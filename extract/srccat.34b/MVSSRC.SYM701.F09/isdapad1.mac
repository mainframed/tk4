         TITLE 'PAD REPORT FORMATTER                                   *
                        '
ISDAPAD1 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(8)                                           01S0001
         DC    C'ISDAPAD1'                                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @10,0                                            01S0001
@PSTART  LA    @11,4095(,@10)                                   01S0001
         LA    @12,4095(,@11)                                   01S0001
         USING @PSTART,@10                                      01S0001
         USING @PSTART+4095,@11                                 01S0001
         USING @PSTART+8190,@12                                 01S0001
         L     @00,@SIZDATD                                     01S0001
         GETMAIN  R,LV=(0)
         LR    @09,@01                                          01S0001
         USING @DATD,@09                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @09,8(,@13)                                      01S0001
         LR    @13,@09                                          01S0001
         MVC   @PC00001(4),0(@01)                               01S0001
*/* %SDACVTL='LENGTH(ISDACVT)'                               @Y30LB55*/
*/*   DCL CVTPTR PTR(31)  AND SET CVTPTR=WORKPTR             @Y30LB55*/
*                                                               01S0006
*                                                               01S0006
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CODE GENERATES THE MSC/SA INTERFACE ARRAY FOR THE ERRORS */
*   /* RECORDED IN THE DRC/DRD PATHS.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0006
*   CVTPTR=WORKPTR;                 /* SET CVTPTR BASE       @Y30LB52*/
         L     @08,@PC00001                                     01S0006
         L     CVTPTR,WORKPTR(,@08)                             01S0006
*   FLAGS='00'X;                    /* CLEAR THE FLAGS       @Y30LB52*/
         MVI   FLAGS,X'00'                                      01S0007
*                                                               02S0008
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE FORMATS THE 'MSC/SA' MATRIX IN THE 'DRD' */
*   /* PORTION OF THE PATH ANALYSIS REPORT.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0008
*   OUTLINE=NEWPAGE;                /* SET NEW PAGE INDICATOR@Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0008
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0008
         MVI   OUTLINE(CVTPTR),C'1'                             02S0008
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0009
         BAL   @14,P1PRINTL                                     02S0009
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE 'DRD' HEADER TO THE OUTPUT BUFFER AND PRINT IT .     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0010
*   OUTLINE=DRDHEAD;                /* MAIN HEADER           @Y30LB52*/
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0010
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0010
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0010
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0011
         BAL   @14,P1PRINTL                                     02S0011
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE 'MSC/SA' ARRAY HEADER LINE TO THE BUFFER AND PRINT   */
*   /* IT.                                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0012
*   OUTLINE=MSCSAHD;                /*                       @Y30LB52*/
         MVI   OUTLINE+33(CVTPTR),C' '                          02S0012
         MVC   OUTLINE+34(99,CVTPTR),OUTLINE+33(CVTPTR)         02S0012
         MVC   OUTLINE(33,CVTPTR),MSCSAHD                       02S0012
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0013
         BAL   @14,P1PRINTL                                     02S0013
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE 'SA' HEADER LINE TO THE BUFFER AND PRINT IT .        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0014
*   OUTLINE=SAHD;                   /*                       @Y30LB52*/
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0014
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0014
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0014
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0015
         BAL   @14,P1PRINTL                                     02S0015
*   /*****************************************************************/
*   /*                                                               */
*   /* SKIP A LINE AND PRINT THE LINE BEFORE THE ARRAY.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0016
*   OUTLINE=SKIPONE;                /*                       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0016
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0016
         MVI   OUTLINE(CVTPTR),C' '                             02S0016
*   COLUMN1='MSC';                  /*                       @Y30LB52*/
         MVC   COLUMN1(3,CVTPTR),@CC00238                       02S0017
*   COLTOTAL='TOTAL';               /*                       @Y30LB52*/
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0018
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0019
         BAL   @14,P1PRINTL                                     02S0019
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPUTE AND PRINT THE ARRAY VALUES AND TOTALS.                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0020
*   CALL P1MSCSAV;                  /* CALL THE MSC/SA VALUE ROUTINE
*                                                            @Y30LB52*/
         BAL   @14,P1MSCSAV                                     02S0020
*P1MSCSAV:                                                      03S0021
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               03S0021
         B     @PB00002                                         03S0021
P1MSCSAV ST    @14,@SA00002                                     03S0021
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE TOTALS, FORMATS AND PRINTS THE VALUES FOR*/
*   /* THE MSC/SA ARRAY IN THE PATH ANALYSIS REPORT(DRD). THE OUTER  */
*   /* LOOP PROCESSES THE EIGHT POSSIBLE MSC INTERFACE ADDRESSES AND */
*   /* THE RESPECTIVE ACCUMULATORS BENEATH.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0022
*   TOTALS=TOTALS&&TOTALS;          /* CLEAR ALL TOTALS      @Y30LB52*/
         XC    TOTALS(76),TOTALS                                03S0022
*   DO I=1 TO 8 WHILE(MSCINTF(I)^='0000'X);/* LOOP THROUGH MSC'S
*                                                            @Y30LB52*/
         LA    I,1                                              03S0023
@DL00023 LR    @08,I                                            03S0023
         SLA   @08,3                                            03S0023
         L     @04,PAD00PTR(,CVTPTR)                            03S0023
         ST    @08,@TF00001                                     03S0023
         ALR   @08,@04                                          03S0023
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0023
         BE    @DC00023                                         03S0023
*     IF SATABPTR(I)^=0             /* WITH ERRORS           @Y30LB52*/
*       THEN                                                    03S0024
         SLR   @08,@08                                          03S0024
         L     @03,@TF00001                                     03S0024
         L     @03,SATABPTR-8(@03,@04)                          03S0024
         CR    @03,@08                                          03S0024
         BE    @RF00024                                         03S0024
*       DO;                         /*                       @Y30LB52*/
         ST    @03,@TF00002                                     03S0025
*         OUTLINE=SKIPONE;          /* SKIP ONE LINE CC      @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0026
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0026
         MVI   OUTLINE(CVTPTR),C' '                             03S0026
*         SATABP=SATABPTR(I);       /* LOAD PTR TO SA TABLE  @Y30LB52*/
*                                                               03S0027
         L     SATABP,@TF00002                                  03S0027
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE MSC ADDRESS TO OUTPUT LINE                         */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0028
*         UNPK(DECNO(1:4),MSCDRDAC(I,1:3));/* UNPACK THE HEX STRING
*                                      PLUS ONE BYTE         @Y30LB52*/
         AL    @04,@TF00001                                     03S0028
         UNPK  DECNO(4),MSCDRDAC-8(3,@04)                       03S0028
*         MSC1=DECNO(1:3)&'0F0F0F'X;/* TURN OFF THE ZONES    @Y30LB52*/
         MVC   MSC1(3,CVTPTR),DECNO                             03S0029
         NC    MSC1(3,CVTPTR),@CB00250                          03S0029
*         TR(MSC1,TRTAB);           /* TRANSLATE TO PRINTABLE@Y30LB52
*                                      HEXADECIMAL CHARACTERS   03S0030
*                                                            @Y30LB52*/
         TR    MSC1(3,CVTPTR),TRTAB                             03S0030
*         RTOTAL=0;                 /* CLEAR THE ROW TOTAL   @Y30LB52*/
*                                                               03S0031
         STH   @08,RTOTAL                                       03S0031
*         /***********************************************************/
*         /*                                                         */
*         /* LOOP THROUGH SIXTEEN POSSIBLE SA'S AND PRINT THE        */
*         /* ACCUMULATED ERRORS.                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0032
*         RESPECIFY                                             03S0032
*           SADRDDSD BASED(SATABP); /*                       @Y30LB52*/
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR THE ACCUMS    @Y30LB52*/
         XC    ACCUMTOT(32),ACCUMTOT                            03S0033
*         ACCPTR=ADDR(ACCUMTOT);    /* SET ACCUMULATOR TOTAL BASE
*                                                            @ZM31069*/
         LA    ACCPTR,ACCUMTOT                                  03S0034
*         DO K=1 TO 16;             /* SIXTEEN POSSIBLE      @Y30LB52*/
         LA    K,1                                              03S0035
@DL00035 DS    0H                                               03S0036
*           IF DASD=OFF             /* DASD REPORT?          @Y30LB52*/
*             THEN                                              03S0036
         TM    DASD,B'10000000'                                 03S0036
         BNZ   @RF00036                                         03S0036
*             DRDACCP=SADRDACC(K);  /* NO, LOAD DRD ACCUMULTR@Y30LB52*/
         LR    @08,K                                            03S0037
         SLA   @08,3                                            03S0037
         AL    @08,@CF00660                                     03S0037
         L     @08,SADRDACC(@08,SATABP)                         03S0037
         ST    @08,DRDACCP                                      03S0037
*           ELSE                                                03S0038
*             DRDACCP=SADASDAC(K);  /* YES, LOAD DASD        @Y30LB52*/
         B     @RC00036                                         03S0038
@RF00036 LR    @08,K                                            03S0038
         SLA   @08,3                                            03S0038
         AL    @08,@CF00661                                     03S0038
         L     @08,SADASDAC-4(@08,SATABP)                       03S0038
         ST    @08,DRDACCP                                      03S0038
*           IF DRDACCP=0            /* IF THE ACCUMULATOR POINTER IS
*                                      XERO                  @Y30LB52*/
*             THEN                                              03S0039
@RC00036 ICM   @08,15,DRDACCP                                   03S0039
         BNZ   @RF00039                                         03S0039
*             MSC2(K)=ASKT4;        /* SET XERO COUNT        @ZM34326*/
         LR    @08,K                                            03S0040
         MH    @08,@CH00101                                     03S0040
         ALR   @08,CVTPTR                                       03S0040
         MVC   MSC2-5(4,@08),@CC00067                           03S0040
*           ELSE                                                03S0041
*             DO;                   /* OTHERWISE, NON-ZERO PTR  03S0041
*                                                            @Y30LB52*/
*                                                               03S0041
         B     @RC00039                                         03S0041
@RF00039 DS    0H                                               03S0042
*               /*****************************************************/
*               /*                                                   */
*               /* TOTAL THE ERRORS RECORDED UNDER THIS MSC/SA       */
*               /* COMBINATION                                       */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0042
*               IF DASD=OFF         /* NOT DASD ARRAY        @Y30LB52*/
*                 THEN                                          03S0042
         TM    DASD,B'10000000'                                 03S0042
         BNZ   @RF00042                                         03S0042
*                 DRDACCE=DRDACCP+LENGTH(CDRDACCT)-2;/*      @Y30LB52*/
         L     @08,DRDACCP                                      03S0043
         SH    @08,@CH00650                                     03S0043
         ST    @08,DRDACCE                                      03S0043
*               ELSE                                            03S0044
*                 DRDACCE=DRDACCP+LENGTH(CSPNDLET)-2;/*      @Y30LB52
*                                      OTHERWISE LOAD DASD ACCUM END
*                                                            @Y30LB52*/
         B     @RC00042                                         03S0044
@RF00042 L     @08,DRDACCP                                      03S0044
         SH    @08,@CH00651                                     03S0044
         ST    @08,DRDACCE                                      03S0044
*               DO DRDACCP=DRDACCP TO DRDACCE BY 2;/* LOOP THROUGH
*                                      ALL ACCUMULATORS      @Y30LB52*/
@RC00042 L     @08,DRDACCP                                      03S0045
         B     @DE00045                                         03S0045
@DL00045 DS    0H                                               03S0046
*                 IF DRDACC^=0      /* IF NON-ZERO ERROR COUNT  03S0046
*                                                            @Y30LB52*/
*                   THEN                                        03S0046
         LH    @08,DRDACC(,@08)                                 03S0046
         LTR   @08,@08                                          03S0046
         BZ    @RF00046                                         03S0046
*                   DO;             /* TOTAL THE ERRORS      @Y30LB52*/
*                     ACCUM1=ACCUM1+DRDACC;/* INCREMNT ACCUMULATOR
*                                      TOTAL                 @Y30LB52*/
         LH    @06,ACCUM1(,ACCPTR)                              03S0048
         ALR   @06,@08                                          03S0048
         STH   @06,ACCUM1(,ACCPTR)                              03S0048
*                     RTOTAL=RTOTAL+DRDACC;/* ROW TOTAL      @Y30LB52*/
         AH    @08,RTOTAL                                       03S0049
         STH   @08,RTOTAL                                       03S0049
*                   END;            /*                       @Y30LB52*/
*               END;                /*                       @Y30LB52*/
*                                                               03S0051
@RF00046 LA    @08,2                                            03S0051
         AL    @08,DRDACCP                                      03S0051
         ST    @08,DRDACCP                                      03S0051
@DE00045 C     @08,DRDACCE                                      03S0051
         BNH   @DL00045                                         03S0051
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT COUNT TO EBCDIC AND INSERT IN OUTPUT LINE */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0052
*               LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT      @Y30LB52
*                                      COLTOTAL              @Y30LB52*/
         LR    @08,K                                            03S0052
         ALR   @08,@08                                          03S0052
         LH    @06,ACCUM1(,ACCPTR)                              03S0052
         LH    @15,LTOTAL-2(@08)                                03S0052
         ALR   @15,@06                                          03S0052
         STH   @15,LTOTAL-2(@08)                                03S0052
*               CVD(ACCUM1,DECNO);  /* CONVERT BINARY STRING TO 03S0053
*                                      DECIMAL               @Y30LB52*/
         CVD   @06,DECNO                                        03S0053
*               MSC2(K)=EDITPAT3;   /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,K                                            03S0054
         MH    @08,@CH00101                                     03S0054
         ST    @08,@TF00001                                     03S0054
         ALR   @08,CVTPTR                                       03S0054
         MVC   MSC2-5(4,@08),EDITPAT3                           03S0054
*               ED(MSC2(K),DECNO1); /* CONVERT TO PRINTABLE HEX 03S0055
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0055
         AL    @08,@TF00001                                     03S0055
         ED    MSC2-5(4,@08),DECNO1                             03S0055
*             END;                  /*                       @Y30LB52*/
*           ACCPTR=ACCPTR+2;        /* INCREMENT ACCUMULATOR @Y30LB52*/
@RC00039 AH    ACCPTR,@CH00106                                  03S0057
*         END;                      /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0058
         CH    K,@CH00084                                       03S0058
         BNH   @DL00035                                         03S0058
*         CVD(RTOTAL,DECNO);        /* CONVERT BINARY STRING TO 03S0059
*                                      DECIMAL               @ZA00699*/
         LH    @08,RTOTAL                                       03S0059
         CVD   @08,DECNO                                        03S0059
*         MSCTOT=EDITPAT5;          /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   MSCTOT(6,CVTPTR),EDITPAT5                        03S0060
*         ED(MSCTOT,DECNO2);        /* CONVERT TO PRINTABLE HEX 03S0061
*                                                            @ZA00699*/
         ED    MSCTOT(6,CVTPTR),DECNO2                          03S0061
*         CALL P1PRINTL;            /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0062
*       END;                        /*                       @Y30LB52*/
*   END;                            /*                       @Y30LB52*/
*                                                               03S0064
@RF00024 AH    I,@CH00045                                       03S0064
         CH    I,@CH00099                                       03S0064
         BNH   @DL00023                                         03S0064
@DC00023 DS    0H                                               03S0065
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT AND PRINT COLUMN TOTALS LINE                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0065
*   OUTLINE=SKIPTWO;                /* SKIP TWO LINES CC     @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0065
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0065
         MVI   OUTLINE(CVTPTR),C'0'                             03S0065
*   MSCCTOT='TOTAL';                /*                       @Y30LB52*/
         MVC   MSCCTOT(5,CVTPTR),@CC00240                       03S0066
*   DO K=1 TO 16;                   /* LOOP THROUGH SA'S     @Y30LB52*/
         LA    K,1                                              03S0067
@DL00067 DS    0H                                               03S0068
*     IF LTOTAL(K)=0                /* ZERO TOTAL?           @Y30LB52*/
*       THEN                                                    03S0068
         LR    @08,K                                            03S0068
         ALR   @08,@08                                          03S0068
         LH    @08,LTOTAL-2(@08)                                03S0068
         LTR   @08,@08                                          03S0068
         BNZ   @RF00068                                         03S0068
*       MSC2(K)=BLNK4;              /* STORE EBCDIC ZERO     @ZM34326*/
         LR    @08,K                                            03S0069
         MH    @08,@CH00101                                     03S0069
         ALR   @08,CVTPTR                                       03S0069
         MVC   MSC2-5(4,@08),@CC00065                           03S0069
*     ELSE                                                      03S0070
*       DO;                         /* NON-ZERO TOTAL?       @Y30LB52*/
*                                                               03S0070
         B     @RC00068                                         03S0070
@RF00068 DS    0H                                               03S0071
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT AND STORE IN OUTPUT LINE                        */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0071
*         GTOTAL=GTOTAL+LTOTAL(K);  /* GRAND TOTAL           @Y30LB52*/
         LR    @08,K                                            03S0071
         ALR   @08,@08                                          03S0071
         LH    @08,LTOTAL-2(@08)                                03S0071
         LH    @05,GTOTAL                                       03S0071
         ALR   @05,@08                                          03S0071
         STH   @05,GTOTAL                                       03S0071
*         CVD(LTOTAL(K),DECNO);     /* CONVERT BINARY STRING TO 03S0072
*                                      DECIMAL               @Y30LB52*/
         CVD   @08,DECNO                                        03S0072
*         MSC2(K)=EDITPAT3;         /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,K                                            03S0073
         MH    @08,@CH00101                                     03S0073
         ST    @08,@TF00001                                     03S0073
         ALR   @08,CVTPTR                                       03S0073
         MVC   MSC2-5(4,@08),EDITPAT3                           03S0073
*         ED(MSC2(K),DECNO1);       /* CONVERT TO PRINTABLE HEX 03S0074
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0074
         AL    @08,@TF00001                                     03S0074
         ED    MSC2-5(4,@08),DECNO1                             03S0074
*       END;                        /*                       @Y30LB52*/
*   END;                            /*                       @Y30LB52*/
@RC00068 AH    K,@CH00045                                       03S0076
         CH    K,@CH00084                                       03S0076
         BNH   @DL00067                                         03S0076
*   CVD(GTOTAL,DECNO);              /* CONVERT BINARY STRING TO 03S0077
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0077
         CVD   @08,DECNO                                        03S0077
*   MSCTOT=EDITPAT5;                /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   MSCTOT(6,CVTPTR),EDITPAT5                        03S0078
*   ED(MSCTOT,DECNO2);              /* CONVERT TO PRINTABLE HEX 03S0079
*                                                            @ZA00699*/
         ED    MSCTOT(6,CVTPTR),DECNO2                          03S0079
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52
*                                                            @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0080
*                                                               03S0081
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE TO BE USED IN THE*/
*   /* INSERTION OF THE ROW ERROR COUNTS.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0081
*   DCL                                                         03S0081
*     1 * DEF(OUTLINE),                                         03S0081
*      2 * CHAR(10),                /* UNUSED                @Y30LB52*/
*      2 MSC1 CHAR(3),              /* MSC UNIT ADDR         @Y30LB52*/
*      2 * CHAR(1),                 /* UNUSED                @Y30LB52*/
*      2 MSCCTOT CHAR(5),           /* CONSTANT 'TOTAL'      @Y30LB52*/
*      2 *(16) CHAR(5),             /* ERROR COUNTS AND SPACE@Y30LB52*/
*       3 MSC2 CHAR(4),             /* ERROR COUNT           @ZM34326*/
*       3 * CHAR(1),                /* UNUSED                @ZM34326*/
*      2 MSCTOT CHAR(6);            /* TOTALS COLUMN         @ZA00699*/
*   END P1MSCSAV;                   /*                       @Y30LB52*/
@EL00002 DS    0H                                               03S0082
@EF00002 DS    0H                                               03S0082
@ER00002 L     @14,@SA00002                                     03S0082
         BR    @14                                              03S0082
@PB00002 DS    0H                                               03S0083
*                                                               02S0083
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS STRUCTURE MAPS THE 'DRD' REPORT HEADER.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0083
*   DCL                                                         02S0083
*     1 DRDHEAD STATIC LOCAL,       /* MAIN DRD REPORT HEAD  @Y30LB52*/
*      2 * CHAR(1) INIT('0'),       /* SKIP TWO CC           @Y30LB52*/
*      2 * CHAR(32) INIT('REPORT 6 - PATH ANALYSIS REPORT '),   02S0083
*      2 * CHAR(19) INIT('OF EQUIPMENT CHECKS'),/*           @ZM30730*/
*      2 * CHAR(24) INIT('(DATA RECORDING DEVICES)'),/*      @ZM30730*/
*                                                               02S0083
*     /***************************************************************/
*     /*                                                             */
*     /* THIS STRUCTURE MAPS THE MAIN HEADER FOR THE 'MSC/SA' ARRAY  */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0083
*     1 MSCSAHD STATIC LOCAL,       /*                       @Y30LB52*/
*      2 * CHAR(1) INIT('-'),       /*                       @Y30LB52*/
*      2 * CHAR(3) INIT('   '),     /*                       @Y30LB52*/
*      2 * CHAR(29) INIT('MSC/SA INTERFACE ERROR COUNTS'),/* @Y30LB52*/
*                                                               02S0083
*     /***************************************************************/
*     /*                                                             */
*     /* THIS STRUCTURE DEFINES THE 'SA' HEADER LINE OF THE MSC/SA   */
*     /* REPORT.                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0083
*     1 SAHD STATIC LOCAL,          /*                       @Y30LB52*/
*      2 * CHAR(1) INIT('-'),       /*                       @Y30LB52*/
*      2 * CHAR(12) INIT(' '),      /*                       @Y30LB52*/
*      2 * CHAR(52) INIT(                                       02S0083
*            'SA     800  810  820  830  840  850  860  870  880  '),
*      2 * CHAR(33) INIT('890  8A0  8B0  8C0  8D0  8E0  8F0'),  02S0083
*                                                               02S0083
*/*                                                          @Y30LB52*/
*                                                               02S0083
*     /***************************************************************/
*     /*                                                             */
*     /* THIS STRUCTURE MAPS THE 'MSC/SA' INNER HEADER OF THE        */
*     /* 'MSC/SA' REPORT.                                            */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0083
*     1 SAHD2 DEF(OUTLINE),         /*                       @Y30LB52*/
*      2 * CHAR(10),                /*                       @Y30LB52*/
*      2 COLUMN1 CHAR(3),           /*                       @Y30LB52*/
*      2 * CHAR(6),                 /*                       @Y30LB52*/
*      2 SAEL2(16) CHAR(5),         /*                       @Y30LB52*/
*      2 * CHAR(2),                 /*                       @ZA00699*/
*      2 COLTOTAL CHAR(5);          /*                       @Y30LB52*/
*                                                               01S0084
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CODE GENERATES THE SA/DRC INTERFACE ARRAY FOR ERRORS     */
*   /* RECORDED IN THE DRC/DRD PATHS.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0084
*   IF MSFTOTC^='0000000000000000'X /* IF NO MSF DRD ERRORS  @Y30LB52*/
*     THEN                                                      01S0084
         L     @08,PAD00PTR(,CVTPTR)                            01S0084
         CLC   MSFTOTC(8,@08),@CB00303                          01S0084
         BE    @RF00084                                         01S0084
*     DO;                           /* SKIP ARRAYS           @Y30LB52*/
*                                                               02S0086
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT FORMATS THE HEADER LINES FOR THE 'SA/DRC'    */
*       /* PORTION OF THE 'DRD' PATH ANALYSIS REPORT. ONE ARRAY IS   */
*       /* PRODUCED FOR EACH LIBRARY PRESENT IN THE SUBSYSTEM BEING  */
*       /* REPORTED ON.                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0086
*       DO I=1 TO MSFNO;            /* LOOP THRO ALL CS'S    @Y30LB52*/
         LA    I,1                                              02S0086
         B     @DE00086                                         02S0086
@DL00086 DS    0H                                               02S0087
*         IF CSFTOTAL(I)^=0         /* IF NO ERRORS WERE     @Y30LB52*/
*           THEN                                                02S0087
         LR    @08,I                                            02S0087
         ALR   @08,@08                                          02S0087
         L     @04,PAD00PTR(,CVTPTR)                            02S0087
         LH    @08,CSFTOTAL-2(@08,@04)                          02S0087
         LTR   @08,@08                                          02S0087
         BZ    @RF00087                                         02S0087
*           DO;                     /* RECORDED, SKIP THE MSF@Y30LB52*/
*                                                               02S0088
*             /*******************************************************/
*             /*                                                     */
*             /* AFTER THE ARRAY FOR THE SECOND LIBRARY IS EVALUATED */
*             /* AND PRINTED, THE PAGE MUST BE EJECTED WITH A NEW TOP*/
*             /* HEADER.                                             */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0089
*             IF I=3 THEN           /* EVERY THIRD ARRAY     @Y30LB52*/
         CH    I,@CH00103                                       02S0089
         BNE   @RF00089                                         02S0089
*               DO;                 /* EJECT THE PAGE        @Y30LB52*/
*                 OUTLINE=NEWPAGE;  /* NEW PAGE CC           @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0091
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0091
         MVI   OUTLINE(CVTPTR),C'1'                             02S0091
*                 CALL P1PRINTL;    /* PRINT A LINE          @Y30LB52*/
*                                                               02S0092
         BAL   @14,P1PRINTL                                     02S0092
*                 /***************************************************/
*                 /*                                                 */
*                 /* OUTPUT THE 'DRD' REPORT HEADER.                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                               02S0093
*                 OUTLINE=DRDHEAD;  /* SET HEADER IN LINE    @Y30LB52*/
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0093
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0093
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0093
*                 CALL P1PRINTL;    /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0094
*               END;                /* PRINT IT              @Y30LB52*/
*                                                               02S0095
*             /*******************************************************/
*             /*                                                     */
*             /* SET UP THE SA/DRC ARRAY MAIN HEADER AND PRINT IT.   */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0096
*             OUTLINE=SADRCHD;      /*                       @Y30LB52*/
@RF00089 MVI   OUTLINE+54(CVTPTR),C' '                          02S0096
         MVC   OUTLINE+55(78,CVTPTR),OUTLINE+54(CVTPTR)         02S0096
         MVC   OUTLINE(54,CVTPTR),SADRCHD                       02S0096
*             OUTLINE(53)=(I-1)×'0';/* CS SSID               @Y30LB52*/
         LR    @08,I                                            02S0097
         BCTR  @08,0                                            02S0097
         O     @08,@CF00073                                     02S0097
         STC   @08,OUTLINE+52(,CVTPTR)                          02S0097
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0098
         BAL   @14,P1PRINTL                                     02S0098
*             /*******************************************************/
*             /*                                                     */
*             /* SET AND PRINT THE 'SA' SSID HEADER LINE.            */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0099
*             OUTLINE=SAHD;         /* SET CONSTANT HEADER   @Y30LB52*/
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0099
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0099
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0099
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/
*                                                               02S0100
         BAL   @14,P1PRINTL                                     02S0100
*             /*******************************************************/
*             /*                                                     */
*             /* SET UP THE DRC-TOTAL HEADER LINE RIGHT BEFORE THE   */
*             /* ARRAY VALUES.                                       */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0101
*             OUTLINE=SKIPONE;      /* SKIP ONE CC           @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0101
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0101
         MVI   OUTLINE(CVTPTR),C' '                             02S0101
*             COLUMN1='DRC';        /* CONSTANT IN LINE      @Y30LB52*/
         MVC   COLUMN1(3,CVTPTR),@CC00307                       02S0102
*             COLTOTAL='TOTAL';     /* SECOND CONSTANT       @Y30LB52*/
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0103
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0104
         BAL   @14,P1PRINTL                                     02S0104
*             /*******************************************************/
*             /*                                                     */
*             /* THE NEXT SEGMENT PRODUCES A PRINTABLE ARRAY OF      */
*             /* VALUES FOR THE 'SA/DRC' REPORT.                     */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0105
*                                                               03S0105
*             /*******************************************************/
*             /*                                                     */
*             /* THE FOLLOWING SEGMENT OF CODE PRODUCES THE VALUE    */
*             /* LINES FOR THE SA/DRC ARRAY OF THE PATH ANALYSIS     */
*             /* REPORT. ON ENTRY TO THIS SEGMENT, THE VARIABLE 'I'  */
*             /* CONTAINS THE CARTRIDGE STORE INDEX.                 */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0105
*             TOTALS=TOTALS&&TOTALS;/* CLEAR ALL TOTALS COUNTERS
*                                                            @Y30LB52*/
         XC    TOTALS(76),TOTALS                                03S0105
*             LTPDRDP=LTPAD+(I-1)*LENGTH(LTPDRDTB);/* SET POINTER TO
*                                      THE LOGICAL DRC CONVERSTION
*                                      TABLE                 @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0106
         LR    @04,I                                            03S0106
         BCTR  @04,0                                            03S0106
         SLA   @04,3                                            03S0106
         AL    @04,LTPAD(,@08)                                  03S0106
         ST    @04,LTPDRDP                                      03S0106
*             DO J=1 TO LIBSIZS(I); /* LOOP THROUGH THE DRCS'S IN THE
*                                      LIBRARY               @Y30LB52*/
         LA    @08,1                                            03S0107
         B     @DE00107                                         03S0107
@DL00107 DS    0H                                               03S0108
*               VSADRC=VSADRC&&VSADRC;/* CLEAR VALID SA/DRC INTERFACE
*                                      CONTROL ARRAY         @Y30LB52*/
         XC    VSADRC(16),VSADRC                                03S0108
*               ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR TOTALS  @Y30LB52*/
*                                                               03S0109
         XC    ACCUMTOT(32),ACCUMTOT                            03S0109
*               /*****************************************************/
*               /*                                                   */
*               /* THE FOLLOWING LOOP PROCESSES THE TWO POSSIBLE SA'S*/
*               /* THAT COULD BE ATTACHED TO THE DRC BEING TOTALED.  */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0110
*               DO K=1 TO 2 WHILE(LTPDRC(J,K)^='FF'X);/* 'FF'X  03S0110
*                                      INDICATES DRC UPPER INTERFACE
*                                      NOT USED              @Y30LB52*/
         LA    K,1                                              03S0110
@DL00110 L     @08,LTPDRDP                                      03S0110
         L     @03,J                                            03S0110
         ALR   @03,@03                                          03S0110
         ALR   @03,K                                            03S0110
         ST    @03,@TF00001                                     03S0110
         ALR   @03,@08                                          03S0110
         AL    @03,@CF00662                                     03S0110
         CLI   LTPDRC(@03),X'FF'                                03S0110
         BE    @DC00110                                         03S0110
*                 SAP=LTPDRC(J,K);  /* LOAD THE SA/LOGICAL DRC BYTE
*                                                            @Y30LB52*/
         L     @03,@TF00001                                     03S0111
         AL    @08,@CF00662                                     03S0111
         SLR   SAP,SAP                                          03S0111
         IC    SAP,LTPDRC(@03,@08)                              03S0111
*                 DRC=SAP&'0F'X;    /* EXTRACT LOGICAL DRC   @Y30LB52*/
         LR    @08,SAP                                          03S0112
         N     @08,@CF00310                                     03S0112
         STH   @08,DRC                                          03S0112
*                 SAP=SAP/16+1;     /* EXTRACT THE SAP INDEX @Y30LB52*/
         LA    @08,1                                            03S0113
         LR    @00,SAP                                          03S0113
         SRDA  @00,32                                           03S0113
         D     @00,@CF00084                                     03S0113
         ALR   @01,@08                                          03S0113
         LR    SAP,@01                                          03S0113
*                 VSADRC(SAP)='FF'X;/* INDICATE VALID SA/DRC @Y30LB52
*                                      CONNECTION            @Y30LB52*/
*                                                               03S0114
         LA    @07,VSADRC-1(SAP)                                03S0114
         MVI   0(@07),X'FF'                                     03S0114
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE FOLLOWING INCLUDED SEGMENT ACCUMULATES ALL  */
*                 /* ERRORS RECORDED IN PATHS INCLUDING THIS SA/DRC  */
*                 /* INTERFACE.                                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0115
*                                                               04S0115
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS SEGMENT OF CODE TOTALS ALL ERRORS IN ALL   */
*                 /* PATHS CONTAINING THE SA/DRC INTERFACE SELECTED  */
*                 /* IN THE PREVIOUS SEGMENT. THIS INVOLVES LOOPING  */
*                 /* THROUGH ALL MSC'S AND FOLLOWING EACH PATH TO THE*/
*                 /* ACCUMULATORS.                                   */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0115
*                 DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* ZERO
*                                      MSC UNIT ADDRESS INDICATES END
*                                      OF LIST               @Y30LB52*/
         STH   @08,MSC                                          04S0115
@DL00115 SLA   @08,3                                            04S0115
         L     @07,PAD00PTR(,CVTPTR)                            04S0115
         ST    @08,@TF00001                                     04S0115
         ALR   @08,@07                                          04S0115
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0115
         BE    @DC00115                                         04S0115
*                   IF SATABPTR(MSC)^=0/* IF THE SATAB POINTER IS
*                                      ZERO,                 @Y30LB52*/
*                     THEN                                      04S0116
         SLR   @08,@08                                          04S0116
         L     @03,@TF00001                                     04S0116
         L     @07,SATABPTR-8(@03,@07)                          04S0116
         CR    @07,@08                                          04S0116
         BE    @RF00116                                         04S0116
*                     DO;           /* THE PATHS THROUGH THIS MSC
*                                      HAVE NO ERRORS        @Y30LB52*/
         ST    @07,@TF00001                                     04S0117
*                       SATABP=SATABPTR(MSC);/* OTHERWISE, LOAD THE
*                                      POINTER               @Y30LB52*/
         L     SATABP,@TF00001                                  04S0118
*                       RESPECIFY                               04S0119
*                         SADRDDSD BASED(SATABP);/*          @Y30LB52*/
*                       IF SADRDACC(SAP)^=0/* XERO POINTER      04S0120
*                                      INDICATES@Y30LB52     @Y30LB52*/
*                         THEN                                  04S0120
         LR    @03,SAP                                          04S0120
         SLA   @03,3                                            04S0120
         AL    @03,@CF00660                                     04S0120
         L     @03,SADRDACC(@03,SATABP)                         04S0120
         CR    @03,@08                                          04S0120
         BE    @RF00120                                         04S0120
*                         DO;       /* NO ERRORS FOR DRD'S   @Y30LB52*/
         ST    @03,@TF00001                                     04S0121
*                           DRDACCP=SADRDACC(SAP)+(DRC-1)*24;/* POINT
*                                      TO PROPER ACCUMULATOR ROW FOR
*                                      THIS DRC              @Y30LB52*/
         LH    @08,DRC                                          04S0122
         BCTR  @08,0                                            04S0122
         MH    @08,@CH00210                                     04S0122
         AL    @08,@TF00001                                     04S0122
         ST    @08,DRDACCP                                      04S0122
*                           ACCPTR=ADDR(ACCUMTOT)+(SAP-1)*2;/*  04S0123
*                                      ADDRESS THE PROPER TOTAL FOR
*                                      THIS SA               @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  04S0123
         LR    @08,SAP                                          04S0123
         BCTR  @08,0                                            04S0123
         ALR   @08,@08                                          04S0123
         ALR   ACCPTR,@08                                       04S0123
*                           DO DRD=1 TO 4;/* LOOP THROUGH ALL   04S0124
*                                      DRD'S@Y30LB52 CONNECTED  04S0124
*                                                            @Y30LB52*/
         LA    DRD,1                                            04S0124
@DL00124 DS    0H                                               04S0125
*                             RESPECIFY                         04S0125
*                               DRDACCS BASED(DRDACCP);/*    @Y30LB52*/
*                             IF DRDACCS^='000000000000'X/* IF COUNTS
*                                      NON-ZERO              @Y30LB52*/
*                               THEN                            04S0126
         L     @08,DRDACCP                                      04S0126
         CLC   DRDACCS(6,@08),@CB00313                          04S0126
         BE    @RF00126                                         04S0126
*                               DO; /* ADD TO TOTALS         @Y30LB52*/
*                                 ACCUM1=ACCUM1+DRDERRS;/* ADD DRD
*                                      ERRORS                @Y30LB52*/
         LH    @15,ACCUM1(,ACCPTR)                              04S0128
         AH    @15,DRDERRS(,@08)                                04S0128
         STH   @15,ACCUM1(,ACCPTR)                              04S0128
*                                 ACCUM1=ACCUM1+CTLIERRS;/* ADD CTLI
*                                      ERRORS@Y30LB52        @Y30LB52*/
         AH    @15,CTLIERRS(,@08)                               04S0129
         STH   @15,ACCUM1(,ACCPTR)                              04S0129
*                                 ACCUM1=ACCUM1+DRCERRS;/* ADD DRC
*                                      ERRORS                @Y30LB52*/
         AH    @15,DRCERRS(,@08)                                04S0130
         STH   @15,ACCUM1(,ACCPTR)                              04S0130
*                               END;/*                       @Y30LB52*/
*                             DRDACCP=DRDACCP+6;/* STEP TO NEXT DRD
*                                      ELEMENT               @YM32170*/
@RF00126 LA    @08,6                                            04S0132
         AL    @08,DRDACCP                                      04S0132
         ST    @08,DRDACCP                                      04S0132
*                           END;    /*                       @Y30LB52*/
         AH    DRD,@CH00045                                     04S0133
         CH    DRD,@CH00055                                     04S0133
         BNH   @DL00124                                         04S0133
*                         END;      /*                       @Y30LB52*/
*                     END;          /*                       @Y30LB52*/
@RF00120 DS    0H                                               04S0136
*                 END;              /*                       @Y30LB52*/
@RF00116 LA    @08,1                                            04S0136
         AH    @08,MSC                                          04S0136
         STH   @08,MSC                                          04S0136
         CH    @08,@CH00099                                     04S0136
         BNH   @DL00115                                         04S0136
@DC00115 DS    0H                                               04S0137
*               END;                /*                       @Y30LB52*/
*                                                               03S0137
         AH    K,@CH00045                                       03S0137
         CH    K,@CH00106                                       03S0137
         BNH   @DL00110                                         03S0137
@DC00110 DS    0H                                               03S0138
*               /*****************************************************/
*               /*                                                   */
*               /* THE FOLLOWING CODE FORMATS AND PRINTS THE         */
*               /* ACCUMULATED TOTALS FOR A DRC AND ITS SA           */
*               /* ATTACHMENTS.                                      */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0138
*               RTOTAL=0;           /* CLEAR THE ROW TOTAL   @Y30LB52*/
         SLR   @08,@08                                          03S0138
         STH   @08,RTOTAL                                       03S0138
*               OUTLINE=SKIPONE;    /* SKIP ONE LINE CC      @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0139
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0139
         MVI   OUTLINE(CVTPTR),C' '                             03S0139
*               DRC1='400';         /* SET THE ROW DRC SSID  @Y30LB52*/
         MVC   DRC1(3,CVTPTR),@CC00316                          03S0140
*               DRC11=(I-1)×DRC11;  /* OR IN THE LIBRARY NUMBER 03S0141
*                                                            @Y30LB52*/
         LR    @08,I                                            03S0141
         BCTR  @08,0                                            03S0141
         SLR   @04,@04                                          03S0141
         IC    @04,DRC11(,CVTPTR)                               03S0141
         OR    @08,@04                                          03S0141
         STC   @08,DRC11(,CVTPTR)                               03S0141
*               DRC12=DRC12×(J-1);  /* INSERT THE DRC NUMBER @Y30LB52*/
         L     @08,J                                            03S0142
         BCTR  @08,0                                            03S0142
         SLR   @04,@04                                          03S0142
         IC    @04,DRC12(,CVTPTR)                               03S0142
         OR    @08,@04                                          03S0142
         STC   @08,DRC12(,CVTPTR)                               03S0142
*               ACCPTR=ADDR(ACCUMTOT);/* POINTER TO FIRST ACCUMULATOR
*                                                            @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  03S0143
*               DO K=1 TO 16;       /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    K,1                                              03S0144
@DL00144 DS    0H                                               03S0145
*                 IF VSADRC(K)='FF'X/* ONLY THE VALID SA/DRC @Y30LB52
*                                      CONNECTIONS           @Y30LB52*/
*                   THEN                                        03S0145
         LA    @08,VSADRC-1(K)                                  03S0145
         CLI   0(@08),X'FF'                                     03S0145
         BNE   @RF00145                                         03S0145
*                   DO;             /* WILL HAVE TOTALS      @Y30LB52*/
*                     RTOTAL=RTOTAL+ACCUM1;/* INCREMENT ROW TOTAL
*                                                            @Y30LB52*/
         LH    @08,ACCUM1(,ACCPTR)                              03S0147
         LH    @15,RTOTAL                                       03S0147
         ALR   @15,@08                                          03S0147
         STH   @15,RTOTAL                                       03S0147
*                     LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT COLUMN
*                                      TOTAL                 @Y30LB52*/
*                                                               03S0148
         LR    @15,K                                            03S0148
         ALR   @15,@15                                          03S0148
         LH    @14,LTOTAL-2(@15)                                03S0148
         ALR   @14,@08                                          03S0148
         STH   @14,LTOTAL-2(@15)                                03S0148
*                     /***********************************************/
*                     /*                                             */
*                     /* CONVERT TOTAL TO EBCDIC AND STORE IN OUTPUT */
*                     /* LINE                                        */
*                     /*                                             */
*                     /***********************************************/
*                                                               03S0149
*                     CVD(ACCUM1,DECNO);/* CONVERT BINARY STRING TO
*                                      DECIMAL               @Y30LB52*/
         CVD   @08,DECNO                                        03S0149
*                     DRC3(K)=EDITPAT3;/* MOVE EDIT PATTERN  @ZM34326*/
         LR    @08,K                                            03S0150
         MH    @08,@CH00101                                     03S0150
         ST    @08,@TF00001                                     03S0150
         ALR   @08,CVTPTR                                       03S0150
         MVC   DRC3-5(4,@08),EDITPAT3                           03S0150
*                     ED(DRC3(K),DECNO1);/* CONVERT TO PRINTABLE HEX
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0151
         AL    @08,@TF00001                                     03S0151
         ED    DRC3-5(4,@08),DECNO1                             03S0151
*                   END;            /*                       @Y30LB52*/
*                 ELSE                                          03S0153
*                   DRC3(K)=ASKT4;  /* INDICATE NO CONNECTION@ZM34326*/
         B     @RC00145                                         03S0153
@RF00145 LR    @08,K                                            03S0153
         MH    @08,@CH00101                                     03S0153
         ALR   @08,CVTPTR                                       03S0153
         MVC   DRC3-5(4,@08),@CC00067                           03S0153
*                 ACCPTR=ACCPTR+2;  /* INCREMENT TO NEXT     @Y30LB52*/
@RC00145 AH    ACCPTR,@CH00106                                  03S0154
*               END;                /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0155
         CH    K,@CH00084                                       03S0155
         BNH   @DL00144                                         03S0155
*               GTOTAL=GTOTAL+RTOTAL;/* INCREMENT THE ROW TOTAL 03S0156
*                                                            @Y30LB52*/
         LH    @08,RTOTAL                                       03S0156
         LH    @04,GTOTAL                                       03S0156
         ALR   @04,@08                                          03S0156
         STH   @04,GTOTAL                                       03S0156
*               CVD(RTOTAL,DECNO);  /* CONVERT BINARY STRING TO 03S0157
*                                      DECIMAL               @ZA00699*/
         CVD   @08,DECNO                                        03S0157
*               DRCTOT=EDITPAT5;    /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DRCTOT(6,CVTPTR),EDITPAT5                        03S0158
*               ED(DRCTOT,DECNO2);  /* CONVERT TO PRINTABLE HEX 03S0159
*                                                            @ZA00699*/
         ED    DRCTOT(6,CVTPTR),DECNO2                          03S0159
*               CALL P1PRINTL;      /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0160
*             END;                  /*                       @Y30LB52*/
         LA    @08,1                                            03S0161
         AL    @08,J                                            03S0161
@DE00107 ST    @08,J                                            03S0161
         L     @04,CNFG0PTR(,CVTPTR)                            03S0161
         SLR   @03,@03                                          03S0161
         IC    @03,LIBSIZS-1(I,@04)                             03S0161
         CR    @08,@03                                          03S0161
         BNH   @DL00107                                         03S0161
*                                                               03S0162
*             /*******************************************************/
*             /*                                                     */
*             /* FORMAT AND PRINT THE LINE CONTAINING COLUMN TOTALS  */
*             /* AND THE GRAND TOTAL                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0162
*             OUTLINE=SKIPTWO;      /* SKIP TWO BEFORE PRINTING 03S0162
*                                                            @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0162
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0162
         MVI   OUTLINE(CVTPTR),C'0'                             03S0162
*             DRC2='TOTAL';         /* SET ROW CONSTANT      @Y30LB52*/
         MVC   DRC2(5,CVTPTR),@CC00240                          03S0163
*             DO K=1 TO 16;         /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    K,1                                              03S0164
@DL00164 DS    0H                                               03S0165
*               IF LTOTAL(K)^=0     /* COLUMN TOTAL ZERO?    @Y30LB52*/
*                 THEN                                          03S0165
         LR    @08,K                                            03S0165
         ALR   @08,@08                                          03S0165
         LH    @08,LTOTAL-2(@08)                                03S0165
         LTR   @08,@08                                          03S0165
         BZ    @RF00165                                         03S0165
*                 DO;               /* PRINT THE TOTAL       @Y30LB52*/
*                   CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO
*                                      DECIMAL               @Y30LB52*/
         CVD   @08,DECNO                                        03S0167
*                   DRC3(K)=EDITPAT3;/* MOVE EDIT PATTERN    @ZM34326*/
         LR    @08,K                                            03S0168
         MH    @08,@CH00101                                     03S0168
         ST    @08,@TF00001                                     03S0168
         ALR   @08,CVTPTR                                       03S0168
         MVC   DRC3-5(4,@08),EDITPAT3                           03S0168
*                   ED(DRC3(K),DECNO1);/* CONVERT TO PRINTABLE HEX
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0169
         AL    @08,@TF00001                                     03S0169
         ED    DRC3-5(4,@08),DECNO1                             03S0169
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
*                                                               03S0171
@RF00165 AH    K,@CH00045                                       03S0171
         CH    K,@CH00084                                       03S0171
         BNH   @DL00164                                         03S0171
*             /*******************************************************/
*             /*                                                     */
*             /* ADD THE GRAND TOTAL AND PRINT                       */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0172
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0172
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0172
         CVD   @08,DECNO                                        03S0172
*             DRCTOT=EDITPAT5;      /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DRCTOT(6,CVTPTR),EDITPAT5                        03S0173
*             ED(DRCTOT,DECNO2);    /* CONVERT TO PRINTABLE HEX 03S0174
*                                                            @ZA00699*/
         ED    DRCTOT(6,CVTPTR),DECNO2                          03S0174
*             CALL P1PRINTL;        /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0175
*             DCL                                               03S0176
*                                                               03S0176
*               /*****************************************************/
*               /*                                                   */
*               /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR  */
*               /* THE PURPOSE OF INSERTING DRC NUMBERS AND          */
*               /* ACCUMULATOR TOTALS.                               */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0176
*               1 * DEF(OUTLINE),   /*                       @Y30LB52*/
*                2 * CHAR(10),      /*                       @Y30LB52*/
*                2 DRC1 CHAR(3),    /* DRC SSID              @Y30LB52*/
*                 3 * CHAR(1),      /*                       @Y30LB52*/
*                 3 DRC11 CHAR(1),  /* LIBRARY NUMBER        @Y30LB52*/
*                 3 DRC12 CHAR(1),  /* DRC NUMBER            @Y30LB52*/
*                2 * CHAR(1),       /*                       @Y30LB52*/
*                2 DRC2 CHAR(5),    /* 'TOTAL' CONSTANT      @Y30LB52*/
*                2 *(16) CHAR(5),   /* COLUMN VALUES         @Y30LB52*/
*                 3 DRC3 CHAR(4),   /* ACTUAL EBCDIC VALUE   @ZM34326*/
*                 3 * CHAR(1),      /* SEPARATOR BLANKS      @ZM34326*/
*                2 DRCTOT CHAR(6),  /* EBCDIC ROW TOTAL      @ZA00699*/
*               VSADRC CHAR(16);    /* VECTOR USED TO INDICATE WHICH
*                                      SA/DRC CONNECTIONS EXIST TO
*                                      THE OUTPUT PROCESS. UNUSED
*                                      CONNECTIONS ARE SKIPPED. 03S0176
*                                                            @Y30LB52*/
*           END;                    /*                       @Y30LB52*/
*       END;                        /*                       @Y30LB52*/
@RF00087 AH    I,@CH00045                                       02S0178
@DE00086 L     @08,CNFG0PTR(,CVTPTR)                            02S0178
         CH    I,MSFNO(,@08)                                    02S0178
         BNH   @DL00086                                         02S0178
*       DCL                                                     02S0179
*                                                               02S0179
*         /***********************************************************/
*         /*                                                         */
*         /* THIS STRUCTURE DEFINES THE 'SA/DRC' REPORT ARRAY HEADER.*/
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0179
*         1 SADRCHD STATIC LOCAL,   /* SA/DRC HEADER         @Y30LB52*/
*          2 * CHAR(1) INIT(SKIP3), /* SKIP 3 LINES CC       @Y30LB52*/
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/
*          2 * CHAR(50) INIT(                                   02S0179
*                'SA/DRC INTERFACE ERROR COUNTS               MSF 0 ');
*                                                               01S0180
*       /*************************************************************/
*       /*                                                           */
*       /* THIS CODE GENERATES THE DRC/DRD INTERFACE ARRAY FOR THE   */
*       /* ERRORS RECORDED IN THE DRC/DRD PATHS.                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0180
*                                                               02S0180
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT PRODUCES THE DRC/DRD INTERFACE PORTION OF THE*/
*       /* PATH ANALYSIS REPORT FOR DRD'S. ONE PRINTED ARRAY IS      */
*       /* PRODUCED FOR EACH CARTRIDGE STORE ON THE SUBSYSTEM. A NEW */
*       /* PAGE IS EJECTED AND THE MAIN PATH ANALYSIS HEADER IS      */
*       /* PRINTED.                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0180
*       OUTLINE=NEWPAGE;            /* SET PAGE EJECT CC     @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0180
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0180
         MVI   OUTLINE(CVTPTR),C'1'                             02S0180
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0181
*       OUTLINE=DRDHEAD;            /* CONSTANT HEADER FOR DRC/DRD
*                                                            @Y30LB52*/
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0182
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0182
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0182
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0183
         BAL   @14,P1PRINTL                                     02S0183
*       /*************************************************************/
*       /*                                                           */
*       /* A SEPARATE ARRAY IS PRODUCED FOR EACH CARTRIDGE STORE     */
*       /* ATTACHED, UP TO FOUR LIBRARIES.                           */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0184
*       DO MSF=1 TO MSFNO;          /* LOOP THROUGH ALL LIBRARIES
*                                                            @Y30LB52*/
         LA    @08,1                                            02S0184
         B     @DE00184                                         02S0184
@DL00184 DS    0H                                               02S0185
*         IF CSFTOTAL(MSF)^=0       /* IF NO ERRORS RECORDED @Y30LB52*/
*           THEN                                                02S0185
         LR    @03,@08                                          02S0185
         ALR   @03,@03                                          02S0185
         L     @01,PAD00PTR(,CVTPTR)                            02S0185
         LH    @03,CSFTOTAL-2(@03,@01)                          02S0185
         LTR   @03,@03                                          02S0185
         BZ    @RF00185                                         02S0185
*           DO;                     /* SKIP THE MSF          @Y30LB52*/
*                                                               02S0186
*             /*******************************************************/
*             /*                                                     */
*             /* FOR EACH CARTRIDGE STORE ARRAY, A MAIN DRC/DRD      */
*             /* HEADER IS PRODUCED WITH THE SSID OF THE CS.         */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0187
*             OUTLINE=DRCDRDHD;     /* MOVE IN CONSTANT HEADER  02S0187
*                                                            @Y30LB52*/
         MVI   OUTLINE+55(CVTPTR),C' '                          02S0187
         MVC   OUTLINE+56(77,CVTPTR),OUTLINE+55(CVTPTR)         02S0187
         MVC   OUTLINE(55,CVTPTR),DRCDRDHD                      02S0187
*             OUTLINE(53)=(MSF-1)×'0';/* OR IN THE CS INDEX  @Y30LB52*/
         BCTR  @08,0                                            02S0188
         O     @08,@CF00073                                     02S0188
         STC   @08,OUTLINE+52(,CVTPTR)                          02S0188
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0189
         BAL   @14,P1PRINTL                                     02S0189
*             /*******************************************************/
*             /*                                                     */
*             /* THE ARRAY HEADER LINE IS PRINTED WITH SSID'S OF THE */
*             /* DRD'S.                                              */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0190
*             OUTLINE=SKIP3;        /* SET SKIP 3 LINES CC   @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0190
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0190
         MVI   OUTLINE(CVTPTR),C'-'                             02S0190
*             DRCD1(1:3)='DRD';     /* SET DRD COLUMN CONSTAN@Y30LB52*/
         MVC   DRCD1(3,CVTPTR),@CC00338                         02S0191
*             DO I=1 TO 8;          /* LOOP THROUGH 8 DRD'S  @Y30LB52*/
         LA    I,1                                              02S0192
@DL00192 DS    0H                                               02S0193
*               DRCD2(I)=' 200';    /* SET CONSTANT          @ZM34326*/
         LR    @08,I                                            02S0193
         MH    @08,@CH00101                                     02S0193
         ST    @08,@TF00001                                     02S0193
         ALR   @08,CVTPTR                                       02S0193
         MVC   DRCD2-5(4,@08),@CC00340                          02S0193
*               DRCD2L(I)=(MSF-1)×'0';/* OR IN MSF NUMBER    @Y30LB52*/
         LA    @08,240                                          02S0194
         LH    @04,MSF                                          02S0194
         BCTR  @04,0                                            02S0194
         OR    @04,@08                                          02S0194
         L     @03,@TF00001                                     02S0194
         STC   @04,DRCD2L-5(@03,CVTPTR)                         02S0194
*               DRCD2R(I)=(I-1)×'0';/* OR IN DRD NUMBER      @Y30LB52*/
         LR    @04,I                                            02S0195
         BCTR  @04,0                                            02S0195
         OR    @04,@08                                          02S0195
         L     @08,@TF00001                                     02S0195
         STC   @04,DRCD2R-5(@08,CVTPTR)                         02S0195
*             END;                  /*                       @Y30LB52*/
         AH    I,@CH00045                                       02S0196
         CH    I,@CH00099                                       02S0196
         BNH   @DL00192                                         02S0196
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0197
*             OUTLINE=SKIPONE;      /*                       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0198
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0198
         MVI   OUTLINE(CVTPTR),C' '                             02S0198
*             ODRC='DRC';           /* SET DRC CONSTANT HEADER  02S0199
*                                                            @Y30LB52*/
         MVC   ODRC(3,CVTPTR),@CC00307                          02S0199
*             OUTLINE(65:69)='TOTAL';/*                      @ZA00699*/
         MVC   OUTLINE+64(5,CVTPTR),@CC00240                    02S0200
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0201
         BAL   @14,P1PRINTL                                     02S0201
*             /*******************************************************/
*             /*                                                     */
*             /* THE FOLLOWING SEGMENT TOTALS THE COUNTS FOR THE     */
*             /* ARRAY AND PRINTS THE VALUES.                        */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0202
*                                                               03S0202
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT TOTALS, FORMATS AND PRINTS THE         */
*             /* ACCUMULATED ERROR TOTALS FOR THE DRC/DRD ERROR      */
*             /* ARRAYS IN THE PATH ANALYSIS REPORT. THE ACCUMULATED */
*             /* ERRORS ARE AT THE BOTTOM OF A TREE STRUCTURE        */
*             /* REPRESENTING THE TOTAL PATH HAVING THE ERRORS. THE  */
*             /* ERRORS WERE ACCUMULATED BY LOGICAL ADDRESS(SA, DRC) */
*             /* BUT ARE PRINTED IN THE REPORT BY PHYSICAL ADDRESS.  */
*             /* FIRST THE SA'S ATTACHED TO EACH DRC IN A LIBRARY    */
*             /* MUST BE DETERMINED TO ACCESS THE ACCUMULATOR TREE.  */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0202
*             LTPDRDP=LTPAD+((MSF-1)*8);/* LOCATE THE PROPER SA/DRC
*                                      TABLE                 @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0202
         LH    @03,MSF                                          03S0202
         BCTR  @03,0                                            03S0202
         SLA   @03,3                                            03S0202
         AL    @03,LTPAD(,@08)                                  03S0202
         ST    @03,LTPDRDP                                      03S0202
*             TOTALS=TOTALS&&TOTALS;/* CLEAR TOTALS          @Y30LB52*/
         XC    TOTALS(76),TOTALS                                03S0203
*             DO I=1 TO LIBSIZS(MSF);/* DEPENDING ON THE LIBRARY
*                                      SIZE, 1 TO 4 DRC'S ARE   03S0204
*                                      PROCESSED             @Y30LB52*/
         LA    I,1                                              03S0204
         B     @DE00204                                         03S0204
@DL00204 DS    0H                                               03S0205
*               VSADRC=VSADRC&&VSADRC;/* CLEAR VALID INTERFACE FIELD
*                                                            @Y30LB52*/
         XC    VSADRC(16),VSADRC                                03S0205
*               ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUM TOTALS
*                                                            @Y30LB52*/
         XC    ACCUMTOT(32),ACCUMTOT                            03S0206
*               DO J=1 TO 2 WHILE(LTPDRC(I,J)^='FF'X);/* EACH   03S0207
*                                      PHYSICAL DRC MAY HAVE TWO SA
*                                      CONNECTIONS           @Y30LB52*/
         LA    @08,1                                            03S0207
         ST    @08,J                                            03S0207
@DL00207 L     @04,LTPDRDP                                      03S0207
         LR    @03,I                                            03S0207
         ALR   @03,@03                                          03S0207
         ALR   @03,@08                                          03S0207
         ST    @03,@TF00001                                     03S0207
         ALR   @03,@04                                          03S0207
         AL    @03,@CF00662                                     03S0207
         CLI   LTPDRC(@03),X'FF'                                03S0207
         BE    @DC00207                                         03S0207
*                 SAP=LTPDRC(I,J);  /* EXTRACT THE SA/DRC BYTE  03S0208
*                                                            @Y30LB52*/
         L     @08,@TF00001                                     03S0208
         AL    @04,@CF00662                                     03S0208
         SLR   @03,@03                                          03S0208
         IC    @03,LTPDRC(@08,@04)                              03S0208
         LR    SAP,@03                                          03S0208
*                 DRC=LTPDRC(I,J)&'0F'X;/* EXTRACT THE LOGICAL DRC
*                                      ADDRESS TO THE SA     @Y30LB52*/
         N     @03,@CF00310                                     03S0209
         STH   @03,DRC                                          03S0209
*                 SAP=SAP/16+1;     /* SA NUMBER +1          @Y30LB52*/
*                                                               03S0210
         LA    @08,1                                            03S0210
         LR    @00,SAP                                          03S0210
         SRDA  @00,32                                           03S0210
         D     @00,@CF00084                                     03S0210
         ALR   @01,@08                                          03S0210
         LR    SAP,@01                                          03S0210
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE FOLLOWING INCLUDED SEGMENT TOTALS ALL ERRORS*/
*                 /* IN PATHS TO THE DRC SELECTED ABOVE.             */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0211
*                                                               04S0211
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS SEGMENT OF CODE TOTALS ALL ERRORS FOR THE  */
*                 /* FOUR DRC/DRD INTERFACES FOR A PHYSICAL DRC. AT  */
*                 /* THIS POINT IN THE CODE, ONE OF THE SA'S ATTACHED*/
*                 /* TO THE DRC HAS BEEN SELECTED AND THE LOGICAL    */
*                 /* CONNECTION OF THIS PHYSICAL DRC HAS BEEN        */
*                 /* DETERMINED. LOOP THROUGH ALL MSC'S WITH         */
*                 /* ACCUMULATED ERRORS                              */
*                 /*                                                 */
*                 /***************************************************/
*                                                               04S0211
*                 DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* 04S0211
*                                      TESTING FOR AN MSC ADDRESS
*                                                            @Y30LB52*/
         STH   @08,MSC                                          04S0211
@DL00211 SLA   @08,3                                            04S0211
         L     @07,PAD00PTR(,CVTPTR)                            04S0211
         ST    @08,@TF00001                                     04S0211
         ALR   @08,@07                                          04S0211
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0211
         BE    @DC00211                                         04S0211
*                   IF SATABPTR(MSC)^=0/* NON-ZERO SATAB        04S0212
*                                      POINTER@Y30LB52       @Y30LB52*/
*                     THEN                                      04S0212
         L     @08,@TF00001                                     04S0212
         L     @08,SATABPTR-8(@08,@07)                          04S0212
         LTR   @08,@08                                          04S0212
         BZ    @RF00212                                         04S0212
*                     DO;           /* INDICATES ERRORS BELOW@Y30LB52
*                                                            @Y30LB52*/
*                       RESPECIFY                               04S0214
*                         SADRDDSD BASED(SATABP);/*          @Y30LB52*/
*                       SATABP=SATABPTR(MSC);/* LOAD THE SATAB BASE
*                                                            @Y30LB52*/
         LR    SATABP,@08                                       04S0215
*                       DRDACCP=SADRDACC(SAP);/* PTR TO ACCUMULATOR
*                                                            @Y30LB52*/
*                                                               04S0216
         LR    @08,SAP                                          04S0216
         SLA   @08,3                                            04S0216
         AL    @08,@CF00660                                     04S0216
         L     @08,SADRDACC(@08,SATABP)                         04S0216
         ST    @08,DRDACCP                                      04S0216
*                       /*********************************************/
*                       /*                                           */
*                       /* THE FOUR LOGICAL DRD'S ATTACHED TO THE DRC*/
*                       /* ARE DETERMINED AND THE PHYSICAL DRD NUMBER*/
*                       /* USED TO UPDATE THE PROPER ACCUMULATOR     */
*                       /* TOTAL. A SINGLE ROW OF THE ACCUMULATOR    */
*                       /* ARRAY CONTAINS THE ERROR COUNTS FOR THESE */
*                       /* DRD'S. THE PHYSICAL DRD CORRESPONDING TO  */
*                       /* EACH LOGICAL DRD IS DETERMINED FROM THE   */
*                       /* 'DRDS' TABLE. THIS BASED TABLE CONTAINS   */
*                       /* THE PHYSICAL DRD NUMBER FOR EACH LOGICAL  */
*                       /* DRD ATTACHMENT FOR A DRC.                 */
*                       /*                                           */
*                       /*********************************************/
*                                                               04S0217
*                       DRDSPTR=MSFAN(LIBSIZS(MSF))+(I-1)*4;/*  04S0217
*                                                            @Y30LB52
*                                      LOAD THE PHYSICAL DRD TABLE
*                                      POINTER               @Y30LB52*/
         LH    @08,MSF                                          04S0217
         L     @07,CNFG0PTR(,CVTPTR)                            04S0217
         SLR   @04,@04                                          04S0217
         IC    @04,LIBSIZS-1(@08,@07)                           04S0217
         SLA   @04,2                                            04S0217
         LR    @08,I                                            04S0217
         BCTR  @08,0                                            04S0217
         SLA   @08,2                                            04S0217
         AL    @08,MSFAN-4(@04)                                 04S0217
         ST    @08,DRDSPTR                                      04S0217
*                       DO K=1 TO 4;/* LOOP THROUGH 4 POSSIBLE  04S0218
*                                      ATTACHED DRD'S        @Y30LB52*/
         LA    K,1                                              04S0218
@DL00218 DS    0H                                               04S0219
*                         VSADRC(DRDS(K)+1)='FF'X;/* INDICATE VALID
*                                      INTERFACE             @Y30LB52*/
         L     @08,DRDSPTR                                      04S0219
         AL    @08,@CF00663                                     04S0219
         SLR   @07,@07                                          04S0219
         IC    @07,DRDS(K,@08)                                  04S0219
         LA    @08,VSADRC(@07)                                  04S0219
         MVI   0(@08),X'FF'                                     04S0219
*                         IF DRDACCP^=0 THEN/* CHECK IF ERRORS  04S0220
*                                                            @ZM34326*/
         L     @08,DRDACCP                                      04S0220
         LTR   @08,@08                                          04S0220
         BZ    @RF00220                                         04S0220
*                           DO;     /* ARE RECORDED          @ZM34326*/
         ST    @07,@TF00001                                     04S0221
*                             RESPECIFY                         04S0222
*                               DRDACCTB BASED(DRDACCP);/*   @Y30LB52*/
*                             RESPECIFY                         04S0223
*                               DRDACCS BASED(L);/*          @Y30LB52*/
*                             L=ADDR(DRDACCTB(DRC,K));/* LOAD   04S0224
*                                      ACCUMULATOR'S ADDRESS @Y30LB52*/
         LH    @03,DRC                                          04S0224
         SLA   @03,2                                            04S0224
         ALR   @03,K                                            04S0224
         MH    @03,@CH00058                                     04S0224
         AL    @08,@CF00664                                     04S0224
         LA    L,DRDACCTB(@03,@08)                              04S0224
*                             IF DRDACCS^='000000000000'X/*     04S0225
*                                      ACCUMULATED ERROR TOTALS 04S0225
*                                      NON-ZERO              @Y30LB52*/
*                               THEN                            04S0225
         CLC   DRDACCS(6,L),@CB00313                            04S0225
         BE    @RF00225                                         04S0225
*                               DO; /* ADD TO TOTALS FOR DRD @Y30LB52*/
*                                 ACCPTR=ADDR(ACCUMTOT)+DRDS(K)*2;/*
*                                      LOAD TOTALS POINTER   @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  04S0227
         L     @08,@TF00001                                     04S0227
         ALR   @08,@08                                          04S0227
         ALR   ACCPTR,@08                                       04S0227
*                                 ACCUM1=ACCUM1+DRDERRS;/* ADD DRD
*                                      ERRORS                @Y30LB52*/
         LH    @08,ACCUM1(,ACCPTR)                              04S0228
         AH    @08,DRDERRS(,L)                                  04S0228
         STH   @08,ACCUM1(,ACCPTR)                              04S0228
*                                 ACCUM1=ACCUM1+CTLIERRS;/* ADD CTLI
*                                      ERRORS@Y30LB52        @Y30LB52*/
         AH    @08,CTLIERRS(,L)                                 04S0229
         STH   @08,ACCUM1(,ACCPTR)                              04S0229
*                                 ACCUM1=ACCUM1+DRCERRS;/* ADD DRC
*                                      ERRORS                @Y30LB52*/
         AH    @08,DRCERRS(,L)                                  04S0230
         STH   @08,ACCUM1(,ACCPTR)                              04S0230
*                               END;/*                       @Y30LB52*/
*                           END;    /*                       @Y30LB52*/
@RF00225 DS    0H                                               04S0233
*                       END;        /*                       @Y30LB52*/
@RF00220 AH    K,@CH00045                                       04S0233
         CH    K,@CH00055                                       04S0233
         BNH   @DL00218                                         04S0233
*                     END;          /*                       @Y30LB52*/
*                 END;              /*                       @Y30LB52*/
@RF00212 LA    @08,1                                            04S0235
         AH    @08,MSC                                          04S0235
         STH   @08,MSC                                          04S0235
         CH    @08,@CH00099                                     04S0235
         BNH   @DL00211                                         04S0235
@DC00211 DS    0H                                               04S0236
*                 DCL                                           04S0236
*                   DRDSPTR PTR(31),/* DRDS BASE             @Y30LB52*/
*                   DRDS(4) FIXED(8) BASED(DRDSPTR),/* PHYSICAL DRD
*                                      NUMBERS CORRESPONDING TO 04S0236
*                                      LOGICAL DRD'S ATTACHED   04S0236
*                                                            @ZM34326*/
*                   MSFAN(4) PTR(31) INIT(ADDR(MSFA1),ADDR(MSFA4),ADDR(
*                       MSFA3),ADDR(MSFA4)),/* POINTERS TO THE TABLES
*                                      CONTAINING THE DRDS ARRAYS
*                                                            @ZM34326*/
*                                                               04S0236
*                   /*************************************************/
*                   /*                                               */
*                   /* THE FOLLOWING TABLES CONTAIN INTEGERS         */
*                   /* CORRESPONDING PHYSICAL DRD'S TO LOGICAL DRD'S */
*                   /* ATTACHED TO A DRC. EACH 4-BYTE ROW OF THE     */
*                   /* ARRAY CONTAINS THE PHYSICAL DRD NUMBERS FOR   */
*                   /* THE FOUR LOGICAL DRD'S ATTACHED TO A DRC.     */
*                   /*                                               */
*                   /*************************************************/
*                                                               04S0236
*                   MSFA1(4) FIXED(8) INIT(0,1,0,1),/* A1 TABLE 04S0236
*                                                            @ZM34326*/
*                   MSFA3(12) FIXED(8) INIT(0,1,4,5,2,3,0,1,4,5,2,3),
*                                                               04S0236
*/*      A3 TABLE                                            @ZA00681*/
*                                                               04S0236
*                   MSFA4(16) FIXED(8) INIT(0,1,2,3,2,3,0,1,4,5,6,7,6,7
*                       ,4,5);                                  04S0236
*                                                               04S0236
*/* A2, A4 TABLE                                             @Y30LB52*/
*                                                               04S0237
*               END;                /*                       @Y30LB52*/
*                                                               03S0237
         LA    @08,1                                            03S0237
         AL    @08,J                                            03S0237
         ST    @08,J                                            03S0237
         CH    @08,@CH00106                                     03S0237
         BNH   @DL00207                                         03S0237
@DC00207 DS    0H                                               03S0238
*               /*****************************************************/
*               /*                                                   */
*               /* THE FOLLOWING CODE CONVERTS AND PRINTS THE ERROR  */
*               /* COUNTS FOR THE DRC SELECTED ABOVE.                */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0238
*               OUTLINE=SKIPONE;    /* SKIP ONE CC           @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0238
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0238
         MVI   OUTLINE(CVTPTR),C' '                             03S0238
*               ODRC='400';         /* INITIALIZE DRC NUMBER @Y30LB52*/
         MVC   ODRC(3,CVTPTR),@CC00316                          03S0239
*               ODRCL=ODRCL×(MSF-1);/* SET LIBRARY PORTION OF SSID
*                                                            @Y30LB52*/
         LH    @08,MSF                                          03S0240
         BCTR  @08,0                                            03S0240
         SLR   @04,@04                                          03S0240
         IC    @04,ODRCL(,CVTPTR)                               03S0240
         OR    @08,@04                                          03S0240
         STC   @08,ODRCL(,CVTPTR)                               03S0240
*               ODRCN=ODRCN×(I-1);  /* SET DRC NUMBER IN SSID@Y30LB52
*                                                            @Y30LB52*/
         LR    @08,I                                            03S0241
         BCTR  @08,0                                            03S0241
         SLR   @04,@04                                          03S0241
         IC    @04,ODRCN(,CVTPTR)                               03S0241
         OR    @08,@04                                          03S0241
         STC   @08,ODRCN(,CVTPTR)                               03S0241
*               RTOTAL=0;           /* REINTIALIZE THE ROW TOTAL
*                                                            @Y30LB52*/
         SLR   @08,@08                                          03S0242
         STH   @08,RTOTAL                                       03S0242
*               ACCPTR=ADDR(ACCUMTOT);/* INITIALIZE ACCUMULATOR TOTAL
*                                      BASE                  @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  03S0243
*               DO K=1 TO 8;        /* LOOP THROUGH 8 POSSIBLE DRD'S
*                                                            @Y30LB52*/
         LA    K,1                                              03S0244
@DL00244 DS    0H                                               03S0245
*                 IF VSADRC(K)='FF'X/* IF VALID INTERFACE    @Y30LB52*/
*                   THEN                                        03S0245
         LA    @08,VSADRC-1(K)                                  03S0245
         CLI   0(@08),X'FF'                                     03S0245
         BNE   @RF00245                                         03S0245
*                   DO;             /*                       @Y30LB52*/
*                     CVD(ACCUM1,DECNO);/* CONVERT BINARY STRING TO
*                                      DECIMAL               @Y30LB52*/
         LH    @08,ACCUM1(,ACCPTR)                              03S0247
         CVD   @08,DECNO                                        03S0247
*                     DRCD2(K)=EDITPAT3;/* MOVE EDIT PATTERN @ZM34326*/
         LR    @15,K                                            03S0248
         MH    @15,@CH00101                                     03S0248
         ST    @15,@TF00001                                     03S0248
         ALR   @15,CVTPTR                                       03S0248
         MVC   DRCD2-5(4,@15),EDITPAT3                          03S0248
*                     ED(DRCD2(K),DECNO1);/* CONVERT TO PRINTABLE HEX
*                                                            @ZM34326*/
         LR    @01,CVTPTR                                       03S0249
         AL    @01,@TF00001                                     03S0249
         ED    DRCD2-5(4,@01),DECNO1                            03S0249
*                     RTOTAL=ACCUM1+RTOTAL;/* INCREMTN THE ROW  03S0250
*                                      TOTAL@Y30LB52         @Y30LB52*/
         LH    @15,RTOTAL                                       03S0250
         ALR   @15,@08                                          03S0250
         STH   @15,RTOTAL                                       03S0250
*                     LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT THE
*                                      COLUMN TOTAL          @Y30LB52*/
         LR    @15,K                                            03S0251
         ALR   @15,@15                                          03S0251
         AH    @08,LTOTAL-2(@15)                                03S0251
         STH   @08,LTOTAL-2(@15)                                03S0251
*                   END;            /*                       @Y30LB52*/
*                 ELSE                                          03S0253
*                   DRCD2(K)=ASKT4; /* SET NO INTERFACE IND. @ZM34326*/
         B     @RC00245                                         03S0253
@RF00245 LR    @08,K                                            03S0253
         MH    @08,@CH00101                                     03S0253
         ALR   @08,CVTPTR                                       03S0253
         MVC   DRCD2-5(4,@08),@CC00067                          03S0253
*                 ACCPTR=ACCPTR+2;  /* STEP TO NEXT TOTAL    @Y30LB52*/
@RC00245 AH    ACCPTR,@CH00106                                  03S0254
*               END;                /*                       @Y30LB52*/
*                                                               03S0255
         AH    K,@CH00045                                       03S0255
         CH    K,@CH00099                                       03S0255
         BNH   @DL00244                                         03S0255
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT AND INSERT THE ROW TOTAL                  */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0256
*               CVD(RTOTAL,DECNO);  /* CONVERT BINARY STRING TO 03S0256
*                                      DECIMAL               @ZA00699*/
         LH    @08,RTOTAL                                       03S0256
         CVD   @08,DECNO                                        03S0256
*               DRCDRT=EDITPAT5;    /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DRCDRT(6,CVTPTR),EDITPAT5                        03S0257
*               ED(DRCDRT,DECNO2);  /* CONVERT TO PRINTABLE HEX 03S0258
*                                                            @ZA00699*/
         ED    DRCDRT(6,CVTPTR),DECNO2                          03S0258
*               CALL P1PRINTL;      /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0259
*               GTOTAL=GTOTAL+RTOTAL;/* INCREMENT THE GRAND TOTAL
*                                                            @Y30LB52*/
         LH    @08,GTOTAL                                       03S0260
         AH    @08,RTOTAL                                       03S0260
         STH   @08,GTOTAL                                       03S0260
*             END;                  /*                       @Y30LB52*/
*                                                               03S0261
         AH    I,@CH00045                                       03S0261
@DE00204 LH    @08,MSF                                          03S0261
         L     @04,CNFG0PTR(,CVTPTR)                            03S0261
         SLR   @03,@03                                          03S0261
         IC    @03,LIBSIZS-1(@08,@04)                           03S0261
         CR    I,@03                                            03S0261
         BNH   @DL00204                                         03S0261
*             /*******************************************************/
*             /*                                                     */
*             /* FORMAT AND OUTPUT THE COLUMN TOTAL LINE             */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0262
*             OUTLINE=SKIPTWO;      /* SKIP TWO LINES CC     @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0262
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0262
         MVI   OUTLINE(CVTPTR),C'0'                             03S0262
*             DRCD1='TOTAL';        /* SET ROW CONSTANT      @Y30LB52*/
         MVC   DRCD1(5,CVTPTR),@CC00240                         03S0263
*             DO K=1 TO 8;          /* LOOP THROUGH 8 COLUMNS@Y30LB52
*                                                            @Y30LB52*/
         LA    K,1                                              03S0264
@DL00264 DS    0H                                               03S0265
*               CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO
*                                      DECIMAL               @Y30LB52*/
         LR    @08,K                                            03S0265
         ALR   @08,@08                                          03S0265
         LH    @08,LTOTAL-2(@08)                                03S0265
         CVD   @08,DECNO                                        03S0265
*               DRCD2(K)=EDITPAT3;  /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,K                                            03S0266
         MH    @08,@CH00101                                     03S0266
         ST    @08,@TF00001                                     03S0266
         ALR   @08,CVTPTR                                       03S0266
         MVC   DRCD2-5(4,@08),EDITPAT3                          03S0266
*               ED(DRCD2(K),DECNO1);/* CONVERT TO PRINTABLE HEX 03S0267
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0267
         AL    @08,@TF00001                                     03S0267
         ED    DRCD2-5(4,@08),DECNO1                            03S0267
*             END;                  /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0268
         CH    K,@CH00099                                       03S0268
         BNH   @DL00264                                         03S0268
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0269
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0269
         CVD   @08,DECNO                                        03S0269
*             DRCDRT=EDITPAT5;      /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DRCDRT(6,CVTPTR),EDITPAT5                        03S0270
*             ED(DRCDRT,DECNO2);    /* CONVERT TO PRINTABLE HEX 03S0271
*                                                            @ZA00699*/
         ED    DRCDRT(6,CVTPTR),DECNO2                          03S0271
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0272
*             DCL                                               03S0273
*                                                               03S0273
*               /*****************************************************/
*               /*                                                   */
*               /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND  */
*               /* IS USED FOR INSERTING THE FORMATTED ROW VALUES AND*/
*               /* TOTALS.                                           */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0273
*               1 * DEF(OUTLINE),   /*                       @Y30LB52*/
*                2 * CHAR(10),      /*                       @Y30LB52*/
*                2 ODRC CHAR(3),    /* DRC NUMBER            @Y30LB52*/
*                 3 * CHAR(1),      /*                       @Y30LB52*/
*                 3 ODRCL CHAR(1),  /* LIBRARY NUMBER        @Y30LB52*/
*                 3 ODRCN CHAR(1),  /* DRC NUMBER            @Y30LB52*/
*                2 * CHAR(2),       /*                       @Y30LB52*/
*                2 DRCD1 CHAR(5),   /* TOTAL                 @Y30LB52*/
*                2 * CHAR(1),       /*                       @ZM34326*/
*                2 *(8) CHAR(5),    /*                       @Y30LB52*/
*                 3 DRCD2 CHAR(4),  /* TOTAL                 @ZM34326*/
*                  4 * CHAR(2),     /*                       @ZM34326*/
*                  4 DRCD2L CHAR(1),/* LIBRARY NUMBER        @Y30LB52*/
*                  4 DRCD2R CHAR(1),/* DRD NUMBER            @Y30LB52*/
*                 3 * CHAR(1),      /*                       @ZM34326*/
*                2 * CHAR(1),       /*                       @Y30LB52*/
*                2 DRCDRT CHAR(6);  /* COLUMN TOTAL          @ZA00699*/
*           END;                    /*                       @Y30LB52*/
*       END;                        /*                       @Y30LB52*/
@RF00185 LA    @08,1                                            02S0275
         AH    @08,MSF                                          02S0275
@DE00184 STH   @08,MSF                                          02S0275
         L     @03,CNFG0PTR(,CVTPTR)                            02S0275
         CH    @08,MSFNO(,@03)                                  02S0275
         BNH   @DL00184                                         02S0275
*       DCL                                                     02S0276
*                                                               02S0276
*         /***********************************************************/
*         /*                                                         */
*         /* THIS STRUCTURE DEFINES THE MAIN DRD/DRC ARRAY HEADER.   */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0276
*         1 DRCDRDHD STATIC LOCAL,  /* DRC/DRC CONSTANT HEADER  02S0276
*                                                            @Y30LB52*/
*          2 * CHAR(1) INIT(SKIP3), /* CC                    @Y30LB52*/
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/
*          2 * CHAR(30) INIT('DRC/DRD INTERFACE ERROR COUNTS'),/*
*                                                            @Y30LB52
*                                                            @Y30LB52*/
*          2 * CHAR(21) INIT('              MSF 0  ');/*     @Y30LB52*/
*                                                               01S0277
*       /*************************************************************/
*       /*                                                           */
*       /* THIS CODE GENERATES THE PATH/ERROR ARRAY FOR THE ERRORS   */
*       /* RECORDED IN THE DRC/DRD PATHS.                            */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0277
*                                                               02S0277
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT FORMATS THE HEADER LINES FOR THE    */
*       /* ERRORS BY PATH PORTION OF THE DRD PATH ANALYSIS REPORT.   */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0277
*       LINES=45;                   /* INITIALIZE LINES REMAINING
*                                      COUNT                 @Y30LB52*/
         LA    LINES,45                                         02S0277
*       OUTLINE=NEWPAGE;            /* EJECT THE PAGE        @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0278
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0278
         MVI   OUTLINE(CVTPTR),C'1'                             02S0278
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0279
*       OUTLINE=DRDHEAD;            /* PUT THE PA-DRD HEADER AT TOP
*                                                            @Y30LB52*/
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0280
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0280
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0280
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0281
         BAL   @14,P1PRINTL                                     02S0281
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THROUGH ALL CARTRIDGE STORES IN THE SUBSYSTEM        */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0282
*       DO I=1 TO MSFNO;            /* LIBNO CONTAINS TOTAL CS'S
*                                                            @Y30LB52*/
         LA    I,1                                              02S0282
         B     @DE00282                                         02S0282
@DL00282 DS    0H                                               02S0283
*         IF CSFTOTAL(I)^=0         /* IF NO ERRORS ARE      @Y30LB52*/
*           THEN                                                02S0283
         LR    @08,I                                            02S0283
         ALR   @08,@08                                          02S0283
         L     @04,PAD00PTR(,CVTPTR)                            02S0283
         LH    @08,CSFTOTAL-2(@08,@04)                          02S0283
         LTR   @08,@08                                          02S0283
         BZ    @RF00283                                         02S0283
*           DO;                     /* RECORDED, SKIP THE MSF@Y30LB52*/
*             TOTALS=TOTALS&&TOTALS;/* CLEAR THE TOTALS      @Y30LB52*/
         XC    TOTALS(76),TOTALS                                02S0285
*             IF LINES<10 THEN                                  02S0286
         CH    LINES,@CH00033                                   02S0286
         BNL   @RF00286                                         02S0286
*               DO;                 /* IF LESS THAN 10 LINES REMAIN
*                                                            @Y30LB52*/
*                 OUTLINE=NEWPAGE;  /* EJECT THE PAGE        @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0288
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0288
         MVI   OUTLINE(CVTPTR),C'1'                             02S0288
*                 CALL P1PRINTL;    /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0289
*                 OUTLINE=DRDHEAD;  /* ANOTHER HEADER        @Y30LB52*/
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0290
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0290
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0290
*                 CALL P1PRINTL;    /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0291
*                 LINES=45;         /* INIT LINES REMAINING COUNT
*                                                            @Y30LB52*/
         LA    LINES,45                                         02S0292
*               END;                /*                       @Y30LB52*/
*                                                               02S0293
*             /*******************************************************/
*             /*                                                     */
*             /* FORMAT THE HEADER FOR THE INDIVIDUAL CARTRIDGE STORE*/
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0294
*             OUTLINE=PATHEAD;      /* HEADER LINE           @Y30LB52*/
@RF00286 MVI   OUTLINE+57(CVTPTR),C' '                          02S0294
         MVC   OUTLINE+58(75,CVTPTR),OUTLINE+57(CVTPTR)         02S0294
         MVC   OUTLINE(57,CVTPTR),PATHEAD                       02S0294
*             OUTLINE(55)=(I-1)×'0';/* CS NUMBER INTO HEADER @Y30LB52*/
         LR    @08,I                                            02S0295
         BCTR  @08,0                                            02S0295
         O     @08,@CF00073                                     02S0295
         STC   @08,OUTLINE+54(,CVTPTR)                          02S0295
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0296
*             OUTLINE=PATHEAD1;     /* FIRST COLUMN HEADER   @Y30LB52*/
         MVI   OUTLINE+101(CVTPTR),C' '                         02S0297
         MVC   OUTLINE+102(31,CVTPTR),OUTLINE+101(CVTPTR)       02S0297
         MVC   OUTLINE(101,CVTPTR),PATHEAD1                     02S0297
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0298
*             OUTLINE=SKIPONE;      /* SECOND COLUMN HEADER  @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0299
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0299
         MVI   OUTLINE(CVTPTR),C' '                             02S0299
*             E1='ERROR';           /*                       @Y30LB52*/
         MVC   E1(5,CVTPTR),@CC00383                            02S0300
*             E2='ERROR';           /*                       @Y30LB52*/
         MVC   E2(5,CVTPTR),@CC00383                            02S0301
*             E3='ERROR';           /*                       @Y30LB52*/
         MVC   E3(5,CVTPTR),@CC00383                            02S0302
*             CALL P1PRINTL;        /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0303
*             LINES=LINES-6;        /* DECREMNT LINES PRINTED@Y30LB52*/
*                                                               02S0304
         SH    LINES,@CH00058                                   02S0304
*             /*******************************************************/
*             /*                                                     */
*             /* THE FOLLOWING CODE FORMATS AND PRINTS THE VALUE     */
*             /* LINES OF THE REPORT SECTION.                        */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0305
*                                                               03S0305
*             /*******************************************************/
*             /*                                                     */
*             /* THIS SEGMENT FORMATS AND PRINTS THE LINES OF THE    */
*             /* ARRAY                                        SHOWING*/
*             /* ERRORS BY PATHS FOR THE DRC/DRD PORTION OF THE PATH */
*             /* ANALYSIS REPORT. ON ENTRY, THE VARIABLE 'I' CONTAINS*/
*             /* THE LIBRARY NUMBER TO BE REPORTED.                  */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0305
*             DO SAP=1 TO SANO;     /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    SAP,1                                            03S0305
         B     @DE00305                                         03S0305
@DL00305 DS    0H                                               03S0306
*               OUTLINE=SKIPTWO;    /* SET SKIP ONE BLANK LINE  03S0306
*                                                            @ZM34326*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0306
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0306
         MVI   OUTLINE(CVTPTR),C'0'                             03S0306
*               LTPDRDP=LTPAD+((I-1)*LENGTH(LTPDRDTB));/* SET LTP
*                                      POINTER FOR CS        @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0307
         LR    @07,I                                            03S0307
         BCTR  @07,0                                            03S0307
         SLA   @07,3                                            03S0307
         AL    @07,LTPAD(,@08)                                  03S0307
         ST    @07,LTPDRDP                                      03S0307
*               DO DRCP=1 TO LIBSIZS(I);/* LOOP THROUGH DRC'S   03S0308
*                                                            @Y30LB52*/
         LA    @08,1                                            03S0308
         B     @DE00308                                         03S0308
@DL00308 DS    0H                                               03S0309
*                 DO J=1 TO 2 WHILE(LTPDRC(DRCP,J)^='FF'X);/* LOOP
*                                      THROUGH TWO POSSIBLE SA  03S0309
*                                      CONNECTIONS           @Y30LB52*/
         LA    @08,1                                            03S0309
         ST    @08,J                                            03S0309
@DL00309 L     @07,LTPDRDP                                      03S0309
         LH    @04,DRCP                                         03S0309
         ALR   @04,@04                                          03S0309
         ALR   @04,@08                                          03S0309
         ST    @04,@TF00001                                     03S0309
         ALR   @04,@07                                          03S0309
         AL    @04,@CF00662                                     03S0309
         CLI   LTPDRC(@04),X'FF'                                03S0309
         BE    @DC00309                                         03S0309
*                   K=LTPDRC(DRCP,J);/* LOAD THE SA/LOGICAL DRC BYTE
*                                                            @Y30LB52*/
         L     @08,@TF00001                                     03S0310
         AL    @07,@CF00662                                     03S0310
         SLR   K,K                                              03S0310
         IC    K,LTPDRC(@08,@07)                                03S0310
*                   DRC=K&'0F'X;    /* EXTRACT THE DRC NUMBER@Y30LB52
*                                                            @Y30LB52*/
         LA    @08,15                                           03S0311
         NR    @08,K                                            03S0311
         STH   @08,DRC                                          03S0311
*                   K=K/16+1;       /* EXTRACT THE SA INDEX  @Y30LB52*/
         LA    @08,1                                            03S0312
         LR    @07,K                                            03S0312
         SRL   @07,4                                            03S0312
         ALR   @07,@08                                          03S0312
         LR    K,@07                                            03S0312
*                   IF SAP=K        /* IF THIS IS THE SA BEING  03S0313
*                                      PROCESSED             @Y30LB52*/
*                     THEN                                      03S0313
         CR    SAP,K                                            03S0313
         BNE   @RF00313                                         03S0313
*                     DO;           /* FORMAT AND PRINT THE VALUE
*                                      LINE                  @Y30LB52*/
*                                                               04S0315
*                       /*********************************************/
*                       /*                                           */
*                       /* THIS SEGMENT OF CODE LOOPS THROUGH ALL    */
*                       /* POSSIBLE PATHS LOOKING FOR ACCUMULATED    */
*                       /* ERRORS WITH THE SA AND DRC SELECTED ABOVE.*/
*                       /* IN THE PATHS WHERE ERRORS HAVE BEEN       */
*                       /* RECORDED, THE THE DEVICES IN THE PATH ARE */
*                       /* INSERTED INTO THE OUTPUT LINE WITH THE    */
*                       /* ERROR COUNTS AND THE LINE PRINTED.        */
*                       /*                                           */
*                       /*********************************************/
*                                                               04S0315
*                       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/*
*                                                            @Y30LB52
*                                      LOOP THROUGH ALL MSC'S WITH
*                                      ERRORS RECORDED       @Y30LB52*/
         STH   @08,MSC                                          04S0315
@DL00315 SLA   @08,3                                            04S0315
         L     @07,PAD00PTR(,CVTPTR)                            04S0315
         ST    @08,@TF00001                                     04S0315
         ALR   @08,@07                                          04S0315
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0315
         BE    @DC00315                                         04S0315
*                         IF SATABPTR(MSC)^=0/* LOWER PATHS DEFINED?
*                                                            @Y30LB52*/
*                           THEN                                04S0316
         SLR   @08,@08                                          04S0316
         L     @04,@TF00001                                     04S0316
         L     @07,SATABPTR-8(@04,@07)                          04S0316
         CR    @07,@08                                          04S0316
         BE    @RF00316                                         04S0316
*                           DO;     /*                       @Y30LB52*/
         ST    @07,@TF00001                                     04S0317
*                             SATABP=SATABPTR(MSC);/* LOAD THE SATAB
*                                      ADDRESS@Y30LB52       @Y30LB52*/
         L     SATABP,@TF00001                                  04S0318
*                             RESPECIFY                         04S0319
*                               SADRDDSD BASED(SATABP);/*    @Y30LB52*/
*                             IF SADRDACC(SAP)^=0/* NON-ZERO POINTER
*                                                            @Y30LB52*/
*                               THEN                            04S0320
         LR    @04,SAP                                          04S0320
         SLA   @04,3                                            04S0320
         AL    @04,@CF00660                                     04S0320
         L     @04,SADRDACC(@04,SATABP)                         04S0320
         CR    @04,@08                                          04S0320
         BE    @RF00320                                         04S0320
*                               DO; /* INDICATES ERRORS IN SA'S PATH
*                                                            @Y30LB52*/
*                                 DRDACCP=SADRDACC(SAP);/* LOAD THE
*                                      ACCUMULATOR ADDRESS   @Y30LB52*/
         ST    @04,DRDACCP                                      04S0322
*                                 DO K=1 TO 4;/* LOOP THROUGH 4 04S0323
*                                      LOGICAL DRD'S         @Y30LB52*/
         LA    K,1                                              04S0323
@DL00323 DS    0H                                               04S0324
*                                   RESPECIFY                   04S0324
*                                     DRDACCTB BASED(DRDACCP);/*
*                                                            @Y30LB52*/
*                                   IF DRDACCTB(DRC,K)^='000000000000'X
*                                   /* NON-ZERO ERROR COUNTS @Y30LB52*/
*                                     THEN                      04S0325
         L     @08,DRDACCP                                      04S0325
         LH    @07,DRC                                          04S0325
         SLA   @07,2                                            04S0325
         ALR   @07,K                                            04S0325
         MH    @07,@CH00058                                     04S0325
         ST    @07,@TF00001                                     04S0325
         ALR   @07,@08                                          04S0325
         AL    @07,@CF00664                                     04S0325
         CLC   DRDACCTB(6,@07),@CB00313                         04S0325
         BE    @RF00325                                         04S0325
*                                    DO;/* PRODUCE AN OUTPUT    04S0326
*                                      LINE@Y30LB52          @Y30LB52*/
*                                     OUTLINE=SKIPONE;/* SKIP 1 LINE
*                                      CC                    @Y30LB52*/
*                                                               04S0327
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0327
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0327
         MVI   OUTLINE(CVTPTR),C' '                             04S0327
*                                     /*******************************/
*                                     /*                             */
*                                     /* FORMAT THE MSC ADDRESS      */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0328
*                                     UNPK(DECNO(1:4),MSCDRDAC(MSC,1:3)
*                                         );/* UNPACK THE HEX STRING
*                                      PLUS ONE BYTE         @Y30LB52*/
         LH    @07,MSC                                          04S0328
         SLA   @07,3                                            04S0328
         L     @01,PAD00PTR(,CVTPTR)                            04S0328
         ALR   @01,@07                                          04S0328
         UNPK  DECNO(4),MSCDRDAC-8(3,@01)                       04S0328
*                                     MSC4=DECNO(1:3)&'0F0F0F'X;/*
*                                      TURN OFF THE ZONES    @Y30LB52*/
         MVC   MSC4(3,CVTPTR),DECNO                             04S0329
         NC    MSC4(3,CVTPTR),@CB00250                          04S0329
*                                     TR(MSC4,TRTAB);/* TRANSLATE TO
*                                      PRINTABLE@Y30LB52 HEXADECIMAL
*                                      CHARACTERS            @Y30LB52*/
*                                                               04S0330
         TR    MSC4(3,CVTPTR),TRTAB                             04S0330
*                                     /*******************************/
*                                     /*                             */
*                                     /* FORMAT THE SA SSID          */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0331
*                                     SA4='800';/* SA SSID   @Y30LB52*/
         MVC   SA4(3,CVTPTR),@CC00390                           04S0331
*                                     SA44=SA44×(SAP-1);/* OR IN THE
*                                      SA INDEX              @Y30LB52*/
*                                                               04S0332
         LR    @07,SAP                                          04S0332
         BCTR  @07,0                                            04S0332
         SLR   @15,@15                                          04S0332
         IC    @15,SA44(,CVTPTR)                                04S0332
         OR    @07,@15                                          04S0332
         STC   @07,SA44(,CVTPTR)                                04S0332
*                                     /*******************************/
*                                     /*                             */
*                                     /* FORMAT THE DRC SSID         */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0333
*                                     DRC4='400';/* DRC SSID @Y30LB52*/
         MVC   DRC4(3,CVTPTR),@CC00316                          04S0333
*                                     DRC44=DRC44×(I-1);/* CS INDEX
*                                                            @Y30LB52*/
         LR    @07,I                                            04S0334
         BCTR  @07,0                                            04S0334
         SLR   @15,@15                                          04S0334
         IC    @15,DRC44(,CVTPTR)                               04S0334
         OR    @07,@15                                          04S0334
         STC   @07,DRC44(,CVTPTR)                               04S0334
*                                     DRC444=DRC444×(DRCP-1);/* OR IN
*                                      THE DRC INDEX         @Y30LB52*/
*                                                               04S0335
         LH    @07,DRCP                                         04S0335
         BCTR  @07,0                                            04S0335
         SLR   @15,@15                                          04S0335
         IC    @15,DRC444(,CVTPTR)                              04S0335
         OR    @15,@07                                          04S0335
         STC   @15,DRC444(,CVTPTR)                              04S0335
*                                     /*******************************/
*                                     /*                             */
*                                     /* FORMAT THE DRD SSID         */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0336
*                                     DRD4='200';/* DRD SSID @Y30LB52*/
         MVC   DRD4(3,CVTPTR),@CC00396                          04S0336
*                                     DRD44=DRC44;/* CS NUMBER  04S0337
*                                                            @Y30LB52*/
*                                                               04S0337
         MVC   DRD44(1,CVTPTR),DRC44(CVTPTR)                    04S0337
*                                     /*******************************/
*                                     /*                             */
*                                     /* THE PHYSICAL DRD NUMBER IS  */
*                                     /* TAKEN FROM A CONSTANT TABLE */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0338
*                                     DRDSPTR=MSFAN(LIBSIZS(I))+(DRCP-1
*                                         )*4;/* LOAD PROPER CONSTANT
*                                      TABLE ADDRESS         @Y30LB52*/
         L     @01,CNFG0PTR(,CVTPTR)                            04S0338
         SLR   @15,@15                                          04S0338
         IC    @15,LIBSIZS-1(I,@01)                             04S0338
         SLA   @15,2                                            04S0338
         SLA   @07,2                                            04S0338
         AL    @07,MSFAN-4(@15)                                 04S0338
         ST    @07,DRDSPTR                                      04S0338
*                                     DRD444=DRD444×DRDS(K);/* INSERT
*                                      PHYSICAL DRD NUMBER INTO THE
*                                      SSID                  @Y30LB52*/
*                                                               04S0339
         SLR   @15,@15                                          04S0339
         IC    @15,DRD444(,CVTPTR)                              04S0339
         AL    @07,@CF00663                                     04S0339
         SLR   @14,@14                                          04S0339
         IC    @14,DRDS(K,@07)                                  04S0339
         OR    @15,@14                                          04S0339
         STC   @15,DRD444(,CVTPTR)                              04S0339
*                                     /*******************************/
*                                     /*                             */
*                                     /* THE FOLLOWING INCLUDED      */
*                                     /* SEGMENT FORMATS AND INSERTS */
*                                     /* THE THREE ERROR COUNTS FOR  */
*                                     /* THIS PATH INTO THE OUTPUT   */
*                                     /* LINE.                       */
*                                     /*                             */
*                                     /*******************************/
*                                                               04S0340
*                                                               05S0340
*                                     /*******************************/
*                                     /*                             */
*                                     /* THIS SEGMENT OF CODE FORMATS*/
*                                     /* AND INSERTS THE THREE ERROR */
*                                     /* VALUES INTO THE OUTPUT LINE.*/
*                                     /*                             */
*                                     /*******************************/
*                                                               05S0340
*                                     DRDACCE=ADDR(DRDACCTB(DRC,K));
         L     @07,@TF00001                                     05S0340
         AL    @08,@CF00664                                     05S0340
         LA    @08,DRDACCTB(@07,@08)                            05S0340
         ST    @08,DRDACCE                                      05S0340
*                                     /* ADDRESS THREE ERROR @Y30LB52
*                                      ACCUMULATORS          @Y30LB52*/
*                                     RESPECIFY                 05S0341
*                                       DRDACC BASED(DRDACCE);/*
*                                                            @Y30LB52*/
*                                     RTOTAL=0;/* CLEAR TOW TOTAL
*                                                            @Y30LB52*/
         SLR   @08,@08                                          05S0342
         STH   @08,RTOTAL                                       05S0342
*                                     DO L=1 TO 3;/* LOOP THROUGH
*                                      THREE ERROR TYPES     @Y30LB52*/
         LA    L,1                                              05S0343
@DL00343 DS    0H                                               05S0344
*                                      RTOTAL=RTOTAL+DRDACC;/*  05S0344
*                                      INCREMENT ROW TOTAL   @Y30LB52*/
         L     @08,DRDACCE                                      05S0344
         LH    @15,DRDACC(,@08)                                 05S0344
         LH    @14,RTOTAL                                       05S0344
         ALR   @14,@15                                          05S0344
         STH   @14,RTOTAL                                       05S0344
*                                      LTOTAL(L)=LTOTAL(L)+DRDACC;/*
*                                      INCREENT THE COLUMN TOTAL
*                                                            @Y30LB52*/
         LR    @14,L                                            05S0345
         ALR   @14,@14                                          05S0345
         LH    @01,LTOTAL-2(@14)                                05S0345
         ALR   @01,@15                                          05S0345
         STH   @01,LTOTAL-2(@14)                                05S0345
*                                      CVD(DRDACC,DECNO);/* CONVERT
*                                      BINARY STRING TO DECIMAL 05S0346
*                                                            @ZA00699*/
         CVD   @15,DECNO                                        05S0346
*                                      OERR(L)=EDITPAT5;/* 5 DIGIT
*                                      EDIT PATTERN          @ZA00699*/
         LR    @15,L                                            05S0347
         MH    @15,@CH00033                                     05S0347
         ST    @15,@TF00001                                     05S0347
         ALR   @15,CVTPTR                                       05S0347
         MVC   OERR-10(6,@15),EDITPAT5                          05S0347
*                                      ED(OERR(L),DECNO2);/* CONVERT
*                                      TO PRINTABLE HEX      @ZA00699*/
         LR    @01,CVTPTR                                       05S0348
         AL    @01,@TF00001                                     05S0348
         ED    OERR-10(6,@01),DECNO2                            05S0348
*                                      DRDACCE=DRDACCE+2;/* STEP TO
*                                      NEXT ERROR COUNT      @Y30LB52*/
         AH    @08,@CH00106                                     05S0349
         ST    @08,DRDACCE                                      05S0349
*                                     END;/*                 @Y30LB52*/
         AH    L,@CH00045                                       05S0350
         CH    L,@CH00103                                       05S0350
         BNH   @DL00343                                         05S0350
*                                     GTOTAL=RTOTAL+GTOTAL;/*   05S0351
*                                      INCREMNT THE GRAND TOTAL 05S0351
*                                                            @Y30LB52*/
*                                                               05S0351
         LH    @08,RTOTAL                                       05S0351
         LH    @07,GTOTAL                                       05S0351
         ALR   @07,@08                                          05S0351
         STH   @07,GTOTAL                                       05S0351
*                                     /*******************************/
*                                     /*                             */
*                                     /* INSERT THE ROW TOTAL INTO   */
*                                     /* THE OUTPUT LINE             */
*                                     /*                             */
*                                     /*******************************/
*                                                               05S0352
*                                     CVD(RTOTAL,DECNO);/* CONVERT
*                                      BINARY STRING TO DECIMAL 05S0352
*                                                            @ZA00699*/
         CVD   @08,DECNO                                        05S0352
*                                     OPTOT=EDITPAT5;/* 5 DIGIT EDIT
*                                      PATTERN               @ZA00699*/
         MVC   OPTOT(6,CVTPTR),EDITPAT5                         05S0353
*                                     ED(OPTOT,DECNO2);/* CONVERT TO
*                                      PRINTABLE HEX         @ZA00699*/
*                                                               05S0354
         ED    OPTOT(6,CVTPTR),DECNO2                           05S0354
*                                     /*******************************/
*                                     /*                             */
*                                     /* INSERT THE PERCENTAGE OF    */
*                                     /* TOTAL COLUMN ENTRY          */
*                                     /*                             */
*                                     /*******************************/
*                                                               05S0355
*                                     RTOTAL=RTOTAL*1000/CSFTOTAL(I);
         MH    @08,@CH00402                                     05S0355
         LR    @07,I                                            05S0355
         ALR   @07,@07                                          05S0355
         L     @01,PAD00PTR(,CVTPTR)                            05S0355
         LR    @14,@08                                          05S0355
         SRDA  @14,32                                           05S0355
         LH    @08,CSFTOTAL-2(@07,@01)                          05S0355
         DR    @14,@08                                          05S0355
         STH   @15,RTOTAL                                       05S0355
*                                     /* CALCULATE PERCENT   @ZM34326*/
*                                     CVD(RTOTAL,DECNO);/* CONVERT TO
*                                      DECIAML               @ZM34326*/
         CVD   @15,DECNO                                        05S0356
*                                     OPCNT=EDITPATP;/* MOVE PERCENT
*                                      PATTERN               @ZM34326*/
         MVC   OPCNT(7,CVTPTR),EDITPATP                         05S0357
*                                     ED(OPCNT,DECNO2);/* EDIT  05S0358
*                                      PERCENTAGE            @ZM34326*/
         ED    OPCNT(7,CVTPTR),DECNO2                           05S0358
*                                                               05S0359
*                                     /*******************************/
*                                     /*                             */
*                                     /* THE FOLLOWING STRUCTURE MAPS*/
*                                     /* THE OUTPUT ONE FOR THE      */
*                                     /* PURPOSE OF INSERTING THE    */
*                                     /* THREE ERROR COUNTS FOR A    */
*                                     /* PATH AND THE ROW TOTAL.     */
*                                     /*                             */
*                                     /*******************************/
*                                                               05S0359
*                                     DCL                       05S0359
*                                       1 * DEF(OUTLINE),/*  @Y30LB52*/
*                                        2 * CHAR(44),/*     @Y30LB52*/
*                                        2 OPTOTAL CHAR(5),/*   05S0359
*                                      CONSTANT 'TOTAL'      @Y30LB52*/
*                                        2 * CHAR(3),/*      @ZA00699*/
*                                        2 *(3) CHAR(10),/*  @Y30LB52*/
*                                         3 OERR CHAR(6),/* EBCDIC
*                                      ERROR COUNT           @ZA00699*/
*                                         3 * CHAR(4),/*     @ZA00699*/
*                                        2 * CHAR(2),/*      @ZA00699*/
*                                        2 OPTOT CHAR(6),/* ROW TOTAL
*                                                            @ZA00699*/
*                                        2 * CHAR(3),/*      @ZA00699*/
*                                        2 OPCNT CHAR(7);/* ERROR
*                                      PERCENTAGE            @ZM34326*/
*                                     LINES=LINES-1;/* INCREMENT
*                                      LINES PRINTED         @Y30LB52*/
         BCTR  LINES,0                                          04S0360
*                                     CALL P1PRINTL;/* PRINT THE LINE
*                                                            @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0361
*                                     OUTLINE=SKIPONE;/* RESET SINGLE
*                                      SKIP                  @ZM34326*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0362
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0362
         MVI   OUTLINE(CVTPTR),C' '                             04S0362
*                                    END;/*                  @Y30LB52*/
*                                 END;/*                     @Y30LB52*/
@RF00325 AH    K,@CH00045                                       04S0364
         CH    K,@CH00055                                       04S0364
         BNH   @DL00323                                         04S0364
*                               END;/*                       @Y30LB52*/
*                           END;    /*                       @Y30LB52*/
@RF00320 DS    0H                                               04S0367
*                       END;        /*                       @Y30LB52*/
@RF00316 LA    @08,1                                            04S0367
         AH    @08,MSC                                          04S0367
         STH   @08,MSC                                          04S0367
         CH    @08,@CH00099                                     04S0367
         BNH   @DL00315                                         04S0367
@DC00315 DS    0H                                               04S0368
*                                                               04S0368
*                       /*********************************************/
*                       /*                                           */
*                       /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT   */
*                       /* LINE FOR THE PURPOSE OF STORING THE EBCDIC*/
*                       /* UNIT ADDRESS AND SSID'S FOR A PATH IN THE */
*                       /* PATH REPORT.                              */
*                       /*                                           */
*                       /*********************************************/
*                                                               04S0368
*                       DCL                                     04S0368
*                         1 * DEF(OUTLINE),/*                @Y30LB52*/
*                          2 * CHAR(4),/*                    @Y30LB52*/
*                          2 MSC4 CHAR(3),/* MSC SSID        @Y30LB52*/
*                          2 * CHAR(2),/*                    @Y30LB52*/
*                          2 SA4 CHAR(3),/* SA SSID          @Y30LB52*/
*                           3 * CHAR(1),/*                   @Y30LB52*/
*                           3 SA44 CHAR(1),/* SA NUMBER      @Y30LB52*/
*                           3 * CHAR(1),/*                   @Y30LB52*/
*                          2 * CHAR(6),/*                    @Y30LB52*/
*                          2 DRC4 CHAR(3),/* DRC SSID        @Y30LB52*/
*                           3 * CHAR(1),/*                   @Y30LB52*/
*                           3 DRC44 CHAR(1),/* CS NUMBER     @Y30LB52*/
*                           3 DRC444 CHAR(1),/* DRC NUMBER   @Y30LB52*/
*                          2 * CHAR(11),/*                   @Y30LB52*/
*                          2 DRD4 CHAR(3),/* DRD SSID        @Y30LB52*/
*                           3 * CHAR(1),/*                   @Y30LB52*/
*                           3 DRD44 CHAR(1),/* CS NUMBER     @Y30LB52*/
*                           3 DRD444 CHAR(1);/* DRD NUMBER   @Y30LB52*/
*                     END;          /*                       @Y30LB52*/
*                 END;              /*                       @Y30LB52*/
@RF00313 LA    @08,1                                            03S0370
         AL    @08,J                                            03S0370
         ST    @08,J                                            03S0370
         CH    @08,@CH00106                                     03S0370
         BNH   @DL00309                                         03S0370
@DC00309 DS    0H                                               03S0371
*               END;                /*                       @Y30LB52*/
         LA    @08,1                                            03S0371
         AH    @08,DRCP                                         03S0371
@DE00308 STH   @08,DRCP                                         03S0371
         L     @07,CNFG0PTR(,CVTPTR)                            03S0371
         SLR   @04,@04                                          03S0371
         IC    @04,LIBSIZS-1(I,@07)                             03S0371
         CR    @08,@04                                          03S0371
         BNH   @DL00308                                         03S0371
*             END;                  /*                       @Y30LB52*/
*                                                               03S0372
         AH    SAP,@CH00045                                     03S0372
@DE00305 L     @08,CNFG0PTR(,CVTPTR)                            03S0372
         CH    SAP,SANO(,@08)                                   03S0372
         BNH   @DL00305                                         03S0372
*             /*******************************************************/
*             /*                                                     */
*             /* FORMAT AND OUTPUT THE TOTALS LINE.                  */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0373
*             LINES=LINES-4;        /* INCREMENT LINES PRINTED  03S0373
*                                                            @Y30LB52*/
         SH    LINES,@CH00055                                   03S0373
*             OUTLINE=SKIPTWO;      /* SKIP TWO LINES        @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0374
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0374
         MVI   OUTLINE(CVTPTR),C'0'                             03S0374
*             OPTOTAL='TOTAL';      /* SET ROW TOTAL CONSTANT@Y30LB52
*                                                            @Y30LB52*/
         MVC   OPTOTAL(5,CVTPTR),@CC00240                       03S0375
*             DO K=1 TO 3;          /* LOOP THROUGH THREE ERROR 03S0376
*                                      COUNTS                @Y30LB52*/
         LA    K,1                                              03S0376
@DL00376 DS    0H                                               03S0377
*               CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO
*                                      DECIMAL               @ZA00699*/
         LR    @08,K                                            03S0377
         ALR   @08,@08                                          03S0377
         LH    @08,LTOTAL-2(@08)                                03S0377
         CVD   @08,DECNO                                        03S0377
*               OERR(K)=EDITPAT5;   /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         LR    @08,K                                            03S0378
         MH    @08,@CH00033                                     03S0378
         ST    @08,@TF00001                                     03S0378
         ALR   @08,CVTPTR                                       03S0378
         MVC   OERR-10(6,@08),EDITPAT5                          03S0378
*               ED(OERR(K),DECNO2); /* CONVERT TO PRINTABLE HEX 03S0379
*                                                            @ZA00699*/
         LR    @08,CVTPTR                                       03S0379
         AL    @08,@TF00001                                     03S0379
         ED    OERR-10(6,@08),DECNO2                            03S0379
*             END;                  /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0380
         CH    K,@CH00103                                       03S0380
         BNH   @DL00376                                         03S0380
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0381
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0381
         CVD   @08,DECNO                                        03S0381
*             OPTOT=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   OPTOT(6,CVTPTR),EDITPAT5                         03S0382
*             ED(OPTOT,DECNO2);     /* CONVERT TO PRINTABLE HEX 03S0383
*                                                            @ZA00699*/
         ED    OPTOT(6,CVTPTR),DECNO2                           03S0383
*             CALL P1PRINTL;        /* PRINT THE TOTALS LINE @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0384
*           END;                    /*                       @Y30LB52*/
*       END;                        /*                       @Y30LB52*/
@RF00283 AH    I,@CH00045                                       02S0386
@DE00282 L     @08,CNFG0PTR(,CVTPTR)                            02S0386
         CH    I,MSFNO(,@08)                                    02S0386
         BNH   @DL00282                                         02S0386
*                                                               02S0387
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING IS THE MAIN PATH SECTION HEADER.            */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0387
*       DCL                                                     02S0387
*         1 PATHEAD STATIC LOCAL,   /* CONSTANT PATH HEAD    @Y30LB52*/
*          2 * CHAR(1) INIT('-'),   /*                       @Y30LB52*/
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/
*          2 * CHAR(53) INIT(                                   02S0387
*                'ERROR COUNTS BY REAL DEVICE PATH              MSF 0
*                ),                                             02S0387
*                                                               02S0387
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING STRUCTURE IS THE FIRST LINE OF THE COLUMN */
*         /* HEADER.                                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0387
*         1 PATHEAD1 STATIC LOCAL,  /* PATH CONSTANT HEADER  @Y30LB52*/
*          2 * CHAR(1) INIT('-'),   /* SKIP TWO CC           @Y30LB52*/
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/
*          2 * CHAR(3) INIT('MSC'), /*                       @Y30LB52*/
*          2 * CHAR(2) INIT('  '),  /*                       @Y30LB52*/
*          2 * CHAR(2) INIT('SA'),  /*                       @Y30LB52*/
*          2 * CHAR(7) INIT(' '),   /*                       @Y30LB52*/
*          2 * CHAR(3) INIT('DRC'), /*                       @Y30LB52*/
*          2 * CHAR(11) INIT(' '),  /*                       @Y30LB52*/
*          2 * CHAR(19) INIT('DRD'),/*                       @Y30LB52*/
*          2 * CHAR(40) INIT(' DRD UNIT  CTL-I ADT  DRC UNIT     TOTAL'
*                ),                 /*                       @ZA00699*/
*          2 * CHAR(10) INIT('    %ERROR'),/*                @ZA00699*/
*                                                               02S0387
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND IS USED*/
*         /* TO INSERT THE SECOND LINE OF THE COLUMN HEADER.         */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0387
*         1 * DEF(OUTLINE),         /*                       @Y30LB52*/
*          2 * CHAR(54),            /*                       @Y30LB52*/
*          2 E1 CHAR(5),            /*                       @Y30LB52*/
*          2 * CHAR(5),             /*                       @Y30LB52*/
*          2 E2 CHAR(5),            /*                       @Y30LB52*/
*          2 * CHAR(5),             /*                       @Y30LB52*/
*          2 E3 CHAR(5);            /*                       @Y30LB52*/
*     END;                          /*                       @Y30LB52*/
*   DASD='1'B;                      /*                       @Y30LB52*/
*                                                               01S0389
@RF00084 OI    DASD,B'10000000'                                 01S0389
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE MSC/SA PORTION OF*/
*   /* THE PATH ANALYSIS REPORT(3330).                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0390
*                                                               02S0390
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE FORMATS THE CONSTANT HEADERS FOR THE     */
*   /* MSC/SA PORTION OF THE PATH ANALYSIS REPORT(DASD).             */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0390
*   OUTLINE=NEWPAGE;                /* START NEW REPORT PAGE @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0390
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0390
         MVI   OUTLINE(CVTPTR),C'1'                             02S0390
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0391
*   OUTLINE=DASDHEAD;               /* PA DASD HEADER        @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0392
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0392
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0392
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0393
*   OUTLINE=MSCSAHD;                /* FIXED MSC/SA HEADER   @Y30LB52*/
         MVI   OUTLINE+33(CVTPTR),C' '                          02S0394
         MVC   OUTLINE+34(99,CVTPTR),OUTLINE+33(CVTPTR)         02S0394
         MVC   OUTLINE(33,CVTPTR),MSCSAHD                       02S0394
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0395
*   OUTLINE=SAHD;                   /* FIXED SA COLUMN HEADER@Y30LB52*/
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0396
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0396
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0396
*   CALL P1PRINTL;                  /* PRINT                 @Y30LB52*/
*                                                               02S0397
         BAL   @14,P1PRINTL                                     02S0397
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FIXED COLUMN HEADER LINE IMMEDIATELY BEFORE THE VALUE  */
*   /* ARRAY.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0398
*   OUTLINE=SKIPONE;                /* SKIP ONE LINE CC      @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0398
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0398
         MVI   OUTLINE(CVTPTR),C' '                             02S0398
*   COLUMN1='MSC';                  /* MSC COLUM HEAD        @Y30LB52*/
         MVC   COLUMN1(3,CVTPTR),@CC00238                       02S0399
*   COLTOTAL='TOTAL';               /* TOTAL COLUMN HEAD     @Y30LB52*/
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0400
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/
*                                                               02S0401
         BAL   @14,P1PRINTL                                     02S0401
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS A PRINTS THE VALUES FOR*/
*   /* THE MSC/SA ARRAY.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0402
*   CALL P1MSCSAV;                  /* CALL THE MSC/SA VALUE ROUTINE
*                                                            @Y30LB52*/
         BAL   @14,P1MSCSAV                                     02S0402
*                                                               02S0403
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING IS A MAP OF THE FIXED DASD HEADER TO BE MOVED   */
*   /* INTO THE OUTPUT BUFFER FOR PRINTING.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0403
*   DCL                                                         02S0403
*     1 DASDHEAD STATIC LOCAL,      /*                       @Y30LB52*/
*      2 * CHAR(1) INIT('0'),       /* SKIP TWO CC           @Y30LB52*/
*      2 * CHAR(35) INIT('REPORT 6 - PATH ANALYSIS REPORT OF '),
*      2 * CHAR(22) INIT('EQUIPMENT CHECKS(3330)');/*        @ZM30730*/
*                                                               01S0404
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE         */
*   /* CHANNEL/SA PORTION OF THE PATH ANALYSIS REPORT(3330).         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0404
*   IF CHCUAD^=0                    /* IF CHAN/CU ARE DEFINED   01S0404
*                                                            @Y30LB52*/
*     THEN                                                      01S0404
         L     @08,CNFG0PTR(,CVTPTR)                            01S0404
         ICM   @03,15,CHCUAD(@08)                               01S0404
         BZ    @RF00404                                         01S0404
*     DO;                           /* OUTPUT CH/SA ARRAY    @Y30LB52*/
*                                                               02S0406
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT OF CODE FORMATS AND PRINTS THE FIXED*/
*       /* HEADER PORTION OF THE CHANNEL/SA ARRAY IN THE PATH        */
*       /* ANALYSIS REPORT(DASD).                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0406
*       OUTLINE=CHSAHEAD;           /* FIXED ARRAY HEADER    @Y30LB52*/
         MVI   OUTLINE+37(CVTPTR),C' '                          02S0406
         MVC   OUTLINE+38(95,CVTPTR),OUTLINE+37(CVTPTR)         02S0406
         MVC   OUTLINE(37,CVTPTR),CHSAHEAD                      02S0406
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0407
*       OUTLINE=SAHD;               /* STANDARD SA COLUMN HEADER
*                                                            @Y30LB52*/
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0408
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0408
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0408
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
*                                                               02S0409
         BAL   @14,P1PRINTL                                     02S0409
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT FIRST LINE OF THE FIXED CH/SA COLUMN HEADER        */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0410
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0410
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0410
         MVI   OUTLINE(CVTPTR),C' '                             02S0410
*       CHSAHD='CHANNEL';           /* CHANNEL INTERFACE HEAD@Y30LB52*/
         MVI   CHSAHD+7(CVTPTR),C' '                            02S0411
         MVI   CHSAHD+8(CVTPTR),C' '                            02S0411
         MVC   CHSAHD(7,CVTPTR),@CC00465                        02S0411
*       CHSAHD1='TOTAL';            /* TOTAL COLUMN HEAD     @Y30LB52*/
         MVC   CHSAHD1(5,CVTPTR),@CC00240                       02S0412
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
*                                                               02S0413
         BAL   @14,P1PRINTL                                     02S0413
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT THE SECOND LINE OF THE FIXED COLUMN HEADER          */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0414
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0414
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0414
         MVI   OUTLINE(CVTPTR),C' '                             02S0414
*       CHSAHD='INTERFACE';         /* CHANNEL INTERFACE HEAD@Y30LB52*/
         MVC   CHSAHD(9,CVTPTR),@CC00467                        02S0415
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
*                                                               02S0416
         BAL   @14,P1PRINTL                                     02S0416
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE VALUES FOR   */
*       /* THIS ARRAY.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0417
*                                                               03S0417
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT OF CODE FORMATS THE VALUE PORTION OF THE     */
*       /* CH/SA ARRAY IN THE PATH ANALYSIS REPORT.                  */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0417
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @Y30LB52*/
         XC    TOTALS(76),TOTALS                                03S0417
*       DO I=1 TO 3;                /* LOOP THROUGH 3 UPPER  @Y30LB52
*                                      INTERFACES            @Y30LB52*/
         LA    I,1                                              03S0418
@DL00418 DS    0H                                               03S0419
*         OUTLINE=SKIPONE;          /* SKIP CC               @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0419
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0419
         MVI   OUTLINE(CVTPTR),C' '                             03S0419
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATOR TOTALS
*                                                            @Y30LB52*/
         XC    ACCUMTOT(32),ACCUMTOT                            03S0420
*         J=SAINTFP;                /* POINT TO FIRST INTERFACE 03S0421
*                                                            @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0421
         MVC   J(4),SAINTFP(@08)                                03S0421
*         RESPECIFY                                             03S0422
*           SAINTF BASED(J);        /* SET BASE              @Y30LB52*/
*         ACCPTR=ADDR(ACCUMTOT);    /* LOAD 1ST ACCUM ADDR   @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  03S0423
*         DO SAP=1 TO SANO;         /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    SAP,1                                            03S0424
         B     @DE00424                                         03S0424
@DL00424 DS    0H                                               03S0425
*           IF SAINTF(I)^=0         /* ERRORS ON THIS INTERFACE?
*                                                            @Y30LB52*/
*             THEN                                              03S0425
         SLR   @08,@08                                          03S0425
         LR    @07,I                                            03S0425
         SLA   @07,2                                            03S0425
         L     @04,J                                            03S0425
         AL    @04,@CF00661                                     03S0425
         L     @07,SAINTF(@07,@04)                              03S0425
         CR    @07,@08                                          03S0425
         BE    @RF00425                                         03S0425
*             DO;                   /* OUTPUT                @Y30LB52*/
*               RESPECIFY                                       03S0427
*                 CHCUTAB BASED(SAINTF(I));/* SET BASE       @Y30LB52*/
*               RESPECIFY                                       03S0428
*                 DASDACCS BASED(DASDACCP);/* SET ACCUM BASE @Y30LB52*/
*               DASDACCP=SPLTABP;   /* LOAD ACCUMULATOR ADDR @Y30LB52*/
         L     @07,SPLTABP(,@07)                                03S0429
         ST    @07,DASDACCP                                     03S0429
*               IF DASDACCP^=0      /* IF NONZERO, ERRORSARE @Y30LB52*/
*                 THEN                                          03S0430
         CR    @07,@08                                          03S0430
         BE    @RF00430                                         03S0430
*                 DO;               /* BELOW                 @Y30LB52*/
*                   DASDACCE=DASDACCP+(LENGTH(CSPNDLET)-2);/* LOAD
*                                      END OF ACCUMULATOR    @Y30LB52*/
*                                                               03S0432
         LA    @08,190                                          03S0432
         ALR   @08,@07                                          03S0432
         ST    @08,DASDACCE                                     03S0432
*                   /*************************************************/
*                   /*                                               */
*                   /* LOOP THROUGH ALL ACCUMULATORS TOTALING THE    */
*                   /* ERRORS                                        */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0433
*                   DO DASDACCP=DASDACCP TO DASDACCE BY 2;/* @Y30LB52*/
         B     @DE00433                                         03S0433
@DL00433 DS    0H                                               03S0434
*                     ACCUM1=ACCUM1+DASDACCS;/* INCREMENT TOTAL 03S0434
*                                                            @Y30LB52*/
         LH    @08,ACCUM1(,ACCPTR)                              03S0434
         AH    @08,DASDACCS(,@07)                               03S0434
         STH   @08,ACCUM1(,ACCPTR)                              03S0434
*                   END;            /*                       @Y30LB52*/
         AH    @07,@CH00106                                     03S0435
         ST    @07,DASDACCP                                     03S0435
@DE00433 C     @07,DASDACCE                                     03S0435
         BNH   @DL00433                                         03S0435
*                 END;              /*                       @Y30LB52*/
*               ELSE                                            03S0437
*                 ACCUM1=0;         /* XERO THE INTF. TOTAL  @YM32170*/
*                                                               03S0437
         B     @RC00430                                         03S0437
@RF00430 SLR   @08,@08                                          03S0437
         STH   @08,ACCUM1(,ACCPTR)                              03S0437
*               /*****************************************************/
*               /*                                                   */
*               /* CONVERT AND STORE IN THE REPORT LINE              */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0438
*               CVD(ACCUM1,DECNO);  /* CONVERT BINARY STRING TO 03S0438
*                                      DECIMAL               @Y30LB52*/
@RC00430 LH    @08,ACCUM1(,ACCPTR)                              03S0438
         CVD   @08,DECNO                                        03S0438
*               CHS2(SAP)=EDITPAT3; /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @07,SAP                                          03S0439
         MH    @07,@CH00101                                     03S0439
         ST    @07,@TF00001                                     03S0439
         ALR   @07,CVTPTR                                       03S0439
         MVC   CHS2-5(4,@07),EDITPAT3                           03S0439
*               ED(CHS2(SAP),DECNO1);/* CONVERT TO PRINTABLE HEX
*                                                            @ZM34326*/
         LR    @07,CVTPTR                                       03S0440
         AL    @07,@TF00001                                     03S0440
         ED    CHS2-5(4,@07),DECNO1                             03S0440
*               LTOTAL(SAP)=LTOTAL(SAP)+ACCUM1;/* INCREMTNT COLUMN
*                                      TOTAL                 @Y30LB52*/
         LR    @07,SAP                                          03S0441
         ALR   @07,@07                                          03S0441
         LH    @04,LTOTAL-2(@07)                                03S0441
         ALR   @04,@08                                          03S0441
         STH   @04,LTOTAL-2(@07)                                03S0441
*               RTOTAL=RTOTAL+ACCUM1;/* INCREMENT THE ROW TOTAL 03S0442
*                                                            @Y30LB52*/
         AH    @08,RTOTAL                                       03S0442
         STH   @08,RTOTAL                                       03S0442
*             END;                  /*                       @Y30LB52*/
*           ELSE                                                03S0444
*             CHS2(SAP)=ASKT4;      /* INTERFACE NOT USED    @ZM34326*/
         B     @RC00425                                         03S0444
@RF00425 LR    @08,SAP                                          03S0444
         MH    @08,@CH00101                                     03S0444
         ALR   @08,CVTPTR                                       03S0444
         MVC   CHS2-5(4,@08),@CC00067                           03S0444
*           J=J+LENGTH(SAINTFC);    /* INCREMENT TO NEXT INTF@Y30LB52*/
@RC00425 LA    @08,12                                           03S0445
         AL    @08,J                                            03S0445
         ST    @08,J                                            03S0445
*         END;                      /*                       @Y30LB52*/
*                                                               03S0446
         AH    SAP,@CH00045                                     03S0446
@DE00424 L     @08,CNFG0PTR(,CVTPTR)                            03S0446
         CH    SAP,SANO(,@08)                                   03S0446
         BNH   @DL00424                                         03S0446
*         /***********************************************************/
*         /*                                                         */
*         /* ALL REMAINING SA'S ARE UNUSED                           */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0447
*         DO SAP=SANO+1 TO 16;      /* SA'S NOT IN SYSTEM    @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0447
         LA    SAP,1                                            03S0447
         AH    SAP,SANO(,@08)                                   03S0447
         B     @DE00447                                         03S0447
@DL00447 DS    0H                                               03S0448
*           CHS2(SAP)=ASKT4;        /* INDICATE UNUSED       @ZM34326*/
         LR    @08,SAP                                          03S0448
         MH    @08,@CH00101                                     03S0448
         ALR   @08,CVTPTR                                       03S0448
         MVC   CHS2-5(4,@08),@CC00067                           03S0448
*         END;                      /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0449
@DE00447 CH    SAP,@CH00084                                     03S0449
         BNH   @DL00447                                         03S0449
*         GTOTAL=GTOTAL+RTOTAL;     /* INCREMENT GRAND TOT   @Y30LB52*/
         LH    @08,RTOTAL                                       03S0450
         LH    @04,GTOTAL                                       03S0450
         ALR   @04,@08                                          03S0450
         STH   @04,GTOTAL                                       03S0450
*         CVD(RTOTAL,DECNO);        /* CONVERT BINARY STRING TO 03S0451
*                                      DECIMAL               @ZA00699*/
         CVD   @08,DECNO                                        03S0451
*         CHSTOT=EDITPAT5;          /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0452
*         ED(CHSTOT,DECNO2);        /* CONVERT TO PRINTABLE HEX 03S0453
*                                                            @ZA00699*/
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0453
*         CHSA=I+'C1'X;             /* SET INTERFACE CHAR    @Y30LB52*/
         LA    @08,193                                          03S0454
         ALR   @08,I                                            03S0454
         STC   @08,CHSA(,CVTPTR)                                03S0454
*         CALL P1PRINTL;            /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0455
*         RTOTAL=0;                 /* CLEAR THE ROW TOTAL   @Y30LB52*/
         SLR   @08,@08                                          03S0456
         STH   @08,RTOTAL                                       03S0456
*       END;                        /*                       @Y30LB52*/
*                                                               03S0457
         AH    I,@CH00045                                       03S0457
         CH    I,@CH00103                                       03S0457
         BNH   @DL00418                                         03S0457
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT THE TOTALS LINE                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0458
*       OUTLINE=SKIPTWO;            /* SKIP TWOLINES         @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0458
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0458
         MVI   OUTLINE(CVTPTR),C'0'                             03S0458
*       DO SAP=1 TO SANO;           /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    SAP,1                                            03S0459
         B     @DE00459                                         03S0459
@DL00459 DS    0H                                               03S0460
*         CVD(LTOTAL(SAP),DECNO);   /* CONVERT BINARY STRING TO 03S0460
*                                      DECIMAL               @Y30LB52*/
         LR    @08,SAP                                          03S0460
         ALR   @08,@08                                          03S0460
         LH    @08,LTOTAL-2(@08)                                03S0460
         CVD   @08,DECNO                                        03S0460
*         CHS2(SAP)=EDITPAT3;       /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,SAP                                          03S0461
         MH    @08,@CH00101                                     03S0461
         ST    @08,@TF00001                                     03S0461
         ALR   @08,CVTPTR                                       03S0461
         MVC   CHS2-5(4,@08),EDITPAT3                           03S0461
*         ED(CHS2(SAP),DECNO1);     /* CONVERT TO PRINTABLE HEX 03S0462
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0462
         AL    @08,@TF00001                                     03S0462
         ED    CHS2-5(4,@08),DECNO1                             03S0462
*       END;                        /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0463
@DE00459 L     @08,CNFG0PTR(,CVTPTR)                            03S0463
         CH    SAP,SANO(,@08)                                   03S0463
         BNH   @DL00459                                         03S0463
*       CVD(GTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0464
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0464
         CVD   @08,DECNO                                        03S0464
*       CHSTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0465
*       ED(CHSTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0466
*                                                            @ZA00699*/
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0466
*       CHSTOTL='TOTAL';            /* SET CONSTANT          @Y30LB52*/
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       03S0467
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52
*                                                            @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0468
*       DCL                                                     03S0469
*         DASDACCS FIXED(15) BASED(DASDACCP),/* DASD ACCUMULATOR
*                                                            @Y30LB52*/
*         DASDACCP PTR(31) DEF(DRDACCP),/* BASE PTR          @Y30LB52*/
*         DASDACCE PTR(31) DEF(DRDACCE),/* END PTR           @Y30LB52*/
*         SAINTFC CHAR(12) DEF(SAINTF),/* SAINTF PTRS        @Y30LB52*/
*                                                               03S0469
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE TO BE USED */
*         /* IN THE INSERTION OF THE ROW ERROR COUNTS.               */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0469
*         1 * DEF(OUTLINE),                                     03S0469
*          2 * CHAR(11),            /* UNUSED                @Y30LB52*/
*          2 CHSA CHAR(1),          /* INTERFACE             @Y30LB52*/
*          2 * CHAR(2),             /* UNUSED                @Y30LB52*/
*          2 CHSTOTL CHAR(5),       /* CONSTANT 'TOTAL'      @Y30LB52*/
*          2 *(16) CHAR(5),         /* ERROR COUNTS AND SPACE@Y30LB52*/
*           3 CHS2 CHAR(4),         /* ERROR COUNT           @ZM34326*/
*           3 * CHAR(1),            /* UNUSED                @ZM34326*/
*          2 CHSTOT CHAR(6);        /* TOTALS COLUMN         @ZA00699*/
*                                                               02S0470
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING STRUCTURE IS A FIXED HEADER FOR THE CH/SA   */
*       /* ARRAY.                                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0470
*       DCL                                                     02S0470
*         1 CHSAHEAD STATIC LOCAL,  /* CHAN/SA HEAD CONSTANT @Y30LB52*/
*          2 * CHAR(1) INIT('-'),   /* SKIP 3 CC             @Y30LB52*/
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/
*          2 * CHAR(33) INIT('CHANNEL/SA INTERFACE ERROR COUNTS'),/*
*                                                            @Y30LB52*/
*                                                               02S0470
*         /***********************************************************/
*         /*                                                         */
*         /* THIS STRUCTURE MAPS THE OUTPUT LINE AND IS USED TO FILL */
*         /* IN THE COLUMN HEAD CONSTANTS.                           */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0470
*         1 * DEF(OUTLINE),         /* MAPS THE OUTPUT LINE  @Y30LB52*/
*          2 * CHAR(7),             /*                       @Y30LB52*/
*          2 CHSAHD CHAR(9),        /* CHANNEL-INTERFACE POSITION
*                                                            @Y30LB52*/
*          2 * CHAR(85),            /*                       @ZA00699*/
*          2 CHSAHD1 CHAR(5);       /*                       @Y30LB52*/
*     END;                          /*                       @Y30LB52*/
*   IF(MSCTOTAL^=0)×(HTOTAL^=0)     /* DASD ERRORS RECORDED  @Y30LB52*/
*     THEN                                                      01S0472
@RF00404 SLR   @08,@08                                          01S0472
         L     @03,PAD00PTR(,CVTPTR)                            01S0472
         CH    @08,MSCTOTAL(,@03)                               01S0472
         BNE   @RT00472                                         01S0472
         CH    @08,HTOTAL(,@03)                                 01S0472
         BE    @RF00472                                         01S0472
@RT00472 DS    0H                                               01S0473
*     DO;                           /* FORMAT THE REMAINDER  @Y30LB52*/
*                                                               01S0473
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE     */
*       /* SA/CONTROLLER PORTION OF THE PATH ANALYSIS REPORT (DASD). */
*       /*                                                           */
*       /*************************************************************/
*                                                               01S0474
*                                                               02S0474
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT FORMATS THE CONSTANT HEADER PORTION */
*       /* OF THE SA/DASD CONTROLLER ARRAY FOR THE PATH ANALYSIS     */
*       /* REPORT(DASD).                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0474
*       OUTLINE=SACONHD;            /* SA/CNTLR HEADER       @Y30LB52*/
         MVI   OUTLINE+37(CVTPTR),C' '                          02S0474
         MVC   OUTLINE+38(95,CVTPTR),OUTLINE+37(CVTPTR)         02S0474
         MVC   OUTLINE(37,CVTPTR),SACONHD                       02S0474
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0475
*       OUTLINE=SAHD;               /* FIXED SA COLUMN HEADER@Y30LB52*/
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0476
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0476
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0476
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
*                                                               02S0477
         BAL   @14,P1PRINTL                                     02S0477
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT THE COLUMN HEADER IMMEDIATELY BEFORE THE ARRAY     */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0478
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0478
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0478
         MVI   OUTLINE(CVTPTR),C' '                             02S0478
*       SACON1='CONTROLLER';        /* CONTROLLER COLUMN     @Y30LB52*/
         MVC   SACON1(10,CVTPTR),@CC00500                       02S0479
*       SACON2='TOTAL';             /* TOTAL COLUMN          @Y30LB52*/
         MVC   SACON2(5,CVTPTR),@CC00240                        02S0480
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/
*                                                               02S0481
         BAL   @14,P1PRINTL                                     02S0481
*       /*************************************************************/
*       /*                                                           */
*       /* THE INCLUDED SEGMENT FORMATS AND FILLS IN THE VALUES      */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0482
*                                                               03S0482
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE VALUE LINES  */
*       /* FOR THE SA/CONTROLLER ARRAY(3330).                        */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0482
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @Y30LB52*/
         XC    TOTALS(76),TOTALS                                03S0482
*       VSADRC=VSADRC&&VSADRC;      /* CLEAR VALID SA ARRAY  @Y30LB52*/
         XC    VSADRC(16),VSADRC                                03S0483
*       DO I=1 TO 4;                /* LOOP THROUGH FOUR CONTROLLERS
*                                                            @Y30LB52*/
         LA    I,1                                              03S0484
@DL00484 DS    0H                                               03S0485
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATORS   @Y30L52
*                                                            @Y30LB52*/
*                                                               03S0485
         XC    ACCUMTOT(32),ACCUMTOT                            03S0485
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING INCLUDED SEGMENT TOTALS THE ACCUMULATORS  */
*         /* FOR ALL ERRORS RECORDED THROUGH A 'MSC' PATH.           */
*         /*                                                         */
*         /***********************************************************/
*                                                               03S0486
*                                                               04S0486
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING SEGMENT OF CODE CHECKS EACH MSC PATH FOR  */
*         /* ACCUMLATED ERRORS AND ADDS ANY FOUND TO THE PROPER      */
*         /* TOTALS.                                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                               04S0486
*         DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH
*                                      ALL MSC'S             @Y30LB52*/
         LA    @08,1                                            04S0486
         STH   @08,MSC                                          04S0486
@DL00486 SLA   @08,3                                            04S0486
         L     @04,PAD00PTR(,CVTPTR)                            04S0486
         ST    @08,@TF00001                                     04S0486
         ALR   @08,@04                                          04S0486
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0486
         BE    @DC00486                                         04S0486
*           SATABP=SATABPTR(MSC);   /* LOAD THE SATAB POINTER@Y30LB52
*                                                            @Y30LB52*/
         L     @08,@TF00001                                     04S0487
         L     SATABP,SATABPTR-8(@08,@04)                       04S0487
*           RESPECIFY                                           04S0488
*             SADRDDSD BASED(SATABP);/*                      @Y30LB52*/
*           IF SATABP^=0            /* DOES THE 'SA' LEVEL TABLE
*                                      EXIST?                @Y30LB52*/
*             THEN                                              04S0489
         LTR   SATABP,SATABP                                    04S0489
         BZ    @RF00489                                         04S0489
*             DO;                   /* IF SO, LOOK FOR ACCUMULATOR
*                                                            @Y30LB52*/
*               ACCPTR=ADDR(ACCUMTOT);/* INITIALIZE TOTALS POINTER
*                                                            @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  04S0491
*               DO SAP=1 TO SANO;   /* LOOP THROUGH ALL POSSIBLE SA'S
*                                                            @Y30LB52*/
         LA    SAP,1                                            04S0492
         B     @DE00492                                         04S0492
@DL00492 DS    0H                                               04S0493
*                 IF SADASDAC(SAP)^=0/* IF AN ACCUMULATOR ARRAY 04S0493
*                                      EXISTS                @Y30LB52*/
*                   THEN                                        04S0493
         LR    @08,SAP                                          04S0493
         SLA   @08,3                                            04S0493
         AL    @08,@CF00661                                     04S0493
         L     @08,SADASDAC-4(@08,SATABP)                       04S0493
         LTR   @08,@08                                          04S0493
         BZ    @RF00493                                         04S0493
*                   DO;             /* ERRORS ARE RECORDED BELOW
*                                                            @Y30LB52*/
*                     DASDACCP=SADASDAC(SAP);/* LOAD ACCUMULATOR
*                                      POINTER               @Y30LB52*/
         ST    @08,DASDACCP                                     04S0495
*                     CALL P1SACON3;/* CALL TOTALS PROCEDURE @Y30LB52*/
         BAL   @14,P1SACON3                                     04S0496
*                   END;            /*                       @Y30LB52*/
*                 ACCPTR=ACCPTR+2;  /* INCREMENT THE TOTALS POINTER
*                                                            @Y30LB52*/
@RF00493 AH    ACCPTR,@CH00106                                  04S0498
*               END;                /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     04S0499
@DE00492 L     @08,CNFG0PTR(,CVTPTR)                            04S0499
         CH    SAP,SANO(,@08)                                   04S0499
         BNH   @DL00492                                         04S0499
*             END;                  /*                       @Y30LB52*/
*         END;                      /*                       @Y30LB52*/
@RF00489 LA    @08,1                                            04S0501
         AH    @08,MSC                                          04S0501
         STH   @08,MSC                                          04S0501
         CH    @08,@CH00099                                     04S0501
         BNH   @DL00486                                         04S0501
@DC00486 DS    0H                                               04S0502
*P1SACON3:                                                      05S0502
*         PROCEDURE OPTIONS(SAVE(14));/*                     @Y30LB52*/
*                                                               05S0502
         B     @PB00003                                         05S0502
P1SACON3 ST    @14,12(,@13)                                     05S0502
*         /***********************************************************/
*         /*                                                         */
*         /* THIS PROCEDURE IS CALLED TO TOTAL ALL ACCUMULATORS IN A */
*         /* PATH WITH A 'SA' AND 3330 CONTROLLER SELECTED           */
*         /* PREVIOUSLY.                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                               05S0503
*         RESPECIFY                                             05S0503
*           SPNDLETB BASED(DASDACCP);/*                      @Y30LB52*/
*         DASDACCP=ADDR(SPNDLETB(I,1));/* ADDRESS ACCUMULATOR ROW
*                                                            @Y30LB52*/
         LR    @08,I                                            05S0504
         MH    @08,@CH00555                                     05S0504
         L     @04,DASDACCP                                     05S0504
         AL    @04,@CF00666                                     05S0504
         LA    @08,SPNDLETB(@08,@04)                            05S0504
         ST    @08,DASDACCP                                     05S0504
*         DASDACCE=DASDACCP+(LENGTH(SPNDLES)*8)-2;/* END OF ROW 05S0505
*                                                            @Y30LB52*/
*                                                               05S0505
         LR    @04,@08                                          05S0505
         SH    @04,@CH00654                                     05S0505
         ST    @04,DASDACCE                                     05S0505
*         /***********************************************************/
*         /*                                                         */
*         /* TOTAL ALL ERRORS RECORDED FOR THIS CONTROLLER.          */
*         /*                                                         */
*         /***********************************************************/
*                                                               05S0506
*         DO DASDACCP=DASDACCP TO DASDACCE BY 2;/*           @Y30LB52*/
         B     @DE00506                                         05S0506
@DL00506 DS    0H                                               05S0507
*           RESPECIFY                                           05S0507
*             DASDACCS BASED(DASDACCP);/* SET BASE           @Y30LB52*/
*           ACCUM1=ACCUM1+DASDACCS; /* INCREMENT TOTALS ACCUMULATOR
*                                                            @Y30LB52*/
         LH    @04,ACCUM1(,ACCPTR)                              05S0508
         AH    @04,DASDACCS(,@08)                               05S0508
         STH   @04,ACCUM1(,ACCPTR)                              05S0508
*         END;                      /*                       @Y30LB52*/
         AH    @08,@CH00106                                     05S0509
         ST    @08,DASDACCP                                     05S0509
@DE00506 C     @08,DASDACCE                                     05S0509
         BNH   @DL00506                                         05S0509
*       END P1SACON3;               /*                       @Y30LB52*/
@EL00003 DS    0H                                               05S0510
@EF00003 DS    0H                                               05S0510
@ER00003 L     @14,12(,@13)                                     05S0510
         BR    @14                                              05S0510
@PB00003 DS    0H                                               05S0511
*                                                               03S0511
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING INCLUDED SEGMENT TOTALS THE ACCUMULATORS FOR*/
*       /* ALL ERRORS RECORDED THROUGH HOST CHANNEL PATHS.           */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0511
*                                                               04S0511
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT OF CODE CHECKS THE PATHS ORIGNATING */
*       /* IN HOST CHANNELS FOR ACCUMULATED ERRORS AND IF FOUND, ADDS*/
*       /* TO THE APPROPRIATE TOTALS.                                */
*       /*                                                           */
*       /*************************************************************/
*                                                               04S0511
*       ACCPTR=ADDR(ACCUMTOT);      /* INITIALIZE ACCUMULATOR PTR
*                                                            @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  04S0511
*       DO SAP=1 TO SANO;           /* LOOP THROUGH SA'S     @Y30LB52*/
         LA    SAP,1                                            04S0512
         B     @DE00512                                         04S0512
@DL00512 DS    0H                                               04S0513
*         J=SAINTFP+(SAP-1)*12;     /* ADDRESS UPPER INTERFACE ARRAY
*                                                            @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            04S0513
         LR    @07,SAP                                          04S0513
         BCTR  @07,0                                            04S0513
         MH    @07,@CH00035                                     04S0513
         AL    @07,SAINTFP(,@08)                                04S0513
         ST    @07,J                                            04S0513
*         DO UINTF=1 TO 3;          /* LOOP THROUGH THREE INTERFACES
*                                                            @Y30LB52*/
         LA    @08,1                                            04S0514
         STH   @08,UINTF                                        04S0514
@DL00514 DS    0H                                               04S0515
*           CHCUPTR=J->SAINTF(UINTF);/* LOAD CHCHTAB POINTER @Y30LB52*/
         SLA   @08,2                                            04S0515
         L     @04,J                                            04S0515
         AL    @04,@CF00661                                     04S0515
         L     CHCUPTR,SAINTF(@08,@04)                          04S0515
*           RESPECIFY                                           04S0516
*             CHCUTAB BASED(CHCUPTR);/*                      @Y30LB52*/
*           IF CHCUPTR^=0           /* CHCUTAB EXISTENT?     @Y30LB52*/
*             THEN                                              04S0517
         SLR   @08,@08                                          04S0517
         CR    CHCUPTR,@08                                      04S0517
         BE    @RF00517                                         04S0517
*             DO;                   /* IF SO, LOOK FOR ACCUMULATORS
*                                                            @Y30LB52*/
*               DASDACCP=SPLTABP;   /* LOAD ACCUMULATOR ADDRESS 04S0519
*                                                            @Y30LB52*/
         L     @04,SPLTABP(,CHCUPTR)                            04S0519
         ST    @04,DASDACCP                                     04S0519
*               IF DASDACCP^=0      /* DOES ACCUMULATOR EXIST?  04S0520
*                                                            @Y30LB52*/
*                 THEN                                          04S0520
         CR    @04,@08                                          04S0520
         BE    @RF00520                                         04S0520
*                 DO;               /* IF SO, TOTAL THE ERRORS  04S0521
*                                                            @Y30LB52*/
*                   CALL P1SACON3;  /*                       @Y30LB52*/
         BAL   @14,P1SACON3                                     04S0522
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
@RF00520 DS    0H                                               04S0525
*         END;                      /*                       @Y30LB52*/
@RF00517 LA    @08,1                                            04S0525
         AH    @08,UINTF                                        04S0525
         STH   @08,UINTF                                        04S0525
         CH    @08,@CH00103                                     04S0525
         BNH   @DL00514                                         04S0525
*         ACCPTR=ACCPTR+2;          /* INCREMENT THE ACCUMULATOR PTR
*                                                            @Y30LB52*/
         AH    ACCPTR,@CH00106                                  04S0526
*       END;                        /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     04S0527
@DE00512 L     @08,CNFG0PTR(,CVTPTR)                            04S0527
         CH    SAP,SANO(,@08)                                   04S0527
         BNH   @DL00512                                         04S0527
*                                                               03S0528
*       /*************************************************************/
*       /*                                                           */
*       /* THIS CODE FORMATS THE OUTPUT LINE CONSISTING OF ONE       */
*       /* ACCUMULATOR TOTAL FOR EACH 'SA' AND A ROW TOTAL.          */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0528
*       ACCPTR=ADDR(ACCUMTOT);      /* LOAD FIRST ACCUM ADDR @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  03S0528
*       RTOTAL=0;                   /* CLEAR THE ROW TOTAL   @Y30LB52*/
         SLR   @08,@08                                          03S0529
         STH   @08,RTOTAL                                       03S0529
*       OUTLINE=SKIPONE;            /* INITIALIZE THE LINE   @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0530
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0530
         MVI   OUTLINE(CVTPTR),C' '                             03S0530
*       DO SAP=1 TO SANO;           /* LOOP THROUGH ATTACHED SA'S
*                                                            @Y30LB52*/
         LA    SAP,1                                            03S0531
         B     @DE00531                                         03S0531
@DL00531 DS    0H                                               03S0532
*         RTOTAL=RTOTAL+ACCUM1;     /* INCREMENT ROW TOTAL   @Y30LB52*/
         LH    @08,ACCUM1(,ACCPTR)                              03S0532
         LH    @07,RTOTAL                                       03S0532
         ALR   @07,@08                                          03S0532
         STH   @07,RTOTAL                                       03S0532
*         LTOTAL(SAP)=LTOTAL(SAP)+ACCUM1;/* INCREMENT COLUMN TOTAL
*                                                            @Y30LB52*/
         LR    @07,SAP                                          03S0533
         ALR   @07,@07                                          03S0533
         LH    @04,LTOTAL-2(@07)                                03S0533
         ALR   @04,@08                                          03S0533
         STH   @04,LTOTAL-2(@07)                                03S0533
*         CVD(ACCUM1,DECNO);        /* CONVERT BINARY STRING TO 03S0534
*                                      DECIMAL               @Y30LB52*/
         CVD   @08,DECNO                                        03S0534
*         CHS2(SAP)=EDITPAT3;       /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,SAP                                          03S0535
         MH    @08,@CH00101                                     03S0535
         ST    @08,@TF00001                                     03S0535
         ALR   @08,CVTPTR                                       03S0535
         MVC   CHS2-5(4,@08),EDITPAT3                           03S0535
*         ED(CHS2(SAP),DECNO1);     /* CONVERT TO PRINTABLE HEX 03S0536
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0536
         AL    @08,@TF00001                                     03S0536
         ED    CHS2-5(4,@08),DECNO1                             03S0536
*         ACCPTR=ACCPTR+2;          /* INCREMENT ACCUMS      @Y30LB52*/
         AH    ACCPTR,@CH00106                                  03S0537
*       END;                        /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0538
@DE00531 L     @08,CNFG0PTR(,CVTPTR)                            03S0538
         CH    SAP,SANO(,@08)                                   03S0538
         BNH   @DL00531                                         03S0538
*       CHSA=(I-1)×'F0'X;           /* CNTLR NUMBER          @Y30LB52*/
         LR    @08,I                                            03S0539
         BCTR  @08,0                                            03S0539
         O     @08,@CF00511                                     03S0539
         STC   @08,CHSA(,CVTPTR)                                03S0539
*       DO SAP=SANO+1 TO 16;        /* LOOP THROUGH REMAINING SA'S
*                                                            @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0540
         LA    SAP,1                                            03S0540
         AH    SAP,SANO(,@08)                                   03S0540
         B     @DE00540                                         03S0540
@DL00540 DS    0H                                               03S0541
*         CHS2(SAP)=ASKT4;          /* SET NO COUNT          @ZM34326*/
         LR    @08,SAP                                          03S0541
         MH    @08,@CH00101                                     03S0541
         ALR   @08,CVTPTR                                       03S0541
         MVC   CHS2-5(4,@08),@CC00067                           03S0541
*       END;                        /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0542
@DE00540 CH    SAP,@CH00084                                     03S0542
         BNH   @DL00540                                         03S0542
*       CVD(RTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0543
*                                      DECIMAL               @ZA00699*/
         LH    @08,RTOTAL                                       03S0543
         CVD   @08,DECNO                                        03S0543
*       CHSTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0544
*       ED(CHSTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0545
*                                                            @ZA00699*/
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0545
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0546
*     END;                          /*                       @Y30LB52*/
*                                                               03S0547
         AH    I,@CH00045                                       03S0547
         CH    I,@CH00055                                       03S0547
         BNH   @DL00484                                         03S0547
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT THE GRAND TOTALS LINE.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               03S0548
*   OUTLINE=SKIPTWO;                /* INITIALIZE THE LINE   @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0548
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0548
         MVI   OUTLINE(CVTPTR),C'0'                             03S0548
*   CHSTOTL='TOTAL';                /* SET LINE CONSTANT     @Y30LB52*/
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       03S0549
*   DO SAP=1 TO SANO;               /* LOOP THROUGH ALL SA'S @Y30LB52*/
         LA    SAP,1                                            03S0550
         B     @DE00550                                         03S0550
@DL00550 DS    0H                                               03S0551
*     CVD(LTOTAL(SAP),DECNO);       /* CONVERT BINARY STRING TO 03S0551
*                                      DECIMAL               @Y30LB52*/
         LR    @08,SAP                                          03S0551
         ALR   @08,@08                                          03S0551
         LH    @08,LTOTAL-2(@08)                                03S0551
         CVD   @08,DECNO                                        03S0551
*     CHS2(SAP)=EDITPAT3;           /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @07,SAP                                          03S0552
         MH    @07,@CH00101                                     03S0552
         ST    @07,@TF00001                                     03S0552
         ALR   @07,CVTPTR                                       03S0552
         MVC   CHS2-5(4,@07),EDITPAT3                           03S0552
*     ED(CHS2(SAP),DECNO1);         /* CONVERT TO PRINTABLE HEX 03S0553
*                                                            @ZM34326*/
         LR    @07,CVTPTR                                       03S0553
         AL    @07,@TF00001                                     03S0553
         ED    CHS2-5(4,@07),DECNO1                             03S0553
*     GTOTAL=GTOTAL+LTOTAL(SAP);    /* INCREMENT GRAND TOTAL @Y30LB52*/
         AH    @08,GTOTAL                                       03S0554
         STH   @08,GTOTAL                                       03S0554
*   END;                            /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0555
@DE00550 L     @08,CNFG0PTR(,CVTPTR)                            03S0555
         CH    SAP,SANO(,@08)                                   03S0555
         BNH   @DL00550                                         03S0555
*   CVD(GTOTAL,DECNO);              /* CONVERT BINARY STRING TO 03S0556
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       03S0556
         CVD   @08,DECNO                                        03S0556
*   CHSTOT=EDITPAT5;                /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0557
*   ED(CHSTOT,DECNO2);              /* CONVERT TO PRINTABLE HEX 03S0558
*                                                            @ZA00699*/
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0558
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0559
*                                                               02S0560
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE CONTAINS THE FIXED SA/CONTROLLER      */
*   /* HEADER                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0560
*   DCL                                                         02S0560
*     1 SACONHD STATIC LOCAL,       /*                       @Y30LB52*/
*      2 * CHAR(1) INIT('-'),       /* SKIP 3 CC             @Y30LB52*/
*      2 * CHAR(36) INIT('SA/CONTROLLER INTERFACE ERROR COUNTS'),/*
*                                                            @Y30LB52*/
*                                                               02S0560
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR THE PURPOSE*/
*     /* OF INSERTING THE 'CONTROLLER' AND 'TOTALS' COLUMN CONSTANTS.*/
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0560
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/
*      2 * CHAR(5),                 /*                       @Y30LB52*/
*      2 SACON1 CHAR(10),           /*                       @Y30LB52*/
*      2 * CHAR(86),                /*                       @ZA00699*/
*      2 SACON2 CHAR(5);            /*                       @Y30LB52*/
*                                                               01S0561
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLWING SEGMENT OF INCLUDED CODE FORMATS AND PRINTS THE  */
*   /* 3330 CONTROLLER/DRIVE PORTION OF THE PATH ANALYSIS REPORT     */
*   /* (DASD).                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0561
*                                                               02S0561
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT OF CODE TOTALS THE ERROR COUNTS FOR ALL          */
*   /* CONTROLLER DRIVE COMBINATIONS UNDER EACH SA. FOR EACH SA IN A */
*   /* PATH WITH ACCUMULATED ERRORS, A CONTROLLER/DRIVE ARRAY IS     */
*   /* FORMATTED AND PRINTED. FOR EACH THREE PRINTED ARRAYS, THE PAGE*/
*   /* IS EJECTED.                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0561
*   ARRAY=0;                        /* INITIALIZE PRINTED ARRAYS
*                                      COUNT                 @Y30LB52*/
         SLR   @08,@08                                          02S0561
         STH   @08,ARRAY                                        02S0561
*   TOTALS=TOTALS&&TOTALS;          /* CLEAR ALL TOTALS      @Y30LB52*/
         XC    TOTALS(76),TOTALS                                02S0562
*   DO SAP=1 TO SANO;               /* LOOP THROUGH ALL SA'S IN THE
*                                      SUBSYSTEM             @Y30LB52*/
         LA    SAP,1                                            02S0563
         B     @DE00563                                         02S0563
@DL00563 DS    0H                                               02S0564
*     IF(ARRAY//3)=0 THEN                                       02S0564
         LH    @00,ARRAY                                        02S0564
         SRDA  @00,32                                           02S0564
         D     @00,@CF00103                                     02S0564
         LTR   @00,@00                                          02S0564
         BNZ   @RF00564                                         02S0564
*       DO;                         /* IF THIS ARRAY IS A MULTIPLE OF
*                                      THREE                 @Y30LB52*/
*                                                               02S0565
*         /***********************************************************/
*         /*                                                         */
*         /* SKIP TO A NEW PAGE BEFORE PRINTING                      */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0566
*         OUTLINE=NEWPAGE;          /* SET NEW PAGE CC       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0566
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0566
         MVI   OUTLINE(CVTPTR),C'1'                             02S0566
*         CALL P1PRINTL;            /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0567
*         OUTLINE=DASDHEAD;         /* PAD DASD HEADER       @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0568
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0568
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0568
*         CALL P1PRINTL;            /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0569
*       END;                        /*                       @Y30LB52*/
*     ARRAY=ARRAY+1;                /* INCREMENT THE PRINTED ARRAY
*                                      COUNT                 @Y30LB52*/
@RF00564 LA    @08,1                                            02S0571
         AH    @08,ARRAY                                        02S0571
         STH   @08,ARRAY                                        02S0571
*     OUTLINE=CONDRHD;              /*                       @Y30LB52
*                                      CONTROLLER/DRIVE HEADER       */
         MVI   OUTLINE+64(CVTPTR),C' '                          02S0572
         MVC   OUTLINE+65(68,CVTPTR),OUTLINE+64(CVTPTR)         02S0572
         MVC   OUTLINE(64,CVTPTR),CONDRHD                       02S0572
*     OUTLINE(LENGTH(CONDRHD)-2)=(SAP-1)×'0';/* SET SA NUMBER IN
*                                      ARRAY HEADER          @Y30LB52*/
         LR    @08,SAP                                          02S0573
         BCTR  @08,0                                            02S0573
         O     @08,@CF00073                                     02S0573
         STC   @08,OUTLINE+61(,CVTPTR)                          02S0573
*     CALL P1PRINTL;                /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0574
*     OUTLINE=SKIPTWO;              /* SKIP TWO LINES        @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0575
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0575
         MVI   OUTLINE(CVTPTR),C'0'                             02S0575
*     OUTLINE(22:22+LENGTH(DRIVEHD))=DRIVEHD;/*              @ZM34326
*                                      AND PRINT THE DRIVE HEADER    */
         MVI   OUTLINE+69(CVTPTR),C' '                          02S0576
         MVC   OUTLINE+21(48,CVTPTR),DRIVEHD                    02S0576
*     CALL P1PRINTL;                /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0577
*     OUTLINE=SKIPONE;              /* SKIP ONE LINE         @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0578
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0578
         MVI   OUTLINE(CVTPTR),C' '                             02S0578
*     DCONTRL='CONTROLLER';         /* SET ARRAY HEADER      @Y30LB52*/
         MVC   DCONTRL(10,CVTPTR),@CC00500                      02S0579
*     DTOTL='TOTAL';                /*                       @Y30LB52*/
         MVC   DTOTL(5,CVTPTR),@CC00240                         02S0580
*     CALL P1PRINTL;                /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0581
*     DO I=1 TO 4;                  /* LOOP THROUGH ABOXES   @Y30LB52*/
         LA    I,1                                              02S0582
@DL00582 DS    0H                                               02S0583
*       OUTLINE=SKIPONE;            /* SKIP LINE CC          @Y30LB52*/
*                                                               02S0583
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0583
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0583
         MVI   OUTLINE(CVTPTR),C' '                             02S0583
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT TOTALS THE ERRORS FOR ONE LINE OF   */
*       /* THE CONTROLLER/DRIVE ERROR ARRAY. THE ERRORS TOTALLED ARE */
*       /* THOSE IN MSC-SA PATHS.                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0584
*                                                               03S0584
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT TOTALS THE ERRORS ACCUMULATED FOR A          */
*       /* CONTROLLER/DRIVE COMBINATION UNDER A SA. THIS SEGMENT     */
*       /* TOTALS ONLY THE DASD ERRORS LOGGED THROUGH A MSC.         */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0584
*       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH
*                                      ALL MSC'S             @Y30LB52*/
         LA    @08,1                                            03S0584
         STH   @08,MSC                                          03S0584
@DL00584 SLA   @08,3                                            03S0584
         L     @07,PAD00PTR(,CVTPTR)                            03S0584
         ST    @08,@TF00001                                     03S0584
         ALR   @08,@07                                          03S0584
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0584
         BE    @DC00584                                         03S0584
*         SATABP=SATABPTR(MSC);     /* LOAD THE SATAB PTR    @Y30LB52*/
         L     @08,PAD00PTR(,CVTPTR)                            03S0585
         L     @04,@TF00001                                     03S0585
         L     SATABP,SATABPTR-8(@04,@08)                       03S0585
*         IF SATABP^=0              /* PATH DEFINED          @Y30LB52*/
*           THEN                                                03S0586
         SLR   @08,@08                                          03S0586
         CR    SATABP,@08                                       03S0586
         BE    @RF00586                                         03S0586
*           DO;                     /* TOTAL ERRORS          @Y30LB52*/
*                                                               03S0587
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE APPROPRIATE POINTER IN THE SATAB IS NON-ZERO,*/
*             /* AN ERROR COUNT HAS BEEN ACCUMULATED WITH THIS SA IN */
*             /* THE PATH. THE ACCUMULATOR TABLE IS ACCESSED AND ALL */
*             /* COUNTS ARE ADDED TO THE TOTAL.                      */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0588
*             RESPECIFY                                         03S0588
*               SADRDDSD BASED(SATABP);/*                    @Y30LB52*/
*             IF SADASDAC(SAP)^=0   /* ERRORS RECORDED       @Y30LB52*/
*               THEN                                            03S0589
         LR    @04,SAP                                          03S0589
         SLA   @04,3                                            03S0589
         AL    @04,@CF00661                                     03S0589
         C     @08,SADASDAC-4(@04,SATABP)                       03S0589
         BE    @RF00589                                         03S0589
*               DO;                 /* ADD TO TOTAL          @Y30LB52*/
*                 ACCPTR=ADDR(ACCUMTOT);/* LOAD TOTAL ARRAY ADDRESS
*                                                            @Y30LB52*/
*                                                               03S0591
         LA    ACCPTR,ACCUMTOT                                  03S0591
*                 /***************************************************/
*                 /*                                                 */
*                 /* LOOP THROUGH ALL ACCUMULATOR ELEMENTS, ADDING TO*/
*                 /* TOTAL.                                          */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0592
*                 DO K=1 TO 8;      /* LOOP THROUGH DRIVES   @Y30LB52*/
         LA    K,1                                              03S0592
@DL00592 DS    0H                                               03S0593
*                   RESPECIFY                                   03S0593
*                     SPNDLETB BASED(SADASDAC(SAP));/*       @Y30LB52*/
*                   DASDACCP=ADDR(SPNDLETB(I,K));/* LOAD ACCP POINTER
*                                                            @Y30LB52*/
         LR    @08,I                                            03S0594
         SLA   @08,3                                            03S0594
         ALR   @08,K                                            03S0594
         MH    @08,@CH00058                                     03S0594
         LR    @15,SAP                                          03S0594
         SLA   @15,3                                            03S0594
         AL    @15,@CF00661                                     03S0594
         L     @01,SADASDAC-4(@15,SATABP)                       03S0594
         AL    @01,@CF00667                                     03S0594
         LA    @08,SPNDLETB(@08,@01)                            03S0594
         ST    @08,DASDACCP                                     03S0594
*                   RESPECIFY                                   03S0595
*                     SPNDLES BASED(DASDACCP);/*             @Y30LB52*/
*                   ACCUM1=ACCUM1+DRVEQCHK;/* DRIVE CHECKS   @Y30LB52*/
         LH    @15,ACCUM1(,ACCPTR)                              03S0596
         AH    @15,DRVEQCHK(,@08)                               03S0596
         STH   @15,ACCUM1(,ACCPTR)                              03S0596
*                   ACCUM1=ACCUM1+STCTLCHK;/* STOR CNTL CHECKS  03S0597
*                                                            @Y30LB52*/
         AH    @15,STCTLCHK(,@08)                               03S0597
         STH   @15,ACCUM1(,ACCPTR)                              03S0597
*                   ACCUM1=ACCUM1+STCTLCCK;/* STOR CNTL CNTL CHECKS
*                                                            @Y30LB52*/
         AH    @15,STCTLCCK(,@08)                               03S0598
         STH   @15,ACCUM1(,ACCPTR)                              03S0598
*                   ACCPTR=ACCPTR+2;/* INCREMENT TOTAL POINTER  03S0599
*                                                            @Y30LB52*/
         AH    ACCPTR,@CH00106                                  03S0599
*                 END;              /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0600
         CH    K,@CH00099                                       03S0600
         BNH   @DL00592                                         03S0600
*               END;                /*                       @Y30LB52*/
*           END;                    /*                       @Y30LB52*/
@RF00589 DS    0H                                               03S0603
*       END;                        /*                       @Y30LB52*/
@RF00586 LA    @08,1                                            03S0603
         AH    @08,MSC                                          03S0603
         STH   @08,MSC                                          03S0603
         CH    @08,@CH00099                                     03S0603
         BNH   @DL00584                                         03S0603
@DC00584 DS    0H                                               03S0604
*                                                               03S0604
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR THE      */
*       /* VALUES SUPPLIED IN THE ABOVE SEGMENT.                     */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0604
*       DCL                                                     03S0604
*         1 * DEF(OUTLINE),         /*                       @Y30LB52*/
*          2 * CHAR(9),             /*                       @Y30LB52*/
*          2 CNTLRNO CHAR(1),       /* CONTROLLER NUMBER     @Y30LB52*/
*          2 * CHAR(20),            /*                       @ZM34326*/
*          2 *(8) CHAR(5),          /*                       @Y30LB52*/
*           3 ERRCNT1 CHAR(4),      /* EBCDIC COUNT          @ZM34326*/
*           3 * CHAR(1),            /*                       @ZM34326*/
*          2 ERRTOT CHAR(6);        /* ROW TOTAL             @ZA00699*/
*                                                               02S0605
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLWING INCLUDED SEGMENT OF CODE TOALS THE CONTROLLER*/
*       /* /DRIVE ERRORS RECORDED THROUGH HOST CHANNEL-SA PATHS.     */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0605
*                                                               03S0605
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT TOTALS THE DASD ERRORS BY           */
*       /* CNTLR/DRIVE COMBINATION THAT HAVE BEEN ACCUMULATED THROUGH*/
*       /* HOST CHANNEL OPERATIONS(NON-MSC). THE ERRORS ARE TOTALED  */
*       /* IN AN ARRAY WITH ONE ELEMENT FOR EACH CONTROLLER/DRIVE    */
*       /* INTERFACE.                                                */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0605
*       J=SAINTFP+(SAP-1)*12;       /* ADDRESS PROPER SAINTF ENTRY
*                                                            @Y3OLB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0605
         LR    @07,SAP                                          03S0605
         BCTR  @07,0                                            03S0605
         MH    @07,@CH00035                                     03S0605
         AL    @07,SAINTFP(,@08)                                03S0605
         ST    @07,J                                            03S0605
*       DO UINTF=1 TO 3;            /* LOOP THROUGH INTERFACES  03S0606
*                                                            @Y30LB52*/
         LA    @08,1                                            03S0606
         STH   @08,UINTF                                        03S0606
@DL00606 DS    0H                                               03S0607
*         CHCUPTR=J->SAINTF(UINTF); /* ADDRESS CHCUTAB       @Y30LB52*/
         SLA   @08,2                                            03S0607
         L     @04,J                                            03S0607
         AL    @04,@CF00661                                     03S0607
         L     CHCUPTR,SAINTF(@08,@04)                          03S0607
*         IF CHCUPTR^=0             /* IF ADDRESS ZERO       @Y30LB52*/
*           THEN                                                03S0608
         SLR   @08,@08                                          03S0608
         CR    CHCUPTR,@08                                      03S0608
         BE    @RF00608                                         03S0608
*           DO;                     /*                       @Y30LB52*/
*                                                               03S0609
*             /*******************************************************/
*             /*                                                     */
*             /* THE CHCUTAB CONTAINS A POINTER TO AN ACCUMULATOR    */
*             /* ARRAY OF ERRORS LOGGED THROUGH THIS INTERFACE OF THE*/
*             /* SA. IF NON-ZERO, THE ERRORS ARE TOTALED BY          */
*             /* CONTROLLER/DRIVE INTERFACE.                         */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0610
*             IF SPLTABP^=0         /* ACCUMULATOR EXISTS    @Y30LB52*/
*               THEN                                            03S0610
         C     @08,SPLTABP(,CHCUPTR)                            03S0610
         BE    @RF00610                                         03S0610
*               DO;                 /* TOTAL THE ERRORS      @Y30LB52*/
*                 ACCPTR=ADDR(ACCUMTOT);/* ADDRESS C/D TOTALS   03S0612
*                                                            @Y30LB52*/
*                                                               03S0612
         LA    ACCPTR,ACCUMTOT                                  03S0612
*                 /***************************************************/
*                 /*                                                 */
*                 /* LOOP THROUGH THE ENTIRE ACCUMULATOR ARRAY,      */
*                 /* TOTALING THE ERRORS BY CONTROLLER/DRIVE.        */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0613
*                 DO K=1 TO 8;      /* LOOP THROUGH DRIVES   @Y30LB52*/
         LA    K,1                                              03S0613
@DL00613 DS    0H                                               03S0614
*                   RESPECIFY                                   03S0614
*                     SPNDLES BASED(DASDACCP);/*             @Y30LB52*/
*                   RESPECIFY                                   03S0615
*                     SPNDLETB BASED(SPLTABP);/*             @Y30LB52*/
*                   DASDACCP=ADDR(SPNDLETB(I,K));/*          @Y30LB52*/
         LR    @08,I                                            03S0616
         SLA   @08,3                                            03S0616
         ALR   @08,K                                            03S0616
         MH    @08,@CH00058                                     03S0616
         L     @01,SPLTABP(,CHCUPTR)                            03S0616
         AL    @01,@CF00667                                     03S0616
         LA    @08,SPNDLETB(@08,@01)                            03S0616
         ST    @08,DASDACCP                                     03S0616
*                   ACCUM1=ACCUM1+DRVEQCHK;/* DRIVE CHECKS   @Y30LB52*/
         LH    @15,ACCUM1(,ACCPTR)                              03S0617
         AH    @15,DRVEQCHK(,@08)                               03S0617
         STH   @15,ACCUM1(,ACCPTR)                              03S0617
*                   ACCUM1=ACCUM1+STCTLCHK;/* STORAGE CONTROL CHKS
*                                                            @Y30LB52*/
         AH    @15,STCTLCHK(,@08)                               03S0618
         STH   @15,ACCUM1(,ACCPTR)                              03S0618
*                   ACCUM1=ACCUM1+STCTLCCK;/* ST CNTL CNTL CHKS 03S0619
*                                                            @Y30LB52*/
         AH    @15,STCTLCCK(,@08)                               03S0619
         STH   @15,ACCUM1(,ACCPTR)                              03S0619
*                   ACCPTR=ACCPTR+2;/* TO NEXT TOTAL ENTRY   @Y30LB52*/
         AH    ACCPTR,@CH00106                                  03S0620
*                 END;              /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0621
         CH    K,@CH00099                                       03S0621
         BNH   @DL00613                                         03S0621
*               END;                /*                       @Y30LB52*/
*           END;                    /*                       @Y30LB52*/
@RF00610 DS    0H                                               03S0624
*       END;                        /*                       @Y30LB52*/
@RF00608 LA    @08,1                                            03S0624
         AH    @08,UINTF                                        03S0624
         STH   @08,UINTF                                        03S0624
         CH    @08,@CH00103                                     03S0624
         BNH   @DL00606                                         03S0624
*       ACCPTR=ADDR(ACCUMTOT);      /* ADDRESS FIRST TOTAL   @Y30LB52*/
         LA    ACCPTR,ACCUMTOT                                  03S0625
*       RTOTAL=0;                   /* INITIALIZE ROW TOTAL  @Y30LB52*/
         SLR   @08,@08                                          03S0626
         STH   @08,RTOTAL                                       03S0626
*       DO K=1 TO 8;                /* LOOP THROUGH EIGHT DRIVES
*                                                            @Y30LB52*/
         LA    K,1                                              03S0627
@DL00627 DS    0H                                               03S0628
*         LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT COLUMN        03S0628
*                                      TOTAL@Y30LB52         @Y30LB52*/
         LR    @08,K                                            03S0628
         ALR   @08,@08                                          03S0628
         LH    @07,ACCUM1(,ACCPTR)                              03S0628
         LH    @15,LTOTAL-2(@08)                                03S0628
         ALR   @15,@07                                          03S0628
         STH   @15,LTOTAL-2(@08)                                03S0628
*         RTOTAL=RTOTAL+ACCUM1;     /* INCREMENT THE ROW TOTAL  03S0629
*                                                            @Y30LB52*/
         LH    @08,RTOTAL                                       03S0629
         ALR   @08,@07                                          03S0629
         STH   @08,RTOTAL                                       03S0629
*         CVD(ACCUM1,DECNO);        /* CONVERT BINARY STRING TO 03S0630
*                                      DECIMAL               @Y30LB52*/
         CVD   @07,DECNO                                        03S0630
*         ERRCNT1(K)=EDITPAT3;      /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @08,K                                            03S0631
         MH    @08,@CH00101                                     03S0631
         ST    @08,@TF00001                                     03S0631
         ALR   @08,CVTPTR                                       03S0631
         MVC   ERRCNT1-5(4,@08),EDITPAT3                        03S0631
*         ED(ERRCNT1(K),DECNO1);    /* CONVERT TO PRINTABLE HEX 03S0632
*                                                            @ZM34326*/
         LR    @08,CVTPTR                                       03S0632
         AL    @08,@TF00001                                     03S0632
         ED    ERRCNT1-5(4,@08),DECNO1                          03S0632
*         ACCPTR=ACCPTR+2;          /* INCREMENT ACCUMULATOR PTR
*                                                            @Y30LB52*/
         AH    ACCPTR,@CH00106                                  03S0633
*       END;                        /*                       @Y30LB52*/
         AH    K,@CH00045                                       03S0634
         CH    K,@CH00099                                       03S0634
         BNH   @DL00627                                         03S0634
*       ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATORS    @Y30LB52*/
         XC    ACCUMTOT(32),ACCUMTOT                            03S0635
*       CVD(RTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0636
*                                      DECIMAL               @ZA00699*/
         LH    @08,RTOTAL                                       03S0636
         CVD   @08,DECNO                                        03S0636
*       ERRTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   ERRTOT(6,CVTPTR),EDITPAT5                        03S0637
*       ED(ERRTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0638
*                                                            @ZA00699*/
         ED    ERRTOT(6,CVTPTR),DECNO2                          03S0638
*       CNTLRNO=(I-1)×'F0'X;        /* SET CONTROLLER INDEX  @Y30LB52*/
         LR    @08,I                                            03S0639
         BCTR  @08,0                                            03S0639
         O     @08,@CF00511                                     03S0639
         STC   @08,CNTLRNO(,CVTPTR)                             03S0639
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0640
*     END;                          /*                       @Y30LB52*/
*                                                               02S0641
         AH    I,@CH00045                                       02S0641
         CH    I,@CH00055                                       02S0641
         BNH   @DL00582                                         02S0641
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT AND PRINT THE TOTALS LINE                            */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0642
*     OUTLINE=SKIPTWO;              /* SKIP TWO CC           @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0642
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0642
         MVI   OUTLINE(CVTPTR),C'0'                             02S0642
*     DO I=1 TO 8;                  /* LOOP THROUGH 8 DRIVES @Y30LB52*/
         LA    I,1                                              02S0643
@DL00643 DS    0H                                               02S0644
*       CVD(LTOTAL(I),DECNO);       /* CONVERT BINARY STRING TO 02S0644
*                                      DECIMAL               @Y30LB52*/
         LR    @08,I                                            02S0644
         ALR   @08,@08                                          02S0644
         LH    @08,LTOTAL-2(@08)                                02S0644
         CVD   @08,DECNO                                        02S0644
*       ERRCNT1(I)=EDITPAT3;        /* MOVE EDIT PATTERN     @ZM34326*/
         LR    @07,I                                            02S0645
         MH    @07,@CH00101                                     02S0645
         ST    @07,@TF00001                                     02S0645
         ALR   @07,CVTPTR                                       02S0645
         MVC   ERRCNT1-5(4,@07),EDITPAT3                        02S0645
*       ED(ERRCNT1(I),DECNO1);      /* CONVERT TO PRINTABLE HEX 02S0646
*                                                            @ZM34326*/
         LR    @07,CVTPTR                                       02S0646
         AL    @07,@TF00001                                     02S0646
         ED    ERRCNT1-5(4,@07),DECNO1                          02S0646
*       GTOTAL=GTOTAL+LTOTAL(I);    /* INCREMENT GRAND TOTAL @Y30LB52*/
         AH    @08,GTOTAL                                       02S0647
         STH   @08,GTOTAL                                       02S0647
*     END;                          /*                       @Y30LB52*/
         AH    I,@CH00045                                       02S0648
         CH    I,@CH00099                                       02S0648
         BNH   @DL00643                                         02S0648
*     CVD(GTOTAL,DECNO);            /* CONVERT BINARY STRING TO 02S0649
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       02S0649
         CVD   @08,DECNO                                        02S0649
*     ERRTOT=EDITPAT5;              /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   ERRTOT(6,CVTPTR),EDITPAT5                        02S0650
*     ED(ERRTOT,DECNO2);            /* CONVERT TO PRINTABLE HEX 02S0651
*                                                            @ZA00699*/
         ED    ERRTOT(6,CVTPTR),DECNO2                          02S0651
*     CHSTOTL='TOTAL';              /* TOTAL LINE CONSTANT   @Y30LB52*/
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       02S0652
*     CALL P1PRINTL;                /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0653
*     TOTALS=TOTALS&&TOTALS;        /* CLEAR TOTALS          @Y30LB52*/
         XC    TOTALS(76),TOTALS                                02S0654
*   END;                            /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     02S0655
@DE00563 L     @08,CNFG0PTR(,CVTPTR)                            02S0655
         CH    SAP,SANO(,@08)                                   02S0655
         BNH   @DL00563                                         02S0655
*                                                               02S0656
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND CONTAINS A   */
*   /* CONSTANT HEADER FOR THE CONTROLLER/DRIVE ARRAYS.              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0656
*   DCL                                                         02S0656
*     1 CONDRHD STATIC LOCAL,       /*                       @Y30LB52*/
*      2 CONDRHD1,                  /*                       @Y30LB52*/
*       3 * CHAR(1) INIT('-'),      /*                       @Y30LB52*/
*       3 * CHAR(3) INIT('   '),                                02S0656
*       3 * CHAR(27) INIT('CONTROLLER/DRIVE INTERFACE '),/*  @Y30LB52*/
*       3 * CHAR(12) INIT('ERROR COUNTS'),/*                 @Y30LB52*/
*       3 * CHAR(21) INIT('(STAGING ADAPTER 800)'),/*        @ZM31022*/
*                                                               02S0656
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING CONSTANT IS THE HEADER LINE IMMEDIATELY       */
*     /* PRECEDING THE ARRAY.                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0656
*     DRIVEHD CHAR(48) STATIC LOCAL INIT(                       02S0656
*         'DRIVE       A    B    C    D    E    F    G    H'),  02S0656
*                                                               02S0656
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING ARRAY MAPS THE OUTPUT LINE FOR THE PURPOSE OF */
*     /* INSERTING AND PRINTING THE CONSTANTS 'CONTROLLER' AND       */
*     /* 'TOTAL'                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0656
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/
*      2 * CHAR(5),                 /*                       @Y30LB52*/
*      2 DCONTRL CHAR(10),          /*                       @Y30LB52*/
*      2 * CHAR(57),                /*                       @ZA00699*/
*      2 DTOTL CHAR(5);             /*                       @Y30LB52*/
*                                                               01S0657
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE REAL    */
*   /* DEVICE PATH PORTION OF THE PATH ANALYSIS REPORT (3330).       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0657
*                                                               02S0657
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SEGMENT SETS UP THE HEADER LINES FOR THE REAL PATH       */
*   /* PORTION OF THE PATH ANALYSIS REPORT(DASD).                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0657
*   IF MSCTOTAL^=0                  /* ERRORS RECORDED THRO  @Y30LB52*/
*     THEN                                                      02S0657
         L     @08,PAD00PTR(,CVTPTR)                            02S0657
         ICM   @03,3,MSCTOTAL(@08)                              02S0657
         BZ    @RF00657                                         02S0657
*     DO;                           /* MSC, PRODUCE ARRAY    @Y30LB52*/
*       OUTLINE=NEWPAGE;            /* SET NEW PAGE CC       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0659
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0659
         MVI   OUTLINE(CVTPTR),C'1'                             02S0659
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0660
*       OUTLINE=DASDHEAD;           /* SET PA(DASD PORTION) HEAD
*                                                            @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0661
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0661
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0661
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0662
*       OUTLINE=DASDPTHD;           /* SET REPORT SECTION HEAD  02S0663
*                                                            @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0663
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0663
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      02S0663
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0664
*       OUTLINE=DASDCOLH;           /* SET COLUMN HEAD       @Y30LB52*/
         MVI   OUTLINE+102(CVTPTR),C' '                         02S0665
         MVC   OUTLINE+103(30,CVTPTR),OUTLINE+102(CVTPTR)       02S0665
         MVC   OUTLINE(102,CVTPTR),DASDCOLH                     02S0665
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0666
*       OUTLINE=SKIPONE;            /* INDICATE SINGLE LINE SKIP
*                                                            @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0667
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0667
         MVI   OUTLINE(CVTPTR),C' '                             02S0667
*       DASDCL1='CHECK';            /* SET FIRST CONSTANT    @Y30LB52*/
         MVC   DASDCL1(5,CVTPTR),@CC00567                       02S0668
*       DASDCL2='EQUIP CHECK';      /* SET SECOND CONSTANT   @ZM31022*/
         MVC   DASDCL2(11,CVTPTR),@CC00569                      02S0669
*       DASDCL3='CNTL CHECK';       /* THIRD                 @Y30LB52*/
         MVC   DASDCL3(10,CVTPTR),@CC00572                      02S0670
*       CALL P1PRINTL;              /*                       @Y30LB52*/
*                                                               02S0671
         BAL   @14,P1PRINTL                                     02S0671
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND INSERTS THE    */
*       /* ACCUMULATORS INTO THE VALUE PORTION OF THE REPORT AND     */
*       /* PRINTS THE LINES.                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0672
*                                                               03S0672
*       /*************************************************************/
*       /*                                                           */
*       /* THIS SEGMENT FORMATS AND PRINTS THE VALUE LINES FOR THE   */
*       /* REAL PATH PORTION OF THE PATH ANALYSIS REPORT(DASD).      */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0672
*       LINES=45;                   /* INITIALIZE LINES REMAINING
*                                                            @Y30LB52*/
         LA    LINES,45                                         03S0672
*       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH
*                                      ALL MSC'S             @Y30LB52*/
         LA    @08,1                                            03S0673
         STH   @08,MSC                                          03S0673
@DL00673 SLA   @08,3                                            03S0673
         L     @15,PAD00PTR(,CVTPTR)                            03S0673
         ST    @08,@TF00001                                     03S0673
         ALR   @08,@15                                          03S0673
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0673
         BE    @DC00673                                         03S0673
*         IF SATABPTR(MSC)^=0       /* IF ERRORS HAVE BEEN RECORDED
*                                                            @Y30LB52*/
*           THEN                                                03S0674
         L     @08,@TF00001                                     03S0674
         L     @08,SATABPTR-8(@08,@15)                          03S0674
         LTR   @08,@08                                          03S0674
         BZ    @RF00674                                         03S0674
*           DO;                     /* RPREPARE REPORT       @Y30LB52*/
*             SATABP=SATABPTR(MSC); /* LOAD SATAB POINTER    @Y30LB52*/
         LR    SATABP,@08                                       03S0676
*             RESPECIFY                                         03S0677
*               SADRDDSD BASED(SATABP);/*                    @Y30LB52*/
*                                                               03S0677
*             /*******************************************************/
*             /*                                                     */
*             /* LOOP THROUGH ALL SA'S IN THE SUBSYSTEM              */
*             /*                                                     */
*             /*******************************************************/
*                                                               03S0678
*             DO SAP=1 TO SANO;     /*                       @Y30LB52*/
         LA    SAP,1                                            03S0678
         B     @DE00678                                         03S0678
@DL00678 DS    0H                                               03S0679
*               IF SADASDAC(SAP)^=0 /* NON-ZERO PTR INDICATES@Y30LB52
*                                                            @Y30LB52*/
*                 THEN                                          03S0679
         LR    @08,SAP                                          03S0679
         SLA   @08,3                                            03S0679
         AL    @08,@CF00661                                     03S0679
         L     @08,SADASDAC-4(@08,SATABP)                       03S0679
         LTR   @08,@08                                          03S0679
         BZ    @RF00679                                         03S0679
*                 DO;               /* ERRORS THROUGH SA     @Y30LB52*/
*                   DASDACCP=SADASDAC(SAP);/* LOAD POINTER   @Y30LB52*/
         ST    @08,DASDACCP                                     03S0681
*                   OUTLINE=SKIPONE;/* SKIP A LINE           @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0682
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0682
         MVI   OUTLINE(CVTPTR),C' '                             03S0682
*                   CALL P1PRINTL;  /* PRINT                 @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0683
*                   DO I=1 TO 4;    /* LOOP THROUGH ALL POSSIBLE
*                                      CNTLRS                @Y30LB52*/
         LA    I,1                                              03S0684
@DL00684 DS    0H                                               03S0685
*                     DO J=1 TO 8;  /* LOOP THROUGH DRIVES   @Y30LB52*/
         LA    @08,1                                            03S0685
         ST    @08,J                                            03S0685
@DL00685 DS    0H                                               03S0686
*                       OUTLINE=SKIPONE;/* SET SKIP ONE CC   @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0686
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0686
         MVI   OUTLINE(CVTPTR),C' '                             03S0686
*                       UNPK(DECNO(1:4),MSCDRDAC(MSC,1:3));/* UNPACK
*                                      THE HEX STRING PLUS ONE BYTE
*                                                            @Y30LB52*/
         LH    @08,MSC                                          03S0687
         SLA   @08,3                                            03S0687
         L     @04,PAD00PTR(,CVTPTR)                            03S0687
         ALR   @04,@08                                          03S0687
         UNPK  DECNO(4),MSCDRDAC-8(3,@04)                       03S0687
*                       DSDMSC=DECNO(1:3)&'0F0F0F'X;/* TURN OFF THE
*                                      ZONES                 @Y30LB52*/
         MVC   DSDMSC(3,CVTPTR),DECNO                           03S0688
         NC    DSDMSC(3,CVTPTR),@CB00250                        03S0688
*                       TR(DSDMSC,TRTAB);/* TRANSLATE TO        03S0689
*                                      PRINTABLE@Y30LB52 HEXADECIMAL
*                                      CHARACTERS            @Y30LB52*/
         TR    DSDMSC(3,CVTPTR),TRTAB                           03S0689
*                       CALL P1DSDPT2;/*                     @Y30LB52*/
         BAL   @14,P1DSDPT2                                     03S0690
*                     END;          /*                       @Y30LB52*/
         LA    @08,1                                            03S0691
         AL    @08,J                                            03S0691
         ST    @08,J                                            03S0691
         CH    @08,@CH00099                                     03S0691
         BNH   @DL00685                                         03S0691
*                   END;            /*                       @Y30LB52*/
         AH    I,@CH00045                                       03S0692
         CH    I,@CH00055                                       03S0692
         BNH   @DL00684                                         03S0692
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
@RF00679 AH    SAP,@CH00045                                     03S0694
@DE00678 L     @08,CNFG0PTR(,CVTPTR)                            03S0694
         CH    SAP,SANO(,@08)                                   03S0694
         BNH   @DL00678                                         03S0694
*           END;                    /*                       @Y30LB52*/
*       END;                        /*                       @Y30LB52*/
@RF00674 LA    @08,1                                            03S0696
         AH    @08,MSC                                          03S0696
         STH   @08,MSC                                          03S0696
         CH    @08,@CH00099                                     03S0696
         BNH   @DL00673                                         03S0696
@DC00673 DS    0H                                               03S0697
*       CALL P1DSDPT3;              /* CALL FOR TOTALS LINE  @Y30LB52*/
         BAL   @14,P1DSDPT3                                     03S0697
*P1DSDPT2:                                                      04S0698
*       PROCEDURE OPTIONS(SAVE(14));/*                       @Y30LB52*/
         B     @PB00004                                         04S0698
P1DSDPT2 ST    @14,@SA00004                                     04S0698
*       RESPECIFY                                               04S0699
*         SPNDLETB BASED(DASDACCP); /*                       @Y30LB52*/
*       K=ADDR(SPNDLETB(I,J));      /* LOAD ACCUMS ADDRESS   @Y30LB52*/
         LR    @08,I                                            04S0700
         SLA   @08,3                                            04S0700
         AL    @08,J                                            04S0700
         MH    @08,@CH00058                                     04S0700
         L     K,DASDACCP                                       04S0700
         AL    K,@CF00667                                       04S0700
         LA    K,SPNDLETB(@08,K)                                04S0700
*       RESPECIFY                                               04S0701
*         SPNDLES BASED(K);         /*                       @Y30LB52*/
*       IF SPNDLES^='000000000000'X /* IF NON-ZERO TOTALS    @Y30LB52*/
*         THEN                                                  04S0702
         CLC   SPNDLES(6,K),@CB00313                            04S0702
         BE    @RF00702                                         04S0702
*         DO;                       /* THEN OUTPUT           @Y30LB52*/
*           LINES=LINES-1;          /* DECREMENT LINES REMAINING
*                                                            @Y30LB52*/
         BCTR  LINES,0                                          04S0704
*           IF LINES=0              /* END OF PAGE?          @Y30LB52*/
*             THEN                                              04S0705
         LTR   LINES,LINES                                      04S0705
         BNZ   @RF00705                                         04S0705
*             DO;                   /* NEW PAGE              @Y30LB52*/
*               OUTLINE=NEWPAGE;    /* SET NEW PAGE CC       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0707
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0707
         MVI   OUTLINE(CVTPTR),C'1'                             04S0707
*               CALL P1PRINTL;      /* PRINT                 @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0708
*               OUTLINE=DASDHEAD;   /* DASD HEADER           @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          04S0709
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         04S0709
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      04S0709
*               CALL P1PRINTL;      /* PRINT IT              @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0710
*               OUTLINE=DASDPTHD;   /* DASD PATH HEAD        @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          04S0711
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         04S0711
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      04S0711
*               CALL P1PRINTL;      /* PRINT                 @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0712
*               LINES=45;           /* RESET LINES REMAINING @Y30LB52*/
         LA    LINES,45                                         04S0713
*             END;                  /*                       @Y30LB52*/
*                                                               04S0714
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT THE PATH FOR THE ERRORS                        */
*           /*                                                       */
*           /*********************************************************/
*                                                               04S0715
*           DSDSA='800';            /* SA SSID               @Y30LB52*/
@RF00705 MVC   DSDSA(3,CVTPTR),@CC00390                         04S0715
*           DSDSA(2)=DSDSA(2)×(SAP-1);/* SA INDEX            @Y30LB52*/
         LR    @08,SAP                                          04S0716
         BCTR  @08,0                                            04S0716
         SLR   @15,@15                                          04S0716
         IC    @15,DSDSA+1(,CVTPTR)                             04S0716
         OR    @08,@15                                          04S0716
         STC   @08,DSDSA+1(,CVTPTR)                             04S0716
*           DSDCNTL='00';           /* CONTROLLER            @Y30LB52*/
         MVC   DSDCNTL(2,CVTPTR),@CC00585                       04S0717
*           DSDCNTL(2)=DSDCNTL(2)×(I-1);/* CNTLR INDEX       @Y30LB52*/
         LR    @08,I                                            04S0718
         BCTR  @08,0                                            04S0718
         SLR   @15,@15                                          04S0718
         IC    @15,DSDCNTL+1(,CVTPTR)                           04S0718
         OR    @08,@15                                          04S0718
         STC   @08,DSDCNTL+1(,CVTPTR)                           04S0718
*           DSDDRV='C0'X+J;         /* DRIVE IDENTIFICATION  @Y30LB52*/
*                                                               04S0719
         LA    @08,192                                          04S0719
         AL    @08,J                                            04S0719
         STC   @08,DSDDRV(,CVTPTR)                              04S0719
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT THE ACCUMULATOR COUNTS                         */
*           /*                                                       */
*           /*********************************************************/
*                                                               04S0720
*           RTOTAL=0;               /* CLEAR ROW TOTAL       @Y30LB52*/
         SLR   @08,@08                                          04S0720
         STH   @08,RTOTAL                                       04S0720
*           CVD(DRVEQCHK,DECNO);    /* CONVERT BINARY STRING TO 04S0721
*                                      DECIMAL               @ZA00699*/
         LH    @15,DRVEQCHK(,K)                                 04S0721
         CVD   @15,DECNO                                        04S0721
*           DSDCNT(1)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DSDCNT(6,CVTPTR),EDITPAT5                        04S0722
*           ED(DSDCNT(1),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0723
*                                                            @ZA00699*/
         ED    DSDCNT(6,CVTPTR),DECNO2                          04S0723
*           LTOTAL(1)=LTOTAL(1)+DRVEQCHK;/* INCREMENT COLUMN TOT
*                                                            @Y30LB52*/
         LH    @14,LTOTAL                                       04S0724
         ALR   @14,@15                                          04S0724
         STH   @14,LTOTAL                                       04S0724
*           RTOTAL=RTOTAL+DRVEQCHK; /* INCREMENT ROW         @Y30LB52*/
         ALR   @08,@15                                          04S0725
         STH   @08,RTOTAL                                       04S0725
*           CVD(STCTLCHK,DECNO);    /* CONVERT BINARY STRING TO 04S0726
*                                      DECIMAL               @ZA00699*/
         LH    @15,STCTLCHK(,K)                                 04S0726
         CVD   @15,DECNO                                        04S0726
*           DSDCNT(2)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DSDCNT+14(6,CVTPTR),EDITPAT5                     04S0727
*           ED(DSDCNT(2),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0728
*                                                            @ZA00699*/
         ED    DSDCNT+14(6,CVTPTR),DECNO2                       04S0728
*           LTOTAL(2)=LTOTAL(2)+STCTLCHK;/* INCREMENT TOT    @Y30LB52*/
         LH    @14,LTOTAL+2                                     04S0729
         ALR   @14,@15                                          04S0729
         STH   @14,LTOTAL+2                                     04S0729
*           RTOTAL=RTOTAL+STCTLCHK; /* INCREMENT ROW         @Y30LB52*/
         ALR   @08,@15                                          04S0730
         STH   @08,RTOTAL                                       04S0730
*           CVD(STCTLCCK,DECNO);    /* CONVERT BINARY STRING TO 04S0731
*                                      DECIMAL               @ZA00699*/
         LH    @15,STCTLCCK(,K)                                 04S0731
         CVD   @15,DECNO                                        04S0731
*           DSDCNT(3)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DSDCNT+28(6,CVTPTR),EDITPAT5                     04S0732
*           ED(DSDCNT(3),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0733
*                                                            @ZA00699*/
         ED    DSDCNT+28(6,CVTPTR),DECNO2                       04S0733
*           LTOTAL(3)=LTOTAL(3)+STCTLCCK;/* INCREMENT TOT    @Y30LB52*/
         LH    @14,LTOTAL+4                                     04S0734
         ALR   @14,@15                                          04S0734
         STH   @14,LTOTAL+4                                     04S0734
*           RTOTAL=RTOTAL+STCTLCCK; /* INCREMENT ROW         @Y30LB52*/
         ALR   @08,@15                                          04S0735
         STH   @08,RTOTAL                                       04S0735
*           CVD(RTOTAL,DECNO);      /* CONVERT BINARY STRING TO 04S0736
*                                      DECIMAL               @ZA00699*/
         CVD   @08,DECNO                                        04S0736
*           DSDTOTL=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DSDTOTL(6,CVTPTR),EDITPAT5                       04S0737
*           ED(DSDTOTL,DECNO2);     /* CONVERT TO PRINTABLE HEX 04S0738
*                                                            @ZA00699*/
         ED    DSDTOTL(6,CVTPTR),DECNO2                         04S0738
*           RTOTAL=RTOTAL*1000/(MSCTOTAL+HTOTAL);/* CALCULATE PERCENT
*                                      ERR                   @ZM34326*/
         MH    @08,@CH00402                                     04S0739
         L     @04,PAD00PTR(,CVTPTR)                            04S0739
         LH    @15,MSCTOTAL(,@04)                               04S0739
         AH    @15,HTOTAL(,@04)                                 04S0739
         LR    @00,@08                                          04S0739
         SRDA  @00,32                                           04S0739
         DR    @00,@15                                          04S0739
         STH   @01,RTOTAL                                       04S0739
*           CVD(RTOTAL,DECNO);      /* CONVERT TO DECIMAL    @ZM34326*/
         CVD   @01,DECNO                                        04S0740
*           DSDPTOT=EDITPATP;       /* MOVE PERCENT PATTERN  @ZM34326*/
         MVC   DSDPTOT(7,CVTPTR),EDITPATP                       04S0741
*           ED(DSDPTOT,DECNO2);     /* EDIT PERCENTAGE       @ZM34326*/
         ED    DSDPTOT(7,CVTPTR),DECNO2                         04S0742
*           CALL P1PRINTL;          /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0743
*         END;                      /*                       @Y30LB52*/
*     END P1DSDPT2;                 /*                       @Y30LB52*/
@EL00004 DS    0H                                               04S0745
@EF00004 DS    0H                                               04S0745
@ER00004 L     @14,@SA00004                                     04S0745
         BR    @14                                              04S0745
@PB00004 DS    0H                                               04S0746
*   DCL                                                         03S0746
*                                                               03S0746
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND IS USED TO */
*     /* STORE THE VALUE LINES.                                      */
*     /*                                                             */
*     /***************************************************************/
*                                                               03S0746
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/
*      2 * CHAR(5),                 /*                       @Y30LB52*/
*      2 DSDMSC CHAR(3),            /* MSC ADDRESS           @Y30LB52*/
*      2 * CHAR(2),                 /*                       @Y30LB52*/
*      2 DSDSA CHAR(3),             /*                       @Y30LB52*/
*      2 * CHAR(6),                 /*                       @Y30LB52*/
*      2 DSDCNTL CHAR(2),           /* DASD CNTLR            @Y30LB52*/
*      2 * CHAR(13),                /*                       @Y30LB52*/
*      2 DSDDRV CHAR(1),            /* DRIVE ID              @Y30LB52*/
*      2 * CHAR(10),                /*                       @ZA00699*/
*      2 *(3) CHAR(14),             /*                       @Y30LB52*/
*       3 DSDCNT CHAR(6),           /* ACCUMULATOR COUNT     @ZA00699*/
*       3 * CHAR(8),                /*                       @ZA00699*/
*      2 DSDTOTL CHAR(6),           /* ROW TOTAL             @ZA00699*/
*      2 * CHAR(1),                 /* SPACE                 @ZM34326*/
*      2 DSDPTOT CHAR(7),           /* PERCENTAGE            @ZM34326*/
*     DRDCOLTC CHAR(5) DEF(DSDDRV); /* TOTAL CONSTANT        @Y30LB52*/
*   END;                            /*                       @Y30LB52*/
*                                                               02S0747
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION FORMATS THE CONSTANT HEADERS FOR THE REAL PATH   */
*   /* ARRAY(HOST 3330).                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0748
*   IF HTOTAL^=0                    /* ERRORS RECORDED THRO  @Y30LB52*/
*     THEN                                                      02S0748
@RF00657 L     @08,PAD00PTR(,CVTPTR)                            02S0748
         ICM   @03,3,HTOTAL(@08)                                02S0748
         BZ    @RF00748                                         02S0748
*     DO;                           /* HOST CHANNELS?        @Y30LB52*/
*       OUTLINE=NEWPAGE;            /* SET NEW PAGE CC       @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0750
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0750
         MVI   OUTLINE(CVTPTR),C'1'                             02S0750
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0751
*       OUTLINE=DASDHEAD;           /* SET PA(DASD PORTION) HEAD
*                                                            @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0752
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0752
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0752
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0753
*       OUTLINE=DASDPTHD;           /* SET REPORT SECTION HEAD  02S0754
*                                                            @Y30LB52*/
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0754
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0754
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      02S0754
*       DSDTYPE='HOST';             /* INDICATE 'HOST' 3330  @Y30LB52*/
         MVC   DSDTYPE(4,CVTPTR),@CC00603                       02S0755
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0756
*       OUTLINE=DASDCOLH;           /* SET COLUMN HEAD       @Y30LB52*/
         MVI   OUTLINE+102(CVTPTR),C' '                         02S0757
         MVC   OUTLINE+103(30,CVTPTR),OUTLINE+102(CVTPTR)       02S0757
         MVC   OUTLINE(102,CVTPTR),DASDCOLH                     02S0757
*       HOSTXX='   ';               /* BLANK MSC HEADER      @ZM31069*/
         MVC   HOSTXX(3,CVTPTR),@CC00279                        02S0758
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0759
*       OUTLINE=SKIPONE;            /* INDICATE SINGLE LINE SKIP
*                                                            @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0760
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0760
         MVI   OUTLINE(CVTPTR),C' '                             02S0760
*       DASDCL1='CHECK';            /* SET FIRST CONSTANT    @Y30LB52*/
         MVC   DASDCL1(5,CVTPTR),@CC00567                       02S0761
*       DASDCL2='EQUIP CHECK';      /* SET SECOND CONSTANT   @ZM31022*/
         MVC   DASDCL2(11,CVTPTR),@CC00569                      02S0762
*       DASDCL3='CNTL CHECK';       /* THIRD                 @Y30LB52*/
         MVC   DASDCL3(10,CVTPTR),@CC00572                      02S0763
*       CALL P1PRINTL;              /*                       @Y30LB52*/
         BAL   @14,P1PRINTL                                     02S0764
*                                                               03S0765
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING SEGMENT OF CODE FORMATS AND PRINTS THE HOST */
*       /* CHANNEL PORTION OF THE REAL PATH ARRAY IN THE PATH        */
*       /* ANALYSIS REPORT(DASD).                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0765
*       LINES=45;                   /* SETLINES REMAINING    @Y30LB52*/
         LA    LINES,45                                         03S0765
*       SATABP=SAINTFP;             /* LOAD UPPER INTF BASE  @Y30LB52*/
         L     @08,CNFG0PTR(,CVTPTR)                            03S0766
         L     SATABP,SAINTFP(,@08)                             03S0766
*       RESPECIFY                                               03S0767
*         SAINTF BASED(SATABP);     /*                       @Y30LB52*/
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @YM32170*/
*                                                               03S0768
         XC    TOTALS(76),TOTALS                                03S0768
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THROUGH ALL SA'S IN THE SUBSYSTEM                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               03S0769
*       DO SAP=1 TO SANO;           /*                       @Y30LB52*/
         LA    SAP,1                                            03S0769
         B     @DE00769                                         03S0769
@DL00769 DS    0H                                               03S0770
*         OUTLINE=SKIPONE;          /* SKIP ONE BETWEEN SA'S @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0770
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0770
         MVI   OUTLINE(CVTPTR),C' '                             03S0770
*         CALL P1PRINTL;            /* PRINT                 @Y30LB52*/
         BAL   @14,P1PRINTL                                     03S0771
*         DO UINTF=1 TO 3;          /* LOOP THROUGH ALL UPPER@Y30LB52
*                                      INTERFACES            @Y30LB52*/
         LA    @08,1                                            03S0772
         STH   @08,UINTF                                        03S0772
@DL00772 DS    0H                                               03S0773
*           IF SAINTF(UINTF)^=0     /* INTERFACE IN USE?     @Y30LB52*/
*             THEN                                              03S0773
         SLR   @15,@15                                          03S0773
         SLA   @08,2                                            03S0773
         AL    @08,@CF00661                                     03S0773
         L     @08,SAINTF(@08,SATABP)                           03S0773
         CR    @08,@15                                          03S0773
         BE    @RF00773                                         03S0773
*             DO;                   /* CHECK FOR ERRORS RECORDED
*                                                            @Y30LB52*/
*               RESPECIFY                                       03S0775
*                 CHCUTAB BASED(SAINTF(UINTF));/*            @Y30LB52*/
*               IF SPLTABP^=0       /* IF AN ACCUMULATOR BLOCK IS
*                                      PRESENT               @Y30LB52*/
*                 THEN                                          03S0776
         L     @08,SPLTABP(,@08)                                03S0776
         CR    @08,@15                                          03S0776
         BE    @RF00776                                         03S0776
*                 DO;               /* FORMAT ERRORS BELOW   @Y30LB52*/
*                   DASDACCP=SPLTABP;/* LOAD ACCUMULATOR ADDRESS
*                                                            @Y30LB52*/
*                                                               03S0778
         ST    @08,DASDACCP                                     03S0778
*                   /*************************************************/
*                   /*                                               */
*                   /* LOOP THROUGH ALL CONTROLLERS AND DRIVES       */
*                   /* CHECKING FOR NONZERO ERROR COUNTS.            */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0779
*                   DO I=1 TO 4;    /* FOUR POSSIBLE CNTLR'S @Y30LB52*/
         LA    I,1                                              03S0779
@DL00779 DS    0H                                               03S0780
*                     DO J=1 TO 8;  /* EIGHT POSSIBLE DRIVES @Y30LB52*/
         LA    @08,1                                            03S0780
         ST    @08,J                                            03S0780
@DL00780 DS    0H                                               03S0781
*                       OUTLINE=SKIPONE;/* SET SINGLE LINE SKIP 03S0781
*                                                            @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0781
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0781
         MVI   OUTLINE(CVTPTR),C' '                             03S0781
*                       CALL P1DSDPT2;/* FORMAT AND PRINT LINE  03S0782
*                                                            @Y30LB52*/
         BAL   @14,P1DSDPT2                                     03S0782
*                     END;          /*                       @Y30LB52*/
         LA    @08,1                                            03S0783
         AL    @08,J                                            03S0783
         ST    @08,J                                            03S0783
         CH    @08,@CH00099                                     03S0783
         BNH   @DL00780                                         03S0783
*                   END;            /*                       @Y30LB52*/
         AH    I,@CH00045                                       03S0784
         CH    I,@CH00055                                       03S0784
         BNH   @DL00779                                         03S0784
*                 END;              /*                       @Y30LB52*/
*             END;                  /*                       @Y30LB52*/
@RF00776 DS    0H                                               03S0787
*         END;                      /*                       @Y30LB52*/
@RF00773 LA    @08,1                                            03S0787
         AH    @08,UINTF                                        03S0787
         STH   @08,UINTF                                        03S0787
         CH    @08,@CH00103                                     03S0787
         BNH   @DL00772                                         03S0787
*         SATABP=SATABP+12;         /* INCREMENT TO NEXT INTERFACE
*                                      ENTRY                 @Y30LB52*/
         AH    SATABP,@CH00035                                  03S0788
*       END;                        /*                       @Y30LB52*/
         AH    SAP,@CH00045                                     03S0789
@DE00769 L     @08,CNFG0PTR(,CVTPTR)                            03S0789
         CH    SAP,SANO(,@08)                                   03S0789
         BNH   @DL00769                                         03S0789
*       CALL P1DSDPT3;              /* CALL FOR TOTALS LINE  @Y30LB52*/
         BAL   @14,P1DSDPT3                                     03S0790
*P1DSDPT3:                                                      04S0791
*       PROCEDURE OPTIONS(SAVE(14));/*                       @Y30LB52*/
*                                                               04S0791
         B     @PB00005                                         04S0791
P1DSDPT3 ST    @14,@SA00005                                     04S0791
*       /*************************************************************/
*       /*                                                           */
*       /* THIS PROCEDURE PRODUCES THE TOTALS LINE THE REAL DEVICE   */
*       /* PATH PORTION OF THE 3330 REPORT.                          */
*       /*                                                           */
*       /*************************************************************/
*                                                               04S0792
*       OUTLINE=SKIPTWO;            /* SKIP 2 LINES          @Y30LB52*/
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0792
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0792
         MVI   OUTLINE(CVTPTR),C'0'                             04S0792
*       DRDCOLTC='TOTAL';           /* SET 'TOTAL' CONSTANT  @Y30LB52*/
         MVC   DRDCOLTC(5,CVTPTR),@CC00240                      04S0793
*       DO I=1 TO 3;                /* LOOP THRO THREE CNTS  @Y30LB52*/
         LA    I,1                                              04S0794
@DL00794 DS    0H                                               04S0795
*         CVD(LTOTAL(I),DECNO);     /* CONVERT BINARY STRING TO 04S0795
*                                      DECIMAL               @ZA00699*/
         LR    @08,I                                            04S0795
         ALR   @08,@08                                          04S0795
         LH    @08,LTOTAL-2(@08)                                04S0795
         CVD   @08,DECNO                                        04S0795
*         DSDCNT(I)=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         LR    @04,I                                            04S0796
         MH    @04,@CH00245                                     04S0796
         ST    @04,@TF00001                                     04S0796
         ALR   @04,CVTPTR                                       04S0796
         MVC   DSDCNT-14(6,@04),EDITPAT5                        04S0796
*         ED(DSDCNT(I),DECNO2);     /* CONVERT TO PRINTABLE HEX 04S0797
*                                                            @ZA00699*/
         LR    @04,CVTPTR                                       04S0797
         AL    @04,@TF00001                                     04S0797
         ED    DSDCNT-14(6,@04),DECNO2                          04S0797
*         GTOTAL=GTOTAL+LTOTAL(I);  /* GRAND TOTAL           @Y30LB52*/
         AH    @08,GTOTAL                                       04S0798
         STH   @08,GTOTAL                                       04S0798
*       END;                        /*                       @Y30LB52*/
         AH    I,@CH00045                                       04S0799
         CH    I,@CH00103                                       04S0799
         BNH   @DL00794                                         04S0799
*       CVD(GTOTAL,DECNO);          /* CONVERT BINARY STRING TO 04S0800
*                                      DECIMAL               @ZA00699*/
         LH    @08,GTOTAL                                       04S0800
         CVD   @08,DECNO                                        04S0800
*       DSDTOTL=EDITPAT5;           /* 5 DIGIT EDIT PATTERN  @ZA00699*/
         MVC   DSDTOTL(6,CVTPTR),EDITPAT5                       04S0801
*       ED(DSDTOTL,DECNO2);         /* CONVERT TO PRINTABLE HEX 04S0802
*                                                            @ZA00699*/
         ED    DSDTOTL(6,CVTPTR),DECNO2                         04S0802
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/
         BAL   @14,P1PRINTL                                     04S0803
*     END P1DSDPT3;                 /*                       @Y30LB52*/
@EL00005 DS    0H                                               04S0804
@EF00005 DS    0H                                               04S0804
@ER00005 L     @14,@SA00005                                     04S0804
         BR    @14                                              04S0804
@PB00005 DS    0H                                               04S0805
*   END;                            /*                       @Y30LB52
*                                                            @Y30LB52*/
*                                                               02S0806
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE IS A MAP OF THE DASD REAL PATH HEADER */
*   /* LINE.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0806
*   DCL                                                         02S0806
*     1 DASDPTHD STATIC LOCAL,      /*                       @Y30LB52*/
*      2 * CHAR(1) INIT(SKIPTWO),   /* CC                    @Y30LB52*/
*      2 * CHAR(57) INIT(                                       02S0806
*            'ERROR COUNTS BY REAL DEVICE PATH(MSC  DASD OPERATIONS)'),
*                                                               02S0806
*     /***************************************************************/
*     /*                                                             */
*     /* THE FOLLOWING STRUCTURE IS A MAP OF THE OUTPUT LINE.        */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0806
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/
*      2 * CHAR(5),                 /*                       @ZM31069*/
*      2 HOSTXX CHAR(3),            /* OVERLAY MSC           @ZM31069*/
*      2 * CHAR(26),                /*                       @ZM31069*/
*      2 DSDTYPE CHAR(4),           /*                       @Y30LB52*/
*      2 * CHAR(9),                 /*                       @Y30LB52*/
*      2 DASDCL1 CHAR(5),           /*                       @Y30LB52*/
*      2 * CHAR(6),                 /*                       @ZM31022*/
*      2 DASDCL2 CHAR(11),          /*                       @ZM31022*/
*      2 * CHAR(4),                 /*                       @ZM31022*/
*      2 DASDCL3 CHAR(10),          /*                       @Y30LB52*/
*                                                               02S0806
*     /***************************************************************/
*     /*                                                             */
*     /* THIS STRUCTURE IS THE DASD REAL PATH ARRAY COLUMN HEADER.   */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0806
*     1 DASDCOLH STATIC LOCAL,                                  02S0806
*      2 * CHAR(1) INIT(SKIPTWO),   /*                       @Y30LB52*/
*      2 * CHAR(4) INIT('    '),    /*                       @Y30LB52*/
*      2 * CHAR(3) INIT('MSC'),     /*                       @Y30LB52*/
*      2 * CHAR(2) INIT('  '),      /*                       @Y30LB52*/
*      2 * CHAR(6) INIT('SA    '),  /*                       @Y30LB52*/
*      2 * CHAR(16) INIT('CONTROLLER'),/*                    @Y30LB52*/
*      2 * CHAR(13) INIT('DRIVE'),  /*                       @Y30LB52*/
*      2 * CHAR(13) INIT('DRIVE EQUIP'),/*                   @Y30LB52*/
*      2 *(2) CHAR(14) INIT(' DIRECTOR   ','  DIRECTOR  '),/*   02S0806
*                                                            @ZM31022*/
*      2 * CHAR(3) INIT('   '),     /*                       @Y30LB52*/
*      2 * CHAR(7) INIT('TOTAL'),   /*                       @Y30LB52*/
*      2 * CHAR(6) INIT('%ERROR');  /*                       @Y30LB52*/
@RF00748 DS    0H                                               02S0807
*   END;                            /*                       @Y30LB52*/
*   RESPECIFY                                                   01S0808
*    (R1) RESTRICTED;               /*                       @Y30LB52*/
@RF00472 DS    0H                                               01S0809
*   RESPECIFY                                                   01S0809
*     P0WORK1 BASED(COREADDR);      /*                       @Y30LB52*/
*   COREADDR=PAD00PTR;              /* LOAD FIRST BLK ADDR   @Y30LB52*/
         MVC   COREADDR(4,CVTPTR),PAD00PTR(CVTPTR)              01S0810
*   SPNO=2;                         /* SUBPOOL NUMBER        @Y30LB52*/
         MVI   SPNO(CVTPTR),X'02'                               01S0811
*   CORELEN=2048;                   /* BLOCK LENGTH          @Y30LB52*/
*                                                               01S0812
         MVC   CORELEN(3,CVTPTR),@CF00646+1                     01S0812
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH ALL BLOCKS AND FREE THEM.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0813
*   DO WHILE(COREADDR^=0);          /*                       @Y30LB52*/
         B     @DE00813                                         01S0813
@DL00813 DS    0H                                               01S0814
*     R1=ADDR(WORKCALL);            /* LOAD PARMLIST ADDRESS @Y30LB52*/
         LA    R1,WORKCALL(,CVTPTR)                             01S0814
*     I=PADFPTR1;                   /* LOAD THE NEXT BLOCK AD   01S0815
*                                                            @Y30LB52*/
         L     @08,COREADDR(,CVTPTR)                            01S0815
         L     I,PADFPTR1(,@08)                                 01S0815
*     CALL ISDAFREE;                /* FREE THE BLOCK        @Y30LB52*/
         L     @15,@CV00117                                     01S0816
         BALR  @14,@15                                          01S0816
*     COREADDR=I;                   /* LOAD THE NEXT BLOCK AD   01S0817
*                                                            @Y30LB52*/
         ST    I,COREADDR(,CVTPTR)                              01S0817
*   END;                            /*                       @Y30LB52*/
@DE00813 ICM   @08,15,COREADDR(CVTPTR)                          01S0818
         BNZ   @DL00813                                         01S0818
*   RETURN CODE(0);                 /*                       @Y30LB52
*                                                            @Y30LB52*/
         L     @13,4(,@13)                                      01S0819
         L     @00,@SIZDATD                                     01S0819
         LR    @01,@09                                          01S0819
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                          01S0819
         L     @14,12(,@13)                                     01S0819
         LM    @00,@12,20(@13)                                  01S0819
         BR    @14                                              01S0819
*P1PRINTL:                                                      02S0820
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/
*                                                               02S0820
P1PRINTL ST    @14,@SA00006                                     02S0820
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PROCEDURE SETS AND CALLS THE SDA PRINT ROUTINE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0821
*   RESPECIFY                                                   02S0821
*     R1 RESTRICTED;                /*                       @Y30LB52*/
*   R1=ADDR(WORKCALL);              /* LOAD PARM LIST ADDR   @Y30LB52*/
         LA    R1,WORKCALL(,CVTPTR)                             02S0822
*   CALL ISDAPRT0;                  /* PRINT THE LINE        @Y30LB52*/
         L     @15,@CV00053                                     02S0823
         BALR  @14,@15                                          02S0823
*   RESPECIFY                                                   02S0824
*     R1 UNRESTRICTED;              /*                       @Y30LB52*/
*   RETURN;                         /*                       @Y30LB52*/
@EL00006 DS    0H                                               02S0825
@EF00006 DS    0H                                               02S0825
@ER00006 L     @14,@SA00006                                     02S0825
         BR    @14                                              02S0825
*   END P1PRINTL;                   /*                       @Y30LB52*/
*   END ISDAPAD1                    /*                       @Y30LB52*/
*                                                               01S0827
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                       */
*/*%INCLUDE SYSLIB  (ISDAPAD5)                                       */
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */
*/*%INCLUDE SYSUT5  (P1MSCSA )                                       */
*/*%INCLUDE SYSUT5  (P1MSCSAV)                                       */
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */
*/*%INCLUDE SYSUT5  (P1SADRC )                                       */
*/*%INCLUDE SYSUT5  (P1SADRCV)                                       */
*/*%INCLUDE SYSUT5  (P1SADRC1)                                       */
*/*%INCLUDE SYSUT5  (P1DRCD  )                                       */
*/*%INCLUDE SYSUT5  (P1DRDVL0)                                       */
*/*%INCLUDE SYSUT5  (P1DRDVL1)                                       */
*/*%INCLUDE SYSUT5  (P1DPATH )                                       */
*/*%INCLUDE SYSUT5  (P1DPATHV)                                       */
*/*%INCLUDE SYSUT5  (P1DPATH1)                                       */
*/*%INCLUDE SYSUT5  (P1DPATH2)                                       */
*/*%INCLUDE SYSUT5  (P1MSCSA1)                                       */
*/*%INCLUDE SYSUT5  (P1CHSA  )                                       */
*/*%INCLUDE SYSUT5  (P1CHSAV )                                       */
*/*%INCLUDE SYSUT5  (P1SACON )                                       */
*/*%INCLUDE SYSUT5  (P1SACONV)                                       */
*/*%INCLUDE SYSUT5  (P1SACON1)                                       */
*/*%INCLUDE SYSUT5  (P1SACON3)                                       */
*/*%INCLUDE SYSUT5  (P1SACON2)                                       */
*/*%INCLUDE SYSUT5  (P1CONDR )                                       */
*/*%INCLUDE SYSUT5  (P1CDTOT1)                                       */
*/*%INCLUDE SYSUT5  (P1CDTOT2)                                       */
*/*%INCLUDE SYSUT5  (P1DSDPTH)                                       */
*/*%INCLUDE SYSUT5  (P1DSDPTV)                                       */
*/*%INCLUDE SYSUT5  (P1DSDPT2)                                       */
*/*%INCLUDE SYSUT5  (P1DSDPT1)                                       */
*/*%INCLUDE SYSUT5  (P1DSDPT3)                                       */
*/*%INCLUDE SYSUT5  (P1PRINTL)                                       */
*                                                               01S0827
*       ;                                                       01S0827
@DATA    DS    0H
@CH00045 DC    H'1'
@CH00106 DC    H'2'
@CH00055 DC    H'4'
@CH00101 DC    H'5'
@CH00058 DC    H'6'
@CH00099 DC    H'8'
@CH00033 DC    H'10'
@CH00035 DC    H'12'
@CH00245 DC    H'14'
@CH00210 DC    H'24'
@CH00555 DC    H'48'
@CH00402 DC    H'1000'
@CH00651 DC    H'-190'
@CH00650 DC    H'-94'
@CH00654 DC    H'-46'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@SA00006 DS    0F
         DS    1F
@TF00001 DS    F
@TF00002 DS    F
ISDAPAD1 CSECT
         DS    0F
@CF00103 DC    F'3'
@CH00103 EQU   @CF00103+2
@CF00084 DC    F'16'
@CH00084 EQU   @CF00084+2
@CF00646 DC    F'2048'
@CF00667 DC    F'-54'
@CF00666 DC    F'-48'
@CF00664 DC    F'-30'
@CF00660 DC    F'-8'
@CF00661 DC    F'-4'
@CF00662 DC    F'-3'
@CF00663 DC    F'-1'
@CF00310 DC    XL4'0F'
@CF00511 DC    XL4'F0'
@CF00073 DC    XL3'0'
         DC    C'0'
@DATD    DSECT
         DS    0D
J        DS    A
DRDACCP  DS    A
DRDACCE  DS    A
LTPDRDP  DS    A
DRDSPTR  DS    A
ARRAY    DS    H
MSF      DS    H
MSC      DS    H
DRC      DS    H
UINTF    DS    H
DRCP     DS    H
FLAGS    DS    CL1
         ORG   FLAGS
DASD     DS    BL1
@NM00001 EQU   FLAGS+0
         ORG   FLAGS+1
         DS    CL7
TOTALS   DS    CL76
         ORG   TOTALS
ACCUMTOT DS    CL32
DECNO    DS    CL8
         ORG   DECNO
@NM00002 DS    CL5
DECNO2   DS    CL3
         ORG   DECNO2
@NM00003 DS    CL1
DECNO1   DS    CL2
         ORG   TOTALS+40
RTOTAL   DS    FL2
LTOTAL   DS    16H
GTOTAL   DS    FL2
         ORG   TOTALS+76
VSADRC   DS    CL16
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAPAD1 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00053 DC    V(ISDAPRT0)
@CV00117 DC    V(ISDAFREE)
         DS    0D
@CC00569 DC    C'EQUIP CHECK'
@CC00500 DC    C'CONTROLLER'
@CC00572 DC    C'CNTL CHECK'
@CC00467 DC    C'INTERFACE'
@CC00465 DC    C'CHANNEL'
@CC00240 DC    C'TOTAL'
@CC00383 DC    C'ERROR'
@CC00567 DC    C'CHECK'
@CC00065 DC    C'    '
@CC00067 DC    C'   *'
@CC00340 DC    C' 200'
@CC00603 DC    C'HOST'
@CC00238 DC    C'MSC'
@CC00279 EQU   @CC00065
@CC00307 DC    C'DRC'
@CC00316 DC    C'400'
@CC00338 DC    C'DRD'
@CC00390 DC    C'800'
@CC00396 DC    C'200'
@CC00585 DC    C'00'
@CB00303 DC    X'0000000000000000'
@CB00313 EQU   @CB00303
@CB00250 DC    X'0F0F0F'
@CB00246 EQU   @CB00303
EDITPAT3 DC    X'40202120'
EDITPAT5 DC    X'402020202120'
EDITPATP DC    X'40202021204B20'
TRTAB    DC    CL16'0123456789ABCDEF'
DRDHEAD  DS    CL76
         ORG   DRDHEAD
@NM00011 DC    CL1'0'
@NM00012 DC    CL32'REPORT 6 - PATH ANALYSIS REPORT '
@NM00013 DC    CL19'OF EQUIPMENT CHECKS'
@NM00014 DC    CL24'(DATA RECORDING DEVICES)'
         ORG   DRDHEAD+76
MSCSAHD  DS    CL33
         ORG   MSCSAHD
@NM00015 DC    CL1'-'
@NM00016 DC    CL3'   '
@NM00017 DC    CL29'MSC/SA INTERFACE ERROR COUNTS'
         ORG   MSCSAHD+33
SAHD     DS    CL98
         ORG   SAHD
@NM00018 DC    CL1'-'
@NM00019 DC    CL12' '
@NM00020 DC    CL52'SA     800  810  820  830  840  850  860  870  880 C
                '
@NM00021 DC    CL33'890  8A0  8B0  8C0  8D0  8E0  8F0'
         ORG   SAHD+98
SADRCHD  DS    CL54
         ORG   SADRCHD
@NM00031 DC    CL1'-'
@NM00032 DC    CL3'   '
@NM00033 DC    CL50'SA/DRC INTERFACE ERROR COUNTS               MSF 0 '
         ORG   SADRCHD+54
DRCDRDHD DS    CL55
         ORG   DRCDRDHD
@NM00043 DC    CL1'-'
@NM00044 DC    CL3'   '
@NM00045 DC    CL30'DRC/DRD INTERFACE ERROR COUNTS'
@NM00046 DC    CL21'              MSF 0  '
         ORG   DRCDRDHD+55
PATHEAD  DS    CL57
         ORG   PATHEAD
@NM00063 DC    CL1'-'
@NM00064 DC    CL3'   '
@NM00065 DC    CL53'ERROR COUNTS BY REAL DEVICE PATH              MSF 0C
                 '
         ORG   PATHEAD+57
PATHEAD1 DS    CL101
         ORG   PATHEAD1
@NM00066 DC    CL1'-'
@NM00067 DC    CL3'   '
@NM00068 DC    CL3'MSC'
@NM00069 DC    CL2'  '
@NM00070 DC    CL2'SA'
@NM00071 DC    CL7' '
@NM00072 DC    CL3'DRC'
@NM00073 DC    CL11' '
@NM00074 DC    CL19'DRD'
@NM00075 DC    CL40' DRD UNIT  CTL-I ADT  DRC UNIT     TOTAL'
@NM00076 DC    CL10'    %ERROR'
         ORG   PATHEAD1+101
DASDHEAD DS    CL58
         ORG   DASDHEAD
@NM00081 DC    CL1'0'
@NM00082 DC    CL35'REPORT 6 - PATH ANALYSIS REPORT OF '
@NM00083 DC    CL22'EQUIPMENT CHECKS(3330)'
         ORG   DASDHEAD+58
CHSAHEAD DS    CL37
         ORG   CHSAHEAD
@NM00089 DC    CL1'-'
@NM00090 DC    CL3'   '
@NM00091 DC    CL33'CHANNEL/SA INTERFACE ERROR COUNTS'
         ORG   CHSAHEAD+37
SACONHD  DS    CL37
         ORG   SACONHD
@NM00095 DC    CL1'-'
@NM00096 DC    CL36'SA/CONTROLLER INTERFACE ERROR COUNTS'
         ORG   SACONHD+37
CONDRHD  DS    CL64
         ORG   CONDRHD
CONDRHD1 DS    CL64
         ORG   CONDRHD1
@NM00105 DC    CL1'-'
@NM00106 DC    CL3'   '
@NM00107 DC    CL27'CONTROLLER/DRIVE INTERFACE '
@NM00108 DC    CL12'ERROR COUNTS'
@NM00109 DC    CL21'(STAGING ADAPTER 800)'
         ORG   CONDRHD+64
DRIVEHD  DC    CL48'DRIVE       A    B    C    D    E    F    G    H'
DASDPTHD DS    CL58
         ORG   DASDPTHD
@NM00122 DC    CL1'0'
@NM00123 DC    CL57'ERROR COUNTS BY REAL DEVICE PATH(MSC  DASD OPERATIOC
               NS)'
         ORG   DASDPTHD+58
DASDCOLH DS    CL102
         ORG   DASDCOLH
@NM00130 DC    CL1'0'
@NM00131 DC    CL4'    '
@NM00132 DC    CL3'MSC'
@NM00133 DC    CL2'  '
@NM00134 DC    CL6'SA    '
@NM00135 DC    CL16'CONTROLLER'
@NM00136 DC    CL13'DRIVE'
@NM00137 DC    CL13'DRIVE EQUIP'
@NM00138 DC    CL14' DIRECTOR   '
         DC    CL14'  DIRECTOR  '
@NM00139 DC    CL3'   '
@NM00140 DC    CL7'TOTAL'
@NM00141 DC    CL6'%ERROR'
         ORG   DASDCOLH+102
MSFAN    DC    AL4(MSFA1)
         DC    AL4(MSFA4)
         DC    AL4(MSFA3)
         DC    AL4(MSFA4)
MSFA1    DC    AL1(0)
         DC    AL1(1)
         DC    AL1(0)
         DC    AL1(1)
MSFA4    DC    AL1(0)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(0)
         DC    AL1(1)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(4)
         DC    AL1(5)
MSFA3    DC    AL1(0)
         DC    AL1(1)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(0)
         DC    AL1(1)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(2)
         DC    AL1(3)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CHCUPTR  EQU   @07
ACCPTR   EQU   @03
SATABP   EQU   @07
DRD      EQU   @07
SAP      EQU   @06
LINES    EQU   @03
CVTPTR   EQU   @02
L        EQU   @07
K        EQU   @04
I        EQU   @05
R1       EQU   @01
DRDACC   EQU   0
ACCUM1   EQU   0
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
MSFNO    EQU   CNFGFXD
SANO     EQU   CNFGFXD+6
LIBSIZS  EQU   CNFGFXD+8
LTPAD    EQU   PCNFG+16
CHCUAD   EQU   PCNFG+20
CPUSERAD EQU   PCNFG+24
SAINTFP  EQU   PCNFG+32
LTPDRDTB EQU   0
LTPDRC   EQU   LTPDRDTB
SADRDDSD EQU   0
SADRDACC EQU   SADRDDSD
SADASDAC EQU   SADRDDSD+4
DRDACCTB EQU   0
DRDACCS  EQU   0
DRDERRS  EQU   DRDACCS
CTLIERRS EQU   DRDACCS+2
DRCERRS  EQU   DRDACCS+4
SAINTF   EQU   0
CHCUTAB  EQU   0
SPLTABP  EQU   CHCUTAB+8
SPNDLETB EQU   0
SPNDLES  EQU   0
DRVEQCHK EQU   SPNDLES
STCTLCHK EQU   SPNDLES+2
STCTLCCK EQU   SPNDLES+4
P0WORK   EQU   0
MSCDRDAC EQU   P0WORK+16
MSCINTF  EQU   MSCDRDAC
SATABPTR EQU   MSCDRDAC+4
CSFTOTAL EQU   P0WORK+80
MSCTOTAL EQU   P0WORK+88
HTOTAL   EQU   P0WORK+90
P0WORK1  EQU   0
PADFPTR1 EQU   P0WORK1
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PAD00PTR EQU   CVTPTRS0+44
CNFG0PTR EQU   CVTPTRS0+88
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
DRDS     EQU   0
DASDACCS EQU   0
CPUSERS  EQU   0
WORKPTR  EQU   0
MSFTOTC  EQU   CSFTOTAL
CDRDACCT EQU   DRDACCTB
CSPNDLET EQU   SPNDLETB
@NM00006 EQU   OUTLINE
MSC1     EQU   @NM00006+10
MSCCTOT  EQU   @NM00006+14
@NM00009 EQU   @NM00006+19
MSC2     EQU   @NM00009
MSCTOT   EQU   @NM00006+99
SAHD2    EQU   OUTLINE
COLUMN1  EQU   SAHD2+10
COLTOTAL EQU   SAHD2+101
@NM00025 EQU   OUTLINE
DRC1     EQU   @NM00025+10
DRC11    EQU   DRC1+1
DRC12    EQU   DRC1+2
DRC2     EQU   @NM00025+14
@NM00029 EQU   @NM00025+19
DRC3     EQU   @NM00029
DRCTOT   EQU   @NM00025+99
@NM00034 EQU   OUTLINE
ODRC     EQU   @NM00034+10
ODRCL    EQU   ODRC+1
ODRCN    EQU   ODRC+2
DRCD1    EQU   @NM00034+15
@NM00039 EQU   @NM00034+21
DRCD2    EQU   @NM00039
DRCD2L   EQU   DRCD2+2
DRCD2R   EQU   DRCD2+3
DRCDRT   EQU   @NM00034+62
@NM00047 EQU   OUTLINE
OPTOTAL  EQU   @NM00047+44
@NM00050 EQU   @NM00047+52
OERR     EQU   @NM00050
OPTOT    EQU   @NM00047+84
OPCNT    EQU   @NM00047+93
@NM00054 EQU   OUTLINE
MSC4     EQU   @NM00054+4
SA4      EQU   @NM00054+9
SA44     EQU   SA4+1
DRC4     EQU   @NM00054+18
DRC44    EQU   DRC4+1
DRC444   EQU   DRC4+2
DRD4     EQU   @NM00054+32
DRD44    EQU   DRD4+1
DRD444   EQU   DRD4+2
@NM00077 EQU   OUTLINE
E1       EQU   @NM00077+54
E2       EQU   @NM00077+64
E3       EQU   @NM00077+74
DASDACCP EQU   DRDACCP
DASDACCE EQU   DRDACCE
SAINTFC  EQU   SAINTF
@NM00084 EQU   OUTLINE
CHSA     EQU   @NM00084+11
CHSTOTL  EQU   @NM00084+14
@NM00087 EQU   @NM00084+19
CHS2     EQU   @NM00087
CHSTOT   EQU   @NM00084+99
@NM00092 EQU   OUTLINE
CHSAHD   EQU   @NM00092+7
CHSAHD1  EQU   @NM00092+101
@NM00097 EQU   OUTLINE
SACON1   EQU   @NM00097+5
SACON2   EQU   @NM00097+101
@NM00100 EQU   OUTLINE
CNTLRNO  EQU   @NM00100+9
@NM00103 EQU   @NM00100+30
ERRCNT1  EQU   @NM00103
ERRTOT   EQU   @NM00100+70
@NM00110 EQU   OUTLINE
DCONTRL  EQU   @NM00110+5
DTOTL    EQU   @NM00110+72
@NM00113 EQU   OUTLINE
DSDMSC   EQU   @NM00113+5
DSDSA    EQU   @NM00113+10
DSDCNTL  EQU   @NM00113+19
DSDDRV   EQU   @NM00113+34
@NM00119 EQU   @NM00113+45
DSDCNT   EQU   @NM00119
DSDTOTL  EQU   @NM00113+87
DSDPTOT  EQU   @NM00113+94
DRDCOLTC EQU   DSDDRV
@NM00124 EQU   OUTLINE
HOSTXX   EQU   @NM00124+5
DSDTYPE  EQU   @NM00124+34
DASDCL1  EQU   @NM00124+47
DASDCL2  EQU   @NM00124+58
DASDCL3  EQU   @NM00124+73
CSADRDDS EQU   SADRDDSD
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00129 EQU   @NM00124+69
@NM00128 EQU   @NM00124+52
@NM00127 EQU   @NM00124+38
@NM00126 EQU   @NM00124+8
@NM00125 EQU   @NM00124
@NM00121 EQU   @NM00113+93
@NM00120 EQU   @NM00119+6
@NM00118 EQU   @NM00113+35
@NM00117 EQU   @NM00113+21
@NM00116 EQU   @NM00113+13
@NM00115 EQU   @NM00113+8
@NM00114 EQU   @NM00113
@NM00112 EQU   @NM00110+15
@NM00111 EQU   @NM00110
@NM00104 EQU   @NM00103+4
@NM00102 EQU   @NM00100+10
@NM00101 EQU   @NM00100
@NM00099 EQU   @NM00097+15
@NM00098 EQU   @NM00097
@NM00094 EQU   @NM00092+16
@NM00093 EQU   @NM00092
@NM00088 EQU   @NM00087+4
@NM00086 EQU   @NM00084+12
@NM00085 EQU   @NM00084
@NM00080 EQU   @NM00077+69
@NM00079 EQU   @NM00077+59
@NM00078 EQU   @NM00077
@NM00062 EQU   DRD4
@NM00061 EQU   @NM00054+21
@NM00060 EQU   DRC4
@NM00059 EQU   @NM00054+12
@NM00058 EQU   SA4+2
@NM00057 EQU   SA4
@NM00056 EQU   @NM00054+7
@NM00055 EQU   @NM00054
@NM00053 EQU   @NM00047+90
@NM00052 EQU   @NM00047+82
@NM00051 EQU   @NM00050+6
@NM00049 EQU   @NM00047+49
@NM00048 EQU   @NM00047
@NM00042 EQU   @NM00034+61
@NM00041 EQU   @NM00039+4
@NM00040 EQU   DRCD2
@NM00038 EQU   @NM00034+20
@NM00037 EQU   @NM00034+13
@NM00036 EQU   ODRC
@NM00035 EQU   @NM00034
@NM00030 EQU   @NM00029+4
@NM00028 EQU   @NM00025+13
@NM00027 EQU   DRC1
@NM00026 EQU   @NM00025
@NM00024 EQU   SAHD2+99
SAEL2    EQU   SAHD2+19
@NM00023 EQU   SAHD2+13
@NM00022 EQU   SAHD2
@NM00010 EQU   @NM00009+4
@NM00008 EQU   @NM00006+13
@NM00007 EQU   @NM00006
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
PARMPTR  EQU   CVTPTRS0+8
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
@NM00005 EQU   MSCDRDAC+2
ENDCORE  EQU   P0WORK+12
COREASG  EQU   P0WORK+8
PADLASTB EQU   P0WORK+4
PADFPTR  EQU   P0WORK
INTF     EQU   CHCUTAB+7
SA       EQU   CHCUTAB+6
CHCU     EQU   CHCUTAB+5
CPUIDSER EQU   CHCUTAB
DRCL1    EQU   LTPDRC+1
DRCL0    EQU   LTPDRC
@NM00004 EQU   PCNFG+30
CNFGTOTL EQU   PCNFG+28
PCNFGL   EQU   CNFGFXD+14
CHINTFNO EQU   CNFGFXD+12
SPINO    EQU   CNFGFXD+4
CPUNO    EQU   CNFGFXD+2
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00702 EQU   @EL00004
@ENDDATA EQU   *
         END   ISDAPAD1,(C'PLS1855',0603,75268)

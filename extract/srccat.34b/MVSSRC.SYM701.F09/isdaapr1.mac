         TITLE 'ISDAAPR1 - ALTERNATE PATH RETRY REPORT FORMATER        *
                        '
ISDAAPR1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDAAPR1  78.044'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0044
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE WORK AREAS AND CALL REPORT GENERATORS              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0044
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO ISDACVT    0044
*                                                            @ZD00192*/
         L     @06,@PC00001                                        0044
         L     CVTPTR,WORKPTR(,@06)                                0044
*   APRWKPTR=APR00PTR;              /* SET LOCAL PTR TO WORK AREA  0045
*                                                            @ZD00192*/
         L     APRWKPTR,APR00PTR(,CVTPTR)                          0045
*   RETCODE=0;                      /* ZERO RETURN CODE      @ZD00192*/
         SLR   RETCODE,RETCODE                                     0046
*   STARTPNT=0;                     /* INIT POINTER TO ACCPOINT    0047
*                                                            @ZD00192*/
         SLR   @15,@15                                             0047
         ST    @15,STARTPNT(,APRWKPTR)                             0047
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO ISDAPRMS   0048
*                                                            @ZD00192*/
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                         0048
*   IF TOTALENT>0 THEN              /* ANY DATA SAVED        @ZD00192*/
         C     @15,TOTALENT(,APRWKPTR)                             0049
         BNL   @RF00049                                            0049
*     DO;                           /* YES, PRODUCE REPORT   @ZD00192*/
*       CALL GETPOINT;              /* GET ACCPOINT TABLE    @ZD00192*/
         BAL   @14,GETPOINT                                        0051
*       IF RETCODE=0 THEN           /* ACCPOINT GOTTEN       @ZD00192*/
         LTR   RETCODE,RETCODE                                     0052
         BNZ   @RF00052                                            0052
*         DO;                       /* YES, CONTINUE         @ZD00192*/
*           IF APRFLAGS(1)='1'B THEN/* IS A SORT REQUIRED    @ZD00192*/
         TM    APRFLAGS(APRWKPTR),B'10000000'                      0054
         BNO   @RF00054                                            0054
*             CALL SORTENT;         /* SORT ACCPOINT BY DATE,TIME  0055
*                                                            @ZD00192*/
         BAL   @14,SORTENT                                         0055
*           ELSE;                   /* NO, INPUT IN CORRECT ORDER  0056
*                                                            @ZD00192*/
@RF00054 DS    0H                                                  0057
*/*         CALL TRACEENT              DUMP ACCUMULATOR      @ZD00192*/
*                                                                  0057
*           IF CAPRSUU(8)='1'B THEN /* APR REQUESTED         @ZD00192*/
         L     @06,LPARMPTR                                        0057
         TM    CAPRSUU(@06),B'00000001'                            0057
         BNO   @RF00057                                            0057
*             DO;                   /* PRODUCE DETAIL PRINTOUT     0058
*                                                            @ZD00192*/
*               CALL DODETAIL;      /* PRODUCE DETAIL REPORT @ZD00192*/
         BAL   @14,DODETAIL                                        0059
*               CALL SUMENT;        /* SUMMARIZE THE ENTRIES @ZD00192*/
         BAL   @14,SUMENT                                          0060
*               CALL SORTENT;       /* SORT NEW ACCPOINT     @ZD00192*/
         BAL   @14,SORTENT                                         0061
*             END;                  /* END DETAIL REPORT CODE@ZD00192*/
*           ELSE;                   /* SUU ONLY, DO SUMMARY  @ZD00192*/
@RF00057 DS    0H                                                  0064
*           IF CAPRSUU(7)='1'B THEN /* SUU REQUESTED         @ZD00192*/
         L     @06,LPARMPTR                                        0064
         TM    CAPRSUU(@06),B'00000010'                            0064
         BNO   @RF00064                                            0064
*             IF TOTALENT>0 THEN    /* ANY DATA TO PRINT     @ZM31022*/
         ICM   @06,15,TOTALENT(APRWKPTR)                           0065
         BNP   @RF00065                                            0065
*               CALL DOSUMRPT;      /* YES, PRINT SUMMARY    @ZD00192*/
         BAL   @14,DOSUMRPT                                        0066
*             ELSE                  /* NO DATA FOR SUU       @ZM31022*/
*               RETCODE=16;         /* SET SUU NOT PRINTED   @ZM31022*/
         B     @RC00065                                            0067
@RF00065 LA    RETCODE,16                                          0067
*           ELSE;                   /* SUU NOT REQUESTED     @ZD00192*/
@RF00064 DS    0H                                                  0069
*         END;                      /* END REPORT            @ZD00192*/
*       ELSE;                       /* NO REPORT, BAD RETURN FROM  0070
*                                      GETPOINT              @ZD00192*/
@RF00052 DS    0H                                                  0071
*       IF RETCODE<4 THEN           /* LOCAL RETCODE SET AS FLAG   0071
*                                                            @ZD00192*/
@RC00052 CH    RETCODE,@CH00106                                    0071
         BNL   @RF00071                                            0071
*         RETCODE=0;                /* YES, RESET TO ZERO    @ZD00192*/
         SLR   RETCODE,RETCODE                                     0072
*       ELSE;                       /* NO, MUST BE VALID ERROR RETURN
*                                                            @ZD00192*/
@RF00071 DS    0H                                                  0074
*     END;                          /* END REPORT            @ZD00192*/
*   ELSE                            /* NO DATA SAVED BY ISDAAPR0   0075
*                                                            @ZD00192*/
*     RETCODE=8;                    /* SET NO REPORT RETURN CODE   0075
*                                                            @ZD00192*/
         B     @RC00049                                            0075
@RF00049 LA    RETCODE,8                                           0075
*   CALL FREECORE;                  /* FREE ALL CORE         @ZD00192*/
@RC00049 BAL   @14,FREECORE                                        0076
*   RETURN CODE(RETCODE);           /* RETURN TO ISDASDA0    @ZD00192*/
         L     @13,4(,@13)                                         0077
         L     @00,@SIZDATD                                        0077
         LR    @01,@10                                             0077
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@07                                             0077
         L     @14,12(,@13)                                        0077
         LM    @00,@12,20(@13)                                     0077
         BR    @14                                                 0077
*                                                                  0078
*   /*****************************************************************/
*   /*                                                               */
*   /* GETPOINT - GET AND INITIALIZE ACCPOINT - TABLE OF POINTERS TO */
*   /* ACCUMULATOR ENTRIES                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0078
*GETPOINT:                                                         0078
*   PROC OPTIONS(SAVE(14));         /* GETPOINT PROC         @ZD00192*/
@EL00001 L     @13,4(,@13)                                         0078
@EF00001 L     @00,@SIZDATD                                        0078
         LR    @01,@10                                             0078
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0078
         BR    @14                                                 0078
GETPOINT ST    @14,@SA00002                                        0078
*   POINTLEN=TOTALENT*4;            /* COMPUTE LENGTH, 4 BYTES PER 0079
*                                      ENTRY                 @ZD00192*/
         L     @06,TOTALENT(,APRWKPTR)                             0079
         SLA   @06,2                                               0079
         STH   @06,POINTLEN(,APRWKPTR)                             0079
*   CORELEN=POINTLEN;               /* MOVE LENGTH           @ZD00192*/
         STCM  @06,7,CORELEN(CVTPTR)                               0080
*   SPNO=APRSPNO;                   /* MOVE SUBPOOL NUMBER   @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0081
*   RFY                                                            0082
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0083
*   CALL ISDAGET1;                  /* GET CORE              @ZD00192*/
         L     @15,@CV00391                                        0084
         BALR  @14,@15                                             0084
*   RFY                                                            0085
*     R15 RSTD;                     /*                       @ZD00192*/
*   RETCODE=R15;                    /* SAVE RETURN CODE      @ZD00192*/
         LR    RETCODE,R15                                         0086
*   RFY                                                            0087
*    (R1,                                                          0087
*     R15) UNRSTD;                  /*                       @ZD00192*/
*   IF RETCODE=0 THEN               /* GOT CORE OK           @ZD00192*/
         LTR   RETCODE,RETCODE                                     0088
         BNZ   @RF00088                                            0088
*     DO;                           /* YES, BUILD ACCPOINT   @ZD00192*/
*       STARTPNT=COREADDR;          /* SAVE ADDRESS          @ZD00192*/
         MVC   STARTPNT(4,APRWKPTR),COREADDR(CVTPTR)               0090
*       ENTRYPTR=ACCUMPTR;          /* POINT TO START OF DATA@ZD00192*/
         L     ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0091
*       DO PINDEX=1 TO TOTALENT WHILE(RETCODE=0);/* LOOP     @ZD00192*/
         LA    @06,1                                               0092
         B     @DE00092                                            0092
@DL00092 SLR   @05,@05                                             0092
         CR    RETCODE,@05                                         0092
         BNE   @DC00092                                            0092
*         IF ENTRYPTR^=0 THEN       /* ADDR NOT ZERO         @ZD00192*/
         CR    ENTRYPTR,@05                                        0093
         BE    @RF00093                                            0093
*           DO;                     /* ADD ADDR TO ACCPOINT  @ZD00192*/
*             ACCPOINT(PINDEX)=ENTRYPTR;/* MOVE ADDRESS      @ZD00192*/
         SLA   @06,2                                               0095
         L     @05,STARTPNT(,APRWKPTR)                             0095
         AL    @05,@CF00875                                        0095
         ST    ENTRYPTR,ACCPOINT(@06,@05)                          0095
*             ENTRYPTR=NEXTENT;     /* POINT TO NEXT ENTRY   @ZD00192*/
         L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0096
*           END;                    /* END BUILD             @ZD00192*/
*         ELSE                      /* BAD ENTRY             @ZD00192*/
*           RETCODE=20;             /* SET ERROR RETURN CODE @ZD00192*/
         B     @RC00093                                            0098
@RF00093 LA    RETCODE,20                                          0098
*       END;                        /* END LOOP THROUGH ACCUMULATORS
*                                                            @ZD00192*/
@RC00093 LA    @06,1                                               0099
         AL    @06,PINDEX                                          0099
@DE00092 ST    @06,PINDEX                                          0099
         C     @06,TOTALENT(,APRWKPTR)                             0099
         BNH   @DL00092                                            0099
@DC00092 DS    0H                                                  0100
*       IF ENTRYPTR^=0&RETCODE=0 THEN/* LAST ENTRY POINTS TO ZERO  0100
*                                                            @ZD00192*/
         SLR   @06,@06                                             0100
         CR    ENTRYPTR,@06                                        0100
         BE    @RF00100                                            0100
         CR    RETCODE,@06                                         0100
         BNE   @RF00100                                            0100
*         RETCODE=20;               /* NO, SET ERROR RETURN CODE   0101
*                                                            @ZD00192*/
         LA    RETCODE,20                                          0101
*       ELSE;                       /* YES, ACCUMULATOR CHAIN IS OK
*                                                            @ZD00192*/
@RF00100 DS    0H                                                  0103
*     END;                          /* END INITIALIZE ACCPOINT     0103
*                                                            @ZD00192*/
*   ELSE;                           /* BAD RETURN FROM ISDAGET1    0104
*                                                            @ZD00192*/
@RF00088 DS    0H                                                  0105
*   END GETPOINT;                   /* END GETPOINT PROC     @ZD00192*/
@EL00002 DS    0H                                                  0105
@EF00002 DS    0H                                                  0105
@ER00002 L     @14,@SA00002                                        0105
         BR    @14                                                 0105
*                                                                  0106
*   /*****************************************************************/
*   /*                                                               */
*   /* SORTENT - PROC TO SORT THE TABLE OF ENTRY POINTERS BY DATE AND*/
*   /* TIME                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0106
*SORTENT:                                                          0106
*   PROC OPTIONS(SAVE(14));         /* SORT PROC             @ZD00192*/
SORTENT  ST    @14,12(,@13)                                        0106
*   SORTCNT=''B;                    /* ZERO SORT COUNT       @ZD00192*/
         SLR   @06,@06                                             0107
         ST    @06,SORTCNT(,APRWKPTR)                              0107
*   DO I=1 TO TOTALENT-1;           /* MAIN LOOP             @ZD00192*/
         LA    I,1                                                 0108
         B     @DE00108                                            0108
@DL00108 DS    0H                                                  0109
*     DO J=I+1 TO TOTALENT;         /* INNER LOOP            @ZD00192*/
         LA    J,1                                                 0109
         ALR   J,I                                                 0109
         B     @DE00109                                            0109
@DL00109 DS    0H                                                  0110
*       SORTCNT=SORTCNT+1;          /* ADD 1 TO LOOP COUNT   @ZD00192*/
         LA    @15,1                                               0110
         AL    @15,SORTCNT(,APRWKPTR)                              0110
         ST    @15,SORTCNT(,APRWKPTR)                              0110
*       ENTRYPTR=ACCPOINT(I);       /* SET BASE PTR          @ZD00192*/
         LR    @15,I                                               0111
         SLA   @15,2                                               0111
         L     @14,STARTPNT(,APRWKPTR)                             0111
         LA    @01,0(@15,@14)                                      0111
         AL    @01,@CF00875                                        0111
         L     @09,ACCPOINT(,@01)                                  0111
         LR    ENTRYPTR,@09                                        0111
*       SAVEDYTS=ENTDAYTS;          /* MOVE DATE,TIME, SEQ NO@ZM31121*/
         MVC   SAVEDYTS(9,APRWKPTR),ENTDAYTS(ENTRYPTR)             0112
*       ENTRYPTR=ACCPOINT(J);       /* SET NEW BASE          @ZD00192*/
         LR    @08,J                                               0113
         SLA   @08,2                                               0113
         LA    @01,0(@08,@14)                                      0113
         AL    @01,@CF00875                                        0113
         L     ENTRYPTR,ACCPOINT(,@01)                             0113
*       IF SAVEDYTS>ENTDAYTS THEN   /* OLD DATE,TIME > NEW   @ZM31121*/
         CLC   SAVEDYTS(9,APRWKPTR),ENTDAYTS(ENTRYPTR)             0114
         BNH   @RF00114                                            0114
*         DO;                       /* YES, SWAP THE TWO ENTRY     0115
*                                      POINTERS              @ZD00192*/
*           ACCPOINT(J)=ACCPOINT(I);/* MOVE I TO J           @ZD00192*/
         AL    @08,@CF00875                                        0116
         ST    @09,ACCPOINT(@08,@14)                               0116
*           ACCPOINT(I)=ENTRYPTR;   /* MOVE OLD J TO I       @ZD00192*/
         AL    @14,@CF00875                                        0117
         ST    ENTRYPTR,ACCPOINT(@15,@14)                          0117
*         END;                      /* END POINTER SWAP      @ZD00192*/
*       ELSE                                                       0119
*         ;                         /* NO SWAP, DATE,TIME NOT >    0119
*                                                            @ZD00192*/
@RF00114 DS    0H                                                  0120
*     END;                          /* END INNER LOOP        @ZD00192*/
         AH    J,@CH00083                                          0120
@DE00109 C     J,TOTALENT(,APRWKPTR)                               0120
         BNH   @DL00109                                            0120
*   END;                            /* END MAIN LOOP         @ZD00192*/
         AH    I,@CH00083                                          0121
@DE00108 L     @06,TOTALENT(,APRWKPTR)                             0121
         BCTR  @06,0                                               0121
         CR    I,@06                                               0121
         BNH   @DL00108                                            0121
*   END SORTENT;                    /* END SORT PROC         @ZD00192*/
@EL00003 DS    0H                                                  0122
@EF00003 DS    0H                                                  0122
@ER00003 L     @14,12(,@13)                                        0122
         BR    @14                                                 0122
*                                                                  0123
*   /*****************************************************************/
*   /*                                                               */
*   /* DODETAIL - PROC TO PRODUCE DETAIL REPORT OF FAILURES          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0123
*DODETAIL:                                                         0123
*   PROC OPTIONS(SAVE(14));         /* PRINT DETAIL PROC     @ZD00192*/
*                                                                  0123
DODETAIL ST    @14,@SA00004                                        0123
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL PHEADER TO PRINT TITLE, HEADER LINES 1 AND 2             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0124
*   CALL PHEADER;                   /* CALL PHEADER PROC     @ZD00192*/
         BAL   @14,PHEADER                                         0124
*   DO PINDEX=1 TO TOTALENT;        /* LOOP THROUGH ACCPOINT @ZD00192*/
         LA    @06,1                                               0125
         B     @DE00125                                            0125
@DL00125 DS    0H                                                  0126
*     ENTRYPTR=ACCPOINT(PINDEX);    /* GET ADDR OF ENTRY     @ZD00192*/
         SLA   @06,2                                               0126
         L     @01,STARTPNT(,APRWKPTR)                             0126
         AL    @01,@CF00875                                        0126
         L     ENTRYPTR,ACCPOINT(@06,@01)                          0126
*     IF ETYPCODE^=T42 THEN         /* NOT IN APR RECORD     @ZM31121*/
*                                                                  0127
         CLI   ETYPCODE(ENTRYPTR),X'42'                            0127
         BE    @RF00127                                            0127
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT ONE LINE FOR ALL RECORDS NOT IN APR                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0128
*       DO;                         /* YES, NOT APR          @ZD00192*/
*         IF LINECNT>56 THEN        /* AT END OF PAGE        @ZD00192*/
         L     @06,LINECNT(,APRWKPTR)                              0129
         CH    @06,@CH00626                                        0129
         BNH   @RF00129                                            0129
*           CALL PHEADER;           /* YES, START NEW PAGE   @ZD00192*/
         BAL   @14,PHEADER                                         0130
*         ELSE                                                     0131
*           ;                       /* NO, OK                @ZD00192*/
@RF00129 DS    0H                                                  0132
*         IF ANSI=LSKIP1 THEN       /* ONE SKIP              @ZM31121*/
         CLI   ANSI(CVTPTR),C' '                                   0132
         BNE   @RF00132                                            0132
*           LINECNT=LINECNT+1;      /* YES, ADD 1 TO COUNT   @ZM31121*/
         LA    @06,1                                               0133
         AL    @06,LINECNT(,APRWKPTR)                              0133
         ST    @06,LINECNT(,APRWKPTR)                              0133
*         ELSE                      /* NO, HAVE 2 SKIP       @ZM31121*/
*           LINECNT=LINECNT+2;      /* ADD 2 TO LINECNT      @ZD00192*/
         B     @RC00132                                            0134
@RF00132 LA    @06,2                                               0134
         AL    @06,LINECNT(,APRWKPTR)                              0134
         ST    @06,LINECNT(,APRWKPTR)                              0134
*         LINE='';                  /* BLANK OUTPUT LINE     @ZD00192*/
@RC00132 MVI   LINE(CVTPTR),C' '                                   0135
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0135
*         APRTEMPS=''B;             /* ZERO TEMP AREA        @ZD00192*/
         XC    APRTEMPS(32,APRWKPTR),APRTEMPS(APRWKPTR)            0136
*         SAVEDAYT=ENTDAYT;         /* MOVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0137
*         CALL MOVEDAYT;            /* BUILD DATE,TIME SECTION     0138
*                                                            @ZD00192*/
         BAL   @14,MOVEDAYT                                        0138
*         BAR2=DASH;                /* MOVE DASH             @ZD00192*/
         MVI   BAR2(CVTPTR),C'-'                                   0139
*         BAR3=DASH;                /* MOVE DASH             @ZD00192*/
         MVI   BAR3(CVTPTR),C'-'                                   0140
*         IF EFLAG1='1'B THEN       /* ACTION 1              @ZM31121*/
*                                                                  0141
         TM    EFLAG1(ENTRYPTR),B'10000000'                        0141
         BNO   @RF00141                                            0141
*           /*********************************************************/
*           /*                                                       */
*           /* ACTION 1 - START APR SEQUENCE                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0142
*           CALL BACTION1;          /* YES, BUILD ACTION 1   @ZM31121*/
         BAL   @14,BACTION1                                        0142
*         ELSE                                                     0143
*           IF EFLAG2='1'B THEN     /* ACTION 2              @ZM31121*/
*                                                                  0143
         B     @RC00141                                            0143
@RF00141 TM    EFLAG2(ENTRYPTR),B'01000000'                        0143
         BNO   @RF00143                                            0143
*             /*******************************************************/
*             /*                                                     */
*             /* ACTION 2 - END APR WITH OR WITHOUT MEDIA FAILURE    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0144
*             CALL BACTION2;        /* YES, BUILD ACTION 2   @ZM31121*/
         BAL   @14,BACTION2                                        0144
*           ELSE                                                   0145
*             IF EFLAG3='1'B THEN   /* ACTION 3              @ZD00192*/
*                                                                  0145
         B     @RC00143                                            0145
@RF00143 TM    EFLAG3(ENTRYPTR),B'00100000'                        0145
         BNO   @RF00145                                            0145
*               /*****************************************************/
*               /*                                                   */
*               /* ACTION 3 - UNIT UNUSABLE (APR) OR ACTION 8 -      */
*               /* CYLINDER STAGED WITH ERROR (APR) OR CODE 06 SUU   */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0146
*               IF ETYPCODE=T00×ETYPCODE=TF6 THEN/* APR SUU OR 06 SUU
*                                                            @ZA28897*/
         CLI   ETYPCODE(ENTRYPTR),X'00'                            0146
         BE    @RT00146                                            0146
         CLI   ETYPCODE(ENTRYPTR),X'F6'                            0146
         BNE   @RF00146                                            0146
@RT00146 DS    0H                                                  0147
*                 CALL BACTION3;    /* YES, BUILD ACTION 3   @ZM31121*/
         BAL   @14,BACTION3                                        0147
*               ELSE                /* NO, MUST BE ACTION 8  @ZM31121*/
*                 CALL BACTION8;    /* BUILD ACTION 8 MSG    @ZM31121*/
         B     @RC00146                                            0148
@RF00146 BAL   @14,BACTION8                                        0148
*             ELSE                  /* CHECK NEXT ACTION     @ZD00192*/
*               IF EFLAG4='1'B THEN /* ACTION 4              @ZD00192*/
*                                                                  0149
         B     @RC00145                                            0149
@RF00145 TM    EFLAG4(ENTRYPTR),B'00010000'                        0149
         BNO   @RF00149                                            0149
*                 /***************************************************/
*                 /*                                                 */
*                 /* ACTION 4 - PERMANENT ERROR                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0150
*                 CALL BACTION4;    /* YES, BUILD ACTION 4 MESSAGE 0150
*                                                            @ZD00192*/
         BAL   @14,BACTION4                                        0150
*               ELSE                /* CHECK NEXT ACTION     @ZD00192*/
*                 IF EFLAG5='1'B THEN/* ACTION 5             @ZD00192*/
*                                                                  0151
         B     @RC00149                                            0151
@RF00149 TM    EFLAG5(ENTRYPTR),B'00001000'                        0151
         BNO   @RF00151                                            0151
*                   /*************************************************/
*                   /*                                               */
*                   /* ACTION 5 - CS RECONFIGURED                    */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0152
*                   CALL BACTION5;  /* YES, BUILD ACTION 5 MESSAGE 0152
*                                                            @ZD00192*/
         BAL   @14,BACTION5                                        0152
*                 ELSE              /* CHECK NEXT ACTION     @ZD00192*/
*                   IF EFLAG6='1'B THEN/* ACTION 6           @ZD00192*/
*                                                                  0153
         B     @RC00151                                            0153
@RF00151 TM    EFLAG6(ENTRYPTR),B'00000100'                        0153
         BNO   @RF00153                                            0153
*                     /***********************************************/
*                     /*                                             */
*                     /* ACTION 6 - MISPLACED CARTRIDGE              */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0154
*                     CALL BACTION6;/* YES, BUILD ACTION 6 MESSAGE 0154
*                                                            @ZD00192*/
         BAL   @14,BACTION6                                        0154
*                   ELSE            /* CHECK NEXT ACTION     @ZD00192*/
*                     IF EFLAG7='1'B THEN/* ACTION 7         @ZD00192*/
*                                                                  0155
         B     @RC00153                                            0155
@RF00153 TM    EFLAG7(ENTRYPTR),B'00000010'                        0155
         BNO   @RF00155                                            0155
*                       /*********************************************/
*                       /*                                           */
*                       /* ACTION 7 - SWITCH TO ALT MSC              */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0156
*                       CALL BACTION7;/* YES, BUILD ACTION 7 MESSAGE
*                                                            @ZD00192*/
         BAL   @14,BACTION7                                        0156
*                     ELSE          /* BAD EFLAG             @ZD00192*/
*                       RETCODE=20; /* SET ERROR RETURN CODE @ZD00192*/
*                                                                  0157
         B     @RC00155                                            0157
@RF00155 LA    RETCODE,20                                          0157
*         /***********************************************************/
*         /*                                                         */
*         /* OUTPUT LINE                                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0158
*         RFY                                                      0158
*           R1 RSTD;                /*                       @ZD00192*/
@RC00155 DS    0H                                                  0158
@RC00153 DS    0H                                                  0158
@RC00151 DS    0H                                                  0158
@RC00149 DS    0H                                                  0158
@RC00145 DS    0H                                                  0158
@RC00143 DS    0H                                                  0158
@RC00141 DS    0H                                                  0159
*         R1=ADDR(WORKCALL);        /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0159
*         CALL ISDAPRT0;            /* PRINT THE LINE        @ZD00192*/
         L     @15,@CV00389                                        0160
         BALR  @14,@15                                             0160
*         RFY                                                      0161
*           R1 UNRSTD;              /*                       @ZD00192*/
*         IF APRFLAGS(2)='1'B THEN  /* IN APR SEQUENCE       @ZM31121*/
         TM    APRFLAGS(APRWKPTR),B'01000000'                      0162
         BNO   @RF00162                                            0162
*           ANSI=LSKIP1;            /* YES, SET 1 LINE SKIP  @ZM31121*/
         MVI   ANSI(CVTPTR),C' '                                   0163
*         ELSE                                                     0164
*           ANSI=LSKIP2;            /* NO, SET 2 LINE SKIP   @ZD00192*/
         B     @RC00162                                            0164
@RF00162 MVI   ANSI(CVTPTR),C'0'                                   0164
*       END;                        /* END NOT IN APR SECTION@ZD00192*/
*     ELSE                                                         0166
*       ;                           /* APR RECORDS           @ZD00192*/
@RF00127 DS    0H                                                  0167
*   END;                            /* END LOOP THROUGH ACCUMULATORS
*                                                            @ZD00192*/
@RC00127 LA    @06,1                                               0167
         AL    @06,PINDEX                                          0167
@DE00125 ST    @06,PINDEX                                          0167
         C     @06,TOTALENT(,APRWKPTR)                             0167
         BNH   @DL00125                                            0167
*                                                                  0168
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT APRMSG10 AND APRMSG20 IF MAXIMUM NUMBER OF APR SEQUENCES*/
*   /* OR LOST CARTRIDGES WAS REACHED                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0168
*   IF APRFLAGS(3)='1'B THEN        /* MAX APR COUNT         @ZM30984*/
         TM    APRFLAGS(APRWKPTR),B'00100000'                      0168
         BNO   @RF00168                                            0168
*     DO;                           /* YES, PRINT APRMSG10   @ZM30984*/
*       LINE=APRMSG10;              /* MOVE MSG10            @ZM30984*/
         MVI   LINE+73(CVTPTR),C' '                                0170
         MVC   LINE+74(58,CVTPTR),LINE+73(CVTPTR)                  0170
         MVC   LINE(73,CVTPTR),APRMSG10                            0170
*       ANSI=LSKIP3;                /* SET 2 LINE SKIP       @ZM30984*/
         MVI   ANSI(CVTPTR),C'-'                                   0171
*       IF T07COUNT>T41COUNT THEN   /* END APR IS BIGGEST    @ZM30984*/
         LH    @06,T07COUNT(,APRWKPTR)                             0172
         CH    @06,T41COUNT(,APRWKPTR)                             0172
         BNH   @RF00172                                            0172
*         J=T07COUNT;               /* YES                   @ZM30984*/
         LH    @15,T07COUNT(,APRWKPTR)                             0173
         LR    J,@15                                               0173
*       ELSE                                                       0174
*         J=T41COUNT;               /* NO, USE START APR CNT @ZM30984*/
         B     @RC00172                                            0174
@RF00172 LH    J,T41COUNT(,APRWKPTR)                               0174
*       CVD(J,TEMP8);               /* CONVERT TO DECIMAL    @ZM30984*/
@RC00172 CVD   J,TEMP8(,APRWKPTR)                                  0175
*       TOTCOUNT=EDPAT02;           /* MOVE EDIT PATTERN     @ZM30984*/
         MVC   TOTCOUNT(6,CVTPTR),EDPAT02                          0176
*       ED(TOTCOUNT,TEMP68);        /* EDIT THE COUNT        @ZM30984*/
         ED    TOTCOUNT(6,CVTPTR),TEMP68(APRWKPTR)                 0177
*       RFY                                                        0178
*         R1 RSTD;                  /*                       @ZM30984*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZM30984*/
         LA    R1,WORKCALL(,CVTPTR)                                0179
*       CALL ISDAPRT0;              /* PRINT APRMSG          @ZM30984*/
         L     @15,@CV00389                                        0180
         BALR  @14,@15                                             0180
*       RFY                                                        0181
*         R1 UNRSTD;                /*                       @ZM30984*/
*     END;                          /* END TOO MANY APR      @ZM30984*/
*   ELSE                                                           0183
*     ;                             /* MAX APR NOT REACHED   @ZM30984*/
@RF00168 DS    0H                                                  0184
*   IF APRFLAGS(4)='1'B THEN        /* MAX LOST CART COUNT   @ZM30984*/
         TM    APRFLAGS(APRWKPTR),B'00010000'                      0184
         BNO   @RF00184                                            0184
*     DO;                           /* YES, PRINT APRMSG02   @ZM30984*/
*       LINE=APRMSG20;              /* MOVE MSG20            @ZM30984*/
         MVI   LINE+87(CVTPTR),C' '                                0186
         MVC   LINE+88(44,CVTPTR),LINE+87(CVTPTR)                  0186
         MVC   LINE(87,CVTPTR),APRMSG20                            0186
*       ANSI=LSKIP3;                /* SET 2 LINE SKIP       @ZM30984*/
         MVI   ANSI(CVTPTR),C'-'                                   0187
*       J=T09COUNT;                 /* GET COUNT             @ZM30984*/
         LH    J,T09COUNT(,APRWKPTR)                               0188
*       CVD(J,TEMP8);               /* CONVERT TO DECIMAL    @ZM30984*/
         CVD   J,TEMP8(,APRWKPTR)                                  0189
*       TOTCOUNT=EDPAT02;           /* MOVE EDIT PATTERN     @ZM30984*/
         MVC   TOTCOUNT(6,CVTPTR),EDPAT02                          0190
*       ED(TOTCOUNT,TEMP68);        /* EDIT THE COUNT        @ZM30984*/
         ED    TOTCOUNT(6,CVTPTR),TEMP68(APRWKPTR)                 0191
*       RFY                                                        0192
*         R1 RSTD;                  /*                       @ZM30984*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZM30984*/
         LA    R1,WORKCALL(,CVTPTR)                                0193
*       CALL ISDAPRT0;              /* PRINT APRMSG          @ZM30984*/
         L     @15,@CV00389                                        0194
         BALR  @14,@15                                             0194
*       RFY                                                        0195
*         R1 UNRSTD;                /*                       @ZM30984*/
*     END;                          /* END TOO MANY T09      @ZM30984*/
*   ELSE                                                           0197
*     ;                             /* MAX T09 NOT REACHED   @ZM30984*/
@RF00184 DS    0H                                                  0198
*   END DODETAIL;                   /* END DETAIL PRINT PROC @ZD00192*/
@EL00004 DS    0H                                                  0198
@EF00004 DS    0H                                                  0198
@ER00004 L     @14,@SA00004                                        0198
         BR    @14                                                 0198
*                                                                  0199
*   /*****************************************************************/
*   /*                                                               */
*   /* PHEADER - PROC TO PRINT TITLE, HEADER LINES 1 AND 2           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0199
*PHEADER:                                                          0199
*   PROC OPTIONS(SAVE(14));         /* PRINT TITLE PROC      @ZD00192*/
PHEADER  ST    @14,@SA00005                                        0199
*   ANSI=PSKIP;                     /* SET PAGE SKIP         @ZD00192*/
         MVI   ANSI(CVTPTR),C'1'                                   0200
*   LINE=APRTITLE;                  /* MOVE TITLE            @ZD00192*/
         MVI   LINE+65(CVTPTR),C' '                                0201
         MVC   LINE+66(66,CVTPTR),LINE+65(CVTPTR)                  0201
         MVC   LINE(65,CVTPTR),APRTITLE                            0201
*   RFY                                                            0202
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0203
*   CALL ISDAPRT0;                  /* PRINT TITLE           @ZD00192*/
         L     @15,@CV00389                                        0204
         BALR  @14,@15                                             0204
*   LINE='';                        /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0205
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0205
*   MSG01=APRMSG01;                 /* MOVE DATE             @ZD00192*/
         MVC   MSG01(4,CVTPTR),APRMSG01                            0206
*   MSG02=APRMSG02;                 /* MOVE TIME             @ZD00192*/
         MVC   MSG02(4,CVTPTR),APRMSG02                            0207
*   MSG03=APRMSG03;                 /* MOVE ACTION           @ZD00192*/
         MVC   MSG03(6,CVTPTR),APRMSG03                            0208
*   MSG04=APRMSG04;                 /* MOVE RESULT           @ZD00192*/
         MVC   MSG04(6,CVTPTR),APRMSG04                            0209
*   ANSI=LSKIP3;                    /* SET 3 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C'-'                                   0210
*   CALL ISDAPRT0;                  /* PRINT LINE 1          @ZD00192*/
         L     @15,@CV00389                                        0211
         BALR  @14,@15                                             0211
*   LINE(1)=DASH;                   /* MOVE DASH             @ZD00192*/
         MVI   LINE(CVTPTR),C'-'                                   0212
*   MVC(LINE(2:116),LINE(1:115));   /* PROPAGATE DASH        @ZA00668*/
         MVC   LINE+1(115,CVTPTR),LINE(CVTPTR)                     0213
*   BAR1=BAR;                       /* BAR1                  @ZD00192*/
         MVI   BAR1(CVTPTR),C'×'                                   0214
*   BAR2=BAR;                       /* BAR2                  @ZD00192*/
         MVI   BAR2(CVTPTR),C'×'                                   0215
*   BAR3=BAR;                       /* BAR3                  @ZD00192*/
         MVI   BAR3(CVTPTR),C'×'                                   0216
*   ANSI=LSKIP1;                    /* 1 LINE SKIP           @ZD00192*/
         MVI   ANSI(CVTPTR),C' '                                   0217
*   CALL ISDAPRT0;                  /* PRINT LINE 2          @ZD00192*/
         L     @15,@CV00389                                        0218
         BALR  @14,@15                                             0218
*   RFY                                                            0219
*     R1 UNRSTD;                    /* RELEASE REG 1         @ZD00192*/
*   LINECNT=5;                      /* INIT LINE COUNT       @ZD00192*/
         MVC   LINECNT(4,APRWKPTR),@CF00187                        0220
*   END PHEADER;                    /* END PHEADER PROC      @ZD00192*/
@EL00005 DS    0H                                                  0221
@EF00005 DS    0H                                                  0221
@ER00005 L     @14,@SA00005                                        0221
         BR    @14                                                 0221
*                                                                  0222
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION1 - PROC TO PRINT ACTION 1 - START APR SEQUENCE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0222
*BACTION1:                                                         0222
*   PROC OPTIONS(SAVE(14));         /* SAVE SSIDS PROC       @ZD00192*/
BACTION1 ST    @14,@SA00006                                        0222
*   APRTEMPS=''B;                   /* ZERO TEMPS            @ZD00192*/
         XC    APRTEMPS(32,APRWKPTR),APRTEMPS(APRWKPTR)            0223
*   TEMP2=ENTSSID;                  /* MOVE SSID             @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0224
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0225
*   TEMP1417=TEMP4;                 /* MOVE SSID             @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP4(APRWKPTR)                0226
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0227
*   SAVESAPR=TEMP1417;              /* SAVE SSID             @ZD00192*/
         MVC   SAVESAPR(4,APRWKPTR),TEMP1417(APRWKPTR)             0228
*   APRFLAGS(2)='1'B;               /* TURN APR FLAG ON      @ZD00192*/
         OI    APRFLAGS(APRWKPTR),B'01000000'                      0229
*   T08COUNT=''B;                   /* ZERO MSG CODE 08 COUNT@ZM31121*/
         SLR   @06,@06                                             0230
         STH   @06,T08COUNT(,APRWKPTR)                             0230
*   STARTAPR=ENTRYPTR;              /* SAVE START POINTER    @ZD00192*/
         ST    ENTRYPTR,STARTAPR(,APRWKPTR)                        0231
*   APRSSIDF='';                    /* BLANK SSIDS           @ZD00192*/
         MVI   APRSSIDF(APRWKPTR),C' '                             0232
         MVC   APRSSIDF+1(15,APRWKPTR),APRSSIDF(APRWKPTR)          0232
*   APRSSIDS(1)=SAVESAPR;           /* SAVE FIRST SSID       @ZD00192*/
         MVC   APRSSIDS(4,APRWKPTR),SAVESAPR(APRWKPTR)             0233
*   DO J=PINDEX+1 TO TOTALENT;      /* FIND END OF APR       @ZM31121*/
         LA    J,1                                                 0234
         AL    J,PINDEX                                            0234
         B     @DE00234                                            0234
@DL00234 DS    0H                                                  0235
*     ENTRYPTR=ACCPOINT(J);         /* GET DATA POINTER      @ZM31121*/
         LR    @15,J                                               0235
         SLA   @15,2                                               0235
         L     @01,STARTPNT(,APRWKPTR)                             0235
         AL    @01,@CF00875                                        0235
         L     ENTRYPTR,ACCPOINT(@15,@01)                          0235
*     TEMP2=ENTSSID;                /* MOVE SSID             @ZM31121*/
         MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0236
*     UNPK(TEMP5,TEMP3);            /* UNPACK                @ZM31121*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0237
*     TEMP1417=TEMP4;               /* MOVE SSID             @ZM31121*/
         MVC   TEMP1417(4,APRWKPTR),TEMP4(APRWKPTR)                0238
*     CALL EBCDICCV;                /* CONVERT TO EBCDIC     @ZM31121*/
         BAL   @14,EBCDICCV                                        0239
*     SAVESAPR=TEMP1417;            /* SAVE SSID             @ZM31121*/
         MVC   SAVESAPR(4,APRWKPTR),TEMP1417(APRWKPTR)             0240
*     K=0;                          /* RESET K TO ZERO       @ZM31121*/
         SLR   @05,@05                                             0241
         ST    @05,K                                               0241
*     IF EFLAG2='1'B×ETYPCODE=T41 THEN/* END OR START        @ZM31121*/
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0242
         BO    @RT00242                                            0242
         CLI   ETYPCODE(ENTRYPTR),X'41'                            0242
         BNE   @RF00242                                            0242
@RT00242 DS    0H                                                  0243
*       J=TOTALENT;                 /* GET OUT OF LOOP       @ZM31121*/
         L     J,TOTALENT(,APRWKPTR)                               0243
*     ELSE                                                         0244
*       IF ETYPCODE=T42 THEN        /* RECORD IN APR         @ZM31121*/
*                                                                  0244
         B     @RC00242                                            0244
@RF00242 CLI   ETYPCODE(ENTRYPTR),X'42'                            0244
         BNE   @RF00244                                            0244
*         /***********************************************************/
*         /*                                                         */
*         /* IN AN APR SEQUENCE - SAVE SSID                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0245
*         DO I=2 TO 4 WHILE(K=0);   /* LOOP THROUGH SSIDS    @ZD00192*/
         LA    I,2                                                 0245
@DL00245 ICM   @15,15,K                                            0245
         BNZ   @DC00245                                            0245
*           IF APRSSIDS(I)=BLANK THEN/* SSID BLANK           @ZD00192*/
         LR    @15,I                                               0246
         SLA   @15,2                                               0246
         ST    @15,@TF00001                                        0246
         ALR   @15,APRWKPTR                                        0246
         CLC   APRSSIDS-4(4,@15),@CC00365                          0246
         BNE   @RF00246                                            0246
*             DO;                   /* YES, STORE SSID       @ZD00192*/
*               K=1;                /* SET GET OUT OF LOOP   @ZD00192*/
         MVC   K(4),@CF00083                                       0248
*               APRSSIDS(I)=SAVESAPR;/* SAVE SSID            @ZD00192*/
         LR    @01,APRWKPTR                                        0249
         AL    @01,@TF00001                                        0249
         MVC   APRSSIDS-4(4,@01),SAVESAPR(APRWKPTR)                0249
*             END;                  /* END STORE SSID        @ZD00192*/
*           ELSE                                                   0251
*             ;                     /* SSID NOT BLANK        @ZD00192*/
@RF00246 DS    0H                                                  0252
*         END;                      /* END SSID LOOP         @ZD00192*/
         AL    I,@CF00083                                          0252
         CH    I,@CH00106                                          0252
         BNH   @DL00245                                            0252
@DC00245 DS    0H                                                  0253
*       ELSE                        /* NO, CHECK IF T00      @ZM31121*/
*         IF ETYPCODE=T00 THEN      /* APR SUU RECORD        @ZM31121*/
*                                                                  0253
         B     @RC00244                                            0253
@RF00244 CLI   ETYPCODE(ENTRYPTR),X'00'                            0253
         BNE   @RF00253                                            0253
*           /*********************************************************/
*           /*                                                       */
*           /* FLAG SAVED SSID IN APR SEQUENCE AS UNUSABLE           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0254
*           DO I=1 TO 4 WHILE(K=0); /* YES, LOOP THRU SSIDS  @ZD00192*/
         LA    I,1                                                 0254
@DL00254 ICM   @15,15,K                                            0254
         BNZ   @DC00254                                            0254
*             IF APRSSIDS(I)=BLANK THEN/* SSID NOT IN LIST   @ZD00192*/
         LR    @15,I                                               0255
         SLA   @15,2                                               0255
         ST    @15,@TF00001                                        0255
         ALR   @15,APRWKPTR                                        0255
         CLC   APRSSIDS-4(4,@15),@CC00365                          0255
         BNE   @RF00255                                            0255
*               APRSSIDS(I)=SAVESAPR;/* YES, ADD IT          @ZM31121*/
         LR    @01,APRWKPTR                                        0256
         AL    @01,@TF00001                                        0256
         MVC   APRSSIDS-4(4,@01),SAVESAPR(APRWKPTR)                0256
*             ELSE                                                 0257
*               ;                   /* SSID IN LIST NOT BLANK@ZD00192*/
@RF00255 DS    0H                                                  0258
*             IF APRSSIDS(I)=SAVESAPR THEN/* FOUND THIS SSID @ZM31121*/
         LR    @15,I                                               0258
         SLA   @15,2                                               0258
         ST    @15,@TF00001                                        0258
         ALR   @15,APRWKPTR                                        0258
         CLC   APRSSIDS-4(4,@15),SAVESAPR(APRWKPTR)                0258
         BNE   @RF00258                                            0258
*               DO;                 /* FLAG SSID AND GET OUT @ZD00192*/
*                 APRSSIDS(I,1)='FF'X;/* FLAG IT UNUSABLE    @ZD00192*/
         LR    @01,APRWKPTR                                        0260
         AL    @01,@TF00001                                        0260
         MVI   APRSSIDS-4(@01),X'FF'                               0260
*                 K=1;              /* SET K TO EXIT LOOP    @ZD00192*/
         MVC   K(4),@CF00083                                       0261
*               END;                /* END FLAG SSIDS LOOP   @ZD00192*/
*             ELSE                                                 0263
*               ;                   /* NO MATCH              @ZD00192*/
@RF00258 DS    0H                                                  0264
*           END;                    /* END LOOP              @ZD00192*/
         AL    I,@CF00083                                          0264
         CH    I,@CH00106                                          0264
         BNH   @DL00254                                            0264
@DC00254 DS    0H                                                  0265
*         ELSE                                                     0265
*           ;                       /* NO, RECORD NOT APR    @ZM31121*/
@RF00253 DS    0H                                                  0266
*   END;                            /* END LOOP THROUGH DATA @ZM31121*/
@RC00244 DS    0H                                                  0266
@RC00242 AL    J,@CF00083                                          0266
@DE00234 C     J,TOTALENT(,APRWKPTR)                               0266
         BNH   @DL00234                                            0266
*   IF EFLAG2='0'B THEN             /* NO END TO APR         @ZM31121*/
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0267
         BNZ   @RF00267                                            0267
*     CALL BACTION2;                /* PRINT 1 AND GET 2     @ZM31121*/
         BAL   @14,BACTION2                                        0268
*   ELSE                            /* NORMAL END TO APR     @ZM31121*/
*     CALL BUILDA1;                 /* BUILD ACTION 1 MESSAGE      0269
*                                                            @ZM31121*/
         B     @RC00267                                            0269
@RF00267 BAL   @14,BUILDA1                                         0269
*   ENTRYPTR=STARTAPR;              /* RESTORE POINTER TO DATA     0270
*                                                            @ZM31121*/
@RC00267 L     ENTRYPTR,STARTAPR(,APRWKPTR)                        0270
*   END BACTION1;                   /* END SAVE SSIDS PROC   @ZD00192*/
@EL00006 DS    0H                                                  0271
@EF00006 DS    0H                                                  0271
@ER00006 L     @14,@SA00006                                        0271
         BR    @14                                                 0271
*                                                                  0272
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION2 - PROC TO BUILD ACTION 1 AND ACTION 2 MESSAGES FOR   */
*   /* ALTERNATE PATH RETRY SEQUENCES                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0272
*BACTION2:                                                         0272
*   PROC OPTIONS(SAVE(14));         /* PROC TO BUILD ACTIONS 1 AND 2
*                                                            @ZD00192*/
BACTION2 ST    @14,@SA00007                                        0272
*   IF APRFLAGS(2)='0'B×EFLAG2='0'B THEN /* INCOMPLETE APR   @ZM31121*/
         TM    APRFLAGS(APRWKPTR),B'01000000'                      0273
         BZ    @RT00273                                            0273
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0273
         BNZ   @RF00273                                            0273
@RT00273 DS    0H                                                  0274
*     DO;                           /* YES, APR WITH NO START@ZM31121*/
*                                                                  0274
*       /*************************************************************/
*       /*                                                           */
*       /* END APR WITH NO START APR OR NO END APR                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0275
*       IF LINECNT>56 THEN          /* AT END OF PAGE        @ZM31121*/
         L     @06,LINECNT(,APRWKPTR)                              0275
         CH    @06,@CH00626                                        0275
         BNH   @RF00275                                            0275
*         DO;                       /* YES, 3 LINES TOO MUCH @ZM31121*/
*           CALL PHEADER;           /* START NEW PAGE        @ZD00192*/
         BAL   @14,PHEADER                                         0277
*           LINECNT=LINECNT+3;      /* ADD 3 TO LINE COUNT   @ZM31121*/
         LA    @06,3                                               0278
         AL    @06,LINECNT(,APRWKPTR)                              0278
         ST    @06,LINECNT(,APRWKPTR)                              0278
*         END;                      /* END SKIP PAGE         @ZM31121*/
*       ELSE                        /* NO, BUT ADD 3RD LINE  @ZD00192*/
*         LINECNT=LINECNT+1;        /* ADD 1 TO LINECNT      @ZM31121*/
         B     @RC00275                                            0280
@RF00275 LA    @06,1                                               0280
         AL    @06,LINECNT(,APRWKPTR)                              0280
         ST    @06,LINECNT(,APRWKPTR)                              0280
*       LINE='';                    /* BLANK LINE            @ZD00192*/
@RC00275 MVI   LINE(CVTPTR),C' '                                   0281
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0281
*       APRTEMPS=''B;               /* ZERO TEMPS            @ZD00192*/
         XC    APRTEMPS(32,APRWKPTR),APRTEMPS(APRWKPTR)            0282
*       BAR2=DASH;                  /* MOVE BAR2             @ZD00192*/
         MVI   BAR2(CVTPTR),C'-'                                   0283
*       BAR3=DASH;                  /* MOVE BAR3             @ZD00192*/
         MVI   BAR3(CVTPTR),C'-'                                   0284
*       CALL BUILDA1;               /* BUILD ACTION 1 MESSAGE@ZD00192*/
*                                                                  0285
         BAL   @14,BUILDA1                                         0285
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT ACTION 1 - NO APR BEG OR NO ENDINNING              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0286
*       RFY                                                        0286
*         R1 RSTD;                  /*                       @ZD00192*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0287
*       CALL ISDAPRT0;              /* PRINT ACTION 1        @ZD00192*/
         L     @15,@CV00389                                        0288
         BALR  @14,@15                                             0288
*       ANSI=LSKIP1;                /* SET 1 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C' '                                   0289
*       LINE='';                    /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0290
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0290
*       APRTEMPS=''B;               /* ZERO TEMPS            @ZD00192*/
         XC    APRTEMPS(32,APRWKPTR),APRTEMPS(APRWKPTR)            0291
*       BAR2=DASH;                  /* MOVE BAR2             @ZD00192*/
         MVI   BAR2(CVTPTR),C'-'                                   0292
*       BAR3=DASH;                  /* MOVE BAR3             @ZD00192*/
         MVI   BAR3(CVTPTR),C'-'                                   0293
*       IF EFLAG2='1'B THEN         /* HAVE END APR          @ZM31121*/
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0294
         BNO   @RF00294                                            0294
*         DO;                       /* YES, GET DATE/TIME    @ZM31121*/
*           SAVEDAYT=ENTDAYT;       /* MOVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0296
*           CALL MOVEDAYT;          /* BUILD DATE,TIME       @ZD00192*/
         BAL   @14,MOVEDAYT                                        0297
*         END;                      /* END GET TIME          @ZM31121*/
*       ELSE;                       /* NO END                @ZM31121*/
@RF00294 DS    0H                                                  0300
*     END;                          /* END APR WITH NO START @ZM31121*/
*   ELSE                                                           0301
*     ;                             /* NORMAL APR SEQUENCE   @ZM31121*/
@RF00273 DS    0H                                                  0302
*                                                                  0302
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD ACTION 2 - END APR MESSAGE                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0302
*   IF EFLAG2='1'B THEN             /* NORMAL END APR        @ZM31121*/
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0302
         BNO   @RF00302                                            0302
*     DO;                           /* YES, GET MESSAGE      @ZM31121*/
*       ACTION=ACTION2;             /* MOVE ACTION MESSAGE   @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION2                           0304
*       IF ETYPCODE=T07 THEN        /* CODE 07 = SUCCESSFUL RETRY  0305
*                                                            @ZD00192*/
         CLI   ETYPCODE(ENTRYPTR),X'07'                            0305
         BNE   @RF00305                                            0305
*         CALL BUILDT07;            /* YES, BUILD SUCC RETRY RESULT
*                                                            @ZD00192*/
         BAL   @14,BUILDT07                                        0306
*       ELSE                        /* NO, MUST BE MEDIA FAILURE CODE
*                                      F7                    @ZD00192*/
*         CALL BUILDTF7;            /* BUILD MEDIA FAILURE RESULT  0307
*                                                            @ZD00192*/
         B     @RC00305                                            0307
@RF00305 BAL   @14,BUILDTF7                                        0307
*     END;                          /* END BUILD             @ZM31121*/
*   ELSE                            /* NO END TO APR         @ZM31121*/
*     DO;                           /* GET ERROR MESSAGE     @ZM31121*/
         B     @RC00302                                            0309
@RF00302 DS    0H                                                  0310
*       ACTION=ACTION2E;            /* MOVE MESSAGE          @ZM31121*/
         MVC   ACTION(19,CVTPTR),ACTION2E                          0310
*       CALL BUILDT07;              /* BUILD MESSAGE         @ZM31121*/
         BAL   @14,BUILDT07                                        0311
*     END;                          /* END ERROR BUILD       @ZM31121*/
*   APRFLAGS(2)='0'B;               /* RESET APR FLAG OFF    @ZD00192*/
@RC00302 NI    APRFLAGS(APRWKPTR),B'10111111'                      0313
*   T08COUNT=''B;                   /* ZERO MSG CODE 08 COUNT@ZM31121*/
         SLR   @06,@06                                             0314
         STH   @06,T08COUNT(,APRWKPTR)                             0314
*   END BACTION2;                   /* END ACTION 2 PROC     @ZD00192*/
@EL00007 DS    0H                                                  0315
@EF00007 DS    0H                                                  0315
@ER00007 L     @14,@SA00007                                        0315
         BR    @14                                                 0315
*                                                                  0316
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDA1 - PROC TO BUILD ACTION 1 MESSAGE - START APR          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0316
*BUILDA1:                                                          0316
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 1 PROC   @ZD00192*/
BUILDA1  ST    @14,@SA00008                                        0316
*   RM71=ACT1M1;                    /* MOVE RESULT           @ZM31121*/
         MVC   RM71(71,CVTPTR),ACT1M1                              0317
*   IF APRFLAGS(2)='1'B THEN        /* HAVE BEGINNING OF APR SEQUENCE
*                                                            @ZD00192*/
*                                                                  0318
         TM    APRFLAGS(APRWKPTR),B'01000000'                      0318
         BNO   @RF00318                                            0318
*     /***************************************************************/
*     /*                                                             */
*     /* END APR WITH RECORDED BEGINNING                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0319
*     DO;                           /* YES, HAVE START OF APR@ZD00192*/
*       ACTION=ACTION1;             /* MOVE ACTION 1 MESSAGE @ZM31121*/
         MVC   ACTION(19,CVTPTR),ACTION1                           0320
*       CURRPTR=ENTRYPTR;           /* SAVE CURRENT PTR      @ZD00192*/
         ST    ENTRYPTR,CURRPTR(,APRWKPTR)                         0321
*       ENTRYPTR=STARTAPR;          /* SET PTR TO START OF APR     0322
*                                                            @ZD00192*/
         L     ENTRYPTR,STARTAPR(,APRWKPTR)                        0322
*       SAVEDAYT=ENTDAYT;           /* MOVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0323
*       CALL MOVEDAYT;              /* BUILD DATE,TIME       @ZD00192*/
         BAL   @14,MOVEDAYT                                        0324
*       TEMP1=EBYTE5;               /* MOVE PATH BYTE        @ZD00192*/
         MVC   TEMP1(1,APRWKPTR),EBYTE5(ENTRYPTR)                  0325
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0326
*       TEMP1415=TEMP2;             /* SAVE PATH             @ZD00192*/
         MVC   TEMP1415(2,APRWKPTR),TEMP2(APRWKPTR)                0327
*       CALL EBCDICCV;              /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0328
*       PATHA1M1=TEMP1415;          /* MOVE PATH             @ZD00192*/
         MVC   PATHA1M1(2,CVTPTR),TEMP1415(APRWKPTR)               0329
*       ENTRYPTR=CURRPTR;           /* RESTORE CURRENT INDEX @ZD00192*/
         L     ENTRYPTR,CURRPTR(,APRWKPTR)                         0330
*       J=2;                        /* SET OUTPUT POINTER    @ZD00192*/
         LA    J,2                                                 0331
*       DO I=1 TO 4;                /* LOOP THROUGH SSIDS    @ZD00192*/
         LA    I,1                                                 0332
@DL00332 DS    0H                                                  0333
*         SSIDA1M1(J:J+2)=APRSSIDS(I,2:4);/* MOVE SSID       @ZD00192*/
         LR    @15,CVTPTR                                          0333
         ALR   @15,J                                               0333
         LR    @14,I                                               0333
         SLA   @14,2                                               0333
         ALR   @14,APRWKPTR                                        0333
         MVC   SSIDA1M1-1(3,@15),APRSSIDS-3(@14)                   0333
*         J=J+4;                    /* INC OUTPUT INDEX      @ZD00192*/
         AH    J,@CH00106                                          0334
*       END;                        /* END SSID LOOP         @ZD00192*/
         AL    I,@CF00083                                          0335
         CH    I,@CH00106                                          0335
         BNH   @DL00332                                            0335
*     END;                          /* END NORMAL APR SEQUENCE     0336
*                                                            @ZD00192*/
*   ELSE                            /* NO BEGINNING OF APR   @ZD00192*/
*                                                                  0337
*     /***************************************************************/
*     /*                                                             */
*     /* END APR WITH NO BEGINNING                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0337
*     ACTION=ACTION1E;              /* MOVE ERROR MESSAGE    @ZD00192*/
*                                                                  0337
         B     @RC00318                                            0337
@RF00318 MVC   ACTION(19,CVTPTR),ACTION1E                          0337
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE VOLID AND CSN IF AVAILABLE                       @ZD00192*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   IF EFLAG2='1'B THEN             /* HAVE APR WITH NORMAL END    0338
*                                                            @ZD00192*/
@RC00318 TM    EFLAG2(ENTRYPTR),B'01000000'                        0338
         BNO   @RF00338                                            0338
*     DO;                           /* YES, MOVE MEDIA INFO  @ZD00192*/
*       IF ENTCSN(1)>=HEXA THEN     /* CSN NOT 00            @ZD00192*/
         CLI   ENTCSN(ENTRYPTR),X'C1'                              0340
         BL    @RF00340                                            0340
*         CSNA1M1=ENTCSN;           /* MOVE CSN              @ZD00192*/
         MVC   CSNA1M1(12,CVTPTR),ENTCSN(ENTRYPTR)                 0341
*       ELSE                                                       0342
*         ;                         /* CSN ZERO, DO NOT MOVE @ZD00192*/
@RF00340 DS    0H                                                  0343
*       IF ENTVOLID(1)>=HEXA THEN   /* VOLID NOT 00          @ZD00192*/
         CLI   ENTVOLID(ENTRYPTR),X'C1'                            0343
         BL    @RF00343                                            0343
*         DO;                       /* YES, MOVE VOLID+SEQ   @ZA00668*/
*           VOLA1M1=ENTVOLID;       /* MOVE VOLID            @ZD00192*/
         MVC   VOLA1M1(6,CVTPTR),ENTVOLID(ENTRYPTR)                0345
*           IF EBYTE10^='00'X THEN  /* HAVE SEQUENCE NUMBER  @ZA00668*/
         CLI   EBYTE10(ENTRYPTR),X'00'                             0346
         BE    @RF00346                                            0346
*             DO;                   /* YES, PRINT IT         @ZA00668*/
*               SEQFA1M1=ACT1M2;    /* MOVE OVERLAY          @ZA00668*/
         MVC   SEQFA1M1(3,CVTPTR),ACT1M2                           0348
*               SEQNA1M1=EBYTE10×'F0'X; /* MAKE PRINTABLE    @ZA00668*/
         MVC   SEQNA1M1(1,CVTPTR),EBYTE10(ENTRYPTR)                0349
         OI    SEQNA1M1(CVTPTR),X'F0'                              0349
*             END;                  /* END MOVE SEQ NUMBER   @ZA00668*/
*           ELSE;                   /* SEQUENCE NUMBER = 00  @ZA00668*/
@RF00346 DS    0H                                                  0352
*         END;                      /* END MOVE VOLID+SEQ    @ZA00668*/
*       ELSE                                                       0353
*         ;                         /* VOLID ZERO, DO NOT MOVE     0353
*                                                            @ZD00192*/
@RF00343 DS    0H                                                  0354
*     END;                          /* END MOVE MEDIA DATA   @ZD00192*/
*   ELSE                                                           0355
*     ;                             /* NO MEDIA INFO, APR WITH NO END
*                                                            @ZD00192*/
@RF00338 DS    0H                                                  0356
*   END BUILDA1;                    /* END BUILD ACTION 1 MESSAGE  0356
*                                                            @ZD00192*/
@EL00008 DS    0H                                                  0356
@EF00008 DS    0H                                                  0356
@ER00008 L     @14,@SA00008                                        0356
         BR    @14                                                 0356
*                                                                  0357
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDT07 - PROC TO BUILD ACTION 2 MESSAGE FOR SUCCESSFUL RETRY*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*BUILDT07:                                                         0357
*   PROC OPTIONS(SAVE(14));         /* SUCCESSFUL RETRY PROC @ZD00192*/
BUILDT07 ST    @14,@SA00009                                        0357
*   RM42=ACT2M1T;                   /* MOVE RIGHT PART       @ZM31022*/
         MVC   RM42(42,CVTPTR),ACT2M1T                             0358
*   IF EFLAG2='1'B THEN             /* APR WITH NORMAL END   @ZD00192*/
         TM    EFLAG2(ENTRYPTR),B'01000000'                        0359
         BNO   @RF00359                                            0359
*     DO;                           /* YES, GET LAST PATH    @ZM31022*/
*       IF EBYTE3(7)='1'B THEN      /* UNSUCCESSFUL RETRY BIT ON   0361
*                                                            @ZD00192*/
         TM    EBYTE3(ENTRYPTR),B'00000010'                        0361
         BNO   @RF00361                                            0361
*         RM18=ACT2M1U;             /* YES, MOVE UNSUCCESSFUL@ZD00192*/
         MVC   RM18(18,CVTPTR),ACT2M1U                             0362
*       ELSE                        /* SUCCESSFUL RETRY BIT ON     0363
*                                                            @ZD00192*/
*         RM18=ACT2M1;              /* YES, MOVE SUCCESSFUL MESSAGE
*                                                            @ZD00192*/
         B     @RC00361                                            0363
@RF00361 MVC   RM18(18,CVTPTR),ACT2M1                              0363
*       TEMP1=EBYTE13;              /* GET LAST PATH         @ZA17149*/
@RC00361 MVC   TEMP1(1,APRWKPTR),EBYTE13(ENTRYPTR)                 0364
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZM31022*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0365
*       TEMP1415=TEMP2;             /* MOVE PATH             @ZA17149*/
         MVC   TEMP1415(2,APRWKPTR),TEMP2(APRWKPTR)                0366
*       CALL EBCDICCV;              /* CONVERT TO EBCDIC     @ZM31022*/
         BAL   @14,EBCDICCV                                        0367
*       PATHA2M1=TEMP1415;          /* MOVE LAST PATH        @ZA17149*/
         MVC   PATHA2M1(2,CVTPTR),TEMP1415(APRWKPTR)               0368
*     END;                          /* END APR NORMAL END    @ZM31022*/
*   ELSE                            /* APR WITH NO END       @ZD00192*/
*     RM18=ACT2M1E;                 /* MOVE NO RESULT MESSAGE@ZD00192*/
         B     @RC00359                                            0370
@RF00359 MVC   RM18(18,CVTPTR),ACT2M1E                             0370
*   J=2;                            /* SET OUTPUT INDEX      @ZD00192*/
@RC00359 LA    J,2                                                 0371
*   IF APRFLAGS(2)='1'B THEN        /* HAVE BEGINNING        @ZD00192*/
         TM    APRFLAGS(APRWKPTR),B'01000000'                      0372
         BNO   @RF00372                                            0372
*     DO I=1 TO 4;                  /* YES, LOOP THROUGH SSIDS     0373
*                                                            @ZD00192*/
         LA    I,1                                                 0373
@DL00373 DS    0H                                                  0374
*       IF APRSSIDS(I,1)='FF'X THEN /* SSID MARKED UNUSABLE  @ZD00192*/
         LR    @04,I                                               0374
         SLA   @04,2                                               0374
         ST    @04,@TF00001                                        0374
         ALR   @04,APRWKPTR                                        0374
         CLI   APRSSIDS-4(@04),X'FF'                               0374
         BNE   @RF00374                                            0374
*         DO;                       /* YES, MOVE IT          @ZD00192*/
*           SSIDA2M1(J:J+2)=APRSSIDS(I,2:4);/* MOVE SSID     @ZD00192*/
         LR    @04,CVTPTR                                          0376
         ALR   @04,J                                               0376
         LR    @15,APRWKPTR                                        0376
         AL    @15,@TF00001                                        0376
         MVC   SSIDA2M1-1(3,@04),APRSSIDS-3(@15)                   0376
*           J=J+4;                  /* INC OUTPUT INDEX      @ZD00192*/
         AH    J,@CH00106                                          0377
*         END;                      /* END MOVE SSID         @ZD00192*/
*       ELSE                                                       0379
*         ;                         /* NOT MARKED UNUSABLE   @ZD00192*/
@RF00374 DS    0H                                                  0380
*     END;                          /* END LOOP THROUGH SSIDS@ZD00192*/
         AL    I,@CF00083                                          0380
         CH    I,@CH00106                                          0380
         BNH   @DL00373                                            0380
*   ELSE                                                           0381
*     ;                             /* NO BEGINNING          @ZD00192*/
@RF00372 DS    0H                                                  0382
*   IF J=2 THEN                     /* ANY SSIDS MOVED       @ZD00192*/
         CH    J,@CH00102                                          0382
         BNE   @RF00382                                            0382
*     SSIDA2M1=ACT2M2;              /* NO, MOVE NONE MESSAGE @ZD00192*/
         MVC   SSIDA2M1(16,CVTPTR),ACT2M2                          0383
*   ELSE                                                           0384
*     ;                             /* YES, SSIDS MOVED      @ZD00192*/
@RF00382 DS    0H                                                  0385
*   END BUILDT07;                   /* END SUCCESSFUL RETRY PROC   0385
*                                                            @ZD00192*/
@EL00009 DS    0H                                                  0385
@EF00009 DS    0H                                                  0385
@ER00009 L     @14,@SA00009                                        0385
         BR    @14                                                 0385
*                                                                  0386
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDTF7 - PROC TO BUILD ACTION 2 MESSAGE FOR MEDIA FAILURE   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0386
*BUILDTF7:                                                         0386
*   PROC OPTIONS(SAVE(14));         /* MEDIA FAILURE PROC    @ZD00192*/
BUILDTF7 ST    @14,@SA00010                                        0386
*   RM28=ACT2M3;                    /* MOVE RESULT LEFT PART @ZD00192*/
         MVC   RM28(28,CVTPTR),ACT2M3                              0387
*   RFLAG=RFLAG2;                   /* MOVE MEDIA FAILURE FLAG     0388
*                                                            @ZD00192*/
         MVC   RFLAG(13,CVTPTR),RFLAG2                             0388
*   TEMP4=EBYT1215;                 /* MOVE TERM CODE AND LZYX     0389
*                                                            @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),EBYT1215(ENTRYPTR)                0389
*   UNPK(TEMP9,TEMP5);              /* UNPACK                @ZD00192*/
         UNPK  TEMP9(9,APRWKPTR),TEMP5(5,APRWKPTR)                 0390
*   TEMP1417=TEMP9(5:8);            /* SAVE LZYX             @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP9+4(APRWKPTR)              0391
*   TEMP1113=TEMP3;                 /* SAVE TERM CODE        @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP3(APRWKPTR)                0392
*   TEMP2=EBYT2829;                 /* CYL STAGED IN ERROR   @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),EBYT2829(ENTRYPTR)                0393
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0394
*   TEMP710=TEMP4;                  /* SAVE CYL STAGED IN ERROR    0395
*                                                            @ZD00192*/
         MVC   TEMP710(4,APRWKPTR),TEMP4(APRWKPTR)                 0395
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0396
*   LZYXA2M3=TEMP1417;              /* MOVE LZYX             @ZD00192*/
         MVC   LZYXA2M3(4,CVTPTR),TEMP1417(APRWKPTR)               0397
*   IF EBYTE12='01'X THEN           /* TERM CODE 01          @ZD00192*/
         CLI   EBYTE12(ENTRYPTR),X'01'                             0398
         BNE   @RF00398                                            0398
*     IF T08COUNT=0 THEN            /* ANY MSG 08 LOGGED     @ZM31121*/
         ICM   @06,3,T08COUNT(APRWKPTR)                            0399
         BNZ   @RF00399                                            0399
*       RM33=ACT2M4;                /* NO, MOVE MEDIA MSG    @ZM31121*/
         MVC   RM33(33,CVTPTR),ACT2M4                              0400
*     ELSE                          /* YES, HAD STAGE WITH   @ZM31121*/
*       DO;                         /* ERROR                 @ZM31121*/
         B     @RC00399                                            0401
@RF00399 DS    0H                                                  0402
*         RM33=ACT2M8;              /* MOVE MESSAGE          @ZM31121*/
         MVC   RM33(33,CVTPTR),ACT2M8                              0402
*         J=T08COUNT;               /* MOVE 08 COUNT         @ZM31121*/
         LH    J,T08COUNT(,APRWKPTR)                               0403
*         CVD(J,TEMP8);             /* CONVERT TO DECIMAL    @ZM31121*/
         CVD   J,TEMP8(,APRWKPTR)                                  0404
*         NO08A2M3=EDPAT03;         /* MOVE EDIT PATTERN     @ZM31121*/
         MVC   NO08A2M3(4,CVTPTR),EDPAT03                          0405
*         ED(NO08A2M3,TEMP78);      /* EDIT COUNT            @ZM31121*/
         ED    NO08A2M3(4,CVTPTR),TEMP78(APRWKPTR)                 0406
*       END;                        /* END STAGE WITH ERROR  @ZM31121*/
*   ELSE                                                           0408
*     IF EBYTE12='02'X THEN         /* TERM CODE 02          @ZD00192*/
         B     @RC00398                                            0408
@RF00398 CLI   EBYTE12(ENTRYPTR),X'02'                             0408
         BNE   @RF00408                                            0408
*       RM33=ACT2M5;                /* MOVE STRIPES AVAILABLE = 0  0409
*                                                            @ZD00192*/
         MVC   RM33(33,CVTPTR),ACT2M5                              0409
*     ELSE                                                         0410
*       IF EBYTE12='03'X THEN       /* TERM CODE 03          @ZD00192*/
         B     @RC00408                                            0410
@RF00408 CLI   EBYTE12(ENTRYPTR),X'03'                             0410
         BNE   @RF00410                                            0410
*         RM33=ACT2M6;              /* MOVE LOAD FAILURE     @ZD00192*/
         MVC   RM33(33,CVTPTR),ACT2M6                              0411
*       ELSE                        /* NOT TERM CODE 01,02, OR 03  0412
*                                                            @ZA00668*/
*         DO;                       /* UNKNOWN TERM CODE     @ZD00192*/
         B     @RC00410                                            0412
@RF00410 DS    0H                                                  0413
*           RM33=ACT2M7;            /* MOVE UNKNOWN TERM CODE@ZD00192*/
         MVC   RM33(33,CVTPTR),ACT2M7                              0413
*           TCA2M7=TEMP1113(1:2);   /* MOVE TERM CODE        @ZD00192*/
         MVC   TCA2M7(2,CVTPTR),TEMP1113(APRWKPTR)                 0414
*         END;                      /* END UNKNOWN CODE      @ZD00192*/
*   END BUILDTF7;                   /* END MEDIA FAILURE PROC@ZD00192*/
@EL00010 DS    0H                                                  0416
@EF00010 DS    0H                                                  0416
@ER00010 L     @14,@SA00010                                        0416
         BR    @14                                                 0416
*                                                                  0417
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION3 - PROC TO BUILD ACTION 3 - UNIT UNUSABLE (APR,ERP)   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0417
*BACTION3:                                                         0417
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 3        @ZD00192*/
BACTION3 ST    @14,@SA00011                                        0417
*   ACTION=ACTION3;                 /* MOVE ACTION           @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION3                           0418
*   RFLAG=RFLAG1;                   /* MOVE UNIT UNUSABLE    @ZD00192*/
         MVC   RFLAG(13,CVTPTR),RFLAG1                             0419
*   IF ETYPCODE=TF6 THEN            /* 06 WITH SUU           @ZA28897*/
         CLI   ETYPCODE(ENTRYPTR),X'F6'                            0420
         BNE   @RF00420                                            0420
*     DO;                           /* YES, MOVE M3          @ZA28897*/
*       RM66=ACT3M3;                /* MOVE RESULT MESSAGE   @ZA28897*/
         MVC   RM66(66,CVTPTR),ACT3M3                              0422
*       ERPA3M3='ERP';              /* CHANGE ACTION MESSAGE @ZA28897*/
         MVC   ERPA3M3(3,CVTPTR),@CC00827                          0423
*     END;                          /* END CODE 06 WITH SUU  @ZA28897*/
*   ELSE                            /* 00 WITH SUU           @ZA28897*/
*     RM58=ACT3M1;                  /* MOVE RESULT MESSAGE   @ZA28897*/
         B     @RC00420                                            0425
@RF00420 MVC   RM58(58,CVTPTR),ACT3M1                              0425
*   TEMP2=ENTSSID;                  /* MOVE SSID             @ZD00192*/
@RC00420 MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0426
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0427
*   TEMP1113=TEMP5(2:4);            /* SAVE 3 CHAR SSID      @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP5+1(APRWKPTR)              0428
*   IF ETYPCODE=TF6 THEN            /* 06 WITH SUU           @ZA28897*/
         CLI   ETYPCODE(ENTRYPTR),X'F6'                            0429
         BNE   @RF00429                                            0429
*     TEMP1=EBYTE5;                 /* MOVE TERM CODE        @ZA28897*/
         MVC   TEMP1(1,APRWKPTR),EBYTE5(ENTRYPTR)                  0430
*   ELSE                            /* 00 WITH SUU           @ZA28897*/
*     TEMP1=EBYTE4;                 /* MOVE BYTE 10          @ZA28897*/
         B     @RC00429                                            0431
@RF00429 MVC   TEMP1(1,APRWKPTR),EBYTE4(ENTRYPTR)                  0431
*   UNPK(TEMP3,TEMP2);              /* UNPACK                @ZD00192*/
@RC00429 UNPK  TEMP3(3,APRWKPTR),TEMP2(2,APRWKPTR)                 0432
*   TEMP1415=TEMP2;                 /* SAVE BYTE 10          @ZD00192*/
         MVC   TEMP1415(2,APRWKPTR),TEMP2(APRWKPTR)                0433
*   TEMP4=EBYTE03;                  /* MOVE BYTES 0-3        @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),EBYTE03(ENTRYPTR)                 0434
*   UNPK(TEMP20(1:9),TEMP5);        /* UNPK INTO 8 BYTES     @ZD00192*/
         UNPK  TEMP20(9,APRWKPTR),TEMP5(5,APRWKPTR)                0435
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0436
*   IF ETYPCODE=TF6 THEN            /* 06 WITH SUU           @ZA28897*/
         CLI   ETYPCODE(ENTRYPTR),X'F6'                            0437
         BNE   @RF00437                                            0437
*     TERMA3M3=TEMP1415;            /* MOVE TERM CODE        @ZA28897*/
         MVC   TERMA3M3(2,CVTPTR),TEMP1415(APRWKPTR)               0438
*   ELSE;                           /* 00 WITH SUU           @ZA28897*/
@RF00437 DS    0H                                                  0440
*     B03A3M1=TEMP20(1:8);          /* MOVE BYTES 0-3        @ZA28897*/
         MVC   B03A3M1(8,CVTPTR),TEMP20(APRWKPTR)                  0440
*   IF ENTSSID(6)='1'B THEN         /* DRC SSID              @ZD00192*/
         TM    ENTSSID(ENTRYPTR),B'00000100'                       0441
         BNO   @RF00441                                            0441
*     DO;                           /* YES, DRC-DRD PATH     @ZD00192*/
*       RM13=ACT3M2;                /* MOVE MESSAGE 2        @ZD00192*/
         MVC   RM13(13,CVTPTR),ACT3M2                              0443
*       SSIDA3M2=TEMP1113;          /* MOVE DRC SSID         @ZD00192*/
         MVC   SSIDA3M2(3,CVTPTR),TEMP1113(APRWKPTR)               0444
*       BY10A3M2=TEMP1415;          /* MOVE DRD SSID         @ZD00192*/
         MVC   BY10A3M2(2,CVTPTR),TEMP1415(APRWKPTR)               0445
*     END;                          /* END DRC-DRD PATH      @ZD00192*/
*   ELSE                            /* NOT DRC-DRD PATH      @ZD00192*/
*     DO;                           /* MESSAGE 1             @ZD00192*/
         B     @RC00441                                            0447
@RF00441 DS    0H                                                  0448
*       SSID34M1=TEMP1113;          /* MOVE SSID             @ZD00192*/
         MVC   SSID34M1(3,CVTPTR),TEMP1113(APRWKPTR)               0448
*       CALL DEVTMOVE;              /* GET DEVICE ID         @ZD00192*/
         BAL   @14,DEVTMOVE                                        0449
*       DEV34M1=TEMP4;              /* MOVE DEVICE ID        @ZD00192*/
         MVC   DEV34M1(4,CVTPTR),TEMP4(APRWKPTR)                   0450
*     END;                          /* END SA OR DRD SSID    @ZD00192*/
*   END BACTION3;                   /* END BUILD ACTION 3    @ZD00192*/
@EL00011 DS    0H                                                  0452
@EF00011 DS    0H                                                  0452
@ER00011 L     @14,@SA00011                                        0452
         BR    @14                                                 0452
*                                                                  0453
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION4 - PROC TO BUILD ACTION 4 - PERMANENT ERROR           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0453
*BACTION4:                                                         0453
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 4        @ZD00192*/
BACTION4 ST    @14,@SA00012                                        0453
*   ACTION=ACTION4;                 /* MOVE ACTION           @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION4                           0454
*   RFLAG=RFLAG1;                   /* MOVE UNIT UNUSABLE    @ZD00192*/
         MVC   RFLAG(13,CVTPTR),RFLAG1                             0455
*   IF ETYPCODE=T20 THEN            /* PERM ERROR ON MSC     @ZD00192*/
*                                                                  0456
         CLI   ETYPCODE(ENTRYPTR),X'20'                            0456
         BNE   @RF00456                                            0456
*     /***************************************************************/
*     /*                                                             */
*     /* FORMAT 1 AND 2 PERM ERRORS ON MSC                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0457
*     DO;                           /* BUILD MSC UNUSABLE MESSAGE  0457
*                                                            @ZD00192*/
*       RM61=ACT4M2;                /* MOVE RESULT MESSAGE 2 @ZD00192*/
         MVC   RM61(61,CVTPTR),ACT4M2                              0458
*       TEMP5=ENTCPUID;             /* MOVE CPUID            @ZD00192*/
         MVC   TEMP5(5,APRWKPTR),ENTCPUID(ENTRYPTR)                0459
*       UNPK(TEMP20(1:13),TEMP7);   /* UNPACK AND SAVE       @ZD00192*/
         UNPK  TEMP20(13,APRWKPTR),TEMP7(7,APRWKPTR)               0460
*       TEMP2=ENTSSID;              /* MOVE RUA              @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0461
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0462
*       TEMP1113=TEMP5(2:4);        /* SAVE RUA              @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP5+1(APRWKPTR)              0463
*       TEMP1=EBYTE9;               /* MOVE FSC BYTE 1       @ZD00192*/
         MVC   TEMP1(1,APRWKPTR),EBYTE9(ENTRYPTR)                  0464
*       TEMP2(2)=EBYTE10;           /* MOVE FSC BYTE 2       @ZD00192*/
         MVC   TEMP2+1(1,APRWKPTR),EBYTE10(ENTRYPTR)               0465
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0466
*       TEMP1417=TEMP4;             /* SAVE FSC              @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP4(APRWKPTR)                0467
*       CALL EBCDICCV;              /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0468
*       RUAA4M2=TEMP1113;           /* MOVE RUA              @ZD00192*/
         MVC   RUAA4M2(3,CVTPTR),TEMP1113(APRWKPTR)                0469
*       CPIDA4M2=TEMP16;            /* MOVE CPUID            @ZD00192*/
         MVC   CPIDA4M2(6,CVTPTR),TEMP16(APRWKPTR)                 0470
*       CPUSA4M2=TEMP710;           /* MOVE CPUSER           @ZD00192*/
         MVC   CPUSA4M2(4,CVTPTR),TEMP710(APRWKPTR)                0471
*       FSCA4M2=TEMP1417;           /* MOVE FSC              @ZD00192*/
         MVC   FSCA4M2(4,CVTPTR),TEMP1417(APRWKPTR)                0472
*     END;                          /* END PERM ERROR ON MSC @ZD00192*/
*                                                                  0474
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT 1, 3, 4, AND 5 PERM ERRORS                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*   ELSE                            /* PERM ERROR ON CS,SA,DRC,DRD,
*                                      OR 3330               @ZD00192*/
*     DO;                           /* BUILD ACTION 4 MESSAGE@ZD00192*/
         B     @RC00456                                            0474
@RF00456 DS    0H                                                  0475
*       RM68=ACT4M1;                /* MOVE RESULT MESSAGE 1 @ZD00192*/
         MVC   RM68(68,CVTPTR),ACT4M1                              0475
*       IF ETYPCODE=T40 THEN        /* FORMAT 4              @ZM31022*/
         CLI   ETYPCODE(ENTRYPTR),X'40'                            0476
         BNE   @RF00476                                            0476
*         DO;                       /* YES, MOVE FMT/MSG CODE@ZM31022*/
*           RM24=ACT4M3;            /* MOVE CENTER SECTION   @ZM31022*/
         MVC   RM24(24,CVTPTR),ACT4M3                              0478
*           TEMP2(2)=EFMTMSG;       /* MOVE BYTE 11          @ZM31022*/
         MVC   TEMP2+1(1,APRWKPTR),EFMTMSG(ENTRYPTR)               0479
*           UNPK(TEMP20(9:13),TEMP3);/* UNPACK               @ZM31022*/
         UNPK  TEMP20+8(5,APRWKPTR),TEMP3(3,APRWKPTR)              0480
*         END;                      /* END FORMAT 4 CODE     @ZM31022*/
*       ELSE                        /* MUST BE FMT 1,3,5     @ZM31022*/
*         DO;                       /* MOVE BYTES 0-5        @ZM31022*/
         B     @RC00476                                            0482
@RF00476 DS    0H                                                  0483
*           TEMP4=EBYTE03;          /* MOVE BYTES 0-3        @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),EBYTE03(ENTRYPTR)                 0483
*           UNPK(TEMP20(1:9),TEMP5);/* UNPACK AND SAVE       @ZD00192*/
         UNPK  TEMP20(9,APRWKPTR),TEMP5(5,APRWKPTR)                0484
*           TEMP2=EBYTE45;          /* MOVE BYTES 4,5        @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),EBYTE45(ENTRYPTR)                 0485
*           UNPK(TEMP20(9:13),TEMP3);/* UNPACK AND SAVE      @ZD00192*/
         UNPK  TEMP20+8(5,APRWKPTR),TEMP3(3,APRWKPTR)              0486
*         END;                      /* END FMT 1,3,5         @ZM31022*/
*       TEMP2=EBYTE67;              /* MOVE FSC              @ZD00192*/
@RC00476 MVC   TEMP2(2,APRWKPTR),EBYTE67(ENTRYPTR)                 0488
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0489
*       TEMP1417=TEMP4;             /* SAVE FSC              @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP4(APRWKPTR)                0490
*       TEMP3=ENTSSID;              /* MOVE SSID             @ZD00192*/
         MVI   TEMP3+2(APRWKPTR),X'00'                             0491
         MVC   TEMP3(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0491
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0492
*       TEMP1820=TEMP5(2:4);        /* SAVE SSID             @ZD00192*/
         MVC   TEMP1820(3,APRWKPTR),TEMP5+1(APRWKPTR)              0493
*       CALL EBCDICCV;              /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0494
*       SSID34M1=TEMP1820;          /* MOVE SSID             @ZD00192*/
         MVC   SSID34M1(3,CVTPTR),TEMP1820(APRWKPTR)               0495
*       IF ETYPCODE=T40 THEN        /* FORMAT 4              @ZM31022*/
         CLI   ETYPCODE(ENTRYPTR),X'40'                            0496
         BNE   @RF00496                                            0496
*         FMTMA4M3=TEMP20(11:12);   /* MOVE SA FMT/MSG CODE  @ZM31022*/
         MVC   FMTMA4M3(2,CVTPTR),TEMP20+10(APRWKPTR)              0497
*       ELSE                        /* MUST BE FORMAT 1,3,5  @ZM31022*/
*         DO;                       /* MOVE BYTES 0-5        @ZM31022*/
         B     @RC00496                                            0498
@RF00496 DS    0H                                                  0499
*           B03A4M1=TEMP20(1:8);    /* MOVE BYTES 0-3        @ZD00192*/
         MVC   B03A4M1(8,CVTPTR),TEMP20(APRWKPTR)                  0499
*           B45A4M1=TEMP20(9:12);   /* MOVE BYTES 4,5        @ZD00192*/
         MVC   B45A4M1(4,CVTPTR),TEMP20+8(APRWKPTR)                0500
*         END;                      /* END FMT 1,3,5         @ZM31022*/
*       IF ETYPCODE=T30 THEN        /* FORMAT 3 RECORD       @ZD00192*/
@RC00496 CLI   ETYPCODE(ENTRYPTR),X'30'                            0502
         BNE   @RF00502                                            0502
*         BFSCA4M1='';              /* YES, BLANK FSC FIELD  @ZD00192*/
         MVI   BFSCA4M1(CVTPTR),C' '                               0503
         MVC   BFSCA4M1+1(10,CVTPTR),BFSCA4M1(CVTPTR)              0503
*       ELSE                        /* NOT CS SENSE          @ZD00192*/
*         FSCA4M1=TEMP1417;         /* MOVE FSC              @ZD00192*/
         B     @RC00502                                            0504
@RF00502 MVC   FSCA4M1(4,CVTPTR),TEMP1417(APRWKPTR)                0504
*       CALL DEVTMOVE;              /* GET DEVICE ID         @ZD00192*/
@RC00502 BAL   @14,DEVTMOVE                                        0505
*       DEV34M1=TEMP4;              /* MOVE DEVICE ID        @ZD00192*/
         MVC   DEV34M1(4,CVTPTR),TEMP4(APRWKPTR)                   0506
*     END;                          /* END BUILD MESSAGE 1   @ZD00192*/
*   END BACTION4;                   /* END BUILD ACTION 4    @ZD00192*/
@EL00012 DS    0H                                                  0508
@EF00012 DS    0H                                                  0508
@ER00012 L     @14,@SA00012                                        0508
         BR    @14                                                 0508
*                                                                  0509
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION5 - PROC TO BUILD ACTION 5 - CS RECONFIGURED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0509
*BACTION5:                                                         0509
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 5        @ZD00192*/
BACTION5 ST    @14,@SA00013                                        0509
*   ACTION=ACTION5;                 /* MOVE ACTION           @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION5                           0510
*   RFLAG=RFLAG3;                   /* MOVE UNIT UNUSABLE    @ZD00192*/
         MVC   RFLAG(13,CVTPTR),RFLAG3                             0511
*   RM63=ACT5M1;                    /* MOVE RESULT MESSAGE   @ZM31121*/
         MVC   RM63(63,CVTPTR),ACT5M1                              0512
*   TEMP2=ENTSSID;                  /* MOVE SSID             @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0513
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0514
*   TEMP1113=TEMP5(2:4);            /* SAVE SSID             @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP5+1(APRWKPTR)              0515
*   TEMP2=EBYTE45;                  /* MOVE BYTES 4,5        @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),EBYTE45(ENTRYPTR)                 0516
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0517
*   TEMP1417=TEMP4;                 /* SAVE BYTES 4,5        @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP4(APRWKPTR)                0518
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0519
*   SSIDA5M1=TEMP1113;              /* MOVE SSID             @ZD00192*/
         MVC   SSIDA5M1(3,CVTPTR),TEMP1113(APRWKPTR)               0520
*   MSFNA5M1=SSIDA5M1(2);           /* MOVE MSF NUMBER       @ZM31022*/
         MVC   MSFNA5M1(1,CVTPTR),SSIDA5M1+1(CVTPTR)               0521
*   IF ENTSSID(2:3)='10'B THEN      /* LEFT ACCESSOR         @ZM31121*/
         TM    ENTSSID(ENTRYPTR),B'01000000'                       0522
         BNO   @RF00522                                            0522
         TM    ENTSSID(ENTRYPTR),B'00100000'                       0522
         BNZ   @RF00522                                            0522
*     ACCA5M1=ACT5M2;               /* YES, MOVE LEFT        @ZM31121*/
         MVC   ACCA5M1(5,CVTPTR),ACT5M2                            0523
*   ELSE                                                           0524
*     IF ENTSSID(2:3)='01'B THEN    /* RIGHT ACCESSOR        @ZM31121*/
         B     @RC00522                                            0524
@RF00522 TM    ENTSSID(ENTRYPTR),B'00100000'                       0524
         BNO   @RF00524                                            0524
         TM    ENTSSID(ENTRYPTR),B'01000000'                       0524
         BNZ   @RF00524                                            0524
*       ACCA5M1=ACT5M3;             /* YES, MOVE RIGHT       @ZM31121*/
         MVC   ACCA5M1(5,CVTPTR),ACT5M3                            0525
*     ELSE;                         /* DO NOT KNOW WHICH ACC @ZM31121*/
@RF00524 DS    0H                                                  0527
*   B45A5M1=TEMP1417;               /* MOVE BYTES 4,5        @ZD00192*/
@RC00522 MVC   B45A5M1(4,CVTPTR),TEMP1417(APRWKPTR)                0527
*   END BACTION5;                   /* END BUILD ACTION 5    @ZD00192*/
@EL00013 DS    0H                                                  0528
@EF00013 DS    0H                                                  0528
@ER00013 L     @14,@SA00013                                        0528
         BR    @14                                                 0528
*                                                                  0529
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION6 - PROC TO BUILD ACTION 6 - MISPLACED CARTRIDGE       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*BACTION6:                                                         0529
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 6        @ZD00192*/
BACTION6 ST    @14,@SA00014                                        0529
*   ACTION=ACTION6;                 /* MOVE ACTION           @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION6                           0530
*   RM72=ACT6M1;                    /* MOVE RESULT MESSAGE   @ZD00192*/
         MVC   RM72(72,CVTPTR),ACT6M1                              0531
*   TEMP4=EBYT1215;                 /* MOVE LZYX AND CASE NUMBER   0532
*                                                            @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),EBYT1215(ENTRYPTR)                0532
*   UNPK(TEMP9,TEMP5);              /* UNPACK                @ZD00192*/
         UNPK  TEMP9(9,APRWKPTR),TEMP5(5,APRWKPTR)                 0533
*   TEMP1417=TEMP9(5:8);            /* SAVE LZYX             @ZD00192*/
         MVC   TEMP1417(4,APRWKPTR),TEMP9+4(APRWKPTR)              0534
*   TEMP1113=TEMP3;                 /* SAVE CASE             @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP3(APRWKPTR)                0535
*   TEMP1=EBYTE10;                  /* MOVE BYTE 10          @ZD00192*/
         MVC   TEMP1(1,APRWKPTR),EBYTE10(ENTRYPTR)                 0536
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0537
*   TEMP1820=TEMP3;                 /* SAVE BYTE 10          @ZD00192*/
         MVC   TEMP1820(3,APRWKPTR),TEMP3(APRWKPTR)                0538
*   TEMP3=ENTSSID;                  /* MOVE SSUD FOR SUU     @ZA29141*/
         MVI   TEMP3+2(APRWKPTR),X'00'                             0539
         MVC   TEMP3(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0539
*   UNPK(TEMP5,TEMP3);              /* UNPACK IT             @ZA29141*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0540
*   TEMP710(1:3)=TEMP5(2:4);        /* SAVE SSID             @ZA29141*/
         MVC   TEMP710(3,APRWKPTR),TEMP5+1(APRWKPTR)               0541
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0542
*   TIDA6M1=TEMP1820(1:2);          /* MOVE TABLE ID         @ZD00192*/
         MVC   TIDA6M1(2,CVTPTR),TEMP1820(APRWKPTR)                0543
*   LZYXA6M1=TEMP1417;              /* MOVE LZYX             @ZD00192*/
         MVC   LZYXA6M1(4,CVTPTR),TEMP1417(APRWKPTR)               0544
*   CASEA6M1=TEMP1113(1:2);         /* MOVE CASE NUMBER      @ZD00192*/
         MVC   CASEA6M1(2,CVTPTR),TEMP1113(APRWKPTR)               0545
*   IF ENTVOLID(1)>=HEXA THEN       /* VOLID NOT 00          @ZD00192*/
         CLI   ENTVOLID(ENTRYPTR),X'C1'                            0546
         BL    @RF00546                                            0546
*     VOLA6M1=ENTVOLID;             /* MOVE VOLID            @ZD00192*/
         MVC   VOLA6M1(6,CVTPTR),ENTVOLID(ENTRYPTR)                0547
*   ELSE                                                           0548
*     ;                             /* VOLID ZERO, DO NOT MOVE     0548
*                                                            @ZD00192*/
@RF00546 DS    0H                                                  0549
*   IF ENTCSN(1)>=HEXA THEN         /* CSN NOT 00            @ZD00192*/
         CLI   ENTCSN(ENTRYPTR),X'C1'                              0549
         BL    @RF00549                                            0549
*     CSNA6M1=ENTCSN;               /* MOVE CSN              @ZD00192*/
         MVC   CSNA6M1(12,CVTPTR),ENTCSN(ENTRYPTR)                 0550
*   ELSE                                                           0551
*     ;                             /* CSN ZERO, DO NOT MOVE @ZD00192*/
@RF00549 DS    0H                                                  0552
*   IF ETYPCODE=TF9 THEN            /* SUU                   @ZA29141*/
         CLI   ETYPCODE(ENTRYPTR),X'F9'                            0552
         BNE   @RF00552                                            0552
*     DO;                           /* YES, ADD SSID         @ZA29141*/
*       RFLAG=RFLAG1;               /* FLAG SUU              @ZA29141*/
         MVC   RFLAG(13,CVTPTR),RFLAG1                             0554
*       IF ENTCSN(1)>=HEXA THEN     /* HAVE A CSN            @ZA29141*/
         CLI   ENTCSN(ENTRYPTR),X'C1'                              0555
         BL    @RF00555                                            0555
*         DO;                       /* YES, OVERLAY VOLID    @ZA29141*/
*           RM13=ACT6M2;            /* MOVE MESSAGE          @ZA29141*/
         MVC   RM13(13,CVTPTR),ACT6M2                              0557
*           SSIDA6M2=TEMP710(1:3);  /* MOVE SSID             @ZA29141*/
         MVC   SSIDA6M2(3,CVTPTR),TEMP710(APRWKPTR)                0558
*         END;                      /* END OVERLAY VOLID     @ZA29141*/
*       ELSE                        /* NO SCAN               @ZA29141*/
*         DO;                       /* OVERLAY CSN           @ZA29141*/
         B     @RC00555                                            0560
@RF00555 DS    0H                                                  0561
*           RM17=ACT6M2;            /* MOVE MESSAGE          @ZA29141*/
         MVI   RM17+13(CVTPTR),C' '                                0561
         MVC   RM17+14(3,CVTPTR),RM17+13(CVTPTR)                   0561
         MVC   RM17(13,CVTPTR),ACT6M2                              0561
*           SSIDA6M3=TEMP710(1:3);  /* MOVE SSID             @ZA29141*/
         MVC   SSIDA6M3(3,CVTPTR),TEMP710(APRWKPTR)                0562
*         END;                      /* END OVERLAY CSN       @ZA29141*/
*     END;                          /* END ADD SSID FOR SUU  @ZA29141*/
*   ELSE;                           /* NOT SUU               @ZA29141*/
@RF00552 DS    0H                                                  0566
*   END BACTION6;                   /* END BUILD ACTION 6    @ZD00192*/
@EL00014 DS    0H                                                  0566
@EF00014 DS    0H                                                  0566
@ER00014 L     @14,@SA00014                                        0566
         BR    @14                                                 0566
*                                                                  0567
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION7 - PROC TO BUILD ACTION 7 - SWITCH TO ALTERNATE MSC   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0567
*BACTION7:                                                         0567
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 7        @ZD00192*/
BACTION7 ST    @14,@SA00015                                        0567
*   ACTION=ACTION7;                 /* MOVE ACTION           @ZD00192*/
         MVC   ACTION(19,CVTPTR),ACTION7                           0568
*   RM61=ACT7M1;                    /* MOVE RESULT MESSAGE   @ZD00192*/
         MVC   RM61(61,CVTPTR),ACT7M1                              0569
*   TEMP5=ENTCPUID;                 /* MOVE CPUID            @ZD00192*/
         MVC   TEMP5(5,APRWKPTR),ENTCPUID(ENTRYPTR)                0570
*   UNPK(TEMP20(1:13),TEMP7);       /* UNPACK AND SAVE       @ZD00192*/
         UNPK  TEMP20(13,APRWKPTR),TEMP7(7,APRWKPTR)               0571
*   TEMP2=ENTSSID;                  /* MOVE RUA              @ZD00192*/
         MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0572
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0573
*   TEMP1113=TEMP5(2:4);            /* SAVE RUA              @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP5+1(APRWKPTR)              0574
*   TEMP1=EFMTMSG;                  /* MOVE MESSAGE CODE     @ZD00192*/
         MVC   TEMP1(1,APRWKPTR),EFMTMSG(ENTRYPTR)                 0575
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0576
*   TEMP1820=TEMP3;                 /* SAVE MESSAGE CODE     @ZD00192*/
         MVC   TEMP1820(3,APRWKPTR),TEMP3(APRWKPTR)                0577
*   CALL EBCDICCV;                  /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0578
*   RUAA7M1=TEMP1113;               /* MOVE RUA              @ZD00192*/
         MVC   RUAA7M1(3,CVTPTR),TEMP1113(APRWKPTR)                0579
*   CPIDA7M1=TEMP16;                /* MOVE CPUID            @ZD00192*/
         MVC   CPIDA7M1(6,CVTPTR),TEMP16(APRWKPTR)                 0580
*   CPUSA7M1=TEMP710;               /* MOVE CPUSER           @ZD00192*/
         MVC   CPUSA7M1(4,CVTPTR),TEMP710(APRWKPTR)                0581
*   MCA7M1=TEMP1820(1:2);           /* MOVE MESSAGE CODE     @ZD00192*/
         MVC   MCA7M1(2,CVTPTR),TEMP1820(APRWKPTR)                 0582
*   END BACTION7;                   /* END BUILD ACTION 7    @ZD00192*/
@EL00015 DS    0H                                                  0583
@EF00015 DS    0H                                                  0583
@ER00015 L     @14,@SA00015                                        0583
         BR    @14                                                 0583
*                                                                  0584
*   /*****************************************************************/
*   /*                                                               */
*   /* BACTION8 - PROC TO BUILD ACTION 8 - CYL STAGED WITH ERROR     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0584
*BACTION8:                                                         0584
*   PROC OPTIONS(SAVE(14));         /* BUILD ACTION 8        @ZM31121*/
BACTION8 ST    @14,@SA00016                                        0584
*   ACTION=ACTION8;                 /* MOVE ACTION           @ZM31121*/
         MVC   ACTION(19,CVTPTR),ACTION8                           0585
*   RM55=ACT8M1;                    /* MOVE RESULT           @ZM31121*/
         MVC   RM55(55,CVTPTR),ACT8M1                              0586
*   RFLAG=RFLAG2;                   /* MOVE MEDIA FAILURE    @ZM31121*/
         MVC   RFLAG(13,CVTPTR),RFLAG2                             0587
*   TEMP2=EBYT1415;                 /* MOVE BYTES 14,15      @ZM31121*/
         MVC   TEMP2(2,APRWKPTR),EBYT1415(ENTRYPTR)                0588
*   UNPK(TEMP5,TEMP3);              /* UNPACK HEX CYL        @ZM31121*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0589
*   TEMP710=TEMP4;                  /* SAVE BAD CYL ADDR     @ZM31121*/
         MVC   TEMP710(4,APRWKPTR),TEMP4(APRWKPTR)                 0590
*   CALL EBCDICCV;                  /* CONVERT TO PRINT      @ZM31121*/
         BAL   @14,EBCDICCV                                        0591
*   CYLA8M1=TEMP710;                /* MOVE CONVERTED CYL    @ZM31121*/
         MVC   CYLA8M1(4,CVTPTR),TEMP710(APRWKPTR)                 0592
*   VOLA8M1=ENTVOLID;               /* MOVE VOLID            @ZM31121*/
         MVC   VOLA8M1(6,CVTPTR),ENTVOLID(ENTRYPTR)                0593
*   IF APRFLAGS(2)='1'B THEN        /* IN APR SEQUENCE       @ZM31121*/
         TM    APRFLAGS(APRWKPTR),B'01000000'                      0594
         BNO   @RF00594                                            0594
*     T08COUNT=T08COUNT+1;          /* YES, ADD 1 TO 08 COUNT@ZM31121*/
         LA    @06,1                                               0595
         AH    @06,T08COUNT(,APRWKPTR)                             0595
         STH   @06,T08COUNT(,APRWKPTR)                             0595
*   ELSE                                                           0596
*     ;                             /* NO, RECORD BY ITSELF  @ZM31121*/
@RF00594 DS    0H                                                  0597
*   END BACTION8;                   /* END ACTION 8 PROC     @ZM31121*/
@EL00016 DS    0H                                                  0597
@EF00016 DS    0H                                                  0597
@ER00016 L     @14,@SA00016                                        0597
         BR    @14                                                 0597
*                                                                  0598
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVEDAYT - PROC TO BUILD DATE,TIME PART OF LINE OUTPUT        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0598
*MOVEDAYT:                                                         0598
*   PROC OPTIONS(SAVE(14));         /* PROC TO CONVERT DATE,TIME   0598
*                                                            @ZD00192*/
MOVEDAYT ST    @14,12(,@13)                                        0598
*   TEMP2331=''B;                   /* ZERO TEMP AREA        @ZD00192*/
         XC    TEMP2331(9,APRWKPTR),TEMP2331(APRWKPTR)             0599
*   TEMP2427=SAVETIME;              /* MOVE TIME             @ZD00192*/
         MVC   TEMP2427(4,APRWKPTR),SAVETIME(APRWKPTR)             0600
*   TEMP2831=SAVEDATE;              /* MOVE DATE             @ZD00192*/
         MVC   TEMP2831(4,APRWKPTR),SAVEDATE(APRWKPTR)             0601
*   EDREC01=EDPAT01;                /* MOVE EDIT PATTERN     @ZD00192*/
         MVC   EDREC01(22,APRWKPTR),EDPAT01                        0602
*   ED(EDREC01,TEMP2331);           /* EDIT DATE,TIME        @ZD00192*/
         ED    EDREC01(22,APRWKPTR),TEMP2331(APRWKPTR)             0603
*   OUTDAY=ED01DAY;                 /* MOVE DAY              @ZD00192*/
         MVC   OUTDAY(3,CVTPTR),ED01DAY(APRWKPTR)                  0604
*   OUTYEAR=ED01YEAR;               /* MOVE YEAR             @ZD00192*/
         MVC   OUTYEAR(3,CVTPTR),ED01YEAR(APRWKPTR)                0605
*   OUTTIME=ED01TIME;               /* MOVE TIME             @ZD00192*/
         MVC   OUTTIME(11,CVTPTR),ED01TIME(APRWKPTR)               0606
*   END MOVEDAYT;                   /* END DATE,TIME PROC    @ZD00192*/
*                                                                  0607
@EL00017 DS    0H                                                  0607
@EF00017 DS    0H                                                  0607
@ER00017 L     @14,12(,@13)                                        0607
         BR    @14                                                 0607
*   /*****************************************************************/
*   /*                                                               */
*   /* EBCDICCV - PROC TO CONVERT UNPACKED HEX TO PRINTABLE EBCDIC   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0608
*EBCDICCV:                                                         0608
*   PROC OPTIONS(SAVE(14));         /* PROC TO CONVERT TO EBCDIC   0608
*                                                            @ZD00192*/
EBCDICCV ST    @14,12(,@13)                                        0608
*   DO I=1 TO LENGTH(TEMP20);       /* LOOP THROUGH TEMP20   @ZD00192*/
         LA    I,1                                                 0609
@DL00609 DS    0H                                                  0610
*     IF TEMP20(I)>'9' THEN         /* NOT 0-9               @ZD00192*/
         LR    @15,APRWKPTR                                        0610
         ALR   @15,I                                               0610
         CLI   TEMP20-1(@15),C'9'                                  0610
         BNH   @RF00610                                            0610
*       TEMP20(I)=TEMP20(I)-'39'X;  /* FIX A-F               @ZD00192*/
         SLR   @00,@00                                             0611
         IC    @00,TEMP20-1(I,APRWKPTR)                            0611
         SH    @00,@CH00854                                        0611
         STC   @00,TEMP20-1(I,APRWKPTR)                            0611
*     ELSE                                                         0612
*       ;                           /* OK 0-9                @ZD00192*/
@RF00610 DS    0H                                                  0613
*   END;                            /* END LOOP              @ZD00192*/
         AL    I,@CF00083                                          0613
         CH    I,@CH00250                                          0613
         BNH   @DL00609                                            0613
*   END EBCDICCV;                   /* END EBCDIC CONVERT PROC     0614
*                                                            @ZD00192*/
@EL00018 DS    0H                                                  0614
@EF00018 DS    0H                                                  0614
@ER00018 L     @14,12(,@13)                                        0614
         BR    @14                                                 0614
*                                                                  0615
*   /*****************************************************************/
*   /*                                                               */
*   /* DEVTMOVE - PROC TO GENERATE DEVICE TYPE FROM SSID - THE 4 CHAR*/
*   /* ID IS PLACED IN TEMP4                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0615
*DEVTMOVE:                                                         0615
*   PROC OPTIONS(SAVE(14));         /* PROC TO GET DEVICE ID @ZD00192*/
DEVTMOVE ST    @14,12(,@13)                                        0615
*   IF ENTSSID(1)='1'B THEN         /* RUA FLAG SET          @ZD00192*/
         TM    ENTSSID(ENTRYPTR),B'10000000'                       0616
         BNO   @RF00616                                            0616
*     TEMP4=IDMSC;                  /* YES, MOVE MSC ID      @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),@CC00372                          0617
*   ELSE                            /* NO, MUST BE AN SSID   @ZD00192*/
*     IF ENTSSID(5)='1'B THEN       /* SA BIT ON             @ZD00192*/
         B     @RC00616                                            0618
@RF00616 TM    ENTSSID(ENTRYPTR),B'00001000'                       0618
         BNO   @RF00618                                            0618
*       TEMP4=IDSA;                 /* YES, MOVE SA ID       @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),@CC00374                          0619
*     ELSE                          /* NO, CHECK NEXT        @ZD00192*/
*       IF ENTSSID(6)='1'B THEN     /* DRC BIT ON            @ZD00192*/
         B     @RC00618                                            0620
@RF00618 TM    ENTSSID(ENTRYPTR),B'00000100'                       0620
         BNO   @RF00620                                            0620
*         TEMP4=IDDRC;              /* YES, MOVE DRC ID      @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),@CC00376                          0621
*       ELSE                        /* NO, CHECK NEXT        @ZD00192*/
*         IF ENTSSID(7)='1'B THEN   /* DRD BIT ON            @ZD00192*/
         B     @RC00620                                            0622
@RF00620 TM    ENTSSID(ENTRYPTR),B'00000010'                       0622
         BNO   @RF00622                                            0622
*           TEMP4=IDDRD;            /* YES MOVE DRD ID       @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),@CC00378                          0623
*         ELSE                      /* NO, CHECK NEXT        @ZD00192*/
*           IF ENTSSID(8)='1'B THEN /* CS BIT ON             @ZD00192*/
         B     @RC00622                                            0624
@RF00622 TM    ENTSSID(ENTRYPTR),B'00000001'                       0624
         BNO   @RF00624                                            0624
*             IF ENTSSID(2:3)='00'B THEN/* ACCESSOR ID       @ZM31121*/
         TM    ENTSSID(ENTRYPTR),B'01100000'                       0625
         BNZ   @RF00625                                            0625
*               DO;                 /* NO, GET MSF NUMBER    @ZM31022*/
*                 TEMP4=IDCS;       /* MOVE CS ID            @ZD00192*/
         MVC   TEMP4(4,APRWKPTR),@CC00380                          0627
*                 TEMP4(4)=ENTSSID(9:16);/* GET CHAR 1 AND 2 @ZM31022*/
         MVC   TEMP4+3(1,APRWKPTR),ENTSSID+1(ENTRYPTR)             0628
*                 SRL(TEMP4(4),4);  /* SHIFT OUT CHAR 2      @ZM31022*/
         SLR   @06,@06                                             0629
         IC    @06,TEMP4+3(,APRWKPTR)                              0629
         SRL   @06,4                                               0629
         STC   @06,TEMP4+3(,APRWKPTR)                              0629
*                 TEMP4(4)=TEMP4(4)×'F0'X;/* MAKE EBCDIC     @ZM31022*/
         OI    TEMP4+3(APRWKPTR),X'F0'                             0630
*               END;                /* END GET MSF NUMBER    @ZM31022*/
*             ELSE                                                 0632
*               TEMP4=IDACC;        /* YES, MOVE ACCESSOR ID @ZD00192*/
         B     @RC00625                                            0632
@RF00625 MVC   TEMP4(4,APRWKPTR),@CC00382                          0632
*           ELSE                    /* NO, ALL BITS OFF      @ZD00192*/
*             TEMP4=ID3330;         /* MOVE 3330 ID          @ZD00192*/
         B     @RC00624                                            0633
@RF00624 MVC   TEMP4(4,APRWKPTR),@CC00384                          0633
*   END DEVTMOVE;                   /* END GET DEVICE ID PROC@ZD00192*/
@EL00019 DS    0H                                                  0634
@EF00019 DS    0H                                                  0634
@ER00019 L     @14,12(,@13)                                        0634
         BR    @14                                                 0634
*                                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMENT - PROC TO SUMMERIZE THE ENTRIES IN THE ACCUMULATORS    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*SUMENT:                                                           0635
*   PROC OPTIONS(SAVE(14));         /* PROC TO SUM ACCUMULATOR     0635
*                                                            @ZD00192*/
SUMENT   ST    @14,@SA00020                                        0635
*   ENTRYPTR=ACCUMPTR;              /* GET OLD START OF ACCUMULATOR
*                                                            @ZD00192*/
         L     ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0636
*   ACCUMPTR=''B;                   /* ZERO START PTR        @ZD00192*/
*                                                                  0637
         SLR   @06,@06                                             0637
         ST    @06,ACCUMPTR(,APRWKPTR)                             0637
*   /*****************************************************************/
*   /*                                                               */
*   /* GET NEW STARTING ADDRESS IF ANY                       @ZD00192*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0638
*   DO WHILE(ENTRYPTR>0&ACCUMPTR=0);/* LOOP UNTIL START FOUND@ZD00192*/
         B     @DE00638                                            0638
@DL00638 DS    0H                                                  0639
*     IF EFLAG8='1'B THEN           /* HAVE SUMMARY INPUT    @ZD00192*/
         TM    EFLAG8(ENTRYPTR),B'00000001'                        0639
         BNO   @RF00639                                            0639
*       ACCUMPTR=ENTRYPTR;          /* YES, SET NEW STARTING ADDRESS
*                                                            @ZD00192*/
         ST    ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0640
*     ELSE                          /* NOT SUMMARY INPUT     @ZD00192*/
*       ENTRYPTR=NEXTENT;           /* UPDATE ENTRY ADDRESS  @ZD00192*/
         B     @RC00639                                            0641
@RF00639 L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0641
*   END;                            /* END OF LOOP           @ZD00192*/
@RC00639 DS    0H                                                  0642
@DE00638 SLR   @06,@06                                             0642
         CR    ENTRYPTR,@06                                        0642
         BNH   @DC00638                                            0642
         C     @06,ACCUMPTR(,APRWKPTR)                             0642
         BE    @DL00638                                            0642
@DC00638 DS    0H                                                  0643
*   IF ACCUMPTR>0 THEN              /* HAVE NEW STARTING ADRR@ZD00192*/
*                                                                  0643
         L     @06,ACCUMPTR(,APRWKPTR)                             0643
         LTR   @06,@06                                             0643
         BNP   @RF00643                                            0643
*     /***************************************************************/
*     /*                                                             */
*     /* SUMMARIZE THE ACCUMULATORS                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0644
*     DO;                           /* YES, SUMMARIZE        @ZD00192*/
*       ENTRYPTR=ACCUMPTR;          /* SET STARTING ADDRESS  @ZD00192*/
         LR    ENTRYPTR,@06                                        0645
*       CURRNEXT=NEXTENT;           /* GET NEXT ADDR         @ZD00192*/
         MVC   CURRNEXT(4,APRWKPTR),NEXTENT(ENTRYPTR)              0646
*       ACCPOINT(1)=ACCUMPTR;       /* SAVE START            @ZD00192*/
         L     @05,STARTPNT(,APRWKPTR)                             0647
         ST    @06,ACCPOINT(,@05)                                  0647
*       PINDEX=1;                   /* SET COUNT TO ONE      @ZD00192*/
         MVC   PINDEX(4),@CF00083                                  0648
*       DO WHILE(CURRNEXT>0);       /* LOOP TO LAST ENTRY ONLY     0649
*                                                            @ZD00192*/
*                                                                  0649
         B     @DE00649                                            0649
@DL00649 DS    0H                                                  0650
*         /***********************************************************/
*         /*                                                         */
*         /* CALL UPDATEAC TO UPDATE AND COMPRESS THE ACCUMULATORS   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0650
*         CALL UPDATEAC;            /* UPDATE AND COMPRESS   @ZD00192*/
         BAL   @14,UPDATEAC                                        0650
*         ENTRYPTR=NEXTENT;         /* POINT TO NEXT ENTRY   @ZD00192*/
         L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0651
*         IF ENTRYPTR>0 THEN        /* NOT AT END OF ACCUMULATOR   0652
*                                                            @ZD00192*/
         LTR   ENTRYPTR,ENTRYPTR                                   0652
         BNP   @RF00652                                            0652
*           DO;                     /* NO, BUILD ACCPOINT    @ZD00192*/
*             CURRNEXT=NEXTENT;     /* GET NEXT ADDR         @ZD00192*/
         MVC   CURRNEXT(4,APRWKPTR),NEXTENT(ENTRYPTR)              0654
*             PINDEX=PINDEX+1;      /* ADD 1 TO COUNT        @ZD00192*/
         LA    @06,1                                               0655
         AL    @06,PINDEX                                          0655
         ST    @06,PINDEX                                          0655
*             ACCPOINT(PINDEX)=ENTRYPTR;/* ADD ADDRESS TO ACCPOINT 0656
*                                                            @ZD00192*/
         SLA   @06,2                                               0656
         L     @05,STARTPNT(,APRWKPTR)                             0656
         AL    @05,@CF00875                                        0656
         ST    ENTRYPTR,ACCPOINT(@06,@05)                          0656
*           END;                    /* END BUILD ACCPOINT    @ZD00192*/
*         ELSE                      /* AT END OF ACCUMULATORS@ZD00192*/
*           CURRNEXT=0;             /* GET OUT OF LOOP       @ZD00192*/
         B     @RC00652                                            0658
@RF00652 SLR   @06,@06                                             0658
         ST    @06,CURRNEXT(,APRWKPTR)                             0658
*       END;                        /* END LOOP THROUGH ACCUMULATORS
*                                                            @ZD00192*/
@RC00652 DS    0H                                                  0659
@DE00649 ICM   @06,15,CURRNEXT(APRWKPTR)                           0659
         BP    @DL00649                                            0659
*       TOTALENT=PINDEX;            /* SET NEW TOTAL ENTRIES @ZD00192*/
         MVC   TOTALENT(4,APRWKPTR),PINDEX                         0660
*       ACCUMPTR=ACCPOINT(1);       /* RESTORE STARTING ADDR @ZD00192*/
         L     @06,STARTPNT(,APRWKPTR)                             0661
         MVC   ACCUMPTR(4,APRWKPTR),ACCPOINT(@06)                  0661
*/*     CALL TRACEENT                  DUMP ACCPOINT, ENTRIES@ZD00192*/
*                                                                  0662
*     END;                          /* END SUMMARY PROCESS   @ZD00192*/
*   ELSE                            /* NO SUMMARY INPUT      @ZD00192*/
*     TOTALENT=0;                   /* ZERO ENTRY COUNT      @ZD00192*/
         B     @RC00643                                            0663
@RF00643 SLR   @06,@06                                             0663
         ST    @06,TOTALENT(,APRWKPTR)                             0663
*   END SUMENT;                     /* END OF SUMMARIZE PROC @ZD00192*/
@EL00020 DS    0H                                                  0664
@EF00020 DS    0H                                                  0664
@ER00020 L     @14,@SA00020                                        0664
         BR    @14                                                 0664
*                                                                  0665
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATEAC - PROC TO INCREMENT THE COUNTS IN THE ACCUMULATORS   */
*   /* AND COMPRESS THE ACCUMULATORS                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0665
*UPDATEAC:                                                         0665
*   PROC OPTIONS(SAVE(14));         /* PROC TO UPDATE ACCUM  @ZD00192*/
UPDATEAC ST    @14,12(,@13)                                        0665
*   RETCODE=0;                      /* SET LOCAL FLAG TO ZERO@ZD00192*/
         SLR   RETCODE,RETCODE                                     0666
*   ACCUMPTR=ENTRYPTR;              /* SAVE CURRENT POINTER  @ZD00192*/
         ST    ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0667
*   SENSEPTR=ADDR(ENTVAR);          /* SET SENSE DATA ADDRESS@ZD00192*/
         LA    SENSEPTR,ENTVAR(,ENTRYPTR)                          0668
*   TYPECODE=ETYPCODE;              /* SAVE TYPE CODE        @ZD00192*/
         MVC   TYPECODE(1,APRWKPTR),ETYPCODE(ENTRYPTR)             0669
*   SORTCNT=ENTCOUNT;               /* SAVE ENTRY COUNT      @ZD00192*/
         LH    @06,ENTCOUNT(,ENTRYPTR)                             0670
         ST    @06,SORTCNT(,APRWKPTR)                              0670
*   SAVESSID=ENTSSID;               /* SAVE SSID             @ZD00192*/
         MVC   SAVESSID(2,APRWKPTR),ENTSSID(ENTRYPTR)              0671
*   SAVEDAYT=ENTDAYT;               /* SAVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0672
*   STARTAPR=ENTRYPTR;              /* SET LAST ADDRESS      @ZD00192*/
         ST    ENTRYPTR,STARTAPR(,APRWKPTR)                        0673
*   ENTRYPTR=NEXTENT;               /* START WITH NEXT ENTRY @ZD00192*/
         L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0674
*   DO WHILE(ENTRYPTR>0);           /* LOOP THROUGH REST OF ENTRIES
*                                                            @ZD00192*/
         B     @DE00675                                            0675
@DL00675 DS    0H                                                  0676
*     IF EFLAG8='1'B THEN           /* HAVE SUMMARY INPUT    @ZD00192*/
         TM    EFLAG8(ENTRYPTR),B'00000001'                        0676
         BNO   @RF00676                                            0676
*       DO;                         /* YES, CHECK ENTRY      @ZD00192*/
*         IF TYPECODE=TF7 THEN      /* LOOKING FOR MEDIA FAILURE   0678
*                                                            @ZD00192*/
         CLI   TYPECODE(APRWKPTR),X'F7'                            0678
         BNE   @RF00678                                            0678
*           IF ETYPCODE=TF7 THEN    /* YES, IS THIS ENTRY MEDIA    0679
*                                                            @ZD00192*/
*                                                                  0679
         CLI   ETYPCODE(ENTRYPTR),X'F7'                            0679
         BNE   @RF00679                                            0679
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE MEDIA FAILURE RECORDS                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0680
*             IF ENTVOLID=VOLID0&EBYTE10=TBLID0&ENTCSN=CSN0 THEN /*
*                                      MATCH VOLID AND SEQ NO.     0680
*                                      AND CSN               @ZA00668*/
         CLC   ENTVOLID(6,ENTRYPTR),VOLID0(SENSEPTR)               0680
         BNE   @RF00680                                            0680
         CLC   EBYTE10(1,ENTRYPTR),TBLID0(SENSEPTR)                0680
         BNE   @RF00680                                            0680
         CLC   ENTCSN(12,ENTRYPTR),CSN0(SENSEPTR)                  0680
         BNE   @RF00680                                            0680
*               RETCODE=2;          /* YES, FOUND MATCH      @ZA00668*/
         LA    RETCODE,2                                           0681
*             ELSE;                 /* NO, NEW ENTRY         @ZA00668*/
@RF00680 DS    0H                                                  0683
*           ELSE                                                   0683
*             ;                     /* THIS ENTRY NOT MEDIA  @ZD00192*/
@RF00679 DS    0H                                                  0684
*         ELSE                      /* NOT CODE F7 = MEDIA FAILURE 0684
*                                                            @ZD00192*/
*           IF ETYPCODE^=TF7 THEN   /* THIS ENTRY NOT MDEIA  @ZD00192*/
*                                                                  0684
         B     @RC00678                                            0684
@RF00678 CLI   ETYPCODE(ENTRYPTR),X'F7'                            0684
         BE    @RF00684                                            0684
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE UNIT UNUSABLE RECORDS                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0685
*             IF SAVESSID=ENTSSID THEN/* HAVE A SSID MATCH   @ZD00192*/
         CLC   SAVESSID(2,APRWKPTR),ENTSSID(ENTRYPTR)              0685
         BNE   @RF00685                                            0685
*               RETCODE=2;          /* YES, SET FOUND FLAG   @ZD00192*/
         LA    RETCODE,2                                           0686
*             ELSE                                                 0687
*               ;                   /* NO MATCH SSID YET     @ZD00192*/
@RF00685 DS    0H                                                  0688
*           ELSE                                                   0688
*             ;                     /* NO CHECK, THIS ENTRY IS MEDIA
*                                                            @ZD00192*/
@RF00684 DS    0H                                                  0689
*         IF RETCODE=2 THEN         /* FOUND A MATCH YET     @ZD00192*/
*                                                                  0689
@RC00678 CH    RETCODE,@CH00102                                    0689
         BNE   @RF00689                                            0689
*           /*********************************************************/
*           /*                                                       */
*           /* UPDATE THE ACCUMULATOR                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0690
*           DO;                     /* YES, UPDATE THE ENTRY @ZD00192*/
*             SORTCNT=SORTCNT+1;    /* ADD 1 TO ENTRY COUNT  @ZD00192*/
         LA    @06,1                                               0691
         AL    @06,SORTCNT(,APRWKPTR)                              0691
         ST    @06,SORTCNT(,APRWKPTR)                              0691
*             IF SAVEDAYT<ENTDAYT THEN/* IS ENTRY DATE,TIME LESS   0692
*                                                            @ZD00192*/
         CLC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0692
         BNL   @RF00692                                            0692
*               SAVEDAYT=ENTDAYT;   /* YES, SAVE NEW DATE,TIME     0693
*                                                            @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0693
*             ELSE                                                 0694
*               ;                   /* NO, DATE,TIME OK      @ZD00192*/
@RF00692 DS    0H                                                  0695
*           END;                    /* END UPDATE ACCUMULATOR CODE 0695
*                                                            @ZD00192*/
*         ELSE                                                     0696
*           ;                       /* NO, MATCH NOT FOUND YET     0696
*                                                            @ZD00192*/
@RF00689 DS    0H                                                  0697
*       END;                        /* END CHECK SUMMARY ENTRY     0697
*                                                            @ZD00192*/
*     ELSE                          /* NOT SUMMARY INPUT     @ZD00192*/
*       RETCODE=2;                  /* SET LOCAL FLAG        @ZD00192*/
         B     @RC00676                                            0698
@RF00676 LA    RETCODE,2                                           0698
*     IF RETCODE=2 THEN             /* FLAG SET TO REMOVE RECORD   0699
*                                                            @ZD00192*/
*                                                                  0699
@RC00676 CH    RETCODE,@CH00102                                    0699
         BNE   @RF00699                                            0699
*       /*************************************************************/
*       /*                                                           */
*       /* REMOVE RECORD FROM ACCUMULATOR CHAIN                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0700
*       DO;                         /* YES, REMOVE THIS RECORD     0700
*                                                            @ZD00192*/
*         RETCODE=0;                /* RESET FLAG            @ZD00192*/
         SLR   RETCODE,RETCODE                                     0701
*         CURRPTR=NEXTENT;          /* GET ADDR OF NEXT      @ZD00192*/
         L     @06,NEXTENT(,ENTRYPTR)                              0702
         ST    @06,CURRPTR(,APRWKPTR)                              0702
*         ENTRYPTR=STARTAPR;        /* GET ADDR OF LAST      @ZD00192*/
         L     ENTRYPTR,STARTAPR(,APRWKPTR)                        0703
*         NEXTENT=CURRPTR;          /* CHAIN LAST TO NEXT    @ZD00192*/
         ST    @06,NEXTENT(,ENTRYPTR)                              0704
*       END;                        /* END REMOVE IT CODE    @ZD00192*/
*     ELSE                          /* NO, DO NOT REMOVE ENTRY     0706
*                                                            @ZD00192*/
*       STARTAPR=ENTRYPTR;          /* UPDATE LAST WITH CURRENT    0706
*                                                            @ZD00192*/
         B     @RC00699                                            0706
@RF00699 ST    ENTRYPTR,STARTAPR(,APRWKPTR)                        0706
*     ENTRYPTR=NEXTENT;             /* GET NEXT ENTRY        @ZD00192*/
@RC00699 L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0707
*   END;                            /* END LOOP THROUGH ACCUMULATORS
*                                                            @ZD00192*/
*                                                                  0708
@DE00675 LTR   ENTRYPTR,ENTRYPTR                                   0708
         BP    @DL00675                                            0708
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE CURRENT ENTRY POINTER AND UPDATE COUNT AND DATE,TIME  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*   ENTRYPTR=ACCUMPTR;              /* RESTORE CURRENT ENTRY @ZD00192*/
         L     ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0709
*   IF SORTCNT>ENTCOUNT THEN        /* FOUND ANY LIKE ENTRIES@ZD00192*/
         L     @06,SORTCNT(,APRWKPTR)                              0710
         CH    @06,ENTCOUNT(,ENTRYPTR)                             0710
         BNH   @RF00710                                            0710
*     DO;                           /* YES, UPDATE CURRENT ENTRY   0711
*                                                            @ZD00192*/
*       ENTCOUNT=SORTCNT;           /* UPDATE COUNT FIELD    @ZD00192*/
         STH   @06,ENTCOUNT(,ENTRYPTR)                             0712
*       ENTDAYT=SAVEDAYT;           /* UPDATE DATE,TIME      @ZD00192*/
         MVC   ENTDAYT(8,ENTRYPTR),SAVEDAYT(APRWKPTR)              0713
*     END;                          /* END UPDATE DATE,TIME AND COUNT
*                                                            @ZD00192*/
*   ELSE                                                           0715
*     ;                             /* NO UPDATES TO DO      @ZD00192*/
@RF00710 DS    0H                                                  0716
*   END UPDATEAC;                   /* END UPDATE ACCUM PROC @ZD00192*/
@EL00021 DS    0H                                                  0716
@EF00021 DS    0H                                                  0716
@ER00021 L     @14,12(,@13)                                        0716
         BR    @14                                                 0716
*                                                                  0717
*   /*****************************************************************/
*   /*                                                               */
*   /* DOSUMRPT - PROC TO PRINT SUU AND MEDIA FAIL SUMMARY REPORT    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*DOSUMRPT:                                                         0717
*   PROC OPTIONS(SAVE(14));         /* PRINT SUMMARY PROC    @ZD00192*/
DOSUMRPT ST    @14,@SA00022                                        0717
*   ANSI=PSKIP;                     /* SET PAGE SKIP         @ZD00192*/
         MVI   ANSI(CVTPTR),C'1'                                   0718
*   LINE=SUUTITLE;                  /* MOVE REPORT TITLE     @ZD00192*/
         MVI   LINE+50(CVTPTR),C' '                                0719
         MVC   LINE+51(81,CVTPTR),LINE+50(CVTPTR)                  0719
         MVC   LINE(50,CVTPTR),SUUTITLE                            0719
*   SDARPTID=SUUID;                 /* MOVE REPORT ID        @ZD00192*/
         MVC   SDARPTID(3,CVTPTR),@CC00351                         0720
*   RFY                                                            0721
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0722
*   CALL ISDAPRT0;                  /* PRINT TITLE           @ZD00192*/
*                                                                  0723
         L     @15,@CV00389                                        0723
         BALR  @14,@15                                             0723
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT SUMMARY OF UNITS MARKED UNUSABLE                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*   ANSI=LSKIP3;                    /* SET 3 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C'-'                                   0724
*   LINE=SUMMSG01;                  /* MOVE LINE 1           @ZD00192*/
         MVI   LINE+27(CVTPTR),C' '                                0725
         MVC   LINE+28(104,CVTPTR),LINE+27(CVTPTR)                 0725
         MVC   LINE(27,CVTPTR),SUMMSG01                            0725
*   CALL ISDAPRT0;                  /* PRINT LINE 1          @ZD00192*/
         L     @15,@CV00389                                        0726
         BALR  @14,@15                                             0726
*   ANSI=LSKIP2;                    /* SET 2 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C'0'                                   0727
*   LINE='';                        /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0728
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0728
*   SUMLAST=SUMMSG03;               /* MOVE LAST             @ZD00192*/
         MVC   SUMLAST(4,CVTPTR),SUMMSG03                          0729
*   SUMSUU=SUMMSG02;                /* MOVE SUU              @ZD00192*/
         MVC   SUMSUU(3,CVTPTR),SUMMSG02                           0730
*   CALL ISDAPRT0;                  /* PRINT LINE 2          @ZD00192*/
         L     @15,@CV00389                                        0731
         BALR  @14,@15                                             0731
*   ANSI=LSKIP1;                    /* SET 1 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C' '                                   0732
*   LINE=SUMMSG04;                  /* MOVE LINE 3           @ZD00192*/
         MVI   LINE+51(CVTPTR),C' '                                0733
         MVC   LINE+52(80,CVTPTR),LINE+51(CVTPTR)                  0733
         MVC   LINE(51,CVTPTR),SUMMSG04                            0733
*   CALL ISDAPRT0;                  /* PRINT LINE 3          @ZD00192*/
         L     @15,@CV00389                                        0734
         BALR  @14,@15                                             0734
*   LINE(1)=DASH;                   /* MOVE DASH             @ZD00192*/
         MVI   LINE(CVTPTR),C'-'                                   0735
*   MVC(LINE(2:52),LINE(1:51));     /* FILL WITH DASH        @ZD00192*/
         MVC   LINE+1(51,CVTPTR),LINE(CVTPTR)                      0736
*   SBAR1=BAR;                      /* MOVE BAR 1            @ZD00192*/
         MVI   SBAR1(CVTPTR),C'×'                                  0737
*   SBAR2=BAR;                      /* MOVE BAR 2            @ZD00192*/
         MVI   SBAR2(CVTPTR),C'×'                                  0738
*   SBAR3=BAR;                      /* MOVE BAR 3            @ZD00192*/
         MVI   SBAR3(CVTPTR),C'×'                                  0739
*   SBAR4=BAR;                      /* MOVE BAR 4            @ZD00192*/
         MVI   SBAR4(CVTPTR),C'×'                                  0740
*   CALL ISDAPRT0;                  /* PRINT LINE 4          @ZD00192*/
         L     @15,@CV00389                                        0741
         BALR  @14,@15                                             0741
*   RFY                                                            0742
*     R1 UNRSTD;                    /* RELEASE R1            @ZD00192*/
*   APRTEMPS=''B;                   /* ZERO TEMP AREA        @ZD00192*/
         XC    APRTEMPS(32,APRWKPTR),APRTEMPS(APRWKPTR)            0743
*   SORTCNT=0;                      /* ZERO LINE COUNT       @ZD00192*/
         SLR   @06,@06                                             0744
         ST    @06,SORTCNT(,APRWKPTR)                              0744
*                                                                  0745
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH ACCUMULATORS LOOKING FOR UNIT UNUSABLE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*   DO PINDEX=1 TO TOTALENT;        /* LOOP THROUGH ENTRIES  @ZD00192*/
         LA    @06,1                                               0745
         B     @DE00745                                            0745
@DL00745 DS    0H                                                  0746
*     ENTRYPTR=ACCPOINT(PINDEX);    /* GET ENTRY ADDRESS     @ZD00192*/
         SLA   @06,2                                               0746
         L     @01,STARTPNT(,APRWKPTR)                             0746
         AL    @01,@CF00875                                        0746
         L     ENTRYPTR,ACCPOINT(@06,@01)                          0746
*     IF ETYPCODE^=TF7 THEN         /* NOT MEDIA FAILURE     @ZD00192*/
         CLI   ETYPCODE(ENTRYPTR),X'F7'                            0747
         BE    @RF00747                                            0747
*       DO;                         /* YES, MUST BE SUU      @ZD00192*/
*         SORTCNT=SORTCNT+1;        /* ADD 1 TO LINE COUNT   @ZD00192*/
         LA    @06,1                                               0749
         AL    @06,SORTCNT(,APRWKPTR)                              0749
         ST    @06,SORTCNT(,APRWKPTR)                              0749
*         LINE='';                  /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0750
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0750
*         SAVEDAYT=ENTDAYT;         /* MOVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0751
*         CALL MOVEDAYT;            /* BUILD DATE,TIME       @ZD00192*/
         BAL   @14,MOVEDAYT                                        0752
*         CALL DEVTMOVE;            /* BUILD DEVICE ID       @ZD00192*/
         BAL   @14,DEVTMOVE                                        0753
*         IF ENTSSID(2:3)='00'B THEN/* ACCESSOR ID           @ZM31121*/
         TM    ENTSSID(ENTRYPTR),B'01100000'                       0754
         BNZ   @RF00754                                            0754
*           SUMDEVT=TEMP4;          /* NO, NOVE DEVICE ID    @ZM31121*/
         MVC   SUMDEVT(4,CVTPTR),TEMP4(APRWKPTR)                   0755
*         ELSE                      /* YES, HAVE BAD ACCESSOR@ZM31121*/
*           IF ENTSSID(2:3)='10'B THEN /* LEFT ACCESSOR ID   @ZM31121*/
         B     @RC00754                                            0756
@RF00754 TM    ENTSSID(ENTRYPTR),B'01000000'                       0756
         BNO   @RF00756                                            0756
         TM    ENTSSID(ENTRYPTR),B'00100000'                       0756
         BNZ   @RF00756                                            0756
*             SUMACCLR=SUMLACC;     /* YES, MOVE L-ACC       @ZM31121*/
         MVC   SUMACCLR(5,CVTPTR),SUMLACC                          0757
*           ELSE                                                   0758
*             IF ENTSSID(2:3)='01'B THEN /* RIGHT ACCESSOR   @ZM31121*/
         B     @RC00756                                            0758
@RF00756 TM    ENTSSID(ENTRYPTR),B'00100000'                       0758
         BNO   @RF00758                                            0758
         TM    ENTSSID(ENTRYPTR),B'01000000'                       0758
         BNZ   @RF00758                                            0758
*               SUMACCLR=SUMRACC;   /* MOVE R-ACC            @ZM31121*/
         MVC   SUMACCLR(5,CVTPTR),SUMRACC                          0759
*             ELSE                  /* DO NOT KNOW WHICH     @ZM31121*/
*               SUMACCLR=SUMBACC;   /* DO NOT SAY WHICH      @ZM31121*/
         B     @RC00758                                            0760
@RF00758 MVC   SUMACCLR(5,CVTPTR),SUMBACC                          0760
*         TEMP2=ENTSSID;            /* MOVE SSID             @ZD00192*/
@RC00758 DS    0H                                                  0761
@RC00756 DS    0H                                                  0761
@RC00754 MVC   TEMP2(2,APRWKPTR),ENTSSID(ENTRYPTR)                 0761
*         UNPK(TEMP5,TEMP3);        /* UNPACK                @ZD00192*/
         UNPK  TEMP5(5,APRWKPTR),TEMP3(3,APRWKPTR)                 0762
*         TEMP1113=TEMP5(2:4);      /* SAVE SSID             @ZD00192*/
         MVC   TEMP1113(3,APRWKPTR),TEMP5+1(APRWKPTR)              0763
*         CALL EBCDICCV;            /* CONVERT TO EBCDIC     @ZD00192*/
         BAL   @14,EBCDICCV                                        0764
*         IF ENTSSID(1)='1'B THEN   /* RUA FLAG ON           @ZD00192*/
         TM    ENTSSID(ENTRYPTR),B'10000000'                       0765
         BNO   @RF00765                                            0765
*           SUMRUA=TEMP1113;        /* YES, MOVE RUA         @ZD00192*/
         MVC   SUMRUA(3,CVTPTR),TEMP1113(APRWKPTR)                 0766
*         ELSE                                                     0767
*           SUMSSID=TEMP1113;       /* NO, MOVE SSID         @ZD00192*/
         B     @RC00765                                            0767
@RF00765 MVC   SUMSSID(3,CVTPTR),TEMP1113(APRWKPTR)                0767
*         J=ENTCOUNT;               /* GET COUNT             @ZD00192*/
@RC00765 LH    J,ENTCOUNT(,ENTRYPTR)                               0768
*         CVD(J,TEMP8);             /* CONVERT TO DECIMAL    @ZD00192*/
         CVD   J,TEMP8(,APRWKPTR)                                  0769
*         SUMCNT1=EDPAT02;          /* MOVE EDIT PATTERN     @ZD00192*/
         MVC   SUMCNT1(6,CVTPTR),EDPAT02                           0770
*         ED(SUMCNT1,TEMP68);       /* EDIT 5 DIGITS         @ZD00192*/
         ED    SUMCNT1(6,CVTPTR),TEMP68(APRWKPTR)                  0771
*         RFY                                                      0772
*           R1 RSTD;                /*                       @ZD00192*/
*         R1=ADDR(WORKCALL);        /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0773
*         CALL ISDAPRT0;            /* PRINT ENTRY LINE      @ZD00192*/
         L     @15,@CV00389                                        0774
         BALR  @14,@15                                             0774
*         RFY                                                      0775
*           R1 UNRSTD;              /*                       @ZD00192*/
*       END;                        /* END SUU EDIT AND PRINT@ZD00192*/
*     ELSE;                         /* DO NOT PRINT MEDIA RECORD   0777
*                                                            @ZD00192*/
@RF00747 DS    0H                                                  0778
*   END;                            /* END SUU LOOP          @ZD00192*/
         LA    @06,1                                               0778
         AL    @06,PINDEX                                          0778
@DE00745 ST    @06,PINDEX                                          0778
         C     @06,TOTALENT(,APRWKPTR)                             0778
         BNH   @DL00745                                            0778
*   IF SORTCNT=0 THEN               /* ANYTHING PRINTED      @ZD00192*/
         ICM   @06,15,SORTCNT(APRWKPTR)                            0779
         BNZ   @RF00779                                            0779
*     DO;                           /* PRINT NONE            @ZD00192*/
*       LINE=ACT2M2;                /* MOVE NONE             @ZD00192*/
         MVI   LINE+16(CVTPTR),C' '                                0781
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0781
         MVC   LINE(16,CVTPTR),ACT2M2                              0781
*       RFY                                                        0782
*         R1 RSTD;                  /*                       @ZD00192*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0783
*       CALL ISDAPRT0;              /* PRINT NONE            @ZD00192*/
         L     @15,@CV00389                                        0784
         BALR  @14,@15                                             0784
*       RFY                                                        0785
*         R1 UNRSTD;                /*                       @ZD00192*/
*     END;                          /* END PRINT NONE        @ZD00192*/
*   ELSE;                           /* REPORT PRINTED        @ZD00192*/
@RF00779 DS    0H                                                  0788
*                                                                  0788
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT SUMMARY OF MEDIA FAILURES                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0788
*   ANSI=LSKIP3;                    /* SET 3 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C'-'                                   0788
*   LINE=SUMMSG05;                  /* MOVE LINE 1           @ZD00192*/
         MVI   LINE+25(CVTPTR),C' '                                0789
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0789
         MVC   LINE(25,CVTPTR),SUMMSG05                            0789
*   RFY                                                            0790
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0791
*   CALL ISDAPRT0;                  /* PRINT LINE 1          @ZD00192*/
         L     @15,@CV00389                                        0792
         BALR  @14,@15                                             0792
*   ANSI=LSKIP2;                    /* SET 2 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C'0'                                   0793
*   LINE='';                        /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0794
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0794
*   SUMLAST=SUMMSG03;               /* MOVE LAST             @ZD00192*/
         MVC   SUMLAST(4,CVTPTR),SUMMSG03                          0795
*   SUMCART=SUMMSG06;               /* MOVE CARTRIDGE        @ZD00192*/
         MVC   SUMCART(9,CVTPTR),SUMMSG06                          0796
*   CALL ISDAPRT0;                  /* PRINT LINE 2          @ZD00192*/
         L     @15,@CV00389                                        0797
         BALR  @14,@15                                             0797
*   ANSI=LSKIP1;                    /* SET 1 LINE SKIP       @ZD00192*/
         MVI   ANSI(CVTPTR),C' '                                   0798
*   LINE=SUMMSG07;                  /* MOVE LINE 3           @ZD00192*/
         MVI   LINE+51(CVTPTR),C' '                                0799
         MVC   LINE+52(80,CVTPTR),LINE+51(CVTPTR)                  0799
         MVC   LINE(51,CVTPTR),SUMMSG07                            0799
*   CALL ISDAPRT0;                  /* PRINT LINE 3          @ZD00192*/
         L     @15,@CV00389                                        0800
         BALR  @14,@15                                             0800
*   LINE(1)=DASH;                   /* MOVE DASH             @ZD00192*/
         MVI   LINE(CVTPTR),C'-'                                   0801
*   MVC(LINE(2:52),LINE(1:51));     /* FILL WITH DASH        @ZD00192*/
         MVC   LINE+1(51,CVTPTR),LINE(CVTPTR)                      0802
*   SBAR1=BAR;                      /* MOVE BAR 1            @ZD00192*/
         MVI   SBAR1(CVTPTR),C'×'                                  0803
*   SBAR4=BAR;                      /* MOVE BAR 4            @ZD00192*/
         MVI   SBAR4(CVTPTR),C'×'                                  0804
*   CALL ISDAPRT0;                  /* PRINT LINE 4          @ZD00192*/
         L     @15,@CV00389                                        0805
         BALR  @14,@15                                             0805
*   RFY                                                            0806
*     R1 UNRSTD;                    /* RELEASE R1            @ZD00192*/
*   SORTCNT=0;                      /* SET LINE COUNT TO 0   @ZD00192*/
*                                                                  0807
         SLR   @06,@06                                             0807
         ST    @06,SORTCNT(,APRWKPTR)                              0807
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH ACCUMULATORS LOOKING FOR MEDIA FAILURE RECORDS   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0808
*   DO PINDEX=1 TO TOTALENT;        /* LOOP THROUGH ENTRIES  @ZD00192*/
         LA    @06,1                                               0808
         B     @DE00808                                            0808
@DL00808 DS    0H                                                  0809
*     ENTRYPTR=ACCPOINT(PINDEX);    /* GET ENTRY ACCRESS     @ZD00192*/
         SLA   @06,2                                               0809
         L     @01,STARTPNT(,APRWKPTR)                             0809
         AL    @01,@CF00875                                        0809
         L     ENTRYPTR,ACCPOINT(@06,@01)                          0809
*     IF ETYPCODE=TF7 THEN          /* MEDIA FAILURE RECORD  @ZD00192*/
         CLI   ETYPCODE(ENTRYPTR),X'F7'                            0810
         BNE   @RF00810                                            0810
*       DO;                         /* YES, PRINT IT         @ZD00192*/
*         SORTCNT=SORTCNT+1;        /* ADD 1 TO LINE COUNT   @ZD00192*/
         LA    @06,1                                               0812
         AL    @06,SORTCNT(,APRWKPTR)                              0812
         ST    @06,SORTCNT(,APRWKPTR)                              0812
*         LINE='';                  /* BLANK LINE            @ZD00192*/
         MVI   LINE(CVTPTR),C' '                                   0813
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0813
*         SAVEDAYT=ENTDAYT;         /* MOVE DATE,TIME        @ZD00192*/
         MVC   SAVEDAYT(8,APRWKPTR),ENTDAYT(ENTRYPTR)              0814
*         CALL MOVEDAYT;            /* GET DATE,TIME         @ZD00192*/
         BAL   @14,MOVEDAYT                                        0815
*         IF ENTCSN(1)>=HEXA THEN   /* HAVE CSN              @ZD00192*/
         CLI   ENTCSN(ENTRYPTR),X'C1'                              0816
         BL    @RF00816                                            0816
*           SUMCSN=ENTCSN;          /* YES, MOVE CSN         @ZD00192*/
         MVC   SUMCSN(12,CVTPTR),ENTCSN(ENTRYPTR)                  0817
*         ELSE                                                     0818
*           ;                       /* CSN NOT AVAILABLE     @ZD00192*/
@RF00816 DS    0H                                                  0819
*         IF ENTVOLID(1)>=HEXA THEN /* HAVE VOLID            @ZD00192*/
         CLI   ENTVOLID(ENTRYPTR),X'C1'                            0819
         BL    @RF00819                                            0819
*           DO;                     /* YES, PRINT IT         @ZA00668*/
*             SUMVOLID=ENTVOLID;    /* YES, MOVE VOLID       @ZA00668*/
         MVC   SUMVOLID(6,CVTPTR),ENTVOLID(ENTRYPTR)               0821
*             IF EBYTE10^='00'X THEN /* HAVE SEQ NUMBER      @ZA00668*/
         CLI   EBYTE10(ENTRYPTR),X'00'                             0822
         BE    @RF00822                                            0822
*               DO;                 /* YES, PRINT IT         @ZA00668*/
*                 SUMSEQD=DASH;     /* MOVE DASH             @ZA00668*/
         MVI   SUMSEQD(CVTPTR),C'-'                                0824
*                 SUMSEQN=EBYTE10×'F0'X; /* MOVE EBCDIC SEQ  @ZA00668*/
         MVC   SUMSEQN(1,CVTPTR),EBYTE10(ENTRYPTR)                 0825
         OI    SUMSEQN(CVTPTR),X'F0'                               0825
*               END;                /* END MOVE SEQUENCE NO  @ZA00668*/
*             ELSE;                 /* SEQ NO NOT AVAILABLE  @ZA00668*/
@RF00822 DS    0H                                                  0828
*           END;                    /* END MOVE VOLID+SEQ    @ZA00668*/
*         ELSE                                                     0829
*           ;                       /* VOLID NOT AVAILABLE   @ZD00192*/
@RF00819 DS    0H                                                  0830
*         J=ENTCOUNT;               /* GET COUNT             @ZD00192*/
         LH    J,ENTCOUNT(,ENTRYPTR)                               0830
*         CVD(J,TEMP8);             /* CONVERT TO DECIMAL    @ZD00192*/
         CVD   J,TEMP8(,APRWKPTR)                                  0831
*         SUMCNT1=EDPAT02;          /* MOVE EDIT PATTERN     @ZD00192*/
         MVC   SUMCNT1(6,CVTPTR),EDPAT02                           0832
*         ED(SUMCNT1,TEMP68);       /* EDIT 5 DIGITS         @ZD00192*/
         ED    SUMCNT1(6,CVTPTR),TEMP68(APRWKPTR)                  0833
*         RFY                                                      0834
*           R1 RSTD;                /*                       @ZD00192*/
*         R1=ADDR(WORKCALL);        /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0835
*         CALL ISDAPRT0;            /* PRINT ENTRY LINE      @ZD00192*/
         L     @15,@CV00389                                        0836
         BALR  @14,@15                                             0836
*         RFY                                                      0837
*           R1 UNRSTD;              /*                       @ZD00192*/
*       END;                        /* END PRINT MEDIA       @ZD00192*/
*     ELSE                                                         0839
*       ;                           /* NOT MEDIA RECORD      @ZD00192*/
@RF00810 DS    0H                                                  0840
*   END;                            /* END MEDIA LOOP        @ZD00192*/
         LA    @06,1                                               0840
         AL    @06,PINDEX                                          0840
@DE00808 ST    @06,PINDEX                                          0840
         C     @06,TOTALENT(,APRWKPTR)                             0840
         BNH   @DL00808                                            0840
*   IF SORTCNT=0 THEN               /* ANYTHING PRINTED      @ZD00192*/
         ICM   @06,15,SORTCNT(APRWKPTR)                            0841
         BNZ   @RF00841                                            0841
*     DO;                           /* NO, PRINT NONE        @ZD00192*/
*       LINE=ACT2M2;                /* MOVE NONE             @ZD00192*/
         MVI   LINE+16(CVTPTR),C' '                                0843
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0843
         MVC   LINE(16,CVTPTR),ACT2M2                              0843
*       RFY                                                        0844
*         R1 RSTD;                  /*                       @ZD00192*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0845
*       CALL ISDAPRT0;              /* PRINT NONE            @ZD00192*/
         L     @15,@CV00389                                        0846
         BALR  @14,@15                                             0846
*       RFY                                                        0847
*         R1 UNRSTD;                /*                       @ZD00192*/
*     END;                          /* END PRINT NONE        @ZD00192*/
*   ELSE                                                           0849
*     ;                             /* SOMETHING WAS PRINTED @ZD00192*/
@RF00841 DS    0H                                                  0850
*   END DOSUMRPT;                   /* END PRINT SUMMARY PROC@ZD00192*/
@EL00022 DS    0H                                                  0850
@EF00022 DS    0H                                                  0850
@ER00022 L     @14,@SA00022                                        0850
         BR    @14                                                 0850
*                                                                  0851
*   /*****************************************************************/
*   /*                                                               */
*   /* FREECORE - PROC TO FREE ALL ACCUMULATORS AND WORK AREA        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0851
*FREECORE:                                                         0851
*   PROC OPTIONS(SAVE(14));         /* PROC TO FREE CORE     @ZD00192*/
FREECORE ST    @14,@SA00023                                        0851
*/* CALL TRACEWRK                      DUMP WORK AREA IF REQ @ZD00192*/
*                                                                  0852
*   GET0PTR=ACCM0PTR;               /* SET PTR TO FIRST ACCUMULATOR
*                                                            @ZD00192*/
*                                                                  0852
         L     GET0PTR,ACCM0PTR(,APRWKPTR)                         0852
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE EACH ACCUMULATOR                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0853
*   DO WHILE(GET0PTR^=0);           /* LOOP THROUGH ACCUMULATORS   0853
*                                                            @ZD00192*/
         B     @DE00853                                            0853
@DL00853 DS    0H                                                  0854
*/*   CALL TRACEHD                     DUMP HEADER IF REQ    @ZD00192*/
*                                                                  0854
*     ENTRYPTR=NEXTPTR;             /* SAVE NEXT ADDRESS     @ZD00192*/
         L     ENTRYPTR,NEXTPTR(,GET0PTR)                          0854
*     SPNOLEN=GET0SPLN;             /* MOVE SPNO AND LENGTH  @ZD00192*/
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(GET0PTR)                 0855
*     COREADDR=GET0PTR;             /* MOVE ADDRESS          @ZD00192*/
         ST    GET0PTR,COREADDR(,CVTPTR)                           0856
*     RFY                                                          0857
*       R1 RSTD;                    /*                       @ZD00192*/
*     R1=ADDR(WORKCALL);            /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0858
*     CALL ISDAFREE;                /* FREE CORE             @ZD00192*/
         L     @15,@CV00392                                        0859
         BALR  @14,@15                                             0859
*     RFY                                                          0860
*       R1 UNRSTD;                  /*                       @ZD00192*/
*     GET0PTR=ENTRYPTR;             /* SET NEXT ADDRESS      @ZD00192*/
         LR    GET0PTR,ENTRYPTR                                    0861
*   END;                            /* END OF FREE ACCUM LOOP@ZD00192*/
@DE00853 SLR   @06,@06                                             0862
         CR    GET0PTR,@06                                         0862
         BNE   @DL00853                                            0862
*   IF STARTPNT^=0 THEN             /* HAVE ACCPOINT         @ZD00192*/
*                                                                  0863
         L     @15,STARTPNT(,APRWKPTR)                             0863
         CR    @15,@06                                             0863
         BE    @RF00863                                            0863
*     /***************************************************************/
*     /*                                                             */
*     /* FREE ACCPOINT                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0864
*     DO;                           /* YES, FREE IT          @ZD00192*/
*       CORELEN=POINTLEN;           /* MOVE LENGTH           @ZD00192*/
         LH    @06,POINTLEN(,APRWKPTR)                             0865
         STCM  @06,7,CORELEN(CVTPTR)                               0865
*       SPNO=APRSPNO;               /* MOVE SUBPOOL NUMBER   @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0866
*       COREADDR=STARTPNT;          /* MOVE ADDRESS          @ZD00192*/
         ST    @15,COREADDR(,CVTPTR)                               0867
*       RFY                                                        0868
*         R1 RSTD;                  /*                       @ZD00192*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0869
*       CALL ISDAFREE;              /* FREE ACCPOINT         @ZD00192*/
         L     @15,@CV00392                                        0870
         BALR  @14,@15                                             0870
*       RFY                                                        0871
*         R1 UNRSTD;                /*                       @ZD00192*/
*     END;                          /* END FREE ACCPOINT     @ZD00192*/
*   ELSE                                                           0873
*     ;                             /* NO CORE TO FREE       @ZD00192*/
@RF00863 DS    0H                                                  0874
*                                                                  0874
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE APRWORK - APR WORK AREA                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0874
*   CORELEN=LENGTH(APRWORK);        /* SET LENGTH            @ZD00192*/
         MVC   CORELEN(3,CVTPTR),@CF00874+1                        0874
*   SPNO=APRSPNO;                   /* SET SUBPOOL NUMBER    @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0875
*   COREADDR=APR00PTR;              /* SET ADDRESS           @ZD00192*/
         MVC   COREADDR(4,CVTPTR),APR00PTR(CVTPTR)                 0876
*   RFY                                                            0877
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0878
*   CALL ISDAFREE;                  /* FREE WORK AREA        @ZD00192*/
         L     @15,@CV00392                                        0879
         BALR  @14,@15                                             0879
*   RFY                                                            0880
*     R1 UNRSTD;                    /*                       @ZD00192*/
*   APR00PTR=0;                     /* SET APR POINTER TO ZERO     0881
*                                                            @ZD00192*/
         SLR   @06,@06                                             0881
         ST    @06,APR00PTR(,CVTPTR)                               0881
*   END FREECORE;                   /* END OF FREECORE PROC  @ZD00192*/
@EL00023 DS    0H                                                  0882
@EF00023 DS    0H                                                  0882
@ER00023 L     @14,@SA00023                                        0882
         BR    @14                                                 0882
*   END ISDAAPR1                    /* END OF ISDAAPR1       @ZD00192*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSC0)                                        *
*;                                                                 0883
@DATA    DS    0H
@CH00102 DC    H'2'
@CH00106 DC    H'4'
@CH00250 DC    H'20'
@CH00626 DC    H'56'
@CH00854 DC    XL2'39'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00004 DS    1F
@SA00020 DS    1F
@SA00022 DS    1F
@SA00006 DS    1F
@SA00007 DS    1F
@SA00011 DS    1F
@SA00016 DS    1F
@SA00012 DS    1F
@SA00013 DS    1F
@SA00014 DS    1F
@SA00015 DS    1F
@SA00008 DS    1F
@SA00009 DS    1F
@SA00010 DS    1F
@SA00005 DS    0F
@SA00023 DS    0F
@SA00002 DS    0F
         DS    1F
@TF00001 DS    F
ISDAAPR1 CSECT
         DS    0F
@CF00083 DC    F'1'
@CH00083 EQU   @CF00083+2
@CF00187 DC    F'5'
@CF00874 DC    F'124'
@CF00875 DC    F'-4'
@DATD    DSECT
         DS    0D
LPARMPTR DS    A
K        DS    F
PINDEX   DS    F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAAPR1 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00389 DC    V(ISDAPRT0)
@CV00391 DC    V(ISDAGET1)
@CV00392 DC    V(ISDAFREE)
@CV00390 DC    V(ISDAGET0)
         DS    0D
@CC00365 DC    C'    '
@CC00372 DC    C'MSC '
@CC00374 DC    C'SA  '
@CC00376 DC    C'DRC '
@CC00378 DC    C'DRD '
@CC00380 DC    C'MSFN'
@CC00382 DC    C'ACC '
@CC00384 DC    C'3330'
@CC00351 DC    C'SUU'
@CC00827 DC    C'ERP'
APRSPNO  DC    X'01'
APRTITLE DC    CL65'REPORT 3 - ALTERNATE PATH RETRY, MEDIA FAILURE, ANDC
                UNIT UNUSABLE'
SUUTITLE DC    CL50'REPORT 4 - UNIT UNUSABLE AND MEDIA FAILURE SUMMARY'
APRMSG10 DC    CL73'***** XXXXX APR SEQUENCES WERE FOUND. ONLY THE FIRSC
               T 50 ARE PRINTED *****'
APRMSG20 DC    CL87'***** XXXXX MISPLACED CARTRIDGE RECORDS WERE FOUND.C
                ONLY THE FIRST 50 ARE PRINTED *****'
ACTION1  DC    CL19'START APR'
ACTION1E DC    CL19'NO APR BEGINNING'
ACTION2E DC    CL19'NO END TO APR'
ACTION2  DC    CL19'END APR'
ACTION3  DC    CL19'UNIT UNUSABLE (APR)'
ACTION4  DC    CL19'PERMANENT ERROR'
ACTION5  DC    CL19'MSFN RECONFIGURED'
ACTION6  DC    CL19'MISPLACED CARTRIDGE'
ACTION7  DC    CL19'SWITCH TO ALT MSC'
ACTION8  DC    CL19'MEDIA FAILURE'
RFLAG1   DC    CL13'UNIT UNUSABLE'
RFLAG2   DC    CL13'MEDIA FAILURE'
RFLAG3   DC    CL13' ACC UNUSABLE'
APRMSG01 DC    CL4'DATE'
APRMSG02 DC    CL4'TIME'
APRMSG03 DC    CL6'ACTION'
APRMSG04 DC    CL6'RESULT'
ACT1M1   DC    CL71'SSIDS FAILED                 -PATH(  )-CSN(        C
                   )-VOLID(      )'
ACT1M2   DC    CL3'- )'
ACT2M1   DC    CL18'SUCCESSFUL RETRY'
ACT2M1U  DC    CL18'UNSUCCESSFUL RETRY'
ACT2M1E  DC    CL18'SUCCESS UNKNOWN'
ACT2M1T  DC    CL42' - PATH(  ) - SSIDS MARKED UNUSABLE BY APR'
ACT2M2   DC    CL16'  NONE'
ACT2M3   DC    CL28'MEDIA FAILURE - LZYX(    ) -'
ACT2M4   DC    CL33'PERMANENT MEDIA ERROR'
ACT2M8   DC    CL33'XXX CYLINDERS STAGED WITH ERROR'
ACT2M5   DC    CL33'STRIPES AVAILABLE = 0'
ACT2M6   DC    CL33'LOAD FAILURE'
ACT2M7   DC    CL33'UNKNOWN TERMINATION CODE (  )'
ACT3M1   DC    CL58'     SSID     MARKED UNUSABLE BY APR - BYTES 0-3(  C
                     )'
ACT3M2   DC    CL13'PATH  4XX-2XX'
ACT3M3   DC    CL66'     SSID     MARKED UNUSABLE BY ERP - MSG CODE 06 C
               - TERM CODE(XX)'
ACT4M1   DC    CL68'     SSID     MARKED UNUSABLE - BYTES 0-5(         C
                   ) - FSC(    )'
ACT4M2   DC    CL61'MSC RUA     MARKED UNUSABLE - CPUID(      -    ) - C
               FSC(    )'
ACT4M3   DC    CL24'MSC FMT 4 SA FMT/MSG(XX)'
ACT5M1   DC    CL63'SSID     -       ACCESSOR MOVED TO GARAGE - MSC BYTC
               ES 4,5(    )'
ACT5M2   DC    CL5' LEFT'
ACT5M3   DC    CL5'RIGHT'
ACT6M1   DC    CL72'VOLID(      ) - CSN(            ) - TABLE ID(  ) - C
               LZYX(    ) - CASE(  )'
ACT6M2   DC    CL13'SUU SSID(XXX)'
ACT7M1   DC    CL61'SWITCHED FROM MSC RUA     - CPUID(      -    ) - MSC
               G CODE(  )'
ACT8M1   DC    CL55'VIRTUAL CYLINDER 0000 STAGED WITH ERROR - VOLID(   C
                  )'
EDPAT01  DC    X'40212020207A20207A20207A20202020612020202020'
EDPAT02  DC    X'402020202120'
EDPAT03  DC    X'40202120'
SUMMSG01 DC    CL27'SUMMARY OF UNUSABLE DEVICES'
SUMMSG02 DC    CL3'SUU'
SUMMSG03 DC    CL4'LAST'
SUMMSG04 DC    CL51' DATE      TIME       RUA   SSID   DEVICE     COUNTC
               '
SUMMSG05 DC    CL25'SUMMARY OF MEDIA FAILURES'
SUMMSG06 DC    CL9'CARTRIDGE'
SUMMSG07 DC    CL51' DATE      TIME        CSN           VOLID    COUNTC
               '
SUMBACC  DC    CL5'ACC  '
SUMLACC  DC    CL5'L-ACC'
SUMRACC  DC    CL5'R-ACC'
PATCH    DC    50X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
J        EQU   @06
I        EQU   @05
RETCODE  EQU   @07
ENTRYPTR EQU   @04
APRWKPTR EQU   @03
SENSEPTR EQU   @05
GET0PTR  EQU   @05
CVTPTR   EQU   @02
R1       EQU   @01
R15      EQU   @15
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
APR00PTR EQU   CVTPTRS0+80
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDARPTID EQU   PRT0CALL+133
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CAPRSUU  EQU   CREPORTS+10
ISDAGHDR EQU   0
GET0SPLN EQU   ISDAGHDR+8
NEXTPTR  EQU   ISDAGHDR+12
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
SUBSENSE EQU   ISDAMSCS+4
SUBFMTMG EQU   SUBSENSE+7
ISDAMSC0 EQU   4
VOLID0   EQU   ISDAMSC0
CHR0     EQU   VOLID0
TBLID0   EQU   ISDAMSC0+6
CSN0     EQU   16
APRWORK  EQU   0
APRWORK0 EQU   APRWORK
ACCM0PTR EQU   APRWORK0
ACCUMPTR EQU   APRWORK0+4
CURRPTR  EQU   APRWORK0+12
CURRNEXT EQU   APRWORK0+16
TOTALENT EQU   APRWORK0+24
SORTCNT  EQU   APRWORK0+28
STARTAPR EQU   APRWORK0+32
STARTPNT EQU   APRWORK0+36
LINECNT  EQU   APRWORK0+40
POINTLEN EQU   APRWORK0+48
T07COUNT EQU   APRWORK0+50
T09COUNT EQU   APRWORK0+52
T41COUNT EQU   APRWORK0+54
T08COUNT EQU   APRWORK0+56
SAVEDYTS EQU   APRWORK0+58
SAVEDAYT EQU   SAVEDYTS
SAVEDATE EQU   SAVEDAYT
SAVETIME EQU   SAVEDAYT+4
SAVESSID EQU   APRWORK0+68
APRSSIDF EQU   APRWORK0+70
APRSSIDS EQU   APRSSIDF
SAVESAPR EQU   APRWORK0+86
TYPECODE EQU   APRWORK0+90
APRFLAGS EQU   APRWORK0+91
APRTEMPS EQU   APRWORK+92
TEMP9    EQU   APRTEMPS
TEMP8    EQU   TEMP9
TEMP7    EQU   TEMP8
TEMP6    EQU   TEMP7
TEMP5    EQU   TEMP6
TEMP4    EQU   TEMP5
TEMP3    EQU   TEMP4
TEMP2    EQU   TEMP3
TEMP1    EQU   TEMP2
TEMP20   EQU   APRTEMPS+9
TEMP16   EQU   TEMP20
TEMP710  EQU   TEMP20+6
TEMP1113 EQU   TEMP20+10
TEMP1417 EQU   TEMP20+13
TEMP1415 EQU   TEMP1417
TEMP1820 EQU   TEMP20+17
ACCENTRY EQU   0
ENTFIXED EQU   ACCENTRY
NEXTENT  EQU   ENTFIXED
ENTFLAGS EQU   ENTFIXED+4
ENTCOUNT EQU   ENTFLAGS
ETYPCODE EQU   ENTFLAGS+3
EFMTMSG  EQU   ENTFLAGS+4
ENTFLAG  EQU   ENTFLAGS+5
EFLAG1   EQU   ENTFLAG
EFLAG2   EQU   ENTFLAG
EFLAG3   EQU   ENTFLAG
EFLAG4   EQU   ENTFLAG
EFLAG5   EQU   ENTFLAG
EFLAG6   EQU   ENTFLAG
EFLAG7   EQU   ENTFLAG
EFLAG8   EQU   ENTFLAG
ENTSSID  EQU   ENTFLAGS+6
ENTDAYTS EQU   ENTFIXED+12
ENTDAYT  EQU   ENTDAYTS
ENTVAR   EQU   ACCENTRY+24
EBYTE03  EQU   ENTVAR
EBYTE3   EQU   EBYTE03+3
EBYTE431 EQU   ENTVAR+4
ENTVOLID EQU   EBYTE431
ENTCPUID EQU   ENTVOLID
EBYTE45  EQU   ENTCPUID
EBYTE4   EQU   EBYTE45
EBYTE5   EQU   EBYTE45+1
EBYTE67  EQU   ENTCPUID+2
EBYTE9   EQU   ENTVOLID+5
EBYTE10  EQU   EBYTE431+6
EBYT1215 EQU   EBYTE431+8
EBYTE12  EQU   EBYT1215
EBYTE13  EQU   EBYT1215+1
EBYT1415 EQU   EBYT1215+2
ENTCSN   EQU   EBYTE431+12
EBYT2829 EQU   EBYTE431+24
ACCPOINT EQU   0
WORKPTR  EQU   0
RM71     EQU   LINE+44
RM18     EQU   LINE+44
RM42     EQU   LINE+62
RM28     EQU   LINE+44
RM33     EQU   LINE+73
RM58     EQU   LINE+44
RM13     EQU   LINE+44
RM66     EQU   LINE+44
RM17     EQU   LINE+60
RM68     EQU   LINE+44
RM24     EQU   LINE+76
RM61     EQU   LINE+44
RM63     EQU   LINE+44
RM72     EQU   LINE+44
RM55     EQU   LINE+44
SSIDA1M1 EQU   LINE+56
PATHA1M1 EQU   LINE+79
CSNA1M1  EQU   LINE+87
VOLA1M1  EQU   LINE+107
SEQFA1M1 EQU   LINE+113
SEQNA1M1 EQU   LINE+114
PATHA2M1 EQU   LINE+70
SSIDA2M1 EQU   LINE+105
LZYXA2M3 EQU   LINE+65
NO08A2M3 EQU   LINE+72
TCA2M7   EQU   LINE+99
ERPA3M3  EQU   LINE+37
DEV34M1  EQU   LINE+44
SSIDA3M2 EQU   LINE+50
SSID34M1 EQU   LINE+54
BY10A3M2 EQU   LINE+55
B03A3M1  EQU   LINE+93
TERMA3M3 EQU   LINE+107
B03A4M1  EQU   LINE+86
B45A4M1  EQU   LINE+95
FSCA4M1  EQU   LINE+107
BFSCA4M1 EQU   LINE+101
RUAA4M2  EQU   LINE+52
CPIDA4M2 EQU   LINE+80
CPUSA4M2 EQU   LINE+87
FSCA4M2  EQU   LINE+99
FMTMA4M3 EQU   LINE+97
SSIDA5M1 EQU   LINE+49
MSFNA5M1 EQU   LINE+25
ACCA5M1  EQU   LINE+55
B45A5M1  EQU   LINE+102
VOLA6M1  EQU   LINE+50
SSIDA6M2 EQU   LINE+53
CSNA6M1  EQU   LINE+64
SSIDA6M3 EQU   LINE+69
TIDA6M1  EQU   LINE+89
LZYXA6M1 EQU   LINE+100
CASEA6M1 EQU   LINE+113
RUAA7M1  EQU   LINE+66
CPIDA7M1 EQU   LINE+78
CPUSA7M1 EQU   LINE+85
MCA7M1   EQU   LINE+102
CYLA8M1  EQU   LINE+61
VOLA8M1  EQU   LINE+92
BAR1     EQU   LINE+7
BAR2     EQU   LINE+20
BAR3     EQU   LINE+42
MSG01    EQU   LINE+1
MSG02    EQU   LINE+11
MSG03    EQU   LINE+22
MSG04    EQU   LINE+44
OUTDAY   EQU   LINE
OUTYEAR  EQU   LINE+3
OUTTIME  EQU   LINE+8
ACTION   EQU   LINE+22
RFLAG    EQU   LINE+117
EDREC01  EQU   APRTEMPS
TEMP68   EQU   TEMP8+5
TEMP78   EQU   TEMP8+6
TEMP2427 EQU   APRTEMPS+23
TEMP2831 EQU   APRTEMPS+27
TEMP2331 EQU   APRTEMPS+22
ED01TIME EQU   EDREC01+3
ED01YEAR EQU   EDREC01+16
ED01DAY  EQU   EDREC01+19
TOTCOUNT EQU   LINE+5
SUMLAST  EQU   LINE+6
SUMSUU   EQU   LINE+46
SUMRUA   EQU   LINE+22
SUMSSID  EQU   LINE+28
SUMDEVT  EQU   LINE+36
SUMACCLR EQU   LINE+36
SUMCNT1  EQU   LINE+44
SUMCART  EQU   LINE+27
SUMCSN   EQU   LINE+22
SUMVOLID EQU   LINE+36
SUMSEQD  EQU   LINE+42
SUMSEQN  EQU   LINE+43
SBAR1    EQU   LINE+20
SBAR2    EQU   LINE+26
SBAR3    EQU   LINE+33
SBAR4    EQU   LINE+44
*                                      START UNREFERENCED COMPONENTS
EBYT3031 EQU   EBYTE431+26
EBYTE11  EQU   EBYTE431+7
EBYTE8   EQU   ENTCPUID+4
EBYTE7   EQU   EBYTE67+1
EBYTE6   EQU   EBYTE67
EBYTE2   EQU   EBYTE03+2
EBYTE1   EQU   EBYTE03+1
EBYTE0   EQU   EBYTE03
ENTSPARE EQU   ENTFIXED+21
ENTSEQEN EQU   ENTDAYTS+8
ENTTIME  EQU   ENTDAYT+4
ENTDATE  EQU   ENTDAYT
ELENGTH  EQU   ENTFLAGS+2
TEMP3032 EQU   APRTEMPS+29
TEMP1617 EQU   TEMP1417+2
SAVSPARE EQU   APRWORK0+67
SAVSEQEN EQU   SAVEDYTS+8
ACCUMCNT EQU   APRWORK0+46
CURRLEN  EQU   APRWORK0+44
ACCLAST  EQU   APRWORK0+20
ACCUMEND EQU   APRWORK0+8
LOADERR0 EQU   ISDAMSC0+26
RWLOADS0 EQU   ISDAMSC0+24
SWCHECK0 EQU   ISDAMSC0+22
SRCHECK0 EQU   ISDAMSC0+20
WUSECNT0 EQU   ISDAMSC0+16
RUSECNT0 EQU   ISDAMSC0+12
XYZL0    EQU   ISDAMSC0+10
@NM00007 EQU   ISDAMSC0+9
TERMCOD0 EQU   ISDAMSC0+8
MSGCODE0 EQU   ISDAMSC0+7
SSID0    EQU   CHR0
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
MSCFSC   EQU   SUBSENSE+22
@NM00006 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00005 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SUBFMTNO EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00004 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT5 EQU   SUBSENSE+1
SUBSTAT4 EQU   SUBSENSE
FORMATNO EQU   ISDAMSCS+3
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
@NM00003 EQU   ISDAGHDR+26
BLOCKCNT EQU   ISDAGHDR+24
BLOCKID  EQU   ISDAGHDR+20
LASTPTR  EQU   ISDAGHDR+16
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
STARTPTR EQU   ISDAGHDR
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
*                                      END UNREFERENCED COMPONENTS
@RC00064 EQU   @RC00052
@RC00146 EQU   @RC00145
@RC00162 EQU   @RC00127
@RC00305 EQU   @RC00302
@RC00410 EQU   @EL00010
@RC00408 EQU   @EL00010
@RC00398 EQU   @EL00010
@RC00441 EQU   @EL00011
@RC00456 EQU   @EL00012
@RC00552 EQU   @EL00014
@RC00624 EQU   @EL00019
@RC00622 EQU   @EL00019
@RC00620 EQU   @EL00019
@RC00618 EQU   @EL00019
@RC00616 EQU   @EL00019
@RC00643 EQU   @EL00020
@RC00065 EQU   @RC00064
@RC00399 EQU   @RC00398
@RC00555 EQU   @RC00552
@RC00625 EQU   @RC00624
@ENDDATA EQU   *
         END   ISDAAPR1,(C'PLS1753',0701,78044)

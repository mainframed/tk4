         TITLE 'ISDASUM0 - SDA SUMMARY ACCUMULATOR                     *
                        '
ISDASUM0 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDASUM0  78.164'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0033
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SECTION                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0033
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO ISDACVT    0033
*                                                            @Y30LB55*/
         L     @06,@PC00001                                        0033
         L     CVTPTR,WORKPTR(,@06)                                0033
*   RETCODE=0;                      /* ZERO RETURN CODE      @Y30LB55*/
         SLR   RETCODE,RETCODE                                     0034
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO ISDAPRMS   0035
*                                                            @Y30LB55*/
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                         0035
*   IF SUM00PTR=0 THEN              /* ON FIRST CALL         @Y30LB55*/
*                                                                  0036
         SLR   @06,@06                                             0036
         C     @06,SUM00PTR(,CVTPTR)                               0036
         BNE   @RF00036                                            0036
*     /***************************************************************/
*     /*                                                             */
*     /* GET CORE FOR SUMWORK AND SUMACCUM                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0037
*     DO;                           /* GET CORE              @Y30LB55*/
*       SUMWKPTR=0;                 /* INITIALYZE SUMWKPTR   @Y30LB55*/
         SLR   SUMWKPTR,SUMWKPTR                                   0038
*       GET0PTR=0;                  /* INITIALYZE GET0PTR    @Y30LB55*/
*                                                                  0039
         ST    @06,GET0PTR                                         0039
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ISDAGET1 FOR SMALL SUM WORK AREA                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0040
*       CORELEN=LENGTH(SUMWORK);    /* LENGTH OF SUMWORK     @Y30LB55*/
         MVC   CORELEN(3,CVTPTR),@CF00612+1                        0040
*       SPNO=SUMSPNO;               /* SET MY SUBPOOL NUMBER @Y30LB55*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0041
*       RFY                                                        0042
*         R1 RSTD;                  /*                       @Y30LB55*/
*       R1=ADDR(WORKCALL);          /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0043
*       CALL ISDAGET1;              /* GET SUMWORK WITHOUT HEADER  0044
*                                                            @Y30LB55*/
         L     @15,@CV00454                                        0044
         BALR  @14,@15                                             0044
*       RFY                                                        0045
*         R15 RSTD;                 /*                       @Y30LB55*/
*       RETCODE=R15;                /* SAVE RETURN CODE      @Y30LB55*/
         LR    RETCODE,R15                                         0046
*       RFY                                                        0047
*        (R1,                                                      0047
*         R15) UNRSTD;              /*                       @Y30LB55*/
*       IF RETCODE=0 THEN           /* WAS GETMAIN DONE      @Y30LB55*/
         LTR   RETCODE,RETCODE                                     0048
         BNZ   @RF00048                                            0048
*         DO;                       /* YES, SET ALL ADDRESS POINTERS
*                                                            @Y30LB55*/
*           SUM00PTR=COREADDR;      /* STORE WORKAREA ADDRESS IN   0050
*                                      ISDACVT               @Y30LB55*/
         L     @06,COREADDR(,CVTPTR)                               0050
         ST    @06,SUM00PTR(,CVTPTR)                               0050
*           SUMWKPTR=COREADDR;      /* SET ADDR TO WORKAREA  @Y30LB55*/
         LR    SUMWKPTR,@06                                        0051
*           SUMWORK=''B;            /* ZERO ACCUMULATOR      @Y30LB55*/
         XC    SUMWORK(233,SUMWKPTR),SUMWORK(SUMWKPTR)             0052
*           NCOUNTER=ISDASUM2;      /* SAVE COUNT OF ENTRIES IN    0053
*                                      DEFAULT TABLE         @Y30LB55*/
         L     @06,@CA00406                                        0053
         L     @15,ISDASUM2-ISDASUM2(,@06)                         0053
         STH   @15,NCOUNTER(,SUMWKPTR)                             0053
*           SUM2PTR=ADDR(ISDASUM2)+4;/* SAVE ADDR OF ACTUAL DEFAULT
*                                      TABLE                 @Y30LB55*/
         AH    @06,@CH00106                                        0054
         ST    @06,SUM2PTR(,SUMWKPTR)                              0054
*           SUMACCL=LENGTH(MCOUNTER)*NCOUNTER;/*                   0055
*                                      LENGTH EACH ENTRY*NO. ENTRIES
*                                                            @Y30LB55*/
         MH    @15,@CH00221                                        0055
         STH   @15,SUMACCL(,SUMWKPTR)                              0055
*           NCPUCNTS=LENGTH(SUMWORK2)/LENGTH(CPUFOUND);/* SET MAX NO.
*                                                            @Y30LB55*/
*                                                                  0056
         MVC   NCPUCNTS(2,SUMWKPTR),@CH00207                       0056
*           /*********************************************************/
*           /*                                                       */
*           /* GET ACCUMULATOR                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0057
*           IF CSUM(8)='1'B THEN    /* WAS SUM REPORT REQUESTED    0057
*                                                            @Y30LB55*/
         L     @06,LPARMPTR                                        0057
         TM    CSUM(@06),B'00000001'                               0057
         BNO   @RF00057                                            0057
*             CALL GETACCUM;        /* YES, CALL ACCUMULATOR PROC  0058
*                                                            @Y30LB55*/
         BAL   @14,GETACCUM                                        0058
*           ELSE                                                   0059
*             ;                     /* NO, DO NOT GET CORE FOR     0059
*                                      SUMACCUM              @Y30LB55*/
@RF00057 DS    0H                                                  0060
*           ACCM0PTR=GET0PTR;       /* SAVE ADDR OF ACCUMULATOR 0  0060
*                                                            @Y30LB55*/
         MVC   ACCM0PTR(4,SUMWKPTR),GET0PTR                        0060
*         END;                      /* END INITIALZIE SUMWORK@ZM02889*/
*       ELSE                                                       0062
*         ;                         /* BAD RETURN FROM ISDAGET1    0062
*                                                            @Y30LB55*/
@RF00048 DS    0H                                                  0063
*     END;                          /* END GETMAIN FOR WORKAREA AND
*                                      ACCUMULATOR                 0063
*                                                            @Y30LB55*/
*   ELSE                            /* ON ALL OTHER CALLS    @Y30LB55*/
*                                                                  0064
*     /***************************************************************/
*     /*                                                             */
*     /* NOT FIRST CALL, SET UP LOCAL POINTERS                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0064
*     SUMWKPTR=SUM00PTR;            /* SET ADDR TO WORKAREA  @Y30LB55*/
         B     @RC00036                                            0064
@RF00036 L     SUMWKPTR,SUM00PTR(,CVTPTR)                          0064
*                                                                  0065
*   /*****************************************************************/
*   /*                                                               */
*   /* ACCUMULATOR CODE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0065
*   IF RETCODE=0 THEN                                              0065
@RC00036 LTR   RETCODE,RETCODE                                     0065
         BNZ   @RF00065                                            0065
*     DO;                           /* GOT ACCUMULATOR OK    @Y30LB55*/
*       LOGPTR=DATAPTR;             /* SET LOCAL PTR TO OBRMDR     0067
*                                                            @Y30LB55*/
         MVC   LOGPTR(4,SUMWKPTR),DATAPTR(CVTPTR)                  0067
*       SENSEPTR=SDATAPTR;          /* SET LOCAL PTR TO ISDAMSCS   0068
*                                                            @Y30LB55*/
         MVC   SENSEPTR(4,SUMWKPTR),SDATAPTR(CVTPTR)               0068
*       IF SUMFLAGS(1)='0'B THEN    /* ACCUMULATING DATA     @ZA20267*/
         TM    SUMFLAGS(SUMWKPTR),B'10000000'                      0069
         BNZ   @RF00069                                            0069
*         CALL SUM0CPU;             /* BUILD TABLE OF CPUIDS @Y30LB55*/
         BAL   @14,SUM0CPU                                         0070
*       ELSE;                       /* NO, PRINT SEVERITY    @ZA20267*/
@RF00069 DS    0H                                                  0072
*       MAINMASK=''B;               /* ZERO 3 BYTE MASK      @Y30LB55*/
*                                                                  0072
         XC    MAINMASK(3,SUMWKPTR),MAINMASK(SUMWKPTR)             0072
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD MASKS FOR ACCUMULATOR UPDATES                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0073
*       IF INDEVTYP='S' THEN        /* SUBSYSTEM RECORD      @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0073
         CLI   INDEVTYP(@06),C'S'                                  0073
         BNE   @RF00073                                            0073
*         FORMATCK=FORMATNO&'FC'X;  /* SET FORMATCK=FORMATNO(1-6)  0074
*                                                            @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0074
         MVC   FORMATCK(1,SUMWKPTR),FORMATNO(@06)                  0074
         NI    FORMATCK(SUMWKPTR),X'FC'                            0074
*       ELSE                        /* NO, HOST DASD RECORD  @Y30LB55*/
*         FORMATCK='04'X;           /* SET FORMATCK SAME AS FORMAT 5
*                                                            @Y30LB55*/
         B     @RC00073                                            0075
@RF00073 MVI   FORMATCK(SUMWKPTR),X'04'                            0075
*       IF INDEVTYP='S' THEN        /* SUBSYSTEM RECORD      @Y30LB55*/
@RC00073 L     @06,SDA00PTR(,CVTPTR)                               0076
         CLI   INDEVTYP(@06),C'S'                                  0076
         BNE   @RF00076                                            0076
*         IF FORMATCK(1)='1'B THEN                                 0077
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0077
         BNO   @RF00077                                            0077
*           CALL SUMFMT0;           /* MSC FORMAT 0          @Y30LB55*/
         BAL   @14,SUMFMT0                                         0078
*         ELSE                                                     0079
*           IF FORMATCK(2)='1'B THEN                               0079
         B     @RC00077                                            0079
@RF00077 TM    FORMATCK(SUMWKPTR),B'01000000'                      0079
         BNO   @RF00079                                            0079
*             CALL SUMFMT1;         /* MSC FORMAT 1          @Y30LB55*/
         BAL   @14,SUMFMT1                                         0080
*           ELSE                                                   0081
*             IF FORMATCK(3)='1'B THEN                             0081
         B     @RC00079                                            0081
@RF00079 TM    FORMATCK(SUMWKPTR),B'00100000'                      0081
         BNO   @RF00081                                            0081
*               CALL SUMFMT2;       /* MSC FORMAT 2          @Y30LB55*/
         BAL   @14,SUMFMT2                                         0082
*             ELSE                                                 0083
*               IF FORMATCK(4)='1'B THEN                           0083
         B     @RC00081                                            0083
@RF00081 TM    FORMATCK(SUMWKPTR),B'00010000'                      0083
         BNO   @RF00083                                            0083
*                 CALL SUMFMT3;     /* MSC FORMAT 3          @Y30LB55*/
         BAL   @14,SUMFMT3                                         0084
*               ELSE                                               0085
*                 IF FORMATCK(5)='1'B THEN                         0085
         B     @RC00083                                            0085
@RF00083 TM    FORMATCK(SUMWKPTR),B'00001000'                      0085
         BNO   @RF00085                                            0085
*                   CALL SUMFMT4;   /* MSC FORMAT 4          @Y30LB55*/
         BAL   @14,SUMFMT4                                         0086
*                 ELSE                                             0087
*                   IF FORMATCK(6)='1'B THEN                       0087
         B     @RC00085                                            0087
@RF00085 TM    FORMATCK(SUMWKPTR),B'00000100'                      0087
         BNO   @RF00087                                            0087
*                     CALL SUMFMT5; /* MSC FORMAT 5          @Y30LB55*/
         BAL   @14,SUMFMT5                                         0088
*                   ELSE                                           0089
*                     DO;           /* UNKNOWN FORMAT        @Y30LB55*/
*                                                                  0089
         B     @RC00087                                            0089
@RF00087 DS    0H                                                  0090
*                     /***********************************************/
*                     /*                                             */
*                     /* SUMUNKN - UNKNOWN FORMAT CODE               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0090
*                       RETCODE=8;  /* SET REJECT RECORD CODE@Y30LB55*/
         LA    RETCODE,8                                           0090
*                       FORMATNC='*';/* SET FORMAT NUMBER    @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'*'                             0091
*                     END;          /* END UNKNOWN FORMAT    @Y30LB55*/
*       ELSE                                                       0093
*         CALL SUMDASD;             /* HOST DASD RECORD      @Y30LB55
*                                                            @Y30LB55*/
         B     @RC00076                                            0093
@RF00076 BAL   @14,SUMDASD                                         0093
*       IF ACCUMPTR^=0&SUMFLAGS(1)='0'B THEN /* DO SUMMARY   @ZA20267*/
*                                                                  0094
@RC00076 ICM   @06,15,ACCUMPTR(SUMWKPTR)                           0094
         BZ    @RF00094                                            0094
         TM    SUMFLAGS(SUMWKPTR),B'10000000'                      0094
         BNZ   @RF00094                                            0094
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE COUNTERS WITH HIGH-LOW DATE AND TIME AND COUNTS  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0095
*         DO;                       /* YES, BUILD TABLES     @ZA20267*/
*           CALL UPDATEAC;          /* UPDATE COUNTERS       @Y30LB55*/
         BAL   @14,UPDATEAC                                        0096
*           IF RETCODE=0&INDEVTYP^='R' THEN /* NO ERRORS AND NOT   0097
*                                              REAL DASD     @ZA20267*/
         LTR   RETCODE,RETCODE                                     0097
         BNZ   @RF00097                                            0097
         L     @06,SDA00PTR(,CVTPTR)                               0097
         CLI   INDEVTYP(@06),C'R'                                  0097
         BE    @RF00097                                            0097
*             CALL SEVERITY;        /* BUILD SEVERITY LIST   @ZA20267*/
         BAL   @14,SEVERITY                                        0098
*           ELSE;                   /* DO NOT ADD TO LIST    @ZA20267*/
@RF00097 DS    0H                                                  0100
*         END;                      /* END BUILD SUM TABLES  @ZA20267*/
*       ELSE                                                       0101
*         ;                         /* NO COUNTERS TO UPDATE @Y30LB55*/
*                                                                  0101
@RF00094 DS    0H                                                  0102
*       /*************************************************************/
*       /*                                                           */
*       /* DETAIL PRINT OF INPUT DATA                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0102
*       IF SUMFLAGS(1)='0'B THEN    /* CALL FROM SDA0        @ZA20267*/
         TM    SUMFLAGS(SUMWKPTR),B'10000000'                      0102
         BNZ   @RF00102                                            0102
*         DO;                       /* YES, CHECK IF DETAIL  @ZA20267*/
*           CALL CHKPARMS;          /* SETS TEMP1 IF DETAIL        0104
*                                      REQUESTED             @ZM31121*/
         BAL   @14,CHKPARMS                                        0104
*           IF TEMP1=FORMATCK THEN  /* DETAIL(X)=FORMATNO(X) @ZM31074*/
         CLC   TEMP1(1,SUMWKPTR),FORMATCK(SUMWKPTR)                0105
         BNE   @RF00105                                            0105
*             CALL DETAIL;          /* YES, PRINT DATA       @ZM30999*/
         BAL   @14,DETAIL                                          0106
*           ELSE;                   /* NO, DUMP THIS FORMAT NOT    0107
*                                      REQUESTED             @Y30LB55*/
@RF00105 DS    0H                                                  0108
*         END;                      /* END PRINT DETAIL      @ZA20267*/
*       ELSE                        /* CALL FROM ISDASUM1    @ZA20267*/
*         CALL DETAIL;              /* PRINT SEVERITY REPORT @ZA20267*/
         B     @RC00102                                            0109
@RF00102 BAL   @14,DETAIL                                          0109
*       IF RETCODE=8&FORMATCK(1)='1'B THEN /* FORMAT 0 AND         0110
*                                      UNKNOWN MSG CODE      @ZA14729*/
@RC00102 CH    RETCODE,@CH00071                                    0110
         BNE   @RF00110                                            0110
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0110
         BNO   @RF00110                                            0110
*         RETCODE=0;                /* YES, DO NOT REJECT    @ZA14729*/
         SLR   RETCODE,RETCODE                                     0111
*       ELSE;                       /* NO                    @ZA14729*/
@RF00110 DS    0H                                                  0113
*     END;                          /* END OF ACCUMULATOR CODE     0113
*                                                            @Y30LB55*/
*   ELSE                            /* CANNOT CONTINUE - NO SPACE  0114
*                                                            @Y30LB55*/
*                                                                  0114
*     /***************************************************************/
*     /*                                                             */
*     /* BAD RETURN FOR ISDAGET, SUM CANNOT BE RUN                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0114
*     DO;                           /* CLEANUP AND RESET CONTROL   0114
*                                      FLAGS                 @Y30LB55*/
         B     @RC00065                                            0114
@RF00065 DS    0H                                                  0115
*       IF SUMWKPTR^=0 THEN         /* WAS SUMWORK GOT       @Y30LB55*/
         SLR   @06,@06                                             0115
         CR    SUMWKPTR,@06                                        0115
         BE    @RF00115                                            0115
*         DO;                       /* YES, MUST FREE IT     @Y30LB55*/
*           IF GET0PTR^=0 THEN      /* HAVE ACCUMULATOR YET  @ZM31074*/
         L     @15,GET0PTR                                         0117
         CR    @15,@06                                             0117
         BE    @RF00117                                            0117
*             DO;                   /* YES, FREE IT          @ZM31074*/
*               SPNOLEN=GET0SPLN;   /* LENGTH + SUBPOOL      @ZM31074*/
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(@15)                     0119
*               COREADDR=GET0PTR;   /* ADDR OF ACCUM         @ZM31074*/
         ST    @15,COREADDR(,CVTPTR)                               0120
*               RFY R1 RSTD;                                       0121
*               R1=ADDR(WORKCALL);  /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0122
*               CALL ISDAFREE;      /* FREEMAIN              @ZM31074*/
         L     @15,@CV00455                                        0123
         BALR  @14,@15                                             0123
*               RFY R1 UNRSTD;                                     0124
*             END;                  /* END FREE ACCUM        @ZM31074*/
*           ELSE;                   /* NO ACCUMULATOR TO FREE@ZM31074*/
@RF00117 DS    0H                                                  0127
*           IF SEVSTART^=0 THEN     /* HAVE SEVERITY LIST    @ZA20267*/
         L     @06,SEVSTART(,SUMWKPTR)                             0127
         LTR   @06,@06                                             0127
         BZ    @RF00127                                            0127
*             DO;                   /* YES, FREE IT          @ZA20267*/
*               SPNOLEN=SEVRLEN;    /* LENGTH + SUBPOOL      @ZA20267*/
         MVC   SPNOLEN(4,CVTPTR),SEVRLEN(SUMWKPTR)                 0129
*               COREADDR=SEVSTART;  /* ADDR OF SEVRLIST      @ZA20267*/
         ST    @06,COREADDR(,CVTPTR)                               0130
*               RFY R1 RSTD;                                       0131
*               R1=ADDR(WORKCALL);  /* R1 -> WORKPTR         @ZA20267*/
         LA    R1,WORKCALL(,CVTPTR)                                0132
*               CALL ISDAFREE;      /* FREEMAIN              @ZA20267*/
         L     @15,@CV00455                                        0133
         BALR  @14,@15                                             0133
*               RFY R1 UNRSTD;                                     0134
*             END;                  /* END FREE SEVERITY     @ZA20267*/
*           ELSE;                   /* NO LIST TO FREE       @ZA20267*/
*                                                                  0136
@RF00127 DS    0H                                                  0137
*           /*********************************************************/
*           /*                                                       */
*           /* FREE SUMWORK                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0137
*           CORELEN=LENGTH(SUMWORK);/* LENGTH OF WORKAREA    @Y30LB55*/
         MVC   CORELEN(3,CVTPTR),@CF00612+1                        0137
*           SPNO=SUMSPNO;           /* SET SUBPOOL NUMBER    @Y30LB55*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0138
*           COREADDR=SUM00PTR;      /* ADDR OF WORKAREA      @Y30LB55*/
         MVC   COREADDR(4,CVTPTR),SUM00PTR(CVTPTR)                 0139
*           RFY                                                    0140
*             R1 RSTD;              /*                       @Y30LB55*/
*           R1=ADDR(WORKCALL);      /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0141
*           CALL ISDAFREE;          /* FREE SUMWORK          @Y30LB55*/
         L     @15,@CV00455                                        0142
         BALR  @14,@15                                             0142
*           RFY                                                    0143
*             R1 UNRSTD;            /* END FREEMAIN          @Y30LB55*/
*         END;                      /* END FREE SUMWORK      @Y30LB55*/
*       ELSE                                                       0145
*         ;                         /* NO, GETMAIN ERROR GETTING   0145
*                                      SUMWORK               @Y30LB55*/
@RF00115 DS    0H                                                  0146
*       SUM00PTR=0;                 /* ZERO MY PTR IN ISDACVT@Y30LB55*/
         SLR   @06,@06                                             0146
         ST    @06,SUM00PTR(,CVTPTR)                               0146
*       CSUM='00'X;                 /* ZERO SUM CALL FLAG    @Y30LB55*/
         L     @06,LPARMPTR                                        0147
         MVI   CSUM(@06),X'00'                                     0147
*     END;                          /* END CLEANUP SECTION   @Y30LB55*/
*   RETURN CODE(RETCODE);           /* RETURN TO ISDASDA0    @Y30LB55*/
@RC00065 L     @13,4(,@13)                                         0149
         L     @00,@SIZDATD                                        0149
         LR    @01,@10                                             0149
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@07                                             0149
         L     @14,12(,@13)                                        0149
         LM    @00,@12,20(@13)                                     0149
         BR    @14                                                 0149
*                                                                  0150
*   /*****************************************************************/
*   /*                                                               */
*   /* DETAIL - PROC TO PRINT DETAIL SENSE OPTION                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0150
*DETAIL:                                                           0150
*   PROC OPTIONS(SAVE(14));         /* PRINT SENSE DATA      @ZM30999*/
@EL00001 L     @13,4(,@13)                                         0150
@EF00001 L     @00,@SIZDATD                                        0150
         LR    @01,@10                                             0150
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0150
         BR    @14                                                 0150
DETAIL   ST    @14,@SA00002                                        0150
*   CALL BUILDM01;                  /* CALL PROC TO BUILD DETAIL   0151
*                                      OUTPUT                @Y30LB55*/
         BAL   @14,BUILDM01                                        0151
*   IF SUMFLAGS(1)='0'B THEN        /* CALL FROM ISDASDA0    @ZA20267*/
         TM    SUMFLAGS(SUMWKPTR),B'10000000'                      0152
         BNZ   @RF00152                                            0152
*     IF (LINECNT+4)>MAXLCNT THEN   /* NO SPACE ON PAGE      @ZM30730*/
         L     @06,PRT00PTR(,CVTPTR)                               0153
         LA    @15,4                                               0153
         AH    @15,LINECNT(,@06)                                   0153
         CH    @15,@CH00441                                        0153
         BNH   @RF00153                                            0153
*       ANSI=PSKIP;                 /* YES, SKIP TO NEW PAGE @ZM30730*/
         MVI   ANSI(CVTPTR),C'1'                                   0154
*     ELSE                          /* THIS PAGE OK          @ZM30730*/
*       ANSI=LSKIP2;                /* SKIP 2 LINES          @Y30LB55*/
         B     @RC00153                                            0155
@RF00153 MVI   ANSI(CVTPTR),C'0'                                   0155
*   ELSE                            /* CALL FROM ISDASUM1    @ZA20267*/
*     ANSI=LSKIP1;                  /* 1 SKIP FOR SEVERITY   @ZA20267*/
         B     @RC00152                                            0156
@RF00152 MVI   ANSI(CVTPTR),C' '                                   0156
*   DUMPADDR=ADDR(ISDAMSCS);        /* SET ADDR TO DUMP      @Y30LB55*/
@RC00152 MVC   DUMPADDR(4,CVTPTR),SENSEPTR(SUMWKPTR)               0157
*   DUMPLEN=DLENGTH;                /* SET LENGTH TO DUMP    @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0158
         LH    @06,DLENGTH(,@06)                                   0158
         ST    @06,DUMPLEN(,CVTPTR)                                0158
*   DUMPIDNO=0;                     /* SET DUMP ID OFF       @Y30LB55*/
         SLR   @06,@06                                             0159
         ST    @06,DUMPIDNO(,CVTPTR)                               0159
*   RFY                                                            0160
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0161
*   CALL ISDAPRT0;                  /* PRINT SUMMSG01        @Y30LB55*/
         L     @15,@CV00457                                        0162
         BALR  @14,@15                                             0162
*   ANSI=LSKIP1;                    /* SKIP 1 LINE           @Y30LB55*/
         MVI   ANSI(CVTPTR),C' '                                   0163
*   LINE=SUMMSG02;                  /* MOVE MSG02            @Y30LB55*/
         MVI   LINE+115(CVTPTR),C' '                               0164
         MVC   LINE+116(16,CVTPTR),LINE+115(CVTPTR)                0164
         MVC   LINE(115,CVTPTR),SUMMSG02                           0164
*   FMTID02=FMTIDSV;                /* MOVE FORMAT ID        @Y30LB55*/
         MVC   FMTID02(7,CVTPTR),FMTIDSV(SUMWKPTR)                 0165
*   FMTNO02=FORMATNC;               /* MOVE FORMAT NO.       @Y30LB55*/
         MVC   FMTNO02(1,CVTPTR),FORMATNC(SUMWKPTR)                0166
*   IF FORMATCK(5:6)^='00'B THEN    /* FORMAT 4 OR 5         @Y30LB55*/
         TM    FORMATCK(SUMWKPTR),B'00001100'                      0167
         BZ    @RF00167                                            0167
*     DO;                           /* MOVE SA FORMAT        @ZM31022*/
*       SUBFID02=SUBFIDSV;          /* YES, MOVE SUB FMT NO. @Y30LB55*/
         MVC   SUBFID02(1,CVTPTR),SUBFIDSV(SUMWKPTR)               0169
*       IF INDEVTYP='R' THEN        /* REAL 3330 RECORD      @ZM31022*/
         L     @06,SDA00PTR(,CVTPTR)                               0170
         CLI   INDEVTYP(@06),C'R'                                  0170
         BNE   @RF00170                                            0170
*         SABLANK='  ';             /* YES, BLANK WORD SA    @ZM31022*/
         MVC   SABLANK(2,CVTPTR),@CC00880                          0171
*       ELSE;                       /* NO                    @ZM31022*/
@RF00170 DS    0H                                                  0173
*     END;                          /* END MOVE SA FORMAT    @ZM31022*/
*   ELSE                            /* NO SA FORMAT FOR 0,1,2,3    0174
*                                                            @Y30LB55*/
*     SUBFID12='';                  /* BLANK SA FORMAT       @Y30LB55*/
         B     @RC00167                                            0174
@RF00167 MVI   SUBFID12(CVTPTR),C' '                               0174
         MVC   SUBFID12+1(13,CVTPTR),SUBFID12(CVTPTR)              0174
*   MSGCOD02(2)=RPAREN;             /* MOVE RIGHT PAREN      @ZM02889*/
@RC00167 MVI   MSGCOD02+1(CVTPTR),C')'                             0175
*   IF FORMATCK(1)='1'B THEN        /* FORMAT 0              @ZM02889*/
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0176
         BNO   @RF00176                                            0176
*     DO;                           /* YES, MOVE 2 DIGITS    @ZM02889*/
*       MSGCOD02(1)=SUBFIDSV;       /* MOVE BITS 0-3         @ZM02889*/
         MVC   MSGCOD02(1,CVTPTR),SUBFIDSV(SUMWKPTR)               0178
*       MSGCOD02(2)=MSGCODSV;       /* MOVE BITS 4-7         @ZM02889*/
         MVC   MSGCOD02+1(1,CVTPTR),MSGCODSV(SUMWKPTR)             0179
*       MSGCOD02(3)=RPAREN;         /* MOVE RIGHT PAREN      @ZM02889*/
         MVI   MSGCOD02+2(CVTPTR),C')'                             0180
*     END;                          /* END FORMAT 0 MSG CODE @ZM02889*/
*   ELSE                            /* CHECK FORMAT 4 OR 5   @ZM02889*/
*     IF FORMATCK(5:6)^='00'B THEN  /* FORMAT 4 OR 5         @ZM02889*/
         B     @RC00176                                            0182
@RF00176 TM    FORMATCK(SUMWKPTR),B'00001100'                      0182
         BZ    @RF00182                                            0182
*       MSGCOD02(1)=MSGCODSV;       /* MOVE MSG CODE         @ZM02889*/
         MVC   MSGCOD02(1,CVTPTR),MSGCODSV(SUMWKPTR)               0183
*     ELSE                          /* NO MSG CODE FOR FMTS 1,2,3  0184
*                                                            @ZM02889*/
*       MSGCOD12='';                /* BLANK MSG CODE        @ZM02889*/
         B     @RC00182                                            0184
@RF00182 MVI   MSGCOD12(CVTPTR),C' '                               0184
         MVC   MSGCOD12+1(11,CVTPTR),MSGCOD12(CVTPTR)              0184
*   CALL ISDAPRT0;                  /* PRINT SUMMSG02        @Y30LB55*/
@RC00182 DS    0H                                                  0185
@RC00176 L     @15,@CV00457                                        0185
         BALR  @14,@15                                             0185
*   RFY                                                            0186
*     R1 UNRSTD;                    /*                       @Y30LB55*/
*   CALL PRINTID;                   /* PRINT SENSE DESCRIP   @ZM30999*/
         BAL   @14,PRINTID                                         0187
*   END DETAIL;                     /* END DETAIL PRINT      @Y30LB55*/
@EL00002 DS    0H                                                  0188
@EF00002 DS    0H                                                  0188
@ER00002 L     @14,@SA00002                                        0188
         BR    @14                                                 0188
*                                                                  0189
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINTID - PROC TO PRINT SENSE DATA WITH ID IN DETAIL PRINT    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0189
*PRINTID:                                                          0189
*   PROC OPTIONS(SAVE(14));         /* GET SENSE DATA ID     @ZM30999*/
PRINTID  ST    @14,@SA00003                                        0189
*   J=0;                            /* INIT J                @ZM30999*/
         SLR   J,J                                                 0190
*   LINE='';                        /* BLANK LINE            @ZM30999*/
         MVI   LINE(CVTPTR),C' '                                   0191
         MVC   LINE+1(131,CVTPTR),LINE(CVTPTR)                     0191
*   IF RETCODE=0 THEN               /* HAVE KNOWN FORMAT     @ZM30999*/
         LTR   RETCODE,RETCODE                                     0192
         BNZ   @RF00192                                            0192
*     DO;                           /* YES, GET SENSE ID     @ZM30999*/
*       DEVIDPTR=SUM2PTR;           /* GET START OF SUM2     @ZM30999*/
         L     DEVIDPTR,SUM2PTR(,SUMWKPTR)                         0194
*       DO I=1 TO NCOUNTER WHILE(J=0); /* LOOP THROUGH SUM2  @ZM30999*/
         LA    I,1                                                 0195
         B     @DE00195                                            0195
@DL00195 LTR   J,J                                                 0195
         BNZ   @DC00195                                            0195
*         IF MAINMASK=MDMASK THEN   /* DO WE HAVE A MATCH    @ZM30999*/
         CLC   MAINMASK(3,SUMWKPTR),MDMASK(DEVIDPTR)               0196
         BNE   @RF00196                                            0196
*           J=1;                    /* YES, GET OUT OF LOOP  @ZM30999*/
         LA    J,1                                                 0197
*         ELSE                      /* NO MATCH YET          @ZM30999*/
*           DEVIDPTR=DEVIDPTR+LENGTH(MDEVIDTB);/*                  0198
*                                      INC SUM2 POINTER      @ZM30999*/
         B     @RC00196                                            0198
@RF00196 AH    DEVIDPTR,@CH01011                                   0198
*       END;                        /* END LOOP THRU SUM2    @ZM30999*/
@RC00196 AH    I,@CH00083                                          0199
@DE00195 SLR   @15,@15                                             0199
         ICM   @15,3,NCOUNTER(SUMWKPTR)                            0199
         CR    I,@15                                               0199
         BNH   @DL00195                                            0199
@DC00195 DS    0H                                                  0200
*       IF J=1 THEN                 /* DID WE FIND A MATCH   @ZM30999*/
         CH    J,@CH00083                                          0200
         BNE   @RF00200                                            0200
*         SENSEID=MDMSGXXX;         /* MOVE SENSE DESCRIPTION@ZM30999*/
         MVC   SENSEID(34,CVTPTR),MDMSGXXX(DEVIDPTR)               0201
*       ELSE;                       /* NO MATCH IN SUM2      @ZM30999*/
@RF00200 DS    0H                                                  0203
*     END;                          /* END GET SENSE ID      @ZM30999*/
*   ELSE;                           /* UNKNOWN FORMAT        @ZM30999*/
@RF00192 DS    0H                                                  0205
*   RFY R1 RSTD;                    /* RESTRICT R1           @ZM30999*/
*   R1=ADDR(WORKCALL);              /* R1 -> WORKPTR         @ZM30999*/
         LA    R1,WORKCALL(,CVTPTR)                                0206
*   CALL ISDAHEXP;                  /* PRINT SENSE AND ID    @ZM30999*/
         L     @15,@CV00456                                        0207
         BALR  @14,@15                                             0207
*   RFY R1 UNRSTD;                  /* RELEASE R1            @ZM30999*/
*   END PRINTID;                    /* END PRINTID PROC      @ZM30999*/
@EL00003 DS    0H                                                  0209
@EF00003 DS    0H                                                  0209
@ER00003 L     @14,@SA00003                                        0209
         BR    @14                                                 0209
*                                                                  0210
*   /*****************************************************************/
*   /*                                                               */
*   /* SUM0CPU - PROC TO BUILD TABLE OF CPUIDS - CPUFOUND            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*SUM0CPU:                                                          0210
*   PROC OPTIONS(SAVE(14));         /* BUILD TABLE OF CPUIDS @Y30LB55*/
SUM0CPU  ST    @14,12(,@13)                                        0210
*   I=1;                            /* INIT INDEX            @Y30LB55*/
         LA    @06,1                                               0211
         LR    I,@06                                               0211
*   J=0;                            /* SET FOUND FLAG TO 0   @Y30LB55*/
         SLR   J,J                                                 0212
*   DO I=1 TO NCPUCNTS WHILE(J=0);  /* LOOP THROUGH CPUFOUND @Y30LB55*/
         LR    I,@06                                               0213
         B     @DE00213                                            0213
@DL00213 LTR   J,J                                                 0213
         BNZ   @DC00213                                            0213
*     IF CPUSERID=CPUFOUND(I) THEN  /* FOUND A MATCH         @Y30LB55*/
         L     @06,LOGPTR(,SUMWKPTR)                               0214
         LR    @15,I                                               0214
         MH    @15,@CH00180                                        0214
         ALR   @15,SUMWKPTR                                        0214
         CLC   CPUSERID(5,@06),CPUFOUND-5(@15)                     0214
         BNE   @RF00214                                            0214
*       J=1;                        /* YES, GET OUT OF LOOP  @Y30LB55*/
         LA    J,1                                                 0215
*     ELSE                          /* NOT A MATCH           @Y30LB55*/
*       IF CPUFOUND(I)=CPUZERO THEN /* FOUND PLACE TO PUT NEW CPUID
*                                                            @Y30LB55*/
         B     @RC00214                                            0216
@RF00214 LR    @06,I                                               0216
         MH    @06,@CH00180                                        0216
         ST    @06,@TF00001                                        0216
         ALR   @06,SUMWKPTR                                        0216
         CLC   CPUFOUND-5(5,@06),CPUZERO                           0216
         BNE   @RF00216                                            0216
*         DO;                       /* YES                   @Y30LB55*/
*           CPUFOUND(I)=CPUSERID;   /* ADD CPUID TO TABLE    @Y30LB55*/
         LR    @06,SUMWKPTR                                        0218
         AL    @06,@TF00001                                        0218
         L     @01,LOGPTR(,SUMWKPTR)                               0218
         MVC   CPUFOUND-5(5,@06),CPUSERID(@01)                     0218
*           NCPUUSED=I;             /* UPDATE COUNT          @Y30LB55*/
         STH   I,NCPUUSED(,SUMWKPTR)                               0219
*           J=1;                    /* GET OUT OF LOOP       @Y30LB55*/
         LA    J,1                                                 0220
*         END;                      /* END UPDATE TABLE CODE @Y30LB55*/
*       ELSE                                                       0222
*         ;                         /* NOT ZERO              @Y30LB55*/
@RF00216 DS    0H                                                  0223
*   END;                            /* END LOOP THROUGH CPUFOUND   0223
*                                                            @Y30LB55*/
@RC00214 AH    I,@CH00083                                          0223
@DE00213 SLR   @06,@06                                             0223
         ICM   @06,3,NCPUCNTS(SUMWKPTR)                            0223
         CR    I,@06                                               0223
         BNH   @DL00213                                            0223
@DC00213 DS    0H                                                  0224
*   IF J=0 THEN                     /* TABLE OVERFLOW        @Y30LB55*/
         LTR   J,J                                                 0224
         BNZ   @RF00224                                            0224
*     SUMFLAGS(8)='1'B;             /* SET CPUFOUND OVERFLOW BIT   0225
*                                                            @Y30LB55*/
         OI    SUMFLAGS(SUMWKPTR),B'00000001'                      0225
*   ELSE                                                           0226
*     ;                             /* TABLE OK              @Y30LB55*/
@RF00224 DS    0H                                                  0227
*   END SUM0CPU;                    /* END OF SUM0CPU PROC   @Y30LB55
*                                                            @Y30LB55*/
@EL00004 DS    0H                                                  0227
@EF00004 DS    0H                                                  0227
@ER00004 L     @14,12(,@13)                                        0227
         BR    @14                                                 0227
*                                                                  0228
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILDM01 - BUILD SUMMSG01 FOR DETAIL PRINT OF INPUT           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0228
*BUILDM01:                                                         0228
*   PROC OPTIONS(SAVE(14));         /* BUILD SUMMSG01 CODE   @Y30LB55*/
BUILDM01 ST    @14,12(,@13)                                        0228
*   LINE=SUMMSG01;                  /* MOVE MSG01            @Y30LB55*/
         MVI   LINE+116(CVTPTR),C' '                               0229
         MVC   LINE+117(15,CVTPTR),LINE+116(CVTPTR)                0229
         MVC   LINE(116,CVTPTR),SUMMSG01                           0229
*   CVD(NINREC,TEMP8);              /* RECORD NO.            @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0230
         L     @06,NINREC(,@06)                                    0230
         CVD   @06,TEMP8(,SUMWKPTR)                                0230
*   REC01=EDPAT05;                  /* MOVE EDIT PATTERN     @Y30LB55*/
         MVC   REC01(6,CVTPTR),EDPAT05                             0231
*   ED(REC01,TEMP68);               /* EDIT REC NUMBER       @Y30LB55*/
*                                                                  0232
*                                                                  0232
         ED    REC01(6,CVTPTR),TEMP68(SUMWKPTR)                    0232
*   /*****************************************************************/
*   /*                                                               */
*   /* UNPACK DATE, TIME, SYSTEM ID, RECORD TYPE, AND CPUID          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*                                                                  0233
*   UNPK(TEMP7,DATE);               /* DATE                  @Y30LB55*/
         L     @06,LOGPTR(,SUMWKPTR)                               0233
         UNPK  TEMP7(7,SUMWKPTR),DATE(4,@06)                       0233
*   DAY01=TEMP7(5:7);               /* MOVE DAY              @Y30LB55*/
         MVC   DAY01(3,CVTPTR),TEMP7+4(SUMWKPTR)                   0234
*   YEAR01=TEMP7(3:4);              /* MOVE YEAR             @Y30LB55*/
         MVC   YEAR01(2,CVTPTR),TEMP7+2(SUMWKPTR)                  0235
*   TEMP4=TIME;                     /* MOVE TIME             @Y30LB55*/
         MVC   TEMP4(4,SUMWKPTR),TIME(@06)                         0236
*   UNPK(TEMP9,TEMP5);              /* TIME                  @Y30LB55*/
         UNPK  TEMP9(9,SUMWKPTR),TEMP5(5,SUMWKPTR)                 0237
*   HOUR01=TEMP9(1:2);              /* MOVE HOUR             @Y30LB55*/
         MVC   HOUR01(2,CVTPTR),TEMP9(SUMWKPTR)                    0238
*   MIN01=TEMP9(3:4);               /* MOVE MINUTE           @Y30LB55*/
         MVC   MIN01(2,CVTPTR),TEMP9+2(SUMWKPTR)                   0239
*   SEC01=TEMP9(5:6);               /* MOVE SECOND           @Y30LB55*/
         MVC   SEC01(2,CVTPTR),TEMP9+4(SUMWKPTR)                   0240
*   HUN01=TEMP9(7:8);               /* MOVE TENS+HUNS        @Y30LB55*/
         MVC   HUN01(2,CVTPTR),TEMP9+6(SUMWKPTR)                   0241
*   IF SYSREL(1:3)='010'B THEN      /* VS1                   @ZM31022*/
         TM    SYSREL(@06),B'01000000'                             0242
         BNO   @RF00242                                            0242
         TM    SYSREL(@06),B'10100000'                             0242
         BNZ   @RF00242                                            0242
*     SYSTEMID='VS1';               /* YES                   @ZM31022*/
         MVC   SYSTEMID(3,CVTPTR),@CC00896                         0243
*   ELSE                            /* NO                    @ZM31022*/
*     IF SYSREL(1:3)='100'B THEN    /* VS2                   @ZM31022*/
         B     @RC00242                                            0244
@RF00242 L     @06,LOGPTR(,SUMWKPTR)                               0244
         TM    SYSREL(@06),B'10000000'                             0244
         BNO   @RF00244                                            0244
         TM    SYSREL(@06),B'01100000'                             0244
         BNZ   @RF00244                                            0244
*       SYSTEMID='VS2';             /* YES                   @ZM31022*/
         MVC   SYSTEMID(3,CVTPTR),@CC00898                         0245
*     ELSE                          /* NO                    @ZM31022*/
*       IF SYSREL(1:3)='000'B THEN  /* OS                    @ZM31022*/
         B     @RC00244                                            0246
@RF00244 L     @06,LOGPTR(,SUMWKPTR)                               0246
         TM    SYSREL(@06),B'11100000'                             0246
         BNZ   @RF00246                                            0246
*         SYSTEMID=' OS';           /* YES                   @ZM31022*/
         MVC   SYSTEMID(3,CVTPTR),@CC00900                         0247
*       ELSE                        /* NO                    @ZM31022*/
*         IF SYSREL(1:3)='001'B THEN /* DOS                  @ZM31022*/
         B     @RC00246                                            0248
@RF00246 L     @06,LOGPTR(,SUMWKPTR)                               0248
         TM    SYSREL(@06),B'00100000'                             0248
         BNO   @RF00248                                            0248
         TM    SYSREL(@06),B'11000000'                             0248
         BNZ   @RF00248                                            0248
*           SYSTEMID='DOS';         /* YES                   @ZM31022*/
         MVC   SYSTEMID(3,CVTPTR),@CC00902                         0249
*         ELSE                      /* NO                    @ZM31022*/
*           IF SYSREL(1:3)='011'B THEN /* VM/370             @ZM31022*/
         B     @RC00248                                            0250
@RF00248 L     @06,LOGPTR(,SUMWKPTR)                               0250
         TM    SYSREL(@06),B'01100000'                             0250
         BNO   @RF00250                                            0250
         TM    SYSREL(@06),B'10000000'                             0250
         BNZ   @RF00250                                            0250
*             SYSTEMID=' VM';       /* YES                   @ZM31022*/
         MVC   SYSTEMID(3,CVTPTR),@CC00904                         0251
*           ELSE;                   /* UNKNOWN SYSTEM        @ZM31022*/
@RF00250 DS    0H                                                  0253
*   IF IRECTYPE='O' THEN                                           0253
@RC00248 DS    0H                                                  0253
@RC00246 DS    0H                                                  0253
@RC00244 DS    0H                                                  0253
@RC00242 L     @06,SDA00PTR(,CVTPTR)                               0253
         CLI   IRECTYPE(@06),C'O'                                  0253
         BNE   @RF00253                                            0253
*     TYPE01='OBR';                 /* OBR                   @Y30LB55*/
         MVC   TYPE01(3,CVTPTR),@CC00906                           0254
*   ELSE                                                           0255
*     TYPE01='MDR';                 /* MDR                   @Y30LB55*/
         B     @RC00253                                            0255
@RF00253 MVC   TYPE01(3,CVTPTR),@CC00907                           0255
*   TEMP3=CPUSER;                   /* MOVE CPUSER           @Y30LB55*/
@RC00253 L     @06,LOGPTR(,SUMWKPTR)                               0256
         MVC   TEMP3(3,SUMWKPTR),CPUSER(@06)                       0256
*   UNPK(TEMP9,TEMP5);              /* UNPACK                @Y30LB55*/
         UNPK  TEMP9(9,SUMWKPTR),TEMP5(5,SUMWKPTR)                 0257
*   TEMP16=TEMP6;                   /* SAVE CPUSER           @Y30LB55*/
         MVC   TEMP16(6,SUMWKPTR),TEMP6(SUMWKPTR)                  0258
*   TEMP2=CPUID;                    /* MOVE CPUID            @Y30LB55*/
         MVC   TEMP2(2,SUMWKPTR),CPUID(@06)                        0259
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @Y30LB55*/
         UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0260
*   TEMP710=TEMP4;                  /* SAVE CPUID            @Y30LB55*/
*                                                                  0261
*                                                                  0261
         MVC   TEMP710(4,SUMWKPTR),TEMP4(SUMWKPTR)                 0261
*   /*****************************************************************/
*   /*                                                               */
*   /* RECORDS FROM THE MSC                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*                                                                  0262
*   IF INDEVTYP='S' THEN            /* SUBSYSTEM RECORD      @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0262
         CLI   INDEVTYP(@06),C'S'                                  0262
         BNE   @RF00262                                            0262
*     DO;                           /* YES , GET SSID        @Y30LB55*/
*       TEMP2=SUBSYSID;             /* MOVE SSID             @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0264
         MVC   TEMP2(2,SUMWKPTR),SUBSYSID(@06)                     0264
*       UNPK(TEMP5,TEMP3);          /* UNPACK                @Y30LB55*/
         UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0265
*       TEMP1113=TEMP5(2:4);        /* SAVE SSID             @Y30LB55*/
         MVC   TEMP1113(3,SUMWKPTR),TEMP5+1(SUMWKPTR)              0266
*       IF FORMATCK(1)='0'B&FORMATCK(4)='0'B THEN/* NOT 0,3  @Y30LB55*/
         TM    FORMATCK(SUMWKPTR),B'10010000'                      0267
         BNZ   @RF00267                                            0267
*         TEMP2=MSCFSC;             /* MOVE FSC              @Y30LB55*/
         MVC   TEMP2(2,SUMWKPTR),MSCFSC(@06)                       0268
*       ELSE                        /* NO FSC TO MOVE        @Y30LB55*/
*         TEMP2=''B;                /* ZERO FSC FIELD        @Y30LB55*/
         B     @RC00267                                            0269
@RF00267 XC    TEMP2(2,SUMWKPTR),TEMP2(SUMWKPTR)                   0269
*     END;                          /* END SUBSYSTEM RECORDS @Y30LB55*/
*   ELSE                            /* DASD RECORD           @Y30LB55*/
*                                                                  0271
*                                                                  0271
*   /*****************************************************************/
*   /*                                                               */
*   /* 3330 RECORDS FROM THE SA TO THE HOST DIRECTLY                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*                                                                  0271
*     DO;                           /* 3330 RECORDS FROM SA  @ZM02889*/
         B     @RC00262                                            0271
@RF00262 DS    0H                                                  0272
*       TEMP2=MSCFSC;               /* MOVE BYTE 26,27       @ZM02889*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0272
         MVC   TEMP2(2,SUMWKPTR),MSCFSC(@06)                       0272
*       TEMP1=''B;                  /* ZERO BYTE 26          @ZM02889*/
         MVI   TEMP1(SUMWKPTR),X'00'                               0273
*       UNPK(TEMP5,TEMP3);          /* UNPACK SSID           @ZM02889*/
         UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0274
*       TEMP1113=TEMP5(2:4);        /* MOVE 3 CHAR SSID      @ZM02889*/
         MVC   TEMP1113(3,SUMWKPTR),TEMP5+1(SUMWKPTR)              0275
*       TEMP2=DASDFSC;              /* MOVE 3330 FSC         @Y30LB55*/
         MVC   TEMP2(2,SUMWKPTR),DASDFSC(@06)                      0276
*     END;                          /* END GET 3330 SSID     @ZMO2889*/
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @Y30LB55*/
@RC00262 UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0278
*   TEMP1417=TEMP4;                 /* SAVE FSC              @Y30LB55*/
         MVC   TEMP1417(4,SUMWKPTR),TEMP4(SUMWKPTR)                0279
*   TEMP2=INRECCUA;                 /* MOVE CUA              @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0280
         MVC   TEMP2(2,SUMWKPTR),INRECCUA(@06)                     0280
*   UNPK(TEMP5,TEMP3);              /* UNPACK                @Y30LB55*/
         UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0281
*   TEMP1820=TEMP5(2:4);            /* MOVE CUA UNPACKED     @Y30LB55*/
         MVC   TEMP1820(3,SUMWKPTR),TEMP5+1(SUMWKPTR)              0282
*   DO I=1 TO 20;                   /* FIX HEX DIGITS        @Y30LB55*/
         LA    I,1                                                 0283
@DL00283 DS    0H                                                  0284
*     IF TEMP20(I)>'9' THEN                                        0284
         LR    @06,SUMWKPTR                                        0284
         ALR   @06,I                                               0284
         CLI   TEMP20-1(@06),C'9'                                  0284
         BNH   @RF00284                                            0284
*       TEMP20(I)=TEMP20(I)-'39'X;  /* FIX A-F               @Y30LB55*/
         SLR   @06,@06                                             0285
         IC    @06,TEMP20-1(I,SUMWKPTR)                            0285
         SH    @06,@CH00909                                        0285
         STC   @06,TEMP20-1(I,SUMWKPTR)                            0285
*     ELSE                                                         0286
*       ;                           /* OK 0-9                @Y30LB55*/
@RF00284 DS    0H                                                  0287
*   END;                            /* END HEX DIGIT FIX     @Y30LB55*/
         AH    I,@CH00083                                          0287
         CH    I,@CH00345                                          0287
         BNH   @DL00283                                            0287
*   CPUSRM01=TEMP16;                /* MOVE CONVERTED CPUSER @Y30LB55*/
         MVC   CPUSRM01(6,CVTPTR),TEMP16(SUMWKPTR)                 0288
*   CPUIDM01=TEMP710;               /* MOVE CONVERTED CPUID  @Y30LB55*/
         MVC   CPUIDM01(4,CVTPTR),TEMP710(SUMWKPTR)                0289
*   DEVRUA01=TEMP1820;              /* MOVE CONVERTED RUA    @ZA11668*/
         MVC   DEVRUA01(3,CVTPTR),TEMP1820(SUMWKPTR)               0290
*   IF SDAFLAG0(8)='1'B THEN        /* WAS FSC GENERATED BY ISDAGEN0
*                                                            @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0291
         TM    SDAFLAG0(@06),B'00000001'                           0291
         BNO   @RF00291                                            0291
*     FSCM21=SUMMSG11;              /* YES, MOVE MESSAGE     @Y30LB55*/
         MVC   FSCM21(14,CVTPTR),SUMMSG11                          0292
*   ELSE                                                           0293
*     ;                             /* NO                    @Y30LB55*/
@RF00291 DS    0H                                                  0294
*   IF RETCODE=8 THEN               /* WAS REC TYPE KNOWN    @Y30LB55*/
         CH    RETCODE,@CH00071                                    0294
         BNE   @RF00294                                            0294
*     FSCM21=SUMMSG21;              /* NO, MOVE UNKNOWN MSG  @Y30LB55*/
         MVC   FSCM21(14,CVTPTR),SUMMSG21                          0295
*   ELSE;                           /* YES, OK               @Y30LB55*/
*                                                                  0296
*                                                                  0296
@RF00294 DS    0H                                                  0297
*   /*****************************************************************/
*   /*                                                               */
*   /* MSC RECORDS - MOVE FORMAT,FSC, AND SSID                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*                                                                  0297
*   IF INDEVTYP='S' THEN                                           0297
         L     @06,SDA00PTR(,CVTPTR)                               0297
         CLI   INDEVTYP(@06),C'S'                                  0297
         BNE   @RF00297                                            0297
*     DO;                           /* MSC RECORD            @Y30LB55*/
*       DEVT01=' MSC';              /* MSC                   @Y30LB55*/
         MVC   DEVT01(4,CVTPTR),@CC00910                           0299
*       DEVVUA11='';                /* BLANK VUA FIELD       @ZA11668*/
         MVI   DEVVUA11(CVTPTR),C' '                               0300
         MVC   DEVVUA11+1(7,CVTPTR),DEVVUA11(CVTPTR)               0300
*       FMTIDSV='FORMAT ';          /* FORMAT                @Y30LB55*/
         MVC   FMTIDSV(7,SUMWKPTR),@CC00911                        0301
*       IF FORMATCK(2:4)='000'B THEN/* FORMAT 0,4, OR 5      @Y30LB55*/
         TM    FORMATCK(SUMWKPTR),B'01110000'                      0302
         BNZ   @RF00302                                            0302
*         I=SUBFMTMG;               /* LOAD SUBFMT+MSG CODE  @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0303
         SLR   I,I                                                 0303
         IC    I,SUBFMTMG(,@06)                                    0303
*       ELSE                        /* FORMAT 1,2, AND 3 HAVE NO   0304
*                                      SUBFMT                @Y30LB55*/
*         I=0;                      /* SET SUBFMT AND MSG CODE TO 0
*                                                            @Y30LB55*/
         B     @RC00302                                            0304
@RF00302 SLR   I,I                                                 0304
*       SSIDM01=TEMP1113;           /* MOVE CONVERTED SSID   @YD00145*/
@RC00302 MVC   SSIDM01(3,CVTPTR),TEMP1113(SUMWKPTR)                0305
*       IF FORMATCK(1)='1'BFORMATCK(4)='1'B THEN/* 0 OR 3   @Y30LB55*/
         TM    FORMATCK(SUMWKPTR),B'10010000'                      0306
         BZ    @RF00306                                            0306
*         FSCM11='';                /* NO FSC IN RECORD      @Y30LB55*/
         MVI   FSCM11(CVTPTR),C' '                                 0307
         MVC   FSCM11+1(8,CVTPTR),FSCM11(CVTPTR)                   0307
*       ELSE                        /* FORMAT 1,2,4, OR 5    @Y30LB55*/
*         IF FORMATCK(5)='1'B&SUBFMTMG>='D0'X&SUBFMTMG<'E0'X THEN  0308
         B     @RC00306                                            0308
@RF00306 TM    FORMATCK(SUMWKPTR),B'00001000'                      0308
         BNO   @RF00308                                            0308
         L     @06,SENSEPTR(,SUMWKPTR)                             0308
         CLI   SUBFMTMG(@06),X'D0'                                 0308
         BL    @RF00308                                            0308
         CLI   SUBFMTMG(@06),X'E0'                                 0308
         BNL   @RF00308                                            0308
*                                   /* SA FORMAT D           @YD00145*/
*           FSCM11='';              /* YES, NO FSC           @YD00145*/
         MVI   FSCM11(CVTPTR),C' '                                 0309
         MVC   FSCM11+1(8,CVTPTR),FSCM11(CVTPTR)                   0309
*         ELSE                      /* NOT 4D                @YD00145*/
*           IF FORMATCK(6)='1'B&SUBFMTMG>='50'X THEN /* 55 OR 56   0310
*                                                            @YD00145*/
         B     @RC00308                                            0310
@RF00308 TM    FORMATCK(SUMWKPTR),B'00000100'                      0310
         BNO   @RF00310                                            0310
         L     @06,SENSEPTR(,SUMWKPTR)                             0310
         CLI   SUBFMTMG(@06),X'50'                                 0310
         BL    @RF00310                                            0310
*             FSCM11='';            /* YES, NO FSC           @YD00145*/
         MVI   FSCM11(CVTPTR),C' '                                 0311
         MVC   FSCM11+1(8,CVTPTR),FSCM11(CVTPTR)                   0311
*           ELSE                    /* NOT FORMAT 55 OR 56   @YD00145*/
*             FSCM01=TEMP1417;      /* MOVE CONVERTED FSC    @Y30LB55*/
         B     @RC00310                                            0312
@RF00310 MVC   FSCM01(4,CVTPTR),TEMP1417(SUMWKPTR)                 0312
*     END;                          /* END MSC RECORDS       @Y30LB55*/
*   ELSE                                                           0314
*                                                                  0314
*                                                                  0314
*   /*****************************************************************/
*   /*                                                               */
*   /* 3330 RECORDS - MOVE S OR R, SSID FOR S, FSC, AND FORMAT       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*                                                                  0314
*     DO;                           /* DASD RECORDS          @Y30LB55*/
         B     @RC00297                                            0314
@RF00297 DS    0H                                                  0315
*       DEVT01='3330';              /* DASD                  @Y30LB55*/
         MVC   DEVT01(4,CVTPTR),@CC00915                           0315
*       IF INDEVTYP='V' THEN                                       0316
         L     @06,SDA00PTR(,CVTPTR)                               0316
         CLI   INDEVTYP(@06),C'V'                                  0316
         BNE   @RF00316                                            0316
*         DO;                       /* HAVE RUA OR VUA       @ZA12870*/
*           FMTIDSV='STAGING';      /* STAGING DASD          @ZM30730*/
         MVC   FMTIDSV(7,SUMWKPTR),@CC00917                        0318
*           IF IRECTYPE='M' THEN    /* MDR RECORD            @ZA11668*/
         CLI   IRECTYPE(@06),C'M'                                  0319
         BNE   @RF00319                                            0319
*             TEMP2=MDRCUA;         /* YES, MOVE VUA         @ZA11668*/
         L     @06,LOGPTR(,SUMWKPTR)                               0320
         MVC   TEMP2(2,SUMWKPTR),MDRCUA(@06)                       0320
*           ELSE                    /* NO, OBR RECORD        @ZA11668*/
*             TEMP2=SECUA(2:3);     /* MOVE VUA FROM HEADER  @ZA14729*/
         B     @RC00319                                            0321
@RF00319 L     @06,LOGPTR(,SUMWKPTR)                               0321
         MVC   TEMP2(2,SUMWKPTR),SECUA+1(@06)                      0321
*           UNPK(TEMP5,TEMP3);      /* UNPACK VUA            @ZA11668*/
@RC00319 UNPK  TEMP5(5,SUMWKPTR),TEMP3(3,SUMWKPTR)                 0322
*           DEVVUA01=TEMP5(2:4);    /* MOVE VUA              @ZA11668*/
         MVC   DEVVUA01(3,CVTPTR),TEMP5+1(SUMWKPTR)                0323
*           DO J=1 TO 3;            /* FIX EBCDIC A-F        @ZA11668*/
         LA    J,1                                                 0324
@DL00324 DS    0H                                                  0325
*             IF DEVVUA01(J)>'9' THEN/* A-F                  @ZA11668*/
         LR    @06,CVTPTR                                          0325
         ALR   @06,J                                               0325
         CLI   DEVVUA01-1(@06),C'9'                                0325
         BNH   @RF00325                                            0325
*               DEVVUA01(J)=DEVVUA01(J)-'39'X;/* YES, FIX IT @ZA11668*/
         SLR   @06,@06                                             0326
         IC    @06,DEVVUA01-1(J,CVTPTR)                            0326
         SH    @06,@CH00909                                        0326
         STC   @06,DEVVUA01-1(J,CVTPTR)                            0326
*             ELSE;                 /* 0-9 OK                @ZA11668*/
@RF00325 DS    0H                                                  0328
*           END;                    /* END FIX VUA           @ZA11668*/
         AH    J,@CH00083                                          0328
         CH    J,@CH00087                                          0328
         BNH   @DL00324                                            0328
*           IF RUADASD='FF'X THEN   /* INVALID RUA           @ZA12870*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0329
         CLI   RUADASD(@06),X'FF'                                  0329
         BNE   @RF00329                                            0329
*             DEVRUA01='???';       /* YES, DO NOT HAVE RUA  @ZA11668*/
         MVC   DEVRUA01(3,CVTPTR),@CC00920                         0330
*           ELSE;                   /* RUA OK                @ZA12870*/
@RF00329 DS    0H                                                  0332
*         END;                      /* END VIRTUAL DASD      @ZA12870*/
*       ELSE                                                       0333
*         DO;                       /* REAL DASD             @ZA11668*/
         B     @RC00316                                            0333
@RF00316 DS    0H                                                  0334
*           DEVVUA11='';            /* BLANK VUA FIELD       @ZA11668*/
         MVI   DEVVUA11(CVTPTR),C' '                               0334
         MVC   DEVVUA11+1(7,CVTPTR),DEVVUA11(CVTPTR)               0334
*           FMTIDSV='  REAL ';      /* REAL DASD             @Y30LB55*/
         MVC   FMTIDSV(7,SUMWKPTR),@CC00921                        0335
*         END;                      /* END REAL DASD         @ZA11668*/
*       I=DASDFMTN;                 /* LOAD SUBFMT+MSG CODE  @Y30LB55*/
@RC00316 L     @06,SENSEPTR(,SUMWKPTR)                             0337
         SLR   I,I                                                 0337
         IC    I,DASDFMTN(,@06)                                    0337
*       IF DASDFMTN>='50'X THEN     /* FORMAT 5 OR 6         @YD00145*/
         CLI   DASDFMTN(@06),X'50'                                 0338
         BL    @RF00338                                            0338
*         FSCM11='';                /* YES, NO FSC           @YD00145*/
         MVI   FSCM11(CVTPTR),C' '                                 0339
         MVC   FSCM11+1(8,CVTPTR),FSCM11(CVTPTR)                   0339
*       ELSE                        /* FORMAT 0-4            @YD00145*/
*         FSCM01=TEMP1417;          /* MOVE CONVERTED FSC    @Y30LB55*/
         B     @RC00338                                            0340
@RF00338 MVC   FSCM01(4,CVTPTR),TEMP1417(SUMWKPTR)                 0340
*       IF INDEVTYP='V' THEN        /* STAGING 3330          @ZM02889*/
@RC00338 L     @06,SDA00PTR(,CVTPTR)                               0341
         CLI   INDEVTYP(@06),C'V'                                  0341
         BNE   @RF00341                                            0341
*         SSIDM01=TEMP1113;         /* YES, SSID FROM BYTE 27@ZM02889*/
         MVC   SSIDM01(3,CVTPTR),TEMP1113(SUMWKPTR)                0342
*       ELSE                        /* NO, NO SSID FOR REAL  @ZM02889*/
*         SSIDM11='';               /* BLANK SSID FIELD      @Y30LB55*/
         B     @RC00341                                            0343
@RF00341 MVI   SSIDM11(CVTPTR),C' '                                0343
         MVC   SSIDM11+1(8,CVTPTR),SSIDM11(CVTPTR)                 0343
*     END;                          /* END DASD RECORD       @Y30LB55*/
@RC00341 DS    0H                                                  0345
*   TEMP78(1)=I;                    /* GET SUBFORMAT+MSG CODE@Y30LB55*/
@RC00297 STC   I,TEMP78(,SUMWKPTR)                                 0345
*   UNPK(TEMP3,TEMP78);             /* UNPACK                @Y30LB55*/
         UNPK  TEMP3(3,SUMWKPTR),TEMP78(2,SUMWKPTR)                0346
*   DO J=1 TO 2;                    /* FIX HEX               @Y30LB55*/
         LA    J,1                                                 0347
@DL00347 DS    0H                                                  0348
*     IF TEMP2(J)>'9' THEN          /* IS IT A-F             @Y30LB55*/
         LR    @06,SUMWKPTR                                        0348
         ALR   @06,J                                               0348
         CLI   TEMP2-1(@06),C'9'                                   0348
         BNH   @RF00348                                            0348
*       TEMP2(J)=TEMP2(J)-'39'X;    /* YES, FIX IT           @Y30LB55*/
         SLR   @06,@06                                             0349
         IC    @06,TEMP2-1(J,SUMWKPTR)                             0349
         SH    @06,@CH00909                                        0349
         STC   @06,TEMP2-1(J,SUMWKPTR)                             0349
*     ELSE                                                         0350
*       ;                           /* NO, OK                @Y30LB55*/
@RF00348 DS    0H                                                  0351
*   END;                            /* END HEX FIX           @Y30LB55*/
         AH    J,@CH00083                                          0351
         CH    J,@CH00102                                          0351
         BNH   @DL00347                                            0351
*   SUBFIDSV=TEMP2(1);              /* SAVE SA FORMAT        @Y30LB55*/
         MVC   SUBFIDSV(1,SUMWKPTR),TEMP2(SUMWKPTR)                0352
*   MSGCODSV=TEMP2(2);              /* SAVE MESSAGE CODE     @Y30LB55*/
         MVC   MSGCODSV(1,SUMWKPTR),TEMP2+1(SUMWKPTR)              0353
*   END BUILDM01;                   /*                       @Y30LB55*/
@EL00005 DS    0H                                                  0354
@EF00005 DS    0H                                                  0354
@ER00005 L     @14,12(,@13)                                        0354
         BR    @14                                                 0354
*                                                                  0355
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT0 - MSC FORMAT 0 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*SUMFMT0:                                                          0355
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 0  @Y30LB55*/
SUMFMT0  ST    @14,12(,@13)                                        0355
*   FORMATNC='0';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'0'                             0356
*   CNTF0=CNTF0+1;                  /* ADD 1 TO FMT0 COUNT   @Y30LB55*/
         LA    @06,1                                               0357
         AL    @06,CNTF0(,SUMWKPTR)                                0357
         ST    @06,CNTF0(,SUMWKPTR)                                0357
*   SUBFMASK=SUBFMTMG;              /* SAVE MESSAGE CODE     @ZM02889*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0358
         MVC   SUBFMASK(1,SUMWKPTR),SUBFMTMG(@06)                  0358
*   IF SUBFMASK='05'X THEN          /* MSG CODE 05           @Y30LB55*/
         CLI   SUBFMASK(SUMWKPTR),X'05'                            0359
         BNE   @RF00359                                            0359
*     FLAGMASK(8)='1'B;             /* YES, SET BUFFERED LOG BIT   0360
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0360
*   ELSE                                                           0361
*     IF SUBFMASK='00'X&SSIDFLAG(2)='1'B THEN /* SUU FMT 0   @ZM30999*/
         B     @RC00359                                            0361
@RF00359 CLI   SUBFMASK(SUMWKPTR),X'00'                            0361
         BNE   @RF00361                                            0361
         L     @06,SENSEPTR(,SUMWKPTR)                             0361
         TM    SSIDFLAG(@06),B'01000000'                           0361
         BNO   @RF00361                                            0361
*       FLAGMASK(5)='1'B;           /* SET SUU BIT           @ZM30999*/
         OI    FLAGMASK(SUMWKPTR),B'00001000'                      0362
*     ELSE                                                         0363
*       IF SUBFMASK='07'X&SUBSENSE(9)^='00'X THEN /* MEDIA   @ZM30999*/
         B     @RC00361                                            0363
@RF00361 CLI   SUBFMASK(SUMWKPTR),X'07'                            0363
         BNE   @RF00363                                            0363
         L     @06,SENSEPTR(,SUMWKPTR)                             0363
         CLI   SUBSENSE+8(@06),X'00'                               0363
         BE    @RF00363                                            0363
*         FLAGMASK(5)='1'B;         /* SET MEDIA FAIL BIT    @ZM30999*/
         OI    FLAGMASK(SUMWKPTR),B'00001000'                      0364
*       ELSE;                       /* NOT 00, 07, OR 05     @ZM30999*/
@RF00363 DS    0H                                                  0366
*   IF SUBFMASK='06'X&RCODEPTR^=0 THEN/* HAVE MSC REASON CODE      0366
*                                                            @ZM31074*/
@RC00361 DS    0H                                                  0366
@RC00359 CLI   SUBFMASK(SUMWKPTR),X'06'                            0366
         BNE   @RF00366                                            0366
         L     @06,RCODEPTR(,SUMWKPTR)                             0366
         LTR   @06,@06                                             0366
         BZ    @RF00366                                            0366
*     DO;                           /* YES, ADD 1 TO COUNT   @ZM31074*/
*       RCODECNT=RCODECNT+1;        /* ADD 1 TO TOTAL COUNT  @ZM31074*/
         LA    @05,1                                               0368
         L     @15,RCODECNT(,SUMWKPTR)                             0368
         ALR   @15,@05                                             0368
         ST    @15,RCODECNT(,SUMWKPTR)                             0368
*       I=ISDAMSCS(13);             /* GET MSC BYTE 12       @ZM31074*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0369
         SLR   I,I                                                 0369
         IC    I,ISDAMSCS+12(,@01)                                 0369
*       I=I+1;                      /* ADD 1 FOR CODE 00     @ZM31074*/
         ALR   I,@05                                               0370
*       RCODES(I)=RCODES(I)+1;      /* ADD 1 TO COUNT        @ZM31074*/
         LR    @15,I                                               0371
         ALR   @15,@15                                             0371
         ST    @15,@TF00001                                        0371
         ALR   @15,@06                                             0371
         BCTR  @15,0                                               0371
         BCTR  @15,0                                               0371
         SLR   @14,@14                                             0371
         ICM   @14,3,RCODES(@15)                                   0371
         ALR   @05,@14                                             0371
         L     @01,@TF00001                                        0371
         BCTR  @06,0                                               0371
         BCTR  @06,0                                               0371
         STH   @05,RCODES(@01,@06)                                 0371
*     END;                          /* END RCODES UPDATE     @ZM31074*/
*   ELSE;                           /* NOT REASON CODE REC   @ZM31074*/
@RF00366 DS    0H                                                  0374
*   END SUMFMT0;                    /* RETURN TO MAIN LINE CODE    0374
*                                                            @Y30LB55*/
@EL00006 DS    0H                                                  0374
@EF00006 DS    0H                                                  0374
@ER00006 L     @14,12(,@13)                                        0374
         BR    @14                                                 0374
*                                                                  0375
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT1 - MSC FORMAT 1 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0375
*SUMFMT1:                                                          0375
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 1  @Y30LB55*/
SUMFMT1  ST    @14,12(,@13)                                        0375
*   FORMATNC='1';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'1'                             0376
*   CNTF1=CNTF1+1;                  /* ADD 1 TO FMT1 COUNT   @Y30LB55*/
         LA    @06,1                                               0377
         AL    @06,CNTF1(,SUMWKPTR)                                0377
         ST    @06,CNTF1(,SUMWKPTR)                                0377
*   END SUMFMT1;                    /* RETURN TO MAIN LINE CODE    0378
*                                                            @Y30LB55*/
*                                                                  0378
@EL00007 DS    0H                                                  0378
@EF00007 DS    0H                                                  0378
@ER00007 L     @14,12(,@13)                                        0378
         BR    @14                                                 0378
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT2 - MSC FORMAT 2 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0379
*SUMFMT2:                                                          0379
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 2  @Y30LB55*/
SUMFMT2  ST    @14,12(,@13)                                        0379
*   FORMATNC='2';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'2'                             0380
*   CNTF2=CNTF2+1;                  /* ADD 1 TO FMT2 COUNT   @Y30LB55*/
         LA    @06,1                                               0381
         AL    @06,CNTF2(,SUMWKPTR)                                0381
         ST    @06,CNTF2(,SUMWKPTR)                                0381
*   END SUMFMT2;                    /* RETURN TO MAIN LINE CODE    0382
*                                                            @Y30LB55*/
@EL00008 DS    0H                                                  0382
@EF00008 DS    0H                                                  0382
@ER00008 L     @14,12(,@13)                                        0382
         BR    @14                                                 0382
*                                                                  0383
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT3 - MSC FORMAT 3 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*SUMFMT3:                                                          0383
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 3  @Y30LB55*/
SUMFMT3  ST    @14,12(,@13)                                        0383
*   FORMATNC='3';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'3'                             0384
*   CNTF3=CNTF3+1;                  /* ADD 1 TO FMT3 COUNT   @Y30LB55*/
         LA    @06,1                                               0385
         AL    @06,CNTF3(,SUMWKPTR)                                0385
         ST    @06,CNTF3(,SUMWKPTR)                                0385
*   IF SUBSTAT5(8)='1'B THEN        /* CS BUFFERED LOG       @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0386
         TM    SUBSTAT5(@06),B'00000001'                           0386
         BNO   @RF00386                                            0386
*     DO;                           /* YES                   @Y30LB55*/
*       FLAGMASK(8)='1'B;           /* SET BUFFERED LOG BIT  @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0388
*       IF MOVES12(3)='1'B THEN     /* ERROR OVERFLOW        @YM32171*/
         TM    MOVES12(@06),B'00100000'                            0389
         BNO   @RF00389                                            0389
*         FLAGMASK(7)='1'B;         /* YES, FORCE LOG MODE   @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000010'                      0390
*       ELSE                                                       0391
*         ;                         /* NO, USAGE OVERFLOW    @Y30LB55*/
@RF00389 DS    0H                                                  0392
*     END;                          /* END BUFFERED LOG CODE @Y30LB55*/
*   ELSE                            /* NO                    @Y30LB55*/
*     IF SUBSTAT5(2)='1'B THEN      /* RECONFIGURE BIT ON    @Y30LB55*/
         B     @RC00386                                            0393
@RF00386 L     @06,SENSEPTR(,SUMWKPTR)                             0393
         TM    SUBSTAT5(@06),B'01000000'                           0393
         BNO   @RF00393                                            0393
*       FLAGMASK(6)='1'B;           /* YES, SET RECONFIGURE  @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000100'                      0394
*     ELSE                          /* NO, CHECK ENVIRONMENTAL DATA
*                                                            @Y30LB55*/
*       IF SUBSTAT4(8)='1'B THEN    /* ENVIRONMENTAL DATA    @Y30LB55*/
         B     @RC00393                                            0395
@RF00393 L     @06,SENSEPTR(,SUMWKPTR)                             0395
         TM    SUBSTAT4(@06),B'00000001'                           0395
         BNO   @RF00395                                            0395
*         FLAGMASK(7)='1'B;         /* YES, SET FORCE LOG MODE     0396
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000010'                      0396
*       ELSE                                                       0397
*         ;                         /* NO, NORMAL SENSE      @Y30LB55*/
@RF00395 DS    0H                                                  0398
*   END SUMFMT3;                    /* RETURN TO MAIN LINE CODE    0398
*                                                            @Y30LB55*/
@EL00009 DS    0H                                                  0398
@EF00009 DS    0H                                                  0398
@ER00009 L     @14,12(,@13)                                        0398
         BR    @14                                                 0398
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT4 - MSC FORMAT 4 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*SUMFMT4:                                                          0399
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 4  @Y30LB55*/
SUMFMT4  ST    @14,12(,@13)                                        0399
*   FORMATNC='4';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'4'                             0400
*   CNTF4=CNTF4+1;                  /* ADD 1 TO FMT4 COUNT   @Y30LB55*/
         LA    @06,1                                               0401
         AL    @06,CNTF4(,SUMWKPTR)                                0401
         ST    @06,CNTF4(,SUMWKPTR)                                0401
*   I=SUBFMTMG;                     /* SUBFMT                @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0402
         SLR   I,I                                                 0402
         IC    I,SUBFMTMG(,@06)                                    0402
*   SUBFMASK=I&'F0'X;               /* MASK OFF MSG CODE     @Y30LB55*/
         LA    @06,240                                             0403
         NR    @06,I                                               0403
         STC   @06,SUBFMASK(,SUMWKPTR)                             0403
*   IF SUBFMASK='D0'X THEN          /* SA FORMAT 13          @Y30LB55*/
         CLI   SUBFMASK(SUMWKPTR),X'D0'                            0404
         BNE   @RF00404                                            0404
*     FLAGMASK(8)='1'B;             /* YES, SET BUFFERED LOG BIT   0405
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0405
*   ELSE                            /* CHECK FORMAT 9        @ZM31022*/
*     IF SUBFMTMG>'9B'X&SUBFMTMG<'9F'X THEN /* 9C,9D,9E      @ZM31022*/
         B     @RC00404                                            0406
@RF00404 L     @06,SENSEPTR(,SUMWKPTR)                             0406
         CLI   SUBFMTMG(@06),X'9B'                                 0406
         BNH   @RF00406                                            0406
         CLI   SUBFMTMG(@06),X'9F'                                 0406
         BNL   @RF00406                                            0406
*       FLAGMASK(1)='1'B;           /* CART UNLOAD FAILURE   @ZM31105*/
         OI    FLAGMASK(SUMWKPTR),B'10000000'                      0407
*     ELSE;                         /* NO                    @ZM31022*/
@RF00406 DS    0H                                                  0409
*   END SUMFMT4;                    /* RETURN TO MAIN LINE CODE    0409
*                                                            @Y30LB55*/
@EL00010 DS    0H                                                  0409
@EF00010 DS    0H                                                  0409
@ER00010 L     @14,12(,@13)                                        0409
         BR    @14                                                 0409
*                                                                  0410
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMFMT5 - MSC FORMAT 5 CODE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*SUMFMT5:                                                          0410
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE MSC FMT 5  @Y30LB55*/
SUMFMT5  ST    @14,12(,@13)                                        0410
*   FORMATNC='5';                   /* SET FORMAT NUMBER     @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C'5'                             0411
*   CNTF5=CNTF5+1;                  /* ADD 1 TO FMT5 COUNT   @Y30LB55*/
         LA    @06,1                                               0412
         AL    @06,CNTF5(,SUMWKPTR)                                0412
         ST    @06,CNTF5(,SUMWKPTR)                                0412
*   I=SUBFMTMG;                     /* SUBFMT                @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0413
         SLR   I,I                                                 0413
         IC    I,SUBFMTMG(,@06)                                    0413
*   SUBFMASK=I&'F0'X;               /* MASK OFF MSG CODE     @Y30LB55*/
         LA    @06,240                                             0414
         NR    @06,I                                               0414
         STC   @06,SUBFMASK(,SUMWKPTR)                             0414
*   IF SUBFMASK='60'X THEN          /* DASD BUFFERED LOG     @Y30LB55*/
         CLI   SUBFMASK(SUMWKPTR),X'60'                            0415
         BNE   @RF00415                                            0415
*     FLAGMASK(8)='1'B;             /* YES, SET BUFFERED LOG BIT   0416
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0416
*   ELSE                                                           0417
*     ;                             /* NO                    @Y30LB55*/
@RF00415 DS    0H                                                  0418
*   END SUMFMT5;                    /* RETURN TO MAIN LINE CODE    0418
*                                                            @Y30LB55*/
*                                                                  0418
@EL00011 DS    0H                                                  0418
@EF00011 DS    0H                                                  0418
@ER00011 L     @14,12(,@13)                                        0418
         BR    @14                                                 0418
*   /*****************************************************************/
*   /*                                                               */
*   /* SUMDASD - HOST DASD CODE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*SUMDASD:                                                          0419
*   PROC OPTIONS(SAVE(14));         /* ACCUMULATE HOST DASD  @Y30LB55*/
SUMDASD  ST    @14,12(,@13)                                        0419
*   FORMATNC=' ';                   /* BLANK FORMAT NUMBER   @Y30LB55*/
         MVI   FORMATNC(SUMWKPTR),C' '                             0420
*   CNTFDASD=CNTFDASD+1;            /* ADD 1 TO DASD COUNT   @Y30LB55*/
         LA    @06,1                                               0421
         AL    @06,CNTFDASD(,SUMWKPTR)                             0421
         ST    @06,CNTFDASD(,SUMWKPTR)                             0421
*   I=DASDFMTN;                     /* SUBFORMAT             @Y30LB55*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0422
         SLR   I,I                                                 0422
         IC    I,DASDFMTN(,@06)                                    0422
*   SUBFMASK=I&'F0'X;               /* MASK OFF MSG CODE     @Y30LB55*/
         LA    @06,240                                             0423
         NR    @06,I                                               0423
         STC   @06,SUBFMASK(,SUMWKPTR)                             0423
*   IF INDEVTYP='V' THEN            /* VIRTUAL DASD          @Y30LB55*/
         L     @06,SDA00PTR(,CVTPTR)                               0424
         CLI   INDEVTYP(@06),C'V'                                  0424
         BNE   @RF00424                                            0424
*     FLAGMASK(4)='1'B;             /* YES, SET VIRT BIT     @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00010000'                      0425
*   ELSE                            /* NO, REAL DASD         @Y30LB55*/
*     FLAGMASK(3)='1'B;             /* SET REAL BIT          @Y30LB55*/
         B     @RC00424                                            0426
@RF00424 OI    FLAGMASK(SUMWKPTR),B'00100000'                      0426
*   IF SUBFMASK='60'X THEN          /* DASD BUFFERED LOG     @Y30LB55*/
@RC00424 CLI   SUBFMASK(SUMWKPTR),X'60'                            0427
         BNE   @RF00427                                            0427
*     FLAGMASK(8)='1'B;             /* YES, SET BUFFERED LOG BIT   0428
*                                                            @Y30LB55*/
         OI    FLAGMASK(SUMWKPTR),B'00000001'                      0428
*   ELSE                                                           0429
*     ;                             /* NO                    @Y30LB55*/
@RF00427 DS    0H                                                  0430
*   END SUMDASD;                    /* RETURN TO MAIN LINE CODE    0430
*                                                            @Y30LB55*/
@EL00012 DS    0H                                                  0430
@EF00012 DS    0H                                                  0430
@ER00012 L     @14,12(,@13)                                        0430
         BR    @14                                                 0430
*                                                                  0431
*   /*****************************************************************/
*   /*                                                               */
*   /* GETACCUM                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*GETACCUM:                                                         0431
*   PROC OPTIONS(SAVE(14));         /* GET ACCUMULATOR CODE  @Y30LB55*/
GETACCUM ST    @14,@SA00013                                        0431
*   CORELEN=LENGTH(ISDAGHDR)+SUMACCL;/*                            0432
*                                      = LENGTH OF BLOCK     @Y30LB55*/
         LA    @06,28                                              0432
         SLR   @15,@15                                             0432
         ICM   @15,3,SUMACCL(SUMWKPTR)                             0432
         ALR   @06,@15                                             0432
         STCM  @06,7,CORELEN(CVTPTR)                               0432
*   SPNO=SUMSPNO;                   /* SET SUBPOOL NUMBER    @Y30LB55*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0433
*   RFY                                                            0434
*     R1 RSTD;                      /*                       @Y30LB55*/
*   R1=ADDR(WORKCALL);              /* R1 -> ADDR(WORKPTR)   @Y30LB55*/
         LA    R1,WORKCALL(,CVTPTR)                                0435
*   CALL ISDAGET0;                  /* CALL ISDAGET0 TO DO GETMAIN 0436
*                                                            @Y30LB55*/
         L     @15,@CV00453                                        0436
         BALR  @14,@15                                             0436
*   RFY                                                            0437
*     R15 RSTD;                     /* RESTRICT REG 15       @Y30LB55*/
*   RETCODE=R15;                    /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @Y30LB55*/
         LR    RETCODE,R15                                         0438
*   RFY                                                            0439
*    (R1,                                                          0439
*     R15) UNRSTD;                  /* RELEASE REG 1 AND 15  @Y30LB55*/
*   IF RETCODE=0 THEN                                              0440
         LTR   RETCODE,RETCODE                                     0440
         BNZ   @RF00440                                            0440
*     DO;                           /* GOT SPACE OK          @Y30LB55*/
*       GET0PTR=COREADDR;           /* SET LOCAL PTR TO CORE ADDRESS
*                                                            @Y30LB55*/
         L     @07,COREADDR(,CVTPTR)                               0442
         ST    @07,GET0PTR                                         0442
*       ACCUMCNT=ACCUMCNT+1;        /* INC ACCUM COUNT       @Y30LB55*/
         LA    @15,1                                               0443
         SLR   @14,@14                                             0443
         ICM   @14,3,ACCUMCNT(SUMWKPTR)                            0443
         ALR   @15,@14                                             0443
         STH   @15,ACCUMCNT(,SUMWKPTR)                             0443
*       BLOCKCNT=ACCUMCNT;          /* ADD COUNT TO ISDAGHDR @Y30LB55*/
         STH   @15,BLOCKCNT(,@07)                                  0444
*       BLOCKID='SUM0';             /* ADD MY ID             @Y30LB55*/
         MVC   BLOCKID(4,@07),@CC00957                             0445
*       ACCUMPTR=STARTPTR;          /* SET PTR TO START OF SUMACCUM
*                                                            @Y30LB55*/
         L     @15,STARTPTR(,@07)                                  0446
         ST    @15,ACCUMPTR(,SUMWKPTR)                             0446
*       ACCM0END=ENDPTR;            /* SET PTR TO END OF SUMACCUM  0447
*                                                            @Y30LB55*/
*                                                                  0447
         L     @07,ENDPTR(,@07)                                    0447
         ST    @07,ACCM0END(,SUMWKPTR)                             0447
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE SUMACCUM FROM ISDASUM2 DEFAULT TABLE           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0448
*       COUNTPTR=ACCUMPTR;          /* START OF COUNTERS     @Y30LB55*/
         LR    COUNTPTR,@15                                        0448
*       COUNTEND=ACCM0END;          /* END OF COUNTERS       @Y30LB55*/
         LR    COUNTEND,@07                                        0449
*       DEVIDPTR=SUM2PTR;           /* START OF DEFAULTS     @Y30LB55*/
         L     DEVIDPTR,SUM2PTR(,SUMWKPTR)                         0450
*       DO WHILE(COUNTPTR<COUNTEND);/* LOOP THROUGH ISDASUM2 @Y30LB55*/
         B     @DE00451                                            0451
@DL00451 DS    0H                                                  0452
*         MCADDXXX=DEVIDPTR;        /* SAVE PTR INTO ISDASUM2@Y30LB55*/
         ST    DEVIDPTR,MCADDXXX(,COUNTPTR)                        0452
*         MCOUNTS=''B;              /* ZERO COUNTS           @Y30LB55*/
         XC    MCOUNTS(4,COUNTPTR),MCOUNTS(COUNTPTR)               0453
*         MCMASK=MDMASK;            /* MOVE 3 BYTE MASK      @Y30LB55*/
         MVC   MCMASK(3,COUNTPTR),MDMASK(DEVIDPTR)                 0454
*         MLDTIME='0099999F00000000'X;/* SET LOW DATE TO 99999     0455
*                                                            @Y30LB55*/
         MVC   MLDTIME(8,COUNTPTR),@CB00958                        0455
*         MHDTIME=''B;              /* SET HIGH DATE TO 0    @Y30LB55*/
         XC    MHDTIME(8,COUNTPTR),MHDTIME(COUNTPTR)               0456
*         COUNTPTR=COUNTPTR+LENGTH(MCOUNTER);/*                    0457
*                                      INC COUNTPTR TO NEXT ENTRY  0457
*                                                            @Y30LB55*/
         AH    COUNTPTR,@CH00221                                   0457
*         DEVIDPTR=DEVIDPTR+LENGTH(MDEVIDTB);/*                    0458
*                                      INC ISDASUM2 PTR TO NEXT ENTRY
*                                                            @Y30LB55*/
         AH    DEVIDPTR,@CH01011                                   0458
*       END;                        /* END OF INITIALIZE LOOP@Y30LB55*/
*                                                                  0459
@DE00451 CR    COUNTPTR,COUNTEND                                   0459
         BL    @DL00451                                            0459
*       /*************************************************************/
*       /*                                                           */
*       /* GET CORE FOR MSC REASON CODES    RCODES                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0460
*       CORELEN=RCODELEN;           /* LENGTH OF RCODES      @ZM31074*/
         MVC   CORELEN(3,CVTPTR),@CF00410+1                        0460
*       SPNO=SUMSPNO;               /* GET SUBPOOL NUMBER    @ZM31074*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0461
*       RFY R1 RSTD;                                               0462
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZM31074*/
         LA    R1,WORKCALL(,CVTPTR)                                0463
*       CALL ISDAGET1;              /* GET CORE NO HEADER    @ZM31074*/
         L     @15,@CV00454                                        0464
         BALR  @14,@15                                             0464
*       RFY R15 RSTD;                                              0465
*       RETCODE=R15;                /* SAVE RETURN CODE      @ZM31074*/
         LR    RETCODE,R15                                         0466
*       RFY (R1,R15) UNRSTD;                                       0467
*       IF RETCODE=0 THEN           /* GOT CORE OK           @ZM31074*/
         LTR   RETCODE,RETCODE                                     0468
         BNZ   @RF00468                                            0468
*         DO;                       /* YES, INITIALIZE RCODES@ZM31074*/
*           RCODEPTR=COREADDR;      /* SAVE ADDR OF RCODES   @ZM31074*/
         MVC   RCODEPTR(4,SUMWKPTR),COREADDR(CVTPTR)               0470
*           DO I=1 TO 256;          /* SET EACH COUNT ZERO   @ZM31074*/
         LA    I,1                                                 0471
@DL00471 DS    0H                                                  0472
*             RCODES(I)=''B;        /* ZERO COUNT            @ZM31074*/
         LR    @06,I                                               0472
         ALR   @06,@06                                             0472
         L     @05,RCODEPTR(,SUMWKPTR)                             0472
         SLR   @15,@15                                             0472
         BCTR  @05,0                                               0472
         BCTR  @05,0                                               0472
         STH   @15,RCODES(@06,@05)                                 0472
*           END;                    /* END ZERO LOOP         @ZM31074*/
         AH    I,@CH00083                                          0473
         CH    I,@CH00408                                          0473
         BNH   @DL00471                                            0473
*         END;                      /* END INITIALIZE CODE   @ZM31074*/
*       ELSE;                       /* NO CORE AVAILABLE     @ZM31074*/
@RF00468 DS    0H                                                  0476
*     END;                          /* END INIT ACCUMULATOR  @ZM02889*/
*   ELSE                                                           0477
*     ;                             /* NO SPACE AVAILABLE    @Y30LB55*/
*                                                                  0477
@RF00440 DS    0H                                                  0478
*   /*****************************************************************/
*   /*                                                               */
*   /* GET CORE FOR SEVERITY TABLE - SEVRLIST                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0478
*   IF RETCODE=0 THEN               /* NO ERRORS             @ZA20267*/
         LTR   RETCODE,RETCODE                                     0478
         BNZ   @RF00478                                            0478
*     DO;                           /* GET SEVERITY TABLE    @ZA20267*/
*       SEVRLCNT=16;                /* NUMBER OF ENTRIES     @ZA20267*/
         LA    @06,16                                              0480
         ST    @06,SEVRLCNT(,SUMWKPTR)                             0480
*       CORELEN=SEVRLCNT*LENGTH(SEVRLIST); /* LENGTH         @ZA20267*/
         MH    @06,@CH01012                                        0481
         STCM  @06,7,CORELEN(CVTPTR)                               0481
*       SPNO=SUMSPNO;               /* SUBPOOL               @ZA20267*/
         MVC   SPNO(1,CVTPTR),SUMSPNO                              0482
*       RFY                                                        0483
*         R1 RSTD;                  /*                       @ZA20267*/
*       R1=ADDR(WORKCALL);          /* R1 -> ADDR(WORKPTR)   @ZA20267*/
         LA    R1,WORKCALL(,CVTPTR)                                0484
*       CALL ISDAGET0;              /* CALL ISDAGET0 TO DO GETMAIN 0485
*                                                            @ZA20267*/
         L     @15,@CV00453                                        0485
         BALR  @14,@15                                             0485
*       RFY                                                        0486
*         R15 RSTD;                 /* RESTRICT REG 15       @ZA20267*/
*       RETCODE=R15;                /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @ZA20267*/
         LR    RETCODE,R15                                         0487
*       RFY                                                        0488
*        (R1,                                                      0488
*         R15) UNRSTD;              /* RELEASE REG 1 AND 15  @ZA20267*/
*       IF RETCODE=0 THEN           /* GOT CORE OK           @ZA20267*/
         LTR   RETCODE,RETCODE                                     0489
         BNZ   @RF00489                                            0489
*         DO;                       /* INITIALIZE SEVRLIST   @ZA20267*/
*           SEVRLEN=SPNOLEN;        /* SAVE LENGTH           @ZA20267*/
         MVC   SEVRLEN(4,SUMWKPTR),SPNOLEN(CVTPTR)                 0491
*           SEVSTART=COREADDR;      /* SAVE ADDRESS          @ZA20267*/
         L     @15,COREADDR(,CVTPTR)                               0492
         ST    @15,SEVSTART(,SUMWKPTR)                             0492
*           SEVRPTR=SEVSTART;       /* POINT TO START        @ZA20267*/
         LR    SEVRPTR,@15                                         0493
*           DO I=1 TO SEVRLCNT;     /* LOOP THROUGH LIST     @ZA20267*/
         LA    I,1                                                 0494
         B     @DE00494                                            0494
@DL00494 DS    0H                                                  0495
*             SEVRLIST=''B;         /* ZERO THIS ENTRY       @ZA20267*/
         XC    SEVRLIST(168,SEVRPTR),SEVRLIST(SEVRPTR)             0495
*             SEVRPTR=SEVRPTR+LENGTH(SEVRLIST); /* GET NEXT  @ZA20267*/
         AL    SEVRPTR,@CF01012                                    0496
*           END;                    /* END LOOP              @ZA20267*/
         AH    I,@CH00083                                          0497
@DE00494 CL    I,SEVRLCNT(,SUMWKPTR)                               0497
         BNH   @DL00494                                            0497
*         END;                      /* END INITIALIZE        @ZA20267*/
*       ELSE;                       /* BAD RETURN FROM GET1  @ZA20267*/
@RF00489 DS    0H                                                  0500
*     END;                          /* END GET SEVRLIST CORE @ZA20267*/
*   ELSE;                           /* NO CORE AVAILABLE     @ZA20267*/
@RF00478 DS    0H                                                  0502
*   END GETACCUM;                   /* END GET ACCUMULATOR   @Y30LB55*/
@EL00013 DS    0H                                                  0502
@EF00013 DS    0H                                                  0502
@ER00013 L     @14,@SA00013                                        0502
         BR    @14                                                 0502
*                                                                  0503
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATEAC - PROC TO UPDATE COUNTERS WITH HIGH-LOW DATE AND TIME*/
*   /* AND COUNTS                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*UPDATEAC:                                                         0503
*   PROC OPTIONS(SAVE(14));         /* UPDATE COUNTERS       @Y30LB55*/
UPDATEAC ST    @14,@SA00014                                        0503
*   RETCODE=8;                      /* SET NOT FOUND         @Y30LB55*/
         LA    RETCODE,8                                           0504
*   COUNTPTR=ACCUMPTR;              /* SET PTR TO START OF SUMACCUM
*                                                            @Y30LB55*/
         L     COUNTPTR,ACCUMPTR(,SUMWKPTR)                        0505
*   COUNTEND=ACCM0END;              /* SET PTR TO END OF SUMACCUM  0506
*                                                            @Y30LB55*/
         L     COUNTEND,ACCM0END(,SUMWKPTR)                        0506
*   DO WHILE(COUNTPTR<COUNTEND);    /* LOOP THROUGH SUMACCUM @Y30LB55*/
         B     @DE00507                                            0507
@DL00507 DS    0H                                                  0508
*     IF MAINMASK=MCMASK THEN       /* FOUND MASK MATCH      @Y30LB55*/
         CLC   MAINMASK(3,SUMWKPTR),MCMASK(COUNTPTR)               0508
         BNE   @RF00508                                            0508
*       DO;                         /* YES, UPDATE COUNTERS  @Y30LB55*/
*         RETCODE=0;                /* RESET RETURN CODE TO 0@Y30LB55*/
         SLR   RETCODE,RETCODE                                     0510
*         IF DATETIME<MLDTIME THEN  /* IS THIS DATE LOW      @Y30LB55*/
         L     @06,LOGPTR(,SUMWKPTR)                               0511
         CLC   DATETIME(8,@06),MLDTIME(COUNTPTR)                   0511
         BNL   @RF00511                                            0511
*           MLDTIME=DATETIME;       /* YES, MOVE DATE        @Y30LB55*/
         MVC   MLDTIME(8,COUNTPTR),DATETIME(@06)                   0512
*         ELSE                                                     0513
*           ;                       /* NO, DATE OK           @Y30LB55*/
@RF00511 DS    0H                                                  0514
*         IF DATETIME>MHDTIME THEN  /* IS THIS DATE HIGH     @Y30LB55*/
         L     @06,LOGPTR(,SUMWKPTR)                               0514
         CLC   DATETIME(8,@06),MHDTIME(COUNTPTR)                   0514
         BNH   @RF00514                                            0514
*           MHDTIME=DATETIME;       /* YES, MOVE DATE        @Y30LB55*/
         MVC   MHDTIME(8,COUNTPTR),DATETIME(@06)                   0515
*         ELSE                                                     0516
*           ;                       /* NO, DATE OK           @Y30LB55*/
@RF00514 DS    0H                                                  0517
*         IF MCFLAG(8)='1'B THEN    /* BUFFERED LOG RECORD   @Y30LB55*/
         TM    MCFLAG(COUNTPTR),B'00000001'                        0517
         BNO   @RF00517                                            0517
*           DO;                     /* YES                   @Y30LB55*/
*             CNTLOG=CNTLOG+1;      /* INC LOG COUNT BY 1    @Y30LB55*/
         LA    @06,1                                               0519
         L     @15,CNTLOG(,SUMWKPTR)                               0519
         ALR   @15,@06                                             0519
         ST    @15,CNTLOG(,SUMWKPTR)                               0519
*             IF IRECTYPE='O' THEN  /* IS IT OBR             @Y30LB55*/
         L     @01,SDA00PTR(,CVTPTR)                               0520
         CLI   IRECTYPE(@01),C'O'                                  0520
         BNE   @RF00520                                            0520
*               MCPXXX=MCPXXX+1;    /* YES, INC OBR COUNT    @Y30LB55*/
         SLR   @15,@15                                             0521
         ICM   @15,3,MCPXXX(COUNTPTR)                              0521
         ALR   @06,@15                                             0521
         STH   @06,MCPXXX(,COUNTPTR)                               0521
*             ELSE                  /* NO, MUST BE MDR       @Y30LB55*/
*               MCTXXX=MCTXXX+1;    /* INC MDR COUNT         @Y30LB55*/
         B     @RC00520                                            0522
@RF00520 LA    @06,1                                               0522
         SLR   @15,@15                                             0522
         ICM   @15,3,MCTXXX(COUNTPTR)                              0522
         ALR   @06,@15                                             0522
         STH   @06,MCTXXX(,COUNTPTR)                               0522
*           END;                    /* END BUFFERED LOG CODE @Y30LB55*/
*         ELSE                      /* SENSE DATA RECORD     @Y30LB55*/
*           DO;                     /* YES                   @Y30LB55*/
         B     @RC00517                                            0524
@RF00517 DS    0H                                                  0525
*             CNTSENSE=CNTSENSE+1;  /* INC SENSE COUNT BY 1  @Y30LB55*/
         LA    @06,1                                               0525
         AL    @06,CNTSENSE(,SUMWKPTR)                             0525
         ST    @06,CNTSENSE(,SUMWKPTR)                             0525
*             CALL TPCHECK;         /* SET PERM OR TEMP      @ZA20267*/
         BAL   @14,TPCHECK                                         0526
*             IF TPTFLAG='00'X THEN /* TEMP ERROR            @ZA20267*/
         CLI   TPTFLAG(SUMWKPTR),X'00'                             0527
         BNE   @RF00527                                            0527
*               MCTXXX=MCTXXX+1;    /* YES, ADD 1 TO TEMP    @ZA20267*/
         LA    @06,1                                               0528
         SLR   @15,@15                                             0528
         ICM   @15,3,MCTXXX(COUNTPTR)                              0528
         ALR   @06,@15                                             0528
         STH   @06,MCTXXX(,COUNTPTR)                               0528
*             ELSE                  /* NO, PERM ERROR        @ZA20267*/
*               MCPXXX=MCPXXX+1;    /* ADD 1 TO PERM COUNT   @ZA20267*/
         B     @RC00527                                            0529
@RF00527 LA    @06,1                                               0529
         SLR   @15,@15                                             0529
         ICM   @15,3,MCPXXX(COUNTPTR)                              0529
         ALR   @06,@15                                             0529
         STH   @06,MCPXXX(,COUNTPTR)                               0529
*           END;                    /* END SENSE DATA CODE   @Y30LB55*/
@RC00527 DS    0H                                                  0531
*         COUNTPTR=COUNTEND;        /* SET PTR TO END OF SUMACCUM TO
*                                      STOP LOOP             @Y30LB55*/
@RC00517 LR    COUNTPTR,COUNTEND                                   0531
*       END;                        /* END OF COUNTER UPDATE @Y30LB55*/
*     ELSE                          /* NO MATCH YET          @Y30LB55*/
*       COUNTPTR=COUNTPTR+LENGTH(MCOUNTER);/*                      0533
*                                      INC POINTER INTO SUMACCUM   0533
*                                                            @Y30LB55*/
         B     @RC00508                                            0533
@RF00508 AH    COUNTPTR,@CH00221                                   0533
*   END;                            /* END OF UPDATE LOOP    @Y30LB55*/
@RC00508 DS    0H                                                  0534
@DE00507 CR    COUNTPTR,COUNTEND                                   0534
         BL    @DL00507                                            0534
*   END UPDATEAC;                   /* END UPDATE COUNTERS PROC    0535
*                                                            @Y30LB55*/
@EL00014 DS    0H                                                  0535
@EF00014 DS    0H                                                  0535
@ER00014 L     @14,@SA00014                                        0535
         BR    @14                                                 0535
*                                                                  0536
*   /*****************************************************************/
*   /*                                                               */
*   /* TPCHECK - PROC TO DETERMIN IF ERROR IS TEMPORARY OR PERMANENT */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0536
*TPCHECK:                                                          0536
*   PROC OPTIONS(SAVE(14));         /* PERM OR TEMP ERROR    @ZA20267*/
TPCHECK  ST    @14,12(,@13)                                        0536
*   IF INDEVTYP='S' THEN            /* MSS RECORD            @ZA20267*/
         L     @06,SDA00PTR(,CVTPTR)                               0537
         CLI   INDEVTYP(@06),C'S'                                  0537
         BNE   @RF00537                                            0537
*     IF STATUS(8)='0'BSSIDFLAG(1:2)^='00'BFORMATNO(7)='1'B      0538
*     THEN                          /* ADD CEM AND SUU CHECK @ZA20267*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0538
         TM    STATUS(@06),B'00000001'                             0538
         BZ    @RT00538                                            0538
         TM    SSIDFLAG(@06),B'11000000'                           0538
         BNZ   @RT00538                                            0538
         TM    FORMATNO(@06),B'00000010'                           0538
         BNO   @RF00538                                            0538
@RT00538 DS    0H                                                  0539
*                                   /* MSC ENVIRONMENTAL BIT OFF OR
*                                      CE MESSAGE OR SUU BIT ON OR 0539
*                                      UNSECCESSFUL RETRY BIT ON   0539
*                                      FOR ALL FORMATS       @ZA20267*/
*       TPTFLAG='01'X;              /* YES, SET PERM ERROR   @ZA20267*/
         MVI   TPTFLAG(SUMWKPTR),X'01'                             0539
*     ELSE                          /* CHECK LOWER STATUS    @ZA20267*/
*       IF FORMATNO(4:5)^='00'B&SUBSTAT4(8)='0'B THEN              0540
         B     @RC00538                                            0540
@RF00538 L     @06,SENSEPTR(,SUMWKPTR)                             0540
         TM    FORMATNO(@06),B'00011000'                           0540
         BZ    @RF00540                                            0540
         TM    SUBSTAT4(@06),B'00000001'                           0540
         BNZ   @RF00540                                            0540
*                                   /* FORMAT 3 OR 4  BYTE 4 BIT 7 0541
*                                      ENVIRONMENTAL DATA BIT OFF  0541
*                                                            @ZA20267*/
*         TPTFLAG='01'X;             /*YES, SET PERM ERROR   @ZA20267*/
         MVI   TPTFLAG(SUMWKPTR),X'01'                             0541
*       ELSE                        /* CHECK FORMAT 5 STATUS @ZA20267*/
*         IF FORMATNO(6)='1'B&SALOWADD(4)='0'B THEN                0542
         B     @RC00540                                            0542
@RF00540 L     @06,SENSEPTR(,SUMWKPTR)                             0542
         TM    FORMATNO(@06),B'00000100'                           0542
         BNO   @RF00542                                            0542
         TM    SALOWADD(@06),B'00010000'                           0542
         BNZ   @RF00542                                            0542
*                                   /* FORMAT 5  BYTE 6 BIT 3      0543
*                                      ENVIRONMENTAL DATA BIT      0543
*                                      OFF                   @ZA20267*/
*           TPTFLAG='01'X;          /* YES, SET PERM ERROR   @ZA20267*/
         MVI   TPTFLAG(SUMWKPTR),X'01'                             0543
*         ELSE                      /* NOT PERMANENT ERROR   @ZA20267*/
*           TPTFLAG='00'X;          /* SET TEMP ERROR        @ZA20267*/
         B     @RC00542                                            0544
@RF00542 MVI   TPTFLAG(SUMWKPTR),X'00'                             0544
*   ELSE                            /* 3330 RECORD           @ZA20267*/
*     IF SSIDLIBN(4)='1'B THEN      /* CHECK BYTE 2 BIT 3          0545
*                                      IS ENVIRONMENTAL BIT ON     0545
*                                                            @ZA20267*/
         B     @RC00537                                            0545
@RF00537 L     @06,SENSEPTR(,SUMWKPTR)                             0545
         TM    SSIDLIBN(@06),B'00010000'                           0545
         BNO   @RF00545                                            0545
*       TPTFLAG='00'X;              /* YES, SET TEMP ERROR   @ZA20267*/
         MVI   TPTFLAG(SUMWKPTR),X'00'                             0546
*     ELSE                          /* NO, PERM ERROR        @ZA20267*/
*       TPTFLAG='01'X;              /* SET PERM ERROR        @ZA20267*/
         B     @RC00545                                            0547
@RF00545 MVI   TPTFLAG(SUMWKPTR),X'01'                             0547
*   END TPCHECK;                    /* END PROC              @ZA20267*/
@EL00015 DS    0H                                                  0548
@EF00015 DS    0H                                                  0548
@ER00015 L     @14,12(,@13)                                        0548
         BR    @14                                                 0548
*                                                                  0549
*   /*****************************************************************/
*   /*                                                               */
*   /* SEVERITY - PROC TO BUILD THE SEVERITY LIST - SEVRLIST         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0549
*SEVERITY:                                                         0549
*   PROC OPTIONS(SAVE(14));         /* BUILD SEVERITY LIST   @ZA20267*/
SEVERITY ST    @14,@SA00016                                        0549
*   TSEVTEMP=''B;                   /* ZERO TEMPS            @ZA20267*/
         XC    TSEVTEMP(9,SUMWKPTR),TSEVTEMP(SUMWKPTR)             0550
*   TSEVFMT=FORMATCK;               /* FORMAT                @ZA20267*/
         MVC   TSEVFMT(1,SUMWKPTR),FORMATCK(SUMWKPTR)              0551
*   IF FORMATCK(1)='1'B THEN        /* FORMAT 0              @ZA20267*/
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0552
         BNO   @RF00552                                            0552
*     TSEVSUBF=SUBFMTMG;            /* SUBFORMAT + MSG CODE  @ZA20267*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0553
         MVC   TSEVSUBF(1,SUMWKPTR),SUBFMTMG(@01)                  0553
*   ELSE                            /* NOT 0                 @ZA20267*/
*     IF FORMATCK(4)='1'B&FLAGMASK(8)='1'B THEN /* 3 BUF LOG @ZA20267*/
         B     @RC00552                                            0554
@RF00552 TM    FORMATCK(SUMWKPTR),B'00010000'                      0554
         BNO   @RF00554                                            0554
         TM    FLAGMASK(SUMWKPTR),B'00000001'                      0554
         BNO   @RF00554                                            0554
*       TSEVSUBF='01'X;             /* FORCE SUBFORMAT 1     @ZA20267*/
         MVI   TSEVSUBF(SUMWKPTR),X'01'                            0555
*     ELSE                          /* NOT 3                 @ZA20267*/
*       IF FORMATCK(5)='1'B THEN    /* FORMAT 4              @ZA20267*/
         B     @RC00554                                            0556
@RF00554 TM    FORMATCK(SUMWKPTR),B'00001000'                      0556
         BNO   @RF00556                                            0556
*         IF SUBFMASK='90'XSUBFMASK='B0'X THEN /* 9 OR B    @ZA20267*/
         CLI   SUBFMASK(SUMWKPTR),X'90'                            0557
         BE    @RT00557                                            0557
         CLI   SUBFMASK(SUMWKPTR),X'B0'                            0557
         BNE   @RF00557                                            0557
@RT00557 DS    0H                                                  0558
*           TSEVSUBF=SUBFMTMG;      /* SUBFMT AND MSG CODE   @ZA20267*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0558
         MVC   TSEVSUBF(1,SUMWKPTR),SUBFMTMG(@01)                  0558
*         ELSE                      /* NOT 9 OR B            @ZA20267*/
*           TSEVSUBF=SUBFMASK;      /* SUBFORMAT ONLY        @ZA20267*/
         B     @RC00557                                            0559
@RF00557 MVC   TSEVSUBF(1,SUMWKPTR),SUBFMASK(SUMWKPTR)             0559
*       ELSE                        /* NOT 4                 @ZA20267*/
*         IF FORMATCK(6)='1'B THEN  /* FORMAT 5              @ZA20267*/
         B     @RC00556                                            0560
@RF00556 TM    FORMATCK(SUMWKPTR),B'00000100'                      0560
         BNO   @RF00560                                            0560
*           TSEVSUBF=SUBFMASK;      /* SUBFORMAT ONLY        @ZA20267*/
         MVC   TSEVSUBF(1,SUMWKPTR),SUBFMASK(SUMWKPTR)             0561
*         ELSE;                     /* NO SUBFORMAT          @ZA20267*/
@RF00560 DS    0H                                                  0563
*   TSEVMASK=FLAGMASK;              /* MOVE TYPE MASK        @ZA20267*/
*                                                                  0563
@RC00556 DS    0H                                                  0563
@RC00554 DS    0H                                                  0563
@RC00552 MVC   TSEVMASK(1,SUMWKPTR),FLAGMASK(SUMWKPTR)             0563
*   /*****************************************************************/
*   /*                                                               */
*   /* GET SSID, TERMCODE, PERM OR TEMP, AND SEVERITY CODE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*   IF INDEVTYP='S' THEN            /* SUBSYSTEM RECORD      @ZA20267*/
         L     @15,SDA00PTR(,CVTPTR)                               0564
         CLI   INDEVTYP(@15),C'S'                                  0564
         BNE   @RF00564                                            0564
*     IF SSID='FFF'X THEN           /* NO SSID               @ZA20267*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0565
         MVC   @TS00001(2),SSID(@01)                               0565
         NC    @TS00001(2),@CB01022                                0565
         CLC   @TS00001(2),@CB01022                                0565
         BNE   @RF00565                                            0565
*       TSSID=INRECCUA;             /* YES, MOVE RUA         @ZA20267*/
         MVC   TSSID(2,SUMWKPTR),INRECCUA(@15)                     0566
*     ELSE                          /* HAVE SSID */                0567
*       TSSID=SUBSYSID&'0FFF'X;     /* MOVE SSID             @ZA20267*/
         B     @RC00565                                            0567
@RF00565 L     @01,SENSEPTR(,SUMWKPTR)                             0567
         MVC   TSSID(2,SUMWKPTR),SUBSYSID(@01)                     0567
         NC    TSSID(2,SUMWKPTR),@CB00973                          0567
*   ELSE                            /* VIRTUAL DASD          @ZA20267*/
*     TSSID=MSCFSC&'00FF'X;         /* MOVE SSID BYTE 27     @ZA20267*/
         B     @RC00564                                            0568
@RF00564 L     @01,SENSEPTR(,SUMWKPTR)                             0568
         MVC   TSSID(2,SUMWKPTR),MSCFSC(@01)                       0568
         NC    TSSID(2,SUMWKPTR),@CB00974                          0568
*   IF FORMATCK(1)='1'B THEN        /* FORMAT 0              @ZA20267*/
@RC00564 TM    FORMATCK(SUMWKPTR),B'10000000'                      0569
         BNO   @RF00569                                            0569
*     TSEVECOD=ISDAMSCS(13);        /* SAVE BYTE 12          @ZA20267*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0570
         MVC   TSEVECOD(1,SUMWKPTR),ISDAMSCS+12(@01)               0570
*   ELSE                            /* NOT 0                 @ZA20267*/
*     IF FORMATCK(5)='1'B THEN      /* FORMAT 4              @ZA20267*/
         B     @RC00569                                            0571
@RF00569 TM    FORMATCK(SUMWKPTR),B'00001000'                      0571
         BNO   @RF00571                                            0571
*       IF SUBFMTMG='9F'XSUBFMTMG='BF'X THEN /* 9F OR BF    @ZA20267*/
         L     @15,SENSEPTR(,SUMWKPTR)                             0572
         CLI   SUBFMTMG(@15),X'9F'                                 0572
         BE    @RT00572                                            0572
         CLI   SUBFMTMG(@15),X'BF'                                 0572
         BNE   @RF00572                                            0572
@RT00572 DS    0H                                                  0573
*         TSEVSUBF=ISDAMSCS(28);    /* YES, MOVE BYTE 27     @ZA20267*/
         L     @01,SENSEPTR(,SUMWKPTR)                             0573
         MVC   TSEVSUBF(1,SUMWKPTR),ISDAMSCS+27(@01)               0573
*       ELSE;                       /* NOT 9F OR BF          @ZA20267*/
@RF00572 DS    0H                                                  0575
*     ELSE;                         /* NOTHING TO SAVE       @ZA20267*/
@RF00571 DS    0H                                                  0576
*   IF FLAGMASK(8)='1'B THEN        /* BUFFERED LOG RECORD   @ZA20267*/
@RC00569 TM    FLAGMASK(SUMWKPTR),B'00000001'                      0576
         BNO   @RF00576                                            0576
*     TPTFLAG='00'X;                /* SET TEMP ERROR        @ZA20267*/
         MVI   TPTFLAG(SUMWKPTR),X'00'                             0577
*   ELSE                            /* SENSE DATA            @ZA20267*/
*     CALL TPCHECK;                 /* SET TEMP-PERM FLAG    @ZA20267*/
         B     @RC00576                                            0578
@RF00576 BAL   @14,TPCHECK                                         0578
*   CALL GETSCODE;                  /* SET SEVERITY CODE     @ZA20267*/
*                                                                  0579
@RC00576 BAL   @14,GETSCODE                                        0579
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE SEVERITY LIST - SEVRLIST                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0580
*   IF RETCODE=0 THEN               /* FOUND SEVERITY CODE   @ZA20267*/
         LTR   RETCODE,RETCODE                                     0580
         BNZ   @RF00580                                            0580
*     DO;                           /* YES, PROCESS IT       @ZA20267*/
*       SEVRPTR=SEVSTART;           /* SET TO START OF TABLE @ZA20267*/
         L     SEVRPTR,SEVSTART(,SUMWKPTR)                         0582
*       MINSEVCD=SEVRCODE;          /* INITIALIZE MIN CODE   @ZA20267*/
         MVC   MINSEVCD(2),SEVRCODE(SEVRPTR)                       0583
*       MINCDPTR=SEVRPTR;           /* INITIALIZE MIN PTR    @ZA20267*/
         ST    SEVRPTR,MINCDPTR                                    0584
*       J=0;                        /* SET LOOP FLAG         @ZA20267*/
         SLR   J,J                                                 0585
*       DO I=1 TO SEVRLCNT WHILE(J=0);  /* LOOP SEVRLIST     @ZA20267*/
         LA    I,1                                                 0586
         B     @DE00586                                            0586
@DL00586 LTR   J,J                                                 0586
         BNZ   @DC00586                                            0586
*         IF SEVRCNT=0 THEN         /* ADD NEW ENTRY         @ZA20267*/
         ICM   @15,3,SEVRCNT(SEVRPTR)                              0587
         BNZ   @RF00587                                            0587
*           DO;                     /* YES, ADD IT           @ZA20267*/
*             J=1;                  /* GET OUT OF LOOP       @ZA20267*/
         LA    @15,1                                               0589
         LR    J,@15                                               0589
*             SEVRCNT=1;            /* SET COUNT TO 1        @ZA20267*/
         STH   @15,SEVRCNT(,SEVRPTR)                               0590
*             CALL SEVFILL;         /* MOVE DATA             @ZA20267*/
         BAL   @14,SEVFILL                                         0591
*           END;                    /* END ADD NEW ENTRY     @ZA20267*/
*         ELSE                      /* LOOK FOR DUPLICATE    @ZA20267*/
*           IF TSEVCDID=SEVCDSID THEN /* DUPLICATE RECORD    @ZA20267*/
         B     @RC00587                                            0593
@RF00587 CLC   TSEVCDID(4,SUMWKPTR),SEVCDSID(SEVRPTR)              0593
         BNE   @RF00593                                            0593
*             DO;                   /* YES, CHECK IT         @ZA20267*/
*               J=1;                /* GET OUT OF LOOP       @ZA20267*/
         LA    @15,1                                               0595
         LR    J,@15                                               0595
*               SEVRCNT=SEVRCNT+1;  /* ADD 1 TO COUNT        @ZA20267*/
         SLR   @14,@14                                             0596
         ICM   @14,3,SEVRCNT(SEVRPTR)                              0596
         ALR   @15,@14                                             0596
         STH   @15,SEVRCNT(,SEVRPTR)                               0596
*               IF DATETIME>=SEVDATET THEN /* LATER DATE     @ZA20267*/
         L     @01,LOGPTR(,SUMWKPTR)                               0597
         CLC   DATETIME(8,@01),SEVDATET(SEVRPTR)                   0597
         BL    @RF00597                                            0597
*                 CALL SEVFILL;     /* YES, REPLACE DATA     @ZA20267*/
         BAL   @14,SEVFILL                                         0598
*               ELSE;               /* NO, KEEP OLD ENTRY    @ZA20267*/
@RF00597 DS    0H                                                  0600
*             END;                  /* END FOUND DUPLICATE   @ZA20267*/
*           ELSE                    /* NO MATCH, TABLE FULL  @ZA20267*/
*             IF MINSEVCD>=SEVRCODE THEN /* LESSER CODE      @ZA20267*/
         B     @RC00593                                            0601
@RF00593 CLC   MINSEVCD(2),SEVRCODE(SEVRPTR)                       0601
         BL    @RF00601                                            0601
*               DO;                 /* YES, SAVE NEW MIN     @ZA20267*/
*                 MINSEVCD=SEVRCODE;/* SAVE SEVERITY CODE    @ZA20267*/
         MVC   MINSEVCD(2),SEVRCODE(SEVRPTR)                       0603
*                 MINCDPTR=SEVRPTR; /* SAVE ADDRESS          @ZA20267*/
         ST    SEVRPTR,MINCDPTR                                    0604
*               END;                /* END SAVE NEW MIN      @ZA20267*/
*             ELSE;                 /* CURRENT MIN IS OK     @ZA20267*/
@RF00601 DS    0H                                                  0607
*         SEVRPTR=SEVRPTR+LENGTH(SEVRLIST); /* GET NEXT      @ZA20267*/
@RC00593 DS    0H                                                  0607
@RC00587 AL    SEVRPTR,@CF01012                                    0607
*       END;                        /* END LOOP SEVRLIST     @ZA20267*/
         AH    I,@CH00083                                          0608
@DE00586 CL    I,SEVRLCNT(,SUMWKPTR)                               0608
         BNH   @DL00586                                            0608
@DC00586 DS    0H                                                  0609
*       IF J=0 THEN                 /* NO MATCH, TABLE FULL  @ZA20267*/
         LTR   J,J                                                 0609
         BNZ   @RF00609                                            0609
*         IF TSEVCODE>=MINSEVCD THEN/* GREATER THAN MIN CODE @ZA20267*/
         CLC   TSEVCODE(2,SUMWKPTR),MINSEVCD                       0610
         BL    @RF00610                                            0610
*           DO;                     /* YES, REPLACE MIN      @ZA20267*/
*             SEVRPTR=MINCDPTR;     /* ADDR OF MIN ENTRY     @ZA20267*/
         L     SEVRPTR,MINCDPTR                                    0612
*             SEVRCNT=1;            /* RESET COUNT TO 1      @ZA20267*/
         MVC   SEVRCNT(2,SEVRPTR),@CH00083                         0613
*             CALL SEVFILL;         /* MOVE DATA             @ZA20267*/
         BAL   @14,SEVFILL                                         0614
*           END;                    /* END REPLACE MIN       @ZA20267*/
*         ELSE;                     /* DO NOT USE THIS DATA  @ZA20267*/
@RF00610 DS    0H                                                  0617
*       ELSE;                       /* RECORD PUT IN TABLE   @ZA20267*/
@RF00609 DS    0H                                                  0618
*     END;                          /* END PROCESS RECORD    @ZA20267*/
*                                                                  0618
*   /*****************************************************************/
*   /*                                                               */
*   /* RECORD NOT FOUND IN THE SEVERITY TABLE - SEVTABG              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*   ELSE                            /* REJECTED BY GETSCODE  @ZA20267*/
*     DO;                           /* DEBUG                 @ZA20267*/
         B     @RC00580                                            0619
@RF00580 DS    0H                                                  0620
*       IF RETCODE=8 THEN           /* NOT FOUND IN TABLES   @ZA20267*/
         CH    RETCODE,@CH00071                                    0620
         BNE   @RF00620                                            0620
*         DO;                       /* DEBUG                 @ZA20267*/
*           LINE='NO SEVERITY CODE COULD BE FOUND FOR THIS RECORD';
         MVI   LINE+47(CVTPTR),C' '                                0622
         MVC   LINE+48(84,CVTPTR),LINE+47(CVTPTR)                  0622
         MVC   LINE(47,CVTPTR),@CC00978                            0622
*           DUMPADDR=SDATAPTR;                                     0623
         MVC   DUMPADDR(4,CVTPTR),SDATAPTR(CVTPTR)                 0623
*           DUMPLEN=DLENGTH;                                       0624
         L     @15,SDA00PTR(,CVTPTR)                               0624
         LH    @14,DLENGTH(,@15)                                   0624
         ST    @14,DUMPLEN(,CVTPTR)                                0624
*           DUMPIDNO=NINREC;                                       0625
         MVC   DUMPIDNO(4,CVTPTR),NINREC(@15)                      0625
*           RFY                                                    0626
*             R1 RSTD;              /*                       @ZA20267*/
*           R1=ADDR(WORKCALL);      /* R1 -> ADDR(WORKPTR)   @ZA20267*/
         LA    R1,WORKCALL(,CVTPTR)                                0627
*           CALL ISDAHEXP;          /* DUMP THIS RECORD              */
         L     @15,@CV00456                                        0628
         BALR  @14,@15                                             0628
*           RFY                                                    0629
*             R1 UNRSTD;            /* RELEASE REG 1         @ZA20267*/
*         END;                                                     0630
*       ELSE;                                                      0631
@RF00620 DS    0H                                                  0632
*       RETCODE=0;                  /* IGNORE THIS RECORD    @ZA20267*/
         SLR   RETCODE,RETCODE                                     0632
*     END;                          /* END RETCODE NOT 0     @ZA20267*/
*   END SEVERITY;                   /* END PROC              @ZA20267*/
@EL00016 DS    0H                                                  0634
@EF00016 DS    0H                                                  0634
@ER00016 L     @14,@SA00016                                        0634
         BR    @14                                                 0634
*                                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* GETSCODE - PROC TO SET THE SEVERITY CODE                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*GETSCODE:                                                         0635
*   PROC OPTIONS(SAVE(14));         /* SET SEVERITY CODE     @ZA20267*/
GETSCODE ST    @14,12(,@13)                                        0635
*   RETCODE=8;                      /* SET NO FOUND FLAG     @ZA20267*/
*                                                                  0636
         LA    RETCODE,8                                           0636
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT 0 MSG CODE 06 AND 0C ONLY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0637
*   IF FORMATCK(1)='1'B THEN        /* FORMAT 0              @ZA20267*/
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0637
         BNO   @RF00637                                            0637
*     IF SUBFMTMG='06'X THEN        /* MESSAGE CODE 06       @ZA20267*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0638
         CLI   SUBFMTMG(@06),X'06'                                 0638
         BNE   @RF00638                                            0638
*       IF TSEVECOD(1:4)='0100'B THEN /* TERM CODE 40-4F     @ZA20267*/
         TM    TSEVECOD(SUMWKPTR),B'01000000'                      0639
         BNO   @RF00639                                            0639
         TM    TSEVECOD(SUMWKPTR),B'10110000'                      0639
         BNZ   @RF00639                                            0639
*         DO;                       /* 40-4F ONLY            @ZA20267*/
*           RETCODE=0;              /* IND FOUND SEVERITY    @ZA20267*/
         SLR   RETCODE,RETCODE                                     0641
*           IF TPTFLAG='00'X THEN   /* TEMP ERROR            @ZA20267*/
         CLI   TPTFLAG(SUMWKPTR),X'00'                             0642
         BNE   @RF00642                                            0642
*             TSEVCODE=101;         /* CODE 101              @ZA20267*/
         MVC   TSEVCODE(2,SUMWKPTR),@CH00529                       0643
*           ELSE                    /* PERM ERROR            @ZA20267*/
*             TSEVCODE=229;         /* CODE 229              @ZA20267*/
         B     @RC00642                                            0644
@RF00642 MVC   TSEVCODE(2,SUMWKPTR),@CH00986                       0644
*         END;                      /* END 40-4F             @ZA20267*/
*       ELSE                        /* NOT 40-4F             @ZA20267*/
*         RETCODE=4;                /* IGNORE THIS RECORD    @ZA20267*/
         B     @RC00639                                            0646
@RF00639 LA    RETCODE,4                                           0646
*     ELSE                          /* NOT MSG CODE 06       @ZA20267*/
*       IF SUBFMTMG='0C'X THEN      /* MESSAGE CODE 0C       @ZA20267*/
         B     @RC00638                                            0647
@RF00638 L     @06,SENSEPTR(,SUMWKPTR)                             0647
         CLI   SUBFMTMG(@06),X'0C'                                 0647
         BNE   @RF00647                                            0647
*         IF TSEVECOD='00'XTSEVECOD='03'X THEN /* 00, 03    @ZA20267*/
         CLI   TSEVECOD(SUMWKPTR),X'00'                            0648
         BE    @RT00648                                            0648
         CLI   TSEVECOD(SUMWKPTR),X'03'                            0648
         BNE   @RF00648                                            0648
@RT00648 DS    0H                                                  0649
*           DO;                     /* YES, TERM 00 OR 03    @ZA20267*/
*             RETCODE=0;            /* IND FOUND SEVERITY    @ZA20267*/
         SLR   RETCODE,RETCODE                                     0650
*             IF TPTFLAG='00'X THEN /* TEMP ERROR            @ZA20267*/
         CLI   TPTFLAG(SUMWKPTR),X'00'                             0651
         BNE   @RF00651                                            0651
*               TSEVCODE=107;       /* CODE 107              @ZA20267*/
         MVC   TSEVCODE(2,SUMWKPTR),@CH00989                       0652
*             ELSE                  /* PERM ERROR            @ZA20267*/
*               TSEVCODE=235;       /* CODE 235              @ZA20267*/
         B     @RC00651                                            0653
@RF00651 MVC   TSEVCODE(2,SUMWKPTR),@CH00990                       0653
*           END;                    /* END 0C 00 OR 03       @ZA20267*/
*         ELSE                      /* NOT 00 OR 03          @ZA20267*/
*             RETCODE=4;            /* IGNORE THIS RECORD    @ZA20267*/
         B     @RC00648                                            0655
@RF00648 LA    RETCODE,4                                           0655
*       ELSE;                       /* NOT MESSAGE CODE 0C   @ZA20267*/
@RF00647 DS    0H                                                  0657
*   ELSE;                           /* NOT FORMAT 0          @ZA20267*/
@RF00637 DS    0H                                                  0658
*   IF RETCODE=8 THEN               /* NOT FOUND YET         @ZA20267*/
*                                                                  0658
@RC00637 CH    RETCODE,@CH00071                                    0658
         BNE   @RF00658                                            0658
*     /***************************************************************/
*     /*                                                             */
*     /*   GENERAL SEARCH FOR ALL OTHER FORMATS USING SEVTABG        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0659
*     DO;                           /* ALL OTHER FORMATS     @ZA20267*/
*       TABPTR=ADDR(SEVTABG);       /* START GENERAL TABLE   @ZA20267*/
         LA    TABPTR,SEVTABG                                      0660
*       J=ADDR(ENDTABG);            /* END GENERAL TABLE     @ZA20267*/
         LA    J,ENDTABG                                           0661
*       DO WHILE(RETCODE=8&TABPTR<=J); /* LOOP SEVTABG       @ZA20267*/
         B     @DE00662                                            0662
@DL00662 DS    0H                                                  0663
*         IF TSEVFMTS=TABHW THEN    /* FORMAT + SUB MATCH    @ZA20267*/
         CLC   TSEVFMTS(2,SUMWKPTR),TABHW(TABPTR)                  0663
         BNE   @RF00663                                            0663
*           DO;                     /* YES, FOUND IT         @ZA20267*/
*             RETCODE=0;            /* IND FOUND SEVERITY    @ZA20267*/
         SLR   RETCODE,RETCODE                                     0665
*             IF TPTFLAG='00'X THEN /* TEMP ERROR            @ZA20267*/
         CLI   TPTFLAG(SUMWKPTR),X'00'                             0666
         BNE   @RF00666                                            0666
*               TSEVCODE=TABLOSEV;  /* USE LOW SEVERITY      @ZA20267*/
         MVC   TSEVCODE(2,SUMWKPTR),TABLOSEV(TABPTR)               0667
*             ELSE                  /* PERM ERROR            @ZA20267*/
*               TSEVCODE=TABHISEV;  /* USE HIGH SEVERITY     @ZA20267*/
         B     @RC00666                                            0668
@RF00666 MVC   TSEVCODE(2,SUMWKPTR),TABHISEV(TABPTR)               0668
*           END;                    /* END FOUND MATCH       @ZA20267*/
*         ELSE;                     /* NO MATCH YET          @ZA20267*/
@RF00663 DS    0H                                                  0671
*         TABPTR=TABPTR+LENGTH(TABGMOD); /* GET NEXT ENTRY   @ZA20267*/
@RC00663 AH    TABPTR,@CH00095                                     0671
*       END;                        /* END LOOP SEVTABG      @ZA20267*/
@DE00662 CH    RETCODE,@CH00071                                    0672
         BNE   @DC00662                                            0672
         CR    TABPTR,J                                            0672
         BNH   @DL00662                                            0672
@DC00662 DS    0H                                                  0673
*     END;                          /* END GENERAL SEARCH    @ZA20267*/
*   ELSE;                           /* NOT RETCODE 8         @ZA20267*/
@RF00658 DS    0H                                                  0675
*   END GETSCODE;                   /* END PROC              @ZA20267*/
@EL00017 DS    0H                                                  0675
@EF00017 DS    0H                                                  0675
@ER00017 L     @14,12(,@13)                                        0675
         BR    @14                                                 0675
*                                                                  0676
*   /*****************************************************************/
*   /*                                                               */
*   /* SEVFILL - PROC TO MOVE DATA TO THE SEVERITY LIST - SEVRLIST  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0676
*SEVFILL:                                                          0676
*   PROC OPTIONS(SAVE(14));         /* MOVE SEVERITY DATA    @ZA20267*/
SEVFILL  ST    @14,12(,@13)                                        0676
*   SEVHMOVE=TSEVTEMP;              /* MOVE HEADER           @ZA20267*/
         MVC   SEVHMOVE(9,SEVRPTR),TSEVTEMP(SUMWKPTR)              0677
*   SEVSDAWK=ISDAWORK;              /* MOVE SDA WORK AREA    @ZA20267*/
         L     @15,SDA00PTR(,CVTPTR)                               0678
         MVC   SEVSDAWK(20,SEVRPTR),ISDAWORK(@15)                  0678
*   SEVSDPTR=SDATAPTR-DATAPTR;      /* GET OFFSET FOR SENSE  @ZA20267*/
         L     @14,DATAPTR(,CVTPTR)                                0679
         L     @09,SDATAPTR(,CVTPTR)                               0679
         SLR   @09,@14                                             0679
         ST    @09,SEVSDPTR(,SEVRPTR)                              0679
*   SEVDEVPT=DEVPTR-DATAPTR;        /* GET OFFSET FOR DEVPTR @ZA20267*/
         LCR   @14,@14                                             0680
         AL    @14,DEVPTR(,@15)                                    0680
         ST    @14,SEVDEVPT(,SEVRPTR)                              0680
*   SEVDATA=OBRMDR(1:SLENGTH);     /* MOVE LOG DATA          @ZA32156*/
         MVI   SEVDATA+1(SEVRPTR),C' '                             0681
         MVC   SEVDATA+2(126,SEVRPTR),SEVDATA+1(SEVRPTR)           0681
         L     @15,LOGPTR(,SUMWKPTR)                               0681
         LH    @14,SLENGTH(,@15)                                   0681
         BCTR  @14,0                                               0681
         EX    @14,@SM01024                                        0681
*   END SEVFILL;                    /* END PROC              @ZA20267*/
@EL00018 DS    0H                                                  0682
@EF00018 DS    0H                                                  0682
@ER00018 L     @14,12(,@13)                                        0682
         BR    @14                                                 0682
*                                                                  0683
*   /*****************************************************************/
*   /*                                                               */
*   /* CHKPARMS - PROC TO CHECK SSID, DEVTYPE, AND FSCODE OPTIONS    */
*   /*            FOR SELECTIVE DETAIL PRINT OF INPUT DATA           */
*   /*                                                               */
*   /*****************************************************************/
*CHKPARMS:                                                         0683
*   PROC OPTIONS(SAVE(14));         /* CHECK SDA PARMS       @ZM31121*/
CHKPARMS ST    @14,12(,@13)                                        0683
*   IF CDETAIL='00'X THEN           /* NO DETAIL PRINT       @ZM31121*/
         L     @06,LPARMPTR                                        0684
         CLI   CDETAIL(@06),X'00'                                  0684
         BNE   @RF00684                                            0684
*     I=2;                          /* SET NO PRINT          @ZM31121*/
         LA    I,2                                                 0685
*   ELSE                            /* CHECK MORE PARMS      @ZM31121*/
*     IF CTYPE='  '&CSSIDF='0000'X&CFSCONLY='00000000'X THEN/*     0686
*                                      NO PARM CHECKS        @ZM31121*/
         B     @RC00684                                            0686
@RF00684 L     @06,LPARMPTR                                        0686
         CLC   CTYPE(2,@06),@CC00880                               0686
         BNE   @RF00686                                            0686
         CLC   CSSIDF(2,@06),@CB00997                              0686
         BNE   @RF00686                                            0686
         CLC   CFSCONLY(4,@06),@CB00998                            0686
         BNE   @RF00686                                            0686
*       I=0;                        /* PRINT DETAIL          @ZM31121*/
         SLR   I,I                                                 0687
*     ELSE                          /* CHECK SSID            @ZM31121*/
*       I=1;                        /* MAY PRINT             @ZM31121*/
         B     @RC00686                                            0688
@RF00686 LA    I,1                                                 0688
*   IF I=1 THEN                     /* CHECK FURTHER         @ZM31121*/
@RC00686 DS    0H                                                  0689
@RC00684 CH    I,@CH00083                                          0689
         BNE   @RF00689                                            0689
*     DO;                           /* YES, GET SSID,DEV,FSC @ZM31121*/
*                                                                  0690
*       /*************************************************************/
*       /*                                                           */
*       /* GET SSID, FSC, AND DEVICE TYPE FOR LATER TESTING          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0691
*       TEMP2=''B;                  /* ZERO SSID FIELD       @ZM31121*/
         XC    TEMP2(2,SUMWKPTR),TEMP2(SUMWKPTR)                   0691
*       TEMP710=''B;                /* ZERO FSC FIELD        @ZM31121*/
         XC    TEMP710(4,SUMWKPTR),TEMP710(SUMWKPTR)               0692
*       TEMP78=''B;                 /* ZERO DEVICE TYPE FIELD@ZM31121*/
         XC    TEMP78(2,SUMWKPTR),TEMP78(SUMWKPTR)                 0693
*       IF INDEVTYP='S' THEN        /* MSC RECORD            @ZM31121*/
         L     @06,SDA00PTR(,CVTPTR)                               0694
         CLI   INDEVTYP(@06),C'S'                                  0694
         BNE   @RF00694                                            0694
*         DO;                       /* GET MSC SSID, FSC     @ZM31121*/
*           TEMP2=SUBSYSID&'0FFF'X; /* YES, GET SSID         @ZM31121*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0696
         MVC   TEMP2(2,SUMWKPTR),SUBSYSID(@06)                     0696
         NC    TEMP2(2,SUMWKPTR),@CB00973                          0696
*           IF CTYPE^='  ' THEN     /* WANT SPECIFIC DEVICE  @ZM31121*/
         L     @06,LPARMPTR                                        0697
         CLC   CTYPE(2,@06),@CC00880                               0697
         BE    @RF00697                                            0697
*             IF FORMATCK(4)='1'B THEN/* FORMAT 3            @ZM31121*/
         TM    FORMATCK(SUMWKPTR),B'00010000'                      0698
         BNO   @RF00698                                            0698
*               TEMP78='CS';        /* SET CARTRIDGE STORE   @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC00999                         0699
*             ELSE                  /* CHECK FORMAT 4        @ZM31121*/
*               IF FORMATCK(5)='1'B THEN/* FORMAT 4          @ZM31121*/
         B     @RC00698                                            0700
@RF00698 TM    FORMATCK(SUMWKPTR),B'00001000'                      0700
         BNO   @RF00700                                            0700
*                 IF SUBFMTNO='1001'BSUBFMTNO='1101'B THEN/*      0701
*                                      SA FORMAT 9 OR D      @ZM31121*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0701
         TM    SUBFMTNO(@06),B'10010000'                           0701
         BNO   @GL00022                                            0701
         TM    SUBFMTNO(@06),B'01100000'                           0701
         BZ    @RT00701                                            0701
@GL00022 L     @06,SENSEPTR(,SUMWKPTR)                             0701
         TM    SUBFMTNO(@06),B'11010000'                           0701
         BNO   @RF00701                                            0701
         TM    SUBFMTNO(@06),B'00100000'                           0701
         BNZ   @RF00701                                            0701
@RT00701 DS    0H                                                  0702
*                   TEMP78='RD';    /* SET DRD               @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC01002                         0702
*                 ELSE                                             0703
*                   IF SUBFMTNO='1011'B THEN/* SA FORMAT B   @ZM31121*/
         B     @RC00701                                            0703
@RF00701 L     @06,SENSEPTR(,SUMWKPTR)                             0703
         TM    SUBFMTNO(@06),B'10110000'                           0703
         BNO   @RF00703                                            0703
         TM    SUBFMTNO(@06),B'01000000'                           0703
         BNZ   @RF00703                                            0703
*                     IF TEMP1='02'X THEN/* DRD SSID         @ZM31121*/
         CLI   TEMP1(SUMWKPTR),X'02'                               0704
         BNE   @RF00704                                            0704
*                       TEMP78='RD';/* SET DRD               @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC01002                         0705
*                     ELSE          /* MUST BE DRC OR SA     @ZM31121*/
*                       TEMP78='RC';/* SET DRC               @ZM31121*/
         B     @RC00704                                            0706
@RF00704 MVC   TEMP78(2,SUMWKPTR),@CC01005                         0706
*                   ELSE                                           0707
*                     IF SUBFMTNO='1110'B THEN/* SA FORMAT E @ZM31121*/
         B     @RC00703                                            0707
@RF00703 L     @06,SENSEPTR(,SUMWKPTR)                             0707
         TM    SUBFMTNO(@06),B'11100000'                           0707
         BNO   @RF00707                                            0707
         TM    SUBFMTNO(@06),B'00010000'                           0707
         BNZ   @RF00707                                            0707
*                       TEMP78='RC';/* SET DRC               @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC01005                         0708
*                     ELSE          /* SA FORMAT A OR C      @ZM31121*/
*                       TEMP78='SA';/* SET SA                @ZM31121*/
         B     @RC00707                                            0709
@RF00707 MVC   TEMP78(2,SUMWKPTR),@CC01007                         0709
*               ELSE                /* CHECK FORMAT 5        @ZM31121*/
*                 IF FORMATCK(6)='1'B THEN/* FORMAT 5        @ZM31121*/
         B     @RC00700                                            0710
@RF00700 TM    FORMATCK(SUMWKPTR),B'00000100'                      0710
         BNO   @RF00710                                            0710
*                   TEMP78='DA';    /* SET DASD              @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC01008                         0711
*                 ELSE              /* NOT FORMAT 3,4, OR 5  @ZM31121*/
*                   I=2;            /* NO PRINT FOR SURE     @ZM31121*/
         B     @RC00710                                            0712
@RF00710 LA    I,2                                                 0712
*           ELSE;                   /* NOT LOOKING FOR DEVICE@ZM31121*/
@RF00697 DS    0H                                                  0714
*           IF CFSCONLY^='00000000'X THEN/* WANT FSC ONLY    @ZM31121*/
@RC00697 L     @06,LPARMPTR                                        0714
         CLC   CFSCONLY(4,@06),@CB00998                            0714
         BE    @RF00714                                            0714
*             IF FORMATCK(1)='0'B THEN/* NOT FORMAT 0        @ZM31121*/
         TM    FORMATCK(SUMWKPTR),B'10000000'                      0715
         BNZ   @RF00715                                            0715
*               IF FORMATCK(4)='0'B THEN/* NOT FORMAT 3      @ZM31121*/
         TM    FORMATCK(SUMWKPTR),B'00010000'                      0716
         BNZ   @RF00716                                            0716
*                 TEMP710(1:2)=MSCFSC;/* MOVE BYTES 26,27    @ZM31121*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0717
         MVC   TEMP710(2,SUMWKPTR),MSCFSC(@06)                     0717
*               ELSE                /* FORMAT 3 RECORD       @ZM31121*/
*                 DO;               /* GET TWO FSCS          @ZM31121*/
         B     @RC00716                                            0718
@RF00716 DS    0H                                                  0719
*                   TEMP710=FSCACC1;/* FSC FOR ACC1          @ZM31121*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0719
         MVC   TEMP710(4,SUMWKPTR),FSCACC1(@06)                    0719
*                   TEMP1417=FSCACC2;/* FSC FOR ACC2         @ZM31121*/
         MVC   TEMP1417(4,SUMWKPTR),FSCACC2(@06)                   0720
*                 END;              /* END CS SENSE          @ZM31121*/
*             ELSE                  /* FORMAT 0 NO FSC       @ZM31121*/
*               I=2;                /* NO PRINT FOR SURE     @ZM31121*/
         B     @RC00715                                            0722
@RF00715 LA    I,2                                                 0722
*           ELSE;                   /* FSC NOT REQUESTED     @ZM31121*/
@RF00714 DS    0H                                                  0724
*         END;                      /* END MSC RECORDS       @ZM31121*/
*       ELSE                        /* DASD RECORD           @ZM31121*/
*         DO;                       /* SETUP FOR DASD        @ZM31121*/
         B     @RC00694                                            0725
@RF00694 DS    0H                                                  0726
*           TEMP78='DA';            /* DEVICE TYPE           @ZM31121*/
         MVC   TEMP78(2,SUMWKPTR),@CC01008                         0726
*           TEMP710(1:2)=DASDFSC;   /* FAULT SYMPTOM CODE    @ZM31121*/
         L     @06,SENSEPTR(,SUMWKPTR)                             0727
         MVC   TEMP710(2,SUMWKPTR),DASDFSC(@06)                    0727
*           IF INDEVTYP='V' THEN    /* STAGING DASD          @ZM31121*/
         L     @05,SDA00PTR(,CVTPTR)                               0728
         CLI   INDEVTYP(@05),C'V'                                  0728
         BNE   @RF00728                                            0728
*             DO;                   /* YES                   @ZM31121*/
*               TEMP2=MSCFSC;       /* GET BYTE 26,27        @ZM31121*/
         MVC   TEMP2(2,SUMWKPTR),MSCFSC(@06)                       0730
*               TEMP1=''B;          /* ZERO BYTE 26          @ZM31121*/
         MVI   TEMP1(SUMWKPTR),X'00'                               0731
*             END;                  /* END STAGING SSID      @ZM31121*/
*           ELSE                    /* REAL DASD             @ZM31121*/
*             IF CSSIDF^='0000'X THEN/* LOOKING FOR SSID     @ZM31121*/
         B     @RC00728                                            0733
@RF00728 L     @06,LPARMPTR                                        0733
         CLC   CSSIDF(2,@06),@CB00997                              0733
         BE    @RF00733                                            0733
*               I=2;                /* NO PRINT FOR SURE     @ZM31121*/
         LA    I,2                                                 0734
*             ELSE;                 /* OK TO USE REAL DASD   @ZM31121*/
@RF00733 DS    0H                                                  0736
*         END;                      /* END DASD SETUP        @ZM31121*/
*     END;                          /* END PARM SETUP        @ZM31121*/
*   ELSE;                           /* NO PARM SETUP NEEDED  @ZM31121*/
*                                                                  0738
@RF00689 DS    0H                                                  0739
*   /*****************************************************************/
*   /*                                                               */
*   /* DO NOT PRINT REAL 3330 FORMAT 6 IF DETAIL(ALL)                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0739
*   IF INDEVTYP='R'&CDETAIL(1:6)='111111'B THEN /* REAL 3330       0739
*                                             AND DETAIL ALL @ZA11010*/
@RC00689 L     @06,SDA00PTR(,CVTPTR)                               0739
         CLI   INDEVTYP(@06),C'R'                                  0739
         BNE   @RF00739                                            0739
         L     @06,LPARMPTR                                        0739
         TM    CDETAIL(@06),B'11111100'                            0739
         BNO   @RF00739                                            0739
*     IF SUBFMASK='60'X THEN        /* YES, FORMAT 6 RECORD  @ZA11010*/
         CLI   SUBFMASK(SUMWKPTR),X'60'                            0740
         BNE   @RF00740                                            0740
*       I=2;                        /* YES, DO NOT PRINT IT  @ZA11010*/
         LA    I,2                                                 0741
*     ELSE;                         /* NOT FORMAT 6          @ZA11010*/
@RF00740 DS    0H                                                  0743
*   ELSE;                           /* NOT REAL DASD         @ZA11010*/
@RF00739 DS    0H                                                  0744
*   IF I=1 THEN                     /* STILL CHECKING        @ZM31121*/
*                                                                  0744
         CH    I,@CH00083                                          0744
         BNE   @RF00744                                            0744
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK DEVICE TYPE AND SSID AND FAULT SYMPTOM CODE           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0745
*     DO;                           /* CHECK EACH FIELD      @ZM31121*/
*       IF CSSIDF^='0000'X THEN     /* WANT SPECIFIC SSID    @ZM31121*/
         L     @06,LPARMPTR                                        0746
         CLC   CSSIDF(2,@06),@CB00997                              0746
         BE    @RF00746                                            0746
*         IF CSSIDF=TEMP2 THEN      /* HAVE SSID MATCH       @ZM31121*/
         CLC   CSSIDF(2,@06),TEMP2(SUMWKPTR)                       0747
         BNE   @RF00747                                            0747
*           I=0;                    /* YES, PRINT IT         @ZM31121*/
         SLR   I,I                                                 0748
*         ELSE                      /* NOT RIGHT SSID        @ZM31121*/
*           I=2;                    /* NO PRINT FOR SURE     @ZM31121*/
         B     @RC00747                                            0749
@RF00747 LA    I,2                                                 0749
*       ELSE;                       /* NOT LOOKING FOR SSID  @ZM31121*/
@RF00746 DS    0H                                                  0751
*       IF CTYPE^='  '&I^=2 THEN    /* LOOKING FOR DEVICE    @ZM31121*/
@RC00746 L     @06,LPARMPTR                                        0751
         CLC   CTYPE(2,@06),@CC00880                               0751
         BE    @RF00751                                            0751
         CH    I,@CH00102                                          0751
         BE    @RF00751                                            0751
*         IF CTYPE=TEMP78 THEN      /* YES, CHECK IT         @ZM31121*/
         CLC   CTYPE(2,@06),TEMP78(SUMWKPTR)                       0752
         BNE   @RF00752                                            0752
*           I=0;                    /* PRINT IT              @ZM31121*/
         SLR   I,I                                                 0753
*         ELSE                      /* WRONG DEVICE TYPE     @ZM31121*/
*           I=2;                    /* NO PRINT FOR SURE     @ZM31121*/
         B     @RC00752                                            0754
@RF00752 LA    I,2                                                 0754
*       ELSE;                       /* NOT LOOKING FOR DEV   @ZM31121*/
@RF00751 DS    0H                                                  0756
*       IF CFSCONLY^='00000000'X&I^=2 THEN /* WANT FSC ONLY  @ZM31121*/
@RC00751 L     @06,LPARMPTR                                        0756
         CLC   CFSCONLY(4,@06),@CB00998                            0756
         BE    @RF00756                                            0756
         CH    I,@CH00102                                          0756
         BE    @RF00756                                            0756
*         IF CFSCONLY=TEMP710 THEN  /* FOUND FSC MATCH       @ZM31121*/
         CLC   CFSCONLY(4,@06),TEMP710(SUMWKPTR)                   0757
         BNE   @RF00757                                            0757
*           I=0;                    /* YES, PRINT IT         @ZM31121*/
         SLR   I,I                                                 0758
*         ELSE                      /* CHECK ACC2 IF FMT 3   @ZM31121*/
*           IF FORMATCK(4)='1'B&CFSCONLY=TEMP1417 THEN/* MATCH     0759
*                                      ON ACC2 FSC           @ZM31121*/
         B     @RC00757                                            0759
@RF00757 TM    FORMATCK(SUMWKPTR),B'00010000'                      0759
         BNO   @RF00759                                            0759
         L     @06,LPARMPTR                                        0759
         CLC   CFSCONLY(4,@06),TEMP1417(SUMWKPTR)                  0759
         BNE   @RF00759                                            0759
*             I=0;                  /* YES, PRINT IT         @ZM31121*/
         SLR   I,I                                                 0760
*           ELSE                    /* WRONG FSC             @ZM31121*/
*             I=2;                  /* NO PRINT FOR SURE     @ZM31121*/
         B     @RC00759                                            0761
@RF00759 LA    I,2                                                 0761
*       ELSE;                       /* NOT LOOKING FOR FSC   @ZM31121*/
@RF00756 DS    0H                                                  0763
*     END;                          /* END ALL CHECKS        @ZM31121*/
*   ELSE;                           /* I=2 ALREADY           @ZM31121*/
*                                                                  0764
@RF00744 DS    0H                                                  0765
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN DETAIL FLAG ON IF I=0                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*   IF I=0 THEN                     /* PRINT RECORD MAYBE    @ZM31121*/
@RC00744 LTR   I,I                                                 0765
         BNZ   @RF00765                                            0765
*     TEMP1=FORMATCK&CDETAIL;       /* USE DETAIL AS MASK AGAINST  0766
*                                      FORMATNO              @Y30LB55*/
         MVC   TEMP1(1,SUMWKPTR),FORMATCK(SUMWKPTR)                0766
         L     @06,LPARMPTR                                        0766
         NC    TEMP1(1,SUMWKPTR),CDETAIL(@06)                      0766
*   ELSE                            /* DO NOT PRINT RECORD   @ZM31121*/
*     TEMP1=''B;                    /* FORCE NO PRINT        @ZM31121*/
         B     @RC00765                                            0767
@RF00765 MVI   TEMP1(SUMWKPTR),X'00'                               0767
*   END CHKPARMS;                   /* END PROC              @ZM31121*/
@EL00019 DS    0H                                                  0768
@EF00019 DS    0H                                                  0768
@ER00019 L     @14,12(,@13)                                        0768
         BR    @14                                                 0768
*   END ISDASUM0                    /* END OF SUM0           @Y30LB55*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDALOBR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        *
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSC3)                                        *
*/*%INCLUDE SYSLIB  (ISDASUM5)                                        *
*;                                                                 0769
@DATA    DS    0H
@CH00083 DC    H'1'
@CH00102 DC    H'2'
@CH00087 DC    H'3'
@CH00106 DC    H'4'
@CH00180 DC    H'5'
@CH00095 DC    H'6'
@CH00071 DC    H'8'
@CH00207 DC    H'16'
@CH00345 DC    H'20'
@CH00221 DC    H'28'
@CH01011 DC    H'48'
@CH00441 DC    H'59'
@CH00529 DC    H'101'
@CH00989 DC    H'107'
@CH00986 DC    H'229'
@CH00990 DC    H'235'
@CH00408 DC    H'256'
@CH00909 DC    XL2'39'
@SM01024 MVC   SEVDATA(0,SEVRPTR),OBRMDR(@15)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00014 DS    1F
@SA00016 DS    1F
@SA00002 DS    1F
@SA00003 DS    0F
@SA00013 DS    0F
         DS    1F
@TF00001 DS    F
ISDASUM0 CSECT
         DS    0F
@CF01012 DC    F'168'
@CH01012 EQU   @CF01012+2
@CF00612 DC    F'233'
@CF00410 DC    F'1024'
@DATD    DSECT
         DS    0D
LPARMPTR DS    A
GET0PTR  DS    A
MINCDPTR DS    A
MINSEVCD DS    H
@TS00001 DS    CL2
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDASUM0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00406 DC    A(ISDASUM2)
@CV00453 DC    V(ISDAGET0)
@CV00454 DC    V(ISDAGET1)
@CV00455 DC    V(ISDAFREE)
@CV00456 DC    V(ISDAHEXP)
@CV00457 DC    V(ISDAPRT0)
         DS    0D
@CC00978 DC    C'NO SEVERITY CODE COULD BE FOUND FOR THIS RECORD'
@CC00911 DC    C'FORMAT '
@CC00917 DC    C'STAGING'
@CC00921 DC    C'  REAL '
@CC00910 DC    C' MSC'
@CC00915 DC    C'3330'
@CC00957 DC    C'SUM0'
@CC00896 DC    C'VS1'
@CC00898 DC    C'VS2'
@CC00900 DC    C' OS'
@CC00902 DC    C'DOS'
@CC00904 DC    C' VM'
@CC00906 DC    C'OBR'
@CC00907 DC    C'MDR'
@CC00920 DC    C'???'
@CC00880 EQU   @CC00921
@CC00999 DC    C'CS'
@CC01002 DC    C'RD'
@CC01005 DC    C'RC'
@CC01007 DC    C'SA'
@CC01008 DC    C'DA'
@CB00958 DC    X'0099999F00000000'
@CB00998 DC    X'00000000'
@CB00973 DC    X'0FFF'
@CB00974 DC    X'00FF'
@CB00997 EQU   @CB00998
@CB01022 DC    B'0000111111111111'
EDPAT05  DC    X'402020202120'
SUMSPNO  DC    X'01'
CPUZERO  DC    X'0000000000'
SUMMSG01 DC    CL116'RECORD 00000  DATE DDD/YY  TIME HH:MM:SS:HT     OBC
               R  MSC RUA(XXX) VUA(XXX)  CPUID(XXXXXX-XXXX)  SSID(XXX) C
                FSC(XXXX)'
SUMMSG02 DC    CL115'00..02..  04..06..  08..10..  12..14..  16..18..  C
               20..22..  24..26..  28..30..  FORMAT X  SA FORMAT(X)  MSC
               G CODE(X)'
SUMMSG11 DC    CL14'GENERATED'
SUMMSG21 DC    CL14'UNKNOWN FORMAT'
         DS    CL1
SEVTABG  DS    CL336
         ORG   SEVTABG
@NM00013 DC    X'2000'
@NM00014 DC    AL2(255)
@NM00015 DC    AL2(127)
@NM00016 DC    X'0430'
@NM00017 DC    AL2(253)
@NM00018 DC    AL2(125)
@NM00019 DC    X'4000'
@NM00020 DC    AL2(251)
@NM00021 DC    AL2(123)
@NM00022 DC    X'0420'
@NM00023 DC    AL2(249)
@NM00024 DC    AL2(121)
@NM00025 DC    X'08A0'
@NM00026 DC    AL2(247)
@NM00027 DC    AL2(119)
@NM00028 DC    X'1000'
@NM00029 DC    AL2(245)
@NM00030 DC    AL2(117)
@NM00031 DC    X'08E0'
@NM00032 DC    AL2(243)
@NM00033 DC    AL2(115)
@NM00034 DC    X'0440'
@NM00035 DC    AL2(241)
@NM00036 DC    AL2(113)
@NM00037 DC    X'8000'
@NM00038 DC    AL2(240)
@NM00039 DC    AL2(112)
@NM00040 DC    X'8007'
@NM00041 DC    AL2(239)
@NM00042 DC    AL2(111)
@NM00043 DC    X'8008'
@NM00044 DC    AL2(237)
@NM00045 DC    AL2(109)
@NM00046 DC    X'0410'
@NM00047 DC    AL2(233)
@NM00048 DC    AL2(105)
@NM00049 DC    X'0400'
@NM00050 DC    AL2(231)
@NM00051 DC    AL2(103)
@NM00052 DC    X'0891'
@NM00053 DC    AL2(227)
@NM00054 DC    AL2(99)
@NM00055 DC    X'089C'
@NM00056 DC    AL2(225)
@NM00057 DC    AL2(97)
@NM00058 DC    X'089B'
@NM00059 DC    AL2(223)
@NM00060 DC    AL2(95)
@NM00061 DC    X'0893'
@NM00062 DC    AL2(221)
@NM00063 DC    AL2(93)
@NM00064 DC    X'089D'
@NM00065 DC    AL2(219)
@NM00066 DC    AL2(91)
@NM00067 DC    X'089E'
@NM00068 DC    AL2(217)
@NM00069 DC    AL2(89)
@NM00070 DC    X'0899'
@NM00071 DC    AL2(215)
@NM00072 DC    AL2(87)
@NM00073 DC    X'0895'
@NM00074 DC    AL2(213)
@NM00075 DC    AL2(85)
@NM00076 DC    X'0894'
@NM00077 DC    AL2(211)
@NM00078 DC    AL2(83)
@NM00079 DC    X'0898'
@NM00080 DC    AL2(209)
@NM00081 DC    AL2(81)
@NM00082 DC    X'0896'
@NM00083 DC    AL2(207)
@NM00084 DC    AL2(79)
@NM00085 DC    X'089A'
@NM00086 DC    AL2(205)
@NM00087 DC    AL2(77)
@NM00088 DC    X'0892'
@NM00089 DC    AL2(201)
@NM00090 DC    AL2(73)
@NM00091 DC    X'0890'
@NM00092 DC    AL2(199)
@NM00093 DC    AL2(71)
@NM00094 DC    X'0897'
@NM00095 DC    AL2(195)
@NM00096 DC    AL2(67)
@NM00097 DC    X'8009'
@NM00098 DC    AL2(191)
@NM00099 DC    AL2(63)
@NM00100 DC    X'800B'
@NM00101 DC    AL2(189)
@NM00102 DC    AL2(61)
@NM00103 DC    X'800D'
@NM00104 DC    AL2(187)
@NM00105 DC    AL2(59)
@NM00106 DC    X'800E'
@NM00107 DC    AL2(185)
@NM00108 DC    AL2(57)
@NM00109 DC    X'08C0'
@NM00110 DC    AL2(183)
@NM00111 DC    AL2(55)
@NM00112 DC    X'0450'
@NM00113 DC    AL2(181)
@NM00114 DC    AL2(53)
@NM00115 DC    X'08B5'
@NM00116 DC    AL2(179)
@NM00117 DC    AL2(51)
@NM00118 DC    X'08B6'
@NM00119 DC    AL2(177)
@NM00120 DC    AL2(49)
@NM00121 DC    X'08B2'
@NM00122 DC    AL2(175)
@NM00123 DC    AL2(47)
@NM00124 DC    X'08B4'
@NM00125 DC    AL2(173)
@NM00126 DC    AL2(45)
@NM00127 DC    X'08B1'
@NM00128 DC    AL2(171)
@NM00129 DC    AL2(43)
@NM00130 DC    X'08BB'
@NM00131 DC    AL2(169)
@NM00132 DC    AL2(41)
@NM00133 DC    X'08BC'
@NM00134 DC    AL2(167)
@NM00135 DC    AL2(39)
@NM00136 DC    X'08B9'
@NM00137 DC    AL2(165)
@NM00138 DC    AL2(37)
@NM00139 DC    X'08BA'
@NM00140 DC    AL2(163)
@NM00141 DC    AL2(35)
@NM00142 DC    X'08B0'
@NM00143 DC    AL2(161)
@NM00144 DC    AL2(33)
@NM00145 DC    X'08B8'
@NM00146 DC    AL2(159)
@NM00147 DC    AL2(31)
@NM00148 DC    X'08B3'
@NM00149 DC    AL2(157)
@NM00150 DC    AL2(29)
@NM00151 DC    X'08B7'
@NM00152 DC    AL2(155)
@NM00153 DC    AL2(27)
@NM00154 DC    X'08BE'
@NM00155 DC    AL2(153)
@NM00156 DC    AL2(25)
@NM00157 DC    X'08BD'
@NM00158 DC    AL2(151)
@NM00159 DC    AL2(23)
@NM00160 DC    X'8005'
@NM00161 DC    AL2(13)
@NM00162 DC    AL2(13)
@NM00163 DC    X'1001'
@NM00164 DC    AL2(11)
@NM00165 DC    AL2(11)
@NM00166 DC    X'8002'
@NM00167 DC    AL2(9)
@NM00168 DC    AL2(9)
@NM00169 DC    X'800A'
@NM00170 DC    AL2(9)
@NM00171 DC    AL2(9)
@NM00172 DC    X'800F'
@NM00173 DC    AL2(7)
@NM00174 DC    AL2(7)
@NM00175 DC    X'08D0'
@NM00176 DC    AL2(5)
@NM00177 DC    AL2(5)
ENDTABG  DC    X'0460'
@NM00178 DC    AL2(3)
@NM00179 DC    AL2(3)
         ORG   SEVTABG+336
PATCH    DC    50X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
TABPTR   EQU   @04
SEVRPTR  EQU   @06
J        EQU   @05
I        EQU   @04
RETCODE  EQU   @07
DEVIDPTR EQU   @06
COUNTEND EQU   @05
COUNTPTR EQU   @04
SUMWKPTR EQU   @03
CVTPTR   EQU   @02
R1       EQU   @01
R15      EQU   @15
         EXTRN ISDASUM2
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
SDA00PTR EQU   CVTPTRS0+12
PRT00PTR EQU   CVTPTRS0+28
SUM00PTR EQU   CVTPTRS0+48
CNFG0PTR EQU   CVTPTRS0+88
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
DUMPADDR EQU   HEXPCALL
DUMPLEN  EQU   HEXPCALL+4
DUMPIDNO EQU   HEXPCALL+8
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CTYPE    EQU   ISDAPRMS+11
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CSUM     EQU   CREPORTS+2
CDETAIL  EQU   ISDAPRMS+46
ISDAGHDR EQU   0
STARTPTR EQU   ISDAGHDR
ENDPTR   EQU   ISDAGHDR+4
GET0SPLN EQU   ISDAGHDR+8
BLOCKID  EQU   ISDAGHDR+20
BLOCKCNT EQU   ISDAGHDR+24
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SLENGTH  EQU   SCW
SYSREL   EQU   OBRMDR+5
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
CPUSER   EQU   CPUSERID
CPUID    EQU   CPUSERID+3
DEVDEP1  EQU   OBRMDR+28
JOBID    EQU   DEVDEP1
DEVTYPE1 EQU   JOBID
MDRCUA   EQU   DEVTYPE1
SDRINF   EQU   DEVDEP1+8
SECUA    EQU   SDRINF+17
DEVTYPE  EQU   0
CLASTYPE EQU   DEVTYPE+2
ISDAMSCS EQU   0
STATUS   EQU   ISDAMSCS
SUBSYSID EQU   ISDAMSCS+1
SSIDFLAG EQU   SUBSYSID
SSID     EQU   SUBSYSID
SSIDLIBN EQU   SSID+1
FORMATNO EQU   ISDAMSCS+3
SUBSENSE EQU   ISDAMSCS+4
SUBSTAT4 EQU   SUBSENSE
SUBSTAT5 EQU   SUBSENSE+1
SALOWADD EQU   SUBSENSE+2
DASDFMTN EQU   SUBSENSE+3
SUBFMTMG EQU   SUBSENSE+7
SUBFMTNO EQU   SUBFMTMG
DASDFSC  EQU   SUBSENSE+18
RUADASD  EQU   SUBSENSE+20
MSCFSC   EQU   SUBSENSE+22
ISDAWORK EQU   0
INFLAGS  EQU   ISDAWORK
IRECTYPE EQU   INFLAGS
INDEVTYP EQU   INFLAGS+2
SDAFLAG0 EQU   INFLAGS+3
DLENGTH  EQU   ISDAWORK+4
INRECCUA EQU   ISDAWORK+6
NINREC   EQU   ISDAWORK+8
DEVPTR   EQU   ISDAWORK+16
PRTWORK  EQU   0
LINECNT  EQU   PRTWORK+18
PCNFG    EQU   0
CNFGFXD  EQU   PCNFG
ISDAMSC3 EQU   4
MOVES12  EQU   ISDAMSC3+2
FSCACC1  EQU   ISDAMSC3+4
FSCACC2  EQU   ISDAMSC3+8
SUMWORK  EQU   0
SUMWORK1 EQU   SUMWORK
ACCM0PTR EQU   SUMWORK1
ACCUMPTR EQU   SUMWORK1+4
ACCM0END EQU   SUMWORK1+8
LOGPTR   EQU   SUMWORK1+12
SENSEPTR EQU   SUMWORK1+16
RCODEPTR EQU   SUMWORK1+20
RCODECNT EQU   SUMWORK1+24
SUM2PTR  EQU   SUMWORK1+28
SEVSTART EQU   SUMWORK1+32
SEVRLEN  EQU   SUMWORK1+36
SEVRLCNT EQU   SUMWORK1+40
GTOTALS  EQU   SUMWORK1+44
CNTF0    EQU   GTOTALS
CNTF1    EQU   GTOTALS+4
CNTF2    EQU   GTOTALS+8
CNTF3    EQU   GTOTALS+12
CNTF4    EQU   GTOTALS+16
CNTF5    EQU   GTOTALS+20
CNTFDASD EQU   GTOTALS+24
CNTSENSE EQU   GTOTALS+28
CNTLOG   EQU   GTOTALS+32
ACCUMCNT EQU   SUMWORK1+88
SUMACCL  EQU   SUMWORK1+90
NCOUNTER EQU   SUMWORK1+92
NCPUUSED EQU   SUMWORK1+94
NCPUCNTS EQU   SUMWORK1+96
SUMWORK2 EQU   SUMWORK+98
CPUFOUND EQU   SUMWORK2
SUMTEMPS EQU   SUMWORK+178
TEMP9    EQU   SUMTEMPS
TEMP8    EQU   TEMP9
TEMP7    EQU   TEMP8
TEMP6    EQU   TEMP7
TEMP5    EQU   TEMP6
TEMP4    EQU   TEMP5
TEMP3    EQU   TEMP4
TEMP2    EQU   TEMP3
TEMP1    EQU   TEMP2
TEMP20   EQU   SUMTEMPS+9
TEMP16   EQU   TEMP20
TEMP710  EQU   TEMP20+6
TEMP1113 EQU   TEMP20+10
TEMP1417 EQU   TEMP20+13
TEMP1820 EQU   TEMP20+17
SUMWORK3 EQU   SUMWORK+210
SUMFLAGS EQU   SUMWORK3
FORMATNC EQU   SUMWORK3+1
MAINMASK EQU   SUMWORK3+2
FORMATCK EQU   MAINMASK
FLAGMASK EQU   MAINMASK+1
SUBFMASK EQU   MAINMASK+2
FMTIDSV  EQU   SUMWORK3+5
SUBFIDSV EQU   SUMWORK3+12
MSGCODSV EQU   SUMWORK3+13
TSEVTEMP EQU   SUMWORK3+14
TSEVCDID EQU   TSEVTEMP
TSEVCODE EQU   TSEVCDID
TSSID    EQU   TSEVCDID+2
TPTFLAG  EQU   TSEVTEMP+4
TSEVFMTS EQU   TSEVTEMP+5
TSEVFMT  EQU   TSEVFMTS
TSEVSUBF EQU   TSEVFMTS+1
TSEVMASK EQU   TSEVTEMP+7
TSEVECOD EQU   TSEVTEMP+8
MDEVIDTB EQU   0
MDFMTXXX EQU   MDEVIDTB
MDMASK   EQU   MDFMTXXX
MDIDS    EQU   MDFMTXXX+3
MDCSMXXX EQU   MDIDS+4
MDMSGXXX EQU   MDFMTXXX+14
MCOUNTER EQU   0
MCFMTXXX EQU   MCOUNTER
MCADDXXX EQU   MCFMTXXX
MCOUNTS  EQU   MCFMTXXX+4
MCPXXX   EQU   MCOUNTS
MCTXXX   EQU   MCOUNTS+2
MCMASK   EQU   MCFMTXXX+8
MCFLAG   EQU   MCMASK+1
MLDTIME  EQU   MCFMTXXX+12
MHDTIME  EQU   MCFMTXXX+20
RCODES   EQU   0
SEVRLIST EQU   0
SEVRCNT  EQU   SEVRLIST
SEVHMOVE EQU   SEVRLIST+2
SEVCDSID EQU   SEVHMOVE
SEVRCODE EQU   SEVCDSID
SEVSDAWK EQU   SEVRLIST+12
SEVSDPTR EQU   SEVRLIST+32
SEVDEVPT EQU   SEVRLIST+36
SEVDATA  EQU   SEVRLIST+40
SEVDATET EQU   SEVDATA+12
TABGMOD  EQU   0
TABHW    EQU   TABGMOD
TABHISEV EQU   TABGMOD+2
TABLOSEV EQU   TABGMOD+4
SUMACCUM EQU   0
WORKPTR  EQU   0
TEMP68   EQU   TEMP8+5
TEMP78   EQU   TEMP8+6
REC01    EQU   LINE+6
DAY01    EQU   LINE+19
YEAR01   EQU   LINE+23
HOUR01   EQU   LINE+32
MIN01    EQU   LINE+35
SEC01    EQU   LINE+38
HUN01    EQU   LINE+41
SYSTEMID EQU   LINE+44
TYPE01   EQU   LINE+48
DEVT01   EQU   LINE+52
DEVRUA01 EQU   LINE+61
DEVVUA11 EQU   LINE+66
DEVVUA01 EQU   LINE+70
CPUSRM01 EQU   LINE+82
CPUIDM01 EQU   LINE+89
SSIDM11  EQU   LINE+96
SSIDM01  EQU   LINE+101
FSCM01   EQU   LINE+111
FSCM11   EQU   LINE+107
FSCM21   EQU   LINE+117
FMTID02  EQU   LINE+80
FMTNO02  EQU   LINE+87
SABLANK  EQU   LINE+90
SUBFID02 EQU   LINE+100
MSGCOD02 EQU   LINE+113
SUBFID12 EQU   LINE+90
MSGCOD12 EQU   LINE+104
SENSEID  EQU   LINE+94
*                                      START UNREFERENCED COMPONENTS
TABBYT27 EQU   TABHW+1
TABBYT11 EQU   TABHW
@NM00012 EQU   SEVDATA
SEVSPARE EQU   SEVRLIST+11
SEVECODE EQU   SEVHMOVE+8
SEVFMASK EQU   SEVHMOVE+7
SEVSUBF  EQU   SEVHMOVE+6
SEVFMT   EQU   SEVHMOVE+5
PTFLAG   EQU   SEVHMOVE+4
SEVSSID  EQU   SEVCDSID+2
MHTIME   EQU   MHDTIME+4
MHDATE   EQU   MHDTIME
MLTIME   EQU   MLDTIME+4
MLDATE   EQU   MLDTIME
MCSPARE  EQU   MCFMTXXX+11
MCSMXXX  EQU   MCMASK+2
MCFXXX   EQU   MCMASK
MDIDXXX  EQU   MDIDS+6
MDCMXXX  EQU   MDCSMXXX+1
MDCSXXX  EQU   MDCSMXXX
MDCFXXX  EQU   MDIDS
MDSMXXX  EQU   MDMASK+2
MDFLAG   EQU   MDMASK+1
MDFXXX   EQU   MDMASK
TEMP3032 EQU   SUMTEMPS+29
TOTTEMPS EQU   SUMWORK1+84
TOTPERMS EQU   SUMWORK1+80
@NM00011 EQU   ISDAMSC3+16
IREGS3F3 EQU   ISDAMSC3+15
IREGS2F3 EQU   ISDAMSC3+14
IREGS1F3 EQU   ISDAMSC3+13
MISCF3   EQU   ISDAMSC3+12
SHIFT2F3 EQU   FSCACC2+3
PCHKACC2 EQU   FSCACC2+2
FAULT2F3 EQU   FSCACC2+1
MCHKACC2 EQU   FSCACC2
SHIFT1F3 EQU   FSCACC1+3
PCHKACC1 EQU   FSCACC1+2
FAULT1F3 EQU   FSCACC1+1
MCHKACC1 EQU   FSCACC1
QUEUE3   EQU   ISDAMSC3+3
RECOVER3 EQU   ISDAMSC3+1
STATUS3  EQU   ISDAMSC3
SAINTFP  EQU   PCNFG+32
@NM00010 EQU   PCNFG+30
CNFGTOTL EQU   PCNFG+28
CPUSERAD EQU   PCNFG+24
CHCUAD   EQU   PCNFG+20
LTPAD    EQU   PCNFG+16
PCNFGL   EQU   CNFGFXD+14
CHINTFNO EQU   CNFGFXD+12
LIBSIZS  EQU   CNFGFXD+8
SANO     EQU   CNFGFXD+6
SPINO    EQU   CNFGFXD+4
CPUNO    EQU   CNFGFXD+2
MSFNO    EQU   CNFGFXD
@NM00009 EQU   PRTWORK
NOUTREC  EQU   ISDAWORK+12
CUABYTE1 EQU   INRECCUA+1
CUABYTE0 EQU   INRECCUA
INSOURCE EQU   INFLAGS+1
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
@NM00008 EQU   SUBSENSE+21
@NM00007 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00006 EQU   SUBSENSE+4
SSIDDEVT EQU   SSID+1
SSIDTYPE EQU   SSID
UNITTYPE EQU   CLASTYPE+1
DEVCLASS EQU   CLASTYPE
OPTFLAGS EQU   DEVTYPE+1
IOFLAGS  EQU   DEVTYPE
DEVDEP2  EQU   SDRINF+32
SENSCNT  EQU   SDRINF+30
IORETRY  EQU   SDRINF+28
PCUA     EQU   SDRINF+25
SDRCNT2  EQU   SDRINF+24
DEVTYPE2 EQU   SDRINF+20
DEVDEPC  EQU   SDRINF+16
CSW      EQU   SDRINF+8
FAILCCW  EQU   SDRINF
CUA2     EQU   JOBID+5
@NM00005 EQU   JOBID+4
SDRCNT1  EQU   OBRMDR+26
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
CLASRC   EQU   OBRMDR+4
@NM00004 EQU   SCW+3
SCODE    EQU   SCW+2
@NM00003 EQU   ISDAGHDR+26
LASTPTR  EQU   ISDAGHDR+16
NEXTPTR  EQU   ISDAGHDR+12
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
GEN00PTR EQU   CVTPTRS0+92
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
*                                      END UNREFERENCED COMPONENTS
@RC00087 EQU   @RC00076
@RC00085 EQU   @RC00076
@RC00083 EQU   @RC00076
@RC00081 EQU   @RC00076
@RC00079 EQU   @RC00076
@RC00077 EQU   @RC00076
@RC00153 EQU   @RC00152
@RC00267 EQU   @RC00262
@RC00310 EQU   @RC00297
@RC00308 EQU   @RC00297
@RC00306 EQU   @RC00297
@RC00393 EQU   @EL00009
@RC00386 EQU   @EL00009
@RC00404 EQU   @EL00010
@RC00520 EQU   @RC00517
@RC00545 EQU   @EL00015
@RC00537 EQU   @EL00015
@RC00557 EQU   @RC00556
@RC00565 EQU   @RC00564
@RC00580 EQU   @EL00016
@RC00647 EQU   @RC00637
@RC00638 EQU   @RC00637
@RC00666 EQU   @RC00663
@RC00710 EQU   @RC00697
@RC00700 EQU   @RC00697
@RC00698 EQU   @RC00697
@RC00694 EQU   @RC00689
@RC00728 EQU   @RC00689
@RC00747 EQU   @RC00746
@RC00752 EQU   @RC00751
@RC00756 EQU   @RC00744
@RC00765 EQU   @EL00019
@RC00542 EQU   @RC00537
@RC00540 EQU   @RC00537
@RC00538 EQU   @RC00537
@RC00639 EQU   @RC00638
@RC00648 EQU   @RC00647
@RC00707 EQU   @RC00700
@RC00703 EQU   @RC00700
@RC00701 EQU   @RC00700
@RC00714 EQU   @RC00694
@RC00759 EQU   @RC00756
@RC00757 EQU   @RC00756
@RC00642 EQU   @RC00639
@RC00651 EQU   @RC00648
@RC00704 EQU   @RC00703
@RC00715 EQU   @RC00714
@RC00716 EQU   @RC00715
@ENDDATA EQU   *
         END   ISDASUM0,(C'PLS1749',0701,78164)

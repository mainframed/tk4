         TITLE 'EQUIPMENT CHECK REPORT FORMAT ROUTINE                  *
                        '
ISDAEQC1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDAEQC1  76.205'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0024
*   /*****************************************************************/
*   /*                                                               */
*   /* PROGRAM START.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0024
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO SDACVT.    0024
*                                                            @Y30LB51*/
         L     @10,@PC00001                                        0024
         L     CVTPTR,WORKPTR(,@10)                                0024
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0025
*                                                            @Y30LB51*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0025
*   EQCRETCD=0;                     /* INITIALIZE RETURN CODE.     0026
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0026
         LR    EQCRETCD,@10                                        0026
*   TRANSPTR=0;                     /* INITIALIZE            @Y30LB51*/
         LR    TRANSPTR,@10                                        0027
*   EQCWKPTR=EQC00PTR;              /* SET PTR TO WORK AREA. @Y30LB51*/
         L     EQCWKPTR,EQC00PTR(,CVTPTR)                          0028
*   IF EQCWKPTR^=0 THEN             /* IF WORK AREA PRESENT  @Y30LB51*/
         CR    EQCWKPTR,@10                                        0029
         BE    @RF00029                                            0029
*     DO;                           /* GET START OF EQC CHAIN.     0030
*                                                            @Y30LB51*/
*       TBLPTR=OLDPTR;              /* SET PTR TO EQC CHAIN START. 0031
*                                                            @Y30LB51*/
         L     TBLPTR,OLDPTR(,EQCWKPTR)                            0031
*       IF TBLPTR^=0 THEN           /* IF DATA ON CHAIN      @Y30LB51*/
         CR    TBLPTR,@10                                          0032
         BE    @RF00032                                            0032
*         DO;                       /* GET NEEDED WORK SPACE.      0033
*                                                            @Y30LB51*/
*           CALL GETTBLS;           /* GET WORK SPACE.       @Y30LB51*/
         BAL   @14,GETTBLS                                         0034
*           IF EQCRETCD=0 THEN      /* IF SPACE OBTAINED     @Y30LB51*/
         LTR   EQCRETCD,EQCRETCD                                   0035
         BNZ   @RF00035                                            0035
*             DO;                   /* PROCESS THE REPORT.   @Y30LB51*/
*               CALL PRTHDR;        /* PRINT THE REPORT HEADER.    0037
*                                                            @Y30LB51*/
         BAL   @14,PRTHDR                                          0037
*               CALL PRTRPT;        /* PRINT THE REPORT.     @Y30LB51*/
         BAL   @14,PRTRPT                                          0038
*               CALL FREECORE;      /* FREE ALL GOTTEN CORE. @Y30LB51*/
         BAL   @14,FREECORE                                        0039
*             END;                  /*                       @Y30LB51*/
*           ELSE                    /* SOMETHING WRONG,      @Y30LB51*/
*             DO;                   /* FREE ANY DYNAMIC STORAGE.   0041
*                                                            @Y30LB51*/
         B     @RC00035                                            0041
@RF00035 DS    0H                                                  0042
*               CALL FREECORE;      /* GO FREE IT.           @Y30LB51*/
         BAL   @14,FREECORE                                        0042
*               EQCRETCD=NOSPACE;   /* SET RETURN CODE.      @Y30LB51*/
         LA    EQCRETCD,4                                          0043
*             END;                  /*                       @Y30LB51*/
*         END;                      /*                       @Y30LB51*/
*       ELSE                        /* NO DATA IN ACCUMULATOR,     0046
*                                                            @Y30LB51*/
*         DO;                       /* FREE ANY DYNAMIC STORAGE.   0046
*                                                            @Y30LB51*/
         B     @RC00032                                            0046
@RF00032 DS    0H                                                  0047
*           CALL FREECORE;          /* GO FREE IT.           @Y30LB51*/
         BAL   @14,FREECORE                                        0047
*           EQCRETCD=NODATA;        /* SET RETURN CODE.      @Y30LB51*/
         LA    EQCRETCD,8                                          0048
*         END;                      /*                       @Y30LB51*/
*     END;                          /*                       @Y30LB51*/
*   ELSE                            /* NO WORK AREA,         @Y30LB51*/
*     EQCRETCD=NODATA;              /* ISDAEQC0 NEVER ENTERED.     0051
*                                                            @Y30LB51*/
         B     @RC00029                                            0051
@RF00029 LA    EQCRETCD,8                                          0051
*   RETURN CODE(EQCRETCD);          /*                       @Y30LB51*/
@RC00029 L     @13,4(,@13)                                         0052
         L     @00,@SIZDATD                                        0052
         LR    @01,@11                                             0052
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@06                                             0052
         L     @14,12(,@13)                                        0052
         LM    @00,@12,20(@13)                                     0052
         BR    @14                                                 0052
*GETTBLS:                                                          0053
*   PROC OPTIONS(SAVE(14));         /*                       @XA14534*/
*                                                                  0053
@EL00001 L     @13,4(,@13)                                         0053
@EF00001 L     @00,@SIZDATD                                        0053
         LR    @01,@11                                             0053
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0053
         BR    @14                                                 0053
GETTBLS  ST    @14,@SA00002                                        0053
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL SECURE SPACE -- VIA THE ISDAGET1 ENTRY TO   */
*   /* ISDAGET0 -- FOR THE TRANSLATION  WORK AREA.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*   SPNO='05'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/
         MVI   SPNO(CVTPTR),X'05'                                  0054
*   CORELEN=LENGTH(CVTAREA);        /* GET TRANSLATION AREA LENGTH.
*                                                            @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00264+1                        0055
*   CALL ISDAGET1(WORKPTR);         /* GET TRANSLATION AREA SPACE. 0056
*                                                            @Y30LB51*/
         L     @10,@PC00001                                        0056
         ST    @10,@AL00001                                        0056
         L     @15,@CV00336                                        0056
         LA    @01,@AL00001                                        0056
         BALR  @14,@15                                             0056
*   RFY                                                            0057
*     RF RSTD;                      /*                       @Y30LB51*/
*   EQCRETCD=RF;                    /* SAVE RETURN CODE.     @Y30LB51*/
         LR    EQCRETCD,RF                                         0058
*   RFY                                                            0059
*     RF UNRSTD;                    /*                       @Y30LB51*/
*   IF EQCRETCD=0 THEN              /* IF SPACE SECURED      @Y30LB51*/
         LTR   EQCRETCD,EQCRETCD                                   0060
         BNZ   @RF00060                                            0060
*     TRANSPTR=COREADDR;            /* SET PTR TO TRANSLATION AREA.
*                                                            @Y30LB51*/
         L     TRANSPTR,COREADDR(,CVTPTR)                          0061
*   ELSE                            /* TRANSLATION AREA NOT        0062
*                                      AVAILABLE.            @Y30LB51*/
*     EQCRETCD=NOSPACE;             /*                       @Y30LB51*/
         B     @RC00060                                            0062
@RF00060 LA    EQCRETCD,4                                          0062
*   END GETTBLS;                    /*                       @Y30LB51*/
@EL00002 DS    0H                                                  0063
@EF00002 DS    0H                                                  0063
@ER00002 L     @14,@SA00002                                        0063
         BR    @14                                                 0063
*PRTHDR:                                                           0064
*   PROC OPTIONS(SAVE(14));         /*                       @XA14534*/
*                                                                  0064
PRTHDR   ST    @14,@SA00003                                        0064
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL PRINT THE REPORT HEADERS ON EACH PAGE OF THE*/
*   /* REPORT.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0065
*   OUTLINE=HEADER;                 /* PRINT THE REPORT TITLE.     0065
*                                                            @Y30LB51*/
         MVI   OUTLINE+91(CVTPTR),C' '                             0065
         MVC   OUTLINE+92(41,CVTPTR),OUTLINE+91(CVTPTR)            0065
         MVC   OUTLINE(91,CVTPTR),@CC00341                         0065
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB51*/
         L     @10,@PC00001                                        0066
         ST    @10,@AL00001                                        0066
         L     @15,@CV00337                                        0066
         LA    @01,@AL00001                                        0066
         BALR  @14,@15                                             0066
*   OUTLINE=SUBHDR;                 /* PRINT THE SUBHEADER LINE.   0067
*                                                            @Y30LB51*/
         MVI   OUTLINE+55(CVTPTR),C' '                             0067
         MVC   OUTLINE+56(77,CVTPTR),OUTLINE+55(CVTPTR)            0067
         MVC   OUTLINE(55,CVTPTR),@CC00350                         0067
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB51*/
         L     @10,@PC00001                                        0068
         ST    @10,@AL00001                                        0068
         L     @15,@CV00337                                        0068
         LA    @01,@AL00001                                        0068
         BALR  @14,@15                                             0068
*   OUTLINE='';                     /*                       @Y30LB51*/
         MVI   OUTLINE(CVTPTR),C' '                                0069
         MVC   OUTLINE+1(132,CVTPTR),OUTLINE(CVTPTR)               0069
*   DRIVEOUT=SUBHDRA;               /*                       @ZD00149*/
         MVC   DRIVEOUT(5,CVTPTR),@CC00355                         0070
*   SENSEOUT=SNSHDR;                /* PRINT THE SENSE HEADER.     0071
*                                                            @Y30LB51*/
         MVC   SENSEOUT(78,CVTPTR),@CC00357                        0071
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB51*/
         L     @10,@PC00001                                        0072
         ST    @10,@AL00001                                        0072
         L     @15,@CV00337                                        0072
         LA    @01,@AL00001                                        0072
         BALR  @14,@15                                             0072
*   OUTLINE='';                     /*                       @Y30LB51*/
         MVI   OUTLINE(CVTPTR),C' '                                0073
         MVC   OUTLINE+1(132,CVTPTR),OUTLINE(CVTPTR)               0073
*   END PRTHDR;                     /*                       @Y30LB51*/
@EL00003 DS    0H                                                  0074
@EF00003 DS    0H                                                  0074
@ER00003 L     @14,@SA00003                                        0074
         BR    @14                                                 0074
*PRTRPT:                                                           0075
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0075
PRTRPT   ST    @14,@SA00004                                        0075
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FORMAT THE DATA FROM THE EQC ACCUMULATOR    */
*   /* TABLE ELEMENTS AND CALL ISDAPRT0 TO PRINT THE REPORT.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0076
*   OUTLINE='';                     /* BLANK OUT THE OUTPUT LINE.  0076
*                                                            @Y30LB51*/
         MVI   OUTLINE(CVTPTR),C' '                                0076
         MVC   OUTLINE+1(132,CVTPTR),OUTLINE(CVTPTR)               0076
*   TBLPTR=OLDPTR;                  /* SET PTR TO FIRST EQC RECORD.
*                                                            @Y30LB51*/
         L     TBLPTR,OLDPTR(,EQCWKPTR)                            0077
*   DO WHILE TBLPTR^=0;             /*                       @Y30LB51*/
         B     @DE00078                                            0078
@DL00078 DS    0H                                                  0079
*     IF LINECT=LINENR THEN         /* IF LAST LINE FOR PAGE @Y30LB51*/
         CLC   LINECT(2,EQCWKPTR),@CH00323                         0079
         BNE   @RF00079                                            0079
*       DO;                         /* START A NEW PAGE.     @Y30LB51*/
*         LINECT=0;                 /* ZERO OUT THE COUNTER. @Y30LB51*/
         SLR   @10,@10                                             0081
         STH   @10,LINECT(,EQCWKPTR)                               0081
*         CALL PRTFOOT;             /* PRINT THE FOOTINGS.   @Y30LB51*/
         BAL   @14,PRTFOOT                                         0082
*         CALL PRTHDR;              /* PRINT HEADERS ON NEXT PAGE. 0083
*                                                            @Y30LB51*/
         BAL   @14,PRTHDR                                          0083
*       END;                        /*                       @Y30LB51*/
*     ELSE                                                         0085
*       ;                           /* NOT LAST LINE FOR PAGE.     0085
*                                                            @Y30LB51*/
@RF00079 DS    0H                                                  0086
*     CALL CVTRUA;                  /* TRANSLATE THE RUA.    @ZD00149*/
         BAL   @14,CVTRUA                                          0086
*     CALL CVTSSID;                 /* TRANSLATE THE SSID.   @Y30LB51*/
         BAL   @14,CVTSSID                                         0087
*     IF EQCAPR='1'B THEN           /* IF SSID ALTERED       @Y30LB51*/
         TM    EQCAPR(TBLPTR),B'00000100'                          0088
         BNO   @RF00088                                            0088
*       SSIDTYP='-A';               /* PUT 'A' IN SSID TYPE. @ZM30730*/
         MVC   SSIDTYP(2,CVTPTR),@CC00424                          0089
*     ELSE                                                         0090
*       ;                           /* NOT ALTERED SSID.     @ZD00149*/
@RF00088 DS    0H                                                  0091
*     CALL CVTFSC;                  /* TRANSLATE THE FSC.    @Y30LB51*/
         BAL   @14,CVTFSC                                          0091
*     CALL CVTTIME;                 /* FORMAT THE DATE/TIME STAMP. 0092
*                                                            @Y30LB51*/
         BAL   @14,CVTTIME                                         0092
*     IF DEVIN='1'B THEN            /* IF DEVICE IDS PRESENT @ZD00149*/
         TM    DEVIN(TBLPTR),B'10000000'                           0093
         BNO   @RF00093                                            0093
*       DO;                         /* PUT THEM INTO SKELETON.     0094
*                                                            @ZD00149*/
*         CONTLR=CNTLUNIT;          /* PUT CONTROL UNIT ID,  @ZD00149*/
         MVC   CONTLR(1,CVTPTR),CNTLUNIT(TBLPTR)                   0095
*         SPACE='60'X;              /* SPACE CHARACTER AND   @ZD00149*/
         MVI   SPACE(CVTPTR),X'60'                                 0096
*         IDDRIVE=UNITID;           /* DRIVE ID INTO SKELETON.     0097
*                                                            @ZD00149*/
         MVC   IDDRIVE(1,CVTPTR),UNITID(TBLPTR)                    0097
*       END;                        /*                       @ZD00149*/
*     ELSE                                                         0099
*       ;                           /* DEVICE IDS ARE NOT PRESENT. 0099
*                                                            @ZD00149*/
@RF00093 DS    0H                                                  0100
*     CALL CVTSENSE;                /* TRANSLATE THE SENSE.  @Y30LB51*/
         BAL   @14,CVTSENSE                                        0100
*     CALL ISDAPRT0(WORKPTR);       /* PRINT IT.             @Y30LB51*/
         L     @10,@PC00001                                        0101
         ST    @10,@AL00001                                        0101
         L     @15,@CV00337                                        0101
         LA    @01,@AL00001                                        0101
         BALR  @14,@15                                             0101
*     OUTLINE='';                   /* BLANK OUT THE OUTPUT LINE.  0102
*                                                            @Y30LB51*/
         MVI   OUTLINE(CVTPTR),C' '                                0102
         MVC   OUTLINE+1(132,CVTPTR),OUTLINE(CVTPTR)               0102
*     TBLPTR=EQCTPTR;               /* SET PTR TO NEXT CHAIN ENTRY.
*                                                            @Y30LB51*/
         L     TBLPTR,EQCTPTR(,TBLPTR)                             0103
*     LINECT=LINECT+1;              /* ADD ONE TO LINE COUNT.      0104
*                                                            @Y30LB51*/
         LA    @10,1                                               0104
         AH    @10,LINECT(,EQCWKPTR)                               0104
         STH   @10,LINECT(,EQCWKPTR)                               0104
*   END;                            /*                       @Y30LB51*/
@DE00078 LTR   TBLPTR,TBLPTR                                       0105
         BNZ   @DL00078                                            0105
*   CALL PRTFOOT;                   /* PRINT THE FOOTINGS.   @Y30LB51*/
         BAL   @14,PRTFOOT                                         0106
*   END PRTRPT;                     /*                       @Y30LB51*/
@EL00004 DS    0H                                                  0107
@EF00004 DS    0H                                                  0107
@ER00004 L     @14,@SA00004                                        0107
         BR    @14                                                 0107
*CVTRUA:                                                           0108
*   PROC OPTIONS(SAVE(14));         /*                       @ZD00149*/
*                                                                  0108
CVTRUA   ST    @14,12(,@13)                                        0108
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CONVERT THE REAL UNIT ADDRESS TO PRINTABLE  */
*   /* CHARACTERS AND DETERMINE THE RECORD TYPE.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0109
*   RUACVT(1)=EQCRUA(1);            /* GET FIRST BYTE OF RUA AND   0109
*                                                            @ZD00149*/
         MVC   RUACVT(1,TRANSPTR),EQCRUA(TBLPTR)                   0109
*   RUACVT(1)=RUACVT(1)&'0F'X;      /* ISOLATE FIRST CHARACTER.    0110
*                                                            @ZD00149*/
         NI    RUACVT(TRANSPTR),X'0F'                              0110
*   RUACVT(2)=EQCRUA(2);            /* GET SECOND BYTE OF RUA AND  0111
*                                                            @ZD00149*/
         MVC   RUACVT+1(1,TRANSPTR),EQCRUA+1(TBLPTR)               0111
*   SRL(RUACVT(2),4);               /* ISOLATE SECOND CHARACTER.   0112
*                                                            @ZD00149*/
         SLR   @10,@10                                             0112
         IC    @10,RUACVT+1(,TRANSPTR)                             0112
         SRL   @10,4                                               0112
         STC   @10,RUACVT+1(,TRANSPTR)                             0112
*   RUACVT(3)=EQCRUA(2);            /* GET SECOND BYTE OF RUA AND  0113
*                                                            @ZD00149*/
         MVC   RUACVT+2(1,TRANSPTR),EQCRUA+1(TBLPTR)               0113
*   RUACVT(3)=RUACVT(3)&'0F'X;      /* ISOLATE THIRD CHARACTER.    0114
*                                                            @ZD00149*/
         NI    RUACVT+2(TRANSPTR),X'0F'                            0114
*   TR(RUACVT,TRANSTAB);            /* TRANSLATE RUA TO PRINTABLE. 0115
*                                                            @ZD00149*/
         TR    RUACVT(3,TRANSPTR),@CC00330                         0115
*   RUAOUT=RUACVT;                  /* PUT RUA INTO SKELETON.      0116
*                                                            @ZD00149*/
         MVI   RUAOUT+3(CVTPTR),C' '                               0116
         MVI   RUAOUT+4(CVTPTR),C' '                               0116
         MVC   RUAOUT(3,CVTPTR),RUACVT(TRANSPTR)                   0116
*   IF REALDASD='1'B THEN           /* IF A REAL DASD RECORD @ZD00149*/
         TM    REALDASD(TBLPTR),B'00100000'                        0117
         BNO   @RF00117                                            0117
*     RUATYPE='-R';                 /* PUT IT IN SKELETON.   @ZM30730*/
         MVC   RUATYPE(2,CVTPTR),@CC00435                          0118
*   ELSE                            /* NOT A REAL DASD RECORD.     0119
*                                                            @ZD00149*/
*     IF VIRTDASD='1'B THEN         /* IF A VIRTUAL DASD RECORD    0119
*                                                            @ZD00149*/
         B     @RC00117                                            0119
@RF00117 TM    VIRTDASD(TBLPTR),B'00010000'                        0119
         BNO   @RF00119                                            0119
*       IF EQCSENSE(25)='FF'X THEN  /* INVALID RUA           @ZA12870*/
         CLI   EQCSENSE+24(TBLPTR),X'FF'                           0120
         BNE   @RF00120                                            0120
*         RUATYPE='-V';             /* YES, HAVE VUA INSTEAD @ZA12870*/
         MVC   RUATYPE(2,CVTPTR),@CC00438                          0121
*       ELSE                        /* NO, RUA IS OK         @ZA12870*/
*         RUATYPE='-S';             /* PUT IT IN SKELETON.   @ZM30730*/
         B     @RC00120                                            0122
@RF00120 MVC   RUATYPE(2,CVTPTR),@CC00439                          0122
*     ELSE                          /* NOT A VIRTUAL DASD RECORD,  0123
*                                      EITHER,               @ZD00149*/
*       RUATYPE='-M';               /* PUT MSC RECORD INTO SKELETON.
*                                                            @ZM30730*/
         B     @RC00119                                            0123
@RF00119 MVC   RUATYPE(2,CVTPTR),@CC00440                          0123
*   END CVTRUA;                     /*                       @ZD00149*/
@EL00005 DS    0H                                                  0124
@EF00005 DS    0H                                                  0124
@ER00005 L     @14,12(,@13)                                        0124
         BR    @14                                                 0124
*CVTSSID:                                                          0125
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0125
CVTSSID  ST    @14,12(,@13)                                        0125
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CONVERT THE SSID TO PRINTABLE CHARACTERS AND*/
*   /* DETERMINE THE DEVICE TYPE.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*   IF REALDASD='0'B THEN           /* IF NOT A REAL DASD RECORD   0126
*                                                            @ZD00149*/
         TM    REALDASD(TBLPTR),B'00100000'                        0126
         BNZ   @RF00126                                            0126
*     DO;                           /* CONVERT THE SSID.     @ZD00149*/
*       SSIDCVT(1)=EQCSSID(1);      /* GET FIRST BYTE SSID AND     0128
*                                                            @Y30LB51*/
         MVC   SSIDCVT(1,TRANSPTR),EQCSSID(TBLPTR)                 0128
*       SSIDCVT(1)=SSIDCVT(1)&'0F'X;/* ISOLATE FIRST CHARACTER.    0129
*                                                            @Y30LB51*/
         NI    SSIDCVT(TRANSPTR),X'0F'                             0129
*       SSIDCVT(2)=EQCSSID(2);      /* GET SECOND BYTE SSID AND    0130
*                                                            @Y30LB51*/
         MVC   SSIDCVT+1(1,TRANSPTR),EQCSSID+1(TBLPTR)             0130
*       SRL(SSIDCVT(2),4);          /* ISOLATE SECOND CHARACTER.   0131
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0131
         IC    @10,SSIDCVT+1(,TRANSPTR)                            0131
         SRL   @10,4                                               0131
         STC   @10,SSIDCVT+1(,TRANSPTR)                            0131
*       SSIDCVT(3)=EQCSSID(2);      /* GET SECOND BYTE SSID AND    0132
*                                                            @Y30LB51*/
         MVC   SSIDCVT+2(1,TRANSPTR),EQCSSID+1(TBLPTR)             0132
*       SSIDCVT(3)=SSIDCVT(3)&'0F'X;/* ISOLATE THIRD CHARACTER.    0133
*                                                            @Y30LB51*/
         NI    SSIDCVT+2(TRANSPTR),X'0F'                           0133
*       TR(SSIDCVT,TRANSTAB);       /* TRANSLATE SSID TO PRINTABLE.
*                                                            @Y30LB51*/
         TR    SSIDCVT(3,TRANSPTR),@CC00330                        0134
*       SSIDOUT=SSIDCVT;            /* PUT SSID IN SKELETON. @Y30LB51*/
         MVI   SSIDOUT+3(CVTPTR),C' '                              0135
         MVI   SSIDOUT+4(CVTPTR),C' '                              0135
         MVC   SSIDOUT(3,CVTPTR),SSIDCVT(TRANSPTR)                 0135
*     END;                          /*                       @ZD00149*/
*   ELSE                                                           0137
*     ;                             /* THIS IS A REAL DASD RECORD. 0137
*                                                            @ZD00149*/
@RF00126 DS    0H                                                  0138
*   END CVTSSID;                    /*                       @Y30LB51*/
@EL00006 DS    0H                                                  0138
@EF00006 DS    0H                                                  0138
@ER00006 L     @14,12(,@13)                                        0138
         BR    @14                                                 0138
*CVTFSC:                                                           0139
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0139
CVTFSC   ST    @14,12(,@13)                                        0139
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CONVERT THE FSC TO PRINTABLE CHARACTERS.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0140
*   IF EQCNOFSC='1'B THEN           /* IF NO FSC PRESENT     @Y30LB51*/
         TM    EQCNOFSC(TBLPTR),B'00001000'                        0140
         BNO   @RF00140                                            0140
*     FSCAREA=''B;                  /* PUT BLANKS IN SKELETON.     0141
*                                                            @Y30LB51*/
         XC    FSCAREA(8,CVTPTR),FSCAREA(CVTPTR)                   0141
*   ELSE                            /* THERE IS AN FSC.      @Y30LB51*/
*     IF CSFLAG='1'B THEN           /* IF A LIBRARY DEVICE   @Y30LB51*/
         B     @RC00140                                            0142
@RF00140 TM    CSFLAG(TBLPTR),B'00000001'                          0142
         BNO   @RF00142                                            0142
*       DO;                         /* CONVERT THE LIBRARY FSC.    0143
*                                                            @Y30LB51*/
*         FSCCVT(1)=EQCFSC(1);      /* ISOLATE THE CHARACTERS OF THE
*                                      FSC.                  @Y30LB51*/
         MVC   FSCCVT(1,TRANSPTR),EQCFSC(TBLPTR)                   0144
*         SRL(FSCCVT(1),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0145
         IC    @10,FSCCVT(,TRANSPTR)                               0145
         SRL   @10,4                                               0145
         STC   @10,FSCCVT(,TRANSPTR)                               0145
*         FSCCVT(2)=EQCFSC(1);      /*                       @Y30LB51*/
         MVC   FSCCVT+1(1,TRANSPTR),EQCFSC(TBLPTR)                 0146
*         FSCCVT(2)=FSCCVT(2)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+1(TRANSPTR),X'0F'                            0147
*         FSCCVT(3)=EQCFSC(2);      /*                       @Y30LB51*/
         MVC   FSCCVT+2(1,TRANSPTR),EQCFSC+1(TBLPTR)               0148
*         SRL(FSCCVT(3),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0149
         IC    @10,FSCCVT+2(,TRANSPTR)                             0149
         SRL   @10,4                                               0149
         STC   @10,FSCCVT+2(,TRANSPTR)                             0149
*         FSCCVT(4)=EQCFSC(2);      /*                       @Y30LB51*/
         MVC   FSCCVT+3(1,TRANSPTR),EQCFSC+1(TBLPTR)               0150
*         FSCCVT(4)=FSCCVT(4)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+3(TRANSPTR),X'0F'                            0151
*         FSCCVT(5)=EQCFSC(3);      /*                       @Y30LB51*/
         MVC   FSCCVT+4(1,TRANSPTR),EQCFSC+2(TBLPTR)               0152
*         SRL(FSCCVT(5),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0153
         IC    @10,FSCCVT+4(,TRANSPTR)                             0153
         SRL   @10,4                                               0153
         STC   @10,FSCCVT+4(,TRANSPTR)                             0153
*         FSCCVT(6)=EQCFSC(3);      /*                       @Y30LB51*/
         MVC   FSCCVT+5(1,TRANSPTR),EQCFSC+2(TBLPTR)               0154
*         FSCCVT(6)=FSCCVT(6)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+5(TRANSPTR),X'0F'                            0155
*         FSCCVT(7)=EQCFSC(4);      /*                       @Y30LB51*/
         MVC   FSCCVT+6(1,TRANSPTR),EQCFSC+3(TBLPTR)               0156
*         SRL(FSCCVT(7),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0157
         IC    @10,FSCCVT+6(,TRANSPTR)                             0157
         SRL   @10,4                                               0157
         STC   @10,FSCCVT+6(,TRANSPTR)                             0157
*         FSCCVT(8)=EQCFSC(4);      /*                       @Y30LB51*/
         MVC   FSCCVT+7(1,TRANSPTR),EQCFSC+3(TBLPTR)               0158
*         FSCCVT(8)=FSCCVT(8)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+7(TRANSPTR),X'0F'                            0159
*         TR(FSCCVT,TRANSTAB);      /* CONVERT FSC TO PRINTABLE AND
*                                                            @Y30LB51*/
         TR    FSCCVT(8,TRANSPTR),@CC00330                         0160
*         FSCAREA=FSCCVT;           /* PUT IT IN SKELETON.   @Y30LB51*/
         MVC   FSCAREA(8,CVTPTR),FSCCVT(TRANSPTR)                  0161
*       END;                        /*                       @Y30LB51*/
*     ELSE                          /* IT IS A NON-LIBRARY FSC.    0163
*                                                            @Y30LB51*/
*       DO;                         /* CONVERT IT TO PRINTABLE.    0163
*                                                            @Y30LB51*/
         B     @RC00142                                            0163
@RF00142 DS    0H                                                  0164
*         FSCCVT(1)=EQCFSC(1);      /*                       @Y30LB51*/
         MVC   FSCCVT(1,TRANSPTR),EQCFSC(TBLPTR)                   0164
*         SRL(FSCCVT(1),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0165
         IC    @10,FSCCVT(,TRANSPTR)                               0165
         SRL   @10,4                                               0165
         STC   @10,FSCCVT(,TRANSPTR)                               0165
*         FSCCVT(2)=EQCFSC(1);      /*                       @Y30LB51*/
         MVC   FSCCVT+1(1,TRANSPTR),EQCFSC(TBLPTR)                 0166
*         FSCCVT(2)=FSCCVT(2)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+1(TRANSPTR),X'0F'                            0167
*         FSCCVT(3)=EQCFSC(2);      /*                       @Y30LB51*/
         MVC   FSCCVT+2(1,TRANSPTR),EQCFSC+1(TBLPTR)               0168
*         SRL(FSCCVT(3),4);         /*                       @Y30LB51*/
         SLR   @10,@10                                             0169
         IC    @10,FSCCVT+2(,TRANSPTR)                             0169
         SRL   @10,4                                               0169
         STC   @10,FSCCVT+2(,TRANSPTR)                             0169
*         FSCCVT(4)=EQCFSC(2);      /*                       @Y30LB51*/
         MVC   FSCCVT+3(1,TRANSPTR),EQCFSC+1(TBLPTR)               0170
*         FSCCVT(4)=FSCCVT(4)&'0F'X;/*                       @Y30LB51*/
         NI    FSCCVT+3(TRANSPTR),X'0F'                            0171
*         TR(FSCNLIB,TRANSTAB);     /* CONVERT FSC TO PRINTABLE AND
*                                                            @Y30LB51*/
         TR    FSCNLIB(4,TRANSPTR),@CC00330                        0172
*         FSCAREAN=FSCNLIB;         /* PUT IT IN SKELETON.   @Y30LB51*/
         MVC   FSCAREAN(4,CVTPTR),FSCNLIB(TRANSPTR)                0173
*         IF FAKEFSC='1'B THEN      /* IF GENERATED FSC      @Y30LB51*/
         TM    FAKEFSC(TBLPTR),B'10000000'                         0174
         BNO   @RF00174                                            0174
*           FSCTYPE='*';            /* PUT INDICATOR IN SKELETON.  0175
*                                                            @Y30LB51*/
         MVI   FSCTYPE(CVTPTR),C'*'                                0175
*         ELSE                                                     0176
*           ;                       /* NOT A GENERATED FSC.  @Y30LB51*/
@RF00174 DS    0H                                                  0177
*       END;                        /*                       @Y30LB51*/
*   END CVTFSC;                     /*                       @Y30LB51*/
@EL00007 DS    0H                                                  0178
@EF00007 DS    0H                                                  0178
@ER00007 L     @14,12(,@13)                                        0178
         BR    @14                                                 0178
*CVTTIME:                                                          0179
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0179
CVTTIME  ST    @14,12(,@13)                                        0179
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CONVERT THE DATE/TIME STAMP INTO THE FORM   */
*   /* 'DDD/YY HH:MM:SS'.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0180
*   UNPK(DDAY,EQCDAY);              /* CONVERT DAY.          @Y30LB51*/
         UNPK  DDAY(3,TRANSPTR),EQCDAY(2,TBLPTR)                   0180
*   DYR(1)=EQCYR(2);                /* CONVERT YEAR.         @Y30LB51*/
         MVC   DYR(1,TRANSPTR),EQCYR+1(TBLPTR)                     0181
*   SRL(DYR(1),4);                  /*                       @Y30LB51*/
         SLR   @10,@10                                             0182
         IC    @10,DYR(,TRANSPTR)                                  0182
         SRL   @10,4                                               0182
         STC   @10,DYR(,TRANSPTR)                                  0182
*   DYR(2)=EQCYR(2);                /*                       @Y30LB51*/
         MVC   DYR+1(1,TRANSPTR),EQCYR+1(TBLPTR)                   0183
*   DYR=DYR×'00';                   /*                       @Y30LB51*/
         OC    DYR(2,TRANSPTR),@CC00454                            0184
*   DSLASH='/';                     /* INSERT SLASH.         @Y30LB51*/
         MVI   DSLASH(TRANSPTR),C'/'                               0185
*   DBLANK='';                      /* INSERT BLANK.         @Y30LB51*/
         MVI   DBLANK(TRANSPTR),C' '                               0186
*   DHR(1)=EQCHR;                   /* CONVERT HOURS.        @Y30LB51*/
         MVC   DHR(1,TRANSPTR),EQCHR(TBLPTR)                       0187
*   SRL(DHR(1),4);                  /*                       @Y30LB51*/
         SLR   @10,@10                                             0188
         IC    @10,DHR(,TRANSPTR)                                  0188
         SRL   @10,4                                               0188
         STC   @10,DHR(,TRANSPTR)                                  0188
*   DHR(2)=EQCHR;                   /*                       @Y30LB51*/
         MVC   DHR+1(1,TRANSPTR),EQCHR(TBLPTR)                     0189
*   DHR=DHR×'00';                   /*                       @Y30LB51*/
         OC    DHR(2,TRANSPTR),@CC00454                            0190
*   DCOLON=':';                     /* INSERT COLON.         @Y30LB51*/
         MVI   DCOLON(TRANSPTR),C':'                               0191
*   DMIN(1)=EQCMIN;                 /* CONVERT MINUTES.      @Y30LB51*/
         MVC   DMIN(1,TRANSPTR),EQCMIN(TBLPTR)                     0192
*   SRL(DMIN(1),4);                 /*                       @Y30LB51*/
         SLR   @10,@10                                             0193
         IC    @10,DMIN(,TRANSPTR)                                 0193
         SRL   @10,4                                               0193
         STC   @10,DMIN(,TRANSPTR)                                 0193
*   DMIN(2)=EQCMIN;                 /*                       @Y30LB51*/
         MVC   DMIN+1(1,TRANSPTR),EQCMIN(TBLPTR)                   0194
*   DMIN=DMIN×'00';                 /*                       @Y30LB51*/
         OC    DMIN(2,TRANSPTR),@CC00454                           0195
*   DCOLONA=':';                    /* INSERT COLON.         @Y30LB51*/
         MVI   DCOLONA(TRANSPTR),C':'                              0196
*   DSEC(1)=EQCSEC;                 /* CONVERT SECONDS.      @Y30LB51*/
         MVC   DSEC(1,TRANSPTR),EQCSEC(TBLPTR)                     0197
*   SRL(DSEC(1),4);                 /*                       @Y30LB51*/
         SLR   @10,@10                                             0198
         IC    @10,DSEC(,TRANSPTR)                                 0198
         SRL   @10,4                                               0198
         STC   @10,DSEC(,TRANSPTR)                                 0198
*   DSEC(2)=EQCSEC;                 /*                       @Y30LB51*/
         MVC   DSEC+1(1,TRANSPTR),EQCSEC(TBLPTR)                   0199
*   DSEC=DSEC×'00';                 /*                       @Y30LB51*/
         OC    DSEC(2,TRANSPTR),@CC00454                           0200
*   DCOLONB=':';                    /* INSERT COLON.         @Y30LB51*/
         MVI   DCOLONB(TRANSPTR),C':'                              0201
*   DHSEC(1)=EQCHSEC;               /* CONVERT HUNDREDTHS    @Y30LB51*/
         MVC   DHSEC(1,TRANSPTR),EQCHSEC(TBLPTR)                   0202
*   SRL(DHSEC(1),4);                /* OF SECONDS.           @Y30LB51*/
         SLR   @10,@10                                             0203
         IC    @10,DHSEC(,TRANSPTR)                                0203
         SRL   @10,4                                               0203
         STC   @10,DHSEC(,TRANSPTR)                                0203
*   DHSEC(2)=EQCHSEC;               /*                       @Y30LB51*/
         MVC   DHSEC+1(1,TRANSPTR),EQCHSEC(TBLPTR)                 0204
*   DHSEC=DHSEC×'00';               /*                       @Y30LB51*/
         OC    DHSEC(2,TRANSPTR),@CC00454                          0205
*   TIMSTAMP=TIMEAREA;              /* PUT DATE/TIME INTO SKELETON.
*                                                            @Y30LB51*/
         MVC   TIMSTAMP(18,CVTPTR),TIMEAREA(TRANSPTR)              0206
*   END CVTTIME;                    /*                       @Y30LB51*/
@EL00008 DS    0H                                                  0207
@EF00008 DS    0H                                                  0207
@ER00008 L     @14,12(,@13)                                        0207
         BR    @14                                                 0207
*CVTSENSE:                                                         0208
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0208
CVTSENSE ST    @14,12(,@13)                                        0208
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL CONVERT THE SENSE DATA INTO PRINTABLE       */
*   /* CHARACTERS AND PLACE IT INTO THE OUTPUT LINE SKELETON. SENSE  */
*   /* WILL BE PLACED INTO FOUR BYTE GROUPINGS SEPARATED BY A SPACE. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*   K=1;                            /* SET WORK POINTER.     @Y30LB51*/
         MVC   K(2,EQCWKPTR),@CH00081                              0209
*   IF DASDFLAG='1'B THEN           /* IF DASD RECORD        @Y30LB51*/
         TM    DASDFLAG(TBLPTR),B'01000000'                        0210
         BNO   @RF00210                                            0210
*     IF REALDASD='1'B THEN         /* AND IF REAL DASD RECORD     0211
*                                                            @Y30LB51*/
         TM    REALDASD(TBLPTR),B'00100000'                        0211
         BNO   @RF00211                                            0211
*       SENSELEN=REALSENS;          /* SET REAL DASD LENGTH. @Y30LB51*/
         MVC   SENSELEN(2,EQCWKPTR),@CH00071                       0212
*     ELSE                          /* NOT REAL DASD RECORD, @Y30LB51*/
*       SENSELEN=VIRTSENS;          /* SET VIRTUAL DASD SENSE LENGTH.
*                                                            @Y30LB51*/
         B     @RC00211                                            0213
@RF00211 MVC   SENSELEN(2,EQCWKPTR),@CH00166                       0213
*   ELSE                            /* NOT DASD RECORD,      @Y30LB51*/
*     SENSELEN=SYSSENSE;            /* SET SUBSYSTEM SENSE LENGTH. 0214
*                                                            @Y30LB51*/
         B     @RC00210                                            0214
@RF00210 MVC   SENSELEN(2,EQCWKPTR),@CH00264                       0214
*   DO J=1 BY 4 TO SENSELEN;        /* TRANSLATE THE SENSE.  @Y30LB51*/
@RC00210 LA    @10,1                                               0215
         STH   @10,J(,EQCWKPTR)                                    0215
         B     @DE00215                                            0215
@DL00215 DS    0H                                                  0216
*     UNPK(SENSEOUT(K:K+8),EQCSENSE(J:J+4));/* UNPACK THE SENSE BYTES
*                                      INTO OUTPUT SKELETON. @Y30LB51*/
         LH    @10,K(,EQCWKPTR)                                    0216
         ALR   @10,CVTPTR                                          0216
         LH    @07,J(,EQCWKPTR)                                    0216
         ALR   @07,TBLPTR                                          0216
         UNPK  SENSEOUT-1(9,@10),EQCSENSE-1(5,@07)                 0216
*     SENSEOUT(K+8)='';             /* INSERT BLANK.         @Y30LB51*/
         LH    @10,K(,EQCWKPTR)                                    0217
         ALR   @10,CVTPTR                                          0217
         MVI   SENSEOUT+7(@10),C' '                                0217
*     DO L=K TO K+7;                /* TRANSLATE CHARACTERS TO     0218
*                                      PRINTABLE.            @Y30LB51*/
         LH    @10,K(,EQCWKPTR)                                    0218
         B     @DE00218                                            0218
@DL00218 DS    0H                                                  0219
*       IF SENSEOUT(L)>'9' THEN     /* IF CHARACTER IS ALPHA @Y30LB51*/
         LH    @10,L(,EQCWKPTR)                                    0219
         ALR   @10,CVTPTR                                          0219
         CLI   SENSEOUT-1(@10),C'9'                                0219
         BNH   @RF00219                                            0219
*         SENSEOUT(L)=SENSEOUT(L)-'39'X;/* MAKE IT PRINTABLE.      0220
*                                                            @Y30LB51*/
         LH    @10,L(,EQCWKPTR)                                    0220
         SLR   @07,@07                                             0220
         IC    @07,SENSEOUT-1(@10,CVTPTR)                          0220
         SH    @07,@CH00461                                        0220
         STC   @07,SENSEOUT-1(@10,CVTPTR)                          0220
*       ELSE                                                       0221
*         ;                         /* CHARACTER IS NUMERIC AND    0221
*                                      PRINTABLE.            @Y30LB51*/
@RF00219 DS    0H                                                  0222
*     END;                          /*                       @Y30LB51*/
         LA    @10,1                                               0222
         AH    @10,L(,EQCWKPTR)                                    0222
@DE00218 STH   @10,L(,EQCWKPTR)                                    0222
         LA    @07,7                                               0222
         AH    @07,K(,EQCWKPTR)                                    0222
         CR    @10,@07                                             0222
         BNH   @DL00218                                            0222
*     K=K+10;                       /* BUMP OUTPUT WORK POINTER.   0223
*                                                            @Y30LB51*/
         LA    @10,10                                              0223
         AH    @10,K(,EQCWKPTR)                                    0223
         STH   @10,K(,EQCWKPTR)                                    0223
*   END;                            /*                       @Y30LB51*/
         LA    @10,4                                               0224
         AH    @10,J(,EQCWKPTR)                                    0224
         STH   @10,J(,EQCWKPTR)                                    0224
@DE00215 CH    @10,SENSELEN(,EQCWKPTR)                             0224
         BNH   @DL00215                                            0224
*   END CVTSENSE;                   /*                       @Y30LB51*/
@EL00009 DS    0H                                                  0225
@EF00009 DS    0H                                                  0225
@ER00009 L     @14,12(,@13)                                        0225
         BR    @14                                                 0225
*PRTFOOT:                                                          0226
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/
*                                                                  0226
PRTFOOT  ST    @14,@SA00010                                        0226
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL PRINT THE FOOTINGS ON EACH PAGE OF THE      */
*   /* REPORT.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0227
*   OUTLINE=FOOT1;                  /*                       @Y30LB51*/
         MVI   OUTLINE+99(CVTPTR),C' '                             0227
         MVC   OUTLINE+100(33,CVTPTR),OUTLINE+99(CVTPTR)           0227
         MVC   OUTLINE(99,CVTPTR),@CC00365                         0227
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB51*/
         L     @10,@PC00001                                        0228
         ST    @10,@AL00001                                        0228
         L     @15,@CV00337                                        0228
         LA    @01,@AL00001                                        0228
         BALR  @14,@15                                             0228
*   OUTLINE=FOOT2;                  /*                       @Y30LB51*/
         MVI   OUTLINE+98(CVTPTR),C' '                             0229
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)            0229
         MVC   OUTLINE(98,CVTPTR),@CC00374                         0229
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB51*/
         L     @10,@PC00001                                        0230
         ST    @10,@AL00001                                        0230
         L     @15,@CV00337                                        0230
         LA    @01,@AL00001                                        0230
         BALR  @14,@15                                             0230
*   OUTLINE='';                     /*                       @Y30LB51*/
         MVI   OUTLINE(CVTPTR),C' '                                0231
         MVC   OUTLINE+1(132,CVTPTR),OUTLINE(CVTPTR)               0231
*   END PRTFOOT;                    /*                       @Y30LB51*/
@EL00010 DS    0H                                                  0232
@EF00010 DS    0H                                                  0232
@ER00010 L     @14,@SA00010                                        0232
         BR    @14                                                 0232
*FREECORE:                                                         0233
*   PROC OPTIONS(SAVE(14));         /*                       @XA14534*/
*                                                                  0233
FREECORE ST    @14,@SA00011                                        0233
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL FREE ALL GOTTEN CORE VIA THE ISDAFREE       */
*   /* ROUTINE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   SPNO='05'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/
         MVI   SPNO(CVTPTR),X'05'                                  0234
*   IF TRANSPTR^=0 THEN             /* IF TRANSLATION AREA EXISTS  0235
*                                                            @Y30LB51*/
         LTR   TRANSPTR,TRANSPTR                                   0235
         BZ    @RF00235                                            0235
*     DO;                           /* FREE IT.              @Y30LB51*/
*       CORELEN=LENGTH(CVTAREA);    /* GET TRANSLATION AREA LENGTH 0237
*                                                            @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00264+1                        0237
*       COREADDR=TRANSPTR;          /* AND ADDRESS           @Y30LB51*/
         ST    TRANSPTR,COREADDR(,CVTPTR)                          0238
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/
         L     @10,@PC00001                                        0239
         ST    @10,@AL00001                                        0239
         L     @15,@CV00338                                        0239
         LA    @01,@AL00001                                        0239
         BALR  @14,@15                                             0239
*     END;                          /*                       @Y30LB51*/
*   ELSE                                                           0241
*     ;                             /* TRANSLATION AREA DOES NOT   0241
*                                      EXIST.                @Y30LB51*/
@RF00235 DS    0H                                                  0242
*   IF GET0PTR^=0 THEN              /* IF ACCUMULATOR TABLE EXISTS 0242
*                                                            @Y30LB51*/
         L     @10,GET0PTR(,EQCWKPTR)                              0242
         LTR   @10,@10                                             0242
         BZ    @RF00242                                            0242
*     DO;                           /* FREE IT.              @Y30LB51*/
*       CORELEN=LENGTH(ISDAGHDR)+LENGTH(EQCTBL)*TBLNR;/*           0244
*                                         GET EQC TABLE LENGTH     0244
*                                                            @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00471+1                        0244
*       COREADDR=GET0PTR;           /* AND ADDRESS           @Y30LB51*/
         ST    @10,COREADDR(,CVTPTR)                               0245
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/
         L     @10,@PC00001                                        0246
         ST    @10,@AL00001                                        0246
         L     @15,@CV00338                                        0246
         LA    @01,@AL00001                                        0246
         BALR  @14,@15                                             0246
*     END;                          /*                       @Y30LB51*/
*   ELSE                                                           0248
*     ;                             /* ACCUMULATOR TABLE EXISTS.   0248
*                                                            @Y30LB51*/
@RF00242 DS    0H                                                  0249
*   IF EQC00PTR^=0 THEN             /* IF WORK AREA EXISTS   @Y30LB51*/
         ICM   @10,15,EQC00PTR(CVTPTR)                             0249
         BZ    @RF00249                                            0249
*     DO;                           /* FREE IT.              @Y30LB51*/
*       CORELEN=LENGTH(EQCWORK);    /* GET WORK AREA LENGTH  @Y30LB51*/
         MVC   CORELEN(3,CVTPTR),@CF00469+1                        0251
*       COREADDR=EQCWKPTR;          /* AND ADDRESS           @Y30LB51*/
         ST    EQCWKPTR,COREADDR(,CVTPTR)                          0252
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/
         L     @10,@PC00001                                        0253
         ST    @10,@AL00001                                        0253
         L     @15,@CV00338                                        0253
         LA    @01,@AL00001                                        0253
         BALR  @14,@15                                             0253
*     END;                          /*                       @Y30LB51*/
*   ELSE                                                           0255
*     ;                             /* WORK AREA DOES NOT EXIST.   0255
*                                                            @Y30LB51*/
@RF00249 DS    0H                                                  0256
*   EQC00PTR=0;                     /* SET WORK AREA ADDRESS TO ZERO.
*                                                            @Y30LB51*/
         SLR   @10,@10                                             0256
         ST    @10,EQC00PTR(,CVTPTR)                               0256
*   END FREECORE;                   /*                       @Y30LB51*/
@EL00011 DS    0H                                                  0257
@EF00011 DS    0H                                                  0257
@ER00011 L     @14,@SA00011                                        0257
         BR    @14                                                 0257
*   END ISDAEQC1                    /*                       @Y30LB51*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDAEQC5)                                        *
*;                                                                 0258
@DATA    DS    0H
@CH00081 DC    H'1'
@CH00071 DC    H'24'
@CH00166 DC    H'28'
@CH00323 DC    H'50'
@CH00461 DC    XL2'39'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00004 DS    1F
@SA00010 DS    0F
@SA00011 DS    0F
@SA00003 DS    0F
@SA00002 DS    0F
         DS    1F
@AL00001 DS    1A
ISDAEQC1 CSECT
         DS    0F
@CF00264 DC    F'32'
@CH00264 EQU   @CF00264+2
@CF00469 DC    F'56'
@CF00471 DC    F'5628'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAEQC1 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00336 DC    V(ISDAGET1)
@CV00337 DC    V(ISDAPRT0)
@CV00338 DC    V(ISDAFREE)
@CV00335 DC    V(ISDAGET0)
         DS    0D
@CC00365 DC    C'0   S = STAGING DASD DEVICE UNIT ADDRESS    M = MSC DEC
               VICE UNIT ADDRESS    * = FSC GENERATED BY SDA'
@CC00374 DC    C'    R = REAL DASD DEVICE UNIT ADDRESS       V = VIRTUAC
               L UNIT ADDRESS       A = SSID ALTERED BY APR'
@CC00341 DC    C'1REPORT 7 - EQUIPMENT CHECK AND DATA CHECK RECORDS    C
                   MOST RECENT RECORDS (MAXIMUM 100)'
@CC00357 DC    C'00..02..  04..06..  08..10..  12..14..  16..18..  20..C
               22..  24..26..  28..30..'
@CC00350 DC    C'0RUA   SSID  FSC       DATE   TIME         CNTLR  SENSC
               E'
@CC00330 DC    C'0123456789ABCDEF'
@CC00355 DC    C'DRIVE'
@CC00424 DC    C'-A'
@CC00435 DC    C'-R'
@CC00438 DC    C'-V'
@CC00439 DC    C'-S'
@CC00440 DC    C'-M'
@CC00454 EQU   @CC00357
PATCH    DS    CL50
         ORG   PATCH
@NM00029 DC    50X'00'
         ORG   PATCH+50
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
TRANSPTR EQU   @03
EQCRETCD EQU   @06
TBLPTR   EQU   @04
EQCWKPTR EQU   @05
LPARMPTR EQU   @03
CVTPTR   EQU   @02
RF       EQU   @15
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
SDA00PTR EQU   CVTPTRS0+12
EQC00PTR EQU   CVTPTRS0+60
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
ISDAWORK EQU   0
INFLAGS  EQU   ISDAWORK
INRECCUA EQU   ISDAWORK+6
ISDAMSCS EQU   0
SUBSYSID EQU   ISDAMSCS+1
SSID     EQU   SUBSYSID
SUBSENSE EQU   ISDAMSCS+4
SUBFMTMG EQU   SUBSENSE+7
ISDAGHDR EQU   0
GET0SPLN EQU   ISDAGHDR+8
EQCWORK  EQU   0
GET0PTR  EQU   EQCWORK
SENSEPTR EQU   EQCWORK+12
OLDPTR   EQU   EQCWORK+20
SSIDSAVE EQU   EQCWORK+26
LINECT   EQU   EQCWORK+40
J        EQU   EQCWORK+44
K        EQU   EQCWORK+46
L        EQU   EQCWORK+48
SENSELEN EQU   EQCWORK+50
EQCSW    EQU   EQCWORK+52
DEVBYTES EQU   EQCWORK+54
EQCTBL   EQU   0
EQCTPTR  EQU   EQCTBL
EQCRUA   EQU   EQCTBL+4
EQCSSID  EQU   EQCTBL+6
EQCFLAGS EQU   EQCTBL+8
FAKEFSC  EQU   EQCFLAGS
DASDFLAG EQU   EQCFLAGS
REALDASD EQU   EQCFLAGS
VIRTDASD EQU   EQCFLAGS
EQCNOFSC EQU   EQCFLAGS
EQCAPR   EQU   EQCFLAGS
CSFLAG   EQU   EQCFLAGS
DEVIN    EQU   EQCFLAGS+1
EQCFSC   EQU   EQCTBL+10
EQCDT    EQU   EQCTBL+14
EQCDATE  EQU   EQCDT
EQCYR    EQU   EQCDATE
EQCDAY   EQU   EQCDATE+2
EQCTIME  EQU   EQCDT+4
EQCHR    EQU   EQCTIME
EQCMIN   EQU   EQCTIME+1
EQCSEC   EQU   EQCTIME+2
EQCHSEC  EQU   EQCTIME+3
EQCUNIT  EQU   EQCTBL+22
CNTLUNIT EQU   EQCUNIT
UNITID   EQU   EQCUNIT+1
EQCSENSE EQU   EQCTBL+24
MSCDASD  EQU   0
FMTMSG   EQU   MSCDASD+7
DASD10   EQU   MSCDASD+10
CVTAREA  EQU   0
RUACVT   EQU   CVTAREA
SSIDCVT  EQU   CVTAREA+3
FSCCVT   EQU   CVTAREA+6
FSCNLIB  EQU   FSCCVT
TIMEAREA EQU   CVTAREA+14
DDAY     EQU   TIMEAREA
DSLASH   EQU   TIMEAREA+3
DYR      EQU   TIMEAREA+4
DBLANK   EQU   TIMEAREA+6
DHR      EQU   TIMEAREA+7
DCOLON   EQU   TIMEAREA+9
DMIN     EQU   TIMEAREA+10
DCOLONA  EQU   TIMEAREA+12
DSEC     EQU   TIMEAREA+13
DCOLONB  EQU   TIMEAREA+15
DHSEC    EQU   TIMEAREA+16
WORKPTR  EQU   0
EQCOUT   EQU   OUTLINE
RUAOUT   EQU   EQCOUT+1
RUATYPE  EQU   RUAOUT+3
SSIDOUT  EQU   EQCOUT+7
SSIDTYP  EQU   SSIDOUT+3
FSCAREA  EQU   EQCOUT+13
FSCAREAN EQU   FSCAREA
FSCTYPE  EQU   FSCAREA+4
TIMSTAMP EQU   EQCOUT+23
DRIVEOUT EQU   EQCOUT+43
CONTLR   EQU   DRIVEOUT+1
SPACE    EQU   DRIVEOUT+2
IDDRIVE  EQU   DRIVEOUT+3
SENSEOUT EQU   EQCOUT+50
*                                      START UNREFERENCED COMPONENTS
@NM00027 EQU   EQCOUT+128
@NM00026 EQU   EQCOUT+48
@NM00025 EQU   DRIVEOUT+4
@NM00024 EQU   DRIVEOUT
@NM00023 EQU   EQCOUT+41
@NM00022 EQU   EQCOUT+21
@NM00021 EQU   FSCAREA+5
@NM00020 EQU   EQCOUT+12
SSIDCHAR EQU   SSIDOUT
@NM00019 EQU   EQCOUT+6
RUACHAR  EQU   RUAOUT
EQCANSI  EQU   EQCOUT
@NM00028 EQU   FSCCVT+4
DASDSSID EQU   MSCDASD+26
@NM00018 EQU   MSCDASD+24
FSCDASD  EQU   MSCDASD+22
@NM00017 EQU   MSCDASD+21
DASD20   EQU   MSCDASD+20
@NM00016 EQU   MSCDASD+12
DASD11   EQU   MSCDASD+11
@NM00015 EQU   DASD10
CLOCKERR EQU   DASD10
TIMEBIT  EQU   DASD10
@NM00014 EQU   MSCDASD+8
DASDMSG  EQU   FMTMSG
DASDFMT  EQU   FMTMSG
@NM00013 EQU   MSCDASD+5
DRIVE    EQU   MSCDASD+4
@NM00012 EQU   MSCDASD
@NM00011 EQU   EQCSENSE+28
DASDDATA EQU   EQCSENSE
@NM00010 EQU   EQCFSC+2
FSCSYS   EQU   EQCFSC
@NM00009 EQU   EQCFLAGS+1
MSCFLAG  EQU   EQCFLAGS
UNITCHAR EQU   EQCSSID+1
DEVCHAR  EQU   EQCSSID
DEVBYTEB EQU   DEVBYTES+1
DEVBYTEA EQU   DEVBYTES
@NM00008 EQU   EQCSW
MSCREC   EQU   EQCSW
NOFSC    EQU   EQCSW
WORKAPR  EQU   EQCSW
FMT3ACC2 EQU   EQCSW
FMT3ACC1 EQU   EQCSW
I        EQU   EQCWORK+42
RECCOUNT EQU   EQCWORK+38
FSCSAVE2 EQU   EQCWORK+34
FSCSAVE1 EQU   EQCWORK+30
FSCSYSSV EQU   EQCWORK+28
@NM00007 EQU   SSIDSAVE+1
SSIDDEV  EQU   SSIDSAVE
RUASAVE  EQU   EQCWORK+24
FREEPTR  EQU   EQCWORK+16
LOGPTR   EQU   EQCWORK+8
PTRSAVE  EQU   EQCWORK+4
@NM00006 EQU   ISDAGHDR+26
BLOCKCNT EQU   ISDAGHDR+24
BLOCKID  EQU   ISDAGHDR+20
LASTPTR  EQU   ISDAGHDR+16
NEXTPTR  EQU   ISDAGHDR+12
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
ENDPTR   EQU   ISDAGHDR+4
STARTPTR EQU   ISDAGHDR
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
MSCFSC   EQU   SUBSENSE+22
@NM00005 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00004 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SUBFMTNO EQU   SUBFMTMG
SALOWAD2 EQU   SUBSENSE+6
SARETRY  EQU   SUBSENSE+5
@NM00003 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SUBSTAT5 EQU   SUBSENSE+1
SUBSTAT4 EQU   SUBSENSE
FORMATNO EQU   ISDAMSCS+3
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
SSIDFLAG EQU   SUBSYSID
STATUS   EQU   ISDAMSCS
DEVPTR   EQU   ISDAWORK+16
NOUTREC  EQU   ISDAWORK+12
NINREC   EQU   ISDAWORK+8
CUABYTE1 EQU   INRECCUA+1
CUABYTE0 EQU   INRECCUA
DLENGTH  EQU   ISDAWORK+4
SDAFLAG0 EQU   INFLAGS+3
INDEVTYP EQU   INFLAGS+2
INSOURCE EQU   INFLAGS+1
IRECTYPE EQU   INFLAGS
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
WORKCALL EQU   CVTPTRS0+96
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
*                                      END UNREFERENCED COMPONENTS
@RC00032 EQU   @RC00029
@RC00060 EQU   @EL00002
@RC00119 EQU   @EL00005
@RC00117 EQU   @EL00005
@RC00142 EQU   @EL00007
@RC00140 EQU   @EL00007
@RC00211 EQU   @RC00210
@RC00035 EQU   @RC00032
@RC00120 EQU   @RC00119
@ENDDATA EQU   *
         END   ISDAEQC1,(C'PLS1048',0603,76205)

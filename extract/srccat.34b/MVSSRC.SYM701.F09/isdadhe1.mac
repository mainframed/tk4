         TITLE 'PRINT REPORTS DHE AND DHU SDA                          *
                        '
ISDADHE1 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDADHE1  78.044'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0039
*/* HOUSEKEEPING                                             @Y30LB54*/
*                                                                  0039
*   CVTPTR=WORKPTR;                 /*                       @Y30LB54*/
         L     @05,@PC00001                                        0039
         L     CVTPTR,WORKPTR(,@05)                                0039
*   DHEWKPTR=DHE00PTR;              /* SET LOCAL PTR TO WORK @ZM30983*/
         L     DHEWKPTR,DHE00PTR(,CVTPTR)                          0040
*   LPARMPTR=PARMPTR;               /* BASE FOR PARMS        @Y30LB54*/
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0041
*   RETCODE=0;                      /*                       @Y30LB54*/
         SLR   RETCODE,RETCODE                                     0042
*                                                                  0043
*   /*****************************************************************/
*   /*                                                               */
*   /* DHU MAIN PROCESSOR                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*   RETCODE1=0;                     /* INIT DHU RETURN CODE  @ZM30730*/
         SLR   RETCODE1,RETCODE1                                   0043
*   IF COUNTRP4^=0 THEN                                            0044
         ICM   @05,15,COUNTRP4(DHEWKPTR)                           0044
         BZ    @RF00044                                            0044
*     DO;                           /*                       @Y30LB54*/
*       DO LIBCTR=1 TO 4 BY 1;      /* PROCESS 4 LIBRARIES   @Y30LB54*/
         LA    @05,1                                               0046
         ST    @05,LIBCTR(,DHEWKPTR)                               0046
@DL00046 DS    0H                                                  0047
*         IF LIBPTR(LIBCTR)^=0 THEN /* NO REPORT NEEDED FOR THIS CS
*                                                            @Y30LB54*/
         L     @05,LIBCTR(,DHEWKPTR)                               0047
         SLA   @05,2                                               0047
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0047
         LA    @05,0(,@05)                                         0047
         LTR   @05,@05                                             0047
         BZ    @RF00047                                            0047
*           DO;                     /*                       @Y30LB54*/
*             PTRRPT=0;             /* REPORT OFFSET INTO COUNTERS 0049
*                                                            @Y30LB54*/
         SLR   @15,@15                                             0049
         ST    @15,PTRRPT(,DHEWKPTR)                               0049
*             KICKPTR=LIBPTR(LIBCTR)+PTRRPT;/* POINT COUNTER BASE TO
*                                      COUNTERS              @Y30LB54*/
         ALR   @05,@15                                             0050
         ST    @05,KICKPTR(,DHEWKPTR)                              0050
*             CALL RPT4HDR;         /* GET HEADER PORTION OF THIS  0051
*                                      REPORT                @Y30LB54*/
         BAL   @14,RPT4HDR                                         0051
*             CALL RPT4CALC;        /* CALCULATE RATIO TABLE @Y30LB54*/
         BAL   @14,RPT4CALC                                        0052
*/*  PRODUCE STATISTICS AND GRAPH PORTION OF REPORT          @Y30LB54*/
*                                                                  0053
*             CALL RATSORT;         /* SORT THE RATIO TABLE  @Y30LB54*/
         BAL   @14,RATSORT                                         0053
*             CALL RPT4BODY;        /* PRINT BODY OF DHU     @Y30LB54*/
         BAL   @14,RPT4BODY                                        0054
*             CALL RPT4ABST;        /* PRINT ABSTRACT OF DHU @Y30LB54*/
         BAL   @14,RPT4ABST                                        0055
*/*PRODUCE 4 DAY TREND PORTION OF REPORT                     @Y30LB54*/
*                                                                  0056
*             PTRRPT=192;           /* OFFSET TO 4 DAY TREND PORTION
*                                      OF COUNTERS           @Y30LB54*/
         LA    @05,192                                             0056
         ST    @05,PTRRPT(,DHEWKPTR)                               0056
*             KICKPTR=LIBPTR(LIBCTR)+PTRRPT;/* COUNTER BASE FOR THIS
*                                      REPORT                @Y30LB54*/
         L     @15,LIBCTR(,DHEWKPTR)                               0057
         SLA   @15,2                                               0057
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0057
         LA    @15,0(,@15)                                         0057
         ALR   @05,@15                                             0057
         ST    @05,KICKPTR(,DHEWKPTR)                              0057
*             CALL RPT4AHDR;        /* PRINT FOUR DAY TREND HDR    0058
*                                                            @Y30LB54*/
         BAL   @14,RPT4AHDR                                        0058
*             CALL RPT4ABDY;        /* PRINT FOUR DAY BODY   @Y30LB54*/
         BAL   @14,RPT4ABDY                                        0059
*           END;                    /*                       @Y30LB54*/
*         ELSE                                                     0061
*           ;                       /*                       @Y30LB54*/
@RF00047 DS    0H                                                  0062
*       END;                        /*                       @Y30LB54*/
         LA    @05,1                                               0062
         AL    @05,LIBCTR(,DHEWKPTR)                               0062
         ST    @05,LIBCTR(,DHEWKPTR)                               0062
         CH    @05,@CH00051                                        0062
         BNH   @DL00046                                            0062
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0064
*     IF CDHEDHU(7)='1'B THEN       /* WAS DHU REQUESTED     @ZM30730*/
         B     @RC00044                                            0064
@RF00044 TM    CDHEDHU(LPARMPTR),B'00000010'                       0064
         BNO   @RF00064                                            0064
*       RETCODE=12;                 /* NO DHU ACCUMULATOR FILLED   0065
*                                                            @Y30LB54*/
         LA    RETCODE,12                                          0065
*     ELSE;                         /* NO, NO RETURN CODE    @ZM30730*/
@RF00064 DS    0H                                                  0067
*                                                                  0067
*   /*****************************************************************/
*   /*                                                               */
*   /* DHE MAIN PROCESSOR                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0067
*   RETCODE2=0;                     /* INIT DHE RETURN CODE  @ZM30730*/
@RC00044 SLR   RETCODE2,RETCODE2                                   0067
*   IF COUNTRP5^=0 THEN                                            0068
         ICM   @15,15,COUNTRP5(DHEWKPTR)                           0068
         BZ    @RF00068                                            0068
*     DO;                           /*                       @Y30LB54*/
*       CALL RPT5HDR;               /* PRINT DHE HEADER      @Y30LB54*/
         BAL   @14,RPT5HDR                                         0070
*       CALL RECSORT;               /* SORT THE DHE RECORDS  @Y30LB54*/
         BAL   @14,RECSORT                                         0071
*       CALL RPT5BDY;               /* PRINT DHE BODY        @Y30LB54*/
         BAL   @14,RPT5BDY                                         0072
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0074
*     IF CDHEDHU(8)='1'B THEN       /* WAS DHE REQUESTED     @ZM30730*/
         B     @RC00068                                            0074
@RF00068 TM    CDHEDHU(LPARMPTR),B'00000001'                       0074
         BNO   @RF00074                                            0074
*       RETCODE2=16;                /* NO DHE ACCUMULATORS FILLED  0075
*                                                            @Y30LB54*/
         LA    RETCODE2,16                                         0075
*     ELSE;                         /* NO, NO RETURN CODE    @ZM30730*/
*                                                                  0076
@RF00074 DS    0H                                                  0077
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL REPORTS PRODUCED AT THIS POINT                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0077
*   IF RETCODE=0 THEN               /* WAS RETCODE SET       @ZM30730*/
@RC00068 SLR   @15,@15                                             0077
         CR    RETCODE,@15                                         0077
         BNE   @RF00077                                            0077
*     IF RETCODE1+RETCODE2^=0 THEN  /* NO, CODE 1 OR 2 SET   @ZM30730*/
         LR    @14,RETCODE1                                        0078
         ALR   @14,RETCODE2                                        0078
         CR    @14,@15                                             0078
         BE    @RF00078                                            0078
*       IF CDHEDHU='03'X THEN       /* BOTH DHU, DHE REQUEST @ZM30730*/
         CLI   CDHEDHU(LPARMPTR),X'03'                             0079
         BNE   @RF00079                                            0079
*         IF RETCODE1+RETCODE2>16 THEN /* NO REPORTS PRINTED @ZM30730*/
         CH    @14,@CH00191                                        0080
         BNH   @RF00080                                            0080
*           RETCODE=8;              /* SET NO REPORTS CODE   @ZM30730*/
         LA    RETCODE,8                                           0081
*         ELSE                      /* SOME REPORT PRINTED   @ZM30730*/
*           RETCODE=RETCODE1+RETCODE2; /* SET CODE 12 OR 16  @ZM30730*/
         B     @RC00080                                            0082
@RF00080 LR    RETCODE,RETCODE1                                    0082
         ALR   RETCODE,RETCODE2                                    0082
*       ELSE                        /* BOTH NOT REQUESTED    @ZM30730*/
*         RETCODE=8;                /* SET NO REPORTS CODE   @ZM30730*/
         B     @RC00079                                            0083
@RF00079 LA    RETCODE,8                                           0083
*     ELSE;                         /* NO DHU,DHE CODES      @ZM30730*/
@RF00078 DS    0H                                                  0085
*   ELSE;                           /* RETCODE ALREADY SET   @ZM30730*/
@RF00077 DS    0H                                                  0086
*   CALL FREECORE;                  /* FREE ALL CORE USED    @Y30LB54*/
@RC00077 BAL   @14,FREECORE                                        0086
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/
         L     @13,4(,@13)                                         0087
         L     @00,@SIZDATD                                        0087
         LR    @01,@10                                             0087
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@04                                             0087
         L     @14,12(,@13)                                        0087
         LM    @00,@12,20(@13)                                     0087
         BR    @14                                                 0087
*                                                                  0088
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT HEADER FOR DHU                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0088
*RPT4HDR:                                                          0088
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4HDR  ST    @14,@SA00002                                        0088
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0089
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0089
         MVI   LINE(CVTPTR),C' '                                   0089
*   LINE(70:72)='MSF';              /*                       @ZM30730*/
         MVC   LINE+69(3,CVTPTR),@CC00308                          0090
*   LINE(1:59)='REPORT 12 - DATA HANDLING USAGE FOR DRDS - DRD BUFFERED
*LOG';                              /* DHU REPORT TITLE      @ZM30730*/
*                                                                  0091
         MVC   LINE(59,CVTPTR),@CC00310                            0091
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*   LINE(87:126)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0092
*                                                            @ZM30730*/
         MVC   LINE+86(40,CVTPTR),@CC00317                         0092
*   ANSI='1';                       /* EJECT TO NEW PAGE     @Y30LB54*/
         MVI   ANSI(CVTPTR),C'1'                                   0093
*   FULLWD1=74;                     /* LOCATION WHERE TO PUT LIBRARY
*                                      NUMBER                @ZM30730*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00320                        0094
*   CALL CONVTLIB;                  /* INSERT LIBRARY NO IN PRINTABLE
*                                      FORM                  @Y30LB54*/
         BAL   @14,CONVTLIB                                        0095
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0096
         ST    @05,@AL00001                                        0096
         L     @15,@CV00040                                        0096
         LA    @01,@AL00001                                        0096
         BALR  @14,@15                                             0096
*   LINE=' ';                       /* CLEAR PRINT LINE      @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0097
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0097
         MVI   LINE(CVTPTR),C' '                                   0097
*   ANSI=' ';                       /* SINGLE SPACE          @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0098
*   CALL ISDAPRT0(WORKPTR);                                /*@Y30LB54*/
         L     @05,@PC00001                                        0099
         ST    @05,@AL00001                                        0099
         L     @15,@CV00040                                        0099
         LA    @01,@AL00001                                        0099
         BALR  @14,@15                                             0099
*   LINE(34:41)='DRD SSID';         /*                       @Y30LB54*/
         MVC   LINE+33(8,CVTPTR),@CC00324                          0100
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0101
         ST    @05,@AL00001                                        0101
         L     @15,@CV00040                                        0101
         LA    @01,@AL00001                                        0101
         BALR  @14,@15                                             0101
*   LINE=' ';                       /*                       @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0102
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0102
         MVI   LINE(CVTPTR),C' '                                   0102
*   LINE(32:112)='×   200   ×   201   ×   202   ×   203   ×   204   ×
*205   ×   206   ×   207   ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00327                         0103
*   LINE(115:120)='TOTALS';         /* TOTALS HEADER         @Y30LB54*/
         MVC   LINE+114(6,CVTPTR),@CC00335                         0104
*   DO CTR=37 TO 107 BY 10;         /* INSERT MSF ID IN SSID @Y30LB54*/
         LA    @05,37                                              0105
         ST    @05,CTR(,DHEWKPTR)                                  0105
@DL00105 DS    0H                                                  0106
*     LINE(CTR)=HEXREP(FOURBITS);   /*                       @Y30LB54*/
         L     @05,CTR(,DHEWKPTR)                                  0106
         ALR   @05,CVTPTR                                          0106
         SLR   @01,@01                                             0106
         IC    @01,FOURBITS(,DHEWKPTR)                             0106
         LA    @15,HEXREP-1(@01)                                   0106
         MVC   LINE-1(1,@05),0(@15)                                0106
*   END;                            /*                       @Y30LB54*/
         LA    @05,10                                              0107
         AL    @05,CTR(,DHEWKPTR)                                  0107
         ST    @05,CTR(,DHEWKPTR)                                  0107
         CH    @05,@CH00337                                        0107
         BNH   @DL00105                                            0107
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0108
         ST    @05,@AL00001                                        0108
         L     @15,@CV00040                                        0108
         LA    @01,@AL00001                                        0108
         BALR  @14,@15                                             0108
*   LINE=' ';                       /* BLANK LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0109
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0109
         MVI   LINE(CVTPTR),C' '                                   0109
*   LINE(32:112)='×---------×---------×---------×---------×---------×--
*------×---------×---------×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00338                         0110
*   LINE(113:121)='---------';      /* GRAND TOTAL BOX       @Y30LB54*/
         MVC   LINE+112(9,CVTPTR),@CC00346                         0111
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0112
         ST    @05,@AL00001                                        0112
         L     @15,@CV00040                                        0112
         LA    @01,@AL00001                                        0112
         BALR  @14,@15                                             0112
*   END RPT4HDR;                    /*                       @Y30LB54*/
@EL00002 DS    0H                                                  0113
@EF00002 DS    0H                                                  0113
@ER00002 L     @14,@SA00002                                        0113
         BR    @14                                                 0113
*                                                                  0114
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE DHU RATIOS AND SET DYNAMIC RATIO TABLE              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0114
*RPT4CALC:                                                         0114
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4CALC ST    @14,@SA00003                                        0114
*   KICKPTR=LIBPTR(LIBCTR)+PTRRPT;  /* ESTABLISH BASE FOR COUNTERS 0115
*                                                            @Y30LB54*/
         L     @05,LIBCTR(,DHEWKPTR)                               0115
         SLA   @05,2                                               0115
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0115
         LA    @05,0(,@05)                                         0115
         AL    @05,PTRRPT(,DHEWKPTR)                               0115
         ST    @05,KICKPTR(,DHEWKPTR)                              0115
*   RATCTR=1;                       /* WE WANT TO START AT TOP OF  0116
*                                      RATIO TABLE           @Y30LB54*/
         LA    @05,1                                               0116
         ST    @05,RATCTR(,DHEWKPTR)                               0116
*   DO CTR=1 TO 3 BY 1;             /* THREE DIFFERENT TYPES OF    0117
*                                      COUNTERS              @Y30LB54*/
         ST    @05,CTR(,DHEWKPTR)                                  0117
@DL00117 DS    0H                                                  0118
*     ANSI=' ';                     /* SINGLE SPACE OUTPUT   @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0118
*     LINE=BODY1(CTR);              /*                       @Y30LB54*/
         MVI   LINE+10(CVTPTR),C' '                                0119
         MVC   LINE+11(121,CVTPTR),LINE+10(CVTPTR)                 0119
         L     @05,CTR(,DHEWKPTR)                                  0119
         MH    @05,@CH00155                                        0119
         LA    @01,BODY1-10(@05)                                   0119
         MVC   LINE(10,CVTPTR),0(@01)                              0119
*     LINE(32:112)='×         ×         ×         ×         ×         ×
*        ×         ×         ×';    /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0120
*     LINE(122)='×';                /* GRAND TOTAL BOX       @Y30LB54*/
         MVI   LINE+121(CVTPTR),C'×'                               0121
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
         L     @05,@PC00001                                        0122
         ST    @05,@AL00001                                        0122
         L     @15,@CV00040                                        0122
         LA    @01,@AL00001                                        0122
         BALR  @14,@15                                             0122
*     LINE=BODY2(CTR);              /*                       @Y30LB54*/
         MVI   LINE+25(CVTPTR),C' '                                0123
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0123
         L     @05,CTR(,DHEWKPTR)                                  0123
         MH    @05,@CH00172                                        0123
         LA    @01,BODY2-25(@05)                                   0123
         MVC   LINE(25,CVTPTR),0(@01)                              0123
*     LINE(32:112)='×         ×         ×         ×         ×         ×
*        ×         ×         ×';    /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0124
*     CALL RPT4FILL;                /*                       @Y30LB54*/
         BAL   @14,RPT4FILL                                        0125
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
         L     @05,@PC00001                                        0126
         ST    @05,@AL00001                                        0126
         L     @15,@CV00040                                        0126
         LA    @01,@AL00001                                        0126
         BALR  @14,@15                                             0126
*     LINE=BODY3(CTR);              /*                       @Y30LB54*/
         MVI   LINE+20(CVTPTR),C' '                                0127
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0127
         L     @05,CTR(,DHEWKPTR)                                  0127
         MH    @05,@CH00180                                        0127
         LA    @01,BODY3-20(@05)                                   0127
         MVC   LINE(20,CVTPTR),0(@01)                              0127
*     KICKPTR=KICKPTR+4;            /* DO NEXT SET OF COUNTERS     0128
*                                                            @Y30LB54*/
         LA    @05,4                                               0128
         AL    @05,KICKPTR(,DHEWKPTR)                              0128
         ST    @05,KICKPTR(,DHEWKPTR)                              0128
*     LINE(32:112)='×         ×         ×         ×         ×         ×
*        ×         ×         ×';    /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0129
*     CALL RPT4FILL;                /*                       @Y30LB54*/
         BAL   @14,RPT4FILL                                        0130
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
         L     @05,@PC00001                                        0131
         ST    @05,@AL00001                                        0131
         L     @15,@CV00040                                        0131
         LA    @01,@AL00001                                        0131
         BALR  @14,@15                                             0131
*     LINE=BODY4(CTR);              /*                       @Y30LB54*/
         MVI   LINE+20(CVTPTR),C' '                                0132
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0132
         L     @05,CTR(,DHEWKPTR)                                  0132
         MH    @05,@CH00180                                        0132
         LA    @01,BODY4-20(@05)                                   0132
         MVC   LINE(20,CVTPTR),0(@01)                              0132
*     LINE(32:112)='×         ×         ×         ×         ×         ×
*        ×         ×         ×';    /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0133
*     CALL RATIOFIL;                /* FILL IN THE RATIO AMOUNT    0134
*                                                            @Y30LB54*/
         BAL   @14,RATIOFIL                                        0134
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
         L     @05,@PC00001                                        0135
         ST    @05,@AL00001                                        0135
         L     @15,@CV00040                                        0135
         LA    @01,@AL00001                                        0135
         BALR  @14,@15                                             0135
*     KICKPTR=KICKPTR+4;            /* DO NEXT SET OF COUNTERS     0136
*                                                            @Y30LB54*/
         LA    @05,4                                               0136
         AL    @05,KICKPTR(,DHEWKPTR)                              0136
         ST    @05,KICKPTR(,DHEWKPTR)                              0136
*   END;                            /*                       @Y30LB54*/
         LA    @05,1                                               0137
         AL    @05,CTR(,DHEWKPTR)                                  0137
         ST    @05,CTR(,DHEWKPTR)                                  0137
         CH    @05,@CH00068                                        0137
         BNH   @DL00117                                            0137
*   LINE='-------------------------------------------------------------
*-----------------------------------------------------------';     0138
         MVI   LINE+121(CVTPTR),C' '                               0138
         MVC   LINE+122(10,CVTPTR),LINE+121(CVTPTR)                0138
         MVC   LINE(121,CVTPTR),@CC00361                           0138
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0139
         ST    @05,@AL00001                                        0139
         L     @15,@CV00040                                        0139
         LA    @01,@AL00001                                        0139
         BALR  @14,@15                                             0139
*   END RPT4CALC;                   /*                       @Y30LB54*/
@EL00003 DS    0H                                                  0140
@EF00003 DS    0H                                                  0140
@ER00003 L     @14,@SA00003                                        0140
         BR    @14                                                 0140
*                                                                  0141
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN THE VALUES IN FIRST SECTION OF REPORT                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0141
*RPT4FILL:                                                         0141
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4FILL ST    @14,12(,@13)                                        0141
*   FULLWD1=33;                     /* THIS IS WHERE TO STUFF@Y30LB54
*                                      COUNTERS              @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0142
*   GRANDU=0;                       /* ZERO GRAND TOTAL COUNTERS   0143
*                                                            @Y30LB54*/
         SLR   @05,@05                                             0143
         ST    @05,GRANDU(,DHEWKPTR)                               0143
*   GRANDE=0;                       /* ZERO GRAND TOTAL COUNTERS   0144
*                                                            @Y30LB54*/
         ST    @05,GRANDE(,DHEWKPTR)                               0144
*   DO CTR1=1 TO 43 BY 6;           /* WANT TO STRIP OFF EVERY SIXTH
*                                      COUNTER               @Y30LB54*/
         LA    @05,1                                               0145
         ST    @05,CTR1(,DHEWKPTR)                                 0145
@DL00145 DS    0H                                                  0146
*     EDREC=EDPAT;                  /* MOVE EDIT PATTERN TO WORKING
*                                      CORE                  @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT                            0146
*     GRANDU=GRANDU+COUNTER(CTR1);  /* ADD TO GRAND TOTALS   @Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0147
         SLA   @05,2                                               0147
         L     @01,KICKPTR(,DHEWKPTR)                              0147
         AL    @01,@CF00538                                        0147
         L     @05,COUNTER(@05,@01)                                0147
         L     @15,GRANDU(,DHEWKPTR)                               0147
         ALR   @15,@05                                             0147
         ST    @15,GRANDU(,DHEWKPTR)                               0147
*     CVD(COUNTER(CTR1),CHAR5);     /* CONVERT TO PACKED DEC @Y30LB54*/
         CVD   @05,@TS00001                                        0148
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0148
*     CHAR5(5)=CHAR5(5)×'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0149
*     ED(EDREC,CHAR5);              /* CONVERT FIELD TO PRINTABLE  0150
*                                      CHAR                  @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0150
*     LINE(FULLWD1:FULLWD1+8)=EDREC(2:10);/* RESULT TO PRINT @Y30LB54*/
         L     @05,FULLWD1(,DHEWKPTR)                              0151
         ALR   @05,CVTPTR                                          0151
         MVC   LINE-1(9,@05),EDREC+1(DHEWKPTR)                     0151
*     FULLWD1=FULLWD1+10;           /* NEXT COUNTER PRINT POSITION 0152
*                                                            @Y30LB54*/
         L     @05,FULLWD1(,DHEWKPTR)                              0152
         AH    @05,@CH00155                                        0152
         ST    @05,FULLWD1(,DHEWKPTR)                              0152
*   END;                            /*                       @Y30LB54*/
         LA    @05,6                                               0153
         AL    @05,CTR1(,DHEWKPTR)                                 0153
         ST    @05,CTR1(,DHEWKPTR)                                 0153
         CH    @05,@CH00374                                        0153
         BNH   @DL00145                                            0153
*   EDREC=EDPAT;                    /*                       @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT                            0154
*   CVD(GRANDU,CHAR5);              /* PRINT GRAND TOTALS    @Y30LB54*/
         L     @05,GRANDU(,DHEWKPTR)                               0155
         CVD   @05,@TS00001                                        0155
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0155
*   CHAR5(5)=CHAR5(5)×'0F'X;        /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0156
*   ED(EDREC,CHAR5);                /* FORMAT OUTPUT         @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0157
*   LINE(113:121)=EDREC(2:10);      /* PUT IT IN OUTPUT LINE @Y30LB54*/
         MVC   LINE+112(9,CVTPTR),EDREC+1(DHEWKPTR)                0158
*   LINE(122)='×';                  /* MOVE IN OR SIGN       @Y30LB54*/
         MVI   LINE+121(CVTPTR),C'×'                               0159
*   END RPT4FILL;                   /*                       @Y30LB54*/
@EL00004 DS    0H                                                  0160
@EF00004 DS    0H                                                  0160
@ER00004 L     @14,12(,@13)                                        0160
         BR    @14                                                 0160
*                                                                  0161
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPUTE THE RATIOS AND FILL IN RATIO TABLE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0161
*RATIOFIL:                                                         0161
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RATIOFIL ST    @14,12(,@13)                                        0161
*   FULLWD1=33;                     /* TELL IT WHERE THE FIRST PRINT
*                                      POS IS                @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0162
*   GRANDU=0;                       /* ZERO GRAND TOTAL COUNTERS   0163
*                                                            @Y30LB54*/
         SLR   @05,@05                                             0163
         ST    @05,GRANDU(,DHEWKPTR)                               0163
*   GRANDE=0;                       /* ZERO GRAND TOTAL COUNTERS   0164
*                                                            @Y30LB54*/
         ST    @05,GRANDE(,DHEWKPTR)                               0164
*   KICKPTR=KICKPTR-4;              /* SET COUNTER BACK TO ERROR CTR
*                                                            @Y30LB54*/
         L     @05,KICKPTR(,DHEWKPTR)                              0165
         SH    @05,@CH00051                                        0165
         ST    @05,KICKPTR(,DHEWKPTR)                              0165
*   DATASSID=-1;                    /* TELL RATIO TABLE WHICH SSID WE
*                                      ARE WORKING           @Y30LB54*/
         MVC   DATASSID(4,DHEWKPTR),@CF00381                       0166
*   DO CTR1=1 TO 43 BY 6;           /* EVERY SIXTH COUNTER   @Y30LB54*/
         LA    @05,1                                               0167
         ST    @05,CTR1(,DHEWKPTR)                                 0167
@DL00167 DS    0H                                                  0168
*     DATASSID=DATASSID+1;          /* NEW SSID BEING WORKED @Y30LB54*/
         LA    @05,1                                               0168
         AL    @05,DATASSID(,DHEWKPTR)                             0168
         ST    @05,DATASSID(,DHEWKPTR)                             0168
*     IF COUNTER(CTR1+1)^=0 THEN                                   0169
         L     @05,CTR1(,DHEWKPTR)                                 0169
         SLA   @05,2                                               0169
         L     @15,KICKPTR(,DHEWKPTR)                              0169
         L     @14,COUNTER(@05,@15)                                0169
         LTR   @14,@14                                             0169
         BZ    @RF00169                                            0169
*       RATCNT(RATCTR)=(COUNTER(CTR1)*10000)/COUNTER(CTR1+1);      0170
         L     @09,RATCTR(,DHEWKPTR)                               0170
         SLA   @09,2                                               0170
         AL    @15,@CF00538                                        0170
         L     @05,COUNTER(@05,@15)                                0170
         MH    @05,@CH00382                                        0170
         LR    @00,@05                                             0170
         SRDA  @00,32                                              0170
         DR    @00,@14                                             0170
         STH   @01,RATCNT-4(@09,DHEWKPTR)                          0170
*     ELSE                                                         0171
*       IF COUNTER(CTR1)^=0 THEN    /* NO USAGE BUT HAVE ERRORS    0171
*                                                            @Y30LB54*/
         B     @RC00169                                            0171
@RF00169 L     @05,CTR1(,DHEWKPTR)                                 0171
         SLA   @05,2                                               0171
         L     @01,KICKPTR(,DHEWKPTR)                              0171
         AL    @01,@CF00538                                        0171
         L     @05,COUNTER(@05,@01)                                0171
         LTR   @05,@05                                             0171
         BZ    @RF00171                                            0171
*         RATCNT(RATCTR)=10000;     /* MAKE IT 100 PERCENT ERROR   0172
*                                                            @Y30LB54*/
         L     @05,RATCTR(,DHEWKPTR)                               0172
         SLA   @05,2                                               0172
         LH    @15,@CH00382                                        0172
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0172
*       ELSE                                                       0173
*         RATCNT(RATCTR)=0;         /* NO ERRORS SO ZERO PERCENT   0173
*                                                            @Y30LB54*/
         B     @RC00171                                            0173
@RF00171 L     @05,RATCTR(,DHEWKPTR)                               0173
         SLA   @05,2                                               0173
         SLR   @15,@15                                             0173
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0173
*     CHAR4='00000000'X;            /* CLEAR CHAR4           @Y30LB54*/
@RC00171 DS    0H                                                  0174
@RC00169 MVC   CHAR4(4,DHEWKPTR),@CB00383                          0174
*     CHAR4(3:4)=RATCNT(RATCTR);    /* PUT IT IN FULL WORD AREA    0175
*                                                            @Y30LB54*/
         L     @05,RATCTR(,DHEWKPTR)                               0175
         SLA   @05,2                                               0175
         LH    @15,RATCNT-4(@05,DHEWKPTR)                          0175
         STH   @15,CHAR4+2(,DHEWKPTR)                              0175
*     IF CHAR4>10000 THEN           /* CANNOT BE MORE THAN 100     0176
*                                      PERCENT ERRORS        @Y30LB54*/
         LH    @15,@CH00382                                        0176
         CL    @15,CHAR4(,DHEWKPTR)                                0176
         BNL   @RF00176                                            0176
*       RATCNT(RATCTR)=10000;       /* MAKE IT 100 PERCENT ERROR   0177
*                                                            @Y30LB54*/
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0177
*     ELSE                                                         0178
*       ;                                                  /*@Y30LB54*/
*                                                                  0178
@RF00176 DS    0H                                                  0179
*/*RATIO = ERRORS DIVIDED BY USAGE                           @Y30LB54*/
*                                                                  0179
*     GRANDU=GRANDU+COUNTER(CTR1+1);/* TOTAL THE USES COUNTER@Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0179
         SLA   @05,2                                               0179
         L     @15,KICKPTR(,DHEWKPTR)                              0179
         L     @14,GRANDU(,DHEWKPTR)                               0179
         AL    @14,COUNTER(@05,@15)                                0179
         ST    @14,GRANDU(,DHEWKPTR)                               0179
*     GRANDE=GRANDE+COUNTER(CTR1);  /* TOTAL THE ERROR COUNTER     0180
*                                                            @Y30LB54*/
         L     @14,GRANDE(,DHEWKPTR)                               0180
         AL    @15,@CF00538                                        0180
         AL    @14,COUNTER(@05,@15)                                0180
         ST    @14,GRANDE(,DHEWKPTR)                               0180
*     RATSSID(RATCTR)=BYTESSID;     /* MOVE IN SSID          @Y30LB54*/
         L     @05,RATCTR(,DHEWKPTR)                               0181
         LR    @15,@05                                             0181
         SLA   @15,2                                               0181
         ST    @15,@TF00001                                        0181
         ALR   @15,DHEWKPTR                                        0181
         MVC   RATSSID-4(1,@15),BYTESSID(DHEWKPTR)                 0181
*     RATCODE(RATCTR)=BYTECODE(CTR);/* MOVE IN ID            @Y30LB54*/
         L     @15,CTR(,DHEWKPTR)                                  0182
         SLA   @15,2                                               0182
         L     @15,BYTECODE-4(@15)                                 0182
         L     @14,@TF00001                                        0182
         STC   @15,RATCODE-4(@14,DHEWKPTR)                         0182
*     EDREC=EDPAT1;                 /* MOVE IN EDIT PATTERN  @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0183
*     FULLWD2=RATCNT(RATCTR);       /* PUT PERCENTAGE IN FULLWORD  0184
*                                                            @Y30LB54*/
         L     @01,@TF00001                                        0184
         LH    @15,RATCNT-4(@01,DHEWKPTR)                          0184
         ST    @15,FULLWD2(,DHEWKPTR)                              0184
*     CVD(FULLWD2,CHAR5);           /*                       @Y30LB54*/
         CVD   @15,@TS00001                                        0185
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0185
*     CHAR5(5)=CHAR5(5)×'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0186
*     ED(EDREC,CHAR5);              /* CONVERT TO PRINTABLE DATA   0187
*                                                            @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0187
*     LINE(FULLWD1+4:FULLWD1+8)=EDREC(6:10);/* RESULT TO PRINT BUFFER
*                                                            @Y30LB54*/
         L     @15,FULLWD1(,DHEWKPTR)                              0188
         ALR   @15,CVTPTR                                          0188
         MVC   LINE+3(5,@15),EDREC+5(DHEWKPTR)                     0188
*     FULLWD1=FULLWD1+10;           /*                       @Y30LB54*/
         L     @15,FULLWD1(,DHEWKPTR)                              0189
         AH    @15,@CH00155                                        0189
         ST    @15,FULLWD1(,DHEWKPTR)                              0189
*     RATCTR=RATCTR+1;              /* MOVE ON TO NEXT TABLE ENTRY 0190
*                                                            @Y30LB54*/
         AH    @05,@CH00048                                        0190
         ST    @05,RATCTR(,DHEWKPTR)                               0190
*   END;                            /*                       @Y30LB54*/
         LA    @05,6                                               0191
         AL    @05,CTR1(,DHEWKPTR)                                 0191
         ST    @05,CTR1(,DHEWKPTR)                                 0191
         CH    @05,@CH00374                                        0191
         BNH   @DL00167                                            0191
*   IF GRANDU^=0 THEN                                              0192
         L     @05,GRANDU(,DHEWKPTR)                               0192
         LTR   @05,@05                                             0192
         BZ    @RF00192                                            0192
*     FULLWD2=(GRANDE*10000)/GRANDU;/* COMPUTE RATIO         @Y30LB54*/
         L     @15,GRANDE(,DHEWKPTR)                               0193
         MH    @15,@CH00382                                        0193
         LR    @00,@15                                             0193
         SRDA  @00,32                                              0193
         DR    @00,@05                                             0193
         ST    @01,FULLWD2(,DHEWKPTR)                              0193
*   ELSE                                                           0194
*     IF GRANDE^=0 THEN             /* NO USAGE BUT HAVE ERRORS    0194
*                                                            @Y30LB54*/
         B     @RC00192                                            0194
@RF00192 ICM   @05,15,GRANDE(DHEWKPTR)                             0194
         BZ    @RF00194                                            0194
*       FULLWD2=10000;              /* MAKE IT 100 PERCENT   @Y30LB54*/
         MVC   FULLWD2(4,DHEWKPTR),@CF00382                        0195
*     ELSE                                                         0196
*       FULLWD2=0;                  /* ZERO RATIO            @Y30LB54*/
         B     @RC00194                                            0196
@RF00194 SLR   @05,@05                                             0196
         ST    @05,FULLWD2(,DHEWKPTR)                              0196
*   IF FULLWD2>10000 THEN           /* CANNOT BE MORE THAN 100     0197
*                                      PERCENT ERRORS        @Y30LB54*/
@RC00194 DS    0H                                                  0197
@RC00192 LH    @05,@CH00382                                        0197
         C     @05,FULLWD2(,DHEWKPTR)                              0197
         BNL   @RF00197                                            0197
*     FULLWD2=10000;                /* MAKE IT 100 PERCENT ERROR   0198
*                                                            @Y30LB54*/
         ST    @05,FULLWD2(,DHEWKPTR)                              0198
*   ELSE                                                           0199
*     ;                                                    /*@Y30LB54*/
@RF00197 DS    0H                                                  0200
*   EDREC=EDPAT1;                   /* MOVE IN EDIT PATTERN  @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0200
*   CVD(FULLWD2,CHAR5);             /* PACK IT               @Y30LB54*/
         L     @05,FULLWD2(,DHEWKPTR)                              0201
         CVD   @05,@TS00001                                        0201
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0201
*   CHAR5(5)=CHAR5(5)×'0F'X;        /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0202
*   ED(EDREC,CHAR5);                /* CONVERT IT TO PRINTABLE CHAR
*                                                            @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0203
*   LINE(117:121)=EDREC(6:10);      /* MOVE TO OUTPUT BUFFER @Y30LB54*/
         MVC   LINE+116(5,CVTPTR),EDREC+5(DHEWKPTR)                0204
*   LINE(122)='×';                  /* MOVE IN OR SIGN       @Y30LB54*/
         MVI   LINE+121(CVTPTR),C'×'                               0205
*   KICKPTR=KICKPTR+4;              /* RESET COUNTER PTR BACK TO   0206
*                                      ORIGIONAL SPOT        @Y30LB54*/
         LA    @05,4                                               0206
         AL    @05,KICKPTR(,DHEWKPTR)                              0206
         ST    @05,KICKPTR(,DHEWKPTR)                              0206
*   END RATIOFIL;                   /*                       @Y30LB54*/
@EL00005 DS    0H                                                  0207
@EF00005 DS    0H                                                  0207
@ER00005 L     @14,12(,@13)                                        0207
         BR    @14                                                 0207
*                                                                  0208
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT BODY OF DHU                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0208
*RPT4BODY:                                                         0208
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4BODY ST    @14,@SA00006                                        0208
*   ANSI=' ';                       /*                       @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0209
*   LINE='     ERROR USAGE RATIO';  /*                       @Y30LB54*/
         MVI   LINE+22(CVTPTR),C' '                                0210
         MVC   LINE+23(109,CVTPTR),LINE+22(CVTPTR)                 0210
         MVC   LINE(22,CVTPTR),@CC00388                            0210
*   LINE(32:112)='×         ×         ×         ×         ×         ×
*      ×         ×         ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0211
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0212
         ST    @05,@AL00001                                        0212
         L     @15,@CV00040                                        0212
         LA    @01,@AL00001                                        0212
         BALR  @14,@15                                             0212
*   FULLWD1=RATCNT(1)-RATCNT(24);   /* HIGHEST-LOWEST RATIO =@Y30LB54
*                                      DIFFERENCE            @Y30LB54*/
         LH    @05,RATCNT(,DHEWKPTR)                               0213
         SH    @05,RATCNT+92(,DHEWKPTR)                            0213
         ST    @05,FULLWD1(,DHEWKPTR)                              0213
*   IF FULLWD1^=0 THEN                                             0214
         LTR   @05,@05                                             0214
         BZ    @RF00214                                            0214
*     FULLWD2=FULLWD1/20;           /* SPREAD REPORT OVER 21 LINES 0215
*                                                            @Y30LB54*/
         LR    @00,@05                                             0215
         SRDA  @00,32                                              0215
         D     @00,@CF00180                                        0215
         ST    @01,FULLWD2(,DHEWKPTR)                              0215
*   ELSE                                                           0216
*     FULLWD2=1;                    /* MAKE 20 LINES INCREMENT BY 01
*                                                            @Y30LB54*/
         B     @RC00214                                            0216
@RF00214 MVC   FULLWD2(4,DHEWKPTR),@CF00048                        0216
*   IF FULLWD2<1 THEN               /* RESULT OF DIVIDE MADE IT ZERO
*                                      WITH CARRY            @Y30LB54*/
@RC00214 LA    @05,1                                               0217
         C     @05,FULLWD2(,DHEWKPTR)                              0217
         BNH   @RF00217                                            0217
*     FULLWD2=1;                    /* MAKE IT MOVE BY AT LEAST .001
*                                                            @Y30LB54*/
         ST    @05,FULLWD2(,DHEWKPTR)                              0218
*   ELSE                                                           0219
*     ;                             /*                       @Y30LB54*/
@RF00217 DS    0H                                                  0220
*   FULLWD1=RATCNT(1);              /* START REPORT WITH HIGHEST   0220
*                                      RATIO                 @Y30LB54*/
         LH    @05,RATCNT(,DHEWKPTR)                               0220
         ST    @05,FULLWD1(,DHEWKPTR)                              0220
*   RATCTR=1;                       /* COUNTER TO STEP THRU 24 RATIOS
*                                                            @Y30LB54*/
*                                                                  0221
         MVC   RATCTR(4,DHEWKPTR),@CF00048                         0221
*   /*****************************************************************/
*   /*                                                               */
*   /* PRODUCE LINES OF OUTPUT                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0222
*   DO CTR=RATCNT(1) TO(RATCNT(24)-FULLWD2) BY-FULLWD2;/*    @Y30LB54*/
         B     @DE00222                                            0222
@DL00222 DS    0H                                                  0223
*     EDREC=EDPAT1;                 /* MOVE EDIT PATTERN INTO@Y30LB54
*                                      RECEIVER              @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0223
*     CVD(FULLWD1,CHAR5);           /* MAKE IT PACKED DECIMAL@Y30LB54*/
         L     @05,FULLWD1(,DHEWKPTR)                              0224
         CVD   @05,@TS00001                                        0224
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0224
*     CHAR5(5)=CHAR5(5)×'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0225
*     ED(EDREC,CHAR5);              /* MAKE IT READABLE      @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0226
*     LINE=' ';                     /* BLANK OUT PRINT LINE  @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0227
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0227
         MVI   LINE(CVTPTR),C' '                                   0227
*     LINE(24:28)=EDREC(6:10);      /* MOVE RATIO TO PRINT LINE    0228
*                                                            @Y30LB54*/
         MVC   LINE+23(5,CVTPTR),EDREC+5(DHEWKPTR)                 0228
*     LINE(32:112)='×         ×         ×         ×         ×         ×
*        ×         ×         ×         ×';/*                 @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00391                         0229
*     PTRDATE=25-RATCTR;            /* WANT TO DO 24 ENTRIES IN RATIO
*                                      TABLE                 @Y30LB54*/
         LA    @05,25                                              0230
         SL    @05,RATCTR(,DHEWKPTR)                               0230
         ST    @05,PTRDATE(,DHEWKPTR)                              0230
*/*THE FIRST TIME AND ONE LESS EACH TIME THEREAFTER          @Y30LB54*/
*                                                                  0231
*     /***************************************************************/
*     /*                                                             */
*     /* FILL IN ONE LINE OF OUTPUT IF WE HAVE A HIT                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0231
*     DO CTR1=1 TO PTRDATE BY 1;    /*                       @Y30LB54*/
         LA    @05,1                                               0231
         ST    @05,CTR1(,DHEWKPTR)                                 0231
         B     @DE00231                                            0231
@DL00231 DS    0H                                                  0232
*       IF RATCNT(RATCTR)=FULLWD1×RATCNT(RATCTR)>FULLWD1 THEN      0232
         L     @05,RATCTR(,DHEWKPTR)                               0232
         SLA   @05,2                                               0232
         LH    @05,RATCNT-4(@05,DHEWKPTR)                          0232
         L     @15,FULLWD1(,DHEWKPTR)                              0232
         CR    @05,@15                                             0232
         BE    @RT00232                                            0232
         CR    @05,@15                                             0232
         BNH   @RF00232                                            0232
@RT00232 DS    0H                                                  0233
*         DO;                       /* THIS GUY BELONGS ON THIS LINE
*                                                            @Y30LB54*/
*           COUNTRP4=(RATSSID(RATCTR)*10)+33;/* COMPUTE PRINT OFFSET
*                                                            @Y30LB54*/
         L     @05,RATCTR(,DHEWKPTR)                               0234
         SLA   @05,2                                               0234
         SLR   @15,@15                                             0234
         IC    @15,RATSSID-4(@05,DHEWKPTR)                         0234
         MH    @15,@CH00155                                        0234
         AL    @15,@CF00373                                        0234
         ST    @15,COUNTRP4(,DHEWKPTR)                             0234
*           IF RATCODE(RATCTR)='R' THEN                            0235
         ALR   @05,DHEWKPTR                                        0235
         CLI   RATCODE-4(@05),C'R'                                 0235
         BE    @RT00235                                            0235
*             ;                     /*                       @Y30LB54*/
*/*  OFFSET IS OK FOR R                                      @Y30LB54*/
*                                                                  0237
*           ELSE                                                   0237
*             IF RATCODE(RATCTR)='W' THEN                          0237
         L     @05,RATCTR(,DHEWKPTR)                               0237
         SLA   @05,2                                               0237
         ALR   @05,DHEWKPTR                                        0237
         CLI   RATCODE-4(@05),C'W'                                 0237
         BNE   @RF00237                                            0237
*               COUNTRP4=COUNTRP4+3;/* DONT WANT W TO OVERLAY R OR L
*                                                            @Y30LB54*/
         LA    @05,3                                               0238
         AL    @05,COUNTRP4(,DHEWKPTR)                             0238
         ST    @05,COUNTRP4(,DHEWKPTR)                             0238
*             ELSE                                                 0239
*               IF RATCODE(RATCTR)='L' THEN                        0239
         B     @RC00237                                            0239
@RF00237 L     @05,RATCTR(,DHEWKPTR)                               0239
         SLA   @05,2                                               0239
         ALR   @05,DHEWKPTR                                        0239
         CLI   RATCODE-4(@05),C'L'                                 0239
         BNE   @RF00239                                            0239
*                 COUNTRP4=COUNTRP4+6;/* DONT WANT L TO OVERLAY W OR
*                                      R                     @Y30LB54*/
         LA    @05,6                                               0240
         AL    @05,COUNTRP4(,DHEWKPTR)                             0240
         ST    @05,COUNTRP4(,DHEWKPTR)                             0240
*               ELSE                                               0241
*                 DO;               /*                       @Y30LB54*/
         B     @RC00239                                            0241
@RF00239 DS    0H                                                  0242
*                   RETCODE=20;     /* BAD LOGIC ERROR       @Y30LB54*/
         LA    RETCODE,20                                          0242
*                   RETURN CODE(RETCODE);/*                  @Y30LB54*/
         LR    @15,RETCODE                                         0243
@EL00006 DS    0H                                                  0243
@EF00006 DS    0H                                                  0243
@ER00006 L     @14,@SA00006                                        0243
         BR    @14                                                 0243
*                 END;              /*                       @Y30LB54*/
*           LINE(COUNTRP4)=RATCODE(RATCTR);/*                @Y30LB54*/
@RC00239 DS    0H                                                  0245
@RC00237 DS    0H                                                  0245
@RT00235 L     @05,COUNTRP4(,DHEWKPTR)                             0245
         ALR   @05,CVTPTR                                          0245
         L     @15,RATCTR(,DHEWKPTR)                               0245
         LR    @14,@15                                             0245
         SLA   @14,2                                               0245
         ALR   @14,DHEWKPTR                                        0245
         MVC   LINE-1(1,@05),RATCODE-4(@14)                        0245
*           RATCTR=RATCTR+1;        /* GO TO NEXT TABLE ENTRY TO SEE
*                                      IF IT FITS HERE       @Y30LB54*/
         AL    @15,@CF00048                                        0246
         ST    @15,RATCTR(,DHEWKPTR)                               0246
*         END;                      /*                       @Y30LB54*/
*       ELSE                                                       0248
*         DO;                       /*                       @Y30LB54*/
         B     @RC00232                                            0248
@RF00232 DS    0H                                                  0249
*           CTR1=100;               /* STOP THIS PORTION OF LOOP WE
*                                      HAVE ALL THAT GOES HERE       */
         MVC   CTR1(4,DHEWKPTR),@CF00398                           0249
*           IF FULLWD1=0 THEN                                      0250
         SLR   @05,@05                                             0250
         L     @15,FULLWD1(,DHEWKPTR)                              0250
         CR    @15,@05                                             0250
         BE    @RT00250                                            0250
*             RETURN;               /*                       @Y30LB54*/
*           ELSE                                                   0252
*             ;                     /*                       @Y30LB54*/
*           FULLWD1=FULLWD1-FULLWD2;/* HEADER FOR NEXT LINE  @Y30LB54*/
         SL    @15,FULLWD2(,DHEWKPTR)                              0253
         ST    @15,FULLWD1(,DHEWKPTR)                              0253
*           IF FULLWD1<0 THEN                                      0254
         CR    @15,@05                                             0254
         BNL   @RF00254                                            0254
*             FULLWD1=0;            /*                       @Y30LB54*/
         ST    @05,FULLWD1(,DHEWKPTR)                              0255
*           ELSE                                                   0256
*             ;                     /*                       @Y30LB54*/
@RF00254 DS    0H                                                  0257
*         END;                      /*                       @Y30LB54*/
*     END;                          /*                       @Y30LB54*/
@RC00232 LA    @05,1                                               0258
         AL    @05,CTR1(,DHEWKPTR)                                 0258
         ST    @05,CTR1(,DHEWKPTR)                                 0258
@DE00231 C     @05,PTRDATE(,DHEWKPTR)                              0258
         BNH   @DL00231                                            0258
*     CALL ISDAPRT0(WORKPTR);       /* PRINT THIS LINE       @Y30LB54*/
         L     @05,@PC00001                                        0259
         ST    @05,@AL00001                                        0259
         L     @15,@CV00040                                        0259
         LA    @01,@AL00001                                        0259
         BALR  @14,@15                                             0259
*     IF FULLWD1<0 THEN                                            0260
         ICM   @05,15,FULLWD1(DHEWKPTR)                            0260
         BM    @RT00260                                            0260
*       RETURN;                     /*                       @Y30LB54*/
*     ELSE                                                         0262
*       ;                           /*                       @Y30LB54*/
*   END;                            /*                       @Y30LB54*/
         L     @05,FULLWD2(,DHEWKPTR)                              0263
         LCR   @05,@05                                             0263
         L     @15,CTR(,DHEWKPTR)                                  0263
         ALR   @15,@05                                             0263
         LR    @05,@15                                             0263
@DE00222 ST    @05,CTR(,DHEWKPTR)                                  0263
         LH    @15,RATCNT+92(,DHEWKPTR)                            0263
         SL    @15,FULLWD2(,DHEWKPTR)                              0263
         CR    @05,@15                                             0263
         BNL   @DL00222                                            0263
*   END RPT4BODY;                   /*                       @Y30LB54*/
         B     @EL00006                                            0264
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE ABSTRACT FOR DHU                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*RPT4ABST:                                                         0265
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4ABST ST    @14,@SA00007                                        0265
*   ANSI=' ';                       /* SINGLE SPACE THIS SECTION   0266
*                                                            @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0266
*   LINE='-------------------------------';/*                @Y30LB54*/
         MVI   LINE+31(CVTPTR),C' '                                0267
         MVC   LINE+32(100,CVTPTR),LINE+31(CVTPTR)                 0267
         MVC   LINE(31,CVTPTR),@CC00402                            0267
*   LINE(32:112)='-----------------------------------------------------
*---------------------------';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00405                         0268
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0269
         ST    @05,@AL00001                                        0269
         L     @15,@CV00040                                        0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*   LINE='LEGEND:';                 /*                       @Y30LB54*/
         MVI   LINE+7(CVTPTR),C' '                                 0270
         MVC   LINE+8(124,CVTPTR),LINE+7(CVTPTR)                   0270
         MVC   LINE(7,CVTPTR),@CC00411                             0270
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0271
         ST    @05,@AL00001                                        0271
         L     @15,@CV00040                                        0271
         LA    @01,@AL00001                                        0271
         BALR  @14,@15                                             0271
*   LINE='R - READ ERROR RATIO';    /*                       @Y30LB54*/
         MVI   LINE+20(CVTPTR),C' '                                0272
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0272
         MVC   LINE(20,CVTPTR),@CC00412                            0272
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0273
         ST    @05,@AL00001                                        0273
         L     @15,@CV00040                                        0273
         LA    @01,@AL00001                                        0273
         BALR  @14,@15                                             0273
*   LINE='W - WRITE ERROR RATIO';   /*                       @Y30LB54*/
         MVI   LINE+21(CVTPTR),C' '                                0274
         MVC   LINE+22(110,CVTPTR),LINE+21(CVTPTR)                 0274
         MVC   LINE(21,CVTPTR),@CC00414                            0274
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0275
         ST    @05,@AL00001                                        0275
         L     @15,@CV00040                                        0275
         LA    @01,@AL00001                                        0275
         BALR  @14,@15                                             0275
*   LINE='L - LOAD ERROR RATIO';    /*                       @Y30LB54*/
         MVI   LINE+20(CVTPTR),C' '                                0276
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0276
         MVC   LINE(20,CVTPTR),@CC00416                            0276
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0277
         ST    @05,@AL00001                                        0277
         L     @15,@CV00040                                        0277
         LA    @01,@AL00001                                        0277
         BALR  @14,@15                                             0277
*   END RPT4ABST;                   /*                       @Y30LB54*/
@EL00007 DS    0H                                                  0278
@EF00007 DS    0H                                                  0278
@ER00007 L     @14,@SA00007                                        0278
         BR    @14                                                 0278
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT HEADER LINE FOR DHU A                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*RPT4AHDR:                                                         0279
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4AHDR ST    @14,@SA00008                                        0279
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0280
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0280
         MVI   LINE(CVTPTR),C' '                                   0280
*   ANSI='1';                       /* EJECT TO START NEW PAGE     0281
*                                                            @Y30LB54*/
         MVI   ANSI(CVTPTR),C'1'                                   0281
*   LINE(58:60)='MSF';              /*                       @ZM30730*/
         MVC   LINE+57(3,CVTPTR),@CC00308                          0282
*   LINE(1:42)='REPORT 12 - LAST FOUR ACTIVE DAYS TRENDING'; /*    0283
*                                      DHU PART 2 TITLE      @ZM30730*/
         MVC   LINE(42,CVTPTR),@CC00424                            0283
*   LINE(81:120)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0284
*                                                             @Y30L54*/
         MVC   LINE+80(40,CVTPTR),@CC00317                         0284
*   FULLWD1=62;                     /* LOCATION WHERE TO PUT LIBRARY
*                                      NUMBER                @ZM30730*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00429                        0285
*   CALL CONVTLIB;                  /* INSERT LIBRARY NO IN PRINTABLE
*                                      FORM                  @Y30LB54*/
         BAL   @14,CONVTLIB                                        0286
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0287
         ST    @05,@AL00001                                        0287
         L     @15,@CV00040                                        0287
         LA    @01,@AL00001                                        0287
         BALR  @14,@15                                             0287
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0288
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0288
         MVI   LINE(CVTPTR),C' '                                   0288
*   ANSI='0';                       /* DOUBLE SPACE NEXT LINE@Y30LB54*/
         MVI   ANSI(CVTPTR),C'0'                                   0289
*   LINE(33:40)='DRD SSID';         /*                       @Y39LB54
*                                                            @Y30LB54*/
         MVC   LINE+32(8,CVTPTR),@CC00324                          0290
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0291
         ST    @05,@AL00001                                        0291
         L     @15,@CV00040                                        0291
         LA    @01,@AL00001                                        0291
         BALR  @14,@15                                             0291
*   ANSI=' ';                       /* SINGLE SPACE THE REST OF THIS
*                                      SECTION               @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0292
*   LINE(32:112)='×   200   ×   201   ×   202   ×   203   ×   204   ×
*205   ×   206   ×   207   ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00327                         0293
*   DO CTR=37 TO 107 BY 10;         /* INSERT MSF IN SSID    @Y30LB54*/
         LA    @05,37                                              0294
         ST    @05,CTR(,DHEWKPTR)                                  0294
@DL00294 DS    0H                                                  0295
*     LINE(CTR)=HEXREP(FOURBITS);   /*                       @Y30LB54*/
         L     @05,CTR(,DHEWKPTR)                                  0295
         ALR   @05,CVTPTR                                          0295
         SLR   @01,@01                                             0295
         IC    @01,FOURBITS(,DHEWKPTR)                             0295
         LA    @15,HEXREP-1(@01)                                   0295
         MVC   LINE-1(1,@05),0(@15)                                0295
*   END;                            /*                       @Y30LB54*/
         LA    @05,10                                              0296
         AL    @05,CTR(,DHEWKPTR)                                  0296
         ST    @05,CTR(,DHEWKPTR)                                  0296
         CH    @05,@CH00337                                        0296
         BNH   @DL00294                                            0296
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0297
         ST    @05,@AL00001                                        0297
         L     @15,@CV00040                                        0297
         LA    @01,@AL00001                                        0297
         BALR  @14,@15                                             0297
*   LINE(32:112)='×---------×---------×---------×---------×---------×--
*------×---------×---------×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00338                         0298
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0299
         ST    @05,@AL00001                                        0299
         L     @15,@CV00040                                        0299
         LA    @01,@AL00001                                        0299
         BALR  @14,@15                                             0299
*   END RPT4AHDR;                   /*                       @Y30LB54*/
@EL00008 DS    0H                                                  0300
@EF00008 DS    0H                                                  0300
@ER00008 L     @14,@SA00008                                        0300
         BR    @14                                                 0300
*                                                                  0301
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT BODY OF DHU A                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0301
*RPT4ABDY:                                                         0301
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4ABDY ST    @14,@SA00009                                        0301
*   ANSI=' ';                       /*                       @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0302
*   PTRDATE=0;                      /* NO DAYS OFFSET INTO COUNTERS
*                                      YET                   @Y30LB54*/
         SLR   @05,@05                                             0303
         ST    @05,PTRDATE(,DHEWKPTR)                              0303
*   PTRSSID=0;                      /* WORK ON FIRST SSID FIRST    0304
*                                                            @Y30LB54*/
         ST    @05,PTRSSID(,DHEWKPTR)                              0304
*   KICKPTR=LIBPTR(LIBCTR)+PTRDATE+PTRSSID+PTRRPT;/*         @Y30LB54*/
         L     @15,LIBCTR(,DHEWKPTR)                               0305
         SLA   @15,2                                               0305
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0305
         LA    @15,0(,@15)                                         0305
         ALR   @15,@05                                             0305
         ALR   @15,@05                                             0305
         AL    @15,PTRRPT(,DHEWKPTR)                               0305
         ST    @15,KICKPTR(,DHEWKPTR)                              0305
*/* NOW HAVE THE TRUE START POSITION IN THE COUNTERS         @Y30LB54*/
*/*FIRST 32 BYTES OF 4A COUNTER AREA IS CONTROL INFO         @Y30LB54*/
*                                                                  0306
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE CONTROL TO WORKING CORE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0306
*   CTR=1;                          /* COUNTER OFFSET        @Y30LB54*/
         LA    @05,1                                               0306
         ST    @05,CTR(,DHEWKPTR)                                  0306
*   DO CTR1=1 TO 4 BY 1;            /* EXTRACT LIBRARY DAY CONTROL 0307
*                                      INFO                  @Y30LB54*/
         ST    @05,CTR1(,DHEWKPTR)                                 0307
@DL00307 DS    0H                                                  0308
*     DATEYYDD(CTR1)=COUNTER(CTR);  /*                       @Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0308
         SLA   @05,3                                               0308
         L     @15,CTR(,DHEWKPTR)                                  0308
         LR    @14,@15                                             0308
         SLA   @14,2                                               0308
         L     @09,KICKPTR(,DHEWKPTR)                              0308
         AL    @14,@CF00538                                        0308
         L     @14,COUNTER(@14,@09)                                0308
         ST    @14,DATEYYDD-8(@05,DHEWKPTR)                        0308
*     CTR=CTR+1;                    /*                       @Y30LB54*/
         LA    @14,1                                               0309
         ALR   @15,@14                                             0309
         ST    @15,CTR(,DHEWKPTR)                                  0309
*     DATEOFST(CTR1)=COUNTER(CTR);  /*                       @Y30LB54*/
         LR    @08,@15                                             0310
         SLA   @08,2                                               0310
         AL    @09,@CF00538                                        0310
         L     @09,COUNTER(@08,@09)                                0310
         ST    @09,DATEOFST-8(@05,DHEWKPTR)                        0310
*     CTR=CTR+ONE;                  /*                       @Y30LB54*/
         ALR   @15,@14                                             0311
         ST    @15,CTR(,DHEWKPTR)                                  0311
*   END;                            /*                       @Y30LB54*/
*                                                                  0312
         LA    @05,1                                               0312
         AL    @05,CTR1(,DHEWKPTR)                                 0312
         ST    @05,CTR1(,DHEWKPTR)                                 0312
         CH    @05,@CH00051                                        0312
         BNH   @DL00307                                            0312
*   /*****************************************************************/
*   /*                                                               */
*   /* READY TO GO ON 4 DAY TREND REPORT                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*   LINE='READ ERROR RATIO        DATE';/*                   @Y30LB54*/
         MVI   LINE+28(CVTPTR),C' '                                0313
         MVC   LINE+29(103,CVTPTR),LINE+28(CVTPTR)                 0313
         MVC   LINE(28,CVTPTR),@CC00433                            0313
*   LINE(32:112)='×         ×         ×         ×         ×         ×
*      ×         ×         ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0314
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0315
         ST    @05,@AL00001                                        0315
         L     @15,@CV00040                                        0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*   COUNTRP4=1;                     /* TELL THEM WHICH COUNTER OFFSET
*                                      IS READ               @Y30LB54*/
         MVC   COUNTRP4(4,DHEWKPTR),@CF00048                       0316
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/
         BAL   @14,RPT4AFIL                                        0317
*   LINE='WRITE ERROR RATIO';       /*                       @Y30LB54*/
         MVI   LINE+17(CVTPTR),C' '                                0318
         MVC   LINE+18(114,CVTPTR),LINE+17(CVTPTR)                 0318
         MVC   LINE(17,CVTPTR),@CC00437                            0318
*   LINE(32:112)='×         ×         ×         ×         ×         ×
*      ×         ×         ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0319
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0320
         ST    @05,@AL00001                                        0320
         L     @15,@CV00040                                        0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
*   COUNTRP4=3;                     /* TELL THEM WHICH COUNTER OFFSET
*                                      IS WRITE              @Y30LB54*/
         MVC   COUNTRP4(4,DHEWKPTR),@CF00068                       0321
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/
         BAL   @14,RPT4AFIL                                        0322
*   LINE='LOAD ERROR RATIO';        /*                       @Y30LB54*/
         MVI   LINE+16(CVTPTR),C' '                                0323
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0323
         MVC   LINE(16,CVTPTR),@CC00439                            0323
*   LINE(32:112)='×         ×         ×         ×         ×         ×
*      ×         ×         ×';      /*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0324
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0325
         ST    @05,@AL00001                                        0325
         L     @15,@CV00040                                        0325
         LA    @01,@AL00001                                        0325
         BALR  @14,@15                                             0325
*   COUNTRP4=5;                     /* TELL THEM WHICH COUNTER OFFSET
*                                      IS LOAD               @Y30LB54*/
         MVC   COUNTRP4(4,DHEWKPTR),@CF00150                       0326
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/
         BAL   @14,RPT4AFIL                                        0327
*   LINE='-------------------------------------------------------------
*--------------------------------------------------';/*      @Y30LB54*/
         MVI   LINE+112(CVTPTR),C' '                               0328
         MVC   LINE+113(19,CVTPTR),LINE+112(CVTPTR)                0328
         MVC   LINE(112,CVTPTR),@CC00441                           0328
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0329
         ST    @05,@AL00001                                        0329
         L     @15,@CV00040                                        0329
         LA    @01,@AL00001                                        0329
         BALR  @14,@15                                             0329
*   END RPT4ABDY;                   /*                       @Y30LB54*/
@EL00009 DS    0H                                                  0330
@EF00009 DS    0H                                                  0330
@ER00009 L     @14,@SA00009                                        0330
         BR    @14                                                 0330
*                                                                  0331
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL THE BODY LINE OF DHU A                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*RPT4AFIL:                                                         0331
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT4AFIL ST    @14,@SA00010                                        0331
*   DO CTR=1 TO 4 BY 1;             /* FOUR DAYS WORTH OF DATA     0332
*                                                            @Y30LB54*/
         LA    @05,1                                               0332
         ST    @05,CTR(,DHEWKPTR)                                  0332
@DL00332 DS    0H                                                  0333
*     IF DATEYYDD(CTR)^='00000000'X THEN/* IF LESS THAN 4 DAYS INPUT
*                                                            @Y30LB54*/
         L     @05,CTR(,DHEWKPTR)                                  0333
         SLA   @05,3                                               0333
         ST    @05,@TF00001                                        0333
         ALR   @05,DHEWKPTR                                        0333
         CLC   DATEYYDD-8(4,@05),@CB00383                          0333
         BE    @RF00333                                            0333
*       DO;                         /*                       @Y30LB54*/
*         PTRDATE=DATEOFST(CTR);    /* POINT TO CORRECT COUNTERS FOR
*                                      TODAY                 @Y30LB54*/
         L     @05,@TF00001                                        0335
         L     @05,DATEOFST-8(@05,DHEWKPTR)                        0335
         ST    @05,PTRDATE(,DHEWKPTR)                              0335
*         CHAR4=DATEYYDD(CTR);      /* PICK UP THIS DATE     @Y30LB54*/
         LR    @05,DHEWKPTR                                        0336
         AL    @05,@TF00001                                        0336
         MVC   CHAR4(4,DHEWKPTR),DATEYYDD-8(@05)                   0336
*         CHAR4(4)=CHAR4(4)×'0F'X;  /* PROTECT AGAINST JUNK  @Y30LB54*/
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0337
*         EDREC1=EDPAT3;            /*                       @Y30LB54*/
         MVC   EDREC1(9,DHEWKPTR),EDPAT3                           0338
*         ED(EDREC1,CHAR4);         /* MAKE IT PRINTABLE     @Y30LB54*/
         ED    EDREC1(9,DHEWKPTR),CHAR4(DHEWKPTR)                  0339
*         LINE=' ';                 /*                       @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0340
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0340
         MVI   LINE(CVTPTR),C' '                                   0340
*         LINE(24:26)=EDREC1(7:9);  /* SPIN THE DATE AROUND  @Y30LB54*/
         MVC   LINE+23(3,CVTPTR),EDREC1+6(DHEWKPTR)                0341
*         LINE(27:27)=EDREC1(6:6);  /* BACKWARDS FROM RECORD @Y30LB54*/
         MVC   LINE+26(1,CVTPTR),EDREC1+5(DHEWKPTR)                0342
*         LINE(28:29)=EDREC1(4:5);  /* BUT THATS THE WAY IT IS     0343
*                                                            @Y30LB54*/
         MVC   LINE+27(2,CVTPTR),EDREC1+3(DHEWKPTR)                0343
*         FULLWD1=33;               /* LOCATION TO START TO STUFF  0344
*                                      COUNTERS              @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0344
*         LINE(32:112)='×         ×         ×         ×         ×  0345
*  ×         ×         ×         ×         ×';/*             @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00391                         0345
*         DO CTR1=0 TO 7 BY 1;      /* PROCESS 8 SSIDS PER DAY     0346
*                                                            @Y30LB54*/
         SLR   @05,@05                                             0346
         ST    @05,CTR1(,DHEWKPTR)                                 0346
@DL00346 DS    0H                                                  0347
*           PTRSSID=CTR1*24;        /* CORRECT OFFSET FOR THIS SSID
*                                                            @Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0347
         MH    @05,@CH00121                                        0347
         ST    @05,PTRSSID(,DHEWKPTR)                              0347
*           KICKPTR=LIBPTR(LIBCTR)+PTRDATE+PTRSSID+PTRRPT;/* @Y30LB54*/
         L     @15,LIBCTR(,DHEWKPTR)                               0348
         SLA   @15,2                                               0348
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0348
         LA    @15,0(,@15)                                         0348
         AL    @15,PTRDATE(,DHEWKPTR)                              0348
         ALR   @15,@05                                             0348
         AL    @15,PTRRPT(,DHEWKPTR)                               0348
         ST    @15,KICKPTR(,DHEWKPTR)                              0348
*           IF COUNTER(COUNTRP4+1)^=0 THEN                         0349
         L     @05,COUNTRP4(,DHEWKPTR)                             0349
         SLA   @05,2                                               0349
         L     @14,COUNTER(@05,@15)                                0349
         LTR   @14,@14                                             0349
         BZ    @RF00349                                            0349
*             FULLWD2=(COUNTER(COUNTRP4)*10000)/COUNTER(COUNTRP4+1);
         AL    @15,@CF00538                                        0350
         L     @05,COUNTER(@05,@15)                                0350
         MH    @05,@CH00382                                        0350
         LR    @00,@05                                             0350
         SRDA  @00,32                                              0350
         DR    @00,@14                                             0350
         ST    @01,FULLWD2(,DHEWKPTR)                              0350
*           ELSE                                                   0351
*             FULLWD2=0;            /* NO RATIO              @Y30LB54*/
         B     @RC00349                                            0351
@RF00349 SLR   @05,@05                                             0351
         ST    @05,FULLWD2(,DHEWKPTR)                              0351
*           EDREC=EDPAT1;           /* MOVE IN EDIT PATTERN  @Y30LB54*/
@RC00349 MVC   EDREC(10,DHEWKPTR),EDPAT1                           0352
*           CVD(FULLWD2,CHAR5);     /* MAKE IT PACKED DECIMAL@Y30LB54*/
         L     @05,FULLWD2(,DHEWKPTR)                              0353
         CVD   @05,@TS00001                                        0353
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0353
*           CHAR5(5)=CHAR5(5)×'0F'X;/* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0354
*           ED(EDREC,CHAR5);        /* MAKE IT READABLE TO PRINTER 0355
*                                                            @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0355
*           LINE(FULLWD1+4:FULLWD1+8)=EDREC(6:10);/*         @Y30LB54*/
         L     @05,FULLWD1(,DHEWKPTR)                              0356
         ALR   @05,CVTPTR                                          0356
         MVC   LINE+3(5,@05),EDREC+5(DHEWKPTR)                     0356
*           FULLWD1=FULLWD1+10;     /* NEXT VALID PRINT POSITION   0357
*                                                            @Y30LB54*/
         L     @05,FULLWD1(,DHEWKPTR)                              0357
         AH    @05,@CH00155                                        0357
         ST    @05,FULLWD1(,DHEWKPTR)                              0357
*         END;                      /*                       @Y30LB54*/
         LA    @05,1                                               0358
         AL    @05,CTR1(,DHEWKPTR)                                 0358
         ST    @05,CTR1(,DHEWKPTR)                                 0358
         CH    @05,@CH00294                                        0358
         BNH   @DL00346                                            0358
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0360
*       DO;                         /*                       @Y30LB54*/
         B     @RC00333                                            0360
@RF00333 DS    0H                                                  0361
*         LINE='------NO INPUT DATA------';/*                @Y30LB54*/
         MVI   LINE+25(CVTPTR),C' '                                0361
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0361
         MVC   LINE(25,CVTPTR),@CC00455                            0361
*         LINE(32:112)='×         ×         ×         ×         ×  0362
*  ×         ×         ×         ×';/*                       @Y30LB54*/
         MVC   LINE+31(81,CVTPTR),@CC00351                         0362
*       END;                        /*                       @Y30LB54*/
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/
@RC00333 L     @05,@PC00001                                        0364
         ST    @05,@AL00001                                        0364
         L     @15,@CV00040                                        0364
         LA    @01,@AL00001                                        0364
         BALR  @14,@15                                             0364
*   END;                            /*                       @Y30LB54*/
         LA    @05,1                                               0365
         AL    @05,CTR(,DHEWKPTR)                                  0365
         ST    @05,CTR(,DHEWKPTR)                                  0365
         CH    @05,@CH00051                                        0365
         BNH   @DL00332                                            0365
*   END RPT4AFIL;                   /*                       @Y30LB54*/
@EL00010 DS    0H                                                  0366
@EF00010 DS    0H                                                  0366
@ER00010 L     @14,@SA00010                                        0366
         BR    @14                                                 0366
*                                                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT DHE HEADER                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0367
*RPT5HDR:                                                          0367
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT5HDR  ST    @14,@SA00011                                        0367
*   SDARPTID=DHEID;                 /* MOVE DHE ID           @ZM30730*/
         MVC   SDARPTID(3,CVTPTR),@CC00153                         0368
*   ANSI='1';                       /* EJECT TO START A NEW PAGE   0369
*                                                            @Y30LB54*/
         MVI   ANSI(CVTPTR),C'1'                                   0369
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0370
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0370
         MVI   LINE(CVTPTR),C' '                                   0370
*   LINE(1:77)=                                                    0371
*'REPORT 13 - DATA HANDLING ERRORS FOR DRDS - DRD BUFFERED LOG COUNTER
*VERFLOW';                          /* DHE REPORT TITLE      @ZM30730*/
*                                                                  0371
         MVC   LINE(77,CVTPTR),@CC00462                            0371
*   LINE(86:125)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0372
*                                                            @ZM30730*/
         MVC   LINE+85(40,CVTPTR),@CC00317                         0372
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @15,@PC00001                                        0373
         ST    @15,@AL00001                                        0373
         L     @15,@CV00040                                        0373
         LA    @01,@AL00001                                        0373
         BALR  @14,@15                                             0373
*   ANSI='0';                       /* DOUBLE SPACE THIS LINE@Y30LB54*/
         MVI   ANSI(CVTPTR),C'0'                                   0374
*   LINE='* INDICATES WHICH COUNTER OVERFLOWED';/*           @Y30LB54*/
         MVI   LINE+36(CVTPTR),C' '                                0375
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0375
         MVC   LINE(36,CVTPTR),@CC00470                            0375
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @15,@PC00001                                        0376
         ST    @15,@AL00001                                        0376
         L     @15,@CV00040                                        0376
         LA    @01,@AL00001                                        0376
         BALR  @14,@15                                             0376
*   ANSI=' ';                       /* SINGLE SPACE THE REST @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0377
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0378
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0378
         MVI   LINE(CVTPTR),C' '                                   0378
*   LINE(1:7)='MSF DRD';            /*                       @Y30LB54*/
         MVC   LINE(7,CVTPTR),@CC00473                             0379
*   LINE(28:39)='STRIPES READ';     /*                       @Y30LB54*/
         MVC   LINE+27(12,CVTPTR),@CC00475                         0380
*   LINE(52:66)='STRIPES WRITTEN';  /*                       @Y30LB54*/
         MVC   LINE+51(15,CVTPTR),@CC00479                         0381
*   LINE(76:79)='LOAD';             /*                       @Y30LB54*/
         MVC   LINE+75(4,CVTPTR),@CC00483                          0382
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @15,@PC00001                                        0383
         ST    @15,@AL00001                                        0383
         L     @15,@CV00040                                        0383
         LA    @01,@AL00001                                        0383
         BALR  @14,@15                                             0383
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0384
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0384
         MVI   LINE(CVTPTR),C' '                                   0384
*   LINE(1:8)='NO  SSID';           /*                       @Y30LB54*/
         MVC   LINE(8,CVTPTR),@CC00484                             0385
*   LINE(10:13)='DATE';                                    /*@Y30LB54*/
         MVC   LINE+9(4,CVTPTR),@CC00486                           0386
*   LINE(18:21)='TIME';             /*                       @Y30LB54*/
         MVC   LINE+17(4,CVTPTR),@CC00488                          0387
*   LINE(28:47)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/
         MVC   LINE+27(20,CVTPTR),@CC00188                         0388
*   LINE(52:71)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/
         MVC   LINE+51(20,CVTPTR),@CC00188                         0389
*   LINE(76:95)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/
         MVC   LINE+75(20,CVTPTR),@CC00188                         0390
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @15,@PC00001                                        0391
         ST    @15,@AL00001                                        0391
         L     @15,@CV00040                                        0391
         LA    @01,@AL00001                                        0391
         BALR  @14,@15                                             0391
*   LINE='--×-----×-------×---------×-----------------------×----------
*------------×-----------------------×';/*                   @Y30LB54*/
         MVI   LINE+99(CVTPTR),C' '                                0392
         MVC   LINE+100(32,CVTPTR),LINE+99(CVTPTR)                 0392
         MVC   LINE(99,CVTPTR),@CC00492                            0392
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/
         L     @15,@PC00001                                        0393
         ST    @15,@AL00001                                        0393
         L     @15,@CV00040                                        0393
         LA    @01,@AL00001                                        0393
         BALR  @14,@15                                             0393
*   END RPT5HDR;                    /*                       @Y30LB54*/
@EL00011 DS    0H                                                  0394
@EF00011 DS    0H                                                  0394
@ER00011 L     @14,@SA00011                                        0394
         BR    @14                                                 0394
*                                                                  0395
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT DHE BODY                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*RPT5BDY:                                                          0395
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RPT5BDY  ST    @14,@SA00012                                        0395
*   ANSI=' ';                       /*                       @Y30LB54*/
         MVI   ANSI(CVTPTR),C' '                                   0396
*   LIBCTR=1;                       /* SET UP WORKING SPACE SUBSCRIPT
*                                                            @Y30LB54*/
         MVC   LIBCTR(4,DHEWKPTR),@CF00048                         0397
*   PTR5CUR=PTR5TOP;                /* START AT TOP OF INPUT STREAM
*                                                            @Y30LB54*/
         L     @15,PTR5TOP(,DHEWKPTR)                              0398
         ST    @15,PTR5CUR(,DHEWKPTR)                              0398
*   PTRINP=ADDR(DATA04);            /* LOCATION OF COUNTERS  @Y30LB54*/
         LA    @14,DATA04(,DHEWKPTR)                               0399
         ST    @14,PTRINP(,DHEWKPTR)                               0399
*   DO PTR5CUR=PTR5CUR TO PTR5BOT BY 36;/* DO ALL DHE RECORDS@Y30LB54*/
         B     @DE00400                                            0400
@DL00400 DS    0H                                                  0401
*     LINE=' ';                     /* CLEAR PRINT BUFFER    @Y30LB54*/
         MVI   LINE+1(CVTPTR),C' '                                 0401
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0401
         MVI   LINE(CVTPTR),C' '                                   0401
*     INPUTCTR=RPT5CTRS(1);         /* MOVE COUNTERS SO WE CAN     0402
*                                      SUBSCRIPT             @Y30LB54*/
         L     @01,PTRINP(,DHEWKPTR)                               0402
         L     @15,PTR5CUR(,DHEWKPTR)                              0402
         MVC   INPUTCTR(24,@01),RPT5CTRS(@15)                      0402
*     FULLWD1=RPT5SSID(1);          /* PUT IT IN ARITHMETIC AREA   0403
*                                                            @Y30LB54*/
         SLR   @14,@14                                             0403
         IC    @14,RPT5SSID(,@15)                                  0403
         ST    @14,FULLWD1(,DHEWKPTR)                              0403
*     CVD(FULLWD1,CHAR4);           /* CONVERT SSID TO PRINTABLE CHAR
*                                                            @Y30LB54*/
         CVD   @14,@TS00001                                        0404
         MVC   CHAR4(4,DHEWKPTR),@TS00001+4                        0404
*     CHAR4(4)=CHAR4(4)×'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0405
*     UNPK(LINE(5:6),CHAR4(3:4));   /*                       @Y30LB54*/
         UNPK  LINE+4(2,CVTPTR),CHAR4+2(2,DHEWKPTR)                0406
*     LINE(4)='2';                  /* INSERT DEVICE TYPE    @Y30LB54*/
         MVI   LINE+3(CVTPTR),C'2'                                 0407
*     LIBNO(LIBCTR)=RPT5LIB(1);     /* CONVERT LIBRARY TO PRINTABLE
*                                      CHAR                  @Y30LB54*/
         L     @14,LIBCTR(,DHEWKPTR)                               0408
         SLA   @14,2                                               0408
         ALR   @14,DHEWKPTR                                        0408
         MVC   LIBNO-4(1,@14),RPT5LIB(@15)                         0408
*     FULLWD1=1;                    /* LOCATION TO PUT CONVERTED   0409
*                                      VALUE                 @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00048                        0409
*     CALL CONVTLIB;                /* CONVERT IT TO PRINT CHAR    0410
*                                                            @Y30LB54*/
         BAL   @14,CONVTLIB                                        0410
*     LINE(5)=HEXREP(FOURBITS);     /* INSERT MSF IN SSID    @Y30LB54*/
         SLR   @01,@01                                             0411
         IC    @01,FOURBITS(,DHEWKPTR)                             0411
         LA    @15,HEXREP-1(@01)                                   0411
         MVC   LINE+4(1,CVTPTR),0(@15)                             0411
*     EDREC(1:8)=RPT5DATE(1);       /* DATE CONVERSION       @Y30LB54*/
         L     @01,PTR5CUR(,DHEWKPTR)                              0412
         MVC   EDREC(8,DHEWKPTR),RPT5DATE(@01)                     0412
*     CHAR4=EDREC(1:4);             /*                       @Y30LB54*/
         MVC   CHAR4(4,DHEWKPTR),EDREC(DHEWKPTR)                   0413
*     CHAR4(4)=CHAR4(4)×'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0414
*     EDREC1=EDPAT3;                /* MOVE IN EDIT PATTERN  @Y30LB54*/
         MVC   EDREC1(9,DHEWKPTR),EDPAT3                           0415
*     ED(EDREC1,CHAR4);             /* CONVERT               @Y30LB54*/
         ED    EDREC1(9,DHEWKPTR),CHAR4(DHEWKPTR)                  0416
*     LINE(10:12)=EDREC1(7:9);      /* MOVE TO PRINT LINE    @Y30LB54*/
         MVC   LINE+9(3,CVTPTR),EDREC1+6(DHEWKPTR)                 0417
*     LINE(13:13)=EDREC1(6:6);      /* SPIN DATE IT IS BACKWARDS   0418
*                                                            @Y30LB54*/
         MVC   LINE+12(1,CVTPTR),EDREC1+5(DHEWKPTR)                0418
*     LINE(14:15)=EDREC1(4:5);      /* YEAR                  @Y30LB54*/
         MVC   LINE+13(2,CVTPTR),EDREC1+3(DHEWKPTR)                0419
*     CHAR4=EDREC(5:8);             /*                       @Y30LB54*/
         MVC   CHAR4(4,DHEWKPTR),EDREC+4(DHEWKPTR)                 0420
*     CHAR4(4)=CHAR4(4)×'0F'X;      /* DELETE HUNDRETHS OF SECOND  0421
*                                                            @Y30LB54*/
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0421
*     EDREC=EDPAT4;                 /* MOVE IN EDIT PATTERN  @Y30LB54*/
         MVC   EDREC(10,DHEWKPTR),EDPAT4                           0422
*     ED(EDREC,CHAR4);              /* CONVERT IT            @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR4(DHEWKPTR)                  0423
*     LINE(18:25)=EDREC(2:9);       /* MOVE IT TO PRINT LINE @Y30LB54*/
         MVC   LINE+17(8,CVTPTR),EDREC+1(DHEWKPTR)                 0424
*     IF LINE(18)='40'X THEN                                       0425
         CLI   LINE+17(CVTPTR),X'40'                               0425
         BNE   @RF00425                                            0425
*       LINE(18)='F0'X;             /*                       @Y30LB54*/
         MVI   LINE+17(CVTPTR),X'F0'                               0426
*     ELSE                                                         0427
*       ;                           /*                       @Y30LB54*/
@RF00425 DS    0H                                                  0428
*     FULLWD1=28;                   /* LOCATION TO START PRINTING  0428
*                                      COUNTERS              @Y30LB54*/
         MVC   FULLWD1(4,DHEWKPTR),@CF00390                        0428
*     DO CTR=1 TO 6 BY 2;           /*                       @Y30LB54*/
         LA    @15,1                                               0429
         ST    @15,CTR(,DHEWKPTR)                                  0429
@DL00429 DS    0H                                                  0430
*       EDRECF=EDPAT;               /* MOVE IN EDIT PATTERN  @ZM02889*/
         MVC   EDRECF(10),EDPAT                                    0430
*       CVD(INCTR(CTR),CHAR5F);     /* CONVERT COUNTER       @ZM02889*/
         L     @15,CTR(,DHEWKPTR)                                  0431
         SLA   @15,2                                               0431
         L     @01,PTRINP(,DHEWKPTR)                               0431
         AL    @01,@CF00538                                        0431
         L     @15,INCTR(@15,@01)                                  0431
         CVD   @15,@TS00001                                        0431
         MVC   CHAR5F(5),@TS00001+3                                0431
*       CHAR5F(5)=CHAR5F(5)×'0F'X;  /* PROTECT FROM JUNK     @ZM02889*/
         OI    CHAR5F+4,X'0F'                                      0432
*       RFY                                                        0433
*           R1 RSTD; /*ALLOW EDIT AND MARK INSTRUCTION       @ZM02889*/
*      GENERATE CODE; /*EDIT AND MARK NOT BUILT IN           @ZM02889*/
      EDMK  EDRECF,CHAR5F
*       FULLWD2 = INCTR(CTR) & '00008000'X;/*DID IT OVERFLOW @ZM02889*/
         L     @15,CTR(,DHEWKPTR)                                  0435
         SLA   @15,2                                               0435
         L     @14,PTRINP(,DHEWKPTR)                               0435
         AL    @14,@CF00538                                        0435
         L     @00,INCTR(@15,@14)                                  0435
         N     @00,@CF00506                                        0435
         ST    @00,FULLWD2(,DHEWKPTR)                              0435
*       IF FULLWD2 ^= 0 THEN       /*                        @ZM02889*/
         LTR   @00,@00                                             0436
         BZ    @RF00436                                            0436
*        DO; /*NOW HAVE AN OVERFLOW CONDITION                @ZM02889*/
*           R1 = R1 - 1; /*POSITION TO FIRST SIGNIFICANT DIG @ZM02889*/
         BCTR  R1,0                                                0438
*        GENERATE CODE; /*RESULTS OF EDIT AND MARK UNUSABLE  @ZM02889*/
        MVI 0(R1),C'*'
*        END;                                              /*@ZM02889*/
*       ELSE;                                              /*@ZM02889*/
@RF00436 DS    0H                                                  0442
*       RFY                                                        0442
*          R1 UNRSTD; /*CLEAR RESTRICTION OF MARK            @ZM02889*/
*       LINE(FULLWD1+0:FULLWD1+5)=EDRECF(5:10);/*            @ZM02889*/
         L     @01,FULLWD1(,DHEWKPTR)                              0443
         ALR   @01,CVTPTR                                          0443
         MVC   LINE-1(6,@01),EDRECF+4                              0443
*       EDRECF=EDPAT;               /*                       @ZM02889*/
         MVC   EDRECF(10),EDPAT                                    0444
*       CVD(INCTR(CTR+1),CHAR5F);   /* CONVERT IT            @ZM02889*/
         L     @15,CTR(,DHEWKPTR)                                  0445
         SLA   @15,2                                               0445
         L     @01,PTRINP(,DHEWKPTR)                               0445
         L     @15,INCTR(@15,@01)                                  0445
         CVD   @15,@TS00001                                        0445
         MVC   CHAR5F(5),@TS00001+3                                0445
*       CHAR5F(5)=CHAR5F(5)×'0F'X;  /* PROTECT FROM JUNK     @ZM02889*/
         OI    CHAR5F+4,X'0F'                                      0446
*       RFY                                                        0447
*         R1 RSTD; /*ALLOW EDIT AND MARK INSTRUCTION         @ZM02889*/
*        GENERATE CODE; /*EDIT AND MARK NOT BUILT IN         @ZM02889*/
        EDMK    EDRECF,CHAR5F
*       IF CTR ^=5 THEN             /*LOAD HAS DIFFERENT MASK@ZM02889*/
         L     @15,CTR(,DHEWKPTR)                                  0449
         CH    @15,@CH00150                                        0449
         BE    @RF00449                                            0449
*           FULLWD2 = INCTR(CTR+1) & '00800000'X;/*OVERFLOW MASK   0450
*                                                            @ZM02889*/
         SLA   @15,2                                               0450
         L     @14,PTRINP(,DHEWKPTR)                               0450
         L     @00,INCTR(@15,@14)                                  0450
         N     @00,@CF00507                                        0450
         ST    @00,FULLWD2(,DHEWKPTR)                              0450
*       ELSE                                               /*@ZM02889*/
*           FULLWD2 = INCTR(CTR+1) & '00008000'X;/*OVERFLOW MASK   0451
*                                                            @ZM02889*/
         B     @RC00449                                            0451
@RF00449 L     @15,CTR(,DHEWKPTR)                                  0451
         SLA   @15,2                                               0451
         L     @14,PTRINP(,DHEWKPTR)                               0451
         L     @00,INCTR(@15,@14)                                  0451
         N     @00,@CF00506                                        0451
         ST    @00,FULLWD2(,DHEWKPTR)                              0451
*       IF FULLWD2 ^= 0 THEN                               /*@ZM02889*/
@RC00449 ICM   @00,15,FULLWD2(DHEWKPTR)                            0452
         BZ    @RF00452                                            0452
*        DO;                                               /*@ZM02889*/
*          R1 = R1 - 1; /*POSITION TO FIRST SIGNIFICANT DIG  @ZM02889*/
         BCTR  R1,0                                                0454
*          GENERATE CODE; /*RESULTS OF EDIT AND MARK UNUSABLE@ZM02889*/
         MVI 0(R1),C'*'
*        END;          /*                                    @ZM02889*/
*       ELSE;         /*                                     @ZM02889*/
@RF00452 DS    0H                                                  0458
*       RFY                                                        0458
*         R1 UNRSTD; /*CLEAR RESTRICTION OF MARK             @ZM02889*/
*       LINE(FULLWD1+6:FULLWD1+15)=EDRECF(1:10);/*           @ZM02889*/
         L     @01,FULLWD1(,DHEWKPTR)                              0459
         ALR   @01,CVTPTR                                          0459
         MVC   LINE+5(10,@01),EDRECF                               0459
*       IF INCTR(CTR+1)^=0 THEN                                    0460
         L     @15,CTR(,DHEWKPTR)                                  0460
         SLA   @15,2                                               0460
         L     @14,PTRINP(,DHEWKPTR)                               0460
         L     @09,INCTR(@15,@14)                                  0460
         LTR   @09,@09                                             0460
         BZ    @RF00460                                            0460
*         FULLWD2=(INCTR(CTR)*10000)/INCTR(CTR+1);/*         @Y30LB54*/
         AL    @14,@CF00538                                        0461
         L     @08,INCTR(@15,@14)                                  0461
         MH    @08,@CH00382                                        0461
         ST    @09,@TF00001                                        0461
         SRDA  @08,32                                              0461
         D     @08,@TF00001                                        0461
         ST    @09,FULLWD2(,DHEWKPTR)                              0461
*       ELSE                                                       0462
*         FULLWD2=0;                /* NO RATIO              @Y30LB54*/
         B     @RC00460                                            0462
@RF00460 SLR   @15,@15                                             0462
         ST    @15,FULLWD2(,DHEWKPTR)                              0462
*       EDREC=EDPAT1;               /*                       @Y30LB54*/
@RC00460 MVC   EDREC(10,DHEWKPTR),EDPAT1                           0463
*       CVD(FULLWD2,CHAR5);         /* CONVERT IT            @Y30LB54*/
         L     @15,FULLWD2(,DHEWKPTR)                              0464
         CVD   @15,@TS00001                                        0464
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0464
*       CHAR5(5)=CHAR5(5)×'0F'X;    /*                       @Y30LB54*/
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0465
*       ED(EDREC,CHAR5);            /* CONVERT IT            @Y30LB54*/
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0466
*       LINE(FULLWD1+16:FULLWD1+20)=EDREC(6:10);/*           @Y30LB54*/
         L     @15,FULLWD1(,DHEWKPTR)                              0467
         ALR   @15,CVTPTR                                          0467
         MVC   LINE+15(5,@15),EDREC+5(DHEWKPTR)                    0467
*       FULLWD1=FULLWD1+24;         /* NEXT TIME AROUND PRINT POS  0468
*                                                            @Y30LB54*/
         L     @15,FULLWD1(,DHEWKPTR)                              0468
         AH    @15,@CH00121                                        0468
         ST    @15,FULLWD1(,DHEWKPTR)                              0468
*     END;                          /*                       @Y30LB54*/
         LA    @15,2                                               0469
         AL    @15,CTR(,DHEWKPTR)                                  0469
         ST    @15,CTR(,DHEWKPTR)                                  0469
         CH    @15,@CH00141                                        0469
         BNH   @DL00429                                            0469
*     CALL ISDAPRT0(WORKPTR);       /* PRINT LINE            @Y30LB54*/
         L     @15,@PC00001                                        0470
         ST    @15,@AL00001                                        0470
         L     @15,@CV00040                                        0470
         LA    @01,@AL00001                                        0470
         BALR  @14,@15                                             0470
*   END;                            /*                       @Y30LB54*/
         LA    @15,36                                              0471
         AL    @15,PTR5CUR(,DHEWKPTR)                              0471
         ST    @15,PTR5CUR(,DHEWKPTR)                              0471
@DE00400 C     @15,PTR5BOT(,DHEWKPTR)                              0471
         BNH   @DL00400                                            0471
*   END RPT5BDY;                    /*                       @Y30LB54*/
@EL00012 DS    0H                                                  0472
@EF00012 DS    0H                                                  0472
@ER00012 L     @14,@SA00012                                        0472
         BR    @14                                                 0472
*                                                                  0473
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT LIBRARY NUMBER TO PRINTABLE CHAR                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*/*FULLWD1 WILL POINT TO OUTPUT PRINT POSITION               @Y30LB54*/
*/*LIBCTR WILL POINT TO LIBRARY CONTROL BLOCK                @Y30LB54*/
*                                                                  0473
*CONVTLIB:                                                         0473
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
CONVTLIB ST    @14,12(,@13)                                        0473
*   KICKPTR=LIBPTR(LIBCTR);         /* ESTABLISH BASE FOR COUNTERS 0474
*                                                            @Y30LB54*/
         L     @15,LIBCTR(,DHEWKPTR)                               0474
         SLA   @15,2                                               0474
         L     @14,LIBPTR-5(@15,DHEWKPTR)                          0474
         LA    @14,0(,@14)                                         0474
         ST    @14,KICKPTR(,DHEWKPTR)                              0474
*   LIBNO(LIBCTR)=LIBNO(LIBCTR)-1;  /* PRINT TRUE VALUE      @Y30LB54*/
         SLR   @14,@14                                             0475
         IC    @14,LIBNO-4(@15,DHEWKPTR)                           0475
         BCTR  @14,0                                               0475
         STC   @14,LIBNO-4(@15,DHEWKPTR)                           0475
*   FOURBITS=LIBNO(LIBCTR)&'0F'X;   /* TAKE BOTTOM BYTE      @Y30LB54*/
         ST    @15,@TF00001                                        0476
         ALR   @15,DHEWKPTR                                        0476
         MVC   FOURBITS(1,DHEWKPTR),LIBNO-4(@15)                   0476
         NI    FOURBITS(DHEWKPTR),X'0F'                            0476
*   FOURBITS=FOURBITS+1;            /* DISPLACE INTO CONVERSION TABLE
*                                                            @Y30LB54*/
         LA    @15,1                                               0477
         SLR   @09,@09                                             0477
         IC    @09,FOURBITS(,DHEWKPTR)                             0477
         ALR   @09,@15                                             0477
         STC   @09,FOURBITS(,DHEWKPTR)                             0477
*   LINE(FULLWD1:FULLWD1)=HEXREP(FOURBITS);/*                @Y30LB54*/
         L     @01,FULLWD1(,DHEWKPTR)                              0478
         ALR   @01,CVTPTR                                          0478
         LA    @08,HEXREP-1(@09)                                   0478
         MVC   LINE-1(1,@01),0(@08)                                0478
*   LIBNO(LIBCTR)=LIBNO(LIBCTR)+1;  /* ALLOW FOR START AT 0  @Y30LB54*/
         ALR   @14,@15                                             0479
         L     @15,@TF00001                                        0479
         STC   @14,LIBNO-4(@15,DHEWKPTR)                           0479
*   END CONVTLIB;                   /*                       @Y30LB54*/
@EL00013 DS    0H                                                  0480
@EF00013 DS    0H                                                  0480
@ER00013 L     @14,12(,@13)                                        0480
         BR    @14                                                 0480
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /* SORT THE RATIO TABLE FOR GRAPH PORTION OF REPORT              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*RATSORT:                                                          0481
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RATSORT  ST    @14,12(,@13)                                        0481
*   SORTSW='0'B;                    /*                       @Y30LB54*/
         MVI   SORTSW(DHEWKPTR),B'00000000'                        0482
*   DO CTR=1 TO 23 BY 1;            /* 8 SSID TIMES 3 POSSIBILITIES
*                                      READ-WRITE-LOAD       @Y30LB54*/
         LA    @05,1                                               0483
         ST    @05,CTR(,DHEWKPTR)                                  0483
@DL00483 DS    0H                                                  0484
*     IF RATIOTBL(CTR+1)>RATIOTBL(CTR) THEN                        0484
         L     @05,CTR(,DHEWKPTR)                                  0484
         SLA   @05,2                                               0484
         ST    @05,@TF00001                                        0484
         ALR   @05,DHEWKPTR                                        0484
         LR    @01,DHEWKPTR                                        0484
         AL    @01,@TF00001                                        0484
         CLC   RATIOTBL(4,@05),RATIOTBL-4(@01)                     0484
         BNH   @RF00484                                            0484
*       DO;                         /*                       @Y30LB54*/
*         FULLWD1=RATIOTBL(CTR);    /* SWAP THEY ARE OUT OF ORDER  0486
*                                                            @Y30LB54*/
         L     @05,@TF00001                                        0486
         L     @05,RATIOTBL-4(@05,DHEWKPTR)                        0486
         ST    @05,FULLWD1(,DHEWKPTR)                              0486
*         RATIOTBL(CTR)=RATIOTBL(CTR+1);/*                   @Y30LB54*/
         LR    @01,DHEWKPTR                                        0487
         AL    @01,@TF00001                                        0487
         LR    @15,DHEWKPTR                                        0487
         AL    @15,@TF00001                                        0487
         MVC   RATIOTBL-4(4,@01),RATIOTBL(@15)                     0487
*         RATIOTBL(CTR+1)=FULLWD1;  /*                       @Y30LB54*/
         L     @01,@TF00001                                        0488
         ST    @05,RATIOTBL(@01,DHEWKPTR)                          0488
*         SORTSW='1'B;              /* TELL WORLD WE REALY DID SORT
*                                                            @Y30LB54*/
         MVI   SORTSW(DHEWKPTR),B'10000000'                        0489
*         CTR=0;                    /* START BUBBLE UP PROCESS OVER
*                                      AGAIN                 @Y30LB54*/
         SLR   @05,@05                                             0490
         ST    @05,CTR(,DHEWKPTR)                                  0490
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0492
*       ;                           /*                       @Y30LB54*/
@RF00484 DS    0H                                                  0493
*   END;                            /*                       @Y30LB54*/
         LA    @05,1                                               0493
         AL    @05,CTR(,DHEWKPTR)                                  0493
         ST    @05,CTR(,DHEWKPTR)                                  0493
         CH    @05,@CH00515                                        0493
         BNH   @DL00483                                            0493
*   END RATSORT;                    /*                       @Y30LB54*/
@EL00014 DS    0H                                                  0494
@EF00014 DS    0H                                                  0494
@ER00014 L     @14,12(,@13)                                        0494
         BR    @14                                                 0494
*                                                                  0495
*   /*****************************************************************/
*   /*                                                               */
*   /* SORT THE DHE RECORDS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*RECSORT:                                                          0495
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/
RECSORT  ST    @14,12(,@13)                                        0495
*   PTR5BOT=PTR5CUR-36;             /* LAST RECORD WRITTEN   @Y30LB54*/
         L     @15,PTR5CUR(,DHEWKPTR)                              0496
         SH    @15,@CH00276                                        0496
         ST    @15,PTR5BOT(,DHEWKPTR)                              0496
*   PTR5CUR=PTR5TOP;                /* START AT FRONT OF FILE@Y30LB54*/
         L     @15,PTR5TOP(,DHEWKPTR)                              0497
         ST    @15,PTR5CUR(,DHEWKPTR)                              0497
*   PTRINP=ADDR(DATA04);            /* WORKING AREA FOR COUNTERS   0498
*                                                            @Y30LB54*/
         LA    @14,DATA04(,DHEWKPTR)                               0498
         ST    @14,PTRINP(,DHEWKPTR)                               0498
*   DO PTR5CUR=PTR5CUR TO(PTR5BOT-36) BY 36;/*               @Y30LB54*/
         B     @DE00499                                            0499
@DL00499 DS    0H                                                  0500
*     IF RPT5RCD(2)<RPT5RCD(1) THEN                                0500
         L     @15,PTR5CUR(,DHEWKPTR)                              0500
         CLC   RPT5RCD+36(36,@15),RPT5RCD(@15)                     0500
         BNL   @RF00500                                            0500
*       DO;                         /*                       @Y30LB54*/
*         DATA05=RPT5RCD(1);        /*                       @Y30LB54*/
         MVC   DATA05(36,DHEWKPTR),RPT5RCD(@15)                    0502
*         RPT5RCD(1)=RPT5RCD(2);    /*                       @Y30LB54*/
         MVC   RPT5RCD(36,@15),RPT5RCD+36(@15)                     0503
*         RPT5RCD(2)=DATA05;        /*                       @Y30LB54*/
         MVC   RPT5RCD+36(36,@15),DATA05(DHEWKPTR)                 0504
*         PTR5CUR=PTR5TOP;          /*                       @Y30LB54*/
         MVC   PTR5CUR(4,DHEWKPTR),PTR5TOP(DHEWKPTR)               0505
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0507
*       ;                           /*                       @Y30LB54*/
@RF00500 DS    0H                                                  0508
*   END;                            /*                       @Y30LB54*/
         LA    @15,36                                              0508
         AL    @15,PTR5CUR(,DHEWKPTR)                              0508
         ST    @15,PTR5CUR(,DHEWKPTR)                              0508
@DE00499 L     @14,PTR5BOT(,DHEWKPTR)                              0508
         SH    @14,@CH00276                                        0508
         CR    @15,@14                                             0508
         BNH   @DL00499                                            0508
*   END RECSORT;                    /*                       @Y30LB54*/
@EL00015 DS    0H                                                  0509
@EF00015 DS    0H                                                  0509
@ER00015 L     @14,12(,@13)                                        0509
         BR    @14                                                 0509
*                                                                  0510
*   /*****************************************************************/
*   /*                                                               */
*   /* FREECORE - ROUTINE TO FREE ALL CORE AQUIRED BY ISDADHE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0510
*FREECORE:                                                         0510
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/
FREECORE ST    @14,@SA00016                                        0510
*   DO CTR1=1 TO 4 BY 1;            /*                       @Y30LB54*/
         LA    @05,1                                               0511
         ST    @05,CTR1(,DHEWKPTR)                                 0511
@DL00511 DS    0H                                                  0512
*     IF LIBPTR(CTR1)^=0 THEN       /* FREE ALL CORE ALREADY OBTAINED
*                                                            @Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0512
         SLA   @05,2                                               0512
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0512
         LA    @05,0(,@05)                                         0512
         LTR   @05,@05                                             0512
         BZ    @RF00512                                            0512
*       DO;                         /*                       @Y30LB54*/
*         SPNO=0;                   /*                       @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0514
*         CORELEN=192+32+768;       /* FILL IN LENGTH OF AREA@Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00535+1                        0515
*         COREADDR=LIBPTR(CTR1);    /* FILL IN ADDRESS OF AREA     0516
*                                                            @Y30LB54*/
         ST    @05,COREADDR(,CVTPTR)                               0516
*         CALL ISDAFREE(WORKPTR);   /*                       @Y30LB54*/
         L     @05,@PC00001                                        0517
         ST    @05,@AL00001                                        0517
         L     @15,@CV00042                                        0517
         LA    @01,@AL00001                                        0517
         BALR  @14,@15                                             0517
*         LIBPTR(CTR1)=0;           /* DELETE GOTTEN CORE PTR@Y30LB54*/
         L     @05,CTR1(,DHEWKPTR)                                 0518
         SLA   @05,2                                               0518
         ALR   @05,DHEWKPTR                                        0518
         SLR   @15,@15                                             0518
         STCM  @15,7,LIBPTR-4(@05)                                 0518
*       END;                        /*                       @Y30LB54*/
*     ELSE                                                         0520
*       ;                           /*                       @Y30LB54*/
@RF00512 DS    0H                                                  0521
*   END;                            /*                       @Y30LB54*/
         LA    @05,1                                               0521
         AL    @05,CTR1(,DHEWKPTR)                                 0521
         ST    @05,CTR1(,DHEWKPTR)                                 0521
         CH    @05,@CH00051                                        0521
         BNH   @DL00511                                            0521
*   IF PTR5TOP^=0 THEN              /* DO WE HAVE DHE SPACE  @Y30LB54*/
         L     @05,PTR5TOP(,DHEWKPTR)                              0522
         LTR   @05,@05                                             0522
         BZ    @RF00522                                            0522
*     DO;                           /*                       @Y30LB54*/
*       SPNO=0;                     /*                       @Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0524
*       CORELEN=50*36;              /*                       @Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00536+1                        0525
*       COREADDR=PTR5TOP;           /*                       @Y30LB54*/
         ST    @05,COREADDR(,CVTPTR)                               0526
*       CALL ISDAFREE(WORKPTR);     /*                       @Y30LB54*/
         L     @05,@PC00001                                        0527
         ST    @05,@AL00001                                        0527
         L     @15,@CV00042                                        0527
         LA    @01,@AL00001                                        0527
         BALR  @14,@15                                             0527
*       PTR5TOP=0;                  /*                       @Y30LB54*/
         SLR   @05,@05                                             0528
         ST    @05,PTR5TOP(,DHEWKPTR)                              0528
*       PTR5CUR=0;                  /*                       @Y30LB54*/
         ST    @05,PTR5CUR(,DHEWKPTR)                              0529
*       PTR5BOT=0;                  /*                       @Y30LB54*/
         ST    @05,PTR5BOT(,DHEWKPTR)                              0530
*     END;                          /*                       @Y30LB54*/
*   ELSE                                                           0532
*     ;                             /*                       @Y30LB54*/
@RF00522 DS    0H                                                  0533
*   SPNO=0;                         /* FREE WORKING CORE ALSO@Y30LB54*/
         MVI   SPNO(CVTPTR),X'00'                                  0533
*   CORELEN=LENGTH(WORKCORE);       /* FILL IN LENGTH OF AREA@Y30LB54*/
         MVC   CORELEN(3,CVTPTR),@CF00537+1                        0534
*   COREADDR=DHE00PTR;              /* FILL IN LOCATION ADDRESS    0535
*                                                            @Y30LB54*/
         MVC   COREADDR(4,CVTPTR),DHE00PTR(CVTPTR)                 0535
*   CALL ISDAFREE(WORKPTR);         /*                       @Y30LB54*/
         L     @05,@PC00001                                        0536
         ST    @05,@AL00001                                        0536
         L     @15,@CV00042                                        0536
         LA    @01,@AL00001                                        0536
         BALR  @14,@15                                             0536
*   DHE00PTR=0;                     /* TELL THE WORLD WE QUIT@Y30LB54*/
         SLR   @05,@05                                             0537
         ST    @05,DHE00PTR(,CVTPTR)                               0537
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/
         LR    @15,RETCODE                                         0538
@EL00016 DS    0H                                                  0538
@EF00016 DS    0H                                                  0538
@ER00016 L     @14,@SA00016                                        0538
         BR    @14                                                 0538
*   END FREECORE;                   /*                       @Y30LB54*/
*   END ISDADHE1                    /*                       @Y30LB54*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*;                                                                 0540
@DATA    DS    0H
@CH00051 DC    H'4'
@CH00141 DC    H'6'
@CH00294 DC    H'7'
@CH00155 DC    H'10'
@CH00191 DC    H'16'
@CH00515 DC    H'23'
@CH00121 DC    H'24'
@CH00172 DC    H'25'
@CH00276 DC    H'36'
@CH00374 DC    H'43'
@CH00337 DC    H'107'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    1F
@SA00003 DS    1F
@SA00008 DS    1F
@SA00009 DS    1F
@SA00012 DS    1F
@SA00010 DS    0F
@SA00016 DS    0F
@SA00011 DS    0F
@SA00007 DS    0F
@SA00006 DS    0F
         DS    1F
@AL00001 DS    1A
@TF00001 DS    F
ISDADHE1 CSECT
         DS    0F
@CF00048 DC    F'1'
@CH00048 EQU   @CF00048+2
@CF00068 DC    F'3'
@CH00068 EQU   @CF00068+2
@CF00150 DC    F'5'
@CH00150 EQU   @CF00150+2
@CF00180 DC    F'20'
@CH00180 EQU   @CF00180+2
@CF00390 DC    F'28'
@CF00373 DC    F'33'
@CF00429 DC    F'62'
@CF00320 DC    F'74'
@CF00398 DC    F'100'
@CF00537 DC    F'336'
@CF00535 DC    F'992'
@CF00536 DC    F'1800'
@CF00382 DC    F'10000'
@CH00382 EQU   @CF00382+2
@CF00538 DC    F'-4'
@CF00381 DC    F'-1'
@CF00506 DC    XL4'00008000'
@CF00507 DC    XL4'00800000'
@DATD    DSECT
         DS    0D
         DS    0D
@TS00001 DS    CL8
EDRECF   DS    CL10
CHAR5F   DS    CL5
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDADHE1 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00040 DC    V(ISDAPRT0)
@CV00042 DC    V(ISDAFREE)
@CV00041 DC    V(ISDATYPE)
         DS    0D
@CC00361 DC    C'------------------------------------------------------C
               --------------------------------------------------------C
               -----------'
@CC00441 EQU   @CC00361
@CC00492 DC    C'--×-----×-------×---------×-----------------------×---C
               --------------------×-----------------------×'
@CC00391 DC    C'×         ×         ×         ×         ×         ×   C
                     ×         ×         ×         ×'
@CC00327 DC    C'×   200   ×   201   ×   202   ×   203   ×   204   ×   C
               205   ×   206   ×   207   ×'
@CC00338 DC    C'×---------×---------×---------×---------×---------×---C
               ------×---------×---------×'
@CC00351 EQU   @CC00391
@CC00405 EQU   @CC00361
@CC00462 DC    C'REPORT 13 - DATA HANDLING ERRORS FOR DRDS - DRD BUFFERC
               ED LOG COUNTER OVERFLOW'
@CC00310 DC    C'REPORT 12 - DATA HANDLING USAGE FOR DRDS - DRD BUFFEREC
               D LOG'
@CC00424 DC    C'REPORT 12 - LAST FOUR ACTIVE DAYS TRENDING'
@CC00317 DC    C'(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)'
@CC00470 DC    C'* INDICATES WHICH COUNTER OVERFLOWED'
@CC00402 EQU   @CC00361
@CC00433 DC    C'READ ERROR RATIO        DATE'
@CC00455 DC    C'------NO INPUT DATA------'
@CC00388 DC    C'     ERROR USAGE RATIO'
@CC00414 DC    C'W - WRITE ERROR RATIO'
@CC00188 DC    C'ERRORS/USAGE = RATIO'
@CC00412 DC    C'R - READ ERROR RATIO'
@CC00416 DC    C'L - LOAD ERROR RATIO'
@CC00437 DC    C'WRITE ERROR RATIO'
@CC00439 DC    C'LOAD ERROR RATIO'
@CC00479 DC    C'STRIPES WRITTEN'
@CC00475 DC    C'STRIPES READ'
@CC00346 EQU   @CC00361
@CC00324 DC    C'DRD SSID'
@CC00484 DC    C'NO  SSID'
@CC00411 DC    C'LEGEND:'
@CC00473 DC    C'MSF DRD'
@CC00335 DC    C'TOTALS'
@CC00483 EQU   @CC00439
@CC00486 DC    C'DATE'
@CC00488 DC    C'TIME'
@CC00153 DC    C'DHE'
@CC00308 EQU   @CC00473
@CB00383 DC    X'00000000'
EDPAT    DC    X'40202020202020202120'
EDPAT1   DC    X'4020202020214B202020'
EDPAT3   DC    X'402021202061202020'
EDPAT4   DC    X'4021207A20207A202020'
PATCH    DC    50X'00'
         DS    CL1
BYTECODE DC    XL3'0'
         DC    C'R'
         DC    XL3'0'
         DC    C'W'
         DC    XL3'0'
         DC    C'L'
BODY1    DC    CL10'     READ '
         DC    CL10'     WRITE'
         DC    CL10'     LOAD '
BODY2    DC    CL25'STRIPE SOFT READ ERRORS'
         DC    CL25'STRIPE SOFT WRITE ERRORS'
         DC    CL25'SOFT LOAD ERRORS'
BODY3    DC    CL20'STRIPE READ USAGE'
         DC    CL20'STRIPE WRITE USAGE'
         DC    CL20'LOAD USAGE'
BODY4    DC    CL20'ERRORS/USAGE = RATIO'
         DC    CL20'ERRORS/USAGE = RATIO'
         DC    CL20'ERRORS/USAGE = RATIO'
HEXREP   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DHEWKPTR EQU   @03
RETCODE2 EQU   @05
RETCODE1 EQU   @07
RETCODE  EQU   @04
LPARMPTR EQU   @06
CVTPTR   EQU   @02
R1       EQU   @01
R0       EQU   @00
R15      EQU   @15
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CDHEDHU  EQU   CREPORTS+3
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
PARMPTR  EQU   CVTPTRS0+8
DHE00PTR EQU   CVTPTRS0+52
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
ANSI     EQU   OUTLINE
LINE     EQU   OUTLINE+1
SDARPTID EQU   PRT0CALL+133
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
RPT5RCD  EQU   0
RPT5LIB  EQU   RPT5RCD
RPT5DATE EQU   RPT5RCD+1
RPT5SSID EQU   RPT5RCD+9
RPT5CTRS EQU   RPT5RCD+12
INPUTCTR EQU   0
INCTR    EQU   INPUTCTR
COUNTER  EQU   0
WORKCORE EQU   0
LIBTAB   EQU   WORKCORE+4
LIBNO    EQU   LIBTAB
LIBPTR   EQU   LIBTAB+1
FULLWD1  EQU   WORKCORE+20
FULLWD2  EQU   WORKCORE+24
DATASSID EQU   WORKCORE+28
KICKPTR  EQU   WORKCORE+36
PTRRPT   EQU   WORKCORE+40
PTRSSID  EQU   WORKCORE+48
PTRDATE  EQU   WORKCORE+52
PTRINP   EQU   WORKCORE+56
CTR      EQU   WORKCORE+60
CTR1     EQU   WORKCORE+64
CHAR4    EQU   WORKCORE+68
COUNTRP4 EQU   WORKCORE+72
COUNTRP5 EQU   WORKCORE+80
DATETBL  EQU   WORKCORE+84
DATEYYDD EQU   DATETBL
DATEOFST EQU   DATETBL+4
PTR5TOP  EQU   WORKCORE+124
PTR5CUR  EQU   WORKCORE+128
PTR5BOT  EQU   WORKCORE+132
LIBCTR   EQU   WORKCORE+136
GRANDU   EQU   WORKCORE+140
GRANDE   EQU   WORKCORE+144
RATCTR   EQU   WORKCORE+148
RATIOTBL EQU   WORKCORE+152
RATCNT   EQU   RATIOTBL
RATSSID  EQU   RATIOTBL+2
RATCODE  EQU   RATIOTBL+3
DATA04   EQU   WORKCORE+248
DATA05   EQU   WORKCORE+272
SORTSW   EQU   WORKCORE+309
FOURBITS EQU   WORKCORE+310
EDREC    EQU   WORKCORE+311
EDREC1   EQU   WORKCORE+321
CHAR5    EQU   WORKCORE+330
WORKPTR  EQU   0
BYTESSID EQU   DATASSID+3
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ENDAREA  EQU   WORKCORE+335
DATAWORK EQU   WORKCORE+308
COUNTR4A EQU   WORKCORE+76
PTRLIB   EQU   WORKCORE+44
DATALIB  EQU   WORKCORE+32
LOGPTR   EQU   WORKCORE
COUNT    EQU   COUNTER
@NM00003 EQU   RPT5RCD+10
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
WORKCALL EQU   CVTPTRS0+96
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
APR00PTR EQU   CVTPTRS0+80
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
SDA00PTR EQU   CVTPTRS0+12
SDATAPTR EQU   CVTPTRS0+4
DATAPTR  EQU   CVTPTRS0
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CAPRSUU  EQU   CREPORTS+10
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00078 EQU   @RC00077
@RT00250 EQU   @EL00006
@RT00260 EQU   @EL00006
@RC00079 EQU   @RC00078
@RC00080 EQU   @RC00079
@ENDDATA EQU   *
         END   ISDADHE1,(C'PLS1807',0701,78044)

         TITLE 'ISDAAPR0 - ALTERNATE PATH RETRY ACCUMULATOR            *
                        '
ISDAAPR0 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISDAAPR0  78.044'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         ISDAGSPC R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0019
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALYZE SECTION                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0019
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO ISDACVT    0019
*                                                            @ZD00192*/
         L     @07,@PC00001                                        0019
         L     CVTPTR,WORKPTR(,@07)                                0019
*   RETCODE=0;                      /* ZERO RETURN CODE      @ZD00192*/
         SLR   RETCODE,RETCODE                                     0020
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO ISDAPRMS   0021
*                                                            @ZD00192*/
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                         0021
*   LOGPTR=DATAPTR;                 /* SET LOCAL PTR TO OBRMDR     0022
*                                                            @ZD00192*/
         L     LOGPTR,DATAPTR(,CVTPTR)                             0022
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO ISDAMSCS   0023
*                                                            @ZD00192*/
         L     SENSEPTR,SDATAPTR(,CVTPTR)                          0023
*   IF APR00PTR=0 THEN              /* ON FIRST CALL         @ZD00192*/
*                                                                  0024
         ICM   @07,15,APR00PTR(CVTPTR)                             0024
         BNZ   @RF00024                                            0024
*     /***************************************************************/
*     /*                                                             */
*     /* GET CORE FOR APRWORK                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0025
*     DO;                           /* GET CORE              @ZD00192*/
*       APRWKPTR=0;                 /* INITIALYZE APRWKPTR   @ZD00192*/
         SLR   APRWKPTR,APRWKPTR                                   0026
*       GET0PTR=0;                  /* INITIALYZE GET0PTR    @ZD00192*/
         SLR   GET0PTR,GET0PTR                                     0027
*       CALL GETWORK;               /* CALL GET CORE PROC    @ZD00192*/
         BAL   @14,GETWORK                                         0028
*     END;                          /* END GETMAIN FOR WORKAREA AND
*                                      ACCUMULATOR           @ZD00192*/
*   ELSE                            /* ON ALL OTHER CALLS    @ZD00192*/
*                                                                  0030
*     /***************************************************************/
*     /*                                                             */
*     /* NOT FIRST CALL, SET UP LOCAL POINTERS                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0030
*     APRWKPTR=APR00PTR;            /* SET ADDR TO WORKAREA  @ZD00192*/
         B     @RC00024                                            0030
@RF00024 L     APRWKPTR,APR00PTR(,CVTPTR)                          0030
*   IF RETCODE=0 THEN               /* GOT WORKAREA          @ZD00192*/
*                                                                  0031
@RC00024 LTR   RETCODE,RETCODE                                     0031
         BNZ   @RF00031                                            0031
*     /***************************************************************/
*     /*                                                             */
*     /* ANALYZE INPUT RECORD AND SET TYPE CODE                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0032
*     CALL GETCODE;                 /* ANALYZE RECORD        @ZD00192*/
         BAL   @14,GETCODE                                         0032
*   ELSE                                                           0033
*     ;                             /* BAD RETURN FROM GETWORK     0033
*                                                            @ZD00192*/
@RF00031 DS    0H                                                  0034
*   IF RETCODE=0 THEN               /* CONTINUE              @ZD00192*/
*                                                                  0034
         LTR   RETCODE,RETCODE                                     0034
         BNZ   @RF00034                                            0034
*     /***************************************************************/
*     /*                                                             */
*     /* ADD RECORD TO ACCUMULATOR OR UPDATE IF SUU ONLY             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0035
*     CALL ADDREC;                  /* YES, ADD THE RECORD   @ZD00192*/
         BAL   @14,ADDREC                                          0035
*   ELSE                                                           0036
*     ;                             /* NO, DO NOT ADD IT     @ZD00192*/
@RF00034 DS    0H                                                  0037
*   IF RETCODE=4 THEN               /* NO CORE SITUATION     @ZD00192*/
*                                                                  0037
         CH    RETCODE,@CH00104                                    0037
         BNE   @RF00037                                            0037
*     /***************************************************************/
*     /*                                                             */
*     /* FREE ALL ACCUMULATORS AND THE WORK AREA                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0038
*     CALL FREECORE;                /* YES, FREE ALL CORE    @ZD00192*/
         BAL   @14,FREECORE                                        0038
*   ELSE                                                           0039
*     IF RETCODE<4 THEN             /* SPECIAL INTERNAL RETCODE    0039
*                                                            @ZD00192*/
         B     @RC00037                                            0039
@RF00037 CH    RETCODE,@CH00104                                    0039
         BNL   @RF00039                                            0039
*       RETCODE=0;                  /* YES, RESET RETCODE    @ZD00192*/
         SLR   RETCODE,RETCODE                                     0040
*     ELSE                                                         0041
*       ;                           /* NO, MUST BE VALID BAD RETCODE
*                                                            @ZD00192*/
@RF00039 DS    0H                                                  0042
*   RETURN CODE(RETCODE);           /* RETURN TO ISDASDA0    @ZD00192*/
@RC00037 L     @13,4(,@13)                                         0042
         L     @00,@SIZDATD                                        0042
         LR    @01,@11                                             0042
         ISDAFSPC R,LV=(0),A=(1)
         LR    @15,@06                                             0042
         L     @14,12(,@13)                                        0042
         LM    @00,@12,20(@13)                                     0042
         BR    @14                                                 0042
*                                                                  0043
*   /*****************************************************************/
*   /*                                                               */
*   /* GETWORK - CALL ISDAGET1 FOR SMALL ISDAAPR WORK AREA           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*GETWORK:                                                          0043
*   PROC OPTIONS(SAVE(14));         /* PROC TO GET WORKAREA  @ZD00192*/
@EL00001 L     @13,4(,@13)                                         0043
@EF00001 L     @00,@SIZDATD                                        0043
         LR    @01,@11                                             0043
         ISDAFSPC R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0043
         BR    @14                                                 0043
GETWORK  ST    @14,@SA00002                                        0043
*   CORELEN=LENGTH(APRWORK);        /* LENGTH OF APRWORK     @ZD00192*/
         MVC   CORELEN(3,CVTPTR),@CF00451+1                        0044
*   SPNO=APRSPNO;                   /* SET MY SUBPOOL NUMBER @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0045
*   RFY                                                            0046
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> ADDR(WORKPTR)   @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0047
*   CALL ISDAGET1;                  /* GET APRWORK WITHOUT HEADER  0048
*                                                            @ZD00192*/
         L     @15,@CV00398                                        0048
         BALR  @14,@15                                             0048
*   RFY                                                            0049
*     R15 RSTD;                     /*                       @ZD00192*/
*   RETCODE=R15;                    /* SAVE RETURN CODE      @ZD00192*/
         LR    RETCODE,R15                                         0050
*   RFY                                                            0051
*    (R1,                                                          0051
*     R15) UNRSTD;                  /*                       @ZD00192*/
*   IF RETCODE=0 THEN               /* WAS GETMAIN DONE      @ZD00192*/
         LTR   RETCODE,RETCODE                                     0052
         BNZ   @RF00052                                            0052
*     DO;                           /* YES, SET ALL ADDRESS POINTERS
*                                                            @ZD00192*/
*       APR00PTR=COREADDR;          /* STORE WORKAREA ADDRESS IN   0054
*                                      ISDACVT               @ZD00192*/
         L     @07,COREADDR(,CVTPTR)                               0054
         ST    @07,APR00PTR(,CVTPTR)                               0054
*       APRWKPTR=COREADDR;          /* SET ADDR TO WORKAREA  @ZD00192*/
         LR    APRWKPTR,@07                                        0055
*       APRWORK=''B;                /* ZERO ACCUMULATOR      @ZD00192*/
         XC    APRWORK(124,APRWKPTR),APRWORK(APRWKPTR)             0056
* /*    CALL TRACEWRK                  DUMP WORK AREA IF REQ @ZD00192*/
*     END;                          /* END INITIALIZE APRWORK@ZD00192*/
*   ELSE                                                           0058
*     ;                             /* BAD RETURN FROM ISDAGET1    0058
*                                                            @ZD00192*/
@RF00052 DS    0H                                                  0059
*   END GETWORK;                    /* END GETWORK PROC      @ZD00192*/
@EL00002 DS    0H                                                  0059
@EF00002 DS    0H                                                  0059
@ER00002 L     @14,@SA00002                                        0059
         BR    @14                                                 0059
*                                                                  0060
*   /*****************************************************************/
*   /*                                                               */
*   /* GETCODE - PROC TO ANALYZE INPUT RECORD AND SET TYPE CODE      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0060
*GETCODE:                                                          0060
*   PROC OPTIONS(SAVE(14));         /* PROC TO SET TYPE CODE @ZD00192*/
GETCODE  ST    @14,12(,@13)                                        0060
*   TYPECODE=TFF;                   /* INITIALIZE TYPE CODE  @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0061
*   IF INDEVTYP='S' THEN            /* MSC RECORD            @ZD00192*/
         L     @07,SDA00PTR(,CVTPTR)                               0062
         CLI   INDEVTYP(@07),C'S'                                  0062
         BNE   @RF00062                                            0062
*     IF FORMATNO(1)='1'B THEN      /* MSC FORMAT 0          @ZD00192*/
*                                                                  0063
         TM    FORMATNO(SENSEPTR),B'10000000'                      0063
         BNO   @RF00063                                            0063
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT 0                                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0064
*       IF SUBFMTMG=T00&SSIDFLAG(2)='1'B THEN/* MSG CODE 00 WITH SUU
*                                      ON                    @ZD00192*/
         CLI   SUBFMTMG(SENSEPTR),X'00'                            0064
         BNE   @RF00064                                            0064
         TM    SSIDFLAG(SENSEPTR),B'01000000'                      0064
         BNO   @RF00064                                            0064
*         TYPECODE=T00;             /* YES, SET CODE 00      @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'00'                            0065
*       ELSE                        /* CHECK 0680 AND SUU    @ZA28897*/
*         IF SUBFMTMG=T06 THEN      /* MESSAGE CODE 06       @ZA28897*/
         B     @RC00064                                            0066
@RF00064 CLI   SUBFMTMG(SENSEPTR),X'06'                            0066
         BNE   @RF00066                                            0066
*           IF TERMCOD0='80'X THEN  /* TERM CODE 80          @ZA28897*/
         CLI   TERMCOD0(SENSEPTR),X'80'                            0067
         BNE   @RF00067                                            0067
*             TYPECODE=T06;         /* 0680, SET CODE 06     @ZA28897*/
         MVI   TYPECODE(APRWKPTR),X'06'                            0068
*           ELSE                    /* NOT CODE 80           @ZA28897*/
*             IF SSIDFLAG(2)='1'B THEN /* CODE 06 WITH SUU   @ZA28897*/
         B     @RC00067                                            0069
@RF00067 TM    SSIDFLAG(SENSEPTR),B'01000000'                      0069
         BNO   @RF00069                                            0069
*               TYPECODE=TF6;       /* SET CODE F6           @ZA28897*/
         MVI   TYPECODE(APRWKPTR),X'F6'                            0070
*             ELSE;                 /* NOT SUU OR 0680       @ZA28897*/
@RF00069 DS    0H                                                  0072
*         ELSE                      /* CHECK 07              @ZD00192*/
*           IF SUBFMTMG=T07 THEN    /* MSG CODE 07           @ZD00192*/
         B     @RC00066                                            0072
@RF00066 CLI   SUBFMTMG(SENSEPTR),X'07'                            0072
         BNE   @RF00072                                            0072
*             IF TERMCOD0='00'X THEN/* NOT MEDIA FAILURE     @ZD00192*/
         CLI   TERMCOD0(SENSEPTR),X'00'                            0073
         BNE   @RF00073                                            0073
*               TYPECODE=T07;       /* SET END APR CODE 07   @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'07'                            0074
*             ELSE                  /* 07 WITH TERM CODE NOT ZERO  0075
*                                                            @ZD00192*/
*               TYPECODE=TF7;       /* SET MEDIA FAILURE CODE F7   0075
*                                                            @ZD00192*/
         B     @RC00073                                            0075
@RF00073 MVI   TYPECODE(APRWKPTR),X'F7'                            0075
*           ELSE                    /* CHECK 09              @ZD00192*/
*             IF SUBFMTMG=T09 THEN  /* MSG CODE 09           @ZD00192*/
         B     @RC00072                                            0076
@RF00072 CLI   SUBFMTMG(SENSEPTR),X'09'                            0076
         BNE   @RF00076                                            0076
*               IF SSIDFLAG(2)='1'B THEN /* SUU              @ZA29141*/
         TM    SSIDFLAG(SENSEPTR),B'01000000'                      0077
         BNO   @RF00077                                            0077
*                 TYPECODE=TF9;     /* YES, SET CODE F9      @ZA29141*/
         MVI   TYPECODE(APRWKPTR),X'F9'                            0078
*               ELSE                /* NO, NOT SUU           @ZA29141*/
*                 TYPECODE=T09;     /* YES, SET CODE 09      @ZA29141*/
         B     @RC00077                                            0079
@RF00077 MVI   TYPECODE(APRWKPTR),X'09'                            0079
*             ELSE                  /* CHECK 08              @ZM31121*/
*               IF SUBFMTMG=T08 THEN /* MSG CODE 08          @ZM31121*/
         B     @RC00076                                            0080
@RF00076 CLI   SUBFMTMG(SENSEPTR),X'08'                            0080
         BNE   @RF00080                                            0080
*                 TYPECODE=T08;     /* YES, SET CODE 08      @ZM31121*/
         MVI   TYPECODE(APRWKPTR),X'08'                            0081
*               ELSE                /* NOT CODE 08           @ZA28897*/
*                 IF SUBFMTMG='0A'X THEN /* MSG CODE 0A      @ZA28897*/
         B     @RC00080                                            0082
@RF00080 CLI   SUBFMTMG(SENSEPTR),X'0A'                            0082
         BNE   @RF00082                                            0082
*                   TYPECODE=T06;   /* SET CODE 06           @ZA28897*/
         MVI   TYPECODE(APRWKPTR),X'06'                            0083
*                 ELSE;             /* NOT 00,06,07,08,09,0A @ZA28897*/
@RF00082 DS    0H                                                  0085
*     ELSE                          /* CHECK FORMAT 1 AND 2  @ZD00192*/
*       IF FORMATNO(2)='1'B×FORMATNO(3)='1'B THEN/* FORMAT 1 OR 2  0085
*                                                            @ZD00192*/
*                                                                  0085
         B     @RC00063                                            0085
@RF00063 TM    FORMATNO(SENSEPTR),B'01100000'                      0085
         BZ    @RF00085                                            0085
*         /***********************************************************/
*         /*                                                         */
*         /* FORMAT 1 AND FORMAT 2                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0086
*         IF STATUS(3)='1'B×STATUS(4)='1'B THEN/* BUS OUT OR EQC   0086
*                                      CHECK                 @ZD00192*/
         TM    STATUS(SENSEPTR),B'00110000'                        0086
         BZ    @RF00086                                            0086
*           TYPECODE=T20;           /* YES, SET MSC UNUSABLE @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'20'                            0087
*         ELSE                      /* NO, NOT MSC FAILURE   @ZA00694*/
*           IF SSIDFLAG(2)='1'B THEN /* SUU BIT ON           @ZA00694*/
         B     @RC00086                                            0088
@RF00086 TM    SSIDFLAG(SENSEPTR),B'01000000'                      0088
         BNO   @RF00088                                            0088
*             TYPECODE=T10;         /* YES, SUU ON SA OR CS  @ZA00694*/
         MVI   TYPECODE(APRWKPTR),X'10'                            0089
*           ELSE;                   /* NOT PERM OR SUU       @ZA00694*/
@RF00088 DS    0H                                                  0091
*       ELSE                        /* CHECK FORMAT 3        @ZD00192*/
*         IF FORMATNO(4)='1'B THEN  /* FORMAT 3              @ZD00192*/
*                                                                  0091
         B     @RC00085                                            0091
@RF00085 TM    FORMATNO(SENSEPTR),B'00010000'                      0091
         BNO   @RF00091                                            0091
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT 3                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0092
*           IF STATUS(8)='0'B×SSIDFLAG(2)='1'B THEN/* ENVIRONMENTAL
*                              DATA OFF OR UNIT UNUSABLE ON  @ZD00192*/
         TM    STATUS(SENSEPTR),B'00000001'                        0092
         BZ    @RT00092                                            0092
         TM    SSIDFLAG(SENSEPTR),B'01000000'                      0092
         BNO   @RF00092                                            0092
@RT00092 DS    0H                                                  0093
*             TYPECODE=T30;         /* YES, SET CS ERROR     @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'30'                            0093
*           ELSE                    /* CHECK RECONFIGURE     @ZD00192*/
*             IF SUBSTAT5(2)='1'B THEN/* RECONFIGURE         @ZD00192*/
         B     @RC00092                                            0094
@RF00092 TM    SUBSTAT5(SENSEPTR),B'01000000'                      0094
         BNO   @RF00094                                            0094
*               TYPECODE=T31;       /* YES, SET CODE 31      @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'31'                            0095
*             ELSE                                                 0096
*               ;                   /* NO, NOT PERM ERROR OR @ZD00192
*                                      RECONFIGURE           @ZD00192*/
@RF00094 DS    0H                                                  0097
*         ELSE                      /* CHECK FORMAT 4        @ZD00192*/
*           IF FORMATNO(5)='1'B THEN/* FORMAT 4              @ZD00192*/
*                                                                  0097
         B     @RC00091                                            0097
@RF00091 TM    FORMATNO(SENSEPTR),B'00001000'                      0097
         BNO   @RF00097                                            0097
*             /*******************************************************/
*             /*                                                     */
*             /* FORMAT 4                                            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0098
*             IF STATUS(8)='0'B×SSIDFLAG(2)='1'B THEN/* ENVIRONMENTAL
*                              DATA OFF OR UNIT UNUSABLE ON  @ZD00192*/
         TM    STATUS(SENSEPTR),B'00000001'                        0098
         BZ    @RT00098                                            0098
         TM    SSIDFLAG(SENSEPTR),B'01000000'                      0098
         BNO   @RF00098                                            0098
@RT00098 DS    0H                                                  0099
*               TYPECODE=T40;       /* YES, SET UNIT UNUSABLE@ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'40'                            0099
*             ELSE                                                 0100
*               IF SARETRY(7)='1'B THEN/* FIRST APR RECORD   @ZD00192*/
         B     @RC00098                                            0100
@RF00098 TM    SARETRY(SENSEPTR),B'00000010'                       0100
         BNO   @RF00100                                            0100
*                 TYPECODE=T41;     /* YES, SET START APR    @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'41'                            0101
*               ELSE                                               0102
*                 IF SARETRY(1:4)^='0000'B THEN/* APR RECORD @ZD00192*/
         B     @RC00100                                            0102
@RF00100 TM    SARETRY(SENSEPTR),B'11110000'                       0102
         BZ    @RF00102                                            0102
*                   TYPECODE=T42;   /* YES, SET IN APR SEQUENCE    0103
*                                                            @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'42'                            0103
*                 ELSE                                             0104
*                   ;               /* NO, MUST BE SA ENVIRONMENTAL
*                                      DATA                  @ZD00192*/
@RF00102 DS    0H                                                  0105
*           ELSE                    /* CHECK FORMAT 5        @ZD00192*/
*             IF FORMATNO(6)='1'B THEN/* FORMAT 5            @ZD00192*/
*                                                                  0105
         B     @RC00097                                            0105
@RF00097 TM    FORMATNO(SENSEPTR),B'00000100'                      0105
         BNO   @RF00105                                            0105
*               /*****************************************************/
*               /*                                                   */
*               /* FORMAT 5                                          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0106
*               IF STATUS(8)='0'B×SSIDFLAG(2)='1'B THEN/*    @ZD00192
*                                      ENVIRONMENTAL DATA OFF OR UNIT
*                                      UNUSABLE ON           @ZD00192*/
         TM    STATUS(SENSEPTR),B'00000001'                        0106
         BZ    @RT00106                                            0106
         TM    SSIDFLAG(SENSEPTR),B'01000000'                      0106
         BNO   @RF00106                                            0106
@RT00106 DS    0H                                                  0107
*                 TYPECODE=T50;     /* YES, SET 3330 UNIT UNUSABLE 0107
*                                                            @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'50'                            0107
*               ELSE                                               0108
*                 ;                 /* NO, NOT PERM ERROR ON TABLE 0108
*                                      PACK                  @ZD00192*/
@RF00106 DS    0H                                                  0109
*             ELSE                  /* NO, RECORD NOT VALID MSC SENSE
*                                                            @ZD00192*/
*               RETCODE=8;          /* SET RECORD REJECT RETURN CODE
*                                                            @ZD00192*/
*                                                                  0109
         B     @RC00105                                            0109
@RF00105 LA    RETCODE,8                                           0109
*   /*****************************************************************/
*   /*                                                               */
*   /* IF APR NOT REQUESTED, DO NOT SAVE CODES 07, 08, 09, 41, OR 42 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0110
*   IF CAPRSUU(8)='0'B THEN         /* APR NOT REQUESTED     @ZD00192*/
@RC00105 DS    0H                                                  0110
@RC00097 DS    0H                                                  0110
@RC00091 DS    0H                                                  0110
@RC00085 DS    0H                                                  0110
@RC00063 DS    0H                                                  0110
@RF00062 L     @07,LPARMPTR                                        0110
         TM    CAPRSUU(@07),B'00000001'                            0110
         BNZ   @RF00110                                            0110
*     IF TYPECODE=T07×TYPECODE=T09 THEN/* NOT MEDIA FAILURE  @ZD00192*/
         CLI   TYPECODE(APRWKPTR),X'07'                            0111
         BE    @RT00111                                            0111
         CLI   TYPECODE(APRWKPTR),X'09'                            0111
         BNE   @RF00111                                            0111
@RT00111 DS    0H                                                  0112
*       TYPECODE=TFF;               /* YES, DO NOT USE THIS RECORD 0112
*                                                            @ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0112
*     ELSE                                                         0113
*       IF TYPECODE=T41×TYPECODE=T42 THEN/* NOT UNIT UNUSABLE@ZD00192*/
         B     @RC00111                                            0113
@RF00111 CLI   TYPECODE(APRWKPTR),X'41'                            0113
         BE    @RT00113                                            0113
         CLI   TYPECODE(APRWKPTR),X'42'                            0113
         BNE   @RF00113                                            0113
@RT00113 DS    0H                                                  0114
*         TYPECODE=TFF;             /* YES, DO NOT USE RECORD@ZD00192*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0114
*       ELSE                                                       0115
*         IF TYPECODE=T08 THEN      /* 08 IS FOLLOWED BY F7  @ZM31121*/
         B     @RC00113                                            0115
@RF00113 CLI   TYPECODE(APRWKPTR),X'08'                            0115
         BNE   @RF00115                                            0115
*           TYPECODE=TFF;           /* SO DO NOT USE IN SUU  @ZM31121*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0116
*         ELSE;                     /* NO, USE THIS IN THE SUMMARY 0117
*                                                            @ZD00192*/
@RF00115 DS    0H                                                  0118
*   ELSE;                           /* NO, APR REQUESTED     @ZD00192*/
*                                                                  0118
@RF00110 DS    0H                                                  0119
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT COUNT FOR CODES T07, T09, AND T41.                  */
*   /* STOP SAVING APR RECORDS IF THE COUNT EXCEEDS MAXCOUNT         */
*   /* STOP SAVING LOST CART RECORDS IF THE COUNT EXCEEDS MAXCOUNT   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0119
*   IF TYPECODE=T07 THEN            /* END APR NOT MEDIA     @ZM30984*/
@RC00110 CLI   TYPECODE(APRWKPTR),X'07'                            0119
         BNE   @RF00119                                            0119
*     T07COUNT=T07COUNT+1;          /* ADD 1 TO COUNT        @ZM30984*/
         LA    @07,1                                               0120
         AH    @07,T07COUNT(,APRWKPTR)                             0120
         STH   @07,T07COUNT(,APRWKPTR)                             0120
*   ELSE                                                           0121
*     IF TYPECODE=T09 THEN          /* MISPLACED CARTRIDGE   @ZM30984*/
         B     @RC00119                                            0121
@RF00119 CLI   TYPECODE(APRWKPTR),X'09'                            0121
         BNE   @RF00121                                            0121
*       T09COUNT=T09COUNT+1;        /* ADD 1 TO COUNT        @ZM30984*/
         LA    @07,1                                               0122
         AH    @07,T09COUNT(,APRWKPTR)                             0122
         STH   @07,T09COUNT(,APRWKPTR)                             0122
*     ELSE                                                         0123
*       IF TYPECODE=T41 THEN        /* START APR             @ZM30984*/
         B     @RC00121                                            0123
@RF00121 CLI   TYPECODE(APRWKPTR),X'41'                            0123
         BNE   @RF00123                                            0123
*         T41COUNT=T41COUNT+1;      /* ADD 1 TO COUNT        @ZM30984*/
         LA    @07,1                                               0124
         AH    @07,T41COUNT(,APRWKPTR)                             0124
         STH   @07,T41COUNT(,APRWKPTR)                             0124
*       ELSE;                       /* NOTHING TO COUNT      @ZM30984*/
@RF00123 DS    0H                                                  0126
*   IF T07COUNT=MAXCOUNT×T41COUNT=MAXCOUNT THEN /* AT MAX    @ZM30984*/
@RC00121 DS    0H                                                  0126
@RC00119 LA    @07,51                                              0126
         CH    @07,T07COUNT(,APRWKPTR)                             0126
         BE    @RT00126                                            0126
         CH    @07,T41COUNT(,APRWKPTR)                             0126
         BNE   @RF00126                                            0126
@RT00126 DS    0H                                                  0127
*     APRFLAGS(3)='1'B;             /* YES, SET FLAG ON      @ZM30984*/
         OI    APRFLAGS(APRWKPTR),B'00100000'                      0127
*   ELSE;                           /* NO, COUNT IS OK       @ZM30984*/
@RF00126 DS    0H                                                  0129
*   IF T09COUNT=MAXCOUNT THEN       /* AT MAXIMUM COUNT      @ZM30984*/
         CLC   T09COUNT(2,APRWKPTR),@CH00390                       0129
         BNE   @RF00129                                            0129
*     APRFLAGS(4)='1'B;             /* YES, SET FLAG ON      @ZM30984*/
         OI    APRFLAGS(APRWKPTR),B'00010000'                      0130
*   ELSE;                           /* NO, COUNT OK          @ZM30984*/
@RF00129 DS    0H                                                  0132
*   IF APRFLAGS(3)='1'B THEN        /* IN NO SAVE MODE       @ZM30984*/
         TM    APRFLAGS(APRWKPTR),B'00100000'                      0132
         BNO   @RF00132                                            0132
*     IF TYPECODE=T07×TYPECODE=T41×TYPECODE=T42 THEN /* YES  @ZM30984*/
         CLI   TYPECODE(APRWKPTR),X'07'                            0133
         BE    @RT00133                                            0133
         CLI   TYPECODE(APRWKPTR),X'41'                            0133
         BE    @RT00133                                            0133
         CLI   TYPECODE(APRWKPTR),X'42'                            0133
         BNE   @RF00133                                            0133
@RT00133 DS    0H                                                  0134
*       TYPECODE=TFF;               /* DO NOT SAVE RECORD    @ZM30984*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0134
*     ELSE;                         /* NOT APR RECORD        @ZM30984*/
@RF00133 DS    0H                                                  0136
*   ELSE;                           /* NOT AT MAX COUNT      @ZM30984*/
@RF00132 DS    0H                                                  0137
*   IF APRFLAGS(4)='1'B&TYPECODE=T09 THEN /* NO SAVE MODE    @ZM30984*/
         TM    APRFLAGS(APRWKPTR),B'00010000'                      0137
         BNO   @RF00137                                            0137
         CLI   TYPECODE(APRWKPTR),X'09'                            0137
         BNE   @RF00137                                            0137
*     TYPECODE=TFF;                 /* DO NOT SAVE RECORD    @ZM30984*/
         MVI   TYPECODE(APRWKPTR),X'FF'                            0138
*   ELSE;                           /* NOT TOO MANY YET      @ZM30984*/
@RF00137 DS    0H                                                  0140
*   IF TYPECODE=TFF&RETCODE=0 THEN  /* THIS RECORD NOT USED  @ZD00192*/
         CLI   TYPECODE(APRWKPTR),X'FF'                            0140
         BNE   @RF00140                                            0140
         LTR   RETCODE,RETCODE                                     0140
         BNZ   @RF00140                                            0140
*     RETCODE=1;                    /* YES, SET INTERNAL FLAG@ZD00192*/
         LA    RETCODE,1                                           0141
*   ELSE                            /* NO, SAVE SSID OR CUA  @ZD00192*/
*     IF TYPECODE=T06×TYPECODE=T20 THEN/* MSC UNUSABLE OR SWITCH   0142
*                                                            @ZD00192*/
         B     @RC00140                                            0142
@RF00140 CLI   TYPECODE(APRWKPTR),X'06'                            0142
         BE    @RT00142                                            0142
         CLI   TYPECODE(APRWKPTR),X'20'                            0142
         BNE   @RF00142                                            0142
@RT00142 DS    0H                                                  0143
*       SAVESSID=INRECCUA×'8000'X;  /* YES, SAVE CUA WITH BIT 0 = 1
*                                      FOR UNIQUENESS        @ZM31109*/
         L     @07,SDA00PTR(,CVTPTR)                               0143
         MVC   SAVESSID(2,APRWKPTR),INRECCUA(@07)                  0143
         OC    SAVESSID(2,APRWKPTR),@CB00421                       0143
*     ELSE                                                         0144
*       DO;                         /* NO, SAVE SSID         @ZM31109*/
         B     @RC00142                                            0144
@RF00142 DS    0H                                                  0145
*         SAVESSID=SUBSYSID&'0FFF'X;/* CLEAR BITS 1-4        @ZM31109*/
         MVC   SAVESSID(2,APRWKPTR),SUBSYSID(SENSEPTR)             0145
         NC    SAVESSID(2,APRWKPTR),@CB00422                       0145
*         IF TYPECODE=T31 THEN      /* ACC IN GARAGE         @ZM31109*/
         CLI   TYPECODE(APRWKPTR),X'31'                            0146
         BNE   @RF00146                                            0146
*           DO;                     /* YES, WHICH ONE        @ZM31121*/
*             IF ISDAMSCS(9:12)^='00000000'X THEN /* RIGHT   @ZM31121*/
         CLC   ISDAMSCS+8(4,SENSEPTR),@CB00423                     0148
         BE    @RF00148                                            0148
*               SAVESSID(3)='1'B;   /* SET RIGHT ACC BIT     @ZM31121*/
         OI    SAVESSID(APRWKPTR),B'00100000'                      0149
*             ELSE;                 /* NOT RIGHT ACC         @ZM31121*/
@RF00148 DS    0H                                                  0151
*             IF ISDAMSCS(13:16)^='00000000'X THEN /* LEFT   @ZM31121*/
         CLC   ISDAMSCS+12(4,SENSEPTR),@CB00423                    0151
         BE    @RF00151                                            0151
*               SAVESSID(2)='1'B;   /* SET LEFT ACC BIT      @ZM31121*/
         OI    SAVESSID(APRWKPTR),B'01000000'                      0152
*             ELSE;                 /* NOT LEFT ACC          @ZM31121*/
@RF00151 DS    0H                                                  0154
*             IF SAVESSID(2:3)='00'B THEN /* BOTH ARE ZERO   @ZM31121*/
         TM    SAVESSID(APRWKPTR),B'01100000'                      0154
         BNZ   @RF00154                                            0154
*               SAVESSID(2:3)='11'B;/* YES, TURN BOTH ON     @ZM31121*/
         OI    SAVESSID(APRWKPTR),B'01100000'                      0155
*             ELSE;                 /* NO, FLAGS ARE OK      @ZM31121*/
@RF00154 DS    0H                                                  0157
*           END;                    /* END SET ACCESSOR FLAG @ZM31121*/
*         ELSE;                     /* NO, SSID IS OK        @ZM31109*/
@RF00146 DS    0H                                                  0159
*       END;                        /* END MOVE SSID         @ZM31109*/
*   END GETCODE;                    /* END OF GETCODE PROC   @ZD00192*/
@EL00003 DS    0H                                                  0160
@EF00003 DS    0H                                                  0160
@ER00003 L     @14,12(,@13)                                        0160
         BR    @14                                                 0160
*                                                                  0161
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDREC - PROC TO ADD A RECORD TO THE ACCUMULATOR              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0161
*ADDREC:                                                           0161
*   PROC OPTIONS(SAVE(14));         /* PROC TO ADD A RECORD  @ZD00192*/
ADDREC   ST    @14,@SA00004                                        0161
*   IF CAPRSUU(8)='0'B&TOTALENT^=0 THEN/* SUU ONLY AND SOME RECORDS
*                                      ALREADY SAVED         @ZD00192*/
*                                                                  0162
         L     @07,LPARMPTR                                        0162
         TM    CAPRSUU(@07),B'00000001'                            0162
         BNZ   @RF00162                                            0162
         ICM   @07,15,TOTALENT(APRWKPTR)                           0162
         BZ    @RF00162                                            0162
*     /***************************************************************/
*     /*                                                             */
*     /* UPDATEAC INCREMENTS THE COUNT IF A MATCHING SSID IS FOUND IN*/
*     /* THE ACCUMULATOR ALREADY. IF SO, IT SETS RETCODE=2           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0163
*     CALL UPDATEAC;                /* YES, LOOK FOR EXISTING RECORD
*                                                            @ZD00192*/
         BAL   @14,UPDATEAC                                        0163
*   ELSE                                                           0164
*     ;                             /* NO                    @ZD00192*/
@RF00162 DS    0H                                                  0165
*   IF RETCODE=0 THEN               /* STILL NEED TO ADD RECORD    0165
*                                                            @ZD00192*/
*                                                                  0165
         LTR   RETCODE,RETCODE                                     0165
         BNZ   @RF00165                                            0165
*     /***************************************************************/
*     /*                                                             */
*     /* COMPUTE ENTRY LENGTH OF 32, 36, 56                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0166
*     DO;                           /* YES, COMPUTE LENGTH OF THIS 0166
*                                      UPDATE                @ZD00192*/
*       IF TYPECODE=T07×TYPECODE=TF7×TYPECODE=T09×                 0167
*                                    TYPECODE=T08 THEN             0167
         CLI   TYPECODE(APRWKPTR),X'07'                            0167
         BE    @RT00167                                            0167
         CLI   TYPECODE(APRWKPTR),X'F7'                            0167
         BE    @RT00167                                            0167
         CLI   TYPECODE(APRWKPTR),X'09'                            0167
         BE    @RT00167                                            0167
         CLI   TYPECODE(APRWKPTR),X'08'                            0167
         BNE   @RF00167                                            0167
@RT00167 DS    0H                                                  0168
*         CURRLEN=56;               /* SET LONG LENGTH FOR 07,F7,08
*                                      AND 09                @ZM31121*/
         MVC   CURRLEN(2,APRWKPTR),@CH00431                        0168
*       ELSE                                                       0169
*         IF TYPECODE=T06×TYPECODE=T20 THEN/* CODES 06 OR 20 @ZD00192*/
         B     @RC00167                                            0169
@RF00167 CLI   TYPECODE(APRWKPTR),X'06'                            0169
         BE    @RT00169                                            0169
         CLI   TYPECODE(APRWKPTR),X'20'                            0169
         BNE   @RF00169                                            0169
@RT00169 DS    0H                                                  0170
*           CURRLEN=36;             /* SET LENGTH FOR MSC UNUSABLE 06
*                                      AND 20                @ZD00192*/
         MVC   CURRLEN(2,APRWKPTR),@CH00432                        0170
*         ELSE                                                     0171
*           CURRLEN=32;             /* SET SHORT LENGTH FOR ALL    0171
*                                      OTHERS                @ZD00192*/
         B     @RC00169                                            0171
@RF00169 MVC   CURRLEN(2,APRWKPTR),@CH00433                        0171
*       IF(CURRNEXT+CURRLEN)>ACCUMEND THEN/* WILL THIS RECORD FIT  0172
*                                      INTO THE CURRENT ACCUMULATOR
*                                      IF ANY                @ZD00192*/
*                                                                  0172
@RC00169 DS    0H                                                  0172
@RC00167 LH    @07,CURRLEN(,APRWKPTR)                              0172
         AL    @07,CURRNEXT(,APRWKPTR)                             0172
         C     @07,ACCUMEND(,APRWKPTR)                             0172
         BNH   @RF00172                                            0172
*         /***********************************************************/
*         /*                                                         */
*         /* GET AN ACCUMULATOR BLOCK                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0173
*         CALL GETACCUM;            /* NO, GET AN ACCUMULATOR@ZD00192*/
         BAL   @14,GETACCUM                                        0173
*       ELSE                                                       0174
*         ;                         /* YES, DO NOT NEED MORE SPACE 0174
*                                                            @ZD00192*/
@RF00172 DS    0H                                                  0175
*     END;                          /* END ACCUMULATOR SETUP @ZD00192*/
*   ELSE                                                           0176
*     ;                             /* NO, DO NOT ADD THIS RECORD  0176
*                                                            @ZD00192*/
*                                                                  0176
@RF00165 DS    0H                                                  0177
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD NEW ENTRY TO ACCUMULATOR                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0177
*   IF RETCODE=0 THEN               /* CONTINUE              @ZD00192*/
         SLR   @07,@07                                             0177
         CR    RETCODE,@07                                         0177
         BNE   @RF00177                                            0177
*     DO;                           /* YES, UPDATE THE ACCUMULATOR 0178
*                                                            @ZD00192*/
*       IF CURRPTR^=0 THEN          /* IS THIS FIRST ENTRY   @ZD00192*/
         L     @04,CURRPTR(,APRWKPTR)                              0179
         CR    @04,@07                                             0179
         BE    @RF00179                                            0179
*         DO;                       /* NO, MUST SET FORWARD POINTER
*                                                            @ZD00192*/
*           ENTRYPTR=CURRPTR;       /* SET ENTRY POINTER     @ZD00192*/
         L     @07,CURRPTR(,APRWKPTR)                              0181
         LR    ENTRYPTR,@07                                        0181
*           NEXTENT=CURRNEXT;       /* MOVE NEXT ADDR INTO ENTRY   0182
*                                                            @ZD00192*/
         MVC   NEXTENT(4,ENTRYPTR),CURRNEXT(APRWKPTR)              0182
*           SAVEDYTS=ENTDAYTS;      /* SAVE DATE, TIME, SEQ  @ZM31121*/
         MVC   SAVEDYTS(9,APRWKPTR),ENTDAYTS(ENTRYPTR)             0183
*         END;                      /* END FORWARD PTR CODE  @ZD00192*/
*       ELSE                                                       0185
*         ;                         /* NO, THIS IS FIRST ENTRY     0185
*                                                            @ZD00192*/
*                                                                  0185
@RF00179 DS    0H                                                  0186
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP ALL ACCUMULATOR POINTERS FOR THIS ENTRY            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0186
*       CURRPTR=CURRNEXT;           /* CURRENT PTR SET TO NEXT PTR 0186
*                                                            @ZD00192*/
         L     @07,CURRNEXT(,APRWKPTR)                             0186
         ST    @07,CURRPTR(,APRWKPTR)                              0186
*       CURRNEXT=CURRPTR+CURRLEN;   /* NEXT = THIS + LENGTH  @ZD00192*/
         LH    @15,CURRLEN(,APRWKPTR)                              0187
         LR    @14,@07                                             0187
         ALR   @14,@15                                             0187
         ST    @14,CURRNEXT(,APRWKPTR)                             0187
*       ENTRYPTR=CURRPTR;           /* SET BASE PTR FOR ENTRY@ZD00192*/
         LR    ENTRYPTR,@07                                        0188
*       TOTALENT=TOTALENT+1;        /* ADD 1 TO ENTRY COUNT  @ZD00192*/
*                                                                  0189
         LA    @07,1                                               0189
         L     @14,TOTALENT(,APRWKPTR)                             0189
         ALR   @14,@07                                             0189
         ST    @14,TOTALENT(,APRWKPTR)                             0189
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD FIXED PART OF ACCUMULATOR ENTRY                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0190
*       NEXTENT=''B;                /* ZERO PTR TO NEXT ENTRY@ZD00192*/
         SLR   @14,@14                                             0190
         ST    @14,NEXTENT(,ENTRYPTR)                              0190
*       ENTCOUNT=1;                 /* INIT COUNTER TO 1     @ZD00192*/
         STH   @07,ENTCOUNT(,ENTRYPTR)                             0191
*       ELENGTH=CURRLEN;            /* MOVE IN LENGTH OF THIS ENTRY
*                                                            @ZD00192*/
         STC   @15,ELENGTH(,ENTRYPTR)                              0192
*       ETYPCODE=TYPECODE;          /* SET TYPE CODE         @ZD00192*/
         MVC   ETYPCODE(1,ENTRYPTR),TYPECODE(APRWKPTR)             0193
*       EFMTMSG=SUBFMTMG;           /* SAVE BYTE 11          @ZD00192*/
         MVC   EFMTMSG(1,ENTRYPTR),SUBFMTMG(SENSEPTR)              0194
*       ENTFLAG='01'X;              /* SET USE IN SUMMARY BIT@ZD00192*/
         MVI   ENTFLAG(ENTRYPTR),X'01'                             0195
*       ENTSSID=SAVESSID;           /* MOVE SSID OR CUA      @ZD00192*/
         MVC   ENTSSID(2,ENTRYPTR),SAVESSID(APRWKPTR)              0196
*       ENTDAYT=DATETIME;           /* MOVE DATE AND TIME    @ZD00192*/
         MVC   ENTDAYT(8,ENTRYPTR),DATETIME(LOGPTR)                0197
*       EBYTE03=ISDAMSCS(1:4);      /* MOVE MSC BYTES 0-3    @ZD00192*/
         MVC   EBYTE03(4,ENTRYPTR),ISDAMSCS(SENSEPTR)              0198
*       IF ENTDAYT<SAVEDAYT THEN    /* NEW DATE < OLD DATE   @ZD00192*/
         CLC   ENTDAYT(8,ENTRYPTR),SAVEDAYT(APRWKPTR)              0199
         BNL   @RF00199                                            0199
*         APRFLAGS(1)='1'B;         /* YES, SORT REQUIRED    @ZD00192*/
         OI    APRFLAGS(APRWKPTR),B'10000000'                      0200
*       ELSE;                       /* NO, THIS RECORD IN TIME ORDER
*                                                            @ZD00192*/
@RF00199 DS    0H                                                  0202
*       IF ENTDAYT=SAVEDAYT THEN    /* SAME DATE AND TIME    @ZM31121*/
         CLC   ENTDAYT(8,ENTRYPTR),SAVEDAYT(APRWKPTR)              0202
         BNE   @RF00202                                            0202
*         SAVSEQEN=SAVSEQEN+1;      /* ADD 1 TO SEQ NO.      @ZM31121*/
         LA    @07,1                                               0203
         SLR   @15,@15                                             0203
         IC    @15,SAVSEQEN(,APRWKPTR)                             0203
         ALR   @07,@15                                             0203
         STC   @07,SAVSEQEN(,APRWKPTR)                             0203
*       ELSE                        /* DATE,TIME NOT EQUAL   @ZM31121*/
*         SAVSEQEN=''B;             /* SET SEQ NO. TO ZERO   @ZM31121*/
         B     @RC00202                                            0204
@RF00202 SLR   @07,@07                                             0204
         STC   @07,SAVSEQEN(,APRWKPTR)                             0204
*       ENTSEQEN=SAVSEQEN;          /* STORE SEQUENCE NUMBER @ZM31121*/
@RC00202 MVC   ENTSEQEN(1,ENTRYPTR),SAVSEQEN(APRWKPTR)             0205
*       CALL ADDVAR;                /* BUILD VARIABLE PART   @ZD00192*/
         BAL   @14,ADDVAR                                          0206
*     END;                          /* END ADD ENTRY CODE    @ZD00192*/
*   ELSE                                                           0208
*     ;                             /* NO, BAD RETURN FROM GETACCUM
*                                      OR NO RECORD TO ADD   @ZD00192*/
@RF00177 DS    0H                                                  0209
*   END ADDREC;                     /* END OF ADDREC PROC    @ZD00192*/
@EL00004 DS    0H                                                  0209
@EF00004 DS    0H                                                  0209
@ER00004 L     @14,@SA00004                                        0209
         BR    @14                                                 0209
*                                                                  0210
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATEAC - PROC TO INCREMENT COUNTS FOR SUMMARY MODE IF       */
*   /* SUU ONLY. A SEARCH FOR A MATCHING SSID OR CSN/VOLID IS        */
*   /* DONE. IF NO EXISTING RECORD IS FOUND THEN THE RECORD IS ADDED */
*   /* BY ADDREC. IF A MATCH IS FOUND, UPDATEAC SET RETCODE=2 TO     */
*   /* PREVENT ADDREC FROM ADDING THE RECORD.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*UPDATEAC:                                                         0210
*   PROC OPTIONS(SAVE(14));         /* UPDATE ACCUM PROC     @ZD00192*/
UPDATEAC ST    @14,12(,@13)                                        0210
*   ENTRYPTR=ACCUMPTR;              /* POINT TO START OF DATA@ZD00192*/
         L     ENTRYPTR,ACCUMPTR(,APRWKPTR)                        0211
*   DO WHILE(ENTRYPTR^=0);          /* LOOP THROUGH ACCUMULATOR    0212
*                                                            @ZD00192*/
         B     @DE00212                                            0212
@DL00212 DS    0H                                                  0213
*     IF TYPECODE=TF7 THEN          /* LOOKING FOR MEDIA FAILURE   0213
*                                                            @ZD00192*/
         CLI   TYPECODE(APRWKPTR),X'F7'                            0213
         BNE   @RF00213                                            0213
*       IF ETYPCODE=TF7 THEN        /* HAVE MEDIA ENTRY      @ZD00192*/
*                                                                  0214
         CLI   ETYPCODE(ENTRYPTR),X'F7'                            0214
         BNE   @RF00214                                            0214
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE MEDIA FAILURE RECORDS                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0215
*         IF ENTVOLID=VOLID0&EBYTE10=TBLID0&ENTCSN=CSN0 THEN /*    0215
*                                      MATCH VOLID AND SEQ NO.     0215
*                                      AND CSN               @ZA00668*/
         CLC   ENTVOLID(6,ENTRYPTR),VOLID0(SENSEPTR)               0215
         BNE   @RF00215                                            0215
         CLC   EBYTE10(1,ENTRYPTR),TBLID0(SENSEPTR)                0215
         BNE   @RF00215                                            0215
         CLC   ENTCSN(12,ENTRYPTR),CSN0(SENSEPTR)                  0215
         BNE   @RF00215                                            0215
*           RETCODE=2;              /* YES, FOUND MATCH      @ZA00668*/
         LA    RETCODE,2                                           0216
*         ELSE;                     /* NO, NEW ENTRY         @ZA00668*/
@RF00215 DS    0H                                                  0218
*       ELSE                                                       0218
*         ;                         /* NOT MEDIA RECORD      @ZD00192*/
@RF00214 DS    0H                                                  0219
*     ELSE                          /* NOT CODE F7 = MEDIA FAILURE 0219
*                                                            @ZD00192*/
*       IF ETYPCODE^=TF7 THEN       /* NOT MEDIA RECORD      @ZD00192*/
*                                                                  0219
         B     @RC00213                                            0219
@RF00213 CLI   ETYPCODE(ENTRYPTR),X'F7'                            0219
         BE    @RF00219                                            0219
*         /***********************************************************/
*         /*                                                         */
*         /* UPDATE UNIT UNUSABLE RECORDS                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0220
*         IF SAVESSID=ENTSSID THEN  /* HAVE A SSID MATCH     @ZD00192*/
         CLC   SAVESSID(2,APRWKPTR),ENTSSID(ENTRYPTR)              0220
         BNE   @RF00220                                            0220
*           RETCODE=2;              /* YES, SET FOUND FLAG   @ZD00192*/
         LA    RETCODE,2                                           0221
*         ELSE                                                     0222
*           ;                       /* NO MATCH SSID YET     @ZD00192*/
@RF00220 DS    0H                                                  0223
*       ELSE                                                       0223
*         ;                         /* MEDIA ENTRY, NOT SUU  @ZD00192*/
@RF00219 DS    0H                                                  0224
*     IF RETCODE=2 THEN             /* FOUND A MATCH YET     @ZD00192*/
*                                                                  0224
@RC00213 CH    RETCODE,@CH00100                                    0224
         BNE   @RF00224                                            0224
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE ACCUMULATOR AND GET OUT OF THE LOOP            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0225
*       DO;                         /* YES, UPDATE THE ENTRY @ZD00192*/
*         ENTCOUNT=ENTCOUNT+1;      /* ADD 1 TO ENTRY COUNT  @ZD00192*/
         LA    @07,1                                               0226
         AH    @07,ENTCOUNT(,ENTRYPTR)                             0226
         STH   @07,ENTCOUNT(,ENTRYPTR)                             0226
*         APRFLAGS(1)='1'B;         /* TURN SORT FLAG ON     @ZD00192*/
         OI    APRFLAGS(APRWKPTR),B'10000000'                      0227
*         IF ENTDAYT<DATETIME THEN  /* IS ENTRY DATE,TIME LESS     0228
*                                                            @ZD00192*/
         CLC   ENTDAYT(8,ENTRYPTR),DATETIME(LOGPTR)                0228
         BNL   @RF00228                                            0228
*           ENTDAYT=DATETIME;       /* YES, SAVE NEW DATE,TIME     0229
*                                                            @ZD00192*/
         MVC   ENTDAYT(8,ENTRYPTR),DATETIME(LOGPTR)                0229
*         ELSE                                                     0230
*           ;                       /* NO, DATE,TIME OK      @ZD00192*/
@RF00228 DS    0H                                                  0231
*         ENTRYPTR=0;               /* SET TO EXIT FROM LOOP @ZD00192*/
         SLR   ENTRYPTR,ENTRYPTR                                   0231
*       END;                        /* END UPDATE ACCUMULATOR CODE 0232
*                                                            @ZD00192*/
*     ELSE                          /* NO, MATCH NOT FOUND YET     0233
*                                                            @ZD00192*/
*       ENTRYPTR=NEXTENT;           /* SET PTR TO NEXT ENTRY @ZD00192*/
         B     @RC00224                                            0233
@RF00224 L     ENTRYPTR,NEXTENT(,ENTRYPTR)                         0233
*   END;                            /* END LOOP THROUGH ACCUMULATORS
*                                                            @ZD00192*/
@RC00224 DS    0H                                                  0234
@DE00212 LTR   ENTRYPTR,ENTRYPTR                                   0234
         BNZ   @DL00212                                            0234
*   END UPDATEAC;                   /* END UPDATE ACCUM PROC @ZD00192*/
@EL00005 DS    0H                                                  0235
@EF00005 DS    0H                                                  0235
@ER00005 L     @14,12(,@13)                                        0235
         BR    @14                                                 0235
*                                                                  0236
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDVAR - PROC TO BUILD THE VARIABLE PART OF THE ACCUMULATOR   */
*   /* ENTRY. THIS PROC MOVES DIFFERENT INFORMATION INTO THE         */
*   /* ACCUMULATOR DEPENDING ON THE TYPE OF RECORD (TYPECODE).       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0236
*ADDVAR:                                                           0236
*   PROC OPTIONS(SAVE(14));         /* ADDVAR PROC           @ZD00192*/
*                                                                  0236
ADDVAR   ST    @14,12(,@13)                                        0236
*   /*****************************************************************/
*   /*                                                               */
*   /* CODE 00 AND CODE F6                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*   IF TYPECODE=T00×TYPECODE=TF6 THEN /* CODE 00 OR 06 SUU   @ZA28897*/
         CLI   TYPECODE(APRWKPTR),X'00'                            0237
         BE    @RT00237                                            0237
         CLI   TYPECODE(APRWKPTR),X'F6'                            0237
         BNE   @RF00237                                            0237
@RT00237 DS    0H                                                  0238
*     DO;                           /* YES                   @ZD00192*/
*       EFLAG3='1'B;                /* SUU BIT ON            @ZD00192*/
         OI    EFLAG3(ENTRYPTR),B'00100000'                        0239
*       EBYTE4=TBLID0;              /* MOVE BYTE 10          @ZD00192*/
         MVC   EBYTE4(1,ENTRYPTR),TBLID0(SENSEPTR)                 0240
*       EBYTE5=TERNCOD0;            /* MOVE BYTE 12          @ZA28897*/
         MVC   EBYTE5(1,ENTRYPTR),TERNCOD0+3                       0241
*       EBYTE67=''B;                /* NOT USED NOW          @ZD00192*/
         XC    EBYTE67(2,ENTRYPTR),EBYTE67(ENTRYPTR)               0242
*     END;                          /* END APR SUU CODE      @ZD00192*/
*   ELSE                            /* NOT 00                @ZD00192*/
*                                                                  0244
*     /***************************************************************/
*     /*                                                             */
*     /* CODE 06                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0244
*     IF TYPECODE=T06 THEN          /* FORMAT 0 CODE 06      @ZD00192*/
         B     @RC00237                                            0244
@RF00237 CLI   TYPECODE(APRWKPTR),X'06'                            0244
         BNE   @RF00244                                            0244
*       DO;                         /* YES, MSC SWITCH RECORDS     0245
*                                                            @ZD00192*/
*         EFLAG7='1'B;              /* SET MSC SWITCH BIT    @ZD00192*/
         OI    EFLAG7(ENTRYPTR),B'00000010'                        0246
*         ENTCPUID=CPUSERID;        /* MOVE 5 BYTE CPUID     @ZD00192*/
         MVC   ENTCPUID(5,ENTRYPTR),CPUSERID(LOGPTR)               0247
*         EBYTE9=TERMCOD0;          /* MOVE BYTE 12          @ZD00192*/
         MVC   EBYTE9(1,ENTRYPTR),TERMCOD0(SENSEPTR)               0248
*         EBYTE10=''B;              /* NOT USED NOW          @ZD00192*/
         MVI   EBYTE10(ENTRYPTR),X'00'                             0249
*         EBYTE11=''B;              /* NOT USED NOW          @ZD00192*/
         MVI   EBYTE11(ENTRYPTR),X'00'                             0250
*       END;                        /* END MSC SWITCH CODE   @ZD00192*/
*     ELSE                          /* NO, CHECK 07,F7, OR 09@ZD00192*/
*                                                                  0252
*       /*************************************************************/
*       /*                                                           */
*       /* CODE 07, F7, 08, 09, AND F9                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0252
*       IF TYPECODE=T07×TYPECODE=TF7×TYPECODE=T09×TYPECODE=T08×    0252
*                                    TYPECODE=TF9 THEN /*    @ZA29141*/
         B     @RC00244                                            0252
@RF00244 CLI   TYPECODE(APRWKPTR),X'07'                            0252
         BE    @RT00252                                            0252
         CLI   TYPECODE(APRWKPTR),X'F7'                            0252
         BE    @RT00252                                            0252
         CLI   TYPECODE(APRWKPTR),X'09'                            0252
         BE    @RT00252                                            0252
         CLI   TYPECODE(APRWKPTR),X'08'                            0252
         BE    @RT00252                                            0252
         CLI   TYPECODE(APRWKPTR),X'F9'                            0252
         BNE   @RF00252                                            0252
@RT00252 DS    0H                                                  0253
*         DO;                       /* YES                   @ZD29141*/
*           EBYTE431=ISDAMSC0;      /* YES, MOVE ALL 28 BYTES@ZD00192*/
         MVC   EBYTE431(28,ENTRYPTR),ISDAMSC0(SENSEPTR)            0254
*           EFLAG8='0'B;            /* TURN SUMMARY FLAG OFF @ZM31121*/
         NI    EFLAG8(ENTRYPTR),B'11111110'                        0255
*           IF TYPECODE=T09×TYPECODE=TF9 THEN /* 09 OR F9    @ZA29141*/
         CLI   TYPECODE(APRWKPTR),X'09'                            0256
         BE    @RT00256                                            0256
         CLI   TYPECODE(APRWKPTR),X'F9'                            0256
         BNE   @RF00256                                            0256
@RT00256 DS    0H                                                  0257
*             DO;                   /* YES, MISPLACED CART   @ZA29141*/
*               EFLAG6='1'B;        /* YES, SET MISPLACED CART BIT 0258
*                                                            @ZA29141*/
         OI    EFLAG6(ENTRYPTR),B'00000100'                        0258
*               IF TYPECODE=TF9 THEN /* SUU ALSO             @ZA29141*/
         CLI   TYPECODE(APRWKPTR),X'F9'                            0259
         BNE   @RF00259                                            0259
*                 EFLAG8='1'B;      /* PUT IN SUMMARY        @ZA29141*/
         OI    EFLAG8(ENTRYPTR),B'00000001'                        0260
*               ELSE;               /* NOT SUU               @ZA29141*/
@RF00259 DS    0H                                                  0262
*             END;                  /* END MISPLACED CART    @ZA29141*/
*           ELSE                                                   0263
*             IF TYPECODE=T08 THEN  /* STAGE WITH ERROR      @ZM31121*/
         B     @RC00256                                            0263
@RF00256 CLI   TYPECODE(APRWKPTR),X'08'                            0263
         BNE   @RF00263                                            0263
*               EFLAG3='1'B;        /* YES, SET FLAG3 BIT ON @ZM31121*/
         OI    EFLAG3(ENTRYPTR),B'00100000'                        0264
*             ELSE                  /* MUST BE CODE 07 OR F7 @ZM31121*/
*               EFLAG2='1'B;        /* SET MEDIA BIT         @ZD00192*/
         B     @RC00263                                            0265
@RF00263 OI    EFLAG2(ENTRYPTR),B'01000000'                        0265
*           IF TYPECODE=TF7 THEN    /* MEDIA FAILURE         @ZM31121*/
@RC00263 DS    0H                                                  0266
@RC00256 CLI   TYPECODE(APRWKPTR),X'F7'                            0266
         BNE   @RF00266                                            0266
*             EFLAG8='1'B;          /* SET SUMMARY BIT ON   @ZM31121*/
         OI    EFLAG8(ENTRYPTR),B'00000001'                        0267
*           ELSE;                   /* NO, LEAVE SUMMARY BIT OFF   0268
*                                                            @ZM31121*/
@RF00266 DS    0H                                                  0269
*         END;                      /* END CODE 07,F7,09     @ZD00192*/
*       ELSE                        /* NO, CHECK FORMAT 2    @ZD00192*/
*                                                                  0270
*         /***********************************************************/
*         /*                                                         */
*         /* CODE 20                                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0270
*         IF TYPECODE=T20 THEN      /* FORMAT 2              @ZD00192*/
         B     @RC00252                                            0270
@RF00252 CLI   TYPECODE(APRWKPTR),X'20'                            0270
         BNE   @RF00270                                            0270
*           DO;                     /* YES                   @ZD00192*/
*             EFLAG4='1'B;          /* SET UNIT UNUSABLE BIT @ZD00192*/
         OI    EFLAG4(ENTRYPTR),B'00010000'                        0272
*             ENTCPUID=CPUSERID;    /* MOVE 5 BYTE CPUID     @ZD00192*/
         MVC   ENTCPUID(5,ENTRYPTR),CPUSERID(LOGPTR)               0273
*             EBYTE9=SUBSENSE(23);  /* MOVE FSC BYTE 26      @ZD00192*/
         MVC   EBYTE9(1,ENTRYPTR),SUBSENSE+22(SENSEPTR)            0274
*             EBYTE10=SUBSENSE(24); /* MOVE FSC BYTE 27      @ZD00192*/
         MVC   EBYTE10(1,ENTRYPTR),SUBSENSE+23(SENSEPTR)           0275
*             EBYTE11=''B;          /* NOT USED NOW          @ZD00192*/
         MVI   EBYTE11(ENTRYPTR),X'00'                             0276
*           END;                    /* END MSC UNIT UNUSABLE CODE  0277
*                                                            @ZD00192*/
*         ELSE                      /* NO, CHECK FORMAT 3    @ZD00192*/
*                                                                  0278
*           /*********************************************************/
*           /*                                                       */
*           /* CODE 30 AND 31                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0278
*           IF TYPECODE=T30×TYPECODE=T31 THEN/* FORMAT 3     @ZD00192*/
         B     @RC00270                                            0278
@RF00270 CLI   TYPECODE(APRWKPTR),X'30'                            0278
         BE    @RT00278                                            0278
         CLI   TYPECODE(APRWKPTR),X'31'                            0278
         BNE   @RF00278                                            0278
@RT00278 DS    0H                                                  0279
*             DO;                   /* YES, CS UNUSABLE OR ACCESSOR
*                                      IN GARAGE             @ZD00192*/
*               IF TYPECODE=T30 THEN/* CODE 30               @ZD00192*/
         CLI   TYPECODE(APRWKPTR),X'30'                            0280
         BNE   @RF00280                                            0280
*                 EFLAG4='1'B;      /* SET UNIT UNUSABLE BIT @ZD00192*/
         OI    EFLAG4(ENTRYPTR),B'00010000'                        0281
*               ELSE                                               0282
*                 EFLAG5='1'B;      /* SET RECONFIGURE BIT   @ZD00192*/
         B     @RC00280                                            0282
@RF00280 OI    EFLAG5(ENTRYPTR),B'00001000'                        0282
*               EBYTE4=SUBSTAT4;    /* MOVE BYTE 4           @ZD00192*/
@RC00280 MVC   EBYTE4(1,ENTRYPTR),SUBSTAT4(SENSEPTR)               0283
*               EBYTE5=SUBSTAT5;    /* MOVE BYTE 5           @ZD00192*/
         MVC   EBYTE5(1,ENTRYPTR),SUBSTAT5(SENSEPTR)               0284
*               EBYTE67=''B;        /* NOT USED NOW          @ZD00192*/
         XC    EBYTE67(2,ENTRYPTR),EBYTE67(ENTRYPTR)               0285
*             END;                  /* END CS CODE           @ZD00192*/
*           ELSE                    /* NO, CHECK FORMAT 4 OR 5 UNIT
*                                      UNUSABLE              @ZD00192*/
*                                                                  0287
*             /*******************************************************/
*             /*                                                     */
*             /* CODE 10,40 AND 50                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0287
*             IF TYPECODE=T10×TYPECODE=T40×TYPECODE=T50 THEN/*     0287
*                                      FORMAT 1,4, OR 5      @ZA00694*/
         B     @RC00278                                            0287
@RF00278 CLI   TYPECODE(APRWKPTR),X'10'                            0287
         BE    @RT00287                                            0287
         CLI   TYPECODE(APRWKPTR),X'40'                            0287
         BE    @RT00287                                            0287
         CLI   TYPECODE(APRWKPTR),X'50'                            0287
         BNE   @RF00287                                            0287
@RT00287 DS    0H                                                  0288
*               DO;                 /* YES, CS,SA,DRD,DRC, OR 3330 0288
*                                      UNUSABLE              @ZD00192*/
*                 EFLAG4='1'B;      /* SET UNIT UNUSABLE BIT @ZD00192*/
         OI    EFLAG4(ENTRYPTR),B'00010000'                        0289
*                 EBYTE4=SUBSTAT4;  /* MOVE BYTE 4           @ZD00192*/
         MVC   EBYTE4(1,ENTRYPTR),SUBSTAT4(SENSEPTR)               0290
*                 EBYTE5=SUBSTAT5;  /* MOVE BYTE 5           @ZD00192*/
         MVC   EBYTE5(1,ENTRYPTR),SUBSTAT5(SENSEPTR)               0291
*                 EBYTE67=MSCFSC;   /* MOVE FSC BYTES 26,27  @ZD00192*/
         MVC   EBYTE67(2,ENTRYPTR),MSCFSC(SENSEPTR)                0292
*               END;                /* END SA UNIT UNUSABLE  @ZD00192*/
*             ELSE                  /* NO, MUST BE APR RECORDS     0294
*                                                            @ZD00192*/
*               IF TYPECODE=T41×TYPECODE=T42 THEN/* FORMAT 4 APR   0294
*                                                            @ZD00192*/
*                                                                  0294
         B     @RC00287                                            0294
@RF00287 CLI   TYPECODE(APRWKPTR),X'41'                            0294
         BE    @RT00294                                            0294
         CLI   TYPECODE(APRWKPTR),X'42'                            0294
         BNE   @RF00294                                            0294
@RT00294 DS    0H                                                  0295
*                 /***************************************************/
*                 /*                                                 */
*                 /* CODE 41 AND 42                                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0295
*                 DO;               /* YES, CODE 41 OR 42    @ZD00192*/
*                   EFLAG1='1'B;    /* SET IN APR BIT        @ZD00192*/
*                   EFLAG8='0'B;    /* TURN SUMMARY BIT OFF  @ZD00192*/
         OI    EFLAG1(ENTRYPTR),B'10000000'                        0297
         NI    EFLAG8(ENTRYPTR),B'11111110'                        0297
*                   EBYTE4=SARETRY; /* MOVE BYTE 9           @ZD00192*/
         MVC   EBYTE4(1,ENTRYPTR),SARETRY(SENSEPTR)                0298
*                   EBYTE5=SALOWAD2;/* MOVE BYTE 10          @ZD00192*/
         MVC   EBYTE5(1,ENTRYPTR),SALOWAD2(SENSEPTR)               0299
*                   EBYTE67=MSCFSC; /* MOVE FSC BYTES 26,27  @ZD00192*/
         MVC   EBYTE67(2,ENTRYPTR),MSCFSC(SENSEPTR)                0300
*                 END;              /* END APR RECORDS CODE  @ZD00192*/
*               ELSE                /* ERROR - INVALID TYPECODE    0302
*                                                            @ZD00192*/
*                 RETCODE=20;       /* SET ERROR RETURN CODE @ZD00192*/
         B     @RC00294                                            0302
@RF00294 LA    RETCODE,20                                          0302
*   END ADDVAR;                     /* END ADDVAR PROC       @ZD00192*/
@EL00006 DS    0H                                                  0303
@EF00006 DS    0H                                                  0303
@ER00006 L     @14,12(,@13)                                        0303
         BR    @14                                                 0303
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* GETACCUM - GET A 2K BLOCK AND CHAIN IT TO THE PREVIOUS BLOCK  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*GETACCUM:                                                         0304
*   PROC OPTIONS(SAVE(14));         /* GET ACCUMULATOR CODE  @ZD00192*/
GETACCUM ST    @14,@SA00007                                        0304
*   CORELEN=APRACCL;                /* = LENGTH OF BLOCK     @ZD00192*/
         MVC   CORELEN(3,CVTPTR),@CF00386+1                        0305
*   SPNO=APRSPNO;                   /* SET SUBPOOL NUMBER    @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0306
*   RFY                                                            0307
*     R1 RSTD;                      /*                       @ZD00192*/
*   R1=ADDR(WORKCALL);              /* R1 -> ADDR(WORKPTR)   @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0308
*   CALL ISDAGET0;                  /* CALL ISDAGET0 TO DO GETMAIN 0309
*                                                            @ZD00192*/
         L     @15,@CV00397                                        0309
         BALR  @14,@15                                             0309
*   RFY                                                            0310
*     R15 RSTD;                     /* RESTRICT REG 15       @ZD00192*/
*   RETCODE=R15;                    /* SAVE RETURN CODE FROM ISDAGET0
*                                                            @ZD00192*/
         LR    RETCODE,R15                                         0311
*   RFY                                                            0312
*    (R1,                                                          0312
*     R15) UNRSTD;                  /* RELEASE REG 1 AND 15  @ZD00192*/
*   IF RETCODE=0 THEN                                              0313
         LTR   RETCODE,RETCODE                                     0313
         BNZ   @RF00313                                            0313
*     DO;                           /* GOT SPACE OK          @ZD00192*/
*       GET0PTR=COREADDR;           /* SET LOCAL PTR TO CORE ADDRESS
*                                                            @ZD00192*/
         L     GET0PTR,COREADDR(,CVTPTR)                           0315
*       ACCUMCNT=ACCUMCNT+1;        /* INC ACCUM COUNT       @ZD00192*/
         LA    @04,1                                               0316
         LH    @15,ACCUMCNT(,APRWKPTR)                             0316
         ALR   @15,@04                                             0316
         STH   @15,ACCUMCNT(,APRWKPTR)                             0316
*       BLOCKCNT=ACCUMCNT;          /* ADD COUNT TO ISDAGHDR @ZD00192*/
         STH   @15,BLOCKCNT(,GET0PTR)                              0317
*       BLOCKID='APR0';             /* ADD APR ID            @ZD00192*/
         MVC   BLOCKID(4,GET0PTR),@CC00447                         0318
*       LASTPTR=ACCLAST;            /* STORE BACKWARD PTR    @ZD00192*/
         MVC   LASTPTR(4,GET0PTR),ACCLAST(APRWKPTR)                0319
*       IF ACCUMCNT=1 THEN          /* IS THIS FIRST ACCUMULATOR   0320
*                                                            @ZD00192*/
         CR    @15,@04                                             0320
         BNE   @RF00320                                            0320
*         DO;                       /* YES, SAVE ADDRESSES   @ZD00192*/
*           ACCUMPTR=STARTPTR;      /* SET PTR TO START OF DATA IN 0322
*                                      FIRST ACCUMULATOR     @ZD00192*/
         MVC   ACCUMPTR(4,APRWKPTR),STARTPTR(GET0PTR)              0322
*           ACCM0PTR=GET0PTR;       /* SET PTR TO START OF FIRST ACC
*                                      HEADER                @ZD00192*/
         ST    GET0PTR,ACCM0PTR(,APRWKPTR)                         0323
*         END;                      /* END FIRST ACCUMULATOR CODE  0324
*                                                            @ZD00192*/
*       ELSE                        /* NOT FIRST ACCUMULATOR @ZD00192*/
*         DO;                       /* STORE FORWARD POINTER @ZD00192*/
         B     @RC00320                                            0325
@RF00320 DS    0H                                                  0326
*           GET0PTR=ACCLAST;        /* PTR TO LAST BLOCK     @ZD00192*/
         L     GET0PTR,ACCLAST(,APRWKPTR)                          0326
*           NEXTPTR=COREADDR;       /* PTR TO THIS BLOCK     @ZD00192*/
         L     @04,COREADDR(,CVTPTR)                               0327
         ST    @04,NEXTPTR(,GET0PTR)                               0327
*           GET0PTR=COREADDR;       /* RESTORE CURRENT PTR   @ZD00192*/
         LR    GET0PTR,@04                                         0328
*         END;                      /* END FORWARD CHAIN CODE@ZD00192*/
*       ACCLAST=GET0PTR;            /* SAVE PTR TO LAST BLOCK@ZD00192*/
@RC00320 ST    GET0PTR,ACCLAST(,APRWKPTR)                          0330
*       CURRNEXT=STARTPTR;          /* SET PTR TO NEXT ENTRY @ZD00192*/
         MVC   CURRNEXT(4,APRWKPTR),STARTPTR(GET0PTR)              0331
*       ACCUMEND=ENDPTR;            /* SET PTR TO END OF APRACCUM  0332
*                                                            @ZD00192*/
         MVC   ACCUMEND(4,APRWKPTR),ENDPTR(GET0PTR)                0332
* /*    CALL TRACEWRK                  DUMP WORK AREA IF REQ @ZD00192*/
* /*    CALL TRACEHD                   DUMP ACC HEADER IF REQ@ZD00192*/
*     END;                          /* END INITIALIZE HEADER @ZD00192*/
*   ELSE;                           /* NO SPACE FOR ACCUMULATOR    0334
*                                                            @ZD00192*/
@RF00313 DS    0H                                                  0335
*   END GETACCUM;                   /* END GET ACCUMULATOR   @ZD00192*/
@EL00007 DS    0H                                                  0335
@EF00007 DS    0H                                                  0335
@ER00007 L     @14,@SA00007                                        0335
         BR    @14                                                 0335
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* FREECORE - PROC TO FREE ALL ACCUMULATORS AND WORK AREA        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*FREECORE:                                                         0336
*   PROC OPTIONS(SAVE(14));         /* PROC TO FREE CORE     @ZD00192*/
FREECORE ST    @14,@SA00008                                        0336
*   IF APR00PTR^=0 THEN             /* HAVE WORKAREA         @ZD00192*/
         ICM   @10,15,APR00PTR(CVTPTR)                             0337
         BZ    @RF00337                                            0337
*     DO;                           /* YES, FREE ALL CORE    @ZD00192*/
* /*    CALL TRACEWRK                  DUMP WORK AREA IF REQ @ZD00192*/
*       GET0PTR=ACCM0PTR;           /* SET PTR TO 1ST ACCUM  @ZD00192*/
*                                                                  0339
         L     GET0PTR,ACCM0PTR(,APRWKPTR)                         0339
*       /*************************************************************/
*       /*                                                           */
*       /* FREE ACCUMULATOR BLOCKS                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0340
*       DO WHILE(GET0PTR^=0);       /* LOOP THROUGH ACCUMULATORS   0340
*                                                            @ZD00192*/
         B     @DE00340                                            0340
@DL00340 DS    0H                                                  0341
* /*      CALL TRACEHD                 DUMP HEADER IF REQ    @ZD00192*/
*         ENTRYPTR=NEXTPTR;         /* SAVE NEXT ADDRESS     @ZD00192*/
         L     ENTRYPTR,NEXTPTR(,GET0PTR)                          0341
*         SPNOLEN=GET0SPLN;         /* MOVE SPNO AND LENGTH  @ZD00192*/
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(GET0PTR)                 0342
*         COREADDR=GET0PTR;         /* MOVE ADDRESS          @ZD00192*/
         ST    GET0PTR,COREADDR(,CVTPTR)                           0343
*         RFY                                                      0344
*           R1 RSTD;                                       /*@ZD00192*/
*         R1=ADDR(WORKCALL);        /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0345
*         CALL ISDAFREE;            /* FREE CORE             @ZD00192*/
         L     @15,@CV00399                                        0346
         BALR  @14,@15                                             0346
*         RFY                                                      0347
*           R1 UNRSTD;                                     /*@ZD00192*/
*         GET0PTR=ENTRYPTR;         /* SET NEXT ADDRESS      @ZD00192*/
         LR    GET0PTR,ENTRYPTR                                    0348
*       END;                        /* END OF FREE ACCUM LOOP@ZD00192*/
*                                                                  0349
@DE00340 LTR   GET0PTR,GET0PTR                                     0349
         BNZ   @DL00340                                            0349
*       /*************************************************************/
*       /*                                                           */
*       /* FREE APRWORK - APR WORK AREA                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0350
*       CORELEN=LENGTH(APRWORK);    /* SET LENGTH            @ZD00192*/
         MVC   CORELEN(3,CVTPTR),@CF00451+1                        0350
*       SPNO=APRSPNO;               /* SET SUBPOOL NUMBER    @ZD00192*/
         MVC   SPNO(1,CVTPTR),APRSPNO                              0351
*       COREADDR=APR00PTR;          /* SET ADDRESS           @ZD00192*/
         MVC   COREADDR(4,CVTPTR),APR00PTR(CVTPTR)                 0352
*       RFY                                                        0353
*         R1 RSTD;                                         /*@ZD00192*/
*       R1=ADDR(WORKCALL);          /* R1 -> WORKPTR         @ZD00192*/
         LA    R1,WORKCALL(,CVTPTR)                                0354
*       CALL ISDAFREE;              /* FREE WORK AREA        @ZD00192*/
         L     @15,@CV00399                                        0355
         BALR  @14,@15                                             0355
*       RFY                                                        0356
*         R1 UNRSTD;                                       /*@ZD00192*/
*     END;                          /* END FREE ALL CORE     @ZD00192*/
*   ELSE;                           /* NO WORK AREA TO FREE  @ZD00192*/
@RF00337 DS    0H                                                  0359
*   APR00PTR=0;                     /* SET APR POINTER ZERO  @ZD00192*/
         SLR   @10,@10                                             0359
         ST    @10,APR00PTR(,CVTPTR)                               0359
*   CAPRSUU='00'X;                  /* RESET APR CALL POINTER@ZD00192*/
         L     @10,LPARMPTR                                        0360
         MVI   CAPRSUU(@10),X'00'                                  0360
*   END FREECORE;                   /* END OF FREECORE PROC  @ZD00192*/
@EL00008 DS    0H                                                  0361
@EF00008 DS    0H                                                  0361
@ER00008 L     @14,@SA00008                                        0361
         BR    @14                                                 0361
*   END ISDAAPR0                    /* END OF ISDAAPR0       @ZD00192*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (ISDACVT )                                        *
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        *
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        *
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        *
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        *
*/*%INCLUDE SYSLIB  (ISDAMSC0)                                        *
*;                                                                 0362
@DATA    DS    0H
@CH00100 DC    H'2'
@CH00104 DC    H'4'
@CH00433 DC    H'32'
@CH00432 DC    H'36'
@CH00390 DC    H'51'
@CH00431 DC    H'56'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00004 DS    1F
@SA00007 DS    0F
@SA00008 DS    0F
@SA00002 DS    0F
         DS    1F
ISDAAPR0 CSECT
         DS    0F
@CF00451 DC    F'124'
@CF00386 DC    F'2048'
@DATD    DSECT
         DS    0D
LPARMPTR DS    A
TERNCOD0 DS    F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISDAAPR0 CSECT
         NOPR  ((@ENDDATD-@DATD)/161*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00397 DC    V(ISDAGET0)
@CV00398 DC    V(ISDAGET1)
@CV00399 DC    V(ISDAFREE)
         DS    0D
@CC00447 DC    C'APR0'
@CB00423 DC    X'00000000'
@CB00421 DC    X'8000'
@CB00422 DC    X'0FFF'
APRSPNO  DC    X'01'
PATCH    DC    50X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RETCODE  EQU   @06
ENTRYPTR EQU   @04
APRWKPTR EQU   @03
SENSEPTR EQU   @05
LOGPTR   EQU   @10
GET0PTR  EQU   @07
CVTPTR   EQU   @02
R1       EQU   @01
R15      EQU   @15
ISDACVT  EQU   0
CVTPTRS0 EQU   ISDACVT
DATAPTR  EQU   CVTPTRS0
SDATAPTR EQU   CVTPTRS0+4
PARMPTR  EQU   CVTPTRS0+8
SDA00PTR EQU   CVTPTRS0+12
APR00PTR EQU   CVTPTRS0+80
WORKCALL EQU   CVTPTRS0+96
GET0CALL EQU   ISDACVT+100
SPNOLEN  EQU   GET0CALL
SPNO     EQU   SPNOLEN
CORELEN  EQU   SPNOLEN+1
COREADDR EQU   GET0CALL+4
HEXPCALL EQU   ISDACVT+108
PRT0CALL EQU   ISDACVT+120
OUTLINE  EQU   PRT0CALL
SDADATD  EQU   ISDACVT+256
PRTDATD  EQU   ISDACVT+416
ISDAPRMS EQU   0
CINPUT   EQU   ISDAPRMS
CSTART   EQU   ISDAPRMS+2
CEND     EQU   ISDAPRMS+6
CFSCONLY EQU   ISDAPRMS+13
CSSIDF   EQU   ISDAPRMS+17
CSERIAL  EQU   ISDAPRMS+21
CREPORTS EQU   ISDAPRMS+33
CAPRSUU  EQU   CREPORTS+10
ISDAGHDR EQU   0
STARTPTR EQU   ISDAGHDR
ENDPTR   EQU   ISDAGHDR+4
GET0SPLN EQU   ISDAGHDR+8
NEXTPTR  EQU   ISDAGHDR+12
LASTPTR  EQU   ISDAGHDR+16
BLOCKID  EQU   ISDAGHDR+20
BLOCKCNT EQU   ISDAGHDR+24
OBRMDR   EQU   0
SCW      EQU   OBRMDR
SWITCHES EQU   OBRMDR+6
DATETIME EQU   OBRMDR+12
DATE     EQU   DATETIME
TIME     EQU   DATETIME+4
CPUSERID EQU   OBRMDR+21
ISDAMSCS EQU   0
STATUS   EQU   ISDAMSCS
SUBSYSID EQU   ISDAMSCS+1
SSIDFLAG EQU   SUBSYSID
SSID     EQU   SUBSYSID
FORMATNO EQU   ISDAMSCS+3
SUBSENSE EQU   ISDAMSCS+4
SUBSTAT4 EQU   SUBSENSE
SUBSTAT5 EQU   SUBSENSE+1
SARETRY  EQU   SUBSENSE+5
SALOWAD2 EQU   SUBSENSE+6
SUBFMTMG EQU   SUBSENSE+7
MSCFSC   EQU   SUBSENSE+22
ISDAWORK EQU   0
INFLAGS  EQU   ISDAWORK
INDEVTYP EQU   INFLAGS+2
INRECCUA EQU   ISDAWORK+6
ISDAMSC0 EQU   4
VOLID0   EQU   ISDAMSC0
CHR0     EQU   VOLID0
TBLID0   EQU   ISDAMSC0+6
TERMCOD0 EQU   ISDAMSC0+8
CSN0     EQU   16
APRWORK  EQU   0
APRWORK0 EQU   APRWORK
ACCM0PTR EQU   APRWORK0
ACCUMPTR EQU   APRWORK0+4
ACCUMEND EQU   APRWORK0+8
CURRPTR  EQU   APRWORK0+12
CURRNEXT EQU   APRWORK0+16
ACCLAST  EQU   APRWORK0+20
TOTALENT EQU   APRWORK0+24
CURRLEN  EQU   APRWORK0+44
ACCUMCNT EQU   APRWORK0+46
T07COUNT EQU   APRWORK0+50
T09COUNT EQU   APRWORK0+52
T41COUNT EQU   APRWORK0+54
SAVEDYTS EQU   APRWORK0+58
SAVEDAYT EQU   SAVEDYTS
SAVSEQEN EQU   SAVEDYTS+8
SAVESSID EQU   APRWORK0+68
APRSSIDF EQU   APRWORK0+70
TYPECODE EQU   APRWORK0+90
APRFLAGS EQU   APRWORK0+91
APRTEMPS EQU   APRWORK+92
TEMP9    EQU   APRTEMPS
TEMP8    EQU   TEMP9
TEMP7    EQU   TEMP8
TEMP6    EQU   TEMP7
TEMP5    EQU   TEMP6
TEMP4    EQU   TEMP5
TEMP3    EQU   TEMP4
TEMP2    EQU   TEMP3
TEMP20   EQU   APRTEMPS+9
TEMP1417 EQU   TEMP20+13
ACCENTRY EQU   0
ENTFIXED EQU   ACCENTRY
NEXTENT  EQU   ENTFIXED
ENTFLAGS EQU   ENTFIXED+4
ENTCOUNT EQU   ENTFLAGS
ELENGTH  EQU   ENTFLAGS+2
ETYPCODE EQU   ENTFLAGS+3
EFMTMSG  EQU   ENTFLAGS+4
ENTFLAG  EQU   ENTFLAGS+5
EFLAG1   EQU   ENTFLAG
EFLAG2   EQU   ENTFLAG
EFLAG3   EQU   ENTFLAG
EFLAG4   EQU   ENTFLAG
EFLAG5   EQU   ENTFLAG
EFLAG6   EQU   ENTFLAG
EFLAG7   EQU   ENTFLAG
EFLAG8   EQU   ENTFLAG
ENTSSID  EQU   ENTFLAGS+6
ENTDAYTS EQU   ENTFIXED+12
ENTDAYT  EQU   ENTDAYTS
ENTSEQEN EQU   ENTDAYTS+8
ENTVAR   EQU   ACCENTRY+24
EBYTE03  EQU   ENTVAR
EBYTE431 EQU   ENTVAR+4
ENTVOLID EQU   EBYTE431
ENTCPUID EQU   ENTVOLID
EBYTE45  EQU   ENTCPUID
EBYTE4   EQU   EBYTE45
EBYTE5   EQU   EBYTE45+1
EBYTE67  EQU   ENTCPUID+2
EBYTE9   EQU   ENTVOLID+5
EBYTE10  EQU   EBYTE431+6
EBYTE11  EQU   EBYTE431+7
EBYT1215 EQU   EBYTE431+8
ENTCSN   EQU   EBYTE431+12
WORKPTR  EQU   0
*                                      START UNREFERENCED COMPONENTS
EBYT3031 EQU   EBYTE431+26
EBYT2829 EQU   EBYTE431+24
EBYT1415 EQU   EBYT1215+2
EBYTE13  EQU   EBYT1215+1
EBYTE12  EQU   EBYT1215
EBYTE8   EQU   ENTCPUID+4
EBYTE7   EQU   EBYTE67+1
EBYTE6   EQU   EBYTE67
EBYTE3   EQU   EBYTE03+3
EBYTE2   EQU   EBYTE03+2
EBYTE1   EQU   EBYTE03+1
EBYTE0   EQU   EBYTE03
ENTSPARE EQU   ENTFIXED+21
ENTTIME  EQU   ENTDAYT+4
ENTDATE  EQU   ENTDAYT
TEMP3032 EQU   APRTEMPS+29
TEMP1820 EQU   TEMP20+17
TEMP1617 EQU   TEMP1417+2
TEMP1415 EQU   TEMP1417
TEMP1113 EQU   TEMP20+10
TEMP710  EQU   TEMP20+6
TEMP16   EQU   TEMP20
TEMP1    EQU   TEMP2
SAVESAPR EQU   APRWORK0+86
APRSSIDS EQU   APRSSIDF
SAVSPARE EQU   APRWORK0+67
SAVETIME EQU   SAVEDAYT+4
SAVEDATE EQU   SAVEDAYT
T08COUNT EQU   APRWORK0+56
POINTLEN EQU   APRWORK0+48
LINECNT  EQU   APRWORK0+40
STARTPNT EQU   APRWORK0+36
STARTAPR EQU   APRWORK0+32
SORTCNT  EQU   APRWORK0+28
LOADERR0 EQU   ISDAMSC0+26
RWLOADS0 EQU   ISDAMSC0+24
SWCHECK0 EQU   ISDAMSC0+22
SRCHECK0 EQU   ISDAMSC0+20
WUSECNT0 EQU   ISDAMSC0+16
RUSECNT0 EQU   ISDAMSC0+12
XYZL0    EQU   ISDAMSC0+10
@NM00008 EQU   ISDAMSC0+9
MSGCODE0 EQU   ISDAMSC0+7
SSID0    EQU   CHR0
DEVPTR   EQU   ISDAWORK+16
NOUTREC  EQU   ISDAWORK+12
NINREC   EQU   ISDAWORK+8
CUABYTE1 EQU   INRECCUA+1
CUABYTE0 EQU   INRECCUA
DLENGTH  EQU   ISDAWORK+4
SDAFLAG0 EQU   INFLAGS+3
INSOURCE EQU   INFLAGS+1
IRECTYPE EQU   INFLAGS
SANOMSCD EQU   SUBSENSE+27
RCYLMSCD EQU   SUBSENSE+25
RUAMSCD  EQU   SUBSENSE+24
@NM00007 EQU   SUBSENSE+21
RUADASD  EQU   SUBSENSE+20
DASDFSC  EQU   SUBSENSE+18
@NM00006 EQU   SUBSENSE+8
MSGCODEN EQU   SUBFMTMG
SUBFMTNO EQU   SUBFMTMG
@NM00005 EQU   SUBSENSE+4
DASDFMTN EQU   SUBSENSE+3
SALOWADD EQU   SUBSENSE+2
SSIDDEVT EQU   SSID+1
SSIDLIBN EQU   SSID+1
SSIDTYPE EQU   SSID
CPUID    EQU   CPUSERID+3
CPUSER   EQU   CPUSERID
VERNO    EQU   OBRMDR+20
TENSHUND EQU   TIME+3
SECOND   EQU   TIME+2
MINUTE   EQU   TIME+1
HOUR     EQU   TIME
DAY      EQU   DATE+2
YEAR     EQU   DATE
RECENTRY EQU   OBRMDR+11
RCDCNT   EQU   OBRMDR+10
SWITCH3  EQU   SWITCHES+3
SWITCH2  EQU   SWITCHES+2
SWITCH1  EQU   SWITCHES+1
SWITCH0  EQU   SWITCHES
SYSREL   EQU   OBRMDR+5
CLASRC   EQU   OBRMDR+4
@NM00004 EQU   SCW+3
SCODE    EQU   SCW+2
SLENGTH  EQU   SCW
@NM00003 EQU   ISDAGHDR+26
GET0LEN  EQU   GET0SPLN+1
GET0SPNO EQU   GET0SPLN
CTRACE   EQU   ISDAPRMS+48
CGEN     EQU   ISDAPRMS+47
CDETAIL  EQU   ISDAPRMS+46
CPERIOD  EQU   ISDAPRMS+45
CPWR     EQU   CREPORTS+11
CDRC     EQU   CREPORTS+9
CDAT     EQU   CREPORTS+8
CCSBCSF  EQU   CREPORTS+7
CDCKTLX  EQU   CREPORTS+6
CEQC     EQU   CREPORTS+5
CFSC     EQU   CREPORTS+4
CDHEDHU  EQU   CREPORTS+3
CSUM     EQU   CREPORTS+2
CPAD     EQU   CREPORTS+1
CDCS     EQU   CREPORTS
CSERNO   EQU   CSERIAL+4
@NM00002 EQU   CSERIAL+3
CIBM     EQU   CSERIAL
CRATIO   EQU   ISDAPRMS+19
CSSID    EQU   CSSIDF
@NM00001 EQU   CSSIDF
CFSC34   EQU   CFSCONLY+2
CFSC12   EQU   CFSCONLY
CTYPE    EQU   ISDAPRMS+11
CSUMMARY EQU   ISDAPRMS+10
CENDDAY  EQU   CEND+2
CENDYEAR EQU   CEND
CSTDAY   EQU   CSTART+2
CSTYEAR  EQU   CSTART
CHISTIN  EQU   CINPUT+1
CLOGIN   EQU   CINPUT
PRTSA001 EQU   PRTDATD
SDATEMPS EQU   SDADATD+136
SDASA002 EQU   SDADATD+76
SDAPC001 EQU   SDADATD+72
SDASA001 EQU   SDADATD
SDARPTID EQU   PRT0CALL+133
LINE     EQU   OUTLINE+1
ANSI     EQU   OUTLINE
DUMPIDNO EQU   HEXPCALL+8
DUMPLEN  EQU   HEXPCALL+4
DUMPADDR EQU   HEXPCALL
GEN00PTR EQU   CVTPTRS0+92
CNFG0PTR EQU   CVTPTRS0+88
PWR00PTR EQU   CVTPTRS0+84
DRC00PTR EQU   CVTPTRS0+76
DAT00PTR EQU   CVTPTRS0+72
CSB00PTR EQU   CVTPTRS0+68
DCK00PTR EQU   CVTPTRS0+64
EQC00PTR EQU   CVTPTRS0+60
FSC00PTR EQU   CVTPTRS0+56
DHE00PTR EQU   CVTPTRS0+52
SUM00PTR EQU   CVTPTRS0+48
PAD00PTR EQU   CVTPTRS0+44
DCS00PTR EQU   CVTPTRS0+40
LOG00PTR EQU   CVTPTRS0+36
HIST0PTR EQU   CVTPTRS0+32
PRT00PTR EQU   CVTPTRS0+28
GET00PTR EQU   CVTPTRS0+24
TYPE0PTR EQU   CVTPTRS0+20
PARM0PTR EQU   CVTPTRS0+16
*                                      END UNREFERENCED COMPONENTS
@RC00080 EQU   @RC00063
@RC00076 EQU   @RC00063
@RC00072 EQU   @RC00063
@RC00066 EQU   @RC00063
@RC00064 EQU   @RC00063
@RC00086 EQU   @RC00085
@RC00092 EQU   @RC00091
@RC00100 EQU   @RC00097
@RC00098 EQU   @RC00097
@RC00113 EQU   @RC00110
@RC00111 EQU   @RC00110
@RC00142 EQU   @EL00003
@RC00140 EQU   @EL00003
@RC00294 EQU   @EL00006
@RC00287 EQU   @EL00006
@RC00278 EQU   @EL00006
@RC00270 EQU   @EL00006
@RC00252 EQU   @EL00006
@RC00244 EQU   @EL00006
@RC00237 EQU   @EL00006
@RC00067 EQU   @RC00066
@RC00073 EQU   @RC00072
@RC00077 EQU   @RC00076
@ENDDATA EQU   *
         END   ISDAAPR0,(C'PLS1748',0701,78044)

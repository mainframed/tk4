         TITLE 'ICBVOP00 MSVC OPERATOR/LIBRARIAN (JULY 30, 1974) MVS   *
                        '
ICBVOP00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBVOP00  77.070'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*   MSGPTR=REG1;                    /* ADDR REQUEST BLK      @Y30LB26*/
         LR    MSGPTR,REG1                                         0068
*   RESPECIFY                                                      0069
*     REG1 UNRSTD;                  /* FREE REG 1            @Y30LB26*/
*                                                                  0069
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO THE RPLV AND MSVC CONTROL    @Y30LB26*/
*   /* BLOCK                                                 @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0070
*   RPLVPTR=MSGRPLV;                /* ADDR OF RPLV          @Y30LB26*/
         L     RPLVPTR,MSGRPLV(,MSGPTR)                            0070
*   VVIPTR=RPLVVICB;                /* ADDR MSVC CB          @Y30LB26*/
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0071
*   SWITCHES=OFF;                   /*                       @ZM30991*/
*                                                                  0072
         MVI   SWITCHES,B'00000000'                                0072
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE EXPANDED WTO AMD WTOR MACROES TO DSECT           @VS32893*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0073
*   WTO=WTOMSG;                     /* MOVE WTO MACRO        @VS32893*/
         MVC   WTO(80),WTOMSG                                      0073
*   WTOR=WTORMSG;                   /* MOVE WTOR MACRO       @VS32893*/
*                                                                  0074
         MVC   WTOR(88),WTORMSG                                    0074
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP INDEX TO MESSAGES AND SEE IF A VALID INDEX     @Y30LB26*/
*   /* WAS GIVEN                                             @Y30LB26*/
*   /* ZERO ROUTING CODE                                     @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0075
*   LIBROUT=BITZERO;                /* ZERO ROUTING          @Y30LB26*/
         MVC   LIBROUT(2),@CB00154                                 0075
*   I=MSGID-TRE99;                  /* SET MESSAGE INDEX     @Y30LB26*/
         L     I,MSGID(,MSGPTR)                                    0076
         SL    I,@CF00157                                          0076
*   IF I>MSGLIMIT×I<=ZERO×MSGTBL(I)=ZERO THEN/*              @Y30LB26*/
*                                                                  0077
         L     @10,@CV00137                                        0077
         L     @10,LIMITADR(,@10)                                  0077
         C     I,MSGLIMIT(,@10)                                    0077
         BH    @RT00077                                            0077
         SLR   @10,@10                                             0077
         CR    I,@10                                               0077
         BNH   @RT00077                                            0077
         LR    @07,I                                               0077
         SLA   @07,2                                               0077
         L     @03,@CV00137                                        0077
         C     @10,MSGTBL(@07,@03)                                 0077
         BNE   @RF00077                                            0077
@RT00077 DS    0H                                                  0078
*     /***************************************************************/
*     /*                                                             */
*     /* IF INVALID INDEX GIVEN, PUT OUT ERROR MESSAGE       @Y30LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0078
*     DO;                           /*                       @Y30LB26*/
*       I=MYMSGID-TRE99;            /* SET NEW ID            @Y30LB26*/
         LA    I,22                                                0079
*       CVD(MSGID,DECID);           /* CONVRT USRS MSGID     @Y30LB26*/
         L     @10,MSGID(,MSGPTR)                                  0080
         CVD   @10,@TS00001                                        0080
         MVC   DECID(4),@TS00001+4                                 0080
*       UNPK(PRINTID,DECID);        /* MAKE PRINTABLE        @Y30LB26*/
         UNPK  PRINTID(4),DECID(4)                                 0081
*       PRINTID(4)=PRINTID(4)×ORID; /* FIX SIGN TO F         @Y30LB26*/
         OC    PRINTID+3(1),ORID                                   0082
*       MSGLEN1=FOUR;               /* LENGTH FOUR           @Y30LB26*/
         MVI   MSGLEN1(MSGPTR),X'04'                               0083
*       MSGTEXT1=ADDR(PRINTID);     /* ADDR TEXT INSRT       @Y30LB26*/
         LA    @10,PRINTID                                         0084
         STCM  @10,7,MSGTEXT1(MSGPTR)                              0084
*       MSGLEN2=ZERO;               /* ZERO LENGTH           @Y30LB26*/
         MVI   MSGLEN2(MSGPTR),X'00'                               0085
*       MSGLEN3=ZERO;               /* ZERO LENGTH           @Y30LB26*/
         MVI   MSGLEN3(MSGPTR),X'00'                               0086
*       MSGLEN4=ZERO;               /* ZERO LENGTH           @Y30LB26*/
         MVI   MSGLEN4(MSGPTR),X'00'                               0087
*       MSGLEN5=ZERO;               /* ZERO LENGTH           @Y30LB26*/
         MVI   MSGLEN5(MSGPTR),X'00'                               0088
*     END;                          /*                       @Y30LB26*/
*                                                                  0090
*   /*****************************************************************/
*   /*                                                               */
*   /* BLANK OUT MESSAGE BUFFER AND MOVE IN SKELETON MESSAGE @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0090
*   MESGBUF=BLANK;                  /* BLANK BUFFER          @Y30LB26*/
@RF00077 MVI   MESGBUF+1,C' '                                      0090
         MVC   MESGBUF+2(70),MESGBUF+1                             0090
         MVI   MESGBUF,C' '                                        0090
*   MESGBUF=MESGSKEL(1:MESGLEN);    /* SKELETON MESSAGE      @Y30LB26*/
*                                                                  0091
         MVI   MESGBUF+1,C' '                                      0091
         MVC   MESGBUF+2(70),MESGBUF+1                             0091
         LR    @10,I                                               0091
         SLA   @10,2                                               0091
         LA    @07,4                                               0091
         L     @03,@CV00137                                        0091
         ALR   @03,@07                                             0091
         AL    @03,@CF00294                                        0091
         L     @03,MSGTBL(@10,@03)                                 0091
         SLR   @15,@15                                             0091
         IC    @15,MESGLEN(,@03)                                   0091
         BCTR  @15,0                                               0091
         L     @03,@CV00137                                        0091
         ALR   @03,@07                                             0091
         AL    @03,@CF00294                                        0091
         L     @03,MSGTBL(@10,@03)                                 0091
         EX    @15,@SM00295                                        0091
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF FIRST SUBSTITUTION WAS REQUESTED AND           @Y30LB26*/
*   /* CHECK STATIC TEXT TO SEE IF IT EXPECTS A SUBSTITUTION @Y30LB26*/
*   /* CHECK LENGTH TO BE SURE THAT IT IS NOT TOO LONG       @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*   IF MSGLEN1^=ZERO&MESGLEN1^=ZERO THEN/* PARAMETER SPEC?   @Y30LB26*/
*                                                                  0092
         CLI   MSGLEN1(MSGPTR),0                                   0092
         BE    @RF00092                                            0092
         L     @03,@CV00137                                        0092
         ALR   @03,@07                                             0092
         AL    @03,@CF00294                                        0092
         L     @03,MSGTBL(@10,@03)                                 0092
         CLI   MESGLEN1(@03),0                                     0092
         BE    @RF00092                                            0092
*     /***************************************************************/
*     /*                                                             */
*     /* IF TOO LONG, SET TO MAXIMUM ALLOWED VALUE AND       @Y30LB26*/
*     /* MOVE FIRST TEXT SECTION INTO MESSAGE                @Y30LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0093
*     DO;                           /*                       @Y30LB26*/
*       IF MSGLEN1>MESGLEN1 THEN    /* SEE IF TOO LONG       @Y30LB26*/
         L     @03,@CV00137                                        0094
         ALR   @03,@07                                             0094
         AL    @03,@CF00294                                        0094
         L     @03,MSGTBL(@10,@03)                                 0094
         CLC   MSGLEN1(1,MSGPTR),MESGLEN1(@03)                     0094
         BNH   @RF00094                                            0094
*         MSGLEN1=MESGLEN1;         /* IF LONG, SHORTEN      @Y30LB26*/
         L     @03,@CV00137                                        0095
         ALR   @03,@07                                             0095
         AL    @03,@CF00294                                        0095
         L     @10,MSGTBL(@10,@03)                                 0095
         MVC   MSGLEN1(1,MSGPTR),MESGLEN1(@10)                     0095
*       MESGBUF(MESGLOC1:MESGLOC1+MSGLEN1-1)=/*              @Y30LB26*/
*           TEXT1(1:MSGLEN1);       /*                       @Y30LB26*/
@RF00094 LR    @10,I                                               0096
         SLA   @10,2                                               0096
         L     @07,@CV00137                                        0096
         L     @10,MSGTBL(@10,@07)                                 0096
         SLR   @07,@07                                             0096
         IC    @07,MESGLOC1(,@10)                                  0096
         LA    @10,MESGBUF-1(@07)                                  0096
         SLR   @07,@07                                             0096
         IC    @07,MSGLEN1(,MSGPTR)                                0096
         BCTR  @07,0                                               0096
         L     @03,MSGTEXT1-1(,MSGPTR)                             0096
         LA    @03,0(,@03)                                         0096
         EX    @07,@SM00297                                        0096
*     END;                          /*                       @Y30LB26*/
*                                                                  0097
*   /*****************************************************************/
*   /*                                                               */
*   /* DO SAME FOR SECOND TEXT SUBSTITUTION                  @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0098
*   IF MSGLEN2^=ZERO&MESGLEN2^=ZERO THEN/* PARAMETER SPEC?   @Y30LB26*/
@RF00092 CLI   MSGLEN2(MSGPTR),0                                   0098
         BE    @RF00098                                            0098
         LR    @10,I                                               0098
         SLA   @10,2                                               0098
         LA    @07,4                                               0098
         L     @03,@CV00137                                        0098
         ALR   @03,@07                                             0098
         AL    @03,@CF00294                                        0098
         L     @03,MSGTBL(@10,@03)                                 0098
         CLI   MESGLEN2(@03),0                                     0098
         BE    @RF00098                                            0098
*     DO;                           /*                       @Y30LB26*/
*       IF MSGLEN2>MESGLEN2 THEN    /* SEE IF TOO LONG       @Y30LB26*/
         L     @03,@CV00137                                        0100
         ALR   @03,@07                                             0100
         AL    @03,@CF00294                                        0100
         L     @03,MSGTBL(@10,@03)                                 0100
         CLC   MSGLEN2(1,MSGPTR),MESGLEN2(@03)                     0100
         BNH   @RF00100                                            0100
*         MSGLEN2=MESGLEN2;         /* IF LONG, SHORTEN      @Y30LB26*/
         L     @03,@CV00137                                        0101
         ALR   @03,@07                                             0101
         AL    @03,@CF00294                                        0101
         L     @10,MSGTBL(@10,@03)                                 0101
         MVC   MSGLEN2(1,MSGPTR),MESGLEN2(@10)                     0101
*       MESGBUF(MESGLOC2:MESGLOC2+MSGLEN2-1)=/*              @Y30LB26*/
*           TEXT2(1:MSGLEN2);       /*                       @Y30LB26*/
@RF00100 LR    @10,I                                               0102
         SLA   @10,2                                               0102
         L     @07,@CV00137                                        0102
         L     @10,MSGTBL(@10,@07)                                 0102
         SLR   @07,@07                                             0102
         IC    @07,MESGLOC2(,@10)                                  0102
         LA    @10,MESGBUF-1(@07)                                  0102
         SLR   @07,@07                                             0102
         IC    @07,MSGLEN2(,MSGPTR)                                0102
         BCTR  @07,0                                               0102
         L     @03,MSGTEXT2-1(,MSGPTR)                             0102
         LA    @03,0(,@03)                                         0102
         EX    @07,@SM00299                                        0102
*     END;                          /*                       @Y30LB26*/
*                                                                  0103
*   /*****************************************************************/
*   /*                                                               */
*   /* DO SAME FOR THIRD TEXT SUBSTITUTION                   @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0104
*   IF MSGLEN3^=ZERO&MESGLEN3^=ZERO THEN/* PARM SPECIFIED?   @Y30LB26*/
@RF00098 CLI   MSGLEN3(MSGPTR),0                                   0104
         BE    @RF00104                                            0104
         LR    @10,I                                               0104
         SLA   @10,2                                               0104
         LA    @07,4                                               0104
         L     @03,@CV00137                                        0104
         ALR   @03,@07                                             0104
         AL    @03,@CF00294                                        0104
         L     @03,MSGTBL(@10,@03)                                 0104
         CLI   MESGLEN3(@03),0                                     0104
         BE    @RF00104                                            0104
*     DO;                           /*                       @Y30LB26*/
*       IF MSGLEN3>MESGLEN3 THEN    /* SEE IF TOO LONG       @Y30LB26*/
         L     @03,@CV00137                                        0106
         ALR   @03,@07                                             0106
         AL    @03,@CF00294                                        0106
         L     @03,MSGTBL(@10,@03)                                 0106
         CLC   MSGLEN3(1,MSGPTR),MESGLEN3(@03)                     0106
         BNH   @RF00106                                            0106
*         MSGLEN3=MESGLEN3;         /* IF LONG, SHORTEN      @Y30LB26*/
         L     @03,@CV00137                                        0107
         ALR   @03,@07                                             0107
         AL    @03,@CF00294                                        0107
         L     @10,MSGTBL(@10,@03)                                 0107
         MVC   MSGLEN3(1,MSGPTR),MESGLEN3(@10)                     0107
*       MESGBUF(MESGLOC3:MESGLOC3+MSGLEN3-1)=/*              @Y30LB26*/
*           TEXT3(1:MSGLEN3);       /*                       @Y30LB26*/
@RF00106 LR    @10,I                                               0108
         SLA   @10,2                                               0108
         L     @07,@CV00137                                        0108
         L     @10,MSGTBL(@10,@07)                                 0108
         SLR   @07,@07                                             0108
         IC    @07,MESGLOC3(,@10)                                  0108
         LA    @10,MESGBUF-1(@07)                                  0108
         SLR   @07,@07                                             0108
         IC    @07,MSGLEN3(,MSGPTR)                                0108
         BCTR  @07,0                                               0108
         L     @03,MSGTEXT3-1(,MSGPTR)                             0108
         LA    @03,0(,@03)                                         0108
         EX    @07,@SM00301                                        0108
*     END;                          /*                       @Y30LB26*/
*                                                                  0109
*   /*****************************************************************/
*   /*                                                               */
*   /* DO SAME FOR FOURTH                                    @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0110
*   IF MSGLEN4^=ZERO&MESGLEN4^=ZERO THEN/* PARM SPEC?        @Y30LB26*/
@RF00104 CLI   MSGLEN4(MSGPTR),0                                   0110
         BE    @RF00110                                            0110
         LR    @10,I                                               0110
         SLA   @10,2                                               0110
         LA    @07,4                                               0110
         L     @03,@CV00137                                        0110
         ALR   @03,@07                                             0110
         AL    @03,@CF00294                                        0110
         L     @03,MSGTBL(@10,@03)                                 0110
         CLI   MESGLEN4(@03),0                                     0110
         BE    @RF00110                                            0110
*     DO;                           /*                       @Y30LB26*/
*       IF MSGLEN4>MESGLEN4 THEN    /* TOO LONG?             @Y30LB26*/
         L     @03,@CV00137                                        0112
         ALR   @03,@07                                             0112
         AL    @03,@CF00294                                        0112
         L     @03,MSGTBL(@10,@03)                                 0112
         CLC   MSGLEN4(1,MSGPTR),MESGLEN4(@03)                     0112
         BNH   @RF00112                                            0112
*         MSGLEN4=MESGLEN4;         /* IF LONG, SHORTEN      @Y30LB26*/
         L     @03,@CV00137                                        0113
         ALR   @03,@07                                             0113
         AL    @03,@CF00294                                        0113
         L     @10,MSGTBL(@10,@03)                                 0113
         MVC   MSGLEN4(1,MSGPTR),MESGLEN4(@10)                     0113
*       MESGBUF(MESGLOC4:MESGLOC4+MSGLEN4-1)=/*              @Y30LB26*/
*           TEXT4(1:MSGLEN4);       /*                       @Y30LB26*/
@RF00112 LR    @10,I                                               0114
         SLA   @10,2                                               0114
         L     @07,@CV00137                                        0114
         L     @10,MSGTBL(@10,@07)                                 0114
         SLR   @07,@07                                             0114
         IC    @07,MESGLOC4(,@10)                                  0114
         LA    @10,MESGBUF-1(@07)                                  0114
         SLR   @07,@07                                             0114
         IC    @07,MSGLEN4(,MSGPTR)                                0114
         BCTR  @07,0                                               0114
         L     @03,MSGTEXT4-1(,MSGPTR)                             0114
         LA    @03,0(,@03)                                         0114
         EX    @07,@SM00303                                        0114
*     END;                          /*                       @Y30LB26*/
*                                                                  0115
*   /*****************************************************************/
*   /*                                                               */
*   /* DO SAME FOR FIFTH                                     @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0116
*   IF MSGLEN5^=ZERO&MESGLEN5^=ZERO THEN/* PARM SPEC?        @Y30LB26*/
@RF00110 CLI   MSGLEN5(MSGPTR),0                                   0116
         BE    @RF00116                                            0116
         LR    @10,I                                               0116
         SLA   @10,2                                               0116
         LA    @07,4                                               0116
         L     @03,@CV00137                                        0116
         ALR   @03,@07                                             0116
         AL    @03,@CF00294                                        0116
         L     @03,MSGTBL(@10,@03)                                 0116
         CLI   MESGLEN5(@03),0                                     0116
         BE    @RF00116                                            0116
*     DO;                           /*                       @Y30LB26*/
*       IF MSGLEN5>MESGLEN5 THEN    /* TOO LONG?             @Y30LB26*/
         L     @03,@CV00137                                        0118
         ALR   @03,@07                                             0118
         AL    @03,@CF00294                                        0118
         L     @03,MSGTBL(@10,@03)                                 0118
         CLC   MSGLEN5(1,MSGPTR),MESGLEN5(@03)                     0118
         BNH   @RF00118                                            0118
*         MSGLEN5=MESGLEN5;         /* IF SO, SHORTEN        @Y30LB26*/
         L     @03,@CV00137                                        0119
         ALR   @03,@07                                             0119
         AL    @03,@CF00294                                        0119
         L     @10,MSGTBL(@10,@03)                                 0119
         MVC   MSGLEN5(1,MSGPTR),MESGLEN5(@10)                     0119
*       MESGBUF(MESGLOC5:MESGLOC5+MSGLEN5-1)=/*              @Y30LB26*/
*           TEXT5(1:MSGLEN5);       /*                       @Y30LB26*/
@RF00118 LR    @10,I                                               0120
         SLA   @10,2                                               0120
         L     @07,@CV00137                                        0120
         L     @10,MSGTBL(@10,@07)                                 0120
         SLR   @07,@07                                             0120
         IC    @07,MESGLOC5(,@10)                                  0120
         LA    @10,MESGBUF-1(@07)                                  0120
         SLR   @07,@07                                             0120
         IC    @07,MSGLEN5(,MSGPTR)                                0120
         BCTR  @07,0                                               0120
         L     @03,MSGTEXT5-1(,MSGPTR)                             0120
         LA    @03,0(,@03)                                         0120
         EX    @07,@SM00305                                        0120
*     END;                          /*                       @Y30LB26*/
*                                                                  0122
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE THAT SENDS MESSAGE                       @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0122
*   CALL SENDMSG;                   /* WRITE TO OPERATOR     @Y30LB26*/
@RF00116 BAL   @14,SENDMSG                                         0122
*                                                                  0123
*   /*****************************************************************/
*   /*                                                               */
*   /* SET REASON AND RETURN CODES IN RPLV FROM STATIC TABLE @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0123
*   RPLVRETC=MESGRET;               /* SET RETURN CODE       @Y30LB26*/
         LR    @10,I                                               0123
         SLA   @10,2                                               0123
         LA    @15,4                                               0123
         L     @14,@CV00137                                        0123
         ALR   @14,@15                                             0123
         AL    @14,@CF00294                                        0123
         L     @01,MSGTBL(@10,@14)                                 0123
         MVC   RPLVRETC(2,RPLVPTR),MESGRET(@01)                    0123
*   RPLRCODE=MESGREA;               /* SET REASON CODE       @Y30LB26*/
         L     @14,@CV00137                                        0124
         ALR   @14,@15                                             0124
         AL    @14,@CF00294                                        0124
         L     @10,MSGTBL(@10,@14)                                 0124
         MVC   RPLRCODE(2,RPLVPTR),MESGREA(@10)                    0124
*   RETURN;                         /*                       @Y30LB26*/
@EL00001 L     @13,4(,@13)                                         0125
@EF00001 L     @00,@SIZDATD                                        0125
         LR    @01,@11                                             0125
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0125
         BR    @14                                                 0125
*                                                                  0126
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE WRITES MESSAGE TO OPERATOR AND/OR LIBRARIAN.  @Y30LB26*/
*   /* MESSAGES THAT REQUIRE REPLYS WILL ONLY GO             @Y30LB26*/
*   /* TO THE OPERATOR.                                      @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*SENDMSG:                                                          0126
*   PROC;                           /*                       @Y30LB26*/
*                                                                  0126
SENDMSG  STM   @14,@12,@SA00002                                    0126
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF MESSAGE NEEDS A REPLY                          @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0127
*   IF MESGFLG3=ON&MESGFLG1=ON THEN /* WTO WITH REPLY        @Y30LB26*/
         LR    @10,I                                               0127
         SLA   @10,2                                               0127
         L     @07,@CV00137                                        0127
         L     @10,MSGTBL(@10,@07)                                 0127
         TM    MESGFLG3(@10),B'10100000'                           0127
         BNO   @RF00127                                            0127
*     DO;                           /*                       @Y30LB26*/
*                                                                  0128
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO WTOR ECB AND DEFAULT REPLY LENGTH IF CALLER  @Y30LB26*/
*       /* FORGOT TO INITILIZE IT. OTHERWISE PUT IN          @Y30LB26*/
*       /* REPLY LENGTH.                                     @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0129
*       WTORECB=ZERO;               /* ZERO WTOR ECB         @Y30LB26*/
         SLR   @10,@10                                             0129
         ST    @10,WTORECB                                         0129
*       IF MSGRLEN=ZERO THEN        /* FORGOT LENGTH ?       @Y30LB26*/
         CLI   MSGRLEN(MSGPTR),0                                   0130
         BNE   @RF00130                                            0130
*         WTORLENR=SEVENTWO;        /* DEFAULT               @Y30LB26*/
         MVI   WTORLENR,X'48'                                      0131
*       ELSE                        /*                       @Y30LB26*/
*         WTORLENR=MSGRLEN;         /* GET REPLY LENGTH      @Y30LB26*/
*                                                                  0132
         B     @RC00130                                            0132
@RF00130 MVC   WTORLENR(1),MSGRLEN(MSGPTR)                         0132
*       /*************************************************************/
*       /*                                                           */
*       /* BLANK OUT REPLY BUFFER. INITILIZE FIELDS IN WTOR  @Y30LB26*/
*       /* MACRO AND MOVE IN MESSAGE.                        @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0133
*       WTORECBA=ADDR(WTORECB);     /* ADDRESS OF ECB        @Y30LB26*/
@RC00130 LA    @10,WTORECB                                         0133
         ST    @10,WTORECBA                                        0133
*       WTORTEXT=MESGBUF;           /* NONE IN TEXT          @Y30LB26*/
         MVC   WTORTEXT(72),MESGBUF                                0134
*       WTORDESC=MESGDES;           /* DESCRIPTOR            @Y30LB26*/
         LR    @10,I                                               0135
         SLA   @10,2                                               0135
         LA    @05,4                                               0135
         L     @03,@CV00137                                        0135
         ALR   @03,@05                                             0135
         AL    @03,@CF00294                                        0135
         L     @03,MSGTBL(@10,@03)                                 0135
         MVC   WTORDESC(2),MESGDES(@03)                            0135
*       WTORROUT=MESGRTE;           /* SET ROUTING INFO      @Y30LB26*/
         L     @03,@CV00137                                        0136
         ALR   @03,@05                                             0136
         AL    @03,@CF00294                                        0136
         L     @10,MSGTBL(@10,@03)                                 0136
         MVC   WTORROUT(2),MESGRTE(@10)                            0136
*       REPLY=BLANK;                /* BLANK REPLY BUF       @VS32893*/
         MVI   REPLY+1,C' '                                        0137
         MVC   REPLY+2(70),REPLY+1                                 0137
         MVI   REPLY,C' '                                          0137
*       WTORADDR=ADDR(REPLY);       /* ADDRESS OF REPLY      @VS32893*/
         LA    @10,REPLY                                           0138
         STCM  @10,7,WTORADDR                                      0138
*                                                                  0139
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE WRITE TO OPERATOR WITH REPLY                @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0139
*       RESPECIFY                                                  0139
*         REG1 RSTD;                /* RESTRICT              @Y30LB26*/
*       REG1=ADDR(WTOR);            /* LIST WTOR ADDR        @VS32893*/
         LA    REG1,WTOR                                           0140
*LWTOR1:                                                           0141
*       GEN(WTOR   MF=(E,(REG1)));  /* WRITE TO OPERATOR     @Y30LB26*/
LWTOR1   WTOR   MF=(E,(REG1))
*       RESPECIFY                                                  0142
*         REG1 UNRSTD;              /* FREE REG 1            @Y30LB26*/
*                                                                  0142
*       /*************************************************************/
*       /*                                                           */
*       /* WAIT FOR REPLY                                    @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0143
*LWAIT1:                                                           0143
*       GEN(WAIT ECB=WTORECB);      /* WAIT FOR REPLY        @Y30LB26*/
*                                                                  0143
LWAIT1   WAIT ECB=WTORECB
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF USER SUPPLIED BOTH A REPLY        @Y30LB26*/
*       /* LENGTH AND A REPLY ADDRESS. IF BOTH NOT GIVEN,    @Y30LB26*/
*       /* NO REPLY CAN BE RETURNED TO USER. IF GIVEN, PUT   @Y30LB26*/
*       /* REPLY IN USERS BUFFER                             @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0144
*       IF MSGRLEN^=ZERO&MSGREPLY^=ZERO THEN/*               @Y30LB26*/
         CLI   MSGRLEN(MSGPTR),0                                   0144
         BE    @RF00144                                            0144
         L     @10,MSGREPLY-1(,MSGPTR)                             0144
         LA    @10,0(,@10)                                         0144
         LTR   @10,@10                                             0144
         BZ    @RF00144                                            0144
*         USERRBUF(1:MSGRLEN)=REPLY(1:MSGRLEN);/* RPLY USER  @Y30LB26*/
         SLR   @05,@05                                             0145
         IC    @05,MSGRLEN(,MSGPTR)                                0145
         BCTR  @05,0                                               0145
         EX    @05,@SM00307                                        0145
*       RETURN;                     /*                       @Y30LB26*/
@EL00002 DS    0H                                                  0146
@EF00002 DS    0H                                                  0146
@ER00002 LM    @14,@12,@SA00002                                    0146
         BR    @14                                                 0146
*     END;                          /*                       @Y30LB26*/
*                                                                  0148
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REPLY NOT WANTED, CHECK FOR LIBRARIAN AND/OR       @Y30LB26*/
*   /* OPERATOR MESSAGE                                      @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0148
*   ELSE                            /*                       @Y30LB26*/
*     DO;                           /*                       @Y30LB26*/
*                                                                  0148
@RF00127 DS    0H                                                  0149
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF MESSAGE BEING SENT TO LIBRARIAN            @Y30LB26*/
*       /* ALTERNATE CONSOLE                                 @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0149
*       IF VVIALCON^=ZERO&MESGFLG2=ON THEN/* NO ROUTING      @Y30LB26*/
         CLI   VVIALCON(VVIPTR),0                                  0149
         BE    @RF00149                                            0149
         LR    @10,I                                               0149
         SLA   @10,2                                               0149
         L     @07,@CV00137                                        0149
         L     @10,MSGTBL(@10,@07)                                 0149
         TM    MESGFLG2(@10),B'01000000'                           0149
         BNO   @RF00149                                            0149
*         DO;                       /*                       @Y30LB26*/
*                                                                  0150
*           /*********************************************************/
*           /*                                                       */
*           /* SET DUMMY ROUTE CODE WITH FIRST BIT ON TO BE  @Y30LB26*/
*           /* SHIFTED RIGHT                                 @Y30LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0151
*           LIBROUT=INITROUT;       /* INITIAL ROUTING       @Y30LB26*/
*                                                                  0151
         MVC   LIBROUT(2),@CB00149                                 0151
*           /*********************************************************/
*           /*                                                       */
*           /* IF ROUTING CODE IS ONE, THEN DUMMY ROUTE      @Y30LB26*/
*           /* CODE ALREADY SET RIGHT. OTHERWISE SHIFT BIT   @Y30LB26*/
*           /* TO CORRECT POSITION.                          @Y30LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0152
*           IF VVIALCON>ONE THEN    /* ROUTING CODE 1?       @Y30LB26*/
         CLI   VVIALCON(VVIPTR),1                                  0152
         BNH   @RF00152                                            0152
*             DO J=1 TO VVIALCON-1; /* START SHIFT BIT       @Y30LB26*/
         LA    J,1                                                 0153
         B     @DE00153                                            0153
@DL00153 DS    0H                                                  0154
*               LIBROUT=LIBROUT/2;  /* SHIFT RT ONE          @Y30LB26*/
         SLR   @10,@10                                             0154
         ICM   @10,3,LIBROUT                                       0154
         SRL   @10,1                                               0154
         STCM  @10,3,LIBROUT                                       0154
*             END;                  /*                       @Y30LB26*/
         AL    J,@CF00038                                          0155
@DE00153 SLR   @10,@10                                             0155
         IC    @10,VVIALCON(,VVIPTR)                               0155
         BCTR  @10,0                                               0155
         CR    J,@10                                               0155
         BNH   @DL00153                                            0155
*         END;                      /*                       @Y30LB26*/
@RF00152 DS    0H                                                  0157
*                                                                  0157
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP FIELDS IN WTO MACRO AND MOVE IN MESSAGE    @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0157
*       WTOTEXT=MESGBUF;            /* MESSAGE TEXT          @Y30LB26*/
@RF00149 MVC   WTOTEXT(72),MESGBUF                                 0157
*       WTODESC=MESGDES;            /* DESCRIPTOR CODES      @Y30LB26*/
*                                                                  0158
         LR    @10,I                                               0158
         SLA   @10,2                                               0158
         LA    @07,4                                               0158
         L     @15,@CV00137                                        0158
         ALR   @15,@07                                             0158
         AL    @15,@CF00294                                        0158
         L     @01,MSGTBL(@10,@15)                                 0158
         MVC   WTODESC(2),MESGDES(@01)                             0158
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF ORING ROUTING CODE IS REQUIRED             @Y30LB26*/
*       /* TO SEND THE MESSAGE TO THE OPERATOR               @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0159
*       IF MESGFLG1=ON THEN         /* OPERATOR MESSAGE      @Y30LB26*/
         L     @15,@CV00137                                        0159
         ALR   @15,@07                                             0159
         AL    @15,@CF00294                                        0159
         L     @01,MSGTBL(@10,@15)                                 0159
         TM    MESGFLG1(@01),B'10000000'                           0159
         BNO   @RF00159                                            0159
*         WTOROUT=MESGRTE×LIBROUT;  /* OR ROUTING CODES      @Y30LB26*/
         L     @15,@CV00137                                        0160
         ALR   @15,@07                                             0160
         AL    @15,@CF00294                                        0160
         L     @10,MSGTBL(@10,@15)                                 0160
         MVC   WTOROUT(2),MESGRTE(@10)                             0160
         OC    WTOROUT(2),LIBROUT                                  0160
*       ELSE                        /*                       @Y30LB26*/
*                                                                  0161
*         /***********************************************************/
*         /*                                                         */
*         /* OTHERWISE PUT IN ROUTING FOR LIBRARIAN          @Y30LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0161
*         IF MESGFLG2=ON THEN       /* LIBRARIAN ROUTING     @Y30LB26*/
         B     @RC00159                                            0161
@RF00159 LR    @10,I                                               0161
         SLA   @10,2                                               0161
         L     @07,@CV00137                                        0161
         L     @10,MSGTBL(@10,@07)                                 0161
         TM    MESGFLG2(@10),B'01000000'                           0161
         BNO   @RF00161                                            0161
*           WTOROUT=LIBROUT;        /* LIB ROUTING           @Y30LB26*/
         MVC   WTOROUT(2),LIBROUT                                  0162
*                                                                  0163
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE WRITE TO OPERATOR MACRO IF MESSAGE IS TO BE @Y30LB26*/
*       /* SENT TO THE OPERATOR AND/OR ALTERNATE CONSOLE     @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0163
*       IF WTOROUT^=BITZERO THEN    /*                       @Y30LB26*/
@RF00161 DS    0H                                                  0163
@RC00159 CLC   WTOROUT(2),@CB00154                                 0163
         BE    @RF00163                                            0163
*         DO;                       /*                       @Y30LB26*/
*           RESPECIFY                                              0165
*             REG1 RSTD;            /* RESTRICT REG1         @Y30LB26*/
*           REG1=ADDR(WTO);         /* ADDRESS MSG LIST      @VS32893*/
         LA    REG1,WTO                                            0166
*LWTO1:                                                            0167
*           GEN(WTO   MF=(E,(REG1)));/* WRITE MESSAGE        @Y30LB26*/
LWTO1    WTO   MF=(E,(REG1))
*           RESPECIFY                                              0168
*             REG1 UNRSTD;          /* FREE REG 1            @Y30LB26*/
*         END;                      /*                       @Y30LB26*/
*                                                                  0169
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF MESSAGE IS TO BE JOURNALED, IF             @Y30LB26*/
*       /* REQUIRED GO JOURNAL IT                            @Y30LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0170
*       IF VVIFLG3=ON&MESGFLG2=ON THEN                             0170
@RF00163 TM    VVIFLG3(VVIPTR),B'00010000'                         0170
         BNO   @RF00170                                            0170
         LR    @10,I                                               0170
         SLA   @10,2                                               0170
         L     @07,@CV00137                                        0170
         L     @10,MSGTBL(@10,@07)                                 0170
         TM    MESGFLG2(@10),B'01000000'                           0170
         BNO   @RF00170                                            0170
*         CALL JRNLMSG;             /* GO JOURNAL MESSAGE    @YM04320*/
         BAL   @14,JRNLMSG                                         0171
*     END;                          /*                       @Y30LB26*/
*   RETURN;                         /*                       @Y30LB26*/
         B     @EL00002                                            0173
*   END SENDMSG;                    /*                       @Y30LB26*/
         B     @EL00002                                            0174
*                                                                  0175
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE WILL JOURNAL THE MESSAGE IF FLAG IN MSVC      @Y30LB26*/
*   /* CONTROL BLOCK INDICATES IT SHOULD BE AND              @Y30LB26*/
*   /* THE MESSAGE IS FOR THE LIBRARIAN.                     @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*JRNLMSG:                                                          0175
*   PROC;                           /*                       @Y30LB26*/
*                                                                  0175
JRNLMSG  STM   @14,@12,@SA00003                                    0175
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT ALREADY RESERVED BY TASK                       @ZM30991*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0176
*   IF VVIFLG5=OFF&                 /*                       @ZM31134*/
*       VVIJUCB^=ZERO THEN          /*                       @ZM31134*/
         TM    VVIFLG5(VVIPTR),B'00000100'                         0176
         BNZ   @RF00176                                            0176
         L     @10,VVIJUCB(,VVIPTR)                                0176
         LTR   @10,@10                                             0176
         BZ    @RF00176                                            0176
*     DO;                           /*                       @ZM30991*/
*       VVIFLG5=ON;                 /* INDIC JRNL RSV        @ZA17161*/
         OI    VVIFLG5(VVIPTR),B'00000100'                         0178
*       RESPECIFY                                                  0179
*        (REG1,                                                    0179
*         REG0) RSTD;               /* RESTRICT              @ZM30991*/
*       RESLIST2=RESLIST1;          /* MOVE LIST             @ZM31134*/
         MVC   RESLIST2(16),RESLIST1                               0180
*       RESJUCB=ADDR(VVIJUCB);      /* SET UCB ADDR          @ZM31134*/
         LA    @10,VVIJUCB(,VVIPTR)                                0181
         ST    @10,RESJUCB                                         0181
*       REG1=ADDR(RESLIST2);        /* SET UP REG 1          @ZM31134*/
         LA    REG1,RESLIST2                                       0182
*LRES1:                                                            0183
*       GEN(RESERVE  MF=(E,(REG1)));/* ISSUE RESERVE         @ZM31134*/
LRES1    RESERVE  MF=(E,(REG1))
*       RESPECIFY                                                  0184
*        (REG1,                                                    0184
*         REG0) UNRSTD;             /* FREE REGS             @ZM30991*/
*       DEQSW=ON;                   /* INDICATE DEQ REQD     @ZM30991*/
         OI    DEQSW,B'10000000'                                   0185
*     END;                          /*                       @ZM30991*/
*                                                                  0186
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE BUFFER ADDRESS AND THE RECORD LENGTH IN      @Y30LB26*/
*   /* THE RPLV SO IT CAN BE RESTORED AFTER THE MESSAGE      @Y30LB26*/
*   /* HAS BEEN JOURNALED                                    @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0187
*   RPLBUFSV=RPLVBUF;               /* SAVE BUF PTR          @Y30LB26*/
@RF00176 L     RPLBUFSV,RPLVBUF(,RPLVPTR)                          0187
*   RPLLNSV=RPLVRLN;                /* SAVE RECORD LEN       @Y30LB26*/
*                                                                  0188
         L     RPLLNSV,RPLVRLN(,RPLVPTR)                           0188
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS IN THE RPLV TO JOURNAL MESSAGE      @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0189
*   RPLVVOP=ON;                     /* INDICATE VOP CALL     @Y30LB26*/
         OI    RPLVVOP(RPLVPTR),B'00000100'                        0189
*   RPLVBUF=ADDR(MESGBUF);          /* ADDR MESSAGE          @Y30LB26*/
         LA    @10,MESGBUF                                         0190
         ST    @10,RPLVBUF(,RPLVPTR)                               0190
*   RPLVRLN=SEVENTWO;               /* LENGTH MESSAGE        @Y30LB26*/
*                                                                  0191
         MVC   RPLVRLN(4,RPLVPTR),@CF00163                         0191
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL JOURNAL ROUTINE TO JOURNAL MESSAGE               @Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0192
*   RESPECIFY                                                      0192
*     REG1 RSTD;                    /* RESTRICT              @Y30LB26*/
*   REG1=RPLVPTR;                   /* ADDR RPLV             @Y30LB26*/
         LR    REG1,RPLVPTR                                        0193
*   CALL ICBVJL00;                  /* JOURNAL MESSAGE       @Y30LB26*/
*                                                                  0194
         L     @15,@CV00138                                        0194
         BALR  @14,@15                                             0194
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE JOURNAL DATA SET                                 @Y30LB26*/
*   /* IF RESERVED BY VOP                                    @ZM30991*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*   IF DEQSW=ON THEN                /*                       @ZM30991*/
         TM    DEQSW,B'10000000'                                   0195
         BNO   @RF00195                                            0195
*     DO;                           /*                       @ZM30991*/
*       RESPECIFY                                                  0197
*         REG0 RSTD;                /* RESTRICT              @ZM30991*/
*       RESLIST2=RESLIST1;          /* MOVE LIST             @ZM31134*/
         MVC   RESLIST2(16),RESLIST1                               0198
*       RESJUCB=ADDR(VVIJUCB);      /* SET UCB ADDR          @ZM31134*/
         LA    @10,VVIJUCB(,VVIPTR)                                0199
         ST    @10,RESJUCB                                         0199
*       REG1=ADDR(RESLIST2);        /* SET UP REG 1          @ZM31134*/
         LA    REG1,RESLIST2                                       0200
*LDEQ1:                                                            0201
*       GEN(DEQ  MF=(E,(REG1)));    /* ISSUE RELEASE         @ZM31134*/
LDEQ1    DEQ  MF=(E,(REG1))
*       RESPECIFY                                                  0202
*        (REG1,                                                    0202
*         REG0) UNRSTD;             /* FREE REGS             @ZM30991*/
*       DEQSW=OFF;                  /*                       @ZM30991*/
         NI    DEQSW,B'01111111'                                   0203
*       VVIFLG5=OFF;                /* INDICATE JRNL FREE    @ZA17161*/
         NI    VVIFLG5(VVIPTR),B'11111011'                         0204
*     END;                          /*                       @ZM30991*/
*                                                                  0205
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE BUFFER ADDRESS AND RECORD LENGTH IN RPLV      #Y30LB26*/
*   /* TURN OFF MESSAGE JOURNALING FLAG                      #Y30LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0206
*   RPLVBUF=RPLBUFSV;               /* RESTORE BUF ADDR      @Y30LB26*/
@RF00195 ST    RPLBUFSV,RPLVBUF(,RPLVPTR)                          0206
*   RPLVRLN=RPLLNSV;                /* RESTORE LENGTH        @Y30LB26*/
         ST    RPLLNSV,RPLVRLN(,RPLVPTR)                           0207
*   RPLVVOP=OFF;                    /* SET BACK TO ORIG      @Y30LB26*/
         NI    RPLVVOP(RPLVPTR),B'11111011'                        0208
*   RETURN;                         /*                       @Y30LB26*/
@EL00003 DS    0H                                                  0209
@EF00003 DS    0H                                                  0209
@ER00003 LM    @14,@12,@SA00003                                    0209
         BR    @14                                                 0209
*   END JRNLMSG;                    /*                       @Y30LB26*/
*   END ICBVOP00                    /*                       @Y30LB26*/
*                                                                  0211
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*                                                                  0211
*       ;                                                          0211
@DATA    DS    0H
@SM00295 MVC   MESGBUF(0),MESGSKEL(@03)
@SM00297 MVC   0(0,@10),TEXT1(@03)
@SM00299 MVC   0(0,@10),TEXT2(@03)
@SM00301 MVC   0(0,@10),TEXT3(@03)
@SM00303 MVC   0(0,@10),TEXT4(@03)
@SM00305 MVC   0(0,@10),TEXT5(@03)
@SM00307 MVC   USERRBUF(0,@10),REPLY
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
ICBVOP00 CSECT
         DS    0F
@CF00038 DC    F'1'
@CF00163 DC    F'72'
@CF00157 DC    F'399'
@CF00294 DC    F'-4'
@DATD    DSECT
         DS    0D
WTORECB  DS    F
         DS    0D
@TS00001 DS    CL8
LIBROUT  DS    BL2
DECID    DS    CL4
PRINTID  DS    CL4
MESGBUF  DS    CL72
SWITCHES DS    BL1
         ORG   SWITCHES
DEQSW    DS    BL1
@NM00008 EQU   SWITCHES+0
         ORG   SWITCHES+1
         DS    CL1
RESLIST2 DS    CL16
WTO      DS    CL80
         ORG   WTO
WTOLEN   DS    FL2
WTOMCS   DS    BL2
WTOTEXT  DS    CL72
WTODESC  DS    BL2
WTOROUT  DS    BL2
         ORG   WTO+80
WTOR     DS    CL88
         ORG   WTOR
WTORLENR DS    FL1
WTORADDR DS    AL3
WTORECBA DS    AL4
WTORLEN  DS    FL2
WTORMCS  DS    BL2
WTORTEXT DS    CL72
WTORDESC DS    BL2
WTORROUT DS    BL2
         ORG   WTOR+88
ICBVOP00 CSECT
         DS    0F
@SIZDATD DC    AL1(241)
         DC    AL3(@ENDDATD-@DATD)
@CV00137 DC    V(ICBVMG00)
@CV00138 DC    V(ICBVJL00)
@CV00139 DC    V(ICBVRR00)
         DS    0D
@CB00154 DC    X'0000'
@CB00149 DC    B'1000000000000000'
ORID     DC    X'F0'
QNAME    DC    CL8'SYSZMSVI'
JRNAME   DC    CL8'MSVIJRNL'
VOPPATCH DS    CL200
         ORG   VOPPATCH
@NM00009 DC    200X'00'
         ORG   VOPPATCH+200
ICBVOP00 CSECT
*                                                          /*@ZM31134*/
RESLIST1 RESERVE (QNAME,JRNAME,E,8,SYSTEMS),UCB=RESLIST1,RET=HAVE,MF=L
ICBVOP00 CSECT
*                                                          /*@Y30LB26*/
WTOMSG WTO '12345678901234567890123456789012345678901234567890123456789*
               0123456789012',ROUTCDE=2,DESC=3,MF=L            @Y30LB26
ICBVOP00 CSECT
*                                                          /*@Y30LB26*/
WTORMSG WTOR '123456789012345678901234567890123456789012345678901234567*
               890123456789012',ROUTCDE=2,DESC=3,MF=L          @Y30LB26
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICBVOP00 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RPLLNSV  EQU   @07
RPLBUFSV EQU   @04
J        EQU   @02
I        EQU   @04
MSGPTR   EQU   @02
VVIPTR   EQU   @06
RPLVPTR  EQU   @05
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
RPLV     EQU   0
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLVVOP  EQU   RPLFLAGA
RPLRCODE EQU   RPLV+32
RPLVRETC EQU   RPLV+34
RPLVSAM  EQU   RPLV+56
RPLVBUF  EQU   RPLVSAM+32
RPLVOPT  EQU   RPLVSAM+40
RPLVRLN  EQU   RPLVSAM+48
VVICB    EQU   0
VVIALCON EQU   VVICB+14
VVIFLGA  EQU   VVICB+15
VVIFLG3  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIJUCB  EQU   VVICB+80
TEXT1    EQU   0
TEXT2    EQU   0
TEXT3    EQU   0
TEXT4    EQU   0
TEXT5    EQU   0
LIMITADR EQU   0
MSGLIMIT EQU   0
USERRBUF EQU   0
MSGTABLE EQU   0
MSGTBL   EQU   MSGTABLE
MESGDEF  EQU   0
MESGREA  EQU   MESGDEF
MESGRET  EQU   MESGDEF+2
MESGRTE  EQU   MESGDEF+4
MESGDES  EQU   MESGDEF+6
MESGLEN  EQU   MESGDEF+8
MESGFLG  EQU   MESGDEF+12
MESGFLG1 EQU   MESGFLG
MESGFLG2 EQU   MESGFLG
MESGFLG3 EQU   MESGFLG
MESGLEN1 EQU   MESGDEF+14
MESGLOC1 EQU   MESGDEF+15
MESGLEN2 EQU   MESGDEF+16
MESGLOC2 EQU   MESGDEF+17
MESGLEN3 EQU   MESGDEF+18
MESGLOC3 EQU   MESGDEF+19
MESGLEN4 EQU   MESGDEF+20
MESGLOC4 EQU   MESGDEF+21
MESGLEN5 EQU   MESGDEF+22
MESGLOC5 EQU   MESGDEF+23
MESGSKEL EQU   MESGDEF+24
MSGRQ    EQU   0
MSGID    EQU   MSGRQ
MSGRPLV  EQU   MSGRQ+4
MSGRLEN  EQU   MSGRQ+8
MSGREPLY EQU   MSGRQ+9
MSGLEN1  EQU   MSGRQ+12
MSGTEXT1 EQU   MSGRQ+13
MSGLEN2  EQU   MSGRQ+16
MSGTEXT2 EQU   MSGRQ+17
MSGLEN3  EQU   MSGRQ+20
MSGTEXT3 EQU   MSGRQ+21
MSGLEN4  EQU   MSGRQ+24
MSGTEXT4 EQU   MSGRQ+25
MSGLEN5  EQU   MSGRQ+28
MSGTEXT5 EQU   MSGRQ+29
REPLY    EQU   MESGBUF
RESJUCB  EQU   RESLIST2+12
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
MESGRES  EQU   MESGDEF+13
MESGFILL EQU   MESGFLG
MESGLOC  EQU   MESGDEF+9
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIDVMEL EQU   VVICB+104
VVIVBSTF EQU   VVICB+100
VVISSOBA EQU   VVICB+96
VVIVSCRA EQU   VVICB+92
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIIUCB  EQU   VVICB+76
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIUCB   EQU   VVICB+60
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIQRPL2 EQU   VVICB+44
VVIQRPL1 EQU   VVICB+40
VVIRES3  EQU   VVICB+36
VVIVQMP  EQU   VVICB+32
VVIECB1  EQU   VVICB+28
VVICATAD EQU   VVICB+24
VVIDCBAD EQU   VVICB+20
VVIACBAD EQU   VVICB+16
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIFLG0  EQU   VVIFLGA
VVICPUID EQU   VVICB+12
VVIUCAT  EQU   VVICB+4
VVICID   EQU   VVICB
RPLVUTIL EQU   RPLV+132
RPLVBLN  EQU   RPLVSAM+52
@NM00007 EQU   RPLVSAM+44
RPLVUPD  EQU   RPLVOPT+1
@NM00006 EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
@NM00005 EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
RPLVDIR  EQU   RPLVOPT
RPLVLOC  EQU   RPLVOPT
RPLVKEY  EQU   RPLVSAM+36
@NM00004 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00003 EQU   RPLVSAM+3
RPLVTYP  EQU   RPLVSAM+2
@NM00002 EQU   RPLVSAM
@NM00001 EQU   RPLV+42
RPLVDATE EQU   RPLV+38
RPLRMSCC EQU   RPLV+36
RPLVTLEN EQU   RPLV+30
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLFTIME EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
RPLVQPTR EQU   RPLV
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00144 EQU   @EL00002
@RF00170 EQU   @EL00002
@ENDDATA EQU   *
         END   ICBVOP00,(C'PLS0341',0603,77070)

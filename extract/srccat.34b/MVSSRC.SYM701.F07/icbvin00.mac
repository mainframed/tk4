         TITLE 'ICBVIN00 - MSVC INITIALIZATION MODULE - MVS            *
                        '
ICBVIN00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBVIN00  77.353'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @08,@SA00001                                        0001
         ST    @08,8(,@13)                                         0001
         LR    @13,@08                                             0001
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*                                                                  0372
*/*********************************************************************
* * ICBVIN00 MAINLINE                                        @Y30LB27
* ********************************************************************/
*                                                                  0372
*                                   /*                       @Y30LB27*/
*/*********************************************************************
* * INVOKE INITIALIZATION SEGMENT                            @Y30LB27
* ********************************************************************/
*                                                                  0372
*   CALL VININIT;                   /* CALL INITIALIZATION SEGMENT 0372
*                                                            @ZM31134*/
         BAL   @14,VININIT                                         0372
*/*********************************************************************
* * ICBVIN00 IPL CALL                                        @Y30LB27
* ********************************************************************/
*                                                                  0373
*   IF ININIT=ON THEN                                              0373
         L     @08,INITPTR                                         0373
         TM    ININIT(@08),B'10000000'                             0373
         BNO   @RF00373                                            0373
*     DO;                           /* INITIALIZATION CALL   @Y30LB27
*                                                            @Y30LB27*/
*       VVIFLG0=ON;                 /* FORCE MSVC DISABLE    @Y30LB27*/
*       VVIFLG2=ON;                 /* FORCE JOURNAL DISABLE @Y30LB27
*                                                            @Y30LB27*/
         OI    VVIFLG0(VVIPTR),B'10100000'                         0376
*/*********************************************************************
* * REQUEST PARMLIB CORRECTIONS FROM OPERATOR                @Y30LB27
* ********************************************************************/
*                                                                  0377
*       IF INIVERFY=ON THEN                                        0377
         TM    INIVERFY(@08),B'10000000'                           0377
         BNO   @RF00377                                            0377
*         CALL VINPARMV;            /* OPERATOR VERIFICATION REQD  0378
*                                                            @Y30LB27*/
         BAL   @14,VINPARMV                                        0378
*/*********************************************************************
* *   DO GETMAIN FOR VOLUME TRACKING STORAGE AREA            @ZA27588*
* ********************************************************************/
*                                                                  0379
*       IF VVIVTRK^=C000 THEN       /*                       @ZA27588*/
@RF00377 CLC   VVIVTRK(3,VVIPTR),@CC03662                          0379
         BE    @RF00379                                            0379
*         DO;                       /*                       @ZA27588*/
*           TEMPBIN=ZEROFX31;       /* ZERO OUT WORK AREA    @ZA27588*/
         SLR   @08,@08                                             0381
         ST    @08,TEMPBIN                                         0381
*           PACK(VVIVTRK,VVIVTRK);  /* PACK VOL COUNT        @ZA27588*/
         PACK  VVIVTRK(3,VVIPTR),VVIVTRK(3,VVIPTR)                 0382
*           CVB(TEMPBIN,VVIVTRK);   /* CONVERT TO BINARY     @ZA27588*/
         XC    @TS00001(8),@TS00001                                0383
         MVC   @TS00001+5(3),VVIVTRK(VVIPTR)                       0383
         CVB   @08,@TS00001                                        0383
         ST    @08,TEMPBIN                                         0383
*           REG0=(FOUR+(SIXTY*TEMPBIN));/* DETER SPACE REQ   @ZA27588*/
         MH    @08,@CH00414                                        0384
         AL    @08,@CF00098                                        0384
         LR    REG0,@08                                            0384
*LGETMA:                                                           0385
*           GEN(GETMAIN RC,LV=(0),SP=241);/* GET SUBPOOL 241 @ZA27588*/
LGETMA   GETMAIN RC,LV=(0),SP=241
*           IF REG15=ZERO THEN      /* IS GETMAIN OK         @ZA27588*/
         LTR   REG15,REG15                                         0386
         BNZ   @RF00386                                            0386
*             DO;                   /* YES                   @ZA27588*/
*               ICBVOLST=REG1;      /* SAVE PTR TO AREA      @ZA27588*/
         L     @08,CVTPTR                                          0388
         L     @08,CVTEXT2(,@08)                                   0388
         L     @08,CVTICB(,@08)                                    0388
         ST    REG1,ICBVOLST(,@08)                                 0388
*               ICBVLCNT=TEMPBIN;   /* SAVE COUNT            @ZA27588*/
         L     @08,CVTPTR                                          0389
         L     @08,CVTEXT2(,@08)                                   0389
         L     @08,CVTICB(,@08)                                    0389
         L     @08,ICBVOLST(,@08)                                  0389
         L     @05,TEMPBIN                                         0389
         ST    @05,ICBVLCNT(,@08)                                  0389
*               DO I=ONE TO ICBVLCNT;/* ZERO OUT AREA        @ZA27588*/
         LA    I,1                                                 0390
         B     @DE00390                                            0390
@DL00390 DS    0H                                                  0391
*                 ICBVLENT(I)=ICBVLENT(I)&&ICBVLENT(I);/*    @ZA27588*/
         LR    @05,I                                               0391
         MH    @05,@CH00414                                        0391
         L     @04,CVTPTR                                          0391
         L     @04,CVTEXT2(,@04)                                   0391
         L     @04,CVTICB(,@04)                                    0391
         L     @04,ICBVOLST(,@04)                                  0391
         ALR   @04,@05                                             0391
         AL    @04,@CF03966                                        0391
         XC    ICBVLENT-4(60,@04),ICBVLENT-4(@04)                  0391
*               END;                                               0392
         AL    I,@CF00055                                          0392
@DE00390 L     @05,CVTPTR                                          0392
         L     @05,CVTEXT2(,@05)                                   0392
         L     @05,CVTICB(,@05)                                    0392
         L     @05,ICBVOLST(,@05)                                  0392
         C     I,ICBVLCNT(,@05)                                    0392
         BNH   @DL00390                                            0392
*             END;                  /*                       @ZA27588*/
*           ELSE                    /* GETMAIN UNSUCCESSFUL  @ZA27588*/
*             DO;                   /*                       @ZA27588*/
         B     @RC00386                                            0394
@RF00386 DS    0H                                                  0395
*               VINMSGID=MSGTRK;    /* SET UP NO SPACE MSG   @ZA27588*/
         MVC   VINMSGID(2),@CH00237                                0395
*               CALL VINWTO;        /* WRITE MSG FROM VMG00  @ZA27588*/
         BAL   @14,VINWTO                                          0396
*             END;                  /*                       @ZA27588*/
*         END;                      /*                       @ZA27588*/
@RC00386 DS    0H                                                  0399
*/*********************************************************************
* * IF LIBRARIAN MSGS ARE TO BE JOURNALLED SAVE FLAG UNTIL   @ZM31134
* * VJL IS INITIALIZED                                       @Y30LB27
* ********************************************************************/
*                                                                  0399
*       IF VVIFLG3=ON THEN          /* LIB MSGS JOURNALED    @Y30LB27*/
@RF00379 TM    VVIFLG3(VVIPTR),B'00010000'                         0399
         BNO   @RF00399                                            0399
*         DO;                       /* YES                   @Y30LB27*/
*           VVIFLG3=OFF;            /* TURN JORUNALLING SWITCH OFF   */
         NI    VVIFLG3(VVIPTR),B'11101111'                         0401
*           JRNLSW3=ON;             /* REMBER IT FOR LATER   @ZA17167*/
         OI    JRNLSW3,B'10000000'                                 0402
*         END;                      /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * INITIALIZE INVENTORY AND JOURNAL DATA SETS               @Y30LB27
* ********************************************************************/
*                                                                  0404
*       IF RPLVRETC=ZERO THEN       /* JOURNAL INIT OKAY     @Y30LB27*/
@RF00399 LH    @08,RPLVRETC(,RPLVPTR)                              0404
         N     @08,@CF03969                                        0404
         LTR   @08,@08                                             0404
         BNZ   @RF00404                                            0404
*         CALL VININDS;             /* INITIALIZE MSVC DATA SETS   0405
*                                                            @Y30LB27
*                                                            @YM04327*/
         BAL   @14,VININDS                                         0405
*/*********************************************************************
* * IF FIRST MSS IPL AFTER SYSGEN WRITE CONTROL RECORDS     @Y30LB27
* ********************************************************************/
*                                                                  0406
*       IF RPLVRETC=ZERO THEN       /* OKAY SO FAR           @YM04327*/
@RF00404 LH    @08,RPLVRETC(,RPLVPTR)                              0406
         N     @08,@CF03969                                        0406
         LTR   @08,@08                                             0406
         BNZ   @RF00406                                            0406
*         IF AMBCREAT=ON THEN       /* INIT RECORDS REQD     @YM04327*/
         L     @08,VVIACBAD(,VVIPTR)                               0407
         L     @08,ACBAMBL(,@08)                                   0407
         L     @08,AMBLDTA(,@08)                                   0407
         TM    AMBCREAT(@08),B'10000000'                           0407
         BNO   @RF00407                                            0407
*           CALL VINCRTDS;          /* FIRST MSS IPL AFTER SYSGEN  0408
*                                                            @YM04327*/
         BAL   @14,VINCRTDS                                        0408
*         ELSE                      /*                       @ZA05115*/
*           CALL UPDTRCDS;          /* NOT FIRST IPL AFTER SYSGEN  0409
*                                                            @ZA05115*/
         B     @RC00407                                            0409
@RF00407 BAL   @14,UPDTRCDS                                        0409
*/*********************************************************************
* * INVOKE MODULES REQUIRING INITIALIZATION CALL AT IPL      @Y30LB27
* * VRR WAS ALREADY INITIALIZED ON RESERVE FOR INVENTORY     @Y30LB27
* ********************************************************************/
*                                                                  0410
*       IF RPLVRETC=ZERO THEN       /* OKAY SO FAR           @Y30LB27*/
@RC00407 DS    0H                                                  0410
@RF00406 LH    @08,RPLVRETC(,RPLVPTR)                              0410
         N     @08,@CF03969                                        0410
         LTR   @08,@08                                             0410
         BNZ   @RF00410                                            0410
*         DO;                       /* YES                   @Y30LB27*/
*           REG1=RPLVPTR;           /* SET RPLV PTR FOR CALL @Y30LB27*/
         LR    REG1,RPLVPTR                                        0412
*           CALL ICBVJL00;          /* INVOKE JOURNAL PROCESSOR    0413
*                                                            @Y30LB27*/
         L     @15,@CV03333                                        0413
         BALR  @14,@15                                             0413
*           IF RPLVRETC^=ZERO THEN  /* GOOD RETURN           @ZA05115*/
         LH    @08,RPLVRETC(,RPLVPTR)                              0414
         N     @08,@CF03969                                        0414
         LTR   @08,@08                                             0414
         BZ    @RF00414                                            0414
*             DO;                   /* NO                    @ZA05115*/
*               VINMSGID=MSGVJLE;   /* SET MSGID             @ZA05115*/
         MVC   VINMSGID(2),@CH00230                                0416
*               CNVRTWK1(ONE:TWO)=RPLRCODE;/* CONVERT THE    @ZA05115*/
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       0417
*               CALL VINCNVRT;      /* CODE                  @ZA05115*/
         BAL   @14,VINCNVRT                                        0418
*               CALL VINWTO;        /* WRITE THE MSG         @ZA05115*/
         BAL   @14,VINWTO                                          0419
*             END;                  /*                       @ZA05115*/
*         END;                      /*                       #Y30LB27
*                                                            #Y30LB27*/
@RF00414 DS    0H                                                  0422
*       IF VVIFLG5=ON THEN          /* RESERVED              @ZA05115*/
@RF00410 TM    VVIFLG5(VVIPTR),B'00000100'                         0422
         BNO   @RF00422                                            0422
*         CALL JRNLDEQ;             /* DEQUEUE THE JOURNAL   @ZA05115*/
         BAL   @14,JRNLDEQ                                         0423
*/*********************************************************************
* * IF VJL INITIALIZED REST JRNL FLAG SWITCH                 #Y30LB27
* ********************************************************************/
*                                                                  0424
*       IF RPLVRETC=ZERO THEN       /* LIB MSGS JOURNALED    @ZA17167*/
@RF00422 LH    @08,RPLVRETC(,RPLVPTR)                              0424
         N     @08,@CF03969                                        0424
         LTR   @08,@08                                             0424
         BNZ   @RF00424                                            0424
*         VVIFLG2=OFF;              /* TURN JOURNALLING SWITCH OFF 0425
*                                                            @Y30LB27*/
         NI    VVIFLG2(VVIPTR),B'11011111'                         0425
*/*********************************************************************
* * UPDATE INV WITH CURRENT IPL ACTIVITY AND MOUNT STATUS    @ZM31134
* ********************************************************************/
*                                                                  0426
*       IF RPLVRETC=ZERO THEN                                      0426
@RF00424 LH    @08,RPLVRETC(,RPLVPTR)                              0426
         N     @08,@CF03969                                        0426
         LTR   @08,@08                                             0426
         BNZ   @RF00426                                            0426
*         CALL VINTBUPT;            /* UPDATE INV IF OKAY    @Y30LB27*/
         BAL   @14,VINTBUPT                                        0427
*       ELSE                                                       0428
*         CALL VINUCBTB;            /* IF NOT BUILD UCB TABLE      0428
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         B     @RC00426                                            0428
@RF00426 BAL   @14,VINUCBTB                                        0428
*/*********************************************************************
* * RESET JRNL FLAG SWITCH - WHETHER OR NOT VJL INIT         @Y30LB27
* ********************************************************************/
*                                                                  0429
*       IF JRNLSW3=ON THEN          /* LIB MSGS JOURNALED    @ZA17167*/
@RC00426 TM    JRNLSW3,B'10000000'                                 0429
         BNO   @RF00429                                            0429
*         VVIFLG3=ON;               /* TURN JOURNALLING SWITCH OFF   */
         OI    VVIFLG3(VVIPTR),B'00010000'                         0430
*/*********************************************************************
* * IF ZERO RPLVRETC THEN INDICATE MSVC ENABLED              @ZM31134
* ********************************************************************/
*                                                                  0431
*       IF RPLVRETC=ZERO THEN       /* ZERO RETURN CODES SO FAR    0431
*                                                            @ZM30746*/
@RF00429 LH    @08,RPLVRETC(,RPLVPTR)                              0431
         N     @08,@CF03969                                        0431
         LTR   @08,@08                                             0431
         BNZ   @RF00431                                            0431
*         DO;                       /* YES - INDICATE MSVC ENABLED 0432
*                                                            @ZM30746
*                                                            @ZM30746*/
*           VVIFLG0=OFF;            /* ENABLE MSVC           @ZM30746*/
*           VVIFLG2=OFF;            /* ENABLE FOR JOURNAL PROCESSING
*                                                            @ZM30746*/
         NI    VVIFLG0(VVIPTR),B'01011111'                         0434
*         END;                      /*                       @ZM30746
*                                                            #Y30LB27*/
*       IF VVIACBAD^=ZERO&ACBOPEN=ON THEN/* ACB OPEN         @ZM31134*/
@RF00431 L     @08,VVIACBAD(,VVIPTR)                               0436
         LTR   @08,@08                                             0436
         BZ    @RF00436                                            0436
         TM    ACBOPEN(@08),B'00010000'                            0436
         BNO   @RF00436                                            0436
*         DO;                       /* YES                   @ZM31134
*                                                            #Y30LB27*/
*/*********************************************************************
* * ISSUE ENDREC FOR DATA SET                                #Y30LB27
* ********************************************************************/
*                                                                  0438
*           RPLVTYP=RPLVENDR;       /* INDICATE ENDREC       #Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'04'                              0438
*           REG1=RPLVPTR;           /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        0439
*           CALL ICBVIO00;          /* CALL ICBVIN00 FOR ENDREC    0440
*                                                            #Y30LB27*/
         L     @15,@CV03332                                        0440
         BALR  @14,@15                                             0440
*           RPLVSAM=''B;            /* CLEAR VSAM RPL        #Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                0441
*         END;                      /*                       @ZM31134*/
*/*********************************************************************
* * DEQ - RELEASE THE DATA SET - INVENTORY                   #Y30LB27
* ********************************************************************/
*                                                                  0443
*                                   /*                       #Y30LB27*/
*       IF VVIFLG4=ON THEN          /* RESERVED              @ZA05115*/
@RF00436 TM    VVIFLG4(VVIPTR),B'00001000'                         0443
         BNO   @RF00443                                            0443
*         CALL INVDEQ;              /* DEQUEUE THE INVENTORY @ZA05115*/
         BAL   @14,INVDEQ                                          0444
*     END;                          /*                       #Y30LB27
*                                                            #Y30LB27*/
@RF00443 DS    0H                                                  0446
*/*********************************************************************
* * ENABLE CALL - FORMALLY A SEPARATE ENTRY POINT            #Y30LB27
* ********************************************************************/
*                                                                  0446
*   IF INIENABL=ON THEN             /* ENABLE CALL           #Y30LB27*/
@RF00373 L     @08,INITPTR                                         0446
         TM    INIENABL(@08),B'01000000'                           0446
         BNO   @RF00446                                            0446
*     CALL ICBVEN00;                /*                       #Y30LB27
*                                                            #Y30LB27*/
         BAL   @14,ICBVEN00                                        0447
*/*********************************************************************
* * DISABLE CALL - FORMALLY A SEPARATE ENTRY POINT           #Y30LB27
* ********************************************************************/
*                                                                  0448
*   IF INIDISAB=ON THEN                                            0448
@RF00446 L     @08,INITPTR                                         0448
         TM    INIDISAB(@08),B'00100000'                           0448
         BNO   @RF00448                                            0448
*     CALL ICBVDS00;                /* INVOKE DISABLE SEG    #Y30LB27
*                                                            #Y30LB27*/
         BAL   @14,ICBVDS00                                        0449
*/*********************************************************************
* * CALL TERMINATION SEGMENT                                 #Y30LB27
* ********************************************************************/
*                                                                  0450
*   CALL VINTERM;                   /* CALL TERMINATION SEGMENT      */
@RF00448 BAL   @14,VINTERM                                         0450
*   RETURN;                         /* RETURN TO CALLER      #Y30LB27*/
@EL00001 L     @13,4(,@13)                                         0451
@EF00001 DS    0H                                                  0451
@ER00001 LM    @14,@12,12(@13)                                     0451
         BR    @14                                                 0451
*                                                                  0452
*/* *******************************************************************
**                                                           @ZM31138
**   VININIT: INITIALIZATION SEGMENT                         @ZM31138
**                                                           @ZM31138
**   INPUT:                                                  @ZM31138
**        NONE                                               @ZM31138
**                                                           @ZM31138
**   PROCESS:                                                @ZM31138
**       ESTABLISH ADDR, CLEAR REQUIRED AREAS, ESTABLISH     @ZM31134
**       ESTAE, AND REPLACE MSVC INTERFACE FROM VPI TO VQM   @ZM31138
**                                                           @ZM31138
**   OUTPUT:                                                 @ZM31138
**        AS INDICATED UNDER PROCESS                         @ZM31138
**                                                           @ZM31138
*******************************************************************  */
*                                                                  0452
*VININIT:                                                          0452
*   PROC OPTIONS(SAVE(14));         /*                       #Y30LB27
*                                                            #Y30LB27*/
VININIT  ST    @14,@SA00002                                        0452
*/*********************************************************************
* * INITIALIZATION SEGMENT                                   #Y30LB27
* ********************************************************************/
*                                                                  0453
*                                   /*                       #Y30LB27*/
*/*********************************************************************
* * ESTABLISH ADDR TO THE RPL                                #Y30LB27
* ********************************************************************/
*                                                                  0453
*   RPLVPTR=REG1;                   /* BASE MSVC RPLV        #Y30LB27*/
         LR    RPLVPTR,REG1                                        0453
*   INITPTR=ADDR(RPLVUTIL);         /* GET INIT RPLV         @ZM31134
*                                                            @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              0454
         ST    @08,INITPTR                                         0454
*/*********************************************************************
* * CLEAR RETURN AND REASON CODES                            @Y30LB27
* ********************************************************************/
*                                                                  0455
*   RPLRCODE=ZERO;                  /* CLEAR REASON CODE     @Y30LB27*/
         SLR   @05,@05                                             0455
         STH   @05,RPLRCODE(,RPLVPTR)                              0455
*   RPLVRETC=ZERO;                  /* CLEAR RETURN CODE     @Y30LB27
*                                                            @Y30LB27*/
         STH   @05,RPLVRETC(,RPLVPTR)                              0456
*/*********************************************************************
* * CLEAR MISC PTRS                                          @Y30LB27
* ********************************************************************/
*                                                                  0457
*   GROUPPTR=ZERO;                  /* CLEAR RECORD BUFFER PTR       */
         ST    @05,GROUPPTR                                        0457
*   SWITCH=OFF;                     /*                       @Y30LB27
*                                                            @Y30LB27*/
         MVI   SWITCH+1,X'00'                                      0458
         MVI   SWITCH,B'00000000'                                  0458
*/*********************************************************************
* * EST MESSAGE RPL                                          @Y30LB27
* ********************************************************************/
*                                                                  0459
*   MSGRQ=''B;                      /* CLEAR MSG REQ PARM LIST     0459
*                                                            @Y30LB27*/
         XC    MSGRQ(32),MSGRQ                                     0459
*   MSGRPLV=RPLVPTR;                /* SET MSVC RPLV PTR IN MSG REQ
*                                      RPL                   @Y30LB27
*                                                            @Y30LB27*/
         ST    RPLVPTR,MSGRPLV                                     0460
*/*********************************************************************
* * EST ADDR FOR VVICB                                       @Y30LB27
* ********************************************************************/
*                                                                  0461
*   VVIPTR=ICBVVICB;                /* SET CONTROL BLOC PTR  @Y30LB27*/
         L     @05,CVTPTR                                          0461
         L     @05,CVTEXT2(,@05)                                   0461
         L     @05,CVTICB(,@05)                                    0461
         L     VVIPTR,ICBVVICB(,@05)                               0461
*   IF ININIT=ON THEN               /* INIT CALL             @ZM31134*/
         TM    ININIT(@08),B'10000000'                             0462
         BNO   @RF00462                                            0462
*     DO;                           /* YES                   @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * INIT FOR IPL CALL ONLY                                   @Y30LB27
* ********************************************************************/
*                                                                  0464
*       ICBVVIC=VVIVQMP;            /* SET USER TASK CONTROLLER IN 0464
*                                      MSSC CONTROL BLOCK    @Y30LB27*/
         L     @08,VVIVQMP(,VVIPTR)                                0464
         ST    @08,ICBVVIC(,@05)                                   0464
*       VVIUCB=REG12;               /* SAVE BASE REG FOR DEBUG     0465
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         ST    REG12,VVIUCB(,VVIPTR)                               0465
*/*********************************************************************
* * EST ESTAE ENVIRONMENT FOR MSVC TASK                      @Y30LB27
* ********************************************************************/
*                                                                  0466
*       ESTAESTG=ESTAELST;          /* GET ESTAE PARM LIST   @Y30LB27*/
         MVC   ESTAESTG(16),ESTAELST                               0466
*       REG1=ADDR(ESTAESTG);        /* GET ADDR TO PARM LIST @Y30LB27*/
         LA    REG1,ESTAESTG                                       0467
*       REG14=ADDR(ICBVPR00);       /* GET ADDR TO RECOVERY RTN    0468
*                                                            @Y30LB27*/
         L     REG14,@CV03330                                      0468
*LESTAE1:                                                          0469
*       GEN REFS(REG14,REG1);                                      0469
LESTAE1  DS    0H                                                  0469
*                                   /* ISSUE ESTAE           @Y30LB27*/
         ESTAE   (14),RECORD=YES,XCTL=YES,MF=(E,(1))           @Y30LB27
*       IF REG15^=ZERO THEN                                        0470
         LTR   REG15,REG15                                         0470
         BZ    @RF00470                                            0470
*         DO;                       /* ESTABLISHED           @Y30LB27*/
*           CNVRTWK1(ONE:TWO)=REG15;/* CONVERT RTN CODE      @Y30LB27*/
         STCM  REG15,3,CNVRTWK1                                    0472
*           CALL VINCNVRT;          /* CONVERT TO EBCDIC     @ZM31134*/
         BAL   @14,VINCNVRT                                        0473
*           VINMSGID=MSGESTE;       /* INDICATE ESTAE ERROR  @Y30LB27*/
         MVC   VINMSGID(2),@CH00055                                0474
*           CALL VINWTO;            /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          0475
*           RETURN;                 /* RETURN TO CALLER      @Y30LB27*/
@EL00002 DS    0H                                                  0476
@EF00002 DS    0H                                                  0476
@ER00002 L     @14,@SA00002                                        0476
         BR    @14                                                 0476
*         END;                      /*                       @Y30LB27*/
*     END;                          /*                       @Y30LB27*/
*   END VININIT;                    /*                       @Y30LB27*/
         B     @EL00002                                            0479
*                                                                  0480
*/* *******************************************************************
**                                                           @Y30LB27
**   VINPARMV: PARMLIB CORRECTIONS SOLICITED FROM            @ZM31134
**                      THE OPERTOR                          @ZM31134
**                                                           @Y30LB27
**   INPUT:                                                  @Y30LB27
**        NONE                                               @Y30LB27
**                                                           @Y30LB27
**   PROCESS:                                                @Y30LB27
**       ALL PARMLIB KEYWORDS ARE EXTRACTED AND OPERATOR IS  @Y30LB27
**       REQUESTED TO VALIDATE THE KEYWORDS                  @Y30LB27
**                                                           @Y30LB27
**   OUTPUT:                                                 @Y30LB27
**        MESSAGE TO OPERATOR                                @Y30LB27
**        REQUIRED CONTROL BLOCKS ARE UPDATED                @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  0480
*VINPARMV:                                                         0480
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27*/
VINPARMV ST    @14,@SA00003                                        0480
*   IF ININIT=ON&INIVCODE^=ZERO THEN/* IPL CALL              @Y30LB27*/
         L     @08,INITPTR                                         0481
         TM    ININIT(@08),B'10000000'                             0481
         BNO   @RF00481                                            0481
         CLI   INIVCODE(@08),0                                     0481
         BE    @RF00481                                            0481
*     DO;                           /* YES                   @Y30LB27*/
*       VINMSGID=MSGMVIE;           /* SET MSG INDEX         @Y30LB27*/
         MVC   VINMSGID(2),@CH00066                                0483
*       CNVRTWK1(ONE)=''B;          /* ERROR CODE IS 1 BYTE  @Y30LB27*/
         MVI   CNVRTWK1,X'00'                                      0484
*       CNVRTWK1(TWO)=INIVCODE;     /* CONVERT CODE          @Y30LB27*/
         MVC   CNVRTWK1+1(1),INIVCODE(@08)                         0485
*       CALL VINCNVRT;              /* AND INSERT INTO MSG   @Y30LB27*/
         BAL   @14,VINCNVRT                                        0486
*       CALL VINWTO;                /* ISSUE THE ERROR MSG   @Y30LB27*/
         BAL   @14,VINWTO                                          0487
*       RETRYSW=ON;                 /* FORCE FIRST READ      @Y30LB27*/
         OI    RETRYSW,B'10000000'                                 0488
*       IF JRNLSW3=ON THEN          /*                       @ZA17167*/
         TM    JRNLSW3,B'10000000'                                 0489
         BNO   @RF00489                                            0489
*         VVIFLG3=ON;               /* LIB MSGS JRNLED       @ZA17167*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         0490
*     END;                          /* END IPL CALL          @Y30LB27*/
@RF00489 DS    0H                                                  0492
*/*********************************************************************
* * LOOP UNTIL NO INVALID PARAMETER IS ENCOUNTERED           @Y30LB27
* ********************************************************************/
*                                                                  0492
*   DO WHILE(RETRYSW=ON);           /* SCAN UNTIL OPER RESPONSE    0492
*                                      COMPLETE              @Y30LB27*/
@RF00481 B     @DE00492                                            0492
@DL00492 DS    0H                                                  0493
*     RETRYSW=OFF;                  /* FORCE FIRST READ      @Y30LB27
*                                                            @Y30LB27*/
         NI    RETRYSW,B'01111111'                                 0493
*/*********************************************************************
* * CONSTRUCT THE MESSAGE                                    @Y30LB27
* ********************************************************************/
*                                                                  0494
*                                   /*                       @Y30LB27*/
*/*********************************************************************
* * USER CATALOG                                             @Y30LB27
* ********************************************************************/
*                                                                  0494
*     DO UCATLEN=ONE TO EIGHT WHILE(VVIUCAT(UCATLEN)^=BLANK);/*    0494
*                                                            @Y30LB27*/
         LA    @08,1                                               0494
         STH   @08,UCATLEN                                         0494
@DL00494 LH    @08,UCATLEN                                         0494
         ALR   @08,VVIPTR                                          0494
         CLI   VVIUCAT-1(@08),C' '                                 0494
         BE    @DC00494                                            0494
*     END;                          /*                       @Y30LB27*/
         LA    @08,1                                               0495
         AH    @08,UCATLEN                                         0495
         STH   @08,UCATLEN                                         0495
         C     @08,@CF00039                                        0495
         BNH   @DL00494                                            0495
@DC00494 DS    0H                                                  0496
*     UCATLEN=UCATLEN-ONE;          /* SCAN TO BLANK         @Y30LB27*/
         LH    @03,UCATLEN                                         0496
         BCTR  @03,0                                               0496
         STH   @03,UCATLEN                                         0496
*     I=UCATLEN;                    /* SET INDEX             @Y30LB27*/
         LH    I,UCATLEN                                           0497
*     SCANPTR=ADDR(MSGBUF);         /* SET PTR MSG BUFFER    @Y30LB27*/
         LA    SCANPTR,MSGBUF                                      0498
*     MSGBUF='';                    /* CLEAR MSG BUFFER      @Y30LB27
*                                                            @Y30LB27*/
         MVI   MSGBUF,C' '                                         0499
         MVC   MSGBUF+1(59),MSGBUF                                 0499
*/*********************************************************************
* * SET USER CATALOG KEYWORD, VALUE, AND DELIMITER           @Y30LB27
* ********************************************************************/
*                                                                  0500
*     SCANCHAR(ONE:LENGTH(CUCAT))=CUCAT;/* SET USER CATALOG KEYWORD
*                                                            @Y30LB27*/
         MVC   SCANCHAR(8,SCANPTR),CUCAT                           0500
*     SCANPTR=SCANPTR+LENGTH(CUCAT);/* UPDATE BUFFER PTR     @Y30LB27*/
         AL    SCANPTR,@CF00039                                    0501
*     SCANCHAR(ONE:I)=VVIUCAT;      /* SET KEYWORD VALUE     @Y30LB27*/
         LR    @03,I                                               0502
         BCTR  @03,0                                               0502
         EX    @03,@SM03973                                        0502
*     SCANPTR=SCANPTR+I;            /* UPDATE SCAN POINTER   @Y30LB27*/
         ALR   SCANPTR,I                                           0503
*     SCANCHAR(ONE)=COMMA;          /* SET DELIMTER          @Y30LB27*/
         MVI   SCANCHAR(SCANPTR),C','                              0504
*     SCANPTR=SCANPTR+ONE;          /* UPDATE SCAN POINTER   @Y30LB27
*                                                            @Y30LB27*/
         LA    @08,1                                               0505
         ALR   SCANPTR,@08                                         0505
*/*********************************************************************
* * SET MSSCSAMP KEYWORD, VALUE, AND DELIMITER                @Y30LB27
* ********************************************************************/
*                                                                  0506
*     SCANCHAR(ONE:LENGTH(CSSCSAMP))=CSSCSAMP;/* SET SAMP KEYWORD  0506
*                                                            @Y30LB27*/
         MVC   SCANCHAR(9,SCANPTR),CSSCSAMP                        0506
*     SCANPTR=SCANPTR+LENGTH(CSSCSAMP);/* SET PTR FOR DELIMTER     0507
*                                                            @Y30LB27*/
         AL    SCANPTR,@CF00035                                    0507
*     SCANCHAR(ONE:LENGTH(ICBSAMP))=ICBSAMP;/* PICK KEYWORD VALUE  0508
*                                                            @Y30LB27*/
         L     @03,CVTPTR                                          0508
         L     @03,CVTEXT2(,@03)                                   0508
         L     @03,CVTICB(,@03)                                    0508
         MVC   SCANCHAR(2,SCANPTR),ICBSAMP(@03)                    0508
*     SCANPTR=SCANPTR+LENGTH(ICBSAMP);/* UPDATE BUFFER PTR   @Y30LB27*/
         AL    SCANPTR,@CF00066                                    0509
*     SCANCHAR(ONE)=COMMA;          /* SET DELIMITER         @Y30LB27*/
         MVI   SCANCHAR(SCANPTR),C','                              0510
*     SCANPTR=SCANPTR+ONE;          /* SET PTR FOR DELIMTER  @Y30LB27
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         ALR   SCANPTR,@08                                         0511
*/*********************************************************************
* * SET MSFMSG KEYWORD, VALUE, AND DELIMITER                 @Y30LB27
* ********************************************************************/
*                                                                  0512
*     SCANCHAR(ONE:LENGTH(CMSFMSG))=CMSFMSG;/* LIBRARAIN MSG @Y30LB27*/
         MVC   SCANCHAR(7,SCANPTR),CMSFMSG                         0512
*     SCANPTR=SCANPTR+LENGTH(CMSFMSG);/* SET BUUFER PTR      @Y30LB27*/
         AL    SCANPTR,@CF00310                                    0513
*     IF VVIALCON^=ZERO&VVIFLG3=ON THEN                            0514
         CLI   VVIALCON(VVIPTR),0                                  0514
         BE    @RF00514                                            0514
         TM    VVIFLG3(VVIPTR),B'00010000'                         0514
         BNO   @RF00514                                            0514
*       DO;                         /* IF BOTH VALUES ADD DELIMTER 0515
*                                                            @Y30LB27*/
*         SCANCHAR(ONE)=LFTPAREN;   /* SET LEFT PAREN        @Y30LB27*/
         MVI   SCANCHAR(SCANPTR),C'('                              0516
*         SCANPTR=SCANPTR+ONE;      /* SET BUFFER PTR        @Y30LB27*/
         ALR   SCANPTR,@08                                         0517
*       END;                        /*                       @Y30LB27*/
*     IF VVIALCON^=ZERO THEN                                       0519
@RF00514 CLI   VVIALCON(VVIPTR),0                                  0519
         BE    @RF00519                                            0519
*       DO;                         /* ALT CONSOLE IN CONTROL BLOCK
*                                                            @Y30LB27*/
*         FIXED8=VVIALCON;          /* BUFFER FOR CONVRT     @Y30LB27*/
         SLR   FIXED8,FIXED8                                       0521
         IC    FIXED8,VVIALCON(,VVIPTR)                            0521
*         CVD(FIXED8,WORK1);        /* CONVRT TO DECIMAL     @Y30LB27*/
         CVD   FIXED8,@TS00001                                     0522
         MVC   WORK1(2),@TS00001+6                                 0522
*         UNPK(SCANCHAR(1:2),WORK1);/* UNPACK                @Y30LB27*/
         UNPK  SCANCHAR(2,SCANPTR),WORK1(2)                        0523
*         SCANCHAR(2)=SCANCHAR(2)×C0;/* FIX SIGN             @Y30LB27*/
         OI    SCANCHAR+1(SCANPTR),C'0'                            0524
*         SCANPTR=SCANPTR+TWO;      /* UPDATE BUFFER PTR     @Y30LB27*/
         AL    SCANPTR,@CF00066                                    0525
*       END;                        /*                       @Y30LB27*/
*     IF VVIFLG3=ON THEN            /* JOURNALLING ALSO      @Y30LB27*/
@RF00519 TM    VVIFLG3(VVIPTR),B'00010000'                         0527
         BNO   @RF00527                                            0527
*       DO;                         /*                       @Y30LB27*/
*         IF VVIALCON^=ZERO THEN                                   0529
         CLI   VVIALCON(VVIPTR),0                                  0529
         BE    @RF00529                                            0529
*           DO;                     /* TWO VALUES            @Y30LB27*/
*             SCANCHAR(ONE)=COMMA;  /* SET DELIMITER         @Y30LB27*/
         MVI   SCANCHAR(SCANPTR),C','                              0531
*             SCANPTR=SCANPTR+ONE;  /* SET BUFFER PTR        @Y30LB27*/
         AL    SCANPTR,@CF00055                                    0532
*           END;                    /*                       @Y30LB27*/
*         SCANCHAR(1:LENGTH(CJOURNAL))=CJOURNAL;/* SET KEYWORD     0534
*                                                            @Y30LB27*/
@RF00529 MVC   SCANCHAR(7,SCANPTR),CJOURNAL                        0534
*         SCANPTR=SCANPTR+LENGTH(CJOURNAL);/* UPDATE BUFFER PTR      */
         AL    SCANPTR,@CF00310                                    0535
*         IF VVIFLG3=ON&VVIALCON^=ZERO THEN/* 2 VALUES       @Y30LB27*/
         TM    VVIFLG3(VVIPTR),B'00010000'                         0536
         BNO   @RF00536                                            0536
         CLI   VVIALCON(VVIPTR),0                                  0536
         BE    @RF00536                                            0536
*           DO;                     /*                       @ZA27588*/
*             SCANCHAR(ONE)=RGTPAREN;/* SET DELIMITER        @Y30LB27*/
         MVI   SCANCHAR(SCANPTR),C')'                              0538
*             SCANPTR=SCANPTR+ONE;  /* SET PRT FOR DELIM     @ZA27588*/
         AL    SCANPTR,@CF00055                                    0539
*           END;                    /*                       @ZA27588*/
*       END;                        /*                       @Y30LB27
*                                                            @Y30LB27*/
@RF00536 DS    0H                                                  0542
*/* SET TRKVOLS KEYWORD, VALUE AND DELIMETER                 @ZA27588*/
*                                                                  0542
*     IF ININIT=ON THEN             /* IS THIS INITIALIZAT   @ZA27588*/
@RF00527 L     @08,INITPTR                                         0542
         TM    ININIT(@08),B'10000000'                             0542
         BNO   @RF00542                                            0542
*       DO;                         /* YES                   @ZA27588*/
*         SCANCHAR(ONE)=COMMA;      /* SET DELIMETER         @ZA27588*/
         MVI   SCANCHAR(SCANPTR),C','                              0544
*         SCANPTR=SCANPTR+ONE;      /* SET PRT FOR DELIM     @ZA27588*/
         AL    SCANPTR,@CF00055                                    0545
*         SCANCHAR(ONE:LENGTH(CTRKVOLS))=CTRKVOLS;/* TRK PARM      0546
*                                                            @ZA27588*/
         MVC   SCANCHAR(8,SCANPTR),CTRKVOLS                        0546
*         SCANPTR=SCANPTR+LENGTH(CTRKVOLS);/* MOVE PTR       @ZA27588*/
         AL    SCANPTR,@CF00039                                    0547
*         SCANCHAR(ONE:LENGTH(VVIVTRK))=VVIVTRK;/* SAVE VALUE      0548
*                                                            @ZA27588*/
         MVC   SCANCHAR(3,SCANPTR),VVIVTRK(VVIPTR)                 0548
*       END;                        /*                       @ZA27588*/
*/*********************************************************************
* * SET RPLV FOR MESSAGE ICB420I                             @Y30LB27
* ********************************************************************/
*                                                                  0550
*     VINMSGID=MSGPRMM;             /* INDICATE VERIFICATION MESSAGE
*                                                            @Y30LB27*/
@RF00542 MVC   VINMSGID(2),@CH00118                                0550
*     CALL VINWTO;                  /* ISSUE MSG HDR         @Y30LB27*/
         BAL   @14,VINWTO                                          0551
*     VINMSGID=MSGVERM;             /* SET MSG ID            #Y30LB27*/
         MVC   VINMSGID(2),@CH00098                                0552
*     MSGLEN1=LENGTH(MSGBUF);       /* SET MSG CONSTANT LEN  #Y30LB27*/
         MVI   MSGLEN1,X'3C'                                       0553
*     MSGTEXT1=ADDR(MSGBUF);        /* MSG COMP LEN          #Y30LB27*/
         LA    @08,MSGBUF                                          0554
         STCM  @08,7,MSGTEXT1                                      0554
*     CALL VINWTO;                  /* ISSUE MSG             #Y30LB27*/
         BAL   @14,VINWTO                                          0555
*     VINMSGID=MSGRPYM;             /* SET MSG ID            #Y30LB27*/
         MVC   VINMSGID(2),@CH00082                                0556
*     MSGRLEN=LENGTH(REPLY);        /* SET REPL LENGTH       #Y30LB27*/
         MVI   MSGRLEN,X'48'                                       0557
*     MSGREPLY=ADDR(REPLY);         /* REPLY LOCATION        #Y30LB27*/
         LA    @08,REPLY                                           0558
         STCM  @08,7,MSGREPLY                                      0558
*     CALL VINWTO;                  /* ISSUE ERROR MSG       #Y30LB27
*                                                            #Y30LB27*/
         BAL   @14,VINWTO                                          0559
*/*********************************************************************
* * FOLD RESPONSE TO UPPER CASE                              #Y30LB27
* ********************************************************************/
*                                                                  0560
*     REPLY=REPLY×BLANKS;           /* FOLD RESPONSE         #Y30LB27
*                                                            @Y30LB27*/
         OC    REPLY(72),BLANKS                                    0560
*/*********************************************************************
* * IF A RESPONSE OF U IS SPECIFED, ACCEPT VALUES AS IS      @ZM31134
* * OTHERWISE ANALYZE THE RESPONSE                           @Y30LB27
* ********************************************************************/
*                                                                  0561
*     IF REPLY(ONE:TWO)^=CU THEN    /* VALUES ACCEPTED       @Y30LB27*/
         CLC   REPLY(2),@CC03666                                   0561
         BE    @RF00561                                            0561
*       DO;                         /*                       @Y30LB27*/
*         INDX=ONE;                 /* NO SCAN RESPONSE      @Y30LB27
*                                                            @Y30LB27*/
         LA    INDX,1                                              0563
*/*********************************************************************
* * MAXIMUM 72 CHARACTER RESPONSE. IF INDX - STRTINDX NO HIT WAS FOUND
* ********************************************************************/
*                                                                  0564
*         DO INDX=INDX TO SVNTYONE; /* SCAN REPLY            @Y30LB27*/
         B     @DE00564                                            0564
@DL00564 DS    0H                                                  0565
*           STRTINDX=INDX;          /* SAVE START INDEX TO VERIFY AT
*                                      LEAST 1 HIT           @Y30LB27
*                                                            @Y30LB27*/
         STH   INDX,STRTINDX                                       0565
*/*********************************************************************
* * USER CATALOG                                             #Y30LB27
* ********************************************************************/
*                                                                  0566
*           IF REPLY(INDX:INDX+LENGTH(CUCAT)-ONE)=CUCAT THEN/*     0566
*                                                            @Y30LB27*/
         LA    @08,REPLY-1(INDX)                                   0566
         CLC   0(8,@08),CUCAT                                      0566
         BNE   @RF00566                                            0566
*             DO;                   /* YES                   #Y30LB27*/
*               INDX=INDX+LENGTH(CUCAT);/* BYPASS KEYWORD    #Y30LB27
*                                                            #Y30LB27*/
         AL    INDX,@CF00039                                       0568
*/*********************************************************************
* * FIND LENGTH MUST BE LESS THAN EIGHT TO BE VALID          #Y30LB27
* ********************************************************************/
*                                                                  0569
*               STRTCOL=INDX;       /* FIND LENGTH           #Y30LB27*/
         STH   INDX,STRTCOL                                        0569
*               DO INDX=INDX TO SVNTYONE WHILE(REPLY(INDX)^=BLANK&REPLY
*                     (INDX)^=COMMA);/*                      #Y30LB27*/
         B     @DE00570                                            0570
@DL00570 LA    @08,REPLY-1(INDX)                                   0570
         CLI   0(@08),C' '                                         0570
         BE    @DC00570                                            0570
         LA    @08,REPLY-1(INDX)                                   0570
         CLI   0(@08),C','                                         0570
         BE    @DC00570                                            0570
*               END;                /*                       #Y30LB27*/
         AL    INDX,@CF00055                                       0571
@DE00570 C     INDX,@CF03635                                       0571
         BNH   @DL00570                                            0571
@DC00570 DS    0H                                                  0572
*               NUMCOL=INDX-STRTCOL;/* CALC LENGTH           #Y30LB27
*                                                            #Y30LB27*/
         LH    @08,STRTCOL                                         0572
         LR    @03,INDX                                            0572
         SLR   @03,@08                                             0572
         STH   @03,NUMCOL                                          0572
*/*********************************************************************
* * UPDATE VVICB IF VALID                                    #Y30LB27
* ********************************************************************/
*                                                                  0573
*               IF NUMCOL>ZERO&NUMCOL<=EIGHT THEN/* 8 IS MAX @YM02859*/
         LTR   @03,@03                                             0573
         BNP   @RF00573                                            0573
         C     @03,@CF00039                                        0573
         BH    @RF00573                                            0573
*                 VVIUCAT=REPLY(STRTCOL:STRTCOL+NUMCOL-ONE);/*     0574
*                                                            #Y30LB27*/
         MVI   VVIUCAT+1(VVIPTR),C' '                              0574
         MVC   VVIUCAT+2(6,VVIPTR),VVIUCAT+1(VVIPTR)               0574
         BCTR  @03,0                                               0574
         LA    @05,REPLY-1(@08)                                    0574
         EX    @03,@SM03975                                        0574
*               ELSE                                               0575
*                 RETRYSW=ON;       /* TRY AGAIN             #Y30LB27*/
         B     @RC00573                                            0575
@RF00573 OI    RETRYSW,B'10000000'                                 0575
*               INDX=INDX+ONE;      /* TRY NEXT              #Y30LB27*/
@RC00573 AL    INDX,@CF00055                                       0576
*             END;                  /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * SCC SAMPLING KEYWORD                                     #Y30LB27
* ********************************************************************/
*                                                                  0578
*           IF REPLY(INDX:INDX+LENGTH(CSSCSAMP)-ONE)=CSSCSAMP THEN/*
*                                      HIT                   @Y30LB27*/
@RF00566 LA    @08,REPLY-1(INDX)                                   0578
         CLC   0(9,@08),CSSCSAMP                                   0578
         BNE   @RF00578                                            0578
*             DO;                   /* YES                   @Y30LB27*/
*               INDX=INDX+LENGTH(CSSCSAMP);/* SET PTR        @Y30LB27
*                                                            @Y30LB27*/
         AL    INDX,@CF00035                                       0580
*/*********************************************************************
* * FIND LENGTH, TWO IS MAXIMUM                              @G24LB04
* ********************************************************************/
*                                                                  0581
*               STRTCOL=INDX;       /* FIND LENGTH           #Y30LB27*/
         STH   INDX,STRTCOL                                        0581
*               DO INDX=INDX TO SVNTYONE WHILE(REPLY(INDX)^=BLANK&REPLY
*                     (INDX)^=COMMA);/*                      #Y30LB27*/
         B     @DE00582                                            0582
@DL00582 LA    @08,REPLY-1(INDX)                                   0582
         CLI   0(@08),C' '                                         0582
         BE    @DC00582                                            0582
         LA    @08,REPLY-1(INDX)                                   0582
         CLI   0(@08),C','                                         0582
         BE    @DC00582                                            0582
*               END;                /*                       #Y30LB27*/
         AL    INDX,@CF00055                                       0583
@DE00582 C     INDX,@CF03635                                       0583
         BNH   @DL00582                                            0583
@DC00582 DS    0H                                                  0584
*               NUMCOL=INDX-STRTCOL;/* NUMBER OF COLUMNS     #Y30LB27*/
         LR    @08,INDX                                            0584
         SH    @08,STRTCOL                                         0584
         STH   @08,NUMCOL                                          0584
*               CALL VINPARMT;      /* VERIFY KEYWORD        @YM02859
*                                                            #Y30LB27*/
         BAL   @14,VINPARMT                                        0585
*/*********************************************************************
* * SET SAMPLING KEYWORD INTO MSSC CONTROL BLOCK              @ZM31134
* ********************************************************************/
*                                                                  0586
*               IF NUMCOL=TWO THEN  /* LEN OF 2              #Y30LB27*/
         CLC   NUMCOL(2),@CH00066                                  0586
         BNE   @RF00586                                            0586
*                 ICBSAMP=REPLY(STRTCOL:STRTCOL+ONE);/*      #Y30LB27*/
         L     @08,CVTPTR                                          0587
         L     @08,CVTEXT2(,@08)                                   0587
         L     @08,CVTICB(,@08)                                    0587
         LH    @03,STRTCOL                                         0587
         LA    @05,REPLY-1(@03)                                    0587
         MVC   ICBSAMP(2,@08),0(@05)                               0587
*               IF NUMCOL=ONE THEN  /* LEN OF 1              @YM02859*/
@RF00586 CLC   NUMCOL(2),@CH00055                                  0588
         BNE   @RF00588                                            0588
*                 DO;               /* YES                   #Y30LB27*/
*                   ICBSAMP(ONE)=C0;/* RIGHT JUSTIFY IT      #Y30LB27*/
         L     @08,CVTPTR                                          0590
         L     @08,CVTEXT2(,@08)                                   0590
         L     @08,CVTICB(,@08)                                    0590
         MVI   ICBSAMP(@08),C'0'                                   0590
*                   ICBSAMP(TWO)=REPLY(STRTCOL);/* SET VALUE #Y30LB27*/
         LH    @03,STRTCOL                                         0591
         LA    @05,REPLY-1(@03)                                    0591
         MVC   ICBSAMP+1(1,@08),0(@05)                             0591
*                 END;              /*                       #Y30LB27*/
*               IF NUMCOL=ZERO×NUMCOL>TWO THEN                     0593
@RF00588 LH    @08,NUMCOL                                          0593
         LTR   @08,@08                                             0593
         BZ    @RT00593                                            0593
         C     @08,@CF00066                                        0593
         BNH   @RF00593                                            0593
@RT00593 DS    0H                                                  0594
*                 RETRYSW=ON;       /*                       @YM02859
*                                                            #Y30LB27*/
         OI    RETRYSW,B'10000000'                                 0594
*               IF RETRYSW=OFF&ICBSAMP(ONE:TWO)=C00 THEN           0595
@RF00593 TM    RETRYSW,B'10000000'                                 0595
         BNZ   @RF00595                                            0595
         L     @08,CVTPTR                                          0595
         L     @08,CVTEXT2(,@08)                                   0595
         L     @08,CVTICB(,@08)                                    0595
         CLC   ICBSAMP(2,@08),@CC03660                             0595
         BNE   @RF00595                                            0595
*                 RETRYSW=ON;       /*                       @YM02859*/
         OI    RETRYSW,B'10000000'                                 0596
*               INDX=INDX+ONE;      /* SET BUFER PTR         #Y30LB27*/
@RF00595 AL    INDX,@CF00055                                       0597
*             END;                  /*                       #Y30LB27
*                                                            @Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * LIBRARIAN MESSAGE KEYWORD                                #Y30LB27
* ********************************************************************/
*                                                                  0599
*           IF REPLY(INDX:INDX+LENGTH(CMSFMSG)-ONE)=CMSFMSG THEN   0599
@RF00578 LA    @08,REPLY-1(INDX)                                   0599
         CLC   0(7,@08),CMSFMSG                                    0599
         BNE   @RF00599                                            0599
*             DO;                   /*                       #Y30LB27*/
*               INDX=INDX+LENGTH(CMSFMSG);/*                 #Y30LB27
*                                                            #Y30LB27*/
         AL    INDX,@CF00310                                       0601
*/*********************************************************************
* * SKIP THE LEFT PAREN                                      #Y30LB27
* ********************************************************************/
*                                                                  0602
*               IF REPLY(INDX)=LFTPAREN THEN                       0602
         LA    @08,REPLY-1(INDX)                                   0602
         CLI   0(@08),C'('                                         0602
         BNE   @RF00602                                            0602
*                 DO;               /*                       #Y30LB27*/
*                   INDX=INDX+ONE;  /* BYPASS DELIMITER      #Y30LB27*/
         AL    INDX,@CF00055                                       0604
*                   PARENSW=ON;     /* INDICATE DELIMITER FND        */
         OI    PARENSW,B'00000010'                                 0605
*                 END;              /*                       @YM02859
*                                                            #Y30LB27*/
*/*********************************************************************
* * JOURNALING KEYWORD                                       #Y30LB27
* ********************************************************************/
*                                                                  0607
*               IF REPLY(INDX:INDX+LENGTH(CJOURNAL)-ONE)=CJOURNAL THEN
@RF00602 LA    @08,REPLY-1(INDX)                                   0607
         CLC   0(7,@08),CJOURNAL                                   0607
         BNE   @RF00607                                            0607
*                                   /*                       #Y30LB27*/
*                 DO;               /*                       #Y30LB27*/
*                   INDX=INDX+LENGTH(CJOURNAL)+ONE;/*        #Y30LB27*/
         AL    INDX,@CF00039                                       0609
*                   VVIFLG3=ON;     /* JOURNAL LIBRARIAN MSGS@ZM31134
*                                                            #Y30LB27*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         0610
*                   VVIALCON=ZERO;  /* ZERO ALT CONSOLE      @YM02859*/
         MVI   VVIALCON(VVIPTR),X'00'                              0611
*                 END;              /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * ASSUM ALTERNAT CONSOLE - GET LENGTH - TWO IS MAXIMUM     @ZM31134
* ********************************************************************/
*                                                                  0613
*               ELSE                                               0613
*                 DO;               /* ASSUME ALT CONSOLE    #Y30LB27*/
         B     @RC00607                                            0613
@RF00607 DS    0H                                                  0614
*                   STRTCOL=INDX;   /* FIND LENGTH           #Y30LB27*/
         STH   INDX,STRTCOL                                        0614
*                   DO INDX=INDX TO SVNTYONE WHILE(REPLY(INDX)^=BLANK&
*                         REPLY(INDX)^=COMMA&REPLY(INDX)^=RGTPAREN);
         B     @DE00615                                            0615
@DL00615 LA    @08,REPLY-1(INDX)                                   0615
         CLI   0(@08),C' '                                         0615
         BE    @DC00615                                            0615
         LA    @08,REPLY-1(INDX)                                   0615
         CLI   0(@08),C','                                         0615
         BE    @DC00615                                            0615
         LA    @08,REPLY-1(INDX)                                   0615
         CLI   0(@08),C')'                                         0615
         BE    @DC00615                                            0615
*                   END;            /*                       #Y30LB27*/
         AL    INDX,@CF00055                                       0616
@DE00615 C     INDX,@CF03635                                       0616
         BNH   @DL00615                                            0616
@DC00615 DS    0H                                                  0617
*                   NUMCOL=INDX-STRTCOL;/* GET LENGTH        #Y30LB27*/
         LR    @08,INDX                                            0617
         SH    @08,STRTCOL                                         0617
         STH   @08,NUMCOL                                          0617
*                   CALL VINPARMT;  /* VERIFY PARMS          @YM02859*/
         BAL   @14,VINPARMT                                        0618
*                   IF NUMCOL=TWO THEN/* 2 IS MAX            #Y30LB27*/
         CLC   NUMCOL(2),@CH00066                                  0619
         BNE   @RF00619                                            0619
*                     DO;           /*                       #Y30LB27*/
*                       PACK(WORK1,REPLY(STRTCOL:STRTCOL+ONE));/*  0621
*                                                            #Y30LB27*/
         LH    @03,STRTCOL                                         0621
         LA    @05,REPLY-1(@03)                                    0621
         PACK  WORK1(2),0(2,@05)                                   0621
*                       CVB(FIXED8,WORK1);/* CONVRT IT       #Y30LB27*/
         XC    @TS00001(8),@TS00001                                0622
         MVC   @TS00001+6(2),WORK1                                 0622
         CVB   FIXED8,@TS00001                                     0622
*                       VVIALCON=FIXED8;/* SET CONTROL BLOCK VALUE 0623
*                                                            #Y30LB27*/
         STC   FIXED8,VVIALCON(,VVIPTR)                            0623
*                       VVIFLG3=OFF;/* JOURNAL LIBARAIAN MSGS      0624
*                                                            @YM02859*/
         NI    VVIFLG3(VVIPTR),B'11101111'                         0624
*                     END;          /*                       #Y30LB27*/
*                   IF NUMCOL=ONE THEN/*                     #Y30LB27*/
@RF00619 CLC   NUMCOL(2),@CH00055                                  0626
         BNE   @RF00626                                            0626
*                     DO;           /*                       #Y30LB27*/
*                       PACK(WORK1,REPLY(STRTCOL));/* PACK IT      0628
*                                                            #Y30LB27*/
         LH    @03,STRTCOL                                         0628
         LA    @05,REPLY-1(@03)                                    0628
         PACK  WORK1(2),0(1,@05)                                   0628
*                       CVB(FIXED8,WORK1);/* CONVERT IT TO BINARY  0629
*                                                            #Y30LB27*/
         XC    @TS00001(8),@TS00001                                0629
         MVC   @TS00001+6(2),WORK1                                 0629
         CVB   FIXED8,@TS00001                                     0629
*                       VVIALCON=FIXED8;/* SET CONTROL BLOCK #Y30LB27*/
         STC   FIXED8,VVIALCON(,VVIPTR)                            0630
*                       VVIFLG3=OFF;/* JOURNAL LIBARAIAN MSGS      0631
*                                                            @YM02859*/
         NI    VVIFLG3(VVIPTR),B'11101111'                         0631
*                     END;          /*                       #Y30LB27*/
*                   IF NUMCOL=ZERO×NUMCOL>TWO THEN                 0633
@RF00626 LH    @08,NUMCOL                                          0633
         LTR   @08,@08                                             0633
         BZ    @RT00633                                            0633
         C     @08,@CF00066                                        0633
         BNH   @RF00633                                            0633
@RT00633 DS    0H                                                  0634
*                     RETRYSW=ON;   /*                       @YM02859*/
         OI    RETRYSW,B'10000000'                                 0634
*                   IF RETRYSW=OFF&VVIALCON=ZERO×VVIALCON>SIXTEEN THEN
@RF00633 TM    RETRYSW,B'10000000'                                 0635
         BNZ   @GL00013                                            0635
         CLI   VVIALCON(VVIPTR),0                                  0635
         BE    @RT00635                                            0635
@GL00013 CLI   VVIALCON(VVIPTR),16                                 0635
         BNH   @RF00635                                            0635
@RT00635 DS    0H                                                  0636
*                     RETRYSW=ON;   /*                       @YM02859*/
         OI    RETRYSW,B'10000000'                                 0636
*                   INDX=INDX+ONE;  /* SET BUFFER PTR        #Y30LB27*/
@RF00635 AL    INDX,@CF00055                                       0637
*                 END;              /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * JOURNALING KEYWORD                                       #Y30LB27
* ********************************************************************/
*                                                                  0639
*               IF PARENSW=ON THEN  /* PAREN DELIMITER       #Y30LB27*/
@RC00607 TM    PARENSW,B'00000010'                                 0639
         BNO   @RF00639                                            0639
*                 DO;               /* JOURNAL KEYWORD       #Y30LB27*/
*                   IF REPLY(INDX:INDX+LENGTH(CJOURNAL)-ONE)=CJOURNAL
*                     THEN          /*                       #Y30LB27*/
         LA    @08,REPLY-1(INDX)                                   0641
         CLC   0(7,@08),CJOURNAL                                   0641
         BNE   @RF00641                                            0641
*                     DO;           /* JOURNAL KEYWORD       #Y30LB27*/
*                       INDX=INDX+LENGTH(CJOURNAL)+ONE;/*    #Y30LB27*/
         AL    INDX,@CF00039                                       0643
*                       VVIFLG3=ON; /* MSGS ARE TO BE JOURNALED    0644
*                                                            #Y30LB27*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         0644
*                     END;          /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * IF NOT ASSUME ALTERNATE CONSOLE - FIND LENGTH            #Y30LB27
* ********************************************************************/
*                                                                  0646
*                   ELSE                                           0646
*                     DO;           /* ALT - CONSOLE         #Y30LB27*/
         B     @RC00641                                            0646
@RF00641 DS    0H                                                  0647
*                       STRTCOL=INDX;/* SAVE KEYWORD BEGIN   #Y30LB27*/
         STH   INDX,STRTCOL                                        0647
*                       DO INDX=INDX TO SVNTYONE WHILE(REPLY(INDX)^=
*                             BLANK&REPLY(INDX)^=COMMA&REPLY(INDX)^=
*                             RGTPAREN);                           0648
         B     @DE00648                                            0648
@DL00648 LA    @08,REPLY-1(INDX)                                   0648
         CLI   0(@08),C' '                                         0648
         BE    @DC00648                                            0648
         LA    @08,REPLY-1(INDX)                                   0648
         CLI   0(@08),C','                                         0648
         BE    @DC00648                                            0648
         LA    @08,REPLY-1(INDX)                                   0648
         CLI   0(@08),C')'                                         0648
         BE    @DC00648                                            0648
*                       END;        /*                       #Y30LB27*/
         AL    INDX,@CF00055                                       0649
@DE00648 C     INDX,@CF03635                                       0649
         BNH   @DL00648                                            0649
@DC00648 DS    0H                                                  0650
*                       NUMCOL=INDX-STRTCOL;/* NUMBER OF COLS      0650
*                                                            #Y30LB27*/
         LR    @08,INDX                                            0650
         SH    @08,STRTCOL                                         0650
         STH   @08,NUMCOL                                          0650
*                       CALL VINPARMT;/* VERIFY PARMS        @YM02859*/
         BAL   @14,VINPARMT                                        0651
*                       IF NUMCOL=TWO THEN/* VALUE LEN OF 2  #Y30LB27*/
         CLC   NUMCOL(2),@CH00066                                  0652
         BNE   @RF00652                                            0652
*                         DO;       /*                       #Y30LB27
*                                      FORCE NUMERIC VALUE   #Y30LB27*/
*                           PACK(WORK1,REPLY(STRTCOL:STRTCOL+ONE));/*
*                                                            #Y30LB27*/
         LH    @03,STRTCOL                                         0654
         LA    @05,REPLY-1(@03)                                    0654
         PACK  WORK1(2),0(2,@05)                                   0654
*                           CVB(FIXED8,WORK1);/* CNVRT IT    #Y30LB27*/
         XC    @TS00001(8),@TS00001                                0655
         MVC   @TS00001+6(2),WORK1                                 0655
         CVB   FIXED8,@TS00001                                     0655
*                           VVIALCON=FIXED8;/* UPDATE CONTROL BLOCK
*                                                            #Y30LB27*/
         STC   FIXED8,VVIALCON(,VVIPTR)                            0656
*                         END;      /*                       #Y30LB27*/
*                       IF NUMCOL=ONE THEN/* VALUE LEN OF 1  #Y30LB27*/
@RF00652 CLC   NUMCOL(2),@CH00055                                  0658
         BNE   @RF00658                                            0658
*                         DO;       /*                       #Y30LB27
*                                      FORCE NUMERIC VALUE   #Y30LB27*/
*                           PACK(WORK1,REPLY(STRTCOL));/* PACK IT  0660
*                                                            #Y30LB27*/
         LH    @03,STRTCOL                                         0660
         LA    @05,REPLY-1(@03)                                    0660
         PACK  WORK1(2),0(1,@05)                                   0660
*                           CVB(FIXED8,WORK1);/* CONVERT IT  #Y30LB27*/
         XC    @TS00001(8),@TS00001                                0661
         MVC   @TS00001+6(2),WORK1                                 0661
         CVB   FIXED8,@TS00001                                     0661
*                           VVIALCON=FIXED8;/* UPDATE CONTROL BLOCK
*                                                            #Y30LB27*/
         STC   FIXED8,VVIALCON(,VVIPTR)                            0662
*                         END;      /*                       #Y30LB27*/
*                       IF NUMCOL=ZERO×NUMCOL>TWO THEN             0664
@RF00658 LH    @08,NUMCOL                                          0664
         LTR   @08,@08                                             0664
         BZ    @RT00664                                            0664
         C     @08,@CF00066                                        0664
         BNH   @RF00664                                            0664
@RT00664 DS    0H                                                  0665
*                         RETRYSW=ON;                              0665
         OI    RETRYSW,B'10000000'                                 0665
*                       IF RETRYSW=OFF&VVIALCON=ZERO×VVIALCON>SIXTEEN
*                         THEN                                     0666
@RF00664 TM    RETRYSW,B'10000000'                                 0666
         BNZ   @GL00018                                            0666
         CLI   VVIALCON(VVIPTR),0                                  0666
         BE    @RT00666                                            0666
@GL00018 CLI   VVIALCON(VVIPTR),16                                 0666
         BNH   @RF00666                                            0666
@RT00666 DS    0H                                                  0667
*                         RETRYSW=ON;/*                      @YM02859*/
         OI    RETRYSW,B'10000000'                                 0667
*                       INDX=INDX+ONE;/* BYPASS VALUE        #Y30LB27*/
@RF00666 AL    INDX,@CF00055                                       0668
*                     END;          /*                       #Y30LB27*/
*                 END;              /*                       #Y30LB27
*                                                            #Y30LB27*/
@RC00641 DS    0H                                                  0671
*/*********************************************************************
* * SKIP RIGHT PAREN                                         #Y30LB27
* ********************************************************************/
*                                                                  0671
*               IF REPLY(INDX)=RGTPAREN THEN                       0671
@RF00639 LA    @08,REPLY-1(INDX)                                   0671
         CLI   0(@08),C')'                                         0671
         BNE   @RF00671                                            0671
*                 INDX=INDX+ONE;    /*                       #Y30LB27*/
         AL    INDX,@CF00055                                       0672
*             END;                  /*                       #Y30LB27
*                                                            #Y30LB27*/
@RF00671 DS    0H                                                  0674
*/*********************************************************************
* * TRKVOLS PARAMETER                                        @ZA27588*
* ********************************************************************/
*                                                                  0674
*           IF REPLY(INDX:INDX+LENGTH(CTRKVOLS)-ONE)=CTRKVOLS THEN/*
*                                                            @ZA27588*/
@RF00599 LA    @08,REPLY-1(INDX)                                   0674
         CLC   0(8,@08),CTRKVOLS                                   0674
         BNE   @RF00674                                            0674
*             DO;                   /*                       @ZA27588*/
*               INDX=INDX+LENGTH(CTRKVOLS);/* INCREMENT INDEX      0676
*                                                            @ZA27588*/
         AL    INDX,@CF00039                                       0676
*               STRTCOL=INDX;       /* SAVE START            @ZA27588*/
         STH   INDX,STRTCOL                                        0677
*               DO INDX=INDX TO SVNTYONE WHILE REPLY(INDX)^=BLANK&REPLY
*                     (INDX)^=COMMA;/*                       @ZA27588*/
         B     @DE00678                                            0678
@DL00678 LA    @08,REPLY-1(INDX)                                   0678
         CLI   0(@08),C' '                                         0678
         BE    @DC00678                                            0678
         LA    @08,REPLY-1(INDX)                                   0678
         CLI   0(@08),C','                                         0678
         BE    @DC00678                                            0678
*               END;                /*                       @ZA27588*/
         AL    INDX,@CF00055                                       0679
@DE00678 C     INDX,@CF03635                                       0679
         BNH   @DL00678                                            0679
@DC00678 DS    0H                                                  0680
*               NUMCOL=INDX-STRTCOL;/* GET REPLY LENGTH      @ZA27588*/
         LR    @08,INDX                                            0680
         SH    @08,STRTCOL                                         0680
         STH   @08,NUMCOL                                          0680
*               IF ININIT=ON THEN   /*                       @ZA27588*/
         L     @03,INITPTR                                         0681
         TM    ININIT(@03),B'10000000'                             0681
         BNO   @RF00681                                            0681
*                 DO;               /*                       @ZA27588*/
*                   IF NUMCOL>ZERO&NUMCOL<=THREE THEN/* COR LENGTH 0683
*                                                            @ZA27588*/
         LTR   @08,@08                                             0683
         BNP   @RF00683                                            0683
         C     @08,@CF00118                                        0683
         BH    @RF00683                                            0683
*                     DO;           /* YES                   @ZA27588*/
*                       TMPCOL=NUMCOL;/* SAVE LENGTH         @ZA27588*/
         STH   @08,TMPCOL                                          0685
*                       CALL VINPARMT;/* TEST FOR NUMRIC     @ZA27588*/
         BAL   @14,VINPARMT                                        0686
*                       VVIVTRK(FOUR-TMPCOL:THREE)=REPLY(STRTCOL:  0687
*                           STRTCOL+TMPCOL-ONE);/* SAVE VOL COUNT  0687
*                                                            @ZA27588*/
         LA    @08,4                                               0687
         SH    @08,TMPCOL                                          0687
         ST    @08,@TF00001                                        0687
         ALR   @08,VVIPTR                                          0687
         LA    @03,3                                               0687
         SL    @03,@TF00001                                        0687
         LH    @05,STRTCOL                                         0687
         LA    @04,REPLY-1(@05)                                    0687
         EX    @03,@SM03977                                        0687
*                       IF NUMCOL=ZERO THEN/* IF NOT NUMERIC @ZA27588*/
         LH    @08,NUMCOL                                          0688
         LTR   @08,@08                                             0688
         BNZ   @RF00688                                            0688
*                         DO;       /*                       @ZA27588*/
*                           VVIVTRK=C68;/* SET DEFAULT       @ZA27588*/
         MVC   VVIVTRK(3,VVIPTR),@CC03664                          0690
*                           RETRYSW=ON;/* RE-ISSUE MSG       @ZA27588*/
         OI    RETRYSW,B'10000000'                                 0691
*                         END;      /*                       @ZA27588*/
*                       IF NUMCOL=ONE THEN/* IS VAL ONE DIGIT      0693
*                                                            @ZA27588*/
@RF00688 CLC   NUMCOL(2),@CH00055                                  0693
         BNE   @RF00693                                            0693
*                         VVIVTRK(ONE:TWO)=C00;/* PAD WITH ZEROS   0694
*                                                            @ZA27588*/
         MVC   VVIVTRK(2,VVIPTR),@CC03660                          0694
*                       IF NUMCOL=TWO THEN/* IS VAL TWO DIGITS     0695
*                                                            @ZA27588*/
@RF00693 CLC   NUMCOL(2),@CH00066                                  0695
         BNE   @RF00695                                            0695
*                         VVIVTRK(ONE)=C0;/* PAD WITH ZERO   @ZA27588*/
         MVI   VVIVTRK(VVIPTR),C'0'                                0696
*                     END;          /*                       @ZA27588*/
*                   ELSE            /*                       @ZA27588*/
*                     DO;           /*                       @ZA27588*/
         B     @RC00683                                            0698
@RF00683 DS    0H                                                  0699
*                       RETRYSW=ON; /* REISSUE MSG           @ZA27588*/
         OI    RETRYSW,B'10000000'                                 0699
*                       VVIVTRK=C68;/* SET DEFAULT           @ZA27588*/
         MVC   VVIVTRK(3,VVIPTR),@CC03664                          0700
*                     END;          /*                       @ZA27588*/
*                 END;              /*                       @ZA27588*/
*               ELSE                                               0703
*                 RETRYSW=ON;       /* RE-ISSUE MSG          @ZA27588*/
         B     @RC00681                                            0703
@RF00681 OI    RETRYSW,B'10000000'                                 0703
*               INDX=INDX+ONE;      /* INCREMENT VAL         @ZA27588*/
@RC00681 AL    INDX,@CF00055                                       0704
*             END;                  /*                       @ZA27588*/
*/*********************************************************************
* * SKIP THE DELIMITER                                       #Y30LB27
* ********************************************************************/
*                                                                  0706
*           IF REPLY(INDX)=COMMA THEN                              0706
@RF00674 LA    @08,REPLY-1(INDX)                                   0706
         CLI   0(@08),C','                                         0706
         BNE   @RF00706                                            0706
*             INDX=INDX+ONE;        /*                       #Y30LB27
*                                                            #Y30LB27*/
         AL    INDX,@CF00055                                       0707
*           IF REPLY(INDX)=BLANK THEN                              0708
@RF00706 LA    @08,REPLY-1(INDX)                                   0708
         CLI   0(@08),C' '                                         0708
         BNE   @RF00708                                            0708
*             INDX=SVNTYTWO;        /* BLANK AUTOMATIC TERMINATION OF
*                                      SCAN                  #Y30LB27*/
         LA    INDX,72                                             0709
*           IF INDX>SVNTYTWO THEN                                  0710
@RF00708 LA    @08,72                                              0710
         CR    INDX,@08                                            0710
         BNH   @RF00710                                            0710
*             INDX=SVNTYTWO;        /* FORCED OUT OF BUFFER  #Y30LB27*/
         LR    INDX,@08                                            0711
*/*********************************************************************
* * IF NO HIT ISSUE ERROR MESSAGE AND CONTINUE SCAN          #Y30LB27
* ********************************************************************/
*                                                                  0712
*           IF STRTINDX=INDX THEN   /*                       #Y30LB27*/
@RF00710 CH    INDX,STRTINDX                                       0712
         BNE   @RF00712                                            0712
*             DO;                   /*                       #Y30LB27*/
*               RETRYSW=ON;         /* FORCE RE-ISSUE        #Y30LB27*/
         OI    RETRYSW,B'10000000'                                 0714
*               INDX=SVNTYTWO;      /* CAUSE PARM ERR MSG    @ZA09528*/
         LA    INDX,72                                             0715
*             END;                  /*                       #Y30LB27*/
*           ELSE                    /* GOOD SCAN             @ZM30746*/
*             INDX=INDX-ONE;        /*                       @ZM30746*/
         B     @RC00712                                            0717
@RF00712 BCTR  INDX,0                                              0717
*         END;                      /*                       @ZM30746*/
@RC00712 AL    INDX,@CF00055                                       0718
@DE00564 C     INDX,@CF03635                                       0718
         BNH   @DL00564                                            0718
*         IF RETRYSW=ON THEN        /*                       @ZM30746*/
         TM    RETRYSW,B'10000000'                                 0719
         BNO   @RF00719                                            0719
*           DO;                     /*                       @ZM30746*/
*             VINMSGID=MSGSPEE;     /*                       @ZM30746*/
         MVC   VINMSGID(2),@CH00707                                0721
*             CALL VINWTO;          /*                       @ZM30746*/
         BAL   @14,VINWTO                                          0722
*           END;                    /*                       @ZM30746*/
*       END;                        /*                       #Y30LB27*/
*     ELSE                          /* SCAN OKAY             @ZM30746*/
*       IF VVIALCON=ZERO&VVIFLG3=OFF THEN/*                  @ZM30746*/
         B     @RC00561                                            0725
@RF00561 CLI   VVIALCON(VVIPTR),0                                  0725
         BNE   @RF00725                                            0725
         TM    VVIFLG3(VVIPTR),B'00010000'                         0725
         BNZ   @RF00725                                            0725
*         DO;                       /*                       @ZM30746*/
*           VINMSGID=MSGSPEE;       /*                       @ZM30746*/
         MVC   VINMSGID(2),@CH00707                                0727
*           CALL VINWTO;            /*                       @ZM30746*/
         BAL   @14,VINWTO                                          0728
*           RETRYSW=ON;             /*                       @ZM30746*/
         OI    RETRYSW,B'10000000'                                 0729
*         END;                      /*                       @ZM30746*/
*       ELSE                        /*                       @ZM30746*/
*         RETRYSW=OFF;              /*                       @ZM30746*/
         B     @RC00725                                            0731
@RF00725 NI    RETRYSW,B'01111111'                                 0731
*   END;                            /*                       #Y30LB27*/
@RC00725 DS    0H                                                  0732
@RC00561 DS    0H                                                  0732
@DE00492 TM    RETRYSW,B'10000000'                                 0732
         BO    @DL00492                                            0732
*   IF VVIFLG3=ON THEN              /* IS JRNL SW ON         @ZA17167*/
         TM    VVIFLG3(VVIPTR),B'00010000'                         0733
         BNO   @RF00733                                            0733
*     JRNLSW3=ON;                   /* SAVE FLG              @ZA17167*/
         OI    JRNLSW3,B'10000000'                                 0734
*   ELSE                                                           0735
*     JRNLSW3=OFF;                  /*                       @ZA17167*/
         B     @RC00733                                            0735
@RF00733 NI    JRNLSW3,B'01111111'                                 0735
*   RETURN;                         /* RETURN TO MAINLINE    #Y30LB27*/
@EL00003 DS    0H                                                  0736
@EF00003 DS    0H                                                  0736
@ER00003 L     @14,@SA00003                                        0736
         BR    @14                                                 0736
*   END VINPARMV;                   /*                       #Y30LB27*/
         B     @EL00003                                            0737
*VINPARMT:                                                         0738
*   PROC OPTIONS(SAVE(14));         /*                       #YM02859*/
VINPARMT ST    @14,12(,@13)                                        0738
*   J=NUMCOL-ONE;                   /* SET LOOP CONTROL      #YM02859*/
         LH    @08,NUMCOL                                          0739
         BCTR  @08,0                                               0739
         STH   @08,J                                               0739
*   DO I=ZERO TO J;                 /* TEST ALL VALUES       #YM02859*/
         SLR   I,I                                                 0740
         B     @DE00740                                            0740
@DL00740 DS    0H                                                  0741
*     TESTBYTE=REPLY(STRTCOL+I);    /* SET VALUE TO BE TESTED      0741
*                                                            #YM02859*/
         LR    @03,I                                               0741
         AH    @03,STRTCOL                                         0741
         LA    @05,REPLY-1(@03)                                    0741
         MVC   TESTBYTE(1),0(@05)                                  0741
*     IF TESTB0=OFF×TESTB1=OFF×TESTB2=OFF×TESTB3=OFF THEN          0742
         TM    TESTB0,B'11110000'                                  0742
         BO    @RF00742                                            0742
*       NUMCOL=ZERO;                /* FORCE INVALID VALUE   #YM02859*/
         SLR   @03,@03                                             0743
         STH   @03,NUMCOL                                          0743
*   END;                            /* END TEST              #YM02859*/
@RF00742 AL    I,@CF00055                                          0744
@DE00740 CH    I,J                                                 0744
         BNH   @DL00740                                            0744
*   END VINPARMT;                   /* END PARM TEST         #YM02859*/
@EL00004 DS    0H                                                  0745
@EF00004 DS    0H                                                  0745
@ER00004 L     @14,12(,@13)                                        0745
         BR    @14                                                 0745
*                                                                  0746
*/******************************************************************
**                                                           #Y30LB27
**  VININDS: ALLOCATE, OPEN (& INIT INVENTORY IF 1ST IPL)    #Y30LB27
**        THE MSVC INVENTORY AND MSVC JOURNAL                #Y30LB27
**                                                           #Y30LB27
**  INPUT:                                                   #Y30LB27
**        ICBVVICB ADDRESS                                   #Y30LB27
**        MSVCS TCB ADDRESS                                  #Y30LB27
**        VVIUCAT, IN ICBVVICB, = VSAM USER CATALOG NAME     #Y30LB27
**                                                           #Y30LB27
**  PROCESS:                                                 #Y30LB27
**        UPON ENTRY, THE MSVC INVENTORY IS ALLOCATED VIA    #Y30LB27
**        CALL TO SEGMENT VINALDS1 (VS/1) OR DYNAMIC         #Y30LB27
**        ALLOCATION (VS/2). IF SUCCESSFUL, SEGMENT VINMOPN  #Y30LB27
**        IS CALLED TO OPEN THE INVENTORY.                   @Y30LB27
**                                                           @Y30LB27
**        IF THE DATA SET IS FOUND TO BE EMPTY, ASSUME       @Y30LB27
**        it IS THE FIRST MSS IPL AFTER SYSGEN AND          @Y30LB27
**        CONTROL RECORDS ARE CREATED AND WRITTEN TO THE     @Y30LB27
**         MSVC INVENTORY.                                   @Y30LB27
**                                                           @Y30LB27
**        UPON SUCCESSFUL OPENING OF THE MSVC INVENTORY,     @Y30LB27
**        THE MSVC JOURNAL IS ALLOCATED, RESERVED AND OPENED,@Z37LB26
**        VIA CALLS VINAJL2, JRNLRES AND VINJOPN.            @Z37LB26
**                                                           @Y30LB27
**        IF ANY UNRECOVERABLE ERRORS ARE ENCOUNTERED DURING SEGMENT
**        PROCESSING, SEGMENT VINWTO IS CALLED TO ASK THE OPERATOR 0746
**        WHETHER MSS SHOULD BE CONTINUED WITHOUT MSVC OR MSS      0746
**        SHOULD BE TERMINATED.  A 'TERM' CODE, INDICATING THE     0746
**        RESPONSE IS PASSED BACK TO THE MAINLINE SEGMENT.   @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**       . FOLLOWING JCL STRUCTURE                           @Y30LB27
**         //STEP      EXEC PGM=ICBVvi00                     @Y30LB27
**         //STEPCAT   DD  DSN=USERCAT,DISP=SHR              @Y30LB27
**         //MSVC      DD  DSN=USERCAT.MSVI,DISP=SHR         @Y30LB27
**         //MSVCJRNL  DD  DSN=USERCAT.MSVCJRNL,DISP=SHR     @Y30LB27
**        . (VS/1) CONTROL BLOCK CONFIGURATION FOR VSAM OPEN OF THE
**          MSVC USER CATALOG                                @Y30LB27
**        . (VS/1) ACB FOR THE MSVC USER CATALOG              @Y30LB27
**                                                           @Y30LB27
**        . (VS/1) CONTROL BLOCK CONFIGURATION FOR VSAM OPEN OF THE
**          MSVC INVENTORY                                   @Y30LB27
**        . ACB FOR THE MSVC INVENTORY IS CHAINED TO THE ICBVVICB  0746
**                                                           @Y30LB27
**        . DCB FOR THE MSVC JOURNAL IS CHAINED TO THE ICBVVICB    0746
**                                                           @Y30LB27
**        . TERM CODE, INDICATING -                          @Y30LB27
**            = 0, NO ALLOCATION/OPEN ERROR                   @Y30LB27
**           ^= 0, ALLOCATION/OPEN ERROR DETECTED             @Y30LB27
**                                                           @Y30LB27
**********************************************************************/
*                                                                  0746
*VININDS:                                                          0746
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VININDS  ST    @14,@SA00005                                        0746
*/*********************************************************************
* * USE DYNAMIC ALLOCATION                                   @G24LB04
* ********************************************************************/
*                                                                  0747
*   CALL VINALV2;                   /* CALL VS/2 SEGMENT     @Y30LB27*/
         BAL   @14,VINALV2                                         0747
*   IF RPLVRETC=ZERO THEN           /* RETURN CODE ZERO      @ZM31134*/
         LH    @08,RPLVRETC(,RPLVPTR)                              0748
         N     @08,@CF03969                                        0748
         LTR   @08,@08                                             0748
         BNZ   @RF00748                                            0748
*     CALL INVRES;                  /* RESERVE THE INVENTORY @ZA05115
*                                                            #Y30LB27*/
         BAL   @14,INVRES                                          0749
*/*********************************************************************
* * OPEN THE INVENTORY DATA SET                              #Y30LB27
* ********************************************************************/
*                                                                  0750
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF00748 LH    @08,RPLVRETC(,RPLVPTR)                              0750
         N     @08,@CF03969                                        0750
         LTR   @08,@08                                             0750
         BNZ   @RF00750                                            0750
*     CALL VINMOPN;                 /* OPEN INVENTORY        #Y30LB27
*                                                            #Y30LB27*/
         BAL   @14,VINMOPN                                         0751
*/*********************************************************************
* * ALLOC JOURNAL DATA SET                                   #Y30LB27
* ********************************************************************/
*                                                                  0752
*                                   /*                       #Y30LB27*/
*/*********************************************************************
* * USE DYN ALLOC                                            @G24LB04
* ********************************************************************/
*                                                                  0752
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF00750 LH    @08,RPLVRETC(,RPLVPTR)                              0752
         N     @08,@CF03969                                        0752
         LTR   @08,@08                                             0752
         BNZ   @RF00752                                            0752
*     CALL VINALJ2;                 /* YES                   #Y30LB27*/
         BAL   @14,VINALJ2                                         0753
*   IF RPLVRETC=ZERO THEN           /* ZERO RETURN CODE      @ZM31134*/
@RF00752 LH    @08,RPLVRETC(,RPLVPTR)                              0754
         N     @08,@CF03969                                        0754
         LTR   @08,@08                                             0754
         BNZ   @RF00754                                            0754
*     CALL JRNLRES;                 /* RESERVE THE JOURNAL   @ZA05115
*                                                            #Y30LB27*/
         BAL   @14,JRNLRES                                         0755
*/*********************************************************************
* * OPEN THE JOURNAL DATA SET                                #Y30LB27
* ********************************************************************/
*                                                                  0756
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF00754 LH    @08,RPLVRETC(,RPLVPTR)                              0756
         N     @08,@CF03969                                        0756
         LTR   @08,@08                                             0756
         BNZ   @RF00756                                            0756
*     CALL VINJOPN;                 /* OPEN THE MSVC JOURNAL #Y30LB27*/
         BAL   @14,VINJOPN                                         0757
*   RETURN;                         /* RETURN TO CALLER      #Y30LB27*/
@EL00005 DS    0H                                                  0758
@EF00005 DS    0H                                                  0758
@ER00005 L     @14,@SA00005                                        0758
         BR    @14                                                 0758
*   END VININDS;                    /*                       #Y30LB27*/
         B     @EL00005                                            0759
*                                                                  0760
*/* ******************************************************************
**                                                           #Y30LB27
**    NAME = VINALV2: SEGMENT TO ALLOCATE INVENTORY FOR VS/2  @Y30LB27
**                                                           #Y30LB27
**    INPUT = NONE                                           #Y30LB27
**                                                           #Y30LB27
**     PROCESS = VINALV2 IS A SUBSEGMENT OF SEGMENT VININDS. #Y30LB27
**                                                           #Y30LB27
**     OUTPUT = JOURNAL IS ALLOCATED FOR MSVC THE TASK       #Y30LB27
**                                                           #Y30LB27
******************************************************************** */
*                                                                  0760
*VINALV2:                                                          0760
*   PROC OPTIONS(SAVE(14));         /*                       #Y30LB27
*                                                            #Y30LB27*/
VINALV2  ST    @14,@SA00006                                        0760
*/*********************************************************************
* * EST SSIB, SWA, AND CALL DYN ALLOC ESTABLISHMENT ROUTINE  #Y30LB27
* ********************************************************************/
*                                                                  0761
*   IF ININIT=ON THEN                                              0761
         L     @08,INITPTR                                         0761
         TM    ININIT(@08),B'10000000'                             0761
         BNO   @RF00761                                            0761
*     DO;                           /* ESTABLISH JSCB DURING IPL ONLY
*                                                            #Y30LB27*/
*/*********************************************************************
* * ESTABLISH SSIB SUBSYSTEM INTERFACE BLOCK - REQD BY       #Y30LB27
* * DYNAMIC ALLOCATION                                       #Y30LB27
* ********************************************************************/
*                                                                  0763
*       REG1=LENGTH(SSIB);          /* GET LENGTH OF SSIB    #Y30LB27*/
         LA    REG1,36                                             0763
*       GEN(GETMAIN RC,LV=(1),SP=230);/* GET STORAGE FOR SSIB      0764
*                                                            @ZM31134*/
         GETMAIN RC,LV=(1),SP=230
*       IF REG15^=ZERO THEN                                        0765
         LTR   REG15,REG15                                         0765
         BZ    @RF00765                                            0765
*         DO;                       /* STORAGE OBTAIN        #Y30LB27*/
*           VINMSGID=MSGSTGE;       /* SET MSG ID FOR STORAGE ERROR
*                                                            #Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                0767
*           CALL VINWTO;            /* PRINT ERROR MESSAGE   #Y30LB27*/
         BAL   @14,VINWTO                                          0768
*           RETURN;                 /* RETURN TO CALLER      #Y30LB27*/
@EL00006 DS    0H                                                  0769
@EF00006 DS    0H                                                  0769
@ER00006 L     @14,@SA00006                                        0769
         BR    @14                                                 0769
*         END;                      /*                       #Y30LB27*/
*       JSCBSSIB=REG1;              /* JSCB POINTS TO SSIB   #Y30LB27*/
@RF00765 L     @08,CVTPTR                                          0771
         L     @08,CVTTCBP(,@08)                                   0771
         L     @08,TCBPTR(,@08)                                    0771
         L     @05,TCBJSCB(,@08)                                   0771
         ST    REG1,JSCBSSIB(,@05)                                 0771
*       RFY                                                        0772
*         SSIB BASED(REG1);         /* RESET PTR TO INIT     #Y30LB27*/
*       SSIBID=CSSIB;               /* SET SSICB ID          #Y30LB27*/
         MVC   SSIBID(4,REG1),CSSIB                                0773
*       SSIBLEN=LENGTH(SSIB);       /* SET SSIB LENGTH       #Y30LB27*/
         MVC   SSIBLEN(2,REG1),@CH03936                            0774
*       SSIBSSNM=MSTR;              /* SET JOBNAME           @ZA13475*/
         MVC   SSIBSSNM(4,REG1),MSTR                               0775
*       SSIBJBID=SUBTASK;           /* SET STEP NAME         @ZM30746
*                                                            #Y30LB27*/
         MVC   SSIBJBID(8,REG1),SUBTASK                            0776
*/*********************************************************************
* * ESTABLISH SCHEDULAR WORK AREA - REQUIRED BY DYN ALLOC    #Y30LB27
* ********************************************************************/
*                                                                  0777
*       RFY                                                        0777
*         SWAE BASED(ADDR(SWAEAREA));/* POINT TO INTERNAL SWA      0777
*                                                            #Y30LB27*/
*       SWJSCBPT=ADDR(TCBJSCB);     /* SWA PTR TO ADDR OF JSCB     0778
*                                                            #Y30LB27*/
         LA    @05,SWAEAREA                                        0778
         LA    @08,TCBJSCB(,@08)                                   0778
         ST    @08,SWJSCBPT(,@05)                                  0778
*       SWCREATE=ON;                /* INDICATE CRAETE       #Y30LB27*/
         OI    SWCREATE(@05),B'10000000'                           0779
*       SWJOBNAM=ADDR(MSTR);        /* ADDR OF JOBNAME       @ZA13475*/
         LA    @08,MSTR                                            0780
         ST    @08,SWJOBNAM(,@05)                                  0780
*       SWSTEPNM=ADDR(SUBTASK);     /* ADDR OF STEPNAME      @ZM31129*/
         LA    @08,SUBTASK                                         0781
         ST    @08,SWSTEPNM(,@05)                                  0781
*       SWTIOTPT=ADDR(TIOTPTR);     /* ZERO TIOT PTR - CREATE NEW  0782
*                                      TIOT                  #Y30LB27
*                                                            #Y30LB27*/
         LA    @08,TIOTPTR                                         0782
         ST    @08,SWTIOTPT(,@05)                                  0782
*/*********************************************************************
* * INVOKE ALLOCATION ESTABLISHMENT ROUTINE FOR DYNAMIC      #Y30LB27
* * ALLCOATION                                               #Y30LB27
* ********************************************************************/
*                                                                  0783
*       REG1=ADDR(SWAEAREA);        /* POINT TO SWA          #Y30LB27*/
         LR    REG1,@05                                            0783
*LLINK1:                                                           0784
*       GEN(LINK EP=IEESB601);      /* INVOKE JSCB ALLOC RTN #Y30LB27*/
LLINK1   LINK EP=IEESB601
*       IF REG15^=ZERO THEN                                        0785
         LTR   REG15,REG15                                         0785
         BZ    @RF00785                                            0785
*         DO;                       /* ERROR RTN             #Y30LB27*/
*/*********************************************************************
* * ALLOCATION OF JOB STEP CONTROL BLOCK FAILED              #Y30LB27
* ********************************************************************/
*                                                                  0787
*           VINMSGID=MSGALCE;       /* SET MSG INDEX         #Y30LB27*/
         MVC   VINMSGID(2),@CH00310                                0787
*           MSGLEN1=LENGTH(CIEESB60);/* SET MSG CONSTANT     #Y30LB27*/
         MVI   MSGLEN1,X'08'                                       0788
*           MSGTEXT1=ADDR(CIEESB60);/* SET MSG CONSTANT      #Y30LB27*/
         LA    @08,CIEESB60                                        0789
         STCM  @08,7,MSGTEXT1                                      0789
*           CNVRTWK1(ONE:TWO)=REG15;/* CNVRT IT FOR MSG      #Y30LB27*/
         STCM  REG15,3,CNVRTWK1                                    0790
*           CALL VINCNVRT;          /* CONVERT IT            #Y30LB27*/
         BAL   @14,VINCNVRT                                        0791
*           CALL VINWTO;            /* ISSUE ERROR MSG       #Y30LB27*/
         BAL   @14,VINWTO                                          0792
*           RETURN;                 /* RETURN                #Y30LB27*/
         B     @EL00006                                            0793
*         END;                      /*                       #Y30LB27*/
*     END;                          /*                       #Y30LB27
*                                                            #Y30LB27*/
@RF00785 DS    0H                                                  0796
*/*********************************************************************
* * SET UP DYNAMIC ALLOC REQUEST BLOCK AND PARAMETER LIST    @ZM31134
* * FOR THE INVENTORY                                        #Y30LB27
* ********************************************************************/
*                                                                  0796
*   S99RB=S99RB&&S99RB;             /* CLEAR DYN ALLOC RB    #Y30LB27*/
@RF00761 XC    S99RB(20),S99RB                                     0796
*   S99RBLN=TWENTY;                 /* SET LENGTH TO 20      #Y30LB27*/
         MVI   S99RBLN,X'14'                                       0797
*   S99VERB=S99VRBAL;               /* SET VERB CODE         #Y30LB27*/
         MVI   S99VERB,X'01'                                       0798
*   S99NOMNT=ON;                    /* INDICATE DONT MOUNT VOLUME  0799
*                                                            #Y30LB27*/
         OI    S99NOMNT,B'00100000'                                0799
*   S99TXTPP=ADDR(TXTPTR(ONE));     /* INITIALIZE TEXT PTR   @Y30LB27*/
         LA    @08,TXTPTR                                          0800
         ST    @08,S99TXTPP                                        0800
*   S99TUPLN(2)=OFF;                /* INDICATE END OF LIST  @Y30LB27*/
         NI    S99TUPLN+4(@08),B'01111111'                         0801
*   S99TUPLN(4)=ON;                 /* INDICATE END OF LIST  @Y30LB27*/
         OI    S99TUPLN+12(@08),B'10000000'                        0802
*   DO UCATLEN=ONE TO EIGHT WHILE(VVIUCAT(UCATLEN)^=BLANK);/*      0803
*                                                            @Y30LB27*/
         LA    @08,1                                               0803
         STH   @08,UCATLEN                                         0803
@DL00803 LH    @08,UCATLEN                                         0803
         ALR   @08,VVIPTR                                          0803
         CLI   VVIUCAT-1(@08),C' '                                 0803
         BE    @DC00803                                            0803
*   END;                            /*                       @Y30LB27*/
         LA    @08,1                                               0804
         AH    @08,UCATLEN                                         0804
         STH   @08,UCATLEN                                         0804
         C     @08,@CF00039                                        0804
         BNH   @DL00803                                            0804
@DC00803 DS    0H                                                  0805
*   UCATLEN=UCATLEN-ONE;            /* SEARCH FOR BLANK      @Y30LB27*/
         LH    @08,UCATLEN                                         0805
         BCTR  @08,0                                               0805
         STH   @08,UCATLEN                                         0805
*   TXTPTR(ONE)=ADDR(MSVCKEY1);     /* POINT TO INVE PARM    @Y30LB27*/
         LA    @08,MSVCKEY1                                        0806
         ST    @08,TXTPTR                                          0806
*   TXTPTR(TWO)->S99TULNG=UCATLEN+FIVE;/* SET PTR            @Y30LB27*/
         L     @08,TXTPTR+4                                        0807
         LA    @05,5                                               0807
         AH    @05,UCATLEN                                         0807
         STCM  @05,3,S99TULNG(@08)                                 0807
*   TXTPTR(TWO)->S99TUPAR(ONE:UCATLEN)=VVIUCAT;/* ADD CAT NAME     0808
*                                                            @Y30LB27*/
         LH    @05,UCATLEN                                         0808
         BCTR  @05,0                                               0808
         EX    @05,@SM03980                                        0808
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+ONE)=PERIOD;/* SET DELIMITER     0809
*                                                            @Y30LB27*/
         LH    @08,UCATLEN                                         0809
         L     @05,TXTPTR+4                                        0809
         ALR   @05,@08                                             0809
         MVI   S99TUPAR(@05),C'.'                                  0809
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+TWO:UCATLEN+FIVE)=CMSVI;/* @Y30LB27*/
         LH    @08,UCATLEN                                         0810
         L     @05,TXTPTR+4                                        0810
         ALR   @05,@08                                             0810
         MVC   S99TUPAR+1(4,@05),CMSVI                             0810
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+SIX:UCATLEN+NINE)=BLANKS(ONE:FOUR);
         LH    @08,UCATLEN                                         0811
         L     @05,TXTPTR+4                                        0811
         ALR   @05,@08                                             0811
         MVC   S99TUPAR+5(4,@05),BLANKS                            0811
*                                   /* RESET TEXT PARM       @Y30LB27*/
*   S99RBPTR=ADDR(S99RB);           /* POINT TO DYN ALLOC RB @Y30LB27
*                                                            @Y30LB27*/
         LA    @08,S99RB                                           0812
         ST    @08,S99RBPTR                                        0812
*/*********************************************************************
* * DYNAMICALLY ALLOCATE INVENTORY FOR VS/2                  @Y30LB27
* ********************************************************************/
*                                                                  0813
*   REG1=ADDR(S99RBPTR);            /* SET PARM REG          @Y30LB27*/
         LA    REG1,S99RBPTR                                       0813
*   S99RBPND=ON;                    /* INDICATE END OF LIST  @Y30LB27*/
         OI    S99RBPND,B'10000000'                                0814
*LSVC99A:                                                          0815
*   GEN(SVC 99);                    /* ISSUE DYNAMIC ALLOC SVC     0815
*                                                            @Y30LB27*/
LSVC99A  SVC 99
*   IF S99ERROR^=ZERO THEN                                         0816
         LH    @08,S99ERROR                                        0816
         N     @08,@CF03969                                        0816
         LTR   @08,@08                                             0816
         BZ    @RF00816                                            0816
*     DO;                           /* DYNAMIC ALLOCATION ERROR    0817
*                                                            @Y30LB27*/
*       IF S99ERROR=LOCERR THEN     /* LOCATE ERROR          @YM02859*/
         CLC   S99ERROR(2),LOCERR                                  0818
         BNE   @RF00818                                            0818
*         DO;                       /* YES                   @YM02859*/
*           VINMSGID=MSGLOCE;       /* INDICATE LOCATE ERROR @YM02859*/
         MVC   VINMSGID(2),@CH02345                                0820
*           MSGLEN1=TXTPTR(TWO)->S99TULNG;/* SET LENGTH      @YM02859*/
         L     @08,TXTPTR+4                                        0821
         MVC   MSGLEN1(1),S99TULNG+1(@08)                          0821
*           MSGTEXT1=ADDR(TXTPTR(TWO)->S99TUPAR);/* SET NAME@YM02859 */
         LA    @08,S99TUPAR(,@08)                                  0822
         STCM  @08,7,MSGTEXT1                                      0822
*         END;                      /* END LOCATE ERROR      @YM02859*/
*       ELSE                        /* NOT LOCATE ERROR      @YM02859*/
*         VINMSGID=MSGDYNEI;        /* ISSUE ERROR MSG       #Y30LB27*/
         B     @RC00818                                            0824
@RF00818 MVC   VINMSGID(2),@CH00039                                0824
*       CNVRTWK1(ONE:TWO)=S99ERROR; /* ADD TO MSG            @ZM30746*/
@RC00818 MVC   CNVRTWK1(2),S99ERROR                                0825
*       CALL VINCNVRT;              /* VIA CNVRT             @ZM30746*/
         BAL   @14,VINCNVRT                                        0826
*       CALL VINWTO;                /* ISSUE MESSAGE         @YM02859*/
         BAL   @14,VINWTO                                          0827
*     END;                          /*                       @YM02859*/
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF00816 LH    @08,RPLVRETC(,RPLVPTR)                              0829
         N     @08,@CF03969                                        0829
         LTR   @08,@08                                             0829
         BNZ   @RF00829                                            0829
*     DO;                           /*                       @ZM30746*/
*       TIOTPTR=TCBTIO;             /*                       @ZM30746*/
         L     @08,CVTPTR                                          0831
         L     @08,CVTTCBP(,@08)                                   0831
         L     @08,TCBPTR(,@08)                                    0831
         L     @08,TCBTIO(,@08)                                    0831
         ST    @08,TIOTPTR                                         0831
*       DO WHILE TIOELNGH^=ZERO;    /*                       @ZM30746*/
         B     @DE00832                                            0832
@DL00832 DS    0H                                                  0833
*         IF TIOEDDNM=CMSVC THEN    /*                       @ZM30746*/
         L     @08,TIOTPTR                                         0833
         CLC   TIOEDDNM(8,@08),CMSVC                               0833
         BNE   @RF00833                                            0833
*           DO;                     /*                       @ZM31134*/
*             INVUCBAD=TIOEFSRT;    /* SAVE MSVI UCB ADDR    @ZM31134*/
         L     @08,TIOEFSRT-1(,@08)                                0835
         LA    @08,0(,@08)                                         0835
         ST    @08,INVUCBAD                                        0835
*             VVIIUCB=TIOEFSRT;     /* SAVE MSVI UCB ADDR    @ZM31134*/
         L     @08,TIOTPTR                                         0836
         L     @08,TIOEFSRT-1(,@08)                                0836
         LA    @08,0(,@08)                                         0836
         ST    @08,VVIIUCB(,VVIPTR)                                0836
*           END;                    /*                       @ZM31134*/
*         TIOTPTR=TIOTPTR+TWENTY;   /*                       @ZM30746*/
@RF00833 LA    @08,20                                              0838
         AL    @08,TIOTPTR                                         0838
         ST    @08,TIOTPTR                                         0838
*       END;                        /*                       @ZM30746*/
@DE00832 L     @08,TIOTPTR                                         0839
         CLI   TIOELNGH(@08),0                                     0839
         BNE   @DL00832                                            0839
*       TIOTPTR=ZERO;               /*                       @ZM30746*/
         SLR   @08,@08                                             0840
         ST    @08,TIOTPTR                                         0840
*     END;                          /*                       @ZM30746*/
*   RETURN;                         /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00006                                            0842
*   END VINALV2;                    /*                       @Y30LB27*/
         B     @EL00006                                            0843
*                                                                  0844
*/* ******************************************************************
**                                                           @Y30LB27
**    NAME = VINALJ2: SEGMENT TO ALLOCATE JOURNAL            @G24LB04
**                                                           @Y30LB27
**    INPUT = NONE                                           @Y30LB27
**                                                           @Y30LB27
**     PROCESS = VINALV2 IS A SUBSEGMENT OF SEGMENT VININDS. @Y30LB27
**                                                           @Y30LB27
**     OUTPUT = JOURNAL IS ALLOCATED FOR MSVC THE TASK       @Y30LB27
**                                                           @Y30LB27
******************************************************************** */
*                                                                  0844
*VINALJ2:                                                          0844
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINALJ2  ST    @14,@SA00007                                        0844
*/*********************************************************************
* * FOR VS/2 DYNAICALLY ALLOC THE JOURNAL                    @Y30LB27
* ********************************************************************/
*                                                                  0845
*                                   /*                       @Y30LB27*/
*   S99RB=S99RB&&S99RB;             /* CLEAR DYN ALLOC RB    @Y30LB27*/
         XC    S99RB(20),S99RB                                     0845
*   S99RBLN=TWENTY;                 /* SET LENGTH TO 20      @Y30LB27*/
         MVI   S99RBLN,X'14'                                       0846
*   S99VERB=S99VRBAL;               /* SET VERB CODE         @Y30LB27*/
         MVI   S99VERB,X'01'                                       0847
*   S99NOMNT=ON;                    /* INDICATE DONT MOUNT VOLUME  0848
*                                                            @Y30LB27*/
         OI    S99NOMNT,B'00100000'                                0848
*   S99TXTPP=ADDR(TXTPTR(ONE));     /* INITIALIZE TEXT PTR   @Y30LB27*/
         LA    @08,TXTPTR                                          0849
         ST    @08,S99TXTPP                                        0849
*   S99TUPLN(2)=OFF;                /* INDICATE END OF LIST  @Y30LB27*/
         NI    S99TUPLN+4(@08),B'01111111'                         0850
*   S99TUPLN(4)=ON;                 /* INDICATE END OF LIST  @Y30LB27*/
         OI    S99TUPLN+12(@08),B'10000000'                        0851
*/*********************************************************************
* * RESET DYN ALLOC PTRS FOR JOURNAL                         #Y30LB27
* ********************************************************************/
*                                                                  0852
*   TXTPTR(ONE)=ADDR(JRNLKEY1);     /* SET DYN ALLOC TEXT PTR TO JRNL
*                                                            @Y30LB27*/
         LA    @08,JRNLKEY1                                        0852
         ST    @08,TXTPTR                                          0852
*   DO UCATLEN=ONE TO EIGHT WHILE(VVIUCAT(UCATLEN)^=BLANK);/*      0853
*                                                            @Y30LB27*/
         LA    @08,1                                               0853
         STH   @08,UCATLEN                                         0853
@DL00853 LH    @08,UCATLEN                                         0853
         ALR   @08,VVIPTR                                          0853
         CLI   VVIUCAT-1(@08),C' '                                 0853
         BE    @DC00853                                            0853
*   END;                            /*                       @Y30LB27*/
         LA    @08,1                                               0854
         AH    @08,UCATLEN                                         0854
         STH   @08,UCATLEN                                         0854
         C     @08,@CF00039                                        0854
         BNH   @DL00853                                            0854
@DC00853 DS    0H                                                  0855
*   UCATLEN=UCATLEN-ONE;            /* SEARCH FOR BLANK      @Y30LB27*/
         LH    @08,UCATLEN                                         0855
         BCTR  @08,0                                               0855
         STH   @08,UCATLEN                                         0855
*   TXTPTR(TWO)->S99TUPAR(ONE:UCATLEN)=VVIUCAT;/* ADD CAT NAME     0856
*                                                            @Y30LB27*/
         L     @08,TXTPTR+4                                        0856
         LH    @05,UCATLEN                                         0856
         BCTR  @05,0                                               0856
         EX    @05,@SM03980                                        0856
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+ONE)=PERIOD;/* SET DELIMITER     0857
*                                                            @Y30LB27*/
         LH    @08,UCATLEN                                         0857
         L     @05,TXTPTR+4                                        0857
         ALR   @05,@08                                             0857
         MVI   S99TUPAR(@05),C'.'                                  0857
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+TWO:UCATLEN+FIVE)=CMSVC(ONE:FOUR);
         LH    @08,UCATLEN                                         0858
         L     @05,TXTPTR+4                                        0858
         ALR   @05,@08                                             0858
         MVC   S99TUPAR+1(4,@05),CMSVC                             0858
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+SIX:UCATLEN+NINE)=CJRNL;/* #Y30LB27*/
         LH    @08,UCATLEN                                         0859
         L     @05,TXTPTR+4                                        0859
         ALR   @05,@08                                             0859
         MVC   S99TUPAR+5(4,@05),CJRNL                             0859
*   TXTPTR(TWO)->S99TULNG=UCATLEN+NINE;/* SET NAME AND NEW LEN     0860
*                                                            #Y30LB27
*                                                            #Y30LB27*/
         L     @08,TXTPTR+4                                        0860
         LA    @05,9                                               0860
         AH    @05,UCATLEN                                         0860
         STCM  @05,3,S99TULNG(@08)                                 0860
*/*********************************************************************
* * DYN ALLOC THE JOURNAL                                    #Y30LB27
* ********************************************************************/
*                                                                  0861
*   REG1=ADDR(S99RBPTR);            /* SET PARM REG          #Y30LB27*/
         LA    REG1,S99RBPTR                                       0861
*   GEN(SVC 99);                    /* ISSUE DYNAMIC ALLOC SVC     0862
*                                                            #Y30LB27*/
         SVC 99
*   IF S99ERROR^=ZERO THEN                                         0863
         LH    @08,S99ERROR                                        0863
         N     @08,@CF03969                                        0863
         LTR   @08,@08                                             0863
         BZ    @RF00863                                            0863
*     DO;                           /* DYNAMIC ALLOCATION ERROR    0864
*                                                            #Y30LB27*/
*       IF S99ERROR=LOCERR THEN     /* LOCATE ERROR          @YM02859*/
         CLC   S99ERROR(2),LOCERR                                  0865
         BNE   @RF00865                                            0865
*         DO;                       /* YES                   @YM02859*/
*           VINMSGID=MSGLOCE;       /* INDICATE LOCATE ERROR @YM02859*/
         MVC   VINMSGID(2),@CH02345                                0867
*           MSGLEN1=TXTPTR(TWO)->S99TULNG;/* SET LENGTH      @YM02859*/
         L     @08,TXTPTR+4                                        0868
         MVC   MSGLEN1(1),S99TULNG+1(@08)                          0868
*           MSGTEXT1=ADDR(TXTPTR(TWO)->S99TUPAR);/* SET NAME@YM02859 */
         LA    @08,S99TUPAR(,@08)                                  0869
         STCM  @08,7,MSGTEXT1                                      0869
*         END;                      /* END LOCATE ERROR      @YM02859*/
*       ELSE                        /* NOT LOCATE ERROR      @YM02859*/
*         VINMSGID=MSGDYNEJ;        /* ISSUE ERROR MSG       @ZM30746*/
         B     @RC00865                                            0871
@RF00865 MVC   VINMSGID(2),@CH00034                                0871
*       CNVRTWK1(ONE:TWO)=S99ERROR; /* CNVRT ERR CODE        @ZM30746*/
@RC00865 MVC   CNVRTWK1(2),S99ERROR                                0872
*       CALL VINCNVRT;              /* AND ADD TO ERR MSG    @ZM30746*/
         BAL   @14,VINCNVRT                                        0873
*       CALL VINWTO;                /* ISSUE MESSAGE         @YM02859*/
         BAL   @14,VINWTO                                          0874
*     END;                          /*                       @YM02859*/
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF00863 LH    @08,RPLVRETC(,RPLVPTR)                              0876
         N     @08,@CF03969                                        0876
         LTR   @08,@08                                             0876
         BNZ   @RF00876                                            0876
*     DO;                           /*                       @ZM30746*/
*       TIOTPTR=TCBTIO;             /*                       @ZM30746*/
         L     @08,CVTPTR                                          0878
         L     @08,CVTTCBP(,@08)                                   0878
         L     @08,TCBPTR(,@08)                                    0878
         L     @08,TCBTIO(,@08)                                    0878
         ST    @08,TIOTPTR                                         0878
*       DO WHILE TIOELNGH^=ZERO;    /*                       @ZM30746*/
         B     @DE00879                                            0879
@DL00879 DS    0H                                                  0880
*         IF TIOEDDNM=MSVCJRNL THEN /*                       @ZM30746*/
         L     @08,TIOTPTR                                         0880
         CLC   TIOEDDNM(8,@08),MSVCJRNL                            0880
         BNE   @RF00880                                            0880
*           DO;                     /*                       @ZM31134*/
*             JNLUCBAD=TIOEFSRT;    /* SAVE MSVJ UCB ADDR    @ZM31134*/
         L     @08,TIOEFSRT-1(,@08)                                0882
         LA    @08,0(,@08)                                         0882
         ST    @08,JNLUCBAD                                        0882
*             VVIJUCB=TIOEFSRT;     /* SAVE MSVJ UCB ADDR    @ZM31134*/
         L     @08,TIOTPTR                                         0883
         L     @08,TIOEFSRT-1(,@08)                                0883
         LA    @08,0(,@08)                                         0883
         ST    @08,VVIJUCB(,VVIPTR)                                0883
*           END;                    /*                       @ZM31134*/
*         TIOTPTR=TIOTPTR+TWENTY;   /*                       @ZM30746*/
@RF00880 LA    @08,20                                              0885
         AL    @08,TIOTPTR                                         0885
         ST    @08,TIOTPTR                                         0885
*       END;                        /*                       @ZM30746*/
@DE00879 L     @08,TIOTPTR                                         0886
         CLI   TIOELNGH(@08),0                                     0886
         BNE   @DL00879                                            0886
*       TIOTPTR=ZERO;               /*                       @ZM30746*/
         SLR   @08,@08                                             0887
         ST    @08,TIOTPTR                                         0887
*     END;                          /*                       @ZM30746*/
*   RETURN;                         /* RETURN TO MAINLINE    #YM02859*/
@EL00007 DS    0H                                                  0889
@EF00007 DS    0H                                                  0889
@ER00007 L     @14,@SA00007                                        0889
         BR    @14                                                 0889
*   END VINALJ2;                    /*                       #Y30LB27*/
         B     @EL00007                                            0890
*                                                                  0891
*/* ***************************************************************
**                                                           @Y30LB27
**  VINMOPN: OPEN THE MSVC INVENTORY                         @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**        ALLOCATED CONTROL BLOCK STRUCTURE                  @Y30LB27
**        USER CATALOG NAME, VVIUCAT IN ICBVVICB             @Y30LB27
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**        STORAGE IS GOTTEN FROM SUBPOOL 241 AND AN ACB IS   @Y30LB27
**        INITIALIZED FOR MSVC.  AN OPEN MACRO IS THEN       @Y30LB27
**        ISSUED AND, IF UNSUCCESSFUL, A SHOWCB MACRO TO     @Y30LB27
**        DETERMINE IF THE DATA SET IS OPEN.  IF THE DATA    @Y30LB27
**        SET IS OPEN,INDICATING A RECORD/EOF ERROR, THEN A  @Y30LB27
**        VERIFY MACRO IS ISSUED TO CORRECT THE              @Y30LB27
**        FAILURE.  IF THIS ACTION FAILS ALSO, A VINWTO      @Y30LB27
**        ERROR CODE IS SET TO INDICATE THE SOURCE OF ERROR. @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**        1. ACB FOR THE MSVC INVENTORY IS CHAINED TO ICBVVICB     0891
**        2. VINWTO ERROR CODE INDICATING -                  @Y30LB27
**             =0, NO ERROR                                  @Y30LB27
**            ^=0, OPEN ERROR ENCOUNTERED                     @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  0891
*VINMOPN:                                                          0891
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINMOPN  ST    @14,@SA00008                                        0891
*/*********************************************************************
* * ACB ADDRES IS USED AS AN OPEN INDICATOR FOR TASK         @Y30LB27
* * RE-INSTATEMENT IF NON-ZERO ACB IS STILL CONSIDERED OPEN  @Y30LB27
* ********************************************************************/
*                                                                  0892
*   DO WHILE(VVIACBAD=ZERO);        /* ACB BEEN ALLOC        @Y30LB27
*                                                            @Y30LB27*/
         B     @DE00892                                            0892
@DL00892 DS    0H                                                  0893
*/*********************************************************************
* * GET STORAGE FOR ACB                                      @Y30LB27
* ********************************************************************/
*                                                                  0893
*     REG0=MAXDCBLN;                /* GET LENGTH OF ACB INTO REG0   */
         LA    REG0,96                                             0893
*LGETM1:                                                           0894
*     GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR ACB   @Y30LB27*/
LGETM1   GETMAIN RC,LV=(0),SP=241
*     IF REG15^=ZERO THEN                                          0895
         LTR   REG15,REG15                                         0895
         BZ    @RF00895                                            0895
*       DO;                         /* STORAGE OBTAIN        @Y30LB27*/
*         VINMSGID=MSGSTGE;         /* SET MSG ID FOR STORAGE ERROR  */
         MVC   VINMSGID(2),@CH00250                                0897
*         CALL VINWTO;              /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          0898
*         RETURN;                   /* RETURN TO CALLER      @Y30LB27*/
@EL00008 DS    0H                                                  0899
@EF00008 DS    0H                                                  0899
@ER00008 L     @14,@SA00008                                        0899
         BR    @14                                                 0899
*       END;                        /*                       @Y30LB27*/
*     VVIACBAD=REG1;                /* SET ACB ADDRESS       @Y30LB27*/
@RF00895 ST    REG1,VVIACBAD(,VVIPTR)                              0901
*   END;                            /*                       @ZM30746
*                                                            @Y30LB27*/
@DE00892 L     @08,VVIACBAD(,VVIPTR)                               0902
         LTR   @08,@08                                             0902
         BZ    @DL00892                                            0902
*/*********************************************************************
* * SET MODEL ACB INDICATE THAT ITS A CATALOG (SYSTEM DATA   @Y30LB27
* * SET) AND THAT ITS MSVC                                   @Y30LB27
* ********************************************************************/
*                                                                  0903
*   IFGACB=ACBLST;                  /* SET MODEL ACB         @Y30LB27*/
         MVC   IFGACB(76,@08),ACBLST                               0903
*   RJFCBSTG=RJFCBLST;              /* SET LIST FOR RDJFCB   @Y30LB27*/
         L     @05,RJFCBLST                                        0904
         ST    @05,RJFCBSTG                                        0904
*   ACBEXLST=ADDR(JFCBELST);        /* SET EXIT LIST ADDR    @Y30LB27*/
         LA    @05,JFCBELST                                        0905
         ST    @05,ACBEXLST(,@08)                                  0905
*   RFY                                                            0906
*     REG2 RSTD;                    /* PASS ACB ADDR VIS REG2      0906
*                                                            @Y30LB27*/
*   REG2=VVIACBAD;                  /* GET ACB ADDR          @Y30LB27*/
         LR    REG2,@08                                            0907
*   REG1=ADDR(RJFCBSTG);            /* PARMLIST FOR SVC      @Y30LB27*/
         LA    REG1,RJFCBSTG                                       0908
*LREADJF1:                                                         0909
*   GEN(RDJFCB ((REG2),),MF=(E,(REG1)));/* GET THE JFCB ADDR @Y30LB27*/
LREADJF1 RDJFCB ((REG2),),MF=(E,(REG1))
*   RFY                                                            0910
*     REG2 UNRSTD;                  /* RELEASE REG2 TO THE CMPLR   0910
*                                                            @Y30LB27*/
*   IFGACB=ACBLST;                  /* SET MODEL ACB         @Y30LB27*/
         L     @08,VVIACBAD(,VVIPTR)                               0911
         MVC   IFGACB(76,@08),ACBLST                               0911
*   ACBVVIC=ON;                     /* INDICATE MSVC ACB     @Y30LB27*/
*   ACBCAT=ON;                      /* INDICATE BUFFERS FROM 241   0913
*                                                            @Y30LB27*/
         OI    ACBVVIC(@08),B'00010010'                            0913
*   ACBUAPTR=ADDR(CATWKA);          /* POINT TO VSAM CATALOG WORKAREA*/
         LA    @05,CATWKA                                          0914
         ST    @05,ACBUAPTR(,@08)                                  0914
*   TIOTPTR=TCBTIO;                 /* SET TIOT PTR          @Y30LB27*/
         L     @08,CVTPTR                                          0915
         L     @08,CVTTCBP(,@08)                                   0915
         L     @08,TCBPTR(,@08)                                    0915
         L     @08,TCBTIO(,@08)                                    0915
         ST    @08,TIOTPTR                                         0915
*   DO WHILE TIOELNGH^=ZERO;        /* SCAN TO END OF TIOT   @Y30LB27*/
         B     @DE00916                                            0916
@DL00916 DS    0H                                                  0917
*     IF TIOEDDNM=CMSVC THEN        /* FOUND MSVC DDNAME     @Y30LB27*/
         L     @08,TIOTPTR                                         0917
         CLC   TIOEDDNM(8,@08),CMSVC                               0917
         BNE   @RF00917                                            0917
*       QMIDSKAD=ADDR(TIOELNGH);    /* POINT TO TIOT ENTRY   @Y30LB27*/
         LA    @08,TIOELNGH(,@08)                                  0918
         ST    @08,QMIDSKAD                                        0918
*     TIOTPTR=TIOTPTR+TWENTY;       /* NEXT ENTRY            @Y30LB27*/
@RF00917 LA    @08,20                                              0919
         AL    @08,TIOTPTR                                         0919
         ST    @08,TIOTPTR                                         0919
*   END;                            /* END OF TIOT SEARCH    @Y30LB27*/
@DE00916 L     @08,TIOTPTR                                         0920
         CLI   TIOELNGH(@08),0                                     0920
         BNE   @DL00916                                            0920
*   TIOTPTR=ZERO;                   /* RESET TIOT PTR FOR ENABLE   0921
*                                                            @Y30LB27*/
         SLR   @08,@08                                             0921
         ST    @08,TIOTPTR                                         0921
*/*********************************************************************
* * SET MODEL OPEN LIST AND OPEN INV                         @Y30LB27
* ********************************************************************/
*                                                                  0922
*   REG0=VVIACBAD;                  /* SET ACB ADDRESS       @Y30LB27*/
         L     REG0,VVIACBAD(,VVIPTR)                              0922
*   OPNSTG=OPNLST;                  /* GET THE OPEN LIST     @Y30LB27*/
         L     @08,OPNLST                                          0923
         ST    @08,OPNSTG                                          0923
*LOPEN1:                                                           0924
*   GEN(OPEN ((REG0),),MF=(E,OPNSTG));/* OPEN THE ACB        @Y30LB27*/
LOPEN1   OPEN ((REG0),),MF=(E,OPNSTG)
*   RFY                                                            0925
*     IDAAMB BASED(AMBLDTA);        /* POINT TO DATA         @ZA09527*/
*   IF(REG15=ZERO)&(ACBOPEN=ON) THEN/*                       @ZA09527*/
         LTR   REG15,REG15                                         0926
         BNZ   @RF00926                                            0926
         L     @08,VVIACBAD(,VVIPTR)                               0926
         TM    ACBOPEN(@08),B'00010000'                            0926
         BNO   @RF00926                                            0926
*     DO;                           /*                       @ZM30746*/
*       IF(AMBCREAT=OFF) THEN       /* NULL DS               @ZA09527*/
         L     @05,ACBAMBL(,@08)                                   0928
         L     @05,AMBLDTA(,@05)                                   0928
         TM    AMBCREAT(@05),B'10000000'                           0928
         BNZ   @RF00928                                            0928
*         DO;                       /*                       @ZA09527*/
*           RPLVSAM=''B;            /* CLEAR VSAM RPL        @Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                0930
*           RPLDACB=VVIACBAD;       /* SET ACB ADDR          @Y30LB27*/
         LA    @05,56                                              0931
         ALR   @05,RPLVPTR                                         0931
         ST    @08,RPLDACB(,@05)                                   0931
*           RPLLEN=LENGTH(RPLVSAM); /* SET ITS LENGTH        @Y30LB27*/
         MVI   RPLLEN(@05),X'4C'                                   0932
*           RPLNEXIT=ON;            /* NO USER EXITS         @Y30LB27*/
         OI    RPLNEXIT(@05),B'01000000'                           0933
*           RPLCNV=ON;              /* CONTROL INTERVAL PROC @Y30LB27*/
         OI    RPLCNV(@05),B'00100000'                             0934
*           RPLVLOC=OFF;            /* LOCATE OFF            @ZA09527*/
*           RPLVDIR=OFF;            /* DIRECT OFF            @ZA09527*/
*           RPLVNEXT=OFF;           /* NO EXIT               @ZA09527*/
         NI    RPLVLOC(RPLVPTR),B'00011111'                        0937
*           RPLKGE=OFF;             /* NO KGE                @ZA09527*/
         NI    RPLKGE(@05),B'11111011'                             0938
*           RPLUPD=OFF;             /* NO UPDATE             @ZA09527*/
*           RPLKEY=OFF;             /* NO KEY                @ZA09527
*                                                            @Y30LB27*/
         NI    RPLUPD(@05),B'01111101'                             0940
*/*********************************************************************
* * ISSUE VERIFY                                             @Y30LB27
* ********************************************************************/
*                                                                  0941
*           REG1=ADDR(RPLVSAM);     /* SET RPL ADDR          @Y30LB27*/
         LA    REG1,RPLVSAM(,RPLVPTR)                              0941
*LVER1:                                                            0942
*           GEN(VERIFY RPL=(REG1)); /* ISSUE VERIFY          @Y30LB27
*                                                            @Y30LB27*/
LVER1    VERIFY RPL=(REG1)
*           RPLKEY=ON;              /* KEY SPECIFIED         @ZA09527*/
         LA    @08,56                                              0943
         ALR   @08,RPLVPTR                                         0943
         OI    RPLKEY(@08),B'10000000'                             0943
*           RPLVLOC=OFF;            /* NO LOCATE             @ZA09527*/
*           RPLVDIR=OFF;            /* NO DIRECT             @ZA09527*/
*           RPLVNEXT=OFF;           /* NO EXIT               @ZA09527*/
*           RPLVKGE=OFF;            /* NO KGE                @ZA09527*/
         NI    RPLVLOC(RPLVPTR),B'00011011'                        0947
*           RPLCNV=OFF;             /* NO CONTROL INTERVAL   @ZA09527*/
         NI    RPLCNV(@08),B'11011111'                             0948
*           RPLVUPD=OFF;            /* NO UPDATE             @ZA09527*/
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0949
*         END;                      /*                       @ZA09527*/
*     END;                          /*                       @Y30LB27*/
*   ELSE                            /*                       @ZM30746*/
*     DO;                           /*                       @ZM30746*/
         B     @RC00926                                            0952
@RF00926 DS    0H                                                  0953
*       RETRYSW=OFF;                /*                       @ZM30746*/
         NI    RETRYSW,B'01111111'                                 0953
*       VINMSGID=MSGOPNEI;          /*                       @ZM30746*/
         MVC   VINMSGID(2),@CH00035                                0954
*       CNVRTWK1(ONE)=''B;          /*                       @ZM30746*/
         MVI   CNVRTWK1,X'00'                                      0955
*       CNVRTWK1(TWO)=ACBERFLG;     /*                       @ZM30746*/
         L     @08,VVIACBAD(,VVIPTR)                               0956
         MVC   CNVRTWK1+1(1),ACBERFLG(@08)                         0956
*       CALL VINCNVRT;              /*                       @ZM30746*/
         BAL   @14,VINCNVRT                                        0957
*       CALL VINWTO;                /*                       @ZM30746*/
         BAL   @14,VINWTO                                          0958
*     END;                          /*                       @ZM30746*/
*   END VINMOPN;                    /*                       @Y30LB27*/
         B     @EL00008                                            0960
*                                                                  0961
*/* ****************************************************************
**                                                           @Y30LB27
**  VINJOPN: OPEN THE MSVC JOURNAL                           @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**        1. CONTROL BLOCK CONFIGURATION SET BY ALLOCATION   @Y30LB27
**        2. VVIUCAT, IN ICBVVICB, = MSVC VSAM USER CATALOG  @Y30LB27
**           NAME                                            @Y30LB27
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**        STORAGE IS OBTAINED FROM SUBPOOL 241, A DCB IS     @Y30LB27
**        CREATED, AND AN OPENJ MACRO ISSUED. THE DCB IS     @Y30LB27
**        CHAINED TO THE ICBVVICB.                           @Y30LB27
**                                                           @Y30LB27
**        IF AN ERROR IS ENCOUNTERED DUE TO OPEN, AN         @Y30LB27
**        ERROR CODE, VINWTO, IS SET TO INDICATE THE SOURCE  @Y30LB27
**        OF FAILURE.                                        @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**        IF JOURNAL SUCCESSFULLY OPENED -                   @Y30LB27
**           1. DCB IS CHAINED TO ICBVVICB                   @Y30LB27
**           2. VINWTO CODE = 0                              @Y30LB27
**        IF JOURNAL UNSUCCESSFULLY OPENED -                 @Y30LB27
**           1. VINWTO CODE ^= 0                             @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  0961
*VINJOPN:                                                          0961
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27*/
VINJOPN  ST    @14,@SA00009                                        0961
*/*********************************************************************
* * DCB ADDRESS IS USED AS INDICATOR THAT DCB IS OPEN ALREADY FOR TASK
* * RE-INSTATEMENT                                           @Y30LB27
* ********************************************************************/
*                                                                  0962
*   DO WHILE(VVIDCBAD=ZERO);        /* ALREADY OPENED        @Y30LB27
*                                                            @Y30LB27*/
         B     @DE00962                                            0962
@DL00962 DS    0H                                                  0963
*/*********************************************************************
* * GET STORAGE FOR DCB                                      @G24LB04
* ********************************************************************/
*                                                                  0963
*     REG0=MAXDCBLN;                /* GET LENGTH OF DCB     @Y30LB27*/
         LA    REG0,96                                             0963
*LGETM2:                                                           0964
*     GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR ACB   @Y30LB27*/
LGETM2   GETMAIN RC,LV=(0),SP=241
*     IF REG15^=ZERO THEN                                          0965
         LTR   REG15,REG15                                         0965
         BZ    @RF00965                                            0965
*       DO;                         /* STORAGE OBTAIN        @Y30LB27*/
*         VINMSGID=MSGSTGE;         /* SET MSG INDEX         @Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                0967
*         CALL VINWTO;              /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          0968
*         RETURN;                   /* RETURN TO CALLER      @Y30LB27*/
@EL00009 DS    0H                                                  0969
@EF00009 DS    0H                                                  0969
@ER00009 L     @14,@SA00009                                        0969
         BR    @14                                                 0969
*       END;                        /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * EST DCB                                                  @Y30LB27
* ********************************************************************/
*                                                                  0971
*     VVIDCBAD=REG1;                /* SET DCB ADDRESS       @Y30LB27*/
@RF00965 ST    REG1,VVIDCBAD(,VVIPTR)                              0971
*     REG0=REG1;                    /* SET DCB ADDRESS       @Y30LB27*/
         LR    REG0,REG1                                           0972
*     DCBPTR=REG1;                  /* SET DCB POINTER       @Y30LB27*/
         ST    REG1,DCBPTR                                         0973
*     IHADCB=DCBLST;                /* MOVE DCB INTO STORAGE @Y30LB27*/
         L     @08,DCBPTR                                          0974
         MVC   IHADCB(52,@08),DCBLST                               0974
*     OPNSTG=OPNLST;                /* SET OPEN LIST         @Y30LB27
*                                                            @Y30LB27*/
         L     @08,OPNLST                                          0975
         ST    @08,OPNSTG                                          0975
*/*********************************************************************
* * FOR VS/2 JUST DO NORMAL OPEN                             @Y30LB27
* ********************************************************************/
*                                                                  0976
*     GEN(OPEN ((REG0),),MF=(E,OPNSTG));/* OPEN IT           @Y30LB27
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         OPEN ((REG0),),MF=(E,OPNSTG)
*     IF DCBOFOPN^=ON THEN                                         0977
         L     @08,DCBPTR                                          0977
         TM    DCBOFOPN+40(@08),B'00010000'                        0977
         BO    @RF00977                                            0977
*       DO;                         /* OPEN ERROR            @Y30LB27*/
*         VINMSGID=MSGOPNEJ;        /* YES                   @Y30LB27*/
         MVC   VINMSGID(2),@CH00033                                0979
*         CALL VINWTO;              /* ISSUE ERROR MSG       @Y30LB27*/
         BAL   @14,VINWTO                                          0980
*         RETURN;                   /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00009                                            0981
*       END;                        /*                       @Y30LB27*/
*   END;                            /*                       @Y30LB27*/
@RF00977 DS    0H                                                  0983
@DE00962 L     @08,VVIDCBAD(,VVIPTR)                               0983
         LTR   @08,@08                                             0983
         BZ    @DL00962                                            0983
*   END VINJOPN;                    /*                       @Y30LB27*/
         B     @EL00009                                            0984
*                                                                  0985
*/* ***************************************************************
**                                                          @Y30LB27
**  VINCRTDS: SEGMENT TO CREATE AND WRITE MSVC CONTROL      @Y30LB27
**            RECORDS TO THE MSVC INVENTORY AT FIRST IPL    @Y30LB27
**            AFTER SYSGEN                                  @Y30LB27
**                                                          @Y30LB27
**  INPUT:                                                   @Y30LB27
**     . VSAM OPEN CONTROL BLOCK CONFIGURATION FOR MSVC      @Y30LB27
**       INVENTORY                                           @Y30LB27
**     . ICBVVICB WITH THE FOLLOWING FIELDS UPDATED          @Y30LB27
**         FROM VVIKEY00: VVIUCAT, MSVC VSAM USER CATALOG    @Y30LB27
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**     STORAGE IS OBTAINED FOR A BUFFER AND THE FOLLOWING    @Y30LB27
**     RECORDS ARE CREATED AND WRITTEN TO THE MSVC INVENTORY:@Y30LB27
**          SYSGROUP (DEFAULT) HEADER RECORD                 @Y30LB27
**          NON-GROUPED HEADER RECORD                        @Y30LB27
**          CPU ASSOCIATION RECORD                           @Y30LB27
**                                                           @Y30LB27
**     WHEN THESE RECORDS ARE WRITTEN, THE DATA SET IS       @Y30LB27
**     CLOSED AND REOPENED.  THIS STEP IS A VSAM REQUIREMENT @Y30LB27
**     SINCE, ON INITIAL UPDATES TO A VSAM KSDS DATA SET,    @Y30LB27
**     ALL UPDATES MUST BE IN KEYED SEQUENTIAL ORDER.        @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**   IF SUCCESSFUL,                                          @Y30LB27
**     VINWTO CODE =0, INDICATING DATA SET INITIALIZED       @Y30LB27
**     THE MSVC INVENTORY IS UPDATED TO INCLUDE THE ABOVE    @Y30LB27
**     RECORDS                                               @Y30LB27
**   IF UNSUCCESSFUL,                                        @Y30LB27
**     VINWTO CODE ^=0, INDICATING THE REASON FOR FAILURE    @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  0985
*VINCRTDS:                                                         0985
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINCRTDS ST    @14,@SA00010                                        0985
*/*********************************************************************
* * GET STORAGE FOR MAXIMUM RECORD BUFFER                    @G24LB04
* ********************************************************************/
*                                                                  0986
*   REG0=MAXREC;                    /* GET LENGTH OF         @Y30LB27
*                                      MAXIMUM RECORD        @G24LB04*/
         LA    REG0,1024                                           0986
*LGETM3:                                                           0987
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GET STORAGE FOR ACB   @Y30LB27*/
LGETM3   GETMAIN RC,LV=(0),SP=241
*   IF REG15^=ZERO THEN                                            0988
         LTR   REG15,REG15                                         0988
         BZ    @RF00988                                            0988
*     DO;                           /* STORAGE OBTAIN        @Y30LB27*/
*       VINMSGID=MSGSTGE;           /* SET MSG ID FOR ERROR  @Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                0990
*       CALL VINWTO;                /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          0991
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
@EL00010 DS    0H                                                  0992
@EF00010 DS    0H                                                  0992
@ER00010 L     @14,@SA00010                                        0992
         BR    @14                                                 0992
*     END;                          /*                       @Y30LB27*/
*   CPUIDPTR=REG1;                  /* SET PTR FOR GROUP RECORD    0994
*                                                            @Y30LB27
*                                                            @Y30LB27*/
@RF00988 ST    REG1,CPUIDPTR                                       0994
*/*********************************************************************
* * INITIALIZE CPU ASSOC RECORD                              @Y30LB27
* ********************************************************************/
*                                                                  0995
*   CPUID=''B;                      /* INIT. THE NON-GRUOP RECORD  0995
*                                                            @Y30LB27*/
         L     @08,CPUIDPTR                                        0995
         XC    CPUID(151,@08),CPUID(@08)                           0995
*   CPUNAME=CCPUIDK;                /* SET NON-GROUP KEY     @Y30LB27*/
         MVC   CPUNAME(13,@08),CCPUIDK                             0996
*   CPUASSOC=ON;                    /*                       @YM30000*/
         OI    CPUASSOC(@08),B'00000010'                           0997
*   RFY                                                            0998
*     IDAAMB BASED(AMBLIX);         /* SET AMB POINTER       @ZM31134*/
*   CPUINEXT=AMDNEXT;               /* SET NUMBER OF INDEX EXTENTS 0999
*                                                            @ZM31134*/
         L     @05,VVIACBAD(,VVIPTR)                               0999
         L     @05,ACBAMBL(,@05)                                   0999
         L     @04,AMBLIX(,@05)                                    0999
         L     @04,AMBDSB(,@04)                                    0999
         LH    @04,AMDNEXT(,@04)                                   0999
         STH   @04,CPUINEXT(,@08)                                  0999
*   RFY                                                            1000
*     IDAAMB BASED(AMBLDTA);        /* SET AMB POINTER       @ZM31134*/
*   CPUDNEXT=AMDNEXT;               /* SET NUMBER OF DATA EXTENTS  1001
*                                                            @ZM31134*/
         L     @05,AMBLDTA(,@05)                                   1001
         L     @05,AMBDSB(,@05)                                    1001
         LH    @05,AMDNEXT(,@05)                                   1001
         STH   @05,CPUDNEXT(,@08)                                  1001
*   DO I=ONE TO SIXTEEN;            /* 16 SLOTS              @Y30LB27*/
         LA    I,1                                                 1002
@DL01002 DS    0H                                                  1003
*     CPUIDREC(I)='';               /* BLANK THE IDS         @Y30LB27*/
         L     @05,CPUIDPTR                                        1003
         LR    @04,I                                               1003
         SLA   @04,3                                               1003
         ST    @04,@TF00001                                        1003
         ALR   @04,@05                                             1003
         MVI   CPUIDREC-8(@04),C' '                                1003
         MVC   CPUIDREC-7(4,@04),CPUIDREC-8(@04)                   1003
*     CPUMASK(I)=''B;               /* ZERO THE MASKS        @Y30LB27*/
         LR    @04,@05                                             1004
         AL    @04,@TF00001                                        1004
         XC    CPUMASK-8(2,@04),CPUMASK-8(@04)                     1004
*     CPUPURGE=''B;                 /* NOBODY TO PURGE       @Y30LB27*/
         XC    CPUPURGE(2,@05),CPUPURGE(@05)                       1005
*   END;                            /*                       @Y30LB27
*                                                            @Y30LB27*/
         AL    I,@CF00055                                          1006
         C     I,@CF00167                                          1006
         BNH   @DL01002                                            1006
*/*********************************************************************
* * INITIALIZE VSAM RPL                                      @Y30LB27
* ********************************************************************/
*                                                                  1007
*   RPLVSAM=''B;                    /* CLEAR VSAM RPL        @Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1007
*   RPLVTYP=RPLVPUT;                /* PUT                   @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1008
*   RPLVBUF=CPUIDPTR;               /* SET BUFFER ADDR       @Y30LB27*/
         L     @08,CPUIDPTR                                        1009
         ST    @08,RPLVBUF(,RPLVPTR)                               1009
*   RPLVKEY=CPUIDPTR;               /* SET KEY ADDR          @Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1010
*   RPLVRLN=LENGTH(CPUID);          /* RECORD LENGTH         @Y30LB27*/
         LA    @08,151                                             1011
         ST    @08,RPLVRLN(,RPLVPTR)                               1011
*   RPLVBLN=LENGTH(CPUID);          /* BUFFER LENGTH         @Y30LB27
*                                                            @Y30LB27*/
         ST    @08,RPLVBLN(,RPLVPTR)                               1012
*/*********************************************************************
* * WRITE CPU ASSOC REC                                      @Y30LB27
* ********************************************************************/
*                                                                  1013
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1013
*   CALL ICBVIO00;                  /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1014
         BALR  @14,@15                                             1014
*   IF RPLVRETC^=ZERO THEN                                         1015
         LH    @08,RPLVRETC(,RPLVPTR)                              1015
         N     @08,@CF03969                                        1015
         LTR   @08,@08                                             1015
         BZ    @RF01015                                            1015
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1017
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1018
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1019
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1020
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1020
*       CALL VINCNVRT;              /* CNVRT IT              @Y30LB27*/
         BAL   @14,VINCNVRT                                        1021
*       CALL VINWTO;                /* ISSUE THE MSG         @Y30LB27*/
         BAL   @14,VINWTO                                          1022
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00010                                            1023
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * INIT SYSGROUP RECORD                                     @Y30LB27
* ********************************************************************/
*                                                                  1025
*   GROUPPTR=CPUIDPTR;              /* SET PTR               @Y30LB27*/
@RF01015 L     @08,CPUIDPTR                                        1025
         ST    @08,GROUPPTR                                        1025
*   GROUP=''B;                      /* INIT. THE GROUOP RECORD     1026
*                                                            @Y30LB27*/
         XC    GROUP(164,@08),GROUP(@08)                           1026
*   GRONAME=CSYSGRPK;               /* SET SYSGROUP KEY      @Y30LB27*/
         MVC   GRONAME(13,@08),CSYSGRPK                            1027
*   GROBLANK='';                    /* RECORD ID             @Y30LB27*/
         MVI   GROBLANK(@08),C' '                                  1028
*   GROFSN='';                      /* SER # OF 1ST VOLUME   @Y30LB27*/
         MVI   GROFSN(@08),C' '                                    1029
         MVC   GROFSN+1(5,@08),GROFSN(@08)                         1029
*   GROLSN='';                      /* SER # OF LAST VOLUME  @Y30LB27*/
         MVI   GROLSN(@08),C' '                                    1030
         MVC   GROLSN+1(5,@08),GROLSN(@08)                         1030
*   GROERRTS='';                    /* ERROR TIME STAMP      @Y30LB27*/
         MVI   GROERRTS(@08),C' '                                  1031
         MVC   GROERRTS+1(7,@08),GROERRTS(@08)                     1031
*   GRODESCR='';                    /* DESCRIPTION           @Y30LB27*/
         MVI   GRODESCR(@08),C' '                                  1032
         MVC   GRODESCR+1(29,@08),GRODESCR(@08)                    1032
*   GROOWNER='';                    /* OWNER                 @Y30LB27*/
         MVI   GROOWNER(@08),C' '                                  1033
         MVC   GROOWNER+1(9,@08),GROOWNER(@08)                     1033
*   GROADDR='';                     /* ADDR OF GROUP OWNER   @Y30LB27*/
         MVI   GROADDR(@08),C' '                                   1034
         MVC   GROADDR+1(29,@08),GROADDR(@08)                      1034
*   GROGVR=ON;                      /* VOLUME RECORD         @Y30LB27*/
         OI    GROGVR(@08),B'10000000'                             1035
*   GROPSPD=EIGHT;                  /* PRIMARY SPACE         @Y30LB27*/
         LA    @05,8                                               1036
         STH   @05,GROPSPD(,@08)                                   1036
*   GROSSPD=EIGHT;                  /* SECONDARY SPACE       @Y30LB27
*                                                            @Y30LB27*/
         STH   @05,GROSSPD(,@08)                                   1037
*/*********************************************************************
* * SET UP RPL AND WRITE SYSGROUP RECORD                     @Y30LB27
* ********************************************************************/
*                                                                  1038
*   RPLVRLN=LENGTH(GROUP);          /* SET LENGTH TO GROUP LENGTH  1038
*                                                            @Y30LB27*/
         LA    @08,164                                             1038
         ST    @08,RPLVRLN(,RPLVPTR)                               1038
*   RPLVBLN=LENGTH(GROUP);          /* SET LENGTH TO GROUP LENGTH  1039
*                                                            @Y30LB27*/
         ST    @08,RPLVBLN(,RPLVPTR)                               1039
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1040
*   CALL ICBVIO00;                  /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1041
         BALR  @14,@15                                             1041
*   IF RPLVRETC^=ZERO THEN                                         1042
         LH    @08,RPLVRETC(,RPLVPTR)                              1042
         N     @08,@CF03969                                        1042
         LTR   @08,@08                                             1042
         BZ    @RF01042                                            1042
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1044
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1045
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1046
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1047
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1047
*       CALL VINCNVRT;              /* INVOKE CNVRSION RTN   @Y30LB27*/
         BAL   @14,VINCNVRT                                        1048
*       CALL VINWTO;                /* ISSUE ERROR MSG       @Y30LB27*/
         BAL   @14,VINWTO                                          1049
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00010                                            1050
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * INITAILZE NON-GROUPED HEADER RECORD                      @Y30LB27
* ********************************************************************/
*                                                                  1052
*   NGVRPTR=GROUPPTR;               /* SET PTR FOR NON-GROUP VOLUME
*                                      RECORD                @Y30LB27*/
@RF01042 L     @08,GROUPPTR                                        1052
         ST    @08,NGVRPTR                                         1052
*   NGVR=''B;                       /* INIT. THE NON-GRUOP RECORD  1053
*                                                            @Y30LB27*/
         XC    NGVR(40,@08),NGVR(@08)                              1053
*   GRONAME=CNGRPK;                 /* SET NON-GROUP KEY     @Y30LB27*/
         L     @05,GROUPPTR                                        1054
         MVC   GRONAME(13,@05),CNGRPK                              1054
*   NGVHDR=ON;                      /* HDR FLAG              @Y30LB27*/
         OI    NGVHDR(@08),B'00000001'                             1055
*   NGVFVOL='';                     /* 1ST VOL SER           @Y30LB27*/
         MVI   NGVFVOL(@08),C' '                                   1056
         MVC   NGVFVOL+1(5,@08),NGVFVOL(@08)                       1056
*   NGVLVOL='';                     /* LAST VOL SER          @Y30LB27
*                                                            @Y30LB27*/
         MVI   NGVLVOL(@08),C' '                                   1057
         MVC   NGVLVOL+1(5,@08),NGVLVOL(@08)                       1057
*/*********************************************************************
* * UPDATE VSAM RPL AND WRITE NON-GROUPED VOLUME HEADER      @Y30LB27
* ********************************************************************/
*                                                                  1058
*   RPLVRLN=LENGTH(NGVR);           /* SET GROUP LENGTH      @Y30LB27*/
         LA    @08,40                                              1058
         ST    @08,RPLVRLN(,RPLVPTR)                               1058
*   RPLVBLN=LENGTH(NGVR);           /* SET GROUP LENGTH      @Y30LB27*/
         ST    @08,RPLVBLN(,RPLVPTR)                               1059
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1060
*   CALL ICBVIO00;                  /* CALL ICBVIO00         @Y30LB27*/
         L     @15,@CV03332                                        1061
         BALR  @14,@15                                             1061
*   IF RPLVRETC^=ZERO THEN                                         1062
         LH    @08,RPLVRETC(,RPLVPTR)                              1062
         N     @08,@CF03969                                        1062
         LTR   @08,@08                                             1062
         BZ    @RF01062                                            1062
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1064
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1065
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1066
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1067
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1067
*       CALL VINCNVRT;              /* SET IN MSG CMP LIST   @Y30LB27*/
         BAL   @14,VINCNVRT                                        1068
*       CALL VINWTO;                /* ISSUE THE ERROR MSG   @Y30LB27*/
         BAL   @14,VINWTO                                          1069
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00010                                            1070
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * CLOSE THE INVENTORY                                      @Y30LB27
* ********************************************************************/
*                                                                  1072
*   REG0=VVIACBAD;                  /* SET ACB ADDRESS       @Y30LB27*/
@RF01062 L     REG0,VVIACBAD(,VVIPTR)                              1072
*   CLSSTG=CLSLST;                  /* SET THE CLOSE LIST    @Y30LB27*/
         L     @08,CLSLST                                          1073
         ST    @08,CLSSTG                                          1073
*LCLOSE2:                                                          1074
*   GEN(CLOSE ((REG0),),MF=(E,CLSSTG));/* CLOSE THE ACB      @Y30LB27*/
LCLOSE2  CLOSE ((REG0),),MF=(E,CLSSTG)
*   RPLVSAM=''B;                    /* CLEAR RPL             @ZM31138
*                                                            @Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1075
*/*********************************************************************
* * RE-OPEN THE INVENTORY                                    @Y30LB27
* ********************************************************************/
*                                                                  1076
*   CALL VINMOPN;                   /* RE-OPEN THE INVENTORY @Y30LB27*/
         BAL   @14,VINMOPN                                         1076
*   RETURN;                         /* RETURN TO VIN MAINLINE      1077
*                                                            @Y30LB27*/
         B     @EL00010                                            1077
*   END VINCRTDS;                   /*                       @Y30LB27*/
*                                                                  1079
*/********************************************************   @ZA05115
**                                                           @ZA05115
**    NAME = UPDTRCDS                                        @ZA05115
**                                                           @ZA05115
**    INPUT= NONE                                            @ZA05115
**                                                           @ZA05115
**    PROCESS = UPDATE THE CPUID RECORD                      @ZA05115
**                                                           @ZA05115
**    OUTPUT = THE CPUID RECORD IS UPDATED                   @ZA05115
**                                                           @ZA05115
**********************************************************   @ZA05115*/
*                                                                  1079
*UPDTRCDS:                                                         1079
*   PROC OPTIONS(SAVE(14));                                        1079
*                                                                  1079
UPDTRCDS ST    @14,@SA00011                                        1079
*/*********************************************************************
* * GET MAX RECORD BUFFER IF NOT ALREADY OBTAINED            @ZA05115
* ********************************************************************/
*                                                                  1080
*   DO WHILE(CPUIDPTR=ZERO);        /* RECORD BUFFER OBTAINED      1080
*                                                            @ZA05115*/
         B     @DE01080                                            1080
@DL01080 DS    0H                                                  1081
*     REG0=MAXREC;                  /* GET LENGTH OF         @ZA05115
*                                      MAXIMUM RECORD        @ZA05115*/
         LA    REG0,1024                                           1081
*LGETM9:                                                           1082
*     GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE           @ZA05115
*                                      FOR ACB               @ZA05115*/
LGETM9   GETMAIN RC,LV=(0),SP=241
*     IF REG15^=ZERO THEN                                          1083
         LTR   REG15,REG15                                         1083
         BZ    @RF01083                                            1083
*       DO;                         /* STORAGE OBTAIN        @ZA05115*/
*         VINMSGID=MSGSTGE;         /* SET MSG ID            @ZA05115*/
         MVC   VINMSGID(2),@CH00250                                1085
*         CALL VINWTO;              /* PRINT ERROR MESSAGE   @ZA05115*/
         BAL   @14,VINWTO                                          1086
*         RETURN;                   /* RETURN TO CALLER      @ZA05115*/
@EL00011 DS    0H                                                  1087
@EF00011 DS    0H                                                  1087
@ER00011 L     @14,@SA00011                                        1087
         BR    @14                                                 1087
*       END;                        /*                       @ZA05115*/
*     CPUIDPTR=REG1;                /* SET PTR FOR RECORD    @ZA05115
*                                      BUFFER                @ZA05115*/
@RF01083 ST    REG1,CPUIDPTR                                       1089
*   END;                            /* BUFFER OBTAINED       @ZA05115*/
@DE01080 L     @08,CPUIDPTR                                        1090
         LTR   @08,@08                                             1090
         BZ    @DL01080                                            1090
*/*********************************************************************
* * GET CPU ASSOCIATION RECORD                               @ZA05115
* ********************************************************************/
*                                                                  1091
*   RPLVTYP=RPLVREAD;               /* INDICATE READ         @ZA05115*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1091
*   RPLVUPD=ON;                     /* FOR UPDATE            @ZA05115*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1092
*   RPLVBUF=CPUIDPTR;               /* SET BUFFER ADDRESS    @ZA05115*/
         ST    @08,RPLVBUF(,RPLVPTR)                               1093
*   RPLVKEY=CPUIDPTR;               /* SET KEY ADDRESS       @ZA05115*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1094
*   RPLVRLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @ZA05115*/
         LA    @05,151                                             1095
         ST    @05,RPLVRLN(,RPLVPTR)                               1095
*   RPLVBLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @ZA05115*/
         ST    @05,RPLVBLN(,RPLVPTR)                               1096
*   CPUNAME=CCPUIDK;                /* SET KWY ADDR          @ZA05115*/
         MVC   CPUNAME(13,@08),CCPUIDK                             1097
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @ZA05115*/
         LR    REG1,RPLVPTR                                        1098
*   CALL ICBVIO00;                  /* GET CPUID REC         @ZA05115*/
         L     @15,@CV03332                                        1099
         BALR  @14,@15                                             1099
*   IF RPLVRETC^=ZERO THEN                                         1100
         LH    @08,RPLVRETC(,RPLVPTR)                              1100
         N     @08,@CF03969                                        1100
         LTR   @08,@08                                             1100
         BZ    @RF01100                                            1100
*     DO;                           /* VSAM I/O ERROR        @ZA05115*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @ZA05115*/
         MVC   VINMSGID(2),@CH00172                                1102
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @ZA05115*/
         MVI   MSGLEN1,X'0C'                                       1103
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @ZA05115*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1104
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @ZA05115*/
         MVI   CNVRTWK1+2,X'00'                                    1105
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1105
*       CALL VINCNVRT;              /* TO MSG                @ZA05115*/
         BAL   @14,VINCNVRT                                        1106
*       CALL VINWTO;                /* ISSUE MESSAGE         @ZA05115*/
         BAL   @14,VINWTO                                          1107
*       RETURN;                     /* RETURN TO CALLER      @ZA05115*/
         B     @EL00011                                            1108
*     END;                          /*                       @ZA05115*/
*                                                                  1109
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE NUMBER OF EXTENTS IN THE CPU ID            @ZA05115*/
*   /* RECORD                                                @ZA05115*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1110
*   RFY                                                            1110
*     IDAAMB BASED(AMBLIX);         /* SET AMB POINTER       @ZA05115*/
@RF01100 DS    0H                                                  1111
*   CPUINEXT=AMDNEXT;               /* SET NUMBER OF INDEX EXTENTS 1111
*                                                            @ZA05115*/
         L     @08,CPUIDPTR                                        1111
         L     @05,VVIACBAD(,VVIPTR)                               1111
         L     @05,ACBAMBL(,@05)                                   1111
         L     @04,AMBLIX(,@05)                                    1111
         L     @04,AMBDSB(,@04)                                    1111
         LH    @04,AMDNEXT(,@04)                                   1111
         STH   @04,CPUINEXT(,@08)                                  1111
*   RFY                                                            1112
*     IDAAMB BASED(AMBLDTA);        /* SET AMB POINTER       @ZA05115*/
*   CPUDNEXT=AMDNEXT;               /* SET NUMBER OF DATA EXTENTS  1113
*                                                            @ZA05115*/
         L     @05,AMBLDTA(,@05)                                   1113
         L     @05,AMBDSB(,@05)                                    1113
         LH    @05,AMDNEXT(,@05)                                   1113
         STH   @05,CPUDNEXT(,@08)                                  1113
*/*********************************************************************
* * MODIFY RPL AND PUT THE UPDATED CPU ASSOC RECORD          @ZA05115
* ********************************************************************/
*                                                                  1114
*   RPLVTYP=RPLVPUT;                /* INDICATE READ         @ZA05115*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1114
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @ZA05115*/
         LR    REG1,RPLVPTR                                        1115
*   CALL ICBVIO00;                  /* WRITE THE RECORD      @ZA05115*/
         L     @15,@CV03332                                        1116
         BALR  @14,@15                                             1116
*   IF RPLVRETC^=ZERO THEN                                         1117
         LH    @08,RPLVRETC(,RPLVPTR)                              1117
         N     @08,@CF03969                                        1117
         LTR   @08,@08                                             1117
         BZ    @RF01117                                            1117
*     DO;                           /* VSAM I/O ERROR        @ZA05115*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @ZA05115*/
         MVC   VINMSGID(2),@CH00172                                1119
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @ZA05115*/
         MVI   MSGLEN1,X'0C'                                       1120
*       MSGTEXT1=RPLVKEY;           /* SET KEY ADDR          @ZA05115*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1121
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @ZA05115*/
         MVI   CNVRTWK1+2,X'00'                                    1122
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1122
*       CALL VINCNVRT;              /* AND ADD TO MSG        @ZA05115*/
         BAL   @14,VINCNVRT                                        1123
*       CALL VINWTO;                /* ISSUE MESSAGE         @ZA05115*/
         BAL   @14,VINWTO                                          1124
*       RETURN;                     /* RETURN TO CALLER      @ZA05115*/
         B     @EL00011                                            1125
*     END;                          /*                       @ZA05115*/
*/*********************************************************************
* * UPDATE VSAM RPL AND ISSUE ENDREC                         @ZA05115
* ********************************************************************/
*                                                                  1127
*   RPLVTYP=RPLVENDR;               /* INDICATE PUT TO VSAM  @ZA05115*/
@RF01117 MVI   RPLVTYP(RPLVPTR),X'04'                              1127
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @ZA05115*/
         LR    REG1,RPLVPTR                                        1128
*   CALL ICBVIO00;                  /* ISSUE ENDREC          @ZA05115*/
         L     @15,@CV03332                                        1129
         BALR  @14,@15                                             1129
*   RPLVSAM=''B;                    /* CLEAR RPL             @ZA05115*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1130
*   END UPDTRCDS;                   /*                       @ZA05515*/
         B     @EL00011                                            1131
*                                                                  1132
*/* ******************************************************************
**                                                           @Y30LB27
**     NAME = VINTBUPT: UPDATE INVENTORY WITH IPL ACTIVITY   @Y30LB27
**                                                           @Y30LB27
**     INPUT = RPL CHAIN CONSTRUCTED BY ICBVPI00, CHAINED    @Y30LB27
**     FROM THE LOW PRIORITY IPL QUEUE OF THE ICBMSVCB       @Y30LB27
**     CONTROL BLOCK AND THE 'USERCAT.MSVI' DATA SET.        @Y30LB27
**                                                           @Y30LB27
**     PROCESS = VINTBUPT TAKES THE RPL BUILT BY             @Y30LB27
**     ICBVPI00, CHAINED FROM THE ICBVVICB CONTROL BLOCK     @Y30LB27
**     (LOW PRIORITY RPL QUEUE), AND EXTRACTS THE ENTRYS INTO      1132
**     THEIR INDIVIDUAL COMPONENT ORDERS. VINTBUPT (VIA            1132
**     ICBVSP00) THEN PROCESSES EACH INDIVIDUAL ORDER AGAINST      1132
**     THE 'USERCAT.MSVI' DATA SET. AFTER ALL RPLS HAVE BEEN APPLIED,
**     THE UCBS ARE SCANNED FOR VIRTUAL UCBS UPDATING THE          1132
**     CURRENT MOUNT STATUS IN THE MSVGRP AND VOLUME RECORDS.      1132
**     ANY VOLUMES MARKED DEMOUNTED BECAUSE OF A PURGE OR          1132
**     ASSOCAITE ORDER HAVE THEIR DOWN LEVEL SPACE INDICATOR       1132
**     TURNED ON.  ANY VOLUMES MARKED MOUNTED BECAUSE OF THE       1132
**     UCB SCAN WILL HAVE THEIR DOWN LEVEL SPACE FLAG TURNED @G24LB23
**     OFF.  IF UPDATING MOUNT STATUS AFTER THE MSVI DATA SET      1132
**     HAS BEEN RESTORED, ALL GENERAL USE MOUNTED VOLUMES    @G24LB23
**     (IF MOUNTED PRIVATE RESERVED OR REMOVABLE OR WITH NO  @G24LB23
**     MOUNT AND USE ATTRIBUTES, AND BELONG TO A GROUP OTHER @G24LB23
**     THAN SYSGROUP) WILL BE LSPACED TO GET ACCURATE        @G24LB23
**     AVAILABLE FREE SPACE.  IF THE RUNNING SPACE INVALID   @G24LB23
**     FLAG IS ON, IT WILL BE TURNED OFF.                    @G24LB23
**     ORDERS PROCESSED ARE PURGE, ASSOCIATE, AND                  1132
**     DISASSOCIATE. CPU ASSOCIATON RECORD AND THE                 1132
**     ICBVVICB CONTROL BLOCK ARE UPDATED TO  REFLECT CPU          1132
**     ASSOCIATION STATUS.                                         1132
**                                                           @Z37LB26
**     OUTPUT = 'USERCAT.MSVI' DATA SET UPDATED TO REFLECT PURGE,  1132
**     ASSOCIATE, AND DISASSOCIATE PROCESSING, AND CURRENT SYSTEM MOUNT
**     STATUS. MSVGP, VOLUME, AND THE CPU ASSOCIATION RECORDS      1132
**     ARE INVOLVED IN THE UPDATE OPERATION. A VINWTO CODE IS SET  1132
**      INDICATING THE RESULTS OF THE SEGMENT.                @Y30LB27
**                                                           @Y30LB27
******************************************************************** */
*                                                                  1132
*VINTBUPT:                                                         1132
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINTBUPT ST    @14,@SA00012                                        1132
*/*********************************************************************
* * GET MAX RECORD BUFFER IF NOT ALREADY OBTAINED            @Y30LB27
* ********************************************************************/
*                                                                  1133
*   DO WHILE(CPUIDPTR=ZERO);        /* RECORD BUFFER OBTAINED      1133
*                                                            @Y30LB27*/
         B     @DE01133                                            1133
@DL01133 DS    0H                                                  1134
*     REG0=MAXREC;                  /* GET LENGTH OF         @Y30LB27
*                                      MAXIMUM RECORD        @G24LB04*/
         LA    REG0,1024                                           1134
*LGETM4:                                                           1135
*     GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR ACB   @Y30LB27*/
LGETM4   GETMAIN RC,LV=(0),SP=241
*     IF REG15^=ZERO THEN                                          1136
         LTR   REG15,REG15                                         1136
         BZ    @RF01136                                            1136
*       DO;                         /* STORAGE OBTAIN        @Y30LB27*/
*         VINMSGID=MSGSTGE;         /* SET MSG ID            @Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                1138
*         CALL VINWTO;              /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          1139
*         RETURN;                   /* RETURN TO CALLER      @Y30LB27*/
@EL00012 DS    0H                                                  1140
@EF00012 DS    0H                                                  1140
@ER00012 L     @14,@SA00012                                        1140
         BR    @14                                                 1140
*       END;                        /*                       @Y30LB27*/
*     CPUIDPTR=REG1;                /* SET PTR FOR RECORD BUFFER   1142
*                                                            @Y30LB27*/
@RF01136 ST    REG1,CPUIDPTR                                       1142
*   END;                            /* BUFFER OBTAINED       @Y30LB27
*                                                            @Y30LB27*/
@DE01133 L     @08,CPUIDPTR                                        1143
         LTR   @08,@08                                             1143
         BZ    @DL01133                                            1143
*/*********************************************************************
* * IF INITIALIZATION ESTABLISH MOUNT MASK FOR CPU - GET     @Y30LB27
* * CPU ASSOCIATION RECORD                                   @Y30LB27
* ********************************************************************/
*                                                                  1144
*   RPLVTYP=RPLVREAD;               /* INDICATE READ         @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1144
*   RPLVUPD=ON;                     /* FOR UPDATE            @Y30LB27*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1145
*   RPLVBUF=CPUIDPTR;               /* SET BUFFER ADDRESS    @Y30LB27*/
         ST    @08,RPLVBUF(,RPLVPTR)                               1146
*   RPLVKEY=CPUIDPTR;               /* SET KEY ADDRESS       @Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1147
*   RPLVRLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @Y30LB27*/
         LA    @05,151                                             1148
         ST    @05,RPLVRLN(,RPLVPTR)                               1148
*   RPLVBLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @Y30LB27*/
         ST    @05,RPLVBLN(,RPLVPTR)                               1149
*   CPUNAME=CCPUIDK;                /* SET KWY ADDR          @Y30LB27*/
         MVC   CPUNAME(13,@08),CCPUIDK                             1150
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1151
*   CALL ICBVIO00;                  /* GET CPUID REC         @Y30LB27*/
         L     @15,@CV03332                                        1152
         BALR  @14,@15                                             1152
*   IF RPLVRETC^=ZERO THEN                                         1153
         LH    @08,RPLVRETC(,RPLVPTR)                              1153
         N     @08,@CF03969                                        1153
         LTR   @08,@08                                             1153
         BZ    @RF01153                                            1153
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1155
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1156
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1157
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1158
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1158
*       CALL VINCNVRT;              /* TO MSG                @Y30LB27*/
         BAL   @14,VINCNVRT                                        1159
*       CALL VINWTO;                /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          1160
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00012                                            1161
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*   SAVEI=ZERO;                     /* CLEAR SAVE AREA       @Y30LB27*/
@RF01153 SLR   SAVEI,SAVEI                                         1163
*   VVICPUID=ZERO;                  /* CLEAR CPUID           @YM02859*/
         SLR   @08,@08                                             1164
         STH   @08,VVICPUID(,VVIPTR)                               1164
*   DO I=ONE TO SIXTEEN;            /* SEARCH FOR CPUID      @Y30LB27*/
         LA    I,1                                                 1165
@DL01165 DS    0H                                                  1166
*     IF CPUIDREC(I)=ICBCPUID THEN                                 1166
         L     @03,CPUIDPTR                                        1166
         LR    @05,I                                               1166
         SLA   @05,3                                               1166
         L     @04,CVTPTR                                          1166
         L     @04,CVTEXT2(,@04)                                   1166
         L     @04,CVTICB(,@04)                                    1166
         ST    @05,@TF00001                                        1166
         ALR   @05,@03                                             1166
         CLC   CPUIDREC-8(5,@05),ICBCPUID(@04)                     1166
         BNE   @RF01166                                            1166
*       DO;                         /* CPUID FOUND           @G24LB05*/
*         VVICPUID=CPUMASK(I);      /* SET CPUID IN ICBVVICB @Y30LB27*/
         AL    @03,@TF00001                                        1168
         MVC   VVICPUID(2,VVIPTR),CPUMASK-8(@03)                   1168
*         I=SIXTEEN;                /* END SEARCH            @Y30LB27*/
         LA    I,16                                                1169
*       END;                        /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * SAVE FIRST EMPTY SLOT IF FIRST TIME FOR THIS CPU         @Y30LB27
* ********************************************************************/
*                                                                  1171
*     IF CPUIDREC(I)=BLANKS(ONE:FIVE)&SAVEI=ZERO THEN/*      @Y30LB27*/
@RF01166 LR    @03,I                                               1171
         SLA   @03,3                                               1171
         L     @05,CPUIDPTR                                        1171
         ALR   @05,@03                                             1171
         CLC   CPUIDREC-8(5,@05),BLANKS                            1171
         BNE   @RF01171                                            1171
         LTR   SAVEI,SAVEI                                         1171
         BNZ   @RF01171                                            1171
*       SAVEI=I;                    /* SAVE INDEX ADDR       @Y30LB27*/
         LR    SAVEI,I                                             1172
*   END;                            /*                       @Y30LB27
*                                                            @Y30LB27*/
@RF01171 AL    I,@CF00055                                          1173
         C     I,@CF00167                                          1173
         BNH   @DL01165                                            1173
*/*********************************************************************
* * IF NOT FOUND AND NO SLOTS ISSUE ERROR MESSAGE            @Y30LB27
* ********************************************************************/
*                                                                  1174
*   IF VVICPUID=ZERO&SAVEI=ZERO THEN                               1174
         SLR   @08,@08                                             1174
         LH    @03,VVICPUID(,VVIPTR)                               1174
         N     @03,@CF03969                                        1174
         CR    @08,@03                                             1174
         BNE   @RF01174                                            1174
         CR    SAVEI,@08                                           1174
         BNE   @RF01174                                            1174
*     DO;                           /*                       @Y30LB27*/
*       VINMSGID=MSGCPUE;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00165                                1176
*       CALL VINWTO;                /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          1177
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00012                                            1178
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * IF NOT FOUND, SHIFT MASK AND USE CURRENT SLOT            @Y30LB27
* ********************************************************************/
*                                                                  1180
*   DO WHILE(VVICPUID=ZERO);        /* IF NOT FOUND FILL NEXT SLOT 1180
*                                                            @Y30LB27*/
@RF01174 B     @DE01180                                            1180
@DL01180 DS    0H                                                  1181
*     IDMASK=MASK8000;              /* INIT MASK FIELD       @Y30LB27*/
         LH    @08,MASK8000                                        1181
         N     @08,@CF03969                                        1181
         STH   @08,IDMASK                                          1181
*     DO I=ONE TO SAVEI-ONE;        /* BUILD MASK            @Y30LB27*/
         LA    I,1                                                 1182
         B     @DE01182                                            1182
@DL01182 DS    0H                                                  1183
*       IDMASK=IDMASK/TWO;          /* SHIFT RIGHT CORRET NUMBER OF
*                                      SLOTS                 @Y30LB27*/
         LH    @03,IDMASK                                          1183
         N     @03,@CF03969                                        1183
         SRL   @03,1                                               1183
         STH   @03,IDMASK                                          1183
*     END;                          /*                       @Y30LB27*/
         AL    I,@CF00055                                          1184
@DE01182 LR    @03,SAVEI                                           1184
         BCTR  @03,0                                               1184
         CR    I,@03                                               1184
         BNH   @DL01182                                            1184
*     VVICPUID=IDMASK;              /* SET MASK IN CONTROL BLOCK   1185
*                                                            @Y30LB27*/
         MVC   VVICPUID(2,VVIPTR),IDMASK                           1185
*     CPUIDREC(SAVEI)=ICBCPUID;     /* SAVE CPUID            @G24LB05*/
         L     @08,CPUIDPTR                                        1186
         LR    @03,SAVEI                                           1186
         SLA   @03,3                                               1186
         ST    @03,@TF00001                                        1186
         ALR   @03,@08                                             1186
         L     @05,CVTPTR                                          1186
         L     @05,CVTEXT2(,@05)                                   1186
         L     @05,CVTICB(,@05)                                    1186
         MVC   CPUIDREC-8(5,@03),ICBCPUID(@05)                     1186
*     CPUMASK(SAVEI)=IDMASK;        /* SET MASK              @Y30LB27*/
         AL    @08,@TF00001                                        1187
         MVC   CPUMASK-8(2,@08),IDMASK                             1187
*   END;                            /*                       @Y30LB27
*                                                            @Y30LB27*/
@DE01180 LH    @08,VVICPUID(,VVIPTR)                               1188
         N     @08,@CF03969                                        1188
         LTR   @08,@08                                             1188
         BZ    @DL01180                                            1188
*/*********************************************************************
* * MODIFY RPL AND PUT THE UPDATED CPU ASSOC RECORD          @Y30LB27
* ********************************************************************/
*                                                                  1189
*   RPLVTYP=RPLVPUT;                /* INDICATE READ         @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1189
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1190
*   CALL ICBVIO00;                  /* WRITE THE RECORD      @Y30LB27*/
         L     @15,@CV03332                                        1191
         BALR  @14,@15                                             1191
*   IF RPLVRETC^=ZERO THEN                                         1192
         LH    @08,RPLVRETC(,RPLVPTR)                              1192
         N     @08,@CF03969                                        1192
         LTR   @08,@08                                             1192
         BZ    @RF01192                                            1192
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1194
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1195
*       MSGTEXT1=RPLVKEY;           /* SET KEY ADDR          @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1196
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1197
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1197
*       CALL VINCNVRT;              /* AND ADD TO MSG        @Y30LB27*/
         BAL   @14,VINCNVRT                                        1198
*       CALL VINWTO;                /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          1199
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00012                                            1200
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * UPDATE VSAM RPL AND ISSUE ENDREC                         @Y30LB27
* ********************************************************************/
*                                                                  1202
*   RPLVTYP=RPLVENDR;               /* INDICATE PUT TO VSAM  @Y30LB27*/
@RF01192 MVI   RPLVTYP(RPLVPTR),X'04'                              1202
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1203
*   CALL ICBVIO00;                  /* ISSUE ENDREC          @Y30LB27*/
         L     @15,@CV03332                                        1204
         BALR  @14,@15                                             1204
*   RPLVSAM=''B;                    /* CLEAR RPL             @Y30LB27
*                                                            @Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1205
*/*********************************************************************
* * SAVE INIT RPLV PTR NAD LOOP THRU VSP WITH PURGE/DISASSOC/ASSOC RPLS
* ********************************************************************/
*                                                                  1206
*   IF ININIT=ON THEN                                              1206
         L     @08,INITPTR                                         1206
         TM    ININIT(@08),B'10000000'                             1206
         BNO   @RF01206                                            1206
*     DO;                           /* IF INITI. PROCESS RPLS      1207
*                                                            @Y30LB27*/
*       RPLVSAVE=RPLVPTR;           /* SAVE RPLV PONITER     @Y30LB27*/
         LR    RPLVSAVE,RPLVPTR                                    1208
*       RPLVPTR=VVIQRPL2;           /* RETRIVE ENTRY FROM LOW@Y30LB27
*                                      PRIORITY QUEUE        @Y30LB27*/
         L     RPLVPTR,VVIQRPL2(,VVIPTR)                           1209
*       INITPTR=ADDR(RPLVUTIL);     /* RESET REQ PTR         @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              1210
         ST    @08,INITPTR                                         1210
*       DO WHILE(RPLVPTR^=ZERO&(INITOPCD=PURGOPCD×INITOPCD=ASSCOPCD));
         B     @DE01211                                            1211
@DL01211 DS    0H                                                  1212
*                                   /*                       @Y30LB27*/
*         RPLFTIME=ON;              /* INDICATE SECOND CALL  @Y30LB27*/
*         RPLVVIN=ON;               /* INDICATE VIN00 CALL TO VSP  1213
*                                      RESERVE ALREADY DONE AND VIN00
*                                      WILL DISABLE IF REQD  @Y30LB27*/
         OI    RPLFTIME(RPLVPTR),B'10001000'                       1213
*         RPLVDATE=CVTDATE;         /* SET DATE              @ZA13484*/
         L     @08,CVTPTR                                          1214
         MVC   RPLVDATE(4,RPLVPTR),CVTDATE(@08)                    1214
*         RPLVDATE=RPLVDATE&FC;     /* SET SIGN              @ZA13484*/
         NC    RPLVDATE(4,RPLVPTR),@CB03677                        1215
*         REG1=RPLVPTR;             /* POINT TP RPLV         @Y30LB27*/
         LR    REG1,RPLVPTR                                        1216
*         CALL ICBVSP00;            /* ICBVSP00 HANDLES PURGE, ASSOC.
*                                      AND DISASSOC. PROC.   @Y30LB27*/
         L     @15,@CV03331                                        1217
         BALR  @14,@15                                             1217
*         IF RPLVSAVE->RPLVRETC=ZERO THEN/* OKAY SO FAR      @Y30LB27*/
         LH    @08,RPLVRETC(,RPLVSAVE)                             1218
         N     @08,@CF03969                                        1218
         LTR   @08,@08                                             1218
         BNZ   @RF01218                                            1218
*           RPLVSAVE->RPLVRETC=RPLVRETC;/* SAVE RETURN CODE  @Y30LB27
*                                                            @YM04327*/
         MVC   RPLVRETC(2,RPLVSAVE),RPLVRETC(RPLVPTR)              1219
*/*********************************************************************
* * MARK RPL COMPLETED AFTER IT HAS BEEN PROCESSED           @YM04327
* ********************************************************************/
*                                                                  1220
*         RPLVCOMP=ON;              /* INDICATE RPL COMPLETED      1220
*                                                            @YM04327*/
@RF01218 OI    RPLVCOMP(RPLVPTR),B'00010000'                       1220
*         RPLVPTR=RPLVQPTR;         /* SET RPLPTR ADDR       @Y30LB27*/
         L     RPLVPTR,RPLVQPTR(,RPLVPTR)                          1221
*         INITPTR=ADDR(RPLVUTIL);   /* RESET PTR TO REQUEST  @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              1222
         ST    @08,INITPTR                                         1222
*       END;                        /*                       @Y30LB27
*                                                            @Y30LB27*/
@DE01211 LTR   RPLVPTR,RPLVPTR                                     1223
         BZ    @DC01211                                            1223
         L     @08,INITPTR                                         1223
         CLC   INITOPCD(1,@08),PURGOPCD                            1223
         BE    @DL01211                                            1223
         CLC   INITOPCD(1,@08),ASSCOPCD                            1223
         BE    @DL01211                                            1223
@DC01211 DS    0H                                                  1224
*/*********************************************************************
* * RESTORE PTR TO INIT RPLV                                 @Y30LB27
* ********************************************************************/
*                                                                  1224
*       RPLVPTR=RPLVSAVE;           /* SAVE RPLV PONITER     @Y30LB27*/
         LR    RPLVPTR,RPLVSAVE                                    1224
*       INITPTR=ADDR(RPLVUTIL);     /* RESET PTR TO REQUEST  @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              1225
         ST    @08,INITPTR                                         1225
*       IF RPLVRETC^=ZERO THEN                                     1226
         LH    @08,RPLVRETC(,RPLVPTR)                              1226
         N     @08,@CF03969                                        1226
         LTR   @08,@08                                             1226
         BZ    @RF01226                                            1226
*         DO;                       /* BAD RETURN CODE       @Y30LB27*/
*           CALL VINDSDS;           /* CLOSE AND DE-ALLOCATE @Y30LB27*/
         BAL   @14,VINDSDS                                         1228
*           RETURN;                 /* RETURN TO MAINLINE    @Y30LB27*/
         B     @EL00012                                            1229
*         END;                      /* END VSP FAILURE       @Y30LB27*/
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
@RF01226 DS    0H                                                  1232
*/*********************************************************************
* * CHECK IF PURGE REQUIRED                                  @Y30LB27
* ********************************************************************/
*                                                                  1232
*   RPLVTYP=RPLVREAD;               /* INDICATE READ         @Y30LB27*/
@RF01206 MVI   RPLVTYP(RPLVPTR),X'00'                              1232
*   RPLVBUF=CPUIDPTR;               /* SET BUFFER ADDRESS    @Y30LB27*/
         L     @08,CPUIDPTR                                        1233
         ST    @08,RPLVBUF(,RPLVPTR)                               1233
*   RPLVKEY=CPUIDPTR;               /* SET KEY ADDRESS       @Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1234
*   RPLVRLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @Y30LB27*/
         LA    @05,151                                             1235
         ST    @05,RPLVRLN(,RPLVPTR)                               1235
*   RPLVBLN=LENGTH(CPUID);          /* SET KEY ADDRESS       @Y30LB27*/
         ST    @05,RPLVBLN(,RPLVPTR)                               1236
*   CPUNAME=CCPUIDK;                /* POINT TO CPUID REC    @Y30LB27*/
         MVC   CPUNAME(13,@08),CCPUIDK                             1237
*   REG1=RPLVPTR;                   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1238
*   CALL ICBVIO00;                  /* READ CPUID            @Y30LB27*/
         L     @15,@CV03332                                        1239
         BALR  @14,@15                                             1239
*   IF RPLVRETC^=ZERO THEN                                         1240
         LH    @08,RPLVRETC(,RPLVPTR)                              1240
         N     @08,@CF03969                                        1240
         LTR   @08,@08                                             1240
         BZ    @RF01240                                            1240
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* INDICATE VSAM ERROR   @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1242
*       MSGTEXT1=RPLVKEY;           /* SET KEY ADDR          @Y30LB27*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1243
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1244
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1244
*       CALL VINCNVRT;              /* ADD IT TO MSG         @Y30LB27*/
         BAL   @14,VINCNVRT                                        1245
*       CALL VINWTO;                /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          1246
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00012                                            1247
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * PURGE THIS CPU - A DISABLE OR SUSPEND-FOR-RECONF WAS EX. @Y30LB27
* * A NORMAL COMPARE WILL NOT SURFICE A 2 BYTE TM WITH VAR.  @Y30LB27
* * FIELDS IS REQD                                           @Y30LB27
* ********************************************************************/
*                                                                  1249
*   REG1=VVICPUID;                  /* GET THE CPUID         @Y30LB27*/
@RF01240 LH    REG1,VVICPUID(,VVIPTR)                              1249
         N     REG1,@CF03969                                       1249
*   WORK1=CPUPURGE;                 /* GET PURG FLAG FROM CPUID REC
*                                                            @Y30LB27*/
         L     @08,CPUIDPTR                                        1250
         MVC   WORK1(2),CPUPURGE(@08)                              1250
*   REG1=REG1&MASK00FF;             /* ISOLATE LOWER ORDER BYTE      */
         N     REG1,MASK00FF                                       1251
*   IF REG1^=ZERO THEN              /* CPU IN FLAG           @Y30LB27*/
         LTR   REG1,REG1                                           1252
         BZ    @RF01252                                            1252
*     DO;                           /* YES                   @Y30LB27*/
*       GEN(EX REG1,VINTML);        /* CPU TO BE PURGED      @Y30LB27*/
         EX REG1,VINTML
*       BC(BZ,CHKPURGH);            /* HAVE A HIT            @Y30LB27*/
         BC    8,CHKPURGH                                          1255
*       PURGSW=ON;                  /* INDICATE PURGE REQD   @Y30LB27*/
         OI    PURGSW,B'00010000'                                  1256
*     END;                          /*                       @Y30LB27*/
*CHKPURGH:                                                         1258
*   REG1=VVICPUID;                  /* GET THE CPUID         @Y30LB27*/
@RF01252 DS    0H                                                  1258
CHKPURGH LH    REG1,VVICPUID(,VVIPTR)                              1258
         N     REG1,@CF03969                                       1258
*   SRL(REG1,EIGHT);                /* ISOLATE HIGH ORDER BYTE     1259
*                                                            @Y30LB27*/
         SRL   REG1,8                                              1259
*   IF REG1^=ZERO THEN              /* CPU IN FLAG           @Y30LB27*/
         LTR   REG1,REG1                                           1260
         BZ    @RF01260                                            1260
*     DO;                           /* YES                   @Y30LB27*/
*       GEN(EX REG1,VINTMH);        /* CPU TO BE PURGED      @Y30LB27*/
         EX REG1,VINTMH
*       BC(BZ,VINPURG);             /* HAVE A HIT            @Y30LB27*/
         BC    8,VINPURG                                           1263
*       PURGSW=ON;                  /* INDICATE PURGE REQD   @Y30LB27*/
         OI    PURGSW,B'00010000'                                  1264
*     END;                          /*                       @Y30LB27*/
*VINPURG:                                                          1266
*   IF PURGSW=ON THEN               /* CPU TO BE PURGED      @Y30LB27*/
@RF01260 DS    0H                                                  1266
VINPURG  TM    PURGSW,B'00010000'                                  1266
         BNO   @RF01266                                            1266
*     DO;                           /*                       @Y30LB27*/
*       PURGSW=OFF;                 /* INDICATE PURGE REQD   @Y30LB27
*                                                            @Y30LB27*/
         NI    PURGSW,B'11101111'                                  1268
*/*********************************************************************
* * UPDATE VSAM RPL AND ISSUE ENDREC                         @Y30LB27
* ********************************************************************/
*                                                                  1269
*       RPLVTYP=RPLVENDR;           /* INDICATE PUT TO VSAM  @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'04'                              1269
*       REG1=RPLVPTR;               /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1270
*       CALL ICBVIO00;              /* ISSUE ENDREC          @Y30LB27*/
         L     @15,@CV03332                                        1271
         BALR  @14,@15                                             1271
*       RPLVSAM=''B;                /* CLEAR RPL             @Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1272
*       RPLVSAVE=RPLVPTR;           /* YES SAVE PTR TO IPL RPLV    1273
*                                                            #Y30LB27*/
         LR    RPLVSAVE,RPLVPTR                                    1273
*       REG0=LENGTH(RPLV)+LENGTH(LSTPAIR);/* SET RPLV LEN    #Y30LB27*/
         LA    REG0,145                                            1274
*LGETM5:                                                           1275
*       GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR IT  #Y30LB27*/
LGETM5   GETMAIN RC,LV=(0),SP=241
*       IF REG15^=ZERO THEN         /* STORAGE OBTAINED      #Y30LB27*/
         LTR   REG15,REG15                                         1276
         BZ    @RF01276                                            1276
*         DO;                       /* NO                    #Y30LB27*/
*           RPLVPTR=RPLVSAVE;       /* SET PTR TO PURGE RPLV @Y30LB27*/
         LR    RPLVPTR,RPLVSAVE                                    1278
*           INITPTR=ADDR(RPLVUTIL); /* SET PTR TO PURGE RPLV @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              1279
         ST    @08,INITPTR                                         1279
*           VINMSGID=MSGSTGE;       /* SET MSG INDEX         #Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                1280
*           CALL VINWTO;            /* ISSUE THE ERROR MSG   #Y30LB27*/
         BAL   @14,VINWTO                                          1281
*           RETURN;                 /* RETURN TO MAINLINE    @Y30LB27*/
         B     @EL00012                                            1282
*         END;                      /*                       #Y30LB27*/
*       RPLVPTR=REG1;               /* SET PTR TO PURGE RPLV #Y30LB27*/
@RF01276 LR    RPLVPTR,REG1                                        1284
*       RPLV=''B;                   /* CLEAR IT              #Y30LB27*/
         XC    RPLV(132,RPLVPTR),RPLV(RPLVPTR)                     1285
*       RPLVVICB=VVIPTR;            /* SET VVICB PTR         @Y30LB27*/
         ST    VVIPTR,RPLVVICB(,RPLVPTR)                           1286
*       RPLFTIME=ON;                /* INDICATE 2ND CALL     #Y30LB27*/
*       RPLVVIN=ON;                 /* INDICATE VIN00 CALL TO VSP  1288
*                                      RESERVE ALREADY DONE AND VIN00
*                                      WILL DISABLE IF REQD  @Y04LB27*/
         OI    RPLFTIME(RPLVPTR),B'10001000'                       1288
*       RPLVTLEN=LENGTH(RPLV);      /* SET LENGTH            #Y30LB27*/
         MVC   RPLVTLEN(2,RPLVPTR),@CH03940                        1289
*       RPLVDATE=CVTDATE;           /* SET DATE              @ZA13484*/
         L     @03,CVTPTR                                          1290
         MVC   RPLVDATE(4,RPLVPTR),CVTDATE(@03)                    1290
*       RPLVDATE=RPLVDATE&FC;       /* SET SIGN              @ZA13484*/
         NC    RPLVDATE(4,RPLVPTR),@CB03677                        1291
*       PAIRPTR=ADDR(RPLVUTIL);     /* SET ADDR FOR PURGE LIST     1292
*                                                            #Y30LB27*/
         LA    PAIRPTR,RPLVUTIL(,RPLVPTR)                          1292
*       LSTPAIR=''B;                /* ZERO OUT PARM LIST    @ZA14739*/
         XC    LSTPAIR(13,PAIRPTR),LSTPAIR(PAIRPTR)                1293
*       PURGLL=LENGTH(LSTPAIR);     /* SET LENGTH            #Y30LB27*/
         MVC   PURGLL(4,PAIRPTR),@CF00230                          1294
*       PURGOP=PURGOPCD;            /* SET THE OP-CODE       #Y30LB27*/
         IC    @05,PURGOPCD                                        1295
         STC   @05,PURGOP(,PAIRPTR)                                1295
*       PURGHOST=ICBCPUID;          /* THE HOSTID            @G24LB05*/
         L     @03,CVTEXT2(,@03)                                   1296
         L     @03,CVTICB(,@03)                                    1296
         MVC   PURGHOST(5,PAIRPTR),ICBCPUID(@03)                   1296
*       REG1=ADDR(RPLV);            /* POINT TO RPL          #Y30LB27*/
         LR    REG1,RPLVPTR                                        1297
*       CALL ICBVSP00;              /* INVOKE VSP            #Y30LB27*/
         L     @15,@CV03331                                        1298
         BALR  @14,@15                                             1298
*       IF RPLVSAVE->RPLVRETC=ZERO THEN/* OKAY SO FAR        @Y30LB27*/
         LH    @08,RPLVRETC(,RPLVSAVE)                             1299
         N     @08,@CF03969                                        1299
         LTR   @08,@08                                             1299
         BNZ   @RF01299                                            1299
*         RPLVSAVE->RPLVRETC=RPLVRETC;/* SAVE RETURN CODE    @Y30LB27*/
         MVC   RPLVRETC(2,RPLVSAVE),RPLVRETC(RPLVPTR)              1300
*       REG0=LENGTH(RPLV)+LENGTH(LSTPAIR);/*                 @ZM30746*/
@RF01299 LA    REG0,145                                            1301
*       REG1=RPLVPTR;               /* SET DCB ADDRESS       @ZM30746*/
         LR    REG1,RPLVPTR                                        1302
*LFREEM7:                                                          1303
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREE DCB     @ZM30746*/
LFREEM7  FREEMAIN RC,LV=(0),A=(1),SP=241
*       RPLVPTR=RPLVSAVE;           /* RE-RESRVE THE INV     @Y30LB27*/
         LR    RPLVPTR,RPLVSAVE                                    1304
*       INITPTR=ADDR(RPLVUTIL);     /* RESET ORDR PTR        @Y30LB27*/
         LA    @08,RPLVUTIL(,RPLVPTR)                              1305
         ST    @08,INITPTR                                         1305
*       IF RPLVRETC^=ZERO THEN                                     1306
         LH    @08,RPLVRETC(,RPLVPTR)                              1306
         N     @08,@CF03969                                        1306
         LTR   @08,@08                                             1306
         BZ    @RF01306                                            1306
*         DO;                       /* BAD RETURN CODE       @Y30LB27*/
*           CALL VINDSDS;           /* CLOSE AND DE-ALLOCATE @Y30LB27*/
         BAL   @14,VINDSDS                                         1308
*           RETURN;                 /* RETURN TO MAINLINE    @Y30LB27*/
         B     @EL00012                                            1309
*         END;                      /* END VSP FAILURE       @Y30LB27*/
*     END;                          /*                       @Y30LB27
*                                                            #Y30LB27*/
@RF01306 DS    0H                                                  1312
*/*********************************************************************
* * CALL VINUCB TO BUILD TABLE OF VIRTUAL UCBS NAD UPDATE    #Y30LB27
* * CURRENT MOUNT STATUS                                     #Y30LB27
* ********************************************************************/
*                                                                  1312
*   CALL VINUCB;                    /* SCAN UCBS TO UPDATE MOUNT   1312
*                                      STATUS                #Y30LB27*/
@RF01266 BAL   @14,VINUCB                                          1312
*   RETURN;                         /* RETURN TO VIN MAINLINE      1313
*                                                            @Y30LB27*/
         B     @EL00012                                            1313
*   END VINTBUPT;                   /*                       @Y30LB27*/
*                                                                  1315
*/* ******************************************************************
**                                                           @Y30LB27
**    NAME = VINUCB: SEGMENT TO SCAN UCBS FOR CURRENT MOUNT STATUS 1315
**                                                           @Y30LB27
**    INPUT = UCBS REFLECTING A MOUNTED MSS VOLUME AND THE MSVC    1315
**     INVENTORY DATA SET.                                   @Y30LB27
**                                                           @Y30LB27
**     PROCESS = ALL UCBS ARE SCANNED LOOKING FOR MOUNTED MSS      1315
**     VOLUMES, IF A MSS VOLUME IS MOUNTED THE VOLUME RECORD       1315
**     IS READ AND UPDATE TO INDICATE IS IS MOUNTED FOR THE CURRENT
**     HOST. IF THE VOLUME IS A MEMBER OF A MSVGRP, THE MSVGRP RECORD I
**     CORRESPONDINGLY UPDATED. THE DOWN LEVEL SPACE FLAG IS       1315
**     TURNED OFF IF THE VOLUME IS MOUNTED.  IECILK2 IN            1315
**     THE CVT CONTAINS THE STARTING ADDR OF THE UCB               1315
**     ADDRESS PORTION OF THE UCB LOOK-UP TABLE. BIT, X'08',       1315
**     IN THE SECOND BYTE (UCB+17) OF THE UCBTYPE FIELD INDICATES  1315
**     A REAL OR MSS VOLUME. B'0' THE DEVICE IS REAL. B'1'         1315
**     THE DEVICE IS VIRTUAL.                                      1315
**                                                           @Z37LB26
**     OUTPUT = VOLUME AND MSVGRP RECORDS IN THE MSVC INVENTORY,   1315
**     UPDATED TO RELFECT THE MOUNT STATUS FOR THE CPU.            1315
**     A VINWTO CODE IS SET INDICATING THE RESULTS OF THE SEGMENT. 1315
**                                                           @Y30LB27
******************************************************************** */
*                                                                  1315
*VINUCB:                                                           1315
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27*/
VINUCB   ST    @14,@SA00013                                        1315
*/*********************************************************************
* * BUILD TABLE OF VIRTUAL UCB ADDRESSES -                   @Y30LB27
* * 31-BIT ADDRESSING                                        @Y30LB27
* ********************************************************************/
*                                                                  1316
*   IF REG12=VVIUCB THEN            /* BUILD TABLE AT IPL    @Y30LB27*/
         C     REG12,VVIUCB(,VVIPTR)                               1316
         BNE   @RF01316                                            1316
*     CALL VINUCBTB;                /* BUILD UCB ADDRESS TABLE     1317
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         BAL   @14,VINUCBTB                                        1317
*/*********************************************************************
* * IF A VIRTUAL UCB HAS A MOUNTED VOLUME INDICATE IT AS     @Y30LB27
* * MOUNTED IN THE VOLUME RECORD AND OPTIONALLY IN THE       @Y30LB27
* * MSVGRP RECORD                                             @Y30LB27
* ********************************************************************/
*                                                                  1318
*   DISSW=ON;                       /* NEED TO RESET IPL     @ZM30746*/
@RF01316 OI    DISSW,B'00000001'                                   1318
*   SCANPTR=VVIUCB;                 /* SET PTR TO START OF UCB ADDRS
*                                                            @Y30LB27*/
         L     SCANPTR,VVIUCB(,VVIPTR)                             1319
*   DO WHILE SCAN31^=UCBDELIM;      /* SCAN TO END OF TABLE  @Y30LB27*/
         B     @DE01320                                            1320
@DL01320 DS    0H                                                  1321
*     RFY                                                          1321
*       UCBOB BASED(SCANP31);       /* BASE UCB ON SCAN ADDR @Y30LB27*/
*     IF UCBVOLI^=BINZERO THEN                                     1322
         L     @08,SCANP31(,SCANPTR)                               1322
         CLC   UCBVOLI(6,@08),BINZERO                              1322
         BE    @RF01322                                            1322
*       CALL VINUCBMT;              /* UPDATE MOUNT          @Y30LB27*/
         BAL   @14,VINUCBMT                                        1323
*     SCANPTR=SCANPTR+FOUR;         /* UPDATE UCB PTR        @Y30LB27
*                                                            @Y30LB27*/
@RF01322 AL    SCANPTR,@CF00098                                    1324
*/*********************************************************************
* * I/O ERRORS FOR MSVGRP, MSVGRP EXT, AND VOLUME RECORDS ARE  @Y30LB27
* * IGNORED DURING IPL VIO WILL ISSUE AN ERROR MESSAGE       @Y30LB27
* ********************************************************************/
*                                                                  1325
*     RPLRCODE=ZERO;                /* CLEAR RETURN CODE     @Y30LB27*/
         SLR   @08,@08                                             1325
         STH   @08,RPLRCODE(,RPLVPTR)                              1325
*     RPLVRETC=ZERO;                /* CLEAR REASON CODE     @Y30LB27*/
         STH   @08,RPLVRETC(,RPLVPTR)                              1326
*   END;                            /*                       @Y30LB27*/
@DE01320 CLC   SCAN31(4,SCANPTR),UCBDELIM                          1327
         BNE   @DL01320                                            1327
*   DISSW=OFF;                      /* NEED TO RESET IPL     @ZM30746*/
         NI    DISSW,B'11111110'                                   1328
*   RETURN;                         /*                       @Y30LB27*/
@EL00013 DS    0H                                                  1329
@EF00013 DS    0H                                                  1329
@ER00013 L     @14,@SA00013                                        1329
         BR    @14                                                 1329
*   END VINUCB;                     /*                       @Y30LB27*/
*                                                                  1331
*/******************************************************************
**                                                           @Y30LB27
**     NAME = VINUCBTB: SEGMENT TO CONSTRUCT TABLE OF VIRTUAL@Y30LB27
**            UCB ADDRESSES AND TO CALCULATE DEVICE MASK     @G24LB04
**            SIZE, AND TO GET AND INITIALIZE CONTROL        @G24LB04
**            BLOCKS FOR JES3 COMMUNICATION.                 @G24LB04
**                                                           @Y30LB27
**     INPUT = SYSTEM UCBS, REFLECTING MOUNTED MSS VOLUMES.  @G24LB04
**                                                           @Y30LB27
**     PROCESS = ALL UCBS ARE SCANNED LOOKING FOR A VIRTUAL  @Y30LB27
**               UNIT. IF A VIRTUAL UNIT IS LOCATED          @G24LB04
**               THE ADDRESS IS ADDED TO TABLE OF 31         @G24LB04
**               BIT ADDRESSES.                              @G24LB04
**                                                           @G24LB04
**                DURING THIS SCAN, THE TOTAL NUMBER OF UCBS @G24LB04
**                IS COUNTED. THE LENGTH OF A MASK IN A      @G24LB04
**                DEVICE MASK TABLE ENTRY IS CALCULATED FROM @G24LB04
**                THIS NUMBER, AND PLACED INTO THE MSVC      @G24LB04
**                CONTROL BLOCK.                             @G24LB04
**                                                           @G24LB04
**                JES3 - STORAGE OBTAINED AND INITIALIZED    @G24LB04
**                                                           @Y30LB27
**     OUTPUT = VVIUCB POINTING TO A TABLE OF VIRTUAL        @Y30LB27
**              UCB ADDRESSES (31 BIT).TABLE IS DELIMITED BY @Y30LB27
**              FULL WORD OF XFFFFFFFF.                      @Y30LB27
**                                                           @Y30LB27
**              VVISSOBA POINTS TO SSOB OF LINKED AND        @G24LB04
**              INITIALIZED SSIB, SSOB AND SSOB EXTENSION    @G24LB04
**              FOR MSVC-OPEN FUNCTION OF JES3, AS USED BY   @G24LB04
**              ALLOCATE TO MOUNTED VOLUMES SUPPORT.         @G24LB04
**                                                           @G24LB04
**              VVIDVMEL HAS THE LENGTH OF THE MASK IN EACH  @G24LB04
**              ENTRY IN THE DEVICE MASK TABLE.              @G24LB04
**                                                           @G24LB04
**********************************************************************/
*                                                                  1331
*VINUCBTB:                                                         1331
*   PROC OPTIONS(SAVE(14));         /*                       @ZM31138
*                                                            @Y30LB27*/
VINUCBTB ST    @14,@SA00014                                        1331
*/*********************************************************************
* * GET STORAGE FOR MAXIMUM TABLE                            @G24LB04
* ********************************************************************/
*                                                                  1332
*   REG0=NUMUCBS*FOUR+LENGTH(AMVJES3S);/* GET STORAGE FOR    @G24LB04
*                                      MAXIMUM TABLE OF UCB  @G24LB04
*                                      ADDRESS AND FOR       @G24LB04
*                                      ALLOCATE TO MOUNTED   @G24LB04
*                                      VOLUMES TO COMMUNICATE      1332
*                                                            @G24LB04
*                                      WITH JES3             @G24LB04*/
         L     REG0,@CF03944                                       1332
*/* NOTE THAT MORE STORAGE IS OBTAINED THAN MAY BE NEEDED.   @G24LB04
*  UNUSED PART WILL BE FREED AFTER THE AMOUNT REQUIRED HAS         1333
*  BEEN DETERMINED.  THE ADDRESS OF THE PORTION TO BE FREED        1333
*  MUST BE ON A DOUBLEWORD BOUNDARY.                         @G24LB04*/
*                                                                  1333
*LGETM6:                                                           1333
*   GEN(GETMAIN RC,LV=(0),SP=241);  /* GET STORAGE FOR ACB   @Y30LB27*/
LGETM6   GETMAIN RC,LV=(0),SP=241
*   IF REG15^=ZERO THEN                                            1334
         LTR   REG15,REG15                                         1334
         BZ    @RF01334                                            1334
*     DO;                           /* STORAGE OBTAIN        @Y30LB27*/
*       VINMSGID=MSGSTGE;           /* SET MSG ID FOR STORAGE ERROR
*                                                            @Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                1336
*       CALL VINWTO;                /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          1337
*       RETURN;                     /* RETURN TO CALLER      @Y30LB27*/
@EL00014 DS    0H                                                  1338
@EF00014 DS    0H                                                  1338
@ER00014 L     @14,@SA00014                                        1338
         BR    @14                                                 1338
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * SET POINTERS IN CONTROL BLOCK                            @G24LB04
* ********************************************************************/
*                                                                  1340
*   VVISSOBA=REG1;                  /* ESTABLISH             @G24LB04
*                                      ADDRESSABILITY TO JES3      1340
*                                                            @G24LB04
*                                      AMV STORAGE           @G24LB04*/
@RF01334 ST    REG1,VVISSOBA(,VVIPTR)                              1340
*   VVIUCB=REG1+LENGTH(AMVJES3S);   /* SET PTR FOR TABLE OF  @G24LB04
*                                      VIRTUAL 3330 UCBS     @G24LB04*/
         LA    @03,84                                              1341
         ALR   @03,REG1                                            1341
         ST    @03,VVIUCB(,VVIPTR)                                 1341
*   SCANPTR=REG1+LENGTH(AMVJES3S);  /* SET PTR FOR SCAN      @G24LB04
*                                                            @Y30LB27*/
         LR    SCANPTR,@03                                         1342
*/*********************************************************************
* * GET START OF UCB LOOK-UP TABLE, DELIMITER BY X'FFFF'     @Y30LB27
* ********************************************************************/
*                                                                  1343
*   UCBLOKUP=CVTILK2;               /* SET UCB PTR TO ADDRESS OF   1343
*                                      LOOK-UP TABLE         @Y30LB27*/
         L     @03,CVTPTR                                          1343
         L     UCBLOKUP,CVTILK2(,@03)                              1343
*   RFY                                                            1344
*     UCBOB BASED(UCBPTR);          /* BASED ON UCBLOOK TABLE      1344
*                                                            @Y30LB27*/
*   COUNTUCB=ZEROFX31;              /* ZERO COUNT OF UCBS    @G24LB04*/
         SLR   @03,@03                                             1345
         ST    @03,COUNTUCB                                        1345
*   DO WHILE(UCBPTR^=UCBDELIM(1:2));/*                       @Y30LB27
*                                                            @Y30LB27*/
         B     @DE01346                                            1346
@DL01346 DS    0H                                                  1347
*     COUNTUCB=COUNTUCB+1;          /* COUNT LOOKUP POSITION @G24LB04*/
         LA    @03,1                                               1347
         AL    @03,COUNTUCB                                        1347
         ST    @03,COUNTUCB                                        1347
*/*********************************************************************
* * MAKE TABLE ENTRY IF DEVICE IS DASD(X20) AND VIRTUAL(X08).@Y30LB27
* ********************************************************************/
*                                                                  1348
*     IF UCBPTR^=ZERO THEN          /* VALID UCB ADDRESS     @G24LB04*/
         LH    @03,UCBPTR(,UCBLOKUP)                               1348
         N     @03,@CF03969                                        1348
         LTR   @03,@03                                             1348
         BZ    @RF01348                                            1348
*       DO;                         /*                       @G24LB04*/
*         IF UCB3DACC=ON            /* DIRECT ACCESS?        @G24LB04*/
*             &UCBRVDEV=ON          /* VIRTUAL VOLUME?       @G24LB04*/
*           THEN                                                   1350
         TM    UCB3DACC(@03),B'00100000'                           1350
         BNO   @RF01350                                            1350
         TM    UCBRVDEV(@03),B'00001000'                           1350
         BNO   @RF01350                                            1350
*           DO;                     /*                       @G24LB04*/
*             SCAN31=UCBPTR;        /* SAVE UCB ADDR OF VIRT 3330  1352
*                                                            @Y30LB27*/
         ST    @03,SCAN31(,SCANPTR)                                1352
*             SCANPTR=SCANPTR+FOUR; /* UPDATE TABLE POINTER  @Y30LB27*/
         AL    SCANPTR,@CF00098                                    1353
*           END;                    /*                       @Y30LB27*/
*       END;                        /*                       @G24LB04*/
@RF01350 DS    0H                                                  1356
*     UCBLOKUP=UCBLOKUP+TWO;        /* UPDATE UCB POINTER    @Y30LB27*/
@RF01348 AL    UCBLOKUP,@CF00066                                   1356
*   END;                            /*                       @Y30LB27*/
@DE01346 CLC   UCBPTR(2,UCBLOKUP),UCBDELIM                         1357
         BNE   @DL01346                                            1357
*   ICBVSCRA=VVIVSCRA;              /* SET SCRNR IN MSSCB    @ZA24770*/
         L     @08,CVTPTR                                          1358
         L     @08,CVTEXT2(,@08)                                   1358
         L     @08,CVTICB(,@08)                                    1358
         L     @03,VVIVSCRA(,VVIPTR)                               1358
         ST    @03,ICBVSCRA(,@08)                                  1358
*   SCAN31=UCBDELIM;                /* SET TABLE DELIMTER    @Y30LB27*/
         L     @08,UCBDELIM                                        1359
         ST    @08,SCAN31(,SCANPTR)                                1359
*   SCANPTR=SCANPTR+FOUR;           /* GET NEXT ADDRESS      @Y30LB27
*                                                            @Y30LB27*/
         AL    SCANPTR,@CF00098                                    1360
*/*********************************************************************
* * CALCULATE NUMBER OF BYTES REMAING AND TABLE ADDR TO      @Y30LB27
* * NEXT DOUBLE WORD FREE THE TABLE                          @Y30LB27
* ********************************************************************/
*                                                                  1361
*   SCANPTR=EVAL(SCANPTR&MASKFFF8)+EIGHT;/* ROUND TO NEXT DOUBLE WORD
*                                      BDY                   @Y30LB27*/
         LR    @08,SCANPTR                                         1361
         N     @08,MASKFFF8                                        1361
         AL    @08,@CF00039                                        1361
         LR    SCANPTR,@08                                         1361
*   REG1=SCANPTR;                   /* SET FREEMAIN ADDR     @Y30LB27*/
         LR    REG1,SCANPTR                                        1362
*   REG0=NUMUCBS*FOUR-EVAL(SCANPTR-VVIUCB);/*                @G24LB04
*                                      # OF BYTES            @G24LB04*/
         LR    REG0,SCANPTR                                        1363
         SL    REG0,VVIUCB(,VVIPTR)                                1363
         LCR   REG0,REG0                                           1363
         AL    REG0,@CF03942                                       1363
*LFREEM3:                                                          1364
*   GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN SUBPOOL 241   1364
*                                                            @Y30LB27*/
LFREEM3  FREEMAIN RC,LV=(0),A=(1),SP=241
*/*CALCULATE SIZE OF DEVICE MASK TABLE ENTRY FROM COUNT OF   @G24LB04*/
*/* UCB LOOKUP POSITIONS IN SYSTEM, AND PUT THIS INTO MSVC   @G24LB04*/
*/* CONTROL BLOCK                                            @G24LB04*/
*                                                                  1365
*   VVIDVMEL=COUNTUCB/MASKDVSR;     /* NO OF FULLWORDS USED  @G24LB04*/
         L     @08,COUNTUCB                                        1365
         LR    @02,@08                                             1365
         SRDA  @02,32                                              1365
         D     @02,@CF00237                                        1365
         ST    @03,VVIDVMEL(,VVIPTR)                               1365
*   IF EVAL(COUNTUCB&MASK001F)^=ZEROFX31 THEN/*              @G24LB04*/
         ICM   @02,15,MASK001F                                     1366
         NR    @08,@02                                             1366
         LTR   @08,@08                                             1366
         BZ    @RF01366                                            1366
*     VVIDVMEL=VVIDVMEL+1;          /* NEED ANOTHER FULLWORD @G24LB04*/
         AL    @03,@CF00055                                        1367
         ST    @03,VVIDVMEL(,VVIPTR)                               1367
*/*   INITIALIZE STORAGE OBTAINED FOR ALLOCATE TO MOUNTED    @G24LB04*/
*/*   VOLUMES COMMUNICATION WITH JES3                        @G24LB04*/
*                                                                  1368
*   AMVJES3S=AMVJES3S&&AMVJES3S;    /*                       @G24LB04*/
@RF01366 L     @08,VVISSOBA(,VVIPTR)                               1368
         XC    AMVJES3S(84,@08),AMVJES3S(@08)                      1368
*   RESPECIFY                                                      1369
*     SSIB BASED(ADDR(AMVSSIB));    /* CLEAR IT              @G24LB04*/
*   SSIBID=CSSIB;                   /* PROVIDE ID OF BLOCK   @G24LB04*/
         LA    @05,48                                              1370
         ALR   @05,@08                                             1370
         MVC   SSIBID(4,@05),CSSIB                                 1370
*   SSIBLEN=LENGTH(SSIB);           /* AND LENGTH            @G24LB04*/
         MVC   SSIBLEN(2,@05),@CH03936                             1371
*   SSIBSSNM=JESPJESN;              /* PRIMARY SUBSYSTEM NAME      1372
*                                                            @G24LB04*/
         L     @04,CVTPTR                                          1372
         L     @04,CVTJESCT(,@04)                                  1372
         MVC   SSIBSSNM(4,@05),JESPJESN(@04)                       1372
*   RESPECIFY                                                      1373
*     SSOB BASED(ADDR(AMVSSOB));    /*                       @G24LB04*/
*   RESPECIFY                                                      1374
*     SSMO BASED(ADDR(AMVSSBX));    /*                       @G24LB04*/
*   SSOBID=CSSOB;                   /* ID OF BLOCK           @G24LB04*/
         MVC   SSOBID(4,@08),CSSOB                                 1375
*   SSOBLEN=LENGTH(SSOB);           /* AND LENGTH            @G24LB04*/
         LA    @05,20                                              1376
         STH   @05,SSOBLEN(,@08)                                   1376
*   SSOBFUNC=SSOBMSVC;              /* MSVC FUNCTION         @G24LB04*/
         MVC   SSOBFUNC(2,@08),@CH02569                            1377
*   SSOBSSIB=ADDR(AMVSSIB);         /* SSIB ADDRESS          @G24LB04*/
         LA    @04,AMVSSIB(,@08)                                   1378
         ST    @04,SSOBSSIB(,@08)                                  1378
*   SSOBINDV=ADDR(AMVSSBX);         /* SSOB EXTENSION        @G24LB04*/
         LA    @04,AMVSSBX(,@08)                                   1379
         ST    @04,SSOBINDV(,@08)                                  1379
*   SSMOLEN=LENGTH(SSMO);           /* LENGTH OF SSOB        @G24LB04
*                                      EXTENSION             @G24LB04*/
         ALR   @08,@05                                             1380
         MVC   SSMOLEN(2,@08),@CH00272                             1380
*   SSMORUSE=ON;                    /* SET UP FOR REUSE      @G24LB04*/
         OI    SSMORUSE(@08),B'00010000'                           1381
*   END VINUCBTB;                   /*                       #Y30LB27*/
         B     @EL00014                                            1382
*                                                                  1383
*/******************************************************************
**                                                           @Y30LB27
**     NAME = VINUCBMT: SEGMENT TO UPDATE MOUNT STATUS.      @Y30LB27
**                                                           @Y30LB27
**     INPUT = UCBS REFLECTING A MOUNTED MSS VOLUME.     @Y30LB27  1383
**                                                           @Y30LB27
**     PROCESS = UPDATES MOUNT STATUS                        @Y30LB27
**                                                           @Y30LB27
**     OUTPUT = INVENTORY REFLECTS MOUNTED MSS VOLUMES,      @G24LB04
**              INCLUDING MOUNT NON-SHARED STATUS.           @G24LB04
**                                                           @Y30LB27
**********************************************************************/
*                                                                  1383
*VINUCBMT:                                                         1383
*   PROC OPTIONS(SAVE(14));         /*                       @ZM31138
*                                                            @Y30LB27*/
VINUCBMT ST    @14,@SA00015                                        1383
*/*********************************************************************
* * SET RECORD BUFFER POINTER                                @Y30LB27
* ********************************************************************/
*                                                                  1384
*   BASEVPTR=CPUIDPTR;              /* SET PTR FOR BASE VOL RECORD 1384
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         L     @08,CPUIDPTR                                        1384
         ST    @08,BASEVPTR                                        1384
*/*********************************************************************
* * SET KEY FOR A BASE VOLUME RECORD                         @Y30LB27
* ********************************************************************/
*                                                                  1385
*   BASNAME=CBASNAMK;               /* SET KEY FOR ANY BASE VOL REC.
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         MVC   BASNAME(13,@08),CBASNAMK                            1385
*/*********************************************************************
* * BASE UCB ON TABLE OF VIRTUAL UCB ADDRESSES               @Y30LB27
* ********************************************************************/
*                                                                  1386
*   RFY                                                            1386
*    (UCBOB) BASED(SCANP31);        /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * INDICATE VOLUME RECORD TO BE READ                        @Y30LB27
* ********************************************************************/
*                                                                  1387
*   BASSERNO=UCBVOLI;               /* SET VOLID             @Y30LB27
*                                                            @Y30LB27*/
         L     @03,SCANP31(,SCANPTR)                               1387
         MVC   BASSERNO(6,@08),UCBVOLI(@03)                        1387
*/*********************************************************************
* * INITIALIZE VSAM RPL AND READ BASE VOLUME RECORD          @Y30LB27
* ********************************************************************/
*                                                                  1388
*   RPLVTYP=RPLVREAD;               /* INDICATE READ         @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1388
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB27*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1389
*   RPLVUPD=ON;                     /* INDICATE READ FOR UPDATE    1390
*                                                            @Y30LB27*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1390
*   RPLVBUF=BASEVPTR;               /* SET RECORD PTR        @Y30LB27*/
         ST    @08,RPLVBUF(,RPLVPTR)                               1391
*   RPLVKEY=BASEVPTR;               /* SET KEY PTR           @Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1392
*   RPLVBLN=MAXREC;                 /* INDICATE BUFFER FOR MAXIMUM 1393
*                                                            @Y30LB27*/
         MVC   RPLVBLN(4,RPLVPTR),@CF03640                         1393
*   REG1=RPLVPTR;                   /* SET PTR TO MSVC RPL   @Y30LB27*/
         LR    REG1,RPLVPTR                                        1394
*   CALL ICBVIO00;                  /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1395
         BALR  @14,@15                                             1395
*   RPLVDIR=OFF;                    /* READ DIRECT           @Y30LB27
*                                                            @Y30LB27*/
         NI    RPLVDIR(RPLVPTR),B'10111111'                        1396
*/*********************************************************************
* * IF I/O ERROR NOTIFY OPERATOR                             @Y30LB27
* ********************************************************************/
*                                                                  1397
*   IF RPLVRETC^=ZERO THEN                                         1397
         LH    @08,RPLVRETC(,RPLVPTR)                              1397
         N     @08,@CF03969                                        1397
         LTR   @08,@08                                             1397
         BZ    @RF01397                                            1397
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       IF RPLRCODE=NORECFND THEN                                  1399
         LH    @08,RPLRCODE(,RPLVPTR)                              1399
         N     @08,@CF03969                                        1399
         CH    @08,NORECFND                                        1399
         BNE   @RF01399                                            1399
*         DO;                       /* NO RECORD FOUND       @Y30LB27*/
*           VINMSGID=MSGVLE;        /* INDICATE VOL ERROR    @YM04327*/
         MVC   VINMSGID(2),@CH03715                                1401
*           MSGLEN1=SIX;            /* COMP LEN              @YM04327*/
         MVI   MSGLEN1,X'06'                                       1402
*           MSGTEXT1=ADDR(UCBVOLI); /* COMP ADDR             @YM04327*/
         L     @08,SCANP31(,SCANPTR)                               1403
         LA    @08,UCBVOLI(,@08)                                   1403
         STCM  @08,7,MSGTEXT1                                      1403
*         END;                      /* END NO REC FOUND      @YM04327*/
*       ELSE                                                       1405
*         DO;                       /* VSAM ERROR            @YM04327*/
         B     @RC01399                                            1405
@RF01399 DS    0H                                                  1406
*           VINMSGID=MSGVSME;       /* SET MSG INDEX         @Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1406
*           MSGLEN1=TWELVE;         /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1407
*           MSGTEXT1=RPLVKEY;       /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1408
*           CNVRTWK1=RPLRCODE;      /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1409
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1409
*           CALL VINCNVRT;          /* CONVERTED             @Y30LB27*/
         BAL   @14,VINCNVRT                                        1410
*         END;                      /* END VSAM ERROR        @YM04327*/
*       CALL VINWTO;                /*                       @Y30LB27*/
@RC01399 BAL   @14,VINWTO                                          1412
*       RETURN;                     /* ISSUE MESSAGE         @Y30LB27*/
@EL00015 DS    0H                                                  1413
@EF00015 DS    0H                                                  1413
@ER00015 L     @14,@SA00015                                        1413
         BR    @14                                                 1413
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * SET RPL TO PUT THE UPDATED RECORD                        @Y30LB27
* ********************************************************************/
*                                                                  1415
*   RPLVTYP=RPLVPUT;                /* INDICATE PUT          @G24LB23
*                                                            @Y30LB27*/
@RF01397 MVI   RPLVTYP(RPLVPTR),X'01'                              1415
*/*********************************************************************
* * INDICATE THE VOLUME MOUNTED AND RE-WRITE THE RECORD      @Y30LB27
* ********************************************************************/
*                                                                  1416
*   BASCPUID=VVICPUID×BASCPUID;     /* INDICATE VOLUME       @Y30LB27*/
         L     @08,BASEVPTR                                        1416
         OC    BASCPUID(2,@08),VVICPUID(VVIPTR)                    1416
*   BASDLMTD=CVTDATE;               /* UPDATE DATE LAST MOUNTED    1417
*                                                            @YN02191*/
         L     @03,CVTPTR                                          1417
         MVC   BASDLMTD(4,@08),CVTDATE(@03)                        1417
*   BASDLMTD=BASDLMTD&FC;           /* SIGN DATE             @ZA14733*/
         NC    BASDLMTD(4,@08),@CB03677                            1418
*   BASDLSF=OFF;                    /* INDICATE SPACE NOT DOWN LEVEL
*                                                            @G24LB23*/
         NI    BASDLSF(@08),B'01111111'                            1419
*   REG1=RPLVPTR;                   /* SET PTR TO MSVC RPL   #Y30LB27*/
         LR    REG1,RPLVPTR                                        1420
*   CALL ICBVIO00;                  /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1421
         BALR  @14,@15                                             1421
*   IF RPLVRETC^=ZERO THEN                                         1422
         LH    @08,RPLVRETC(,RPLVPTR)                              1422
         N     @08,@CF03969                                        1422
         LTR   @08,@08                                             1422
         BZ    @RF01422                                            1422
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       VINMSGID=MSGVSME;           /* SET MSG INDEX         #Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1424
*       MSGLEN1=TWELVE;             /* LEN OF MSG CONST      #Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1425
*       MSGTEXT1=RPLVKEY;           /* LOCATION OF NON-GRP   @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1426
*       CNVRTWK1=RPLRCODE;          /* SET REASON CODE       @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1427
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1427
*       CALL VINCNVRT;              /* IN PRINTABLE FORMAT   @Y30LB27*/
         BAL   @14,VINCNVRT                                        1428
*       CALL VINWTO;                /* ISSUE THE ERROR MSG   @Y30LB27*/
         BAL   @14,VINWTO                                          1429
*       RETURN;                     /*                       @Y30LB27*/
         B     @EL00015                                            1430
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * IF THE VOLUME IS GROUPED READ THE VVGROUP AND            @Y30LB27
* * EXTENSION RECORDS                                        @Y30LB27
* ********************************************************************/
*                                                                  1432
*   RPLVTYP=RPLVREAD;               /* INDICATE READ         @Y30LB27*/
@RF01422 MVI   RPLVTYP(RPLVPTR),X'00'                              1432
*   RPLVDIR=ON;                     /* READ DIRECT           @Y30LB27*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1433
*   IF BASGRPV=OFF×BASGENUS=OFF×BASINAC=ON THEN                    1434
         L     @08,BASEVPTR                                        1434
         TM    BASINAC(@08),B'00000100'                            1434
         BNZ   @RT01434                                            1434
         TM    BASGRPV(@08),B'00110000'                            1434
         BNO   @RT01434                                            1434
*     RETURN;                       /* IF NOT A MEMBER OF A GROUP  1435
*                                      CONT                  @Y30LB27*/
*   GROUPPTR=BASEVPTR;              /* SET GROUP REC PTR     @Y30LB27*/
         ST    @08,GROUPPTR                                        1436
*   GRONAME=CGRONAMK;               /* GET GENERAL GROUP KEY @Y30LB27*/
         MVC   GRONAME(13,@08),CGRONAMK                            1437
*   GROVVGRP=BASGROUP;              /* SET GROUP NAME IN KET @Y30LB27*/
         L     @03,BASEVPTR                                        1438
         MVC   GROVVGRP(8,@08),BASGROUP(@03)                       1438
*   REG1=RPLVPTR;                   /* SET PTR TO MSVC RPL   @Y30LB27*/
         LR    REG1,RPLVPTR                                        1439
*   CALL ICBVIO00;                  /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1440
         BALR  @14,@15                                             1440
*   RPLVDIR=OFF;                    /* READ DIRECT           @Y30LB27*/
         NI    RPLVDIR(RPLVPTR),B'10111111'                        1441
*   IF RPLVRETC^=ZERO THEN                                         1442
         LH    @08,RPLVRETC(,RPLVPTR)                              1442
         N     @08,@CF03969                                        1442
         LTR   @08,@08                                             1442
         BZ    @RF01442                                            1442
*     DO;                           /* VSAM I/O ERROR        @Y30LB27*/
*       IF RPLRCODE=NORECFND THEN                                  1444
         LH    @08,RPLRCODE(,RPLVPTR)                              1444
         N     @08,@CF03969                                        1444
         CH    @08,NORECFND                                        1444
         BNE   @RF01444                                            1444
*         DO;                       /* NO RECORD FOUND       @ZM30746*/
*           VINMSGID=MSGGRPE;       /* INDICATE VOL ERROR    @ZM30746*/
         LH    @08,MSGGRPE                                         1446
         STH   @08,VINMSGID                                        1446
*           MSGLEN1=SIX;            /* COMP LEN              @ZM30746*/
         MVI   MSGLEN1,X'06'                                       1447
*           MSGTEXT1=ADDR(BASGROUP);/* COMP ADDR             @ZM30746*/
         L     @08,BASEVPTR                                        1448
         LA    @08,BASGROUP(,@08)                                  1448
         STCM  @08,7,MSGTEXT1                                      1448
*           MSGLEN2=SIX;            /* COMP LEN              @ZM30746*/
         MVI   MSGLEN2,X'06'                                       1449
*           MSGTEXT2=ADDR(UCBVOLI); /* COMP ADDR             @ZM30746*/
         L     @08,SCANP31(,SCANPTR)                               1450
         LA    @08,UCBVOLI(,@08)                                   1450
         STCM  @08,7,MSGTEXT2                                      1450
*         END;                      /* END NO REC FOUND      @ZM30746*/
*       ELSE                                                       1452
*         DO;                       /* VSAM ERROR            @ZM30746*/
         B     @RC01444                                            1452
@RF01444 DS    0H                                                  1453
*           VINMSGID=MSGVSME;       /* SET MSG INDEX         @ZM30746*/
         MVC   VINMSGID(2),@CH00172                                1453
*           MSGLEN1=TWELVE;         /* LEN OF MSG CONST      @ZM30746*/
         MVI   MSGLEN1,X'0C'                                       1454
*           MSGTEXT1=RPLVKEY;       /* LOCATION OF NON-GRP   @ZM30746*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1455
*           CNVRTWK1=RPLRCODE;      /* SET REASON CODE       @ZM30746*/
         MVI   CNVRTWK1+2,X'00'                                    1456
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1456
*           CALL VINCNVRT;          /* CONVERTED             @Y30LB27*/
         BAL   @14,VINCNVRT                                        1457
*           CALL VINWTO;            /* ISSUE THE ERROR MSG   @Y30LB27*/
         BAL   @14,VINWTO                                          1458
*         END;                      /*                       @ZM30746*/
*       RETURN;                     /*                       @Y30LB27*/
         B     @EL00015                                            1460
*     END;                          /*                       @Y30LB27*/
*   GVSEXSW=ON;                     /* INDICATE READ OF EXTENSION  1462
*                                      RECORD                @Y30LB27
*                                                            @Y30LB27*/
@RF01442 OI    GVSEXSW,B'01000000'                                 1462
*/*********************************************************************
* * SEARCH GROUP EXTENSION RECORDS FOR VOLUME                @Y30LB27
* ********************************************************************/
*                                                                  1463
*   DO WHILE(GVSEXSW=ON);           /* CONTINUE TO READ EXTENSIONS 1463
*                                                            @Y30LB27*/
         B     @DE01463                                            1463
@DL01463 DS    0H                                                  1464
*     RPLVNEXT=ON;                  /* INDICATE READ NEXT    @Y30LB27*/
         OI    RPLVNEXT(RPLVPTR),B'00100000'                       1464
*     REG1=RPLVPTR;                 /* SET PTR TO MSVC RPL   @Y30LB27*/
         LR    REG1,RPLVPTR                                        1465
*     CALL ICBVIO00;                /* CALL ICBVIN00         @Y30LB27*/
         L     @15,@CV03332                                        1466
         BALR  @14,@15                                             1466
*     RPLVNEXT=OFF;                 /* INDICATE READ NEXT    @Y30LB27*/
         NI    RPLVNEXT(RPLVPTR),B'11011111'                       1467
*     IF RPLVRETC^=ZERO THEN                                       1468
         LH    @08,RPLVRETC(,RPLVPTR)                              1468
         N     @08,@CF03969                                        1468
         LTR   @08,@08                                             1468
         BZ    @RF01468                                            1468
*       DO;                         /* VSAM I/O ERROR        @ZM30746*/
*         IF RPLRCODE=NORECFND THEN                                1470
         LH    @08,RPLRCODE(,RPLVPTR)                              1470
         N     @08,@CF03969                                        1470
         CH    @08,NORECFND                                        1470
         BNE   @RF01470                                            1470
*           DO;                     /* NO RECORD FOUND       @ZM30746*/
*             VINMSGID=MSGGRPE;     /* INDICATE VOL ERROR    @ZM30746*/
         LH    @08,MSGGRPE                                         1472
         STH   @08,VINMSGID                                        1472
*             MSGLEN1=SIX;          /* COMP LEN              @ZM30746*/
         MVI   MSGLEN1,X'06'                                       1473
*             MSGTEXT1=ADDR(BASGROUP);/* COMP ADDR           @ZM30746*/
         L     @08,BASEVPTR                                        1474
         LA    @08,BASGROUP(,@08)                                  1474
         STCM  @08,7,MSGTEXT1                                      1474
*             MSGLEN2=SIX;          /* COMP LEN              @ZM30746*/
         MVI   MSGLEN2,X'06'                                       1475
*             MSGTEXT2=ADDR(UCBVOLI);/* COMP ADDR            @ZM30746*/
         L     @08,SCANP31(,SCANPTR)                               1476
         LA    @08,UCBVOLI(,@08)                                   1476
         STCM  @08,7,MSGTEXT2                                      1476
*           END;                    /* END NO REC FOUND      @ZM30746*/
*         ELSE                                                     1478
*           DO;                     /* VSAM ERROR            @ZM30746*/
         B     @RC01470                                            1478
@RF01470 DS    0H                                                  1479
*             VINMSGID=MSGVSME;     /* SET MSG INDEX         @ZM30746*/
         MVC   VINMSGID(2),@CH00172                                1479
*             MSGLEN1=TWELVE;       /* LEN OF MSG CONST      @ZM30746*/
         MVI   MSGLEN1,X'0C'                                       1480
*             MSGTEXT1=RPLVKEY;     /* LOCATION OF NON-GRP   @ZM30746*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1481
*             CNVRTWK1=RPLRCODE;    /* SET REASON CODE       @ZM30746*/
         MVI   CNVRTWK1+2,X'00'                                    1482
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1482
*             CALL VINCNVRT;        /* CONVERTED             @ZM30746*/
         BAL   @14,VINCNVRT                                        1483
*             CALL VINWTO;          /* ISSUE THE ERROR MSG   @ZM30746*/
         BAL   @14,VINWTO                                          1484
*           END;                    /*                       @ZM30746*/
*         RETURN;                   /*                       @ZM30746*/
         B     @EL00015                                            1486
*       END;                        /*                       @ZM30746
*                                                            @Y30LB27*/
*/*********************************************************************
* * VOLUME IN THIS GROUP EXTENSION? IF YES INDICATE VOLUME    @G24LB04
* * MOUNTED. IF NO, TRY NEXT EXTENSION                        @G24LB04
* ********************************************************************/
*                                                                  1488
*     DO I=ONE TO GVSESIND-ONE;     /* LOOP CONTROL          @Y30LB27*/
@RF01468 LA    I,1                                                 1488
         B     @DE01488                                            1488
@DL01488 DS    0H                                                  1489
*       IF UCBVOLI=GVSVOLID(I) THEN                                1489
         L     @03,SCANP31(,SCANPTR)                               1489
         L     @05,GVSNEPTR                                        1489
         LR    @04,I                                               1489
         MH    @04,@CH00088                                        1489
         ST    @04,@TF00001                                        1489
         ALR   @04,@05                                             1489
         CLC   UCBVOLI(6,@03),GVSVOLID-20(@04)                     1489
         BNE   @RF01489                                            1489
*         DO;                       /* SPECIFIED VOLID       @Y30LB27*/
*           GVSCPUBM(I)=VVICPUID×GVSCPUBM(I);/* INDICATE VOLUME    1491
*                                      MOUNTED               @Y30LB27*/
         LR    @04,@05                                             1491
         AL    @04,@TF00001                                        1491
         OC    GVSCPUBM-20(2,@04),VVICPUID(VVIPTR)                 1491
*           IF UCBRR=OFF            /* MOUNTED AS HOST       @G24LB04
*                                      NON-SHARED?           @G24LB04*/
*             THEN                                                 1492
         TM    UCBRR(@03),B'00100000'                              1492
         BNZ   @RF01492                                            1492
*             GVSMTNSH(I)=ON;       /* YES, SET FLAG IN GVSNE      1493
*                                                            @G24LB04*/
*                                                                  1493
         AL    @05,@TF00001                                        1493
         OI    GVSMTNSH-20(@05),B'01000000'                        1493
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VOLUME BELONGS TO A GROUP OTHER THAN   @G24LB23*/
*           /* SYSGROUP, IS MOUNTED PRIVATE RESERVED OR      @G24LB23*/
*           /* REMOVABLE OR WITH NO MOUNT AND USE ATTRIBUTES,        */
*           /*                                               @G24LB23*/
*           /* AND IF ENABLE WITH RESTORED IS REQUESTED, THEN        */
*           /*                                               @G24LB23*/
*           /* LSPACE THE VOLUME.                            @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1494
*           IF INIENABL=ON&INIRESTR=ON&GVSVVGRP^=SYSGROUP&((UCBBPRV=ON&
*               (UCBRESV=ON×(UCBPRES=OFF&UCBRESV=OFF)))×(UCBBPRV=OFF&
*               UCBBPUB=OFF&UCBBSTR=OFF)) THEN                     1494
@RF01492 L     @03,INITPTR                                         1494
         TM    INIENABL(@03),B'01000000'                           1494
         BNO   @RF01494                                            1494
         TM    INIRESTR(@03),B'00010000'                           1494
         BNO   @RF01494                                            1494
         L     @03,GVSNEPTR                                        1494
         CLC   GVSVVGRP(8,@03),@CC03588                            1494
         BE    @RF01494                                            1494
         L     @03,SCANP31(,SCANPTR)                               1494
         TM    UCBBPRV(@03),B'00010000'                            1494
         BNO   @GL00032                                            1494
         TM    UCBRESV(@03),B'00100000'                            1494
         BO    @RT01494                                            1494
         TM    UCBPRES(@03),B'00100100'                            1494
         BZ    @RT01494                                            1494
@GL00032 L     @03,SCANP31(,SCANPTR)                               1494
         TM    UCBBPRV(@03),B'00011100'                            1494
         BNZ   @RF01494                                            1494
@RT01494 DS    0H                                                  1495
*             DO;                   /*                       @G24LB23*/
*                                                                  1495
*               /*****************************************************/
*               /*                                                   */
*               /* INITIALIZE FOR LSPACE AND ISSUE LSPACE REQUEST    */
*               /*                                           @G24LB23*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1496
*               REG0=ADDR(UCBOB);   /*                       @G24LB23*/
         L     REG0,SCANP31(,SCANPTR)                              1496
*               REG1=ADDR(LSPAREA); /*                       @G24LB23*/
         LA    REG1,LSPAREA                                        1497
*               SVC(LSPACE);        /*                       @G24LB23*/
*                                                                  1498
         SVC   78                                                  1498
*               /*****************************************************/
*               /*                                                   */
*               /* IF LSPACE SUCCESSFUL, MOVE FREE SPACE INTO        */
*               /*                                           @G24LB23*/
*               /* AVAILABLE FREE SPACE FIELD                @G24LB23*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1499
*               IF REG15=ZERO THEN                                 1499
         LTR   REG15,REG15                                         1499
         BNZ   @RF01499                                            1499
*                 DO;               /*                       @G24LB23*/
*                   PACK(TEMPPACK,LSPFRESP);/*               @G24LB23*/
         PACK  TEMPPACK(4),LSPFRESP(4)                             1501
*                   CVB(TEMPBIN,TEMPPACK);/*                 @G24LB23*/
         XC    @TS00001(8),@TS00001                                1502
         MVC   @TS00001+4(4),TEMPPACK                              1502
         CVB   @03,@TS00001                                        1502
         ST    @03,TEMPBIN                                         1502
*                   GVSRCFSI(I)=OFF;/*                       @G24LB23*/
         L     @05,GVSNEPTR                                        1503
         LR    @04,I                                               1503
         MH    @04,@CH00088                                        1503
         ST    @04,@TF00001                                        1503
         ALR   @04,@05                                             1503
         NI    GVSRCFSI-20(@04),B'01111111'                        1503
*                   GVSMTDSP(I)=TEMPBIN;/*                   @G24LB23*/
         L     @04,@TF00001                                        1504
         STH   @03,GVSMTDSP-20(@04,@05)                            1504
*                   GVSFRESP(I)=TEMPBIN;/* UPDATE FREE SPACE @ZA28479*/
         L     @04,@TF00001                                        1505
         STH   @03,GVSFRESP-20(@04,@05)                            1505
*                   PACK(TEMPPACK,LSPLEXT);/*                @ZA28479*/
         PACK  TEMPPACK(4),LSPLEXT(4)                              1506
*                   CVB(TEMPBIN,TEMPPACK);/*                 @ZA28479*/
         XC    @TS00001(8),@TS00001                                1507
         MVC   @TS00001+4(4),TEMPPACK                              1507
         CVB   @03,@TS00001                                        1507
         ST    @03,TEMPBIN                                         1507
*                   GVSLEXT(I)=TEMPBIN;/* UPDATE LRGST EXTENT      1508
*                                                            @ZA28479*/
         L     @04,@TF00001                                        1508
         STH   @03,GVSLEXT-20(@04,@05)                             1508
*                 END;              /*                       @G24LB23*/
*               ELSE                                               1510
*                                                                  1510
*                 /***************************************************/
*                 /*                                                 */
*                 /* PRINT LSPACE ERROR MESSAGE AND TURN ON INVALID  */
*                 /*                                         @G24LB23*/
*                 /* AVAILABLE SPACE FLAG.                   @G24LB23*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1510
*                 DO;               /*                       @G24LB23*/
         B     @RC01499                                            1510
@RF01499 DS    0H                                                  1511
*                   GVSRCFSI(I)=ON; /*                       @G24LB23*/
         LR    @03,I                                               1511
         MH    @03,@CH00088                                        1511
         L     @05,GVSNEPTR                                        1511
         ALR   @05,@03                                             1511
         OI    GVSRCFSI-20(@05),B'10000000'                        1511
*                   MSGRQ=''B;      /*                       @G24LB23*/
         XC    MSGRQ(32),MSGRQ                                     1512
*                   MSGRPLV=RPLVPTR;/*                       @G24LB23*/
         ST    RPLVPTR,MSGRPLV                                     1513
*                   MSGID=M401;     /*                       @G24LB23*/
         MVC   MSGID(4),@CF03592                                   1514
*                   MSGLEN1=SIX;    /*                       @G24LB23*/
         MVI   MSGLEN1,X'06'                                       1515
*                   MSGTEXT1=ADDR(UCBVOLI);/*                @G24LB23*/
         L     @08,SCANP31(,SCANPTR)                               1516
         LA    @08,UCBVOLI(,@08)                                   1516
         STCM  @08,7,MSGTEXT1                                      1516
*                   MSGLEN2=TWO;    /*                       @G24LB23*/
         MVI   MSGLEN2,X'02'                                       1517
*                   MSGTEXT2=ADDR(TEMPCHAR);/*               @G24LB23*/
         LA    @08,TEMPCHAR                                        1518
         STCM  @08,7,MSGTEXT2                                      1518
*                   TEMPBIN=REG15;  /*                       @G24LB23*/
         ST    REG15,TEMPBIN                                       1519
*                   CVD(TEMPBIN,TEMPPACK);/*                 @G24LB23*/
         L     @08,TEMPBIN                                         1520
         CVD   @08,@TS00001                                        1520
         MVC   TEMPPACK(4),@TS00001+4                              1520
*                   UNPK(TEMPCHAR,TEMPPACK);/*               @G24LB23*/
         UNPK  TEMPCHAR(2),TEMPPACK(4)                             1521
*                   TEMPCHAR=TEMPCHAR×NUMCONV;/*             @G24LB23*/
         OC    TEMPCHAR(2),@CB03596                                1522
*                   REG1=ADDR(MSGRQ);/*                      @G24LB23*/
         LA    REG1,MSGRQ                                          1523
*                   CALL ICBVOP00;  /*                       @G24LB23*/
         L     @15,@CV03334                                        1524
         BALR  @14,@15                                             1524
*                   MSGRQ=''B;      /*                       @G24LB23*/
         XC    MSGRQ(32),MSGRQ                                     1525
*                   MSGRPLV=RPLVPTR;/*                       @G24LB23*/
         ST    RPLVPTR,MSGRPLV                                     1526
*                 END;              /*                       @G24LB23*/
*             END;                  /*                       @G24LB23*/
@RC01499 DS    0H                                                  1529
*           RPLVTYP=RPLVPUT;        /* INDICATE PUT          @G24LB23*/
@RF01494 MVI   RPLVTYP(RPLVPTR),X'01'                              1529
*           REG1=RPLVPTR;           /* SET PTR TO MSVC RPL   #Y30LB27*/
         LR    REG1,RPLVPTR                                        1530
*           CALL ICBVIO00;          /* CALL ICBVIO00         @G24LB23*/
         L     @15,@CV03332                                        1531
         BALR  @14,@15                                             1531
*           IF RPLVRETC^=ZERO THEN                                 1532
         LH    @08,RPLVRETC(,RPLVPTR)                              1532
         N     @08,@CF03969                                        1532
         LTR   @08,@08                                             1532
         BZ    @RF01532                                            1532
*             DO;                   /* ERROR                 #Y30LB27*/
*               VINMSGID=MSGVSME;   /* SET ERROR INDEX       #Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                1534
*               MSGLEN1=TWELVE;     /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1535
*               MSGTEXT1=RPLVKEY;   /* LOCATION OF KEY       @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1536
*               CALL VINCNVRT;      /* CONVERTED             @Y30LB27*/
         BAL   @14,VINCNVRT                                        1537
*               CALL VINWTO;        /* ISSUE ERROR MSG       @Y30LB27*/
         BAL   @14,VINWTO                                          1538
*               RETURN;             /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00015                                            1539
*             END;                  /*                       @Y30LB27*/
*           RPLVTYP=RPLVREAD;       /* INDICATE READ         @Y30LB27*/
@RF01532 MVI   RPLVTYP(RPLVPTR),X'00'                              1541
*           RETURN;                 /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00015                                            1542
*         END;                      /*                       @Y30LB27*/
*     END;                          /*                       @Y30LB27*/
@RF01489 AL    I,@CF00055                                          1544
@DE01488 L     @03,GVSNEPTR                                        1544
         LH    @03,GVSESIND(,@03)                                  1544
         BCTR  @03,0                                               1544
         CR    I,@03                                               1544
         BNH   @DL01488                                            1544
*     IF GVSEX=ON THEN                                             1545
         L     @08,GVSNEPTR                                        1545
         TM    GVSEX(@08),B'10000000'                              1545
         BNO   @RF01545                                            1545
*       GVSEXSW=ON;                 /* ANOTHER EXTENSION REC @Y30LB27*/
         OI    GVSEXSW,B'01000000'                                 1546
*     ELSE                                                         1547
*       GVSEXSW=OFF;                /*                       @Y30LB27*/
         B     @RC01545                                            1547
@RF01545 NI    GVSEXSW,B'10111111'                                 1547
*   END;                            /*                       @Y30LB27*/
@RC01545 DS    0H                                                  1548
@DE01463 TM    GVSEXSW,B'01000000'                                 1548
         BO    @DL01463                                            1548
*   END VINUCBMT;                   /*                       @Y30LB27*/
         B     @EL00015                                            1549
*                                                                  1550
*/* ****************************************************************
**                                                           @Y30LB27
**  VINDSDS: SEGMENT TO DEALLOCATE AND CLOSE ALL DATA SETS   @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**     MSVC TCB ADDRESS                                      @Y30LB27
**     VVIACBAD, IN ICBVVICB = ACB ADDRESS OF MSVC INVENTORY @Y30LB27
**     VVIDCBAD, IN ICBVVICB = DCB ADDRESS OF MSVC JOURNAL   @Y30LB27
**     USER CATALOG ACB ADDRESS                              @Y30LB27
**     UCB ADDRESSES IN TIOT ENTRIES                         @Y30LB27
**     ACB, DCB ADDRESSES IN ICBVVICB                        @Y30LB27
**                                                           @Y30LB27
**  PROCESS: SEGMENT TO DEALLOCATE AND CLOSE ALL DATA SETS   @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**     WHEN DATA SETS ARE CLOSED -                           @Y30LB27
**       VVIACBAD = 0                                        @Y30LB27
**       VVIDCBAD = 0                                        @Y30LB27
**     WHEN DATA SETS ARE DEALLOCATED -                      @Y30LB27
**       UCB ADDRS IN EACH TIOT ENTRY ARE SET TO ZERO        @G24LB04
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  1550
*VINDSDS:                                                          1550
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27*/
VINDSDS  ST    @14,@SA00016                                        1550
*/*********************************************************************
* * SAVE  RPLVRETC IF NOT A DISABLE CALL                     @Y30LB27
* ********************************************************************/
*                                                                  1551
*   SAVRETC=RPLVRETC;               /* SAVE RETURN CODE      @Y30LB27*/
         LH    @08,RPLVRETC(,RPLVPTR)                              1551
         N     @08,@CF03969                                        1551
         STH   @08,SAVRETC                                         1551
*   RPLVRETC=ZERO;                  /* ZERO IT               @Y30LB27*/
         SLR   @08,@08                                             1552
         STH   @08,RPLVRETC(,RPLVPTR)                              1552
*   DISSW=ON;                       /* INDICATE DISABLE PROCESSING TO
*                                      VINWTO                @Y30LB27
*                                                            @Y30LB27*/
         OI    DISSW,B'00000001'                                   1553
*/*********************************************************************
* * NON-ZERO ADDRESS MEANS OPEN DCB - CLOSE, DE-ALLOCATE,    @Y30LB27
* * AND FREE STORAGE                                         @Y30LB27
* ********************************************************************/
*                                                                  1554
*   IF VVIDCBAD^=ZERO THEN                                         1554
         C     @08,VVIDCBAD(,VVIPTR)                               1554
         BE    @RF01554                                            1554
*     DO;                           /* DCB PRESENT           @Y30LB27*/
*       IF DCBOFOPN=ON THEN                                        1556
         L     @08,DCBPTR                                          1556
         TM    DCBOFOPN+40(@08),B'00010000'                        1556
         BNO   @RF01556                                            1556
*         DO;                       /* OPEN DCB              @Y30LB27*/
*           IF VVIFLG5=OFF THEN     /* JOURNAL RESERVED      @ZM31134*/
         TM    VVIFLG5(VVIPTR),B'00000100'                         1558
         BNZ   @RF01558                                            1558
*             DO;                   /*                       @ZM31134*/
*               VRRSWJ=ON;          /* SET ICBVIN00 RESVD    @ZM31134*/
         OI    VRRSWJ,B'00010000'                                  1560
*               CALL JRNLRES;       /* RESERVE THE JOURNAL   @ZA05515*/
         BAL   @14,JRNLRES                                         1561
*             END;                  /*                       @ZM31134*/
*           IF INIDISAB=OFF THEN                                   1563
@RF01558 L     @08,INITPTR                                         1563
         TM    INIDISAB(@08),B'00100000'                           1563
         BNZ   @RF01563                                            1563
*             DO;                   /* ENABLE OR IPL         @ZM30746*/
*               VJLSW=ON;           /* REMBER TEMP SETTING OF      1565
*                                      INIDISABL             @ZM30746*/
         OI    VJLSW,B'01000000'                                   1565
*               INIDISAB=ON;        /* IND DISABLE           @ZM30746*/
         OI    INIDISAB(@08),B'00100000'                           1566
*             END;                  /* END JRNL TEST         @ZM30746*/
*           REG1=RPLVPTR;           /* SET RPLV PTR          @ZM30746*/
@RF01563 LR    REG1,RPLVPTR                                        1568
*           CALL ICBVJL00;          /* LET VJL SET EOF ADDR  @ZM30746*/
         L     @15,@CV03333                                        1569
         BALR  @14,@15                                             1569
*           IF VJLSW=ON THEN                                       1570
         TM    VJLSW,B'01000000'                                   1570
         BNO   @RF01570                                            1570
*             DO;                   /* ENABLE OR IPL         @ZM30746*/
*               VJLSW=OFF;          /* REMBER TEMP SETTING OF      1572
*                                      INIDISABL             @ZM30746*/
         NI    VJLSW,B'10111111'                                   1572
*               INIDISAB=OFF;       /* IND DISABLE           @ZM30746*/
         L     @08,INITPTR                                         1573
         NI    INIDISAB(@08),B'11011111'                           1573
*             END;                  /* END JRNL TEST         @ZM30746*/
*           REG0=VVIDCBAD;          /* SET DCB ADDRESS       #Y30LB27*/
@RF01570 L     REG0,VVIDCBAD(,VVIPTR)                              1575
*           CLSSTG=CLSLST;          /* SET CLOSE LIST        @Y30LB27*/
         L     @08,CLSLST                                          1576
         ST    @08,CLSSTG                                          1576
*LCLOSE3:                                                          1577
*           GEN(CLOSE ((REG0),),MF=(E,CLSSTG));/* CLOSE JOURNAL    1577
*                                                            @Y30LB27*/
LCLOSE3  CLOSE ((REG0),),MF=(E,CLSSTG)
*           IF VRRSWJ=ON THEN       /* CHECK IF IDBVIN00 RESVD     1578
*                                                            @ZM31134*/
         TM    VRRSWJ,B'00010000'                                  1578
         BNO   @RF01578                                            1578
*             DO;                   /*                       @ZM31134*/
*               CALL JRNLDEQ;       /* DEQUEUE JOURNAL       @ZA05515*/
         BAL   @14,JRNLDEQ                                         1580
*               VVIFLG5=OFF;        /* JOURNAL DEQED         @ZM30746*/
         NI    VVIFLG5(VVIPTR),B'11111011'                         1581
*               VRRSWJ=OFF;         /* SET ICBVIN00 RESVD SW OFF   1582
*                                                            @ZM31134*/
         NI    VRRSWJ,B'11101111'                                  1582
*             END;                  /*                       @ZM31134*/
*           IF DCBOFOPN=ON THEN                                    1584
@RF01578 L     @08,DCBPTR                                          1584
         TM    DCBOFOPN+40(@08),B'00010000'                        1584
         BNO   @RF01584                                            1584
*             DO;                   /* CLOSE FAILURE         @Y30LB27*/
*               VINMSGID=MSGCLSEJ;  /* CLOSE ERROR MESSAGE   @Y30LB27*/
         MVC   VINMSGID(2),@CH00167                                1586
*               CALL VINWTO;        /* CALL ERROR ROUTINE    @Y30LB27*/
         BAL   @14,VINWTO                                          1587
*             END;                  /*                       @Y30LB27*/
*         END;                      /*                       @Y30LB27
*                                                            @Y30LB27*/
@RF01584 DS    0H                                                  1590
*/*********************************************************************
* * IF CLOSE OKAY DE-ALLOCATE IT                             @G24LB04
* ********************************************************************/
*                                                                  1590
*       IF RPLVRETC=ZERO THEN       /* CAN DISABLE CONT      @Y30LB27*/
@RF01556 LH    @08,RPLVRETC(,RPLVPTR)                              1590
         N     @08,@CF03969                                        1590
         LTR   @08,@08                                             1590
         BNZ   @RF01590                                            1590
*         CALL VINDALJ2;            /* VS/2                  @Y30LB27
*                                                            @Y30LB27*/
         BAL   @14,VINDALJ2                                        1591
*/*********************************************************************
* * DE-ALLOC OKAY FREE STORAGE                               @Y30LB27
* ********************************************************************/
*                                                                  1592
*       IF RPLVRETC=ZERO THEN                                      1592
@RF01590 LH    @08,RPLVRETC(,RPLVPTR)                              1592
         N     @08,@CF03969                                        1592
         LTR   @08,@08                                             1592
         BNZ   @RF01592                                            1592
*         DO;                       /* DE-ALLOCATION OKAY    @Y30LB27*/
*           REG0=MAXDCBLN;          /* SET DCB LENGTH        @Y30LB27*/
         LA    REG0,96                                             1594
*           REG1=VVIDCBAD;          /* SET DCB ADDRESS       @Y30LB27*/
         L     REG1,VVIDCBAD(,VVIPTR)                              1595
*LFREEM4:                                                          1596
*           GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREE DCB @Y30LB27*/
LFREEM4  FREEMAIN RC,LV=(0),A=(1),SP=241
*           VVIDCBAD=ZERO;          /* ZERO DCB ADDRESS      @Y30LB27*/
         SLR   @08,@08                                             1597
         ST    @08,VVIDCBAD(,VVIPTR)                               1597
*         END;                      /*                       @Y30LB27*/
*     END;                          /*                       @Y30LB27
*                                                            @Y30LB27*/
@RF01592 DS    0H                                                  1600
*/*********************************************************************
* * IF SUCCESSFUL SO FAR AND THIS IS NOT A JOURANL DISABLE   @Y30LB27
* * CLOSE, DE-ALLOCATE AND FREE INVENTORY ACB                @Y30LB27
* ********************************************************************/
*                                                                  1600
*   IF RPLVRETC=ZERO&(ININIT=ON×INIABLE=ON×INIENABL=ON) THEN       1600
@RF01554 LH    @08,RPLVRETC(,RPLVPTR)                              1600
         N     @08,@CF03969                                        1600
         LTR   @08,@08                                             1600
         BNZ   @RF01600                                            1600
         L     @08,INITPTR                                         1600
         TM    ININIT(@08),B'10000000'                             1600
         BO    @RT01600                                            1600
         TM    INIABLE(@08),B'00100000'                            1600
         BO    @RT01600                                            1600
         TM    INIENABL(@08),B'01000000'                           1600
         BNO   @RF01600                                            1600
@RT01600 DS    0H                                                  1601
*     DO;                           /*                       @ZM30746*/
*       IF VVIACBAD^=ZERO THEN      /* DCB PRESENT           @Y30LB27*/
         L     @08,VVIACBAD(,VVIPTR)                               1602
         LTR   @08,@08                                             1602
         BZ    @RF01602                                            1602
*         DO;                       /* YES                   @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * CLOSE THE ACB                                            @Y30LB27
* ********************************************************************/
*                                                                  1604
*           IF ACBOPEN=ON THEN                                     1604
         TM    ACBOPEN(@08),B'00010000'                            1604
         BNO   @RF01604                                            1604
*             DO;                   /* ACB TO CLOSE          @Y30LB27*/
*               IF VVIFLG4=OFF THEN /* CHECK IF INV RESERVED @ZM31134*/
         TM    VVIFLG4(VVIPTR),B'00001000'                         1606
         BNZ   @RF01606                                            1606
*                 DO;               /*                       @ZM31134*/
*                   VRRSWI=ON;      /* INDICATE ICBVIN00 RESVD     1608
*                                                            @ZM31134*/
         OI    VRRSWI,B'00100000'                                  1608
*                   CALL INVRES;    /* RESERVE INVENTORY     @ZA05115*/
         BAL   @14,INVRES                                          1609
*                 END;              /*                       @ZM31134*/
*               REG0=VVIACBAD;      /* SET ACB ADDRESS       @Y30LB27*/
@RF01606 L     REG0,VVIACBAD(,VVIPTR)                              1611
*               CLSSTG=CLSLST;      /* SET CLOSE LIST        @Y30LB27*/
         L     @08,CLSLST                                          1612
         ST    @08,CLSSTG                                          1612
*LCLOSE4:                                                          1613
*               GEN(CLOSE ((REG0),),MF=(E,CLSSTG));/* CLOSE ACB    1613
*                                                            @Y30LB27*/
LCLOSE4  CLOSE ((REG0),),MF=(E,CLSSTG)
*               IF VRRSWI=ON THEN   /* ICBVIN00 RESEVD       @ZM31134*/
         TM    VRRSWI,B'00100000'                                  1614
         BNO   @RF01614                                            1614
*                 DO;               /*                       @ZM31134*/
*                   CALL INVDEQ;    /* DEQUEUE INVENTORY     @ZA05115*/
         BAL   @14,INVDEQ                                          1616
*                   VRRSWI=OFF;     /* SET ICBVIN00 RESEVD OFF     1617
*                                                            @ZM31134*/
         NI    VRRSWI,B'11011111'                                  1617
*                 END;              /*                       @ZM31134*/
*               IF ACBOPEN=ON THEN                                 1619
@RF01614 L     @08,VVIACBAD(,VVIPTR)                               1619
         TM    ACBOPEN(@08),B'00010000'                            1619
         BNO   @RF01619                                            1619
*                 DO;               /* CLOSE OKAY            @Y30LB27*/
*                   VINMSGID=MSGCLSEI;/* CLOSE ERROR MSG     @Y30LB27*/
         MVC   VINMSGID(2),@CH03410                                1621
*                   CNVRTWK1(ONE)=''B;/* ADD ERROR           @Y30LB27*/
         MVI   CNVRTWK1,X'00'                                      1622
*                   CNVRTWK1(TWO)=ACBERFLG;/* CODE TO MSG    @Y30LB27*/
         MVC   CNVRTWK1+1(1),ACBERFLG(@08)                         1623
*                   CALL VINCNVRT;  /* TO THE MSG            @Y30LB27*/
         BAL   @14,VINCNVRT                                        1624
*                   CALL VINWTO;    /* ISSUE ERROR MSG       @Y30LB27*/
         BAL   @14,VINWTO                                          1625
*                 END;              /*                       @Y30LB27*/
*             END;                  /*                       #Y30LB27
*                                                            #Y30LB27*/
@RF01619 DS    0H                                                  1628
*/*********************************************************************
* * CLOSE SUCCESSFUL - DE-ALLOC THE ACB                      @Y30LB27
* ********************************************************************/
*                                                                  1628
*           IF RPLVRETC=ZERO THEN   /* CAL IN BE DE-ALLOCATED        */
@RF01604 LH    @08,RPLVRETC(,RPLVPTR)                              1628
         N     @08,@CF03969                                        1628
         LTR   @08,@08                                             1628
         BNZ   @RF01628                                            1628
*             CALL VINDALV2;        /* VS/1                  @Y30LB27
*                                                            @Y30LB27*/
         BAL   @14,VINDALV2                                        1629
*/*********************************************************************
* * DE-ALLOC SUCCESSFUL FREE THE ACB STORAGE                 @G24LB04
* ********************************************************************/
*                                                                  1630
*           IF RPLVRETC=ZERO&VVIACBAD^=ZERO THEN                   1630
@RF01628 LH    @08,RPLVRETC(,RPLVPTR)                              1630
         N     @08,@CF03969                                        1630
         LTR   @08,@08                                             1630
         BNZ   @RF01630                                            1630
         L     @08,VVIACBAD(,VVIPTR)                               1630
         LTR   @08,@08                                             1630
         BZ    @RF01630                                            1630
*             DO;                   /*                       @ZM30746*/
*               REG0=MAXDCBLN;      /* SET ACB LENGTH        #Y30LB27*/
         LA    REG0,96                                             1632
*               REG1=VVIACBAD;      /* SET ACB ADDRESS       #Y30LB27*/
         LR    REG1,@08                                            1633
*LFREEM5:                                                          1634
*               GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREE ACB   1634
*                                                            #Y30LB27*/
LFREEM5  FREEMAIN RC,LV=(0),A=(1),SP=241
*               VVIACBAD=ZERO;      /* ZERO DCB ADDRESS      #Y30LB27*/
         SLR   @08,@08                                             1635
         ST    @08,VVIACBAD(,VVIPTR)                               1635
*             END;                  /*                       #Y30LB27*/
*         END;                      /*                       #Y30LB27*/
@RF01630 DS    0H                                                  1638
*     END;                          /*                       #Y30LB27*/
@RF01602 DS    0H                                                  1639
*   DISSW=OFF;                      /* DISABLE COMPLETE      #Y30LB27
*                                                            #Y30LB27*/
@RF01600 NI    DISSW,B'11111110'                                   1639
*/*********************************************************************
* * IF ENTERED FOR OTHER THAN DISABLE RESTORE THE RPLVRETC   #Y30LB27
* ********************************************************************/
*                                                                  1640
*   IF INIDISAB=OFF THEN            /* DISABLE               #Y30LB27*/
         L     @08,INITPTR                                         1640
         TM    INIDISAB(@08),B'00100000'                           1640
         BNZ   @RF01640                                            1640
*     RPLVRETC=SAVRETC;             /* RESTORE RPLVRETC      #Y30LB27*/
         LH    @08,SAVRETC                                         1641
         STH   @08,RPLVRETC(,RPLVPTR)                              1641
*   RETURN;                         /* RETURN TO CALLER      #Y30LB27*/
@EL00016 DS    0H                                                  1642
@EF00016 DS    0H                                                  1642
@ER00016 L     @14,@SA00016                                        1642
         BR    @14                                                 1642
*   END VINDSDS;                    /*                       #Y30LB27*/
         B     @EL00016                                            1643
*                                                                  1644
*/* ******************************************************************
**                                                           #Y30LB27
**    NAME = VINDALV2: SEGMENT TO DE-ALLOCATE INVENTORY      @G24LB04
**                                                           #Y30LB27
**    INPUT = NONE                                           #Y30LB27
**                                                           #Y30LB27
**     PROCESS = VINDALV2 IS A SUBSEGMENT OF SEGMENT VINDSDS. @Y30LB27
**                                                           #Y30LB27
**     OUTPUT = INVENTORY IS DE-ALLOCATED FROM MSVC THE TASK #Y30LB27
**                                                           #Y30LB27
******************************************************************** */
*                                                                  1644
*VINDALV2:                                                         1644
*   PROC OPTIONS(SAVE(14));         /*                       #Y30LB27
*                                                            #Y30LB27*/
VINDALV2 ST    @14,@SA00017                                        1644
*/*********************************************************************
* * RECONSTRUCT DYN ALLOC PARAMETER LIST                     #Y30LB27
* * AND ISSUE DYNAMIC DE-ALLOCATION FOR THE JOURNAL          #Y30LB27
* ********************************************************************/
*                                                                  1645
*   S99RB=S99RB&&S99RB;             /* CLEAR DYN ALLOC RB    #Y30LB27*/
         XC    S99RB(20),S99RB                                     1645
*   S99RBLN=TWENTY;                 /* SET LENGTH TO 20      #Y30LB27*/
         MVI   S99RBLN,X'14'                                       1646
*   S99VERB=S99VRBUN;               /* SET VERB CODE         #Y30LB27*/
         MVI   S99VERB,X'02'                                       1647
*   S99TXTPP=ADDR(TXTPTR(1));       /* INITIALIZE TEXT POINTER     1648
*                                                            #Y30LB27*/
         LA    @08,TXTPTR                                          1648
         ST    @08,S99TXTPP                                        1648
*   S99TUPLN(2)=ON;                 /* INDICATE END OF LIST  #Y30LB27*/
         OI    S99TUPLN+4(@08),B'10000000'                         1649
*   TXTPTR(TWO)->S99TULNG=UCATLEN+FIVE;/* SET PTR            #Y30LB27*/
         L     @08,TXTPTR+4                                        1650
         LA    @03,5                                               1650
         AH    @03,UCATLEN                                         1650
         STCM  @03,3,S99TULNG(@08)                                 1650
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+TWO:UCATLEN+FIVE)=CMSVI;/* #Y30LB27*/
         LH    @03,UCATLEN                                         1651
         ALR   @08,@03                                             1651
         MVC   S99TUPAR+1(4,@08),CMSVI                             1651
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+SIX:UCATLEN+NINE)=BLANKS(ONE:FOUR);
         LH    @08,UCATLEN                                         1652
         L     @03,TXTPTR+4                                        1652
         ALR   @03,@08                                             1652
         MVC   S99TUPAR+5(4,@03),BLANKS                            1652
*                                   /* RESET TEXT PARM       #Y30LB27*/
*   TXTPTR(ONE)=ADDR(MSVCKEY1);     /* POINT TO INVE PARM    #Y30LB27*/
         LA    @08,MSVCKEY1                                        1653
         ST    @08,TXTPTR                                          1653
*   S99RBPTR=ADDR(S99RB);           /* POINT TO SYN ALLOC REQUEST  1654
*                                      BLOCK                 #Y30LB27*/
         LA    @08,S99RB                                           1654
         ST    @08,S99RBPTR                                        1654
*   REG1=ADDR(S99RBPTR);            /* SET PARM REG          #Y30LB27*/
         LA    REG1,S99RBPTR                                       1655
*   S99RBPND=ON;                    /* END OF LIST           #Y30LB27*/
         OI    S99RBPND,B'10000000'                                1656
*   REG1=ADDR(S99RBPTR);            /* SET PARM REG          #Y30LB27*/
         LA    REG1,S99RBPTR                                       1657
*LSVC99B:                                                          1658
*   GEN(SVC 99);                    /* ISSUE DYNAMIC ALLOC SVC     1658
*                                                            #Y30LB27*/
LSVC99B  SVC 99
*   IF S99ERROR^=ZERO THEN                                         1659
         LH    @08,S99ERROR                                        1659
         N     @08,@CF03969                                        1659
         LTR   @08,@08                                             1659
         BZ    @RF01659                                            1659
*     DO;                           /* DYNAMIC ALLOC ERROR   #Y30LB27*/
*       VINMSGID=MSGDYDEI;          /* SET MSG INDEX         #Y30LB27*/
         MVC   VINMSGID(2),@CH03701                                1661
*       CNVRTWK1(ONE:TWO)=S99ERROR; /* ADD                   @Y30LB27
*                                                            #Y30LB27*/
         MVC   CNVRTWK1(2),S99ERROR                                1662
*       CALL VINCNVRT;              /* CODE                  #Y30LB27*/
         BAL   @14,VINCNVRT                                        1663
*       CALL VINWTO;                /* ISSUE ERROR MSG       #Y30LB27*/
         BAL   @14,VINWTO                                          1664
*     END;                          /*                       #Y30LB27*/
*   RETURN;                         /* RETURN TO CALLER      #Y30LB27*/
@EL00017 DS    0H                                                  1666
@EF00017 DS    0H                                                  1666
@ER00017 L     @14,@SA00017                                        1666
         BR    @14                                                 1666
*   END VINDALV2;                   /*                       #Y30LB27*/
         B     @EL00017                                            1667
*                                                                  1668
*/* ******************************************************************
**                                                           #Y30LB27
**    NAME = VINDALJ2: SEGMENT TO DE-ALLOCATE JOURNAL        @G24LB04
**                                                           #Y30LB27
**    INPUT = NONE                                           #Y30LB27
**                                                           #Y30LB27
**     PROCESS = VINDALJ2 IS A SUBSEGMENT OF SEGMENT VINDSDS. @Y30LB27
**                                                           #Y30LB27
**     OUTPUT = JOURANL IS DE-ALLOCATED FROM MSVC THE TASK   #Y30LB27
**                                                           #Y30LB27
******************************************************************** */
*                                                                  1668
*VINDALJ2:                                                         1668
*   PROC OPTIONS(SAVE(14));         /*                       #Y30LB27
*                                                            #Y30LB27*/
VINDALJ2 ST    @14,@SA00018                                        1668
*/*********************************************************************
* * RECONSTRUCT DYN ALLOC PARAMETER LIST                     #Y30LB27
* * AND ISSUE DYNAMIC DE-ALLOCATION FOR THE JOURNAL          #Y30LB27
* ********************************************************************/
*                                                                  1669
*   S99RB=S99RB&&S99RB;             /* CLEAR DYN ALLOC RB    #Y30LB27*/
         XC    S99RB(20),S99RB                                     1669
*   S99RBLN=TWENTY;                 /* SET LENGTH TO 20      #Y30LB27*/
         MVI   S99RBLN,X'14'                                       1670
*   S99VERB=S99VRBUN;               /* SET VERB CODE         #Y30LB27*/
         MVI   S99VERB,X'02'                                       1671
*   S99TXTPP=ADDR(TXTPTR(1));       /* INITIALIZE TEXT POINTER     1672
*                                                            #Y30LB27*/
         LA    @08,TXTPTR                                          1672
         ST    @08,S99TXTPP                                        1672
*   S99TUPLN(2)=ON;                 /* INDICATE END OF LIST  #Y30LB27*/
         OI    S99TUPLN+4(@08),B'10000000'                         1673
*   TXTPTR(ONE)=ADDR(JRNLKEY1);     /* SET DYN ALLOC TEXT PTR TO JRNL
*                                                            #Y30LB27*/
         LA    @08,JRNLKEY1                                        1674
         ST    @08,TXTPTR                                          1674
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+TWO:UCATLEN+FIVE)=CMSVC(ONE:FOUR);
         LH    @08,UCATLEN                                         1675
         L     @03,TXTPTR+4                                        1675
         ALR   @03,@08                                             1675
         MVC   S99TUPAR+1(4,@03),CMSVC                             1675
*                                   /*                       #Y30LB27*/
*   TXTPTR(TWO)->S99TUPAR(UCATLEN+SIX:UCATLEN+NINE)=CJRNL;/* #Y30LB27*/
         LH    @08,UCATLEN                                         1676
         L     @03,TXTPTR+4                                        1676
         ALR   @03,@08                                             1676
         MVC   S99TUPAR+5(4,@03),CJRNL                             1676
*   TXTPTR(TWO)->S99TULNG=UCATLEN+NINE;/* SET NAME AND NEW LEN     1677
*                                                            #Y30LB27*/
         L     @08,TXTPTR+4                                        1677
         LA    @03,9                                               1677
         AH    @03,UCATLEN                                         1677
         STCM  @03,3,S99TULNG(@08)                                 1677
*   S99TXTPP=ADDR(TXTPTR(1));       /* INITIALIZE TEXT POINTER     1678
*                                                            #Y30LB27*/
         LA    @08,TXTPTR                                          1678
         ST    @08,S99TXTPP                                        1678
*   S99RBPTR=ADDR(S99RB);           /* POINT TO SYN ALLOC REQUEST  1679
*                                      BLOCK                 #Y30LB27*/
         LA    @08,S99RB                                           1679
         ST    @08,S99RBPTR                                        1679
*   REG1=ADDR(S99RBPTR);            /* SET PARM REG          #Y30LB27*/
         LA    REG1,S99RBPTR                                       1680
*   S99RBPND=ON;                    /* END OF LIST           #Y30LB27*/
         OI    S99RBPND,B'10000000'                                1681
*LSVC99C:                                                          1682
*   GEN(SVC 99);                    /* ISSUE DYNAMIC ALLOC SVC     1682
*                                                            #Y30LB27*/
LSVC99C  SVC 99
*   IF S99ERROR^=ZERO THEN                                         1683
         LH    @08,S99ERROR                                        1683
         N     @08,@CF03969                                        1683
         LTR   @08,@08                                             1683
         BZ    @RF01683                                            1683
*     DO;                           /* DYNAMIC ALLOC ERROR   #Y30LB27*/
*       VINMSGID=MSGDYDEJ;          /* SET MSG INDEX         #Y30LB27*/
         MVC   VINMSGID(2),@CH03698                                1685
*       CNVRTWK1(ONE:TWO)=S99ERROR; /* ADD ERROR             #Y30LB27*/
         MVC   CNVRTWK1(2),S99ERROR                                1686
*       CALL VINCNVRT;              /* CODE TO THE MSG       #Y30LB27*/
         BAL   @14,VINCNVRT                                        1687
*       CALL VINWTO;                /* ISSUE THE RROR MSG    #Y30LB27*/
         BAL   @14,VINWTO                                          1688
*     END;                          /*                       #Y30LB27*/
*   RETURN;                         /* EXIT                  #Y30LB27*/
@EL00018 DS    0H                                                  1690
@EF00018 DS    0H                                                  1690
@ER00018 L     @14,@SA00018                                        1690
         BR    @14                                                 1690
*   END VINDALJ2;                   /*                       #Y30LB27*/
         B     @EL00018                                            1691
*                                                                  1692
*/* ****************************************************************
**                                                           @Y30LB27
**  VINWTO: SEGMENT TO PROCESS DISABLE, ENABLE, IPL FAILURE  @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**     VINWTO CODE, INDICATING REASON FOR FAILURE            @Y30LB27
**     MSVC RPL, INDICATING FUNCTION: DISABLE, ENABLE, IPL   @Y30LB27
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**     UPON ENTRY, THE FUNCTION BEING PERFORMED IS           @Y30LB27
**     DETERMINED FROM THE MSVC RPL AND A MESSAGE IS PRINTED @Y30LB27
**     TO THE OPERATOR.                                      @Y30LB27
**                                                           @Y30LB27
**     NEXT, THE VINWTO CODE IS USED TO SELECT A 'REASON FOR       1692
**     FAILURE' MESSAGE AND THAT IS PRINTED AT THE OPERATORS       1692
**     CONSOLE. IF IPL, A REQUEST FOR OPERATOR RESPONSE ON         1692
**     WHETHER TO CONTINUE MSS WITHOUT MSVC OR TERMINATE BOTH      1692
**     IS ALSO PRINTED.                                      @Y30LB27
**                                                           @Y30LB27
**     FOR BOTH IPL AND ENABLE, SEGMENT VINDSDS IS CALLED TO       1692
**     CLEAN-UP ALL OPENED AND ALLOCATED DATA SETS.  A RETURN CODE 1692
**     IS SET TO INDICATE THE OPERATOR'S RESPONSE, IF IPL, AND THE 1692
**     SEGMENT IS EXITED.                                    @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**     TERM CODE IS SET TO INDICATE:                         @Y30LB27
**            TERMINATE MSVC, KEEP MSS ACTIVE               @Y30LB27
**            TERMINATE MSVC AND MSS                        @Y30LB27
**     MESSAGES ARE WRITTEN TO THE OPERATOR                   @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  1692
*VINWTO:                                                           1692
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINWTO   ST    @14,@SA00019                                        1692
*/*********************************************************************
* * SET MESSAGE ID - POINT TO MSG RPL AND CALL MESSAGE MODULE@Y30LB27
* ********************************************************************/
*                                                                  1693
*   MSGID=VINMSGTB(VINMSGID);       /* SET ACTUAL MSGID      @Y30LB27*/
         LH    @08,VINMSGID                                        1693
         ALR   @08,@08                                             1693
         LH    @08,VINMSGTB-2(@08)                                 1693
         ST    @08,MSGID                                           1693
*   REG1=ADDR(MSGRQ);               /* POINT TO MSG REQUEST  @Y30LB27*/
         LA    REG1,MSGRQ                                          1694
*   CALL ICBVOP00;                  /* ISSUE MSG VIA ICBVOP00      1695
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         L     @15,@CV03334                                        1695
         BALR  @14,@15                                             1695
*/*********************************************************************
* * IF IT IS A TERMINATING MESSAGE AND ITS IPL CHECK TO SEE  @Y30LB27
* * MSVC DISABLES OR TERMINATES MSS                          @Y30LB27
* ********************************************************************/
*                                                                  1696
*   IF RPLVRETC^=ZERO&DISSW=OFF THEN                               1696
         LH    @08,RPLVRETC(,RPLVPTR)                              1696
         N     @08,@CF03969                                        1696
         LTR   @08,@08                                             1696
         BZ    @RF01696                                            1696
         TM    DISSW,B'00000001'                                   1696
         BNZ   @RF01696                                            1696
*     DO;                           /*                       @Y30LB27*/
*       IF ININIT=ON THEN                                          1698
         L     @03,INITPTR                                         1698
         TM    ININIT(@03),B'10000000'                             1698
         BNO   @RF01698                                            1698
*         DO;                       /* NO - IPL              @Y30LB27*/
*/*********************************************************************
* * LOOP UNTIL A VALID RESPONSE IS RECEIVED                  @Y30LB27
* ********************************************************************/
*                                                                  1700
*           RETRYSW=ON;             /* IF IPL ASK FOR DISABLE OR   1700
*                                      TERMINATE IPL         #Y30LB27*/
         OI    RETRYSW,B'10000000'                                 1700
*           SAVRETC=RPLVRETC;       /* SAVE RETURN CODE      @Y30LB27*/
         STH   @08,SAVRETC                                         1701
*           DO WHILE(RETRYSW=ON);   /* LOOP UNTIL VALID RESPONSE   1702
*                                                            @Y30LB27*/
         B     @DE01702                                            1702
@DL01702 DS    0H                                                  1703
*             MSGRQ=''B;            /* CLEAR MESSAGE REQ     @Y30LB27*/
         XC    MSGRQ(32),MSGRQ                                     1703
*             MSGRPLV=RPLVPTR;      /* RESET RPLV PTR        @Y30LB27*/
         ST    RPLVPTR,MSGRPLV                                     1704
*             MSGID=VINMSGTB(MSGTRME);/* ISSUE ICB419D       @Y30LB27*/
         LH    @08,VINMSGTB+44                                     1705
         ST    @08,MSGID                                           1705
*             MSGRLEN=LENGTH(REPLY);/* SET REPLY AREA ADDR   @Y30LB27*/
         MVI   MSGRLEN,X'48'                                       1706
*             MSGREPLY=ADDR(REPLY); /* AND LENGTH            @Y30LB27*/
         LA    @08,REPLY                                           1707
         STCM  @08,7,MSGREPLY                                      1707
*             REG1=ADDR(MSGRQ);     /* POINT TO REQUEST      @Y30LB27*/
         LA    REG1,MSGRQ                                          1708
*             CALL ICBVOP00;        /* ISSUE REQUEST         @Y30LB27*/
         L     @15,@CV03334                                        1709
         BALR  @14,@15                                             1709
*             MSGRQ=''B;            /* CLEAR MESSAGE REQ     @ZM31138*/
         XC    MSGRQ(32),MSGRQ                                     1710
*             MSGRPLV=RPLVPTR;      /* RESET RPLV PTR        @ZM31138*/
         ST    RPLVPTR,MSGRPLV                                     1711
*/*********************************************************************
* * FOLD RESPONSE TO UPPERCASE                               @Y30LB27
* ********************************************************************/
*                                                                  1712
*             REPLY(ONE:TWO)=REPLY(ONE:TWO)×BLANKS(ONE:TWO);/* FOLD
*                                      TO UPPER CASE         @Y30LB27*/
         OC    REPLY(2),BLANKS                                     1712
*             IF REPLY(ONE:TWO)=CY THEN/* REPLY Y            @Y30LB27*/
         CLC   REPLY(2),@CC03670                                   1713
         BNE   @RF01713                                            1713
*               RETRYSW=OFF;        /* VALID RESPONSE - DISAB@Y30LB27*/
         NI    RETRYSW,B'01111111'                                 1714
*             ELSE                  /* IS IT N               @Y30LB27*/
*               IF REPLY(ONE:TWO)=CN THEN                          1715
         B     @RC01713                                            1715
@RF01713 CLC   REPLY(2),@CC03672                                   1715
         BNE   @RF01715                                            1715
*                 DO;               /* ITS N                 @Y30LB27*/
*                   RETRYSW=OFF;    /* VALID RESPONSE - TERM @Y30LB27*/
         NI    RETRYSW,B'01111111'                                 1717
*                   ICBV=OFF;       /* TELL MSSC TO TERMINATE      1718
*                                                            @Y30LB27*/
         L     @08,CVTPTR                                          1718
         L     @08,CVTEXT2(,@08)                                   1718
         L     @08,CVTICB(,@08)                                    1718
         NI    ICBV(@08),B'11011111'                               1718
*                 END;              /*                       @Y30LB27*/
*               ELSE                /* INVALID RESPONSE      @Y30LB27*/
*                 DO;               /* ISSUE                 @Y30LB27*/
         B     @RC01715                                            1720
@RF01715 DS    0H                                                  1721
*                   REG1=ADDR(MSGRQ);/* POINT TO REQUEST     @ZM31138*/
         LA    REG1,MSGRQ                                          1721
*                   MSGID=VINMSGTB(MSGSPEE);/* ICB423D AND RE-ISSUE
*                                                            #Y30LB27*/
         LH    @08,VINMSGTB+46                                     1722
         ST    @08,MSGID                                           1722
*                   CALL ICBVOP00;  /* ICB419D               #Y30LB27*/
         L     @15,@CV03334                                        1723
         BALR  @14,@15                                             1723
*                   MSGRQ=''B;      /* CLEAR MESSAGE REQ     @ZM31138*/
         XC    MSGRQ(32),MSGRQ                                     1724
*                   MSGRPLV=RPLVPTR;/* RESET RPLV PTR        @ZM31138*/
         ST    RPLVPTR,MSGRPLV                                     1725
*                 END;              /*                       #Y30LB27*/
*           END;                    /*                       #Y30LB27
*                                                            @Y30LB27*/
@RC01715 DS    0H                                                  1727
@RC01713 DS    0H                                                  1727
@DE01702 TM    RETRYSW,B'10000000'                                 1727
         BO    @DL01702                                            1727
*/*********************************************************************
* * IF MSVC IS TO DISABLE CLOSE AND DE-ALLOCATE THE DATA     @Y30LB27
* * SETS INDICATE MSVC DISABLED                              @Y30LB27
* ********************************************************************/
*                                                                  1728
*           IF VVIACBAD^=ZERO&ACBOPEN=ON THEN/* OPEN ACB     @Y30LB27*/
         L     @08,VVIACBAD(,VVIPTR)                               1728
         LTR   @08,@08                                             1728
         BZ    @RF01728                                            1728
         TM    ACBOPEN(@08),B'00010000'                            1728
         BNO   @RF01728                                            1728
*             DO;                   /* YES                   @Y30LB27*/
*               DO WHILE(CPUIDPTR=ZERO);/* RECORD BUFFER OBTAINED  1730
*                                                            @Y30LB27*/
         B     @DE01730                                            1730
@DL01730 DS    0H                                                  1731
*                 REG0=MAXREC;      /* GET LENGTH OF         @Y30LB27
*                                      MAXIMUM RECORD        @G24LB04*/
         LA    REG0,1024                                           1731
*LGETM7:                                                           1732
*                 GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR 1732
*                                      ACB                   @Y30LB27*/
LGETM7   GETMAIN RC,LV=(0),SP=241
*                 IF REG15^=ZERO THEN                              1733
         LTR   REG15,REG15                                         1733
         BZ    @RF01733                                            1733
*                   DO;             /* STORAGE OBTAIN        @Y30LB27*/
*                     REG1=ADDR(MSGRQ);/* POINT TO REQUEST   @ZM31138*/
         LA    REG1,MSGRQ                                          1735
*                     MSGID=VINMSGTB(MSGSTGE);/* SET MSG ID  #Y30LB27*/
         LH    @08,VINMSGTB+10                                     1736
         ST    @08,MSGID                                           1736
*                     CALL ICBVOP00;/* PRINT ERROR MESSAGE   #Y30LB27*/
         L     @15,@CV03334                                        1737
         BALR  @14,@15                                             1737
*                     MSGRQ=''B;    /* CLEAR MESSAGE REQ     @ZM31138*/
         XC    MSGRQ(32),MSGRQ                                     1738
*                     MSGRPLV=RPLVPTR;/* RESET RPLV PTR      @ZM31138*/
         ST    RPLVPTR,MSGRPLV                                     1739
*                     RETURN;       /* RETURN TO CALLER      #Y30LB27*/
@EL00019 DS    0H                                                  1740
@EF00019 DS    0H                                                  1740
@ER00019 L     @14,@SA00019                                        1740
         BR    @14                                                 1740
*                   END;            /*                       #Y30LB27*/
*                 CPUIDPTR=REG1;    /* SET PTR FOR RECORD BUFFER   1742
*                                                            #Y30LB27*/
@RF01733 ST    REG1,CPUIDPTR                                       1742
*               END;                /*                       #Y30LB27*/
@DE01730 L     @08,CPUIDPTR                                        1743
         LTR   @08,@08                                             1743
         BZ    @DL01730                                            1743
*               RPLVTYP=RPLVREAD;   /* INDICATE READ         #Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1744
*               RPLVUPD=ON;         /* FOR UPDATE            #Y30LB27*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1745
*               RPLVBUF=CPUIDPTR;   /* SET BUFFER ADDRESS    #Y30LB27*/
         ST    @08,RPLVBUF(,RPLVPTR)                               1746
*               RPLVKEY=CPUIDPTR;   /* SET KEY ADDRESS       #Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               1747
*               RPLVRLN=LENGTH(CPUID);/* SET KEY ADDRESS     #Y30LB27*/
         LA    @03,151                                             1748
         ST    @03,RPLVRLN(,RPLVPTR)                               1748
*               RPLVBLN=LENGTH(CPUID);/* SET KEY ADDRESS     #Y30LB27*/
         ST    @03,RPLVBLN(,RPLVPTR)                               1749
*               CPUNAME=CCPUIDK;    /* SET KWY ADDR          #Y30LB27*/
         MVC   CPUNAME(13,@08),CCPUIDK                             1750
*               REG1=RPLVPTR;       /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        1751
*               CALL ICBVIO00;      /* GET CPUID REC         #Y30LB27*/
         L     @15,@CV03332                                        1752
         BALR  @14,@15                                             1752
*               IF RPLVRETC^=ZERO THEN                             1753
         LH    @08,RPLVRETC(,RPLVPTR)                              1753
         N     @08,@CF03969                                        1753
         LTR   @08,@08                                             1753
         BZ    @RF01753                                            1753
*                 DO;               /* VSAM I/O ERROR        #Y30LB27*/
*                   MSGLEN1=TWELVE; /* LEN OF MSG CONST      @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1755
*                   MSGTEXT1=RPLVKEY;/* LOCATION OF NON-GRP  @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1756
*                   CNVRTWK1=RPLRCODE;/* SET REASON CODE     @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1757
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1757
*                   CALL VINCNVRT;  /* TO MSG                @Y30LB27*/
         BAL   @14,VINCNVRT                                        1758
*                   MSGID=VINMSGTB(MSGVSME);/* SET MSG ID    @Y30LB27*/
         LH    @08,VINMSGTB+26                                     1759
         ST    @08,MSGID                                           1759
*                   REG1=ADDR(MSGRQ);/* POINT TO REQUEST     @ZM31138*/
         LA    REG1,MSGRQ                                          1760
*                   CALL ICBVOP00;  /* PRINT ERROR MESSAGE   @Y30LB27*/
         L     @15,@CV03334                                        1761
         BALR  @14,@15                                             1761
*                   MSGRQ=''B;      /* CLEAR MESSAGE REQ     @ZM31138*/
         XC    MSGRQ(32),MSGRQ                                     1762
*                   MSGRPLV=RPLVPTR;/* RESET RPLV PTR        @ZM31138*/
         ST    RPLVPTR,MSGRPLV                                     1763
*                 END;              /*                       @Y30LB27*/
*               IF RPLVRETC=ZERO THEN                              1765
@RF01753 LH    @08,RPLVRETC(,RPLVPTR)                              1765
         N     @08,@CF03969                                        1765
         LTR   @08,@08                                             1765
         BNZ   @RF01765                                            1765
*                 DO;               /* VSAM I/O ERROR        @Y30LB27*/
*                   CPUPURGE=CPUPURGE×VVICPUID;/* OR PURGE REQUIRED
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         L     @08,CPUIDPTR                                        1767
         OC    CPUPURGE(2,@08),VVICPUID(VVIPTR)                    1767
*/*********************************************************************
* * MODIFY RPL AND PUT THE UPDATED CPU ASSOC RECORD          @Y30LB27
* ********************************************************************/
*                                                                  1768
*                   RPLVTYP=RPLVPUT;/* INDICATE READ         @Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1768
*                   REG1=RPLVPTR;   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1769
*                   CALL ICBVIO00;  /* WRITE THE RECORD      @Y30LB27*/
         L     @15,@CV03332                                        1770
         BALR  @14,@15                                             1770
*                   IF RPLVRETC^=ZERO THEN                         1771
         LH    @08,RPLVRETC(,RPLVPTR)                              1771
         N     @08,@CF03969                                        1771
         LTR   @08,@08                                             1771
         BZ    @RF01771                                            1771
*                     DO;           /* VSAM I/O ERROR        @Y30LB27*/
*                       MSGLEN1=TWELVE;/* LEN OF MSG CONST   @Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       1773
*                       MSGTEXT1=RPLVKEY;/* SET KEY ADDR     @YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      1774
*                       CNVRTWK1=RPLRCODE;/* SET REASON CODE @Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    1775
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1775
*                       CALL VINCNVRT;/* AND ADD TO MSG      @Y30LB27*/
         BAL   @14,VINCNVRT                                        1776
*                       MSGID=VINMSGTB(MSGVSME);/* SET MSG ID      1777
*                                                            @YM04327*/
         LH    @08,VINMSGTB+26                                     1777
         ST    @08,MSGID                                           1777
*                       REG1=ADDR(MSGRQ);/* POINT TO REQUEST @ZM31138*/
         LA    REG1,MSGRQ                                          1778
*                       CALL ICBVOP00;/* PRINT ERROR MESSAGE @YM04327*/
         L     @15,@CV03334                                        1779
         BALR  @14,@15                                             1779
*                       MSGRQ=''B;  /* CLEAR MESSAGE REQ     @YM04327*/
         XC    MSGRQ(32),MSGRQ                                     1780
*                       MSGRPLV=RPLVPTR;/* RESET RPLV PTR    @YM04327*/
         ST    RPLVPTR,MSGRPLV                                     1781
*                     END;          /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * ISSUE ENDREC FOR DATA SET                                @Y30LB27
* ********************************************************************/
*                                                                  1783
*                   RPLVTYP=RPLVENDR;/* INDICATE ENDREC      @Y30LB27*/
@RF01771 MVI   RPLVTYP(RPLVPTR),X'04'                              1783
*                   REG1=RPLVPTR;   /* SET REG1 TO MSVC RPLV @Y30LB27*/
         LR    REG1,RPLVPTR                                        1784
*                   CALL ICBVIO00;  /* CALL ICBVIN00 FOR ENDREC    1785
*                                                            @Y30LB27*/
         L     @15,@CV03332                                        1785
         BALR  @14,@15                                             1785
*                 END;              /*                       @Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * DEQ - RELEASE THE DATA SET - INVENTORY                   @Y30LB27
* ********************************************************************/
*                                                                  1787
*               CALL INVDEQ;        /* RESERVE INVENTORY     @ZA05115*/
@RF01765 BAL   @14,INVDEQ                                          1787
*             END;                  /*                       @Y30LB27*/
*           RPLVRETC=SAVRETC;       /* RESTORE RTNCODE       @Y30LB27*/
@RF01728 LH    @08,SAVRETC                                         1789
         STH   @08,RPLVRETC(,RPLVPTR)                              1789
*           CALL VINDSDS;           /* CLOSE AND DE-ALLOC THE DATA 1790
*                                      SETS                  @Y30LB27*/
         BAL   @14,VINDSDS                                         1790
*           VVIFLG0=ON;             /* MSVC IS DISABLED      @Y30LB27*/
*           VVIFLG2=ON;             /* JOURNAL IS DISABLED   @Y30LB27*/
         OI    VVIFLG0(VVIPTR),B'10100000'                         1792
*         END;                      /*                       @Y30LB27*/
*       IF INIENABL=ON THEN         /* ENABLE CALL           @YM04327*/
@RF01698 L     @08,INITPTR                                         1794
         TM    INIENABL(@08),B'01000000'                           1794
         BNO   @RF01794                                            1794
*         CALL VINDSDS;             /* YES CLEAN UP          @YM04327*/
         BAL   @14,VINDSDS                                         1795
*     END;                          /*                       @Y30LB27*/
@RF01794 DS    0H                                                  1797
*   MSGRQ=''B;                      /* CLEAR MESSAGE REQ     @Y30LB27*/
@RF01696 XC    MSGRQ(32),MSGRQ                                     1797
*   MSGRPLV=RPLVPTR;                /* RESET RPLV PTR        @Y30LB27*/
         ST    RPLVPTR,MSGRPLV                                     1798
*   RETURN;                         /* RETURN TO CALLER      @Y30LB27*/
         B     @EL00019                                            1799
*   END VINWTO;                     /*                       @Y30LB27*/
*                                                                  1801
*/* ******************************************************************
**                                                           @Y30LB27
**    NAME = VINCNVRT: SEGMENT TO CONVERT RETURN CODE TO     @Y30LB27
**    EBCDIC FOR PRINTING                                    @Y30LB27
**                                                           @Y30LB27
**    INPUT = CNVRTWK1 - CONVERT WORK AREA CONTAINING REASON @Y30LB27
**    CODE CONVERTED.                                        @Y30LB27
**                                                           @Y30LB27
**     PROCESS = UNPACK CNVRTWK1 INTO CNVRTWK2. TAKES HEX 0-F@Y30LB27
**     AND CONVERTS IT TO XEX F0-FF. THEN TRANS THIS TO      @Y30LB27
**     EBCDIC. SET MSGLEN2 = FOUR AND MSGTEXT2 = ADDRESS     @Y30LB27
**     CONVRTWK2.                                            @Y30LB27
**                                                           @Y30LB27
**     OUTPUT = REASON CODE CONVERTED AND READY FOR PRINTING.@Y30LB27
**                                                           @Y30LB27
******************************************************************** */
*                                                                  1801
*VINCNVRT:                                                         1801
*   PROC OPTIONS(NOSAVE);           /*                       @Y30LB27*/
VINCNVRT DS    0H                                                  1802
*   CNVRTWK1(THREE)=MASK0F;         /* DUMMY SIGN FOR CONVERSION   1802
*                                                            @Y30LB27*/
         MVC   CNVRTWK1+2(1),MASK0F                                1802
*   UNPK(CNVRTWK2,CNVRTWK1);        /* UNPACK IT             @Y30LB27*/
         UNPK  CNVRTWK2(5),CNVRTWK1(3)                             1803
*   TR(CNVRTWK2,TRTAB(1));          /* TRANSLATE IT          @Y30LB27*/
         TR    CNVRTWK2(5),TRTAB                                   1804
*   IF VINMSGID=MSGALCE×VINMSGID=MSGVSME×VINMSGID=MSGLOCE THEN     1805
         LH    @08,VINMSGID                                        1805
         C     @08,@CF00310                                        1805
         BE    @RT01805                                            1805
         C     @08,@CF00172                                        1805
         BE    @RT01805                                            1805
         C     @08,@CF02345                                        1805
         BNE   @RF01805                                            1805
@RT01805 DS    0H                                                  1806
*     DO;                           /*                       @Y30LB27*/
*       MSGLEN2=FOUR;               /* SET THE LENGTH        @Y30LB27*/
         MVI   MSGLEN2,X'04'                                       1807
*       MSGTEXT2=ADDR(CNVRTWK2);    /* POINT TO CONVERT VALUE      1808
*                                                            @Y30LB27*/
         LA    @08,CNVRTWK2                                        1808
         STCM  @08,7,MSGTEXT2                                      1808
*     END;                          /*                       @Y30LB27*/
*   ELSE                            /*                       @Y30LB27*/
*     DO;                           /*                       @Y30LB27*/
         B     @RC01805                                            1810
@RF01805 DS    0H                                                  1811
*       MSGLEN1=FOUR;               /* SET THE LENGTH        @Y30LB27*/
         MVI   MSGLEN1,X'04'                                       1811
*       MSGTEXT1=ADDR(CNVRTWK2);    /* POINT TO CONVERT VALUE      1812
*                                                            @Y30LB27*/
         LA    @08,CNVRTWK2                                        1812
         STCM  @08,7,MSGTEXT1                                      1812
*     END;                          /*                       @Y30LB27*/
*   RETURN;                         /* RETURN TO CALLER      @Y30LB27*/
@EL00020 DS    0H                                                  1814
@EF00020 DS    0H                                                  1814
@ER00020 BR    @14                                                 1814
*   END VINCNVRT;                   /*                       @Y30LB27*/
         B     @EL00020                                            1815
*                                                                  1816
*/*******************************************************    @ZA05115
**                                                           @ZA05115
**   NAME = JRNLRES                                          @ZA05115
**                                                           @ZA05115
**   INPUT = NONE                                            @ZA05115
**                                                           @ZA05115
**   PROCESS = RESERVE THE JOURNAL DATA SET                  @ZA05115
**             'USERCAT.MSVCJRNL' IF IT IS NOT ALREADY       @ZA05115
**             RESERVED                                      @ZA05115
**                                                           @ZA05115
**   OUTPUT = THE JOURNAL DATA SET IS RESERVED               @ZA05115
**                                                           @ZA05115
*********************************************************    @ZA05115*/
*                                                                  1816
*JRNLRES:                           /*                       @ZA05115*/
*   PROC OPTIONS(SAVE(14));         /*                       @ZA05115*/
JRNLRES  ST    @14,@SA00021                                        1816
*   IF VVIFLG5=ON THEN              /* IS JRNL RESERVED      @ZA05115*/
         TM    VVIFLG5(VVIPTR),B'00000100'                         1817
         BNO   @RF01817                                            1817
*     DO;                           /* YES                   @ZA05115*/
*       SRCODE=RPLRCODE;            /* SAVE REASON CODE      @ZA05115*/
         LH    @03,RPLRCODE(,RPLVPTR)                              1819
         N     @03,@CF03969                                        1819
         STH   @03,SRCODE                                          1819
*       SVRETC=RPLVRETC;            /* SAVE RETURN CODE      @ZA05115*/
         LH    SVRETC,RPLVRETC(,RPLVPTR)                           1820
         N     SVRETC,@CF03969                                     1820
*       MSGID=JRES;                 /* SET MSG ID            @ZA05115*/
         MVC   MSGID(4),@CF03366                                   1821
*       REG1=ADDR(MSGRQ);           /* POINT TO MSG AREA     @ZA05115*/
         LA    REG1,MSGRQ                                          1822
*       CALL ICBVOP00;              /* WRITE MSG             @ZA05115*/
         L     @15,@CV03334                                        1823
         BALR  @14,@15                                             1823
*       RPLRCODE=SRCODE;            /* RESTORE REASON CODE   @ZA05115*/
         LH    @03,SRCODE                                          1824
         STH   @03,RPLRCODE(,RPLVPTR)                              1824
*       RPLVRETC=SVRETC;            /* RESTORE RETURN CODE   @ZA05115*/
         STH   SVRETC,RPLVRETC(,RPLVPTR)                           1825
*       RETURN;                     /* RETURN TO CALLER      @ZA05115*/
@EL00021 DS    0H                                                  1826
@EF00021 DS    0H                                                  1826
@ER00021 L     @14,@SA00021                                        1826
         BR    @14                                                 1826
*     END;                          /*                       @ZA05115*/
*   REG1=ADDR(RSVJNLLT);            /* POINT TO RES LIST     @ZA05115*/
@RF01817 LA    REG1,RSVJNLLT                                       1828
*   VVIFLG5=ON;                     /* INDICATE RESERVED     @ZA05115*/
         OI    VVIFLG5(VVIPTR),B'00000100'                         1829
*   GEN(RESERVE MF=(E,(1)));        /* ISSUE RESERVE         @ZA05115*/
         RESERVE MF=(E,(1))
*   END JRNLRES;                    /*                       @ZA05115*/
         B     @EL00021                                            1831
*                                                                  1832
*/*******************************************************    @ZA05115
**                                                           @ZA05115
**   NAME=JRNLDEQ                                            @G24LB04
**                                                           @ZA05115
**   INPUT = NONE                                            @ZA05115
**                                                           @G24LB04
**   PROCESS = DEQUEUE THE JOURNAL DATA SET 'USERCAT.MSVJRNL'@ZA05115
**             IF IT WAS RESERVED                            @ZA05115
**                                                           @ZA05115
**   OUTPUT = THE JOURNAL DATA SET IS DEQUEUED               @ZA05115
**                                                           @ZA05115
*********************************************************    @ZA05115*/
*                                                                  1832
*JRNLDEQ:                           /*                       @ZA05115*/
*   PROC OPTIONS(SAVE(14));         /*                       @ZA05115*/
JRNLDEQ  ST    @14,@SA00022                                        1832
*   IF VVIFLG5=ON THEN              /* JRNL RESERVED         @ZA05115*/
         TM    VVIFLG5(VVIPTR),B'00000100'                         1833
         BNO   @RF01833                                            1833
*     DO;                           /* YES                   @ZA05115*/
*       REG1=ADDR(RSVJNLLT);        /* POINT TO RES LIST     @ZA05115*/
         LA    REG1,RSVJNLLT                                       1835
*       GEN(DEQ MF=(E,(1)));        /* ISSUE DEQUEUE         @ZA05115*/
         DEQ MF=(E,(1))
*       VVIFLG5=OFF;                /* INDICATE DEQUEUED     @ZA05115*/
         NI    VVIFLG5(VVIPTR),B'11111011'                         1837
*       RETURN;                     /* RETURN TO CALLER      @ZA05115*/
@EL00022 DS    0H                                                  1838
@EF00022 DS    0H                                                  1838
@ER00022 L     @14,@SA00022                                        1838
         BR    @14                                                 1838
*     END;                          /*                       @ZA05115*/
*   SRCODE=RPLRCODE;                /* SAVE REASON CODE      @ZA05115*/
@RF01833 LH    @03,RPLRCODE(,RPLVPTR)                              1840
         N     @03,@CF03969                                        1840
         STH   @03,SRCODE                                          1840
*   SVRETC=RPLVRETC;                /* SAVE RETURN CODE      @ZA05115*/
         LH    SVRETC,RPLVRETC(,RPLVPTR)                           1841
         N     SVRETC,@CF03969                                     1841
*   MSGID=JDEQ;                     /* SET MSG ID            @ZA05115*/
         MVC   MSGID(4),@CF03370                                   1842
*   REG1=ADDR(MSGRQ);               /* POINT TO MSG AREA     @ZA05115*/
         LA    REG1,MSGRQ                                          1843
*   CALL ICBVOP00;                  /* WRITE MSG             @ZA05115*/
         L     @15,@CV03334                                        1844
         BALR  @14,@15                                             1844
*   RPLRCODE=SRCODE;                /* RESTORE REASON CODE   @ZA05115*/
         LH    @03,SRCODE                                          1845
         STH   @03,RPLRCODE(,RPLVPTR)                              1845
*   RPLVRETC=SVRETC;                /* RESTORE RETURN CODE   @ZA05115*/
         STH   SVRETC,RPLVRETC(,RPLVPTR)                           1846
*   END JRNLDEQ;                    /*                       @ZA05115*/
         B     @EL00022                                            1847
*                                                                  1848
*/********************************************************   @ZA05115
**                                                           @ZA05115
**   NAME = INVRES                                           @ZA05115
**                                                           @ZA05115
**   INPUT = NONE                                            @ZA05115
**                                                           @ZA05115
**   PROCESS = RESERVE THE INVENTORY DATA SET 'USERCAT.MSVI' @ZA05115
**             IF IT IS NOT ALREADY RESERVED                 @ZA05115
**                                                           @ZA05115
**   OUTPUT = THE INVENTORY DATA SET IS RESERVED             @ZA05115
**                                                           @ZA05115
**********************************************************   @ZA05115*/
*                                                                  1848
*INVRES:                            /*                       @ZA05115*/
*   PROC OPTIONS(SAVE(14));         /*                       @ZA05115*/
INVRES   ST    @14,@SA00023                                        1848
*   IF VVIFLG4=ON THEN              /* IS INV ALREADY RESERVED     1849
*                                                            @ZA05115*/
         TM    VVIFLG4(VVIPTR),B'00001000'                         1849
         BNO   @RF01849                                            1849
*     DO;                           /* YES                   @ZA05115*/
*       SRCODE=RPLRCODE;            /* SAVE REASON CODE      @ZA05115*/
         LH    @03,RPLRCODE(,RPLVPTR)                              1851
         N     @03,@CF03969                                        1851
         STH   @03,SRCODE                                          1851
*       SVRETC=RPLVRETC;            /* SAVE RETURN CODE      @ZA05115*/
         LH    SVRETC,RPLVRETC(,RPLVPTR)                           1852
         N     SVRETC,@CF03969                                     1852
*       MSGID=IRES;                 /* SET MSG ID            @ZA05115*/
         MVC   MSGID(4),@CF03364                                   1853
*       REG1=ADDR(MSGRQ);           /* POINT TO MSG AREA     @ZA05115*/
         LA    REG1,MSGRQ                                          1854
*       CALL ICBVOP00;              /* WRITE THE MESSAGE     @ZA05115*/
         L     @15,@CV03334                                        1855
         BALR  @14,@15                                             1855
*       RPLRCODE=SRCODE;            /* RESTORE REASON CODE   @ZA05115*/
         LH    @03,SRCODE                                          1856
         STH   @03,RPLRCODE(,RPLVPTR)                              1856
*       RPLVRETC=SVRETC;            /* RESTORE RETURN CODE   @ZA05115*/
         STH   SVRETC,RPLVRETC(,RPLVPTR)                           1857
*       RETURN;                     /* RETURN TO CALLER      @ZA05115*/
@EL00023 DS    0H                                                  1858
@EF00023 DS    0H                                                  1858
@ER00023 L     @14,@SA00023                                        1858
         BR    @14                                                 1858
*     END;                          /*                       @ZA05115*/
*   REG1=ADDR(RSVINVLT);            /* POINT TO RES LIST     @ZA05115*/
@RF01849 LA    REG1,RSVINVLT                                       1860
*   VVIFLG4=ON;                     /* INDICATE RESERVED     @ZA05115*/
         OI    VVIFLG4(VVIPTR),B'00001000'                         1861
*   GEN(RESERVE MF=(E,(1)));        /* ISSUE RESERVE         @ZA05115*/
         RESERVE MF=(E,(1))
*   END INVRES;                     /*                       @ZA05115*/
         B     @EL00023                                            1863
*                                                                  1864
*/***********************************************************@ZA05115
**                                                           @ZA05115
**   NAME = INVDEQ                                           @ZA05115
**                                                           @ZA05115
**   INPUT = NONE                                            @ZA05115
**                                                           @ZA05115
**   PROCESS DEQUEUE THE INVENTORY DATA SET 'USERCAT.MSVI'   @ZA05115
**                                                           @ZA05115
**   OUTPUT = THE INVENTORY DATA SET IS DEQUEUED             @ZA05115
**                                                           @ZA05115
*************************************************************@ZA05115*/
*                                                                  1864
*INVDEQ:                            /* DEQUEUE INVENTORY     @ZA05115*/
*   PROC OPTIONS(SAVE(14));         /* PROCEDURE             @ZA05115*/
INVDEQ   ST    @14,@SA00024                                        1864
*   IF VVIFLG4=ON THEN              /* IS INV RESERVED       @ZA05115*/
         TM    VVIFLG4(VVIPTR),B'00001000'                         1865
         BNO   @RF01865                                            1865
*     DO;                           /* YES                   @ZA05115*/
*       REG1=ADDR(RSVINVLT);        /* POINT TO RES LIST     @ZA05115*/
         LA    REG1,RSVINVLT                                       1867
*       GEN(DEQ MF=(E,(1)));        /* ISSUE DEQUEUE         @ZA05115*/
         DEQ MF=(E,(1))
*       VVIFLG4=OFF;                /* INDICATE DEQUEUED     @ZA05115*/
         NI    VVIFLG4(VVIPTR),B'11110111'                         1869
*       RETURN;                     /* RET TO CALLER         @ZA05115*/
@EL00024 DS    0H                                                  1870
@EF00024 DS    0H                                                  1870
@ER00024 L     @14,@SA00024                                        1870
         BR    @14                                                 1870
*     END;                          /*                       @ZA05115*/
*   SRCODE=RPLRCODE;                /* SAVE REASON CODE      @ZA05115*/
@RF01865 LH    @03,RPLRCODE(,RPLVPTR)                              1872
         N     @03,@CF03969                                        1872
         STH   @03,SRCODE                                          1872
*   SVRETC=RPLVRETC;                /* SAVE RETURN CODE      @ZA05115*/
         LH    SVRETC,RPLVRETC(,RPLVPTR)                           1873
         N     SVRETC,@CF03969                                     1873
*   MSGID=IDEQ;                     /* SET MESSAGE ID        @ZA05115*/
         MVC   MSGID(4),@CF03368                                   1874
*   REG1=ADDR(MSGRQ);               /* POINT TO MSG AREA     @ZA05115*/
         LA    REG1,MSGRQ                                          1875
*   CALL ICBVOP00;                  /* WRITE MSG             @ZA05115*/
         L     @15,@CV03334                                        1876
         BALR  @14,@15                                             1876
*   RPLRCODE=SRCODE;                /* RESTORE REASON CODE   @ZA05115*/
         LH    @03,SRCODE                                          1877
         STH   @03,RPLRCODE(,RPLVPTR)                              1877
*   RPLVRETC=SVRETC;                /* RESTORE RETURN CODE   @ZA05115*/
         STH   SVRETC,RPLVRETC(,RPLVPTR)                           1878
*   END INVDEQ;                     /*                       @ZA05115*/
         B     @EL00024                                            1879
*                                                                  1880
*/* ******************************************************************
**                                                           @Y30LB27
**    NAME = VINTERM: TERMINATION SEGMENT                    @Y30LB27
**                                                           @Y30LB27
**    INPUT = MSVC CONTROL BLOCK STRUCTURE                   @Y30LB27
**                                                           @Y30LB27
**     PROCESS = DURING ENABLE/DISABLE PROCESSING ONLY       @Y30LB27
**     REASON AND RETURN CODES. DURING IPL IF ICBV = ON THE  @Y30LB27
**        CONTROL BLOCK STRUCTURE IS FREED.                  @Y30LB27
**                                                           @Y30LB27
**     OUTPUT = CONTROL BLOCK STRUCTURE IS FREED             @Y30LB27
**                                                           @Y30LB27
******************************************************************** */
*                                                                  1880
*VINTERM:                                                          1880
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @Y30LB27*/
VINTERM  ST    @14,@SA00025                                        1880
*/*********************************************************************
* * FREE THE RECORD BUFFER                                   @ZM30746
* ********************************************************************/
*                                                                  1881
*   IF CPUIDPTR^=ZERO THEN          /*                       @ZM30746*/
         L     @08,CPUIDPTR                                        1881
         LTR   @08,@08                                             1881
         BZ    @RF01881                                            1881
*     DO;                           /*                       @ZM30746*/
*       REG0=MAXREC;                /* SET RECORD BUFFER PTR @ZM30746*/
         LA    REG0,1024                                           1883
*       REG1=CPUIDPTR;              /* SET RECORD BUFFER PTR @ZM30746*/
         LR    REG1,@08                                            1884
*LFREEM2:                                                          1885
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=241);/* FREEMAIN SUBPOOL 241
*                                                            @ZM30746*/
LFREEM2  FREEMAIN RC,LV=(0),A=(1),SP=241
*       CPUIDPTR=ZERO;              /*                       @ZM30746*/
         SLR   @08,@08                                             1886
         ST    @08,CPUIDPTR                                        1886
*     END;                          /*                       @ZM30746
*                                                            #Y30LB27*/
*/*********************************************************************
** CLEAN-UP MSVC CONTROL BLOCK STRUCTURE                     #Y30LB27
** VVICB AND RPLS                                            #Y30LB27
**********************************************************************/
*                                                                  1888
*   IF ICBV=OFF THEN                /* MSS TO TERMINATE      #Y30LB27*/
@RF01881 L     @08,CVTPTR                                          1888
         L     @08,CVTEXT2(,@08)                                   1888
         L     @08,CVTICB(,@08)                                    1888
         TM    ICBV(@08),B'00100000'                               1888
         BNZ   @RF01888                                            1888
*     DO;                           /* CLEAR RPLV'S          #Y30LB27*/
*       RPLVPTR=VVIQRPL1;           /* POINT TO 1ST RPL      #Y30LB27*/
         L     RPLVPTR,VVIQRPL1(,VVIPTR)                           1890
*       DO WHILE RPLVPTR^=ZERO;     /* LOOP THRU RPLS        #Y30LB27*/
         B     @DE01891                                            1891
@DL01891 DS    0H                                                  1892
*         RPLVCOMP=ON;              /* INDICATE REQ COMPLETED      1892
*                                                            #Y30LB27*/
         OI    RPLVCOMP(RPLVPTR),B'00010000'                       1892
*         RPLRCODE=RDISABLE;        /* SET REASON CODE       #Y30LB27*/
         MVC   RPLRCODE(2,RPLVPTR),@CH03643                        1893
*         RPLVRETC=FOUR;            /* SET RETURN CODE       #YM04315*/
         MVC   RPLVRETC(2,RPLVPTR),@CH00098                        1894
*         RPLVPTR=RPLVQPTR;         /* SET REQUEST ADDR      #YM04315*/
         L     RPLVPTR,RPLVQPTR(,RPLVPTR)                          1895
*       END;                        /*                       #Y30LB27*/
@DE01891 LTR   RPLVPTR,RPLVPTR                                     1896
         BNZ   @DL01891                                            1896
*       RPLVPTR=VVIQRPL2;           /* POINT TO 1ST TABLE    #Y30LB27*/
         L     RPLVPTR,VVIQRPL2(,VVIPTR)                           1897
*       DO WHILE RPLVPTR^=ZERO;     /* LOOP THRU TABLES      #Y30LB27*/
         B     @DE01898                                            1898
@DL01898 DS    0H                                                  1899
*         RPLVCOMP=ON;              /* INDICATE REQ COMPLETED      1899
*                                                            #Y30LB27*/
         OI    RPLVCOMP(RPLVPTR),B'00010000'                       1899
*         RPLRCODE=RDISABLE;        /* SET REASON CODE       #Y30LB27*/
         MVC   RPLRCODE(2,RPLVPTR),@CH03643                        1900
*         RPLVRETC=FOUR;            /* SET RETURN CODE       #YM04315*/
         MVC   RPLVRETC(2,RPLVPTR),@CH00098                        1901
*         RPLVPTR=RPLVQPTR;         /* SET REQUEST ADDR      #YM04315*/
         L     RPLVPTR,RPLVQPTR(,RPLVPTR)                          1902
*       END;                        /*                       #Y30LB27*/
@DE01898 LTR   RPLVPTR,RPLVPTR                                     1903
         BNZ   @DL01898                                            1903
*     END;                          /*                       #Y30LB27*/
*   RETURN;                         /* RETURN TO MSI         #Y30LB27*/
@EL00025 DS    0H                                                  1905
@EF00025 DS    0H                                                  1905
@ER00025 L     @14,@SA00025                                        1905
         BR    @14                                                 1905
*   END VINTERM;                    /*                       #Y30LB27*/
         B     @EL00025                                            1906
*                                                                  1907
*/* ************************************************************** 1907
**                                                           #Y30LB27
**  ICBVEN00: REALLOCATE AND OPEN THE MSVC DATA SETS FOR     #Y30LB27
**            FULL MSVC FUNCTION.                            @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**    REG 1 = ADDRESS OF THE MSVC RPL                        @Y30LB27
**            (SEE 'ICBVEN00' INPUT IN MODULE PROLOGUE)      @Y30LB27
**    ICBVVICB                                               @Y30LB27
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**     UPON ENTRY, THE INPUT MSVC RPL IS EXAMINED FOR INDICATION   1907
**     A 'JOURNAL ENABLE.'  IF SPECIFIED AND THE JOURNAL IS ALREADY
**     ALLOCATED, THEN AN ERROR CODE IS SET AND THE SEGMENT IS     1907
**     EXITED.  OTHERWISE, THE MSVC JOURNAL IS RE-ALLOCATED AND    1907
**     RE-OPENED AND A FLAG RESET IN THE ICBVVICB TO PERMIT JOURNAL
**     RECORDING.                                            @Y30LB27
**                                                           @Y30LB27
**     IF 'TOTAL DATA SET' ACTIVITY IS TO BE RESTORED AND A NEW    1907
**     USER CATALOG IS SPECIFIED, THE ICBVVICB IS UPDATED.  THEN THE
**     ICBVVICB IS CHECKED TO ENSURE THAT MSVC IS NOT ALREADY      1907
**     ALLOCATED. IF NOT, SEGMENT VININDS IS CALLED TO ALLOCATE AND
**     OPEN THE MSVC DATA SETS. OTHERWISE AN ERROR CODE IS SET TO  1907
**     INDICATE THAT MSVC ENABLE FAILED.                     @Y30LB27
**                                                           @Y30LB27
**     PRIOR TO RETURNING TO THE MSVC CONTROLLER, THE ERROR CODE   1907
**     IS CHECKED AND AN ERROR MESSAGE WRITTEN TO THE OPERATOR     1907
**     CONSOLE IF INDICATED.                                 @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**        . ENABLE FLAGS IN ICBVVICB RESET TO INDICATE ENABLED@Y30LB27
**                 DATA SET ACTIVITY.                        @Y30LB27
**        . ACB CREATED FOR MSVC INVENTORY                   @Y30LB27
**        . DCB CREATED FOR MSVC JOURNAL                     @Y30LB27
**        . UCB ADDRESSES ARE ADDED TO THE TIOT ENTRIES            1907
**                 AS EACH DATA SET IS DYNAMICALLY ALLOCATED.      1907
**        . A RETURN CODE TO THE MSVC CONTROLLER (TO BE USED       1907
**                 TO POST THE ICBVDR00 UTILITY)                   1907
**                                                           @Y30LB27
******************************************************************** */
*                                                                  1907
*ICBVEN00:                                                         1907
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27
*                                                            @YM04327*/
ICBVEN00 ST    @14,@SA00026                                        1907
*/*********************************************************************
* * IS MSVC ALREADY ENABLED                                  @ZM30746
* ********************************************************************/
*                                                                  1908
*   IF(VVIFLG0=OFF&VVIFLG2=OFF)×ICBV=OFF THEN                      1908
         TM    VVIFLG0(VVIPTR),B'10100000'                         1908
         BZ    @RT01908                                            1908
         L     @08,CVTPTR                                          1908
         L     @08,CVTEXT2(,@08)                                   1908
         L     @08,CVTICB(,@08)                                    1908
         TM    ICBV(@08),B'00100000'                               1908
         BNZ   @RF01908                                            1908
@RT01908 DS    0H                                                  1909
*     DO;                           /*                       @ZM30746*/
*       VVIFLG3=OFF;                /* TURN OFF JOURNALING   @ZM30746*/
         NI    VVIFLG3(VVIPTR),B'11101111'                         1910
*       IF VVIFLG0=OFF&VVIFLG2=OFF THEN/* ALREADY ENABLED    @ZM30746*/
         TM    VVIFLG0(VVIPTR),B'10100000'                         1911
         BNZ   @RF01911                                            1911
*         VINMSGID=MSGENAE;         /* SET ERROR INDEX       @ZM30746*/
         MVC   VINMSGID(2),@CH00178                                1912
*       IF ICBV=OFF THEN            /* MSS INOPERATIVE       @ZM30746*/
@RF01911 L     @08,CVTPTR                                          1913
         L     @08,CVTEXT2(,@08)                                   1913
         L     @08,CVTICB(,@08)                                    1913
         TM    ICBV(@08),B'00100000'                               1913
         BNZ   @RF01913                                            1913
*         VINMSGID=MSGINOE;         /* SET ERROR INDEX       @ZM30746*/
         LH    @08,MSGINOE                                         1914
         STH   @08,VINMSGID                                        1914
*       CALL VINWTO;                /* ISSUE ERROR MSG       @ZM30746*/
@RF01913 BAL   @14,VINWTO                                          1915
*       IF JRNLSW3=ON THEN          /* JOURNAL MSGS          @ZA17167*/
         TM    JRNLSW3,B'10000000'                                 1916
         BNO   @RF01916                                            1916
*         VVIFLG3=ON;               /* TURN OFF JOURNALING   @ZM30746*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         1917
*       RETURN;                     /*                       @ZM30746*/
@EL00026 DS    0H                                                  1918
@EF00026 DS    0H                                                  1918
@ER00026 L     @14,@SA00026                                        1918
         BR    @14                                                 1918
*     END;                          /*                       @ZM30746*/
*   VVIFLG1=OFF;                    /* TURN OFF INTERNAL DISABLE   1920
*                                                            @ZM31134*/
@RF01908 NI    VVIFLG1(VVIPTR),B'10111111'                         1920
*   IF VVIFLG0=ON&(VVIACBAD^=ZERO×VVICATAD^=ZERO) THEN             1921
         TM    VVIFLG0(VVIPTR),B'10000000'                         1921
         BNO   @RF01921                                            1921
         SLR   @08,@08                                             1921
         C     @08,VVIACBAD(,VVIPTR)                               1921
         BNE   @RT01921                                            1921
         C     @08,VVICATAD(,VVIPTR)                               1921
         BE    @RF01921                                            1921
@RT01921 DS    0H                                                  1922
*     DO;                           /*                       @ZM30746*/
*       CALL VINDSDS;               /* CLOSE AND DE-ALLOC INVEN    1923
*                                                            @ZM30746*/
         BAL   @14,VINDSDS                                         1923
*       VVIFLG2=ON;                 /*                       @ZM30746*/
         OI    VVIFLG2(VVIPTR),B'00100000'                         1924
*     END;                          /*                       @ZM30746*/
*   IF VVIFLG2=ON&VVIDCBAD^=ZERO THEN                              1926
@RF01921 TM    VVIFLG2(VVIPTR),B'00100000'                         1926
         BNO   @RF01926                                            1926
         L     @08,VVIDCBAD(,VVIPTR)                               1926
         LTR   @08,@08                                             1926
         BZ    @RF01926                                            1926
*     DO;                           /*                       @ZM30746*/
*       CALL VINDSDS;               /* CLOSE AND DE-ALLOC JRNL     1928
*                                                            @ZM30746*/
         BAL   @14,VINDSDS                                         1928
*       VVIFLG0=ON;                 /*                       @ZM30746*/
         OI    VVIFLG0(VVIPTR),B'10000000'                         1929
*       INIVERFY=OFF;               /* MUST BE JOURNAL ENABLE DONT 1930
*                                      PROMPT OPERATOR       @ZM30746*/
         L     @08,INITPTR                                         1930
         NI    INIVERFY(@08),B'01111111'                           1930
*     END;                          /*                       @ZM30746*/
*   IF VVIFLG0=ON&RPLJRCVY=OFF THEN /*                       #Y30LB27*/
@RF01926 TM    VVIFLG0(VVIPTR),B'10000000'                         1932
         BNO   @RF01932                                            1932
         TM    RPLJRCVY(RPLVPTR),B'00000010'                       1932
         BNZ   @RF01932                                            1932
*     IF INIUCAT(ONE:EIGHT)^=BLANKS(ONE:EIGHT) THEN/* USER CAT     1933
*                                      SPECIFIED             #Y30LB27*/
         L     @08,INITPTR                                         1933
         CLC   INIUCAT(8,@08),BLANKS                               1933
         BE    @RF01933                                            1933
*       VVIUCAT=INIUCAT;            /* SET NEW USER CAT      #Y30LB27
*                                                            #Y30LB27*/
         MVC   VVIUCAT(8,VVIPTR),INIUCAT(@08)                      1934
*/*********************************************************************
* * REQUEST AND PARAMETER CHANGES FROM THE OPERATOR          #Y30LB27
* ********************************************************************/
*                                                                  1935
*   IF VVIFLG0=ON&RPLJRCVY=OFF&INIVERFY=ON THEN/*            #Y30LB27*/
@RF01933 DS    0H                                                  1935
@RF01932 TM    VVIFLG0(VVIPTR),B'10000000'                         1935
         BNO   @RF01935                                            1935
         TM    RPLJRCVY(RPLVPTR),B'00000010'                       1935
         BNZ   @RF01935                                            1935
         L     @08,INITPTR                                         1935
         TM    INIVERFY(@08),B'10000000'                           1935
         BNO   @RF01935                                            1935
*     DO;                           /* VERIFICATION REQD     #Y30LB27*/
*       RETRYSW=ON;                 /* FORCE MSG             #Y30LB27*/
         OI    RETRYSW,B'10000000'                                 1937
*       CALL VINPARMV;              /* ANY PARAMTER CHANGES  #Y30LB27*/
         BAL   @14,VINPARMV                                        1938
*     END;                          /*                       #Y30LB27
*                                                            #Y30LB27*/
*   VVIFLG3=OFF;                    /* NO MSG UNTIL AFTER JRNL OPEN
*                                                            @ZA17167
*                                                            #YM04327*/
@RF01935 NI    VVIFLG3(VVIPTR),B'11101111'                         1940
*/*********************************************************************
* * TOTAL ENABLE                                             #YM04327
* ********************************************************************/
*                                                                  1941
*   IF VVIFLG0=ON&VVIFLG2=ON&RPLVRETC=ZERO THEN/*            #Y30LB27*/
         TM    VVIFLG0(VVIPTR),B'10100000'                         1941
         BNO   @RF01941                                            1941
         LH    @08,RPLVRETC(,RPLVPTR)                              1941
         N     @08,@CF03969                                        1941
         LTR   @08,@08                                             1941
         BNZ   @RF01941                                            1941
*     CALL VININDS;                 /* ALLOCATE AND OPEN DATA SETS 1942
*                                                            @Y30LB27
*                                                            @Y30LB27*/
         BAL   @14,VININDS                                         1942
*/*********************************************************************
* * JOURNAL ENABLE ALLOC & OPEN JOURNAL                       @Y30LB27
* ********************************************************************/
*                                                                  1943
*   IF VVIFLG0=OFF&VVIFLG2=ON&RPLVRETC=ZERO THEN                   1943
@RF01941 TM    VVIFLG2(VVIPTR),B'00100000'                         1943
         BNO   @RF01943                                            1943
         TM    VVIFLG0(VVIPTR),B'10000000'                         1943
         BNZ   @RF01943                                            1943
         LH    @08,RPLVRETC(,RPLVPTR)                              1943
         N     @08,@CF03969                                        1943
         LTR   @08,@08                                             1943
         BNZ   @RF01943                                            1943
*     DO;                                                          1944
*       CALL VINALJ2;               /* VS/2                  @YM04327*/
         BAL   @14,VINALJ2                                         1945
*       IF RPLVRETC=ZERO THEN       /*                       @ZM30746*/
         LH    @08,RPLVRETC(,RPLVPTR)                              1946
         N     @08,@CF03969                                        1946
         LTR   @08,@08                                             1946
         BNZ   @RF01946                                            1946
*         CALL JRNLRES;             /* RESERVE THE JOURNAL   @ZA05115
*                                                            #Y30LB27*/
         BAL   @14,JRNLRES                                         1947
*/*********************************************************************
* * RE-OPEN THE JOURNAL                                      #Y30LB27
* ********************************************************************/
*                                                                  1948
*       IF RPLVRETC=ZERO THEN                                      1948
@RF01946 LH    @08,RPLVRETC(,RPLVPTR)                              1948
         N     @08,@CF03969                                        1948
         LTR   @08,@08                                             1948
         BNZ   @RF01948                                            1948
*         CALL VINJOPN;             /* RE-OPEN JRNL          #Y30LB27*/
         BAL   @14,VINJOPN                                         1949
*     END;                          /*                       #Y30LB27
*                                                            @YM04327*/
@RF01948 DS    0H                                                  1951
*/*********************************************************************
* * IF NULL INVENTORY WRITE CONTROL RECORDS                  @YM04327
* ********************************************************************/
*                                                                  1951
*   IF RPLVRETC=ZERO THEN           /*                       @ZM30746*/
@RF01943 LH    @08,RPLVRETC(,RPLVPTR)                              1951
         N     @08,@CF03969                                        1951
         LTR   @08,@08                                             1951
         BNZ   @RF01951                                            1951
*     IF AMBCREAT=ON THEN           /* INIT RECORDS REQD     @YM04327*/
         L     @08,VVIACBAD(,VVIPTR)                               1952
         L     @08,ACBAMBL(,@08)                                   1952
         L     @08,AMBLDTA(,@08)                                   1952
         TM    AMBCREAT(@08),B'10000000'                           1952
         BNO   @RF01952                                            1952
*       CALL VINCRTDS;              /* FIRST MSS IPL AFTER SYSGEN  1953
*                                                            @ZM31134*/
         BAL   @14,VINCRTDS                                        1953
*     ELSE                                                         1954
*       CALL UPDTRCDS;              /* UPDATE THE RECORDS    @ZA05115*/
         B     @RC01952                                            1954
@RF01952 BAL   @14,UPDTRCDS                                        1954
*/*********************************************************************
* * INVOKE MODULES REQUIRING INITIALIZATION CALL AT IPL      #Y30LB27
* ********************************************************************/
*                                                                  1955
*   IF RPLVRETC=ZERO THEN           /* TERMINATING ERROR     #Y30LB27*/
@RC01952 DS    0H                                                  1955
@RF01951 LH    @08,RPLVRETC(,RPLVPTR)                              1955
         N     @08,@CF03969                                        1955
         LTR   @08,@08                                             1955
         BNZ   @RF01955                                            1955
*     DO;                           /* NO                    #Y30LB27*/
*       REG1=RPLVPTR;               /* SET RPLV PTR FOR CALL #Y30LB27*/
         LR    REG1,RPLVPTR                                        1957
*       CALL ICBVJL00;              /* INVOKE JOURNAL PROCESSOR    1958
*                                                            #Y30LB27*/
         L     @15,@CV03333                                        1958
         BALR  @14,@15                                             1958
*       SAVRETC=RPLVRETC;           /* SAVE RETURN CODE      @Y30LB27*/
         LH    @08,RPLVRETC(,RPLVPTR)                              1959
         N     @08,@CF03969                                        1959
         STH   @08,SAVRETC                                         1959
*       SAVRCODE=RPLRCODE;          /* SAVE RETURN CODE      @Y30LB27
*                                                            #Y30LB27*/
         LH    @08,RPLRCODE(,RPLVPTR)                              1960
         N     @08,@CF03969                                        1960
         STH   @08,SAVRCODE                                        1960
*/*********************************************************************
* * DEQ - RELEASE THE DATA SET - JOURNAL                     #Y30LB27
* ********************************************************************/
*                                                                  1961
*       CALL JRNLDEQ;               /* DEQUEUE THE JOURNAL   @ZA05115*/
         BAL   @14,JRNLDEQ                                         1961
*       RPLVRETC=SAVRETC;           /* SAVE RETURN CODE      @Y30LB27*/
         LH    @08,SAVRETC                                         1962
         STH   @08,RPLVRETC(,RPLVPTR)                              1962
*       RPLRCODE=SAVRCODE;          /* SAVE RETURN CODE      @Y30LB27*/
         LH    @05,SAVRCODE                                        1963
         STH   @05,RPLRCODE(,RPLVPTR)                              1963
*       IF RPLVRETC^=ZERO THEN                                     1964
         LTR   @08,@08                                             1964
         BZ    @RF01964                                            1964
*         DO;                       /* VJL INIT OKAY         #Y30LB27*/
*           VINMSGID=MSGVJLE;       /* NO ISSUE ERROR MSG    #Y30LB27*/
         MVC   VINMSGID(2),@CH00230                                1966
*           CNVRTWK1(ONE:TWO)=RPLRCODE;/* CONVERT RPLVCODE   #Y30LB27*/
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       1967
*           CALL VINCNVRT;          /* WILL BE ADDED TO MSG  #Y30LB27*/
         BAL   @14,VINCNVRT                                        1968
*           CALL VINWTO;            /* ISSUE ERROR MSG       #Y30LB27*/
         BAL   @14,VINWTO                                          1969
*         END;                      /*                       #Y30LB27*/
*     END;                          /*                       #Y30LB27*/
@RF01964 DS    0H                                                  1972
*   IF VVIFLG5=ON THEN              /* STILL RESERVED        @ZA05115*/
@RF01955 TM    VVIFLG5(VVIPTR),B'00000100'                         1972
         BNO   @RF01972                                            1972
*     CALL JRNLDEQ;                 /* DEQUEUE THE JOURNAL   @ZA05115*/
         BAL   @14,JRNLDEQ                                         1973
*   IF RPLVRETC=ZERO THEN           /*                       @ZA17167*/
@RF01972 LH    @08,RPLVRETC(,RPLVPTR)                              1974
         N     @08,@CF03969                                        1974
         LTR   @08,@08                                             1974
         BNZ   @RF01974                                            1974
*     VVIFLG2=OFF;                  /*                       @ZM30746*/
         NI    VVIFLG2(VVIPTR),B'11011111'                         1975
*   IF JRNLSW3=ON THEN              /* LIB MSGS JRNLED       @ZA17167*/
@RF01974 TM    JRNLSW3,B'10000000'                                 1976
         BNO   @RF01976                                            1976
*     VVIFLG3=ON;                   /*                       @ZA17167*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         1977
*/*********************************************************************
* * IF SUCCESSFUL UPDATE MOUNT STATUS                        #Y30LB27
* ********************************************************************/
*                                                                  1978
*   IF RPLVRETC=ZERO&VVIFLG0=ON&RPLJRCVY=OFF THEN                  1978
@RF01976 LH    @08,RPLVRETC(,RPLVPTR)                              1978
         N     @08,@CF03969                                        1978
         LTR   @08,@08                                             1978
         BNZ   @RF01978                                            1978
         TM    VVIFLG0(VVIPTR),B'10000000'                         1978
         BNO   @RF01978                                            1978
         TM    RPLJRCVY(RPLVPTR),B'00000010'                       1978
         BNZ   @RF01978                                            1978
*     CALL VINTBUPT;                                               1979
         BAL   @14,VINTBUPT                                        1979
*   IF VVIFLG0=ON&VVIACBAD^=ZERO&ACBOPEN=ON THEN                   1980
@RF01978 TM    VVIFLG0(VVIPTR),B'10000000'                         1980
         BNO   @RF01980                                            1980
         L     @08,VVIACBAD(,VVIPTR)                               1980
         LTR   @08,@08                                             1980
         BZ    @RF01980                                            1980
         TM    ACBOPEN(@08),B'00010000'                            1980
         BNO   @RF01980                                            1980
*     DO;                           /* YES                   #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * ISSUE ENDREC FOR DATA SET                                #Y30LB27
* ********************************************************************/
*                                                                  1982
*       RPLVTYP=RPLVENDR;           /* INDICATE ENDREC       #Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'04'                              1982
*       REG1=RPLVPTR;               /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        1983
*       CALL ICBVIO00;              /* CALL ICBVIN00 FOR ENDREC    1984
*                                                            #Y30LB27*/
         L     @15,@CV03332                                        1984
         BALR  @14,@15                                             1984
*       RPLVSAM=''B;                /* CLEAR RPL             @Y30LB27
*                                                            #Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                1985
*/*********************************************************************
* * DEQ - RELEASE THE DATA SET                               #Y30LB27
* ********************************************************************/
*                                                                  1986
*     END;                          /*                       #Y30LB27*/
*   IF VVIFLG4=ON THEN              /* INV RESERVED          @ZA05115*/
@RF01980 TM    VVIFLG4(VVIPTR),B'00001000'                         1987
         BNO   @RF01987                                            1987
*     CALL INVDEQ;                  /* DEQUEUE THE INV       @ZA05115*/
         BAL   @14,INVDEQ                                          1988
*/*********************************************************************
* * IF SUCCESSFUL INDICATE MSVC ENABLEB                      #Y30LB27
* ********************************************************************/
*                                                                  1989
*                                   /*                       @Y30LB27*/
*/*********************************************************************
* * ISSUE FINAL SUMMATION MESSAGE                            @Y30LB27
* ********************************************************************/
*                                                                  1989
*   IF RPLVRETC=ZERO THEN                                          1989
@RF01987 LH    @08,RPLVRETC(,RPLVPTR)                              1989
         N     @08,@CF03969                                        1989
         LTR   @08,@08                                             1989
         BNZ   @RF01989                                            1989
*     DO;                           /* ENABLE OKAY           @YM04327*/
*       IF VVIFLG0=ON THEN                                         1991
         TM    VVIFLG0(VVIPTR),B'10000000'                         1991
         BNO   @RF01991                                            1991
*         VVIFLG0=OFF;              /* INDIACTE INVEN ENABLED        */
         NI    VVIFLG0(VVIPTR),B'01111111'                         1992
*       IF VVIFLG2=ON THEN                                         1993
@RF01991 TM    VVIFLG2(VVIPTR),B'00100000'                         1993
         BNO   @RF01993                                            1993
*         VVIFLG2=OFF;              /* INDIACTE INVEN ENABLED        */
         NI    VVIFLG2(VVIPTR),B'11011111'                         1994
*       IF RPLJRCVY=OFF THEN                                       1995
@RF01993 TM    RPLJRCVY(RPLVPTR),B'00000010'                       1995
         BNZ   @RF01995                                            1995
*         DO;                       /* OKAY CONT             @Y30LB27*/
*           VVIFLG3=OFF;            /*                       @ZA17167*/
         NI    VVIFLG3(VVIPTR),B'11101111'                         1997
*           VINMSGID=MSGENAM;       /* ISSUE SUMMATION       @Y30LB27*/
         MVC   VINMSGID(2),@CH02855                                1998
*           CALL VINWTO;            /* ISSUE MSG             @Y30LB27*/
         BAL   @14,VINWTO                                          1999
*         END;                      /*                       @Y30LB27*/
*     END;                          /*                       @Y30LB27*/
@RF01995 DS    0H                                                  2002
*/*********************************************************************
** RESET JOURNAL FLAG AT THIS TIME EVEN IF VJL FAILED TO INIT      2002
******************************************************************** */
*                                                                  2002
*   IF JRNLSW3=ON THEN              /* MSG TO BE JOURNALED   @Y30LB27*/
@RF01989 TM    JRNLSW3,B'10000000'                                 2002
         BNO   @RF02002                                            2002
*     VVIFLG3=ON;                   /*                       @Y30LB27*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         2003
*   RETURN;                         /* RETURN TO MAINLINE    @Y30LB27*/
         B     @EL00026                                            2004
*   END ICBVEN00;                   /*                       @Y30LB27*/
         B     @EL00026                                            2005
*                                                                  2006
*/* *****************************************************************
**                                                           @Y30LB27
**   ICBVDS00: DISABLE MSVC DATA SET ACTIVITY AND DEALLOCATE @ZM30746
**            & CLOSE THE MSVC DATA SETS.                    @Y30LB27
**                                                           @Y30LB27
**  INPUT:                                                   @Y30LB27
**        . ADDRESS OF THE MSVC RPL                          @Y30LB27
**        . ICBVVICB ADDRESS                                 @Y30LB27
**        . ACB CREATED FOR MSVC INVENTORY                   @Y30LB27
**        . DCB CREATED FOR MSVC JOURNAL                     @Y30LB27
**        . UCB ADDRESSES IN THE TIOT ENTRIES TO             @G24LB04
**          INDICATE WHETHER EACH DATA SET IS ALLOCATED      @G24LB04
**                                                           @Y30LB27
**  PROCESS:                                                 @Y30LB27
**     UPON ENTRY MSVC DATA SET ACTIVITY IS DISABLED         @Y30LB27
**     BY SETTING INDICATORS IN THE ICBVVICB.                @Y30LB27
**                                                           @Y30LB27
**     NEXT, SEGMENT VINDSDS IS CALLED TO DEALLOCATE AND CLOSE THE 2006
**     MSVC DATA SETS. THIS SEGMENT RETURNS A CODE TO INDICATE     2006
**     WHETHER IT WAS SUCCESSFUL OR NOT.                     @Y30LB27
**                                                           @Y30LB27
**     PRIOR TO RETURNING TO THE MSVC CONTROLLER, A MESSAGE  @Y30LB27
**     IS WRITTEN TO THE OPERATOR IF DISABLE ACTIVITY        @Y30LB27
**     IS UNSUCCESSFUL                                       @Y30LB27
**                                                           @Y30LB27
**  NOTE: IT MIGHT BE IMPORTANT TO NOTE THAT THE MSVC DATA SETS    2006
**     MUST BE DEALLOCATED, AS WELL AS CLOSED, TO ALLOW THE        2006
**     INSTALLATION TO RE-CATALOG HIS DATA SETS IN ANOTHER VSAM    2006
**     USER CATALOG DURING THE RECOVERY PERIOD.  IN ADDITION THE AMS
**     UTILITIES REQUIRE EXCLUSIVE USE OF A VOLUME.                2006
**     DISABLE TIME.                                         @Y30LB27
**                                                           @Y30LB27
**  OUTPUT:                                                  @Y30LB27
**     UPON SUCCESSFUL DISABLEMENT OF MSVC DATA SET ACTIVITY -     2006
**        . DISABLE FLAGS IN ICBVVICB SET.                   @Y30LB27
**        . ACB ADDR FOR MSVC INVENTORY ZEROED IN ICBVVICB   @Y30LB27
**        . DCB ADDR FOR MSVC JOURNAL ZEROED IN ICBVVICB     @Y30LB27
**        . UCB ADDRESSES IN THE TIOT ENTRIES ARE ZEROED.          2006
**                                                           @Y30LB27
**     A MESSAGE TO THE OPERATOR IS WRITTEN TO INDICATE MSVC       2006
**     STATUS.                                               @Y30LB27
**                                                           @Y30LB27
*******************************************************************  */
*                                                                  2006
*ICBVDS00:                                                         2006
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB27*/
ICBVDS00 ST    @14,@SA00027                                        2006
*   VVIFLG3=OFF;                    /* NO MSG UNTIL AFTER JRNL OPEN
*                                                            @ZA17167*/
*   VVIFLG1=OFF;                    /* TURN OFF INTERNAL DISABLE   2008
*                                                            @ZM31134*/
*                                                                  2008
         NI    VVIFLG3(VVIPTR),B'10101111'                         2008
*   /*****************************************************************/
*   /*                                                               */
*   /* SET APPROPRIATE DISABLE FLAGS                         @ZA09527*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2009
*   IF INIABLE=ON THEN                                             2009
         L     @08,INITPTR                                         2009
         TM    INIABLE(@08),B'00100000'                            2009
         BNO   @RF02009                                            2009
*     VVIFLG0=ON;                   /* JOURNAL DISABLE       @ZA09527*/
         OI    VVIFLG0(VVIPTR),B'10000000'                         2010
*   IF INIJRNL=ON THEN                                             2011
@RF02009 L     @08,INITPTR                                         2011
         TM    INIJRNL(@08),B'01000000'                            2011
         BNO   @RF02011                                            2011
*     VVIFLG2=ON;                   /* INVENTORY DISBLE      @ZA09527*/
         OI    VVIFLG2(VVIPTR),B'00100000'                         2012
*/*********************************************************************
* * GET MAX RECORD BUFFER IF NOT ALREADY OBTAINED            @Y30LB27
* ********************************************************************/
*                                                                  2013
*   IF INIABLE=ON&VVIACBAD^=ZERO&ACBOPEN=ON THEN/* OPEN ACB  @ZM30746*/
@RF02011 L     @08,INITPTR                                         2013
         TM    INIABLE(@08),B'00100000'                            2013
         BNO   @RF02013                                            2013
         L     @08,VVIACBAD(,VVIPTR)                               2013
         LTR   @08,@08                                             2013
         BZ    @RF02013                                            2013
         TM    ACBOPEN(@08),B'00010000'                            2013
         BNO   @RF02013                                            2013
*     DO;                           /* YES                   @Y30LB27*/
*       DO WHILE(CPUIDPTR=ZERO);    /* RECORD BUFFER OBTAINED      2015
*                                                            @Y30LB27*/
         B     @DE02015                                            2015
@DL02015 DS    0H                                                  2016
*         REG0=MAXREC;              /* GET LENGTH OF         @Y30LB27
*                                      MAXIMUM RECORD        @G24LB04*/
         LA    REG0,1024                                           2016
*LGETM8:                                                           2017
*         GEN(GETMAIN RC,LV=(0),SP=241);/* GET STORAGE FOR ACB     2017
*                                                            @Y30LB27*/
LGETM8   GETMAIN RC,LV=(0),SP=241
*         IF REG15^=ZERO THEN                                      2018
         LTR   REG15,REG15                                         2018
         BZ    @RF02018                                            2018
*           DO;                     /* STORAGE OBTAIN        @Y30LB27*/
*             VINMSGID=MSGSTGE;     /* SET MSG ID            @Y30LB27*/
         MVC   VINMSGID(2),@CH00250                                2020
*             CALL VINWTO;          /* PRINT ERROR MESSAGE   @Y30LB27*/
         BAL   @14,VINWTO                                          2021
*             RETURN;               /* RETURN TO CALLER      @Y30LB27*/
@EL00027 DS    0H                                                  2022
@EF00027 DS    0H                                                  2022
@ER00027 L     @14,@SA00027                                        2022
         BR    @14                                                 2022
*           END;                    /*                       @Y30LB27*/
*         CPUIDPTR=REG1;            /* SET PTR FOR RECORD BUFFER   2024
*                                                            @Y30LB27*/
@RF02018 ST    REG1,CPUIDPTR                                       2024
*       END;                        /*                       @Y30LB27
*                                                            @Y30LB27*/
@DE02015 L     @08,CPUIDPTR                                        2025
         LTR   @08,@08                                             2025
         BZ    @DL02015                                            2025
*/*********************************************************************
* * ISSUE RESERVE FOR INVENTORY                              @Y30LB27
* ********************************************************************/
*                                                                  2026
*       CALL INVRES;                /* RESERVE THE INVENTORY @ZA05115*/
         BAL   @14,INVRES                                          2026
*       VRRSW=ON;                   /* DEQUEUE REQUIRED      @ZA05115
*                                                            #Y30LB27*/
         OI    VRRSW,B'10000000'                                   2027
*/*********************************************************************
* * GET CPU ASSOCIATION RECORD                               #Y30LB27
* ********************************************************************/
*                                                                  2028
*       IF RPLVRETC=ZERO THEN       /*                       @ZM30746*/
         LH    @08,RPLVRETC(,RPLVPTR)                              2028
         N     @08,@CF03969                                        2028
         LTR   @08,@08                                             2028
         BNZ   @RF02028                                            2028
*         DO;                       /*                       @ZM30746*/
*           RPLVTYP=RPLVREAD;       /* INDICATE READ         #Y30LB27*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              2030
*           RPLVUPD=ON;             /* FOR UPDATE            #Y30LB27*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        2031
*           RPLVBUF=CPUIDPTR;       /* SET BUFFER ADDRESS    #Y30LB27*/
         L     @08,CPUIDPTR                                        2032
         ST    @08,RPLVBUF(,RPLVPTR)                               2032
*           RPLVKEY=CPUIDPTR;       /* SET KEY ADDRESS       #Y30LB27*/
         ST    @08,RPLVKEY(,RPLVPTR)                               2033
*           RPLVRLN=LENGTH(CPUID);  /* SET KEY ADDRESS       #Y30LB27*/
         LA    @05,151                                             2034
         ST    @05,RPLVRLN(,RPLVPTR)                               2034
*           RPLVBLN=LENGTH(CPUID);  /* SET KEY ADDRESS       #Y30LB27*/
         ST    @05,RPLVBLN(,RPLVPTR)                               2035
*           CPUNAME=CCPUIDK;        /* SET KWY ADDR          #Y30LB27*/
         MVC   CPUNAME(13,@08),CCPUIDK                             2036
*           REG1=RPLVPTR;           /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        2037
*           CALL ICBVIO00;          /* GET CPUID REC         #Y30LB27*/
         L     @15,@CV03332                                        2038
         BALR  @14,@15                                             2038
*           IF RPLVRETC^=ZERO THEN                                 2039
         LH    @08,RPLVRETC(,RPLVPTR)                              2039
         N     @08,@CF03969                                        2039
         LTR   @08,@08                                             2039
         BZ    @RF02039                                            2039
*             DO;                   /* VSAM I/O ERROR        #Y30LB27*/
*               VINMSGID=MSGVSME;   /* INDICATE VSAM ERROR   #Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                2041
*               MSGLEN1=TWELVE;     /* LEN OF MSG CONST      #Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       2042
*               MSGTEXT1=RPLVKEY;   /* LOCATION OF NON-GRP   #YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      2043
*               CNVRTWK1=RPLRCODE;  /* SET REASON CODE       #Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    2044
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       2044
*               CALL VINCNVRT;      /* TO MSG                #Y30LB27*/
         BAL   @14,VINCNVRT                                        2045
*               CALL VINWTO;        /* ISSUE MESSAGE         #Y30LB27*/
         BAL   @14,VINWTO                                          2046
*             END;                  /*                       #Y30LB27*/
*           IF RPLVRETC=ZERO THEN                                  2048
@RF02039 LH    @08,RPLVRETC(,RPLVPTR)                              2048
         N     @08,@CF03969                                        2048
         LTR   @08,@08                                             2048
         BNZ   @RF02048                                            2048
*             DO;                   /* VSAM I/O ERROR        #Y30LB27*/
*               IF RPLJRCVY=OFF THEN/* OKAY CONT             #Y30LB27*/
         TM    RPLJRCVY(RPLVPTR),B'00000010'                       2050
         BNZ   @RF02050                                            2050
*                 CPUPURGE=CPUPURGE×VVICPUID;/* OR PURGE REQUIRED  2051
*                                                            #Y30LB27*/
         L     @08,CPUIDPTR                                        2051
         OC    CPUPURGE(2,@08),VVICPUID(VVIPTR)                    2051
*               ELSE                /* NOT RECOVERY          #Y30LB27*/
*                 CPUPURGE=MASKFFFF;/* OR PURGE REQUIRED     #Y30LB27
*                                                            #Y30LB27*/
         B     @RC02050                                            2052
@RF02050 L     @08,CPUIDPTR                                        2052
         MVC   CPUPURGE(2,@08),MASKFFFF                            2052
*/*********************************************************************
* * MODIFY RPL AND PUT THE UPDATED CPU ASSOC RECORD          #Y30LB27
* ********************************************************************/
*                                                                  2053
*               RPLVTYP=RPLVPUT;    /* INDICATE READ         #Y30LB27*/
@RC02050 MVI   RPLVTYP(RPLVPTR),X'01'                              2053
*               REG1=RPLVPTR;       /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        2054
*               CALL ICBVIO00;      /* WRITE THE RECORD      #Y30LB27*/
         L     @15,@CV03332                                        2055
         BALR  @14,@15                                             2055
*               IF RPLVRETC^=ZERO THEN                             2056
         LH    @08,RPLVRETC(,RPLVPTR)                              2056
         N     @08,@CF03969                                        2056
         LTR   @08,@08                                             2056
         BZ    @RF02056                                            2056
*                 DO;               /* VSAM I/O ERROR        #Y30LB27*/
*                   VINMSGID=MSGVSME;/* INDICATE VSAM ERROR  #Y30LB27*/
         MVC   VINMSGID(2),@CH00172                                2058
*                   MSGLEN1=TWELVE; /* LEN OF MSG CONST      #Y30LB27*/
         MVI   MSGLEN1,X'0C'                                       2059
*                   MSGTEXT1=RPLVKEY;/* SET KEY ADDR         #YM02859*/
         MVC   MSGTEXT1(3),RPLVKEY+1(RPLVPTR)                      2060
*                   CNVRTWK1=RPLRCODE;/* SET REASON CODE     #Y30LB27*/
         MVI   CNVRTWK1+2,X'00'                                    2061
         MVC   CNVRTWK1(2),RPLRCODE(RPLVPTR)                       2061
*                   CALL VINCNVRT;  /* AND ADD TO MSG        #Y30LB27*/
         BAL   @14,VINCNVRT                                        2062
*                   CALL VINWTO;    /* ISSUE MESSAGE         @Y30LB27*/
         BAL   @14,VINWTO                                          2063
*                 END;              /*                       #Y30LB27
*                                                            #Y30LB27*/
*/*********************************************************************
* * ISSUE ENDREC FOR DATA SET                                #Y30LB27
* ********************************************************************/
*                                                                  2065
*               RPLVTYP=RPLVENDR;   /* INDICATE ENDREC       #Y30LB27*/
@RF02056 MVI   RPLVTYP(RPLVPTR),X'04'                              2065
*               REG1=RPLVPTR;       /* SET REG1 TO MSVC RPLV #Y30LB27*/
         LR    REG1,RPLVPTR                                        2066
*               CALL ICBVIO00;      /* CALL ICBVIN00 FOR ENDREC    2067
*                                                            #Y30LB27*/
         L     @15,@CV03332                                        2067
         BALR  @14,@15                                             2067
*               RPLVSAM=''B;        /* CLEAR VSAM RPL        #Y30LB27*/
         XC    RPLVSAM(76,RPLVPTR),RPLVSAM(RPLVPTR)                2068
*             END;                  /*                       @ZM30746*/
*         END;                      /*                       @ZM30746
*                                                            #Y30LB27*/
@RF02048 DS    0H                                                  2071
*/*********************************************************************
* * DEQ - RELEASE THE DATA SET - INVENTORY                   #Y30LB27
* ********************************************************************/
*                                                                  2071
*       IF VRRSW=ON THEN                                           2071
@RF02028 TM    VRRSW,B'10000000'                                   2071
         BNO   @RF02071                                            2071
*         DO;                       /* DEQUEUE REQUIRED      @ZA05115*/
*           CALL INVDEQ;            /* DEQUEUE THE INV       @ZA05115*/
         BAL   @14,INVDEQ                                          2073
*         END;                      /*                       @ZA05155*/
*     END;                          /*                       @ZA05115
*                                                            #Y30LB27*/
@RF02071 DS    0H                                                  2076
*/*********************************************************************
* * CLOSE AND DE-ALLOC THE DATA SET                          #Y30LB27
* * DE-ALLOCATE WILL FREE THE BUFFER                         #Y30LB27
* ********************************************************************/
*                                                                  2076
*   CALL VINDSDS;                   /* CALL CLOSE & DE-ALLOC SEGMENT
*                                                            #Y30LB27
*                                                            #Y30LB27*/
@RF02013 BAL   @14,VINDSDS                                         2076
*   IF RPLVRETC=ZERO THEN                                          2077
         LH    @08,RPLVRETC(,RPLVPTR)                              2077
         N     @08,@CF03969                                        2077
         LTR   @08,@08                                             2077
         BNZ   @RF02077                                            2077
*     DO;                           /* SUCESSFUL             #Y30LB27
*                                                            @Y30LB27*/
*/*********************************************************************
* * ISSUE FINAL SUMMATION MESSAGE                            @Y30LB27
* ********************************************************************/
*                                                                  2079
*       IF RPLJRCVY=OFF THEN                                       2079
         TM    RPLJRCVY(RPLVPTR),B'00000010'                       2079
         BNZ   @RF02079                                            2079
*         DO;                       /* OKAY CONT             @Y30LB27*/
*           VINMSGID=MSGDISM;       /* INDICATE DISABLE      @Y30LB27*/
         MVC   VINMSGID(2),@CH00088                                2081
*           CALL VINWTO;            /* ISSUE THE ERROR MSG   @Y30LB27*/
         BAL   @14,VINWTO                                          2082
*         END;                      /*                       @Y30LB27*/
*     END;                          /*                       @Y30LB27*/
@RF02079 DS    0H                                                  2085
*   IF JRNLSW3=ON THEN              /* MSG TO BE JOURNALED   @ZA17167*/
@RF02077 TM    JRNLSW3,B'10000000'                                 2085
         BNO   @RF02085                                            2085
*     VVIFLG3=ON;                   /* NO MSG UNTIL AFTER JRNL OPEN
*                                                            @Y30LB27*/
         OI    VVIFLG3(VVIPTR),B'00010000'                         2086
*   RETURN;                         /* RETURN TO MAINLINE    @Y30LB27*/
         B     @EL00027                                            2087
*   END ICBVDS00;                   /*                       @Y30LB27*/
         B     @EL00027                                            2088
*VINPATCH:                                                         2089
*   PROC OPTIONS(NOSAVE);           /*                       @Y30LB27*/
VINPATCH DS    0H                                                  2090
*   GEN;                                                           2090
*                                   /* PATCH AREA            @Y30LB27*/
         DS    0F                      ALIGN DCS               @Y30LB27
VINPACHA NOP  *                        CALC BASE/DISP          @Y30LB27
         DC   20F'0'                   PATCH AREA              @Y30LB27
VINPACHB NOP  *                        CALC BASE/DISP          @Y30LB27
         DC   20F'0'                   PATCH AREA              @Y30LB27
VINPACHC NOP  *                        CALC BASE/DISP          @Y30LB27
         DC   20F'0'                   PATCH AREA              @Y30LB27
VINPACHD NOP  *                        CALC BASE/DISP          @Y30LB27
         DC   20F'0'                   PATCH AREA              @Y30LB27
*   END VINPATCH;                   /*                       @Y30LB27*/
@EL00028 DS    0H                                                  2091
@EF00028 DS    0H                                                  2091
@ER00028 BR    @14                                                 2091
*   END ICBVIN00                    /* END ICBVIN00 PROC     @Y30LB27*/
*                                                                  2092
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZINIT )                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */
*/*%INCLUDE SYSLIB  (IEZCPUID)                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (ICBVOLTB)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */
*/*%INCLUDE SYSLIB  (IEEZB801)                                       */
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */
*                                                                  2092
*       ;                                                          2092
@DATA    DS    0H
@CH00082 DC    H'5'
@CH00250 DC    H'6'
@CH00034 DC    H'10'
@CH00033 DC    H'11'
@CH00165 DC    H'15'
@CH03698 DC    H'17'
@CH03410 DC    H'18'
@CH03701 DC    H'19'
@CH00088 DC    H'20'
@CH00178 DC    H'21'
@CH02855 DC    H'22'
@CH00707 DC    H'24'
@CH00272 DC    H'28'
@CH03715 DC    H'29'
@CH02569 DC    H'35'
@CH03936 DC    H'36'
@CH00414 DC    H'60'
@CH03940 DC    H'132'
@CH03643 DC    H'532'
@SM03973 MVC   SCANCHAR(0,SCANPTR),VVIUCAT(VVIPTR)
@SM03975 MVC   VVIUCAT(0,VVIPTR),0(@05)
@SM03977 MVC   VVIVTRK-1(0,@08),0(@04)
@SM03980 MVC   S99TUPAR(0,@08),VVIUCAT(VVIPTR)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    1F
@SA00005 DS    1F
@SA00006 DS    1F
@SA00007 DS    1F
@SA00008 DS    1F
@SA00009 DS    1F
@SA00010 DS    1F
@SA00012 DS    1F
@SA00013 DS    1F
@SA00014 DS    1F
@SA00015 DS    1F
@SA00016 DS    1F
@SA00017 DS    1F
@SA00018 DS    1F
@SA00019 DS    1F
@SA00003 DS    1F
@SA00026 DS    1F
@SA00027 DS    1F
@SA00011 DS    1F
@SA00022 DS    1F
@SA00024 DS    1F
@SA00025 DS    1F
@SA00023 DS    1F
@SA00021 DS    1F
@TF00001 DS    F
         DS    0F
@CF00055 DC    F'1'
@CH00055 EQU   @CF00055+2
@CF00066 DC    F'2'
@CH00066 EQU   @CF00066+2
@CF00118 DC    F'3'
@CH00118 EQU   @CF00118+2
@CF00098 DC    F'4'
@CH00098 EQU   @CF00098+2
@CF00310 DC    F'7'
@CH00310 EQU   @CF00310+2
@CF00039 DC    F'8'
@CH00039 EQU   @CF00039+2
@CF00035 DC    F'9'
@CH00035 EQU   @CF00035+2
@CF00230 DC    F'13'
@CH00230 EQU   @CF00230+2
@CF00172 DC    F'14'
@CH00172 EQU   @CF00172+2
@CF00167 DC    F'16'
@CH00167 EQU   @CF00167+2
@CF02345 DC    F'25'
@CH02345 EQU   @CF02345+2
@CF00237 DC    F'32'
@CH00237 EQU   @CF00237+2
@CF03635 DC    F'71'
@CF03592 DC    F'401'
@CF03364 DC    F'427'
@CF03366 DC    F'428'
@CF03368 DC    F'430'
@CF03370 DC    F'431'
@CF03640 DC    F'1024'
@CF03942 DC    F'8000'
@CF03944 DC    F'8084'
@CF03966 DC    F'-56'
@CF03969 DC    XL4'0000FFFF'
@CV03330 DC    V(ICBVPR00)
@CV03331 DC    V(ICBVSP00)
@CV03332 DC    V(ICBVIO00)
@CV03333 DC    V(ICBVJL00)
@CV03334 DC    V(ICBVOP00)
         DS    0D
INITPTR  DS    A
GROUPPTR DS    A
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
DCBPTR   DS    A
TIOTPTR  DC    A(0)
JFCBPTR  DC    AL4(JFCB)
INVUCBAD DS    F
JNLUCBAD DS    F
COUNTUCB DS    F
TEMPBIN  DS    F
INILEN   DC    AL2(20)
J        DS    H
UCATLEN  DS    H
NUMCOL   DS    H
TMPCOL   DS    H
STRTCOL  DS    H
STRTINDX DS    H
SRCODE   DS    H
NORECFND DC    XL2'0208'
SAVRETC  DS    H
SAVRCODE DS    H
VINMSGID DS    H
MSGGRPE  DC    H'30'
MSGINOE  DC    H'31'
JRNLSW   DC    XL1'0'
         ORG   JRNLSW
JRNLSW3  DS    BL1
@NM00108 EQU   JRNLSW+0
         ORG   JRNLSW+1
POOL     DC    AL1(241)
         DS    0D
@TS00001 DS    CL8
@CC03588 DC    C'SYSGROUP'
@CC03662 DC    C'000'
@CC03664 DC    C'068'
@CC03660 EQU   @CC03662
@CC03666 DC    C'U '
@CC03670 DC    C'Y '
@CC03672 DC    C'N '
@CB03677 DC    X'FFFFFFFC'
@CB03596 DC    X'00F0'
         DS    CL2
S99RB    DS    CL20
         ORG   S99RB
S99RBLN  DS    CL1
S99VERB  DS    CL1
S99FLAG1 DS    CL2
         ORG   S99FLAG1
S99FLG11 DS    CL1
         ORG   S99FLG11
S99ONCNV DS    BL1
S99NOCNV EQU   S99FLG11+0
S99NOMNT EQU   S99FLG11+0
S99JBSYS EQU   S99FLG11+0
         ORG   S99FLAG1+1
S99FLG12 DS    CL1
         ORG   S99RB+4
S99RSC   DS    CL4
         ORG   S99RSC
S99ERROR DS    CL2
S99INFO  DS    CL2
         ORG   S99RB+8
S99TXTPP DS    AL4
S99RSV01 DS    FL4
S99FLAG2 DS    CL4
         ORG   S99FLAG2
S99FLG21 DS    CL1
         ORG   S99FLG21
S99WTVOL DS    BL1
S99WTDSN EQU   S99FLG21+0
S99NORES EQU   S99FLG21+0
S99WTUNT EQU   S99FLG21+0
S99OFFLN EQU   S99FLG21+0
S99TIONQ EQU   S99FLG21+0
S99CATLG EQU   S99FLG21+0
S99MOUNT EQU   S99FLG21+0
         ORG   S99FLAG2+1
S99FLG22 DS    CL1
         ORG   S99FLG22
S99UDEVT DS    BL1
S99PCINT EQU   S99FLG22+0
         ORG   S99FLAG2+2
S99FLG23 DS    CL1
S99FLG24 DS    CL1
         ORG   S99RB+20
MSGRQ    DS    CL32
         ORG   MSGRQ
MSGID    DS    FL4
MSGRPLV  DS    AL4
MSGRLEN  DS    BL1
MSGREPLY DS    AL3
MSGLEN1  DS    BL1
MSGTEXT1 DS    AL3
MSGLEN2  DS    BL1
MSGTEXT2 DS    AL3
MSGLEN3  DS    BL1
MSGTEXT3 DS    AL3
MSGLEN4  DS    BL1
MSGTEXT4 DS    AL3
MSGLEN5  DS    BL1
MSGTEXT5 DS    AL3
         ORG   MSGRQ+32
TXTMSVC  DS    CL49
         ORG   TXTMSVC
MSVCKEY1 DC    X'0001'
MSVCNUM1 DC    XL2'0001'
MSVCLNG1 DC    H'4'
MSVCPAR1 DC    CL4'MSVC'
MSVCKEY2 DC    X'0002'
MSVCNUM2 DC    XL2'0001'
MSVCLNG2 DS    FL2
MSVCPAR2 DC    CL18' '
MSVCKEY3 DC    X'0004'
MSVCNUM3 DC    XL2'0001'
MSVCLNG3 DC    XL2'0001'
MSVCPAR3 DC    X'08'
@NM00105 DS    CL1
MSVCKEY4 DC    X'0005'
MSVCNUM4 DC    XL2'0001'
MSVCLNG4 DC    XL2'0001'
MSVCPAR4 DC    X'08'
         ORG   TXTMSVC+49
         DS    CL1
TXTJRNL  DS    CL14
         ORG   TXTJRNL
JRNLKEY1 DC    X'0001'
JRNLNUM1 DC    XL2'0001'
JRNLLNG1 DC    H'8'
JRNLPAR1 DC    CL8'MSVCJRNL'
         ORG   TXTJRNL+14
SWITCH   DS    BL2
         ORG   SWITCH
RETRYSW  DS    BL1
GVSEXSW  EQU   SWITCH+0
SCANSW   EQU   SWITCH+0
PURGSW   EQU   SWITCH+0
@NM00106 EQU   SWITCH+0
MSGSW    EQU   SWITCH+0
PARENSW  EQU   SWITCH+0
DISSW    EQU   SWITCH+0
VRRSW    DS    BL1
VJLSW    EQU   SWITCH+1
VRRSWI   EQU   SWITCH+1
VRRSWJ   EQU   SWITCH+1
TRKSW    EQU   SWITCH+1
@NM00107 EQU   SWITCH+1
         ORG   SWITCH+2
TESTBYTE DS    BL1
         ORG   TESTBYTE
TESTB0   DS    BL1
TESTB1   EQU   TESTBYTE+0
TESTB2   EQU   TESTBYTE+0
TESTB3   EQU   TESTBYTE+0
@NM00109 EQU   TESTBYTE+0
         ORG   TESTBYTE+1
         DS    CL1
JFCBELST DS    CL4
         ORG   JFCBELST
JFCBCODE DC    X'87'
JFCBEXIT DC    AL3(JFCB)
         ORG   JFCBELST+4
CATWKA   DS    CL588
         ORG   CATWKA
QMIOP    DS    CL24
         ORG   QMIOP
@NM00110 DS    CL12
QMIDSKAD DS    CL4
         ORG   CATWKA+24
CATSAVRG DS    CL88
JFCB     DS    CL176
@NM00111 DS    CL300
         ORG   CATWKA+588
SWAEAREA DC    XL20'0'
UCBDELIM DC    X'FFFFFFFF'
IDMASK   DS    CL2
MASK0F   DC    X'0F'
MASKF0   DC    X'F0'
MASKFA   DC    X'FA'
         DS    CL1
MASK8000 DC    X'8000'
MASK00F6 DC    X'00F6'
MASKFFFF DC    X'FFFF'
MASKF0F1 DC    X'F0F1'
         DS    CL2
MASKFFF8 DC    X'FFFFFFF8'
MASK00FF DC    X'000000FF'
MASK001F DC    X'0000001F'
LOCERR   DC    X'1708'
WORK1    DS    CL2
MSGBUF   DS    CL60
CINVENTO DC    CL9'INVENTORY'
CJOURNAL DC    CL7'JOURNAL'
CMSFMSG  DC    CL7'MSFMSG='
CSSCSAMP DC    CL9'MSSCSAMP='
CTRKVOLS DC    CL8'TRKVOLS='
CUCAT    DC    CL8'MSVCCAT='
CIEESB60 DC    CL8'IEESB601'
CSSIB    DC    CL4'SSIB'
CSSOB    DC    CL4'SSOB'
CMSTR    DC    CL8'MSTR'
CMSVC    DC    CL8'MSVC'
CMSVI    DC    CL4'MSVI'
CJRNL    DC    CL4'JRNL'
MSVI     DC    CL4'MSvi'
MSVIJRNL DC    CL8'MSVIJRNL'
MSVCJRNL DC    CL8'MSVCJRNL'
@NM00112 DS    CL16
         ORG   @NM00112
MSTR     DC    CL4'MSTR'
@NM00113 DC    CL4'    '
SUBTASK  DC    CL8'SUBTASK'
         ORG   @NM00112+16
SYSZMSVI DC    CL8'SYSZMSVI'
CSYSGRPK DS    CL13
         ORG   CSYSGRPK
CSYSGRP  DC    CL12'G  SYSGROUP '
CB00     DC    X'00'
         ORG   CSYSGRPK+13
CNGRPK   DC    CL13'N   HEADER'
CCPUIDK  DC    CL13'C  CPU ID'
CBASNAMK DS    CL13
         ORG   CBASNAMK
@NM00114 DC    CL12'V'
@NM00115 DC    X'00'
         ORG   CBASNAMK+13
CGRONAMK DS    CL13
         ORG   CGRONAMK
@NM00116 DC    CL12'G'
@NM00117 DC    X'00'
         ORG   CGRONAMK+13
BLANKS   DC    CL72' '
DASD     DC    X'20'
VIRT     DC    X'08'
RBAERR   DC    X'74'
PURGOPCD DC    X'14'
ASSCOPCD DC    X'2C'
LSPAREA  DS    CL30
         ORG   LSPAREA
@NM00118 DS    CL6
LSPFRESP DS    CL4
@NM00119 DS    CL1
LSPFRETR DS    CL4
@NM00120 DS    CL1
LSPFREXT DS    CL4
@NM00121 DS    CL1
LSPLEXT  DS    CL4
@NM00122 DS    CL1
LSPLGTRK DS    CL4
         ORG   LSPAREA+30
TEMPPACK DS    CL4
TEMPCHAR DS    CL2
REPLY    DS    CL72
CNVRTWK1 DS    CL3
CNVRTWK2 DS    CL5
         DS    CL2
ESTAESTG DS    CL16
OPNSTG   DS    CL4
CLSSTG   DS    CL4
RJFCBSTG DS    CL4
BINZERO  DC    X'000000000000'
         DS    CL2
TXTPTR   DC    AL4(MSVCKEY1)
         DC    AL4(MSVCKEY2)
         DC    AL4(MSVCKEY3)
         DC    AL4(MSVCKEY4)
VINMSGTB DC    H'433'
         DC    H'422'
         DC    H'420'
         DC    H'456'
         DC    H'423'
         DC    H'409'
         DC    H'441'
         DC    H'442'
         DC    H'444'
         DC    H'443'
         DC    H'446'
         DC    H'0'
         DC    H'448'
         DC    H'449'
         DC    H'417'
         DC    H'453'
         DC    H'451'
         DC    H'452'
         DC    H'450'
         DC    H'455'
         DC    H'454'
         DC    H'418'
         DC    H'419'
         DC    H'457'
         DC    H'471'
         DC    H'468'
         DC    H'469'
         DC    H'470'
         DC    H'402'
         DC    H'403'
         DC    H'474'
         DC    H'434'
ICBVIN00 CSECT
*                                   /*                       @Y30LB27*/
TRTAB    EQU  *-X'F0'                  UNUSED                  @Y30LB27
         DC   C'0123456789ABCDEF'      TRANSLATION BYTES       @Y30LB27
ICBVIN00 CSECT
*                                                          /*@ZA09527*/
ESTAELST  ESTAE MF=L                                           @Y30LB27
OPNLST    OPEN (,(OUTPUT)),MF=L                                @Y30LB27
CLSLST    OPEN (,),MF=L                                        @Y30LB27
DCBLST    DCB  DSORG=PS,MACRF=E,DDNAME=MSVCJRNL,DEVD=DA,RECFM=FS
ACBLST    ACB  BUFND=2,BUFNI=1,STRNO=1,DDNAME=MSVC,MACRF=(KEY,DIR,CNV, *
               SEQ,IN,OUT)                                     @Y30LB27
RJFCBLST  RDJFCB (),MF=L                                       @Y30LB27
VINTMH   TM   WORK1,X'00'           TARGET OF EXECUTE INST     @Y30LB27
VINTML   TM   WORK1+1,X'00'           TARGET OF EXECUTE INST   @Y30LB27
RSVINVLT RESERVE (SYSZMSVI,MSVI,E,4,SYSTEMS),RET=HAVE,         @ZM31134*
               UCB=INVUCBAD,MF=L                               @ZM31134
RSVJNLLT RESERVE (SYSZMSVI,MSVIJRNL,E,8,SYSTEMS),RET=HAVE,     @ZM31134*
               UCB=JNLUCBAD,MF=L                               @ZM31134
ICBVIN00 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FIXED8   EQU   @08
SVRETC   EQU   @08
RPLVSAVE EQU   @02
INDX     EQU   @02
SAVEI    EQU   @02
I        EQU   @08
UCBLOKUP EQU   @08
SCANPTR  EQU   @02
PAIRPTR  EQU   @08
RPLVPTR  EQU   @06
VVIPTR   EQU   @07
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
PAIRR1   EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG3     EQU   @03
CVTPTR   EQU   16
ICB2SSCB EQU   0
ICBOPT   EQU   ICB2SSCB+48
ICBFLG   EQU   ICB2SSCB+52
ICBFG1   EQU   ICBFLG
ICBV     EQU   ICBFG1
ICBVVIC  EQU   ICB2SSCB+72
ICBVVICB EQU   ICB2SSCB+76
ICBCPUID EQU   ICB2SSCB+112
ICBSAMP  EQU   ICB2SSCB+118
ICBVSCRA EQU   ICB2SSCB+120
ICBVOLST EQU   ICB2SSCB+124
ICBTRACE EQU   ICB2SSCB+148
VVICB    EQU   0
VVIUCAT  EQU   VVICB+4
VVICPUID EQU   VVICB+12
VVIALCON EQU   VVICB+14
VVIFLGA  EQU   VVICB+15
VVIFLG0  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
VVIFLG3  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIACBAD EQU   VVICB+16
VVIDCBAD EQU   VVICB+20
VVICATAD EQU   VVICB+24
VVIVQMP  EQU   VVICB+32
VVIVTRK  EQU   VVICB+37
VVIQRPL1 EQU   VVICB+40
VVIQRPL2 EQU   VVICB+44
VVIUCB   EQU   VVICB+60
VVIIUCB  EQU   VVICB+76
VVIJUCB  EQU   VVICB+80
VVIVSCRA EQU   VVICB+92
VVISSOBA EQU   VVICB+96
VVIDVMEL EQU   VVICB+104
RPLV     EQU   0
RPLVQPTR EQU   RPLV
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLFTIME EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLVTLEN EQU   RPLV+30
RPLRCODE EQU   RPLV+32
RPLVRETC EQU   RPLV+34
RPLVDATE EQU   RPLV+38
RPLVSAM  EQU   RPLV+56
RPLVTYP  EQU   RPLVSAM+2
RPLVBUF  EQU   RPLVSAM+32
RPLVKEY  EQU   RPLVSAM+36
RPLVOPT  EQU   RPLVSAM+40
RPLVLOC  EQU   RPLVOPT
RPLVDIR  EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
RPLVUPD  EQU   RPLVOPT+1
RPLVRLN  EQU   RPLVSAM+48
RPLVBLN  EQU   RPLVSAM+52
RPLVUTIL EQU   RPLV+132
INITVVI  EQU   0
INITOPCD EQU   INITVVI+4
INIFLAGA EQU   INITVVI+5
ININIT   EQU   INIFLAGA
INIENABL EQU   INIFLAGA
INIDISAB EQU   INIFLAGA
INIFLAGB EQU   INITVVI+6
INIVERFY EQU   INIFLAGB
INIJRNL  EQU   INIFLAGB
INIABLE  EQU   INIFLAGB
INIRESTR EQU   INIFLAGB
INIVCODE EQU   INITVVI+7
INIUCAT  EQU   INITVVI+8
LSTPAIR  EQU   0
PURGLL   EQU   LSTPAIR
PURGOP   EQU   LSTPAIR+4
PURGFLG  EQU   LSTPAIR+6
PURGHOST EQU   LSTPAIR+8
GROUP    EQU   0
GRONAME  EQU   GROUP
GROVVGRP EQU   GRONAME+3
GROID    EQU   GRONAME+11
GROBLANK EQU   GROID
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROGVR   EQU   GROTYPE
GROFSN   EQU   GROUP+17
GROLSN   EQU   GROUP+23
GROPSPD  EQU   GROUP+36
GROSSPD  EQU   GROUP+38
GROERRTS EQU   GROUP+56
GRODESCR EQU   GROUP+64
GROOWNER EQU   GROUP+96
GROADDR  EQU   GROUP+106
GVSNE    EQU   0
GVSHDR   EQU   GVSNE
GVSNAME  EQU   GVSHDR
GVSVVGRP EQU   GVSNAME+3
GVSID    EQU   GVSNAME+11
GVSFLAGA EQU   GVSHDR+13
GVSTYPE  EQU   GVSFLAGA
GVSEX    EQU   GVSFLAGA+2
GVSESIND EQU   GVSHDR+18
GVSSLOTS EQU   GVSNE+28
GVSVOLID EQU   GVSSLOTS
GVSVOLFL EQU   GVSSLOTS+6
GVSCPUBM EQU   GVSVOLFL
GVSRCFSI EQU   GVSVOLFL+2
GVSMTNSH EQU   GVSVOLFL+2
GVSFRESP EQU   GVSSLOTS+10
GVSLEXT  EQU   GVSSLOTS+12
GVSMTDSP EQU   GVSSLOTS+18
NGVR     EQU   0
NGVRTYPE EQU   NGVR+13
NGVHDR   EQU   NGVRTYPE
NGVFVOL  EQU   NGVR+17
NGVLVOL  EQU   NGVR+23
CPUID    EQU   0
CPUNAME  EQU   CPUID
CPUINEXT EQU   CPUID+14
CPUDNEXT EQU   CPUID+16
CPUTYPE  EQU   CPUID+18
CPUASSOC EQU   CPUTYPE
CPUMAP   EQU   CPUID+20
CPUIDREC EQU   CPUMAP
CPUMASK  EQU   CPUMAP+6
CPUPURGE EQU   CPUID+148
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASDLSF  EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASCPUID EQU   BASEV+18
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASDLMTD EQU   BASEV+92
BASGROUP EQU   BASEV+180
ICBVLIST EQU   0
ICBVLCNT EQU   ICBVLIST
ICBVLENT EQU   ICBVLIST+4
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUPLN EQU   S99TUPTR
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUENT EQU   S99TUNIT+4
S99TULNG EQU   S99TUENT
S99TUPAR EQU   S99TUENT+2
S99TUFLD EQU   0
SWAE     EQU   0
SWOPTION EQU   SWAE
SWCREATE EQU   SWOPTION
SWJOBNAM EQU   SWAE+4
SWSTEPNM EQU   SWAE+8
SWTIOTPT EQU   SWAE+12
SWJSCBPT EQU   SWAE+16
SWAEPTR  EQU   0
IFGACB   EQU   0
ACBCOMN  EQU   IFGACB
ACBLENG  EQU   ACBCOMN+2
ACBLENG2 EQU   ACBLENG
ACBAMBL  EQU   ACBCOMN+4
ACBJWA   EQU   ACBAMBL
ACBMACRF EQU   ACBCOMN+12
ACBMACR1 EQU   ACBMACRF
ACBADR   EQU   ACBMACR1
ACBCNV   EQU   ACBMACR1
ACBMACR2 EQU   ACBMACRF+1
ACBBUFPL EQU   ACBCOMN+20
ACBMACR3 EQU   ACBBUFPL
ACBRECFM EQU   ACBCOMN+24
ACBCCTYP EQU   ACBCOMN+25
ACBOPT   EQU   ACBCOMN+26
ACBDSORG EQU   ACBOPT
ACBCROPS EQU   ACBDSORG
ACBEXLST EQU   ACBCOMN+36
ACBDDNM  EQU   ACBCOMN+40
ACBAMETH EQU   ACBDDNM+3
ACBOFLGS EQU   ACBCOMN+48
ACBOPEN  EQU   ACBOFLGS
ACBEXFG  EQU   ACBOFLGS
ACBIOSFG EQU   ACBOFLGS
ACBERFLG EQU   ACBCOMN+49
ACBINFLG EQU   ACBCOMN+50
ACBCAT   EQU   ACBINFLG
ACBVVIC  EQU   ACBINFLG
ACBUJFCB EQU   ACBCOMN+52
ACBBLKSZ EQU   ACBCOMN+60
ACBUAPTR EQU   ACBCOMN+64
IDAAMBL  EQU   0
AMBLEOV  EQU   IDAAMBL+12
AMBLEFLG EQU   AMBLEOV
AMBLDDNM EQU   IDAAMBL+16
AMBLIDF  EQU   AMBLDDNM
AMBLQ    EQU   AMBLIDF+7
AMBLVC   EQU   IDAAMBL+28
AMBLTYPE EQU   IDAAMBL+30
AMBLSHAR EQU   IDAAMBL+33
AMBLFLG1 EQU   IDAAMBL+35
AMBLFLG2 EQU   IDAAMBL+36
AMBLDTA  EQU   IDAAMBL+52
AMBLIX   EQU   IDAAMBL+56
IDAAMB   EQU   0
AMBDSB   EQU   IDAAMB+20
AMBEOVR  EQU   IDAAMB+24
AMBFLG0  EQU   AMBEOVR
AMBFLG1  EQU   IDAAMB+25
AMBCREAT EQU   AMBFLG1
AMBDSORG EQU   IDAAMB+26
AMBIOBAD EQU   IDAAMB+28
AMBINFL  EQU   IDAAMB+42
AMBDEBPT EQU   IDAAMB+44
AMBOFLGS EQU   IDAAMB+48
AMBFLG2  EQU   IDAAMB+49
AMBEOVPT EQU   IDAAMB+56
AMBCSWD1 EQU   IDAAMB+84
AMBAFLG  EQU   AMBCSWD1
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLDACB  EQU   RPLCOMN+24
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLKGE   EQU   RPLOPT1
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLKEY   EQU   RPLOPT2
RPLADR   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
RPLNEXIT EQU   RPLEXTD1
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS28 EQU   0
DCBOPTCD EQU   IHADCS28
DCBOPTZ  EQU   DCBOPTCD
IHADCS44 EQU   0
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTILK2  EQU   CVTMAP+40
CVTDATE  EQU   CVTMAP+56
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTICB   EQU   CVTXTNT2+48
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBTIO   EQU   TCB+12
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
TIOT1    EQU   0
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
SSIB     EQU   0
SSIBID   EQU   SSIB
SSIBLEN  EQU   SSIB+4
SSIBFLG1 EQU   SSIB+6
SSIBSSNM EQU   SSIB+8
SSIBJBID EQU   SSIB+12
SSIBPTR  EQU   0
SSOB     EQU   0
SSOBID   EQU   SSOB
SSOBLEN  EQU   SSOB+4
SSOBFUNC EQU   SSOB+6
SSOBSSIB EQU   SSOB+8
SSOBINDV EQU   SSOB+16
SSMO     EQU   0
SSMOLEN  EQU   SSMO
SSMOFLG1 EQU   SSMO+2
SSMORUSE EQU   SSMOFLG1
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESPJESN EQU   JESCT+28
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
UCB      EQU   0
UCBPTR   EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBRESV  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCBRR    EQU   UCBDUDN1
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRVDEV EQU   UCBRWTAU
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00098 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
@NM00099 EQU   0
AMDNEXT  EQU   @NM00099+58
SCANP31  EQU   0
SCAN31   EQU   0
TCBWORDS EQU   0
TCBPTR   EQU   TCBWORDS+4
SAVAREA  EQU   0
AMVJES3S EQU   0
AMVSSOB  EQU   AMVJES3S
AMVSSBX  EQU   AMVJES3S+20
AMVSSIB  EQU   AMVJES3S+48
SCANCHAR EQU   0
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
SSREQ    EQU   0
SWAMGR   EQU   0
UCBBGN   EQU   0
GVSNEPTR EQU   GROUPPTR
NGVRPTR  EQU   GROUPPTR
CPUIDPTR EQU   GROUPPTR
BASEVPTR EQU   GROUPPTR
S99TUFP  EQU   S99TUENT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
TIOENTRY EQU   TIOT1+24
TIOELNGH EQU   TIOENTRY
TIOESTTA EQU   TIOENTRY+1
TIOERLOC EQU   TIOENTRY+2
TIOELINK EQU   TIOERLOC+1
TIOESYOT EQU   TIOELINK
TIOEDDNM EQU   TIOENTRY+4
TIOESTTC EQU   TIOENTRY+15
TIOESTTB EQU   TIOENTRY+16
TIOEFSRT EQU   TIOENTRY+17
POOLSTAR EQU   TIOENTRY+20
TIOEDEVE EQU   TIOESTTB
TIOSTTB  EQU   TIOEDEVE
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCBSSIB EQU   JSCBSEC3+56
JSCSCT   EQU   JSCBSEC3+68
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00097 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
DCBELST  EQU   IHADCB+23
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DCBEXLST EQU   DCBELST+1
@NM00101 EQU   DCBELST
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00097
UCBSKPFG EQU   @NM00097
UCBRIPND EQU   @NM00097
UCBRTIAC EQU   @NM00097
UCBRSV79 EQU   @NM00097
UCBRSV78 EQU   @NM00097
UCBRSV77 EQU   @NM00097
UCBOLTEP EQU   @NM00097
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBDQDSP EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00096 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00094 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00093 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00092 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00087 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00086 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
TIOUCBP  EQU   TIOEDEVE+1
TIOVERF  EQU   TIOSTTB
TIOUNLD  EQU   TIOSTTB
TIOMNTD  EQU   TIOSTTB
TIOSETU  EQU   TIOSTTB
TIOVLSR  EQU   TIOSTTB
TIOPVIO  EQU   TIOSTTB
TIOREQD  EQU   TIOSTTB
TIOUSED  EQU   TIOSTTB
TIOTFEND EQU   POOLSTAR+16
TIOPSLOT EQU   POOLSTAR+13
TIOPSTTB EQU   POOLSTAR+12
TIOPPOOL EQU   POOLSTAR+4
TIOPNSRT EQU   POOLSTAR+3
@NM00083 EQU   POOLSTAR+2
TIOPNSLT EQU   POOLSTAR+1
@NM00082 EQU   POOLSTAR
TIOSVERF EQU   TIOESTTB
TIOSUNLD EQU   TIOESTTB
TIOSMNTD EQU   TIOESTTB
TIOSSETU EQU   TIOESTTB
TIOSVLSR EQU   TIOESTTB
TIOSPVIO EQU   TIOESTTB
TIOSREQD EQU   TIOESTTB
TIOSUSED EQU   TIOESTTB
TIOSBALS EQU   TIOESTTC
TIOSBALP EQU   TIOESTTC
TIOSVOLS EQU   TIOESTTC
TIOSVOLP EQU   TIOESTTC
TIOSAFFS EQU   TIOESTTC
TIOSAFFP EQU   TIOESTTC
TIOSDEFR EQU   TIOESTTC
TIOSDKCR EQU   TIOESTTC
TIOEJFCB EQU   TIOENTRY+12
TIOTREM  EQU   TIOELINK
TIOESSDS EQU   TIOESYOT
TIOESYIN EQU   TIOELINK
TIOEQNAM EQU   TIOELINK
TIOEDYNM EQU   TIOELINK
TIOTTERM EQU   TIOELINK
TIOTRV01 EQU   TIOELINK
TIOSYOUT EQU   TIOELINK
TIOEWTCT EQU   TIOERLOC
TIOSDSP2 EQU   TIOESTTA
TIOSDSP1 EQU   TIOESTTA
TIOSLABL EQU   TIOESTTA
TIOSDADS EQU   TIOESTTA
TIOSJBLB EQU   TIOESTTA
TIOSPLTS EQU   TIOESTTA
TIOSPLTP EQU   TIOESTTA
TIOSLTYP EQU   TIOESTTA
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
SAVREG0  EQU   SAVAREA+20
SAVREG15 EQU   SAVAREA+16
SAVREG14 EQU   SAVAREA+12
@NM00104 EQU   SAVAREA+8
SAVPTR   EQU   SAVAREA+4
@NM00103 EQU   SAVAREA
@NM00102 EQU   TCBWORDS
@NM00100 EQU   @NM00099
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBFCBPE EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00098
UCBHALI  EQU   @NM00098
UCBRSV09 EQU   @NM00098
UCBRSV08 EQU   @NM00098
UCBRSV07 EQU   @NM00098
UCBRSV06 EQU   @NM00098
UCBRSV05 EQU   @NM00098
UCBRSV04 EQU   @NM00098
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRPS   EQU   UCBDUDN2
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00095 EQU   UCB
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00091 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00090 EQU   JESCT
SSMOPRPN EQU   SSMO+24
SSMOPDDN EQU   SSMO+20
SSMOPVOL EQU   SSMO+16
SSMOPUAD EQU   SSMO+12
SSMOPSTN EQU   SSMO+8
SSMOPNAM EQU   SSMO+4
SSMORSV0 EQU   SSMO+3
@NM00089 EQU   SSMOFLG1
SSMOMNTD EQU   SSMOFLG1
SSMOSCR  EQU   SSMOFLG1
SSMOFINL EQU   SSMOFLG1
SSMOOPEN EQU   SSMOFLG1
SSOBRETN EQU   SSOB+12
SSIBSUSE EQU   SSIB+32
SSIBRSV1 EQU   SSIB+28
SSIBDEST EQU   SSIB+20
SSIBRESV EQU   SSIB+7
@NM00088 EQU   SSIBFLG1
SSIBPJES EQU   SSIBFLG1
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00085 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00084 EQU   IEZJSCB
TIOCSTEP EQU   TIOT1+8
TIOCNJOB EQU   TIOT1
@NM00081 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00080 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00079 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00078 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00077 EQU   CVTFIX+248
@NM00076 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
@NM00075 EQU   IHADCS44+10
DCBXENDA EQU   IHADCS44+8
DCBCENDA EQU   IHADCS44+6
DCBSIOA  EQU   IHADCS44+4
DCBPCIA  EQU   IHADCS44+2
DCBEOEA  EQU   IHADCS44
@NM00074 EQU   IHADCS28+1
@NM00073 EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
@NM00072 EQU   DCBOPTCD
DCBDEBA  EQU   DCBDEBAD+1
@NM00071 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00070 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBTRBAL EQU   IHADCS01+6
@NM00069 EQU   IHADCS01+5
@NM00068 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00067 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00066 EQU   IHADCB
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00065 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00064 EQU   RPLRBAR+3
@NM00063 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
@NM00062 EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLAREA  EQU   RPLCOMN+32
RPLTCBPT EQU   RPLCOMN+28
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLERREG EQU   RPLRTNCD
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
AMBVIOT  EQU   IDAAMB+116
AMBSZCP  EQU   IDAAMB+114
AMBSZFW  EQU   IDAAMB+112
AMBSZWR  EQU   IDAAMB+110
AMBSZRD  EQU   IDAAMB+108
AMBEXEX  EQU   IDAAMB+100
AMBWSHD  EQU   IDAAMB+96
AMBCPA   EQU   IDAAMB+92
AMBBM2SH EQU   IDAAMB+88
AMBRDCNT EQU   AMBCSWD1+2
@NM00061 EQU   AMBCSWD1+1
@NM00060 EQU   AMBAFLG
AMBCFX   EQU   AMBAFLG
AMBSIS   EQU   AMBAFLG
AMBDFR   EQU   AMBAFLG
AMBICI   EQU   AMBAFLG
AMBGSR   EQU   AMBAFLG
AMBLSR   EQU   AMBAFLG
@NM00059 EQU   AMBAFLG
AMBUPLH  EQU   IDAAMB+80
AMBPAMBL EQU   IDAAMB+76
AMBPIXP  EQU   IDAAMB+72
@NM00058 EQU   IDAAMB+68
AMBIWA   EQU   IDAAMB+64
AMBWKA   EQU   IDAAMB+60
AMBAMBXN EQU   AMBEOVPT
AMBEDB   EQU   IDAAMB+52
AMBRPT   EQU   IDAAMB+50
AMBPUG   EQU   AMBFLG2
AMBBUSY  EQU   AMBOFLGS
AMBEXFG  EQU   AMBOFLGS
@NM00057 EQU   AMBOFLGS
AMBOPEN  EQU   AMBOFLGS
@NM00056 EQU   AMBOFLGS
AMBDEBAD EQU   AMBDEBPT+1
AMBIFLGS EQU   AMBDEBPT
AMBAMETH EQU   IDAAMB+43
AMBUPX   EQU   AMBINFL
AMBUCRA  EQU   AMBINFL
AMBSCRA  EQU   AMBINFL
AMBCAT   EQU   AMBINFL
@NM00055 EQU   AMBINFL
@NM00054 EQU   AMBINFL
AMBTIOT  EQU   IDAAMB+40
@NM00053 EQU   IDAAMB+38
AMBDDSN  EQU   IDAAMB+35
AMBCDSN  EQU   IDAAMB+32
AMBIOMB  EQU   AMBIOBAD
@NM00052 EQU   AMBDSORG+1
AMBDORGA EQU   AMBDSORG+1
@NM00051 EQU   AMBDSORG
AMBINBUF EQU   AMBFLG1
AMBJRN   EQU   AMBFLG1
AMBUBF   EQU   AMBFLG1
AMBSPEED EQU   AMBFLG1
AMBPCAT  EQU   AMBFLG1
AMBMCAT  EQU   AMBFLG1
AMBTYPE  EQU   AMBFLG1
@NM00050 EQU   AMBFLG0
AMBPSDS  EQU   AMBFLG0
AMBCACB  EQU   IDAAMB+16
AMBPH    EQU   IDAAMB+12
AMBBUFC  EQU   IDAAMB+8
AMBLINK  EQU   IDAAMB+4
AMBLEN   EQU   IDAAMB+2
AMBRSC   EQU   IDAAMB+1
AMBID    EQU   IDAAMB
AMBLCMB  EQU   IDAAMBL+64
AMBLBIB  EQU   IDAAMBL+60
AMBLMIDS EQU   IDAAMBL+42
AMBLNIDS EQU   IDAAMBL+41
@NM00049 EQU   IDAAMBL+40
AMBLNUM  EQU   IDAAMBL+38
AMBLNST  EQU   IDAAMBL+37
@NM00048 EQU   AMBLFLG2
AMBLSTAG EQU   AMBLFLG2
@NM00047 EQU   AMBLFLG2
AMBLDUMY EQU   AMBLFLG1
AMBLCAT  EQU   AMBLFLG1
AMBLUCRA EQU   AMBLFLG1
AMBLSCRA EQU   AMBLFLG1
AMBLVVIC EQU   AMBLFLG1
AMBLUPD  EQU   AMBLFLG1
AMBLCINV EQU   AMBLFLG1
AMBLFULL EQU   AMBLFLG1
AMBLLEN  EQU   IDAAMBL+34
@NM00046 EQU   AMBLSHAR
AMBLWRIT EQU   AMBLSHAR
AMBLCATO EQU   AMBLSHAR
AMBLPRIM EQU   AMBLSHAR
AMBLID   EQU   IDAAMBL+32
@NM00045 EQU   IDAAMBL+31
@NM00044 EQU   AMBLTYPE
AMBLFIX  EQU   AMBLTYPE
AMBLBASE EQU   AMBLTYPE
AMBLAIX  EQU   AMBLTYPE
AMBLUPGR EQU   AMBLTYPE
AMBLPATH EQU   AMBLTYPE
AMBLENO  EQU   AMBLVC+1
AMBLVRT  EQU   AMBLVC
AMBLXPT  EQU   IDAAMBL+24
AMBLDFR  EQU   AMBLQ
AMBLESDS EQU   AMBLQ
AMBLKSDS EQU   AMBLQ
AMBLUBF  EQU   AMBLQ
AMBLFSTP EQU   AMBLQ
AMBLLSR  EQU   AMBLQ
AMBLGSR  EQU   AMBLQ
AMBLDDC  EQU   AMBLQ
AMBLDCI  EQU   AMBLIDF+4
AMBLCACB EQU   AMBLIDF
@NM00043 EQU   AMBLEOV+2
AMBLCOMP EQU   AMBLEOV+1
AMBLESET EQU   AMBLEFLG
AMBLWAIT EQU   AMBLEFLG
AMBLACB  EQU   IDAAMBL+8
AMBLSCHN EQU   IDAAMBL+4
AMBLPCHN EQU   IDAAMBL
ACBAPID  EQU   ACBCOMN+72
ACBCBMWA EQU   ACBCOMN+68
ACBLRECL EQU   ACBCOMN+62
ACBMSGLN EQU   ACBBLKSZ
ACBBUFSP EQU   ACBCOMN+56
@NM00042 EQU   ACBUJFCB+1
ACBOPTN  EQU   ACBUJFCB
ACBUCRA  EQU   ACBINFLG
ACBSCRA  EQU   ACBINFLG
ACBIJRQE EQU   ACBINFLG
ACBJEPS  EQU   ACBINFLG
@NM00041 EQU   ACBINFLG
ACBBUSY  EQU   ACBIOSFG
ACBLOCK  EQU   ACBEXFG
@NM00040 EQU   ACBOFLGS
ACBDSERR EQU   ACBOFLGS
ACBEOV   EQU   ACBOFLGS
@NM00039 EQU   ACBOFLGS
ACBDEB   EQU   ACBDDNM+5
ACBERFL  EQU   ACBDDNM+4
ACBAM    EQU   ACBAMETH
ACBINFL  EQU   ACBDDNM+2
ACBTIOT  EQU   ACBDDNM
ACBUEL   EQU   ACBEXLST
ACBPASSW EQU   ACBCOMN+32
ACBMSGAR EQU   ACBCOMN+28
@NM00038 EQU   ACBDSORG+1
ACBDORGA EQU   ACBDSORG+1
@NM00037 EQU   ACBDSORG
ACBCRNRE EQU   ACBCROPS
ACBCRNCK EQU   ACBCROPS
ACBASA   EQU   ACBCCTYP
@NM00036 EQU   ACBCCTYP
ACBRECAF EQU   ACBRECFM
ACBJBUF  EQU   ACBBUFPL+2
ACBMACR4 EQU   ACBBUFPL+1
@NM00035 EQU   ACBMACR3
ACBNCFX  EQU   ACBMACR3
ACBSIS   EQU   ACBMACR3
ACBDFR   EQU   ACBMACR3
ACBICI   EQU   ACBMACR3
ACBGSR   EQU   ACBMACR3
ACBLSR   EQU   ACBMACR3
@NM00034 EQU   ACBMACR3
ACBBUFNI EQU   ACBCOMN+18
ACBBUFND EQU   ACBCOMN+16
ACBSTRNO EQU   ACBCOMN+15
ACBBSTNO EQU   ACBCOMN+14
ACBAIX   EQU   ACBMACR2
ACBDSN   EQU   ACBMACR2
ACBRST   EQU   ACBMACR2
ACBLOGON EQU   ACBMACR2
ACBSKP   EQU   ACBMACR2
@NM00033 EQU   ACBMACR2
ACBUBF   EQU   ACBMACR1
ACBOUT   EQU   ACBMACR1
ACBIN    EQU   ACBMACR1
ACBDIR   EQU   ACBMACR1
ACBSEQ   EQU   ACBMACR1
ACBBLK   EQU   ACBCNV
ACBADD   EQU   ACBADR
ACBKEY   EQU   ACBMACR1
ACBINRTN EQU   ACBCOMN+8
ACBIBCT  EQU   ACBJWA
ACBLEN2  EQU   ACBLENG2
ACBSTYP  EQU   ACBCOMN+1
ACBID    EQU   ACBCOMN
@NM00032 EQU   SWAE+1
@NM00031 EQU   SWOPTION
SWRSJSCB EQU   SWOPTION
SWRSTIOT EQU   SWOPTION
SWDELETE EQU   SWOPTION
S99TUPRM EQU   S99TUFLD+2
S99TULEN EQU   S99TUFLD
S99TUNUM EQU   S99TUNIT+2
S99TUKEY EQU   S99TUNIT
S99TUPND EQU   S99TUP
ICBVLCYL EQU   ICBVLENT+6
ICBVLVID EQU   ICBVLENT
@NM00030 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00029 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
@NM00028 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
@NM00027 EQU   CPUID+150
@NM00026 EQU   CPUMAP+5
CPURES2  EQU   CPUTYPE
CPURES1  EQU   CPUTYPE
@NM00025 EQU   CPUID+13
@NM00024 EQU   NGVR+32
NGVNOVOL EQU   NGVR+30
@NM00023 EQU   NGVR+29
@NM00022 EQU   NGVR+15
NGVRES2  EQU   NGVRTYPE+1
NGVRES1  EQU   NGVRTYPE
NGVNAME  EQU   NGVR
GVSEXPDT EQU   GVSSLOTS+14
@NM00021 EQU   GVSVOLFL+2
@NM00020 EQU   GVSHDR+20
@NM00019 EQU   GVSHDR+17
@NM00018 EQU   GVSFLAGA+2
@NM00017 EQU   GVSTYPE
GVSGVSEX EQU   GVSTYPE
@NM00016 EQU   GVSTYPE
GVSNO    EQU   GVSID+1
GVSRES1  EQU   GVSID
GVSG     EQU   GVSNAME
@NM00015 EQU   GROUP+136
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GRONINAC EQU   GROUP+34
GRONRSTD EQU   GROUP+32
GRONGEN  EQU   GROUP+30
GROPCENT EQU   GROUP+29
@NM00014 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GROBIND  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROZERO  EQU   GROID+1
GROG     EQU   GRONAME
@NM00013 EQU   PURGFLG
PURGMPP  EQU   PURGFLG
@NM00012 EQU   LSTPAIR+5
@NM00011 EQU   INITVVI+16
@NM00010 EQU   INIFLAGB
@NM00009 EQU   INIFLAGA
INILNGTH EQU   INITVVI
@NM00008 EQU   RPLVSAM+44
@NM00007 EQU   RPLVOPT
@NM00006 EQU   RPLVOPT
@NM00005 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00004 EQU   RPLVSAM+3
@NM00003 EQU   RPLVSAM
@NM00002 EQU   RPLV+42
RPLRMSCC EQU   RPLV+36
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLVVOP  EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIVBSTF EQU   VVICB+100
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIOPCD  EQU   VVICB+36
VVIECB1  EQU   VVICB+28
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVICID   EQU   VVICB
ICBLORD  EQU   ICBTRACE+256
ICBOTRC  EQU   ICBTRACE
ICBRESV  EQU   ICB2SSCB+128
ICBRESVD EQU   ICB2SSCB+117
ICBFAB   EQU   ICB2SSCB+108
ICBMSSC  EQU   ICB2SSCB+104
ICBRSVP  EQU   ICB2SSCB+100
ICBAEAP  EQU   ICB2SSCB+96
ICBSIOBP EQU   ICB2SSCB+92
ICBIATNA EQU   ICB2SSCB+88
ICBIPRGA EQU   ICB2SSCB+84
ICBSRBP  EQU   ICB2SSCB+80
ICBSIOP  EQU   ICB2SSCB+68
ICBMEP   EQU   ICB2SSCB+64
ICBIORCI EQU   ICB2SSCB+60
ICB2ACTP EQU   ICB2SSCB+56
ICBFG3   EQU   ICBFLG+2
ICBFG2   EQU   ICBFLG+1
@NM00001 EQU   ICBFG1
ICBMSCA  EQU   ICBFG1
ICBMSCMP EQU   ICBFG1
ICBS     EQU   ICBFG1
ICBB     EQU   ICBFG1
ICBR     EQU   ICBFG1
ICBI     EQU   ICBFG1
ICBNVT   EQU   ICBOPT
ICBVN02P EQU   ICB2SSCB+44
ICBTCB   EQU   ICB2SSCB+40
ICBQHEAD EQU   ICB2SSCB+36
ICBAUCB  EQU   ICB2SSCB+32
ICBPUCB  EQU   ICB2SSCB+28
ICBCOMQ  EQU   ICB2SSCB+24
ICBIOR   EQU   ICB2SSCB+20
ICBCOM   EQU   ICB2SSCB+16
ICBACTV  EQU   ICB2SSCB+12
ICBECB   EQU   ICB2SSCB+8
ICBSSNAM EQU   ICB2SSCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00462 EQU   @EL00002
@RF00470 EQU   @EL00002
@RC00683 EQU   @RC00681
@RF00719 EQU   @RC00561
@RC00733 EQU   @EL00003
@RF00756 EQU   @EL00005
@RF00829 EQU   @EL00006
@RF00876 EQU   @EL00007
@RC00926 EQU   @EL00008
@RT01434 EQU   @EL00015
@RC01444 EQU   @EL00015
@RC01470 EQU   @EL00015
@RF01640 EQU   @EL00016
@RF01659 EQU   @EL00017
@RF01683 EQU   @EL00018
@RC01805 EQU   @EL00020
@RF01888 EQU   @EL00025
@RF01916 EQU   @EL00026
@RF02002 EQU   @EL00026
@RF02085 EQU   @EL00027
@RF00695 EQU   @RC00683
@RF00928 EQU   @RC00926
@ENDDATA EQU   *
         END   ICBVIN00,(C'PLS1906',0701,77353)

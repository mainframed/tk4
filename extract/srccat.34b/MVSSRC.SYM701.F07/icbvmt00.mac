         TITLE 'ICBVMT00 MSVC MOUNT SERVICE MODULE - MVS               *
                        '
ICBVMT00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBVMT00  78.158'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                                  0211
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION OF VARIABLES                           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0211
*   RPLVPTR=REG1;                   /* SET RPLV BASE         @Y30LB11*/
         LR    RPLVPTR,REG1                                        0211
*   VVIPTR=RPLVVICB;                /* BASE MSVC CB          @Y30LB11*/
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0212
*   JPTRFX=ADDR(RPLVUTIL)+          /* SET BASE FOR          @Y30LB11*/
*       LENGTH(ICBMTLST);           /* JFCB LIST             @Y30LB11*/
         LA    @14,RPLVUTIL(,RPLVPTR)                              0213
         AL    @14,@CF00901                                        0213
         ST    @14,JPTRFX                                          0213
*   MSGRQ=''B;                      /* ZERO MACRO LIST       @Y30LB11*/
         XC    MSGRQ(32),MSGRQ                                     0214
*   MSGRPLV=RPLVPTR;                /* MSVC RPLV ADDR        @Y30LB11*/
         ST    RPLVPTR,MSGRPLV                                     0215
*   Z5=''B;                         /* ZERO 5 CHARACTERS     @Y30LB11*/
         XC    Z5(5),Z5                                            0216
*   RCUNPACK(3:4)=RPLRCODE;         /* SAVE REASON CODE      @VS32876*/
         MVC   RCUNPACK+2(2),RPLRCODE(RPLVPTR)                     0217
*   VUAUNPCK(3:4)=MDVUA;            /* SAVE VUA ADDRESS      @ZA09516*/
         MVC   VUAUNPCK+2(2),MDVUA+132(RPLVPTR)                    0218
*   SAVRETC=Z2;                     /* ZERO RETURN CODE      @Y30LB11*/
         MVC   SAVRETC(2),Z2                                       0219
*   SAVRCODE=R000;                  /* ZERO REASON CODE      @Y30LB11*/
         MVC   SAVRCODE(2),@CB00170                                0220
*   SAVGRPCD=R000;                  /* ZERO REASON CODE      @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00170                                0221
*   ARGNUM=0;                       /* ZERO GROUP ARGUMENT   @Y30LB11*/
         MVI   ARGNUM,X'00'                                        0222
*   DLMTD=CVTDATE;                  /* SAVE DATE             @Y30LB11*/
         L     @14,CVTPTR                                          0223
         MVC   DLMTD(4),CVTDATE(@14)                               0223
*   DLMTD=DLMTD&FC;                 /* SIGN DATE             @VS34306*/
         NC    DLMTD(4),@CB00106                                   0224
*   GXPDTOLD=FOX;                   /* NULL OLD EXP DATE     @ZA17172*/
         MVC   GXPDTOLD(4),FOX                                     0225
*   SWITCHES=''B;                   /* ZERO SWITCH AT ENTRY  @ZA17172*/
         MVI   SWITCHES,X'00'                                      0226
*                                                                  0227
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MSC MOUNT SUCESSFUL THEN RETURN                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0227
*   IF RPLFTIME=ON&                 /* SECOND CALL           @Y30LB11*/
*       RPLVRETC=Z2 THEN            /* MOUNT SUCESSFUL?      @Y30LB11*/
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0227
         BNO   @RF00227                                            0227
         CLC   RPLVRETC(2,RPLVPTR),Z2                              0227
         BNE   @RF00227                                            0227
*     DO;                           /* YES                   @Y30LB11*/
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0229
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0230
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/
@EL00001 L     @13,4(,@13)                                         0231
@EF00001 DS    0H                                                  0231
@ER00001 LM    @14,@12,12(@13)                                     0231
         BR    @14                                                 0231
*     END;                          /*                       @Y30LB11*/
*                                                                  0232
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MSVC IS DISABLED THEN RETURN                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   IF VVIFLG0=ON THEN              /* MSVC DISABLED?        @Y30LB11*/
@RF00227 TM    VVIFLG0(VVIPTR),B'10000000'                         0233
         BNO   @RF00233                                            0233
*     DO;                           /* YES                   @Y30LB11*/
*       IF MDSRTCH=ON THEN          /* MOUNT NON-SPECIFIC?   @Y30LB11*/
         TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0235
         BNO   @RF00235                                            0235
*         DO;                       /* YES                   @Y30LB11*/
*           RPLVRETC=FOUR;          /* SET BAD RC            @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0237
*           RPLRCODE=R213;          /* MSVC IS DISABLED      @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00174                        0238
*         END;                      /*                       @Y30LB11*/
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/
         B     @EL00001                                            0240
*     END;                          /*                       @Y30LB11*/
*                                                                  0241
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE THE MSVC INVENTORY EXCLUSIVELY                #Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0242
*   REG0=1;                         /* MSVC EXCLUSIVE        @Y30LB11*/
@RF00233 LA    REG0,1                                              0242
*   REG1=RPLVPTR;                   /* RPLV ADDRESS          @Y30LB11*/
         LR    REG1,RPLVPTR                                        0243
*   CALL ICBVRR00;                  /* RESERVE MSVC INVENTRY @Y30LB11*/
         L     @15,@CV00248                                        0244
         BALR  @14,@15                                             0244
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @ZM31134*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0245
*   RPLVDIR=ON;                     /* READ DIRECT           @ZM31134*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0246
*                                                                  0247
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION OF CODE PICKS THE CPU ASSOCIATION BIT MASK       */
*   /* CORRESPONDING TO THE HOST. IF THE MASK IN THE MSVC CONTROL    */
*   /* BLOCK DOES NOT CORRESPOND TO THE HOST OR IS ZERO, THEN THE    */
*   /* CPUID RECORD IS READ AND THE MASK ASSOCIATED WITH THE HOST IS */
*   /* USED.                                                 @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   CPU=Z2;                         /* ZERO CPU VARIABLE     @Y30LB11*/
         MVC   CPU(2),Z2                                           0247
*   IF ICBCPUID=MDHOST×             /* IF CPUID = HOST OR    @G24LB05*/
*       MDHOST=Z5 THEN              /* MDHOST = ZERO         @Y30LB11*/
         L     @14,CVTPTR                                          0248
         L     @14,CVTEXT2(,@14)                                   0248
         L     @14,CVTICB(,@14)                                    0248
         LA    @09,132                                             0248
         ALR   @09,RPLVPTR                                         0248
         CLC   ICBCPUID(5,@14),MDHOST(@09)                         0248
         BE    @RT00248                                            0248
         CLC   MDHOST(5,@09),Z5                                    0248
         BNE   @RF00248                                            0248
@RT00248 DS    0H                                                  0249
*     CPU=VVICPUID;                 /* SET CPU ASSOC MASK    @Y30LB11*/
         MVC   CPU(2),VVICPUID(VVIPTR)                             0249
*   ELSE                            /* OTHERWISE             @Y30LB11*/
*     DO;                           /* SET CPUID ASSOC MASK  @Y30LB11*/
         B     @RC00248                                            0250
@RF00248 DS    0H                                                  0251
*       RPLVLOC=ON;                 /* LOCATE MODE           @Y30LB11*/
         OI    RPLVLOC(RPLVPTR),B'10000000'                        0251
*       RPLVKEY=ADDR(ARGCPU);       /* ADDR CPU ID KEY       @Y30LB11*/
         LA    @14,ARGCPU                                          0252
         ST    @14,RPLVKEY(,RPLVPTR)                               0252
*       MSGID=M410;                 /* CPUID RECORD NOT READ @Y30LB11*/
         MVC   MSGID(4),@CF00156                                   0253
*       CALL COMONRTN;              /* GET CPUID RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0254
*       IF RETCOD=0 THEN            /* RECORD GOTTEN?        @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0255
         BNZ   @RF00255                                            0255
*         DO;                       /* YES                   @Y30LB11*/
*           DO I=1 TO 16;           /* SEARCH THRU CPUID     @Y30LB11*/
         LA    @14,1                                               0257
         STH   @14,I                                               0257
@DL00257 DS    0H                                                  0258
*             IF MDHOST=CPUIDREC(I) THEN/* HOST/CPUID =?     @Y30LB11*/
         SLA   @14,3                                               0258
         L     @09,CPUIDPTR(,RPLVPTR)                              0258
         ST    @14,@TF00001                                        0258
         ALR   @14,@09                                             0258
         CLC   MDHOST+132(5,RPLVPTR),CPUIDREC-8(@14)               0258
         BNE   @RF00258                                            0258
*               CPU=CPUMASK(I);     /* SET CPUID MASK        @Y30LB11*/
         AL    @09,@TF00001                                        0259
         MVC   CPU(2),CPUMASK-8(@09)                               0259
*           END;                    /*                       @Y30LB11*/
@RF00258 LA    @14,1                                               0260
         AH    @14,I                                               0260
         STH   @14,I                                               0260
         C     @14,@CF00100                                        0260
         BNH   @DL00257                                            0260
*         END;                      /*                       @Y30LB11*/
*       RPLVLOC=OFF;                /* MOVE MODE RESTORED    @Y30LB11*/
@RF00255 NI    RPLVLOC(RPLVPTR),B'01111111'                        0262
*     END;                          /*                       @Y30LB11*/
*                                                                  0263
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION OF CODE INSURES THAT A CPUID ASSOCIATION MASK HAS*/
*   /* BEEN SET PROPERLY. NOTICE THAT IN MOUNT NON- SPECIFIC CASES A */
*   /* BAD RETURN AND REASON CODE IS PASSED.                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*   IF CPU=Z2 THEN                  /* CPUID FOUND?          @Y30LB11*/
@RC00248 CLC   CPU(2),Z2                                           0264
         BNE   @RF00264                                            0264
*     DO;                           /* NO                    @Y30LB11*/
*       MSGID=M404;                 /* CPUID MSG             @Y30LB11*/
         MVC   MSGID(4),@CF00152                                   0266
*       REG1=ADDR(MSGRQ);           /* REG1 PARM             @Y30LB11*/
         LA    REG1,MSGRQ                                          0267
*       CALL ICBVOP00;              /* OPER/LIB ROUTINE      @Y30LB11*/
         L     @15,@CV00250                                        0268
         BALR  @14,@15                                             0268
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0269
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0270
*       IF MDSRTCH=ON THEN          /* MOUNT NON-SPECIFIC?   @Y30LB11*/
         TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0271
         BNO   @RF00271                                            0271
*         DO;                       /* SET REASON & RC CODES @Y30LB11*/
*           RPLRCODE=R22B;          /* ID NOT IN CPUID       @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00176                        0273
*           RPLVRETC=FOUR;          /* BAD RETURN            @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0274
*         END;                      /*                       @Y30LB11*/
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/
         B     @EL00001                                            0276
*     END;                          /*                       @Y30LB11*/
*                                                                  0278
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MOUNT SPECIFIC.                               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*   IF MDSRTCH=OFF THEN             /* MOUNT SPECIFIC?       @Y30LB11*/
@RF00264 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0278
         BNZ   @RF00278                                            0278
*     DO;                           /* YES                   @Y30LB11*/
*                                                                  0279
*       /*************************************************************/
*       /*                                                           */
*       /* MOUNT SPECIFIC FAILURE, SECOND CALL               @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0280
*       IF RPLFTIME=ON THEN         /* SECOND CALL           @Y30LB11*/
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0280
         BNO   @RF00280                                            0280
*         DO;                       /* YES                   @Y30LB11*/
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  @Y30LB11*/
         BAL   @14,MNTRSTR                                         0282
*           RPLVRETC=Z2;            /* GOOD RETURN CODE      @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0283
*           RPLRCODE=R000;          /* GOOD REASON CODE      @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0284
*           RETURN;                 /* RETURN TO ICBVCR00    @Y30LB11*/
         B     @EL00001                                            0285
*         END;                      /*                       @Y30LB11*/
*                                                                  0287
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS MOUNT SPECIFIC, FIRST CALL.               @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0287
*                                                                  0287
*       /*************************************************************/
*       /*                                                           */
*       /* THE BASE VOLUME IS READ TO UPDATE THE MOUNT STATUS. IF AN */
*       /* ERROR OCCURS IN ICBVIO00, AN ERROR MESSAGE IS SENT TO THE */
*       /* LIBRARIAN, AND PROCESSING IS TERMINATED.          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0287
*       ARGVOL=MDVOL;               /* KEY VOLUME RECORD     @Y30LB11*/
@RF00280 LA    @14,132                                             0287
         ALR   @14,RPLVPTR                                         0287
         MVC   ARGVOL(6),MDVOL(@14)                                0287
*       MSGTEXT1=ADDR(MDVOL);       /* INSERT TEXT           @Y30LB11*/
         LA    @14,MDVOL(,@14)                                     0288
         STCM  @14,7,MSGTEXT1                                      0288
*       MSGLEN1=SIX;                /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'06'                                       0289
*       MSGID=M402;                 /* BASEV NOT FOUND       @Y30LB11*/
         MVC   MSGID(4),@CF00150                                   0290
*       RPLVKEY=ADDR(ARGV);         /* ADDR OF VOLUME KEY    @Y30LB11*/
         LA    @14,ARGV                                            0291
         ST    @14,RPLVKEY(,RPLVPTR)                               0291
*       RPLVUPD=ON;                 /* UPDATE RECORD         @Y30LB11*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0292
*       CALL COMONRTN;              /* GET BASEV RECORD      @Y30LB11*/
*                                                                  0293
         BAL   @14,COMONRTN                                        0293
*       /*************************************************************/
*       /*                                                           */
*       /* IF I/O SUCESSFUL, UPDATE THE BASE VOLUME RECORD, AND IF   */
*       /* THE VOLUME IS A GENERAL USE TYPE THE GVSNE RECORD IS      */
*       /* UPDATED.                                          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0294
*       IF RETCOD=0 THEN            /* SUCCESSFUL I/O        @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0294
         BNZ   @RF00294                                            0294
*         DO;                       /* YES                   @Y30LB11*/
*           BASCPUID=BASCPUID×CPU;  /* SET CPUID MASK        @Y30LB11*/
         L     @14,BASEVPTR(,RPLVPTR)                              0296
         OC    BASCPUID(2,@14),CPU                                 0296
*           BASDLMTD=DLMTD;         /* UPDATE TIME IN RECORD @Y30LB11*/
         MVC   BASDLMTD(4,@14),DLMTD                               0297
*           BASXPDT2=BASEXPDT;      /* SAVE OLD EXP DATE     @ZA17172*/
         L     @04,BASEXPDT(,@14)                                  0298
         ST    @04,BASXPDT2                                        0298
*           GXPDTOLD=BASEXPDT;      /* SAVE OLD EXP DATE     @ZA17172*/
         MVC   GXPDTOLD(4),BASEXPDT(@14)                           0299
*           RPLVTYP=RPLVPUT;        /* SET VIO PUT SW ON     @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0300
*           CALL COMONRTN;          /* PUT BASE VOL RECORD   @Y30LB11*/
         BAL   @14,COMONRTN                                        0301
*           IF BASGENUS=ON THEN     /* GENERAL USE TYPE?     @Y30LB11*/
         L     @14,BASEVPTR(,RPLVPTR)                              0302
         TM    BASGENUS(@14),B'00010000'                           0302
         BNO   @RF00302                                            0302
*             DO;                   /* YES                   @Y30LB11*/
*               ARGGP=BASGROUP;     /* SET GVSNE KEY         @Y30LB11*/
         MVC   ARGGP(8),BASGROUP(@14)                              0304
*               ARGNUM=1;           /* SET GVSNE INDEX       @Y30LB11*/
         MVI   ARGNUM,X'01'                                        0305
*               SCRTCHSW=OFF;       /* INDICATE GVSNE UPDATE @Y30LB11*/
*               RSTRSW=OFF;         /* NOT RESTORATION       @Y30LB11*/
         NI    SCRTCHSW,B'10011111'                                0307
*               CALL GVSRECRD;      /* UPDATE GVSNE RECORD   @Y30LB11*/
         BAL   @14,GVSRECRD                                        0308
*             END;                  /*                       @Y30LB11*/
*         END;                      /*                       @Y30LB11*/
@RF00302 DS    0H                                                  0311
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/
@RF00294 MVC   RPLVRETC(2,RPLVPTR),Z2                              0311
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0312
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/
         B     @EL00001                                            0313
*     END;                          /*                       @Y30LB11*/
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MOUNT NON-SPECIFIC                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* MOUNT NON-SPECIFIC FAILURE, SECOND CALL               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   IF RPLFTIME=ON THEN             /* SECOND CALL           @Y30LB11*/
@RF00278 TM    RPLFTIME(RPLVPTR),B'10000000'                       0315
         BNO   @RF00315                                            0315
*     DO;                           /* YES                   @Y30LB11*/
*       IF RCUNPACK(3:4)=RJES       /* IS THIS A JES3 REJECT ?     0317
*                                                            @G18MB04*/
*         THEN                                                     0317
         CLC   RCUNPACK+2(2),@CB00192                              0317
         BNE   @RF00317                                            0317
*         DO;                       /* YES, SET UP FOR THAT MESSAGE
*                                                            @G18MB04*/
*           MSGID=M479;             /* MESSAGE ID            @G18MB04*/
         MVC   MSGID(4),@CF00164                                   0319
*           MSGLEN1=SIX;            /* VOLID LENGTH          @G18MB04*/
         MVI   MSGLEN1,X'06'                                       0320
*           MSGTEXT1=ADDR(MDVOL);   /* VOLID REJECTED        @G18MB04*/
         LA    @14,MDVOL+132(,RPLVPTR)                             0321
         STCM  @14,7,MSGTEXT1                                      0321
*           REG1=ADDR(MSGRQ);       /* POINT REG1 TO REQUEST @G18MB04*/
         LA    REG1,MSGRQ                                          0322
*           CALL ICBVOP00;          /* CALL OPER/LIB COMM    @G18MB04*/
         L     @15,@CV00250                                        0323
         BALR  @14,@15                                             0323
*           MSGRQ=''B;              /* ZERO REQUEST BLOCK    @G18MB04*/
         XC    MSGRQ(32),MSGRQ                                     0324
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G18MB04*/
         ST    RPLVPTR,MSGRPLV                                     0325
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  @G18MB04*/
         BAL   @14,MNTRSTR                                         0326
*           RPLVDIR=ON;             /* READ DIRECT           @G18MB04*/
*           RPLVNEXT=OFF;           /* READ EXACT KEY        @G18MB04*/
*           RPLVKGE=OFF;            /* KEY >= OFF            @G18MB04*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0329
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0329
*         END;                      /*                       @G18MB04*/
*       ELSE                                                       0331
*         DO;                       /*                       @G18MB04*/
         B     @RC00317                                            0331
@RF00317 DS    0H                                                  0332
*           MSGID=M473;             /* MESSAGE ID            @VS32876*/
         MVC   MSGID(4),@CF00162                                   0332
*           MSGLEN1=3;              /* VUA LENGTH            @OX10810*/
         MVI   MSGLEN1,X'03'                                       0333
*           MSGTEXT1=ADDR(WRKVUA);  /* VUA ADDRESS           @OX10810*/
         LA    @14,WRKVUA                                          0334
         STCM  @14,7,MSGTEXT1                                      0334
*           MSGTEXT1=MSGTEXT1+1;    /* GET 3 DIGIT VUA       @OX10810*/
         LA    @14,1(,@14)                                         0335
         STCM  @14,7,MSGTEXT1                                      0335
*           MSGLEN2=SIX;            /* VOLID LENGTH          @OX10810*/
         MVI   MSGLEN2,X'06'                                       0336
*           MSGTEXT2=ADDR(MDVOL);   /* VOLID                 @OX10810*/
         LA    @14,MDVOL+132(,RPLVPTR)                             0337
         STCM  @14,7,MSGTEXT2                                      0337
*           MSGLEN3=4;              /* MSC CODE LENGTH       @OX10810*/
         MVI   MSGLEN3,X'04'                                       0338
*           MSGTEXT3=ADDR(WORK1);   /* MSC CODE              @OX10810*/
         LA    @14,WORK1                                           0339
         STCM  @14,7,MSGTEXT3                                      0339
*           VUAUNPCK(5:5)=SIGN;     /* SIGN FOR UNPACK       @OX10810*/
         MVC   VUAUNPCK+4(1),SIGN                                  0340
*           GEN(UNPK  WRKVUA(5),VUAUNPCK+2(3));/* UNPACK     @OX10810*/
         UNPK  WRKVUA(5),VUAUNPCK+2(3)
*           GEN(TR    WRKVUA(4),TRANS-240);/* TRANSLATE      @OX10810*/
         TR    WRKVUA(4),TRANS-240
*           RCUNPACK(5:5)=SIGN;     /* SIGN FOR UNPACK       @VS32876*/
         MVC   RCUNPACK+4(1),SIGN                                  0343
*           GEN(UNPK WORK1(5),RCUNPACK+2(3));/* UNPACK       @VS32892*/
         UNPK WORK1(5),RCUNPACK+2(3)
*           GEN(TR WORK1(4),TRANS-240);/* TRANSLATE          @VS32892*/
         TR WORK1(4),TRANS-240
*           REG1=ADDR(MSGRQ);       /* POINT REG1 TO REQUEST         */
         LA    REG1,MSGRQ                                          0346
*           CALL ICBVOP00;          /* CALL OPER/LIB COMM    @VS32876*/
         L     @15,@CV00250                                        0347
         BALR  @14,@15                                             0347
*           MSGRQ=''B;              /* ZERO REQUEST BLOCK    @VS32876*/
         XC    MSGRQ(32),MSGRQ                                     0348
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @VS32876*/
         ST    RPLVPTR,MSGRPLV                                     0349
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  #Y30LB11*/
         BAL   @14,MNTRSTR                                         0350
*           RPLVDIR=ON;             /* READ DIRECT           #Y30LB11*/
*           RPLVNEXT=OFF;           /* READ EXACT KEY        #Y30LB11*/
*           RPLVKGE=OFF;            /* KEY >= OFF            #Y30LB11*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0353
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0353
*           IF RPLRMSCC<=MSCRC04×   /* IS VUA USE            @ZA27804*/
*               RPLRMSCC=MSCRC0B×   /*                       @ZA27804*/
*               RPLRMSCC=>MSCRCF0 THEN/*                     @ZA27804*/
         CLC   RPLRMSCC(2,RPLVPTR),MSCRC04                         0354
         BNH   @RT00354                                            0354
         CLC   RPLRMSCC(2,RPLVPTR),MSCRC0B                         0354
         BE    @RT00354                                            0354
         CLC   RPLRMSCC(2,RPLVPTR),MSCRCF0                         0354
         BL    @RF00354                                            0354
@RT00354 DS    0H                                                  0355
*             DO;                   /* YES                   @ZA09516*/
*               RPLVRETC=FOUR;      /* SAVE RETURN CODE      @ZA09516*/
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0356
*               RPLRCODE=RPLRMSCC;  /* SAVE REASON CODE      @ZA11667*/
         MVC   RPLRCODE(2,RPLVPTR),RPLRMSCC(RPLVPTR)               0357
*               RETURN;             /* RETURN TO ICBVCR00    @ZA09516*/
         B     @EL00001                                            0358
*             END;                  /*                       @ZA09516*/
*         END;                      /*                       @Y30LB11*/
@RF00354 DS    0H                                                  0361
*     END;                          /*                       @G18MB04*/
@RC00317 DS    0H                                                  0362
*                                                                  0362
*   /*****************************************************************/
*   /*                                                               */
*   /* MOUNT NON-SPECIFIC SELECTION OF A VOLUME              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*   ALGOSW=OFF;                     /* POSSIBLE 1ST ALGO REQ @Y30LB11*/
@RF00315 NI    ALGOSW,B'01111111'                                  0362
*   IF ALGOBIT=ON THEN              /* CHECK ALGORITHM REQ   @Y30LB11*/
         L     @14,JFCBPTR                                         0363
         TM    ALGOBIT(@14),B'10000000'                            0363
         BNO   @RF00363                                            0363
*     ALGOSW=ON;                    /* SET SWITCH            @Y30LB11*/
         OI    ALGOSW,B'10000000'                                  0364
*   CALL MTSCRTCH;                  /* CALL MT SCRATCH RTN   @Y30LB11*/
@RF00363 BAL   @14,MTSCRTCH                                        0365
*   IF RETCOD^=0&                   /* SCRATCH NOT MOUNTED?  @Y30LB11*/
*       SAVGRPCD^=R23D&             /* NOT FATAL ERROR       @G24LB04*/
*       ALGOBIT=OFF THEN            /* 1ST ALGORITHM?        @Y30LB11*/
         SLR   @14,@14                                             0366
         CR    RETCOD,@14                                          0366
         BE    @RF00366                                            0366
         CLC   SAVGRPCD(2),@CB00190                                0366
         BE    @RF00366                                            0366
         L     @04,JFCBPTR                                         0366
         TM    ALGOBIT(@04),B'10000000'                            0366
         BNZ   @RF00366                                            0366
*     DO;                           /* NO                    @Y30LB11*/
*       ALGOSW=ON;                  /* ALTERNATE ALGORITHM   @Y30LB11*/
         OI    ALGOSW,B'10000000'                                  0368
*       SAVGRPCD=R000;              /* RESET REASON CODE     @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00170                                0369
*       VOLINDEX=0;                 /* RESET VOLINDEX        @Y30LB11*/
         STH   @14,VOLINDEX                                        0370
*       CALL CALSPACE;              /* RECALIBRATE SPACE     @Y30LB11*/
         BAL   @14,CALSPACE                                        0371
*       CALL MTSCRCH2;              /* RECALL MT SCRTCH RTN  @Y30LB11*/
         BAL   @14,MTSCRCH2                                        0372
*     END;                          /*                       @Y30LB11*/
*   IF SAVGRPCD^=0 THEN             /* BAD RETURN CODE?      @Y30LB11*/
@RF00366 ICM   @14,3,SAVGRPCD                                      0374
         BZ    @RF00374                                            0374
*     DO;                           /* YES                   @Y30LB11*/
*       IF SAVGRPCD^=R23D           /* MESSAGE NOT WRITTEN   @G24LB04*/
*         THEN                                                     0376
         CLC   SAVGRPCD(2),@CB00190                                0376
         BE    @RF00376                                            0376
*         DO;                       /* WRITE MESSAGE         @G24LB04*/
*           MSGRQ=''B;              /* ZERO MACRO LIST       @Y30LB11*/
         XC    MSGRQ(32),MSGRQ                                     0378
*           MSGRPLV=RPLVPTR;        /* RESET RPLV PTR        @Y30LB11*/
         ST    RPLVPTR,MSGRPLV                                     0379
*           MSGID=M407;             /* SET MSGID             @Y30LB11*/
         MVC   MSGID(4),@CF00154                                   0380
*           MSGTEXT1=ADDR(ARGGP);   /* PARM TEXT             @Y30LB11*/
         LA    @14,ARGGP                                           0381
         STCM  @14,7,MSGTEXT1                                      0381
*           MSGLEN1=EIGHT;          /* PARM LENGTH           @Y30LB11*/
         MVI   MSGLEN1,X'08'                                       0382
*           REG1=ADDR(MSGRQ);       /* ADDR MSGRQ            @Y30LB11*/
         LA    REG1,MSGRQ                                          0383
*           CALL ICBVOP00;          /* CALL MSG ROUTINE      @Y30LB11*/
         L     @15,@CV00250                                        0384
         BALR  @14,@15                                             0384
*         END;                      /*                       @G24LB04*/
*       ELSE                                                       0386
*         ;                         /*                       @G24LB04*/
@RF00376 DS    0H                                                  0387
*       SAVRETC=FOUR;               /* SET BAD RC            @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0387
*       SAVRCODE=SAVGRPCD;          /* SET REASON CODE       @Y30LB11*/
         MVC   SAVRCODE(2),SAVGRPCD                                0388
*     END;                          /*                       @Y30LB11*/
*   ELSE                                                           0390
*     IF SAVGRETN=ON&               /* NEED TO JRNAL?        @ZA11015*/
*         GXPDTOLD=FOX THEN         /*                       @ZA11665*/
         B     @RC00374                                            0390
@RF00374 TM    SAVGRETN,B'10000000'                                0390
         BNO   @RF00390                                            0390
         CLC   GXPDTOLD(4),FOX                                     0390
         BNE   @RF00390                                            0390
*       CALL JOURNAL;               /* SET UP TO JOURNAL     @ZA11015*/
         BAL   @14,JOURNAL                                         0391
*   RPLVRETC=SAVRETC;               /* RESTORE RETURN CODE   @Y30LB11*/
@RF00390 DS    0H                                                  0392
@RC00374 MVC   RPLVRETC(2,RPLVPTR),SAVRETC                         0392
*   RPLRCODE=SAVRCODE;              /* RESTORE REASON CODE   @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),SAVRCODE                        0393
*   RETURN;                         /* RETURN TO ICBVCR00    @Y30LB11*/
         B     @EL00001                                            0394
*                                                                  0395
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0395
*01*  NAME = MNTRSTR                                         @Y30LB11
*                                                                  0395
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO RESTORE THE VOLUME   0395
*                MOUNT STATUS IF A MOUNT FAILS.              @Y30LB11
*                                                                  0395
*02*    INPUT = RPLV                                         @Y30LB11
*                                                                  0395
*02*    OUTPUT = RESTORED BASE VOLUME RECORD AND ALSO THE          0395
*                GROUP EXTENSION RECORD, IF VOLUME BELONGS TO A    0395
*                GENERAL USE GROUP.                         @Y30LB11
*                                                                  0395
**** END OF SPECIFICATIONS **                                        */
*                                                                  0395
*MNTRSTR:                                                          0395
*   PROCEDURE;                      /*                       @Y30LB11*/
MNTRSTR  STM   @14,@04,@SA00002                                    0395
         STM   @06,@12,@SA00002+28                                 0395
*   ARGVOL=MDVOL;                   /* SET VOLUME ARGUMENT   @Y30LB11*/
         LA    @14,132                                             0396
         ALR   @14,RPLVPTR                                         0396
         MVC   ARGVOL(6),MDVOL(@14)                                0396
*   RPLVUPD=ON;                     /* RESTORE BASEV         @Y30LB11*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0397
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0398
*   RPLVKEY=ADDR(ARGV);             /* ADDR OF KEY           @Y30LB11*/
         LA    @09,ARGV                                            0399
         ST    @09,RPLVKEY(,RPLVPTR)                               0399
*   RPLVKGE=OFF;                    /* READ EXACT KEY ONLY   @Y30LB11*/
         NI    RPLVKGE(RPLVPTR),B'11111011'                        0400
*   MSGTEXT1=ADDR(MDVOL);           /* INSERT TEXT           @Y30LB11*/
         LA    @14,MDVOL(,@14)                                     0401
         STCM  @14,7,MSGTEXT1                                      0401
*   MSGLEN1=SIX;                    /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'06'                                       0402
*   MSGID=M411;                     /* BASEV NOT RESTORED    @Y30LB11*/
         MVC   MSGID(4),@CF00158                                   0403
*   CALL COMONRTN;                  /* READ DIRECT           @Y30LB11*/
         BAL   @14,COMONRTN                                        0404
*   IF RETCOD^=0 THEN               /* RECORD READ?          @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0405
         BNZ   @RT00405                                            0405
*     RETURN;                       /* NO, RETURN            @Y30LB11*/
*   BASCPUID=BASCPUID&&CPU;         /* RESET CPUID MASK      @Y30LB11*/
         L     @14,BASEVPTR(,RPLVPTR)                              0407
         XC    BASCPUID(2,@14),CPU                                 0407
*   IF BASEXPDT^=BASXPDT2 THEN      /* ARE OLD AND CURRENT EQ@ZA17172*/
         L     @09,BASXPDT2                                        0408
         CL    @09,BASEXPDT(,@14)                                  0408
         BE    @RF00408                                            0408
*     DO;                           /* IF NOT EQUAL DO       @ZA17172*/
*       BASEXPDT=BASXPDT2;          /* SET EXP TO OLD DATE   @ZA17172*/
         ST    @09,BASEXPDT(,@14)                                  0410
*       JRNLFLG=ON;                 /* REMBER TO JRNL        @ZA17172*/
         OI    JRNLFLG,B'00001000'                                 0411
*     END;                          /*                       @ZA17172*/
*   GXPDTOLD=BASXPDT2;              /* RESTORE EXPDT         @ZA20327*/
@RF00408 MVC   GXPDTOLD(4),BASXPDT2                                0413
*   RPLVTYP=RPLVPUT;                /* PUT I/O ON            @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0414
*   CALL COMONRTN;                  /* RESTORE VOL RECORD    @Y30LB11*/
         BAL   @14,COMONRTN                                        0415
*   IF JRNLFLG=ON THEN              /* SHOULD JRNL BE UPDT   @ZA11665*/
         TM    JRNLFLG,B'00001000'                                 0416
         BNO   @RF00416                                            0416
*     CALL JOURNAL;                 /* UPDATE JOURNAL        @ZA11665*/
*                                                                  0417
         BAL   @14,JOURNAL                                         0417
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME IS A GENERAL USE TYPE THE GVSNE RECORD IS READ  */
*   /* TO BE RESTORED.                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0418
*   IF BASGENUS=ON THEN             /* GENERAL USE TYPE?     @Y30LB11*/
@RF00416 L     @14,BASEVPTR(,RPLVPTR)                              0418
         TM    BASGENUS(@14),B'00010000'                           0418
         BNO   @RF00418                                            0418
*     DO;                           /* YES                   @Y30LB11*/
*       ARGGP=BASGROUP;             /* SET GVSNE KEY         @Y30LB11*/
         MVC   ARGGP(8),BASGROUP(@14)                              0420
*       ARGNUM=1;                   /* GET GVSNE             @Y30LB11*/
         MVI   ARGNUM,X'01'                                        0421
*       SCRTCHSW=OFF;               /* INDICATE GVSNE UPDATE @Y30LB11*/
*       RSTRSW=ON;                  /* SET RESTORE SW ON     @Y30LB11*/
         OI    RSTRSW,B'01000000'                                  0423
         NI    SCRTCHSW,B'11011111'                                0423
*       CALL GVSRECRD;              /* UPDATE GVSNE RECORD   @Y30LB11*/
         BAL   @14,GVSRECRD                                        0424
*     END;                          /*                       @Y30LB11*/
*   END MNTRSTR;                    /*                       @Y30LB11*/
@EL00002 DS    0H                                                  0426
@EF00002 DS    0H                                                  0426
@ER00002 LM    @14,@04,@SA00002                                    0426
         LM    @06,@12,@SA00002+28                                 0426
         BR    @14                                                 0426
*                                                                  0427
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0427
*01*  NAME = MTSCRTCH                                        @Y30LB11
*                                                                  0427
*01*  FUNCTION = THIS SUBROUTINE IS CALLED WHENEVER A VOLUME       0427
*                IS TO BE SELECTED AS A CANDIDATE FOR MOUNT        0427
*                NON-SPECIFIC.                               @Y30LB11
*                                                                  0427
*02*    INPUT = UPDATE PARAMETERS                            @Y30LB11
*                                                                  0427
*02*    OUTPUT = UPDATED BASEV AND GVSNE RECORDS             @Y30LB11
*       MESSAGE (VIA ICBVOP00) WITH ANY EXPIRATION DATE      @G24LB04
*       ASSIGNED, AND VOLUME IDENTIFICATION                  @G24LB04
*                                                                  0427
**** END OF SPECIFICATIONS **                                        */
*                                                                  0427
*MTSCRTCH:                          /* MOUNT SCRATCH ROUTINE @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
MTSCRTCH STM   @14,@08,@SA00003                                    0427
         STM   @10,@12,@SA00003+44                                 0427
*   CALL FINDGRP;                   /* GET GROUP NAME        @Y30LB11*/
         BAL   @14,FINDGRP                                         0428
*   IF RETCOD^=0 THEN               /* GROUP GOTTEN?         @Y30LB11*/
         SLR   @14,@14                                             0429
         CR    RETCOD,@14                                          0429
         BE    @RF00429                                            0429
*     RETURN CODE(0);               /* NO, RETURN TO VCR     @VS32850*/
         LR    @15,@14                                             0430
         L     @14,@SA00003                                        0430
         LM    @00,@08,@SA00003+8                                  0430
         LM    @10,@12,@SA00003+44                                 0430
         BR    @14                                                 0430
*   SAVGRETN=OFF;                   /* SET SW OFF            @Y30LB11*/
@RF00429 NI    SAVGRETN,B'01111111'                                0431
*   IF GRORETN=ON THEN              /* RETENTION SPECIFIED?  @Y30LB11*/
         L     @14,GROUPPTR(,RPLVPTR)                              0432
         TM    GRORETN(@14),B'00000100'                            0432
         BNO   @RF00432                                            0432
*     DO;                           /* YES                   @Y30LB11*/
*       SAVGRETN=ON;                /* YES, SET SAVE VALUE   @Y30LB11*/
         OI    SAVGRETN,B'10000000'                                0434
*       SAVRETPD=GRORETPD;          /* SAVE VALUE            @Y30LB11*/
         L     @14,GRORETPD(,@14)                                  0435
         ST    @14,SAVRETPD                                        0435
*     END;                          /*                       @Y30LB11*/
*MTSCRCH2:                          /*                       @Y30LB11*/
*   ENTRY;                          /* ENTRY                 @Y30LB11*/
         B     @EC00437                                            0437
MTSCRCH2 STM   @14,@08,@SA00003                                    0437
         STM   @10,@12,@SA00003+44                                 0437
@EC00437 DS    0H                                                  0438
*   ARGNUM=1;                       /* GET GVSNE             @Y30LB11*/
         MVI   ARGNUM,X'01'                                        0438
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB11*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0439
*   RPLVLOC=OFF;                    /* MOVE MODE             @Y30LB11*/
*   RPLVNEXT=OFF;                   /* TURN READ NEXT OFF    @ZA13051*/
*   RPLVDIR=ON;                     /* TURN READ DIR ON      @ZA13051*/
*                                                                  0442
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0442
         NI    RPLVLOC(RPLVPTR),B'01011111'                        0442
*   /*****************************************************************/
*   /*                                                               */
*   /* GET GVSNE RECORD                                      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0443
*   DO WHILE I=I;                   /* LOOP CONDITION        @Y30LB11*/
         B     @DE00443                                            0443
@DL00443 DS    0H                                                  0444
*     SCRTCHSW=ON;                  /* INDICATE GVSNE READ   @Y30LB11*/
*     RSTRSW=OFF;                   /* NOT RESTORATION       @Y30LB11*/
         OI    SCRTCHSW,B'00100000'                                0445
         NI    RSTRSW,B'10111111'                                  0445
*     CALL GVSRECRD;                /* GET GVSNE RECORD      @Y30LB11*/
         BAL   @14,GVSRECRD                                        0446
*     IF RETCOD^=0 THEN             /* GVSNE FOUND?          @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0447
         BZ    @RF00447                                            0447
*       RETURN CODE(4);             /* RETURN CODE           @Y30LB11*/
         LA    @15,4                                               0448
         L     @14,@SA00003                                        0448
         LM    @00,@08,@SA00003+8                                  0448
         LM    @10,@12,@SA00003+44                                 0448
         BR    @14                                                 0448
*     DO I=INDEX TO LAST WHILE INDEX<=LAST;/* SEARCH SLOTS   @Y30LB11*/
@RF00447 LR    @14,INDEX                                           0449
         B     @DE00449                                            0449
@DL00449 CH    INDEX,LAST                                          0449
         BH    @DC00449                                            0449
*       WRKRETPD=SAVRETPD;          /* SET WORK VALUE        @Y30LB11*/
         L     WRKRETPD,SAVRETPD                                   0450
*       VOLINDEX=VOLINDEX+1;        /* INCREMENT INDEX       @Y30LB11*/
         LH    @06,VOLINDEX                                        0451
         LA    @06,1(,@06)                                         0451
         STH   @06,VOLINDEX                                        0451
*       GXPDTOLD=GVSEXPDT(I);       /* SAVE OLD EXP DATE     @ZA11665*/
         MH    @14,@CH00325                                        0452
         L     @06,GVSNEPTR(,RPLVPTR)                              0452
         ST    @14,@TF00001                                        0452
         ALR   @14,@06                                             0452
         MVC   GXPDTOLD(4),GVSEXPDT-20(@14)                        0452
*       IF GVSEXPDT(I)=FOX THEN     /* EXPDT SET IN GVSNE?   @VS32879*/
         AL    @06,@TF00001                                        0453
         CLC   GVSEXPDT-20(4,@06),FOX                              0453
         BNE   @RF00453                                            0453
*         GXPDT=DLMTD;              /* SET DATE              @Y30LB11*/
         MVC   GXPDT(4),DLMTD                                      0454
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         GXPDT=GVSEXPDT(I);        /* USE GVSNE EXPDT       @Y30LB11*/
         B     @RC00453                                            0455
@RF00453 LH    @14,I                                               0455
         MH    @14,@CH00325                                        0455
         L     @06,GVSNEPTR(,RPLVPTR)                              0455
         ALR   @06,@14                                             0455
         MVC   GXPDT(4),GVSEXPDT-20(@06)                           0455
*       IF SAVGRETN=ON&             /* RETENTION PERIOD?     @Y30LB11*/
*           GVSEXPDT(I)=FOX THEN    /* AND EXP SPECIFIED     @VS32879*/
@RC00453 TM    SAVGRETN,B'10000000'                                0456
         BNO   @RF00456                                            0456
         LH    @14,I                                               0456
         MH    @14,@CH00325                                        0456
         L     @06,GVSNEPTR(,RPLVPTR)                              0456
         ALR   @06,@14                                             0456
         CLC   GVSEXPDT-20(4,@06),FOX                              0456
         BNE   @RF00456                                            0456
*         DO WHILE WRKRETPD>0;      /* YES                   @Y30LB11*/
         B     @DE00457                                            0457
@DL00457 DS    0H                                                  0458
*           CVB(TEMP,GX2PDT);       /* CONVERT               @Y30LB11*/
         XC    @TS00001(8),@TS00001                                0458
         MVC   @TS00001+6(2),GX2PDT                                0458
         CVB   TEMP,@TS00001                                       0458
*           IF WRKRETPD>TSF THEN    /* RETENTION PERIOD> 365 @Y30LB11*/
         LA    @14,365                                             0459
         CR    WRKRETPD,@14                                        0459
         BNH   @RF00459                                            0459
*             DO;                   /* YES                   @Y30LB11*/
*               TEMP=TEMP+TSF;      /* INCREMENT BY 365      @Y30LB11*/
         ALR   TEMP,@14                                            0461
*               WRKRETPD=WRKRETPD-TSF;/* REDUCE RET PERIOD   @Y30LB11*/
         SLR   WRKRETPD,@14                                        0462
*             END;                  /*                       @Y30LB11*/
*           ELSE                    /* OTHERWISE             @Y30LB11*/
*             DO;                   /*                       @Y30LB11*/
         B     @RC00459                                            0464
@RF00459 DS    0H                                                  0465
*               TEMP=TEMP+WRKRETPD; /* SET TEMP              @Y30LB11*/
         ALR   TEMP,WRKRETPD                                       0465
*               WRKRETPD=0;         /* ZERO SAVRETPD         @Y30LB11*/
         SLR   WRKRETPD,WRKRETPD                                   0466
*             END;                  /*                       @Y30LB11*/
*           IF TEMP>TSF THEN        /* > 365?                @Y30LB11*/
@RC00459 LA    @14,365                                             0468
         CR    TEMP,@14                                            0468
         BNH   @RF00468                                            0468
*             DO;                   /* YES                   @Y30LB11*/
*               TEMP=TEMP-TSF;      /* REDUCE # OF DAYS      @Y30LB11*/
         SLR   TEMP,@14                                            0470
*               CVD(TEMP,GX2PDT);   /* CONVERT               @Y30LB11*/
         CVD   TEMP,@TS00001                                       0471
         MVC   GX2PDT(2),@TS00001+6                                0471
*               GENERATE REFS(GX1PDT,F);                           0472
*                                   /*                       @VS34306*/
         LH    15,GX1PDT               LOAD YEAR             @VS34306
         SLL   15,4(0)                 SHIFT FOR SIGN        @VS34306
         O     15,F                    PUT IN SIGN           @VS34306
         STH   15,GX1PDT               RESTORE YEAR          @VS34306
*               CVB(TEMP,GX1PDT);   /* CONVERT               @Y30LB11*/
         XC    @TS00001(8),@TS00001                                0473
         MVC   @TS00001+6(2),GX1PDT                                0473
         CVB   TEMP,@TS00001                                       0473
*               TEMP=TEMP+1;        /* INCREMENT YEAR BY 1   @Y30LB11*/
         AL    TEMP,@CF00112                                       0474
*               CVD(TEMP,GX1PDT);   /* CONVERT               @VS34306*/
         CVD   TEMP,@TS00001                                       0475
         MVC   GX1PDT(2),@TS00001+6                                0475
*               GENERATE REFS(GX1PDT);                             0476
*                                   /*                       @VS34306*/
         LH    15,GX1PDT               LOAD YEAR             @VS34306
         SRL   15,4(0)                 SHIFT SIGN            @Y30LB11
         STH   15,GX1PDT               RESTORE YEAR          @Y30LB11
*             END;                  /*                       @Y30LB11*/
*           ELSE                    /*                       @Y30LB11*/
*             CVD(TEMP,GX2PDT);     /* OVERLAY DATE          @Y30LB11*/
         B     @RC00468                                            0478
@RF00468 CVD   TEMP,@TS00001                                       0478
         MVC   GX2PDT(2),@TS00001+6                                0478
*           IF GXPDT>MAXIMUM THEN   /* > '0099365C'?         @Y30LB11*/
@RC00468 CLC   GXPDT(4),@CB00146                                   0479
         BNH   @RF00479                                            0479
*             GXPDT=MAXIMUM;        /* SET EQUAL             @Y30LB11*/
         MVC   GXPDT(4),@CB00146                                   0480
*         END;                      /*                       @Y30LB11*/
@RF00479 DS    0H                                                  0481
@DE00457 LTR   WRKRETPD,WRKRETPD                                   0481
         BP    @DL00457                                            0481
*       SAVCPUBM=GVSCPUBM(I);       /* SET CPUBM             @Y30LB11*/
@RF00456 LH    @14,I                                               0482
         MH    @14,@CH00325                                        0482
         L     @04,GVSNEPTR(,RPLVPTR)                              0482
         ALR   @04,@14                                             0482
         MVC   SAVCPUBM(2),GVSCPUBM-20(@04)                        0482
*       DO WHILE SAVCPUBM=Z2&       /* VOL NOT MOUNTED       @Y30LB11*/
*             GVSFRESP(I)>=FRSP&    /* ENOUGH FR SPACE?      @Y30LB11*/
*             GVSLEXT(I)>=LEXT&     /* CNTIG SPACE OK?       @Y30LB11*/
*             (GXPDT>=EXPDT×        /* IN PERIOD?            @Y30LB11*/
*             SAVGRETN=OFF);        /* NO RETENSION?         @Y30LB11*/
         B     @DE00483                                            0483
@DL00483 DS    0H                                                  0484
*         CALL JFCBCK;              /* VOLID IN JFCB?        @Y30LB11*/
         BAL   @14,JFCBCK                                          0484
*         IF RETCOD=0 THEN          /* VOL NOT EXTENDED?     @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0485
         BNZ   @RF00485                                            0485
*           CALL UCBCK;             /* CHECK UCBLIST         @Y30LB11*/
         BAL   @14,UCBCK                                           0486
*         IF RETCOD=0 THEN          /* VOLUME NOT FOUND?     @Y30LB11*/
@RF00485 LTR   RETCOD,RETCOD                                       0487
         BNZ   @RF00487                                            0487
*           DO;                     /*                       @Y30LB11*/
*             ARGVOL=GVSVOLID(I);   /* SET ARGUMENT          @Y30LB11*/
         LH    @14,I                                               0489
         MH    @14,@CH00325                                        0489
         L     @04,GVSNEPTR(,RPLVPTR)                              0489
         ST    @14,@TF00001                                        0489
         ALR   @14,@04                                             0489
         MVC   ARGVOL(6),GVSVOLID-20(@14)                          0489
*             IF GVSEXPDT(I)=FOX&   /* NO EXPIRATION DATE?   @VS32879*/
*                 SAVGRETN=ON THEN  /* AND RETENTION         @Y30LB11*/
         LR    @14,@04                                             0490
         AL    @14,@TF00001                                        0490
         CLC   GVSEXPDT-20(4,@14),FOX                              0490
         BNE   @RF00490                                            0490
         TM    SAVGRETN,B'10000000'                                0490
         BNO   @RF00490                                            0490
*               DO;                 /* SET & TRACK EXP DATE  @G24LB04*/
*                 GVSEXPDT(I)=GXPDT;/* SET GVSNE XPDT        @G24LB04*/
         AL    @04,@TF00001                                        0492
         MVC   GVSEXPDT-20(4,@04),GXPDT                            0492
*                 CALL WRITEXPD;    /* WRITE MESSAGE         @G24LB04*/
         BAL   @14,WRITEXPD                                        0493
*               END;                /*                       @G24LB04*/
*             GVSCPUBM(I)=GVSCPUBM(I)×CPU;/* SET CPU MASK    @Y30LB11*/
@RF00490 LH    @14,I                                               0495
         MH    @14,@CH00325                                        0495
         L     @04,GVSNEPTR(,RPLVPTR)                              0495
         ALR   @04,@14                                             0495
         OC    GVSCPUBM-20(2,@04),CPU                              0495
*             CALL AMVGVSUD;        /* MORE GVSNE UPDATING   @G24LB04*/
         BAL   @14,AMVGVSUD                                        0496
*             IF RETCOD^=0          /* FAILURE ?             @G24LB04*/
*               THEN                /*                       @G24LB04*/
         LTR   RETCOD,RETCOD                                       0497
         BZ    @RF00497                                            0497
*               DO;                 /*                       @G24LB04*/
*                 SAVGRPCD=R23D;    /* UCB LOOK UP FAILED    @G24LB04*/
         MVC   SAVGRPCD(2),@CB00190                                0499
*                 RETURN CODE(4);   /* REQUEST WILL FAIL     @G24LB04*/
         LA    @15,4                                               0500
         L     @14,@SA00003                                        0500
         LM    @00,@08,@SA00003+8                                  0500
         LM    @10,@12,@SA00003+44                                 0500
         BR    @14                                                 0500
*               END;                /*                       @G24LB04*/
*             RPLVTYP=RPLVPUT;      /* SET VIO WRITE SW ON   @Y30LB11*/
@RF00497 MVI   RPLVTYP(RPLVPTR),X'01'                              0502
*             CALL COMONRTN;        /* PUT RECORD            @Y30LB11*/
*                                                                  0503
         BAL   @14,COMONRTN                                        0503
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE BASE VOLUME RECORD.                  @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0504
*             RPLVNEXT=OFF;         /* READ NDIRECT          @Y30LB11*/
*             RPLVDIR=ON;           /* DIRECT SW ON          @Y30LB11*/
*             RPLVKGE=OFF;          /* EXACT KEY             @Y30LB11*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0506
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0506
*             IF RETCOD=0 THEN      /* PUT OK?               @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0507
         BNZ   @RF00507                                            0507
*               CALL BASUPDTE;      /* UPDATE VOL RECORD     @Y30LB11*/
         BAL   @14,BASUPDTE                                        0508
*             IF RETCOD=0 THEN      /* RECORD UPDATED?       @Y30LB11*/
@RF00507 LTR   RETCOD,RETCOD                                       0509
         BNZ   @RF00509                                            0509
*               DO;                 /* YES                   @Y30LB11*/
*                 JFCVINDX=VOLINDEX;/* RESET JFCVINDX > 0    @Y30LB11*/
         L     @14,JFCBPTR                                         0511
         LH    @08,VOLINDEX                                        0511
         STH   @08,JFCVINDX(,@14)                                  0511
*                 IF ALGOSW=ON THEN /* ALTERNATE ALGORITHM?  @Y30LB11*/
         TM    ALGOSW,B'10000000'                                  0512
         BNO   @RF00512                                            0512
*                   ALGOBIT=ON;     /* SET 2ND ALGORITHM     @Y30LB11*/
         OI    ALGOBIT(@14),B'10000000'                            0513
*                 RETURN CODE(0);   /* EXIT LOOP             @Y30LB11*/
@RF00512 SLR   @15,@15                                             0514
         L     @14,@SA00003                                        0514
         LM    @00,@08,@SA00003+8                                  0514
         LM    @10,@12,@SA00003+44                                 0514
         BR    @14                                                 0514
*               END;                /*                       @Y30LB11*/
*           END;                    /*                       @Y30LB11*/
@RF00509 DS    0H                                                  0517
*         SAVCPUBM=CPU;             /* END LOOP CONDITION    @Y30LB11*/
@RF00487 MVC   SAVCPUBM(2),CPU                                     0517
*       END;                        /*                       @Y30LB11*/
@DE00483 CLC   SAVCPUBM(2),Z2                                      0518
         BNE   @DC00483                                            0518
         LH    @14,I                                               0518
         MH    @14,@CH00325                                        0518
         L     @04,GVSNEPTR(,RPLVPTR)                              0518
         LH    @07,GVSFRESP-20(@14,@04)                            0518
         CH    @07,FRSP                                            0518
         BL    @DC00483                                            0518
         LH    @14,GVSLEXT-20(@14,@04)                             0518
         L     @04,LEXT-1                                          0518
         LA    @04,0(,@04)                                         0518
         CR    @14,@04                                             0518
         BL    @DC00483                                            0518
         CLC   GXPDT(4),EXPDT                                      0518
         BNL   @DL00483                                            0518
         TM    SAVGRETN,B'10000000'                                0518
         BZ    @DL00483                                            0518
@DC00483 DS    0H                                                  0519
*     END;                          /*                       @Y30LB11*/
         LA    @14,1                                               0519
         AH    @14,I                                               0519
@DE00449 STH   @14,I                                               0519
         CH    @14,LAST                                            0519
         BNH   @DL00449                                            0519
@DC00449 DS    0H                                                  0520
*     IF INDEX>LAST THEN            /* NEED ANOTHER GVSNE?   @Y30LB11*/
         LH    @14,LAST                                            0520
         CR    INDEX,@14                                           0520
         BNH   @RF00520                                            0520
*       INDEX=INDEX-LAST;           /* NO, DECREMENT         @Y30LB11*/
         SLR   INDEX,@14                                           0521
*     ELSE                          /* OTHERWISE             @Y30LB11*/
*       INDEX=1;                    /* RESET INDEX TO 1      @Y30LB11*/
         B     @RC00520                                            0522
@RF00520 LA    INDEX,1                                             0522
*     IF GVSEX=ON THEN              /* ANOTHER GVSNE?        @Y30LB11*/
@RC00520 L     @14,GVSNEPTR(,RPLVPTR)                              0523
         TM    GVSEX(@14),B'10000000'                              0523
         BNO   @RF00523                                            0523
*       DO;                         /* YES                   @Y30LB11*/
*         RPLVNEXT=ON;              /* READ NEXT             @Y30LB11*/
*         RPLVDIR=OFF;              /* READ DIRECT OFF       @Y30LB11*/
         OI    RPLVNEXT(RPLVPTR),B'00100000'                       0526
         NI    RPLVDIR(RPLVPTR),B'10111111'                        0526
*       END;                        /*                       @Y30LB11*/
*     ELSE                          /* OTHERWISE             @Y30LB11*/
*       DO;                         /*                       @Y30LB11*/
         B     @RC00523                                            0528
@RF00523 DS    0H                                                  0529
*         SAVGRPCD=R232;            /* SET GROUP CODE        @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00188                                0529
*         RETURN CODE(4);           /* RETURN TO ICBVMT00    @Y30LB11*/
         LA    @15,4                                               0530
         L     @14,@SA00003                                        0530
         LM    @00,@08,@SA00003+8                                  0530
         LM    @10,@12,@SA00003+44                                 0530
         BR    @14                                                 0530
*       END;                        /*                       @Y30LB11*/
*   END;                            /*                       @Y30LB11*/
@RC00523 DS    0H                                                  0532
@DE00443 LH    @14,I                                               0532
         CR    @14,@14                                             0532
         BE    @DL00443                                            0532
*   END MTSCRTCH;                   /*                       @Y30LB11*/
@EL00003 DS    0H                                                  0533
@EF00003 DS    0H                                                  0533
@ER00003 LM    @14,@08,@SA00003                                    0533
         LM    @10,@12,@SA00003+44                                 0533
         BR    @14                                                 0533
*                                                                  0534
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0534
*01*  NAME = FINDGRP                                         @Y30LB11
*                                                                  0534
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE FROM       0534
*                WHICH GROUP THE NON-SPECIFIC MOUNT REQUEST WILL   0534
*                USE IN SELECTING A VOLUME.                  @Y30LB11
*                                                                  0534
*02*    INPUT = NONE                                         @Y30LB11
*                                                                  0534
*02*    OUTPUT = GROUP NAME                                  @Y30LB11
*                                                                  0534
**** END OF SPECIFICATIONS **                                        */
*                                                                  0534
*FINDGRP:                           /* FINDGRP ROUTINE       @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
FINDGRP  STM   @14,@08,@SA00004                                    0534
         STM   @10,@12,@SA00004+44                                 0534
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0535
*   RPLVUPD=OFF;                    /* NOT FOR UPDATE        @Y30LB11*/
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0536
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB11*/
         OI    RPLVLOC(RPLVPTR),B'10000000'                        0537
*   JD1=JFCBDRLH;                   /* INITIALIZE JD1        @Y30LB11*/
         L     @14,JFCBPTR                                         0538
         MVC   JD1(3),JFCBDRLH(@14)                                0538
*   JP1=JFCBPQTY;                   /* INITIALIZE JP1        @Y30LB11*/
         MVC   JP1(3),JFCBPQTY(@14)                                0539
*   JS1=JFCBSQTY;                   /* INITIALIZE JS1        @Y30LB11*/
         MVC   JS1(3),JFCBSQTY(@14)                                0540
*   JFCBYD=JFCBXPDT;                /* INITIALIZE JFCBYD     @Y30LB11*/
         MVC   JFCBYD(3),JFCBXPDT(@14)                             0541
*   VOLINDEX=VINDX&OFFBIT;          /* SET VOLINDEX POSITIVE @Y30LB11*/
         L     @08,@CF00117                                        0542
         LH    @04,VINDX(,@14)                                     0542
         N     @04,@CF02120                                        0542
         NR    @08,@04                                             0542
         STH   @08,VOLINDEX                                        0542
*   INDEX=VOLINDEX+1;               /* INCREMENT BY 1        @Y30LB11*/
         AL    @08,@CF00112                                        0543
         LR    INDEX,@08                                           0543
*   NVOLINDX=NVOL;                  /* INITIALIZE NVOLINDX   @Y30LB11*/
         IC    @08,NVOL(,@14)                                      0544
         STC   @08,NVOLINDX                                        0544
*   SPACESW=OFF;                    /* INITIALIZE SPACE SW   @Y30LB11*/
         NI    SPACESW,B'11101111'                                 0545
*   IF JPQTY=0&                     /* PRIM SPACE NOT SPEC?  @Y30LB11*/
*       JSQTY=0&                    /* SECDY SPACE NOT SPEC? @Y30LB11*/
*       JFCBSPAC=JSPACE&            /* SPACE NOT SPECIFIED?  @Y30LB11*/
*       JFCBNVOL=Z1&                /* NVOL ZERO             @ZA14749*/
*       JFCBABST=0 THEN             /* REL TRACK ADDR 0?     @Y30LB11*/
         L     @08,JPQTY-1                                         0546
         LA    @08,0(,@08)                                         0546
         LTR   @08,@08                                             0546
         BNZ   @RF00546                                            0546
         L     @08,JSQTY-1                                         0546
         LA    @08,0(,@08)                                         0546
         LTR   @08,@08                                             0546
         BNZ   @RF00546                                            0546
         TM    JFCBSPAC(@14),B'11000000'                           0546
         BNZ   @RF00546                                            0546
         CLC   JFCBNVOL(1,@14),Z1                                  0546
         BNE   @RF00546                                            0546
         LH    @08,JFCBABST(,@14)                                  0546
         LTR   @08,@08                                             0546
         BNZ   @RF00546                                            0546
*     DO;                           /* YES                   @Y30LB11*/
*       IF JFCBMSGP=OFF THEN        /* MSVGRP SPECIFIED?     @Y30LB11*/
         TM    JFCBMSGP(@14),B'00100000'                           0548
         BNZ   @RF00548                                            0548
*         DO;                       /* NO                    @Y30LB11*/
*           SAVRETC=FOUR;           /* SET REASON CODE       @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0550
*           SAVRCODE=R22E;          /* NOT SPACE NOR MSVGRP  @Y30LB11*/
         MVC   SAVRCODE(2),@CB00182                                0551
*           RETURN CODE(4);         /* RETURN TO CALLER      @Y30LB11*/
         LA    @15,4                                               0552
         L     @14,@SA00004                                        0552
         LM    @00,@08,@SA00004+8                                  0552
         LM    @10,@12,@SA00004+44                                 0552
         BR    @14                                                 0552
*         END;                      /*                       @Y30LB11*/
*       IF JFCORGIS=ON×             /* INDEXED SEQUENTIAL?   @Y30LB11*/
*           JFCORGPO=ON THEN        /* PARTITIONED ORG?      @Y30LB11*/
@RF00548 L     @14,JFCBPTR                                         0554
         TM    JFCORGIS(@14),B'10000010'                           0554
         BZ    @RF00554                                            0554
*         DO;                       /* YES                   @Y30LB11*/
*           SAVRETC=FOUR;           /* SET REASON CODE       @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0556
*           SAVRCODE=R22F;          /* BAD ORGANIZATION      @Y30LB11*/
         MVC   SAVRCODE(2),@CB00184                                0557
*           RETURN CODE(4);         /* RETURN TO CALLER      @Y30LB11*/
         LA    @15,4                                               0558
         L     @14,@SA00004                                        0558
         LM    @00,@08,@SA00004+8                                  0558
         LM    @10,@12,@SA00004+44                                 0558
         BR    @14                                                 0558
*         END;                      /*                       @Y30LB11*/
*       SPACESW=ON;                 /* SET SPACE SW ON       @Y30LB11*/
@RF00554 OI    SPACESW,B'00010000'                                 0560
*     END;                          /*                       @Y30LB11*/
*   IF JFCBNVOL=Z1 THEN             /* NVOL = 0?             @Y30LB11*/
@RF00546 L     @14,JFCBPTR                                         0562
         CLC   JFCBNVOL(1,@14),Z1                                  0562
         BNE   @RF00562                                            0562
*     DO;                           /* YES                   @Y30LB11*/
*       IF JFCBMSGP=ON&             /* MSVGRP SPECIFIED?     @Y30LB11*/
*           JFCMSVGP^=BK THEN       /* MSVGRP NOT BLANK?     @Y30LB11*/
         TM    JFCBMSGP(@14),B'00100000'                           0564
         BNO   @RF00564                                            0564
         CLC   JFCMSVGP(8,@14),@CC00108                            0564
         BE    @RF00564                                            0564
*         ARGGP=JFCMSVGP;           /* USE JFCVVGRP          @Y30LB11*/
         MVC   ARGGP(8),JFCMSVGP(@14)                              0565
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         ARGGP=SYSGRP;             /* USE SYSGROUP          @Y30LB11*/
         B     @RC00564                                            0566
@RF00564 MVC   ARGGP(8),@CC00214                                   0566
*     END;                          /*                       @Y30LB11*/
*   ELSE                            /* OTHERWISE             @Y30LB11*/
*     DO;                           /* SET GROUP ARGUMENT    @Y30LB11*/
         B     @RC00562                                            0568
@RF00562 DS    0H                                                  0569
*       ARGVOL=JFCAVOLS(1);         /* SET ARGUMENT          @Y30LB11*/
         L     @14,JFCBPTR                                         0569
         MVC   ARGVOL(6),JFCAVOLS(@14)                             0569
*       RPLVKEY=ADDR(ARGV);         /* ADDR OF KEY           @Y30LB11*/
         LA    @14,ARGV                                            0570
         ST    @14,RPLVKEY(,RPLVPTR)                               0570
*       MSGTEXT1=ADDR(ARGVOL);      /* INSERT TEXT           @Y30LB11*/
         LA    @14,ARGVOL                                          0571
         STCM  @14,7,MSGTEXT1                                      0571
*       MSGLEN1=SIX;                /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'06'                                       0572
*       MSGID=M402;                 /* BASEV NOT FND         @Y30LB11*/
         MVC   MSGID(4),@CF00150                                   0573
*       CALL COMONRTN;              /* GET VOLID RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0574
*       IF RETCOD^=0 THEN           /* GOOD RETURN?          @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0575
         BZ    @RF00575                                            0575
*         DO;                       /* NO                    @Y30LB11*/
*           SAVRETC=FOUR;           /* SET RETURN CODE       @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0577
*           SAVRCODE=R231;          /* SET REASON CODE       @Y30LB11*/
         MVC   SAVRCODE(2),@CB00186                                0578
*           RETURN CODE(4);         /* PASS BAD RETURN       @Y30LB11*/
         LA    @15,4                                               0579
         L     @14,@SA00004                                        0579
         LM    @00,@08,@SA00004+8                                  0579
         LM    @10,@12,@SA00004+44                                 0579
         BR    @14                                                 0579
*         END;                      /*                       @Y30LB11*/
*       IF BASGENUS=ON×             /* GENERAL USE VOLUME    @YM30739*/
*           BASRSTD=ON THEN         /* RESTRICTED USE VOLUME @YM30739*/
@RF00575 L     @14,BASEVPTR(,RPLVPTR)                              0581
         TM    BASGENUS(@14),B'00011000'                           0581
         BZ    @RF00581                                            0581
*         ARGGP=BASGROUP;           /* USE BASGROUP          @Y30LB11*/
         MVC   ARGGP(8),BASGROUP(@14)                              0582
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         ARGGP=SYSGRP;             /* USE SYSGROUP          @Y30LB11*/
         B     @RC00581                                            0583
@RF00581 MVC   ARGGP(8),@CC00214                                   0583
*     END;                          /*                       @Y30LB11*/
@RC00581 DS    0H                                                  0585
*   ARGNUM=0;                       /* SET ARG FOR GROUP RCD @Y30LB11*/
@RC00562 MVI   ARGNUM,X'00'                                        0585
*   RPLVKEY=ADDR(ARGGR);            /* ADDR OF GROUP KEY     @Y30LB11*/
         LA    @14,ARGGR                                           0586
         ST    @14,RPLVKEY(,RPLVPTR)                               0586
*   MSGTEXT1=ADDR(ARGGP);           /* TEXT INSERT           @Y30LB11*/
         LA    @14,ARGGP                                           0587
         STCM  @14,7,MSGTEXT1                                      0587
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'08'                                       0588
*   MSGID=M415;                     /* GROUP NOT FND         @Y30LB11*/
         MVC   MSGID(4),@CF00160                                   0589
*   CALL COMONRTN;                  /* GET GROUP RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0590
*   IF RETCOD^=0 THEN               /* GOOD RETURN?          @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0591
         BZ    @RF00591                                            0591
*     DO;                           /* NO                    @Y30LB11*/
*       SAVRETC=FOUR;               /* SET RETURN CODE       @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0593
*       SAVRCODE=R231;              /* SET REASON CODE       @Y30LB11*/
         MVC   SAVRCODE(2),@CB00186                                0594
*       RETURN CODE(4);             /* PASS BAD RETURN       @Y30LB11*/
         LA    @15,4                                               0595
         L     @14,@SA00004                                        0595
         LM    @00,@08,@SA00004+8                                  0595
         LM    @10,@12,@SA00004+44                                 0595
         BR    @14                                                 0595
*     END;                          /*                       @Y30LB11*/
*   IF SPACESW=ON THEN              /* WAS SPACE SPECIFIED?  @Y30LB11*/
@RF00591 TM    SPACESW,B'00010000'                                 0597
         BNO   @RF00597                                            0597
*     DO;                           /* FILL IN FROM GROUP    @Y30LB11*/
*       JFCBFQTY=GROPSPD;           /* JFCB PRIMARY SPACE    @Y30LB11*/
         L     @14,GROUPPTR(,RPLVPTR)                              0599
         LH    @08,GROPSPD(,@14)                                   0599
         STCM  @08,7,JFCBFQTY                                      0599
*       JFCBPQTY=JFCBQTY;           /* SET JFCB WITH SPACE   @Y30LB11*/
         L     @04,JFCBPTR                                         0600
         MVC   JFCBPQTY(3,@04),JFCBQTY                             0600
*       JFCBFQTY=GROSSPD;           /* JFCB SECONDARY SPACE  @Y30LB11*/
         LH    @07,GROSSPD(,@14)                                   0601
         STCM  @07,7,JFCBFQTY                                      0601
*       JFCBSQTY=JFCBQTY;           /* SET JFCB WITH SPACE   @Y30LB11*/
         MVC   JFCBSQTY(3,@04),JFCBQTY                             0602
*       JFCBSPAC=CYLSPACE;          /* SET CYLINDER BOUN ON  @Y30LB11*/
         OI    JFCBSPAC(@04),B'11000000'                           0603
*       JPQTY=GROPSPD;              /* PRIMARY SPACE         @Y30LB11*/
         STCM  @08,7,JPQTY                                         0604
*       JSQTY=GROSSPD;              /* SECONDARY SPACE       @Y30LB11*/
         STCM  @07,7,JSQTY                                         0605
*       PQTY=JPQTY;                 /* SET PQTY              @Y30LB11*/
         STCM  @08,7,PQTY                                          0606
*       SQTY=JSQTY;                 /* SET SQTY              @Y30LB11*/
         STCM  @07,7,SQTY                                          0607
*       IF GRORLSE=ON THEN          /* IS RELEASE SET?       @Y30LB11*/
         TM    GRORLSE(@14),B'00001000'                            0608
         BNO   @RF00608                                            0608
*         DO;                       /*                       @Y30LB11*/
*           JFCRLSE1=ON;            /* YES, SET JFCB RELEASE @Y30LB11*/
*           JFCRLSE2=ON;            /* YES, SET JFCB RELEASE @Y30LB11*/
         OI    JFCRLSE1(@04),B'11000000'                           0611
*         END;                      /*                       @Y30LB11*/
*       JFCONTIG=ON;                /* SET CONTIGUOUS BIT ON @Y30LB11*/
@RF00608 L     @14,JFCBPTR                                         0613
         OI    JFCONTIG(@14),B'00001000'                           0613
*     END;                          /*                       @Y30LB11*/
*   ELSE                            /* OTHERWISE             @Y30LB11*/
*     DO;                           /* CALCULATE IT          @Y30LB11*/
         B     @RC00597                                            0615
@RF00597 DS    0H                                                  0616
*       IF JFCBSPAC=CYLSPACE THEN   /* SPACE NOT SPECIFIED   @Y30LB11*/
         L     @14,JFCBPTR                                         0616
         TM    JFCBSPAC(@14),B'11000000'                           0616
         BNO   @RF00616                                            0616
*         DO;                       /*                       @Y30LB11*/
*           PQTY=JPQTY;             /* SET PRIMARY QTY       @Y30LB11*/
         MVC   PQTY(3),JPQTY                                       0618
*           SQTY=JSQTY;             /* SET SECONDARY QTY     @Y30LB11*/
         MVC   SQTY(3),JSQTY                                       0619
*         END;                      /*                       @Y30LB11*/
*       ELSE                        /*                       @Y30LB11*/
*         IF JFCBSPAC=TRKSPACE THEN /* SPACE IN TRACKS?      @Y30LB11*/
         B     @RC00616                                            0621
@RF00616 L     @14,JFCBPTR                                         0621
         TM    JFCBSPAC(@14),B'10000000'                           0621
         BNO   @RF00621                                            0621
         TM    JFCBSPAC(@14),B'01000000'                           0621
         BNZ   @RF00621                                            0621
*           DO;                     /* SET QUANTITIES        @Y30LB11*/
*             IF JPQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?      @ZM30745*/
         L     @02,JPQTY-1                                         0623
         LA    @02,0(,@02)                                         0623
         SRDA  @02,32                                              0623
         D     @02,@CF00148                                        0623
         LTR   @02,@02                                             0623
         BNP   @RF00623                                            0623
*               ROUND=1;            /* YES, ROUND UP         @Y30LB11*/
         LA    ROUND,1                                             0624
*             ELSE                  /* OTHERWISE             @Y30LB11*/
*               ROUND=0;            /* DO NOT ROUND          @Y30LB11*/
         B     @RC00623                                            0625
@RF00623 SLR   ROUND,ROUND                                         0625
*             PQTY=(JPQTY/TRKCYL)+ROUND;/* SET PRIMARY       @ZM30745*/
@RC00623 LA    @14,19                                              0626
         L     @03,JPQTY-1                                         0626
         LA    @03,0(,@03)                                         0626
         SLR   @02,@02                                             0626
         DR    @02,@14                                             0626
         ALR   @03,ROUND                                           0626
         STCM  @03,7,PQTY                                          0626
*             IF JSQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?      @ZM30745*/
         L     @02,JSQTY-1                                         0627
         LA    @02,0(,@02)                                         0627
         SRDA  @02,32                                              0627
         DR    @02,@14                                             0627
         LTR   @02,@02                                             0627
         BNP   @RF00627                                            0627
*               ROUND=1;            /* YES, ROUND UP         @Y30LB11*/
         LA    ROUND,1                                             0628
*             ELSE                  /* OTHERWISE             @Y30LB11*/
*               ROUND=0;            /* DO NOT ROUND          @Y30LB11*/
         B     @RC00627                                            0629
@RF00627 SLR   ROUND,ROUND                                         0629
*             SQTY=(JSQTY/TRKCYL)+ROUND;/* SET SECONDARY     @ZM30745*/
@RC00627 L     @03,JSQTY-1                                         0630
         LA    @03,0(,@03)                                         0630
         SLR   @02,@02                                             0630
         D     @02,@CF00148                                        0630
         ALR   @03,ROUND                                           0630
         STCM  @03,7,SQTY                                          0630
*           END;                    /*                       @Y30LB11*/
*         ELSE                      /* OTHERWISE             @Y30LB11*/
*           IF JFCBSPAC=AVBSPACE THEN/* BLOCK REQUEST        @YM30739*/
         B     @RC00621                                            0632
@RF00621 L     @14,JFCBPTR                                         0632
         TM    JFCBSPAC(@14),B'01000000'                           0632
         BNO   @RF00632                                            0632
         TM    JFCBSPAC(@14),B'10000000'                           0632
         BNZ   @RF00632                                            0632
*             DO;                   /*                       @YM30739*/
*               IF JFCBDRLH^=0 THEN /* BLKLENG - CALCULATE   @YM30739*/
         ICM   @08,7,JFCBDRLH(@14)                                 0634
         BZ    @RF00634                                            0634
*                 DO;               /*                       @YM30739*/
*                   IF KEYLE>0 THEN /*                       @ZM30745*/
         CLI   KEYLE(@14),0                                        0636
         BNH   @RF00636                                            0636
*                     RECLEN=CON1+KEYLE+DRLH;/* RECORD LENGTH-KEY  0637
*                                                            @YM30739*/
         LA    RECLEN,191                                          0637
         SLR   @04,@04                                             0637
         IC    @04,KEYLE(,@14)                                     0637
         ALR   RECLEN,@04                                          0637
         L     @14,DRLH-1                                          0637
         LA    @14,0(,@14)                                         0637
         ALR   RECLEN,@14                                          0637
*                   ELSE            /*                       @ZM30745*/
*                     RECLEN=CON2+DRLH;/* RECORD LENGTH NO-KEY     0638
*                                                            @YM30739*/
         B     @RC00636                                            0638
@RF00636 LA    RECLEN,135                                          0638
         L     @14,DRLH-1                                          0638
         LA    @14,0(,@14)                                         0638
         ALR   RECLEN,@14                                          0638
*                   RECORDS=TKCAPCTY/RECLEN;/*               @ZM30745
*                                      CALCULATE NO OF       @ZM30745
*                                      RECORDS               @ZM30745*/
@RC00636 L     @02,@CF00217                                        0639
         SRDA  @02,32                                              0639
         DR    @02,RECLEN                                          0639
         LR    RECORDS,@03                                         0639
*                   IF(JFCRFO=OFF&RECORDS^=0) THEN/* CHECK IF      0640
*                                                            @ZM30745
*                                      TRACK OVER FLOW       @ZM30745
*                                      IS REQUESTED          @ZM30745*/
         L     @14,JFCBPTR                                         0640
         TM    JFCRFO(@14),B'00100000'                             0640
         BNZ   @RF00640                                            0640
         SLR   @14,@14                                             0640
         CR    RECORDS,@14                                         0640
         BE    @RF00640                                            0640
*                     DO;           /*                       @ZM30745*/
*                       IF(JPQTY//RECORDS)>0 THEN/* CHECK    @ZM30745
*                                      IF ANOTHER TRACK      @ZM30745
*                                      REQUIRED              @ZM30745*/
         L     @02,JPQTY-1                                         0642
         LA    @02,0(,@02)                                         0642
         SRDA  @02,32                                              0642
         DR    @02,RECORDS                                         0642
         CR    @02,@14                                             0642
         BNH   @RF00642                                            0642
*                         ROUND=1;  /* SET FOR ANOTHER TRACK @ZM30745*/
         LA    ROUND,1                                             0643
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO TRACK REQUIRED     @ZM30745*/
         B     @RC00642                                            0644
@RF00642 SLR   ROUND,ROUND                                         0644
*                       PQTY=(JPQTY/RECORDS)+ROUND;/* CALCULATE    0645
*                                                            @ZM30745
*                                      PRIMARY               @ZM30745
*                                      QUANTITY IN TRKS      @ZM30745*/
@RC00642 L     @03,JPQTY-1                                         0645
         LA    @03,0(,@03)                                         0645
         SLR   @02,@02                                             0645
         DR    @02,RECORDS                                         0645
         ALR   @03,ROUND                                           0645
         STCM  @03,7,PQTY                                          0645
*                       IF(JSQTY//RECORDS)>0 THEN/* CHECK    @ZM30745
*                                      IF ANOTHER TRACK      @ZM30745
*                                      REQUIRED              @ZM30745*/
         L     @02,JSQTY-1                                         0646
         LA    @02,0(,@02)                                         0646
         SRDA  @02,32                                              0646
         DR    @02,RECORDS                                         0646
         LTR   @02,@02                                             0646
         BNP   @RF00646                                            0646
*                         ROUND=1;  /* SET FOR ANOTHER TRACK @ZM30745*/
         LA    ROUND,1                                             0647
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO TRACK REQUIRED     @ZM30745*/
         B     @RC00646                                            0648
@RF00646 SLR   ROUND,ROUND                                         0648
*                       SQTY=(JSQTY/RECORDS)+ROUND;/* CALCULATE    0649
*                                                            @ZM30745
*                                      SECONDARY             @ZM30745
*                                      QTY IN TRKS           @ZM30745*/
@RC00646 L     @03,JSQTY-1                                         0649
         LA    @03,0(,@03)                                         0649
         SLR   @02,@02                                             0649
         DR    @02,RECORDS                                         0649
         ALR   @03,ROUND                                           0649
         STCM  @03,7,SQTY                                          0649
*                       IF(PQTY//TRKCYL)>0 THEN/* CHECK IF EXTRA   0650
*                                                            @ZM30745
*                                      CYL REQUIRED          @ZM30745*/
         L     @02,PQTY-1                                          0650
         LA    @02,0(,@02)                                         0650
         SRDA  @02,32                                              0650
         D     @02,@CF00148                                        0650
         LTR   @02,@02                                             0650
         BNP   @RF00650                                            0650
*                         ROUND=1;  /* EXTRA CYLINDER REQUIRED     0651
*                                                            @ZM30745*/
         LA    ROUND,1                                             0651
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO EXTRA CYLINDER REQUIRED  0652
*                                                            @ZM30745*/
         B     @RC00650                                            0652
@RF00650 SLR   ROUND,ROUND                                         0652
*                       PQTY=(PQTY/TRKCYL)+ROUND;/* CALCULATE      0653
*                                                            @ZM30745
*                                      PRIMARY QTY IN        @ZM30745
*                                      CYL                   @ZM30745*/
@RC00650 LA    @14,19                                              0653
         L     @03,PQTY-1                                          0653
         LA    @03,0(,@03)                                         0653
         SLR   @02,@02                                             0653
         DR    @02,@14                                             0653
         ALR   @03,ROUND                                           0653
         STCM  @03,7,PQTY                                          0653
*                       IF(SQTY//TRKCYL)>0 THEN/* CHECK IF EXTRA   0654
*                                                            @ZM30745
*                                      CYL REQUIRED          @ZM30745*/
         L     @02,SQTY-1                                          0654
         LA    @02,0(,@02)                                         0654
         SRDA  @02,32                                              0654
         DR    @02,@14                                             0654
         LTR   @02,@02                                             0654
         BNP   @RF00654                                            0654
*                         ROUND=1;  /*                       @ZM30745*/
         LA    ROUND,1                                             0655
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO EXTRA CYLINDER REQUIRED  0656
*                                                            @ZM30745*/
         B     @RC00654                                            0656
@RF00654 SLR   ROUND,ROUND                                         0656
*                       SQTY=(SQTY/TRKCYL)+ROUND;/* CALCULATE      0657
*                                                            @ZM30745
*                                      SECONDARY QTY IN      @ZM30745
*                                      CYL                   @ZM30745*/
@RC00654 L     @03,SQTY-1                                          0657
         LA    @03,0(,@03)                                         0657
         SLR   @02,@02                                             0657
         D     @02,@CF00148                                        0657
         ALR   @03,ROUND                                           0657
         STCM  @03,7,SQTY                                          0657
*                     END;          /*                       @ZM30745*/
*                   ELSE            /*                       @ZM30745*/
*                     DO;           /*                       @ZM30745*/
         B     @RC00640                                            0659
@RF00640 DS    0H                                                  0660
*                       TOTLEN=RECLEN*JPQTY;/* TOTAL         @ZM30745
*                                      LENGTH OF RECORDS     @ZM30745*/
         L     @03,JPQTY-1                                         0660
         LA    @03,0(,@03)                                         0660
         MR    @02,RECLEN                                          0660
         LR    TOTLEN,@03                                          0660
*                       IF(TOTLEN//TKCAPCTY)>0 THEN/*        @ZM30745*/
         LR    @02,TOTLEN                                          0661
         SRDA  @02,32                                              0661
         D     @02,@CF00217                                        0661
         LTR   @02,@02                                             0661
         BNP   @RF00661                                            0661
*                         ROUND=1;  /* SET FOR ANOTHER       @ZM30745
*                                      TRACK                 @ZM30745*/
         LA    ROUND,1                                             0662
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO OTHER TRACK        @ZM30745
*                                      NEEDED                @ZM30745*/
         B     @RC00661                                            0663
@RF00661 SLR   ROUND,ROUND                                         0663
*                       PQTY=(TOTLEN/TKCAPCTY)+ROUND;/*      @ZM30745
*                                      CALCULATE NO OF       @ZM30745
*                                      TRACKS                @ZM30745*/
@RC00661 L     @14,@CF00217                                        0664
         LR    @02,TOTLEN                                          0664
         SRDA  @02,32                                              0664
         DR    @02,@14                                             0664
         ALR   @03,ROUND                                           0664
         STCM  @03,7,PQTY                                          0664
*                       TOTLEN=RECLEN*JSQTY;/* TOTAL         @ZM30745
*                                      LENGTH OF RECORDS     @ZM30745*/
         L     @03,JSQTY-1                                         0665
         LA    @03,0(,@03)                                         0665
         MR    @02,RECLEN                                          0665
         LR    TOTLEN,@03                                          0665
*                       IF(TOTLEN//TKCAPCTY)>0 THEN/*        @ZM30745*/
         LR    @02,TOTLEN                                          0666
         SRDA  @02,32                                              0666
         DR    @02,@14                                             0666
         LTR   @02,@02                                             0666
         BNP   @RF00666                                            0666
*                         ROUND=1;  /* SET FOR ANOTHER       @ZM30745
*                                      TRACK                 @ZM30745*/
         LA    ROUND,1                                             0667
*                       ELSE        /*                       @ZM30745*/
*                         ROUND=0;  /* NO OTHER TRACK        @ZM30745
*                                      NEEDED                @ZM30745*/
         B     @RC00666                                            0668
@RF00666 SLR   ROUND,ROUND                                         0668
*                       SQTY=(TOTLEN/TKCAPCTY)+ROUND;/*      @ZM30745
*                                      CALCULATE NO OF       @ZM30745
*                                      TRACKS                @ZM30745*/
@RC00666 LR    @02,TOTLEN                                          0669
         SRDA  @02,32                                              0669
         D     @02,@CF00217                                        0669
         ALR   @03,ROUND                                           0669
         STCM  @03,7,SQTY                                          0669
*                       IF PQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?   0670
*                                                            @ZM30745*/
         L     @02,PQTY-1                                          0670
         LA    @02,0(,@02)                                         0670
         SRDA  @02,32                                              0670
         D     @02,@CF00148                                        0670
         LTR   @02,@02                                             0670
         BNP   @RF00670                                            0670
*                         ROUND=1;  /* YES, ROUND UP         @YM30739*/
         LA    ROUND,1                                             0671
*                       ELSE        /* OTHERWISE             @YM30739*/
*                         ROUND=0;  /* DO NOT ROUND          @YM30739*/
         B     @RC00670                                            0672
@RF00670 SLR   ROUND,ROUND                                         0672
*                       PQTY=(PQTY/TRKCYL)+ROUND;/* SET PRIMARY    0673
*                                                            @ZM30745*/
@RC00670 LA    @14,19                                              0673
         L     @03,PQTY-1                                          0673
         LA    @03,0(,@03)                                         0673
         SLR   @02,@02                                             0673
         DR    @02,@14                                             0673
         ALR   @03,ROUND                                           0673
         STCM  @03,7,PQTY                                          0673
*                       IF SQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?   0674
*                                                            @ZM30745*/
         L     @02,SQTY-1                                          0674
         LA    @02,0(,@02)                                         0674
         SRDA  @02,32                                              0674
         DR    @02,@14                                             0674
         LTR   @02,@02                                             0674
         BNP   @RF00674                                            0674
*                         ROUND=1;  /* YES, ROUND UP         @YM30739*/
         LA    ROUND,1                                             0675
*                       ELSE        /* OTHERWISE             @YM30739*/
*                         ROUND=0;  /* DO NOT ROUND          @YM30739*/
         B     @RC00674                                            0676
@RF00674 SLR   ROUND,ROUND                                         0676
*                       SQTY=(SQTY/TRKCYL)+ROUND;/* SET SECONDARY  0677
*                                                            @ZM30745*/
@RC00674 L     @03,SQTY-1                                          0677
         LA    @03,0(,@03)                                         0677
         SLR   @02,@02                                             0677
         D     @02,@CF00148                                        0677
         ALR   @03,ROUND                                           0677
         STCM  @03,7,SQTY                                          0677
*                     END;          /*                       @ZM30745*/
*                 END;              /*                       @YM30739*/
*             END;                                                 0680
*           ELSE                    /* OTHERWISE             @Y30LB11*/
*             IF JFCBNVOL^=Z1&      /* NVOL NOT ZERO         @ZA14749*/
*                 JFCBSPAC=JSPACE THEN/* SPACE NOT SPECIFIED @ZA14749*/
         B     @RC00632                                            0681
@RF00632 L     @14,JFCBPTR                                         0681
         CLC   JFCBNVOL(1,@14),Z1                                  0681
         BE    @RF00681                                            0681
         TM    JFCBSPAC(@14),B'11000000'                           0681
         BNZ   @RF00681                                            0681
*               DO;                 /*                       @Y30LB11*/
*                 PQTY=GROPSPD;     /* SET PRIMARY QTY       @ZA31053*/
         L     @14,GROUPPTR(,RPLVPTR)                              0683
         LH    @08,GROPSPD(,@14)                                   0683
         STCM  @08,7,PQTY                                          0683
*                 SQTY=GROSSPD;     /* SET SECONDARY QTY     @ZA31053*/
         LH    @14,GROSSPD(,@14)                                   0684
         STCM  @14,7,SQTY                                          0684
*               END;                /*                       @Y30LB11*/
*             ELSE                  /*                       @YM30739*/
*               DO;                 /* ERROR CONDITION       @YM30739*/
         B     @RC00681                                            0686
@RF00681 DS    0H                                                  0687
*                 SAVRCODE=R22C;    /* NOT PROPER SPACE      @Y30LB11*/
         MVC   SAVRCODE(2),@CB00178                                0687
*                 SAVRETC=FOUR;     /* SET RETURN CODE       @Y30LB11*/
         MVC   SAVRETC(2),@CB00103                                 0688
*                 RETURN CODE(4);   /* RETURN                @Y30LB11*/
         LA    @15,4                                               0689
         L     @14,@SA00004                                        0689
         LM    @00,@08,@SA00004+8                                  0689
         LM    @10,@12,@SA00004+44                                 0689
         BR    @14                                                 0689
*               END;                /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RC00681 DS    0H                                                  0691
@RC00632 DS    0H                                                  0691
@RC00621 DS    0H                                                  0691
@RC00616 DS    0H                                                  0692
*   CALL CALSPACE;                  /* CALCULATE SPACE/CYLS  @Y30LB11*/
@RC00597 BAL   @14,CALSPACE                                        0692
*   IF JFCBYFX=0&                   /* YEAR 0?               @Y30LB11*/
*       JFCBDFX=0 THEN              /* DAY 0?                @Y30LB11*/
         CLI   JFCBYFX,0                                           0693
         BNE   @RF00693                                            0693
         LH    @14,JFCBDFX                                         0693
         LTR   @14,@14                                             0693
         BNZ   @RF00693                                            0693
*     EXPDT=DLMTD;                  /* YES, USE TODAYS DATE  @Y30LB11*/
         MVC   EXPDT(4),DLMTD                                      0694
*   ELSE                            /* OTHERWISE             @Y30LB11*/
*     DO;                           /* USE JFCBS             @Y30LB11*/
         B     @RC00693                                            0695
@RF00693 DS    0H                                                  0696
*       CVD(JFCBYFX,GX1PDT);        /* SET YEAR              @Y30LB11*/
         SLR   @14,@14                                             0696
         IC    @14,JFCBYFX                                         0696
         CVD   @14,@TS00001                                        0696
         MVC   GX1PDT(2),@TS00001+6                                0696
*       GENERATE REFS(GX1PDT);                                     0697
*                                   /*                       @Y30LB11*/
         LH    15,GX1PDT               LOAD YEAR             @Y30LB11
         SRL   15,4(0)                 SHIFT SIGN            @Y30LB11
         STH   15,GX1PDT               RESTORE YEAR          @Y30LB11
*       CVD(JFCBDFX,GX2PDT);        /* SET DAY               @Y30LB11*/
         LH    @14,JFCBDFX                                         0698
         CVD   @14,@TS00001                                        0698
         MVC   GX2PDT(2),@TS00001+6                                0698
*       EXPDT=GXPDT;                /* SET EXPDT             @Y30LB11*/
         MVC   EXPDT(4),GXPDT                                      0699
*     END;                          /*                       @Y30LB11*/
*   RETURN CODE(0);                 /* OK RETURN CODE        @Y30LB11*/
@RC00693 SLR   @15,@15                                             0701
         L     @14,@SA00004                                        0701
         LM    @00,@08,@SA00004+8                                  0701
         LM    @10,@12,@SA00004+44                                 0701
         BR    @14                                                 0701
*   END FINDGRP;                    /*                       @Y30LB11*/
*                                                                  0703
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0703
*01*  NAME = CALSPACE                                        @Y30LB11
*                                                                  0703
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO CALCULATE THE        0703
*                SPACE REQUESTED IN CYLINDERS.  CARE IS TAKEN      0703
*                TO USE THE BEST OF THREE ALGORITHMS DEPENDING UPON
*                THE DATA SET JFCB PARAMETERS.               @Y30LB11
*                                                                  0703
*02*    INPUT = JFCB PARAMETERS                              @Y30LB11
*                                                                  0703
*02*    OUTPUT = SPACE CONVERSION IN CYLINDERS               @Y30LB11
*                                                                  0703
**** END OF SPECIFICATIONS **                                        */
*                                                                  0703
*CALSPACE:                          /* CALSPACE ROUTINE      @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
CALSPACE STM   @14,@12,12(@13)                                     0703
*   FRSP=0;                         /* INITIALIZE FREE SPACE @Y30LB11*/
         SLR   @14,@14                                             0704
         STH   @14,FRSP                                            0704
*   IF ALGOBIT=OFF&                 /* ALGORITHM 1?          @Y30LB11*/
*       ALGOSW=OFF THEN             /* 1ST ALGORITHM REQUEST @Y30LB11*/
         L     @14,JFCBPTR                                         0705
         TM    ALGOBIT(@14),B'10000000'                            0705
         BNZ   @RF00705                                            0705
         TM    ALGOSW,B'10000000'                                  0705
         BNZ   @RF00705                                            0705
*     DO;                           /* YES                   @Y30LB11*/
*       IF MDVSVRQ=OFF THEN         /* PRIMARY VOL REQUEST?  @Y30LB11*/
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0707
         BNZ   @RF00707                                            0707
*         DO;                       /* SET SPACE RQMTS       @Y30LB11*/
*           LEXT=PQTY;              /* CONTIG SPACE          @Y30LB11*/
         L     @14,PQTY-1                                          0709
         LA    @14,0(,@14)                                         0709
         STCM  @14,7,LEXT                                          0709
*           FRSP=PQTY+15*SQTY;      /* CYLS REQUESTED        @Y30LB11*/
         L     @04,SQTY-1                                          0710
         LA    @04,0(,@04)                                         0710
         MH    @04,@CH00085                                        0710
         ALR   @14,@04                                             0710
         STH   @14,FRSP                                            0710
*         END;                      /*                       @Y30LB11*/
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         DO;                       /* SET SECDY SPACE RQMTS @Y30LB11*/
         B     @RC00707                                            0712
@RF00707 DS    0H                                                  0713
*           LEXT=SQTY;              /* CONTIG SPACE          @Y30LB11*/
         L     @14,SQTY-1                                          0713
         LA    @14,0(,@14)                                         0713
         STCM  @14,7,LEXT                                          0713
*           FRSP=16*SQTY;           /* CYLS REQUESTED        @Y30LB11*/
         SLA   @14,4                                               0714
         STH   @14,FRSP                                            0714
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RC00707 DS    0H                                                  0717
*   IF FRSP>MAX×ALGOSW=ON THEN      /* FREE SPACE>403 CYLS?  @Y30LB11*/
@RF00705 LH    @14,FRSP                                            0717
         C     @14,@CF00098                                        0717
         BH    @RT00717                                            0717
         TM    ALGOSW,B'10000000'                                  0717
         BNO   @RF00717                                            0717
@RT00717 DS    0H                                                  0718
*     DO;                           /* YES                   @Y30LB11*/
*       ALGOBIT=ON;                 /* SET 2ND ALGORITHM     @Y30LB11*/
         L     @14,JFCBPTR                                         0719
         OI    ALGOBIT(@14),B'10000000'                            0719
*       IF JFCONTIG=ON×             /* CONTIGUOUS?           @Y30LB11*/
*           JFCMIXG=ON×             /* MIXG REQUEST?         @Y30LB11*/
*           JFCALX=ON THEN          /* ALX REQUEST?          @Y30LB11*/
         TM    JFCONTIG(@14),B'00001110'                           0720
         BZ    @RF00720                                            0720
*         DO;                       /* YES                   @Y30LB11*/
*           IF MDVSVRQ=OFF THEN     /* PRIMARY VOL REQUEST?  @Y30LB11*/
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0722
         BNZ   @RF00722                                            0722
*             DO;                   /* SET SPACE RQMTS       @Y30LB11*/
*               LEXT=PQTY;          /* CONTIG SPACE          @Y30LB11*/
         L     @14,PQTY-1                                          0724
         LA    @14,0(,@14)                                         0724
         STCM  @14,7,LEXT                                          0724
*               FRSP=PQTY;          /* CYLS REQUESTED        @Y30LB11*/
         STH   @14,FRSP                                            0725
*             END;                  /*                       @Y30LB11*/
*           ELSE                    /* OTHERWISE             @Y30LB11*/
*             DO;                   /* SET SECDY SPACE RQMTS @Y30LB11*/
         B     @RC00722                                            0727
@RF00722 DS    0H                                                  0728
*               LEXT=SQTY;          /* CONTIG SPACE          @Y30LB11*/
         L     @14,SQTY-1                                          0728
         LA    @14,0(,@14)                                         0728
         STCM  @14,7,LEXT                                          0728
*               FRSP=SQTY;          /* CYLS REQUESTED        @Y30LB11*/
         STH   @14,FRSP                                            0729
*             END;                  /*                       @Y30LB11*/
*         END;                      /*                       @Y30LB11*/
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         DO;                       /* YES                   @Y30LB11*/
         B     @RC00720                                            0732
@RF00720 DS    0H                                                  0733
*           IF MDVSVRQ=OFF THEN     /* PRIMARY VOL REQUEST?  @Y30LB11*/
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0733
         BNZ   @RF00733                                            0733
*             FRSP=PQTY;            /* CYLS REQUESTED        @Y30LB11*/
         L     @14,PQTY-1                                          0734
         LA    @14,0(,@14)                                         0734
         STH   @14,FRSP                                            0734
*           ELSE                    /* OTHERWISE             @Y30LB11*/
*             FRSP=SQTY;            /* CYLS REQUESTED        @Y30LB11*/
         B     @RC00733                                            0735
@RF00733 L     @14,SQTY-1                                          0735
         LA    @14,0(,@14)                                         0735
         STH   @14,FRSP                                            0735
*           LEXT=(FRSP+4)/5;        /* SET CONTIG SPACE      @ZA31053*/
@RC00733 LA    @02,4                                               0736
         AH    @02,FRSP                                            0736
         SRDA  @02,32                                              0736
         D     @02,@CF00089                                        0736
         STCM  @03,7,LEXT                                          0736
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*   END CALSPACE;                   /*                       @Y30LB11*/
@EL00005 DS    0H                                                  0739
@EF00005 DS    0H                                                  0739
@ER00005 LM    @14,@12,12(@13)                                     0739
         BR    @14                                                 0739
*                                                                  0740
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0740
*01*  NAME = BASUPDTE                                        @Y30LB11
*                                                                  0740
*01*  FUNCTION = THIS SUBROUTINE IS CALLED WHENEVER A VOLUME       0740
*                IS TO BE SELECTED AS A CANDIDATE FOR MOUNT        0740
*                NON-SPECIFIC.  IF IT CANNOT BE SELECTED THE       0740
*                GVSNE RECORD MUST BE RESTORED.              @Y30LB11
*                                                                  0740
*02*    INPUT = UPDATE PARAMETERS                            @Y30LB11
*                                                                  0740
*02*    OUTPUT = UPDATED BASEV                               @Y30LB11
*                                                                  0740
**** END OF SPECIFICATIONS **                                        */
*                                                                  0740
*BASUPDTE:                          /* BASEV UPDATE ROUTINE  @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
BASUPDTE STM   @14,@12,@SA00006                                    0740
*   RPLVKEY=ADDR(ARGV);             /* ADDR OF VOLUME KEY    @Y30LB11*/
         LA    @14,ARGV                                            0741
         ST    @14,RPLVKEY(,RPLVPTR)                               0741
*   RPLVTYP=RPLVREAD;               /* SET VIO READ SW ON    @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0742
*   MSGRQ=''B;                      /* ZERO MSG PARMLIST     @Y30LB11*/
         XC    MSGRQ(32),MSGRQ                                     0743
*   MSGRPLV=RPLVPTR;                /* RESET RPLV PTR        @Y30LB11*/
         ST    RPLVPTR,MSGRPLV                                     0744
*   MSGTEXT1=ADDR(ARGVOL);          /* INSERT TEXT           @Y30LB11*/
         LA    @14,ARGVOL                                          0745
         STCM  @14,7,MSGTEXT1                                      0745
*   MSGLEN1=SIX;                    /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'06'                                       0746
*   MSGID=M402;                     /* BASEV NOT FND         @Y30LB11*/
         MVC   MSGID(4),@CF00150                                   0747
*   CALL COMONRTN;                  /* GET RECORD            @Y30LB11*/
         BAL   @14,COMONRTN                                        0748
*   IF RETCOD^=0 THEN               /* RECORD HANDLED?       @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0749
         BZ    @RF00749                                            0749
*     RETURN CODE(4);               /* NO                    @Y30LB11*/
         LA    @15,4                                               0750
         L     @14,@SA00006                                        0750
         LM    @00,@12,@SA00006+8                                  0750
         BR    @14                                                 0750
*   MDVOL=BASSERNO;                 /* SET VOLID IN LIST     @Y30LB11*/
@RF00749 L     @14,BASEVPTR(,RPLVPTR)                              0751
         MVC   MDVOL+132(6,RPLVPTR),BASSERNO(@14)                  0751
*   GXPDTOLD=BASEXPDT;              /* REMBER CURRENT DATE   @ZA17172*/
         MVC   GXPDTOLD(4),BASEXPDT(@14)                           0752
*   IF BASRCVYF=Z4 THEN             /* BASE RECORD OK?       @Y30LB11*/
         CLC   BASRCVYF(4,@14),Z4                                  0753
         BNE   @RF00753                                            0753
*     DO;                           /* YES                   @Y30LB11*/
*       BASDLMTD=DLMTD;             /* UPDATE DATE           @Y30LB11*/
         MVC   BASDLMTD(4,@14),DLMTD                               0755
*       BASXPDT2=BASEXPDT;          /* ZERO OUT OLD EXP DTE  @ZA17172*/
         L     @04,BASEXPDT(,@14)                                  0756
         ST    @04,BASXPDT2                                        0756
*       IF BASEXPDT=FOX&            /* SET ONLY IF ZERO AND  @VS32879*/
*           SAVGRETN=ON THEN        /* GP RETEN SPECIFIED    @Y30LB11*/
         CLC   BASEXPDT(4,@14),FOX                                 0757
         BNE   @RF00757                                            0757
         TM    SAVGRETN,B'10000000'                                0757
         BNO   @RF00757                                            0757
*         BASEXPDT=GXPDT;           /* UPDATE EXPIR DATE     @Y30LB11*/
         MVC   BASEXPDT(4,@14),GXPDT                               0758
*       BASCPUID=BASCPUID×CPU;      /* UPDATE CPU ASSOC MASK @Y30LB11*/
@RF00757 L     @14,BASEVPTR(,RPLVPTR)                              0759
         OC    BASCPUID(2,@14),CPU                                 0759
*       RPLVTYP=RPLVPUT;            /* SET VIO PUT SW ON     @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0760
*       CALL COMONRTN;              /* GET RECORD            @Y30LB11*/
         BAL   @14,COMONRTN                                        0761
*       RETURN CODE(RETCOD);        /* RETURN RESULTS        @Y30LB11*/
         L     @14,@SA00006                                        0762
         LM    @00,@12,@SA00006+8                                  0762
         BR    @14                                                 0762
*     END;                          /*                       @Y30LB11*/
*   ARGGP=BASGROUP;                 /* SET GVSNE KEY         @Y30LB11*/
@RF00753 L     @14,BASEVPTR(,RPLVPTR)                              0764
         MVC   ARGGP(8),BASGROUP(@14)                              0764
*   RSTRSW=ON;                      /* RESTORE GVSNE         @Y30LB11*/
*   SCRTCHSW=OFF;                   /* ITERATE UNTIL FOUND   @Y30LB11*/
         OI    RSTRSW,B'01000000'                                  0766
         NI    SCRTCHSW,B'11011111'                                0766
*   CALL GVSRECRD;                  /* GET RECORD            @Y30LB11*/
         BAL   @14,GVSRECRD                                        0767
*   RPLVDIR=ON;                     /* READ DIRECT           @ZA17148*/
*   RPLVNEXT=OFF;                   /* NOT READ NEXT         @ZA17148*/
*   RPLVKGE=OFF;                    /* NOT READ KEY GT OR EQ @ZA17148*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0770
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0770
*   RPLVUPD=ON;                     /* READ FOR UPD          @ZA17148*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0771
*   RPLVTYP=RPLVREAD;               /*                       @ZA17148*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0772
*   RPLVKEY=ADDR(GVSBUFR);          /* READ GVSNE            @ZA17148*/
         LA    @14,GVSBUFR                                         0773
         ST    @14,RPLVKEY(,RPLVPTR)                               0773
*   MSGTEXT1=ADDR(ARGGP);           /* INSERT TEXT           @ZA17148*/
         LA    @14,ARGGP                                           0774
         STCM  @14,7,MSGTEXT1                                      0774
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @ZA17148*/
         MVI   MSGLEN1,X'08'                                       0775
*   MSGID=M415;                     /* GVSNE NOT FOUND       @ZA17148*/
         MVC   MSGID(4),@CF00160                                   0776
*   CALL COMONRTN;                  /* GET RECORD            @ZA17148*/
         BAL   @14,COMONRTN                                        0777
*   RETURN CODE(4);                 /* BAD VOL CHOICE        @Y30LB11*/
         LA    @15,4                                               0778
         L     @14,@SA00006                                        0778
         LM    @00,@12,@SA00006+8                                  0778
         BR    @14                                                 0778
*   END BASUPDTE;                   /*                       @Y30LB11*/
*                                                                  0780
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0780
*01*  NAME = GVSRECRD                                        @Y30LB11
*                                                                  0780
*01*  FUNCTION = THIS ROUTINE IS CALLED TO PREPARE TO GET THE      0780
*                GROUP VOLUME SERIAL NUMBER EXTENSION RECORDS.     0780
*                                                            @Y30LB11
*                                                                  0780
*02*    INPUT = RPLV                                         @Y30LB11
*                                                                  0780
*02*    OUTPUT = GROUP VOLUME SERIAL EXTENSION RECORD        @Y30LB11
*                                                                  0780
**** END OF SPECIFICATIONS **                                        */
*                                                                  0780
*GVSRECRD:                                                         0780
*   PROCEDURE;                      /*                       @Y30LB11*/
GVSRECRD STM   @14,@12,@SA00007                                    0780
*   RPLVKEY=ADDR(ARGGR);            /* ADDRESS OF KEY        @Y30LB11*/
         LA    @14,ARGGR                                           0781
         ST    @14,RPLVKEY(,RPLVPTR)                               0781
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0782
*   RPLVKGE=ON;                     /* READ KEY >= ON        @Y30LB11*/
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0783
*   MSGTEXT1=ADDR(ARGGP);           /* INSERT TEXT           @Y30LB11*/
         LA    @14,ARGGP                                           0784
         STCM  @14,7,MSGTEXT1                                      0784
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @Y30LB11*/
         MVI   MSGLEN1,X'08'                                       0785
*   MSGID=M415;                     /* GVSNE NOT FOUND       @Y30LB11*/
         MVC   MSGID(4),@CF00160                                   0786
*   CALL COMONRTN;                  /* GET GVSNE RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0787
*   IF RETCOD^=0×                   /* RECORD NOT HANDLED?   @Y30LB11*/
*       GVSGVSEX=OFF THEN           /* NOT EXTENSION RECORD? @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0788
         BNZ   @RT00788                                            0788
         L     @14,GVSNEPTR(,RPLVPTR)                              0788
         TM    GVSGVSEX(@14),B'01000000'                           0788
         BNZ   @RF00788                                            0788
@RT00788 DS    0H                                                  0789
*     DO;                           /* NO,BAD                @Y30LB11*/
*       SAVGRPCD=R232;              /* SET REASON CODE       @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00188                                0790
*       RETURN CODE(4);             /* RETURN TO GVSCODE     @Y30LB11*/
         LA    @15,4                                               0791
         L     @14,@SA00007                                        0791
         LM    @00,@12,@SA00007+8                                  0791
         BR    @14                                                 0791
*     END;                          /*                       @Y30LB11*/
*   LAST=GVSESIND-1;                /* INITIALIZE LAST SLOT  @Y30LB11*/
@RF00788 L     @14,GVSNEPTR(,RPLVPTR)                              0793
         LH    @14,GVSESIND(,@14)                                  0793
         BCTR  @14,0                                               0793
         STH   @14,LAST                                            0793
*   IF SCRTCHSW=OFF THEN            /* SPECIFIC RECORD READ? @Y30LB11*/
         TM    SCRTCHSW,B'00100000'                                0794
         BNZ   @RF00794                                            0794
*     DO;                           /* YES                   @Y30LB11*/
*       CALL GVSCODE;               /* READ RECORD(S)        @Y30LB11*/
         BAL   @14,GVSCODE                                         0796
*       IF RETCOD^=0 THEN           /* RECORD READ?          @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0797
         BZ    @RF00797                                            0797
*         RETURN CODE(4);           /* GOOD RETURN CODE      @Y30LB11*/
         LA    @15,4                                               0798
         L     @14,@SA00007                                        0798
         LM    @00,@12,@SA00007+8                                  0798
         BR    @14                                                 0798
*     END;                          /*                       @Y30LB11*/
@RF00797 DS    0H                                                  0800
*   RETURN CODE(0);                 /* GOOD RETURN CODE      @Y30LB11*/
@RF00794 SLR   @15,@15                                             0800
         L     @14,@SA00007                                        0800
         LM    @00,@12,@SA00007+8                                  0800
         BR    @14                                                 0800
*   END GVSRECRD;                   /* END GVSRECRD          @Y30LB11*/
*                                                                  0802
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0802
*01*  NAME = GVSCODE                                         @Y30LB11
*                                                                  0802
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO LOOP THROUGH THE     0802
*                SLOTS IN THE GVSNE LOOKING FOR A MATCH ON THE     0802
*                VOLID IN ORDER TO UPDATE MOUNT STATUS.            0802
*                 IF THE APPROPRIATE SLOT IS NOT FOUND,            0802
*                RETURN IS MADE TO THE MAIN PROGRAM AND THEN TO    0802
*                THE USER.                                   @Y30LB11
*                                                                  0802
*02*    INPUT = RPLV                                         @Y30LB11
*                                                                  0802
*02*    OUTPUT = UPDATED GVSNE                               @Y30LB11
*                                                                  0802
**** END OF SPECIFICATIONS **                                        */
*                                                                  0802
*GVSCODE:                                                          0802
*   PROCEDURE;                      /*                       @Y30LB11*/
GVSCODE  STM   @14,@12,@SA00008                                    0802
*   DO WHILE I=I;                   /* LOOPING PROCEDURE     @Y30LB11*/
         B     @DE00803                                            0803
@DL00803 DS    0H                                                  0804
*     DO I=1 TO LAST;               /* ITERATE THRU SLOTS    @Y30LB11*/
         LA    @14,1                                               0804
         B     @DE00804                                            0804
@DL00804 DS    0H                                                  0805
*       IF MDVOL=GVSVOLID(I) THEN   /* MOUNT VOLID SLOT &    @Y30LB11*/
         MH    @14,@CH00325                                        0805
         L     @04,GVSNEPTR(,RPLVPTR)                              0805
         ST    @14,@TF00001                                        0805
         ALR   @14,@04                                             0805
         CLC   MDVOL+132(6,RPLVPTR),GVSVOLID-20(@14)               0805
         BNE   @RF00805                                            0805
*         DO;                       /* YES                   @Y30LB11*/
*           IF RSTRSW=OFF THEN      /* UPDATE RECORD?        @Y30LB11*/
         TM    RSTRSW,B'01000000'                                  0807
         BNZ   @RF00807                                            0807
*             GVSCPUBM(I)=GVSCPUBM(I)×CPU;/* SET GVSNE CPUID @Y30LB11*/
         AL    @04,@TF00001                                        0808
         OC    GVSCPUBM-20(2,@04),CPU                              0808
*           ELSE                    /* OTHERWISE             @Y30LB11*/
*             DO;                   /*                       @ZA11665*/
         B     @RC00807                                            0809
@RF00807 DS    0H                                                  0810
*               GVSCPUBM(I)=GVSCPUBM(I)&&CPU;/* RSTR CPUID   @Y30LB11*/
         LH    @14,I                                               0810
         MH    @14,@CH00325                                        0810
         L     @04,GVSNEPTR(,RPLVPTR)                              0810
         ST    @14,@TF00001                                        0810
         ALR   @14,@04                                             0810
         XC    GVSCPUBM-20(2,@14),CPU                              0810
*               GVSEXPDT(I)=GXPDTOLD;/* REST GRP EXT EXPDT   @ZA11665*/
         AL    @04,@TF00001                                        0811
         MVC   GVSEXPDT-20(4,@04),GXPDTOLD                         0811
*             END;                  /*                       @ZA11665*/
*           CALL AMVGVSUD;          /* MORE GVSNE UPDATE     @G24LB04*/
*                                                                  0813
@RC00807 BAL   @14,AMVGVSUD                                        0813
*           /*********************************************************/
*           /*                                                       */
*           /* NOTE RETURN CODE IS NOT CHECKED BECAUSE MSVC DOES NOT */
*           /* FAIL MOUNT SPECIFIC, WHICH IS THE ONLY PATH THROUGH   */
*           /* HERE FOR WHICH AMVGVSUD COULD RETURN A FAILURE CODE   */
*           /*                                               @G24LB04*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0814
*           RPLVTYP=RPLVPUT;        /* VIO PUT SW ON         @Y30LB11*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0814
*           CALL COMONRTN;          /* PUT GVSNE RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0815
*           IF RETCOD^=0 THEN       /* RECORD NOT HANDLED?   @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0816
         BZ    @RF00816                                            0816
*             DO;                   /* NO,BAD                @Y30LB11*/
*               SAVGRPCD=R232;      /* SET REASON CODE       @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00188                                0818
*               RETURN CODE(4);     /* RETURN TO GVSCODE     @Y30LB11*/
         LA    @15,4                                               0819
         L     @14,@SA00008                                        0819
         LM    @00,@12,@SA00008+8                                  0819
         BR    @14                                                 0819
*             END;                  /*                       @Y30LB11*/
*           RETURN CODE(0);         /* GOOD RETURN CODE      @Y30LB11*/
@RF00816 SLR   @15,@15                                             0821
         L     @14,@SA00008                                        0821
         LM    @00,@12,@SA00008+8                                  0821
         BR    @14                                                 0821
*         END;                      /* CHECK NEXT SLOT       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RF00805 LA    @14,1                                               0823
         AH    @14,I                                               0823
@DE00804 STH   @14,I                                               0823
         CH    @14,LAST                                            0823
         BNH   @DL00804                                            0823
*     IF GVSEX=ON THEN              /* ANOTHER RECORD EXIST? @Y30LB11*/
         L     @14,GVSNEPTR(,RPLVPTR)                              0824
         TM    GVSEX(@14),B'10000000'                              0824
         BNO   @RF00824                                            0824
*       DO;                         /* READ NEXT RECORD      @Y30LB11*/
*         RPLVDIR=OFF;              /* DIRECT OFF            @Y30LB11*/
*         RPLVNEXT=ON;              /* READ NEXT             @Y30LB11*/
         OI    RPLVNEXT(RPLVPTR),B'00100000'                       0827
         NI    RPLVDIR(RPLVPTR),B'10111111'                        0827
*         CALL COMONRTN;            /* GET GVSNE RECORD      @Y30LB11*/
         BAL   @14,COMONRTN                                        0828
*         IF RETCOD^=0×             /* RECORD NOT HANDLED?   @Y30LB11*/
*             GVSGVSEX=OFF THEN     /* NOT EXTENSION RECORD? @Y30LB11*/
         LTR   RETCOD,RETCOD                                       0829
         BNZ   @RT00829                                            0829
         L     @14,GVSNEPTR(,RPLVPTR)                              0829
         TM    GVSGVSEX(@14),B'01000000'                           0829
         BNZ   @RF00829                                            0829
@RT00829 DS    0H                                                  0830
*           DO;                     /* NO,BAD                @Y30LB11*/
*             SAVGRPCD=R232;        /* SET REASON CODE       @Y30LB11*/
         MVC   SAVGRPCD(2),@CB00188                                0831
*             RETURN CODE(4);       /* RETURN TO GVSCODE     @Y30LB11*/
         LA    @15,4                                               0832
         L     @14,@SA00008                                        0832
         LM    @00,@12,@SA00008+8                                  0832
         BR    @14                                                 0832
*           END;                    /*                       @Y30LB11*/
*         LAST=GVSESIND-1;          /* INITIALIZE LAST SLOT  @Y30LB11*/
@RF00829 L     @14,GVSNEPTR(,RPLVPTR)                              0834
         LH    @14,GVSESIND(,@14)                                  0834
         BCTR  @14,0                                               0834
         STH   @14,LAST                                            0834
*       END;                        /*                       @Y30LB11*/
*     ELSE                          /* OTHERWISE             @Y30LB11*/
*       RETURN CODE(4);             /* RETURN TO CALLER      @Y30LB11*/
         B     @RC00824                                            0836
@RF00824 LA    @15,4                                               0836
         L     @14,@SA00008                                        0836
         LM    @00,@12,@SA00008+8                                  0836
         BR    @14                                                 0836
*   END;                            /*                       @Y30LB11*/
@RC00824 DS    0H                                                  0837
@DE00803 LH    @14,I                                               0837
         CR    @14,@14                                             0837
         BE    @DL00803                                            0837
*   END GVSCODE;                    /* END                   @G24LB04*/
@EL00008 DS    0H                                                  0838
@EF00008 DS    0H                                                  0838
@ER00008 LM    @14,@12,@SA00008                                    0838
         BR    @14                                                 0838
*                                                                  0839
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0839
*01*  NAME = JFCBCK                                          @Y30LB11
*                                                                  0839
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE WHETHER    0839
*                THE VOLUME SELECTED FROM THE GVSNE RECORD IS ALREADY
*                IN THE JFCB OR ITS EXTENTIONS.  IF IT IS A NEW VOLUME
*                MUST BE SELECTED.                           @Y30LB11
*                                                                  0839
*02*    INPUT = GVSNE RECORD                                 @Y30LB11
*                                                                  0839
*02*    OUTPUT = RETURN=0 - VOLID NOT FOUND                  @Y30LB11
*                RETURN=4 - VOLID FOUND                      @Y30LB11
*                                                                  0839
**** END OF SPECIFICATIONS **                                        */
*                                                                  0839
*JFCBCK:                            /* JFCB CHECKING ROUTINE @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
JFCBCK   STM   @14,@12,12(@13)                                     0839
*   IF NVOLINDX>0 THEN              /* ITERATE THROUGH JFCBN @Y30LB11*/
         CLI   NVOLINDX,0                                          0840
         BNH   @RF00840                                            0840
*     DO;                           /*                       @Y30LB11*/
*       DO J=1 TO 5;                /* INDEX THRU JFCB       @Y30LB11*/
         LA    J,1                                                 0842
@DL00842 DS    0H                                                  0843
*         IF JFCAVOLS(J)=GVSVOLID(I) THEN/* VOLID FOUND?     @Y30LB11*/
         LR    @14,J                                               0843
         MH    @14,@CH00091                                        0843
         LH    @07,I                                               0843
         MH    @07,@CH00325                                        0843
         L     @04,GVSNEPTR(,RPLVPTR)                              0843
         L     @09,JFCBPTR                                         0843
         ALR   @09,@14                                             0843
         ALR   @04,@07                                             0843
         CLC   JFCAVOLS-6(6,@09),GVSVOLID-20(@04)                  0843
         BNE   @RF00843                                            0843
*           RETURN CODE(4);         /* RETURN CODE           @Y30LB11*/
         LA    @15,4                                               0844
         L     @14,12(,@13)                                        0844
         LM    @00,@12,20(@13)                                     0844
         BR    @14                                                 0844
*         ELSE                      /* OTHERWISE             @Y30LB11*/
*           NVOLINDX=NVOLINDX-1;    /* REDUCE NVOLINDX       @Y30LB11*/
@RF00843 SLR   @14,@14                                             0845
         IC    @14,NVOLINDX                                        0845
         BCTR  @14,0                                               0845
         STC   @14,NVOLINDX                                        0845
*       END;                        /*                       @Y30LB11*/
         AL    J,@CF00112                                          0846
         C     J,@CF00089                                          0846
         BNH   @DL00842                                            0846
*     END;                          /*                       @Y30LB11*/
*   JXPTRFX=JPTRFX+176;             /* INIT BASE             @Y30LB11*/
@RF00840 LA    @14,176                                             0848
         AL    @14,JPTRFX                                          0848
         ST    @14,JXPTRFX                                         0848
*   DO WHILE NVOLINDX>0;            /* ITERATE THROUGH JFCB  @Y30LB11*/
         B     @DE00849                                            0849
@DL00849 DS    0H                                                  0850
*     DO J=1 TO 15;                 /* INDEX THRU JFCB EXTS  @Y30LB11*/
         LA    J,1                                                 0850
@DL00850 DS    0H                                                  0851
*       IF JFCBXVOL(J)=GVSVOLID(I) THEN/* VOLID FOUND?       @Y30LB11*/
         LR    @14,J                                               0851
         MH    @14,@CH00091                                        0851
         LH    @07,I                                               0851
         MH    @07,@CH00325                                        0851
         L     @04,GVSNEPTR(,RPLVPTR)                              0851
         L     @09,JFCBXPTR                                        0851
         ALR   @09,@14                                             0851
         BCTR  @09,0                                               0851
         BCTR  @09,0                                               0851
         ALR   @04,@07                                             0851
         CLC   JFCBXVOL-4(6,@09),GVSVOLID-20(@04)                  0851
         BNE   @RF00851                                            0851
*         RETURN CODE(4);           /* RETURN CODE           @Y30LB11*/
         LA    @15,4                                               0852
         L     @14,12(,@13)                                        0852
         LM    @00,@12,20(@13)                                     0852
         BR    @14                                                 0852
*       ELSE                        /* OTHERWISE             @Y30LB11*/
*         NVOLINDX=NVOLINDX-1;      /* REDUCE NVOLINDX       @Y30LB11*/
@RF00851 SLR   @14,@14                                             0853
         IC    @14,NVOLINDX                                        0853
         BCTR  @14,0                                               0853
         STC   @14,NVOLINDX                                        0853
*     END;                          /*                       @Y30LB11*/
         AL    J,@CF00112                                          0854
         C     J,@CF00085                                          0854
         BNH   @DL00850                                            0854
*     JXPTRFX=JXPTRFX+LENGTH(JFCBX);/* NEXT EXT RECORD       @Y30LB11*/
         LA    @14,176                                             0855
         AL    @14,JXPTRFX                                         0855
         ST    @14,JXPTRFX                                         0855
*   END;                            /*                       @Y30LB11*/
@DE00849 CLI   NVOLINDX,0                                          0856
         BH    @DL00849                                            0856
*   RETURN CODE(0);                 /* VOLID NOT FOUND       @Y30LB11*/
         SLR   @15,@15                                             0857
         L     @14,12(,@13)                                        0857
         LM    @00,@12,20(@13)                                     0857
         BR    @14                                                 0857
*   END JFCBCK;                     /*                       @Y30LB11*/
*                                                                  0859
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0859
*01*  NAME = UCBCK                                           @Y30LB11
*                                                                  0859
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE WHETHER    0859
*                THE VOLUME SELECTED FROM THE GVSNE RECORD IS ALREADY
*                IN THE UCB LIST.  IF IT IS A NEW VOLUME MUST BE   0859
*                SELECTED.                                   @Y30LB11
*                                                                  0859
*02*    INPUT = GVSNE RECORD                                 @Y30LB11
*                                                                  0859
*02*    OUTPUT = RETURN=0 - VOLID NOT FOUND                  @Y30LB11
*                RETURN=4 - VOLID FOUND                      @Y30LB11
*                                                                  0859
**** END OF SPECIFICATIONS **                                        */
*                                                                  0859
*   DCL                                                            0859
*     TENQVOL CHAR(6) BDY(WORD);    /*                       @ZA11687*/
*   DCL                                                            0860
*     MAJRNAM CHAR(8) BDY(WORD) INIT('SYSZVOLS');/*          @ZA11687*/
*UCBCK:                             /* UCB CK RTN (VS/2 ONLY)      0861
*                                                            @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
UCBCK    STM   @14,@12,@SA00010                                    0861
*   UCBPR1=VVIUCB;                  /* INITIALIZE UCBPR1 PTR @Y30LB11*/
         L     @14,VVIUCB(,VVIPTR)                                 0862
         LR    UCBPR1,@14                                          0862
*   IF VVIUCB=0 THEN                /* NO UCB LIST           @Y30LB11*/
         SLR   @09,@09                                             0863
         CR    @14,@09                                             0863
         BNE   @RF00863                                            0863
*     RETURN CODE(0);               /* RETURN W/0 TESTING    @Y30LB11*/
         LR    @15,@09                                             0864
         L     @14,@SA00010                                        0864
         LM    @00,@12,@SA00010+8                                  0864
         BR    @14                                                 0864
*   DO WHILE UCBPR2>FOXES;          /* END OF TABLE?         @Y30LB11*/
@RF00863 B     @DE00865                                            0865
@DL00865 DS    0H                                                  0866
*     IF UCBVOLI=GVSVOLID(I) THEN   /* VOLID FOUND?          @Y30LB11*/
         L     @14,UCBPTR(,UCBPR1)                                 0866
         LH    @09,I                                               0866
         MH    @09,@CH00325                                        0866
         L     @07,GVSNEPTR(,RPLVPTR)                              0866
         ALR   @07,@09                                             0866
         CLC   UCBVOLI(6,@14),GVSVOLID-20(@07)                     0866
         BNE   @RF00866                                            0866
*       RETURN CODE(4);             /* BAD RETURN CODE       @Y30LB11*/
         LA    @15,4                                               0867
         L     @14,@SA00010                                        0867
         LM    @00,@12,@SA00010+8                                  0867
         BR    @14                                                 0867
*     ELSE                          /* OTHERWISE             @Y30LB11*/
*       UCBPR1=UCBPR1+4;            /* GET NEXT VIRTUAL UCB  @Y30LB11*/
@RF00866 AL    UCBPR1,@CF00087                                     0868
*   END;                            /*                       @Y30LB11*/
@DE00865 L     @14,UCBPR2(,UCBPR1)                                 0869
         LTR   @14,@14                                             0869
         BNM   @DL00865                                            0869
*   TENQVOL=GVSVOLID(I);            /*                       @ZA11687*/
         LH    @14,I                                               0870
         MH    @14,@CH00325                                        0870
         L     @09,GVSNEPTR(,RPLVPTR)                              0870
         ALR   @09,@14                                             0870
         MVC   TENQVOL(6),GVSVOLID-20(@09)                         0870
*   GEN REFS(MAJRNAM,TENQVOL);                                     0871
*                                   /*                       @ZA11687*/
LENQ1    ENQ  (MAJRNAM,TENQVOL,E,6,SYSTEM),RET=TEST
*   IF RETCOD^=0 THEN                                              0872
         LTR   RETCOD,RETCOD                                       0872
         BZ    @RF00872                                            0872
*     RETURN CODE(4);               /*                       @ZA11687*/
         LA    @15,4                                               0873
         L     @14,@SA00010                                        0873
         LM    @00,@12,@SA00010+8                                  0873
         BR    @14                                                 0873
*   RETURN CODE(0);                 /* VOL NOT FOUND         @Y30LB11*/
@RF00872 SLR   @15,@15                                             0874
         L     @14,@SA00010                                        0874
         LM    @00,@12,@SA00010+8                                  0874
         BR    @14                                                 0874
*   END UCBCK;                      /*                       @Y30LB11*/
*                                                                  0876
*/*  START OF SPECIFICATIONS ****                            @Y30LB11
*                                                                  0876
*01*  NAME = COMONRTN                                        @Y30LB11
*                                                                  0876
*01*  FUNCTION = THIS SUBROUTINE IS CALLED A RECORD NEEDS TO BE    0876
*                RETRIEVED OR PUT OUT.  THE ORIGINAL CALLING       0876
*                SUBROUTINE MUST SET UP THE CALL FOR VSAM.   @Y30LB11
*                                                                  0876
*02*    INPUT = VSAM PARAMETERS                              @Y30LB11
*                                                                  0876
*02*    OUTPUT = DESIRED RECORD IN LOCATE OR MOVE MOVE       @Y30LB11
*                                                                  0876
**** END OF SPECIFICATIONS **                                        */
*                                                                  0876
*COMONRTN:                          /* COMONRTN ROUTINE      @Y30LB11*/
*   PROCEDURE;                      /*                       @Y30LB11*/
COMONRTN STM   @14,@12,@SA00011                                    0876
*   RPLVBUF=ADDR(GVSBUFR);          /* INITIALIZE GVSNE PTR  @Y30LB11*/
         LA    @14,GVSBUFR                                         0877
         ST    @14,RPLVBUF(,RPLVPTR)                               0877
*   RPLVBLN=LENGTH(GVSBUFR);        /* BUFFER LENGTH         @Y30LB11*/
         MVC   RPLVBLN(4,RPLVPTR),@CF00331                         0878
*   REG1=RPLVPTR;                   /* REG1 PARAMETER        @Y30LB11*/
         LR    REG1,RPLVPTR                                        0879
*   CALL ICBVIO00;                  /* GET RECORD            @Y30LB11*/
         L     @15,@CV00249                                        0880
         BALR  @14,@15                                             0880
*   IF RPLVRETC^=Z2 THEN            /* RECORD HANDLED?       @Y30LB11*/
         CLC   RPLVRETC(2,RPLVPTR),Z2                              0881
         BE    @RF00881                                            0881
*     DO;                           /* NO                    @Y30LB11*/
*       IF RPLVTYP=RPLVREAD THEN    /* RECORD FOUND?         @Y30LB11*/
         CLI   RPLVTYP(RPLVPTR),0                                  0883
         BNE   @RF00883                                            0883
*         DO;                       /* NO                    @Y30LB11*/
*           SAVRETC=RPLVRETC;       /* SAVE RETURN CODE      @Y30LB11*/
         MVC   SAVRETC(2),RPLVRETC(RPLVPTR)                        0885
*           SAVRCODE=RPLRCODE;      /* SAVE REASON CODE      @Y30LB11*/
         MVC   SAVRCODE(2),RPLRCODE(RPLVPTR)                       0886
*           MSGRPLV=RPLVPTR;        /* MSVC RPLV ADDR        @Y30LB11*/
         ST    RPLVPTR,MSGRPLV                                     0887
*           REG1=ADDR(MSGRQ);       /* REG1 PARM             @Y30LB11*/
         LA    REG1,MSGRQ                                          0888
*           CALL ICBVOP00;          /* OPER/LIB ROUTINE      @Y30LB11*/
         L     @15,@CV00250                                        0889
         BALR  @14,@15                                             0889
*           RPLVRETC=SAVRETC;       /* RESET RETURN CODE     @Y30LB11*/
         MVC   RPLVRETC(2,RPLVPTR),SAVRETC                         0890
*           RPLRCODE=SAVRCODE;      /* RESET REASON CODE     @Y30LB11*/
         MVC   RPLRCODE(2,RPLVPTR),SAVRCODE                        0891
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RF00883 DS    0H                                                  0894
*   RETURN CODE(RPLVRETC);          /* RETURN TO CALLER      @Y30LB11*/
@RF00881 LH    @15,RPLVRETC(,RPLVPTR)                              0894
         N     @15,@CF02120                                        0894
         L     @14,@SA00011                                        0894
         LM    @00,@12,@SA00011+8                                  0894
         BR    @14                                                 0894
*   END COMONRTN;                   /*                       @Y30LB11*/
*                                                                  0896
*   /*****************************************************************/
*   /*                                                               */
*   /* NAME - JOURNAL                                        @ZA11665*/
*   /*                                                       @ZA11665*/
*   /* FUNCTION - THIS ROUTINE JOURNALS THE RPLV AND         @ZA11665*/
*   /* IS CALLED AFTER THE FIRST SUCCESSFUL UPDATE           @ZA11015*/
*   /* OF THE INVENTORY DATA SET.                            @ZA11665*/
*   /*                                                       @ZA11665*/
*   /* INPUT - MDVOL, GXPDT                                  @ZA11665*/
*   /*                                                       @ZA11665*/
*   /* OUTPUT - DUMMY RPLV FOR MVR                           @ZA11665*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0896
*JOURNAL:                                                          0896
*   PROC;                           /*                       @ZA11015*/
*                                                                  0896
JOURNAL  STM   @14,@04,@SA00012                                    0896
         STM   @06,@12,@SA00012+28                                 0896
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PART OF PROCEDURE WILL SET UP THE RPLV.          @ZA11665*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0897
*   DRPLV=DRPLV&&DRPLV;             /* ZERO OUT RPLV         @ZA11015*/
         XC    DRPLV(220),DRPLV                                    0897
*   SAVEPTR=RPLVPTR;                /* SAVE PRLVPTR          @ZA11665*/
         LR    SAVEPTR,RPLVPTR                                     0898
*   RPLVPTR=ADDR(DRPLV);            /* ADDR DUMMY RPLV       @ZA11665*/
         LA    RPLVPTR,DRPLV                                       0899
*   RPLVTLEN=LENGTH(RPLV)+LENGTH(MVR);/* RPLV LENGTH         @ZA11665*/
         MVC   RPLVTLEN(2,RPLVPTR),@CH02098                        0900
*   RPLVVICB=VVIPTR;                /* SET VVICB PTR         @ZA11665*/
         ST    VVIPTR,RPLVVICB(,RPLVPTR)                           0901
*   MVRPTR=ADDR(RPLVUTIL);          /* ADDR FOR MVR IN RPLV  @ZA17172*/
         LA    MVRPTR,RPLVUTIL(,RPLVPTR)                           0902
*   RPLVPTR=SAVEPTR;                /* RESTORE RPLVPTR       @ZA17172*/
*                                                                  0903
         LR    RPLVPTR,SAVEPTR                                     0903
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP MODIFY VOLUME                                  @ZA11665*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0904
*   MVROPCD=MVROP;                  /* SET MVR OP CODE       @ZA11665*/
         MVI   MVROPCD(MVRPTR),X'85'                               0904
*   MVRLNGTH=LENGTH(MVR);           /* MODV LENGTH           @ZA11665*/
         MVC   MVRLNGTH(4,MVRPTR),@CF00312                         0905
*   MVRFLBAS=ON;                    /* BASE VOLUME SPEC      @ZA11665*/
*   MVRFLTO=ON;                     /* EXPIR DATE SPEC       @ZA11665*/
         OI    MVRFLBAS(MVRPTR),B'00101000'                        0907
*   MVRBVOL=MDVOL;                  /* VOLID                 @ZA11665*/
         MVC   MVRBVOL(6,MVRPTR),MDVOL+132(RPLVPTR)                0908
*   MVRTO=BASEXPDT;                 /* EXPIR DATE            @ZA17172*/
*                                                                  0909
         L     @14,BASEVPTR(,RPLVPTR)                              0909
         MVC   MVRTO(4,MVRPTR),BASEXPDT(@14)                       0909
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE THE JOURNAL DATA SET                          @ZA11015*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0910
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @ZA17172*/
         LR    REG1,RPLVPTR                                        0910
*   REG0=RESEXVJL;                  /* INDICATE JOURNAL      @ZA11015*/
         LA    REG0,17                                             0911
*   CALL ICBVRR00;                  /* RESERVE JOURNAL       @ZA11015*/
*                                                                  0912
         L     @15,@CV00248                                        0912
         BALR  @14,@15                                             0912
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO JOURNAL THE RPLV                      @ZA11015*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0913
*   REG1=ADDR(DRPLV);               /* ADDR OF RPLV          @ZA17172*/
         LA    REG1,DRPLV                                          0913
*   CALL ICBVJL00;                  /* JOURNAL REQUEST BLK   @ZA11015*/
*                                                                  0914
         L     @15,@CV00251                                        0914
         BALR  @14,@15                                             0914
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ROUTINE TO RELEASE JOURNAL DATA SET              @ZA11015*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @ZA17172*/
         LR    REG1,RPLVPTR                                        0915
*   REG0=DEQJRNL;                   /* INDICATE FREE JOURNAL @ZA11015*/
         LA    REG0,16                                             0916
*   CALL ICBVRR00;                  /* FREE IT               @ZA11015*/
*                                                                  0917
         L     @15,@CV00248                                        0917
         BALR  @14,@15                                             0917
*   /*****************************************************************/
*   /*                                                               */
*   /* MAKE IT APPEAR THAT JOURNALING WAS SUCCESSFUL         @ZA11015*/
*   /* EVEN IF IT WAS NOT.                                   @ZA11015*/
*   /* SET SWITCH INDICATING IT HAS BEEN JOURNALED           @ZA11015*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0918
*   RPLVRETC=R000;                  /* ZERO RETURN           @ZA11015*/
         MVC   RPLVRETC(2,RPLVPTR),@CB00170                        0918
*   RPLRCODE=R000;                  /* ZERO REASON CODE      @ZA11015*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0919
*   JRNLFLG=OFF;                    /* END JOURNALLING       @ZA11015*/
         NI    JRNLFLG,B'11110111'                                 0920
*   RETURN;                         /*                       @ZA11015*/
@EL00012 DS    0H                                                  0921
@EF00012 DS    0H                                                  0921
@ER00012 LM    @14,@04,@SA00012                                    0921
         LM    @06,@12,@SA00012+28                                 0921
         BR    @14                                                 0921
*   END JOURNAL;                    /*                       @ZA11015*/
*                                                                  0923
*/*  START OF SPECIFICATIONS ****                            @G24LB04
*                                                                  0923
*01*  NAME = AMVGVSUD                                        @G24LB04
*                                                                  0923
*01*  FUNCTION = GROUP EXTENSION RECORD UPDATE FOR ALLOCATE  @G24LB04
*                TO MOUNTED VOLUMES SUPPORT                  @G24LB04
*                                                                  0923
*02*  INPUT = ADDRESSABILITY TO GVSNE AND RPLV WITH JFCB AND @G24LB04
*             MOUNT PARAMETER LIST(GVSNE SLOT INDEXED BY I). @G24LB04
*                                                                  0923
*02*  OUTPUT = FOR SUCCESS (RETURN CODE ZERO)                @G24LB04
*              GVSNE UPDATED THUS --                         @G24LB04
*              FOR MOUNT FOR GENERAL-USE VOLUME,             @G24LB04
*                HOST SHAREABILITY IS SET ACCORDING TO UCB   @G24LB04
*              FOR MOUNT FOR GENERAL-USE VOLUME NOT IN       @G24LB04
*              SYSGROUP, ON A NONSPECIFIC REQUEST WITH NO    @G24LB04
*              VOLUMES IN THE JFCB,                          @G24LB04
*                THE AMOUNT OF PRIMARY EXTENT IS SUBTRACTED  @G24LB04
*                FROM THE RUNNING COUNT OF FREE SPACE        @G24LB04
*              FOR MOUNT FAILURE FOR GENERAL-USE VOLUME,     @G24LB04
*                1) IF VOLUME IS MOUNTED TO NO HOST, THE     @G24LB04
*                   MOUNTED NON-SHARE INDICATOR IS SET OFF   @G24LB04
*                2) IF NOT IN SYSGROUP, NO VOLUMES IN JFCB   @G24LB04
*                   FOR NONSPECIFIC REQUEST, THE AMOUNT OF   @G24LB04
*                   THE PRIMARY EXTENT IS ADDED TO THE       @G24LB04
*                   RUNNING COUNT OF FREE SPACE              @G24LB04
*              FOR FAILURE (RETURN CODE FOUR)                @G24LB04
*              (ONLY CAN BE INCURRED FOR FIRST ENTRY FOR A   @G24LB04
*              REQUEST)                                      @G24LB04
*                GVSNE SET TO SHOW MOUNTED NON-SHAREABLE     @G24LB04
*                                                                  0923
**** END OF SPECIFICATIONS ***                               @G24LB04*/
*                                                                  0923
*AMVGVSUD:                          /* GVSNE UPDATE          @G24LB04*/
*   PROCEDURE;                      /*                       @G24LB04*/
AMVGVSUD STM   @14,@12,@SA00013                                    0923
*   IF RPLFTIME=OFF                 /* MOUNT                 @G24LB04*/
*     THEN                          /* FIRST ENTRY,          @G24LB04*/
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0924
         BNZ   @RF00924                                            0924
*     DO;                           /* NOT FAILURE           @G24LB04*/
*       CALL FINDUCB;               /* GET UCB ADDRESS       @G24LB04*/
         BAL   @14,FINDUCB                                         0926
*       IF RETCOD=0                 /* WAS UCB FOUND?        @G24LB04*/
*         THEN                      /* YES                   @G24LB04*/
         LTR   RETCOD,RETCOD                                       0927
         BNZ   @RF00927                                            0927
*         IF FOUNDUCB->UCBRR=OFF    /* SHAREABLE BETW CPUS?  @G24LB04*/
*           THEN                    /*                       @G24LB04*/
         L     @14,FOUNDUCB                                        0928
         TM    UCBRR(@14),B'00100000'                              0928
         BNZ   @RF00928                                            0928
*           GVSMTNSH(I)=ON;         /* MARK NOT SHAREABLE    @G24LB04*/
         LH    @14,I                                               0929
         MH    @14,@CH00325                                        0929
         L     @04,GVSNEPTR(,RPLVPTR)                              0929
         ALR   @04,@14                                             0929
         OI    GVSMTNSH-20(@04),B'01000000'                        0929
*         ELSE                                                     0930
*           ;                       /*                       @G24LB04*/
@RF00928 DS    0H                                                  0931
*       ELSE                                                       0931
*         DO;                       /* UCB NOT FOUND, ERROR  @G24LB04*/
         B     @RC00927                                            0931
@RF00927 DS    0H                                                  0932
*           GVSMTNSH(I)=ON;         /* SET NOT SHAREABLE AND @G24LB04*/
         LH    @14,I                                               0932
         MH    @14,@CH00325                                        0932
         L     @04,GVSNEPTR(,RPLVPTR)                              0932
         ALR   @04,@14                                             0932
         OI    GVSMTNSH-20(@04),B'01000000'                        0932
*           RETURN CODE(4);         /* SET TO FAIL IF REQ.   @G24LB04*/
         LA    @15,4                                               0933
         L     @14,@SA00013                                        0933
         LM    @00,@12,@SA00013+8                                  0933
         BR    @14                                                 0933
*         END;                      /* CONTINUE PROCESSING   @G24LB04*/
*       IF MDSRTCH=ON&              /* MOUNT NON-SPECIFIC?   @G24LB04*/
*           GVSVVGRP^=SYSGRP&       /* NOT IN SYSGROUP?      @G24LB04*/
*           JFCBNVOL=Z1             /* NO VOLUMES IN JFCB?   @G24LB04*/
*         THEN                      /* UPDATE RUNNING COUNT  @G24LB04*/
@RC00927 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0935
         BNO   @RF00935                                            0935
         L     @14,GVSNEPTR(,RPLVPTR)                              0935
         CLC   GVSVVGRP(8,@14),@CC00214                            0935
         BE    @RF00935                                            0935
         L     @14,JFCBPTR                                         0935
         CLC   JFCBNVOL(1,@14),Z1                                  0935
         BNE   @RF00935                                            0935
*         DO;                       /* OF FREE SPACE         @G24LB04*/
*           CALL PRISCALC;          /* CALC IN CYLINDERS     @G24LB04*/
         BAL   @14,PRISCALC                                        0937
*           GVSMTDSP(I)=GVSMTDSP(I)-PRIQUANC;/* DECREMENT    @G24LB04*/
         LH    @14,I                                               0938
         MH    @14,@CH00325                                        0938
         L     @06,GVSNEPTR(,RPLVPTR)                              0938
         LH    @04,GVSMTDSP-20(@14,@06)                            0938
         SLR   @04,PRIQUANC                                        0938
         STH   @04,GVSMTDSP-20(@14,@06)                            0938
*         END;                      /*                       @G24LB04*/
*     END;                          /* END 1ST TIME PROCESS  @G24LB04*/
*   ELSE                            /* MOUNT FAILURE         @G24LB04*/
*     DO;                           /* SECOND CALL           @G24LB04*/
         B     @RC00924                                            0941
@RF00924 DS    0H                                                  0942
*       IF GVSCPUBM(I)=Z2 THEN      /* MOUNTED TO NO CPU?    @G24LB04*/
         LH    @14,I                                               0942
         MH    @14,@CH00325                                        0942
         L     @04,GVSNEPTR(,RPLVPTR)                              0942
         ST    @14,@TF00001                                        0942
         ALR   @14,@04                                             0942
         CLC   GVSCPUBM-20(2,@14),Z2                               0942
         BNE   @RF00942                                            0942
*         GVSMTNSH(I)=OFF;          /* TURN OFF NON-SHARABLE @G24LB04*/
         AL    @04,@TF00001                                        0943
         NI    GVSMTNSH-20(@04),B'10111111'                        0943
*       IF MDSRTCH=ON&              /* MOUNT NON-SPECIFIC    @G24LB04*/
*           RSTRSW=ON&              /* RESTORING ?           @G24LB04*/
*           GVSVVGRP^=SYSGRP&       /* NOT IN SYSGROUP?      @G24LB04*/
*           JFCBNVOL=Z1             /* NO VOLUMES IN JFCB?   @G24LB04*/
*         THEN                                                     0944
@RF00942 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0944
         BNO   @RF00944                                            0944
         TM    RSTRSW,B'01000000'                                  0944
         BNO   @RF00944                                            0944
         L     @14,GVSNEPTR(,RPLVPTR)                              0944
         CLC   GVSVVGRP(8,@14),@CC00214                            0944
         BE    @RF00944                                            0944
         L     @14,JFCBPTR                                         0944
         CLC   JFCBNVOL(1,@14),Z1                                  0944
         BNE   @RF00944                                            0944
*         DO;                       /* UPDATE RUNNING COUNT  @G24LB04*/
*           CALL PRISCALC;          /* PRIMARY SPACE IN CYLS @G24LB04*/
         BAL   @14,PRISCALC                                        0946
*           GVSMTDSP(I)=GVSMTDSP(I)+PRIQUANC;/* ADD BACK IN  @G24LB04*/
         LH    @14,I                                               0947
         MH    @14,@CH00325                                        0947
         L     @06,GVSNEPTR(,RPLVPTR)                              0947
         LR    @04,PRIQUANC                                        0947
         AH    @04,GVSMTDSP-20(@14,@06)                            0947
         STH   @04,GVSMTDSP-20(@14,@06)                            0947
*         END;                      /* FREE SPACE UPDATE     @G24LB04*/
*     END;                          /*                       @G24LB04*/
@RF00944 DS    0H                                                  0950
*   RETURN CODE(0);                 /* GOOD RETURN           @G24LB04*/
@RC00924 SLR   @15,@15                                             0950
         L     @14,@SA00013                                        0950
         LM    @00,@12,@SA00013+8                                  0950
         BR    @14                                                 0950
*   END AMVGVSUD;                   /*                       @G24LB04*/
*                                                                  0952
*/*  START OF SPECIFICATIONS ****                            @G24LB04
*                                                                  0952
*01* NAME = FINDUCB                                          @G24LB04
*                                                                  0952
*01* FUNCTION = FIND UCB ADDRESS FOR VUA IN MOUNT REQUEST    @G24LB04
*               USES IOSGEN MACRO TO PERFORM LOOK-UP         @G24LB04
*                                                                  0952
*02* INPUT = ADDRESSABILITY TO MOUNT PARAMETER LIST          @G24LB04
*               AND TO GVSNE SLOT WITH VOLID, INDEXED BY I   @G24LB04
*                                                                  0952
*02* OUTPUT =  RETURN CODE OF ZERO WHEN UCB FOUND OK         @G24LB04
*                 ADDRESS OF UCB IN FOUNDUCB                 @G24LB04
*              RETURN CODE OF FOUR WHEN UCB LOOK UP FAILED   @G24LB04
*                 MESSAGE VIA ICBVOP00                       @G24LB04
*                                                                  0952
**** END OF SPECIFICATIONS ***                               @G24LB04*/
*                                                                  0952
*FINDUCB:                           /* FIND ONE UCB ADDRESS  @G24LB04*/
*   PROCEDURE;                      /*                       @G24LB04*/
*                                                                  0952
FINDUCB  STM   @14,@12,@SA00014                                    0952
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE REGS AROUND IOSGEN USE, RESTORE ASAP             @G24LB04*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0953
*   STM(REG13,REG15,SAV2UCBL);      /*                       @G24LB04*/
         STM   REG13,REG15,SAV2UCBL                                0953
*   STM(REG6,REG7,SAV3UCBL);        /*                       @G24LB04*/
         STM   REG6,REG7,SAV3UCBL                                  0954
*   RFY                                                            0955
*    (REG6,                                                        0955
*     REG7,                                                        0955
*     REG13) RSTD;                  /*                       @G24LB04*/
*   REG13=ADDR(SAV1UCBL);           /* SAVE AREA FOR IOSGEN  @G24LB04*/
         LA    REG13,SAV1UCBL                                      0956
*   REG6=MDVUA;                     /* VUA TO FIND UCB FOR   @G24LB04
*                                      USE IOSGEN MACRO      @G24LB04*/
         LH    REG6,MDVUA+132(,RPLVPTR)                            0957
*IOSGEN1:                           /*                       @G24LB04*/
*   GEN REFS(CVTILK1,CVTILK2,CVTIXAVL,CVTMAP,CVTPTR)/*       @G24LB04*/
*       SETS(REG7,REG15,FOUNDUCB,SAVR15);                          0958
IOSGEN1  DS    0H                                                  0958
*                                                          /*@G24LB04*/
         IOSGEN UCBLOOK                                        @G24LB04
         ST     REG7,FOUNDUCB         SAVE UCB ADDRESS         @G24LB04
         ST     REG15,SAVR15          SAVE RETURN CODE         @G24LB04
*   RFY                                                            0959
*    (REG6,                                                        0959
*     REG7,                                                        0959
*     REG13) UNRSTD;                /*                       @G24LB04*/
*   LM(REG13,REG15,SAV2UCBL);       /* RESTORE OWN REGS      @G24LB04*/
         LM    REG13,REG15,SAV2UCBL                                0960
*   LM(REG6,REG7,SAV3UCBL);         /*                       @G24LB04*/
         LM    REG6,REG7,SAV3UCBL                                  0961
*   IF SAVR15^=FX31ZERO             /* GOOD RETURN?          @G24LB04*/
*     THEN                          /* UCB NOT FOUND         @G24LB04*/
         L     @14,SAVR15                                          0962
         LTR   @14,@14                                             0962
         BZ    @RF00962                                            0962
*     DO;                           /* ERROR PROCESSING      @G24LB04*/
*       RPLRCODE=R23D;              /* SET MSSC REASON CODE  @G24LB04*/
         MVC   RPLRCODE(2,RPLVPTR),@CB00190                        0964
*       MSGRQ=''B;                  /* CLEAR MESSAGE REQUEST @G24LB04*/
         XC    MSGRQ(32),MSGRQ                                     0965
*       MSGRPLV=RPLVPTR;            /* RPLV ADDRESS          @G24LB04*/
         ST    RPLVPTR,MSGRPLV                                     0966
*       MSGID=M482;                 /* MESSAGE ICB482I       @G24LB04*/
         MVC   MSGID(4),@CF00168                                   0967
*       MSGLEN1=FOURFIX8;           /* LENGTH OF VUA REPRES  @G24LB04*/
*                                                                  0968
         MVI   MSGLEN1,X'04'                                       0968
*       /*************************************************************/
*       /*                                                           */
*       /* SINCE VUA WAS NOT KNOWN, HERE PRINT EBCDIC OF     @G24LB04*/
*       /* THE HEX VALUE IN THE VUA POSITIONS OF THE MOUNT   @G24LB04*/
*       /* REQUEST LIST AS AN AID IN DEBUGGING               @G24LB04*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0969
*       DO ICHAR=1 TO 2;            /* 1 BYTE HEX TO 2 CHARS @G24LB04*/
         LA    ICHAR,1                                             0969
@DL00969 DS    0H                                                  0970
*         FRCHAR=VUACHAR(ICHAR);    /* PICK UP 1 BYTE OF VUA @G24LB04*/
         LR    @14,RPLVPTR                                         0970
         ALR   @14,ICHAR                                           0970
         MVC   FRCHAR(1),VUACHAR+131(@14)                          0970
*         EIX=0;                    /* ZERO THE INDEX        @G24LB04*/
         MVI   EIX,X'00'                                           0971
*         TOBIT8=TOBIT8×FRBIT8/16;  /* MOVE IN LEFT HALF     @G24LB04*/
         SLR   @14,@14                                             0972
         IC    @14,FRBIT8                                          0972
         SRL   @14,4                                               0972
         SLR   @07,@07                                             0972
         IC    @07,TOBIT8                                          0972
         OR    @14,@07                                             0972
         STC   @14,TOBIT8                                          0972
*         PRHXCH(2*(ICHAR-1)+1)=EBC(EIX+1);/* EBCDIC OF      @G24LB04
*                                      LEFT HALF             @G24LB04*/
         LR    @14,ICHAR                                           0973
         BCTR  @14,0                                               0973
         ALR   @14,@14                                             0973
         LA    @07,PRHXCH(@14)                                     0973
         SLR   @14,@14                                             0973
         IC    @14,EIX                                             0973
         LA    @04,EBC(@14)                                        0973
         MVC   0(1,@07),0(@04)                                     0973
*         EIX=0;                    /* ZERO THE INDEX        @G24LB04*/
         MVI   EIX,X'00'                                           0974
*         TOBIT8=TOBIT8×FRBIT8&'0F'X;/* PICK UP RIGHT HALF   @G24LB04*/
         MVC   @TS00001(1),FRBIT8                                  0975
         NI    @TS00001,X'0F'                                      0975
         OC    TOBIT8(1),@TS00001                                  0975
*         PRHXCH(2*ICHAR)=EBC(EIX+1);/* EBCDIC OF RIGHT      @G24LB04
*                                      HALF                  @G24LB04*/
         LR    @14,ICHAR                                           0976
         ALR   @14,@14                                             0976
         LA    @07,PRHXCH-1(@14)                                   0976
         SLR   @14,@14                                             0976
         IC    @14,EIX                                             0976
         LA    @04,EBC(@14)                                        0976
         MVC   0(1,@07),0(@04)                                     0976
*       END;                        /* ONE CHAR AT A TIME    @G24LB04*/
         AL    ICHAR,@CF00112                                      0977
         C     ICHAR,@CF00076                                      0977
         BNH   @DL00969                                            0977
*       MSGTEXT1=ADDR(PRINTHEX);    /* EBCDIC FOR HEX OF VUA @G24LB04*/
         LA    @14,PRINTHEX                                        0978
         STCM  @14,7,MSGTEXT1                                      0978
*       MSGLEN2=SIX;                /* LENGTH OF VOLSER      @G24LB04*/
         MVI   MSGLEN2,X'06'                                       0979
*       MSGTEXT2=ADDR(GVSVOLID(I)); /* PROVIDE VOLSER        @G24LB04*/
         LH    @14,I                                               0980
         MH    @14,@CH00325                                        0980
         L     @04,GVSNEPTR(,RPLVPTR)                              0980
         LA    @14,GVSVOLID-20(@14,@04)                            0980
         STCM  @14,7,MSGTEXT2                                      0980
*       RFY                                                        0981
*        (REG1) RSTD;               /*                       @G24LB04*/
*       REG1=ADDR(MSGRQ);           /* PROVIDE REQUEST ADDR  @G24LB04*/
         LA    REG1,MSGRQ                                          0982
*       CALL ICBVOP00;              /* WRITE MESSAGE         @G24LB04*/
         L     @15,@CV00250                                        0983
         BALR  @14,@15                                             0983
*       RFY                                                        0984
*        (REG1) UNRSTD;             /*                       @G24LB04*/
*       RETURN CODE(4);             /* SET TO FAIL IF REQ    @G24LB04*/
         LA    @15,4                                               0985
         L     @14,@SA00014                                        0985
         LM    @00,@12,@SA00014+8                                  0985
         BR    @14                                                 0985
*     END;                          /*                       @G24LB04*/
*   RETURN CODE(0);                 /* GOOD RETURN           @G24LB04*/
@RF00962 SLR   @15,@15                                             0987
         L     @14,@SA00014                                        0987
         LM    @00,@12,@SA00014+8                                  0987
         BR    @14                                                 0987
*   END FINDUCB;                    /*                       @G24LB04*/
*                                                                  0989
*/*  START OF SPECIFICATIONS                                 @G24LB04
*                                                                  0989
*01* NAME = PRISCALC                                         @G24LB04
*                                                                  0989
*01* FUNCTION = CALCULATE PRIMARY EXTENT SPACE IN CYLINDERS  @G24LB04
*                                                                  0989
*02* INPUT = ADDRESSABILITY TO JFCB IN MOUNT PARAMETER LIST. @G24LB04
*            JFCBPQTY MUST HAVE PRIMARY SPACE VALUE.         @G24LB04
*                                                                  0989
*02* OUTPUT = PRIQUANC CONTAINS THE PRIMARY EXTENT QUANTITY, @G24LB04
*             IN CYLINDERS                                   @G24LB04
*                                                                  0989
**** END OF SPECIFICATIONS ***                               @G24LB04*/
*                                                                  0989
*PRISCALC:                          /* CALC PRIMARY SPACE    @G24LB04*/
*   PROCEDURE;                      /*                       @G24LB04*/
PRISCALC STM   @14,@06,12(@13)                                     0989
         STM   @08,@12,52(@13)                                     0989
*   PRIQUANC=FX24ZERO;              /* ZERO PRIMARY QUANTITY @G24LB04*/
         SLR   PRIQUANC,PRIQUANC                                   0990
*   NP1=JFCBPQTY;                   /* PICK UP PRIMARY SPEC  @G24LB04*/
         L     @14,JFCBPTR                                         0991
         MVC   NP1(3),JFCBPQTY(@14)                                0991
*   JD1=JFCBDRLH;                   /* AVE. DATA BLOCK LENGTH@G24LB04*/
         MVC   JD1(3),JFCBDRLH(@14)                                0992
*   IF JFCBSPAC=CYLSPACE            /* SPACE IN CYLINDERS?   @G24LB04*/
*     THEN                                                         0993
         TM    JFCBSPAC(@14),B'11000000'                           0993
         BNO   @RF00993                                            0993
*     PRIQUANC=NPQTY;               /* PICK UP PRIMARY       @G24LB04*/
         L     PRIQUANC,NPQTY-1                                    0994
         LA    PRIQUANC,0(,PRIQUANC)                               0994
*   ELSE                            /* SPACE NOT IN CYLINDER @G24LB04*/
*     IF JFCBSPAC=TRKSPACE          /* SPACE IN TRACKS?      @G24LB04*/
*       THEN                        /* SPACE IN TRACKS       @G24LB04*/
         B     @RC00993                                            0995
@RF00993 L     @14,JFCBPTR                                         0995
         TM    JFCBSPAC(@14),B'10000000'                           0995
         BNO   @RF00995                                            0995
         TM    JFCBSPAC(@14),B'01000000'                           0995
         BNZ   @RF00995                                            0995
*       DO;                         /* SET QUANTITIES        @G24LB04*/
*         IF NPQTY//TRKCYL>0        /* MULTIPLE OF 19?       @G24LB04*/
*           THEN                                                   0997
         L     @02,NPQTY-1                                         0997
         LA    @02,0(,@02)                                         0997
         SRDA  @02,32                                              0997
         D     @02,@CF00148                                        0997
         LTR   @02,@02                                             0997
         BNP   @RF00997                                            0997
*           ROUND=1;                /* ROUND UP              @G24LB04*/
         LA    ROUND,1                                             0998
*         ELSE                                                     0999
*           ROUND=0;                /* DO NOT ROUND          @G24LB04*/
         B     @RC00997                                            0999
@RF00997 SLR   ROUND,ROUND                                         0999
*         PRIQUANC=(NPQTY/TRKCYL)+ROUND;/* SET PRIMARY       @G24LB04*/
@RC00997 L     @03,NPQTY-1                                         1000
         LA    @03,0(,@03)                                         1000
         SLR   @02,@02                                             1000
         D     @02,@CF00148                                        1000
         ALR   @03,ROUND                                           1000
         LR    PRIQUANC,@03                                        1000
*       END;                        /*                       @G24LB04*/
*     ELSE                          /*                       @G24LB04*/
*       IF JFCBSPAC=AVBSPACE        /* BLOCK REQUEST         @G24LB04*/
*         THEN                                                     1002
         B     @RC00995                                            1002
@RF00995 L     @14,JFCBPTR                                         1002
         TM    JFCBSPAC(@14),B'01000000'                           1002
         BNO   @RF01002                                            1002
         TM    JFCBSPAC(@14),B'10000000'                           1002
         BNZ   @RF01002                                            1002
*         DO;                       /*                       @G24LB04*/
*           IF JFCBDRLH^=0          /* BLKLENG - CALCULATE   @G24LB04*/
*             THEN                  /*                       @G24LB04*/
         ICM   @06,7,JFCBDRLH(@14)                                 1004
         BZ    @RF01004                                            1004
*             DO;                   /*                       @G24LB04*/
*               IF KEYLE>0          /* KEY GT ZERO?          @G24LB04*/
*                 THEN                                             1006
         CLI   KEYLE(@14),0                                        1006
         BNH   @RF01006                                            1006
*                 NRECLN=CON1+KEYLE+DRLH;/*                  @G24LB04
*                                      RECORD LENGTH-KEY     @G24LB04*/
         LA    NRECLN,191                                          1007
         SLR   @01,@01                                             1007
         IC    @01,KEYLE(,@14)                                     1007
         ALR   NRECLN,@01                                          1007
         L     @14,DRLH-1                                          1007
         LA    @14,0(,@14)                                         1007
         ALR   NRECLN,@14                                          1007
*               ELSE                                               1008
*                 NRECLN=CON2+DRLH; /* RECORD LENGTH,        @G24LB04
*                                      NO KEY                @G24LB04*/
         B     @RC01006                                            1008
@RF01006 LA    NRECLN,135                                          1008
         L     @14,DRLH-1                                          1008
         LA    @14,0(,@14)                                         1008
         ALR   NRECLN,@14                                          1008
*               NRECRDS=TKCAPCTY/NRECLN;/* CALC NO OF RECORDS      1009
*                                                            @G24LB04*/
@RC01006 L     @02,@CF00217                                        1009
         SRDA  @02,32                                              1009
         DR    @02,NRECLN                                          1009
         LR    NRECRDS,@03                                         1009
*               IF(JFCRFO=OFF&NRECRDS^=0)/* TRACK OVERFLOW   @G24LB04
*                                      REQUEST               @G24LB04*/
*                 THEN              /* YES                   @G24LB04*/
         L     @14,JFCBPTR                                         1010
         TM    JFCRFO(@14),B'00100000'                             1010
         BNZ   @RF01010                                            1010
         SLR   @14,@14                                             1010
         CR    NRECRDS,@14                                         1010
         BE    @RF01010                                            1010
*                 DO;               /*                       @G24LB04*/
*                   IF(NPQTY//NRECRDS)>0/* ANOTHER TRACK     @G24LB04
*                                      REQUIRED              @G24LB04*/
*                     THEN                                         1012
         L     @02,NPQTY-1                                         1012
         LA    @02,0(,@02)                                         1012
         SRDA  @02,32                                              1012
         DR    @02,NRECRDS                                         1012
         CR    @02,@14                                             1012
         BNH   @RF01012                                            1012
*                     ROUND=1;      /* YES                   @G24LB04*/
         LA    ROUND,1                                             1013
*                   ELSE                                           1014
*                     ROUND=0;      /* NO TRACK REQUIRED     @G24LB04*/
         B     @RC01012                                            1014
@RF01012 SLR   ROUND,ROUND                                         1014
*                   PRIQUANC=(NPQTY/NRECRDS)+ROUND;/*        @G24LB04
*                                      CALC PRI Q IN TRACKS  @G24LB04*/
@RC01012 L     @03,NPQTY-1                                         1015
         LA    @03,0(,@03)                                         1015
         SLR   @02,@02                                             1015
         DR    @02,NRECRDS                                         1015
         ALR   @03,ROUND                                           1015
         LR    PRIQUANC,@03                                        1015
*                   IF(PRIQUANC//TRKCYL)>0/* EXTRA CYL       @G24LB04
*                                      REQUIRED?             @G24LB04*/
*                     THEN                                         1016
         LR    @02,PRIQUANC                                        1016
         SRDA  @02,32                                              1016
         D     @02,@CF00148                                        1016
         LTR   @02,@02                                             1016
         BNP   @RF01016                                            1016
*                     ROUND=1;      /* YES                   @G24LB04*/
         LA    ROUND,1                                             1017
*                   ELSE                                           1018
*                     ROUND=0;      /* NO                    @G24LB04*/
         B     @RC01016                                            1018
@RF01016 SLR   ROUND,ROUND                                         1018
*                   PRIQUANC=(PRIQUANC/TRKCYL)+ROUND;/*      @G24LB04
*                                      CALC PRI QTY IN CYLS  @G24LB04*/
@RC01016 LR    @03,PRIQUANC                                        1019
         SLR   @02,@02                                             1019
         D     @02,@CF00148                                        1019
         ALR   @03,ROUND                                           1019
         LR    PRIQUANC,@03                                        1019
*                 END;              /*                       @G24LB04*/
*               ELSE                                               1021
*                 DO;               /*                       @G24LB04*/
         B     @RC01010                                            1021
@RF01010 DS    0H                                                  1022
*                   PRIQUANC=NRECLN*NPQTY;/* TOTAL LENGTH OF @G24LB04
*                                      RECS                  @G24LB04*/
         L     @03,NPQTY-1                                         1022
         LA    @03,0(,@03)                                         1022
         MR    @02,NRECLN                                          1022
         LR    PRIQUANC,@03                                        1022
*                   IF(PRIQUANC//TKCAPCTY)>0/*               @G24LB04*/
*                     THEN                                         1023
         LR    @02,PRIQUANC                                        1023
         SRDA  @02,32                                              1023
         D     @02,@CF00217                                        1023
         LTR   @02,@02                                             1023
         BNP   @RF01023                                            1023
*                     ROUND=1;      /* SET FOR ANOTHER TRACK @G24LB04*/
         LA    ROUND,1                                             1024
*                   ELSE                                           1025
*                     ROUND=0;      /* NO OTHER TRACK NEEDED @G24LB04*/
         B     @RC01023                                            1025
@RF01023 SLR   ROUND,ROUND                                         1025
*                   PRIQUANC=(PRIQUANC/TKCAPCTY)+ROUND;/*    @G24LB04
*                                      CALC NO OF TRACKS     @G24LB04*/
@RC01023 LR    @03,PRIQUANC                                        1026
         SLR   @02,@02                                             1026
         D     @02,@CF00217                                        1026
         ALR   @03,ROUND                                           1026
         LR    PRIQUANC,@03                                        1026
*                   IF(PRIQUANC//TRKCYL)>0/* MULTIPLE OF 19? @G24LB04*/
*                     THEN                                         1027
         LR    @02,PRIQUANC                                        1027
         SRDA  @02,32                                              1027
         D     @02,@CF00148                                        1027
         LTR   @02,@02                                             1027
         BNP   @RF01027                                            1027
*                     ROUND=1;      /*                       @G24LB04*/
         LA    ROUND,1                                             1028
*                   ELSE                                           1029
*                     ROUND=0;      /*                       @G24LB04*/
         B     @RC01027                                            1029
@RF01027 SLR   ROUND,ROUND                                         1029
*                   PRIQUANC=(PRIQUANC/TRKCYL)+ROUND;/*      @G24LB04
*                                      PRIMARY QUAN IN CYLS  @G24LB04*/
@RC01027 LR    @03,PRIQUANC                                        1030
         SLR   @02,@02                                             1030
         D     @02,@CF00148                                        1030
         ALR   @03,ROUND                                           1030
         LR    PRIQUANC,@03                                        1030
*                 END;              /*                       @G24LB04*/
*             END;                  /*                       @G24LB04*/
*         END;                      /*                       @G24LB04*/
*   END PRISCALC;                   /*                       @G24LB04*/
@EL00015 DS    0H                                                  1034
@EF00015 DS    0H                                                  1034
@ER00015 LM    @14,@06,12(@13)                                     1034
         LM    @08,@12,52(@13)                                     1034
         BR    @14                                                 1034
*                                                                  1035
*/*  START OF SPECIFICATIONS                                 @G24LB04
*                                                                  1035
*01* NAME = WRITEXPD                                         @G24LB04
*                                                                  1035
*01* FUNCTION = WRITES MESSAGE FOR EACH EXPIRATION DATE      @G24LB04
*               ASSIGNED BY MSVC                             @G24LB04
*                                                                  1035
*02* INPUT = ADDRESSABILITY TO GVSNE AND SLOT, INDEXED BY I. @G24LB04
*            GVSNE HAS GROUP AND SLOT HAS VOLID FOR MESSAGE. @G24LB04
*            DATE ASSIGNED IS IN GXPDT, A LOCAL VARIABLE.    @G24LB04
*                                                                  1035
*02* OUTPUT = MESSAGE ICB481I                                @G24LB04
*             VOLUME VVVVVV IN GROUP GGGGGGGG EXPIRES YYDDD  @G24LB04
*                                                                  1035
**** END OF SPECIFICATIONS ****                              @G24LB04*/
*                                                                  1035
*WRITEXPD:                          /* WRITE EXPIRATION DATE @G24LB04*/
*   PROCEDURE;                      /*                       @G24LB04*/
WRITEXPD STM   @14,@12,@SA00016                                    1035
*   MSGRQ=''B;                      /* CLEAR MESSAGE REQUEST @G24LB04*/
         XC    MSGRQ(32),MSGRQ                                     1036
*   MSGRPLV=RPLVPTR;                /* RPLV ADDRESS          @G24LB04*/
         ST    RPLVPTR,MSGRPLV                                     1037
*   MSGID=M481;                     /* ICB481I               @G24LB04*/
         MVC   MSGID(4),@CF00166                                   1038
*   MSGLEN1=SIX;                    /* LENGTH OF VOLSER      @G24LB04*/
         MVI   MSGLEN1,X'06'                                       1039
*   MSGTEXT1=ADDR(GVSVOLID(I));     /* VOLSER                @G24LB04*/
         LH    @14,I                                               1040
         MH    @14,@CH00325                                        1040
         L     @04,GVSNEPTR(,RPLVPTR)                              1040
         LA    @14,GVSVOLID-20(@14,@04)                            1040
         STCM  @14,7,MSGTEXT1                                      1040
*   MSGLEN2=EIGHT;                  /* LENGTH OF GRP NAME    @G24LB04*/
         MVI   MSGLEN2,X'08'                                       1041
*   MSGTEXT2=ADDR(GVSVVGRP);        /* GROUP NAME            @G24LB04*/
         LA    @14,GVSVVGRP(,@04)                                  1042
         STCM  @14,7,MSGTEXT2                                      1042
*   MSGLEN3=FIVE;                   /* LENGTH OF YYDDD DATE  @G24LB04*/
*                                                                  1043
         MVI   MSGLEN3,X'05'                                       1043
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT DATE TO EBCDIC                                @G24LB04*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1044
*   WDATE(1:4)=GXPDT;               /* GET EXPIRATION DATE   @G24LB04*/
         MVC   WDATE(4),GXPDT                                      1044
*   WDATE(5:5)=SIGN;                /* PROVIDE FAKE SIGN     @G24LB04*/
         MVC   WDATE+4(1),SIGN                                     1045
*   GEN(UNPK WRKDATE(7),WDATE+1(4));/* UNPACK 3 BYTES TO 6   @G24LB04*/
         UNPK WRKDATE(7),WDATE+1(4)
*   MSGTEXT3=ADDR(WRKDATE);         /* (LAST BYTE NOT USED)  @G24LB04*/
         LA    @14,WRKDATE                                         1047
         STCM  @14,7,MSGTEXT3                                      1047
*   RFY                                                            1048
*    (REG1) RSTD;                   /*                       @G24LB04*/
*   REG1=ADDR(MSGRQ);               /* MESSAGE REQUEST DATA  @G24LB04*/
         LA    REG1,MSGRQ                                          1049
*   CALL ICBVOP00;                  /* CALLS WRITES MESSAGE  @G24LB04*/
         L     @15,@CV00250                                        1050
         BALR  @14,@15                                             1050
*   RFY                                                            1051
*    (REG1) UNRSTD;                 /*                       @G24LB04*/
*   END WRITEXPD;                   /*                       @G24LB04*/
@EL00016 DS    0H                                                  1052
@EF00016 DS    0H                                                  1052
@ER00016 LM    @14,@12,@SA00016                                    1052
         BR    @14                                                 1052
*   END ICBVMT00                    /* END ICBVMT00          #Y30LB11*/
*                                                                  1053
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */
*/*%INCLUDE SYSLIB  (IEZCPUID)                                       */
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*                                                                  1053
*       ;                                                          1053
@DATA    DS    0H
@CH00091 DC    H'6'
@CH00325 DC    H'20'
@CH02098 DC    H'220'
         DS    0F
@SA00001 DS    18F
@SA00002 DS    14F
@SA00007 DS    15F
@SA00003 DS    14F
@SA00004 DS    14F
@SA00010 DS    15F
@SA00016 DS    15F
@SA00013 DS    15F
@SA00006 DS    15F
@SA00008 DS    15F
@SA00014 DS    15F
@SA00012 DS    0F
@SA00011 DS    0F
         DS    15F
@TF00001 DS    F
         DS    0F
@CF00112 DC    F'1'
@CF00076 DC    F'2'
@CF00087 DC    F'4'
@CF00089 DC    F'5'
@CF00085 DC    F'15'
@CH00085 EQU   @CF00085+2
@CF00100 DC    F'16'
@CF00148 DC    F'19'
@CF00901 DC    F'28'
@CF00312 DC    F'88'
@CF00150 DC    F'402'
@CF00098 DC    F'403'
@CF00152 DC    F'404'
@CF00154 DC    F'407'
@CF00156 DC    F'410'
@CF00158 DC    F'411'
@CF00160 DC    F'415'
@CF00162 DC    F'473'
@CF00164 DC    F'479'
@CF00166 DC    F'481'
@CF00168 DC    F'482'
@CF00331 DC    F'1024'
@CF00217 DC    F'13165'
@CF02120 DC    XL4'0000FFFF'
@CF00117 DC    XL4'7FFF'
@CV00248 DC    V(ICBVRR00)
@CV00249 DC    V(ICBVIO00)
@CV00250 DC    V(ICBVOP00)
@CV00251 DC    V(ICBVJL00)
         DS    0D
JPTRFX   DS    F
JXPTRFX  DS    F
SAVRETPD DS    F
BASXPDT2 DS    F
VOLINDEX DS    H
I        DS    H
LAST     DS    H
FRSP     DS    H
MVRLEN   DC    AL2(88)
NVOLINDX DS    FL1
         DS    CL2
LEXT     DS    FL3
         DS    CL1
PQTY     DS    FL3
         DS    CL1
SQTY     DS    FL3
         DS    0D
@TS00001 DS    CL8
@CC00108 DC    C'        '
@CC00214 DC    C'SYSGROUP'
@CB00106 DC    X'FFFFFFFC'
@CB00146 DC    X'0099366C'
@CB00103 DC    X'0004'
@CB00170 DC    X'0000'
@CB00174 DC    X'0213'
@CB00176 DC    X'022B'
@CB00178 DC    X'022C'
@CB00182 DC    X'022E'
@CB00184 DC    X'022F'
@CB00186 DC    X'0231'
@CB00188 DC    X'0232'
@CB00190 DC    X'023D'
@CB00192 DC    X'0261'
         DS    CL3
JFCBQTY  DS    CL3
FOX      DC    X'FFFFFFFF'
F        DC    X'0000000F'
CPU      DS    CL2
EXPDT    DS    CL4
DLMTD    DS    CL4
         DS    CL2
RCUNPACK DS    CL5
SAVCPUBM DS    BL2
SAVGRETN DS    BL1
SAVGRPCD DS    BL2
SAVRCODE DS    BL2
SAVRETC  DS    BL2
         DS    CL2
SAV1UCBL DS    CL64
SAV2UCBL DS    CL12
SAV3UCBL DS    CL8
SIGN     DC    X'0F'
TRANS    DC    CL16'0123456789ABCDEF'
         DS    CL3
WORK1    DS    CL8
WRKVUA   DS    CL8
WRKDATE  DS    CL8
WDATE    DS    CL5
         DS    CL3
VUAUNPCK DS    CL5
MSCRCF0  DC    X'00F0'
MSCRC04  DC    X'0004'
MSCRC0B  DC    X'000B'
TOBIT8   DS    BL1
FRBIT8   DS    BL1
PRINTHEX DS    CL4
ARGV     DS    CL13
         ORG   ARGV
@NM00001 DC    CL5'V    '
ARGVOL   DS    CL6
@NM00002 DC    CL1' '
@NM00003 DC    XL1'0'
         ORG   ARGV+13
ARGGR    DS    CL13
         ORG   ARGGR
@NM00004 DC    CL3'G  '
ARGGP    DS    CL8
@NM00005 DC    CL1' '
ARGNUM   DS    FL1
         ORG   ARGGR+13
ARGCPU   DS    CL13
         ORG   ARGCPU
@NM00006 DC    CL3'C  '
@NM00007 DC    CL3'CPU'
@NM00008 DC    CL1' '
@NM00009 DC    CL2'ID'
@NM00010 DC    CL4' '
         ORG   ARGCPU+13
GXPDT    DS    CL4
         ORG   GXPDT
GX1PDT   DS    CL2
GX2PDT   DS    CL2
         ORG   GXPDT+4
GXPDTOLD DS    CL4
JFCBDATE DS    CL4
         ORG   JFCBDATE
@NM00012 DS    FL1
JFCBYD   DS    CL3
         ORG   JFCBYD
JFCBYFX  DS    FL1
JFCBDFX  DS    FL2
         ORG   JFCBDATE+4
JD       DS    CL4
         ORG   JD
@NM00013 DS    CL1
JD1      DS    CL3
         ORG   JD+4
JP       DS    CL4
         ORG   JP
@NM00014 DS    CL1
JP1      DS    CL3
         ORG   JP+4
NP       DS    CL4
         ORG   NP
@NM00015 DS    CL1
NP1      DS    CL3
         ORG   NP+4
JS       DS    CL4
         ORG   JS
@NM00016 DS    CL1
JS1      DS    CL3
         ORG   JS+4
SWITCHES DS    BL1
         ORG   SWITCHES
ALGOSW   DS    BL1
RSTRSW   EQU   SWITCHES+0
SCRTCHSW EQU   SWITCHES+0
SPACESW  EQU   SWITCHES+0
JRNLFLG  EQU   SWITCHES+0
@NM00018 EQU   SWITCHES+0
         ORG   SWITCHES+1
         DS    CL3
WORKAREA DS    CL368
         ORG   WORKAREA
QMGRLIST DS    CL24
         ORG   QMGRLIST
@NM00019 DS    CL12
QMIDSKA3 DS    CL3
         ORG   WORKAREA+24
SAVEREGS DS    CL88
QMGRWORK DS    CL256
         ORG   WORKAREA+368
Z5       DS    CL5
         ORG   Z5
Z4       DS    CL4
         ORG   Z4
Z3       DS    CL3
         ORG   Z3
Z2       DS    CL2
Z1       DS    CL1
         ORG   Z4+3
@NM00020 DS    CL1
         ORG   Z5+4
@NM00021 DS    CL1
         ORG   Z5+5
         DS    CL3
VMTPATCH DS    CL200
         ORG   VMTPATCH
@NM00022 DC    CL20'ICBVMT00 PATCH AREA '
@NM00023 DC    XL180'0'
         ORG   VMTPATCH+200
GVSBUFR  DS    CL1024
MSGRQ    DS    CL32
         ORG   MSGRQ
MSGID    DS    FL4
MSGRPLV  DS    AL4
MSGRLEN  DS    BL1
MSGREPLY DS    AL3
MSGLEN1  DS    BL1
MSGTEXT1 DS    AL3
MSGLEN2  DS    BL1
MSGTEXT2 DS    AL3
MSGLEN3  DS    BL1
MSGTEXT3 DS    AL3
MSGLEN4  DS    BL1
MSGTEXT4 DS    AL3
MSGLEN5  DS    BL1
MSGTEXT5 DS    AL3
         ORG   MSGRQ+32
DRPLV    DS    CL220
TENQVOL  DS    CL6
         DS    CL2
MAJRNAM  DC    CL8'SYSZVOLS'
ICBVMT00 CSECT
FOUNDUCB  DS    F                    UCB ADDRESS FOUND
SAVR15    DS    F                    RETURN CODE
ICBVMT00 CSECT
*                                   /* CONSTANTS FOR IOSGEN  @G24LB04*/
         IECDIOCM                                              @G24LB04
         IECDIOCX                                              @G24LB04
ICBVMT00 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ICHAR    EQU   @06
TEMP     EQU   @06
WRKRETPD EQU   @07
ROUND    EQU   @06
NRECRDS  EQU   @05
RECORDS  EQU   @07
TOTLEN   EQU   @07
NRECLN   EQU   @04
RECLEN   EQU   @08
PRIQUANC EQU   @07
INDEX    EQU   @09
J        EQU   @06
UCBPR1   EQU   @06
MVRPTR   EQU   @06
SAVEPTR  EQU   @07
VVIPTR   EQU   @08
RPLVPTR  EQU   @05
REG0     EQU   @00
REG1     EQU   @01
REG6     EQU   @06
REG7     EQU   @07
REG13    EQU   @13
REG15    EQU   @15
RETCOD   EQU   @15
MDREG1   EQU   @01
CVTPTR   EQU   16
UCBPTR   EQU   0
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCBRR    EQU   UCBDUDN1
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00027 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
VVICB    EQU   0
VVICPUID EQU   VVICB+12
VVIFLGA  EQU   VVICB+15
VVIFLG0  EQU   VVIFLGA
VVIUCB   EQU   VVICB+60
RPLV     EQU   0
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLFTIME EQU   RPLFLAGA
RPLVTLEN EQU   RPLV+30
RPLRCODE EQU   RPLV+32
RPLVRETC EQU   RPLV+34
RPLRMSCC EQU   RPLV+36
RPLVSAM  EQU   RPLV+56
RPLVTYP  EQU   RPLVSAM+2
RPLVBUF  EQU   RPLVSAM+32
RPLVKEY  EQU   RPLVSAM+36
RPLVOPT  EQU   RPLVSAM+40
RPLVLOC  EQU   RPLVOPT
RPLVDIR  EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
RPLVUPD  EQU   RPLVOPT+1
RPLVBLN  EQU   RPLVSAM+52
RPLVUTIL EQU   RPLV+132
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASGENUS EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASCPUID EQU   BASEV+18
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASDLMTD EQU   BASEV+92
BASEXPDT EQU   BASEV+96
BASGROUP EQU   BASEV+180
GROUP    EQU   0
GRONAME  EQU   GROUP
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GRORLSE  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GROPSPD  EQU   GROUP+36
GROSSPD  EQU   GROUP+38
GRORETPD EQU   GROUP+52
GROERRTS EQU   GROUP+56
GVSNE    EQU   0
GVSHDR   EQU   GVSNE
GVSNAME  EQU   GVSHDR
GVSVVGRP EQU   GVSNAME+3
GVSID    EQU   GVSNAME+11
GVSFLAGA EQU   GVSHDR+13
GVSTYPE  EQU   GVSFLAGA
GVSGVSEX EQU   GVSTYPE
GVSEX    EQU   GVSFLAGA+2
GVSESIND EQU   GVSHDR+18
GVSSLOTS EQU   GVSNE+28
GVSVOLID EQU   GVSSLOTS
GVSVOLFL EQU   GVSSLOTS+6
GVSCPUBM EQU   GVSVOLFL
GVSMTNSH EQU   GVSVOLFL+2
GVSFRESP EQU   GVSSLOTS+10
GVSLEXT  EQU   GVSSLOTS+12
GVSEXPDT EQU   GVSSLOTS+14
GVSMTDSP EQU   GVSSLOTS+18
CPUID    EQU   0
CPUTYPE  EQU   CPUID+18
CPUMAP   EQU   CPUID+20
CPUIDREC EQU   CPUMAP
CPUMASK  EQU   CPUMAP+6
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCVINDX EQU   INFMJFCB+64
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBXPDT EQU   INFMJFCB+83
JFCBIND1 EQU   INFMJFCB+86
JFCRLSE  EQU   JFCBIND1
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
JFCBX    EQU   0
JFCBXVOL EQU   JFCBX+4
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVROPCD  EQU   MVRCODE
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRBVOL  EQU   MVR+12
MVRTO    EQU   MVR+58
ICB2SSCB EQU   0
ICBOPT   EQU   ICB2SSCB+48
ICBFLG   EQU   ICB2SSCB+52
ICBFG1   EQU   ICBFLG
ICBCPUID EQU   ICB2SSCB+112
ICBTRACE EQU   ICB2SSCB+148
CVTMAP   EQU   0
CVTILK1  EQU   CVTMAP+36
CVTILK2  EQU   CVTMAP+40
CVTDATE  EQU   CVTMAP+56
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIXAVL EQU   CVTMAP+124
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTICB   EQU   CVTXTNT2+48
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
ICBMTLST EQU   0
MDLEN    EQU   ICBMTLST
MDOPCD   EQU   ICBMTLST+4
MDFLG    EQU   ICBMTLST+6
MDVSVRQ  EQU   MDFLG
MDSRTCH  EQU   MDFLG
MDVOL    EQU   ICBMTLST+8
MDVUA    EQU   ICBMTLST+14
MDHOST   EQU   ICBMTLST+16
MNTEXTP  EQU   ICBMTLST+24
MDJFCB   EQU   MNTEXTP
UCBBGN   EQU   0
CPUIDPTR EQU   RPLVBUF
BASEVPTR EQU   RPLVBUF
GROUPPTR EQU   RPLVBUF
GVSNEPTR EQU   RPLVBUF
UCBPR2   EQU   UCBPTR
JPTR     EQU   JPTRFX
JFCBPTR  EQU   JPTR
JXPTR    EQU   JXPTRFX
JFCBXPTR EQU   JXPTR
DRLH     EQU   JD1
JFCBFQTY EQU   JFCBQTY
JPQTY    EQU   JP1
NPQTY    EQU   NP1
JSQTY    EQU   JS1
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCORGIS EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBNVOL EQU   JFCUCSEG+9
JFCBVOLS EQU   JFCUCSEG+10
JFCAVOLS EQU   JFCBVOLS
NVOL     EQU   JFCBNVOL
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
KEYLE    EQU   JFCKEYLE
VUACHAR  EQU   MDVUA
FRCHAR   EQU   FRBIT8
PRHXCH   EQU   PRINTHEX
EBC      EQU   TRANS
EIX      EQU   TOBIT8
@NM00011 EQU   JFCRLSE
JFCRLSE1 EQU   @NM00011
JFCRLSE2 EQU   @NM00011
VINDX    EQU   JFCVINDX
ALGOBIT  EQU   VINDX
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00026 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCBS001 EQU   JFCBVOLS
JFCMSVGP EQU   JFCBS001+22
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSPAC EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
JFCBABST EQU   JFCBS001+48
JFCBDRLH EQU   JFCBS001+53
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
MNTFLAGS EQU   MDFLG
MNTHOSTD EQU   MDHOST
MNTJFCB  EQU   MDJFCB
MNTLEN   EQU   MDLEN
MNTOPCD  EQU   MDOPCD
MNTVOLID EQU   MDVOL
MNTVUA   EQU   MDVUA
TOCHAR   EQU   TOBIT8
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBSBNM EQU   JFCBS001+50
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
@NM00052 EQU   JFCBS001
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00026
UCBSKPFG EQU   @NM00026
UCBRIPND EQU   @NM00026
UCBRTIAC EQU   @NM00026
UCBRSV79 EQU   @NM00026
UCBRSV78 EQU   @NM00026
UCBRSV77 EQU   @NM00026
UCBOLTEP EQU   @NM00026
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00025 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
@NM00017 EQU   VINDX
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00051 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00050 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
MNTRES2  EQU   ICBMTLST+21
@NM00063 EQU   MDFLG
MDMEXT   EQU   MDFLG
MDVISMNT EQU   MDFLG
@NM00062 EQU   MDFLG
MNTRES1  EQU   ICBMTLST+5
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00061 EQU   CVTFIX+248
@NM00060 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
ICBLORD  EQU   ICBTRACE+256
ICBOTRC  EQU   ICBTRACE
ICBRESV  EQU   ICB2SSCB+128
ICBVOLST EQU   ICB2SSCB+124
ICBVSCRA EQU   ICB2SSCB+120
ICBSAMP  EQU   ICB2SSCB+118
ICBRESVD EQU   ICB2SSCB+117
ICBFAB   EQU   ICB2SSCB+108
ICBMSSC  EQU   ICB2SSCB+104
ICBRSVP  EQU   ICB2SSCB+100
ICBAEAP  EQU   ICB2SSCB+96
ICBSIOBP EQU   ICB2SSCB+92
ICBIATNA EQU   ICB2SSCB+88
ICBIPRGA EQU   ICB2SSCB+84
ICBSRBP  EQU   ICB2SSCB+80
ICBVVICB EQU   ICB2SSCB+76
ICBVVIC  EQU   ICB2SSCB+72
ICBSIOP  EQU   ICB2SSCB+68
ICBMEP   EQU   ICB2SSCB+64
ICBIORCI EQU   ICB2SSCB+60
ICB2ACTP EQU   ICB2SSCB+56
ICBFG3   EQU   ICBFLG+2
ICBFG2   EQU   ICBFLG+1
@NM00059 EQU   ICBFG1
ICBMSCA  EQU   ICBFG1
ICBMSCMP EQU   ICBFG1
ICBS     EQU   ICBFG1
ICBB     EQU   ICBFG1
ICBV     EQU   ICBFG1
ICBR     EQU   ICBFG1
ICBI     EQU   ICBFG1
ICBNVT   EQU   ICBOPT
ICBVN02P EQU   ICB2SSCB+44
ICBTCB   EQU   ICB2SSCB+40
ICBQHEAD EQU   ICB2SSCB+36
ICBAUCB  EQU   ICB2SSCB+32
ICBPUCB  EQU   ICB2SSCB+28
ICBCOMQ  EQU   ICB2SSCB+24
ICBIOR   EQU   ICB2SSCB+20
ICBCOM   EQU   ICB2SSCB+16
ICBACTV  EQU   ICB2SSCB+12
ICBECB   EQU   ICB2SSCB+8
ICBSSNAM EQU   ICB2SSCB
@NM00058 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00057 EQU   MVRFLAGA+2
MVRCICPY EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00056 EQU   MVRCODE+1
JFCBXNXT EQU   JFCBX+172
@NM00055 EQU   JFCBX+144
JFCBXDEV EQU   JFCBX+140
JFCBXNAM EQU   JFCBX+96
@NM00054 EQU   JFCBX+94
@NM00053 EQU   JFCBX+3
JFCBXTTR EQU   JFCBX
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00049 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
@NM00048 EQU   CPUID+150
CPUPURGE EQU   CPUID+148
@NM00047 EQU   CPUMAP+5
CPURES2  EQU   CPUTYPE
CPUASSOC EQU   CPUTYPE
CPURES1  EQU   CPUTYPE
CPUDNEXT EQU   CPUID+16
CPUINEXT EQU   CPUID+14
@NM00046 EQU   CPUID+13
CPUNAME  EQU   CPUID
@NM00045 EQU   GVSVOLFL+2
GVSRCFSI EQU   GVSVOLFL+2
@NM00044 EQU   GVSHDR+20
@NM00043 EQU   GVSHDR+17
@NM00042 EQU   GVSFLAGA+2
@NM00041 EQU   GVSTYPE
@NM00040 EQU   GVSTYPE
GVSNO    EQU   GVSID+1
GVSRES1  EQU   GVSID
GVSG     EQU   GVSNAME
@NM00039 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GRONINAC EQU   GROUP+34
GRONRSTD EQU   GROUP+32
GRONGEN  EQU   GROUP+30
GROPCENT EQU   GROUP+29
GROLSN   EQU   GROUP+23
GROFSN   EQU   GROUP+17
@NM00038 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GROBIND  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROVVGRP EQU   GRONAME+3
GROG     EQU   GRONAME
@NM00037 EQU   BASEV+188
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00036 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
@NM00035 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
RPLVRLN  EQU   RPLVSAM+48
@NM00034 EQU   RPLVSAM+44
@NM00033 EQU   RPLVOPT
@NM00032 EQU   RPLVOPT
@NM00031 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00030 EQU   RPLVSAM+3
@NM00029 EQU   RPLVSAM
@NM00028 EQU   RPLV+42
RPLVDATE EQU   RPLV+38
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLVVOP  EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
RPLVQPTR EQU   RPLV
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIDVMEL EQU   VVICB+104
VVIVBSTF EQU   VVICB+100
VVISSOBA EQU   VVICB+96
VVIVSCRA EQU   VVICB+92
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIJUCB  EQU   VVICB+80
VVIIUCB  EQU   VVICB+76
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIQRPL2 EQU   VVICB+44
VVIQRPL1 EQU   VVICB+40
VVIVTRK  EQU   VVICB+37
VVIOPCD  EQU   VVICB+36
VVIVQMP  EQU   VVICB+32
VVIECB1  EQU   VVICB+28
VVICATAD EQU   VVICB+24
VVIDCBAD EQU   VVICB+20
VVIACBAD EQU   VVICB+16
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG3  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIALCON EQU   VVICB+14
VVIUCAT  EQU   VVICB+4
VVICID   EQU   VVICB
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00027
UCBHALI  EQU   @NM00027
UCBRSV09 EQU   @NM00027
UCBRSV08 EQU   @NM00027
UCBRSV07 EQU   @NM00027
UCBRSV06 EQU   @NM00027
UCBRSV05 EQU   @NM00027
UCBRSV04 EQU   @NM00027
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00024 EQU   UCB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00235 EQU   @EL00001
@RF00271 EQU   @EL00001
@RT00405 EQU   @EL00002
@RF00418 EQU   @EL00002
@RF00432 EQU   @EC00437
@RC00564 EQU   @RC00562
@RF00634 EQU   @RC00632
@RC00640 EQU   @RC00632
@RF00717 EQU   @EL00005
@RC00720 EQU   @EL00005
@RF00935 EQU   @RC00924
@RF01002 EQU   @EL00015
@RC00995 EQU   @EL00015
@RC00993 EQU   @EL00015
@RF01004 EQU   @EL00015
@RC01010 EQU   @EL00015
@RC00722 EQU   @RC00720
@ENDDATA EQU   *
         END   ICBVMT00,(C'PLS1244',0701,78158)

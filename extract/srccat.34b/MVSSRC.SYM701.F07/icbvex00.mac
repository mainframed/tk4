         TITLE '*********** ICBVEX00: MSVC EOV EXTEND SPACE UTILITY ****
               *********'
ICBVEX00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBVEX00  76.273'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*   RPLVPTR=REG1;                   /*                       @G24LB35*/
         LR    RPLVPTR,REG1                                        0039
*   RFY                                                            0040
*     REG1 UNRESTRICTED;            /*                       @G24LB35*/
*   VVIPTR=RPLVVICB;                /*                       @G24LB35*/
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0041
*   PARMPTR=ADDR(RPLVUTIL);         /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0042
         LA    PARMPTR,RPLVUTIL(,RPLVPTR)                          0042
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MSVI INVENTORY DATA SET IS NOT DISABLED THEN   @G24LB35*/
*   /* THE INVENTORY IS RESERVED.                            @G24LB35*/
*   /* NOTE - THE RELEASE WILL BE DONE BY ICBVCR00           @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*                                   /*                       @G24LB35*/
*   IF VVIFLG0=OFF THEN             /*                       @G24LB35*/
         TM    VVIFLG0(VVIPTR),B'10000000'                         0043
         BNZ   @RF00043                                            0043
*     RETCODE=ZERO;                 /*                       @G24LB35*/
         SLR   RETCODE,RETCODE                                     0044
*   ELSE                            /*                       @G24LB35*/
*     RETCODE=DISABLED;             /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0045
         B     @RC00043                                            0045
@RF00043 LA    RETCODE,4                                           0045
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TO RESERVE MSVI DATA SET                         @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0046
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
@RC00043 LTR   RETCODE,RETCODE                                     0046
         BNZ   @RF00046                                            0046
*     DO;                           /*                       @G24LB35*/
*       RFY                                                        0048
*        (REG0,                                                    0048
*         REG1) RESTRICTED;         /*                       @G24LB35*/
*       REG0=RESCODE;               /*                       @G24LB35*/
         LA    REG0,1                                              0049
*       REG1=RPLVPTR;               /*                       @G24LB35*/
         LR    REG1,RPLVPTR                                        0050
*       CALL ICBVRR00;              /*                       @G24LB35*/
         L     @15,@CV00293                                        0051
         BALR  @14,@15                                             0051
*       RFY                                                        0052
*        (REG0,                                                    0052
*         REG1) UNRESTRICTED;       /*                       @G24LB35*/
*     END;                          /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0054
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FINDGRP PROCEDURE IS CALLED TO DETERMINE          @G24LB35*/
*   /* WHETHER THE VOLUME IS A GENERAL USE GROUP VOLUME      @G24LB35*/
*   /* AND NOT A MEMBER OF SYSGROUP.                         @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
@RF00046 LTR   RETCODE,RETCODE                                     0054
         BNZ   @RF00054                                            0054
*     CALL FINDGRP;                 /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0055
         BAL   @14,FINDGRP                                         0055
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS ZERO, THE FINDEXT PROCEDURE     @G24LB35*/
*   /* IS CALLED TO LOCATE THE GROUP EXTENSION RECORD AND    @G24LB35*/
*   /* THE SLOT LOCATION WITHIN THE EXTENSION RECORD.        @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0056
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
@RF00054 LTR   RETCODE,RETCODE                                     0056
         BNZ   @RF00056                                            0056
*     CALL FINDEXT;                 /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0057
         BAL   @14,FINDEXT                                         0057
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS ZERO, THE SPACERCD IS CALLED    @G24LB35*/
*   /* TO CALCULATE THE AMOUNT OF CYLINDERS ALLOCATED.       @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0058
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
@RF00056 LTR   RETCODE,RETCODE                                     0058
         BNZ   @RF00058                                            0058
*     CALL SPACERCD;                /*                       @G24LB35
*                                                            @G24LB35*/
         BAL   @14,SPACERCD                                        0059
*                                                                  0060
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS ZERO, ICBVIO00 IS CALLED TO     @G24LB35*/
*   /* WRITE THE EXTENSION RECORD BACK OUT TO THE MSVI DATA  @G24LB35*/
*   /* SET. (ANY I/O ERRORS ENCOUNTERED WILL HAVE ERROR      @G24LB35*/
*   /* MESSAGES BY ICBVIO00)                                 @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0060
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN                                           0060
@RF00058 LTR   RETCODE,RETCODE                                     0060
         BNZ   @RF00060                                            0060
*     DO;                           /*                       @G24LB35*/
*       RPLVTYP=RPLVPUT;            /*                       @G24LB35*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0062
*       RFY                                                        0063
*         REG1 RESTRICTED;          /*                       @G24LB35*/
*       REG1=RPLVPTR;               /*                       @G24LB35*/
         LR    REG1,RPLVPTR                                        0064
*       CALL ICBVIO00;              /*                       @G24LB35*/
         L     @15,@CV00292                                        0065
         BALR  @14,@15                                             0065
*       RFY                                                        0066
*         REG1 UNRESTRICTED;        /*                       @G24LB35*/
*     END;                          /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0067
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CONTROLLER WITH ZERO RETURN AND REASON */
*   /* CODES.                                                @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0068
*                                   /*                       @G24LB35*/
*   RETURN;                         /*                       @G24LB35*/
@EL00001 L     @13,4(,@13)                                         0068
@EF00001 DS    0H                                                  0068
@ER00001 LM    @14,@12,12(@13)                                     0068
         BR    @14                                                 0068
*                                                                  0069
*/********************************************************************/
*/*                                                          @G24LB35*/
*/*     PROCEDURE NAME - FINDGRP                             @G24LB35*/
*/*                                                          @G24LB35*/
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/
*/*                ICBVEX00 MAIN PROCEDURE, CALLS ICBVIO00   @G24LB35*/
*/*                TO READ BASE VOLUME RECORD, DETERMINES IF @G24LB35*/
*/*                THE VOLUME IS A GROUP GENERAL USE VOLUME, @G24LB35*/
*/*                DETERMINES IF THE VOLUME IS NOT A MEMBER  @G24LB35*/
*/*                OF SYSGROUP, AND RETURNS TO ICBVEX00.     @G24LB35*/
*/*                                                          @G24LB35*/
*/*     INPUT -    THE ARLIST IS USED TO OBTAIN THE VOLSER   @G24LB35*/
*/*                                                          @G24LB35*/
*/*     OUTPUT -   THE BASEV RECORD IS READ INTO CORE        @G24LB35*/
*/*                FOR THE GROUP NAME.   THE RETURN CODE:    @G24LB35*/
*/*                   0 = SUCCESSFUL READ OF GROUP RECORD.   @G24LB35*/
*/*                   4 = NOT FOUND, NOT IN GROUP, NOT       @G24LB35*/
*/*                       GENERAL USE, OR SYSGROUP           @G24LB35*/
*/*                                                          @G24LB35*/
*/********************************************************************/
*                                                                  0069
*                                   /*                       @G24LB35*/
*FINDGRP:                           /*                       @G24LB35*/
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35*/
*                                                                  0069
         B     @EL00001                                            0069
FINDGRP  ST    @14,@SA00002                                        0069
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0070
*   DCL                                                            0070
*     SYSGROUP CHAR(8) INIT('SYSGROUP');/* DEFAULT GROUP     @G24LB35
*                                                            @G24LB35*/
*                                                                  0071
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE RPLV TO READ THE BASE VOLUME RECORD         @G24LB35*/
*   /* AND CALL ICBVIO00 TO READ RECORD.                     @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0071
*                                   /*                       @G24LB35*/
*   BASEVPTR=ADDR(BASEVBUF);        /* ADDRESSIBILITY TO BUF @G24LB35*/
         LA    @06,BASEVBUF                                        0071
         ST    @06,BASEVPTR                                        0071
*   BASEVNAM=ARVOL;                 /* VOLSER INTO KEY       @G24LB35*/
         MVC   BASEVNAM(6),ARVOL(PARMPTR)                          0072
*   RPLVKEY=ADDR(BASEKEY);          /* ADDRESS OF GROUP KEY  @G24LB35*/
         LA    @15,BASEKEY                                         0073
         ST    @15,RPLVKEY(,RPLVPTR)                               0073
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB35*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0074
*   RPLVTYP=RPLVREAD;               /* READ GROUP RECORD     @G24LB35*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0075
*   RPLVBUF=BASEVPTR;               /* ADDRESS OF GVSNE      @G24LB35*/
         ST    @06,RPLVBUF(,RPLVPTR)                               0076
*   RPLVBLN=LENGTH(BASEV);          /* LENGTH OF BUFFER      @G24LB35*/
         MVC   RPLVBLN(4,RPLVPTR),@CF00340                         0077
*   RFY                                                            0078
*     REG1 RESTRICTED;              /*                       @G24LB35*/
*   REG1=RPLVPTR;                   /* PASS RPLV             @G24LB35*/
         LR    REG1,RPLVPTR                                        0079
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB35*/
         L     @15,@CV00292                                        0080
         BALR  @14,@15                                             0080
*   RFY                                                            0081
*     REG1 UNRESTRICTED;            /*                       @G24LB35*/
*                                                                  0081
*   /*****************************************************************/
*   /*                                                               */
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB35*/
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB35*/
*   /* NOT A ZERO THEN SET RETURN CODE TO FOUR.              @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0082
*                                   /*                       @G24LB35*/
*   IF RPLVRETC^=ZERO THEN          /*                       @G24LB35*/
         LH    @06,RPLVRETC(,RPLVPTR)                              0082
         N     @06,@CF00347                                        0082
         LTR   @06,@06                                             0082
         BZ    @RF00082                                            0082
*     RETCODE=FOUR;                 /*                       @G24LB35
*                                                            @G24LB35*/
         LA    RETCODE,4                                           0083
*                                                                  0084
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD WAS READ SUCCESSFULLY, THE RECORD       @G24LB35*/
*   /* WILL BE TESTED TO DETERMINE WHETHER THE VOLUME        @G24LB35*/
*   /* IS A GENERAL USE GROUP VOLUME AND WHETHER IT IS A     @G24LB35*/
*   /* MEMBER OF SYSGROUP.                                   @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0084
*                                   /*                       @G24LB35*/
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
@RF00082 LTR   RETCODE,RETCODE                                     0084
         BNZ   @RF00084                                            0084
*     DO;                           /*                       @G24LB35*/
*                                                                  0085
*       /*************************************************************/
*       /*                                                           */
*       /* TEST FOR VOLUME BEING A MEMBER OF GROUP,          @G24LB35*/
*       /* GENERAL USE, OR A MEMBER OF SYSGROUP              @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0086
*       IF BASGRPV=OFF×BASGENUS=OFF×BASGROUP=SYSGROUP THEN         0086
         L     @06,BASEVPTR                                        0086
         TM    BASGRPV(@06),B'00110000'                            0086
         BNO   @RT00086                                            0086
         CLC   BASGROUP(8,@06),SYSGROUP                            0086
         BNE   @RF00086                                            0086
@RT00086 DS    0H                                                  0087
*         RETCODE=FOUR;             /*                       @G24LB35*/
         LA    RETCODE,4                                           0087
*     END;                          /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0088
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0089
*                                   /*                       @G24LB35*/
*   RETURN;                         /* RET TO ICBVEX00 PROC  @G24LB35
*                                                            @G24LB35*/
@EL00002 DS    0H                                                  0089
@EF00002 DS    0H                                                  0089
@ER00002 L     @14,@SA00002                                        0089
         BR    @14                                                 0089
*   END FINDGRP;                    /* END OF FINDGRP PROC   @G24LB35*/
         B     @EL00002                                            0090
*                                                                  0091
*/********************************************************************/
*/*                                                          @G24LB35*/
*/*     PROCEDURE NAME - FINDEXT                             @G24LB35*/
*/*                                                          @G24LB35*/
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/
*/*                ICBVEX00 MAIN PROCEDURE, CALLS ICBVIO00   @G24LB35*/
*/*                TO READ GROUP EXTENSION RECORD, DETERMINES@G24LB35*/
*/*                IF THE VOLUME IS WITHIN EXTENSION RECORD, @G24LB35*/
*/*                AND RETURNS TO ICBVEX00 WITH VOLUME       @G24LB35*/
*/*                POSITION IN EXTENSION RECORD.             @G24LB35*/
*/*                                                          @G24LB35*/
*/*     INPUT -    THE BASEV RECORD IS USED FOR GROUP NAME   @G24LB35*/
*/*                                                          @G24LB35*/
*/*     OUTPUT -   THE GVSNE RECORD IS READ INTO CORE FOR    @G24LB35*/
*/*                VOLUME INFORMATION.  THE RETURN CODE:     @G24LB35*/
*/*                   0 = SUCCESSFUL READ OF GROUP EXTENSION @G24LB35*/
*/*                       AND VOLSER LOCATED.                @G24LB35*/
*/*                   4 = GVSNE NOT READ OR VOLSER NOT       @G24LB35*/
*/*                       LOCATED IN GVSNE.                  @G24LB35*/
*/*                                                          @G24LB35*/
*/********************************************************************/
*                                                                  0091
*                                   /*                       @G24LB35*/
*FINDEXT:                           /*                       @G24LB35*/
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0091
FINDEXT  ST    @14,@SA00003                                        0091
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0092
*                                   /*                       @G24LB35*/
*   DCL                                                            0092
*     FOUNDSW BIT(1);               /* SWITCH FOR LOOP       @G24LB35*/
*                                                                  0093
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE RPLV TO READ THE GROUP EXTENSION RECORD     @G24LB35*/
*   /* AND CALL ICBVIO00 TO READ RECORD.                     @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0093
*                                   /*                       @G24LB35*/
*   GVSNEPTR=ADDR(GVSNEBUF);        /* ADDRESSABILITY TO BUF @G24LB35*/
         LA    @06,GVSNEBUF                                        0093
         ST    @06,GVSNEPTR                                        0093
*   GROUPNAM=BASGROUP;              /* MOVE IN GROUP NAME    @G24LB35*/
         L     @01,BASEVPTR                                        0094
         MVC   GROUPNAM(8),BASGROUP(@01)                           0094
*   GROUPIND=ONE;                   /* SET INDEX TO ONE      @G24LB35*/
         MVI   GROUPIND,X'01'                                      0095
*   RPLVKEY=ADDR(GROUPKEY);         /* ADDRESS OF GROUP KEY  @G24LB35*/
         LA    @15,GROUPKEY                                        0096
         ST    @15,RPLVKEY(,RPLVPTR)                               0096
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB35*/
*   RPLVKGE=ON;                     /* READ EQUAL OR GREATER @G24LB35*/
         OI    RPLVDIR(RPLVPTR),B'01000100'                        0098
*   RPLVUPD=ON;                     /* UPDATE MODE           @G24LB35*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0099
*   RPLVTYP=RPLVREAD;               /* READ GROUP EXTENSION  @G24LB35*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0100
*   RPLVBUF=GVSNEPTR;               /* ADDRESS OF GVSNE BUFF @G24LB35*/
         ST    @06,RPLVBUF(,RPLVPTR)                               0101
*   RPLVBLN=LENGTH(GVSNE);          /* LENGTH OF BUFFER      @G24LB35*/
         MVC   RPLVBLN(4,RPLVPTR),@CF00341                         0102
*   RFY                                                            0103
*     REG1 RESTRICTED;              /*                       @G24LB35*/
*   REG1=RPLVPTR;                   /*                       @G24LB35*/
         LR    REG1,RPLVPTR                                        0104
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB35*/
         L     @15,@CV00292                                        0105
         BALR  @14,@15                                             0105
*   RFY                                                            0106
*     REG1 UNRESTRICTED;            /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0106
*   /*****************************************************************/
*   /*                                                               */
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB35*/
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB35*/
*   /* NOT A ZERO, THEN SET RETURN CODE TO FOUR. IF THE      @G24LB35*/
*   /* RETURN CODE IS ZERO, SET THE RETURN CODE TO ZERO.     @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0107
*                                   /*                       @G24LB35*/
*   IF RPLVRETC^=ZERO THEN          /*                       @G24LB35*/
         LH    @06,RPLVRETC(,RPLVPTR)                              0107
         N     @06,@CF00347                                        0107
         LTR   @06,@06                                             0107
         BZ    @RF00107                                            0107
*     RETCODE=FOUR;                 /*                       @G24LB35
*                                                            @G24LB35*/
         LA    RETCODE,4                                           0108
*                                                                  0109
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD WAS READ SUCCESSFULLY AND THE RECORD IS @G24LB35*/
*   /* OF THE SAME GROUP, THEN THE SLOTS WILL BE LOOPED      @G24LB35*/
*   /* THROUGH TO DETERMINE WHETHER THE VOLSER IS IN THE     @G24LB35*/
*   /* GROUP EXTENSION RECORD.                               @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0109
*                                   /*                       @G24LB35*/
*   FOUNDSW=OFF;                    /* INITIALIZE OFF        @G24LB35
*                                                            @G24LB35*/
@RF00107 NI    FOUNDSW,B'01111111'                                 0109
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/
*                                                                  0110
         LTR   RETCODE,RETCODE                                     0110
         BNZ   @RF00110                                            0110
*     /***************************************************************/
*     /*                                                             */
*     /* CONTROL LOOPS TO READ AND SEARCH GVSNE RECORDS      @G24LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0111
*     DO WHILE FOUNDSW=OFF&RETCODE=ZERO&GVSVVGRP=BASGROUP;         0111
         B     @DE00111                                            0111
@DL00111 DS    0H                                                  0112
*       DO SLOT=ONE TO(GVSESIND-ONE) WHILE FOUNDSW=OFF;            0112
*                                                                  0112
         LA    @06,1                                               0112
         B     @DE00112                                            0112
@DL00112 TM    FOUNDSW,B'10000000'                                 0112
         BNZ   @DC00112                                            0112
*         /***********************************************************/
*         /*                                                         */
*         /* TEST FOR VOLSER IN SLOT.                        @G24LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0113
*         IF GVSVOLID(SLOT)=ARVOL THEN/*                     @G24LB35*/
         MH    @06,@CH00342                                        0113
         L     @01,GVSNEPTR                                        0113
         ALR   @01,@06                                             0113
         CLC   GVSVOLID-20(6,@01),ARVOL(PARMPTR)                   0113
         BNE   @RF00113                                            0113
*           FOUNDSW=ON;             /*                       @G24LB35*/
         OI    FOUNDSW,B'10000000'                                 0114
*       END;                        /*                       @G24LB35*/
*                                                                  0115
@RF00113 LA    @06,1                                               0115
         AH    @06,SLOT                                            0115
@DE00112 STH   @06,SLOT                                            0115
         L     @01,GVSNEPTR                                        0115
         LH    @15,GVSESIND(,@01)                                  0115
         BCTR  @15,0                                               0115
         CR    @06,@15                                             0115
         BNH   @DL00112                                            0115
@DC00112 DS    0H                                                  0116
*       /*************************************************************/
*       /*                                                           */
*       /* SET SLOT COUNTER BACK TO SLOT WITH VOLUME         @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0116
*       SLOT=SLOT-ONE;              /*                       @G24LB35*/
*                                                                  0116
         LH    @06,SLOT                                            0116
         BCTR  @06,0                                               0116
         STH   @06,SLOT                                            0116
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLSER STILL NOT FOUND, DETERMINE              @G24LB35*/
*       /* IF THERE IS MORE GVSNE RECORDS TO READ            @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0117
*       IF FOUNDSW=OFF THEN         /*                       @G24LB35
*                                                            @G24LB35*/
         TM    FOUNDSW,B'10000000'                                 0117
         BNZ   @RF00117                                            0117
*         IF GVSEX=ON THEN                                         0118
         L     @06,GVSNEPTR                                        0118
         TM    GVSEX(@06),B'10000000'                              0118
         BNO   @RF00118                                            0118
*           DO;                     /*                       @G24LB35*/
*             GROUPIND=GVSNO+ONE;   /*                       @G24LB35*/
         LA    @15,1                                               0120
         SLR   @14,@14                                             0120
         IC    @14,GVSNO(,@06)                                     0120
         ALR   @15,@14                                             0120
         STC   @15,GROUPIND                                        0120
*             RFY                                                  0121
*               REG1 RESTRICTED;    /*                       @G24LB35*/
*             REG1=RPLVPTR;         /*                       @G24LB35*/
         LR    REG1,RPLVPTR                                        0122
*             CALL ICBVIO00;        /* READ GROUP EXT REC    @G24LB35*/
         L     @15,@CV00292                                        0123
         BALR  @14,@15                                             0123
*             RFY                                                  0124
*               REG1 UNRESTRICTED;  /*                       @G24LB35*/
*             IF RPLVRETC^=ZERO THEN/*                       @G24LB35*/
         LH    @06,RPLVRETC(,RPLVPTR)                              0125
         N     @06,@CF00347                                        0125
         LTR   @06,@06                                             0125
         BZ    @RF00125                                            0125
*               RETCODE=FOUR;       /*                       @G24LB35*/
         LA    RETCODE,4                                           0126
*           END;                    /*                       @G24LB35*/
*                                                                  0127
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO MORE GVSNE TO READ AND VOLSER NOT           @G24LB35*/
*       /* FOUND, SET ERROR CODE & FALL THROUGH              @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0128
*         ELSE                      /*                       @G24LB35*/
*           RETCODE=FOUR;           /*                       @G24LB35*/
         B     @RC00118                                            0128
@RF00118 LA    RETCODE,4                                           0128
*     END;                          /*                       @G24LB35*/
*                                                                  0129
@RC00118 DS    0H                                                  0129
@RF00117 DS    0H                                                  0129
@DE00111 TM    FOUNDSW,B'10000000'                                 0129
         BNZ   @DC00111                                            0129
         LTR   RETCODE,RETCODE                                     0129
         BNZ   @DC00111                                            0129
         L     @06,GVSNEPTR                                        0129
         L     @01,BASEVPTR                                        0129
         CLC   GVSVVGRP(8,@06),BASGROUP(@01)                       0129
         BE    @DL00111                                            0129
@DC00111 DS    0H                                                  0130
*   /*****************************************************************/
*   /*                                                               */
*   /* ENSURE THAT IF VOLSER WAS NOT FOUND THAT A FOUR CODE  @G24LB35*/
*   /* IS SET TO STOP FURTHER PROCESSING.                    @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0130
*   IF FOUNDSW=OFF THEN                                            0130
@RF00110 TM    FOUNDSW,B'10000000'                                 0130
         BNZ   @RF00130                                            0130
*     RETCODE=FOUR;                 /*                       @G24LB35*/
         LA    RETCODE,4                                           0131
*                                                                  0132
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0132
*                                   /*                       @G24LB35*/
*   RETURN;                         /* RETURN TO ICBVEX00    @G24LB35
*                                                            @G24LB35*/
@EL00003 DS    0H                                                  0132
@EF00003 DS    0H                                                  0132
@ER00003 L     @14,@SA00003                                        0132
         BR    @14                                                 0132
*   END FINDEXT;                    /* END OF FINDEXT PROC   @G24LB35*/
         B     @EL00003                                            0133
*                                                                  0134
*/********************************************************************/
*/*                                                          @G24LB35*/
*/*     PROCEDURE NAME - SPACERCD                            @G24LB35*/
*/*                                                          @G24LB35*/
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/
*/*                ICBVEX00 MAIN PROCEDURE, CALCULATES THE   @G24LB35*/
*/*                NUMBER OF CYLINDERS BEING ACQUIRED BY     @G24LB35*/
*/*                EOV, UPDATES THE GVSMTDSP VALUE (WHICH IS @G24LB35*/
*/*                APPROXIMATE FREE SPACE ON VOLUME) IN THE  @G24LB35*/
*/*                GROUP EXTENSION RECORD, AND RETURNS.      @G24LB35*/
*/*                                                          @G24LB35*/
*/*     INPUT -    THE GVSNE RECORD IS USED FOR GVSMTDSP AND @G24LB35*/
*/*                GVSRCFSI FIELD.                           @G24LB35*/
*/*                THE ARLIST IS USED FOR ARNMEXT AND AREXT  @G24LB35*/
*/*                                                          @G24LB35*/
*/*     OUTPUT -   THE GVSNE RECORD IS UPDATED WITH GVSMTDSP @G24LB35*/
*/*                THE RETURN CODE IS SET WITH:              @G24LB35*/
*/*                   0 = OK - WRITE EXTENSION RECORD        @G24LB35*/
*/*                   4 = DO NOT WRITE EXTENSION RECORD      @G24LB35*/
*/*                                                          @G24LB35*/
*/********************************************************************/
*                                                                  0134
*                                   /*                       @G24LB35*/
*SPACERCD:                          /*                       @G24LB35*/
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35
*                                                            @G24LB35*/
*                                                                  0134
SPACERCD ST    @14,12(,@13)                                        0134
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0135
*                                   /*                       @G24LB35*/
*   DCL                                                            0135
*     1 EXTENT(16),                 /* EXTENTS ARRAY         @G24LB35*/
*      2 BEGCC FIXED(16),           /* BEGINNING EXTENT      @G24LB35*/
*      2 ENDCC FIXED(16);           /* ENDING EXTENT         @G24LB35*/
*   DCL                                                            0136
*     ARRAY CHAR(256) BASED(EXTPTR);/* STRUCTURE TO          @G24LB35
*                                      MOVE UP BOTTOM HALF OF      0136
*                                                            @G24LB35
*                                      EXTENT ARRAY AFTER A  @G24LB35
*                                      CONSOLIDATION 2 EXTS  @G24LB35*/
*   DCL                                                            0137
*     EXTPTR PTR(31);               /* POINTER TO EXTENT ARRAY       */
*   DCL                                                            0138
*     LOOPCTR FIXED(15);            /* SORT LOOP COUNTER     @G24LB35*/
*   DCL                                                            0139
*     SPACE FIXED(15);              /* VARIABLE TO CAL SPACE @G24LB35*/
*   DCL                                                            0140
*     SIXTEEN FIXED(15) INIT(16);   /* NUMBER OF MAX EXTS    @G24LB35*/
*   DCL                                                            0141
*     SORTWORK CHAR(LENGTH(EXTENT));/* REPLACE AREA          @G24LB35*/
*   DCL                                                            0142
*     ELEMENTS FIXED(15);           /* NUMBER OF ELEMENTS    @G24LB35*/
*   DCL                                                            0143
*     EXTCTR FIXED(15);             /* NUMBER OF EXTENTS CTR @G24LB35*/
*   DCL                                                            0144
*     ELEMOVE BIT(1);               /* SWITCH FOR SORTING    @G24LB35*/
*   DCL                                                            0145
*     DONE BIT(1);                  /* SWITCH FOR LOOPING    @G24LB35*/
*                                                                  0146
*   /*****************************************************************/
*   /*                                                               */
*   /* THE GVSRCFSI BIT INDICATES THAT THE "APPROXIMATE      @G24LB35*/
*   /* FREE SPACE" IS INACCURATE. ALSO TESTED IS GVSMTDSP    @G24LB35*/
*   /* FOR ALREADY ZERO(LOWEST POSSIBLE). IF EITHER          @G24LB35*/
*   /* IS TRUE, THERE IS NO NEED TO UPDATE SPACE.            @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0146
*   IF GVSRCFSI(SLOT)=OFF&GVSMTDSP(SLOT)>ZERO THEN                 0146
         L     @06,GVSNEPTR                                        0146
         LH    @15,SLOT                                            0146
         MH    @15,@CH00342                                        0146
         ST    @15,@TF00001                                        0146
         ALR   @15,@06                                             0146
         TM    GVSRCFSI-20(@15),B'10000000'                        0146
         BNZ   @RF00146                                            0146
         L     @01,@TF00001                                        0146
         LH    @06,GVSMTDSP-20(@01,@06)                            0146
         LTR   @06,@06                                             0146
         BNP   @RF00146                                            0146
*     DO;                           /*                       @G24LB35*/
*       ELEMENTS=ARNMEXT;           /* INIT NUMBER OF EXTS   @G24LB35*/
*                                                                  0148
         SLR   ELEMENTS,ELEMENTS                                   0148
         IC    ELEMENTS,ARNMEXT(,PARMPTR)                          0148
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE ACQUIRE EXTENTS INTO WORKAREA                @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0149
*       EXTENT(ONE,ONE:LENGTH(EXTENT(ONE))*SIXTEEN)/*        @G24LB35*/
*           =AREXT(ONE,ONE:LENGTH(EXTENT(ONE))*SIXTEEN);/*   @G24LB35
*                                                            @G24LB35*/
*                                                                  0149
         LH    @15,SIXTEEN                                         0149
         SLA   @15,2                                               0149
         BCTR  @15,0                                               0149
         EX    @15,@SM00351                                        0149
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE EXTENT IS MADE IN TWO EXTENTS, THEN THE    @G24LB35*/
*       /* SORTING IS SKIPPED IN FOLLOWING STEP.             @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0150
*                                   /*                       @G24LB35
*                                                            @G24LB35*/
*       IF ELEMENTS>ONE THEN        /*                       @G24LB35*/
         C     ELEMENTS,@CF00037                                   0150
         BNH   @RF00150                                            0150
*         DO;                       /*                       @G24LB35*/
*                                                                  0151
*           /*********************************************************/
*           /*                                                       */
*           /* EXTENTS ARE SORTED IN ASCENDING ORDER         @G24LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0152
*           DONE=OFF;               /*                       @G24LB35*/
         NI    DONE,B'01111111'                                    0152
*           DO LOOPCTR=ELEMENTS-ONE TO ONE BY-ONE WHILE DONE=OFF;/*
*                                                            @G24LB35*/
         LR    LOOPCTR,ELEMENTS                                    0153
         BCTR  LOOPCTR,0                                           0153
         B     @DE00153                                            0153
@DL00153 TM    DONE,B'10000000'                                    0153
         BNZ   @DC00153                                            0153
*             DO EXTCTR=ONE TO LOOPCTR;/*                    @G24LB35*/
*                                                                  0154
         LA    EXTCTR,1                                            0154
         B     @DE00154                                            0154
@DL00154 DS    0H                                                  0155
*               /*****************************************************/
*               /*                                                   */
*               /* ONCE AN EXTENT IS FOUND OUT OF ORDER,     @G24LB35*/
*               /* IT IS EXCHANGED.                          @G24LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0155
*               IF EXTENT(EXTCTR,ONE:LENGTH(EXTENT(ONE)))>EXTENT(EXTCTR
*                   +ONE,ONE:LENGTH(EXTENT(ONE))) THEN             0155
         LR    @07,EXTCTR                                          0155
         SLA   @07,2                                               0155
         LA    @01,EXTENT-4(@07)                                   0155
         LA    @15,EXTENT(@07)                                     0155
         CLC   0(4,@01),0(@15)                                     0155
         BNH   @RF00155                                            0155
*                 DO;               /*                       @G24LB35*/
*                   ELEMOVE=ON;     /*                       @G24LB35*/
         OI    ELEMOVE,B'10000000'                                 0157
*                   SORTWORK=EXTENT(EXTCTR);/*               @G24LB35*/
         LA    @01,EXTENT-4(@07)                                   0158
         MVC   SORTWORK(4),0(@01)                                  0158
*                   EXTENT(EXTCTR)=EXTENT(EXTCTR+ONE);             0159
         LA    @01,EXTENT-4(@07)                                   0159
         LA    @15,EXTENT(@07)                                     0159
         MVC   0(4,@01),0(@15)                                     0159
*                   EXTENT(EXTCTR+ONE)=SORTWORK;/*           @G24LB35*/
         LA    @01,EXTENT(@07)                                     0160
         MVC   0(4,@01),SORTWORK                                   0160
*                 END;              /*                       @G24LB35*/
*             END;                  /*                       @G24LB35*/
*                                                                  0162
@RF00155 AL    EXTCTR,@CF00037                                     0162
@DE00154 CR    EXTCTR,LOOPCTR                                      0162
         BNH   @DL00154                                            0162
*             /*******************************************************/
*             /*                                                     */
*             /* IF AN ELEMENT WAS INTERCHANGED THEN TURN    @G24LB35*/
*             /* ELEMOVE SWITCH OFF. IF NO INTERCHANGE WAS   @G24LB35*/
*             /* MADE AFTER COMPLETE PASS, TURN DONE SWITCH ON       */
*             /*                                             @G24LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0163
*                                   /*                       @G24LB35*/
*             IF ELEMOVE=ON THEN    /* DETERMINE IF DONE     @G24LB35*/
         TM    ELEMOVE,B'10000000'                                 0163
         BNO   @RF00163                                            0163
*               ELEMOVE=OFF;        /* RESET ELEMOVE SWITCH  @G24LB35*/
         NI    ELEMOVE,B'01111111'                                 0164
*             ELSE                  /*                       @G24LB35*/
*               DONE=ON;            /* INDICATE DONE         @G24LB35*/
         B     @RC00163                                            0165
@RF00163 OI    DONE,B'10000000'                                    0165
*           END;                    /*                       @G24LB35*/
*                                                                  0166
@RC00163 BCTR  LOOPCTR,0                                           0166
@DE00153 LTR   LOOPCTR,LOOPCTR                                     0166
         BP    @DL00153                                            0166
@DC00153 DS    0H                                                  0167
*           /*********************************************************/
*           /*                                                       */
*           /* AFTER THE EXTENTS HAVE BEEN SORTED, THEY      @G24LB35*/
*           /* ARE LOOPED THROUGH AND CONSOLIDATED WHERE     @G24LB35*/
*           /* THE EXTENTS ARE CONTIGUOUS OR SAME CYLINDERS  @G24LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0167
*           DO LOOPCTR=ELEMENTS TO TWO BY-ONE;/*             @G24LB35*/
         LR    LOOPCTR,ELEMENTS                                    0167
         B     @DE00167                                            0167
@DL00167 DS    0H                                                  0168
*             IF BEGCC(LOOPCTR)=ENDCC(LOOPCTR-ONE) THEN/*    @G24LB35*/
         LR    @07,LOOPCTR                                         0168
         SLA   @07,2                                               0168
         LA    @03,BEGCC-4(@07)                                    0168
         LA    @01,ENDCC-8(@07)                                    0168
         CLC   0(2,@03),0(@01)                                     0168
         BNE   @RF00168                                            0168
*               DO;                 /*                       @G24LB35*/
*                                                                  0169
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE LARGEST ENDING CC OF THE TWO IS USED        */
*                 /*                                         @G24LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0170
*                 ENDCC(LOOPCTR-ONE)=ENDCC(LOOPCTR);/*       @G24LB35*/
*                                                                  0170
         LH    @03,ENDCC-4(@07)                                    0170
         N     @03,@CF00347                                        0170
         STH   @03,ENDCC-8(@07)                                    0170
*                 /***************************************************/
*                 /*                                                 */
*                 /* ALL THE EXTENTS BELOW ARE MOVED UP ONE  @G24LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0171
*                 IF LOOPCTR<SIXTEEN THEN/*                  @G24LB35*/
         LH    @03,SIXTEEN                                         0171
         CR    LOOPCTR,@03                                         0171
         BNL   @RF00171                                            0171
*                   DO;             /*                       @G24LB35*/
*                     EXTPTR=ADDR(EXTENT(LOOPCTR+ONE));/*    @G24LB35*/
         LA    EXTPTR,EXTENT(@07)                                  0173
*                     EXTENT(LOOPCTR,ONE:LENGTH(EXTENT)*/*   @G24LB35*/
*                         (SIXTEEN-LOOPCTR))=ARRAY;/*        @G24LB35*/
         LA    @01,EXTENT-4(@07)                                   0174
         LH    @07,SIXTEEN                                         0174
         SLR   @07,LOOPCTR                                         0174
         SLA   @07,2                                               0174
         BCTR  @07,0                                               0174
         EX    @07,@SM00353                                        0174
*                   END;            /*                       @G24LB35*/
*                 ELEMENTS=ELEMENTS-ONE;/*                   @G24LB35*/
@RF00171 BCTR  ELEMENTS,0                                          0176
*               END;                /*                       @G24LB35*/
*           END;                    /*                       @G24LB35*/
@RF00168 BCTR  LOOPCTR,0                                           0178
@DE00167 C     LOOPCTR,@CF00054                                    0178
         BNL   @DL00167                                            0178
*         END;                      /*                       @G24LB35*/
*                                                                  0179
*       /*************************************************************/
*       /*                                                           */
*       /* THE SORTED AND CONSOLIDATED EXTENTS ARE LOOPED    @G24LB35*/
*       /* THROUGH AND THE SPACE USED IS CALCULATED.         @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0180
*       SPACE=ZERO;                 /*                       @G24LB35*/
@RF00150 SLR   SPACE,SPACE                                         0180
*       DO LOOPCTR=ONE TO ELEMENTS BY ONE;/*                 @G24LB35*/
         LA    LOOPCTR,1                                           0181
         B     @DE00181                                            0181
@DL00181 DS    0H                                                  0182
*         SPACE=SPACE+ENDCC(LOOPCTR)-BEGCC(LOOPCTR)+ONE;           0182
         LR    @07,LOOPCTR                                         0182
         SLA   @07,2                                               0182
         LR    @15,SPACE                                           0182
         LH    @14,ENDCC-4(@07)                                    0182
         N     @14,@CF00347                                        0182
         ALR   @15,@14                                             0182
         LH    @07,BEGCC-4(@07)                                    0182
         N     @07,@CF00347                                        0182
         SLR   @15,@07                                             0182
         AL    @15,@CF00037                                        0182
         LR    SPACE,@15                                           0182
*       END;                        /*                       @G24LB35*/
*                                                                  0183
         AL    LOOPCTR,@CF00037                                    0183
@DE00181 CR    LOOPCTR,ELEMENTS                                    0183
         BNH   @DL00181                                            0183
*       /*************************************************************/
*       /*                                                           */
*       /* THE SPACE USED IS DECREMENTED FROM THE GVSNE.     @G24LB35*/
*       /* IF THE SPACE TO BE DECREMENTED IS LARGER THAN     @G24LB35*/
*       /* THE AMOUNT OF RUNNING FREE SPACE, IT IS SET       @G24LB35*/
*       /* TO ITS LOWEST POSSIBLE VALUE - ZERO.              @G24LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0184
*       IF GVSMTDSP(SLOT)<SPACE THEN/*                       @G24LB35*/
         L     @02,GVSNEPTR                                        0184
         LH    @15,SLOT                                            0184
         MH    @15,@CH00342                                        0184
         CH    SPACE,GVSMTDSP-20(@15,@02)                          0184
         BNH   @RF00184                                            0184
*         GVSMTDSP(SLOT)=ZERO;      /*                       @G24LB35*/
         SLR   @14,@14                                             0185
         STH   @14,GVSMTDSP-20(@15,@02)                            0185
*       ELSE                        /*                       @G24LB35*/
*         GVSMTDSP(SLOT)=GVSMTDSP(SLOT)-SPACE;/*             @G24LB35*/
         B     @RC00184                                            0186
@RF00184 L     @02,GVSNEPTR                                        0186
         LH    @15,SLOT                                            0186
         MH    @15,@CH00342                                        0186
         LH    @14,GVSMTDSP-20(@15,@02)                            0186
         SLR   @14,SPACE                                           0186
         STH   @14,GVSMTDSP-20(@15,@02)                            0186
*     END;                          /*                       @G24LB35*/
*                                                                  0187
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE INVALID RUNNING SPACE FLAG IS                  @G24LB35*/
*   /* FOUND ON OR THE RUNNING SPACE IS ALREADY ZERO,        @G24LB35*/
*   /* THE NO SPACE UPDATE CODE IS SET SO THE RECORD         @G24LB35*/
*   /* WILL NOT BE REWRITTEN BACK TO THE MSVI DATA SET       @G24LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0188
*   ELSE                                                           0188
*     RETCODE=FOUR;                 /*                       @G24LB35*/
         B     @RC00146                                            0188
@RF00146 LA    RETCODE,4                                           0188
*   RETURN;                         /*                       @G24LB35*/
@EL00004 DS    0H                                                  0189
@EF00004 DS    0H                                                  0189
@ER00004 L     @14,12(,@13)                                        0189
         BR    @14                                                 0189
*   END SPACERCD;                   /*                       @G24LB35*/
         B     @EL00004                                            0190
*   END ICBVEX00                    /*                       @G24LB35*/
*                                                                  0191
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*                                                                  0191
*       ;                                                          0191
@DATA    DS    0H
@CH00342 DC    H'20'
@SM00351 MVC   EXTENT(0),AREXT(PARMPTR)
@SM00353 MVC   0(0,@01),ARRAY(EXTPTR)
         DS    0F
@SA00001 DS    18F
@SA00003 DS    0F
@SA00002 DS    0F
         DS    1F
@TF00001 DS    F
         DS    0F
@CF00037 DC    F'1'
@CF00054 DC    F'2'
@CF00340 DC    F'224'
@CF00341 DC    F'988'
@CF00347 DC    XL4'0000FFFF'
@CV00292 DC    V(ICBVIO00)
@CV00293 DC    V(ICBVRR00)
         DS    0D
GVSNEPTR DS    A
BASEVPTR DS    A
SLOT     DS    H
SIXTEEN  DC    H'16'
FIXAREA  DS    CL250
         ORG   FIXAREA
@NM00021 DC    250X'00'
         ORG   FIXAREA+250
GROUPKEY DS    CL13
         ORG   GROUPKEY
GROUPG   DC    CL3'G  '
GROUPNAM DS    CL8
GROUPBLK DC    CL1' '
GROUPIND DS    FL1
         ORG   GROUPKEY+13
BASEKEY  DS    CL13
         ORG   BASEKEY
BASEVG   DC    CL5'V    '
BASEVNAM DS    CL6
BASEVBLK DC    CL1' '
BASEVIND DC    XL1'00'
         ORG   BASEKEY+13
GVSNEBUF DS    CL988
BASEVBUF DS    CL224
SYSGROUP DC    CL8'SYSGROUP'
FOUNDSW  DS    BL1
SORTWORK DS    CL4
ELEMOVE  DS    BL1
DONE     DS    BL1
         DS    CL1
EXTENT   DS    CL4
         ORG   EXTENT+0
BEGCC    DS    FL2
ENDCC    DS    FL2
         ORG   EXTENT+64
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
EXTCTR   EQU   @03
ELEMENTS EQU   @06
SPACE    EQU   @03
LOOPCTR  EQU   @02
EXTPTR   EQU   @03
RETCODE  EQU   @05
PARMPTR  EQU   @07
VVIPTR   EQU   @02
RPLVPTR  EQU   @04
REG0     EQU   @00
REG1     EQU   @01
REG14    EQU   @14
ARR1     EQU   @01
RPLV     EQU   0
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLVRETC EQU   RPLV+34
RPLVSAM  EQU   RPLV+56
RPLVTYP  EQU   RPLVSAM+2
RPLVBUF  EQU   RPLVSAM+32
RPLVKEY  EQU   RPLVSAM+36
RPLVOPT  EQU   RPLVSAM+40
RPLVDIR  EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
RPLVUPD  EQU   RPLVOPT+1
RPLVBLN  EQU   RPLVSAM+52
RPLVUTIL EQU   RPLV+132
VVICB    EQU   0
VVIFLGA  EQU   VVICB+15
VVIFLG0  EQU   VVIFLGA
GVSNE    EQU   0
GVSHDR   EQU   GVSNE
GVSNAME  EQU   GVSHDR
GVSVVGRP EQU   GVSNAME+3
GVSID    EQU   GVSNAME+11
GVSNO    EQU   GVSID+1
GVSFLAGA EQU   GVSHDR+13
GVSTYPE  EQU   GVSFLAGA
GVSEX    EQU   GVSFLAGA+2
GVSESIND EQU   GVSHDR+18
GVSSLOTS EQU   GVSNE+28
GVSVOLID EQU   GVSSLOTS
GVSVOLFL EQU   GVSSLOTS+6
GVSRCFSI EQU   GVSVOLFL+2
GVSMTDSP EQU   GVSSLOTS+18
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASGRPV  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASGROUP EQU   BASEV+180
ARLIST   EQU   0
ARFLG    EQU   ARLIST+6
ARNMEXT  EQU   ARLIST+7
ARVOL    EQU   ARLIST+8
AREXT    EQU   ARLIST+28
ARRAY    EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ARNEDB   EQU   ARLIST+92
@NM00020 EQU   AREXT
ARCOMPC  EQU   ARLIST+26
@NM00019 EQU   ARLIST+25
ARHOST   EQU   ARLIST+20
ARECB    EQU   ARLIST+16
ARASID   EQU   ARLIST+14
@NM00018 EQU   ARFLG
ARSEC    EQU   ARFLG
ARINH    EQU   ARFLG
ARDRES   EQU   ARFLG
ARBDUBD  EQU   ARFLG
@NM00017 EQU   ARLIST+5
AROP     EQU   ARLIST+4
ARLL     EQU   ARLIST
@NM00016 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00015 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00014 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
GVSEXPDT EQU   GVSSLOTS+14
GVSLEXT  EQU   GVSSLOTS+12
GVSFRESP EQU   GVSSLOTS+10
@NM00013 EQU   GVSVOLFL+2
GVSMTNSH EQU   GVSVOLFL+2
GVSCPUBM EQU   GVSVOLFL
@NM00012 EQU   GVSHDR+20
@NM00011 EQU   GVSHDR+17
@NM00010 EQU   GVSFLAGA+2
@NM00009 EQU   GVSTYPE
GVSGVSEX EQU   GVSTYPE
@NM00008 EQU   GVSTYPE
GVSRES1  EQU   GVSID
GVSG     EQU   GVSNAME
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIDVMEL EQU   VVICB+104
VVIVBSTF EQU   VVICB+100
VVISSOBA EQU   VVICB+96
VVIVSCRA EQU   VVICB+92
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIJUCB  EQU   VVICB+80
VVIIUCB  EQU   VVICB+76
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIUCB   EQU   VVICB+60
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIQRPL2 EQU   VVICB+44
VVIQRPL1 EQU   VVICB+40
VVIRES3  EQU   VVICB+36
VVIVQMP  EQU   VVICB+32
VVIECB1  EQU   VVICB+28
VVICATAD EQU   VVICB+24
VVIDCBAD EQU   VVICB+20
VVIACBAD EQU   VVICB+16
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG3  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIALCON EQU   VVICB+14
VVICPUID EQU   VVICB+12
VVIUCAT  EQU   VVICB+4
VVICID   EQU   VVICB
RPLVRLN  EQU   RPLVSAM+48
@NM00007 EQU   RPLVSAM+44
@NM00006 EQU   RPLVOPT
@NM00005 EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
RPLVLOC  EQU   RPLVOPT
@NM00004 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00003 EQU   RPLVSAM+3
@NM00002 EQU   RPLVSAM
@NM00001 EQU   RPLV+38
RPLRMSCC EQU   RPLV+36
RPLRCODE EQU   RPLV+32
RPLVTLEN EQU   RPLV+30
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLVVOP  EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLFTIME EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
RPLVQPTR EQU   RPLV
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00060 EQU   @EL00001
@RF00084 EQU   @EL00002
@RF00086 EQU   @EL00002
@RF00125 EQU   @RC00118
@RF00130 EQU   @EL00003
@RC00146 EQU   @EL00004
@RC00184 EQU   @RC00146
@ENDDATA EQU   *
         END   ICBVEX00,(C'PLS1953',0603,76273)

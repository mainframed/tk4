         TITLE '************* ICBVSL00: VOLUME SELECTION ROUTINE********
               *****    '
ICBVSL00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICBVSL00  77.354'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*   RPLVPTR=REG1;                   /* ADDRESS OF RPLV       @G24LB26*/
         LR    RPLVPTR,REG1                                        0228
*   RESPECIFY                                                      0229
*     REG1 UNRSTD;                  /*                       @G24LB26*/
*   SELTMPTR=ADDR(RPLVUTIL);        /* ADDRESS OF SELECTOR   @G24LB26
*                                      PARM LIST             @G24LB26*/
         LA    SELTMPTR,RPLVUTIL(,RPLVPTR)                         0230
*   VVIPTR=RPLVVICB;                /* ADDRESS OF MSVC       @G24LB26
*                                      CONTROL BLOCK         @G24LB26*/
         L     @08,RPLVVICB(,RPLVPTR)                              0231
         ST    @08,VVIPTR                                          0231
*   IF VVIFLG0=ON THEN              /* MSVC INVENTORY        @G24LB26
*                                      DISABLED?             @G24LB26*/
         TM    VVIFLG0(@08),B'10000000'                            0232
         BNO   @RF00232                                            0232
*     DO;                           /*                       @G24LB26*/
*       RPLVRETC=RCFOUR;            /* SET BAD RETURN        @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0234
*       RPLRCODE=MSVCDISA;          /* INDICATE DISABLED     @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02077                        0235
*     END;                          /*                       @G24LB26*/
*                                                                  0237
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF PROCESSING TO CONTINUE                   @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/
@RF00232 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0237
         BNE   @RF00237                                            0237
*     DO;                           /*                       @G24LB26*/
*                                                                  0238
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE KEYS IN CASE PREVIOUS EXECUTION OF     @G24LB26*/
*       /* PROGRAM ALTERED THEM                              @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0239
*       GBLKKY=BLANK;               /* FILL AREA             @G24LB26*/
         MVI   GBLKKY,C' '                                         0239
*       GIDKY=ZERO;                 /* INDEX AREA            @G24LB26*/
*                                                                  0240
         MVI   GIDKY,X'00'                                         0240
*       /*************************************************************/
*       /*                                                           */
*       /* SETUP ADDRESSING TO RECORD RETURN AREAS           @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0241
*       BASEVPTR=ADDR(STORBASE);    /* ADDRESS BASE REC AREA @G24LB26*/
         LA    @08,STORBASE                                        0241
         ST    @08,BASEVPTR                                        0241
*       GROUPPTR=ADDR(STORGRP);     /* ADDRESS GROUP REC AREA      0242
*                                                            @G24LB26*/
         LA    @08,STORGRP                                         0242
         ST    @08,GROUPPTR                                        0242
*       GVSNEPTR=ADDR(STORGPEX);    /* ADDRESS EXTEND REC    @G24LB26
*                                      AREA                  @G24LB26*/
*                                                                  0243
         LA    @08,STORGPEX                                        0243
         ST    @08,GVSNEPTR                                        0243
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO INTERNAL WORK AREA AND FLAGS                 @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0244
*       INTWORK=INTWORK&&INTWORK;   /*                       @G24LB26*/
         XC    INTWORK(22),INTWORK                                 0244
*       DYNMFLGS=DYNMFLGS&&DYNMFLGS;/*                       @G24LB26*/
         XC    DYNMFLGS(2),DYNMFLGS                                0245
*       DSPDDADR=ZEROPTR;           /* CLEAR STEP TABLE DD   @G24LB26
*                                      ENTRY ADDRESS         @G24LB26*/
*                                                                  0246
         SLR   @08,@08                                             0246
         ST    @08,DSPDDADR                                        0246
*       /*************************************************************/
*       /*                                                           */
*       /* RESERVE THE INVENTORY DATA SET                    @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0247
*       RESPECIFY                                                  0247
*        (REG0,                                                    0247
*         REG1) RSTD;               /*                       @G24LB26*/
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @G24LB26*/
         LR    REG1,RPLVPTR                                        0248
*       REG0=RESEXINV;              /* INDICATE RESERVE      @G24LB26
*                                      EXCLUSIVE             @G24LB26*/
         LA    REG0,1                                              0249
*       CALL ICBVRR00;              /* CALL RESERVE/RELEASE  @G24LB26*/
         L     @15,@CV01909                                        0250
         BALR  @14,@15                                             0250
*       RESPECIFY                                                  0251
*        (REG0,                                                    0251
*         REG1) UNRSTD;             /*                       @G24LB26*/
*                                                                  0252
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOL=REF REQUEST CALL APPROPRIATE ROUTINE       @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0252
*       IF SELVOLRF=ON THEN         /*                       @G24LB26*/
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0252
         BNO   @RF00252                                            0252
*         CALL VOLREF;              /*                       @G24LB26*/
         BAL   @14,VOLREF                                          0253
*     END;                          /*                       @G24LB26*/
*                                                                  0254
@RF00252 DS    0H                                                  0255
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLREF WAS NOT CALLED AND THERE ARE NO BAD         @G24LB26*/
*   /* RETURN CODES, CONTINUE                                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0255
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF THEN/*                   @G24LB26*/
@RF00237 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0255
         BNE   @RF00255                                            0255
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0255
         BNZ   @RF00255                                            0255
*     DO;                           /*                       @G24LB26*/
*                                                                  0256
*       /*************************************************************/
*       /*                                                           */
*       /* READ GROUP RECORD, FOR READ ONLY                  @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0257
*       GROUPKY=JFCMSVGP;           /* GROUP NAME IN KEY     @G24LB26*/
         L     @08,JFCBPTR(,SELTMPTR)                              0257
         MVC   GROUPKY(8),JFCMSVGP(@08)                            0257
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @G24LB26*/
         LA    @08,GKEY                                            0258
         ST    @08,RPLVKEY(,RPLVPTR)                               0258
*       RPLVBUF=ADDR(STORGRP);      /* ADDR GROUP BUFFER     @G24LB26*/
         LA    @08,STORGRP                                         0259
         ST    @08,RPLVBUF(,RPLVPTR)                               0259
*       RPLVBLN=LENGTH(STORGRP);    /* BUFFER LENGTH         @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02237                         0260
*       RPLVDIR=ON;                 /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0261
*       RPLVTYP=RPLVREAD;           /* READ                  @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0262
*       RESPECIFY                                                  0263
*         REG1 RSTD;                /*                       @G24LB26*/
*       REG1=RPLVPTR;               /* ADD OF RPLV           @G24LB26*/
         LR    REG1,RPLVPTR                                        0264
*       CALL ICBVIO00;              /* I/O PROCESSOR         @G24LB26*/
         L     @15,@CV01910                                        0265
         BALR  @14,@15                                             0265
*       RESPECIFY                                                  0266
*         REG1 UNRSTD;              /*                       @G24LB26*/
*                                                                  0266
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN                                      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0267
*       IF RPLVRETC^=RCZERO THEN    /*                       @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0267
         BE    @RF00267                                            0267
*         DO;                       /*                       @G24LB26*/
*                                                                  0268
*           /*********************************************************/
*           /*                                                       */
*           /* IF UNABLE TO READ GROUP RECORD,               @G24LB26*/
*           /* ISSUE MESSAGE ICB415I                         @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0269
*           MSGRQ=MSGRQ&&MSGRQ;     /* CLEAR MSG PARM LIST   @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0269
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0270
*           MSGID=MSG415;           /* MESSAGE ID FOR ICB415I      0271
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02065                                   0271
*           MSGLEN1=EIGHT;          /* LENGTH OF INSERT      @G24LB26*/
         MVI   MSGLEN1,X'08'                                       0272
*           MSGTEXT1=ADDR(GROUPKY); /* GROUP NAME IM MESSAGE @G24LB26*/
         LA    @08,GROUPKY                                         0273
         STCM  @08,7,MSGTEXT1                                      0273
*           RESPECIFY                                              0274
*             REG1 RSTD;            /*                       @G24LB26*/
*           REG1=ADDR(MSGRQ);       /* ADDR OF MSG PARM LIST @G24LB26*/
         LA    REG1,MSGRQ                                          0275
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0276
         BALR  @14,@15                                             0276
*           RESPECIFY                                              0277
*             REG1 UNRSTD;          /*                       @G24LB26*/
*           RPLRCODE=NOGRPFND;      /* REASON CODE HEX 231   @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02089                        0278
*           RPLVRETC=RCFOUR;        /* RETURN CODE 4         @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0279
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  0281
@RF00267 DS    0H                                                  0282
*   /*****************************************************************/
*   /*                                                               */
*   /* ENSURE STILL NEED TO CONTINUE                         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0282
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF THEN/*                   @G24LB26*/
@RF00255 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0282
         BNE   @RF00282                                            0282
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0282
         BNZ   @RF00282                                            0282
*     DO;                           /*                       @G24LB26*/
*                                                                  0283
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF GROUP SUPPORTS THIS TYPE OF REQUEST  @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0284
*       IF GROCONUS=ZERO THEN       /*                       @G24LB26*/
         L     @08,GROUPPTR                                        0284
         CLI   GROCONUS(@08),0                                     0284
         BNE   @RF00284                                            0284
*         DO;                       /*                       @G24LB26*/
*                                                                  0285
*           /*********************************************************/
*           /*                                                       */
*           /* ZERO CONCURRENT USERS, THEREFORE GROUP        @G24LB26*/
*           /* DOES NOT SUPPORT THIS FUNCTION. RETURN.       @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0286
*           RPLRCODE=RCZERO;        /* SET ZERO REASON CODE  @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0286
*           RPLVRETC=RCZERO;        /* SET ZERO RETURN CODE  @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0287
*           EXITVSL=ON;             /* INDICATE DONE         @G24LB26*/
         OI    EXITVSL,B'00100000'                                 0288
*         END;                      /*                       @G24LB26*/
*                                                                  0289
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF ANY GENERAL USE VOLUMES IN GROUP     @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0290
*       ELSE                        /*                       @G24LB26*/
*         IF GRONGEN=ZERO THEN      /*                       @G24LB26*/
         B     @RC00284                                            0290
@RF00284 L     @08,GROUPPTR                                        0290
         LH    @08,GRONGEN(,@08)                                   0290
         LTR   @08,@08                                             0290
         BNZ   @RF00290                                            0290
*           DO;                     /*                       @G24LB26*/
*                                                                  0291
*             /*******************************************************/
*             /*                                                     */
*             /* IF THERE ARE NO GENERAL USE VOLUMES IN      @G24LB26*/
*             /* GROUP, ISSUE MESSAGE ICB407I AND RETURN     @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0292
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR PARM LIST       @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0292
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0293
*             MSGID=MSG407;         /* MESSAGE ID FOR ICB407I      0294
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02061                                   0294
*             MSGLEN1=EIGHT;        /* LENGTH INSERT         @G24LB26*/
         MVI   MSGLEN1,X'08'                                       0295
*             MSGTEXT1=ADDR(GROUPKY);/* INSERT GROUP NAME    @G24LB26*/
         LA    @08,GROUPKY                                         0296
         STCM  @08,7,MSGTEXT1                                      0296
*             RESPECIFY                                            0297
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=ADDR(MSGRQ);     /* ADDR PARM LIST        @G24LB26*/
         LA    REG1,MSGRQ                                          0298
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0299
         BALR  @14,@15                                             0299
*             RESPECIFY                                            0300
*               REG1 UNRSTD;        /*                       @G24LB26*/
*             RPLRCODE=SELFAIL;     /* REASON CODE OF HEX 232      0301
*                                                            @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0301
*             RPLVRETC=RCFOUR;      /* SET RETURN CODE       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0302
*           END;                    /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  0304
@RF00290 DS    0H                                                  0304
@RC00284 DS    0H                                                  0305
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF REQUEST IS FINISHED OR IF PROCESSING     @G24LB26*/
*   /* SHOULD CONTINUE                                       @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/
*                                                                  0305
@RF00282 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0305
         BNE   @RF00305                                            0305
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0305
         BNZ   @RF00305                                            0305
         TM    EXITVSL,B'00100000'                                 0305
         BNZ   @RF00305                                            0305
*     /***************************************************************/
*     /*                                                             */
*     /* CALL ROUTINE TO DETERMINE IF VALID REQUEST          @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0306
*     CALL SELSCREN;                /*                       @G24LB26*/
         BAL   @14,SELSCREN                                        0306
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/
@RF00305 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0307
         BNE   @RF00307                                            0307
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0307
         BNZ   @RF00307                                            0307
         TM    EXITVSL,B'00100000'                                 0307
         BNZ   @RF00307                                            0307
*     DO;                           /*                       @G24LB26*/
*                                                                  0308
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE THE NUMBER OF VOLUMES TO BE SELECTED    @G24LB26*/
*       /* FOR THIS REQUEST                                  @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0309
*       IF SELPARMT=ON THEN         /*                       @G24LB26*/
         TM    SELPARMT(SELTMPTR),B'10000000'                      0309
         BNO   @RF00309                                            0309
*         NUMBVOL=JFCBVLCT;         /*                       @G24LB26*/
*                                                                  0310
         L     @08,JFCBPTR(,SELTMPTR)                              0310
         IC    @06,JFCBVLCT(,@08)                                  0310
         STC   @06,NUMBVOL                                         0310
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT PARALLEL MOUNT, UNIT COUNT IS DESIRED      @G24LB26*/
*       /* NUMBER                                            @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0311
*       ELSE                        /*                       @G24LB26*/
*         NUMBVOL=SELUNCNT;         /*                       @G24LB26*/
*                                                                  0311
         B     @RC00309                                            0311
@RF00309 IC    @08,SELUNCNT(,SELTMPTR)                             0311
         STC   @08,NUMBVOL                                         0311
*       /*************************************************************/
*       /*                                                           */
*       /* IF MORE VOLUMES THAN UNITS AND NOT PARALLEL       @G24LB26*/
*       /* MOUNT, THEN REQUEST IS FOR NON-SHARE              @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0312
*       IF JFCBVLCT>SELUNCNT&SELPARMT=OFF THEN/*             @G24LB26*/
@RC00309 L     @08,JFCBPTR(,SELTMPTR)                              0312
         CLC   JFCBVLCT(1,@08),SELUNCNT(SELTMPTR)                  0312
         BNH   @RF00312                                            0312
         TM    SELPARMT(SELTMPTR),B'10000000'                      0312
         BNZ   @RF00312                                            0312
*         NSHRREQF=ON;              /* INDICATE NON-SHARE    @G24LB26
*                                      REQUEST               @G24LB26*/
*                                                                  0313
         OI    NSHRREQF,B'10000000'                                0313
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THERE IS ENOUGH GENERAL USE VOLUMES  @G24LB26*/
*       /* IN GROUP TO SATISFY THE REQUEST. EXIT IF NOT      @G24LB26*/
*       /* ENOUGH.                                           @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0314
*       IF NUMBVOL>GRONGEN THEN     /*                       @G24LB26*/
@RF00312 SLR   @08,@08                                             0314
         IC    @08,NUMBVOL                                         0314
         L     @06,GROUPPTR                                        0314
         CH    @08,GRONGEN(,@06)                                   0314
         BNH   @RF00314                                            0314
*         DO;                       /*                       @G24LB26*/
*                                                                  0315
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE ERROR MESSAGE ICB407I AND REASON CODE   @G24LB26*/
*           /* HEX 232                                       @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0316
*           MSGRQ=MSGRQ&&MSGRQ;     /* CLEAR PARM LIST       @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0316
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0317
*           MSGID=MSG407;           /* MESSAGE ID FOR ICB407I      0318
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02061                                   0318
*           MSGLEN1=EIGHT;          /* LENGTH INSERT         @G24LB26*/
         MVI   MSGLEN1,X'08'                                       0319
*           MSGTEXT1=ADDR(GROUPKY); /* INSERT GROUP NAME     @G24LB26*/
         LA    @08,GROUPKY                                         0320
         STCM  @08,7,MSGTEXT1                                      0320
*           RESPECIFY                                              0321
*             REG1 RSTD;            /*                       @G24LB26*/
*           REG1=ADDR(MSGRQ);       /* ADDR PRINT PARM       @G24LB26*/
         LA    REG1,MSGRQ                                          0322
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0323
         BALR  @14,@15                                             0323
*           RESPECIFY                                              0324
*             REG1 UNRSTD;          /*                       @G24LB26*/
*           RPLRCODE=SELFAIL;       /* REASON CODE OF HEX 232      0325
*                                                            @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0325
*           RPLVRETC=RCFOUR;        /* RETURN CODE 4         @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0326
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  0328
@RF00314 DS    0H                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK AGAIN                                           @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/
@RF00307 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0329
         BNE   @RF00329                                            0329
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0329
         BNZ   @RF00329                                            0329
         TM    EXITVSL,B'00100000'                                 0329
         BNZ   @RF00329                                            0329
*     DO;                           /*                       @G24LB26*/
*                                                                  0330
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF A GETMAIN REQUIRED FOR BEST FIT      @G24LB26*/
*       /* TABLE                                             @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0331
*       IF GRONGEN>GVSNSLOT THEN    /* IF GREATER THAN 48,   @G24LB26
*                                      MUST DO GETMAIN       @G24LB26*/
         L     @08,GROUPPTR                                        0331
         LH    @08,GRONGEN(,@08)                                   0331
         C     @08,@CF00346                                        0331
         BNH   @RF00331                                            0331
*         DO;                       /*                       @G24LB26*/
*                                                                  0332
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE GETMAIN AFTER CALCULATE SPACE REQUIRED  @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0333
*           GETMNLEN=BFHEADLN+(GRONGEN*BFSLOTLN);/* LENGTH   @G24LB26*/
         LR    @01,@08                                             0333
         SLR   @08,@08                                             0333
         IC    @08,BFSLOTLN                                        0333
         MR    @00,@08                                             0333
         SLR   @08,@08                                             0333
         IC    @08,BFHEADLN                                        0333
         ALR   @01,@08                                             0333
         STH   @01,GETMNLEN                                        0333
*           RESPECIFY                                              0334
*            (REG2,                                                0334
*             REG15) RSTD;          /*                       @G24LB26*/
*           REG2=ADDR(BFTBLPTR);    /* ADDR OF LOCATION TO   @G24LB26
*                                      PLACE CORE ADDRESS    @G24LB26*/
         LA    REG2,BFTBLPTR                                       0335
*           REG15=GETMNLEN;         /* LENGTH OF AREA NEEDED @G24LB26*/
         LR    REG15,@01                                           0336
*LGETM1:                                                           0337
*           GEN REFS(REG2,REG15) SETS(REG15);                      0337
*                                                                  0337
LGETM1   DS    0H                                                  0337
*                                                         /*@G24LB26*/
       GETMAIN EC,LV=(REG15),A=(REG2),SP=241                  @G24LB26
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK RETURN CODE                             @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0338
*           IF REG15=RCZERO THEN    /*                       @G24LB26*/
         LTR   REG15,REG15                                         0338
         BNZ   @RF00338                                            0338
*             DO;                   /*                       @G24LB26*/
*                                                                  0339
*               /*****************************************************/
*               /*                                                   */
*               /* CLEAR HEADER SECTION OF BEST FIT TABLE    @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0340
*               BFHEADER=BFHEADER&&BFHEADER;/*               @G24LB26*/
*                                                                  0340
         L     @14,BFTBLPTR                                        0340
         XC    BFHEADER(21,@14),BFHEADER(@14)                      0340
*               /*****************************************************/
*               /*                                                   */
*               /* PUT LENGTH OF GETMAINED AREA IN FIRST     @G24LB26*/
*               /* TWO BYTES OF AREA                         @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0341
*               BFLEN=GETMNLEN;     /* PUT IN LENGTH         @G24LB26*/
*                                                                  0341
         LH    @08,GETMNLEN                                        0341
         STH   @08,BFLEN(,@14)                                     0341
*               /*****************************************************/
*               /*                                                   */
*               /* PUT ADDRESS OF GETMAINED AREA IN VVICB    @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0342
*               VVIVBSTF=BFTBLPTR;  /* ADDRESS IN VVICB      @G24LB26*/
*                                                                  0342
         L     @08,VVIPTR                                          0342
         ST    @14,VVIVBSTF(,@08)                                  0342
*               /*****************************************************/
*               /*                                                   */
*               /* SET NON-SHARE FLAG FROM THE INTERNAL      @G24LB26*/
*               /* WORK AREA                                 @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0343
*               IF NSHRREQF=ON THEN /*                       @G24LB26*/
         TM    NSHRREQF,B'10000000'                                0343
         BNO   @RF00343                                            0343
*                 BFNSHRFL=ON;      /*                       @G24LB26*/
         OI    BFNSHRFL(@14),B'10000000'                           0344
*             END;                  /*                       @G24LB26*/
*                                                                  0345
*           /*********************************************************/
*           /*                                                       */
*           /* GETMAIN UNSUCCESSFUL                          @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0346
*           ELSE                    /*                       @G24LB26*/
*             DO;                   /*                       @G24LB26*/
*                                                                  0346
         B     @RC00338                                            0346
@RF00338 DS    0H                                                  0347
*               /*****************************************************/
*               /*                                                   */
*               /* IF GETMAIN FAILURE, ISSUE MESSAGE ICB409I @G24LB26*/
*               /* AND REASON CODE 22A. EXIT PROGRAM         @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0347
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR PARM LIST       @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0347
*               MSGRPLV=RPLVPTR;    /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0348
*               MSGID=MSG409;       /* MESSAGE ID FOR ICB409I      0349
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02063                                   0349
*               RESPECIFY                                          0350
*                 REG1 RSTD;        /*                       @G24LB26*/
*               REG1=ADDR(MSGRQ);   /* ADDR OF REQUEST BLOCK @G24LB26*/
         LA    REG1,MSGRQ                                          0351
*               CALL ICBVOP00;      /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0352
         BALR  @14,@15                                             0352
*               RESPECIFY                                          0353
*                 REG1 UNRSTD;      /*                       @G24LB26*/
*               RPLRCODE=NOSTORAG;  /* SET 22A REASON CODE   @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02079                        0354
*               RPLVRETC=RCFOUR;    /* SET RETURN CODE TO 4  @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0355
*             END;                  /*                       @G24LB26*/
*           RESPECIFY                                              0357
*            (REG2,                                                0357
*             REG15) UNRSTD;        /*                       @G24LB26*/
@RC00338 DS    0H                                                  0358
*         END;                      /*                       @G24LB26*/
*                                                                  0358
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE ARE LESS THAN 48 VOLUMES IN GROUP,       @G24LB26*/
*       /* USE BEST FIT TABLES IN PROGRAM                    @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0359
*       ELSE                        /*                       @G24LB26*/
*         DO;                       /*                       @G24LB26*/
         B     @RC00331                                            0359
@RF00331 DS    0H                                                  0360
*           BFTBLPTR=ADDR(STRBFTBL);/* SET UP ADDRESSABILITY @G24LB26
*                                      TO BEST FIT TABLE     @G24LB26*/
*                                                                  0360
         LA    @08,STRBFTBL                                        0360
         ST    @08,BFTBLPTR                                        0360
*           /*********************************************************/
*           /*                                                       */
*           /* CLEAR HEADER SECTION OF BEST FIT TABLE        @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0361
*           BFHEADER=BFHEADER&&BFHEADER;/*                   @G24LB26*/
         XC    BFHEADER(21,@08),BFHEADER(@08)                      0361
*           BFLEN=LENGTH(STRBFTBL); /* PUT IN LENGTH OF TABLE      0362
*                                                            @G24LB26*/
*                                                                  0362
         MVC   BFLEN(2,@08),@CH02238                               0362
*           /*********************************************************/
*           /*                                                       */
*           /* NOW THAT ADDRESSING SET UP TO BEST FIT TABLE  @G24LB26*/
*           /* SET NON-SHARE FLAG FROM INTERNAL WORK AREA.   @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0363
*           IF NSHRREQF=ON THEN     /*                       @G24LB26*/
         TM    NSHRREQF,B'10000000'                                0363
         BNO   @RF00363                                            0363
*             BFNSHRFL=ON;          /*                       @G24LB26*/
         OI    BFNSHRFL(@08),B'10000000'                           0364
*         END;                      /*                       @G24LB26*/
@RF00363 DS    0H                                                  0366
*     END;                          /*                       @G24LB26*/
*                                                                  0366
@RC00331 DS    0H                                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF PROGRAM HAS ENCOUNTERED ERROR YET.           @G24LB26*/
*   /* IF NOT, CONTINUE                                      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0367
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/
@RF00329 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0367
         BNE   @RF00367                                            0367
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0367
         BNZ   @RF00367                                            0367
         TM    EXITVSL,B'00100000'                                 0367
         BNZ   @RF00367                                            0367
*     DO;                           /*                       @G24LB26*/
*                                                                  0368
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SELECTVOL ROUTINE TO SELECT VOLUMES          @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0369
*       CALL SELCTVOL;              /*                       @G24LB26*/
*                                                                  0369
         BAL   @14,SELCTVOL                                        0369
*       /*************************************************************/
*       /*                                                           */
*       /* IF GETMAIN ISSUED, FREE STORAGE OBTAINED          @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0370
*       IF VVIVBSTF^=ZERO THEN      /*                       @G24LB26*/
         SLR   @08,@08                                             0370
         L     @15,VVIPTR                                          0370
         C     @08,VVIVBSTF(,@15)                                  0370
         BE    @RF00370                                            0370
*         DO;                       /*                       @G24LB26*/
*                                                                  0371
*           /*********************************************************/
*           /*                                                       */
*           /* ZERO OUT GETMAINED ADDRESS IN VVICB SO        @G24LB26*/
*           /* THAT NO ATTEMPT WILL BE MADE TO FREE IT AGAIN @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0372
*           VVIVBSTF=ZERO;          /*                       @G24LB26*/
*                                                                  0372
         ST    @08,VVIVBSTF(,@15)                                  0372
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE FREEMAIN FOR BEST FIT TABLE             @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0373
*           RESPECIFY                                              0373
*            (REG2,                                                0373
*             REG15) RSTD;          /*                       @G24LB26*/
*           REG2=ADDR(BFTBLPTR);    /* LOCATION              @G24LB26
*                                      TO BE FREED           @G24LB26*/
         LA    REG2,BFTBLPTR                                       0374
*           REG15=GETMNLEN;         /* LENGTH OF GETMAINED   @G24LB26
*                                      AREA.                 @G24LB26*/
         LH    REG15,GETMNLEN                                      0375
*LFREEM1:                                                          0376
*           GEN REFS(REG2,REG15) SETS(REG15);                      0376
LFREEM1  DS    0H                                                  0376
*                                                         /*@G24LB26*/
         FREEMAIN E,LV=(REG15),A=(REG2),SP=241                @G24LB26
*           RESPECIFY                                              0377
*            (REG2,                                                0377
*             REG15) UNRSTD;        /*                       @G24LB26*/
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /* RETURN TO CONTROLLER  @G24LB26*/
@EL00001 L     @13,4(,@13)                                         0380
@EF00001 DS    0H                                                  0380
@ER00001 LM    @14,@12,12(@13)                                     0380
         BR    @14                                                 0380
*                                                                  0381
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - SELSCREN                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - DETERMINES IF REQUEST CAN BE PROCESSED ON THE @G24LB26*/
*/*            BASIS OF DATA SET ORGANIZAITON AND SPACE      @G24LB26*/
*/*            REQUIREMENTS. SPACE MUST BE SPECIFIED ON      @G24LB26*/
*/*            PARTITIONED OR INDEXED ORGANIZATION. SPACE    @G24LB26*/
*/*            MAY NOT BE ALLOCATED IN MIXG, ALX, OR ABSTR   @G24LB26*/
*/*            UNITS.                                        @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - JFCB (JOB FILE CONTROL BLOCK)                    @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - REASON CODES AND RETURN CODE RETURNED IN RPLV   @G24LB26*/
*/*          '022F'X PARTITIONED OR INDEXED ORGANIZATION     @G24LB26*/
*/*          AND NO SPACE SPECIFIED                          @G24LB26*/
*/*          '022C'X SPACE ALLOCATED IN MIXG, ALX, OR ABSTR  @G24LB26*/
*/*          RETURN CODES                                    @G24LB26*/
*/*               0 = REQUEST OK                             @G24LB26*/
*/*               4 = REQUEST FAILED                         @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0381
*SELSCREN:                                                         0381
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0381
         B     @EL00001                                            0381
SELSCREN ST    @14,12(,@13)                                        0381
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF PARTITIONED OR INDEXED ORGANIZATION.     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0382
*   IF JFCORGIS=ONJFCORGPO=ON THEN /*                       @G24LB26*/
         L     @08,JFCBPTR(,SELTMPTR)                              0382
         TM    JFCORGIS(@08),B'10000010'                           0382
         BZ    @RF00382                                            0382
*     DO;                           /*                       @G24LB26*/
*                                                                  0383
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO DETERMINE IF SPACE WAS SPECIFIED. IF     @G24LB26*/
*       /* NO SPACE, SET FAILING REASON AND RETURN CODE.     @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0384
*       IF PQTY=ZERO&SQTY=ZERO&JFCBSPAC=NOSPACE&/*           @G24LB26*/
*           JFCBABST=ZERO THEN      /*                       @G24LB26*/
*                                                                  0384
         ICM   @06,7,PQTY(@08)                                     0384
         BNZ   @RF00384                                            0384
         ICM   @06,7,SQTY(@08)                                     0384
         BNZ   @RF00384                                            0384
         TM    JFCBSPAC(@08),B'11000000'                           0384
         BNZ   @RF00384                                            0384
         LH    @08,JFCBABST(,@08)                                  0384
         LTR   @08,@08                                             0384
         BNZ   @RF00384                                            0384
*         /***********************************************************/
*         /*                                                         */
*         /* SET REASON CODE TO HEX 22F, RETURN CODE TO 4.   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0385
*         DO;                       /*                       @G24LB26*/
*           RPLRCODE=NOSPACRC;      /*                       @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02087                        0386
*           RPLVRETC=RCFOUR;        /*                       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0387
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  0389
@RF00384 DS    0H                                                  0390
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF NECESSARY TO CHECK ON THE CORRECT UNITS  @G24LB26*/
*   /* FOR SPACE ALLOCATION.                                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0390
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/
@RF00382 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0390
         BNE   @RF00390                                            0390
*     DO;                           /*                       @G24LB26*/
*                                                                  0391
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK ON UNITS SPACE ALLOCATED IN ABSOLUTE,       @G24LB26*/
*       /* MIXG OR ALX.                                      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0392
*       IF(JFCBSPAC=ABSTRSPA&JFCBABST^=ZERO)/*              @G24LB26*/
*           JFCMIXG=ONJFCALX=ON THEN/*                      @G24LB26*/
         L     @08,JFCBPTR(,SELTMPTR)                              0392
         TM    JFCBSPAC(@08),B'11000000'                           0392
         BNZ   @GL00015                                            0392
         LH    @08,JFCBABST(,@08)                                  0392
         LTR   @08,@08                                             0392
         BNZ   @RT00392                                            0392
@GL00015 L     @08,JFCBPTR(,SELTMPTR)                              0392
         TM    JFCMIXG(@08),B'00000110'                            0392
         BZ    @RF00392                                            0392
@RT00392 DS    0H                                                  0393
*         DO;                       /*                       @G24LB26*/
*                                                                  0393
*           /*********************************************************/
*           /*                                                       */
*           /* SET REASON CODE TO 22C AND RETURN CODE TO 4.  @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0394
*           RPLRCODE=BADTYPSP;      /*                       @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02085                        0394
*           RPLVRETC=RCFOUR;        /*                       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0395
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00002 DS    0H                                                  0398
@EF00002 DS    0H                                                  0398
@ER00002 L     @14,12(,@13)                                        0398
         BR    @14                                                 0398
*   END SELSCREN;                   /*                       @G24LB26*/
         B     @EL00002                                            0399
*                                                                  0400
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - SELCTVOL                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - MAIN DRIVER ROUTINE FOR THE SELECTION         @G24LB26*/
*/*            PROCESS. HANDLES THE GROUP EXTENSION READING  @G24LB26*/
*/*            AND PASSES VOLUMES TO ROUTINES TO BUILD A     @G24LB26*/
*/*            BEST FIT TABLE, SORT THE BEST FIT TABLE       @G24LB26*/
*/*            AFTER IT IS BUILT AND FINALLY CALLS A ROUTINE @G24LB26*/
*/*            TO SELECT A SATISFACTORY VOLUME OR VOLUMES    @G24LB26*/
*/*            FOR THE REQUEST.                              @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE SELECT REQUEST BLOCK, THE GROUP RECORD,      @G24LB26*/
*/*         AND THE GROUP EXTENSION RECORDS FROM THE MSVI.   @G24LB26*/
*/*         ALSO THE STATUS OF THE VOLUME AS TO ITS MOUNT    @G24LB26*/
*/*         STATUS FOR THE ELGIBLCK ROUTINE.                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - A ZERO RETURN CODE IN THE RPLV WITH SELECTED    @G24LB26*/
*/*          VOLUMES IN THE VOLUME RETURN AREA OR A NON-     @G24LB26*/
*/*          ZERO RETURN CODE IN THE RPLV WHICH WILL FAIL    @G24LB26*/
*/*          THE REQUEST. REASON CODES RETURNED FOR FAILURES @G24LB26*/
*/*          ARE AS FOLLOWS:                                 @G24LB26*/
*/*          '0231'X - UNABLE TO READ THE EXTENSION RECORD.  @G24LB26*/
*/*          '0232'X - REQUIRED NUMBER OF VOLUMES COULD NOT  @G24LB26*/
*/*                    BE SELECTED FOR THE REQUEST.          @G24LB26*/
*/*          ISSUE MESSAGE ICB407I.                          @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0400
*SELCTVOL:                                                         0400
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0400
SELCTVOL ST    @14,@SA00003                                        0400
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR GROUP PARAMETER RETURN AREA FOR TABLE PROCESSOR @G24LB26*/
*   /* ALSO ZERO NUMBER OF VOLUMES SELECTED COUNT IN         @G24LB26*/
*   /* VOLUME RETURN AREA                                    @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   GRPPR=GRPPR&&GRPPR;             /*                       @G24LB26*/
         L     @08,SELGRPPR(,SELTMPTR)                             0401
         XC    GRPPR(12,@08),GRPPR(@08)                            0401
*   VOLNUM=ZERO;                    /*                       @G24LB26*/
*                                                                  0402
         SLR   @08,@08                                             0402
         L     @04,SELVLRET(,SELTMPTR)                             0402
         STH   @08,VOLNUM(,@04)                                    0402
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE BEST FIT TABLE INDEX TO ONE                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   INDXBFTB=ONE;                   /*                       @G24LB26*/
*                                                                  0403
         LA    INDXBFTB,1                                          0403
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LOOP SWITCH                                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0404
*   EXITSW=OFF;                     /*                       @G24LB26*/
*                                                                  0404
         NI    EXITSW,B'11101111'                                  0404
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SELECTABLE SPACE FOR THIS REQUEST TO       @ZA28479*/
*   /* ZERO BEFORE STARTING TO PROCESS VOLUMES IN GROUP      @ZA28479*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0405
*   SLGRPSPA=ZERO;                  /*                       @ZA28479*/
*                                                                  0405
         ST    @08,SLGRPSPA                                        0405
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE HEADER FIELDS IN THE BEST FIT TABLE        @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0406
*   BFGROUP=GROVVGRP;               /* SET GROUP NAME        @G24LB26*/
*                                                                  0406
         L     @04,BFTBLPTR                                        0406
         L     @01,GROUPPTR                                        0406
         MVC   BFGROUP(8,@04),GROVVGRP(@01)                        0406
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SPECIFIC UNIT REQUEST, PUT UCB ADDR IN BEST FIT    @G24LB26*/
*   /* TABLE. IF NOT, PUT DEVICE TYPE IN BEST FIT TABLE.     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   IF SELUCBAD=ZERO THEN           /*                       @G24LB26*/
         C     @08,SELUCBAD(,SELTMPTR)                             0407
         BNE   @RF00407                                            0407
*     BFDEVTP=SELDEVTP;             /*                       @G24LB26*/
         L     @08,SELDEVTP(,SELTMPTR)                             0408
         ST    @08,BFDEVTP(,@04)                                   0408
*   ELSE                            /*                       @G24LB26*/
*     BFDEVTP=SELUCBAD;             /*                       @G24LB26*/
         B     @RC00407                                            0409
@RF00407 L     @08,SELUCBAD(,SELTMPTR)                             0409
         L     @04,BFTBLPTR                                        0409
         ST    @08,BFDEVTP(,@04)                                   0409
*   BFJOBID=SELJOBID;               /* INITIALIZE JOB        @G24LB26
*                                      IDENTIFIER            @G24LB26*/
*                                                                  0410
@RC00407 L     @08,SELJOBID(,SELTMPTR)                             0410
         L     @04,BFTBLPTR                                        0410
         ST    @08,BFJOBID(,@04)                                   0410
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE GROUP EXTENSION KEY VALUES                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   GBLKKY=BLANK;                   /*                       @G24LB26*/
         MVI   GBLKKY,C' '                                         0411
*   GVSNO=ZERO;                     /*                       @G24LB26*/
         L     @08,GVSNEPTR                                        0412
         MVI   GVSNO(@08),X'00'                                    0412
*   GROUPKY=GROVVGRP;               /*                       @G24LB26*/
*                                                                  0413
         L     @08,GROUPPTR                                        0413
         MVC   GROUPKY(8),GROVVGRP(@08)                            0413
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP RPLV TO READ GROUP EXTENSION RECORD            @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @G24LB26*/
         LA    @08,GKEY                                            0414
         ST    @08,RPLVKEY(,RPLVPTR)                               0414
*   RPLVBUF=ADDR(STORGPEX);         /* ADDR RETURN BUFFER    @G24LB26*/
         LA    @08,STORGPEX                                        0415
         ST    @08,RPLVBUF(,RPLVPTR)                               0415
*   RPLVBLN=LENGTH(STORGPEX);       /* LENGTH OF RECORD BUF  @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         0416
*   RPLVDIR=ON;                     /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0417
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0418
*   RPLVKGE=ON;                     /* KEY GREATER THAN OR = @G24LB26*/
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0419
*   RPLVUPD=ON;                     /* FOR UPDATE            @ZA28479*/
*                                                                  0420
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0420
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP OUTSIDE DO LOOP TO READ EACH EXTENSION RECORD  @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0421
*   DO WHILE EXITSW=OFF;            /* LOOP THROUGH EXTENSION      0421
*                                                            @G24LB26*/
*                                                                  0421
         B     @DE00421                                            0421
@DL00421 DS    0H                                                  0422
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP INDEX TO READ NEXT RECORD                    @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0422
*     GIDKY=GVSNO;                  /*                       @G24LB26*/
         L     @08,GVSNEPTR                                        0422
         SLR   @04,@04                                             0422
         IC    @04,GVSNO(,@08)                                     0422
         STC   @04,GIDKY                                           0422
*     GIDKY=GIDKY+ONE;              /*                       @G24LB26*/
*                                                                  0423
         LA    @04,1(,@04)                                         0423
         STC   @04,GIDKY                                           0423
*     /***************************************************************/
*     /*                                                             */
*     /* CALL THE I/O PROCESSOR TO READ THE GROUP            @G24LB26*/
*     /* EXTENSION RECORD                                    @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0424
*     RESPECIFY                                                    0424
*       REG1 RSTD;                  /*                       @G24LB26*/
*     REG1=RPLVPTR;                 /*                       @G24LB26*/
         LR    REG1,RPLVPTR                                        0425
*     CALL ICBVIO00;                /*                       @G24LB26*/
         L     @15,@CV01910                                        0426
         BALR  @14,@15                                             0426
*     RESPECIFY                                                    0427
*       REG1 UNRSTD;                /*                       @G24LB26*/
*                                                                  0427
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF PROPER GROUP EXTENSION RECORD RETURNED @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0428
*     IF RPLVRETC^=RCZEROGVSVVGRP^=GROVVGRP THEN/*          @G24LB26*/
*                                                                  0428
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0428
         BNE   @RT00428                                            0428
         L     @08,GVSNEPTR                                        0428
         L     @04,GROUPPTR                                        0428
         CLC   GVSVVGRP(8,@08),GROVVGRP(@04)                       0428
         BE    @RF00428                                            0428
@RT00428 DS    0H                                                  0429
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE EXTENSION RECORD COULD NOT BE LOCATED,     @G24LB26*/
*       /* ISSUE ERROR MESSAGE AND FAIL REQUEST              @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0429
*       DO;                         /*                       @G24LB26*/
*                                                                  0429
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE ERROR MESSAGE ICB415I AND EXIT ROUTINE    @G24LB26*/
*         /* WITH NON-ZERO REASON AND RETURN CODES           @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0430
*         MSGRQ=MSGRQ&&MSGRQ;       /* ZERO MSG REQUEST BLK  @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0430
*         MSGRPLV=RPLVPTR;          /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0431
*         MSGID=MSG415;             /* MESSAGE ICB415I ID    @G24LB26*/
         MVC   MSGID(4),@CF02065                                   0432
*         MSGLEN1=EIGHT;            /* LENGTH OF GROUP NAME  @G24LB26*/
         MVI   MSGLEN1,X'08'                                       0433
*         MSGTEXT1=ADDR(GROVVGRP);  /* GROUP NAME            @G24LB26*/
         L     @08,GROUPPTR                                        0434
         LA    @08,GROVVGRP(,@08)                                  0434
         STCM  @08,7,MSGTEXT1                                      0434
*         RESPECIFY                                                0435
*           REG1 RSTD;              /*                       @G24LB26*/
*         REG1=ADDR(MSGRQ);         /* ADDR MESSAGE PARM     @G24LB26*/
         LA    REG1,MSGRQ                                          0436
*         CALL ICBVOP00;            /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0437
         BALR  @14,@15                                             0437
*         RESPECIFY                                                0438
*           REG1 UNRSTD;            /*                       @G24LB26*/
*         RPLVRETC=RCFOUR;          /*                       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0439
*         RPLRCODE=NOGRPFND;        /* SET REASON CODE TO    @G24LB26
*                                      HEX 231               @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02089                        0440
*         EXITSW=ON;                /* INDICATE NO MORE      @G24LB26
*                                      PROCESSING TO BE DONE @G24LB26*/
         OI    EXITSW,B'00010000'                                  0441
*       END;                        /*                       @G24LB26*/
*                                                                  0442
*     /***************************************************************/
*     /*                                                             */
*     /* IF NO PROBLEM READING EXTENSION RECORD, CONTINUE    @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0443
*     ELSE                          /*                       @G24LB26*/
*                                                                  0443
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THRU SLOTS IN EXTENSION RECORD               @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0443
*       DO INDXEXTS=ONE TO GVSESIND-ONE;/*                   @G24LB26*/
*                                                                  0443
         B     @RC00428                                            0443
@RF00428 LA    INDXEXTS,1                                          0443
         B     @DE00443                                            0443
@DL00443 DS    0H                                                  0444
*         /***********************************************************/
*         /*                                                         */
*         /* CALL ROUTINE TO DETERMINE IF VOLUME IS          @G24LB26*/
*         /* ELIGIBLE FOR SELECTION FOR THIS REQUEST         @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0444
*         CALL ELGIBLCK;            /*                       @G24LB26*/
*                                                                  0444
         BAL   @14,ELGIBLCK                                        0444
*         /***********************************************************/
*         /*                                                         */
*         /* IF VOLUME IS ELIGIBLE, MAKE REMAINING CHECKS,   @G24LB26*/
*         /* IF VOLUME WAS NOT ELIGIBLE, GET NEXT VOLUME     @G24LB26*/
*         /* IN EXTENSION IF ANY, OR FALL THRU TO END        @G24LB26*/
*         /* OF INSIDE LOOP AND GET NEXT VOLUME IN NEW       @G24LB26*/
*         /* EXTENSION RECORD UNLESS CURRENT EXTENSION       @G24LB26*/
*         /* WAS THE LAST EXTENSION RECORD                   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0445
*         IF INTERCC=RCZERO THEN    /*                       @G24LB26*/
         CLC   INTERCC(2),@CB02111                                 0445
         BNE   @RF00445                                            0445
*           DO;                     /*                       @G24LB26*/
*                                                                  0446
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK MOUNT FLAGS SET BY ELGIBLCK AND       @G24LB26*/
*             /* IF VOLUME IS MOUNTED TO ANOTHER HOST        @G24LB26*/
*             /* AND THE DEVICE TYPE IS OTHER THAN 3330V,    @G24LB26*/
*             /* THE VOLUME IS A HIGH RISK VOLUME.           @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0447
*             IF BFMTDOHF(INDXBFTB)=ON&/*                    @G24LB26*/
*                 SELDEVTP^=DEV3330V THEN/*                  @G24LB26*/
         L     @04,BFTBLPTR                                        0447
         LR    @15,INDXBFTB                                        0447
         MH    @15,@CH02240                                        0447
         ST    @15,@TF00001                                        0447
         ALR   @15,@04                                             0447
         TM    BFMTDOHF-18(@15),B'00100000'                        0447
         BNO   @RF00447                                            0447
         CLC   SELDEVTP(4,SELTMPTR),DEV3330V                       0447
         BE    @RF00447                                            0447
*               BFHRSKFL(INDXBFTB)=ON;/*                     @G24LB26*/
*                                                                  0448
         AL    @04,@TF00001                                        0448
         OI    BFHRSKFL-18(@04),B'10000000'                        0448
*             /*******************************************************/
*             /*                                                     */
*             /* CALL ROUTINE TO DETERMINE IF VOLUME         @G24LB26*/
*             /* WOULD CAUSE THE STEP TO WAIT IF IT WERE     @G24LB26*/
*             /* SELECTED FOR THE REQUEST ONLY IF IT IS      @G24LB26*/
*             /* CURRENTLY MOUNTED TO THIS HOST.             @G24LB26*/
*             /* CALL ROUTINE TO GET THE NUMBER OF           @G24LB26*/
*             /* CONCURRENT USERS THIS VOLUME HAS            @G24LB26*/
*             /* AT PRESENT TIME ONLY IF VOLUME IS           @G24LB26*/
*             /* MOUNTED TO THIS HOST                        @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0449
*             IF BFNOTMTD(INDXBFTB)=OFF&/*                   @G24LB26*/
*                 BFMTDOHF(INDXBFTB)=OFF THEN/*              @G24LB26*/
@RF00447 L     @04,BFTBLPTR                                        0449
         LR    @15,INDXBFTB                                        0449
         MH    @15,@CH02240                                        0449
         ST    @15,@TF00001                                        0449
         ALR   @15,@04                                             0449
         TM    BFNOTMTD-18(@15),B'10000000'                        0449
         BNZ   @RF00449                                            0449
         AL    @04,@TF00001                                        0449
         TM    BFMTDOHF-18(@04),B'00100000'                        0449
         BNZ   @RF00449                                            0449
*               DO;                 /*                       @G24LB26*/
*                 CALL WAITCK;      /*                       @G24LB26*/
         BAL   @14,WAITCK                                          0451
*                 CALL CONUSER;     /*                       @G24LB26*/
         BAL   @14,CONUSER                                         0452
*               END;                /*                       @G24LB26*/
*                                                                  0453
*             /*******************************************************/
*             /*                                                     */
*             /* SET BEST FIT TABLE POINTER TO NEXT SLOT     @G24LB26*/
*             /* SINCE AN ENTRY WAS MADE IN BEST FIT TABLE.  @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0454
*             INDXBFTB=INDXBFTB+ONE;/*                       @G24LB26*/
@RF00449 LA    INDXBFTB,1(,INDXBFTB)                               0454
*           END;                    /*                       @G24LB26*/
*       END;                        /* END OF SLOT LOOP      @G24LB26*/
*                                                                  0456
@RF00445 LA    INDXEXTS,1(,INDXEXTS)                               0456
@DE00443 L     @04,GVSNEPTR                                        0456
         LH    @04,GVSESIND(,@04)                                  0456
         BCTR  @04,0                                               0456
         CR    INDXEXTS,@04                                        0456
         BNH   @DL00443                                            0456
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF ANOTHER EXTENSION RECORD IS TO BE      @G24LB26*/
*     /* READ IF AN ERROR HAS NOT ALREADY OCCURRED.          @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0457
*     IF EXITSW=OFF&GVSEX=OFF THEN  /*                       @G24LB26*/
@RC00428 TM    EXITSW,B'00010000'                                  0457
         BNZ   @RF00457                                            0457
         L     @08,GVSNEPTR                                        0457
         TM    GVSEX(@08),B'10000000'                              0457
         BNZ   @RF00457                                            0457
*       EXITSW=ON;                  /*                       @G24LB26*/
*                                                                  0458
         OI    EXITSW,B'00010000'                                  0458
*     /***************************************************************/
*     /*                                                             */
*     /* WRITE THE EXTENSION RECORD IF IT HAD ITS            @ZA28479*/
*     /* SPACE FIELDS UPDATED                                @ZA28479*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0459
*     IF UPDTGVSN=ON THEN           /*                       @ZA28479*/
@RF00457 TM    UPDTGVSN,B'10000000'                                0459
         BNO   @RF00459                                            0459
*       DO;                         /*                       @ZA28479*/
*         RPLVTYP=RPLVPUT;          /* WRITE EXT RECORD      @ZA28479*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0461
*         RESPECIFY                                                0462
*           REG1 RSTD;              /*                       @ZA28479*/
*         REG1=RPLVPTR;             /* ADDR OF RPLV          @ZA28479*/
         LR    REG1,RPLVPTR                                        0463
*         CALL ICBVIO00;            /* WRITE EXT RECORD      @ZA28479*/
         L     @15,@CV01910                                        0464
         BALR  @14,@15                                             0464
*         RESPECIFY                                                0465
*           REG1 UNRSTD;            /*                       @ZA28479*/
*         RPLVRETC=RCZERO;          /* CLEAR SO PROCESS CONT @ZA28479*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0466
*         RPLRCODE=RCZERO;          /* CLEAR                 @ZA28479*/
*                                                                  0467
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0467
*         /***********************************************************/
*         /*                                                         */
*         /* SET FLAG INDICATING THAT EXTENSION RECORD       @ZA28479*/
*         /* WAS WRITTEN TO THE INVENTORY DATA SET           @ZA28479*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0468
*         UPDTGVSN=OFF;             /*                       @ZA28479*/
*                                                                  0468
         NI    UPDTGVSN,B'01111111'                                0468
*         /***********************************************************/
*         /*                                                         */
*         /* RESET VSAM SECTION OF RPLV SO THAT THE          @ZA28479*/
*         /* READ LOOP WILL CONTINUE TO FUNCTION             @ZA28479*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0469
*         RPLVTYP=RPLVREAD;         /*                       @ZA28479*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0469
*       END;                        /*                       @ZA28479*/
*   END;                            /* END OUTSIDE LOOP      @G24LB26*/
*                                                                  0471
@RF00459 DS    0H                                                  0471
@DE00421 TM    EXITSW,B'00010000'                                  0471
         BZ    @DL00421                                            0471
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF REQUEST FAILED YET                       @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0472
         BNE   @RF00472                                            0472
*     DO;                           /*                       @G24LB26*/
*                                                                  0473
*       /*************************************************************/
*       /*                                                           */
*       /* SET INDEX COUNTER IN BEST FIT TABLE TO NUMBER     @G24LB26*/
*       /* OF ELEMENTS IN BEST FIT TABLE.                    @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0474
*       IF INDXBFTB>ONE THEN        /*                       @G24LB26*/
         C     INDXBFTB,@CF00043                                   0474
         BNH   @RF00474                                            0474
*         BFTOTIDX=INDXBFTB-ONE;    /*                       @G24LB26*/
         LR    @08,INDXBFTB                                        0475
         BCTR  @08,0                                               0475
         L     @04,BFTBLPTR                                        0475
         STH   @08,BFTOTIDX(,@04)                                  0475
*       ELSE                        /*                       @G24LB26*/
*         BFTOTIDX=ZERO;            /*                       @G24LB26*/
*                                                                  0476
         B     @RC00474                                            0476
@RF00474 L     @08,BFTBLPTR                                        0476
         SLR   @06,@06                                             0476
         STH   @06,BFTOTIDX(,@08)                                  0476
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THERE IS ENOUGH USABLE SPACE FOR     @ZA28479*/
*       /* THIS REQUEST TO MEET THE THRESHOLD PERCENTAGE     @ZA28479*/
*       /* IF THERE IS NOT, ISSUE MESSAGE ICB441I            @ZA28479*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0477
*       IF GROPCENT^=ZERO&SLGRPSPA<GROSTRSH THEN/*           @ZA28479*/
@RC00474 L     @08,GROUPPTR                                        0477
         CLI   GROPCENT(@08),0                                     0477
         BE    @RF00477                                            0477
         L     @06,SLGRPSPA                                        0477
         C     @06,GROSTRSH(,@08)                                  0477
         BNL   @RF00477                                            0477
*         DO;                       /*                       @ZA28479*/
*           IF GROERRDT^=CVTDATE&GROMSG1=OFF THEN/*          @ZA28479*/
         L     @06,CVTPTR                                          0479
         CLC   GROERRDT(4,@08),CVTDATE(@06)                        0479
         BE    @RF00479                                            0479
         TM    GROMSG1(@08),B'00000010'                            0479
         BNZ   @RF00479                                            0479
*             DO;                   /*                       @ZA28479*/
*               GROMSG1=ON;         /* INDICATE MESSAGE SENT @ZA28479*/
         OI    GROMSG1(@08),B'00000010'                            0481
*               GROERRDT=CVTDATE;   /* ENTER TODAYS DATA     @ZA28479*/
         MVC   GROERRDT(4,@08),CVTDATE(@06)                        0482
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR MSG REQ PARMS   @ZA28479*/
         XC    MSGRQ(32),MSGRQ                                     0483
*               MSGRPLV=RPLVPTR;    /* ADDR OF REQUEST PARM  @ZA28479*/
         ST    RPLVPTR,MSGRPLV                                     0484
*               MSGID=MSG441;       /* MESSAGE NUMBER        @ZA28479*/
         MVC   MSGID(4),@CF02067                                   0485
*               MSGLEN1=EIGHT;      /* LENGTH INSERT         @ZA28479*/
         MVI   MSGLEN1,X'08'                                       0486
*               MSGTEXT1=ADDR(GROVVGRP);/* ADDR GRP NAME     @ZA28479*/
         LA    @08,GROVVGRP(,@08)                                  0487
         STCM  @08,7,MSGTEXT1                                      0487
*               RESPECIFY                                          0488
*                 REG1 RSTD;        /*                       @ZA28479*/
*               REG1=ADDR(MSGRQ);   /* ADDR MESSAGE PARM     @ZA28479*/
         LA    REG1,MSGRQ                                          0489
*               CALL ICBVOP00;      /* CALL MESSAGE MODULE   @ZA28479*/
*                                                                  0490
         L     @15,@CV01912                                        0490
         BALR  @14,@15                                             0490
*               /*****************************************************/
*               /*                                                   */
*               /* READ GROUP RECORD FOR UPDATE TO PRIME     @ZA28479*/
*               /* THE VSAM INTERNAL FIELDS IN PREPARATION   @ZA28479*/
*               /* FOR A WRITE.                              @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0491
*               GKEY=GRONAME;       /* ENSURE KEY SET OK     @ZA28479*/
         L     @08,GROUPPTR                                        0491
         MVC   GKEY(13),GRONAME(@08)                               0491
*               RPLVKEY=ADDR(GKEY); /* ADDR OF KEY           @ZA28479*/
         LA    @08,GKEY                                            0492
         ST    @08,RPLVKEY(,RPLVPTR)                               0492
*               RPLVBUF=ADDR(DUMMYBUF);/* ADDR DUMMY BUF     @ZA28479*/
         LA    @08,DUMMYBUF                                        0493
         ST    @08,RPLVBUF(,RPLVPTR)                               0493
*               RPLVBLN=LENGTH(STORGRP);/* LEN GROUP REC     @ZA28479*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02237                         0494
*               RPLVDIR=ON;         /* READ DIRECT           @ZA28479*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0495
*               RPLVTYP=RPLVREAD;   /* READ RECORD           @ZA28479*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0496
*               RPLVUPD=ON;         /* READ FOR UPDATE       @ZA28479*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0497
*               REG1=RPLVPTR;       /* ADDR RPLV IN REG1     @ZA28479*/
         LR    REG1,RPLVPTR                                        0498
*               CALL ICBVIO00;      /* READ GROUP RECORD     @ZA28479*/
*                                                                  0499
         L     @15,@CV01910                                        0499
         BALR  @14,@15                                             0499
*               /*****************************************************/
*               /*                                                   */
*               /* WRITE OUT GROUP RECORD NOW IN GROUP       @ZA28479*/
*               /* RECORD BUFFER                             @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0500
*               RPLVBUF=ADDR(STORGRP);/* ADDR UPDTD GRP REC  @ZA28479*/
         LA    @08,STORGRP                                         0500
         ST    @08,RPLVBUF(,RPLVPTR)                               0500
*               RPLVTYP=RPLVPUT;    /* PUT RECORD            @ZA28479*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              0501
*               REG1=RPLVPTR;       /* ADDR RPLV             @ZA28479*/
         LR    REG1,RPLVPTR                                        0502
*               CALL ICBVIO00;      /* WRITE UPDTED GRP REC  @ZA28479*/
         L     @15,@CV01910                                        0503
         BALR  @14,@15                                             0503
*               RESPECIFY                                          0504
*                 REG1 UNRSTD;      /*                       @ZA28479*/
*                                                                  0504
*               /*****************************************************/
*               /*                                                   */
*               /* SINCE NO LOGICAL ACTION WILL BE TAKEN     @ZA28479*/
*               /* IF A BAD REASON CODE RESULTS, CLEAR       @ZA28479*/
*               /* REASON AND RETURN CODES IN RPLV           @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0505
*               RPLVRETC=RCZERO;    /*                       @ZA28479*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0505
*               RPLRCODE=RCZERO;    /*                       @ZA28479*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0506
*             END;                  /*                       @ZA28479*/
*         END;                      /*                       @ZA28479*/
*                                                                  0508
@RF00479 DS    0H                                                  0509
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF THERE ARE ENOUGH VOLUMES IN THE BEST @G24LB26*/
*       /* FIT TABLE TO POSSIBLY SATISFY THIS REQUEST. IF    @G24LB26*/
*       /* NOT, ISSUE MESSAGE AND FAIL THE REQUEST NOW.      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0509
*       IF NUMBVOL>BFTOTIDX THEN    /*                       @G24LB26*/
@RF00477 SLR   @08,@08                                             0509
         IC    @08,NUMBVOL                                         0509
         L     @06,BFTBLPTR                                        0509
         CH    @08,BFTOTIDX(,@06)                                  0509
         BNH   @RF00509                                            0509
*         DO;                       /*                       @G24LB26*/
*                                                                  0510
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE MESSAGE ICB407I AND FAIL REQUEST WITH   @G24LB26*/
*           /* HEX 232 REASON CODE.                          @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0511
*           MSGRQ=MSGRQ&&MSGRQ;     /* ZERO MSG REQUEST BLK  @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0511
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0512
*           MSGID=MSG407;           /* MESSAGE ID FOR ICB407I      0513
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02061                                   0513
*           MSGLEN1=EIGHT;          /* LENGTH OF INSERT      @G24LB26*/
         MVI   MSGLEN1,X'08'                                       0514
*           MSGTEXT1=ADDR(GROVVGRP);/* GROUP NAME            @G24LB26*/
         L     @08,GROUPPTR                                        0515
         LA    @08,GROVVGRP(,@08)                                  0515
         STCM  @08,7,MSGTEXT1                                      0515
*           RESPECIFY                                              0516
*             REG1 RSTD;            /*                       @G24LB26*/
*           REG1=ADDR(MSGRQ);       /* ADDR PRINT PARM       @G24LB26*/
         LA    REG1,MSGRQ                                          0517
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0518
         BALR  @14,@15                                             0518
*           RESPECIFY                                              0519
*             REG1 UNRSTD;          /*                       @G24LB26*/
*           RPLRCODE=SELFAIL;       /* REASON CODE HEX 232   @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0520
*           RPLVRETC=RCFOUR;        /* RETURN CODE           @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0521
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  0523
@RF00509 DS    0H                                                  0524
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUEST HAS NOT ALREADY FAILED, THEN SET UP        @G24LB26*/
*   /* PARAMETER LIST TO CALL TABLE PROCESSOR TO UPDATE      @G24LB26*/
*   /* CONCURRENT USERS, WAIT STATUS, SHAREABILITY AND       @G24LB26*/
*   /* MOUNT STATUS OF VOLUMES IN BEST FIT TABLE.            @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0524
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/
@RF00472 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0524
         BNE   @RF00524                                            0524
*     DO;                           /*                       @G24LB26*/
*       TABP=TABP&&TABP;            /* CLEAR TABLE PROCESSOR @G24LB26
*                                      PARM                  @G24LB26*/
         LA    @08,STRTABP                                         0526
         XC    TABP(12,@08),TABP(@08)                              0526
*       TABFBFIT=ON;                /* INDICATE UPDATE       @G24LB26
*                                      BEST FIT TABLE        @G24LB26*/
         OI    TABFBFIT(@08),B'00100000'                           0527
*       TABSELRB=ADDR(RPLVUTIL);    /* ADDR OF REQUEST BLOCK @G24LB26*/
         LA    @06,RPLVUTIL(,RPLVPTR)                              0528
         ST    @06,TABSELRB(,@08)                                  0528
*       TABBFTBL=BFTBLPTR;          /* ADDR OF BEST FIT TABLE      0529
*                                                            @G24LB26*/
         L     @06,BFTBLPTR                                        0529
         ST    @06,TABBFTBL(,@08)                                  0529
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/
*                                                                  0530
         ST    @08,@AL00001                                        0530
         L     @15,@CV01914                                        0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THRU BEST FIT TABLE AND UPDATE THE           @G24LB26*/
*       /* CONCURRENT USER FIELD FOR VOLUMES THAT ARE OVER   @G24LB26*/
*       /* THE MAXIMUM CONCURRENT USERS.                     @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0531
*       DO INDXBFTB=ONE TO BFTOTIDX;/* LOOP THRU TABLE       @G24LB26*/
*                                                                  0531
         LA    INDXBFTB,1                                          0531
         B     @DE00531                                            0531
@DL00531 DS    0H                                                  0532
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE IF CONCURRENT USERS IS OVER MAXIMUM   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0532
*         IF BFCONUSE(INDXBFTB)>=GROCONUS THEN/*             @G24LB26*/
*                                                                  0532
         L     @08,BFTBLPTR                                        0532
         LR    @04,INDXBFTB                                        0532
         MH    @04,@CH02240                                        0532
         SLR   @15,@15                                             0532
         IC    @15,BFCONUSE-18(@04,@08)                            0532
         L     @14,GROUPPTR                                        0532
         SLR   @03,@03                                             0532
         IC    @03,GROCONUS(,@14)                                  0532
         CR    @15,@03                                             0532
         BL    @RF00532                                            0532
*           /*********************************************************/
*           /*                                                       */
*           /* SET OVER MAXIMUM FIELD TO NUMBER OF           @G24LB26*/
*           /* CONCURRENT USERS                              @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0533
*           BFOVERUS(INDXBFTB)=BFCONUSE(INDXBFTB);/*         @G24LB26*/
         STC   @15,BFOVERUS-18(@04,@08)                            0533
*       END;                        /*                       @G24LB26*/
*                                                                  0534
@RF00532 AL    INDXBFTB,@CF00043                                   0534
@DE00531 L     @08,BFTBLPTR                                        0534
         CH    INDXBFTB,BFTOTIDX(,@08)                             0534
         BNH   @DL00531                                            0534
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO USE BEST FIT TABLE TO MAKE        @G24LB26*/
*       /* FINAL VOLUME SELECTIONS FOR THIS REQUEST.         @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0535
*       CALL FINSELCT;              /*                       @G24LB26*/
         BAL   @14,FINSELCT                                        0535
*     END;                          /*                       @G24LB26*/
*                                                                  0536
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF FINSELCT ROUTINE HAD A PROBLEM        @G24LB26*/
*   /* OR ANY PREVIOUS PROBLEMS EXIST, AND IF THERE          @G24LB26*/
*   /* ARE NOT ANY, CALL ROUTINE TO UPDATE THE MSVI RECORDS. @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/
@RF00524 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0537
         BNE   @RF00537                                            0537
*     DO;                           /*                       @G24LB26*/
*       CALL UPDTMSVI;              /*                       @G24LB26*/
*                                                                  0539
         BAL   @14,UPDTMSVI                                        0539
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARAMETER LIST TO CALL THE TABLE PROCESSOR @G24LB26*/
*       /* TO TABLE THE VOLUME SELECTIONS MADE FOR THIS      @G24LB26*/
*       /* REQUEST.                                          @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0540
*       GRPNAME=BFGROUP;            /* GROUP SELECTING FROM  @G24LB26*/
         L     @08,SELGRPPR(,SELTMPTR)                             0540
         L     @06,BFTBLPTR                                        0540
         MVC   GRPNAME(8,@08),BFGROUP(@06)                         0540
*       GRPEXTIN=BFGRPIDX(PRIBFIDX);/* EXTENSION RECORD      @G24LB26
*                                      INDEX                 @G24LB26*/
         SLR   @04,@04                                             0541
         IC    @04,PRIBFIDX                                        0541
         MH    @04,@CH02240                                        0541
         SLR   @15,@15                                             0541
         IC    @15,BFGRPIDX-18(@04,@06)                            0541
         STC   @15,GRPEXTIN(,@08)                                  0541
*       GRPSLOTN=BFGRPSLT(PRIBFIDX);/* SLOT INDEX            @G24LB26*/
         SLR   @15,@15                                             0542
         IC    @15,BFGRPSLT-18(@04,@06)                            0542
         STC   @15,GRPSLOTN(,@08)                                  0542
*       GRPPRMSP=PRICYL;            /* PRIMARY SPACE IN CYL  @G24LB26*/
         LH    @06,PRICYL                                          0543
         STH   @06,GRPPRMSP(,@08)                                  0543
*       TABP=TABP&&TABP;            /* CLEAR TABLE PARM      @G24LB26*/
         LA    @08,STRTABP                                         0544
         XC    TABP(12,@08),TABP(@08)                              0544
*       TABFBLDE=ON;                /* INDICATE BUILDING     @G24LB26
*                                      DD ENTRY              @G24LB26*/
         OI    TABFBLDE(@08),B'10000000'                           0545
*       TABSELRB=ADDR(RPLVUTIL);    /* ADDR SELECT RPL       @G24LB26*/
         LA    @04,RPLVUTIL(,RPLVPTR)                              0546
         ST    @04,TABSELRB(,@08)                                  0546
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/
         ST    @08,@AL00001                                        0547
         L     @15,@CV01914                                        0547
         LA    @01,@AL00001                                        0547
         BALR  @14,@15                                             0547
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00003 DS    0H                                                  0549
@EF00003 DS    0H                                                  0549
@ER00003 L     @14,@SA00003                                        0549
         BR    @14                                                 0549
*   END SELCTVOL;                   /*                       @G24LB26*/
         B     @EL00003                                            0550
*                                                                  0551
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - VOLREF                                  @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - HANDLES VOL=REF REQUESTS BY UPDATING SPACE IN @G24LB26*/
*/*            THE EXTENSION RECORD FOR THE PRIMARY VOLUME.  @G24LB26*/
*/*            IF THE SPACE WAS SUCCESSFULLY UPDATED IN THE  @G24LB26*/
*/*            EXTENSION RECORD, THEN THAT SPACE IS TABLED   @G24LB26*/
*/*            BY THE TABLE PROCESSOR, OTHERWISE ZERO        @G24LB26*/
*/*            CYLINDERS ARE TABLED ON THE CALL TO THE STEP  @G24LB26*/
*/*            TABLE PROCESSOR.                              @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - ADDRESSABILITY SET UP TO JFCB, BASE              @G24LB26*/
*/*         VOLUME RECORD, GROUP EXTENSION RECORD.           @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - UPDATED FREE SPACE FOR VOLUME IN THE GROUP      @G24LB26*/
*/*          EXTENSION RECORD, TABLED DD ENTRY IN STEP       @G24LB26*/
*/*          TABLE RESULTING FROM CALL TO TABLE PROCESSOR.   @G24LB26*/
*/*          ZERO REASON AND RETURN CODES IN THE RPLV.       @G24LB26*/
*/*          ISSUES MESSAGES ICB402I AND ICB445I.            @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0551
*VOLREF:                                                           0551
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0551
VOLREF   ST    @14,@SA00004                                        0551
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR GROUP RETURN AREA FOR TABLE PROCESSOR           @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0552
*   GRPPR=GRPPR&&GRPPR;             /*                       @G24LB26*/
*                                                                  0552
         L     @08,SELGRPPR(,SELTMPTR)                             0552
         XC    GRPPR(12,@08),GRPPR(@08)                            0552
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE VOLID OF THE PRIMARY VOLUME FROM THE JFCB     @G24LB26*/
*   /* AND READ THE BASE VOLUME RECORD.                      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   VOLKY=JFCAVOLS(ONE);            /* VOLUME SERIAL         @G24LB26*/
         L     @08,JFCBPTR(,SELTMPTR)                              0553
         MVC   VOLKY(6),JFCAVOLS(@08)                              0553
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           @G24LB26*/
         LA    @08,VKEY                                            0554
         ST    @08,RPLVKEY(,RPLVPTR)                               0554
*   RPLVBUF=ADDR(STORBASE);         /* ADDR OF BUFFER        @G24LB26*/
         LA    @08,STORBASE                                        0555
         ST    @08,RPLVBUF(,RPLVPTR)                               0555
*   RPLVBLN=LENGTH(STORBASE);       /* LENGTH OF BUFFER      @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02241                         0556
*   RPLVDIR=ON;                     /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0557
*   RPLVTYP=RPLVREAD;               /* READ REQUEST          @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0558
*   RESPECIFY                                                      0559
*     REG1 RSTD;                    /*                       @G24LB26*/
*   REG1=RPLVPTR;                   /* ADDR RPLV             @G24LB26*/
         LR    REG1,RPLVPTR                                        0560
*   CALL ICBVIO00;                  /* READ BASE RECORD      @G24LB26*/
         L     @15,@CV01910                                        0561
         BALR  @14,@15                                             0561
*   RESPECIFY                                                      0562
*     REG1 UNRSTD;                  /*                       @G24LB26*/
*                                                                  0562
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK RETURN CODE                                     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*   IF RPLVRETC^=RCZERO THEN        /*                       @G24LB26*/
*                                                                  0563
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0563
         BE    @RF00563                                            0563
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE ERROR MESSAGE AND SET REASON AND RETURN CODE. @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0564
*     DO;                           /*                       @G24LB26*/
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MSG PARM LIST   @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0565
*       MSGRPLV=RPLVPTR;            /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0566
*       MSGID=MSG402;               /* MSG ID FOR ICB402I    @G24LB26*/
         MVC   MSGID(4),@CF02059                                   0567
*       MSGLEN1=SIX;                /* LENGTH OF INSERT      @G24LB26*/
         MVI   MSGLEN1,X'06'                                       0568
*       MSGTEXT1=ADDR(VOLKY);       /* VOLUME NAME IN MSG    @G24LB26*/
         LA    @08,VOLKY                                           0569
         STCM  @08,7,MSGTEXT1                                      0569
*       RESPECIFY                                                  0570
*         REG1 RSTD;                /*                       @G24LB26*/
*       REG1=ADDR(MSGRQ);           /* ADDR OF MSG PARM LIST @G24LB26*/
         LA    REG1,MSGRQ                                          0571
*       CALL ICBVOP00;              /*                       @G24LB26*/
         L     @15,@CV01912                                        0572
         BALR  @14,@15                                             0572
*       RESPECIFY                                                  0573
*         REG1 UNRSTD;              /*                       @G24LB26*/
*       RPLRCODE=RCZERO;            /* SET ZERO REASON CODE  @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0574
*       RPLVRETC=RCZERO;            /* SET ZERO RETURN CODE  @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0575
*     END;                          /*                       @G24LB26*/
*                                                                  0576
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE BASE VOLUME RECORD WAS READ, CHECK THAT IT IS  @G24LB26*/
*   /* GROUPED OTHER THAN SYSGROUP AND IS GENERAL-USE,       @G24LB26*/
*   /* THEN READ FOR CORRECT SLOT IN EXTENSION RECORD.       @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   ELSE                            /*                       @G24LB26*/
*     IF BASGRPV=ON&BASGENUS=ON&BASGROUP^=SYSGROUP THEN/*    @G24LB26*/
         B     @RC00563                                            0577
@RF00563 L     @08,BASEVPTR                                        0577
         TM    BASGRPV(@08),B'00110000'                            0577
         BNO   @RF00577                                            0577
         CLC   BASGROUP(8,@08),SYSGROUP                            0577
         BE    @RF00577                                            0577
*       DO;                         /*                       @G24LB26*/
*         ERRORSW=OFF;              /*                       @G24LB26*/
*         EXITSW=OFF;               /*                       @G24LB26*/
         NI    ERRORSW,B'11100111'                                 0580
*         GBLKKY=BLANK;             /* BLANK OUT FILL        @G24LB26
*                                      PORTION OF KEY        @G24LB26*/
         MVI   GBLKKY,C' '                                         0581
*         GIDKY=ONE;                /* SET ID TO GET FIRST   @G24LB26
*                                      EXTENSION             @G24LB26*/
         MVI   GIDKY,X'01'                                         0582
*         GROUPKY=BASGROUP;         /* GRP FROM BASE RECORD  @G24LB26*/
         MVC   GROUPKY(8),BASGROUP(@08)                            0583
*         RPLVKEY=ADDR(GKEY);       /* ADDR OF KEY           @G24LB26*/
         LA    @08,GKEY                                            0584
         ST    @08,RPLVKEY(,RPLVPTR)                               0584
*         RPLVBUF=ADDR(STORGPEX);   /* ADDR OF BUFFER        @G24LB26*/
         LA    @08,STORGPEX                                        0585
         ST    @08,RPLVBUF(,RPLVPTR)                               0585
*         RPLVBLN=LENGTH(STORGPEX); /* LENGTH OF BUFFER      @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         0586
*         RPLVDIR=ON;               /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0587
*         RPLVTYP=RPLVREAD;         /* READ RECORD           @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              0588
*         RPLVKGE=ON;               /* READ > OR =           @G24LB26*/
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0589
*         RPLVUPD=ON;               /* READ FOR UPDATE       @G24LB26*/
*                                                                  0590
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0590
*         /***********************************************************/
*         /*                                                         */
*         /* LOOP THRU EXTENSION RECORDS UNTIL ONE WITH      @G24LB26*/
*         /* REQUIRED SLOT IS FOUND.                         @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0591
*         DO WHILE EXITSW=OFF;      /*                       @G24LB26*/
*                                                                  0591
         B     @DE00591                                            0591
@DL00591 DS    0H                                                  0592
*           /*********************************************************/
*           /*                                                       */
*           /* READ GROUP EXTENSION RECORD.                  @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0592
*           RESPECIFY                                              0592
*             REG1 RSTD;            /*                       @G24LB26*/
*           REG1=RPLVPTR;           /* ADDR OF RPLV          @G24LB26*/
         LR    REG1,RPLVPTR                                        0593
*           CALL ICBVIO00;          /* READ                  @G24LB26*/
         L     @15,@CV01910                                        0594
         BALR  @14,@15                                             0594
*           RESPECIFY                                              0595
*             REG1 UNRSTD;          /*                       @G24LB26*/
*                                                                  0595
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK RETURN CODE FROM I/O PROCESSOR AND      @G24LB26*/
*           /* ALSO CHECK IF PROPER GROUP.                   @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0596
*           IF RPLVRETC^=RCZEROGVSVVGRP^=GROUPKY THEN/*     @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0596
         BNE   @RT00596                                            0596
         L     @08,GVSNEPTR                                        0596
         CLC   GVSVVGRP(8,@08),GROUPKY                             0596
         BE    @RF00596                                            0596
@RT00596 DS    0H                                                  0597
*             DO;                   /*                       @G24LB26*/
*               ERRORSW=ON;         /* INDICATE ERROR        @G24LB26*/
*               EXITSW=ON;          /* EXIT LOOP             @G24LB26*/
         OI    ERRORSW,B'00011000'                                 0599
*               RPLVRETC=RCZERO;    /* CLEAR RETURN AND      @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0600
*               RPLRCODE=RCZERO;    /* REASON CODES          @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0601
*             END;                  /*                       @G24LB26*/
*                                                                  0602
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO ERROR READING RECORDS, LOOP THRU        @G24LB26*/
*           /* LOOKING FOR DESIRED SLOT.                     @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0603
*           ELSE                    /*                       @G24LB26*/
*             DO INDXEXTS=ONE TO GVSESIND-ONE/*              @G24LB26*/
*                   WHILE EXITSW=OFF;/*                      @G24LB26*/
*                                                                  0603
         B     @RC00596                                            0603
@RF00596 LA    INDXEXTS,1                                          0603
         B     @DE00603                                            0603
@DL00603 TM    EXITSW,B'00010000'                                  0603
         BNZ   @DC00603                                            0603
*               /*****************************************************/
*               /*                                                   */
*               /* LOOK FOR SLOT WITH VOLID CURRENTLY        @G24LB26*/
*               /* BEING PROCESSED.                          @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0604
*               IF GVSVOLID(INDXEXTS)=BASSERNO THEN/*        @G24LB26*/
         L     @06,GVSNEPTR                                        0604
         LR    @04,INDXEXTS                                        0604
         MH    @04,@CH01851                                        0604
         ST    @04,@TF00001                                        0604
         ALR   @04,@06                                             0604
         L     @01,BASEVPTR                                        0604
         CLC   GVSVOLID-20(6,@04),BASSERNO(@01)                    0604
         BNE   @RF00604                                            0604
*                 DO;               /*                       @G24LB26*/
*                                                                  0605
*                   /*************************************************/
*                   /*                                               */
*                   /* UPDATE FIELDS FOR TABLE PROCESSOR     @G24LB26*/
*                   /* AND CALL ROUTINE TO CONVERT SPACE TO  @G24LB26*/
*                   /* CYLINDERS TO UPDATE MSVI RECORDS      @G24LB26*/
*                   /* IF SPACE IS NOT ALREADY DOWN LEVEL.   @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0606
*                   GRPNAME=GVSVVGRP;/* GROUP NAME           @G24LB26*/
         L     @04,SELGRPPR(,SELTMPTR)                             0606
         MVC   GRPNAME(8,@04),GVSVVGRP(@06)                        0606
*                   GRPEXTIN=GVSNO; /* EXTENSION ID          @G24LB26*/
         IC    @15,GVSNO(,@06)                                     0607
         STC   @15,GRPEXTIN(,@04)                                  0607
*                   GRPSLOTN=INDXEXTS;/* SLOT INDEX NO.      @G24LB26*/
*                                                                  0608
         STC   INDXEXTS,GRPSLOTN(,@04)                             0608
*                   /*************************************************/
*                   /*                                               */
*                   /* CALL SPACE CONVERSION IF SPACE        @G24LB26*/
*                   /* IS VALID.                             @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0609
*                   IF GVSRCFSI(INDXEXTS)=OFF THEN/*         @G24LB26*/
         AL    @06,@TF00001                                        0609
         TM    GVSRCFSI-20(@06),B'10000000'                        0609
         BNZ   @RF00609                                            0609
*                     DO;           /*                       @G24LB26*/
*                       NUMBVOL=ONE;/* INDICATE CALCULATE    @G24LB26
*                                      ONLY PRIMARY          @G24LB26*/
*                                                                  0611
         MVI   NUMBVOL,X'01'                                       0611
*                       /*********************************************/
*                       /*                                           */
*                       /* CALL SPACE CONVERSION ROUTINE     @G24LB26*/
*                       /* TO GET SPACE IN CYLINDERS.        @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0612
*                       CALL SPACONV;/*                      @G24LB26*/
*                                                                  0612
         BAL   @14,SPACONV                                         0612
*                       /*********************************************/
*                       /*                                           */
*                       /* UPDATE SPACE IN EXTENSION SLOT    @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0613
*                       GVSMTDSP(INDXEXTS)=/*                @G24LB26*/
*                           GVSMTDSP(INDXEXTS)-PRICYL;/*     @G24LB26*/
*                                                                  0613
         L     @06,GVSNEPTR                                        0613
         LR    @04,INDXEXTS                                        0613
         MH    @04,@CH01851                                        0613
         LH    @15,GVSMTDSP-20(@04,@06)                            0613
         SH    @15,PRICYL                                          0613
         STH   @15,GVSMTDSP-20(@04,@06)                            0613
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK TO SEE IF VALUE WENT        @G24LB26*/
*                       /* NEGATIVE. IF LESS THAN ZERO,      @G24LB26*/
*                       /* SET TO ZERO.                      @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0614
*                       IF GVSMTDSP(INDXEXTS)<ZERO THEN/*    @G24LB26*/
         SLR   @14,@14                                             0614
         CR    @15,@14                                             0614
         BNL   @RF00614                                            0614
*                         GVSMTDSP(INDXEXTS)=ZERO;/*         @G24LB26*/
*                                                                  0615
         STH   @14,GVSMTDSP-20(@04,@06)                            0615
*                       /*********************************************/
*                       /*                                           */
*                       /* WRITE UPDATED EXTENSION RECORD    @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0616
*                       RPLVTYP=RPLVPUT;/* PUT EXT RECORD    @G24LB26*/
@RF00614 MVI   RPLVTYP(RPLVPTR),X'01'                              0616
*                       RESPECIFY                                  0617
*                         REG1 RSTD;/*                       @G24LB26*/
*                       REG1=RPLVPTR;/*                      @G24LB26*/
         LR    REG1,RPLVPTR                                        0618
*                       CALL ICBVIO00;/* WRITE EXTENSION     @G24LB26*/
         L     @15,@CV01910                                        0619
         BALR  @14,@15                                             0619
*                       RESPECIFY                                  0620
*                         REG1 UNRSTD;/*                     @G24LB26*/
*                                                                  0620
*                       /*********************************************/
*                       /*                                           */
*                       /* IF SPACE UPDATE IN EXTENSION      @G24LB26*/
*                       /* RECORD WAS SUCCESSFULLY WRITTEN   @G24LB26*/
*                       /* TO THE MSVI, THEN INDICATE TO     @G24LB26*/
*                       /* TABLE PROCESSOR THE AMOUNT OF     @G24LB26*/
*                       /* PRIMARY SPACE.                    @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0621
*                       IF RPLVRETC=RCZERO THEN/*            @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0621
         BNE   @RF00621                                            0621
*                         GRPPRMSP=PRICYL;/* UPDATE SPACE    @G24LB26
*                                      FOR TABLE PROC        @G24LB26*/
         L     @06,SELGRPPR(,SELTMPTR)                             0622
         LH    @04,PRICYL                                          0622
         STH   @04,GRPPRMSP(,@06)                                  0622
*                       ELSE        /*                       @G24LB26*/
*                         DO;       /*                       @G24LB26*/
         B     @RC00621                                            0623
@RF00621 DS    0H                                                  0624
*                           RPLVRETC=RCZERO;/*               @G24LB26
*                                      CLEAR RETURN AND      @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0624
*                           RPLRCODE=RCZERO;/* REASON CODES  @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0625
*                         END;      /*                       @G24LB26*/
*                     END;          /*                       @G24LB26*/
*                                                                  0627
@RC00621 DS    0H                                                  0628
*                   /*************************************************/
*                   /*                                               */
*                   /* SET SWITCH UP TO GET OUT OF LOOP AND  @G24LB26*/
*                   /* INDICATE THAT MATCH WAS FOUND.        @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0628
*                   EXITSW=ON;      /*                       @G24LB26*/
@RF00609 OI    EXITSW,B'00010000'                                  0628
*                 END;              /*                       @G24LB26*/
*             END;                  /*                       @G24LB26*/
*                                                                  0630
@RF00604 AL    INDXEXTS,@CF00043                                   0630
@DE00603 L     @06,GVSNEPTR                                        0630
         LH    @06,GVSESIND(,@06)                                  0630
         BCTR  @06,0                                               0630
         CR    INDXEXTS,@06                                        0630
         BNH   @DL00603                                            0630
@DC00603 DS    0H                                                  0631
*           /*********************************************************/
*           /*                                                       */
*           /* IF A MATCH DID NOT OCCUR AND NO I/O ERROR     @G24LB26*/
*           /* HAS BEEN ENCOUNTERED, SEE IF THERE ARE ANY    @G24LB26*/
*           /* MORE EXTENSION RECORDS TO READ.               @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0631
*           IF EXITSW=OFF&GVSEX=OFF THEN/*                   @G24LB26*/
*                                                                  0631
@RC00596 TM    EXITSW,B'00010000'                                  0631
         BNZ   @RF00631                                            0631
         L     @08,GVSNEPTR                                        0631
         TM    GVSEX(@08),B'10000000'                              0631
         BNZ   @RF00631                                            0631
*             /*******************************************************/
*             /*                                                     */
*             /* GET OUT OF LOOP AND INDICATE AN ERROR       @G24LB26*/
*             /* OCCURRED.                                   @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0632
*             DO;                   /*                       @G24LB26*/
*               ERRORSW=ON;         /*                       @G24LB26*/
*               EXITSW=ON;          /*                       @G24LB26*/
         OI    ERRORSW,B'00011000'                                 0634
*             END;                  /*                       @G24LB26*/
*                                                                  0635
*           /*********************************************************/
*           /*                                                       */
*           /* IF MORE RECORDS TO READ AND NO MATCH YET      @G24LB26*/
*           /* FOUND, SET UP KEY TO READ NEXT EXTENSION      @G24LB26*/
*           /* RECORD.                                       @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0636
*           ELSE                    /*                       @G24LB26*/
*             DO;                   /*                       @G24LB26*/
         B     @RC00631                                            0636
@RF00631 DS    0H                                                  0637
*               GKEY=GVSNAME;       /* SET KEY TO RECORD     @G24LB26
*                                      KEY JUST READ         @G24LB26*/
         L     @08,GVSNEPTR                                        0637
         MVC   GKEY(13),GVSNAME(@08)                               0637
*               GIDKY=GIDKY+ONE;    /* AND SET TO READ NEXT  @G24LB26
*                                      RECORD                @G24LB26*/
         IC    @08,GIDKY                                           0638
         LA    @08,1(,@08)                                         0638
         STC   @08,GIDKY                                           0638
*             END;                  /*                       @G24LB26*/
*         END;                      /*                       @G24LB26*/
*                                                                  0640
@RC00631 DS    0H                                                  0640
@DE00591 TM    EXITSW,B'00010000'                                  0640
         BZ    @DL00591                                            0640
*         /***********************************************************/
*         /*                                                         */
*         /* IF AN I/O ERROR OCCURRED OR THE SLOT FOR THE    @G24LB26*/
*         /* VOLUME COULD NOT BE FOUND, ISSUE ERROR MESSAGE  @G24LB26*/
*         /* ICB445I WITH ZERO REASON AND RETURN CODES.      @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0641
*         IF ERRORSW=ON THEN        /*                       @G24LB26*/
         TM    ERRORSW,B'00001000'                                 0641
         BNO   @RF00641                                            0641
*           DO;                     /*                       @G24LB26*/
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM LIST   @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0643
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0644
*             MSGID=MSG445;         /* MSG ID FOR ICB445I    @G24LB26*/
         MVC   MSGID(4),@CF02069                                   0645
*             MSGLEN1=SIX;          /* VOLSER LENGTH         @G24LB26*/
         MVI   MSGLEN1,X'06'                                       0646
*             MSGTEXT1=ADDR(BASSERNO);/* VOLID OF BASE VOL   @G24LB26
*                                      READ                  @G24LB26*/
         L     @08,BASEVPTR                                        0647
         LA    @06,BASSERNO(,@08)                                  0647
         STCM  @06,7,MSGTEXT1                                      0647
*             MSGLEN2=EIGHT;        /* LENGTH GROUP NAME     @G24LB26*/
         MVI   MSGLEN2,X'08'                                       0648
*             MSGTEXT2=ADDR(BASGROUP);/* GRP NAME FROM BASE  @G24LB26
*                                      RECORD                @G24LB26*/
         LA    @08,BASGROUP(,@08)                                  0649
         STCM  @08,7,MSGTEXT2                                      0649
*             RESPECIFY                                            0650
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=ADDR(MSGRQ);     /* ADDR PARM LIST        @G24LB26*/
         LA    REG1,MSGRQ                                          0651
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0652
         BALR  @14,@15                                             0652
*             RESPECIFY                                            0653
*               REG1 UNRSTD;        /*                       @G24LB26*/
*           END;                    /*                       @G24LB26*/
*       END;                        /*                       @G24LB26*/
*                                                                  0655
@RF00641 DS    0H                                                  0656
*   /*****************************************************************/
*   /*                                                               */
*   /* REGARDLESS OF WHETHER EXTENSION RECORD WAS UPDATED OR @G24LB26*/
*   /* NOT, THE TABLE PROCESSOR WILL BE CALLED TO TABLE THE  @G24LB26*/
*   /* VOL=REF REQUEST. IF THE EXTENSION RECORD WAS NOT      @G24LB26*/
*   /* UPDATED, THE TABLE PROCESSOR WILL TABLE ZERO          @G24LB26*/
*   /* CYLINDERS PRIMARY SPACE. GROUP PARAMETER LIST IS      @G24LB26*/
*   /* ALREADY SET UP.                                       @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*   TABP=TABP&&TABP;                /* CLEAR TABLE PROC      @G24LB26
*                                      PARM FIELDS           @G24LB26*/
@RF00577 DS    0H                                                  0656
@RC00563 LA    @08,STRTABP                                         0656
         XC    TABP(12,@08),TABP(@08)                              0656
*   TABFBLDE=ON;                    /* BUILD DD ENTRY FUNC   @G24LB26*/
         OI    TABFBLDE(@08),B'10000000'                           0657
*   TABSELRB=ADDR(RPLVUTIL);        /* ADDR SELECT REQ BLK   @G24LB26*/
         LA    @06,RPLVUTIL(,RPLVPTR)                              0658
         ST    @06,TABSELRB(,@08)                                  0658
*   CALL ICBVTP00(TABP);            /* CALL TO TABLE PROC    @G24LB26*/
*                                                                  0659
         ST    @08,@AL00001                                        0659
         L     @15,@CV01914                                        0659
         LA    @01,@AL00001                                        0659
         BALR  @14,@15                                             0659
*   /*****************************************************************/
*   /*                                                               */
*   /* IGNORE REG15 AND RETURN                               @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0660
*   RETURN;                         /*                       @G24LB26*/
@EL00004 DS    0H                                                  0660
@EF00004 DS    0H                                                  0660
@ER00004 L     @14,@SA00004                                        0660
         BR    @14                                                 0660
*   END VOLREF;                     /*                       @G24LB26*/
*                                                                  0662
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - ELGIBLCK                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - DETERMINES IF A VOLUME IS ELIGIBLE TO BE      @G24LB26*/
*/*            SELECTED FOR THIS PARTICULAR REQUEST. CHECKS  @G24LB26*/
*/*            AVAILABLE FREE SPACE, CHECKS MOUNT STATUS AND @G24LB26*/
*/*            IF MOUNTED TO ANOTHER HOST, CHECKS TO SEE IF  @G24LB26*/
*/*            GROUP MUST HAVE EXCLUSIVE CONTROL OR IF       @G24LB26*/
*/*            VOLUME IS MOUNTED EXCLUSIVE TO ANOTHER HOST.  @G24LB26*/
*/*            ALSO CHECKS FOR USER SPECIFIED UNIT OR DATA   @G24LB26*/
*/*            SEPARATION REQUESTS. CHECKS MOUNT ATTRIBUTES  @G24LB26*/
*/*            IF VOLUME HAS AN ASSOCIATED UCB.              @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - INDEX INTO BEST FIT TABLE, INDEX INTO GROUP      @G24LB26*/
*/*         EXTENSION RECORD, GROUP RECORD, SELECT REQUEST   @G24LB26*/
*/*         BLOCK, GROUP EXTENSION RECORD, MSVC CONTROL      @G24LB26*/
*/*         BLOCK.                                           @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - AN ENTRY FOR THE VOLUME UNDER CONSIDERATION IN  @G24LB26*/
*/*          THE BEST FIT TABLE OR A FOUR RETURN CODE IN     @G24LB26*/
*/*          THE INTERNAL RETURN AREA.                       @G24LB26*/
*/*          ISSUES MESSAGE ICB483I.                         @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0662
*ELGIBLCK:                                                         0662
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0662
ELGIBLCK ST    @14,@SA00005                                        0662
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO INTERNAL WORK AREA, IE., INTERNAL RETURN         @G24LB26*/
*   /* CODE AND UCB ADDRESS.                                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0663
*   DYNMAREA=DYNMAREA&&DYNMAREA;    /*                       @G24LB26*/
*                                                                  0663
         XC    DYNMAREA(6),DYNMAREA                                0663
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO SLOT IN BEST FIT TABLE THAT WILL BE USED         @G24LB26*/
*   /* FOR THIS CALL.                                        @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0664
*   BFENTRY(INDXBFTB)=              /*                       @G24LB26*/
*       BFENTRY(INDXBFTB)&&BFENTRY(INDXBFTB);/*              @G24LB26*/
*                                                                  0664
         L     @04,BFTBLPTR                                        0664
         LR    @15,INDXBFTB                                        0664
         MH    @15,@CH02240                                        0664
         ST    @15,@TF00001                                        0664
         ALR   @15,@04                                             0664
         XC    BFENTRY-18(18,@15),BFENTRY-18(@15)                  0664
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE MOUNT STATUS OF VOLUME AND                  @G24LB26*/
*   /* SET INDICATORS IN BEST FIT TABLE.                     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0665
*   IF GVSCPUBM(INDXEXTS)=ZEROMTMA THEN/*                    @G24LB26*/
         LR    @15,INDXEXTS                                        0665
         MH    @15,@CH01851                                        0665
         L     @01,GVSNEPTR                                        0665
         ALR   @01,@15                                             0665
         CLC   GVSCPUBM-20(2,@01),@CB02111                         0665
         BNE   @RF00665                                            0665
*     DO;                           /*                       @G24LB26*/
*                                                                  0666
*       /*************************************************************/
*       /*                                                           */
*       /* SET INDICATOR SHOWING VOLUME NOT MOUNTED.         @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0667
*       BFNMTDFL(INDXBFTB)=ON;      /*                       @G24LB26*/
         LR    @01,@04                                             0667
         AL    @01,@TF00001                                        0667
         OI    BFNMTDFL-18(@01),B'01000000'                        0667
*       BFNOTMTD(INDXBFTB)=ON;      /*                       @G24LB26*/
         AL    @04,@TF00001                                        0668
         OI    BFNOTMTD-18(@04),B'10000000'                        0668
*     END;                          /*                       @G24LB26*/
*                                                                  0669
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS MOUNTED, DETERMINE IF MOUNTED            @G24LB26*/
*   /* ONLY TO ANOTHER HOST.                                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0670
*   ELSE                            /*                       @G24LB26*/
*     DO;                           /*                       @G24LB26*/
*                                                                  0670
         B     @RC00665                                            0670
@RF00665 DS    0H                                                  0671
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO IF MOUNTED TO THIS HOST.                 @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0671
*       TESTMASK=VVICPUID&GVSCPUBM(INDXEXTS);/*              @G24LB26*/
         LR    @04,INDXEXTS                                        0671
         MH    @04,@CH01851                                        0671
         L     @01,VVIPTR                                          0671
         MVC   TESTMASK(2),VVICPUID(@01)                           0671
         L     @01,GVSNEPTR                                        0671
         ALR   @01,@04                                             0671
         NC    TESTMASK(2),GVSCPUBM-20(@01)                        0671
*       IF TESTMASK=ZEROMTMA THEN   /*                       @G24LB26*/
*                                                                  0672
         CLC   TESTMASK(2),@CB02111                                0672
         BNE   @RF00672                                            0672
*         /***********************************************************/
*         /*                                                         */
*         /* INDICATE VOLUME MOUNTED TO ANOTHER HOST.        @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0673
*         DO;                       /*                       @G24LB26*/
*           BFMTDOHF(INDXBFTB)=ON;  /*                       @G24LB26*/
         L     @04,BFTBLPTR                                        0674
         LR    @15,INDXBFTB                                        0674
         MH    @15,@CH02240                                        0674
         ST    @15,@TF00001                                        0674
         ALR   @15,@04                                             0674
         OI    BFMTDOHF-18(@15),B'00100000'                        0674
*           BFMTDOTH(INDXBFTB)=ON;  /*                       @G24LB26*/
*           BFMTDOHT(INDXBFTB)=ON;  /*                       @ZA28479*/
         AL    @04,@TF00001                                        0676
         OI    BFMTDOTH-18(@04),B'01100000'                        0676
*         END;                      /*                       @G24LB26*/
*       ELSE                        /*                       @ZA28479*/
*                                                                  0678
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO DETERMINE IF VOLUME MAY BE MOUNTED     @ZA28479*/
*         /* TO OTHER HOST PLUS REQUESTING HOST.             @ZA28479*/
*         /* IF SO, SET INDICATOR MOUNTED TO OTHER HOST      @ZA28479*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0678
*         DO;                       /*                       @ZA28479*/
         B     @RC00672                                            0678
@RF00672 DS    0H                                                  0679
*           TESTMASK=VVICPUID&&GVSCPUBM(INDXEXTS);/*         @ZA28479*/
         LR    @04,INDXEXTS                                        0679
         MH    @04,@CH01851                                        0679
         L     @01,VVIPTR                                          0679
         MVC   TESTMASK(2),VVICPUID(@01)                           0679
         L     @01,GVSNEPTR                                        0679
         ALR   @01,@04                                             0679
         XC    TESTMASK(2),GVSCPUBM-20(@01)                        0679
*           IF TESTMASK^=ZEROMTMA THEN/*                     @ZA28479*/
         CLC   TESTMASK(2),@CB02111                                0680
         BE    @RF00680                                            0680
*             BFMTDOHT(INDXBFTB)=ON;/*                       @ZA28479*/
         LR    @04,INDXBFTB                                        0681
         MH    @04,@CH02240                                        0681
         L     @01,BFTBLPTR                                        0681
         ALR   @01,@04                                             0681
         OI    BFMTDOHT-18(@01),B'00100000'                        0681
*         END;                      /*                       @ZA28479*/
@RF00680 DS    0H                                                  0683
*     END;                          /*                       @G24LB26*/
*                                                                  0683
@RC00672 DS    0H                                                  0684
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF VOLUME IS MOUNTED                        @ZA28479*/
*   /* TO THIS HOST. IF IT IS, CALL UNIT PROCESSOR           @ZA28479*/
*   /* TO GET A UCB ADDRESS.                                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0684
*   IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOTH(INDXBFTB)=OFF/*       @ZA28479*/
*     THEN                          /*                       @ZA28479*/
*                                                                  0684
@RC00665 LR    @04,INDXBFTB                                        0684
         MH    @04,@CH02240                                        0684
         L     @01,BFTBLPTR                                        0684
         ALR   @01,@04                                             0684
         TM    BFNOTMTD-18(@01),B'11000000'                        0684
         BNZ   @RF00684                                            0684
*     /***************************************************************/
*     /*                                                             */
*     /* CALL UNIT PROCESSOR                                 @ZA28479*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0685
*     DO;                           /*                       @ZA28479*/
*       UNITP=UNITP&&UNITP;         /* ZERO UNIT PROC PARM   @G24LB26*/
         LA    @04,STRUNITP                                        0686
         XC    UNITP(17,@04),UNITP(@04)                            0686
*       UNIVOL=GVSVOLID(INDXEXTS);  /* VOLID FOR SEARCH      @G24LB26*/
         LR    @15,INDXEXTS                                        0687
         MH    @15,@CH01851                                        0687
         L     @01,GVSNEPTR                                        0687
         ALR   @01,@15                                             0687
         MVC   UNIVOL(6,@04),GVSVOLID-20(@01)                      0687
*       UNIFMTD=ON;                 /* INDICATE MOUNT CHECK  @G24LB26*/
         OI    UNIFMTD(@04),B'10000000'                            0688
*       RESPECIFY                                                  0689
*         REG15 RSTD;               /*                       @G24LB26*/
*       CALL ICBVUP00(UNITP,VVICB); /*                       @G24LB26*/
         ST    @04,@AL00001                                        0690
         L     @14,VVIPTR                                          0690
         ST    @14,@AL00001+4                                      0690
         L     @15,@CV01913                                        0690
         LA    @01,@AL00001                                        0690
         BALR  @14,@15                                             0690
*       IF REG15=RCZERO THEN        /*                       @G24LB26*/
*                                                                  0691
         LTR   REG15,REG15                                         0691
         BNZ   @RF00691                                            0691
*         /***********************************************************/
*         /*                                                         */
*         /* SET UCB ADDRESS IN WORK AREA AND CHECK UCB.     @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0692
*         DO;                       /*                       @G24LB26*/
*           UCBADDR=UNIUCBP;        /* UCB ADDR TO WORK AREA @G24LB26*/
         LA    @14,STRUNITP                                        0693
         L     @14,UNIUCBP(,@14)                                   0693
         ST    @14,UCBADDR                                         0693
*           UCBPTR=UNIUCBP;         /* SET UP ADDRESSABILITY @G24LB26
*                                      TO UCB                @G24LB26*/
*                                                                  0694
         ST    @14,UCBPTR                                          0694
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK MOUNTING ATTRIBUTES OF VOLUME IN UCB.   @G24LB26*/
*           /* CHECK IF ONLINE, PRIVATE RESERVED, PRIVATE    @G24LB26*/
*           /* REMOVEABLE, OR NO MOUNTING ATTRIBUTES.        @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0695
*           IF UCBONLI=ON&UCBPRES=OFF&/*                     @G24LB26*/
*               (UCBBPRV=ON(UCBBPRV=OFF&UCBBPUB=OFF&/*      @G24LB26*/
*               UCBBSTR=OFF&UCBRESV=OFF)) THEN                     0695
         TM    UCBONLI(@14),B'10000000'                            0695
         BNO   @RF00695                                            0695
         TM    UCBPRES(@14),B'00000100'                            0695
         BNZ   @RF00695                                            0695
         TM    UCBBPRV(@14),B'00010000'                            0695
         BO    @RT00695                                            0695
         TM    UCBBPRV(@14),B'00011100'                            0695
         BNZ   @RF00695                                            0695
         TM    UCBRESV(@14),B'00100000'                            0695
         BZ    @RT00695                                            0695
*             ;                     /*                       @G24LB26*/
*                                                                  0696
*           /*********************************************************/
*           /*                                                       */
*           /* IF ABOVE CONDITIONS ARE NOT MET, VOLUME       @G24LB26*/
*           /* IS INELIGIBLE.                                @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0697
*           ELSE                    /*                       @G24LB26*/
*             INTERCC=RCFOUR;       /*                       @G24LB26*/
@RF00695 MVC   INTERCC(2),@CB02113                                 0697
*         END;                      /*                       @G24LB26*/
@RT00695 DS    0H                                                  0699
*       RESPECIFY                                                  0699
*         REG15 UNRSTD;             /*                       @G24LB26*/
@RF00691 DS    0H                                                  0700
*     END;                          /*                       @G24LB26*/
*                                                                  0700
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK RUNNING FREE SPACE INDICATOR, AND IF IT         @G24LB26*/
*   /* SHOWS RUNNING SPACE IS INVALID, CORRECT IT BY         @ZA28479*/
*   /* ISSUING LSPACE IF THE VOLUME IS MOUNTED TO THE        @ZA28479*/
*   /* REQUESTING HOST ONLY                                  @ZA28479*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0701
*   IF INTERCC=RCZERO&GVSRCFSI(INDXEXTS)=ON THEN/*           @ZA28479*/
@RF00684 CLC   INTERCC(2),@CB02111                                 0701
         BNE   @RF00701                                            0701
         LR    @04,INDXEXTS                                        0701
         MH    @04,@CH01851                                        0701
         L     @01,GVSNEPTR                                        0701
         ALR   @01,@04                                             0701
         TM    GVSRCFSI-20(@01),B'10000000'                        0701
         BNO   @RF00701                                            0701
*     DO;                           /*                       @ZA28479*/
*                                                                  0702
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO DETERMINE IF THE VOLUME IS MOUNTED TO    @ZA28479*/
*       /* THE REQUESTING HOST AND NOT OTHER HOST.           @ZA28479*/
*       /* ALSO CHECK IF UCB ADDRESS WAS SUCCESSFULLY        @ZA28479*/
*       /* OBTAINED                                          @ZA28479*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0703
*       IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOHT(INDXBFTB)=OFF&UCBADDR^= 0703
*           ZEROPTR THEN            /*                       @ZA28479*/
         LR    @04,INDXBFTB                                        0703
         MH    @04,@CH02240                                        0703
         L     @01,BFTBLPTR                                        0703
         ALR   @01,@04                                             0703
         TM    BFNOTMTD-18(@01),B'10100000'                        0703
         BNZ   @RF00703                                            0703
         L     @04,UCBADDR                                         0703
         LTR   @04,@04                                             0703
         BZ    @RF00703                                            0703
*         DO;                       /*                       @ZA28479*/
*                                                                  0704
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE LSPACE TO GET SPACE UP LEVEL            @ZA28479*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0705
*           RESPECIFY                                              0705
*            (REG0,                                                0705
*             REG1,                                                0705
*             REG15) RSTD;          /*                       @ZA28479*/
*           REG0=ADDR(UCBOB);       /* SET UP UCB ADDR       @ZA28479*/
         L     REG0,UCBPTR                                         0706
*           REG1=ADDR(LSPAREA);     /* ADDR OF RETURN AREA   @ZA28479*/
         LA    REG1,LSPAREA                                        0707
*           SVC(LSPACE);            /* ISSUE LSPACE MACRO    @ZA28479*/
*                                                                  0708
         SVC   78                                                  0708
*           /*********************************************************/
*           /*                                                       */
*           /* IF LSPACE SUCCESSFUL, UPDATE FREE SPACE IN    @ZA28479*/
*           /* EXTENSION RECORD. ALSO LARGEST FREE EXTENT    @ZA28479*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0709
*           RESPECIFY                                              0709
*             REG1 UNRSTD;          /*                       @ZA28479*/
*           IF REG15=RCZERO THEN    /*                       @ZA28479*/
         LTR   REG15,REG15                                         0710
         BNZ   @RF00710                                            0710
*             DO;                   /*                       @ZA28479*/
*               PACK(TEMPPACK,LSPFRESP);/*                   @ZA28479*/
         PACK  TEMPPACK(4),LSPFRESP(4)                             0712
*               CVB(TEMPBIN,TEMPPACK);/*                     @ZA28479*/
         XC    @TS00001(8),@TS00001                                0713
         MVC   @TS00001+4(4),TEMPPACK                              0713
         CVB   TEMPBIN,@TS00001                                    0713
*               GVSFRESP(INDXEXTS)=TEMPBIN;/* UPDT FREE SP   @ZA28479*/
         L     @14,GVSNEPTR                                        0714
         LR    @04,INDXEXTS                                        0714
         MH    @04,@CH01851                                        0714
         STH   TEMPBIN,GVSFRESP-20(@04,@14)                        0714
*               PACK(TEMPPACK,LSPLEXT);/*                    @ZA28479*/
         PACK  TEMPPACK(4),LSPLEXT(4)                              0715
*               CVB(TEMPBIN,TEMPPACK);/*                     @ZA28479*/
         XC    @TS00001(8),@TS00001                                0716
         MVC   @TS00001+4(4),TEMPPACK                              0716
         CVB   TEMPBIN,@TS00001                                    0716
*               GVSLEXT(INDXEXTS)=TEMPBIN;/* UPDT LRGST EXT  @ZA28479*/
*                                                                  0717
         STH   TEMPBIN,GVSLEXT-20(@04,@14)                         0717
*               /*****************************************************/
*               /*                                                   */
*               /* CALL TABLE PROCESSOR TO GET SCHEDULED     @ZA28479*/
*               /* SPACE                                     @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0718
*               TABP=TABP&&TABP;    /* CLEAR TABLE PARM      @ZA28479*/
         LA    @01,STRTABP                                         0718
         XC    TABP(12,@01),TABP(@01)                              0718
*               TABFTSPC=ON;        /* SEARCH FOR VOL        @ZA28479*/
         OI    TABFTSPC(@01),B'00010000'                           0719
*               TABVOLID=GVSVOLID(INDXEXTS);/* VOLID         @ZA28479*/
         ALR   @14,@04                                             0720
         MVC   TABVOLID(6,@01),GVSVOLID-20(@14)                    0720
*               CALL ICBVTP00(TABP);/* CALL TABLE PROCESSOR  @ZA28479*/
         ST    @01,@AL00001                                        0721
         L     @15,@CV01914                                        0721
         LA    @01,@AL00001                                        0721
         BALR  @14,@15                                             0721
*               GVSMTDSP(INDXEXTS)=GVSFRESP(INDXEXTS)-TABSPRET;    0722
         L     @14,GVSNEPTR                                        0722
         LR    @04,INDXEXTS                                        0722
         MH    @04,@CH01851                                        0722
         LA    @01,STRTABP                                         0722
         LH    @03,GVSFRESP-20(@04,@14)                            0722
         SH    @03,TABSPRET(,@01)                                  0722
         STH   @03,GVSMTDSP-20(@04,@14)                            0722
*               GVSRCFSI(INDXEXTS)=OFF;/* AVAIL SPACE OK     @ZA28479*/
*                                                                  0723
         ST    @04,@TF00001                                        0723
         ALR   @04,@14                                             0723
         NI    GVSRCFSI-20(@04),B'01111111'                        0723
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR NEGATIVE NUMBER                 @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0724
*               IF GVSMTDSP(INDXEXTS)<ZERO THEN/*            @ZA28479*/
         SLR   @04,@04                                             0724
         L     @01,@TF00001                                        0724
         CH    @04,GVSMTDSP-20(@01,@14)                            0724
         BNH   @RF00724                                            0724
*                 GVSMTDSP(INDXEXTS)=ZERO;/*                 @ZA28479*/
         L     @01,@TF00001                                        0725
         STH   @04,GVSMTDSP-20(@01,@14)                            0725
*               RESPECIFY                                          0726
*                 REG0 UNRSTD;      /*                       @ZA28479*/
*                                                                  0726
@RF00724 DS    0H                                                  0727
*               /*****************************************************/
*               /*                                                   */
*               /* INDICATE EXTENSION RECORD UPDATED         @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0727
*               UPDTGVSN=ON;        /*                       @ZA28479*/
         OI    UPDTGVSN,B'10000000'                                0727
*             END;                  /*                       @ZA28479*/
*           ELSE                    /*                       @ZA28479*/
*                                                                  0729
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE ERROR MESSAGE, LSPACE FAILED          @ZA28479*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0729
*             DO;                   /*                       @ZA28479*/
         B     @RC00710                                            0729
@RF00710 DS    0H                                                  0730
*               RESPECIFY                                          0730
*                 REG1 RSTD;        /*                       @ZA28479*/
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR PARM FIELD      @ZA28479*/
         XC    MSGRQ(32),MSGRQ                                     0731
*               MSGRPLV=RPLVPTR;    /* ADDR OF REQUEST PARM  @ZA28479*/
         ST    RPLVPTR,MSGRPLV                                     0732
*               MSGID=MSG401;       /* MSG NUMBER            @ZA28479*/
         MVC   MSGID(4),@CF02057                                   0733
*               MSGLEN1=SIX;        /* MSG LENGTH OF INSERT  @ZA28479*/
         MVI   MSGLEN1,X'06'                                       0734
*               MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* INSERT  @ZA28479*/
         LR    @14,INDXEXTS                                        0735
         MH    @14,@CH01851                                        0735
         L     @04,GVSNEPTR                                        0735
         LA    @14,GVSVOLID-20(@14,@04)                            0735
         STCM  @14,7,MSGTEXT1                                      0735
*               MSGLEN2=TWO;        /* MSG LENGTH OF INSERT  @ZA28479*/
         MVI   MSGLEN2,X'02'                                       0736
*               MSGTEXT2=ADDR(TEMPCHAR);/* INSERT TWO        @ZA28479*/
         LA    @14,TEMPCHAR                                        0737
         STCM  @14,7,MSGTEXT2                                      0737
*               TEMPBIN=REG15;      /* RETURN CODE           @ZA28479*/
         LR    TEMPBIN,REG15                                       0738
*               CVD(TEMPBIN,TEMPPACK);/*                     @ZA28479*/
         CVD   TEMPBIN,@TS00001                                    0739
         MVC   TEMPPACK(4),@TS00001+4                              0739
*               UNPK(TEMPCHAR,TEMPPACK);/*                   @ZA28479*/
         UNPK  TEMPCHAR(2),TEMPPACK(4)                             0740
*               TEMPCHAR(2:2)=TEMPCHAR(2:2)ORSIGN;/* PRTBLE @ZA28479*/
         OC    TEMPCHAR+1(1),ORSIGN                                0741
*               REG1=ADDR(MSGRQ);   /*                       @ZA28479*/
         LA    REG1,MSGRQ                                          0742
*               CALL ICBVOP00;      /* CALL MSG MODULE       @ZA28479*/
         L     @15,@CV01912                                        0743
         BALR  @14,@15                                             0743
*             END;                  /*                       @ZA28479*/
*         END;                      /*                       @ZA28479*/
@RC00710 DS    0H                                                  0746
*     END;                          /*                       @ZA28479*/
@RF00703 DS    0H                                                  0747
*   RESPECIFY                                                      0747
*     REG15 UNRSTD;                 /*                       @ZA28479*/
*                                                                  0747
@RF00701 DS    0H                                                  0748
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MESSAGE FOR DOWN LEVEL RUNNING SPACE            @ZA28479*/
*   /* ICB483I WITH INTERNAL RETURN CODE OF FOUR.            @ZA28479*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0748
*   IF INTERCC=RCZERO&GVSRCFSI(INDXEXTS)=ON THEN/*           @ZA28479*/
         CLC   INTERCC(2),@CB02111                                 0748
         BNE   @RF00748                                            0748
         L     @04,GVSNEPTR                                        0748
         LR    @15,INDXEXTS                                        0748
         MH    @15,@CH01851                                        0748
         ST    @15,@TF00001                                        0748
         ALR   @15,@04                                             0748
         TM    GVSRCFSI-20(@15),B'10000000'                        0748
         BNO   @RF00748                                            0748
*     DO;                           /*                       @ZA28479*/
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MESSAGE PARM    @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     0750
*       MSGRPLV=RPLVPTR;            /* RPLV PTR              @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     0751
*       MSGID=MSG483;               /* SET MSG ID FOR ICB483I      0752
*                                                            @G24LB26*/
         MVC   MSGID(4),@CF02075                                   0752
*       MSGLEN1=SIX;                /* LENGTH FIRST INSERT   @G24LB26*/
         MVI   MSGLEN1,X'06'                                       0753
*       MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* VOL INSERT      @G24LB26*/
         L     @15,@TF00001                                        0754
         LA    @00,GVSVOLID-20(@15,@04)                            0754
         STCM  @00,7,MSGTEXT1                                      0754
*       MSGLEN2=EIGHT;              /* LENGTH REC INSERT     @G24LB26*/
         MVI   MSGLEN2,X'08'                                       0755
*       MSGTEXT2=ADDR(GVSVVGRP);    /* GROUP NAME            @G24LB26*/
         LA    @04,GVSVVGRP(,@04)                                  0756
         STCM  @04,7,MSGTEXT2                                      0756
*       REG1=ADDR(MSGRQ);           /* ADDR OF MESSAGE PARM  @G24LB26*/
         LA    REG1,MSGRQ                                          0757
*       CALL ICBVOP00;              /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        0758
         BALR  @14,@15                                             0758
*       INTERCC=RCFOUR;             /* ERROR RETURN CODE     @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 0759
*     END;                          /*                       @ZA28479*/
*   RESPECIFY                                                      0761
*     REG1 UNRSTD;                  /*                       @ZA28479*/
*                                                                  0761
@RF00748 DS    0H                                                  0762
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OVERALL STATUS OF VOLUME                        @ZA28479*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0762
*   IF INTERCC=RCZERO THEN          /*                       @ZA28479*/
         CLC   INTERCC(2),@CB02111                                 0762
         BNE   @RF00762                                            0762
*     DO;                           /*                       @ZA28479*/
*                                                                  0763
*       /*************************************************************/
*       /*                                                           */
*       /* USING MOUNT FLAGS SET PREVIOUSLY, DETERMINE IF    @ZA28479*/
*       /* VOLUME IS MOUNTED EXCLUSIVE TO ANOTHER HOST OR IF @G24LB26*/
*       /* MOUNTED ANOTHER HOST, CANNOT BE USED BY THIS      @G24LB26*/
*       /* HOST.                                             @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0764
*       IF BFMTDOTH(INDXBFTB)=ON THEN/*                      @G24LB26*/
*                                                                  0764
         LR    @04,INDXBFTB                                        0764
         MH    @04,@CH02240                                        0764
         L     @01,BFTBLPTR                                        0764
         ALR   @01,@04                                             0764
         TM    BFMTDOTH-18(@01),B'01000000'                        0764
         BNO   @RF00764                                            0764
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF VOLUME SHOULD BE EXCLUSIVE TO THIS     @G24LB26*/
*         /* HOST OR IF ALREADY EXCLUSIVE TO ANOTHER HOST,   @G24LB26*/
*         /* SET BAD RETURN CODE IF IT IS.                   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0765
*         IF GROEXCL=ONGVSMTNSH(INDXEXTS)=ON THEN/*         @G24LB26*/
         L     @04,GROUPPTR                                        0765
         TM    GROEXCL(@04),B'01000000'                            0765
         BO    @RT00765                                            0765
         LR    @04,INDXEXTS                                        0765
         MH    @04,@CH01851                                        0765
         L     @01,GVSNEPTR                                        0765
         ALR   @01,@04                                             0765
         TM    GVSMTNSH-20(@01),B'01000000'                        0765
         BNO   @RF00765                                            0765
@RT00765 DS    0H                                                  0766
*           INTERCC=RCFOUR;         /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 0766
*     END;                          /*                       @ZA28479*/
*                                                                  0767
@RF00765 DS    0H                                                  0767
@RF00764 DS    0H                                                  0768
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF VOLUME IS STILL ELIGIBLE, AND IF IT IS,  @G24LB26*/
*   /* CALL ROUTINE TO CHECK EXPIRATION DATES.               @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0768
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/
@RF00762 CLC   INTERCC(2),@CB02111                                 0768
         BNE   @RF00768                                            0768
*     CALL EXPIRCK;                 /*                       @G24LB26*/
*                                                                  0769
         BAL   @14,EXPIRCK                                         0769
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GOOD RETURN CODE FROM PREVIOUS PROCESSING,         @G24LB26*/
*   /* CONTINUE.                                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0770
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/
@RF00768 CLC   INTERCC(2),@CB02111                                 0770
         BNE   @RF00770                                            0770
*     DO;                           /*                       @G24LB26*/
*                                                                  0771
*       /*************************************************************/
*       /*                                                           */
*       /* IF SPACE FOR THIS REQUEST HAS NOT YET BEEN        @G24LB26*/
*       /* CALCULATED, CALL ROUTINE TO CALCULATE SPACE       @G24LB26*/
*       /* IN CYLINDERS.                                     @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0772
*       IF PRICYL=ZERO&SECCYL=ZERO THEN/*                    @G24LB26*/
         SLR   @04,@04                                             0772
         CH    @04,PRICYL                                          0772
         BNE   @RF00772                                            0772
         CH    @04,SECCYL                                          0772
         BNE   @RF00772                                            0772
*         CALL SPACONV;             /*                       @G24LB26*/
*                                                                  0773
         BAL   @14,SPACONV                                         0773
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO DETERMINE IF ENOUGH SPACE ON      @G24LB26*/
*       /* VOLUME FOR EITHER A PRIMARY OR SECONDARY REQUEST. @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0774
*       CALL SPACECK;               /*                       @G24LB26*/
@RF00772 BAL   @14,SPACECK                                         0774
*     END;                          /*                       @G24LB26*/
*                                                                  0775
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS STILL ELIGIBLE, DETERMINE IF REQUEST HAS @G24LB26*/
*   /* ANY DATA SEPARATION RESTRICTIONS.                     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*   IF INTERCC=RCZERO&SELSEPVL=ON THEN/*                     @G24LB26*/
@RF00770 CLC   INTERCC(2),@CB02111                                 0776
         BNE   @RF00776                                            0776
         TM    SELSEPVL(SELTMPTR),B'00100000'                      0776
         BNO   @RF00776                                            0776
*     CALL VOLSEPCK;                /*                       @G24LB26*/
*                                                                  0777
         BAL   @14,VOLSEPCK                                        0777
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS STILL ELIGIBLE, IT WILL BE AN ENTRY IN   @G24LB26*/
*   /* THE BEST FIT TABLE, SO FILL IN THE REMAINING FIELDS   @G24LB26*/
*   /* IN THE TABLE THAT ARE KNOWN AT THIS TIME.             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0778
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/
@RF00776 CLC   INTERCC(2),@CB02111                                 0778
         BNE   @RF00778                                            0778
*     DO;                           /*                       @G24LB26*/
*       BFVOLID(INDXBFTB)=GVSVOLID(INDXEXTS);/* VOLID IN     @G24LB26
*                                      BFTBL                 @G24LB26*/
         L     @04,BFTBLPTR                                        0780
         LR    @15,INDXBFTB                                        0780
         MH    @15,@CH02240                                        0780
         ST    @15,@TF00001                                        0780
         ALR   @15,@04                                             0780
         L     @14,GVSNEPTR                                        0780
         LR    @03,INDXEXTS                                        0780
         MH    @03,@CH01851                                        0780
         ALR   @03,@14                                             0780
         MVC   BFVOLID-18(6,@15),GVSVOLID-20(@03)                  0780
*       BFGRPIDX(INDXBFTB)=GVSNO;   /* INDEX TO EXTEN REC    @G24LB26*/
         SLR   @15,@15                                             0781
         IC    @15,GVSNO(,@14)                                     0781
         L     @14,@TF00001                                        0781
         STC   @15,BFGRPIDX-18(@14,@04)                            0781
*       BFGRPSLT(INDXBFTB)=INDXEXTS;/* INDEX TO SLOT IN      @G24LB26
*                                      EXTENSION REC         @G24LB26*/
         L     @01,@TF00001                                        0782
         STC   INDXEXTS,BFGRPSLT-18(@01,@04)                       0782
*       SLGRPSPA=SLGRPSPA+TPVOLSPA; /* UPDATE USABLE SPACE   @ZA28479
*                                      TOTAL FOR THE GROUP   @ZA28479*/
         LH    @04,TPVOLSPA                                        0783
         AL    @04,SLGRPSPA                                        0783
         ST    @04,SLGRPSPA                                        0783
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00005 DS    0H                                                  0785
@EF00005 DS    0H                                                  0785
@ER00005 L     @14,@SA00005                                        0785
         BR    @14                                                 0785
*   END ELGIBLCK;                   /*                       @G24LB26*/
         B     @EL00005                                            0786
*                                                                  0787
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - EXPIRCK                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - ROUTINE DETERMINES IF VOLUME IS IN A          @G24LB26*/
*/*            RETENTION GROUP AND IF IT IS, DETERMINES IF   @G24LB26*/
*/*            THE VOLUME EXPIRES BEFORE THE DATA SET TO BE  @G24LB26*/
*/*            ALLOCATED DOES. IF THE VOLUME IN A RETENTION  @G24LB26*/
*/*            GROUP HAS A NULL EXPIRATION DATE, A ROUTINE   @G24LB26*/
*/*            IS CALLED TO CALCULATE A DEFAULT, WHICH IS    @G24LB26*/
*/*            THEN USED TO MAKE THE COMPARISON. IF NO       @G24LB26*/
*/*            EXPIRATION DATE WAS SPECIFIED ON THE DD, A    @G24LB26*/
*/*            DEFAULT OF TODAYS DATE IS USED FOR THE DATA   @G24LB26*/
*/*            SET EXPIRATION. IF THE DATA SET EXPIRED AFTER @G24LB26*/
*/*            THE VOLUME, THE VOLUME IS INELIGIBLE FOR THIS @G24LB26*/
*/*            REQUEST.                                      @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE VOLUME EXPIRATION DATE IN THE EXTENSION      @G24LB26*/
*/*         RECORD, THE GROUP RECORD, THE INDEX VALUES INTO  @G24LB26*/
*/*         THE EXTENSION SLOT AND THE BEST FIT TABLE, THE   @G24LB26*/
*/*         VOLUME DEFAULT EXPIRATION DATE FOR THE GROUP IF  @G24LB26*/
*/*         CALCULATED BEFORE IN THE INTERNAL WORK AREA,     @G24LB26*/
*/*         TODAYS DATE IN THE CVT, AND THE DATA SET         @G24LB26*/
*/*         EXPIRATION DATE IN THE JFCB.                     @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - THE VOLUME EXPIRATION DATE IN THE BEST FIT      @G24LB26*/
*/*          TABLE IF THE VOLUME IS ELIGIBLE, PLUS A ZERO    @G24LB26*/
*/*          INTERNAL RETURN CODE. A FOUR INTERNAL RETURN    @G24LB26*/
*/*          CODE IF THE VOLUME IS NOT ELIGIBLE.             @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0787
*EXPIRCK:                                                          0787
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0787
EXPIRCK  ST    @14,@SA00006                                        0787
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF VOLUME IS IN A RETENTION GROUP. IF NOT,  @G24LB26*/
*   /* SET NULL EXPIRATION DATE IN THE BEST FIT TABLE AND    @G24LB26*/
*   /* EXIT PROGRAM.                                         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0788
*   IF GRORETN=OFF THEN             /*                       @G24LB26*/
         L     @04,GROUPPTR                                        0788
         TM    GRORETN(@04),B'00000100'                            0788
         BNZ   @RF00788                                            0788
*     BFVOLEXP(INDXBFTB)=NULEXPDT;  /*                       @G24LB26*/
         LR    @04,INDXBFTB                                        0789
         MH    @04,@CH02240                                        0789
         L     @01,BFTBLPTR                                        0789
         ALR   @01,@04                                             0789
         MVC   BFVOLEXP-18(4,@01),NULEXPDT                         0789
*   ELSE                            /*                       @G24LB26*/
*     DO;                           /*                       @G24LB26*/
*                                                                  0790
         B     @RC00788                                            0790
@RF00788 DS    0H                                                  0791
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE ANY EXPIRATION DATES NECESSARY AND MAKE @G24LB26*/
*       /* THEIR FORMAT COMPATABLE.                          @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0791
*       IF EXPIRDT=ZEROEXP&         /*                       @G24LB26*/
*           GVSEXPDT(INDXEXTS)=NULEXPDT THEN/*               @G24LB26*/
*                                                                  0791
         CLC   EXPIRDT(4),ZEROEXP                                  0791
         BNE   @RF00791                                            0791
         LR    @04,INDXEXTS                                        0791
         MH    @04,@CH01851                                        0791
         L     @01,GVSNEPTR                                        0791
         ALR   @01,@04                                             0791
         CLC   GVSEXPDT-20(4,@01),NULEXPDT                         0791
         BNE   @RF00791                                            0791
*         /***********************************************************/
*         /*                                                         */
*         /* SINCE THE VOLUME EXPIRATION DATE FOR THE        @G24LB26*/
*         /* GROUP HAS NOT YET BEEN CALCULATED AND THE       @G24LB26*/
*         /* EXTENSION CONTAINS A NULL DATE FOR THIS VOLUME, @G24LB26*/
*         /* CALL ROUTINE TO CALCULATE THE DEFAULT DATE.     @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0792
*         CALL DATES;               /*                       @G24LB26*/
*                                                                  0792
         BAL   @14,DATES                                           0792
*       /*************************************************************/
*       /*                                                           */
*       /* PUT EXPIRATION DATE FROM JFCB IN COMPATABLE       @G24LB26*/
*       /* FORMAT IF IT IS NOT ZERO. OTHERWISE SET DEFAULT   @G24LB26*/
*       /* FROM CVT.                                         @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0793
*       IF JFCBDATE=ZERO THEN       /*                       @G24LB26*/
@RF00791 L     @04,JFCBPTR(,SELTMPTR)                              0793
         ICM   @15,7,JFCBDATE(@04)                                 0793
         BNZ   @RF00793                                            0793
*         DO;                       /*                       @G24LB26*/
*                                                                  0794
*           /*********************************************************/
*           /*                                                       */
*           /* MAKE CVT DATE COMPATABLE WITH MSVI EXPIRATION @G24LB26*/
*           /* DATES                                         @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0795
*           EXPCVT=CVTDATE;         /* TODAYS DATE IN PACKED @G24LB26
*                                      DECIMAL               @G24LB26*/
         L     @04,CVTPTR                                          0795
         MVC   EXPCVT(4),CVTDATE(@04)                              0795
*           EXPCVT=EXPCVT&ANCVTEXP; /* CHANGE SIGN FROM F    @G24LB26
*                                      TO C                  @G24LB26*/
         NC    EXPCVT(4),ANCVTEXP                                  0796
*         END;                      /*                       @G24LB26*/
*       ELSE                        /*                       @G24LB26*/
*                                                                  0798
*         /***********************************************************/
*         /*                                                         */
*         /* IF JFCB DATE IS NOT ZERO, MAKE IT COMPATABLE    @G24LB26*/
*         /* WITH MSVI DATES.                                @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0798
*         DO;                       /*                       @G24LB26*/
         B     @RC00793                                            0798
@RF00793 DS    0H                                                  0799
*           RESPECIFY                                              0799
*             REG15 RSTD;           /*                       @G24LB26*/
*           CVD(JFCBYFX,EXPYR);     /* CONVERT YEAR TO DEC   @G24LB26*/
         L     @14,JFCBPTR(,SELTMPTR)                              0800
         SLR   @04,@04                                             0800
         IC    @04,JFCBYFX(,@14)                                   0800
         CVD   @04,@TS00001                                        0800
         MVC   EXPYR(2),@TS00001+6                                 0800
*           GENERATE REFS(EXPYR,REG15) SETS(EXPYR,REG15);          0801
*                                                         /*@G24LB26*/
           LH REG15,EXPYR          LOAD YEAR                  @G24LB26
           SRL REG15,4(0)          SHIFT SIGN OUT             @G24LB26
           STH REG15,EXPYR         STORE BACK                 @G24LB26
*           CVD(JFCBDFX,EXPDAY);    /* CONVERT DAYS TO DEC   @G24LB26*/
         L     @14,JFCBPTR(,SELTMPTR)                              0802
         LH    @14,JFCBDFX(,@14)                                   0802
         CVD   @14,@TS00001                                        0802
         MVC   EXPDAY(2),@TS00001+6                                0802
*           RESPECIFY                                              0803
*             REG15 UNRSTD;         /*                       @G24LB26*/
*         END;                      /*                       @G24LB26*/
*                                                                  0804
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF VOLUME EXPIRES TO SOON FOR THIS      @G24LB26*/
*       /* REQUEST.                                          @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0805
*       IF GVSEXPDT(INDXEXTS)=NULEXPDT THEN/*                @G24LB26*/
@RC00793 LR    @04,INDXEXTS                                        0805
         MH    @04,@CH01851                                        0805
         L     @01,GVSNEPTR                                        0805
         ALR   @01,@04                                             0805
         CLC   GVSEXPDT-20(4,@01),NULEXPDT                         0805
         BNE   @RF00805                                            0805
*         DO;                       /*                       @G24LB26*/
*                                                                  0806
*           /*********************************************************/
*           /*                                                       */
*           /* NULL DATE IN EXTENSION RECORD, BOTH DEFAULTS  @G24LB26*/
*           /* ARE TAKEN AND THE VOLUME MUST BE OK.          @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0807
*           IF JFCBDATE=ZERO THEN   /*                       @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0807
         ICM   @15,7,JFCBDATE(@04)                                 0807
         BNZ   @RF00807                                            0807
*             BFVOLEXP(INDXBFTB)=EXPIRDT;/* DEFAULT DATE IN  @G24LB26
*                                      BEST FIT              @G24LB26*/
         LR    @04,INDXBFTB                                        0808
         MH    @04,@CH02240                                        0808
         L     @01,BFTBLPTR                                        0808
         ALR   @01,@04                                             0808
         MVC   BFVOLEXP-18(4,@01),EXPIRDT                          0808
*           ELSE                    /*                       @G24LB26*/
*                                                                  0809
*             /*******************************************************/
*             /*                                                     */
*             /* DATE IN JFCB                                @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0809
*             IF EXPIRDT<EXPJFCB THEN/* DEFAULT VOL EXPIRES  @G24LB26
*                                      BEFORE REQUESTED DATE @G24LB26*/
         B     @RC00807                                            0809
@RF00807 CLC   EXPIRDT(4),EXPJFCB                                  0809
         BNL   @RF00809                                            0809
*               INTERCC=RCFOUR;     /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 0810
*             ELSE                  /*                       @G24LB26*/
*               BFVOLEXP(INDXBFTB)=EXPIRDT;/* DEFAULT TO     @G24LB26
*                                      BEST FIT              @G24LB26*/
         B     @RC00809                                            0811
@RF00809 LR    @04,INDXBFTB                                        0811
         MH    @04,@CH02240                                        0811
         L     @01,BFTBLPTR                                        0811
         ALR   @01,@04                                             0811
         MVC   BFVOLEXP-18(4,@01),EXPIRDT                          0811
*         END;                      /*                       @G24LB26*/
*                                                                  0812
*       /*************************************************************/
*       /*                                                           */
*       /* EXPIRATION DATE IS NOT NULL IN EXTENSION RECORD   @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0813
*       ELSE                        /*                       @G24LB26*/
*         DO;                       /*                       @G24LB26*/
*                                                                  0813
         B     @RC00805                                            0813
@RF00805 DS    0H                                                  0814
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO DATE IN JFCB, USE DEFAULT.              @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0814
*           IF JFCBDATE=ZERO THEN   /*                       @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0814
         ICM   @15,7,JFCBDATE(@04)                                 0814
         BNZ   @RF00814                                            0814
*             IF GVSEXPDT(INDXEXTS)<EXPCVT THEN/* VOLUME     @G24LB26
*                                      ALREADY EXPIRED       @G24LB26*/
         LR    @04,INDXEXTS                                        0815
         MH    @04,@CH01851                                        0815
         L     @01,GVSNEPTR                                        0815
         ALR   @01,@04                                             0815
         CLC   GVSEXPDT-20(4,@01),EXPCVT                           0815
         BNL   @RF00815                                            0815
*               INTERCC=RCFOUR;     /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 0816
*             ELSE                  /*                       @G24LB26*/
*               BFVOLEXP(INDXBFTB)=GVSEXPDT(INDXEXTS);/*     @G24LB26
*                                      EXPIR DATE IN BEST FIT      0817
*                                                            @G24LB26*/
         B     @RC00815                                            0817
@RF00815 LR    @04,INDXBFTB                                        0817
         MH    @04,@CH02240                                        0817
         L     @01,BFTBLPTR                                        0817
         ALR   @01,@04                                             0817
         LR    @04,INDXEXTS                                        0817
         MH    @04,@CH01851                                        0817
         L     @15,GVSNEPTR                                        0817
         ALR   @15,@04                                             0817
         MVC   BFVOLEXP-18(4,@01),GVSEXPDT-20(@15)                 0817
*           ELSE                    /*                       @G24LB26*/
*                                                                  0818
*             /*******************************************************/
*             /*                                                     */
*             /* COMPARE EXTENSION AND JFCB DATES            @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0818
*             IF GVSEXPDT(INDXEXTS)<EXPJFCB THEN/*           @G24LB26*/
         B     @RC00814                                            0818
@RF00814 LR    @04,INDXEXTS                                        0818
         MH    @04,@CH01851                                        0818
         L     @01,GVSNEPTR                                        0818
         ALR   @01,@04                                             0818
         CLC   GVSEXPDT-20(4,@01),EXPJFCB                          0818
         BNL   @RF00818                                            0818
*               INTERCC=RCFOUR;     /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 0819
*             ELSE                  /*                       @G24LB26*/
*               BFVOLEXP(INDXBFTB)=GVSEXPDT(INDXEXTS);/*     @G24LB26
*                                      EXPIR DATE IN BEST FIT      0820
*                                                            @G24LB26*/
         B     @RC00818                                            0820
@RF00818 LR    @04,INDXBFTB                                        0820
         MH    @04,@CH02240                                        0820
         L     @01,BFTBLPTR                                        0820
         ALR   @01,@04                                             0820
         LR    @04,INDXEXTS                                        0820
         MH    @04,@CH01851                                        0820
         L     @15,GVSNEPTR                                        0820
         ALR   @15,@04                                             0820
         MVC   BFVOLEXP-18(4,@01),GVSEXPDT-20(@15)                 0820
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00006 DS    0H                                                  0823
@EF00006 DS    0H                                                  0823
@ER00006 L     @14,@SA00006                                        0823
         BR    @14                                                 0823
*   END EXPIRCK;                    /*                       @G24LB26*/
         B     @EL00006                                            0824
*                                                                  0825
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - DATES                                   @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - CALCULATES A JULIAN EXPIRATION DATE GIVEN THE @G24LB26*/
*/*            RETENTION PERIOD FOR A GROUP.                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - CURRENT DATE FROM CVT, RETENTION PERIOD FROM     @G24LB26*/
*/*         GROUP RECORD.                                    @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - JULIAN EXPIRATION DATE IN INTERNAL WORK AREA.   @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0825
*DATES:                                                            0825
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
DATES    ST    @14,12(,@13)                                        0825
*   RESPECIFY                                                      0826
*     REG1 RSTD;                    /*                       @G24LB26*/
*                                                                  0826
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE DATE FROM THE CVT TO BINARY.              @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*   DBLWORD=DBLWORD&&DBLWORD;       /* CLEAR DOUBLE WORD     @G24LB26
*                                      WORK AREA             @G24LB26*/
         XC    DBLWORD(8),DBLWORD                                  0827
*   DBLWORD(5:8)=CVTDATE;           /* PLACE PACKED DECIMAL  @G24LB26
*                                      DATE IN WORK AREA     @G24LB26*/
         L     @04,CVTPTR                                          0828
         MVC   DBLWORD+4(4),CVTDATE(@04)                           0828
*   CVB(REG1,DBLWORD);              /* CONVERT DATE BINARY   @G24LB26*/
         CVB   REG1,DBLWORD                                        0829
*   YEAR=REG1/DATSEP;               /* EXTRACT YEARS         @G24LB26*/
         LA    @04,1000                                            0830
         LR    @14,REG1                                            0830
         SRDA  @14,32                                              0830
         DR    @14,@04                                             0830
         LR    YEAR,@15                                            0830
*   DAY=REG1//DATSEP;               /* EXTRACT DAYS          @G24LB26*/
*                                                                  0831
         LR    @14,REG1                                            0831
         SRDA  @14,32                                              0831
         DR    @14,@04                                             0831
         LR    DAY,@14                                             0831
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD THE RETENTION PERIOD FOR THE GROUP TO THE DAYS.   @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0832
*   DAY=DAY+GRORETPD;               /*                       @G24LB26*/
         L     @04,GROUPPTR                                        0832
         AL    DAY,GRORETPD(,@04)                                  0832
*   DATEEXIT=OFF;                   /* SET OUTSIDE LOOP      @G24LB26
*                                      SWITCH                @G24LB26*/
*                                                                  0833
         NI    DATEEXIT,B'11111011'                                0833
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU CHANGING DAYS TO YEARS UNTIL DATE IN        @G24LB26*/
*   /* PROPER FORMAT.                                        @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0834
*   DO WHILE DATEEXIT=OFF;          /*                       @G24LB26*/
*                                                                  0834
         B     @DE00834                                            0834
@DL00834 DS    0H                                                  0835
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF LEAP YEAR BY DIVIDING BY FOUR AND      @G24LB26*/
*     /* CHECKING REMAINDER.                                 @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0835
*     IF YEAR//FOUR=ZERO THEN       /*                       @G24LB26*/
         LR    @14,YEAR                                            0835
         SRDA  @14,32                                              0835
         D     @14,@CF00064                                        0835
         LTR   @14,@14                                             0835
         BNZ   @RF00835                                            0835
*       DO;                         /*                       @G24LB26*/
*                                                                  0836
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO DETERMINE IF MORE THAN 366 DAYS AND    @G24LB26*/
*         /* IF SO, ADD ONE YEAR AND SUBTRACT DAYS SINCE     @G24LB26*/
*         /* A LEAP YEAR WAS ENCOUNTERED.                    @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0837
*         IF DAY>DAYLEPYR THEN      /*                       @G24LB26*/
*                                                                  0837
         LA    @04,366                                             0837
         CR    DAY,@04                                             0837
         BNH   @RF00837                                            0837
*           /*********************************************************/
*           /*                                                       */
*           /* SUBTRACT NUMBER OF DAYS IN A LEAP YEAR AND    @G24LB26*/
*           /* ADD ONE TO YEAR. THEN LOOP BACK TO SEE IF     @G24LB26*/
*           /* ANOTHER YEAR CAN BE ADDED.                    @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0838
*           DO;                     /*                       @G24LB26*/
*             DAY=DAY-DAYLEPYR;     /* SUBTRACT 366 DAYS     @G24LB26*/
         SLR   DAY,@04                                             0839
*             YEAR=YEAR+ONE;        /* INCREMENT YEAR        @G24LB26*/
         AL    YEAR,@CF00043                                       0840
*           END;                    /*                       @G24LB26*/
*                                                                  0841
*         /***********************************************************/
*         /*                                                         */
*         /* IF DAYS LESS THAN DAYS IN YEAR THAN JOB         @G24LB26*/
*         /* IS FINISHED.                                    @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0842
*         ELSE                      /*                       @G24LB26*/
*           DATEEXIT=ON;            /* GET OUT OF LOOP       @G24LB26*/
         B     @RC00837                                            0842
@RF00837 OI    DATEEXIT,B'00000100'                                0842
*       END;                        /*                       @G24LB26*/
*                                                                  0843
*     /***************************************************************/
*     /*                                                             */
*     /* SINCE FOUR DID NOT DIVIDE YEAR EVENLY, IT IS        @G24LB26*/
*     /* NO A LEAP YEAR, SO PROCESS FOR NORMAL YEAR.         @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0844
*     ELSE                          /*                       @G24LB26*/
*       IF DAY>DAYNRMYR THEN        /*                       @G24LB26*/
*                                                                  0844
         B     @RC00835                                            0844
@RF00835 LA    @04,365                                             0844
         CR    DAY,@04                                             0844
         BNH   @RF00844                                            0844
*         /***********************************************************/
*         /*                                                         */
*         /* IF THERE ARE MORE THAN 365 DAYS, SUBTRACT       @G24LB26*/
*         /* 365 FROM DAYS AND ADD ONE TO YEAR. THEN GO      @G24LB26*/
*         /* BACK AND SEE IF ANY MORE DAYS CAN BE            @G24LB26*/
*         /* SUBTRACTED.                                     @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0845
*         DO;                       /*                       @G24LB26*/
*           DAY=DAY-DAYNRMYR;       /*                       @G24LB26*/
         SLR   DAY,@04                                             0846
*           YEAR=YEAR+ONE;          /*                       @G24LB26*/
         AL    YEAR,@CF00043                                       0847
*         END;                      /*                       @G24LB26*/
*                                                                  0848
*     /***************************************************************/
*     /*                                                             */
*     /* IF LESS THAN 365 DAYS, THEN JOB IS FINISH           @G24LB26*/
*     /* TO DROP OUT OF LOOP.                                @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0849
*       ELSE                        /*                       @G24LB26*/
*         DATEEXIT=ON;              /* GET OUT OF LOOP       @G24LB26*/
         B     @RC00844                                            0849
@RF00844 OI    DATEEXIT,B'00000100'                                0849
*   END;                            /*                       @G24LB26*/
*                                                                  0850
@RC00844 DS    0H                                                  0850
@RC00835 DS    0H                                                  0850
@DE00834 TM    DATEEXIT,B'00000100'                                0850
         BZ    @DL00834                                            0850
*   /*****************************************************************/
*   /*                                                               */
*   /* MULTIPLY YEARS BY 1000 SO THAT DAYS AND YEARS CAN     @G24LB26*/
*   /* BE COMBINED TO BE CONVERTED TO PACKED DECIMAL         @G24LB26*/
*   /* IN JULIAN FORMAT.                                     @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0851
*   REG1=YEAR*DATSEP;               /* MOVE YEAR TO PROPER   @G24LB26
*                                      LOCATION              @G24LB26*/
         LR    REG1,YEAR                                           0851
         MH    REG1,@CH02014                                       0851
*   REG1=REG1+DAY;                  /* PUT DAYS INTO DATE    @G24LB26*/
         ALR   REG1,DAY                                            0852
*   CVD(REG1,DBLWORD);              /* CONVERT TO DECIMAL    @G24LB26*/
*                                                                  0853
         CVD   REG1,DBLWORD                                        0853
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE NEW DATE INTO INTERNAL WORK AREA.                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0854
*   EXPIRDT=DBLWORD(5:8);           /*                       @G24LB26*/
         MVC   EXPIRDT(4),DBLWORD+4                                0854
*   RESPECIFY                                                      0855
*     REG1 UNRSTD;                  /*                       @G24LB26*/
*                                                                  0855
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALCULATED DATE IS GREATER THAN THE MAXIMUM    @G24LB26*/
*   /* ALLOWED DATE, THEN SET IT TO THE MAXIMUM ALLOWED DATE @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0856
*   IF EXPIRDT>MAXDATE THEN         /*                       @G24LB26*/
         CLC   EXPIRDT(4),MAXDATE                                  0856
         BNH   @RF00856                                            0856
*     EXPIRDT=MAXDATE;              /*                       @G24LB26*/
         MVC   EXPIRDT(4),MAXDATE                                  0857
*   RETURN;                         /*                       @G24LB26*/
@EL00007 DS    0H                                                  0858
@EF00007 DS    0H                                                  0858
@ER00007 L     @14,12(,@13)                                        0858
         BR    @14                                                 0858
*   END DATES;                      /*                       @G24LB26*/
         B     @EL00007                                            0859
*                                                                  0860
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - SPACONV                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - IF SPACE IS NOT SPECIFIED IN THE JFCB, THE    @G24LB26*/
*/*            ROUTINE TAKES THE DEFAULT GROUP SPACE OUT     @G24LB26*/
*/*            OF THE GROUP RECORD AND PUTS THIS INTO THE    @G24LB26*/
*/*            INTERNAL WORK AREA AND INTO THE JFCB. IF      @G24LB26*/
*/*            SPACE IS SPECIFIED IN THE JFCB, THE ROUTINE   @G24LB26*/
*/*            CONVERTS IT TO CYLINDERS IF IT IS NOT         @G24LB26*/
*/*            SPECIFIED IN CYLINDERS. IF MORE THAN ONE      @G24LB26*/
*/*            VOLUME IS BEING SELECTED, IT ALSO CONVERTS    @G24LB26*/
*/*            SECONDARY SPACE TO CYLINDERS IF IT IS NOT     @G24LB26*/
*/*            ALREADY SPECIFIED IN CYLINDERS. THIS SPACE    @G24LB26*/
*/*            IN CYLINDERS IS PLACED IN THE INTERNAL WORK   @G24LB26*/
*/*            AREA TO BE USED IN LATER PROCESSING.          @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE NUMBER OF VOLUMES BEING SELECTED FOR THE     @G24LB26*/
*/*         REQUEST. THIS VALUE WILL ALWAYS BE ONE IF        @G24LB26*/
*/*         CONVERTING SPACE FOR A VOLREF REQUEST, THE       @G24LB26*/
*/*         JFCB AND GROUP RECORD.                           @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - THE PRIMARY AND SECONDARY SPACE DEFAULT IN      @G24LB26*/
*/*          THE JFCB AND INTERNAL WORK AREA IF NONE WAS     @G24LB26*/
*/*          GIVEN IN THE JFCB. IF SPACE IS IN THE JFCB,     @G24LB26*/
*/*          CONVERTED PRIMARY IS PLACED IN THE INTERNAL     @G24LB26*/
*/*          WORK AREA. IF MORE THAN ONE VOLUME IS TO BE     @G24LB26*/
*/*          SELECTED THE SECONDARY SPACE ALLOCATION IS      @G24LB26*/
*/*          ALSO CONVERTED TO CYLINDERS AND PLACED IN THE   @G24LB26*/
*/*          INTERNAL WORK AREA.                             @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0860
*SPACONV:                                                          0860
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  0860
SPACONV  ST    @14,12(,@13)                                        0860
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF SPACE WAS SPECIFIED IN THE JFCB AND      @G24LB26*/
*   /* IF IT WAS NOT, PLACE THE DEFAULT SPACE FOR THE GROUP  @G24LB26*/
*   /* IN THE JFCB AND INTERNAL WORK AREAS.                  @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*   IF PQTY=ZERO&SQTY=ZERO&JFCBSPAC=NOSPACE&/*               @G24LB26*/
*       JFCBABST=ZERO THEN          /*                       @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0861
         ICM   @15,7,PQTY(@04)                                     0861
         BNZ   @RF00861                                            0861
         ICM   @15,7,SQTY(@04)                                     0861
         BNZ   @RF00861                                            0861
         TM    JFCBSPAC(@04),B'11000000'                           0861
         BNZ   @RF00861                                            0861
         LH    @15,JFCBABST(,@04)                                  0861
         LTR   @15,@15                                             0861
         BNZ   @RF00861                                            0861
*     DO;                           /*                       @G24LB26*/
*       PQTY=GROPSPD;               /* PRIMARY SPACE IN CYL  @G24LB26*/
         L     @15,GROUPPTR                                        0863
         LH    @14,GROPSPD(,@15)                                   0863
         STCM  @14,7,PQTY(@04)                                     0863
*       SQTY=GROSSPD;               /* SECONDARY SPACE IN CYL      0864
*                                                            @G24LB26*/
         LH    @14,GROSSPD(,@15)                                   0864
         STCM  @14,7,SQTY(@04)                                     0864
*       JFCBSPAC=DBLON;             /* INDICATE SPACE IN CYL @G24LB26*/
*                                                                  0865
         OI    JFCBSPAC(@04),B'11000000'                           0865
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF GROUP DEFAULT IS FOR RELEASE OF UNUSED   @G24LB26*/
*       /* SPACE. IF IT IS, SET INDICATOR IN JFCB.           @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0866
*       IF GRORLSE=ON THEN          /*                       @G24LB26*/
         TM    GRORLSE(@15),B'00001000'                            0866
         BNO   @RF00866                                            0866
*         JFCRLSE=DBLON;            /* RELEASE UNUSED SPACE  @G24LB26*/
         OI    JFCRLSE(@04),B'11000000'                            0867
*       PRICYL=GROPSPD;             /* SET INTERNAL PRIMARY  @G24LB26*/
@RF00866 L     @04,GROUPPTR                                        0868
         LH    @15,GROPSPD(,@04)                                   0868
         STH   @15,PRICYL                                          0868
*       SECCYL=GROSSPD;             /* SET INTERNAL SECONDARY      0869
*                                                            @G24LB26*/
         LH    @04,GROSSPD(,@04)                                   0869
         STH   @04,SECCYL                                          0869
*     END;                          /*                       @G24LB26*/
*                                                                  0870
*   /*****************************************************************/
*   /*                                                               */
*   /* SINCE SPACE WAS SPECIFIED IN THE JFCB, CONVERT IT     @G24LB26*/
*   /* TO CYLINDERS IF NECESSARY.                            @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0871
*   ELSE                            /*                       @G24LB26*/
*     DO;                           /*                       @G24LB26*/
*                                                                  0871
         B     @RC00861                                            0871
@RF00861 DS    0H                                                  0872
*       /*************************************************************/
*       /*                                                           */
*       /* IF SPACE ALLOCATED IN CYLINDERS, THEN JUST COPY   @G24LB26*/
*       /* IT TO INTERNAL PARAMETER AREA, NO CONVERSION      @G24LB26*/
*       /* NECESSARY.                                        @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0872
*       IF JFCBSPAC=DBLON THEN      /*                       @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0872
         TM    JFCBSPAC(@04),B'11000000'                           0872
         BNO   @RF00872                                            0872
*         DO;                       /*                       @G24LB26*/
*           PRICYL=PQTY;            /* PRIMARY IN CYL        @G24LB26*/
*                                                                  0874
         MVC   PRICYL(2),PQTY+1(@04)                               0874
*           /*********************************************************/
*           /*                                                       */
*           /* IF MULTI-VOLUME REQUEST, SET SECONDARY SPACE  @G24LB26*/
*           /* IN CYLINDERS.                                 @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0875
*           IF NUMBVOL>ONE THEN     /*                       @G24LB26*/
         CLI   NUMBVOL,1                                           0875
         BNH   @RF00875                                            0875
*             SECCYL=SQTY;          /*                       @G24LB26*/
         MVC   SECCYL(2),SQTY+1(@04)                               0876
*         END;                      /*                       @G24LB26*/
*       ELSE                        /*                       @G24LB26*/
*                                                                  0878
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE IF SPACE WAS ALLOCATED IN TRACKS AND  @G24LB26*/
*         /* IF IT WAS, CONVERT IT TO CYLINDERS.             @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0878
*         IF JFCBSPAC=TRKALLOC THEN /*                       @G24LB26*/
         B     @RC00872                                            0878
@RF00872 L     @04,JFCBPTR(,SELTMPTR)                              0878
         TM    JFCBSPAC(@04),B'10000000'                           0878
         BNO   @RF00878                                            0878
         TM    JFCBSPAC(@04),B'01000000'                           0878
         BNZ   @RF00878                                            0878
*           DO;                     /*                       @G24LB26*/
*                                                                  0879
*             /*******************************************************/
*             /*                                                     */
*             /* IF TRACKS ARE NOT AN EVEN MULTIPLE OF       @G24LB26*/
*             /* CYLINDERS, ROUND CYLINDERS UP ONE.          @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0880
*             IF PQTY//TRKCYL>ZERO THEN/*                    @G24LB26*/
         SLR   @00,@00                                             0880
         ICM   @00,7,PQTY(@04)                                     0880
         SRDA  @00,32                                              0880
         D     @00,@CF02038                                        0880
         LTR   @00,@00                                             0880
         BNP   @RF00880                                            0880
*               ROUND=ONE;          /* ROUND UP ONE CYL      @G24LB26*/
         LA    ROUND,1                                             0881
*             ELSE                  /*                       @G24LB26*/
*               ROUND=ZERO;         /* NO ROUND UP REQUIRED  @G24LB26*/
*                                                                  0882
         B     @RC00880                                            0882
@RF00880 SLR   ROUND,ROUND                                         0882
*             /*******************************************************/
*             /*                                                     */
*             /* CALCULATE PRIMARY SPACE IN CYLINDERS        @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0883
*             PRICYL=(PQTY/TRKCYL)+ROUND;/*                  @G24LB26*/
*                                                                  0883
@RC00880 LA    @04,19                                              0883
         L     @03,JFCBPTR(,SELTMPTR)                              0883
         SLR   @01,@01                                             0883
         ICM   @01,7,PQTY(@03)                                     0883
         SLR   @00,@00                                             0883
         DR    @00,@04                                             0883
         ALR   @01,ROUND                                           0883
         STH   @01,PRICYL                                          0883
*             /*******************************************************/
*             /*                                                     */
*             /* CALCULATE SECONDARY SPACE ONLY IF THIS IS   @G24LB26*/
*             /* A MULTI-VOLUME DATA SET REQUEST.            @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0884
*             IF NUMBVOL>ONE THEN   /*                       @G24LB26*/
         CLI   NUMBVOL,1                                           0884
         BNH   @RF00884                                            0884
*               DO;                 /*                       @G24LB26*/
*                                                                  0885
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE SECONDARY SPACE IN CYLINDERS. @G24LB26*/
*                 /* FIRST DETERMINE ROUND OFF FACTOR.       @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0886
*                 IF SQTY//TRKCYL>ZERO THEN/*                @G24LB26*/
         SLR   @00,@00                                             0886
         ICM   @00,7,SQTY(@03)                                     0886
         SRDA  @00,32                                              0886
         DR    @00,@04                                             0886
         LTR   @00,@00                                             0886
         BNP   @RF00886                                            0886
*                   ROUND=ONE;      /* ROUND UP ONE CYL      @G24LB26*/
         LA    ROUND,1                                             0887
*                 ELSE              /*                       @G24LB26*/
*                   ROUND=ZERO;     /* NO ROUND UP REQUIRED  @G24LB26*/
*                                                                  0888
         B     @RC00886                                            0888
@RF00886 SLR   ROUND,ROUND                                         0888
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE SECONDARY SPACE               @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0889
*                 SECCYL=(SQTY/TRKCYL)+ROUND;/*              @G24LB26*/
@RC00886 L     @04,JFCBPTR(,SELTMPTR)                              0889
         SLR   @01,@01                                             0889
         ICM   @01,7,SQTY(@04)                                     0889
         SLR   @00,@00                                             0889
         D     @00,@CF02038                                        0889
         ALR   @01,ROUND                                           0889
         STH   @01,SECCYL                                          0889
*               END;                /*                       @G24LB26*/
*           END;                    /*                       @G24LB26*/
*                                                                  0891
*       /*************************************************************/
*       /*                                                           */
*       /* IF SPACE NOT IN CYLINDERS OR TRACKS, IT MUST      @G24LB26*/
*       /* BE IN BLOCKS.                                     @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0892
*         ELSE                      /*                       @G24LB26*/
*                                                                  0892
*           /*********************************************************/
*           /*                                                       */
*           /* CALCULATE SPACE IN CYLINDERS FROM BLOCKS      @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0892
*           DO;                     /*                       @G24LB26*/
*                                                                  0892
         B     @RC00878                                            0892
@RF00878 DS    0H                                                  0893
*             /*******************************************************/
*             /*                                                     */
*             /* CALCULATE RECORD LENGTH FOR CONVERTING      @G24LB26*/
*             /* TO CYLINDERS.                               @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0893
*             IF KEYLEN>ZERO THEN   /* DOES REC HAVE A KEY?  @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0893
         CLI   KEYLEN(@04),0                                       0893
         BNH   @RF00893                                            0893
*               RECLEN=CON191+KEYLEN+DRLH;/* AVERAGE REC     @G24LB26
*                                      LENGTH WITH KEY       @G24LB26*/
         L     @15,JFCBPTR(,SELTMPTR)                              0894
         LA    RECLEN,191                                          0894
         SLR   @14,@14                                             0894
         IC    @14,KEYLEN(,@15)                                    0894
         ALR   RECLEN,@14                                          0894
         SLR   @14,@14                                             0894
         ICM   @14,7,DRLH(@15)                                     0894
         ALR   RECLEN,@14                                          0894
*             ELSE                  /*                       @G24LB26*/
*               RECLEN=CON135+DRLH; /* AVERAGE REC LENGTH    @G24LB26
*                                      WITHOUT KEY           @G24LB26*/
*                                                                  0895
         B     @RC00893                                            0895
@RF00893 L     @01,JFCBPTR(,SELTMPTR)                              0895
         LA    RECLEN,135                                          0895
         SLR   @00,@00                                             0895
         ICM   @00,7,DRLH(@01)                                     0895
         ALR   RECLEN,@00                                          0895
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF TRACK OVERFLOW EXISTS BY       @G24LB26*/
*             /* FLAG AND NUMBER OF RECORDS THAT CAN FIT     @G24LB26*/
*             /* ON ONE TRACK.                               @G24LB26*/
*             /* THE ASSUMPTION IS BEING MADE IN THIS        @G24LB26*/
*             /* ALGORYTHM, THAT WHEN A TRACK OVERFLOW       @G24LB26*/
*             /* SITUATION EXISTS, AN OVERFLOW WILL OCCUR    @G24LB26*/
*             /* FOR EACH TRACK EXCEPT WHERE THE RECORD      @G24LB26*/
*             /* LENGTH IS EXACTLY 13030 BYTES, NOT          @G24LB26*/
*             /* INCLUDING RECORD OVERHEAD.                  @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0896
*             RECORDS=TRKCAPTY/RECLEN;/*                     @G24LB26*/
@RC00893 L     @00,@CF02042                                        0896
         SRDA  @00,32                                              0896
         DR    @00,RECLEN                                          0896
         LR    RECORDS,@01                                         0896
*             IF JFCRFO=ONRECORDS=ZERO THEN/* TRACK         @G24LB26
*                                      OVERFLOW?             @G24LB26*/
         L     @02,JFCBPTR(,SELTMPTR)                              0897
         TM    JFCRFO(@02),B'00100000'                             0897
         BO    @RT00897                                            0897
         LTR   RECORDS,RECORDS                                     0897
         BNZ   @RF00897                                            0897
@RT00897 DS    0H                                                  0898
*               DO;                 /*                       @G24LB26*/
*                                                                  0898
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE THE NUMBER OF PRIMARY BYTES   @G24LB26*/
*                 /* TO BE ALLOCATED WITH TRACK OVERFLOW     @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0899
*                 PRIBYTES=RECLEN*PQTY;/*                    @G24LB26*/
*                                                                  0899
         L     @01,JFCBPTR(,SELTMPTR)                              0899
         SLR   PRIBYTES,PRIBYTES                                   0899
         ICM   PRIBYTES,7,PQTY(@01)                                0899
         MR    @02,RECLEN                                          0899
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE ROUND OFF FOR SPACE TO TRACKS @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0900
*                 IF RECLEN=TRKCAPTY THEN/*                  @G24LB26*/
         C     RECLEN,@CF02042                                     0900
         BNE   @RF00900                                            0900
*                   ROUND=ZERO;     /*                       @G24LB26*/
         SLR   ROUND,ROUND                                         0901
*                 ELSE              /*                       @G24LB26*/
*                                                                  0902
*                   /*************************************************/
*                   /*                                               */
*                   /* TRACK OVERFLOW EXISTS, SO USE THE     @G24LB26*/
*                   /* OVERFLOW TRACK CAPACITY TO DETERMINE  @G24LB26*/
*                   /* ROUNDING FACTOR                       @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0902
*                   IF PRIBYTES//TRKOFCAP>ZERO THEN/*        @G24LB26*/
         B     @RC00900                                            0902
@RF00900 LR    @00,PRIBYTES                                        0902
         SRDA  @00,32                                              0902
         D     @00,@CF02040                                        0902
         LTR   @00,@00                                             0902
         BNP   @RF00902                                            0902
*                     ROUND=ONE;    /*                       @G24LB26*/
         LA    ROUND,1                                             0903
*                   ELSE            /*                       @G24LB26*/
*                     ROUND=ZERO;   /*                       @G24LB26*/
*                                                                  0904
         B     @RC00902                                            0904
@RF00902 SLR   ROUND,ROUND                                         0904
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE THE NUMBER OF PRIMARY TRACKS  @G24LB26*/
*                 /* NO OVERFLOW WILL REALLY OCCURE          @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0905
*                 IF RECLEN=TRKCAPTY THEN/*                  @G24LB26*/
@RC00902 DS    0H                                                  0905
@RC00900 L     @15,@CF02042                                        0905
         CR    RECLEN,@15                                          0905
         BNE   @RF00905                                            0905
*                   PRICYL=(PRIBYTES/TRKCAPTY)+ROUND;/*      @G24LB26*/
*                                                                  0906
         LR    @00,PRIBYTES                                        0906
         SRDA  @00,32                                              0906
         DR    @00,@15                                             0906
         ALR   @01,ROUND                                           0906
         STH   @01,PRICYL                                          0906
*                 /***************************************************/
*                 /*                                                 */
*                 /* OVERFLOW WILL REALLY TAKE PLACE         @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0907
*                 ELSE              /*                       @G24LB26*/
*                   PRICYL=(PRIBYTES/TRKOFCAP)+ROUND;/*      @G24LB26*/
*                                                                  0907
         B     @RC00905                                            0907
@RF00905 LR    @00,PRIBYTES                                        0907
         SRDA  @00,32                                              0907
         D     @00,@CF02040                                        0907
         ALR   @01,ROUND                                           0907
         STH   @01,PRICYL                                          0907
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE ROUND OFF FACTOR FROM TRACKS  @G24LB26*/
*                 /* TO CYLINDERS                            @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0908
*                 IF PRICYL//TRKCYL>ZERO THEN/*              @G24LB26*/
@RC00905 LH    @00,PRICYL                                          0908
         SRDA  @00,32                                              0908
         D     @00,@CF02038                                        0908
         LTR   @00,@00                                             0908
         BNP   @RF00908                                            0908
*                   ROUND=ONE;      /* ROUND UP NECESSARY    @G24LB26*/
         LA    ROUND,1                                             0909
*                 ELSE              /*                       @G24LB26*/
*                   ROUND=ZERO;     /* NO ROUND UP NECESSARY @G24LB26*/
*                                                                  0910
         B     @RC00908                                            0910
@RF00908 SLR   ROUND,ROUND                                         0910
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE PRIMARY SPACE IN CYLINDERS    @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0911
*                 PRICYL=(PRICYL/TRKCYL)+ROUND;/*            @G24LB26*/
*                                                                  0911
@RC00908 LH    @00,PRICYL                                          0911
         SRDA  @00,32                                              0911
         D     @00,@CF02038                                        0911
         ALR   @01,ROUND                                           0911
         STH   @01,PRICYL                                          0911
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK TO DETERMINE IF SECONDARY SPACE   @G24LB26*/
*                 /* NEEDS CALCULATING FOR REQUEST WITH      @G24LB26*/
*                 /* TRACK OVERFLOW.                         @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0912
*                 IF NUMBVOL>ONE THEN/*                      @G24LB26*/
         CLI   NUMBVOL,1                                           0912
         BNH   @RF00912                                            0912
*                   DO;             /*                       @G24LB26*/
*                                                                  0913
*                     /***********************************************/
*                     /*                                             */
*                     /* CALCULATE THE NUMBER OF SECONDARY   @G24LB26*/
*                     /* BYTES TO BE ALLOCATED.              @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0914
*                     SECBYTES=RECLEN*SQTY;/*                @G24LB26*/
*                                                                  0914
         L     @01,JFCBPTR(,SELTMPTR)                              0914
         SLR   SECBYTES,SECBYTES                                   0914
         ICM   SECBYTES,7,SQTY(@01)                                0914
         MR    @02,RECLEN                                          0914
*                     /***********************************************/
*                     /*                                             */
*                     /* DETERMINE SECONDARY ROUND OFF FOR   @G24LB26*/
*                     /* SPACE TO TRACKS.                    @G24LB26*/
*                     /* THE ASSUMPTION IS BEING MADE IN     @G24LB26*/
*                     /* THIS ALGORYTHM, THAT WHEN A TRACK   @G24LB26*/
*                     /* OVERFLOW SITUATION EXISTS, AN       @G24LB26*/
*                     /* OVERFLOW WILL OCCUR FOR EACH TRACK  @G24LB26*/
*                     /* EXCEPT WHERE THE RECORD LENGTH IS   @G24LB26*/
*                     /* EXACTLY 13030 BYTES, NOT INCLUDING  @G24LB26*/
*                     /* RECORD OVERHEAD.                    @G24LB26*/
*                     /* DETERMINE IF REALLY OVERFLOW        @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0915
*                     IF RECLEN=TRKCAPTY THEN/*              @G24LB26*/
         C     RECLEN,@CF02042                                     0915
         BNE   @RF00915                                            0915
*                       ROUND=ZERO; /* NO ROUND UP NECESSARY @G24LB26*/
*                                                                  0916
         SLR   ROUND,ROUND                                         0916
*                     /***********************************************/
*                     /*                                             */
*                     /* TRACK OVERFLOW REALLY OCCURES       @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0917
*                     ELSE          /*                       @G24LB26*/
*                       IF SECBYTES//TRKOFCAP>ZERO THEN/*    @G24LB26*/
         B     @RC00915                                            0917
@RF00915 LR    @00,SECBYTES                                        0917
         SRDA  @00,32                                              0917
         D     @00,@CF02040                                        0917
         LTR   @00,@00                                             0917
         BNP   @RF00917                                            0917
*                         ROUND=ONE;/* ROUND UP ONE TRACK    @G24LB26*/
         LA    ROUND,1                                             0918
*                       ELSE        /*                       @G24LB26*/
*                         ROUND=ZERO;/* NO ROUND UP          @G24LB26*/
*                                                                  0919
         B     @RC00917                                            0919
@RF00917 SLR   ROUND,ROUND                                         0919
*                     /***********************************************/
*                     /*                                             */
*                     /* CALCULATE NUMBER OF SECONDARY       @G24LB26*/
*                     /* TRACKS WHEN                         @G24LB26*/
*                     /* OVERFLOW DOES NOT REALLY OCCURE     @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0920
*                     IF RECLEN=TRKCAPTY THEN/*              @G24LB26*/
@RC00917 DS    0H                                                  0920
@RC00915 L     @15,@CF02042                                        0920
         CR    RECLEN,@15                                          0920
         BNE   @RF00920                                            0920
*                       SECCYL=(SECBYTES/TRKCAPTY)+ROUND;/*  @G24LB26*/
*                                                                  0921
         LR    @00,SECBYTES                                        0921
         SRDA  @00,32                                              0921
         DR    @00,@15                                             0921
         ALR   @01,ROUND                                           0921
         STH   @01,SECCYL                                          0921
*                     /***********************************************/
*                     /*                                             */
*                     /* WHEN OVERFLOW SITUATION OCCURES     @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0922
*                     ELSE          /*                       @G24LB26*/
*                       SECCYL=(SECBYTES/TRKOFCAP)+ROUND;/*  @G24LB26*/
*                                                                  0922
         B     @RC00920                                            0922
@RF00920 LR    @00,SECBYTES                                        0922
         SRDA  @00,32                                              0922
         D     @00,@CF02040                                        0922
         ALR   @01,ROUND                                           0922
         STH   @01,SECCYL                                          0922
*                     /***********************************************/
*                     /*                                             */
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/
*                     /* TRACKS TO CYLINDERS FOR SECONDARY   @G24LB26*/
*                     /* SPACE                               @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0923
*                     IF SECCYL//TRKCYL>ZERO THEN/*          @G24LB26*/
@RC00920 LH    @00,SECCYL                                          0923
         SRDA  @00,32                                              0923
         D     @00,@CF02038                                        0923
         LTR   @00,@00                                             0923
         BNP   @RF00923                                            0923
*                       ROUND=ONE;  /* ROUND UP REQUIRED     @G24LB26*/
         LA    ROUND,1                                             0924
*                     ELSE          /*                       @G24LB26*/
*                       ROUND=ZERO; /* NO ROUND UP REQUIRED  @G24LB26*/
*                                                                  0925
         B     @RC00923                                            0925
@RF00923 SLR   ROUND,ROUND                                         0925
*                     /***********************************************/
*                     /*                                             */
*                     /* CALCULATE SECONDARY SPACE IN        @G24LB26*/
*                     /* CYLINDERS                           @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0926
*                     SECCYL=(SECCYL/TRKCYL)+ROUND;/*        @G24LB26*/
@RC00923 LH    @00,SECCYL                                          0926
         SRDA  @00,32                                              0926
         D     @00,@CF02038                                        0926
         ALR   @01,ROUND                                           0926
         STH   @01,SECCYL                                          0926
*                   END;            /*                       @G24LB26*/
*               END;                /*                       @G24LB26*/
*                                                                  0928
*             /*******************************************************/
*             /*                                                     */
*             /* NO TRACK OVERFLOW CALCULATIONS              @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0929
*             ELSE                  /*                       @G24LB26*/
*                                                                  0929
*               /*****************************************************/
*               /*                                                   */
*               /* SINCE THE NUMBER OF RECORDS THAT WILL FIT @G24LB26*/
*               /* ON A TRACK HAS ALREADY BEEN CALCULATED    @G24LB26*/
*               /* AND FOUND TO BE ONE OR GREATER, WE CAN    @G24LB26*/
*               /* PROCEED WITH THE NO TRACK OVERFLOW        @G24LB26*/
*               /* SITUATION.                                @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0929
*               DO;                 /*                       @G24LB26*/
*                                                                  0929
         B     @RC00897                                            0929
@RF00897 DS    0H                                                  0930
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE ROUND OFF FACTOR WHEN         @G24LB26*/
*                 /* CONVERTING TO TRACKS                    @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0930
*                 IF PQTY//RECORDS>ZERO THEN/*               @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0930
         SLR   @00,@00                                             0930
         ICM   @00,7,PQTY(@04)                                     0930
         SRDA  @00,32                                              0930
         DR    @00,RECORDS                                         0930
         LTR   @00,@00                                             0930
         BNP   @RF00930                                            0930
*                   ROUND=ONE;      /* ROUND UP ONE TRACK    @G24LB26*/
         LA    ROUND,1                                             0931
*                 ELSE              /*                       @G24LB26*/
*                   ROUND=ZERO;     /* NO ROUNDING UP        @G24LB26
*                                      REQUIRED              @G24LB26*/
*                                                                  0932
         B     @RC00930                                            0932
@RF00930 SLR   ROUND,ROUND                                         0932
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE NUMBER OFF PRIMARY TRACKS FOR @G24LB26*/
*                 /* NO OVERFLOW CONDITION.                  @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0933
*                 PRICYL=(PQTY/RECORDS)+ROUND;/*             @G24LB26*/
*                                                                  0933
@RC00930 L     @04,JFCBPTR(,SELTMPTR)                              0933
         SLR   @01,@01                                             0933
         ICM   @01,7,PQTY(@04)                                     0933
         SLR   @00,@00                                             0933
         DR    @00,RECORDS                                         0933
         ALR   @01,ROUND                                           0933
         STH   @01,PRICYL                                          0933
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE ROUND OFF FOR TRACKS TO       @G24LB26*/
*                 /* CYLINDERS                               @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0934
*                 IF PRICYL//TRKCYL>ZERO THEN/*              @G24LB26*/
         LR    @14,@01                                             0934
         SRDA  @14,32                                              0934
         D     @14,@CF02038                                        0934
         LTR   @14,@14                                             0934
         BNP   @RF00934                                            0934
*                   ROUND=ONE;      /* ROUND UP ONE CYL      @G24LB26*/
         LA    ROUND,1                                             0935
*                 ELSE              /*                       @G24LB26*/
*                   ROUND=ZERO;     /* NO ROUND UP REQUIRED  @G24LB26*/
*                                                                  0936
         B     @RC00934                                            0936
@RF00934 SLR   ROUND,ROUND                                         0936
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALCULATE PRIMARY SPACE IN CYLINDERS    @G24LB26*/
*                 /* FOR NO TRACK OVERFLOW.                  @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0937
*                 PRICYL=(PRICYL/TRKCYL)+ROUND;/*            @G24LB26*/
*                                                                  0937
@RC00934 LH    @00,PRICYL                                          0937
         SRDA  @00,32                                              0937
         D     @00,@CF02038                                        0937
         ALR   @01,ROUND                                           0937
         STH   @01,PRICYL                                          0937
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE REQUEST IN MULTI-VOLUME, CONVERT @G24LB26*/
*                 /* SECONDARY SPACE TO CYLINDERS.           @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0938
*                 IF NUMBVOL>ONE THEN/*                      @G24LB26*/
         CLI   NUMBVOL,1                                           0938
         BNH   @RF00938                                            0938
*                   DO;             /*                       @G24LB26*/
*                                                                  0939
*                     /***********************************************/
*                     /*                                             */
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/
*                     /* CONVERSION TO TRACKS                @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0940
*                     IF SQTY//RECORDS>ZERO THEN/*           @G24LB26*/
         L     @04,JFCBPTR(,SELTMPTR)                              0940
         SLR   @00,@00                                             0940
         ICM   @00,7,SQTY(@04)                                     0940
         SRDA  @00,32                                              0940
         DR    @00,RECORDS                                         0940
         LTR   @00,@00                                             0940
         BNP   @RF00940                                            0940
*                       ROUND=ONE;  /*                       @G24LB26*/
         LA    ROUND,1                                             0941
*                     ELSE          /*                       @G24LB26*/
*                       ROUND=ZERO; /*                       @G24LB26*/
*                                                                  0942
         B     @RC00940                                            0942
@RF00940 SLR   ROUND,ROUND                                         0942
*                     /***********************************************/
*                     /*                                             */
*                     /* CALCULATE NUMBER OF SECONDARY       @G24LB26*/
*                     /* TRACKS FOR NO OVERFLOW CONDITION    @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0943
*                     SECCYL=(SQTY/RECORDS)+ROUND;/*         @G24LB26*/
*                                                                  0943
@RC00940 L     @04,JFCBPTR(,SELTMPTR)                              0943
         SLR   @01,@01                                             0943
         ICM   @01,7,SQTY(@04)                                     0943
         SLR   @00,@00                                             0943
         DR    @00,RECORDS                                         0943
         ALR   @01,ROUND                                           0943
         STH   @01,SECCYL                                          0943
*                     /***********************************************/
*                     /*                                             */
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/
*                     /* TRACKS TO CYLINDERS                 @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0944
*                     IF SECCYL//TRKCYL>ZERO THEN/*          @G24LB26*/
         LR    @02,@01                                             0944
         SRDA  @02,32                                              0944
         D     @02,@CF02038                                        0944
         LTR   @02,@02                                             0944
         BNP   @RF00944                                            0944
*                       ROUND=ONE;  /* ROUND UP ONE CYL      @G24LB26*/
         LA    ROUND,1                                             0945
*                     ELSE          /*                       @G24LB26*/
*                       ROUND=ZERO; /* NO ROUND OFF REQUIRED @G24LB26*/
*                                                                  0946
         B     @RC00944                                            0946
@RF00944 SLR   ROUND,ROUND                                         0946
*                     /***********************************************/
*                     /*                                             */
*                     /* CALCULATE SECONDARY SPACE IN        @G24LB26*/
*                     /* CYLINDERS FOR NO TRACK OVERFLOW     @G24LB26*/
*                     /* CONDITION.                          @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0947
*                     SECCYL=(SECCYL/TRKCYL)+ROUND;/*        @G24LB26*/
@RC00944 LH    @00,SECCYL                                          0947
         SRDA  @00,32                                              0947
         D     @00,@CF02038                                        0947
         ALR   @01,ROUND                                           0947
         STH   @01,SECCYL                                          0947
*                   END;            /*                       @G24LB26*/
*               END;                /*                       @G24LB26*/
*           END;                    /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00008 DS    0H                                                  0952
@EF00008 DS    0H                                                  0952
@ER00008 L     @14,12(,@13)                                        0952
         BR    @14                                                 0952
*   END SPACONV;                    /*                       @G24LB26*/
         B     @EL00008                                            0953
*                                                                  0954
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - SPACECK                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCITON - DETERMINES IF THERE IS ENOUGH SPACE ON A      @G24LB26*/
*/*            VOLUME FOR THE PRIMARY SPACE REQUIRED         @G24LB26*/
*/*            WITHOUT USING ANY RESERVED SPACE. IF THE      @G24LB26*/
*/*            REQUEST IS MULTI-VOLUME, THE ROUTINE          @G24LB26*/
*/*            DETERMINES IF THERE IS ENOUGH SPACE FOR ONE   @G24LB26*/
*/*            SECONDARY EXTENT NOT TAKING INTO ACCOUNT      @G24LB26*/
*/*            ANY RESERVED SPACE.                           @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - PRIMARY AND SECONDARY SPACE REQUIRED BY THE      @G24LB26*/
*/*         REQUEST AND A COUNT FIELD TO DETERMINE IF IT     @G24LB26*/
*/*         IS A MULTI-VOLUME REQUEST OR NOT. AVAILABLE      @G24LB26*/
*/*         RUNNING SPACE FROM EXTENSION RECORD. PERCENT     @G24LB26*/
*/*         RESERVED SPACE FROM THE GROUP RECORD.  ALSO      @G24LB26*/
*/*         INDEXES INTO THE EXTENSION RECORD AND THE        @G24LB26*/
*/*         BEST FIT TABLE.                                  @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - A 4 RETURN CODE IN INTERNAL WORK AREA IF        @G24LB26*/
*/*          VOLUME IS NOT ELIGIBLE FOR PRIMARY VOLUME       @G24LB26*/
*/*          AND IF MULTI-VOLUME IS NOT ELIGIBLE FOR         @G24LB26*/
*/*          SECONDARY. TURNS ON INDICATORS IN BEST FIT      @G24LB26*/
*/*          TABLE IF VOLUME IS ELIGIBLE, BUT NOT FOR        @G24LB26*/
*/*          BOTH PRIMARY AND SECONDARY.                     @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  0954
*SPACECK:                                                          0954
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
SPACECK  ST    @14,@SA00009                                        0954
*   INTERCC=RCZERO;                 /* CLEAR RETURN CODE     @G24LB26*/
         MVC   INTERCC(2),@CB02111                                 0955
*   LSPASW=OFF;                     /* INIT LOOP CONTROL     @ZA28479*/
*   SPAEXIT=OFF;                    /* INIT OTHER LOOP CNTR  @ZA28479*/
*                                                                  0957
         NI    LSPASW,B'10011111'                                  0957
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE ROUNDING FACTOR FOR RESERVED SPACE          @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0958
*   IF(GRORESSP*CYL3330V)//CONVPERC>ZERO THEN/*              @G24LB26*/
         L     @04,GROUPPTR                                        0958
         SLR   @01,@01                                             0958
         IC    @01,GRORESSP(,@04)                                  0958
         M     @00,@CF02021                                        0958
         D     @00,@CF02023                                        0958
         LTR   @00,@00                                             0958
         BNP   @RF00958                                            0958
*     ROUND=ONE;                    /*                       @G24LB26*/
         LA    ROUND,1                                             0959
*   ELSE                            /*                       @G24LB26*/
*     ROUND=ZERO;                   /*                       @G24LB26*/
*                                                                  0960
         B     @RC00958                                            0960
@RF00958 SLR   ROUND,ROUND                                         0960
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE RESERVED SPACE.                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0961
*   RESERSPA=((GRORESSP*CYL3330V)/CONVPERC)+ROUND;/*         @G24LB26*/
*                                                                  0961
@RC00958 L     @04,GROUPPTR                                        0961
         SLR   @01,@01                                             0961
         IC    @01,GRORESSP(,@04)                                  0961
         M     @00,@CF02021                                        0961
         D     @00,@CF02023                                        0961
         ALR   @01,ROUND                                           0961
         STH   @01,RESERSPA                                        0961
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THIS, PLUS THE PRIMARY SPACE REQUEST     @G24LB26*/
*   /* IS MORE THAN THE AVAILABLE FREE SPACE.                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*   TOTSPA=RESERSPA+PRICYL;         /*                       @ZA28479*/
*                                                                  0962
         AH    @01,PRICYL                                          0962
         STH   @01,TOTSPA                                          0962
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF RESERVE SPACE WOULD BE USED IF VOLUME    @G24LB26*/
*   /* WAS USED.                                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0963
*   DO WHILE SPAEXIT=OFF;           /*                       @ZA28479*/
         B     @DE00963                                            0963
@DL00963 DS    0H                                                  0964
*     IF(TOTSPA>GVSMTDSP(INDXEXTS))(JFCONTIG=ON&GVSLEXT(INDXEXTS)<
*         PRICYL)(JFCONTIG=OFF&FIVE*GVSLEXT(INDXEXTS)<PRICYL) THEN
*                                                                  0964
         L     @04,GVSNEPTR                                        0964
         LR    @15,INDXEXTS                                        0964
         MH    @15,@CH01851                                        0964
         LH    @14,TOTSPA                                          0964
         CH    @14,GVSMTDSP-20(@15,@04)                            0964
         BH    @RT00964                                            0964
         L     @01,JFCBPTR(,SELTMPTR)                              0964
         TM    JFCONTIG(@01),B'00001000'                           0964
         BNO   @GL00040                                            0964
         LH    @04,GVSLEXT-20(@15,@04)                             0964
         CH    @04,PRICYL                                          0964
         BL    @RT00964                                            0964
@GL00040 L     @04,JFCBPTR(,SELTMPTR)                              0964
         TM    JFCONTIG(@04),B'00001000'                           0964
         BNZ   @RF00964                                            0964
         LR    @04,INDXEXTS                                        0964
         MH    @04,@CH01851                                        0964
         L     @01,GVSNEPTR                                        0964
         LH    @04,GVSLEXT-20(@04,@01)                             0964
         MH    @04,@CH00087                                        0964
         CH    @04,PRICYL                                          0964
         BNL   @RF00964                                            0964
@RT00964 DS    0H                                                  0965
*       /*************************************************************/
*       /*                                                           */
*       /* TRY TO SAVE VOLUME FOR PRIMARY BY LSPACING        @ZA28479*/
*       /* IF FREE SPACE AND RUNNING SPACE ARE TWO TIMES     @ZA28479*/
*       /* THE PRIMARY REQUEST APART                         @ZA28479*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0965
*       DO;                         /*                       @ZA28479*/
*         IF(GVSFRESP(INDXEXTS)-GVSMTDSP(INDXEXTS)>TWO*PRICYL)&BFNOTMTD
*             (INDXBFTB)=OFF&BFMTDOHT(INDXBFTB)=OFF&UCBADDR^=ZEROPTR&
*             LSPASW=OFF THEN       /*                       @ZA28479*/
         L     @04,GVSNEPTR                                        0966
         LR    @15,INDXEXTS                                        0966
         MH    @15,@CH01851                                        0966
         LH    @14,GVSFRESP-20(@15,@04)                            0966
         SH    @14,GVSMTDSP-20(@15,@04)                            0966
         LH    @04,PRICYL                                          0966
         ALR   @04,@04                                             0966
         CR    @14,@04                                             0966
         BNH   @RF00966                                            0966
         LR    @04,INDXBFTB                                        0966
         MH    @04,@CH02240                                        0966
         L     @01,BFTBLPTR                                        0966
         ALR   @01,@04                                             0966
         TM    BFNOTMTD-18(@01),B'10100000'                        0966
         BNZ   @RF00966                                            0966
         L     @04,UCBADDR                                         0966
         LTR   @04,@04                                             0966
         BZ    @RF00966                                            0966
         TM    LSPASW,B'00100000'                                  0966
         BNZ   @RF00966                                            0966
*           DO;                     /*                       @ZA28479*/
*             RESPECIFY                                            0968
*              (REG0,                                              0968
*               REG1,                                              0968
*               REG15) RSTD;        /*                       @ZA28479*/
*                                                                  0968
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE LSPACE TO GET SPACE UP LEVEL          @ZA28479*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0969
*             REG0=ADDR(UCBOB);     /* SET UP UCB ADDR       @ZA28479*/
         L     REG0,UCBPTR                                         0969
*             REG1=ADDR(LSPAREA);   /* ADDR OF RETURN AREA   @ZA28479*/
         LA    REG1,LSPAREA                                        0970
*             SVC(LSPACE);          /* ISSUE LSPACE MACRO    @ZA28479*/
         SVC   78                                                  0971
*             RESPECIFY                                            0972
*              (REG0,                                              0972
*               REG1) UNRSTD;       /*                       @ZA28479*/
*             LSPASW=ON;            /* INDICATE LSPACE DONE  @ZA28479*/
*                                                                  0973
         OI    LSPASW,B'00100000'                                  0973
*             /*******************************************************/
*             /*                                                     */
*             /* IF LSPACE SUCCESSFUL, UPDATE FREE SPACE IN  @ZA28479*/
*             /* EXTENSION RECORD. ALSO LARGEST FREE EXTENT  @ZA28479*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0974
*             IF REG15=RCZERO THEN  /*                       @ZA28479*/
         LTR   REG15,REG15                                         0974
         BNZ   @RF00974                                            0974
*               DO;                 /*                       @ZA28479*/
*                 PACK(TEMPPACK,LSPFRESP);/*                 @ZA28479*/
         PACK  TEMPPACK(4),LSPFRESP(4)                             0976
*                 CVB(TEMPBIN,TEMPPACK);/*                   @ZA28479*/
         XC    @TS00001(8),@TS00001                                0977
         MVC   @TS00001+4(4),TEMPPACK                              0977
         CVB   TEMPBIN,@TS00001                                    0977
*                 GVSFRESP(INDXEXTS)=TEMPBIN;/* UPDT FREE SP @ZA28479*/
         L     @14,GVSNEPTR                                        0978
         LR    @04,INDXEXTS                                        0978
         MH    @04,@CH01851                                        0978
         STH   TEMPBIN,GVSFRESP-20(@04,@14)                        0978
*                 PACK(TEMPPACK,LSPLEXT);/*                  @ZA28479*/
         PACK  TEMPPACK(4),LSPLEXT(4)                              0979
*                 CVB(TEMPBIN,TEMPPACK);/*                   @ZA28479*/
         XC    @TS00001(8),@TS00001                                0980
         MVC   @TS00001+4(4),TEMPPACK                              0980
         CVB   TEMPBIN,@TS00001                                    0980
*                 GVSLEXT(INDXEXTS)=TEMPBIN;/* UPDT FREE SP  @ZA28479*/
*                                                                  0981
         STH   TEMPBIN,GVSLEXT-20(@04,@14)                         0981
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL TABLE PROCESSOR TO GET SCHEDULED   @ZA28479*/
*                 /* SPACE                                   @ZA28479*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0982
*                 TABP=TABP&&TABP;  /* CLEAR TABLE PARM      @ZA28479*/
         LA    @03,STRTABP                                         0982
         XC    TABP(12,@03),TABP(@03)                              0982
*                 TABFTSPC=ON;      /* SEARCH FOR VOL        @ZA28479*/
         OI    TABFTSPC(@03),B'00010000'                           0983
*                 TABVOLID=GVSVOLID(INDXEXTS);/* VOLID       @ZA28479*/
         ALR   @14,@04                                             0984
         MVC   TABVOLID(6,@03),GVSVOLID-20(@14)                    0984
*                 CALL ICBVTP00(TABP);/* CALL TABLE PROCESSOR      0985
*                                                            @ZA28479*/
         ST    @03,@AL00001                                        0985
         L     @15,@CV01914                                        0985
         LA    @01,@AL00001                                        0985
         BALR  @14,@15                                             0985
*                 GVSMTDSP(INDXEXTS)=GVSFRESP(INDXEXTS)-TABSPRET;  0986
         L     @14,GVSNEPTR                                        0986
         LR    @04,INDXEXTS                                        0986
         MH    @04,@CH01851                                        0986
         LA    @03,STRTABP                                         0986
         LH    @02,GVSFRESP-20(@04,@14)                            0986
         SH    @02,TABSPRET(,@03)                                  0986
         STH   @02,GVSMTDSP-20(@04,@14)                            0986
*                 GVSRCFSI(INDXEXTS)=OFF;/* AVAIL SPACE OK   @ZA28479*/
*                                                                  0987
         ST    @04,@TF00001                                        0987
         ALR   @04,@14                                             0987
         NI    GVSRCFSI-20(@04),B'01111111'                        0987
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK FOR NEGATIVE NUMBER               @ZA28479*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0988
*                 IF GVSMTDSP(INDXEXTS)<ZERO THEN/*          @ZA28479*/
         SLR   @04,@04                                             0988
         L     @01,@TF00001                                        0988
         CH    @04,GVSMTDSP-20(@01,@14)                            0988
         BNH   @RF00988                                            0988
*                   GVSMTDSP(INDXEXTS)=ZERO;/*               @ZA28479*/
*                                                                  0989
         L     @01,@TF00001                                        0989
         STH   @04,GVSMTDSP-20(@01,@14)                            0989
*                 /***************************************************/
*                 /*                                                 */
*                 /* INDICATE THAT EXTENSION RECORD          @ZA28479*/
*                 /* WAS UPDATED                             @ZA28479*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0990
*                 UPDTGVSN=ON;      /*                       @ZA28479*/
@RF00988 OI    UPDTGVSN,B'10000000'                                0990
*               END;                /*                       @ZA28479*/
*             ELSE                  /*                       @ZA28479*/
*                                                                  0992
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE ERROR MESSAGE, LSPACE FAILED        @ZA28479*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0992
*               DO;                 /*                       @ZA28479*/
         B     @RC00974                                            0992
@RF00974 DS    0H                                                  0993
*                 MSGRQ=MSGRQ&&MSGRQ;/* CLEAR PARM FIELD     @ZA28479*/
         XC    MSGRQ(32),MSGRQ                                     0993
*                 MSGRPLV=RPLVPTR;  /* ADDR OF REQUEST PARM  @ZA28479*/
         ST    RPLVPTR,MSGRPLV                                     0994
*                 MSGID=MSG401;     /* MSG NUMBER            @ZA28479*/
         MVC   MSGID(4),@CF02057                                   0995
*                 MSGLEN1=SIX;      /* MSG LENGTH OF INSERT  @ZA28479*/
         MVI   MSGLEN1,X'06'                                       0996
*                 MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* INSERT      0997
*                                                            @ZA28479*/
         LR    @14,INDXEXTS                                        0997
         MH    @14,@CH01851                                        0997
         L     @04,GVSNEPTR                                        0997
         LA    @14,GVSVOLID-20(@14,@04)                            0997
         STCM  @14,7,MSGTEXT1                                      0997
*                 MSGLEN2=TWO;      /* MSG LENGTH OF INSERT  @ZA28479*/
         MVI   MSGLEN2,X'02'                                       0998
*                 MSGTEXT2=ADDR(TEMPCHAR);/* INSERT TWO      @ZA28479*/
         LA    @14,TEMPCHAR                                        0999
         STCM  @14,7,MSGTEXT2                                      0999
*                 TEMPBIN=REG15;    /* RETURN CODE           @ZA28479*/
         LR    TEMPBIN,REG15                                       1000
*                 CVD(TEMPBIN,TEMPPACK);/*                   @ZA28479*/
         CVD   TEMPBIN,@TS00001                                    1001
         MVC   TEMPPACK(4),@TS00001+4                              1001
*                 UNPK(TEMPCHAR,TEMPPACK);/*                 @ZA28479*/
         UNPK  TEMPCHAR(2),TEMPPACK(4)                             1002
*                 TEMPCHAR(2:2)=TEMPCHAR(2:2)ORSIGN;/*      @ZA28479*/
         OC    TEMPCHAR+1(1),ORSIGN                                1003
*                 RESPECIFY                                        1004
*                   REG1 RSTD;      /*                       @ZA28479*/
*                 REG1=ADDR(MSGRQ); /*                       @ZA28479*/
         LA    REG1,MSGRQ                                          1005
*                 CALL ICBVOP00;    /* CALL MSG MODULE       @ZA28479*/
         L     @15,@CV01912                                        1006
         BALR  @14,@15                                             1006
*                 RESPECIFY                                        1007
*                  (REG1,                                          1007
*                   REG15) UNRSTD;  /*                       @ZA28479*/
*                 SPAEXIT=ON;       /* EXIT FROM LOOP        @ZA28479*/
         OI    SPAEXIT,B'01000000'                                 1008
*                 INTERCC=RCFOUR;   /* MAKE TOTALLY INELGBLE @ZA28479*/
         MVC   INTERCC(2),@CB02113                                 1009
*               END;                /*                       @ZA28479*/
*           END;                    /*                       @ZA28479*/
*         ELSE                      /*                       @ZA28479*/
*           DO;                     /*                       @G24LB26*/
*                                                                  1012
         B     @RC00966                                            1012
@RF00966 DS    0H                                                  1013
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF VOLUME NEEDS CHECK FOR         @G24LB26*/
*             /* SECONDARY SPACE.                            @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1013
*             IF NUMBVOL=ONE THEN   /*                       @G24LB26*/
         CLI   NUMBVOL,1                                           1013
         BNE   @RF01013                                            1013
*               DO;                 /*                       @ZA28479*/
*                 INTERCC=RCFOUR;   /* FAIL REQUEST          @ZA28479*/
         MVC   INTERCC(2),@CB02113                                 1015
*                 SPAEXIT=ON;       /* EXIT LOOP             @ZA28479*/
         OI    SPAEXIT,B'01000000'                                 1016
*               END;                /*                       @ZA28479*/
*             ELSE                  /*                       @ZA28479*/
*               DO;                 /*                       @ZA28479*/
         B     @RC01013                                            1018
@RF01013 DS    0H                                                  1019
*                 BFBADPRI(INDXBFTB)=ON;/*                   @G24LB26*/
         LR    @04,INDXBFTB                                        1019
         MH    @04,@CH02240                                        1019
         L     @01,BFTBLPTR                                        1019
         ALR   @01,@04                                             1019
         OI    BFBADPRI-18(@01),B'10000000'                        1019
*                 SPAEXIT=ON;       /* EXIT LOOP             @ZA28479*/
         OI    SPAEXIT,B'01000000'                                 1020
*               END;                /*                       @ZA28479*/
*           END;                    /*                       @ZA28479*/
*       END;                        /*                       @ZA28479*/
*     ELSE                          /*                       @ZA28479*/
*       SPAEXIT=ON;                 /* VOL OK, EXIT LOOP     @ZA28479*/
         B     @RC00964                                            1024
@RF00964 OI    SPAEXIT,B'01000000'                                 1024
*   END;                            /*                       @ZA28479*/
*                                                                  1025
@RC00964 DS    0H                                                  1025
@DE00963 TM    SPAEXIT,B'01000000'                                 1025
         BZ    @DL00963                                            1025
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS ELIGIBLE FOR PRIMARY SELECTION           @ZA28479*/
*   /* AT THIS POINT IN THE SELECTION PROCESS,               @ZA28479*/
*   /* THEN PLACE THE AMOUNT OF SELECTABLE SPACE ON          @ZA28479*/
*   /* THIS VOLUME IN A TEMPORARY HOLDING AREA UNTIL         @ZA28479*/
*   /* IT IS DETERMINED FOR CERTAIN THAT THIS VOLUME         @ZA28479*/
*   /* IS ELIGIBLE FOR THE REQUEST.                          @ZA28479*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1026
*   IF INTERCC=RCZERO&BFBADPRI(INDXBFTB)=OFF THEN/*          @ZA28479*/
         CLC   INTERCC(2),@CB02111                                 1026
         BNE   @RF01026                                            1026
         LR    @04,INDXBFTB                                        1026
         MH    @04,@CH02240                                        1026
         L     @01,BFTBLPTR                                        1026
         ALR   @01,@04                                             1026
         TM    BFBADPRI-18(@01),B'10000000'                        1026
         BNZ   @RF01026                                            1026
*     TPVOLSPA=GVSMTDSP(INDXEXTS)-RESERSPA;/*                @ZA28479*/
*                                                                  1027
         LR    @04,INDXEXTS                                        1027
         MH    @04,@CH01851                                        1027
         L     @01,GVSNEPTR                                        1027
         LH    @04,GVSMTDSP-20(@04,@01)                            1027
         SH    @04,RESERSPA                                        1027
         STH   @04,TPVOLSPA                                        1027
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ONLY SELECTING FOR PRIMARY ONLY, DO NOT            @G24LB26*/
*   /* PROCESS FOR SECONDARY SELECTION.                      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1028
*   IF NUMBVOL>ONE THEN             /* SEE IF MULTI-VOLUME   @G24LB26
*                                      REQUEST               @G24LB26*/
@RF01026 CLI   NUMBVOL,1                                           1028
         BNH   @RF01028                                            1028
*     DO;                           /*                       @G24LB26*/
*                                                                  1029
*       /*************************************************************/
*       /*                                                           */
*       /* IF NOT ENOUGH SPACE FOR SECONDARY EXTENT,         @G24LB26*/
*       /* TURN ON INDICATOR.                                @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1030
*       IF SECCYL>GVSMTDSP(INDXEXTS) THEN/*                  @G24LB26*/
         LR    @04,INDXEXTS                                        1030
         MH    @04,@CH01851                                        1030
         LH    @15,SECCYL                                          1030
         L     @14,GVSNEPTR                                        1030
         CH    @15,GVSMTDSP-20(@04,@14)                            1030
         BNH   @RF01030                                            1030
*         BFBADSEC(INDXBFTB)=ON;    /*                       @G24LB26*/
*                                                                  1031
         LR    @04,INDXBFTB                                        1031
         MH    @04,@CH02240                                        1031
         L     @01,BFTBLPTR                                        1031
         ALR   @01,@04                                             1031
         OI    BFBADSEC-18(@01),B'01000000'                        1031
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME IS NOT ELIGIBLE FOR EITHER PRIMARY      @G24LB26*/
*       /* OR SECONDARY, SET BAD RETURN CODE.                @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1032
*       IF BFBADPRI(INDXBFTB)=ON&   /*                       @G24LB26*/
*           BFBADSEC(INDXBFTB)=ON THEN/*                     @G24LB26*/
@RF01030 LR    @04,INDXBFTB                                        1032
         MH    @04,@CH02240                                        1032
         L     @01,BFTBLPTR                                        1032
         ALR   @01,@04                                             1032
         TM    BFBADPRI-18(@01),B'11000000'                        1032
         BNO   @RF01032                                            1032
*         INTERCC=RCFOUR;           /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 1033
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00009 DS    0H                                                  1035
@EF00009 DS    0H                                                  1035
@ER00009 L     @14,@SA00009                                        1035
         BR    @14                                                 1035
*   END SPACECK;                    /*                       @G24LB26*/
         B     @EL00009                                            1036
*                                                                  1037
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - VOLSEPCK                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - PROCEDURE IS CALLED TO DETERMINE IF VOLUME    @G24LB26*/
*/*            SHOULD BE EXCLUDED FROM SELECTION BECAUSE     @G24LB26*/
*/*            REQUEST REQUIRES DATA SEPARATION.             @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - SELECT REQUEST BLOCK, INDEX INTO EXTENSION       @G24LB26*/
*/*         RECORD TO GET VOLID PRESENTLY WORKING ON.        @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - ZERO INTERNAL RETURN CODE IF VOLUME IS STILL    @G24LB26*/
*/*          ELIGIBLE FOR SELECTION, FOUR RETURN CODE IF     @G24LB26*/
*/*          SEPARATION REQUIREMENTS HAVE ELIMINATED THIS    @G24LB26*/
*/*          VOLUME.                                         @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1037
*VOLSEPCK:                                                         1037
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1037
VOLSEPCK ST    @14,@SA00010                                        1037
*   /*****************************************************************/
*   /*                                                               */
*   /* INITILIZE LOOP CONTROL SWITCH                         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1038
*   SEPEXIT=OFF;                    /*                       @G24LB26*/
*                                                                  1038
         NI    SEPEXIT,B'11111110'                                 1038
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETER LIST TO CALL STEP TABLE PROCESSOR.   @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1039
*   RESPECIFY                                                      1039
*     STPDDENT BASED(DSPDDADR);     /*                       @G24LB26*/
*                                                                  1039
*   /*****************************************************************/
*   /*                                                               */
*   /* SINCE VOL SEP SPECIFIED, CALL TABLE PROCESSOR TO SEE  @G24LB26*/
*   /* IF VOLUME IS EXCLUDED FROM SELECTION, UNLESS THE      @G24LB26*/
*   /* TABLE PROCESSOR HAS ALREADY BEEN CALLED FOR A         @G24LB26*/
*   /* PREVIOUS VOLUME IN THIS REQUEST                       @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1040
*   IF DSPDDADR=ZEROPTR THEN        /*                       @G24LB26*/
         L     @04,DSPDDADR                                        1040
         LTR   @04,@04                                             1040
         BNZ   @RF01040                                            1040
*     DO;                           /*                       @G24LB26*/
*                                                                  1041
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE PROCESSOR PARAMETER LIST.              @G24LB26*/
*       /* CALL TABLE PROCESSOR FOR ADDRESS OF DD ENTRY      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1042
*       TABP=TABP&&TABP;            /* CLEAR TABLE PROCESSOR @G24LB26
*                                      PARM LIST             @G24LB26*/
         LA    @04,STRTABP                                         1042
         XC    TABP(12,@04),TABP(@04)                              1042
*       TABFSRCD=ON;                /* INDIC SEARCH TABLES   @G24LB26*/
         OI    TABFSRCD(@04),B'01000000'                           1043
*       TABJOBID=SELJOBID;          /* JOB ID                @G24LB26*/
         L     @15,SELJOBID(,SELTMPTR)                             1044
         ST    @15,TABJOBID(,@04)                                  1044
*       TABDDNUM=SELRFDDN;          /* DD # FOR TABLE SEARCH @G24LB26*/
         LH    @15,SELRFDDN(,SELTMPTR)                             1045
         STH   @15,TABDDNUM(,@04)                                  1045
*       RESPECIFY                                                  1046
*         REG15 RSTD;               /*                       @G24LB26*/
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/
*                                                                  1047
         ST    @04,@AL00001                                        1047
         L     @15,@CV01914                                        1047
         LA    @01,@AL00001                                        1047
         BALR  @14,@15                                             1047
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN CODE FROM TABLE PROCESSOR.           @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1048
*       IF REG15=RCZERO THEN        /*                       @G24LB26*/
         LTR   REG15,REG15                                         1048
         BNZ   @RF01048                                            1048
*         DSPDDADR=TABDDRET;        /* ADDR OF DD ENTRY      @G24LB26*/
         LA    @14,STRTABP                                         1049
         L     @14,TABDDRET(,@14)                                  1049
         ST    @14,DSPDDADR                                        1049
*       ELSE                        /*                       @G24LB26*/
*         DSPDDADR=ONEPTR;          /* DO NOT SEARCH TABLE   @G24LB26*/
         B     @RC01048                                            1050
@RF01048 MVC   DSPDDADR(4),@CF00043                                1050
*       RESPECIFY                                                  1051
*         REG15 UNRSTD;             /*                       @G24LB26*/
@RC01048 DS    0H                                                  1052
*     END;                          /*                       @G24LB26*/
*                                                                  1052
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU VOLUMES IN STEP TABLE ENTRY IF THE          @G24LB26*/
*   /* THE TABLE PROCESSOR HAS NOT ENCOUNTERED AN ERROR      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1053
*   IF DSPDDADR^=ONEPTR THEN        /*                       @G24LB26*/
@RF01040 LA    @04,1                                               1053
         C     @04,DSPDDADR                                        1053
         BE    @RF01053                                            1053
*     DO INDXDDVL=ONE TO STPDDNVL WHILE SEPEXIT=OFF;/*       @G24LB26*/
*                                                                  1054
         LR    INDXDDVL,@04                                        1054
         B     @DE01054                                            1054
@DL01054 TM    SEPEXIT,B'00000001'                                 1054
         BNZ   @DC01054                                            1054
*       /*************************************************************/
*       /*                                                           */
*       /* IF MATCH FOUND, GET OUT OF LOOP AND SET           @G24LB26*/
*       /* RETURN CODE INDICATING VOLUME IS NOT ELIGIBLE     @G24LB26*/
*       /* FOR SELECTION.                                    @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1055
*       IF GVSVOLID(INDXEXTS)=STPDDVOL(INDXDDVL) THEN/*      @G24LB26*/
         LR    @04,INDXEXTS                                        1055
         MH    @04,@CH01851                                        1055
         LR    @03,INDXDDVL                                        1055
         MH    @03,@CH00215                                        1055
         L     @01,GVSNEPTR                                        1055
         ALR   @01,@04                                             1055
         L     @04,DSPDDADR                                        1055
         ALR   @04,@03                                             1055
         CLC   GVSVOLID-20(6,@01),STPDDVOL-6(@04)                  1055
         BNE   @RF01055                                            1055
*         DO;                       /*                       @G24LB26*/
*           INTERCC=RCFOUR;         /* SET RETURN TO         @G24LB26
*                                      NON-ZERO              @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 1057
*           SEPEXIT=ON;             /* GET OUT OF LOOP       @G24LB26*/
         OI    SEPEXIT,B'00000001'                                 1058
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
@RF01055 AL    INDXDDVL,@CF00043                                   1060
@DE01054 L     @04,DSPDDADR                                        1060
         SLR   @03,@03                                             1060
         IC    @03,STPDDNVL(,@04)                                  1060
         CR    INDXDDVL,@03                                        1060
         BNH   @DL01054                                            1060
@DC01054 DS    0H                                                  1061
*   RETURN;                         /*                       @G24LB26*/
@EL00010 DS    0H                                                  1061
@EF00010 DS    0H                                                  1061
@ER00010 L     @14,@SA00010                                        1061
         BR    @14                                                 1061
*   END VOLSEPCK;                   /*                       @G24LB26*/
         B     @EL00010                                            1062
*                                                                  1063
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - WAITCK                                  @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - DETERMINES IF A VOLUME WOULD CAUSE THE STEP   @G24LB26*/
*/*            TO WAIT IF IT WERE SELECTED FOR THE REQUEST.  @G24LB26*/
*/*            THE TABLE PROCESSOR MUST ALSO BE CONSULTED TO @G24LB26*/
*/*            DETERMINE THIS, BUT THAT IS DONE LATER.       @G24LB26*/
*/*            ROUTINE GETS CALLED ONLY IF MSVI RECORDS      @G24LB26*/
*/*            INDICATE VOLUME IS MOUNTED TO THIS HOST.      @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - UCB ADDRESS IF AVAILABLE, UCB IF ACCESSABLE,     @G24LB26*/
*/*         UCB ADDRESS OF REQUEST IF SPECIFIC UNIT          @G24LB26*/
*/*         SPECIFIED ON THE REQUEST, BFNSHRFL FLAG IN       @G24LB26*/
*/*         BEST FIT TABLE TO INDICATE IF REQUEST IS FOR     @G24LB26*/
*/*         SHARED OR EXCLUSIVE USE AND ALSO THE DEVICE      @G24LB26*/
*/*         TYPE FOR THIS REQUEST IF A SPECIFIC UNIT WAS     @G24LB26*/
*/*         NOT SPECIFIED.                                   @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - RETURNS WITH WAIT FLAG SET ON OR LEFT OFF.      @G24LB26*/
*/*          ZERO RETURN CODE IN INTERCC.                    @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1063
*WAITCK:                                                           1063
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
WAITCK   ST    @14,@SA00011                                        1063
*   WAITEXIT=OFF;                   /* ZERO EXIT SWITCH      @G24LB26*/
*                                                                  1064
         NI    WAITEXIT,B'11111101'                                1064
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF UCB LOCATED FOR VOLUME UNDER             @G24LB26*/
*   /* CONSIDERATION, AND IF THERE IS NO UCB ADDRESS,        @G24LB26*/
*   /* MARK AS A WAIT VOLUME SINCE IT IS ASSUMED THAT THE    @G24LB26*/
*   /* VOLUME IS IN THE PROCESS OF BEING MOUNTED             @G24LB26*/
*   /* AND THERE IS NO WAY TO DETERMINE IF THE VOLUME        @G24LB26*/
*   /* IS GOING TO BE MOUNTED EXCLUSIVELY OR FOR SHARED      @G24LB26*/
*   /* USE. THERE FOR, THE WORST CASE IS ASSUMED.            @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*   IF UCBADDR=ZEROPTR THEN         /*                       @G24LB26*/
         L     @04,UCBADDR                                         1065
         LTR   @04,@04                                             1065
         BNZ   @RF01065                                            1065
*     BFWAITFL(INDXBFTB)=ON;        /*                       @G24LB26*/
*                                                                  1066
         LR    @04,INDXBFTB                                        1066
         MH    @04,@CH02240                                        1066
         L     @01,BFTBLPTR                                        1066
         ALR   @01,@04                                             1066
         OI    BFWAITFL-18(@01),B'01000000'                        1066
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS NOT ALREADY MARKED AS A WAIT VOLUME,     @G24LB26*/
*   /* CHECK UCB SHAREABILITY AND EXCLUSIVE REQUEST STATUS   @G24LB26*/
*   /* IF THERE ARE ANY USERS. IF UCB IS NON-SHARABLE OR     @G24LB26*/
*   /* REQUEST IS FOR EXCLUSIVE USE, TURN ON WAIT FLAG.      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1067
*   IF BFWAITFL(INDXBFTB)=OFF THEN  /*                       @G24LB26*/
@RF01065 L     @04,BFTBLPTR                                        1067
         LR    @15,INDXBFTB                                        1067
         MH    @15,@CH02240                                        1067
         ALR   @15,@04                                             1067
         TM    BFWAITFL-18(@15),B'01000000'                        1067
         BNZ   @RF01067                                            1067
*     IF UCBUSER^=ZERO&(UCBBSVL=ONBFNSHRFL=ON) THEN/*       @G24LB26*/
         L     @15,UCBPTR                                          1068
         CLI   UCBUSER(@15),0                                      1068
         BE    @RF01068                                            1068
         TM    UCBBSVL(@15),B'10000000'                            1068
         BO    @RT01068                                            1068
         TM    BFNSHRFL(@04),B'10000000'                           1068
         BNO   @RF01068                                            1068
@RT01068 DS    0H                                                  1069
*       BFWAITFL(INDXBFTB)=ON;      /*                       @G24LB26*/
*                                                                  1069
         LR    @04,INDXBFTB                                        1069
         MH    @04,@CH02240                                        1069
         L     @01,BFTBLPTR                                        1069
         ALR   @01,@04                                             1069
         OI    BFWAITFL-18(@01),B'01000000'                        1069
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS NOT YET MARKED AS A WAIT VOLUME AND      @G24LB26*/
*   /* THE REQUEST SPECIFIED A SPECIFIC UNIT ADDRESS,        @G24LB26*/
*   /* THEN CHECK ITS CURRENT UNIT LOCATION.                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1070
*   IF BFWAITFL(INDXBFTB)=OFF&SELUCBAD^=ZEROPTR THEN/*       @G24LB26*/
*                                                                  1070
@RF01068 DS    0H                                                  1070
@RF01067 L     @04,BFTBLPTR                                        1070
         LR    @15,INDXBFTB                                        1070
         MH    @15,@CH02240                                        1070
         ST    @15,@TF00001                                        1070
         ALR   @15,@04                                             1070
         TM    BFWAITFL-18(@15),B'01000000'                        1070
         BNZ   @RF01070                                            1070
         L     @15,SELUCBAD(,SELTMPTR)                             1070
         LTR   @15,@15                                             1070
         BZ    @RF01070                                            1070
*     /***************************************************************/
*     /*                                                             */
*     /* IF VOLUME IS NOT CURRENTLY MOUNTED ON THE UNIT      @G24LB26*/
*     /* REQUESTED, IT IS A WAIT VOLUME.                     @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1071
*     IF UCBADDR^=SELUCBAD THEN     /*                       @G24LB26*/
         C     @15,UCBADDR                                         1071
         BE    @RF01071                                            1071
*       BFWAITFL(INDXBFTB)=ON;      /* INDICATES WAIT VOL    @G24LB26*/
*                                                                  1072
         AL    @04,@TF00001                                        1072
         OI    BFWAITFL-18(@04),B'01000000'                        1072
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IT IS ON THE REQUESTED UNIT, INDICATE THAT         @G24LB26*/
*   /* NO MORE CHECKS ARE NECESSARY.                         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1073
*     ELSE                          /*                       @G24LB26*/
*       WAITEXIT=ON;                /* GET TO END OF PROC    @G24LB26*/
*                                                                  1073
         B     @RC01071                                            1073
@RF01071 OI    WAITEXIT,B'00000010'                                1073
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME IS NOT MARKED WAIT YET AND REMAINING        @G24LB26*/
*   /* CHECKS ARE REQUIRED, THEN CHECK TO DETERMINE IF AN    @G24LB26*/
*   /* ESOTERIC OF OTHER THAN '3330V' WAS SPECIFIED.         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1074
*   IF BFWAITFL(INDXBFTB)=OFF&WAITEXIT=OFF THEN/*            @G24LB26*/
*                                                                  1074
@RC01071 DS    0H                                                  1074
@RF01070 LR    @04,INDXBFTB                                        1074
         MH    @04,@CH02240                                        1074
         L     @01,BFTBLPTR                                        1074
         ALR   @01,@04                                             1074
         TM    BFWAITFL-18(@01),B'01000000'                        1074
         BNZ   @RF01074                                            1074
         TM    WAITEXIT,B'00000010'                                1074
         BNZ   @RF01074                                            1074
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK DEVICE TYPE OF REQUEST.                       @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1075
*     IF SELDEVTP^=DEV3330V THEN    /*                       @G24LB26*/
         CLC   SELDEVTP(4,SELTMPTR),DEV3330V                       1075
         BE    @RF01075                                            1075
*       DO;                         /*                       @G24LB26*/
*                                                                  1076
*         /***********************************************************/
*         /*                                                         */
*         /* IF '3330V' DEVICE TYPE WAS NOT SPECIFED,        @G24LB26*/
*         /* SET UP PARAMETER LIST TO CALL UNIT PROCESSOR    @G24LB26*/
*         /* TO DETERMINE IF THE UNIT VOLUME IS MOUNTED      @G24LB26*/
*         /* ON FALLS WITHIN ESOTERIC SPECIFIED.             @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1077
*         UNITP=UNITP&&UNITP;       /* CLEAR PARM LIST AREA  @G24LB26*/
         LA    @04,STRUNITP                                        1077
         XC    UNITP(17,@04),UNITP(@04)                            1077
*         UNIDEVTP=SELDEVTP;        /* DEVICE TYPE OF REQUEST      1078
*                                                            @G24LB26*/
         MVC   UNIDEVTP(4,@04),SELDEVTP(SELTMPTR)                  1078
*         UNIUCBP=UCBADDR;          /* UCB ADDR WHERE VOLUME @G24LB26
*                                      IS MOUNTED            @G24LB26*/
         L     @15,UCBADDR                                         1079
         ST    @15,UNIUCBP(,@04)                                   1079
*         UNIFINCL=ON;              /* INDICATE INCLUDED     @G24LB26
*                                      TYPE CHECK            @G24LB26*/
         OI    UNIFINCL(@04),B'01000000'                           1080
*         RESPECIFY                                                1081
*           REG15 RSTD;             /*                       @G24LB26*/
*         CALL ICBVUP00(UNITP,VVICB);/*                      @G24LB26*/
*                                                                  1082
         ST    @04,@AL00001                                        1082
         L     @14,VVIPTR                                          1082
         ST    @14,@AL00001+4                                      1082
         L     @15,@CV01913                                        1082
         LA    @01,@AL00001                                        1082
         BALR  @14,@15                                             1082
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK RETURN CODE FROM UNIT PROCESSOR AND IF    @G24LB26*/
*         /* NOT ZERO, VOLUME IS A WAIT BECAUSE UNIT DID NOT @G24LB26*/
*         /* FALL WITHIN ESOTERIC.                           @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1083
*         IF REG15^=RCZERO THEN     /*                       @G24LB26*/
         LTR   REG15,REG15                                         1083
         BZ    @RF01083                                            1083
*           BFWAITFL(INDXBFTB)=ON;  /*                       @G24LB26*/
         LR    @14,INDXBFTB                                        1084
         MH    @14,@CH02240                                        1084
         L     @04,BFTBLPTR                                        1084
         ALR   @04,@14                                             1084
         OI    BFWAITFL-18(@04),B'01000000'                        1084
*         RESPECIFY                                                1085
*           REG15 UNRSTD;           /*                       @G24LB26*/
@RF01083 DS    0H                                                  1086
*       END;                        /*                       @G24LB26*/
*                                                                  1086
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ZERO RETURN CODE                                  @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1087
*   INTERCC=RCZERO;                 /*                       @G24LB26*/
@RF01075 DS    0H                                                  1087
@RF01074 MVC   INTERCC(2),@CB02111                                 1087
*   RETURN;                         /*                       @G24LB26*/
@EL00011 DS    0H                                                  1088
@EF00011 DS    0H                                                  1088
@ER00011 L     @14,@SA00011                                        1088
         BR    @14                                                 1088
*   END WAITCK;                     /*                       @G24LB26*/
*                                                                  1090
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - CONUSER                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - ROUTINE GETS THE CONCURRENT USERS FROM THE    @G24LB26*/
*/*            UCB IF THE UNIT PROCESSOR LOCATED A UCB FOR   @G24LB26*/
*/*            THE VOLUME. IF A UCB WAS NOT LOCATED, SINCE   @G24LB26*/
*/*            VOLUME IS INDICATED AS BEING MOUNTED BY THE   @G24LB26*/
*/*            MSVI RECORDS, ONE CONCURRENT USER IS ASSUMED. @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE ROUTINE ONLY GETS CALLED IF MSVI RECORDS     @G24LB26*/
*/*         INDICATE VOLUME IS MOUNTED TO THIS HOST. IT      @G24LB26*/
*/*         USES THE UCB ADDRESS IN THE INTERNAL WORK AREA   @G24LB26*/
*/*         IF UCB EXISTS.  IT THEN USES THE UCBUSER FIELD   @G24LB26*/
*/*         IN THE UCB TO RETRIEVE CONCURRENT USERS. ALSO    @G24LB26*/
*/*         NEEDS THE CURRENT INDEX INTO THE BEST FIT TABLE. @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - PUTS CONCURRENT USERS INTO THE BEST FIT TABLE   @G24LB26*/
*/*          FOR VOLUME CURRENTLY BEING PROCESSED.           @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1090
*CONUSER:                                                          1090
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1090
CONUSER  ST    @14,12(,@13)                                        1090
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE UCB FOR THIS VOLUME COULD NOT BE LOCATED,      @G24LB26*/
*   /* ASSUME ONE USER AND EXIT THIS PROCEDURE.              @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*   IF UCBADDR=ZEROPTR THEN         /*                       @G24LB26*/
         L     @04,UCBADDR                                         1091
         LTR   @04,@04                                             1091
         BNZ   @RF01091                                            1091
*     BFCONUSE(INDXBFTB)=ONE;       /*                       @G24LB26*/
*                                                                  1092
         LR    @04,INDXBFTB                                        1092
         MH    @04,@CH02240                                        1092
         LA    @15,1                                               1092
         L     @14,BFTBLPTR                                        1092
         STC   @15,BFCONUSE-18(@04,@14)                            1092
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE TAKE USER COUNT FROM UCB FOR THE NUMBER     @G24LB26*/
*   /* OF USERS.                                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1093
*   ELSE                            /*                       @G24LB26*/
*     BFCONUSE(INDXBFTB)=UCBUSER;   /*                       @G24LB26*/
         B     @RC01091                                            1093
@RF01091 LR    @04,INDXBFTB                                        1093
         MH    @04,@CH02240                                        1093
         L     @01,UCBPTR                                          1093
         SLR   @00,@00                                             1093
         IC    @00,UCBUSER(,@01)                                   1093
         L     @01,BFTBLPTR                                        1093
         STC   @00,BFCONUSE-18(@04,@01)                            1093
*   RETURN;                         /*                       @G24LB26*/
@EL00012 DS    0H                                                  1094
@EF00012 DS    0H                                                  1094
@ER00012 L     @14,12(,@13)                                        1094
         BR    @14                                                 1094
*   END CONUSER;                    /*                       @G24LB26*/
         B     @EL00012                                            1095
*                                                                  1096
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - FINSELCT                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - USES THE BEST FIT TABLE ENTRIES AND CALLS     @G24LB26*/
*/*            THE SORT ROUTINE TO SORT THE VOLUMES IN       @G24LB26*/
*/*            ORDER FROM BEST FIT TO WORST FIT. THIS IS     @G24LB26*/
*/*            ACCOMPLISHED BY SORTING ON FIELDS AND FLAGS   @G24LB26*/
*/*            REPRESENTING THE CURRENT STATUS OF THE        @G24LB26*/
*/*            VOLUME. THE FIRST FIELD SORTED ON IS A        @G24LB26*/
*/*            BIT REPRESENTING WHETHER VOLUME IS HIGH       @G24LB26*/
*/*            RISK OR NOT. IF FLAG IS ON, VOLUME IS         @G24LB26*/
*/*            HIGH RISK AND WILL GO TO THE BOTTOM OF THE    @G24LB26*/
*/*            LIST. THE NEXT FIELD THE WAIT FLAG. IF ON,    @G24LB26*/
*/*            VOLUME IS WAIT AND WILL GO TO THE BOTTOM      @G24LB26*/
*/*            OF THE NON-HIGH RISK OR BOTTOM OF THE HIGH    @G24LB26*/
*/*            RISK DEPENDING ON THE RISK STATUS. THIS       @G24LB26*/
*/*            TYPE OF STRATIFICATION WILL CONTINUE AS THE   @G24LB26*/
*/*            LOWER PRIORITY FIELDS ARE TAKEN INTO          @G24LB26*/
*/*            ACCOUNT. THE REMAINING FIELDS SORTED ON IN    @G24LB26*/
*/*            ORDER OF PRIORITY ARE NUMBER OF CONCURRENT    @G24LB26*/
*/*            USERS IF OVER MAXIMUM, VOLUME EXPIRATION DATE @G24LB26*/
*/*            IN PACKED DECIMAL, SHAREABILITY CONFLICTS     @G24LB26*/
*/*            FLAG, NOT MOUNTED FLAG, MOUNTED ONLY TO       @G24LB26*/
*/*            ANOTHER HOST FLAG AND NUMBER OF CONCURRENT    @G24LB26*/
*/*            USERS FIELD. WHEN THE SORTING IS COMPLETE,    @G24LB26*/
*/*            THE ROUTINE CHOOSES THE BEST VOLUME FOR THIS  @G24LB26*/
*/*            REQUEST AS A PRIMARY, AND IF MORE THAN ONE    @G24LB26*/
*/*            VOLUME IS REQUESTED, IT CHOOSES THE NEXT BEST @G24LB26*/
*/*            VOLUME FOR THE FIRST SECONDARY, ETC. IN       @G24LB26*/
*/*            ADDITION TO THE ABOVE DESCRIBED PROCEDURE, IN @G24LB26*/
*/*            VS/2 THE ROUTINE ALSO CALLS A PROCEDURE TO    @G24LB26*/
*/*            CHECK ON THE ENQUEUE STATUS OF THE VOLUME.    @G24LB26*/
*/*            IF THE VOLUME IS ENQUEUED, THEN THE WAIT      @G24LB26*/
*/*            INDICATION FLAG IS TURNED ON AND THE BEST     @G24LB26*/
*/*            FIT TABLE IS RE-SORTED. IF THE TEST ENQ       @G24LB26*/
*/*            DETERMINES THAT THE VOLUME IS NOT AVAILABLE   @G24LB26*/
*/*            FOR USE, IT IS MARKED INELIGIBLE AND THE NEXT @G24LB26*/
*/*            VOLUME IN THE TABLE IS PROCESSED. ONCE A      @G24LB26*/
*/*            VOLUME IS FOUND THAT IS EITHER ALREADY A      @G24LB26*/
*/*            WAIT VOLUME, OR IS NOT ENQUEUED, A ROUTINE    @G24LB26*/
*/*            IS CALLED TO DETERMINE IF THE VOLUME IS       @G24LB26*/
*/*            APPROVED FOR SELECTION BY JES3. IF THE VOLUME @G24LB26*/
*/*            IS NOT APPROVED BY JES3, THE VOLUME IS NOT A  @G24LB26*/
*/*            CANDIDATE AND THE NEXT VOLUME IN THE BEST     @G24LB26*/
*/*            FIT TABLE IS PROCESSED. IF THE VOLUME IS      @G24LB26*/
*/*            APPROVED FOR SELECTION BY JES3, THE VOLUME    @G24LB26*/
*/*            IS SELECTED. THIS PROCESS CONTINUES UNTIL     @G24LB26*/
*/*            ALL REQUESTED VOLUMES ARE SELECTED, OR UNTIL  @G24LB26*/
*/*            END OF THE BEST FIT TABLE IS REACHED. IF THE  @G24LB26*/
*/*            END OF THE TABLE IS ENCOUNTERED BEFORE ALL    @G24LB26*/
*/*            REQUESTED VOLUMES HAVE BEEN SELECTED, THE     @G24LB26*/
*/*            REQUEST FAILS. ALSO A FLAG IS CHECKED IN      @G24LB26*/
*/*            VS/2 TO DETERMINE IF THE REQUEST CAN WAIT     @G24LB26*/
*/*            OR NOT FOR THE VOLUME SELECTED. IF IT CANNOT, @G24LB26*/
*/*            ANY VOLUME WITH THE WAIT FLAG ON IS NOT A     @G24LB26*/
*/*            CANDIDATE, INCLUDING VOLUMES ENQUEUED.        @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - BEST FIT TABLE WITH ALL ELIGIBLE VOLUMES IN IT   @G24LB26*/
*/*         AND EACH ENTRY COMPLETED. SELECT REQUEST BLOCK.  @G24LB26*/
*/*         NUMBER OF VOLUMES TO BE SELECTED FOR THIS        @G24LB26*/
*/*         REQUEST.                                         @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - SELECTED VOLUMES IN THE VOLUME RETURN AREA OF   @G24LB26*/
*/*          THE RPLV OR IF THE REQUESTED NUMBER OF VOLUMES  @G24LB26*/
*/*          COULD NOT BE SELECTED, A MESSAGE, ICB407I WILL  @G24LB26*/
*/*          BE ISSUED ALONG WITH A REASON CODE OF HEX 232   @G24LB26*/
*/*          AND A RETURN CODE OF 4. IF REQUEST WAS          @G24LB26*/
*/*          SUCCESSFUL, A ZERO REASON AND RETURN CODE WILL  @G24LB26*/
*/*          BE RETURNED IN THE RPLV.                        @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1096
*FINSELCT:                                                         1096
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
FINSELCT ST    @14,@SA00013                                        1096
*   NUMCHOS=ZERO;                   /* ZERO VOLUMES CHOSEN   @G24LB26*/
         MVI   NUMCHOS,X'00'                                       1097
*   VOLNUM=ZERO;                    /* INDICATE NO VOLUMES   @G24LB26
*                                      IN VOLUME RETURN AREA @G24LB26*/
*                                                                  1098
         L     @08,SELVLRET(,SELTMPTR)                             1098
         SLR   @06,@06                                             1098
         STH   @06,VOLNUM(,@08)                                    1098
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUEST CANNOT WAIT FOR THE SELECTED VOLUME,       @G24LB26*/
*   /* ELIMINATE ALL VOLUMES IN THE BEST FIT TABLE THAT      @G24LB26*/
*   /* ARE ALREADY WAIT VOLUMES.                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1099
*   IF SELCNTWT=ON THEN             /*                       @G24LB26*/
         TM    SELCNTWT(SELTMPTR),B'00001000'                      1099
         BNO   @RF01099                                            1099
*     DO INDXBFTB=ONE TO BFTOTIDX;  /*                       @G24LB26*/
         LA    INDXBFTB,1                                          1100
         B     @DE01100                                            1100
@DL01100 DS    0H                                                  1101
*       IF BFWAITFL(INDXBFTB)=ON THEN/*                      @G24LB26*/
         L     @08,BFTBLPTR                                        1101
         LR    @04,INDXBFTB                                        1101
         MH    @04,@CH02240                                        1101
         ST    @04,@TF00001                                        1101
         ALR   @04,@08                                             1101
         TM    BFWAITFL-18(@04),B'01000000'                        1101
         BNO   @RF01101                                            1101
*         BFVOLREJ(INDXBFTB)=ON;    /* VOL NOT ELIGIBLE      @G24LB26*/
         AL    @08,@TF00001                                        1102
         OI    BFVOLREJ-18(@08),B'00000100'                        1102
*     END;                          /*                       @G24LB26*/
*                                                                  1103
@RF01101 AL    INDXBFTB,@CF00043                                   1103
@DE01100 L     @08,BFTBLPTR                                        1103
         CH    INDXBFTB,BFTOTIDX(,@08)                             1103
         BNH   @DL01100                                            1103
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETER LIST TO CALL SORT ROUTINE            @G24LB26*/
*   /* TO SORT VOLUMES IN BEST FIT TABLE.                    @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1104
*   SRTADDR=ADDR(BFSLOT(ONE));      /* ADDR OF FIRST ENTRY   @G24LB26*/
@RF01099 L     @08,BFTBLPTR                                        1104
         LA    @06,BFSLOT(,@08)                                    1104
         ST    @06,SRTADDR                                         1104
*   SRTNUM=BFTOTIDX;                /* NO OF ELEMENTS IN     @G24LB26
*                                      ARRAY                 @G24LB26*/
         LH    @04,BFTOTIDX(,@08)                                  1105
         STH   @04,SRTNUM                                          1105
*   SRTLEN=LENGTH(BFSLOT);          /* LENGTH OF ONE         @G24LB26
*                                      ELEMENT               @G24LB26*/
         MVC   SRTLEN(2),@CH02240                                  1106
*   SRTBEG=ADDR(BFHPFLGS(ONE))-ADDR(BFSLOT(ONE));/* START    @G24LB26
*                                      OF SORT FIELD         @G24LB26*/
*                                                                  1107
         LA    @04,BFHPFLGS(,@08)                                  1107
         LCR   @06,@06                                             1107
         ALR   @06,@04                                             1107
         STH   @06,SRTBEG                                          1107
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE SRTBEG FROM OFFSET TO COLUMN NUMBER            @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1108
*   SRTBEG=SRTBEG+ONE;              /* ADD ONE TO START COL  @G24LB26*/
         LA    @15,1                                               1108
         ALR   @06,@15                                             1108
         STH   @06,SRTBEG                                          1108
*   SRTFLDLN=ADDR(BFMISCFL(ONE))-ADDR(BFHPFLGS(ONE));/*      @G24LB26
*                                      LENGTH OF SORT FIELD  @G24LB26*/
         LA    @08,BFMISCFL(,@08)                                  1109
         SLR   @08,@04                                             1109
         STH   @08,SRTFLDLN                                        1109
*   RESORTSW=ON;                    /* SORT FIRST TIME THRU  @G24LB26*/
*   FINEXIT=OFF;                    /* INITIALIZE LOOP       @G24LB26
*                                      CONTROL SWITCH        @G24LB26*/
*                                                                  1111
         OI    RESORTSW,B'00010000'                                1111
         NI    FINEXIT,B'01111111'                                 1111
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU BEST FIT TABLE UNTIL THE DESIRED            @G24LB26*/
*   /* NUMBER OF VOLUMES HAVE BEEN SELECTED.                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1112
*   DO INDXBFTB=ONE TO BFTOTIDX WHILE FINEXIT=OFF;/*         @G24LB26*/
*                                                                  1112
         LR    INDXBFTB,@15                                        1112
         B     @DE01112                                            1112
@DL01112 TM    FINEXIT,B'10000000'                                 1112
         BNZ   @DC01112                                            1112
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF BEST FIT TABLE MUST BE SORTED          @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1113
*     IF RESORTSW=ON THEN           /*                       @G24LB26*/
         TM    RESORTSW,B'00010000'                                1113
         BNO   @RF01113                                            1113
*       DO;                         /*                       @G24LB26*/
*         CALL SORT;                /* SORT BEST FIT TABLE   @G24LB26*/
         BAL   @14,SORT                                            1115
*         RESORTSW=OFF;             /* INDICATE SORT DONE    @G24LB26*/
         NI    RESORTSW,B'11101111'                                1116
*       END;                        /*                       @G24LB26*/
*                                                                  1117
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF VOLUME IS ELIGIBLE FOR EITHER PRIMARY  @G24LB26*/
*     /* OR SECONDARY SELECTION                              @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1118
*     IF BFVOLREJ(INDXBFTB)=OFF&    /*                       @G24LB26*/
*         ((NUMCHOS=ZERO&BFBADPRI(INDXBFTB)=OFF)/*          @G24LB26*/
*         (NUMCHOS>ZERO&BFBADSEC(INDXBFTB)=OFF&/*            @G24LB26*/
*         BFSELSEC(INDXBFTB)=OFF)) THEN/*                    @G24LB26*/
@RF01113 L     @08,BFTBLPTR                                        1118
         LR    @04,INDXBFTB                                        1118
         MH    @04,@CH02240                                        1118
         ST    @04,@TF00001                                        1118
         ALR   @04,@08                                             1118
         TM    BFVOLREJ-18(@04),B'00000100'                        1118
         BNZ   @RF01118                                            1118
         CLI   NUMCHOS,0                                           1118
         BNE   @GL00053                                            1118
         AL    @08,@TF00001                                        1118
         TM    BFBADPRI-18(@08),B'10000000'                        1118
         BZ    @RT01118                                            1118
@GL00053 CLI   NUMCHOS,0                                           1118
         BNH   @RF01118                                            1118
         LR    @08,INDXBFTB                                        1118
         MH    @08,@CH02240                                        1118
         L     @04,BFTBLPTR                                        1118
         ALR   @04,@08                                             1118
         TM    BFBADSEC-18(@04),B'01010000'                        1118
         BNZ   @RF01118                                            1118
@RT01118 DS    0H                                                  1119
*       DO;                         /*                       @G24LB26*/
*                                                                  1119
*         /***********************************************************/
*         /*                                                         */
*         /* CALL ROUTINE TO DETERMINE IF VOLUME IS ENQUEUED @G24LB26*/
*         /* UNLESS TEST ENQ HAS ALREADY BEEN DONE ON THIS   @G24LB26*/
*         /* VOLUME.                                         @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1120
*         IF BFNOENQ(INDXBFTB)=OFF& /*                       @G24LB26*/
*             BFENQUED(INDXBFTB)=OFF THEN/*                  @G24LB26*/
         LR    @08,INDXBFTB                                        1120
         MH    @08,@CH02240                                        1120
         L     @04,BFTBLPTR                                        1120
         ALR   @04,@08                                             1120
         TM    BFNOENQ-18(@04),B'00000011'                         1120
         BNZ   @RF01120                                            1120
*           DO;                     /*                       @G24LB26*/
*             CALL TESTENQ;         /*                       @G24LB26*/
*                                                                  1122
         BAL   @14,TESTENQ                                         1122
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK RETURN CODE FROM ENQUEUE ROUTINE      @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1123
*             IF INTERCC=RCZERO THEN/*                       @G24LB26*/
         CLC   INTERCC(2),@CB02111                                 1123
         BNE   @RF01123                                            1123
*               BFNOENQ(INDXBFTB)=ON;/* VOL IS NOT ENQUEUED  @G24LB26*/
*                                                                  1124
         LR    @08,INDXBFTB                                        1124
         MH    @08,@CH02240                                        1124
         L     @04,BFTBLPTR                                        1124
         ALR   @04,@08                                             1124
         OI    BFNOENQ-18(@04),B'00000010'                         1124
*             /*******************************************************/
*             /*                                                     */
*             /* VOLUME IS ENQUEUED OR NOT ELIGIBLE          @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1125
*             ELSE                  /*                       @G24LB26*/
*                                                                  1125
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK IF VOLUME IS ENQUEUED               @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1125
*               IF INTERCC=RCFOUR THEN/*                     @G24LB26*/
         B     @RC01123                                            1125
@RF01123 CLC   INTERCC(2),@CB02113                                 1125
         BNE   @RF01125                                            1125
*                 DO;               /*                       @G24LB26*/
*                                                                  1126
*                   /*************************************************/
*                   /*                                               */
*                   /* INDICATE VOLUME IS ENQUEUED           @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1127
*                   BFENQUED(INDXBFTB)=ON;/*                 @G24LB26*/
*                                                                  1127
         L     @08,BFTBLPTR                                        1127
         LR    @04,INDXBFTB                                        1127
         MH    @04,@CH02240                                        1127
         ST    @04,@TF00001                                        1127
         ALR   @04,@08                                             1127
         OI    BFENQUED-18(@04),B'00000001'                        1127
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK TO SEE IF VOLUME IS STILL       @G24LB26*/
*                   /* ELIGIBLE                              @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1128
*                   IF SELCNTWT=ON THEN/*                    @G24LB26*/
         TM    SELCNTWT(SELTMPTR),B'00001000'                      1128
         BNO   @RF01128                                            1128
*                     BFVOLREJ(INDXBFTB)=ON;/*               @G24LB26*/
*                                                                  1129
         AL    @08,@TF00001                                        1129
         OI    BFVOLREJ-18(@08),B'00000100'                        1129
*                   /*************************************************/
*                   /*                                               */
*                   /* VOLUME IS A WAIT VOLUME AND IS STILL  @G24LB26*/
*                   /* ELIGIBLE, BUT STATUS MAY HAVE CHANGED @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1130
*                   ELSE            /*                       @G24LB26*/
*                     IF BFWAITFL(INDXBFTB)=OFF THEN/*       @G24LB26*/
*                                                                  1130
         B     @RC01128                                            1130
@RF01128 LR    @08,INDXBFTB                                        1130
         MH    @08,@CH02240                                        1130
         L     @04,BFTBLPTR                                        1130
         ALR   @04,@08                                             1130
         TM    BFWAITFL-18(@04),B'01000000'                        1130
         BNZ   @RF01130                                            1130
*                       /*********************************************/
*                       /*                                           */
*                       /* INDICATE BEST FIT TABLE WILL BE   @G24LB26*/
*                       /* RE-SORTED, STATUS CHANGED         @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1131
*                       RESORTSW=ON;/* RE-SORT TABLE         @G24LB26*/
         OI    RESORTSW,B'00010000'                                1131
*                   BFWAITFL(INDXBFTB)=ON;/* TURN ON WAIT FLAG     1132
*                                                            @G24LB26*/
*                                                                  1132
@RF01130 DS    0H                                                  1132
@RC01128 LR    @08,INDXBFTB                                        1132
         MH    @08,@CH02240                                        1132
         L     @04,BFTBLPTR                                        1132
         ALR   @04,@08                                             1132
         OI    BFWAITFL-18(@04),B'01000000'                        1132
*                   /*************************************************/
*                   /*                                               */
*                   /* DETERMINE IF RESORTING AND THEREFORE  @G24LB26*/
*                   /* NEED TO START AT TOP OF TABLE         @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1133
*                   IF RESORTSW=ON THEN/*                    @G24LB26*/
         TM    RESORTSW,B'00010000'                                1133
         BNO   @RF01133                                            1133
*                     INDXBFTB=ZERO;/* LOOP BACK TO TOP      @G24LB26
*                                      OF BEST FIT TABLE     @G24LB26*/
         SLR   INDXBFTB,INDXBFTB                                   1134
*                 END;              /*                       @G24LB26*/
*                                                                  1135
*             /*******************************************************/
*             /*                                                     */
*             /* VOLUME IS NOT AVAILABLE FOR USE AT          @G24LB26*/
*             /* THIS TIME                                   @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1136
*               ELSE                /*                       @G24LB26*/
*                 IF INTERCC=RCEIGHT THEN/*                  @G24LB26*/
         B     @RC01125                                            1136
@RF01125 CLC   INTERCC(2),@CB02115                                 1136
         BNE   @RF01136                                            1136
*                   BFVOLREJ(INDXBFTB)=ON;/*                 @G24LB26*/
         LR    @08,INDXBFTB                                        1137
         MH    @08,@CH02240                                        1137
         L     @04,BFTBLPTR                                        1137
         ALR   @04,@08                                             1137
         OI    BFVOLREJ-18(@04),B'00000100'                        1137
*           END;                    /*                       @G24LB26*/
*                                                                  1138
@RF01136 DS    0H                                                  1138
@RC01125 DS    0H                                                  1138
@RC01123 DS    0H                                                  1139
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK IF STATUS OF VOLUME HAS CHANGED OR IF     @G24LB26*/
*         /* VOLUME IS STILL ELIGIBLE.                       @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1139
*         IF INDXBFTB>ZERO THEN     /*                       @G24LB26*/
@RF01120 C     INDXBFTB,@CF00084                                   1139
         BNH   @RF01139                                            1139
*           IF BFVOLREJ(INDXBFTB)=OFF&RESORTSW=OFF THEN/*    @G24LB26*/
         LR    @08,INDXBFTB                                        1140
         MH    @08,@CH02240                                        1140
         L     @04,BFTBLPTR                                        1140
         ALR   @04,@08                                             1140
         TM    BFVOLREJ-18(@04),B'00000100'                        1140
         BNZ   @RF01140                                            1140
         TM    RESORTSW,B'00010000'                                1140
         BNZ   @RF01140                                            1140
*             DO;                   /*                       @G24LB26*/
*                                                                  1141
*               /*****************************************************/
*               /*                                                   */
*               /* SINCE VOLUME IS STILL ELIGIBLE FOR        @G24LB26*/
*               /* SELECTION AND ITS STATUS HAS NOT CHANGED  @G24LB26*/
*               /* CALL THE JES3 INTERFACE ROUTINE TO        @G24LB26*/
*               /* DETERMINE IF VOLUME IS OK FOR SELECTION.  @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1142
*               CALL JESINTF;       /*                       @G24LB26*/
*                                                                  1142
         BAL   @14,JESINTF                                         1142
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK CODE IN RPLV AND IF IS IS ZERO,     @G24LB26*/
*               /* CHECK INTERNAL RETURN CODE.               @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1143
*               IF RPLVRETC=RCZERO THEN/*                    @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1143
         BNE   @RF01143                                            1143
*                 DO;               /*                       @G24LB26*/
*                                                                  1144
*                   /*************************************************/
*                   /*                                               */
*                   /* CHECK IF VOLUME HAS APPROVAL OF JES3  @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1145
*                   IF INTERCC=RCZERO THEN/*                 @G24LB26*/
*                                                                  1145
         CLC   INTERCC(2),@CB02111                                 1145
         BNE   @RF01145                                            1145
*                     /***********************************************/
*                     /*                                             */
*                     /* VOLUME IS APPROVED BY JES3,         @G24LB26*/
*                     /* SELECT IT.                          @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1146
*                     DO;           /*                       @G24LB26*/
*                                                                  1146
*                       /*********************************************/
*                       /*                                           */
*                       /* IF VOLUME IS A PRIMARY SELECTION, @G24LB26*/
*                       /* INDICATE IT                       @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1147
*                       IF NUMCHOS=ZERO THEN/*               @G24LB26*/
         CLI   NUMCHOS,0                                           1147
         BNE   @RF01147                                            1147
*                         DO;       /*                       @G24LB26*/
*                           BFSELPRI(INDXBFTB)=ON;/*         @G24LB26*/
*                           BFBADSEC(INDXBFTB)=ON;/*         @G24LB26*/
         LR    @08,INDXBFTB                                        1150
         MH    @08,@CH02240                                        1150
         L     @04,BFTBLPTR                                        1150
         ALR   @04,@08                                             1150
         OI    BFSELPRI-18(@04),B'01100000'                        1150
*                           NUMCHOS=ONE;/*                   @G24LB26*/
         MVI   NUMCHOS,X'01'                                       1151
*                         END;      /*                       @G24LB26*/
*                                                                  1152
*                       /*********************************************/
*                       /*                                           */
*                       /* VOLUME IS A SECONDARY SELECTION   @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1153
*                       ELSE        /*                       @G24LB26*/
*                         DO;       /*                       @G24LB26*/
         B     @RC01147                                            1153
@RF01147 DS    0H                                                  1154
*                           BFSELSEC(INDXBFTB)=ON;/*         @G24LB26*/
         LR    @08,INDXBFTB                                        1154
         MH    @08,@CH02240                                        1154
         L     @04,BFTBLPTR                                        1154
         ALR   @04,@08                                             1154
         OI    BFSELSEC-18(@04),B'00010000'                        1154
*                           NUMCHOS=NUMCHOS+ONE;/*           @G24LB26*/
         IC    @08,NUMCHOS                                         1155
         LA    @08,1(,@08)                                         1155
         STC   @08,NUMCHOS                                         1155
*                         END;      /*                       @G24LB26*/
*                                                                  1156
*                       /*********************************************/
*                       /*                                           */
*                       /* * NOTE: VOLUME HAS ALREADY BEEN * @G24LB26*/
*                       /* * PLACED IN THE VOLUME RETURN *   @G24LB26*/
*                       /* * AREA BY THE JESINTF ROUTINE. *  @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1157
*                                                                  1157
*                       /*********************************************/
*                       /*                                           */
*                       /* IF ALL VOLUMES SELECTED, EXIT     @G24LB26*/
*                       /* LOOP. IF NOT, CHECK IF PRIMARY    @G24LB26*/
*                       /* SELECTION. IF PRIMARY SET INDEX   @G24LB26*/
*                       /* SO THAT SEARCH FOR SECONDARY      @G24LB26*/
*                       /* WILL START AT TOP OF TABLE.       @G24LB26*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  1157
*                       IF NUMCHOS=NUMBVOL THEN/*            @G24LB26*/
@RC01147 CLC   NUMCHOS(1),NUMBVOL                                  1157
         BNE   @RF01157                                            1157
*                         DO;       /*                       @G24LB26*/
*                           VOLNUM=NUMCHOS;/* VOL RET INDEX  @G24LB26*/
         L     @08,SELVLRET(,SELTMPTR)                             1159
         SLR   @04,@04                                             1159
         IC    @04,NUMCHOS                                         1159
         STH   @04,VOLNUM(,@08)                                    1159
*                           FINEXIT=ON;/*                    @G24LB26*/
         OI    FINEXIT,B'10000000'                                 1160
*                         END;      /*                       @G24LB26*/
*                       ELSE        /*                       @G24LB26*/
*                         IF BFSELPRI(INDXBFTB)=ON THEN/*    @G24LB26*/
         B     @RC01157                                            1162
@RF01157 LR    @08,INDXBFTB                                        1162
         MH    @08,@CH02240                                        1162
         L     @04,BFTBLPTR                                        1162
         ALR   @04,@08                                             1162
         TM    BFSELPRI-18(@04),B'00100000'                        1162
         BNO   @RF01162                                            1162
*                           INDXBFTB=ZERO;/*                 @G24LB26*/
         SLR   INDXBFTB,INDXBFTB                                   1163
*                     END;          /*                       @G24LB26*/
*                                                                  1164
*                   /*************************************************/
*                   /*                                               */
*                   /* VOLUME WAS NOT APPROVED BY JES3       @G24LB26*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1165
*                   ELSE            /*                       @G24LB26*/
*                                                                  1165
*                     /***********************************************/
*                     /*                                             */
*                     /* INDICATE VOLUME REJECTED            @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1165
*                     BFVOLREJ(INDXBFTB)=ON;/*               @G24LB26*/
         B     @RC01145                                            1165
@RF01145 LR    @08,INDXBFTB                                        1165
         MH    @08,@CH02240                                        1165
         L     @04,BFTBLPTR                                        1165
         ALR   @04,@08                                             1165
         OI    BFVOLREJ-18(@04),B'00000100'                        1165
*                 END;              /*                       @G24LB26*/
*               ELSE                /*                       @G24LB26*/
*                                                                  1167
*                 /***************************************************/
*                 /*                                                 */
*                 /* JES3 HAD A SEVERE PROBLEM, SO TERMINATE @G24LB26*/
*                 /* THE REQUEST.                            @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1167
*                 FINEXIT=ON;       /*                       @G24LB26*/
         B     @RC01143                                            1167
@RF01143 OI    FINEXIT,B'10000000'                                 1167
*             END;                  /*                       @G24LB26*/
@RC01143 DS    0H                                                  1169
*       END;                        /*                       @G24LB26*/
@RF01140 DS    0H                                                  1169
@RF01139 DS    0H                                                  1170
*   END;                            /* END OUTSIDE LOOP      @G24LB26*/
*                                                                  1170
@RF01118 AL    INDXBFTB,@CF00043                                   1170
@DE01112 L     @08,BFTBLPTR                                        1170
         CH    INDXBFTB,BFTOTIDX(,@08)                             1170
         BNH   @DL01112                                            1170
@DC01112 DS    0H                                                  1171
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF ALL REQUESTE VOLUMES WERE SELECTED,      @G24LB26*/
*   /* AND IF THEY WERE NOT, AND JES3 DID NOT ENCOUNTER A    @G24LB26*/
*   /* TERMINATING ERROR, ISSUE ERROR MESSAGE                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1171
*   IF RPLVRETC=RCZERO&NUMCHOS<NUMBVOL THEN/*                @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1171
         BNE   @RF01171                                            1171
         CLC   NUMCHOS(1),NUMBVOL                                  1171
         BNL   @RF01171                                            1171
*     DO;                           /*                       @G24LB26*/
*                                                                  1172
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE ICB407I AND SET REASON CODE TO      @G24LB26*/
*       /* 232 HEX, RETURN CODE 4.                           @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1173
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MSG PARM FIELD  @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     1173
*       MSGRPLV=RPLVPTR;            /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     1174
*       MSGID=MSG407;               /* MSG ID FOR ICB407I    @G24LB26*/
         MVC   MSGID(4),@CF02061                                   1175
*       MSGLEN1=EIGHT;              /* LENGTH OF INSERT      @G24LB26*/
         MVI   MSGLEN1,X'08'                                       1176
*       MSGTEXT1=ADDR(GROVVGRP);    /* GROUP NAME            @G24LB26*/
         L     @08,GROUPPTR                                        1177
         LA    @08,GROVVGRP(,@08)                                  1177
         STCM  @08,7,MSGTEXT1                                      1177
*       RESPECIFY                                                  1178
*         REG1 RSTD;                /*                       @G24LB26*/
*       REG1=ADDR(MSGRQ);           /* ADDR OF MSG PARM LIST @G24LB26*/
         LA    REG1,MSGRQ                                          1179
*       CALL ICBVOP00;              /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        1180
         BALR  @14,@15                                             1180
*       RESPECIFY                                                  1181
*         REG1 UNRSTD;              /*                       @G24LB26*/
*       RPLRCODE=SELFAIL;           /* SET REASON CODE TO    @G24LB26
*                                      232 HEX               @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        1182
*       RPLVRETC=RCFOUR;            /* RETURN CODE TO 4,     @G24LB26
*                                      FAIL REQUEST          @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1183
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00013 DS    0H                                                  1185
@EF00013 DS    0H                                                  1185
@ER00013 L     @14,@SA00013                                        1185
         BR    @14                                                 1185
*   END FINSELCT;                   /*                       @G24LB26*/
         B     @EL00013                                            1186
*                                                                  1187
*/********************************************************************/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - SORT                                    @G24LB26*/
*/*                                                          @Z40LB37*/
*/* FUNCTION - THIS PROCEDURE PROVIDES THE                   @G24LB26*/
*/*            CALLER WITH THE BASIC FUNCTION OF SORTING     @Z40LB37*/
*/*            A CONTIGUOUS AREA OF STORAGE OF ANY LENGTH,   @Z40LB37*/
*/*            OR ELEMENT (RECORD) SIZE.   IT ALLOWS         @Z40LB37*/
*/*            FIELDS TO BE SORTED PER USER CALL,            @G24LB26*/
*/*            ANYWHERE WITHIN AN ELEMENT (RECORD) FOR ANY   @Z40LB37*/
*/*            LENGTH EQUAL TO OR SMALLER THAN AN ELEMENTS   @Z40LB37*/
*/*            SIZE.                                         @G24LB26*/
*/*                                                          @Z40LB37*/
*/* INPUT  - ADDRESS OF ARGUMENT LIST (SRTAGL), AND THE BEST @Z40LB26*/
*/*          FIT TABLE. ALSO SORT WORK AREA IS PROVIDED.     @G24LB26*/
*/*                                                          @Z40LB37*/
*/* OUTPUT - A SORTED BEST FIT TABLE. NO RETURN CODE IS SET. @G24LB26*/
*/*                                                          @Z40LB37*/
*/********************************************************************/
*                                                                  1187
*SORT:                                                             1187
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1187
SORT     ST    @14,12(,@13)                                        1187
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE ENDING POSITION AND INITILIZE LOOP          @G24LB26*/
*   /* CONTROL AND END INDICATOR SWITCHES                    @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   SRTEND=SRTBEG+(SRTFLDLN-ONE);   /*                       @G24LB26*/
         LH    SRTEND,SRTFLDLN                                     1188
         BCTR  SRTEND,0                                            1188
         AH    SRTEND,SRTBEG                                       1188
*   SRTSTOP=OFF;                    /*                       @Z40LB37*/
*   SRTMOVE=OFF;                    /*                       @Z40LB37*/
         NI    SRTSTOP,B'00111111'                                 1190
*                                                                  1191
*   /*****************************************************************/
*   /*                                                               */
*   /* EXECUTE THE SORT LOOP USING THE MAXIMUM ELEMENTS      @Z40LB37*/
*   /* MINUS ONE FOR THE SRTI COUNTER AND DECREMENTING THE   @Z40LB37*/
*   /* THE SRTI COUNTER BY ONE EACH PASS. THE SRTJ COUNTER   @Z40LB37*/
*   /* IS USED TO COUNT THE ELEMENTS THRU EACH PASS AND IN-  @Z40LB37*/
*   /* CREMENT THE SRTJ COUNTER BY ONE AFTER EACH ELEMENT    @Z40LB37*/
*   /* IS COMPARED. THE SRTSTOP SWITCH IS USED TO TERM-      @Z40LB37*/
*   /* INATE THE SORT IF NO INTERCHANGE OF ELEMENTS TAKES    @Z40LB37*/
*   /* PLACE.                                                @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1191
*   DO SRTI=SRTNUM-ONE TO ONE BY-ONE/*                       @G24LB26*/
*         WHILE SRTSTOP=OFF;        /*                       @G24LB26*/
         LH    SRTI,SRTNUM                                         1191
         BCTR  SRTI,0                                              1191
         B     @DE01191                                            1191
@DL01191 TM    SRTSTOP,B'10000000'                                 1191
         BNZ   @DC01191                                            1191
*     DO SRTJ=ONE TO SRTI;          /*                       @Z40LB37*/
*                                                                  1192
         LA    SRTJ,1                                              1192
         B     @DE01192                                            1192
@DL01192 DS    0H                                                  1193
*       /*************************************************************/
*       /*                                                           */
*       /* COMPARE THE TWO ELEMENTS TO SEE IF AN INTER-      @Z40LB37*/
*       /* CHANGE SHOULD TAKE PLACE, USING THE PASSED SORT   @Z40LB37*/
*       /* FIELDS AS A SUBSTRING, IF SO INTERCHANGE THEM.    @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1193
*       IF SRTELEM(SRTJ,SRTBEG:SRTEND)>/*                    @G24LB26*/
*           SRTELEM(SRTJ+ONE,SRTBEG:SRTEND) THEN/*           @G24LB26*/
         L     @08,SRTADDR                                         1193
         LH    @15,SRTBEG                                          1193
         LR    @14,SRTJ                                            1193
         MH    @14,@CH02240                                        1193
         LR    @01,@14                                             1193
         ALR   @01,@15                                             1193
         LCR   @15,@15                                             1193
         ALR   @15,SRTEND                                          1193
         ST    @01,@TF00001                                        1193
         ALR   @01,@08                                             1193
         AL    @01,@CF02280                                        1193
         ST    @14,@TF00002                                        1193
         LR    @14,@08                                             1193
         AL    @14,@TF00001                                        1193
         BCTR  @14,0                                               1193
         EX    @15,@SC02281                                        1193
         BNH   @RF01193                                            1193
*         DO;                       /*                       @Z40LB37*/
*           SRTMOVE=ON;             /*                       @Z40LB37*/
         OI    SRTMOVE,B'01000000'                                 1195
*           SORTWORK=SRTELEM(SRTJ); /*                       @G24LB26*/
         LR    @01,@08                                             1196
         AL    @01,@TF00002                                        1196
         AL    @01,@CF02283                                        1196
         MVC   SORTWORK(18),SRTELEM(@01)                           1196
*           SRTELEM(SRTJ)=SRTELEM(SRTJ+ONE);/*               @Z40LB37*/
         LR    @01,@08                                             1197
         AL    @01,@TF00002                                        1197
         AL    @01,@CF02283                                        1197
         LR    @15,@08                                             1197
         AL    @15,@TF00002                                        1197
         MVC   SRTELEM(18,@01),SRTELEM(@15)                        1197
*           SRTELEM(SRTJ+ONE)=SORTWORK;/*                    @G24LB26*/
         AL    @08,@TF00002                                        1198
         MVC   SRTELEM(18,@08),SORTWORK                            1198
*         END;                      /*                       @Z40LB37*/
*     END;                          /*                       @Z40LB37*/
*                                                                  1200
@RF01193 AL    SRTJ,@CF00043                                       1200
@DE01192 CR    SRTJ,SRTI                                           1200
         BNH   @DL01192                                            1200
*     /***************************************************************/
*     /*                                                             */
*     /* IF AN ELEMENT WAS INTERCHANGED THEN TURN SRTMOVE    @Z40LB37*/
*     /* SWITCH OFF. IF NO INTERCHANGE WAS MADE TURN SORT    @Z40LB37*/
*     /* STOP SWITCH TO ON.                                  @Z40LB37*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1201
*     IF SRTMOVE=ON                 /*                       @G24LB26*/
*       THEN                        /*                       @G24LB26*/
         TM    SRTMOVE,B'01000000'                                 1201
         BNO   @RF01201                                            1201
*       SRTMOVE=OFF;                /*                       @Z40LB37*/
         NI    SRTMOVE,B'10111111'                                 1202
*     ELSE                          /*                       @G24LB26*/
*       SRTSTOP=ON;                 /*                       @Z40LB37*/
         B     @RC01201                                            1203
@RF01201 OI    SRTSTOP,B'10000000'                                 1203
*   END;                            /*                       @G24LB26*/
@RC01201 BCTR  SRTI,0                                              1204
@DE01191 LTR   SRTI,SRTI                                           1204
         BP    @DL01191                                            1204
@DC01191 DS    0H                                                  1205
*   RETURN;                         /*                       @G24LB26*/
@EL00014 DS    0H                                                  1205
@EF00014 DS    0H                                                  1205
@ER00014 L     @14,12(,@13)                                        1205
         BR    @14                                                 1205
*   END SORT;                       /*                       @G24LB26*/
*                                                                  1207
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - TESTENQ                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - THE ROUTINE DETERMINES IF THE VOLUME IS       @G24LB26*/
*/*            ENQUEUED OR NOT FOR THE TYPE OF USE THE       @G24LB26*/
*/*            VOLUME IS NEEDED FOR. THIS CAN BE EITHER      @G24LB26*/
*/*            SHARED OR EXCLUSIVE USE. IF THE REQUEST IS    @G24LB26*/
*/*            FOR SHARE, A TEST ENQ FOR SHARED USE IS       @G24LB26*/
*/*            ISSUED. IF THE REQUEST IS FOR EXCLUSIVE       @G24LB26*/
*/*            CONTROL, TEST ENQ FOR EXCLUSIVE USE IS        @G24LB26*/
*/*            ISSUED.                                       @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE BEST FIT TABLE AND THE INDEX INTO THE BEST   @G24LB26*/
*/*         FIT TABLE FOR THE VOLUME BEING PROCESSED.        @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - A RETURN CODE IN THE INTERNAL RETURN CODE AREA  @G24LB26*/
*/*             0 - VOLUME WILL NOT CAUSE A WAIT IF SELECTED @G24LB26*/
*/*             4 - VOLUME WOULD CAUSE REQUST TO WAIT IF     @G24LB26*/
*/*                 SELECTED                                 @G24LB26*/
*/*             8 - VOLUME UNUSABLE AT THIS TIME             @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1207
*TESTENQ:                                                          1207
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1207
TESTENQ  ST    @14,@SA00015                                        1207
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP REQUIRED PARAMETERS FOR THE TEST ENQ MACRO      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1208
*   TENQVOL=BFVOLID(INDXBFTB);      /* VOLID OF VOLUME       @G24LB26
*                                      BEING TESTED          @G24LB26*/
*                                                                  1208
         L     @08,BFTBLPTR                                        1208
         LR    @04,INDXBFTB                                        1208
         MH    @04,@CH02240                                        1208
         ALR   @04,@08                                             1208
         MVC   TENQVOL(6),BFVOLID-18(@04)                          1208
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REQUEST IS FOR EXCLUSIVE USE, A TEST ENQ FOR       @G24LB26*/
*   /* EXCLUSIVE USE MUST BE DONE.                           @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1209
*   IF BFNSHRFL=ON THEN             /*                       @G24LB26*/
         TM    BFNSHRFL(@08),B'10000000'                           1209
         BNO   @RF01209                                            1209
*     DO;                           /*                       @G24LB26*/
*       RESPECIFY                                                  1211
*         REG15 RSTD;               /*                       @G24LB26*/
*LENQ1:                                                            1212
*       GEN REFS(MAJRNAM,TENQVOL);                                 1212
*                                                                  1212
LENQ1    DS    0H                                                  1212
*                                                         /*@G24LB26*/
         ENQ (MAJRNAM,TENQVOL,E,6,SYSTEM),RET=TEST            @G24LB26
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN CODE FROM ENQ                        @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1213
*       IF REG15=ZERO THEN          /*                       @G24LB26*/
         LTR   REG15,REG15                                         1213
         BNZ   @RF01213                                            1213
*         INTERCC=RCZERO;           /* VOL IS NOT ENQUEUED   @G24LB26*/
         MVC   INTERCC(2),@CB02111                                 1214
*       ELSE                        /*                       @G24LB26*/
*                                                                  1215
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK NON ZERO RETURN CODE FROM ENQ             @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1215
*         IF ENQRETC=FOUR THEN      /*                       @G24LB26*/
         B     @RC01213                                            1215
@RF01213 CLI   ENQRETC(REG15),4                                    1215
         BNE   @RF01215                                            1215
*           INTERCC=RCFOUR;         /* VOL IS ENQUEUED       @G24LB26*/
*                                                                  1216
         MVC   INTERCC(2),@CB02113                                 1216
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE IS NOT ZERO OR FOUR,               @G24LB26*/
*       /* VOLUME IS NOT ELIGIBLE                            @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1217
*         ELSE                      /*                       @G24LB26*/
*           INTERCC=RCEIGHT;        /*                       @G24LB26*/
         B     @RC01215                                            1217
@RF01215 MVC   INTERCC(2),@CB02115                                 1217
*       RESPECIFY                                                  1218
*         REG15 UNRSTD;             /*                       @G24LB26*/
@RC01215 DS    0H                                                  1218
@RC01213 DS    0H                                                  1219
*     END;                          /*                       @G24LB26*/
*                                                                  1219
*   /*****************************************************************/
*   /*                                                               */
*   /* REQUEST IS FOR SHARED USE, SO PROCESS ON THAT BASIS   @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1220
*   ELSE                            /*                       @G24LB26*/
*     DO;                           /*                       @G24LB26*/
*                                                                  1220
         B     @RC01209                                            1220
@RF01209 DS    0H                                                  1221
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF ISSUING A TEST ENQ IS NECESSARY      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1221
*       IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOTH(INDXBFTB)=OFF/*   @G24LB26*/
*           &BFCONUSE(INDXBFTB)>ZERO&BFWAITFL(INDXBFTB)/*    @G24LB26*/
*           =OFF THEN               /*                       @G24LB26*/
         L     @08,BFTBLPTR                                        1221
         LR    @04,INDXBFTB                                        1221
         MH    @04,@CH02240                                        1221
         ST    @04,@TF00001                                        1221
         ALR   @04,@08                                             1221
         TM    BFNOTMTD-18(@04),B'11000000'                        1221
         BNZ   @RF01221                                            1221
         L     @04,@TF00001                                        1221
         SLR   @15,@15                                             1221
         IC    @15,BFCONUSE-18(@04,@08)                            1221
         C     @15,@CF00084                                        1221
         BNH   @RF01221                                            1221
         AL    @08,@TF00001                                        1221
         TM    BFWAITFL-18(@08),B'01000000'                        1221
         BNZ   @RF01221                                            1221
*         INTERCC=RCZERO;           /*                       @G24LB26*/
*                                                                  1222
         MVC   INTERCC(2),@CB02111                                 1222
*       /*************************************************************/
*       /*                                                           */
*       /* IF ABOVE TEST WAS NOT MET, A TEST ENQ FOR SHARED  @G24LB26*/
*       /* USE MUST BE ISSUED                                @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1223
*       ELSE                        /*                       @G24LB26*/
*         DO;                       /*                       @G24LB26*/
         B     @RC01221                                            1223
@RF01221 DS    0H                                                  1224
*           RESPECIFY                                              1224
*             REG15 RSTD;           /*                       @G24LB26*/
*LENQ2:                                                            1225
*           GEN REFS(MAJRNAM,TENQVOL);                             1225
*                                                                  1225
LENQ2    DS    0H                                                  1225
*                                                         /*@G24LB26*/
         ENQ (MAJRNAM,TENQVOL,S,6,SYSTEM),RET=TEST            @G24LB26
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK RETURN CODE FROM ENQ                    @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1226
*           IF REG15=ZERO THEN      /*                       @G24LB26*/
         LTR   REG15,REG15                                         1226
         BNZ   @RF01226                                            1226
*             INTERCC=RCZERO;       /* VOL IS NOT ENQ EXCL   @G24LB26*/
         MVC   INTERCC(2),@CB02111                                 1227
*           ELSE                    /*                       @G24LB26*/
*             IF ENQRETC=FOUR THEN  /*                       @G24LB26*/
         B     @RC01226                                            1228
@RF01226 CLI   ENQRETC(REG15),4                                    1228
         BNE   @RF01228                                            1228
*               INTERCC=RCFOUR;     /* VOL IS ENQ EXCLUSIVE  @G24LB26*/
*                                                                  1229
         MVC   INTERCC(2),@CB02113                                 1229
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN CODE IS NEITHER ZERO OR FOUR, SO       @G24LB26*/
*           /* VOLUME IS NOT USABLE                          @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1230
*             ELSE                  /*                       @G24LB26*/
*               INTERCC=RCEIGHT;    /*                       @G24LB26*/
         B     @RC01228                                            1230
@RF01228 MVC   INTERCC(2),@CB02115                                 1230
*           RESPECIFY                                              1231
*             REG15 UNRSTD;         /*                       @G24LB26*/
@RC01228 DS    0H                                                  1231
@RC01226 DS    0H                                                  1232
*         END;                      /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00015 DS    0H                                                  1234
@EF00015 DS    0H                                                  1234
@ER00015 L     @14,@SA00015                                        1234
         BR    @14                                                 1234
*   END TESTENQ;                    /*                       @G24LB26*/
         B     @EL00015                                            1235
*                                                                  1236
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - JESINTF                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - THE ROUTINE SETS UP THE REQUIRED INTERFACE    @G24LB26*/
*/*            THRU THE SUBSYSTEM INTERFACE TO CONTACT JES3. @G24LB26*/
*/*            IT THEN INTERPRETS THE RETURN FROM JES3 AND   @G24LB26*/
*/*            THE SUBSYSTEM INTERFACE TO DETERMINE IF THE   @G24LB26*/
*/*            VOLUME IS ELIGIBLE FOR THIS REQUEST OR NOT.   @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE ADDRESS OF THE SUBSYSTEM CONTROL BLOCK       @G24LB26*/
*/*         SSOB. THE BEST FIT TABLE ALONG WITH THE INDEX    @G24LB26*/
*/*         INTO THE BEST FIT TABLE OF THE VOLUME CURRENTLY  @G24LB26*/
*/*         BEING PROCESSED. THE SELECT REQUEST BLOCK.       @G24LB26*/
*/*         THE ADDRESS OF THE SSOB IS IN VVICB. THE SSOB    @G24LB26*/
*/*         CONTAINS THE ADDRESS OF THE SSOBMO.              @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - A ZERO REASON AND RETURN CODE IN THE RPLV IF    @G24LB26*/
*/*          JES3 PROCESSED THE REQUEST SUCCESSFULLY. A      @G24LB26*/
*/*          NON-ZERO REASON AND RETURN IN RPLV IF SUB-      @G24LB26*/
*/*          SYSTEM OR JES3 ERRORS.                          @G24LB26*/
*/*          IF THE REQUEST WAS SUCCESSFULLY PROCESSED, THE  @G24LB26*/
*/*          INTERNAL RETURN CODE WILL CONTAIN EITHER ZERO   @G24LB26*/
*/*          IF THE VOLUME IS ELIGIBLE TO BE SELECTED FOR    @G24LB26*/
*/*          THIS REQUEST, OR A FOUR IF THE VOLUME IS NOT A  @G24LB26*/
*/*          CANDIDATE FOR SELECTION.                        @G24LB26*/
*/*          ISSUES MESSAGE ICB479I.                         @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1236
*JESINTF:                                                          1236
*   PROC OPTIONS(SAVEAREA);         /*                       @G24LB26*/
*                                                                  1236
JESINTF  STM   @14,@12,12(@13)                                     1236
         ST    @13,@SA00016+4                                      1236
         LA    @14,@SA00016                                        1236
         ST    @14,8(,@13)                                         1236
         LR    @13,@14                                             1236
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE PARAMETER LIST FOR THE SUBSYSTEM           @G24LB26*/
*   /* INTERFACE. START BY SETTING AN INDICATOR TELLING IF   @G24LB26*/
*   /* VOLUME IS MOUNTED OR NOT.                             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1237
*   IF BFNOTMTD(INDXBFTB)=OFF THEN  /*                       @G24LB26*/
         LR    @08,INDXBFTB                                        1237
         MH    @08,@CH02240                                        1237
         L     @04,BFTBLPTR                                        1237
         ALR   @04,@08                                             1237
         TM    BFNOTMTD-18(@04),B'10000000'                        1237
         BNZ   @RF01237                                            1237
*     SSMOMNTD=ON;                  /* VOLUME MOUNTED        @G24LB26*/
         L     @08,VVIPTR                                          1238
         L     @08,VVISSOBA(,@08)                                  1238
         L     @08,SSOBINDV(,@08)                                  1238
         OI    SSMOMNTD(@08),B'00001000'                           1238
*   ELSE                            /*                       @G24LB26*/
*     SSMOMNTD=OFF;                 /* VOLUME NOT MOUNTED    @G24LB26*/
         B     @RC01237                                            1239
@RF01237 L     @08,VVIPTR                                          1239
         L     @08,VVISSOBA(,@08)                                  1239
         L     @08,SSOBINDV(,@08)                                  1239
         NI    SSMOMNTD(@08),B'11110111'                           1239
*   SSMOPNAM=ADDR(SELJOBNM);        /* JOB NAME ADDR         @G24LB26*/
@RC01237 L     @08,VVIPTR                                          1240
         L     @08,VVISSOBA(,@08)                                  1240
         L     @04,SSOBINDV(,@08)                                  1240
         LA    @15,SELJOBNM(,SELTMPTR)                             1240
         ST    @15,SSMOPNAM(,@04)                                  1240
*   SSMOPSTN=ADDR(SELSTNUM);        /* STEP NUMBER ADDR      @G24LB26*/
*                                                                  1241
         LA    @15,SELSTNUM(,SELTMPTR)                             1241
         ST    @15,SSMOPSTN(,@04)                                  1241
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE VOLID CURRENTLY INTO THE SELECT REQUEST BLOCK    @G24LB26*/
*   /* SO SUBSYSTEM INTERFACE HAS ACCESS TO IT.              @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1242
*   VOLSER(NUMCHOS+ONE)=BFVOLID(INDXBFTB);/*                 @G24LB26*/
         SLR   @15,@15                                             1242
         IC    @15,NUMCHOS                                         1242
         MH    @15,@CH00215                                        1242
         L     @14,SELVLRET(,SELTMPTR)                             1242
         ST    @15,@TF00001                                        1242
         ALR   @15,@14                                             1242
         LR    @03,INDXBFTB                                        1242
         MH    @03,@CH02240                                        1242
         L     @01,BFTBLPTR                                        1242
         ALR   @01,@03                                             1242
         MVC   VOLSER(6,@15),BFVOLID-18(@01)                       1242
*   SSMOPVOL=ADDR(VOLSER(NUMCHOS+ONE));/* ADDR OF VOLID      @G24LB26*/
         L     @15,@TF00001                                        1243
         LA    @15,VOLSER(@15,@14)                                 1243
         ST    @15,SSMOPVOL(,@04)                                  1243
*   SSMOPDDN=ADDR(SELDDNAM);        /* ADDR OF DDNAME        @G24LB26*/
         LA    @15,SELDDNAM(,SELTMPTR)                             1244
         ST    @15,SSMOPDDN(,@04)                                  1244
*   SSMOPRPN=ADDR(SELDDCAT);        /* ADDR OF CONCAT NUMBER @G24LB26*/
*                                                                  1245
         LA    @15,SELDDCAT(,SELTMPTR)                             1245
         ST    @15,SSMOPRPN(,@04)                                  1245
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR RETURN CODE AREA USED BY SUBSYSTEM FOR          @G24LB26*/
*   /* RETURN CODE.                                          @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1246
*   SSOBRETN=ZEROPTR;               /* CLEAR RETURN CODE     @G24LB26*/
         SLR   @04,@04                                             1246
         ST    @04,SSOBRETN(,@08)                                  1246
*   RESPECIFY                                                      1247
*     REG15 RSTD;                   /*                       @G24LB26*/
*                                                                  1247
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MACRO TO INVOKE SUBSYSTEM INTERFACE             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1248
*/*   ? IEFSSREQ  (SSOB);                                            */
*/*                                                                  */
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */
*/*  PROCESS REQUEST -                                               */
*/*                                                                  */
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */
*/*            WORD PARAMETER LIST WHICH                             */
*/*            POINTS TO THE SSOB                                    */
*/*                                                                  */
*                                                                  1248
*   CALL SSREQ(SSOB);               /*                       @G24LB26*/
*                                                                  1248
         ST    @08,@AL00001                                        1248
         MVI   @AL00001,X'80'                                      1248
         L     @08,CVTPTR                                          1248
         L     @08,CVTJESCT(,@08)                                  1248
         L     @15,JESSSREQ(,@08)                                  1248
         LA    @01,@AL00001                                        1248
         BALR  @14,@15                                             1248
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK ON RETURN CODE FROM SUBSYSTEM INTERFACE AND     @G24LB26*/
*   /* JES3                                                  @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1249
*   IF REG15=SSRTOK THEN            /*                       @G24LB26*/
         SLR   @14,@14                                             1249
         CR    REG15,@14                                           1249
         BNE   @RF01249                                            1249
*     DO;                           /*                       @G24LB26*/
*                                                                  1250
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN CODE IN SSOB. IF ZERO, VOLUME        @G24LB26*/
*       /* OK TO SELECT                                      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1251
*       IF SSOBRETN=SSMOVOLA THEN   /*                       @G24LB26*/
         L     @08,VVIPTR                                          1251
         L     @08,VVISSOBA(,@08)                                  1251
         C     @14,SSOBRETN(,@08)                                  1251
         BNE   @RF01251                                            1251
*         INTERCC=RCZERO;           /*                       @G24LB26*/
         MVC   INTERCC(2),@CB02111                                 1252
*       ELSE                        /*                       @G24LB26*/
*                                                                  1253
*         /***********************************************************/
*         /*                                                         */
*         /* IF FOUR RETURN, VOLUME IS BUSY AND THEREFORE    @G24LB26*/
*         /* NOT ELIGIBLE.                                   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1253
*         IF SSOBRETN=SSMOVOLB THEN /*                       @G24LB26*/
*                                                                  1253
         B     @RC01251                                            1253
@RF01251 L     @14,VVIPTR                                          1253
         L     @14,VVISSOBA(,@14)                                  1253
         CLC   SSOBRETN(4,@14),@CF00064                            1253
         BNE   @RF01253                                            1253
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE MESSAGE ICB479I AND SET INTERNAL        @G24LB26*/
*           /* RETURN CODE TO 4.                             @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1254
*           DO;                     /*                       @G24LB26*/
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM FIELD  @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     1255
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     1256
*             MSGID=MSG479;         /* MSG ID FOR ICB479I    @G24LB26*/
         MVC   MSGID(4),@CF02071                                   1257
*             MSGLEN1=SIX;          /* LENGTH OF VOLID       @G24LB26*/
         MVI   MSGLEN1,X'06'                                       1258
*             MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID      @G24LB26*/
         LR    @14,INDXBFTB                                        1259
         MH    @14,@CH02240                                        1259
         L     @08,BFTBLPTR                                        1259
         LA    @14,BFVOLID-18(@14,@08)                             1259
         STCM  @14,7,MSGTEXT1                                      1259
*             RESPECIFY                                            1260
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=ADDR(MSGRQ);     /* ADDR MSG PARM LIST    @G24LB26*/
         LA    REG1,MSGRQ                                          1261
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        1262
         BALR  @14,@15                                             1262
*             RESPECIFY                                            1263
*               REG1 UNRSTD;        /*                       @G24LB26*/
*             INTERCC=RCFOUR;       /* INDICATE VOLUME NOT   @G24LB26
*                                      ELIGIBLE              @G24LB26*/
         MVC   INTERCC(2),@CB02113                                 1264
*           END;                    /*                       @G24LB26*/
*         ELSE                      /*                       @G24LB26*/
*                                                                  1266
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN CODE NOT VALID FROM SUBSYSTEM          @G24LB26*/
*           /* INTERFACE.                                    @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1266
*           DO;                     /*                       @G24LB26*/
*                                                                  1266
         B     @RC01253                                            1266
@RF01253 DS    0H                                                  1267
*             /*******************************************************/
*             /*                                                     */
*             /* SET REASON AND RETURN CODES IN RPLV         @G24LB26*/
*             /* BECAUSE OF BAD RETURN CODE FROM SUBSYSTEM   @G24LB26*/
*             /* INTERFACE.                                  @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1267
*             RPLVRETC=RCFOUR;      /* RETURN CODE 4         @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1267
*             RPLRCODE=INVALRET;    /* REASON CODE OF 265 HEX      1268
*                                                            @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02099                        1268
*           END;                    /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*                                                                  1270
*   /*****************************************************************/
*   /*                                                               */
*   /* SINCE REG15 DOES NOT HAVE A ZERO RETURN CODE,         @G24LB26*/
*   /* CHECK ON WHAT IT IS.                                  @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1271
*   ELSE                            /*                       @G24LB26*/
*     DO;                           /*                       @G24LB26*/
         B     @RC01249                                            1271
@RF01249 DS    0H                                                  1272
*       IF REG15=SSRTNSUPREG15=SSRTNTUPREG15=SSRTNOSS/*    @G24LB26*/
*         THEN                      /*                       @G24LB26*/
*                                                                  1272
         C     REG15,@CF00064                                      1272
         BE    @RT01272                                            1272
         C     REG15,@CF00040                                      1272
         BE    @RT01272                                            1272
         C     REG15,@CF00032                                      1272
         BNE   @RF01272                                            1272
@RT01272 DS    0H                                                  1273
*         /***********************************************************/
*         /*                                                         */
*         /* SUBSYSTEM IS NOT UP, NOT SUPPORTED OR DOES      @G24LB26*/
*         /* NOT EXIST                                       @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1273
*         INTERCC=RCZERO;           /* GO AHEAD & SELECT VOL @G24LB26*/
         MVC   INTERCC(2),@CB02111                                 1273
*       ELSE                        /*                       @G24LB26*/
*         IF REG15=SSRTDIST THEN    /*                       @G24LB26*/
         B     @RC01272                                            1274
@RF01272 C     REG15,@CF00112                                      1274
         BNE   @RF01274                                            1274
*           DO;                     /*                       @G24LB26*/
*                                                                  1275
*             /*******************************************************/
*             /*                                                     */
*             /* SUBSYSTEM ENCOUNTERED DISASTEROUS ERROR     @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1276
*             RPLRCODE=DISAEROR;    /* REASON CODE 262 HEX   @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02093                        1276
*             RPLVRETC=RCFOUR;      /* RETURN CODE 4         @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1277
*           END;                    /*                       @G24LB26*/
*         ELSE                      /*                       @G24LB26*/
*           IF REG15=SSRTLERR THEN  /*                       @G24LB26*/
         B     @RC01274                                            1279
@RF01274 C     REG15,@CF01851                                      1279
         BNE   @RF01279                                            1279
*             DO;                   /*                       @G24LB26*/
*                                                                  1280
*               /*****************************************************/
*               /*                                                   */
*               /* SUBSYSTEM ENCOUNTERED LOGICAL ERROR       @G24LB26*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1281
*               RPLVRETC=RCFOUR;    /* RETURN CODE 4         @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1281
*               RPLRCODE=LOGICERR;  /* HEX CODE 263          @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02095                        1282
*             END;                  /*                       @G24LB26*/
*                                                                  1283
*       /*************************************************************/
*       /*                                                           */
*       /* REG 15 DOES NOT CONTAIN A VALID RETURN CODE       @G24LB26*/
*       /* OF 0, 4, 8, 12, 16, OR 20.                        @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1284
*           ELSE                    /*                       @G24LB26*/
*             DO;                   /*                       @G24LB26*/
         B     @RC01279                                            1284
@RF01279 DS    0H                                                  1285
*               RPLVRETC=RCFOUR;    /* RETURN CODE OF 4      @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1285
*               RPLRCODE=INVALERR;  /* REASON CODE 264 HEX   @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02097                        1286
*             END;                  /*                       @G24LB26*/
*     END;                          /*                       @G24LB26*/
*   RESPECIFY                                                      1289
*     REG15 UNRSTD;                 /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00016 L     @13,4(,@13)                                         1290
@EF00016 DS    0H                                                  1290
@ER00016 LM    @14,@12,12(@13)                                     1290
         BR    @14                                                 1290
*   END JESINTF;                    /*                       @G24LB26*/
         B     @EL00016                                            1291
*                                                                  1292
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - UPDTMSVI                                @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - READS THE EXTENSION RECORDS AND UPDATES THE   @G24LB26*/
*/*            AVAILABLE RUNNING SPACE. ALSO UPDATES THE     @G24LB26*/
*/*            EXPIRATION DATE IN BOTH THE BASE VOLUME AND   @G24LB26*/
*/*            EXTENSION RECORDS IF IT WAS MODIFIED AND      @G24LB26*/
*/*            JOURNALS THE EXPIRATION DATE CHANGE.          @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - THE BEST FIT TABLE, THE GROUP RECORD, THE GROUP  @G24LB26*/
*/*         EXTENSION RECORDS, THE NUMBER OF VOLUMES         @G24LB26*/
*/*         SELECTED FOR THIS REQUEST AND THE AMOUNT OF      @G24LB26*/
*/*         PRIMARY SPACE ALLOCATED FOR THIS REQUEST IN      @G24LB26*/
*/*         CYLINDERS.                                       @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - GROUP EXTENSION RECORD UPDATED WITH NEW RUNNING @G24LB26*/
*/*          SPACE FOR PRIMARY VOLUME, PLUS EXPIRATION DATE  @G24LB26*/
*/*          UPDATED FOR ANY VOLUME CHOSEN WITH A NULL       @G24LB26*/
*/*          EXPIRATION DATE IF VOLUME IS IN A RETENTION     @G24LB26*/
*/*          GROUP. BASE VOLUME RECORDS EXPIRATION DATE IS   @G24LB26*/
*/*          UPDATED IF IT CHANGED. ANY EXPIRATION DATE      @G24LB26*/
*/*          CHANGES ARE JOURNALED. ALSO, IT INITIALIZES A   @G24LB26*/
*/*          FIELD IN AN INTERNAL PARAMETER LIST WITH        @G24LB26*/
*/*          THE INDEX INTO THE BEST FIT TABLE, OF THE       @G24LB26*/
*/*          VOLUME SELECTED FOR PRIMARY.                    @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1292
*UPDTMSVI:                                                         1292
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1292
UPDTMSVI ST    @14,@SA00017                                        1292
*   /*****************************************************************/
*   /*                                                               */
*   /* SET SWITCHES CONTROLLING INITIAL I/O FOR EXTENSION    @G24LB26*/
*   /* RECORD.                                               @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1293
*   UPDTGVSN=OFF;                   /* GVSNE NOT UPDATED YET @G24LB26*/
*   BASEREAD=ON;                    /* GVSNE WILL BE READ    @G24LB26
*                                      FOR UPDATE ON FIRST   @G24LB26
*                                      PASS                  @G24LB26*/
*   EXITSW=OFF;                     /* EXIT LOOP SWITCH      @G24LB26*/
*   ERRORSW=OFF;                    /* NO ERRORS YET         @G24LB26*/
*                                                                  1296
         OI    BASEREAD,B'01000000'                                1296
         NI    UPDTGVSN,B'01100111'                                1296
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF BEST FIT TABLE NEEDS TO BE SORTED        @G24LB26*/
*   /* BY EXTENSION INDEX FOR EFFICIENCY OF I/O OPERATION.   @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1297
*   IF NUMBVOL>TWO&GRORETN=ON THEN  /*                       @G24LB26*/
         CLI   NUMBVOL,2                                           1297
         BNH   @RF01297                                            1297
         L     @08,GROUPPTR                                        1297
         TM    GRORETN(@08),B'00000100'                            1297
         BNO   @RF01297                                            1297
*     DO;                           /*                       @G24LB26*/
*                                                                  1298
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARAMETER LIST TO CALL SORT ROUTINE        @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1299
*       SRTADDR=ADDR(BFSLOT(ONE));  /* ADDR OF FIRST ENTRY   @G24LB26*/
         L     @08,BFTBLPTR                                        1299
         LA    @06,BFSLOT(,@08)                                    1299
         ST    @06,SRTADDR                                         1299
*       SRTNUM=BFTOTIDX;            /* NO OF ELE IN ARRAY    @G24LB26*/
         LH    @04,BFTOTIDX(,@08)                                  1300
         STH   @04,SRTNUM                                          1300
*       SRTLEN=LENGTH(BFSLOT);      /* LENGTH OF ONE ELE     @G24LB26*/
         MVC   SRTLEN(2),@CH02240                                  1301
*       SRTBEG=ADDR(BFGRPIDX(ONE))-ADDR(BFSLOT(ONE));/*      @G24LB26
*                                      START OF SORT FIELD   @G24LB26*/
*                                                                  1302
         LA    @08,BFGRPIDX(,@08)                                  1302
         SLR   @08,@06                                             1302
         STH   @08,SRTBEG                                          1302
*       /*************************************************************/
*       /*                                                           */
*       /* CHANGE FROM STARTING OFFSET TO STARTING COLUMN    @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1303
*       SRTBEG=SRTBEG+ONE;          /* CHANGE TO START COL   @G24LB26*/
         LA    @06,1                                               1303
         ALR   @08,@06                                             1303
         STH   @08,SRTBEG                                          1303
*       SRTFLDLN=LENGTH(BFGRPIDX(ONE));/* LENGTH OF SORT     @G24LB26
*                                      FIELD                 @G24LB26*/
*                                                                  1304
         STH   @06,SRTFLDLN                                        1304
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SORT PROCEDURE                               @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1305
*       CALL SORT;                  /*                       @G24LB26*/
         BAL   @14,SORT                                            1305
*     END;                          /*                       @G24LB26*/
*                                                                  1306
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU BEST FIT TABEL UPDATING NECESSARY RECORDS.  @G24LB26*/
*   /* START AT BOTTOM SINCE THAT GVSNE IS THE MOST LIKELY   @G24LB26*/
*   /* TO BE IN CORE CURRENTLY.                              @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1307
*   DO INDXBFTB=BFTOTIDX TO ONE BY-ONE WHILE EXITSW=OFF;/*   @G24LB26*/
*                                                                  1307
@RF01297 L     @08,BFTBLPTR                                        1307
         LH    INDXBFTB,BFTOTIDX(,@08)                             1307
         B     @DE01307                                            1307
@DL01307 TM    EXITSW,B'00010000'                                  1307
         BNZ   @DC01307                                            1307
*     /***************************************************************/
*     /*                                                             */
*     /* LOOK FOR VOLUME SELECTED FOR EITHER PRIMARY OR      @G24LB26*/
*     /* SECONDARY ALLOCATION AND DETERMINE IF ANY UPDATES   @G24LB26*/
*     /* COULD BE NECESSARY.                                 @G24LB26*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1308
*     IF BFSELPRI(INDXBFTB)=ON(BFSELSEC(INDXBFTB)=ON/*      @G24LB26*/
*         &GRORETN=ON) THEN         /*                       @G24LB26*/
         L     @08,BFTBLPTR                                        1308
         LR    @04,INDXBFTB                                        1308
         MH    @04,@CH02240                                        1308
         ST    @04,@TF00001                                        1308
         ALR   @04,@08                                             1308
         TM    BFSELPRI-18(@04),B'00100000'                        1308
         BO    @RT01308                                            1308
         AL    @08,@TF00001                                        1308
         TM    BFSELSEC-18(@08),B'00010000'                        1308
         BNO   @RF01308                                            1308
         L     @08,GROUPPTR                                        1308
         TM    GRORETN(@08),B'00000100'                            1308
         BNO   @RF01308                                            1308
@RT01308 DS    0H                                                  1309
*       DO;                         /*                       @G24LB26*/
*                                                                  1309
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO SEE IF GVSNE ALREADY IN BUFFER AREA.   @G24LB26*/
*         /* IF NOT, WRITE OLD RECORD IF NECESSARY AND       @G24LB26*/
*         /* READ GROUP EXTENSION RECORD.                    @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1310
*         IF GVSNO^=BFGRPIDX(INDXBFTB) THEN/*                @G24LB26*/
         L     @08,GVSNEPTR                                        1310
         LR    @04,INDXBFTB                                        1310
         MH    @04,@CH02240                                        1310
         SLR   @15,@15                                             1310
         IC    @15,GVSNO(,@08)                                     1310
         L     @14,BFTBLPTR                                        1310
         SLR   @03,@03                                             1310
         IC    @03,BFGRPIDX-18(@04,@14)                            1310
         CR    @15,@03                                             1310
         BE    @RF01310                                            1310
*           DO;                     /*                       @G24LB26*/
*                                                                  1311
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF OLD GVSNE MUST BE WRITTEN      @G24LB26*/
*             /* TO THE MSVI                                 @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1312
*             IF UPDTGVSN=ON THEN   /* REC MUST BE WRITTEN   @G24LB26*/
         TM    UPDTGVSN,B'10000000'                                1312
         BNO   @RF01312                                            1312
*               DO;                 /*                       @G24LB26*/
*                                                                  1313
*                 /***************************************************/
*                 /*                                                 */
*                 /* CHECK IF THE RECORD MUST BE RE-READ     @G24LB26*/
*                 /* FOR UPDATE BEFORE IT CAN BE WRITTEN.    @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1314
*                 IF BASEREAD=ON THEN/*                      @G24LB26*/
         TM    BASEREAD,B'01000000'                                1314
         BNO   @RF01314                                            1314
*                   DO;             /*                       @G24LB26*/
*                                                                  1315
*                     /***********************************************/
*                     /*                                             */
*                     /* READ EXTENSION RECORD CURRENTLY     @G24LB26*/
*                     /* IN STORAGE FOR UPDATE               @G24LB26*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  1316
*                     GKEY=GVSNAME; /* SET UP KEY FOR THIS   @G24LB26
*                                      READ                  @G24LB26*/
         MVC   GKEY(13),GVSNAME(@08)                               1316
*                     RPLVKEY=ADDR(GKEY);/* KEY TO READ FOR  @G24LB26*/
         LA    @08,GKEY                                            1317
         ST    @08,RPLVKEY(,RPLVPTR)                               1317
*                     RPLVBUF=ADDR(DUMMYBUF);/* ADDR OF      @G24LB26
*                                      BUFFER                @G24LB26*/
         LA    @08,DUMMYBUF                                        1318
         ST    @08,RPLVBUF(,RPLVPTR)                               1318
*                     RPLVBLN=LENGTH(DUMMYBUF);/* LENGTH     @G24LB26
*                                      OF BUFFER             @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1319
*                     RPLVDIR=ON;   /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1320
*                     RPLVTYP=RPLVREAD;/* READ REQUEST       @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1321
*                     RPLVUPD=ON;   /* FOR UPDATE            @G24LB26*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1322
*                     RESPECIFY                                    1323
*                       REG1 RSTD;  /*                       @G24LB26*/
*                     REG1=RPLVPTR; /* ADDR PRLV             @G24LB26*/
         LR    REG1,RPLVPTR                                        1324
*                     CALL ICBVIO00;/* READ EXT REC          @G24LB26*/
         L     @15,@CV01910                                        1325
         BALR  @14,@15                                             1325
*                     RESPECIFY                                    1326
*                       REG1 UNRSTD;/*                       @G24LB26*/
*                   END;            /*                       @G24LB26*/
*                                                                  1327
*                 /***************************************************/
*                 /*                                                 */
*                 /* WRITE EXTENSION RECORD NOW IN BUFFER    @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1328
*                 RPLVBUF=ADDR(STORGPEX);/* ADDR OF RECORD   @G24LB26
*                                      IN BUFFER             @G24LB26*/
@RF01314 LA    @08,STORGPEX                                        1328
         ST    @08,RPLVBUF(,RPLVPTR)                               1328
*                 RPLVTYP=RPLVPUT;  /* PUT RECORD            @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1329
*                 RESPECIFY                                        1330
*                   REG1 RSTD;      /*                       @G24LB26*/
*                 REG1=RPLVPTR;     /* ADDR OF RPLV          @G24LB26*/
         LR    REG1,RPLVPTR                                        1331
*                 CALL ICBVIO00;    /* WRITE EXTENSION       @G24LB26*/
         L     @15,@CV01910                                        1332
         BALR  @14,@15                                             1332
*                 RESPECIFY                                        1333
*                   REG1 UNRSTD;    /*                       @G24LB26*/
*                 RPLVRETC=RCZERO;  /* CLEAR RETURN CODE     @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1334
*                 RPLRCODE=RCZERO;  /* CLEAR REASON CODE     @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1335
*                 UPDTGVSN=OFF;     /* INDICATE NO LONGER    @G24LB26
*                                      NEEDS TO BE WRITTEN   @G24LB26*/
         NI    UPDTGVSN,B'01111111'                                1336
*               END;                /*                       @G24LB26*/
*                                                                  1337
*             /*******************************************************/
*             /*                                                     */
*             /* READ THE NEW EXTENSION RECORD FOR UPDATE    @G24LB26*/
*             /* SINCE IT IS NOT IN THE BUFFER.              @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1338
*             GIDKY=BFGRPIDX(INDXBFTB);/* INDEX OF EXT       @G24LB26
*                                      TO READ               @G24LB26*/
@RF01312 LR    @08,INDXBFTB                                        1338
         MH    @08,@CH02240                                        1338
         L     @04,BFTBLPTR                                        1338
         SLR   @15,@15                                             1338
         IC    @15,BFGRPIDX-18(@08,@04)                            1338
         STC   @15,GIDKY                                           1338
*             RPLVKEY=ADDR(GKEY);   /* ADDR OF KEY           @G24LB26*/
         LA    @08,GKEY                                            1339
         ST    @08,RPLVKEY(,RPLVPTR)                               1339
*             RPLVBUF=ADDR(STORGPEX);/* ADDR OF BUFFER       @G24LB26*/
         LA    @08,STORGPEX                                        1340
         ST    @08,RPLVBUF(,RPLVPTR)                               1340
*             RPLVBLN=LENGTH(STORGPEX);/* LENGTH OF BUFFER   @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1341
*             RPLVDIR=ON;           /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1342
*             RPLVTYP=RPLVREAD;     /* READ RECORD           @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1343
*             RPLVUPD=ON;           /* FOR UPDATE            @G24LB26*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1344
*             RESPECIFY                                            1345
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=RPLVPTR;         /* ADDR OF RPLV          @G24LB26*/
         LR    REG1,RPLVPTR                                        1346
*             CALL ICBVIO00;        /* READ EXT RECORD       @G24LB26*/
         L     @15,@CV01910                                        1347
         BALR  @14,@15                                             1347
*             RESPECIFY                                            1348
*               REG1 UNRSTD;        /*                       @G24LB26*/
*             RPLVRETC=RCZERO;      /* CLEAR RETURN CODE     @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1349
*             RPLRCODE=RCZERO;      /* CLEAR REASON CODE     @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1350
*             BASEREAD=OFF;         /* INDICATE NO LONGER    @G24LB26
*                                      NECESSARY READ EXT    @G24LB26
*                                      FOR UPDATE            @G24LB26*/
         NI    BASEREAD,B'10111111'                                1351
*           END;                    /*                       @G24LB26*/
*                                                                  1352
*         /***********************************************************/
*         /*                                                         */
*         /* PROPER EXTENSION RECORD IS NOW IN THE BUFFER    @G24LB26*/
*         /* AND CAN THEREFORE BE UPDATED AS NECESSARY.      @G24LB26*/
*         /* IF THE VOLUME IS A PRIMARY, UPDATE THE SPACE.   @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1353
*         IF BFSELPRI(INDXBFTB)=ON THEN/*                    @G24LB26*/
@RF01310 L     @08,BFTBLPTR                                        1353
         LR    @04,INDXBFTB                                        1353
         MH    @04,@CH02240                                        1353
         ST    @04,@TF00001                                        1353
         ALR   @04,@08                                             1353
         TM    BFSELPRI-18(@04),B'00100000'                        1353
         BNO   @RF01353                                            1353
*           DO;                     /*                       @G24LB26*/
*             GVSMTDSP(BFGRPSLT(INDXBFTB))=/*                @G24LB26*/
*                 GVSMTDSP(BFGRPSLT(INDXBFTB))-PRICYL;/*     @G24LB26*/
*                                                                  1355
         L     @04,GVSNEPTR                                        1355
         L     @01,@TF00001                                        1355
         SLR   @15,@15                                             1355
         IC    @15,BFGRPSLT-18(@01,@08)                            1355
         MH    @15,@CH01851                                        1355
         LH    @08,GVSMTDSP-20(@15,@04)                            1355
         SH    @08,PRICYL                                          1355
         STH   @08,GVSMTDSP-20(@15,@04)                            1355
*             /*******************************************************/
*             /*                                                     */
*             /* IF VALUE WENT NEGATIVE, SET IT TO ZERO      @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1356
*             IF GVSMTDSP(BFGRPSLT(INDXBFTB))<ZERO THEN/*    @G24LB26*/
         SLR   @14,@14                                             1356
         CR    @08,@14                                             1356
         BNL   @RF01356                                            1356
*               GVSMTDSP(BFGRPSLT(INDXBFTB))=ZERO;/*         @G24LB26*/
*                                                                  1357
         STH   @14,GVSMTDSP-20(@15,@04)                            1357
*             /*******************************************************/
*             /*                                                     */
*             /* SET INDEX INTO BEST FIT TABLE FOR PRIMARY   @G24LB26*/
*             /* VOLUME                                      @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1358
*             PRIBFIDX=INDXBFTB;    /*                       @G24LB26*/
*                                                                  1358
@RF01356 STC   INDXBFTB,PRIBFIDX                                   1358
*             /*******************************************************/
*             /*                                                     */
*             /* INDICATE EXTENSION RECORD UPDATED           @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1359
*             UPDTGVSN=ON;          /*                       @G24LB26*/
         OI    UPDTGVSN,B'10000000'                                1359
*           END;                    /*                       @G24LB26*/
*                                                                  1360
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO SEE IF GROUP RETENTION APPLIES, AND    @G24LB26*/
*         /* UPDATE THE EXPIRATION DATE IF VOLUME HAD A      @G24LB26*/
*         /* NULL EXPIRATON DATE BEFORE                      @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1361
*         IF GRORETN=ON&            /*                       @G24LB26*/
*             GVSEXPDT(BFGRPSLT(INDXBFTB))=NULEXPDT THEN/*   @G24LB26*/
@RF01353 L     @08,GROUPPTR                                        1361
         TM    GRORETN(@08),B'00000100'                            1361
         BNO   @RF01361                                            1361
         L     @08,GVSNEPTR                                        1361
         L     @04,BFTBLPTR                                        1361
         LR    @15,INDXBFTB                                        1361
         MH    @15,@CH02240                                        1361
         SLR   @14,@14                                             1361
         IC    @14,BFGRPSLT-18(@15,@04)                            1361
         MH    @14,@CH01851                                        1361
         ST    @14,@TF00001                                        1361
         ALR   @14,@08                                             1361
         CLC   GVSEXPDT-20(4,@14),NULEXPDT                         1361
         BNE   @RF01361                                            1361
*           DO;                     /*                       @G24LB26*/
*                                                                  1362
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE EXPIRATION DATE AND INDICATE         @G24LB26*/
*             /* EXTENSION UPDATED                           @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1363
*             GVSEXPDT(BFGRPSLT(INDXBFTB))=/*                @G24LB26*/
*                 BFVOLEXP(INDXBFTB);/*                      @G24LB26*/
         AL    @08,@TF00001                                        1363
         ST    @15,@TF00001                                        1363
         ALR   @15,@04                                             1363
         MVC   GVSEXPDT-20(4,@08),BFVOLEXP-18(@15)                 1363
*             UPDTGVSN=ON;          /*                       @G24LB26*/
*                                                                  1364
         OI    UPDTGVSN,B'10000000'                                1364
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE MESSAGE ICB481I TELLING THAT VOLUME   @G24LB26*/
*             /* HAS A NEW EXPIRATION DATE.                  @G24LB26*/
*             /* CONVERT DATE TO PRINTABLE FORMAT.           @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1365
*             DBLWORD=DBLWORD&&DBLWORD;/*                    @G24LB26*/
         XC    DBLWORD(8),DBLWORD                                  1365
*             UNPK(DBLWORD,BFVOLEXP(INDXBFTB));/*            @G24LB26
*                                      CONVERT TO PRINTABLE  @G24LB26*/
         LR    @08,@04                                             1366
         AL    @08,@TF00001                                        1366
         UNPK  DBLWORD(8),BFVOLEXP-18(4,@08)                       1366
*             DBLWORD(8:8)=DBLWORD(8:8)ORSIGN;/* FIX SIGN   @G24LB26*/
         OC    DBLWORD+7(1),ORSIGN                                 1367
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM LIST   @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     1368
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     1369
*             MSGID=MSG481;         /* MSG ID FOR ICB481I    @G24LB26*/
         MVC   MSGID(4),@CF02073                                   1370
*             MSGLEN1=SIX;          /* VOLID LENGTH          @G24LB26*/
         MVI   MSGLEN1,X'06'                                       1371
*             MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID      @G24LB26*/
         L     @08,@TF00001                                        1372
         LA    @08,BFVOLID-18(@08,@04)                             1372
         STCM  @08,7,MSGTEXT1                                      1372
*             MSGLEN2=EIGHT;        /* LENGTH OF GROUP NAME  @G24LB26*/
         MVI   MSGLEN2,X'08'                                       1373
*             MSGTEXT2=ADDR(BFGROUP);/* GROUP NAME           @G24LB26*/
         LA    @08,BFGROUP(,@04)                                   1374
         STCM  @08,7,MSGTEXT2                                      1374
*             MSGLEN3=FIVE;         /* LENGTH OF JULIAN DATE @G24LB26*/
         MVI   MSGLEN3,X'05'                                       1375
*             MSGTEXT3=ADDR(DBLWORD)+THREE;/* JULIAN EXPIR   @G24LB26
*                                      DATE                  @G24LB26*/
         LA    @08,DBLWORD                                         1376
         LA    @08,3(,@08)                                         1376
         STCM  @08,7,MSGTEXT3                                      1376
*             RESPECIFY                                            1377
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=ADDR(MSGRQ);     /* ADDR MSG PARM LIST    @G24LB26*/
         LA    REG1,MSGRQ                                          1378
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        1379
         BALR  @14,@15                                             1379
*             RESPECIFY                                            1380
*               REG1 UNRSTD;        /*                       @G24LB26*/
*                                                                  1380
*             /*******************************************************/
*             /*                                                     */
*             /* CALL JOURNAL TO BUILD A MODIFY VOLUME RPL   @G24LB26*/
*             /* AND JOURNAL IT FOR THE UPDATED EXPIRATION   @G24LB26*/
*             /* DATE.                                       @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1381
*             CALL JOURNAL;         /*                       @G24LB26*/
*                                                                  1381
         BAL   @14,JOURNAL                                         1381
*             /*******************************************************/
*             /*                                                     */
*             /* READ THE BASE VOLUME RECORD AND UPDATE      @G24LB26*/
*             /* ITS EXPIRATION DATE.                        @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1382
*             BASEREAD=ON;          /* INDICATE BASE VOLUME  @G24LB26
*                                      BEING READ            @G24LB26*/
         OI    BASEREAD,B'01000000'                                1382
*             VOLKY=BFVOLID(INDXBFTB);/* VOLID OF BASE REC   @G24LB26*/
         LR    @08,INDXBFTB                                        1383
         MH    @08,@CH02240                                        1383
         L     @04,BFTBLPTR                                        1383
         ALR   @04,@08                                             1383
         MVC   VOLKY(6),BFVOLID-18(@04)                            1383
*             RPLVKEY=ADDR(VKEY);   /* ADDR OF KEY           @G24LB26*/
         LA    @08,VKEY                                            1384
         ST    @08,RPLVKEY(,RPLVPTR)                               1384
*             RPLVBUF=ADDR(STORBASE);/* ADDR BASE BUFFER     @G24LB26*/
         LA    @08,STORBASE                                        1385
         ST    @08,RPLVBUF(,RPLVPTR)                               1385
*             RPLVBLN=LENGTH(STORBASE);/* LENGTH OF BUFFER   @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02241                         1386
*             RPLVDIR=ON;           /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1387
*             RPLVTYP=RPLVREAD;     /* READ RECORD           @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1388
*             RPLVUPD=ON;           /* READ FOR UPDATE       @G24LB26*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1389
*             RESPECIFY                                            1390
*               REG1 RSTD;          /*                       @G24LB26*/
*             REG1=RPLVPTR;         /* ADDR RPLV             @G24LB26*/
         LR    REG1,RPLVPTR                                        1391
*             CALL ICBVIO00;        /* READ BASE RECORD      @G24LB26*/
         L     @15,@CV01910                                        1392
         BALR  @14,@15                                             1392
*             RESPECIFY                                            1393
*               REG1 UNRSTD;        /*                       @G24LB26*/
*                                                                  1393
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF BASE VOLUME READ SUCCESSFULLY.     @G24LB26*/
*             /* IF SUCCESSFUL, UPDATE AND WRITE IT. IF      @G24LB26*/
*             /* NOT, ZERO RETURN AND REASON CODE AND        @G24LB26*/
*             /* CONTINUE WITH NEXT VOLUME.                  @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1394
*             IF RPLVRETC=RCZERO THEN/*                      @G24LB26*/
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1394
         BNE   @RF01394                                            1394
*               DO;                 /*                       @G24LB26*/
*                                                                  1395
*                 /***************************************************/
*                 /*                                                 */
*                 /* UPDATE EXPIRATION DATE IN BASE VOLUME   @G24LB26*/
*                 /* RECORD.                                 @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1396
*                 BASEXPDT=BFVOLEXP(INDXBFTB);/*             @G24LB26*/
*                                                                  1396
         L     @08,BASEVPTR                                        1396
         LR    @04,INDXBFTB                                        1396
         MH    @04,@CH02240                                        1396
         L     @01,BFTBLPTR                                        1396
         ALR   @01,@04                                             1396
         MVC   BASEXPDT(4,@08),BFVOLEXP-18(@01)                    1396
*                 /***************************************************/
*                 /*                                                 */
*                 /* WRITE BASE VOLUME RECORD                @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1397
*                 RPLVTYP=RPLVPUT;  /* PUT OUT BASE          @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1397
*                 RESPECIFY                                        1398
*                   REG1 RSTD;      /*                       @G24LB26*/
*                 REG1=RPLVPTR;     /*                       @G24LB26*/
         LR    REG1,RPLVPTR                                        1399
*                 CALL ICBVIO00;    /* WRITE BASE RECORD     @G24LB26*/
         L     @15,@CV01910                                        1400
         BALR  @14,@15                                             1400
*                 RESPECIFY                                        1401
*                   REG1 UNRSTD;    /*                       @G24LB26*/
*                 RPLVRETC=RCZERO;  /* CLEAR RETURN CODE     @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1402
*                 RPLRCODE=RCZERO;  /* CLEAR REASON CODE     @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1403
*               END;                /*                       @G24LB26*/
*                                                                  1404
*             /*******************************************************/
*             /*                                                     */
*             /* I/O ERROR ON BASE VOLUME RECORD READ        @G24LB26*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1405
*             ELSE                  /*                       @G24LB26*/
*               DO;                 /*                       @G24LB26*/
*                                                                  1405
         B     @RC01394                                            1405
@RF01394 DS    0H                                                  1406
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE MESSAGE ICB402I                   @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1406
*                 MSGRQ=MSGRQ&&MSGRQ;/* CLEAR MSG PARM       @G24LB26*/
         XC    MSGRQ(32),MSGRQ                                     1406
*                 MSGRPLV=RPLVPTR;  /* RPLV PTR              @G24LB26*/
         ST    RPLVPTR,MSGRPLV                                     1407
*                 MSGID=MSG402;     /* MSG ID FOR ICB402I    @G24LB26*/
         MVC   MSGID(4),@CF02059                                   1408
*                 MSGLEN1=SIX;      /* VOLID LENGTH          @G24LB26*/
         MVI   MSGLEN1,X'06'                                       1409
*                 MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID  @G24LB26*/
         LR    @08,INDXBFTB                                        1410
         MH    @08,@CH02240                                        1410
         L     @04,BFTBLPTR                                        1410
         LA    @08,BFVOLID-18(@08,@04)                             1410
         STCM  @08,7,MSGTEXT1                                      1410
*                 RESPECIFY                                        1411
*                   REG1 RSTD;      /*                       @G24LB26*/
*                 REG1=ADDR(MSGRQ); /* ADDR MSG PARM LIST    @G24LB26*/
         LA    REG1,MSGRQ                                          1412
*                 CALL ICBVOP00;    /* ISSUE MESSAGE         @G24LB26*/
         L     @15,@CV01912                                        1413
         BALR  @14,@15                                             1413
*                 RESPECIFY                                        1414
*                   REG1 UNRSTD;    /*                       @G24LB26*/
*                                                                  1414
*                 /***************************************************/
*                 /*                                                 */
*                 /* CLEAR REASON AND RETURN CODES SO        @G24LB26*/
*                 /* REQUEST WILL NOT FAIL                   @G24LB26*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1415
*                 RPLVRETC=RCZERO;  /*                       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1415
*                 RPLRCODE=RCZERO;  /*                       @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1416
*               END;                /*                       @G24LB26*/
*           END;                    /*                       @G24LB26*/
*                                                                  1418
@RC01394 DS    0H                                                  1419
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK ON STATUS OF VOLUMES PROCESSED TO         @G24LB26*/
*         /* DETERMINE IF POSSIBLE TO HAULT SCANNING OF      @G24LB26*/
*         /* BEST FIT TABLE. IF PRIMARY VOLUME PROCESSED     @G24LB26*/
*         /* AND NO GROUP RETENTION OR ONLY ONE VOLUME       @G24LB26*/
*         /* SELECTED, EXIT LOOP.                            @G24LB26*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1419
*         IF PRIBFIDX^=ZERO&(NUMBVOL=ONEGRORETN=OFF)/*      @G24LB26*/
*           THEN                    /*                       @G24LB26*/
@RF01361 CLI   PRIBFIDX,0                                          1419
         BE    @RF01419                                            1419
         CLI   NUMBVOL,1                                           1419
         BE    @RT01419                                            1419
         L     @08,GROUPPTR                                        1419
         TM    GRORETN(@08),B'00000100'                            1419
         BNZ   @RF01419                                            1419
@RT01419 DS    0H                                                  1420
*           EXITSW=ON;              /*                       @G24LB26*/
         OI    EXITSW,B'00010000'                                  1420
*       END;                        /*                       @G24LB26*/
@RF01419 DS    0H                                                  1422
*   END;                            /*                       @G24LB26*/
*                                                                  1422
@RF01308 BCTR  INDXBFTB,0                                          1422
@DE01307 C     INDXBFTB,@CF00043                                   1422
         BNL   @DL01307                                            1422
@DC01307 DS    0H                                                  1423
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF AN EXTENSION RECORD MUST BE WRITTEN   @G24LB26*/
*   /* OUT OF THE BUFFER BEFORE EXITING ROUTINE.             @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1423
*   IF UPDTGVSN=ON THEN             /*                       @G24LB26*/
         TM    UPDTGVSN,B'10000000'                                1423
         BNO   @RF01423                                            1423
*     DO;                           /*                       @G24LB26*/
*                                                                  1424
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF RECORD MUST FIRST BE READ FOR UPDATE     @G24LB26*/
*       /* BEFORE IT CAN BE WRITTEN.                         @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1425
*       IF BASEREAD=ON THEN         /*                       @G24LB26*/
         TM    BASEREAD,B'01000000'                                1425
         BNO   @RF01425                                            1425
*         DO;                       /*                       @G24LB26*/
*                                                                  1426
*           /*********************************************************/
*           /*                                                       */
*           /* READ EXTENSION RECORD CURRENTLY IN STORAGE    @G24LB26*/
*           /* FOR UPDATE                                    @G24LB26*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1427
*           GKEY=GVSNAME;           /* ENSURE KEY SET        @G24LB26
*                                      PROPERLY              @G24LB26*/
         L     @08,GVSNEPTR                                        1427
         MVC   GKEY(13),GVSNAME(@08)                               1427
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @G24LB26*/
         LA    @08,GKEY                                            1428
         ST    @08,RPLVKEY(,RPLVPTR)                               1428
*           RPLVBUF=ADDR(DUMMYBUF); /* ADDR OF DUMMY BUFFER  @G24LB26*/
         LA    @08,DUMMYBUF                                        1429
         ST    @08,RPLVBUF(,RPLVPTR)                               1429
*           RPLVBLN=LENGTH(DUMMYBUF);/* LEN OF DUMMY BUFFER  @G24LB26*/
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1430
*           RPLVDIR=ON;             /* READ DIRECT           @G24LB26*/
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1431
*           RPLVTYP=RPLVREAD;       /* READ FUNCTION         @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'00'                              1432
*           RPLVUPD=ON;             /* READ FOR UPDATE       @G24LB26*/
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1433
*           RESPECIFY                                              1434
*             REG1 RSTD;            /*                       @G24LB26*/
*           REG1=RPLVPTR;           /* ADDR RPLV             @G24LB26*/
         LR    REG1,RPLVPTR                                        1435
*           CALL ICBVIO00;          /* READ EXTENSION RECORD @G24LB26*/
         L     @15,@CV01910                                        1436
         BALR  @14,@15                                             1436
*           RESPECIFY                                              1437
*             REG1 UNRSTD;          /*                       @G24LB26*/
*           BASEREAD=OFF;           /* INDICATE RECORD READ  @G24LB26
*                                      FOR DEBUG PURPOSES    @G24LB26*/
         NI    BASEREAD,B'10111111'                                1438
*         END;                      /*                       @G24LB26*/
*                                                                  1439
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE EXTENSION RECORD NOW IN THE BUFFER      @G24LB26*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1440
*       RPLVBUF=ADDR(STORGPEX);     /* ADDR OF NON-DUMMY EXT @G24LB26*/
@RF01425 LA    @08,STORGPEX                                        1440
         ST    @08,RPLVBUF(,RPLVPTR)                               1440
*       RPLVTYP=RPLVPUT;            /* PUT RECORD            @G24LB26*/
         MVI   RPLVTYP(RPLVPTR),X'01'                              1441
*       RESPECIFY                                                  1442
*         REG1 RSTD;                /*                       @G24LB26*/
*       REG1=RPLVPTR;               /* ADDR RPLV             @G24LB26*/
         LR    REG1,RPLVPTR                                        1443
*       CALL ICBVIO00;              /* WRITE EXTENSION REC   @G24LB26*/
         L     @15,@CV01910                                        1444
         BALR  @14,@15                                             1444
*       RESPECIFY                                                  1445
*         REG1 UNRSTD;              /*                       @G24LB26*/
*       RPLVRETC=RCZERO;            /* CLEAR RETURN CODE     @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1446
*       RPLRCODE=RCZERO;            /* CLEAR REASON CODE     @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1447
*       UPDTGVSN=OFF;               /* INDICATE EXTENSION    @G24LB26
*                                      WRITTEN FOR DEBUG     @G24LB26
*                                      PURPOSES              @G24LB26*/
         NI    UPDTGVSN,B'01111111'                                1448
*     END;                          /*                       @G24LB26*/
*   RETURN;                         /*                       @G24LB26*/
@EL00017 DS    0H                                                  1450
@EF00017 DS    0H                                                  1450
@ER00017 L     @14,@SA00017                                        1450
         BR    @14                                                 1450
*   END UPDTMSVI;                   /*                       @G24LB26*/
         B     @EL00017                                            1451
*                                                                  1452
*/*********************************************************  @G24LB26*/
*/*                                                          @G24LB26*/
*/* PROCEDURE NAME - JOURNAL                                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* FUNCTION - BUILDS A REQUEST LIST FOR A MODIFY VOLUME     @G24LB26*/
*/*            RECORD WHENEVER THE EXPIRATION DATE IS        @G24LB26*/
*/*            UPDATED BY THE SELECTOR MODULE. IT THEN CALLS @G24LB26*/
*/*            THE JOURNAL PROGRAM (ICBVJL00) TO JOURNAL THE @G24LB26*/
*/*            MODIFY VOLUME RECORD COMMAND.                 @G24LB26*/
*/*                                                          @G24LB26*/
*/* INPUT - INDEX INTO BEST FIT TABLE OF VOLUME WHOSE        @G24LB26*/
*/*         EXPIRATION DATE IS BEING UPDATED BY THE SELECTOR @G24LB26*/
*/*         MODULE.                                          @G24LB26*/
*/*                                                          @G24LB26*/
*/* OUTPUT - RETURN WITH ZERO REASON AND RETURN CODES        @G24LB26*/
*/*          IN THE RPLV. JOURNAL ENTRY WILL BE MADE FOR     @G24LB26*/
*/*          EXPIRATION DATE CHANGE.                         @G24LB26*/
*/*                                                          @G24LB26*/
*/*********************************************************  @G24LB26*/
*                                                                  1452
*JOURNAL:                                                          1452
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/
*                                                                  1452
JOURNAL  ST    @14,@SA00018                                        1452
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR THE RPLVJ AND SET UP TOTAL LENGTH OF REQUEST    @G24LB26*/
*   /* BLOCK.                                                @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1453
*   RPLVJ=RPLVJ&&RPLVJ;             /*                       @G24LB26*/
         XC    RPLVJ(220),RPLVJ                                    1453
*   SAVEPTR=RPLVPTR;                /* SAVE ADDR OF RPLV     @G24LB26*/
         LR    SAVEPTR,RPLVPTR                                     1454
*   RPLVPTR=ADDR(RPLVJ);            /* SET UP ADDRESSING TO  @G24LB26
*                                      JOURNALED RPLV        @G24LB26*/
         LA    RPLVPTR,RPLVJ                                       1455
*   RPLVTLEN=LENGTH(RPLV)+LENGTH(MVR);/* TOTAL LEN OF RPLV   @G24LB26*/
         MVC   RPLVTLEN(2,RPLVPTR),@CH02245                        1456
*   RPLVVICB=VVIPTR;                /* ADDR OF VVICB         @G24LB26*/
*                                                                  1457
         L     @08,VVIPTR                                          1457
         ST    @08,RPLVVICB(,RPLVPTR)                              1457
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY OF COMMAND SECTION OF RPLV      @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1458
*   MVRPTR=ADDR(RPLVUTIL);          /*                       @G24LB26*/
*                                                                  1458
         LA    MVRPTR,RPLVUTIL(,RPLVPTR)                           1458
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MODIFY VOLUME REQUEST BLOCK TO JOURNAL     @G24LB26*/
*   /* AN EXPIRATION CHANGE.                                 @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1459
*   MVRLNGTH=LENGTH(MVR);           /* LENGTH OF UTILITY RPL @G24LB26*/
         MVC   MVRLNGTH(4,MVRPTR),@CF02244                         1459
*   MVROPCD=MVROP;                  /* MODIFY VOL OP CODE    @G24LB26*/
         MVI   MVROPCD(MVRPTR),X'85'                               1460
*   MVRFLBAS=ON;                    /* VOLID SPECIFIED       @G24LB26*/
*   MVRFLTO=ON;                     /* EXPIR DATE SPECIFIED  @G24LB26*/
         OI    MVRFLBAS(MVRPTR),B'00101000'                        1462
*   MVRBVOL=BFVOLID(INDXBFTB);      /* VOLID                 @G24LB26*/
         L     @08,BFTBLPTR                                        1463
         LR    @04,INDXBFTB                                        1463
         MH    @04,@CH02240                                        1463
         ST    @04,@TF00001                                        1463
         ALR   @04,@08                                             1463
         MVC   MVRBVOL(6,MVRPTR),BFVOLID-18(@04)                   1463
*   MVRTO=BFVOLEXP(INDXBFTB);       /* EXPIRATION DATE       @G24LB26*/
*                                                                  1464
         AL    @08,@TF00001                                        1464
         MVC   MVRTO(4,MVRPTR),BFVOLEXP-18(@08)                    1464
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE JOURNAL DATA SET                              @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1465
*   RESPECIFY                                                      1465
*    (REG0,                                                        1465
*     REG1) RSTD;                   /*                       @G24LB26*/
*   REG0=RESEXVJL;                  /* RESERVE JOURNAL       @G24LB26
*                                      EXCLUSIVE             @G24LB26*/
         LA    REG0,17                                             1466
*   REG1=SAVEPTR;                   /* ADDR OF RPLV          @G24LB26*/
         LR    REG1,SAVEPTR                                        1467
*   CALL ICBVRR00;                  /* RESERVE JOURNAL       @G24LB26*/
         L     @15,@CV01909                                        1468
         BALR  @14,@15                                             1468
*   REG1=RPLVPTR;                   /* RESET TO RPLVJ        @G24LB26*/
         LR    REG1,RPLVPTR                                        1469
*   CALL ICBVJL00;                  /*                       @G24LB26*/
         L     @15,@CV01911                                        1470
         BALR  @14,@15                                             1470
*   REG1=SAVEPTR;                   /* RESET ADDR OF RPLV    @G24LB26
*                                      AGAIN                 @G24LB26*/
         LR    REG1,SAVEPTR                                        1471
*   REG0=DEQJRNL;                   /* INDICATE FREE JOURNAL @G24LB26*/
         LA    REG0,16                                             1472
*   CALL ICBVRR00;                  /* FREE JOURNAL          @G24LB26*/
         L     @15,@CV01909                                        1473
         BALR  @14,@15                                             1473
*   RESPECIFY                                                      1474
*    (REG0,                                                        1474
*     REG1) UNRSTD;                 /*                       @G24LB26*/
*   RPLVPTR=SAVEPTR;                /* RESTORE ADDRESSING    @G24LB26
*                                      TO ORIGINAL RPLV      @G24LB26*/
*                                                                  1475
         LR    RPLVPTR,SAVEPTR                                     1475
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ZERO REASON AND RETURN CODES IN THE RPLV.         @G24LB26*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1476
*   RPLVRETC=RCZERO;                /*                       @G24LB26*/
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1476
*   RPLRCODE=RCZERO;                /*                       @G24LB26*/
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1477
*   RETURN;                         /*                       @G24LB26*/
@EL00018 DS    0H                                                  1478
@EF00018 DS    0H                                                  1478
@ER00018 L     @14,@SA00018                                        1478
         BR    @14                                                 1478
*   END JOURNAL;                    /*                       @G24LB26*/
*   END ICBVSL00                    /*                       @G24LB26*/
*                                                                  1480
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */
*/*%INCLUDE SYSLIB  (IEZUNITP)                                       */
*/*%INCLUDE SYSLIB  (IEZTABP )                                       */
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */
*/*%INCLUDE SYSLIB  (IEZGRPPR)                                       */
*/*%INCLUDE SYSLIB  (IEZVOLRT)                                       */
*/*%INCLUDE SYSLIB  (IEZBFTBL)                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */
*                                                                  1480
*       ;                                                          1480
@DATA    DS    0H
@CH00087 DC    H'5'
@CH00215 DC    H'6'
@CH02240 DC    H'18'
@CH02245 DC    H'220'
@CH02238 DC    H'885'
@CH02014 DC    H'1000'
@SC02281 CLC   SRTELEM(0,@01),SRTELEM(@14)
         DS    0F
@SA00001 DS    18F
@SA00004 DS    1F
@SA00003 DS    1F
@SA00005 DS    1F
@SA00013 DS    1F
@SA00017 DS    1F
@SA00006 DS    1F
@SA00015 DS    1F
@SA00016 DS    18F
@SA00018 DS    0F
@SA00010 DS    0F
@SA00009 DS    0F
@SA00011 DS    0F
         DS    1F
@AL00001 DS    2A
@TF00001 DS    F
@TF00002 DS    F
         DS    0F
@CF00084 DC    F'0'
@CF00043 DC    F'1'
@CF00064 DC    F'4'
@CF00040 DC    F'8'
@CF00032 DC    F'12'
@CF00112 DC    F'16'
@CF02038 DC    F'19'
@CF01851 DC    F'20'
@CH01851 EQU   @CF01851+2
@CF00346 DC    F'48'
@CF02244 DC    F'88'
@CF02023 DC    F'100'
@CF02237 DC    F'164'
@CF02241 DC    F'224'
@CF02057 DC    F'401'
@CF02059 DC    F'402'
@CF02021 DC    F'404'
@CF02061 DC    F'407'
@CF02063 DC    F'409'
@CF02065 DC    F'415'
@CF02067 DC    F'441'
@CF02069 DC    F'445'
@CF02071 DC    F'479'
@CF02073 DC    F'481'
@CF02075 DC    F'483'
@CF02239 DC    F'988'
@CF02040 DC    F'13030'
@CF02042 DC    F'13165'
@CF02280 DC    F'-19'
@CF02283 DC    F'-18'
@CV01909 DC    V(ICBVRR00)
@CV01910 DC    V(ICBVIO00)
@CV01911 DC    V(ICBVJL00)
@CV01912 DC    V(ICBVOP00)
@CV01913 DC    V(ICBVUP00)
@CV01914 DC    V(ICBVTP00)
         DS    0D
VVIPTR   DS    A
BASEVPTR DS    A
GROUPPTR DS    A
GVSNEPTR DS    A
UCBPTR   DS    A
BFTBLPTR DS    A
DSPDDADR DS    A
SLGRPSPA DS    F
MVRLEN   DC    AL2(88)
TPVOLSPA DS    H
RESERSPA DS    H
TOTSPA   DS    H
BFSLOTLN DC    AL1(18)
BFHEADLN DC    AL1(21)
         DS    0D
@TS00001 DS    CL8
@CB02077 DC    X'0213'
@CB02079 DC    X'022A'
@CB02085 DC    X'022C'
@CB02087 DC    X'022F'
@CB02089 DC    X'0231'
@CB02091 DC    X'0232'
@CB02093 DC    X'0262'
@CB02095 DC    X'0263'
@CB02097 DC    X'0264'
@CB02099 DC    X'0265'
@CB02111 DC    X'0000'
@CB02113 DC    X'0004'
@CB02115 DC    X'0008'
         DS    CL2
MSGRQ    DS    CL32
         ORG   MSGRQ
MSGID    DS    FL4
MSGRPLV  DS    AL4
MSGRLEN  DS    BL1
MSGREPLY DS    AL3
MSGLEN1  DS    BL1
MSGTEXT1 DS    AL3
MSGLEN2  DS    BL1
MSGTEXT2 DS    AL3
MSGLEN3  DS    BL1
MSGTEXT3 DS    AL3
MSGLEN4  DS    BL1
MSGTEXT4 DS    AL3
MSGLEN5  DS    BL1
MSGTEXT5 DS    AL3
         ORG   MSGRQ+32
STRUNITP DS    CL17
STRTABP  DS    CL12
STRBFTBL DS    CL885
STORBASE DS    CL224
STORGRP  DS    CL164
STORGPEX DS    CL988
DUMMYBUF DS    CL988
         DS    CL2
SRTAGL   DS    CL12
         ORG   SRTAGL
SRTADDR  DS    AL4
SRTNUM   DS    FL2
SRTLEN   DS    FL2
SRTBEG   DS    FL2
SRTFLDLN DS    FL2
         ORG   SRTAGL+12
SORTWORK DS    CL18
SRTFLGS  DS    BL1
         ORG   SRTFLGS
SRTSTOP  DS    BL1
SRTMOVE  EQU   SRTFLGS+0
         ORG   SRTFLGS+1
RPLVJ    DS    CL220
EXPCVT   DS    CL4
TESTMASK DS    BL2
         DS    CL3
EXPJFCB  DS    CL4
         ORG   EXPJFCB
EXPYR    DS    CL2
EXPDAY   DS    CL2
         ORG   EXPJFCB+4
GKEY     DS    CL13
         ORG   GKEY
GKY      DC    CL3'G  '
GROUPKY  DS    CL8
GBLKKY   DS    CL1
GIDKY    DS    FL1
         ORG   GKEY+13
VKEY     DS    CL13
         ORG   VKEY
VKY      DC    CL5'V    '
VOLKY    DS    CL6
VBLKKY   DC    CL1' '
VIDKY    DC    XL1'00'
         ORG   VKEY+13
         DS    CL2
INTWORK  DS    CL22
         ORG   INTWORK
GETMNLEN DS    FL2
NUMBVOL  DS    FL1
NUMCHOS  DS    FL1
PRICYL   DS    FL2
SECCYL   DS    FL2
PRIBFIDX DS    FL1
EXPIRDT  DS    CL4
STATFLGS DS    BL1
         ORG   STATFLGS
NSHRREQF DS    BL1
         ORG   INTWORK+14
@NM00045 DS    CL2
DYNMAREA DS    CL6
         ORG   DYNMAREA
UCBADDR  DS    AL4
INTERCC  DS    BL2
         ORG   INTWORK+22
DYNMFLGS DS    BL2
         ORG   DYNMFLGS
UPDTGVSN DS    BL1
BASEREAD EQU   DYNMFLGS+0
EXITVSL  EQU   DYNMFLGS+0
EXITSW   EQU   DYNMFLGS+0
ERRORSW  EQU   DYNMFLGS+0
DATEEXIT EQU   DYNMFLGS+0
WAITEXIT EQU   DYNMFLGS+0
SEPEXIT  EQU   DYNMFLGS+0
FINEXIT  DS    BL1
SPAEXIT  EQU   DYNMFLGS+1
LSPASW   EQU   DYNMFLGS+1
RESORTSW EQU   DYNMFLGS+1
         ORG   DYNMFLGS+2
LSPAREA  DS    CL30
         ORG   LSPAREA
@NM00046 DS    CL6
LSPFRESP DS    CL4
@NM00047 DS    CL1
LSPFRETR DS    CL4
@NM00048 DS    CL1
LSPFREXT DS    CL4
@NM00049 DS    CL1
LSPLEXT  DS    CL4
@NM00050 DS    CL1
LSPLGTRK DS    CL4
         ORG   LSPAREA+30
TEMPPACK DS    CL4
TEMPCHAR DS    CL2
MAJRNAM  DC    CL8'SYSZVOLS'
TENQVOL  DS    CL6
MAXDATE  DC    X'0099365C'
         DS    CL2
DBLWORD  DS    CL8
DEV3330V DC    X'30582009'
NULEXPDT DC    X'FFFFFFFF'
ZEROEXP  DC    X'00000000'
ANCVTEXP DC    X'FFFFFFFC'
ORSIGN   DC    X'F0'
SYSGROUP DC    CL8'SYSGROUP'
SL1PATCH DS    CL400
         ORG   SL1PATCH
@NM00052 DC    400X'00'
         ORG   SL1PATCH+400
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
INDXDDVL EQU   @02
INDXEXTS EQU   @08
INDXBFTB EQU   @06
SECBYTES EQU   @03
PRIBYTES EQU   @03
ROUND    EQU   @02
RECORDS  EQU   @03
RECLEN   EQU   @04
YEAR     EQU   @03
DAY      EQU   @02
TEMPBIN  EQU   @02
SRTJ     EQU   @02
SRTI     EQU   @03
SRTEND   EQU   @04
SAVEPTR  EQU   @03
SELTMPTR EQU   @07
MVRPTR   EQU   @02
RPLVPTR  EQU   @05
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG14    EQU   @14
REG15    EQU   @15
REG10    EQU   @10
REG11    EQU   @11
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
CVTPTR   EQU   16
SELRB    EQU   0
SELFLGS1 EQU   SELRB+5
SELPARMT EQU   SELFLGS1
SELSEPVL EQU   SELFLGS1
SELVOLRF EQU   SELFLGS1
SELFLGS2 EQU   SELRB+6
SELCNTWT EQU   SELFLGS2
SELUNCNT EQU   SELRB+7
SELJOBID EQU   SELRB+8
SELJFCBA EQU   SELRB+12
SELDEVTP EQU   SELRB+16
SELUCBAD EQU   SELRB+20
SELJOBNM EQU   SELRB+24
SELDDNAM EQU   SELRB+32
SELSTNUM EQU   SELRB+40
SELDDCAT EQU   SELRB+42
SELRFDDN EQU   SELRB+46
SELVLRET EQU   SELRB+56
SELGRPPR EQU   SELRB+60
RPLV     EQU   0
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLVTLEN EQU   RPLV+30
RPLRCODE EQU   RPLV+32
RPLVRETC EQU   RPLV+34
RPLVSAM  EQU   RPLV+56
RPLVTYP  EQU   RPLVSAM+2
RPLVBUF  EQU   RPLVSAM+32
RPLVKEY  EQU   RPLVSAM+36
RPLVOPT  EQU   RPLVSAM+40
RPLVDIR  EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
RPLVUPD  EQU   RPLVOPT+1
RPLVBLN  EQU   RPLVSAM+52
RPLVUTIL EQU   RPLV+132
VVICB    EQU   0
VVICPUID EQU   VVICB+12
VVIFLGA  EQU   VVICB+15
VVIFLG0  EQU   VVIFLGA
VVISSOBA EQU   VVICB+96
VVIVBSTF EQU   VVICB+100
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVROPCD  EQU   MVRCODE
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRBVOL  EQU   MVR+12
MVRTO    EQU   MVR+58
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASGRPV  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASEXPDT EQU   BASEV+96
BASGROUP EQU   BASEV+180
GROUP    EQU   0
GRONAME  EQU   GROUP
GROVVGRP EQU   GRONAME+3
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROEXCL  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GROPCENT EQU   GROUP+29
GRONGEN  EQU   GROUP+30
GROPSPD  EQU   GROUP+36
GROSSPD  EQU   GROUP+38
GROSTRSH EQU   GROUP+40
GRORETPD EQU   GROUP+52
GROERRTS EQU   GROUP+56
GROERRDT EQU   GROERRTS
GROCONUS EQU   GROUP+94
GRORESSP EQU   GROUP+95
GVSNE    EQU   0
GVSHDR   EQU   GVSNE
GVSNAME  EQU   GVSHDR
GVSVVGRP EQU   GVSNAME+3
GVSID    EQU   GVSNAME+11
GVSNO    EQU   GVSID+1
GVSFLAGA EQU   GVSHDR+13
GVSTYPE  EQU   GVSFLAGA
GVSEX    EQU   GVSFLAGA+2
GVSESIND EQU   GVSHDR+18
GVSSLOTS EQU   GVSNE+28
GVSVOLID EQU   GVSSLOTS
GVSVOLFL EQU   GVSSLOTS+6
GVSCPUBM EQU   GVSVOLFL
GVSRCFSI EQU   GVSVOLFL+2
GVSMTNSH EQU   GVSVOLFL+2
GVSFRESP EQU   GVSSLOTS+10
GVSLEXT  EQU   GVSSLOTS+12
GVSEXPDT EQU   GVSSLOTS+14
GVSMTDSP EQU   GVSSLOTS+18
UNITP    EQU   0
UNIDEVTP EQU   UNITP
UNIVOL   EQU   UNITP+4
UNIUCBP  EQU   UNITP+12
UNIFLAGS EQU   UNITP+16
UNIFMTD  EQU   UNIFLAGS
UNIFINCL EQU   UNIFLAGS
TABP     EQU   0
TABFLAGS EQU   TABP
TABFBLDE EQU   TABFLAGS
TABFSRCD EQU   TABFLAGS
TABFBFIT EQU   TABFLAGS
TABFTSPC EQU   TABFLAGS
TABVOLID EQU   TABP+2
TABDDNUM EQU   TABVOLID
TABSELRB EQU   TABVOLID+2
TABJOBID EQU   TABSELRB
TABBFTBL EQU   TABJOBID
TABDDRET EQU   TABP+8
TABHDRET EQU   TABDDRET
TABSPRET EQU   TABHDRET
STPTB    EQU   0
STPFLAGS EQU   STPTB+14
STPDDENT EQU   0
STPDDFLG EQU   STPDDENT+24
STPDDNVL EQU   STPDDENT+25
STPDDVOL EQU   STPDDENT+26
GRPPR    EQU   0
GRPNAME  EQU   GRPPR
GRPEXTIN EQU   GRPPR+8
GRPSLOTN EQU   GRPPR+9
GRPPRMSP EQU   GRPPR+10
VOLRT    EQU   0
VOLNUM   EQU   VOLRT+2
VOLSER   EQU   VOLRT+4
BFTBL    EQU   0
BFHEADER EQU   BFTBL
BFLEN    EQU   BFHEADER
BFGROUP  EQU   BFHEADER+2
BFTOTIDX EQU   BFHEADER+10
BFDEVTP  EQU   BFHEADER+12
BFJOBID  EQU   BFHEADER+16
BFREQFLS EQU   BFHEADER+20
BFNSHRFL EQU   BFREQFLS
BFENTRY  EQU   BFTBL+21
BFSLOT   EQU   BFENTRY
BFVOLID  EQU   BFSLOT
BFGRPIDX EQU   BFSLOT+6
BFGRPSLT EQU   BFSLOT+7
BFHPFLGS EQU   BFSLOT+8
BFHRSKFL EQU   BFHPFLGS
BFWAITFL EQU   BFHPFLGS
BFOVERUS EQU   BFSLOT+9
BFVOLEXP EQU   BFSLOT+10
BFLPFLGS EQU   BFSLOT+14
BFNMTDFL EQU   BFLPFLGS
BFMTDOHF EQU   BFLPFLGS
BFCONUSE EQU   BFSLOT+15
BFMISCFL EQU   BFSLOT+16
BFBADPRI EQU   BFMISCFL
BFBADSEC EQU   BFMISCFL
BFSELPRI EQU   BFMISCFL
BFSELSEC EQU   BFMISCFL
BFVOLREJ EQU   BFMISCFL
BFNOENQ  EQU   BFMISCFL
BFENQUED EQU   BFMISCFL
BFNOTMTD EQU   BFMISCFL+1
BFMTDOTH EQU   BFMISCFL+1
BFMTDOHT EQU   BFMISCFL+1
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00036 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBXPDT EQU   INFMJFCB+83
JFCBIND1 EQU   INFMJFCB+86
JFCRLSE  EQU   JFCBIND1
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
CVTMAP   EQU   0
CVTDATE  EQU   CVTMAP+56
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
SSOB     EQU   0
SSOBRETN EQU   SSOB+12
SSOBINDV EQU   SSOB+16
SSMO     EQU   0
SSMOFLG1 EQU   SSMO+2
SSMOMNTD EQU   SSMOFLG1
SSMOPNAM EQU   SSMO+4
SSMOPSTN EQU   SSMO+8
SSMOPVOL EQU   SSMO+16
SSMOPDDN EQU   SSMO+20
SSMOPRPN EQU   SSMO+24
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
SSREQ    EQU   0
SRTSTOR  EQU   0
SRTELEM  EQU   SRTSTOR
ENQRETRN EQU   0
ENQRETC  EQU   ENQRETRN+3
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
SWAMGR   EQU   0
UCBBGN   EQU   0
UCBDCPTR EQU   0
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBUSER  EQU   UCBOBS01+14
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00035 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
JFCBPTR  EQU   SELJFCBA
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCORGIS EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCAVOLS EQU   JFCBVOLS
JFCBS001 EQU   JFCBVOLS
JFCMSVGP EQU   JFCBS001+22
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSPAC EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
JFCBABST EQU   JFCBS001+48
JFCBDRLH EQU   JFCBS001+53
JFCBVLCT EQU   JFCBS001+56
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
JFCBDATE EQU   JFCBXPDT
JFCBYFX  EQU   JFCBDATE
JFCBDFX  EQU   JFCBDATE+1
PQTY     EQU   JFCBPQTY
SQTY     EQU   JFCBSQTY
DRLH     EQU   JFCBDRLH
KEYLEN   EQU   JFCKEYLE
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBSBNM EQU   JFCBS001+50
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
@NM00040 EQU   JFCBS001
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00039 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00038 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00035
UCBSKPFG EQU   @NM00035
UCBRIPND EQU   @NM00035
UCBRTIAC EQU   @NM00035
UCBRSV79 EQU   @NM00035
UCBRSV78 EQU   @NM00035
UCBRSV77 EQU   @NM00035
UCBOLTEP EQU   @NM00035
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBDQDSP EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00034 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
@NM00051 EQU   ENQRETRN
JESPJESN EQU   JESCT+28
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00044 EQU   JESCT
SSMOPUAD EQU   SSMO+12
SSMORSV0 EQU   SSMO+3
@NM00043 EQU   SSMOFLG1
SSMORUSE EQU   SSMOFLG1
SSMOSCR  EQU   SSMOFLG1
SSMOFINL EQU   SSMOFLG1
SSMOOPEN EQU   SSMOFLG1
SSMOLEN  EQU   SSMO
SSOBSSIB EQU   SSOB+8
SSOBFUNC EQU   SSOB+6
SSOBLEN  EQU   SSOB+4
SSOBID   EQU   SSOB
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00042 EQU   CVTFIX+248
@NM00041 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00037 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBFCBPE EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00036
UCBHALI  EQU   @NM00036
UCBRSV09 EQU   @NM00036
UCBRSV08 EQU   @NM00036
UCBRSV07 EQU   @NM00036
UCBRSV06 EQU   @NM00036
UCBRSV05 EQU   @NM00036
UCBRSV04 EQU   @NM00036
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00033 EQU   UCB
@NM00032 EQU   BFMISCFL+1
BFJESOK  EQU   BFMISCFL
@NM00031 EQU   BFLPFLGS
BFSHCNFL EQU   BFLPFLGS
@NM00030 EQU   BFHPFLGS
@NM00029 EQU   BFREQFLS
VOLLEN   EQU   VOLRT
@NM00028 EQU   STPDDFLG
STPDDSPL EQU   STPDDFLG
STPDDEXC EQU   STPDDFLG
STPDDPRM EQU   STPDDENT+22
STPDDGPS EQU   STPDDENT+21
STPDDGPI EQU   STPDDENT+20
STPDDGPN EQU   STPDDENT+12
STPDDDVT EQU   STPDDENT+8
STPDDNUM EQU   STPDDENT+6
STPDDLEN EQU   STPDDENT+4
STPDDNXT EQU   STPDDENT
STPDDPTR EQU   STPTB+16
STPICCTR EQU   STPTB+15
@NM00027 EQU   STPFLAGS
STPNOFRE EQU   STPFLAGS
STPINVAL EQU   STPFLAGS
STPHDRLN EQU   STPTB+12
STPJOBID EQU   STPTB+8
STPPRVTB EQU   STPTB+4
STPNXTTB EQU   STPTB
@NM00026 EQU   TABHDRET+2
@NM00025 EQU   TABP+1
@NM00024 EQU   TABFLAGS
TABFFREE EQU   TABFLAGS
TABFUTRM EQU   TABFLAGS
@NM00023 EQU   UNIFLAGS
UNIFALLV EQU   UNIFLAGS
@NM00022 EQU   UNITP+10
@NM00021 EQU   GVSVOLFL+2
@NM00020 EQU   GVSHDR+20
@NM00019 EQU   GVSHDR+17
@NM00018 EQU   GVSFLAGA+2
@NM00017 EQU   GVSTYPE
GVSGVSEX EQU   GVSTYPE
@NM00016 EQU   GVSTYPE
GVSRES1  EQU   GVSID
GVSG     EQU   GVSNAME
@NM00015 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GRONINAC EQU   GROUP+34
GRONRSTD EQU   GROUP+32
GROLSN   EQU   GROUP+23
GROFSN   EQU   GROUP+17
@NM00014 EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GROBIND  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROG     EQU   GRONAME
@NM00013 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00012 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00011 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
@NM00010 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00009 EQU   MVRFLAGA+2
MVRCICPY EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00008 EQU   MVRCODE+1
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIDVMEL EQU   VVICB+104
VVIVSCRA EQU   VVICB+92
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIJUCB  EQU   VVICB+80
VVIIUCB  EQU   VVICB+76
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIUCB   EQU   VVICB+60
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIQRPL2 EQU   VVICB+44
VVIQRPL1 EQU   VVICB+40
VVIVTRK  EQU   VVICB+37
VVIOPCD  EQU   VVICB+36
VVIVQMP  EQU   VVICB+32
VVIECB1  EQU   VVICB+28
VVICATAD EQU   VVICB+24
VVIDCBAD EQU   VVICB+20
VVIACBAD EQU   VVICB+16
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG3  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIALCON EQU   VVICB+14
VVIUCAT  EQU   VVICB+4
VVICID   EQU   VVICB
RPLVRLN  EQU   RPLVSAM+48
@NM00007 EQU   RPLVSAM+44
@NM00006 EQU   RPLVOPT
@NM00005 EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
RPLVLOC  EQU   RPLVOPT
@NM00004 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00003 EQU   RPLVSAM+3
@NM00002 EQU   RPLVSAM
@NM00001 EQU   RPLV+42
RPLVDATE EQU   RPLV+38
RPLRMSCC EQU   RPLV+36
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLVVOP  EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLFTIME EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
RPLVQPTR EQU   RPLV
SELUNUSE EQU   SELRB+64
SELJFCBX EQU   SELRB+52
SELUNUS2 EQU   SELRB+48
SELDDNUM EQU   SELRB+44
SELUNUS1 EQU   SELRB+41
SELNOVSL EQU   SELFLGS2
SELRPRIV EQU   SELFLGS2
SELINITC EQU   SELFLGS2
SELUNSEP EQU   SELFLGS2
SELSUBAL EQU   SELFLGS2
SELSCSPL EQU   SELFLGS2
SELPRSPL EQU   SELFLGS2
SELMXESO EQU   SELFLGS1
SELVRGRP EQU   SELFLGS1
SELVRNEW EQU   SELFLGS1
SELVENQV EQU   SELFLGS1
SELDEFER EQU   SELFLGS1
SELRBOPC EQU   SELRB+4
SELRBLEN EQU   SELRB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00343 EQU   @RC00338
@RF00367 EQU   @EL00001
@RF00370 EQU   @EL00001
@RF00390 EQU   @EL00002
@RF00392 EQU   @EL00002
@RF00537 EQU   @EL00003
@RF00778 EQU   @EL00005
@RC00788 EQU   @EL00006
@RC00805 EQU   @EL00006
@RC00818 EQU   @EL00006
@RC00814 EQU   @EL00006
@RC00837 EQU   @RC00835
@RF00856 EQU   @EL00007
@RC00861 EQU   @EL00008
@RC00878 EQU   @EL00008
@RC00872 EQU   @EL00008
@RC00897 EQU   @EL00008
@RF00938 EQU   @EL00008
@RC00966 EQU   @RC00964
@RC01013 EQU   @RC00964
@RF01028 EQU   @EL00009
@RF01032 EQU   @EL00009
@RF01053 EQU   @EL00010
@RC01091 EQU   @EL00012
@RF01133 EQU   @RC01125
@RC01145 EQU   @RC01143
@RF01171 EQU   @EL00013
@RC01209 EQU   @EL00015
@RC01221 EQU   @EL00015
@RC01249 EQU   @EL00016
@RC01279 EQU   @EL00016
@RC01274 EQU   @EL00016
@RC01272 EQU   @EL00016
@RF01423 EQU   @EL00017
@RC00809 EQU   @RC00805
@RC00807 EQU   @RC00805
@RC00815 EQU   @RC00814
@RF00875 EQU   @RC00872
@RF00884 EQU   @RC00878
@RF00912 EQU   @RC00897
@RC00974 EQU   @RC00966
@RF01162 EQU   @RC01145
@RC01157 EQU   @RC01145
@RC01253 EQU   @RC01249
@RC01251 EQU   @RC01249
@ENDDATA EQU   *
         END   ICBVSL00,(C'PLS1955',0701,77354)

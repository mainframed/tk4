         TITLE 'ICBVUT00 - DEFV, MCRT, COVC PROCESSOR (OCT 9, 1974) MVS*
               S        '
ICBVUT00 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'ICBVUT00  78.157'                                 0001
ICBVUCHI DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP02562-ICBVUCHI)
         ENTRY ICBVUCHI
ICBVUCHO DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP02779-ICBVUCHO)
         ENTRY ICBVUCHO
ICBVUPGH DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP02929-ICBVUPGH)
         ENTRY ICBVUPGH
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         LA    @08,4095(,@09)                                      0001
         LA    @07,4095(,@08)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         USING @PSTART+16380,@08                                   0001
         USING @PSTART+20475,@07                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*   RPLVPTR=RG1;                    /* ADDR TO REQUEST BLK   @Y30LB25*/
         ST    RG1,RPLVPTR                                         0141
*   RESPECIFY                                                      0142
*     RG1 UNRSTD;                   /* FREE REG1             @Y30LB25*/
*   VVIPTR=RPLVVICB;                /* ADDR TO MSVCB         @Y30LB25*/
         L     @03,RPLVPTR                                         0143
         L     @15,RPLVVICB(,@03)                                  0143
         ST    @15,VVIPTR                                          0143
*   MCRTPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBMCRT       @Y30LB25*/
         LA    @14,RPLVUTIL(,@03)                                  0144
         LR    MCRTPTR,@14                                         0144
*   DEFVPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBDEFV       @Y30LB25*/
         LR    DEFVPTR,@14                                         0145
*   CVOLPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBCOVC       @Y30LB25*/
         ST    @14,CVOLPTR                                         0146
*   MCRTEPTR=MCRTPTR+MCRTLEN;       /* ADDR TO ICBMCRTE      @Y30LB25*/
         LR    @01,MCRTPTR                                         0147
         AL    @01,MCRTLEN(,MCRTPTR)                               0147
         ST    @01,MCRTEPTR                                        0147
*   DEFVEPTR=DEFVPTR+DEFVLEN;       /* ADDR TO ICBDEFVE      @Y30LB25*/
         LR    DEFVEPTR,DEFVPTR                                    0148
         AL    DEFVEPTR,DEFVLEN(,DEFVPTR)                          0148
*   COVCEPTR=CVOLPTR+CVOLLEN;       /* ADDR TO ICBCOVCE      @Y30LB25*/
         LR    @01,@14                                             0149
         AL    @01,CVOLLEN(,@14)                                   0149
         ST    @01,COVCEPTR                                        0149
*   GROUPPTR=ADDR(GROUPBUF);        /* ADDR GRP BUF          @Y30LB25*/
         LA    @14,GROUPBUF                                        0150
         ST    @14,GROUPPTR                                        0150
*   NGVRPTR=ADDR(NGVRBUF);          /* ADDR NON-GRP BUF      @Y30LB25*/
         LA    NGVRPTR,NGVRBUF                                     0151
*   COPYVPTR=ADDR(COPYBUF);         /* ADDR CVR BUF          @Y30LB25*/
         LA    @14,COPYBUF                                         0152
         ST    @14,COPYVPTR                                        0152
*   BASEVPTR=ADDR(BASEBUF);         /* ADDR BVR BUF          @Y30LB25*/
         LA    @14,BASEBUF                                         0153
         ST    @14,BASEVPTR                                        0153
*   INDEXPTR=ADDR(INDEXBUF);        /* ADDR CIR BUF          @Y30LB25*/
         LA    @14,INDEXBUF                                        0154
         ST    @14,INDEXPTR                                        0154
*   DUPVPTR=ADDR(DUPVBUF);          /* ADDR DUP BUF          @Y30LB25*/
         LA    @14,DUPVBUF                                         0155
         ST    @14,DUPVPTR                                         0155
*   WORKAREA=WORKAREA&&WORKAREA;    /* ZERO WORK AREA        @Y30LB25*/
         XC    WORKAREA(23),WORKAREA                               0156
*   CIDKY=FIXONE;                   /* CVR ID TO 1           @Y30LB25*/
         MVI   CIDKY,X'01'                                         0157
*   DIDKY=FIXONE;                   /* DVR ID TO 1           @Y30LB25*/
         MVI   DIDKY,X'01'                                         0158
*                                                                  0159
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR MSVC DISABLED                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0159
*   IF VVIFLG0=ON                   /* DISABLED?             @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    VVIFLG0(@15),B'10000000'                            0159
         BNO   @RF00159                                            0159
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/
         MVC   RPLVRETC(2,@03),@CH00041                            0161
*       RPLRCODE=DISABLED;          /* REASON CODE           @Y30LB25*/
         MVC   RPLRCODE(2,@03),@CB00723                            0162
*       RETURN;                     /*                       @Y30LB25*/
@EL00001 L     @13,4(,@13)                                         0163
@EF00001 DS    0H                                                  0163
@ER00001 LM    @14,@12,12(@13)                                     0163
         BR    @14                                                 0163
*     END;                          /*                       @Y30LB25*/
*                                                                  0165
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR BEFORE OR AFTER MSC CALL AND DETERMINE      @Y30LB25*/
*   /* THE CORRECT MSVC FUNCTION TO PERFORM.                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0165
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00159 L     @01,RPLVPTR                                         0165
         TM    RPLFTIME(@01),B'10000000'                           0165
         BNZ   @RF00165                                            0165
*     DO;                           /*                       @Y30LB25*/
*       CALL BEFRMSC;               /* PROCESS BEFORE MSC    @Y30LB25*/
         BAL   @14,BEFRMSC                                         0167
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00001                                            0168
*     END;                          /*                       @Y30LB25*/
*   ELSE                            /* PROCESS AFTER MSC     @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
@RF00165 DS    0H                                                  0171
*       CALL AFTRMSC;               /*                       @Y30LB25*/
         BAL   @14,AFTRMSC                                         0171
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00001                                            0172
*     END;                          /*                       @Y30LB25*/
*                                                                  0174
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - BEFRMSC                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS MSVC BEFORE THE CALL TO THE MSC.   @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0174
*BEFRMSC:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0174
BEFRMSC  ST    @14,@SA00002                                        0174
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR .MSVIJRNL DISABLED AND RECOVERY PROCESSING  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   IF VVIFLG2=ON&RPLJRCVY=OFF      /* JRNL DISABLED & NO    @Y30LB25
*                                      RECOVERY PROC?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,VVIPTR                                          0175
         TM    VVIFLG2(@01),B'00100000'                            0175
         BNO   @RF00175                                            0175
         L     @15,RPLVPTR                                         0175
         TM    RPLJRCVY(@15),B'00000010'                           0175
         BNZ   @RF00175                                            0175
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/
         MVC   RPLVRETC(2,@15),@CH00041                            0177
*       RPLRCODE=JRNLDISB;          /* JRNL DISABLED         @Y30LB25*/
         MVC   RPLRCODE(2,@15),@CB00725                            0178
*       RETURN;                     /*                       @Y30LB25*/
@EL00002 DS    0H                                                  0179
@EF00002 DS    0H                                                  0179
@ER00002 L     @14,@SA00002                                        0179
         BR    @14                                                 0179
*     END;                          /*                       @Y30LB25*/
*                                                                  0180
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0181
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00175 CLI   DEFVOPCD(DEFVPTR),24                                0181
         BNE   @RF00181                                            0181
*     DO;                           /*                       @Y30LB25*/
*                                                                  0182
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0183
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFVACT(DEFVPTR),B'00000010'                        0183
         BNO   @RF00183                                            0183
*         DO;                       /*                       @Y30LB25*/
*           CALL ACTVOL1;           /*                       @Y30LB25
*                                      ACTIVATE AN INACT     @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,ACTVOL1                                         0185
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0186
*         END;                      /*                       @Y30LB25*/
*                                                                  0187
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0188
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00183 TM    DEFVCR(DEFVPTR),B'10000000'                         0188
         BNO   @RF00188                                            0188
*         DO;                       /*                       @Y30LB25*/
*           CALL CRTINCV1;          /*                       @Y30LB25
*                                      CREATE AN INACT       @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,CRTINCV1                                        0190
*           IF RPLVRETC=FIXZERO     /*                       @VS32198
*                                      ERROR?                @VS32198*/
*             THEN                  /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         0191
         LH    @06,RPLVRETC(,@06)                                  0191
         N     @06,@CF01129                                        0191
         LTR   @06,@06                                             0191
         BNZ   @RF00191                                            0191
*             CALL JRNLRPLV;        /*                       @VS32198
*                                      JOURNAL RPLV          @VS32198*/
         BAL   @14,JRNLRPLV                                        0192
*           RETURN;                 /*                       #Y30LB25*/
         B     @EL00002                                            0193
*         END;                      /*                       #Y30LB25*/
*                                                                  0194
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0195
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     #Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00188 TM    DEFVREP(DEFVPTR),B'00010000'                        0195
         BNO   @RF00195                                            0195
*         DO;                       /*                       @Y30LB25*/
*           CALL REPVFLG1;          /*                       @Y30LB25
*                                      REPLACE VOL FLAGS     @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,REPVFLG1                                        0197
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0198
*         END;                      /*                       @Y30LB25*/
*                                                                  0199
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0200
*       IF DEFVRNM=ON×DEFVRNTR=ON   /*                       @Y30LB25
*                                      RENAME ACT VOL OR     @Y30LB25
*                                      RENAME INAC VOL?      @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00195 TM    DEFVRNM(DEFVPTR),B'00100100'                        0200
         BZ    @RF00200                                            0200
*         DO;                       /*                       @Y30LB25*/
*           CALL RENAME1;           /*                       @Y30LB25
*                                      RENAME ACT VOL OR     @Y30LB25
*                                      RENAME INAC VOL       @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,RENAME1                                         0202
*           IF RPLVRETC=FIXZERO     /*                       @VS32198
*                                      ERROR?                @VS32198*/
*             THEN                  /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         0203
         LH    @06,RPLVRETC(,@06)                                  0203
         N     @06,@CF01129                                        0203
         LTR   @06,@06                                             0203
         BNZ   @RF00203                                            0203
*             CALL JRNLRPLV;        /*                       @VS32198
*                                      JOURNAL RPLV          @VS32198*/
         BAL   @14,JRNLRPLV                                        0204
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0205
*         END;                      /*                       @Y30LB25*/
*                                                                  0206
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0207
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00200 TM    DEFVELM(DEFVPTR),B'01000000'                        0207
         BNO   @RF00207                                            0207
*         DO;                       /*                       @Y30LB25*/
*           CALL RMSVI;             /*                       @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
         BAL   @14,RMSVI                                           0209
*           CALL ELACREN1;          /*                       @Y30LB25
*                                      ELIMINATE ACT VOL     @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,ELACREN1                                        0210
*           IF RPLVRETC=FIXZERO     /*                       @VS32198
*                                      ERROR?                @VS32198*/
*             THEN                  /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         0211
         LH    @06,RPLVRETC(,@06)                                  0211
         N     @06,@CF01129                                        0211
         LTR   @06,@06                                             0211
         BNZ   @RF00211                                            0211
*             CALL JRNLRPLV;        /*                       @VS32198
*                                      JOURNAL RPLV          @VS32198*/
         BAL   @14,JRNLRPLV                                        0212
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0213
*         END;                      /*                       @Y30LB25*/
*                                                                  0214
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0215
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00207 TM    DEFVELTR(DEFVPTR),B'00001000'                       0215
         BNO   @RF00215                                            0215
*         DO;                       /*                       @Y30LB25*/
*           CALL RMSVIS;            /*                       @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
         BAL   @14,RMSVIS                                          0217
*           IVOLKY=DEFVCSN1;        /*                       @Y30LB25
*                                      CSN TO CIR KEY        @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0218
*           CALL GETRECLC;          /*                       @Y30LB25
*                                      ELIMINATE INAC VOL    @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,GETRECLC                                        0219
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0220
*         END;                      /*                       @Y30LB25*/
*                                                                  0221
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR DEACTIVATE AN ACTIVE VOLUME.            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0222
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00215 TM    DEFVDACT(DEFVPTR),B'00000001'                       0222
         BNO   @RF00222                                            0222
*         DO;                       /*                       @Y30LB25*/
*           CALL RMSVIS;            /*                       @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
         BAL   @14,RMSVIS                                          0224
*           BVOLKY=DEFVOLD;         /*                       @Y30LB25
*                                      VOLID TO BVR KEY      @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          0225
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25
*                                      KEY ADDR              @Y30LB25*/
         LA    @06,BKEY                                            0226
         L     @01,RPLVPTR                                         0226
         ST    @06,RPLVKEY(,@01)                                   0226
*           CALL READLOC;           /*                       @Y30LB25
*                                      DEACTIVATE ACT VOL    @Y30LB25
*                                      BEFORE MCS CALL       @Y30LB25*/
         BAL   @14,READLOC                                         0227
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0228
*         END;                      /*                       @Y30LB25*/
*                                                                  0229
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0230
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/
@RF00222 L     @06,RPLVPTR                                         0230
         MVC   RPLVRETC(2,@06),@CH00041                            0230
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0231
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00002                                            0232
*     END;                          /*                       @Y30LB25*/
*                                                                  0233
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
*                                                                  0234
@RF00181 CLI   MCRTOPCD(MCRTPTR),14                                0234
         BNE   @RF00234                                            0234
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0235
*     IF MCRTTRAN=ON                /* MOVE INACT CART?      @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0235
         BNO   @RF00235                                            0235
*       DO;                         /*                       @Y30LB25*/
*         CALL INACVOL1;            /* MOVE INACT VOL        @Y30LB25
*                                      BEFORE MSC CALL       @Y30LB25*/
         BAL   @14,INACVOL1                                        0237
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00002                                            0238
*       END;                        /*                       @Y30LB25*/
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*     ELSE                          /* ERROR                 @Y30LB25*/
*       DO;                         /*                       @Y30LB25*/
@RF00235 DS    0H                                                  0241
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0241
         MVC   RPLVRETC(2,@06),@CH00041                            0241
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0242
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00002                                            0243
*       END;                        /*                       @Y30LB25*/
*                                                                  0244
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00234 L     @06,CVOLPTR                                         0245
         CLI   CVOLOPCD(@06),X'2A'                                 0245
         BNE   @RF00245                                            0245
*     DO;                           /*                       @Y30LB25*/
*                                                                  0246
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/
*       /* DASD TO CARTRIDGE.                                @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0247
*       IF CVODASCR=ON              /* TRANSFER DATA         @Y30LB25
*                                      DASD TO CART?         @Y30LB25*/
*         THEN                      /* YES?                  @Y30LB25*/
         TM    CVODASCR(@06),B'10000000'                           0247
         BNO   @RF00247                                            0247
*         DO;                       /*                       @Y30LB25*/
*           CALL RMSVIS;            /*                       @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
         BAL   @14,RMSVIS                                          0249
*           BVOLKY=CVOLID;          /*                       @Y30LB25
*                                      VOLID TO BVR          @Y30LB25*/
         L     @06,CVOLPTR                                         0250
         MVC   BVOLKY(6),CVOLID(@06)                               0250
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25
*                                      KEY ADDR              @Y30LB25*/
         LA    @06,BKEY                                            0251
         L     @01,RPLVPTR                                         0251
         ST    @06,RPLVKEY(,@01)                                   0251
*           CALL READLOC;           /*                       @Y30LB25
*                                      TRANSFER DATA         @Y30LB25
*                                      DASD TO CART          @Y30LB25*/
         BAL   @14,READLOC                                         0252
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00002                                            0253
*         END;                      /*                       @Y30LB25*/
*                                                                  0254
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSFER DATA FROM AN ACTIVE TO AN                @Y30LB25*/
*       /* INACTIVE VOLUME, OR TRANSFER                      @Y30LB25*/
*       /* DATA FROM AN INACTIVE TO AN                       @Y30LB25*/
*       /* ACTIVE VOLUME.                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0255
*       IF CVOCRCR=ON×CVOCRCRV=ON   /* TRANSFER DATA         @Y30LB25
*                                      ACT VOL TO INACT      @Y30LB25
*                                      VOL? OR TRANSFER      @Y30LB25
*                                      DATA INACT TO         @Y30LB25
*                                      ACT VOL?              @Y30LB25*/
*         THEN                      /* YES?                  @Y30LB25*/
@RF00247 L     @06,CVOLPTR                                         0255
         TM    CVOCRCR(@06),B'00110000'                            0255
         BNZ   @RT00255                                            0255
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  0256
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID COPY REQUEST.                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0257
*       RPLVRETC=FIXFOUR;           /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0257
         MVC   RPLVRETC(2,@06),@CH00041                            0257
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0258
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00002                                            0259
*     END;                          /*                       @Y30LB25*/
*                                                                  0260
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00245 L     @06,CVOLPTR                                         0261
         CLI   CVOLOPCD(@06),X'28'                                 0261
         BE    @RT00261                                            0261
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  0262
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID FUNCTION.                                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0263
         MVC   RPLRCODE(2,@06),@CH00041                            0263
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0264
*   END BEFRMSC;                    /*                       @Y30LB25*/
         B     @EL00002                                            0265
*                                                                  0266
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - AFTRMSC                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS MSVC AFTER THE CALL TO THE MSC.    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0266
*AFTRMSC:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0266
AFTRMSC  ST    @14,@SA00003                                        0266
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0267
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLI   DEFVOPCD(DEFVPTR),24                                0267
         BNE   @RF00267                                            0267
*     DO;                           /*                       @Y30LB25*/
*                                                                  0268
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0269
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFVACT(DEFVPTR),B'00000010'                        0269
         BNO   @RF00269                                            0269
*         DO;                       /*                       @Y30LB25*/
*           CALL ACTVOL2;           /*                       @Y30LB25
*                                      ACTIVATE AN INACT     @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,ACTVOL2                                         0271
*           RETURN;                 /*                       @Y30LB25*/
@EL00003 DS    0H                                                  0272
@EF00003 DS    0H                                                  0272
@ER00003 L     @14,@SA00003                                        0272
         BR    @14                                                 0272
*         END;                      /*                       @Y30LB25*/
*                                                                  0273
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0274
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00269 TM    DEFVCR(DEFVPTR),B'10000000'                         0274
         BNO   @RF00274                                            0274
*         DO;                       /*                       @Y30LB25*/
*           CALL CRTINCV2;          /*                       @Y30LB25
*                                      CREATE AN INACT       @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,CRTINCV2                                        0276
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0277
*         END;                      /*                       @Y30LB25*/
*                                                                  0278
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0279
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00274 TM    DEFVREP(DEFVPTR),B'00010000'                        0279
         BNO   @RF00279                                            0279
*         DO;                       /*                       @Y30LB25*/
*           CALL REPVFLG2;          /*                       @Y30LB25
*                                      REPLACE VOL FLAGS     @Y30LB25
*                                      A FTER MCS CALL       @Y30LB25*/
         BAL   @14,REPVFLG2                                        0281
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0282
*         END;                      /*                       @Y30LB25*/
*                                                                  0283
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0284
*       IF DEFVRNM=ON×DEFVRNTR=ON   /* RENAME ACT VOL OR     @Y30LB25
*                                      INACT VOL?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00279 TM    DEFVRNM(DEFVPTR),B'00100100'                        0284
         BZ    @RF00284                                            0284
*         DO;                       /*                       @Y30LB25*/
*           CALL RENAME2;           /*                       @Y30LB25
*                                      RENAME ACT VOL OR     @Y30LB25
*                                      INACT VOL             @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,RENAME2                                         0286
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0287
*         END;                      /*                       @Y30LB25*/
*                                                                  0288
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0289
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00284 TM    DEFVELM(DEFVPTR),B'01000000'                        0289
         BNO   @RF00289                                            0289
*         DO;                       /*                       @Y30LB25*/
*           CALL ELMACTV2;          /*                       @Y30LB25
*                                      ELIMINATE ACT VOL     @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,ELMACTV2                                        0291
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0292
*         END;                      /*                       @Y30LB25*/
*                                                                  0293
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0294
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00289 TM    DEFVELTR(DEFVPTR),B'00001000'                       0294
         BNO   @RF00294                                            0294
*         DO;                       /*                       @Y30LB25*/
*           CALL ELINACV2;          /*                       @Y30LB25
*                                      ELIMINATE INAC VOL    @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,ELINACV2                                        0296
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0297
*         END;                      /*                       @Y30LB25*/
*                                                                  0298
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR DEACTIVE AN ACTIVE VOLUME.              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0299
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00294 TM    DEFVDACT(DEFVPTR),B'00000001'                       0299
         BNO   @RF00299                                            0299
*         DO;                       /*                       @Y30LB25*/
*           CALL DEACTV2;           /*                       @Y30LB25
*                                      DEACTIVATE ACT VOL    @Y30LB25
*                                      AFTER MCS CALL        @Y30LB25*/
         BAL   @14,DEACTV2                                         0301
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0302
*         END;                      /*                       @Y30LB25*/
*                                                                  0303
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0304
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/
@RF00299 L     @06,RPLVPTR                                         0304
         MVC   RPLVRETC(2,@06),@CH00041                            0304
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0305
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00003                                            0306
*     END;                          /*                       @Y30LB25*/
*                                                                  0307
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0308
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
*                                                                  0308
@RF00267 CLI   MCRTOPCD(MCRTPTR),14                                0308
         BNE   @RF00308                                            0308
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0309
*     IF MCRTTRAN=ON                /* MOVE INAC VOL?        @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0309
         BNO   @RF00309                                            0309
*       DO;                         /*                       @Y30LB25*/
*         CALL INACVOL2;            /* MOVE INACT VOL        @Y30LB25
*                                      AFTER MSC CALL        @Y30LB25*/
         BAL   @14,INACVOL2                                        0311
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00003                                            0312
*       END;                        /*                       @Y30LB25*/
*                                                                  0313
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*     ELSE                          /* ERROR                 @Y30LB25*/
*       DO;                         /*                       @Y30LB25*/
@RF00309 DS    0H                                                  0315
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0315
         MVC   RPLVRETC(2,@06),@CH00041                            0315
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0316
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00003                                            0317
*       END;                        /*                       @Y30LB25*/
*                                                                  0318
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0319
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00308 L     @06,CVOLPTR                                         0319
         CLI   CVOLOPCD(@06),X'2A'                                 0319
         BNE   @RF00319                                            0319
*     DO;                           /*                       @Y30LB25*/
*                                                                  0320
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/
*       /* DASD TO CARTRIDGE, OR                             @Y30LB25*/
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/
*       /* AN INACTIVE TO AN ACTIVE VOLUME.                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0321
*       IF CVODASCR=ON×CVOCRCRV=ON  /* TRANSFER DATA         @Y30LB25
*                                      DASD TO CART OR       @Y30LB25
*                                      TRANSFER DATA         @Y30LB25
*                                      INACT TO ACT?         @Y30LB25*/
*         THEN                      /* YES?                  @Y30LB25*/
         TM    CVODASCR(@06),B'10010000'                           0321
         BZ    @RF00321                                            0321
*         DO;                       /*                       @Y30LB25*/
*           CALL TRANDAT2;          /*                       @Y30LB25
*                                      TRANSFER DATA         @Y30LB25
*                                      DASD TO CART OR       @Y30LB25
*                                      TRANSFER DATA         @Y30LB25
*                                      INACT TO ACT          @Y30LB25
*                                      AFTER MSC             @Y30LB25*/
         BAL   @14,TRANDAT2                                        0323
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0324
*         END;                      /*                       @Y30LB25*/
*                                                                  0325
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/
*       /* AN ACTIVE TO AN INACTIVE VOLUME.                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0326
*       IF CVOCRCR=ON               /* TRANSFER DATA         @Y30LB25
*                                      ACT TO INACT?         @Y30LB25*/
*         THEN                      /* YES?                  @Y30LB25*/
@RF00321 L     @06,CVOLPTR                                         0326
         TM    CVOCRCR(@06),B'00100000'                            0326
         BNO   @RF00326                                            0326
*         DO;                       /*                       @Y30LB25*/
*           CALL ACINACV2;          /*                       @Y30LB25
*                                      TRANSFER DATA         @Y30LB25
*                                      ACT TO INAC VOL       @Y30LB25
*                                      AFTER MSC             @Y30LB25*/
         BAL   @14,ACINACV2                                        0328
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00003                                            0329
*         END;                      /*                       @Y30LB25*/
*                                                                  0330
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID COPY REQUEST.                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0331
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/
@RF00326 L     @06,RPLVPTR                                         0331
         MVC   RPLVRETC(2,@06),@CH00041                            0331
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0332
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00003                                            0333
*     END;                          /*                       @Y30LB25*/
*                                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00319 L     @06,CVOLPTR                                         0335
         CLI   CVOLOPCD(@06),X'28'                                 0335
         BE    @RT00335                                            0335
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* INVALID FUNCTION.                                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0337
         MVC   RPLRCODE(2,@06),@CH00041                            0337
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00727                            0338
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00003                                            0339
*   END AFTRMSC;                    /*                       @Y30LB25*/
         B     @EL00003                                            0340
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - JRNLRPLV                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - WRITE THE RPLV TO .MSVIJRNL BEFORE AND/OR  @VS32198*/
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* RPLV WAS JOURNALLED FLAG IN PASSBYTE                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE/RELEASE RETURNS ZERO REASON/RETURN CODES.     @Y30LB25*/
*   /* RPLV WILL BE JOURNALLED, BECAUSE CHECK FOR DISABLED   @Y30LB25*/
*   /* WAS MADE BEFORE CALL TO THE MSC. THEREFORE,           @Y30LB25*/
*   /* THIS INCOMPLETELY PROCESSED FUNCTION WILL BE ALLOWED  @Y30LB25*/
*   /* TO COMPLETE EVEN IF THE JOURNAL HAS BEEN DISABLED     @Y30LB25*/
*   /* SINCE THE LAST CHECK. THE JOURNAL ALWAYS HAS          @Y30LB25*/
*   /* SPACE RESERVED FOR SUCH A SITUATION.                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*JRNLRPLV:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
JRNLRPLV ST    @14,@SA00004                                        0341
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG0=RESEXVJL;                   /* RESERVE JRNL FLAG     @Y30LB25*/
         LA    RG0,17                                              0344
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/
         L     RG1,RPLVPTR                                         0345
*   CALL ICBVRR00;                  /* RESERVE JOURNNAL      @Y30LB25*/
         L     @15,@CV00763                                        0346
         BALR  @14,@15                                             0346
*   CALL ICBVJL00;                  /* JRNL THE RPLV         @Y30LB25*/
         L     @15,@CV00764                                        0347
         BALR  @14,@15                                             0347
*   RG0=DEQJRNL;                    /* RELEASE JRNL FLAG     @Y30LB25*/
         LA    RG0,16                                              0348
*   CALL ICBVRR00;                  /* RELEASE JOURNAL       @Y30LB25*/
         L     @15,@CV00763                                        0349
         BALR  @14,@15                                             0349
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RPLVFLG=ON;                     /* RPLV IS JRNLED        @Y30LB25*/
         OI    RPLVFLG,B'00000001'                                 0352
*   RETURN;                         /*                       @Y30LB25*/
@EL00004 DS    0H                                                  0353
@EF00004 DS    0H                                                  0353
@ER00004 L     @14,@SA00004                                        0353
         BR    @14                                                 0353
*   END JRNLRPLV;                   /*                       @Y30LB25*/
*                                                                  0355
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RMSVI                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - RESERVE .MSVI EXCLUSIVE.                   @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* NONE                                                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*RMSVI:                             /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
RMSVI    ST    @14,@SA00005                                        0355
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG0=RESEXINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/
         LA    RG0,1                                               0358
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/
         L     RG1,RPLVPTR                                         0359
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/
         L     @15,@CV00763                                        0360
         BALR  @14,@15                                             0360
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   END RMSVI;                      /*                       @Y30LB25*/
@EL00005 DS    0H                                                  0363
@EF00005 DS    0H                                                  0363
@ER00005 L     @14,@SA00005                                        0363
         BR    @14                                                 0363
*                                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RMSVIS                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - RESERVE .MSVI SHARED.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* NONE                                                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*RMSVIS:                            /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
RMSVIS   ST    @14,@SA00006                                        0364
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG0=RESSHINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/
         LA    RG0,2                                               0367
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/
         L     RG1,RPLVPTR                                         0368
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/
         L     @15,@CV00763                                        0369
         BALR  @14,@15                                             0369
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   END RMSVIS;                     /*                       @Y30LB25*/
@EL00006 DS    0H                                                  0372
@EF00006 DS    0H                                                  0372
@ER00006 L     @14,@SA00006                                        0372
         BR    @14                                                 0372
*                                                                  0373
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - INACVOL1                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME BEFORE     @Y30LB25*/
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY. @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0373
*INACVOL1:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0373
INACVOL1 ST    @14,@SA00007                                        0373
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE .MSVI.                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0374
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/
*                                                                  0374
         BAL   @14,RMSVIS                                          0374
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET TO THE CVR, DVR, OR BVR KEY.      @Y30LB25*/
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/
*   /* NOT FOR UPDATE.                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0375
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/
         MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0375
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECLC                                        0376
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0377
         CLC   RPLRCODE(2,@15),@CB00713                            0377
         BE    @RT00377                                            0377
*     RETURN;                       /*                       @Y30LB25*/
*   IF RPLRCODE=NORECFND&           /* NO RECD FND WITH      @Y30LB25*/
*       (MCRTVEXT^=FIXZERO&MCRREC=ON)/* RECORD OPTION ON?    @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLC   RPLRCODE(2,@15),@CB00711                            0379
         BNE   @RF00379                                            0379
         L     @14,MCRTVEXT(,MCRTPTR)                              0379
         LTR   @14,@14                                             0379
         BZ    @RF00379                                            0379
         L     @01,MCRTEPTR                                        0379
         TM    MCRREC(@01),B'10000000'                             0379
         BNO   @RF00379                                            0379
*     DO;                           /*                       @Y30LB25*/
*       RPLRCODE=RECDOPTN;          /* ERROR                 @Y30LB25*/
         MVC   RPLRCODE(2,@15),@CB00733                            0381
*       RETURN;                     /*                       @Y30LB25*/
@EL00007 DS    0H                                                  0382
@EF00007 DS    0H                                                  0382
@ER00007 L     @14,@SA00007                                        0382
         BR    @14                                                 0382
*     END;                          /*                       @Y30LB25*/
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00379 L     @15,RPLVPTR                                         0384
         CLC   RPLRCODE(2,@15),@CB00711                            0384
         BNE   @RF00384                                            0384
*     DO;                           /*                       @Y30LB25*/
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0386
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0387
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00007                                            0388
*     END;                          /*                       @Y30LB25*/
*   BCDVPTR=RPLVBUF;                /* ADDR OF MSVC RECD     @Y30LB25*/
@RF00384 L     @01,RPLVPTR                                         0390
         L     @15,RPLVBUF(,@01)                                   0390
         ST    @15,BCDVPTR                                         0390
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    BCDCOPY(@15),B'00010000'                            0391
         BO    @RT00391                                            0391
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  0392
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE MOVE CARTRIDGE EXTENSION.                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/
         BAL   @14,PROMCRTE                                        0393
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00007                                            0394
*   END INACVOL1;                   /*                       @Y30LB25*/
         B     @EL00007                                            0395
*                                                                  0396
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - GETRECLC                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - READ FOR A CIR USING THE INPUT CSN, THEN   @Y30LB25*/
*   /* GET THE MSVC RECORD FROM ITS KEY IN THE CIR           @Y30LB25*/
*   /* ALL IN THE LOCATE MODE.                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0396
*GETRECLC:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
GETRECLC ST    @14,@SA00008                                        0396
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/
         L     @15,RPLVPTR                                         0397
         LA    @14,IKEY                                            0397
         ST    @14,RPLVKEY(,@15)                                   0397
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         MVI   RPLVTYP(@15),X'00'                                  0398
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/
         OI    RPLVDIR(@15),B'11000000'                            0400
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/
         NI    RPLVUPD(@15),B'11111101'                            0401
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@15                                             0403
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/
         L     @15,@CV00762                                        0404
         BALR  @14,@15                                             0404
*   IF RPLVRETC^=FIXZERO            /* ERROR                 @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0405
         LH    @00,RPLVRETC(,@15)                                  0405
         N     @00,@CF01129                                        0405
         LTR   @00,@00                                             0405
         BNZ   @RT00405                                            0405
*     RETURN;                       /*                       @Y30LB25*/
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/
         L     @00,RPLVBUF(,@15)                                   0407
         ST    @00,INDEXPTR                                        0407
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/
         LR    @14,@00                                             0408
         MVC   BCDKEY(13),INDRECKY(@14)                            0408
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/
         LA    @00,BCDKEY                                          0409
         ST    @00,RPLVKEY(,@15)                                   0409
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/
         L     @15,@CV00762                                        0410
         BALR  @14,@15                                             0410
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00008 DS    0H                                                  0412
@EF00008 DS    0H                                                  0412
@ER00008 L     @14,@SA00008                                        0412
         BR    @14                                                 0412
*   END GETRECLC;                   /*                       @Y30LB25*/
         B     @EL00008                                            0413
*                                                                  0414
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - INACVOL2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME AFTER      @Y30LB25*/
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*INACVOL2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0414
INACVOL2 ST    @14,@SA00009                                        0414
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN MSC ERRROR OTHER THAT ONE                @VS32198*/
*   /* CARTRIDGE EJECTED.                                    @VS32198*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0415
*   IF RPLRCODE^=EJEC1CRT&RPLVRETC^=FIXZERO/* MSC ERROR?     @ZA13487*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0415
         CLC   RPLRCODE(2,@15),@CB00701                            0415
         BE    @RF00415                                            0415
         LH    @14,RPLVRETC(,@15)                                  0415
         N     @14,@CF01129                                        0415
         LTR   @14,@14                                             0415
         BZ    @RF00415                                            0415
*     DO;                           /*                       @VS32198*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @VS32198*/
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0417
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @VS32198*/
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0418
*       RETURN;                     /*                       @VS32198*/
@EL00009 DS    0H                                                  0419
@EF00009 DS    0H                                                  0419
@ER00009 L     @14,@SA00009                                        0419
         BR    @14                                                 0419
*     END;                          /*                       @VS32198*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198
*                                      RESERVE .MSVI         @VS32198*/
*                                                                  0421
@RF00415 BAL   @14,HOUSKEEP                                        0421
*   /*****************************************************************/
*   /*                                                               */
*   /* ONE CARTRIDGE EJECTED IS OK.                          @VS32198*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0422
*   IF RPLRCODE=EJEC1CRT            /* 1 CART EJECTED?       @VS32198*/
*     THEN                          /* YES                   @VS32198*/
         L     @15,RPLVPTR                                         0422
         CLC   RPLRCODE(2,@15),@CB00701                            0422
         BNE   @RF00422                                            0422
*     DO;                           /* OK                    @VS32198*/
*       REACODE=RPLRCODE;           /* SAVE REASON CODE      @VS32198*/
         MVC   REACODE(2),RPLRCODE(@15)                            0424
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0425
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0426
*     END;                          /*                       @VS32198*/
*                                                                  0427
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET THE CVR, BVR, OR DVR KEY.         @Y30LB25*/
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/
*   /* FOR UPDATE                                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0428
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/
@RF00422 MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0428
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECUD                                        0429
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0430
         CLC   RPLRCODE(2,@15),@CB00713                            0430
         BE    @RT00430                                            0430
*     RETURN;                       /*                       @Y30LB25*/
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLC   RPLRCODE(2,@15),@CB00711                            0432
         BNE   @RF00432                                            0432
*     DO;                           /*                       @Y30LB25*/
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0434
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0435
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00009                                            0436
*     END;                          /*                       @Y30LB25*/
*                                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS MCRTE                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0438
*   BCDVPTR=BASEVPTR;               /* ADDR OF MSVC RECD     @Y30LB25*/
@RF00432 L     @15,BASEVPTR                                        0438
         ST    @15,BCDVPTR                                         0438
*   INDEXPTR=ADDR(INDEXBUF);        /* RESET BUF PTR         @Y30LB25*/
         LA    @15,INDEXBUF                                        0439
         ST    @15,INDEXPTR                                        0439
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/
         BAL   @14,PROMCRTE                                        0440
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00009                                            0441
*   END INACVOL2;                   /*                       @Y30LB25*/
         B     @EL00009                                            0442
*                                                                  0443
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - HOUSKEEP                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION-                                             @Y30LB25*/
*   /* JOURNALS THE RPLV AND RESERVES .MSVI FOR PROCESSING   @Y30LB25*/
*   /* AFTER THE MSC IS DONE.                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0443
*HOUSKEEP:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0443
HOUSKEEP ST    @14,@SA00010                                        0443
*   /*****************************************************************/
*   /*                                                               */
*   /* JOURNAL THE RPLV                                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*   RETCODE=RPLVRETC;               /* SAVE RETN CODE        @VS32192*/
         L     @15,RPLVPTR                                         0444
         MVC   RETCODE(2),RPLVRETC(@15)                            0444
*   REACODE=RPLRCODE;               /* SAVE RESN CODE        @VS32192*/
         MVC   REACODE(2),RPLRCODE(@15)                            0445
*   CALL JRNLRPLV;                  /* JOURNAL RPLV          @Y30LB25*/
*                                                                  0446
         BAL   @14,JRNLRPLV                                        0446
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE .MSVI.                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   CALL RMSVI;                     /* RESERVE MSVI          @Y30LB25*/
         BAL   @14,RMSVI                                           0447
*   RPLVRETC=RETCODE;               /* REST RETN CODE        @VS32192*/
         L     @15,RPLVPTR                                         0448
         MVC   RPLVRETC(2,@15),RETCODE                             0448
*   RPLRCODE=REACODE;               /* REST RESN CODE        @VS32192*/
         MVC   RPLRCODE(2,@15),REACODE                             0449
*   RETURN;                         /*                       #Y30LB25*/
@EL00010 DS    0H                                                  0450
@EF00010 DS    0H                                                  0450
@ER00010 L     @14,@SA00010                                        0450
         BR    @14                                                 0450
*   END HOUSKEEP;                   /*                       #Y30LB25*/
*                                                                  0452
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - GETRECUD                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - READ A CIR IN THE LOCATE MODE USING        @Y30LB25*/
*   /* THE INPUT CSN, GET THE MSVC RECORD FOR UPDATE         @Y30LB25*/
*   /* FROM ITS KEY IN THE CIR.                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0452
*GETRECUD:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
GETRECUD ST    @14,@SA00011                                        0452
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/
         L     @15,RPLVPTR                                         0453
         LA    @14,IKEY                                            0453
         ST    @14,RPLVKEY(,@15)                                   0453
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         MVI   RPLVTYP(@15),X'00'                                  0454
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/
         OI    RPLVDIR(@15),B'11000000'                            0456
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/
         NI    RPLVUPD(@15),B'11111101'                            0457
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@15                                             0459
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/
         L     @15,@CV00762                                        0460
         BALR  @14,@15                                             0460
*   IF RPLVRETC^=FIXZERO            /* ERROR                 @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0461
         LH    @00,RPLVRETC(,@15)                                  0461
         N     @00,@CF01129                                        0461
         LTR   @00,@00                                             0461
         BNZ   @RT00461                                            0461
*     RETURN;                       /*                       @Y30LB25*/
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/
         L     @00,RPLVBUF(,@15)                                   0463
         ST    @00,INDEXPTR                                        0463
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/
         LR    @14,@00                                             0464
         MVC   BCDKEY(13),INDRECKY(@14)                            0464
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/
         LA    @00,BCDKEY                                          0465
         ST    @00,RPLVKEY(,@15)                                   0465
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@15),B'01111111'                            0466
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/
         OI    RPLVUPD(@15),B'00000010'                            0467
*   RPLVBUF=ADDR(BASEBUF);          /* BUF ADDR              @Y30LB25*/
         LA    @00,BASEBUF                                         0468
         ST    @00,RPLVBUF(,@15)                                   0468
*   RPLVBLN=LENGTH(BASEBUF);        /* BUFF LENGTH           @Y30LB25*/
         MVC   RPLVBLN(4,@15),@CF01103                             0469
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/
         L     @15,@CV00762                                        0470
         BALR  @14,@15                                             0470
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00011 DS    0H                                                  0472
@EF00011 DS    0H                                                  0472
@ER00011 L     @14,@SA00011                                        0472
         BR    @14                                                 0472
*   END GETRECUD;                   /*                       @Y30LB25*/
         B     @EL00011                                            0473
*                                                                  0474
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROMCRTE                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS IEZMCRTE.                          @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*PROMCRTE:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0474
PROMCRTE ST    @14,@SA00012                                        0474
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR BEFORE THE CALL TO THE MSC.                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0475
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         0475
         TM    RPLFTIME(@15),B'10000000'                           0475
         BNZ   @RF00475                                            0475
*     DO;                           /*                       @Y30LB25*/
*                                                                  0476
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR DVR WITH KEEP RECORD OPTION ON.         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0477
*       IF BCDDUP=ON&               /* DVR WITH RECORD       @Y30LB25*/
*           (MCRTVEXT^=FIXZERO&MCRREC=ON)/* OPTION ON?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,BCDVPTR                                         0477
         TM    BCDDUP(@01),B'00000100'                             0477
         BNO   @RF00477                                            0477
         L     @14,MCRTVEXT(,MCRTPTR)                              0477
         LTR   @14,@14                                             0477
         BZ    @RF00477                                            0477
         L     @01,MCRTEPTR                                        0477
         TM    MCRREC(@01),B'10000000'                             0477
         BNO   @RF00477                                            0477
*         DO;                       /*                       @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/
         MVC   RPLVRETC(2,@15),@CH00041                            0479
*           RPLRCODE=RECOPDVR;      /* ERROR REASON CODE     @Y30LB25*/
         MVC   RPLRCODE(2,@15),@CB00717                            0480
*           RETURN;                 /*                       @Y30LB25*/
@EL00012 DS    0H                                                  0481
@EF00012 DS    0H                                                  0481
@ER00012 L     @14,@SA00012                                        0481
         BR    @14                                                 0481
*         END;                      /*                       @Y30LB25*/
*                                                                  0482
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR BVR WITH COPIES, BUT KEEP RECORD        @Y30LB25*/
*       /* OPTION OFF.                                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0483
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/
@RF00477 L     @15,RPLVPTR                                         0483
         L     @14,RPLVBUF(,@15)                                   0483
         ST    @14,BASEVPTR                                        0483
*       IF BCDBASE=ON&(MCRTVEXT^=FIXZERO&MCRREC=OFF)&BASNCOPY^=FIXZERO
*                                   /* BVR, RECORD OPTN      @Y30LB25
*                                      OFF, - WITH CPYS?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,BCDVPTR                                         0484
         TM    BCDBASE(@01),B'00100000'                            0484
         BNO   @RF00484                                            0484
         L     @05,MCRTVEXT(,MCRTPTR)                              0484
         LTR   @05,@05                                             0484
         BZ    @RF00484                                            0484
         L     @01,MCRTEPTR                                        0484
         TM    MCRREC(@01),B'10000000'                             0484
         BNZ   @RF00484                                            0484
         CLI   BASNCOPY(@14),0                                     0484
         BE    @RF00484                                            0484
*         DO;                       /*                       @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/
         MVC   RPLVRETC(2,@15),@CH00041                            0486
*           RPLRCODE=RECOPBVR;      /* ERROR REASON CODE     @Y30LB25*/
         MVC   RPLRCODE(2,@15),@CB00719                            0487
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00012                                            0488
*         END;                      /*                       @Y30LB25*/
*                                                                  0489
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR REASSIGNED BVR.                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0490
*       IF BCDBASE=ON&BASREASS=ON   /* REASS BVR?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00484 L     @06,BCDVPTR                                         0490
         TM    BCDBASE(@06),B'00100000'                            0490
         BNO   @RF00490                                            0490
         L     @06,BASEVPTR                                        0490
         TM    BASREASS(@06),B'00100000'                           0490
         BNO   @RF00490                                            0490
*         DO;                       /*                       @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* ERROR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0492
         MVC   RPLVRETC(2,@06),@CH00041                            0492
*           RPLRCODE=REASSIGN;      /* REASSIGNED            @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00737                            0493
*         END;                      /*                       @Y30LB25*/
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00012                                            0495
*     END;                          /*                       @Y30LB25*/
*                                                                  0496
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING AFTER THE MSC WAS CALLED.                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*   ELSE                            /* AFTER MSC CALL        @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
*                                                                  0497
@RF00475 DS    0H                                                  0498
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK KEEP RECORD OPTION                          @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0498
*       IF(MCRTVEXT^=FIXZERO&MCRREC=ON)×MCRTVEXT=FIXZERO/* KEEP RECD
*                                      OPT ON?               @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @15,MCRTVEXT(,MCRTPTR)                              0498
         LTR   @15,@15                                             0498
         BZ    @GL00011                                            0498
         L     @01,MCRTEPTR                                        0498
         TM    MCRREC(@01),B'10000000'                             0498
         BO    @RT00498                                            0498
@GL00011 L     @15,MCRTVEXT(,MCRTPTR)                              0498
         LTR   @15,@15                                             0498
         BNZ   @RF00498                                            0498
@RT00498 DS    0H                                                  0499
*         DO;                       /*                       @Y30LB25*/
*                                                                  0499
*           /*********************************************************/
*           /*                                                       */
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0500
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         CLC   REACODE(2),@CB00701                                 0500
         BNE   @RF00500                                            0500
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/
         L     @01,BCDVPTR                                         0501
         MVI   BCDLIB1(@01),X'FF'                                  0501
*           ELSE                    /*                       @Y30LB25*/
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/
         B     @RC00500                                            0502
@RF00500 DS    0H                                                  0503
*               BCDLIB1=FIX1F;      /*                       @Y30LB25
*                                      NULL LIBID1           @Y30LB25*/
         L     @15,BCDVPTR                                         0503
         MVI   BCDLIB1(@15),X'FF'                                  0503
*               BCDLIB2=FIX1F;      /*                       @Y30LB25
*                                      NULL LIBID2           @Y30LB25*/
         MVI   BCDLIB2(@15),X'FF'                                  0504
*             END;                  /*                       @Y30LB25*/
*                                                                  0505
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR RECOVERY RPLV AND IF SO USE THE     @ZA13484*/
*           /* DATE THE RPLV WAS CREATED.                    @ZA13484*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0506
*           IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?     0506
*                                                            @ZA13484*/
@RC00500 L     @15,RPLVPTR                                         0506
         TM    RPLJRCVY(@15),B'00000010'                           0506
         BNO   @RF00506                                            0506
         CLC   RPLVDATE(4,@15),NULLDATE                            0506
         BE    @RF00506                                            0506
*             DO;                   /* YES                   @ZA13484*/
*               IF BCDCOPY=ON THEN  /* CVR?                  @ZA13484*/
         L     @06,BCDVPTR                                         0508
         TM    BCDCOPY(@06),B'00010000'                            0508
         BNO   @RF00508                                            0508
*                 DO;               /* YES                   @ZA13484*/
*                   COPYVPTR=BCDVPTR;/* SET CVR PTR          @ZA13484*/
         ST    @06,COPYVPTR                                        0510
*                   COPDTREM=RPLVDATE;/* SET DATE            @ZA13484*/
         MVC   COPDTREM(4,@06),RPLVDATE(@15)                       0511
*                 END;              /*                       @ZA13484*/
*               IF BCDBASE=ON THEN  /* BVR?                  @ZA13484*/
@RF00508 L     @06,BCDVPTR                                         0513
         TM    BCDBASE(@06),B'00100000'                            0513
         BNO   @RF00513                                            0513
*                 BASDTREM=RPLVDATE;/* SET DATE              @ZA13484*/
         L     @06,BASEVPTR                                        0514
         L     @01,RPLVPTR                                         0514
         MVC   BASDTREM(4,@06),RPLVDATE(@01)                       0514
*             END;                  /*                       @ZA13484*/
*           ELSE                                                   0516
*             DO;                   /*                       @ZA13484*/
*                                                                  0516
         B     @RC00506                                            0516
@RF00506 DS    0H                                                  0517
*               /*****************************************************/
*               /*                                                   */
*               /* UPDATE THE LOCATION AND EJECT DATE.       @Y30LB25*/
*               /* GET AND SET THE CURRENT DATE              @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0517
*               CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/*     @ZA30662
*                                      GET CURRENT DATE      @Y30LB25*/
         L     @15,@CV00768                                        0517
         LA    @01,@AL00517                                        0517
         BALR  @14,@15                                             0517
*               IF BCDCOPY=ON       /* CVR LOCATION?         @Y30LB25*/
*                 THEN              /* YES                   @Y30LB25*/
         L     @15,BCDVPTR                                         0518
         TM    BCDCOPY(@15),B'00010000'                            0518
         BNO   @RF00518                                            0518
*                 DO;               /*                       @Y30LB25*/
*                   COPYVPTR=BCDVPTR;/*                      @Y30LB25
*                                      ADDR CVR              @Y30LB25*/
         ST    @15,COPYVPTR                                        0520
*                   IF MCRTVEXT^=FIXZERO&MCRSPLOC=ON THEN          0521
         L     @14,MCRTVEXT(,MCRTPTR)                              0521
         LTR   @14,@14                                             0521
         BZ    @RF00521                                            0521
         L     @14,MCRTEPTR                                        0521
         TM    MCRSPLOC(@14),B'10000000'                           0521
         BNO   @RF00521                                            0521
*                     COPDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/
         MVC   COPDEST(30,@15),MCRLOC(@14)                         0522
*                   COPDTREM=EXPRDT;/*                       @Y30LB25
*                                      SET EJECT DATE        @Y30LB25*/
@RF00521 L     @01,COPYVPTR                                        0523
         MVC   COPDTREM(4,@01),EXPRDT                              0523
*                 END;              /*                       @Y30LB25*/
*               IF BCDBASE=ON       /* BVR LOCATION?         @Y30LB25*/
*                 THEN              /* YES                   @Y30LB25*/
@RF00518 L     @01,BCDVPTR                                         0525
         TM    BCDBASE(@01),B'00100000'                            0525
         BNO   @RF00525                                            0525
*                 DO;               /*                       @Y30LB25*/
*                   IF MCRTVEXT^=FIXZERO&MCRSPLOC=ON THEN          0527
         L     @15,MCRTVEXT(,MCRTPTR)                              0527
         LTR   @15,@15                                             0527
         BZ    @RF00527                                            0527
         L     @15,MCRTEPTR                                        0527
         TM    MCRSPLOC(@15),B'10000000'                           0527
         BNO   @RF00527                                            0527
*                     BASDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/
         L     @06,BASEVPTR                                        0528
         MVC   BASDEST(30,@06),MCRLOC(@15)                         0528
*                   BASDTREM=EXPRDT;/*                       @Y30LB25
*                                      SET EJECT DATE        @Y30LB25*/
@RF00527 L     @06,BASEVPTR                                        0529
         MVC   BASDTREM(4,@06),EXPRDT                              0529
*                 END;              /*                       @Y30LB25*/
*             END;                  /*                       @ZA13484*/
*                                                                  0531
@RF00525 DS    0H                                                  0532
*           /*********************************************************/
*           /*                                                       */
*           /* WRITE THE BVR OR CVR.                         @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0532
*           CALL WRITRECD;          /* WRITE BVR OR CVR      @Y30LB25*/
@RC00506 BAL   @14,WRITRECD                                        0532
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00012                                            0533
*         END;                      /*                       @Y30LB25*/
*                                                                  0534
*       /*************************************************************/
*       /*                                                           */
*       /* KEEP RECORD OPTION IS OFF.                        @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0535
*       ELSE                        /* KEEP RECORD           @Y30LB25
*                                      OPTION IS OFF         @Y30LB25*/
*         DO;                       /*                       @Y30LB25*/
*                                                                  0535
@RF00498 DS    0H                                                  0536
*           /*********************************************************/
*           /*                                                       */
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0536
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         CLC   REACODE(2),@CB00701                                 0536
         BNE   @RF00536                                            0536
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/
         L     @06,BCDVPTR                                         0537
         MVI   BCDLIB1(@06),X'FF'                                  0537
*           ELSE                    /*                       @Y30LB25*/
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/
         B     @RC00536                                            0538
@RF00536 DS    0H                                                  0539
*               BCDLIB1=FIX1F;      /*                       @Y30LB25
*                                      NULL LIBID1           @Y30LB25*/
         L     @06,BCDVPTR                                         0539
         MVI   BCDLIB1(@06),X'FF'                                  0539
*               BCDLIB2=FIX1F;      /*                       @Y30LB25
*                                      NULL LIBID2           @Y30LB25*/
         MVI   BCDLIB2(@06),X'FF'                                  0540
*             END;                  /*                       @Y30LB25*/
*                                                                  0541
*           /*********************************************************/
*           /*                                                       */
*           /* BOTH LIBID FIELDS NULL, THEN DELETE           @Y30LB25*/
*           /* THE RECORD. OTHERWISE, WRITE THE RECORD.      @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0542
*           IF BCDLIB1=FIX1F&BCDLIB2=FIX1F/*                 @Y30LB25
*                                      DELETE OR WRITE?      @Y30LB25*/
*             THEN                  /* DELETE                @Y30LB25*/
@RC00536 L     @06,BCDVPTR                                         0542
         CLI   BCDLIB1(@06),255                                    0542
         BNE   @RF00542                                            0542
         CLI   BCDLIB2(@06),255                                    0542
         BNE   @RF00542                                            0542
*             RPLVTYP=RPLVDEL;      /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         0543
         MVI   RPLVTYP(@06),X'05'                                  0543
*           ELSE                    /*                       @Y30LB25*/
*             RPLVTYP=RPLVPUT;      /* WRITE                 @Y30LB25*/
         B     @RC00542                                            0544
@RF00542 L     @06,RPLVPTR                                         0544
         MVI   RPLVTYP(@06),X'01'                                  0544
*           RESPECIFY               /*                       @Y30LB25*/
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/
@RC00542 DS    0H                                                  0546
*           RG1=RPLVPTR;            /* SET RPLVPTR           @Y30LB25*/
         L     RG1,RPLVPTR                                         0546
*           CALL ICBVIO00;          /* WRITE/DELETE BVR,     @Y30LB25
*                                      CVR, OR DVR           @Y30LB25*/
         L     @15,@CV00762                                        0547
         BALR  @14,@15                                             0547
*           RESPECIFY               /*                       @Y30LB25*/
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0549
         LH    @15,RPLVRETC(,@06)                                  0549
         N     @15,@CF01129                                        0549
         LTR   @15,@15                                             0549
         BNZ   @RT00549                                            0549
*             RETURN;               /*                       @Y30LB25*/
*                                                                  0550
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN IF BOTH LIBID FIELDS ARE NOT FF        @ZA17163*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0551
*           IF BCDLIB1^=FIX1F×BCDLIB2^=FIX1F/*               @ZA17163*/
*             THEN                  /* NO                    @ZA17163*/
         L     @15,BCDVPTR                                         0551
         CLI   BCDLIB1(@15),255                                    0551
         BNE   @RT00551                                            0551
         CLI   BCDLIB2(@15),255                                    0551
         BNE   @RT00551                                            0551
*             RETURN;               /*                       @ZA17163*/
*                                                                  0552
*           /*********************************************************/
*           /*                                                       */
*           /* DELETE THE CIR.                               @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0553
*           IVOLKY=BCDCSN1;         /* SET CIR KEY           @Y30LB25*/
         MVC   IVOLKY(12),BCDCSN1(@15)                             0553
*           RPLVKEY=ADDR(IKEY);     /* ADDR OF KEY           @Y30LB25*/
         LA    @15,IKEY                                            0554
         ST    @15,RPLVKEY(,@06)                                   0554
*           RPLVBUF=INDEXPTR;       /* BUF PTR               @Y30LB25*/
         L     @15,INDEXPTR                                        0555
         ST    @15,RPLVBUF(,@06)                                   0555
*           RPLVBLN=LENGTH(INDEXBUF);/*                      @Y30LB25
*                                      SET BUFFER LENGTH     @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF00339                             0556
*           CALL DELTRECD;          /* DELETE CIR            @Y30LB25*/
*                                                                  0557
         BAL   @14,DELTRECD                                        0557
*           /*********************************************************/
*           /*                                                       */
*           /* DISREGARD ANY ERROR AND CONTINUE              @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0558
*           RPLVRETC=RPLVRETC&&RPLVRETC;/*                   @Y30LB25*/
         L     @06,RPLVPTR                                         0558
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0558
*           RPLRCODE=RPLRCODE&&RPLRCODE;/*                   @Y30LB25*/
*                                                                  0559
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0559
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF OK TO DELETE OTHER                   @Y30LB25*/
*           /* CIR, BECAUSE ONLY ONE                         @Y30LB25*/
*           /* CARTRIDGE MAY HAVE BEEN                       @Y30LB25*/
*           /* EJECTED BY THE MSC.                           @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0560
*           IF BCDLIB2=FIX1F        /* 2ND CART EJECTED?     @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         0560
         CLI   BCDLIB2(@06),255                                    0560
         BNE   @RF00560                                            0560
*             DO;                   /*                       @Y30LB25*/
*               IVOLKY=BCDCSN2;     /* SET CIR KEY           @Y30LB25*/
         MVC   IVOLKY(12),BCDCSN2(@06)                             0562
*               CALL DELTRECD;      /* DELETE CIR            @Y30LB25*/
*                                                                  0563
         BAL   @14,DELTRECD                                        0563
*               /*****************************************************/
*               /*                                                   */
*               /* DISREGARD ANY ERROR AND CONTINUE          @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0564
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Y30LB25*/
         L     @06,RPLVPTR                                         0564
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0564
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0565
*             END;                  /*                       @Y30LB25*/
*                                                                  0566
*           /*********************************************************/
*           /*                                                       */
*           /* RETURN IF RECORD IS A DUPLICATE               @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0567
*           IF BCDDUP=ON            /*                       @ZA17163*/
*             THEN                  /*                       @Y30LB25*/
@RF00560 L     @06,BCDVPTR                                         0567
         TM    BCDDUP(@06),B'00000100'                             0567
         BO    @RT00567                                            0567
*             RETURN;               /*                       @Y30LB25*/
*                                                                  0568
*           /*********************************************************/
*           /*                                                       */
*           /* FOR A CVR, UPDATE ITS BVR.                    @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0569
*           IF BCDCOPY=ON           /* CVR?                  @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         TM    BCDCOPY(@06),B'00010000'                            0569
         BNO   @RF00569                                            0569
*             DO;                   /*                       @Y30LB25*/
*               ADDSUB=OFF;         /*                       @Y30LB25
*                                      DELETE CVR            @Y30LB25*/
         NI    ADDSUB,B'10111111'                                  0571
*               CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*   @Y30LB25
*                                      UPDT CVR'S BVR        @Y30LB25*/
         L     @15,@CV00769                                        0572
         LA    @01,@AL00572                                        0572
         BALR  @14,@15                                             0572
*             END;                  /*                       @Y30LB25*/
*           ELSE                    /* BVR                   @Y30LB25*/
*             DO;                   /*                       @Y30LB25*/
*                                                                  0574
         B     @RC00569                                            0574
@RF00569 DS    0H                                                  0575
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR GROUPED                         @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0575
*               IF BASGRPV=ON       /* GROUPED?              @Y30LB25*/
*                 THEN              /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0575
         TM    BASGRPV(@06),B'00100000'                            0575
         BNO   @RF00575                                            0575
*                 DO;               /*                       @Y30LB25*/
*                   CALL INACGVR;   /*                       @Y30LB25
*                                      DECREM # INAC VOLS    @Y30LB25*/
         BAL   @14,INACGVR                                         0577
*                   IF RPLVRETC^=FIXZERO/* ERROR?            @Y30LB25*/
*                     THEN          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0578
         LH    @06,RPLVRETC(,@06)                                  0578
         N     @06,@CF01129                                        0578
         LTR   @06,@06                                             0578
         BNZ   @RT00578                                            0578
*                     RETURN;       /*                       @Y30LB25*/
*                 END;              /*                       @Y30LB25*/
*                                                                  0580
*               /*****************************************************/
*               /*                                                   */
*               /* FOR A BVR, UPDATE ITS GVR OR NGVR.        @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0581
*               CALL PROCBVR;       /* PROCESS BVR           @Y30LB25*/
@RF00575 BAL   @14,PROCBVR                                         0581
*             END;                  /*                       @Y30LB25*/
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00012                                            0583
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   END PROMCRTE;                   /*                       @Y30LB25*/
         B     @EL00012                                            0586
*                                                                  0587
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - INACGVR                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* DECREMENTS THE COUNT OF INACTIVE VOLUMES IN THE       @Y30LB25*/
*   /* GROUP VOLUME RECORD.                                  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0587
*INACGVR:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
INACGVR  ST    @14,@SA00013                                        0587
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/
         L     @06,BASEVPTR                                        0588
         MVC   GROUPKY(8),BASGROUP(@06)                            0588
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,GKEY                                            0589
         L     @01,RPLVPTR                                         0589
         ST    @06,RPLVKEY(,@01)                                   0589
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/
         BAL   @14,READUPD1                                        0590
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0591
         LH    @15,RPLVRETC(,@06)                                  0591
         N     @15,@CF01129                                        0591
         LTR   @15,@15                                             0591
         BNZ   @RT00591                                            0591
*     RETURN;                       /*                       @Y30LB25*/
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              0593
*   GRONINAC=GRONINAC-FIXONE;       /* DECREM INAC VOLS      @Y30LB25*/
         L     @15,GROUPPTR                                        0594
         LH    @14,GRONINAC(,@15)                                  0594
         BCTR  @14,0                                               0594
         STH   @14,GRONINAC(,@15)                                  0594
*   RPLVBUF=ADDR(GROUPBUF);         /* BUFFER ADDR           @Y30LB25*/
         LA    @15,GROUPBUF                                        0595
         ST    @15,RPLVBUF(,@06)                                   0595
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        0596
*   RETURN;                         /*                       @Y30LB25*/
@EL00013 DS    0H                                                  0597
@EF00013 DS    0H                                                  0597
@ER00013 L     @14,@SA00013                                        0597
         BR    @14                                                 0597
*   END INACGVR;                    /*                       @Y30LB25*/
         B     @EL00013                                            0598
*                                                                  0599
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - DELTRECD                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - READ AND DELETE AN MSVC RECORD.            @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* KEY OF RECORD IN RPLVKEY                              @Y30LB25*/
*   /* ADDRESS OF RECORD BUFFER IN RPLVBUF                   @Y30LB25*/
*   /* LENGTH OF BUFFER IN RPLVBLN                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0599
*DELTRECD:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
DELTRECD ST    @14,@SA00014                                        0599
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         L     @06,RPLVPTR                                         0600
         MVI   RPLVTYP(@06),X'00'                                  0600
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@06),B'01111111'                            0601
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/
         OI    RPLVUPD(@06),B'00000010'                            0602
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         OI    RPLVDIR(@06),B'01000000'                            0603
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/
         LR    RG1,@06                                             0605
*   CALL ICBVIO00;                  /* READ MSVC RECORD      @Y30LB25*/
         L     @15,@CV00762                                        0606
         BALR  @14,@15                                             0606
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0607
         LH    @00,RPLVRETC(,@06)                                  0607
         N     @00,@CF01129                                        0607
         LTR   @00,@00                                             0607
         BNZ   @RT00607                                            0607
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/
         MVI   RPLVTYP(@06),X'05'                                  0609
*   CALL ICBVIO00;                  /* DELETE MSVC RECORD    @Y30LB25*/
         L     @15,@CV00762                                        0610
         BALR  @14,@15                                             0610
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00014 DS    0H                                                  0612
@EF00014 DS    0H                                                  0612
@ER00014 L     @14,@SA00014                                        0612
         BR    @14                                                 0612
*   END DELTRECD;                   /*                       @Y30LB25*/
         B     @EL00014                                            0613
*                                                                  0614
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCBVR                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - THE INPUT BVR HAS ALREADY BEEN DELETED.    @Y30LB25*/
*   /* IF THE BVR IS GROUPED, GET THE GVR, UPDATE IT, CHAIN  @Y30LB25*/
*   /* THE BVR OUT OF THE GVR, AND WRITE THE GVR.            @Y30LB25*/
*   /* IF THE BVR WAS GROUPED, ACTIVE AND GENERAL-USE        @Y30LB25*/
*   /* DELETE ITS GROUP VOLUME SERIAL NUMBER EXTENSION       @Y30LB25*/
*   /* SLOT. LOCATE A DVR FOR THE BVR, IF ANY, AND MAKE      @Y30LB25*/
*   /* IT THE BVR. IF NO DVR IS FOUND, THEN DELETE THE       @Y30LB25*/
*   /* BVR FROM THE NGVR CHAIN OF BVRS, IF THE BVR           @Y30LB25*/
*   /* IS NON-GROUPED.                                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*PROCBVR:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
PROCBVR  ST    @14,@SA00015                                        0614
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0615
         TM    BASGRPV(@06),B'00100000'                            0615
         BNO   @RF00615                                            0615
*     DO;                           /*                       @Y30LB25*/
*                                                                  0616
*       /*************************************************************/
*       /*                                                           */
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0617
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/
         MVC   GROUPKY(8),BASGROUP(@06)                            0617
*       RPLVKEY=ADDR(GKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,GKEY                                            0618
         L     @01,RPLVPTR                                         0618
         ST    @06,RPLVKEY(,@01)                                   0618
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/
         BAL   @14,READUPD1                                        0619
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/
*         THEN                      /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0620
         LH    @06,RPLVRETC(,@06)                                  0620
         N     @06,@CF01129                                        0620
         LTR   @06,@06                                             0620
         BNZ   @RT00620                                            0620
*         RETURN;                   /*                       @Y30LB25*/
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              0622
*       GRPFLG=ON;                  /* SET GROUP FLAG        @Y30LB25*/
         OI    GRPFLG,B'00010000'                                  0623
*       CALL VUCHO;                 /* CHAIN BVR OUT GVR     @Y30LB25*/
         BAL   @14,VUCHO                                           0624
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/
*         THEN                      /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0625
         LH    @15,RPLVRETC(,@06)                                  0625
         N     @15,@CF01129                                        0625
         LTR   @15,@15                                             0625
         BNZ   @RT00625                                            0625
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  0626
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH RPLV FOR WRITING THE GVR              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0627
*       GROUPKY=BASGROUP;           /* SET THE KEY           @Y30LB25*/
         L     @01,BASEVPTR                                        0627
         MVC   GROUPKY(8),BASGROUP(@01)                            0627
*       RPLVKEY=ADDR(GKEY);         /* PTR TO KEY            @Y30LB25*/
         LA    @15,GKEY                                            0628
         ST    @15,RPLVKEY(,@06)                                   0628
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/
         BAL   @14,READUPD1                                        0629
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/
*         THEN                      /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0630
         LH    @15,RPLVRETC(,@06)                                  0630
         N     @15,@CF01129                                        0630
         LTR   @15,@15                                             0630
         BNZ   @RT00630                                            0630
*         RETURN;                   /*                       @Y30LB25*/
*       RPLVBUF=ADDR(GROUPBUF);     /* PTR TO GVR            @Y30LB25*/
         LA    @15,GROUPBUF                                        0632
         ST    @15,RPLVBUF(,@06)                                   0632
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        0633
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/
*         THEN                      /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0634
         LH    @06,RPLVRETC(,@06)                                  0634
         N     @06,@CF01129                                        0634
         LTR   @06,@06                                             0634
         BNZ   @RT00634                                            0634
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  0635
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ACTIVE GENERAL-USE TO DELETE            @Y30LB25*/
*       /* ITS GVSNER SLOT.                                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0636
*       IF BASINAC=OFF&BASGENUS=ON  /* ACT & GEN-USE?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0636
         TM    BASGENUS(@06),B'00010000'                           0636
         BNO   @RF00636                                            0636
         TM    BASINAC(@06),B'00000100'                            0636
         BNZ   @RF00636                                            0636
*         DO;                       /*                       @Y30LB25*/
*           ADDSUBSL=OFF;           /* DELETE SLOT           @Y30LB25*/
         NI    ADDSUBSL,B'11111101'                                0638
*           EXPSLOT=OFF;            /* NO UPDT EXPIR DATE    @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 0639
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0640
*                                      DELETE GVSNER SLOT    @Y30LB25*/
         L     @15,@CV00767                                        0640
         LA    @01,@AL00640                                        0640
         BALR  @14,@15                                             0640
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0641
         LH    @06,RPLVRETC(,@06)                                  0641
         N     @06,@CF01129                                        0641
         LTR   @06,@06                                             0641
         BNZ   @RT00641                                            0641
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  0644
@RF00636 DS    0H                                                  0645
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A DUP VOLUME RECORD FOR THE DELETED         @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0645
*   DVOLKY=BASSERNO;                /* SET VOLID IN KEY      @Y30LB25*/
@RF00615 L     @06,BASEVPTR                                        0645
         MVC   DVOLKY(6),BASSERNO(@06)                             0645
*   DIDKY=FIXONE;                   /* SET KEY               @Y30LB25*/
         MVI   DIDKY,X'01'                                         0646
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/
         L     @06,RPLVPTR                                         0647
         LA    @15,DKEY                                            0647
         ST    @15,RPLVKEY(,@06)                                   0647
*   RPLVTYP=RPLVREAD;               /* READ OPTION ON        @Y30LB25*/
         MVI   RPLVTYP(@06),X'00'                                  0648
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         OI    RPLVDIR(@06),B'01000000'                            0650
         NI    RPLVLOC(@06),B'01111111'                            0650
*   RPLVUPD=ON;                     /* SET UPDATE            @Y30LB25*/
         OI    RPLVUPD(@06),B'00000010'                            0651
*   RPLVKGE=ON;                     /* READ KEY = OR >       @Y30LB25*/
         OI    RPLVKGE(@06),B'00000100'                            0652
*   RPLVBUF=DUPVPTR;                /* BUFFER PTR            @Y30LB25*/
         L     @15,DUPVPTR                                         0653
         ST    @15,RPLVBUF(,@06)                                   0653
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             0654
*   RESPECIFY                                                      0655
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@06                                             0656
*   CALL ICBVIO00;                  /* READ FOR DVR          @Y30LB25*/
         L     @15,@CV00762                                        0657
         BALR  @14,@15                                             0657
*   RESPECIFY                                                      0658
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/
         L     @06,RPLVPTR                                         0659
         NI    RPLVKGE(@06),B'11111011'                            0659
*   IF RPLRCODE=IOERROR             /* CHECK REASON CODE     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLC   RPLRCODE(2,@06),@CB00713                            0660
         BE    @RT00660                                            0660
*     RETURN;                       /*                       @Y30LB25*/
*   IF DKY^=DUPD×DVOLKY^=DUPSERNO   /* DVR FOUND?            @Y30LB25*/
*     THEN                          /* NO                    @Y30LB25*/
         L     @06,DUPVPTR                                         0662
         CLC   DKY(5),DUPD(@06)                                    0662
         BNE   @RT00662                                            0662
         CLC   DVOLKY(6),DUPSERNO(@06)                             0662
         BE    @RF00662                                            0662
@RT00662 DS    0H                                                  0663
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/
         L     @06,RPLVPTR                                         0664
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0664
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/
*                                                                  0665
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0665
*       /*************************************************************/
*       /*                                                           */
*       /* NO DVR WAS FOUND                                  #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0666
*       IF BASGRPV=OFF              /* BVR NOT GRPD?         @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0666
         TM    BASGRPV(@06),B'00100000'                            0666
         BNZ   @RF00666                                            0666
*         DO;                       /*                       @Y30LB25*/
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/
         NI    GRPFLG,B'11101111'                                  0668
*           CALL VUCHO;             /* CHAIN BVR OUT NGVR    @Y30LB25*/
         BAL   @14,VUCHO                                           0669
*         END;                      /*                       @Y30LB25*/
*       RETURN;                     /*                       @Y30LB25*/
@EL00015 DS    0H                                                  0671
@EF00015 DS    0H                                                  0671
@ER00015 L     @14,@SA00015                                        0671
         BR    @14                                                 0671
*     END;                          /*                       @Y30LB25*/
*                                                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /* DVR WAS FOUND                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*   ELSE                            /* DVR WAS FOUND         @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
@RF00662 DS    0H                                                  0674
*       IF BASGRPV=ON               /* BVR GROUPED?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0674
         TM    BASGRPV(@06),B'00100000'                            0674
         BNO   @RF00674                                            0674
*         DO;                       /*                       @Y30LB25*/
*                                                                  0675
*           /*********************************************************/
*           /*                                                       */
*           /* MAKE DVR INTO A BASE AND CHAIN INTO NGVR      @Y30LB25*/
*           /* ICBVUDBR RETURNS THE POINTER TO THE           @Y30LB25*/
*           /* BVR IT CREATED IN BASEVPTR                    @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0676
*           GRPDV=ON;               /* GROUPED FLAG ON       @Y30LB25*/
         OI    GRPDV,B'10000000'                                   0676
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0677
*                                                            @Y30LB25*/
*               FIXZERO,FIXZERO);   /*                       @Y30LB25
*                                      MAKE DVR A BVR        @Y30LB25*/
         L     @15,@CV00766                                        0677
         LA    @01,@AL00677                                        0677
         BALR  @14,@15                                             0677
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/
*             THEN                  /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0678
         LH    @06,RPLVRETC(,@06)                                  0678
         N     @06,@CF01129                                        0678
         LTR   @06,@06                                             0678
         BNZ   @RT00678                                            0678
*             RETURN;               /*                       @Y30LB25*/
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/
         NI    GRPFLG,B'11101111'                                  0680
*           CALL VUCHI;             /* CHAIN BVR IN NGVR     @Y30LB25*/
         BAL   @14,VUCHI                                           0681
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/
*             THEN                  /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0682
         LH    @06,RPLVRETC(,@06)                                  0682
         N     @06,@CF01129                                        0682
         LTR   @06,@06                                             0682
         BNZ   @RT00682                                            0682
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*       ELSE                        /* NOT GROUPED           @Y30LB25*/
*                                                                  0685
*         /***********************************************************/
*         /*                                                         */
*         /* MAKE THE DVR INTO A BVR                         @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0685
*         DO;                       /*                       @Y30LB25*/
         B     @RC00674                                            0685
@RF00674 DS    0H                                                  0686
*           GRPDV=OFF;              /* GROUPED FLAG OFF      @Y30LB25*/
         NI    GRPDV,B'01111111'                                   0686
*           IF BASFIRST=ON          /* 1ST BVR IN CHAIN?     @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0687
         TM    BASFIRST(@06),B'00010000'                           0687
         BNO   @RF00687                                            0687
*             FRSTDV=ON;            /* SET 1ST FLG ON        @Y30LB25*/
         OI    FRSTDV,B'01000000'                                  0688
*           IF BASLAST=ON           /* LAST BVR IN CHAIN?    @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
@RF00687 L     @06,BASEVPTR                                        0689
         TM    BASLAST(@06),B'00001000'                            0689
         BNO   @RF00689                                            0689
*             LASTDV=ON;            /* SET LAST FLG ON       @Y30LB25*/
         OI    LASTDV,B'00100000'                                  0690
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0691
*                                                            @Y30LB25*/
*               BASPREV,BASNEXTV);  /*                       @Y30LB25
*                                      MAKE DVR A BVR        @Y30LB25*/
@RF00689 MVC   @AL00001(16),@AL00691                               0691
         L     @06,BASEVPTR                                        0691
         LA    @15,BASPREV(,@06)                                   0691
         ST    @15,@AL00001+16                                     0691
         LA    @06,BASNEXTV(,@06)                                  0691
         ST    @06,@AL00001+20                                     0691
         L     @15,@CV00766                                        0691
         LA    @01,@AL00001                                        0691
         BALR  @14,@15                                             0691
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/
*             THEN                  /* ERROR                 @Y30LB25*/
         L     @06,RPLVPTR                                         0692
         LH    @06,RPLVRETC(,@06)                                  0692
         N     @06,@CF01129                                        0692
         LTR   @06,@06                                             0692
         BNZ   @RT00692                                            0692
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  0695
@RC00674 DS    0H                                                  0696
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE NEW BVR                                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0696
*   RPLVTYP=RPLVPUT;                /* WRITE BVR             @Y30LB25*/
         L     @06,RPLVPTR                                         0696
         MVI   RPLVTYP(@06),X'01'                                  0696
*   RPLVBUF=BASEVPTR;               /* PTR TO BVR            @Y30LB25*/
         L     @15,BASEVPTR                                        0697
         ST    @15,RPLVBUF(,@06)                                   0697
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/
         NI    RPLVUPD(@06),B'11111101'                            0698
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@06),B'01111111'                            0699
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUF LENGTH        @Y30LB25*/
         LA    @15,224                                             0700
         ST    @15,RPLVBLN(,@06)                                   0700
*   RPLVRLN=LENGTH(BASEBUF);        /* SET BVR LENGTH        @Y30LB25*/
         ST    @15,RPLVRLN(,@06)                                   0701
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        0702
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00015                                            0703
*   END PROCBVR;                    /*                       @Y30LB25*/
         B     @EL00015                                            0704
*                                                                  0705
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ACTVOL1                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS A VOLUME BEFORE THE CALL TO THE    @Y30LB25*/
*   /* MSC WHICH IS TO BECOME ACTIVE.                        @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0705
*ACTVOL1:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0705
ACTVOL1  ST    @14,@SA00016                                        0705
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE .MSVI.                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0706
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/
*                                                                  0706
         BAL   @14,RMSVIS                                          0706
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET TO THE BVR OR CVR KEY.            @ZDR2054*/
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/
*   /* IN THE CIR - NOT FOR UPDATE.                          @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0707
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0707
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECLC                                        0708
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0709
         LH    @15,RPLVRETC(,@06)                                  0709
         N     @15,@CF01129                                        0709
         LTR   @15,@15                                             0709
         BNZ   @RT00709                                            0709
*     RETURN;                       /*                       @Y30LB25*/
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25
*                                      GVR IS READ           @Y30LB25*/
         L     @06,RPLVBUF(,@06)                                   0711
         MVC   BASEBUF(224),BUFFER(@06)                            0711
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/
*                                                                  0712
         LA    @06,BASEBUF                                         0712
         ST    @06,BCDVPTR                                         0712
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0713
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/
         BAL   @14,EXPCK                                           0713
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0714
         LH    @15,RPLVRETC(,@06)                                  0714
         N     @15,@CF01129                                        0714
         LTR   @15,@15                                             0714
         BNZ   @RT00714                                            0714
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  0715
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A BVR                                       @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0716
*   IF BCDBASE=ON THEN              /* BVR?                  @ZDR2054*/
         L     @01,BCDVPTR                                         0716
         TM    BCDBASE(@01),B'00100000'                            0716
         BNO   @RF00716                                            0716
*     DO;                           /* YES                   @ZDR2054*/
*                                                                  0717
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ENTERED FROM THE CAS WHILE MSVC WAS DISABLED     */
*       /*                                                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0718
*       IF BASLIB1=FIX1F&BASLIB2=FIX1F/* ENTERED AT CAS?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @15,BASEVPTR                                        0718
         CLI   BASLIB1(@15),255                                    0718
         BNE   @RF00718                                            0718
         CLI   BASLIB2(@15),255                                    0718
         BNE   @RF00718                                            0718
*         DO;                       /* ERROR                 @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/
         MVC   RPLVRETC(2,@06),@CH00041                            0720
*           RPLRCODE=NULLIBID;      /* SET REASON CODE       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00735                            0721
*           RETURN;                 /*                       @Y30LB25*/
@EL00016 DS    0H                                                  0722
@EF00016 DS    0H                                                  0722
@ER00016 L     @14,@SA00016                                        0722
         BR    @14                                                 0722
*         END;                      /*                       @Y30LB25*/
*                                                                  0723
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR REASSIGNED                              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0724
*       IF BASREASS=ON              /* REASSIGNED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF00718 L     @06,BASEVPTR                                        0724
         TM    BASREASS(@06),B'00100000'                           0724
         BNO   @RF00724                                            0724
*         DO;                       /* ERROR                 @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0726
         MVC   RPLVRETC(2,@06),@CH00041                            0726
*           RPLRCODE=REASSIGN;      /* SET REASON CODE       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00737                            0727
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00016                                            0728
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @ZDR2054*/
*                                                                  0730
@RF00724 DS    0H                                                  0731
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR ACTIVATING A CVR, GET ITS BVR FOR CHECKING        @ZDR2054*/
*   /* THE ATTRIBUTES                                        @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0731
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/
@RF00716 L     @06,BCDVPTR                                         0731
         TM    BCDCOPY(@06),B'00010000'                            0731
         BNO   @RF00731                                            0731
*     DO;                           /* YES                   @ZDR2054*/
*       BVOLKY=BCDSERNO;            /* SERIAL NUMBER         @ZDR2054*/
         MVC   BVOLKY(6),BCDSERNO(@06)                             0733
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/
         LA    @06,BKEY                                            0734
         L     @01,RPLVPTR                                         0734
         ST    @06,RPLVKEY(,@01)                                   0734
*       CALL READLOC;               /* READ BVR              @ZDR2054*/
         BAL   @14,READLOC                                         0735
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/
         L     @06,RPLVPTR                                         0736
         LH    @15,RPLVRETC(,@06)                                  0736
         N     @15,@CF01129                                        0736
         LTR   @15,@15                                             0736
         BNZ   @RT00736                                            0736
*         RETURN;                   /*                       @ZDR2054*/
*       BASEVPTR=RPLVPTR;           /* SET BVR PTR           @ZDR2054*/
         ST    @06,BASEVPTR                                        0738
*     END;                          /*                       @ZDR2054*/
*                                                                  0739
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK ATTRIBUTES IF GENERAL-USE, GROUPED.             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0740
*   CALL CKATTRIB;                  /* CHECK ATTRIB'S        @Y30LB25*/
@RF00731 BAL   @14,CKATTRIB                                        0740
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00016                                            0741
*   END ACTVOL1;                    /*                       @Y30LB25*/
         B     @EL00016                                            0742
*                                                                  0743
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - EXPCK                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE IS USED BY DEFINEV FUNCTIONS,            @Y30LB25*/
*   /* BEFORE THE CALL TO THE MSC.                           @Y30LB25*/
*   /* IT READS THE GROUP VOLUME RECORD IF EITHER            @Y30LB25*/
*   /* TO OR FOR EXPIRATION DATES WERE SPECIFIED.            @Y30LB25*/
*   /* IF THERE IS NO RETENTION FOR THE GROUP                @Y30LB25*/
*   /* IT RETURNS WITH AN ERROR REASON CODE.                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0743
*EXPCK:                                                            0743
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0743
EXPCK    ST    @14,@SA00017                                        0743
*   /*****************************************************************/
*   /*                                                               */
*   /* BE SURE THAT 'TO' OR 'FOR' WERE SPECIFIED AND         @Y30LB25*/
*   /* THAT THERE IS A DEFINE EXTENSION.                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*   IF DEFVVEXT^=FIXZERO&(DEFPFOR=ON×DEFPTO=ON) THEN               0744
         L     @06,DEFVVEXT(,DEFVPTR)                              0744
         LTR   @06,@06                                             0744
         BZ    @RF00744                                            0744
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       0744
         BZ    @RF00744                                            0744
*     DO;                           /*                       @Y30LB25*/
*                                                                  0745
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF BASE RECORD IS GOING GROUPED OR IS         @Y30LB25*/
*       /* GROUPED GENERAL-USE OR STAYING                    @Y30LB25*/
*       /* GROUPED GENERAL-USE.                              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0746
*       IF((DEFPGRO=ON×BASGRPV=ON)&DEFGENUS=ON)×/*           @Y30LB25*/
*           (BASGENUS=ON&DEFNGRP=OFF&DEFRSTD=OFF)/*          @Y30LB25*/
*         THEN                                                     0746
*                                                                  0746
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0746
         BO    @GL00022                                            0746
         L     @06,BASEVPTR                                        0746
         TM    BASGRPV(@06),B'00100000'                            0746
         BNO   @GL00021                                            0746
@GL00022 TM    DEFGENUS(DEFVEPTR),B'10000000'                      0746
         BO    @RT00746                                            0746
@GL00021 L     @06,BASEVPTR                                        0746
         TM    BASGENUS(@06),B'00010000'                           0746
         BNO   @RF00746                                            0746
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0746
         BNZ   @RF00746                                            0746
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0746
         BNZ   @RF00746                                            0746
@RT00746 DS    0H                                                  0747
*         /***********************************************************/
*         /*                                                         */
*         /* GET GROUP NAME FROM CORRECT SOURCE              @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0747
*         DO;                       /*                       @Y30LB25*/
*           IF DEFPGRO=ON THEN      /* GROUP SPECIFIED ?     @Y30LB25*/
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0748
         BNO   @RF00748                                            0748
*             GROUPKY=DEFGROUP;     /* GROUP FROM REQ BLK    @Y30LB25*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0749
*           ELSE                    /*                       @Y30LB25*/
*             GROUPKY=BASGROUP;     /* GROUP FROM BASE REC   @Y30LB25*/
*                                                                  0750
         B     @RC00748                                            0750
@RF00748 L     @06,BASEVPTR                                        0750
         MVC   GROUPKY(8),BASGROUP(@06)                            0750
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP REMAINING PARAMETERS                   @Y30LB25*/
*           /* AND READ THE GROUP RECORD                     @Y30LB25*/
*           /* TO SEE IF IT HAS RETENTION                    @Y30LB25*/
*           /* SPECIFIED FOR THE GROUP.                      @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0751
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @Y30LB25*/
@RC00748 LA    @06,GKEY                                            0751
         L     @01,RPLVPTR                                         0751
         ST    @06,RPLVKEY(,@01)                                   0751
*           CALL READLOC;           /* READ GROUP RECORD     @Y30LB25*/
         BAL   @14,READLOC                                         0752
*           IF RPLVRETC^=FIXZERO THEN/* CHECK RETURN?        @Y30LB25*/
         L     @06,RPLVPTR                                         0753
         LH    @15,RPLVRETC(,@06)                                  0753
         N     @15,@CF01129                                        0753
         LTR   @15,@15                                             0753
         BNZ   @RT00753                                            0753
*             RETURN;               /*                       @Y30LB25*/
*                                                                  0754
*           /*********************************************************/
*           /*                                                       */
*           /* GET ADDRESS OF GROUP RECORD AND CHECK         @Y30LB25*/
*           /* IF RETENTION CHECKING IN EFFECT.              @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0755
*           GROUPPTR=RPLVBUF;       /* ADDRESSING TO BUFFER  @Y30LB25*/
         L     @15,RPLVBUF(,@06)                                   0755
         ST    @15,GROUPPTR                                        0755
*           IF GRORETN=OFF THEN     /* NO RET DATE?          @Y30LB25*/
*                                                                  0756
         TM    GRORETN(@15),B'00000100'                            0756
         BNZ   @RF00756                                            0756
*             /*******************************************************/
*             /*                                                     */
*             /* IF RETENTION CHECKING NOT IN                @Y30LB25*/
*             /* EFFECT, ERROR.                              @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0757
*             DO;                   /*                       @Y30LB25*/
*               RPLVRETC=FIXFOUR;   /* SET BAD RETURN        @Y30LB25*/
         MVC   RPLVRETC(2,@06),@CH00041                            0758
*               RPLRCODE=NOEXPICK;  /* NO GROUP EXPIRATION   @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00729                            0759
*               RETURN;             /*                       @Y30LB25*/
@EL00017 DS    0H                                                  0760
@EF00017 DS    0H                                                  0760
@ER00017 L     @14,@SA00017                                        0760
         BR    @14                                                 0760
*             END;                  /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  0762
*       /*************************************************************/
*       /*                                                           */
*       /* IF BASE VOLUME IS NOT BECOMMING A GROUPED GENERAL @Y30LB25*/
*       /* USE, OR NOT STAYING A GROUPED GENERAL USE, THEN   @Y30LB25*/
*       /* 'TO' OR 'FOR' SHOULD NOT HAVE BEEN SPECIFIED.     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*       ELSE                        /*                       @Y30LB25*/
*         DO;                       /*                       @Y30LB25*/
         B     @RC00746                                            0763
@RF00746 DS    0H                                                  0764
*           RPLVRETC=FIXFOUR;       /* SET BAD RET CODE      @Y30LB25*/
         L     @06,RPLVPTR                                         0764
         MVC   RPLVRETC(2,@06),@CH00041                            0764
*           RPLRCODE=NOEXPICK;      /* NO EXPIRATION CK      @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00729                            0765
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00017                                            0766
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00017                                            0769
*   END EXPCK;                      /*                       @Y30LB25*/
         B     @EL00017                                            0770
*                                                                  0771
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CKATTRIB                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CHECK THE ATTRIBUTES IF THE BVR INDICATES THE VOLUME  @Y30LB25*/
*   /* IS GROUPED GENERAL-USE OR THE DEFVE EXTENSION         @Y30LB25*/
*   /* INDICATES THAT THE VOLUME WILL BE GROUPED             @Y30LB25*/
*   /* GENERAL-USE.                                          @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0771
*CKATTRIB:                                                         0771
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0771
CKATTRIB ST    @14,@SA00018                                        0771
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A DEFVE AND IF THE BVR IS GOING TO BE       @Y30LB25*/
*   /* GROUPED, OR IS NOW GROUPED.                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0772
*   IF(DEFVVEXT^=FIXZERO&DEFPGRO=ON)×(DEFVVEXT=FIXZERO&BASGRPV=ON)×(
*       DEFVVEXT^=FIXZERO&BASGRPV=ON&DEFNGRP=OFF) THEN             0772
*                                                                  0772
         L     @06,DEFVVEXT(,DEFVPTR)                              0772
         LTR   @06,@06                                             0772
         BZ    @GL00027                                            0772
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0772
         BO    @RT00772                                            0772
@GL00027 L     @06,DEFVVEXT(,DEFVPTR)                              0772
         LTR   @06,@06                                             0772
         BNZ   @GL00026                                            0772
         L     @06,BASEVPTR                                        0772
         TM    BASGRPV(@06),B'00100000'                            0772
         BO    @RT00772                                            0772
@GL00026 L     @06,DEFVVEXT(,DEFVPTR)                              0772
         LTR   @06,@06                                             0772
         BZ    @RF00772                                            0772
         L     @06,BASEVPTR                                        0772
         TM    BASGRPV(@06),B'00100000'                            0772
         BNO   @RF00772                                            0772
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0772
         BNZ   @RF00772                                            0772
@RT00772 DS    0H                                                  0773
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK IF IT IS BECOMING OR NOW IS GENERAL-USE.      @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0773
*     IF(DEFVVEXT^=FIXZERO&DEFGENUS=ON)×(DEFVVEXT=FIXZERO&BASGENUS=ON)×
*         (DEFVVEXT^=FIXZERO&BASGENUS=ON&DEFRSTD=OFF) THEN/* @Y30LB25*/
         L     @06,DEFVVEXT(,DEFVPTR)                              0773
         LTR   @06,@06                                             0773
         BZ    @GL00033                                            0773
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      0773
         BO    @RT00773                                            0773
@GL00033 L     @06,DEFVVEXT(,DEFVPTR)                              0773
         LTR   @06,@06                                             0773
         BNZ   @GL00032                                            0773
         L     @06,BASEVPTR                                        0773
         TM    BASGENUS(@06),B'00010000'                           0773
         BO    @RT00773                                            0773
@GL00032 L     @06,DEFVVEXT(,DEFVPTR)                              0773
         LTR   @06,@06                                             0773
         BZ    @RF00773                                            0773
         L     @06,BASEVPTR                                        0773
         TM    BASGENUS(@06),B'00010000'                           0773
         BNO   @RF00773                                            0773
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0773
         BNZ   @RF00773                                            0773
@RT00773 DS    0H                                                  0774
*       DO;                         /*                       @Y30LB25*/
*                                                                  0774
*         /***********************************************************/
*         /*                                                         */
*         /* OBTAIN THE CORRECT GROUP NAME                   @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0775
*         IF DEFVVEXT^=FIXZERO&DEFPGRO=ON THEN/*             @Y30LB25*/
         L     @06,DEFVVEXT(,DEFVPTR)                              0775
         LTR   @06,@06                                             0775
         BZ    @RF00775                                            0775
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0775
         BNO   @RF00775                                            0775
*           GROUPKY=DEFGROUP;       /*                       @Y30LB25*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0776
*         ELSE                      /*                       @Y30LB25*/
*           GROUPKY=BASGROUP;       /*                       @Y30LB25*/
*                                                                  0777
         B     @RC00775                                            0777
@RF00775 L     @06,BASEVPTR                                        0777
         MVC   GROUPKY(8),BASGROUP(@06)                            0777
*         /***********************************************************/
*         /*                                                         */
*         /* READ GVR.                                       @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0778
*         RPLVKEY=ADDR(GKEY);       /* SET KEY ADDR          @Y30LB25*/
@RC00775 LA    @06,GKEY                                            0778
         L     @01,RPLVPTR                                         0778
         ST    @06,RPLVKEY(,@01)                                   0778
*         CALL READLOC;             /* READ GVR              @Y30LB25*/
         BAL   @14,READLOC                                         0779
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0780
         LH    @15,RPLVRETC(,@06)                                  0780
         N     @15,@CF01129                                        0780
         LTR   @15,@15                                             0780
         BNZ   @RT00780                                            0780
*           RETURN;                 /*                       @Y30LB25*/
*         GROUPPTR=RPLVBUF;         /* MAPPING ADDR          @Y30LB25*/
*                                                                  0782
         L     @06,RPLVBUF(,@06)                                   0782
         ST    @06,GROUPPTR                                        0782
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK ATTRIBUTES                                @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0783
*         IF DEFVACT=ON×(DEFVRNM=ON&DEFVVFLG=FIX1F) THEN           0783
*                                                                  0783
         TM    DEFVACT(DEFVPTR),B'00000010'                        0783
         BO    @RT00783                                            0783
         TM    DEFVRNM(DEFVPTR),B'00100000'                        0783
         BNO   @RF00783                                            0783
         CLI   DEFVVFLG(DEFVPTR),X'FF'                             0783
         BNE   @RF00783                                            0783
@RT00783 DS    0H                                                  0784
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK THE ATTRIBUTES BETWEEN THE BVR          @Y30LB25*/
*           /* AND THE GVR                                   @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0784
*           DO;                     /*                       @Y30LB25*/
*             IF(BASEXCL=OFF&GROEXCL=OFF)×(BASEXCL=ON&GROEXCL=ON)/*
*                                      EXCLUS MATCH?         @Y30LB25*/
*               THEN                /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0785
         TM    BASEXCL(@06),B'00000001'                            0785
         BNZ   @GL00041                                            0785
         L     @06,GROUPPTR                                        0785
         TM    GROEXCL(@06),B'01000000'                            0785
         BZ    @RT00785                                            0785
@GL00041 L     @06,BASEVPTR                                        0785
         TM    BASEXCL(@06),B'00000001'                            0785
         BNO   @RF00785                                            0785
         L     @06,GROUPPTR                                        0785
         TM    GROEXCL(@06),B'01000000'                            0785
         BNO   @RF00785                                            0785
@RT00785 DS    0H                                                  0786
*               DO;                 /*                       @Y30LB25*/
*                 IF(BASBIND=OFF&GROBIND=OFF)×(BASBIND=ON&GROBIND=ON)
*                                   /* BIND MATCH?           @Y30LB25*/
*                   THEN            /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0787
         TM    BASBIND(@06),B'00000010'                            0787
         BNZ   @GL00044                                            0787
         L     @06,GROUPPTR                                        0787
         TM    GROBIND(@06),B'10000000'                            0787
         BZ    @RT00787                                            0787
@GL00044 L     @06,BASEVPTR                                        0787
         TM    BASBIND(@06),B'00000010'                            0787
         BNO   @RF00787                                            0787
         L     @06,GROUPPTR                                        0787
         TM    GROBIND(@06),B'10000000'                            0787
         BNO   @RF00787                                            0787
@RT00787 DS    0H                                                  0788
*                   DO;             /*                       @Y30LB25*/
*                     IF(BASDAERA=OFF&GRODAERA=OFF)×(BASDAERA=ON&  0789
*                         GRODAERA=ON)/* DASD ERASE MATCH?   @Y30LB25*/
*                       THEN        /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        0789
         TM    BASDAERA(@06),B'10000000'                           0789
         BNZ   @GL00047                                            0789
         L     @06,GROUPPTR                                        0789
         TM    GRODAERA(@06),B'00100000'                           0789
         BZ    @RT00789                                            0789
@GL00047 L     @06,BASEVPTR                                        0789
         TM    BASDAERA(@06),B'10000000'                           0789
         BNO   @RF00789                                            0789
         L     @06,GROUPPTR                                        0789
         TM    GRODAERA(@06),B'00100000'                           0789
         BNO   @RF00789                                            0789
@RT00789 DS    0H                                                  0790
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/
         L     @06,A                                               0790
         ST    @06,A                                               0790
*                     ELSE          /* ERROR                 @Y30LB25*/
*                       DO;         /*                       @Y30LB25*/
         B     @RC00789                                            0791
@RF00789 DS    0H                                                  0792
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/
         L     @06,RPLVPTR                                         0792
         MVC   RPLVRETC(2,@06),@CH00041                            0792
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0793
*                         RETURN;   /*                       @Y30LB25*/
@EL00018 DS    0H                                                  0794
@EF00018 DS    0H                                                  0794
@ER00018 L     @14,@SA00018                                        0794
         BR    @14                                                 0794
*                       END;        /*                       @Y30LB25*/
*                   END;            /*                       @Y30LB25*/
*                 ELSE              /* ERROR                 @Y30LB25*/
*                   DO;             /*                       @Y30LB25*/
         B     @RC00787                                            0797
@RF00787 DS    0H                                                  0798
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/
         L     @06,RPLVPTR                                         0798
         MVC   RPLVRETC(2,@06),@CH00041                            0798
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0799
*                     RETURN;       /*                       @Y30LB25*/
         B     @EL00018                                            0800
*                   END;            /*                       @Y30LB25*/
*               END;                /*                       @Y30LB25*/
*             ELSE                  /* ERROR                 @Y30LB25*/
*               DO;                 /*                       @Y30LB25*/
         B     @RC00785                                            0803
@RF00785 DS    0H                                                  0804
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         0804
         MVC   RPLVRETC(2,@06),@CH00041                            0804
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0805
*                 RETURN;           /*                       @Y30LB25*/
         B     @EL00018                                            0806
*               END;                /*                       @Y30LB25*/
*           END;                    /*                       @Y30LB25*/
*                                                                  0808
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK ATTRIBUTES BETWEEN THE GVR AND            @Y30LB25*/
*         /* THE ICBDEFV REQUEST BLOCK                       @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0809
*         ELSE                                                     0809
*           DO;                     /*                       @Y30LB25*/
         B     @RC00783                                            0809
@RF00783 DS    0H                                                  0810
*             IF(DEFVEXCL=OFF&GROEXCL=OFF)×(DEFVEXCL=ON&GROEXCL=ON)/*
*                                      EXCLUS MATCH?         @Y30LB25*/
*               THEN                /* YES                   @Y30LB25*/
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810
         BNZ   @GL00050                                            0810
         L     @06,GROUPPTR                                        0810
         TM    GROEXCL(@06),B'01000000'                            0810
         BZ    @RT00810                                            0810
@GL00050 TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810
         BNO   @RF00810                                            0810
         L     @06,GROUPPTR                                        0810
         TM    GROEXCL(@06),B'01000000'                            0810
         BNO   @RF00810                                            0810
@RT00810 DS    0H                                                  0811
*               DO;                 /*                       @Y30LB25*/
*                 IF(DEFVBIND=OFF&GROBIND=OFF)×(DEFVBIND=ON&GROBIND=ON)
*                                   /* BIND MATCH?           @Y30LB25*/
*                   THEN            /* YES                   @Y30LB25*/
         TM    DEFVBIND(DEFVPTR),B'00000100'                       0812
         BNZ   @GL00053                                            0812
         L     @06,GROUPPTR                                        0812
         TM    GROBIND(@06),B'10000000'                            0812
         BZ    @RT00812                                            0812
@GL00053 TM    DEFVBIND(DEFVPTR),B'00000100'                       0812
         BNO   @RF00812                                            0812
         L     @06,GROUPPTR                                        0812
         TM    GROBIND(@06),B'10000000'                            0812
         BNO   @RF00812                                            0812
@RT00812 DS    0H                                                  0813
*                   DO;             /*                       @Y30LB25*/
*                     IF(DEFVSEC=OFF&GRODAERA=OFF)×(DEFVSEC=ON&GRODAERA
*                         =ON)      /* DASD ERASE MATCH?     @Y30LB25*/
*                       THEN        /* YES                   @Y30LB25*/
         TM    DEFVSEC(DEFVPTR),B'00100000'                        0814
         BNZ   @GL00056                                            0814
         L     @06,GROUPPTR                                        0814
         TM    GRODAERA(@06),B'00100000'                           0814
         BZ    @RT00814                                            0814
@GL00056 TM    DEFVSEC(DEFVPTR),B'00100000'                        0814
         BNO   @RF00814                                            0814
         L     @06,GROUPPTR                                        0814
         TM    GRODAERA(@06),B'00100000'                           0814
         BNO   @RF00814                                            0814
@RT00814 DS    0H                                                  0815
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/
         L     @06,A                                               0815
         ST    @06,A                                               0815
*                     ELSE          /* ERROR                 @Y30LB25*/
*                       DO;         /*                       @Y30LB25*/
         B     @RC00814                                            0816
@RF00814 DS    0H                                                  0817
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/
         L     @06,RPLVPTR                                         0817
         MVC   RPLVRETC(2,@06),@CH00041                            0817
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0818
*                         RETURN;   /*                       @Y30LB25*/
         B     @EL00018                                            0819
*                       END;        /*                       @Y30LB25*/
*                   END;            /*                       @Y30LB25*/
*                 ELSE              /* ERROR                 @Y30LB25*/
*                   DO;             /*                       @Y30LB25*/
         B     @RC00812                                            0822
@RF00812 DS    0H                                                  0823
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/
         L     @06,RPLVPTR                                         0823
         MVC   RPLVRETC(2,@06),@CH00041                            0823
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0824
*                     RETURN;       /*                       @Y30LB25*/
         B     @EL00018                                            0825
*                   END;            /*                       @Y30LB25*/
*               END;                /*                       @Y30LB25*/
*             ELSE                  /* ERROR                 @Y30LB25*/
*               DO;                 /*                       @Y30LB25*/
         B     @RC00810                                            0828
@RF00810 DS    0H                                                  0829
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         0829
         MVC   RPLVRETC(2,@06),@CH00041                            0829
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0830
*                 RETURN;           /*                       @Y30LB25*/
         B     @EL00018                                            0831
*               END;                /*                       @Y30LB25*/
*           END;                    /*                       @Y30LB25*/
*                                                                  0833
@RC00810 DS    0H                                                  0834
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK READ ONLY FOR - REPLACE VOLUME FLAGS.     @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0834
*         IF DEFVREP=ON             /* REPLACE VOL FLAGS     @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
@RC00783 TM    DEFVREP(DEFVPTR),B'00010000'                        0834
         BNO   @RF00834                                            0834
*           IF(DEFVWINH=OFF&GRORONLY=OFF)×(DEFVWINH=ON&GRORONLY=ON)/*
*                                      READ ONLY MATCH?      @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         TM    DEFVWINH(DEFVPTR),B'00000010'                       0835
         BNZ   @GL00059                                            0835
         L     @06,GROUPPTR                                        0835
         TM    GRORONLY(@06),B'00010000'                           0835
         BZ    @RT00835                                            0835
@GL00059 TM    DEFVWINH(DEFVPTR),B'00000010'                       0835
         BNO   @RF00835                                            0835
         L     @06,GROUPPTR                                        0835
         TM    GRORONLY(@06),B'00010000'                           0835
         BO    @RT00835                                            0835
*             RETURN;               /*                       @Y30LB25*/
*           ELSE                    /* NO                    @Y30LB25*/
*             DO;                   /*                       @Y30LB25*/
@RF00835 DS    0H                                                  0838
*               RPLVRETC=FIXFOUR;   /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         0838
         MVC   RPLVRETC(2,@06),@CH00041                            0838
*               RPLRCODE=MISATTB;   /*                       @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00731                            0839
*             END;                  /*                       @Y30LB25*/
*       END;                        /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00018                                            0842
*   END CKATTRIB;                   /*                       @Y30LB25*/
         B     @EL00018                                            0843
*                                                                  0844
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ACTVOL2                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS A VOLUME AFTER THE CALL TO THE     @Y30LB25*/
*   /* MSC WHICH HAS JUST MADE IT ACTIVE.                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* RESTRICTIONS - CAN NOT CHANGE THE VOLUME FROM         @Y30LB25*/
*   /* GENERAL TO RESTRICTED OR RESTRICTED TO GENERAL,       @Y30LB25*/
*   /* REMOVE OR ADD A VOLUME TO A GROUP, AND MOVE           @Y30LB25*/
*   /* A VOLUME FROM ONE GROUP TO ANOTHER GROUP.             @Y30LB25*/
*   /* THIS WILL RESULT IN MSVI PROBLEMS.                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*ACTVOL2:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
ACTVOL2  ST    @14,@SA00019                                        0844
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0845
         LH    @15,RPLRCODE(,@06)                                  0845
         N     @15,@CF01129                                        0845
         LTR   @15,@15                                             0845
         BZ    @RF00845                                            0845
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0847
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0848
*       RETURN;                     /*                       @Y30LB25*/
@EL00019 DS    0H                                                  0849
@EF00019 DS    0H                                                  0849
@ER00019 L     @14,@SA00019                                        0849
         BR    @14                                                 0849
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
*                                                                  0851
@RF00845 BAL   @14,HOUSKEEP                                        0851
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               @ZDR2054*/
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/
*   /* IN THE CIR - FOR UPDATE                               @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0852
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0852
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECUD                                        0853
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0854
         LH    @06,RPLVRETC(,@06)                                  0854
         N     @06,@CF01129                                        0854
         LTR   @06,@06                                             0854
         BNZ   @RT00854                                            0854
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  0855
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ACTIVATE OF A CVR                           @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0856
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/
         LA    @06,BASEBUF                                         0856
         ST    @06,BCDVPTR                                         0856
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/
         TM    BCDCOPY(@06),B'00010000'                            0857
         BNO   @RF00857                                            0857
*     DO;                           /* YES                   @ZDR2054*/
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @ZDR2054*/
*                                                                  0859
         MVC   COPYBUF(224),BASEBUF                                0859
*       /*************************************************************/
*       /*                                                           */
*       /* MAKE THE CVR INTO A BVR                           @ZDR2054*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0860
*       CALL CVRTOBVR;              /* CVR TO A BVR          @ZDR2054*/
         BAL   @14,CVRTOBVR                                        0860
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/
         L     @06,RPLVPTR                                         0861
         LH    @06,RPLVRETC(,@06)                                  0861
         N     @06,@CF01129                                        0861
         LTR   @06,@06                                             0861
         BNZ   @RT00861                                            0861
*         RETURN;                   /* YES                   @ZDR2054*/
*     END;                          /*                       @ZDR2054*/
*                                                                  0863
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE BVR                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0864
*   BASINAC=OFF;                    /* MAKE ACTIVE           @Y30LB25*/
@RF00857 L     @06,BASEVPTR                                        0864
         NI    BASINAC(@06),B'11111011'                            0864
*   BASHOLD=OFF;                    /* MAKE NOT A PHOLD      @ZA17163*/
         NI    BASHOLD(@06),B'01111111'                            0865
*   IF BASLIB1=FIX1F&BASLIB2^=FIX1F /* NULL LIBID 1?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLI   BASLIB1(@06),255                                    0866
         BNE   @RF00866                                            0866
         CLI   BASLIB2(@06),255                                    0866
         BE    @RF00866                                            0866
*     BASLIB1=BASLIB2;              /* SET LIBID 1           @Y30LB25*/
         IC    @15,BASLIB2(,@06)                                   0867
         STC   @15,BASLIB1(,@06)                                   0867
*   IF BASLIB2=FIX1F&BASLIB1^=FIX1F /* NULL LIBID 2?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00866 L     @06,BASEVPTR                                        0868
         CLI   BASLIB2(@06),255                                    0868
         BNE   @RF00868                                            0868
         CLI   BASLIB1(@06),255                                    0868
         BE    @RF00868                                            0868
*     BASLIB2=BASLIB1;              /* SET LIBID 2           @Y30LB25*/
*                                                                  0869
         IC    @15,BASLIB1(,@06)                                   0869
         STC   @15,BASLIB2(,@06)                                   0869
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0870
*   IF DEFVVEXT^=FIXZERO            /* A DEFVE?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00868 L     @06,DEFVVEXT(,DEFVPTR)                              0870
         LTR   @06,@06                                             0870
         BZ    @RF00870                                            0870
*     DO;                           /*                       @Y30LB25*/
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/
         L     @06,BASEVPTR                                        0872
         ST    @06,BCDVPTR                                         0872
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/
         BAL   @14,PRODEFVE                                        0873
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0874
         LH    @06,RPLVRETC(,@06)                                  0874
         N     @06,@CF01129                                        0874
         LTR   @06,@06                                             0874
         BNZ   @RT00874                                            0874
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  0876
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/
*   /* GROUP CHANGES WILL NOT OCCUR ON AN ACTIVE VOLUME.     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0877
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF00870 L     @06,BASEVPTR                                        0877
         TM    BASGRPV(@06),B'00100000'                            0877
         BNO   @RF00877                                            0877
*     DO;                           /*                       @Y30LB25*/
*                                                                  0878
*       /*************************************************************/
*       /*                                                           */
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0879
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/
         MVC   GROUPKY(8),BASGROUP(@06)                            0879
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/
         LA    @06,GKEY                                            0880
         L     @01,RPLVPTR                                         0880
         ST    @06,RPLVKEY(,@01)                                   0880
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/
         BAL   @14,READUPD1                                        0881
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0882
         LH    @06,RPLVRETC(,@06)                                  0882
         N     @06,@CF01129                                        0882
         LTR   @06,@06                                             0882
         BNZ   @RT00882                                            0882
*         RETURN;                   /*                       @Y30LB25*/
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              0884
*       GRONINAC=GRONINAC-FIXONE;   /* DECR # INACT VOLS     @Y30LB25*/
         L     @06,GROUPPTR                                        0885
         LH    @15,GRONINAC(,@06)                                  0885
         BCTR  @15,0                                               0885
         STH   @15,GRONINAC(,@06)                                  0885
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,BASEVPTR                                        0886
         TM    BASRSTD(@01),B'00001000'                            0886
         BNO   @RF00886                                            0886
*         GRONRSTD=GRONRSTD+FIXONE; /*                       @Y30LB25
*                                      INCR # RSTD VOLS      @Y30LB25*/
         LA    @15,1                                               0887
         AH    @15,GRONRSTD(,@06)                                  0887
         STH   @15,GRONRSTD(,@06)                                  0887
*       ELSE                        /* CK GEN-USE            @Y30LB25*/
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         B     @RC00886                                            0888
@RF00886 L     @06,BASEVPTR                                        0888
         TM    BASGENUS(@06),B'00010000'                           0888
         BNO   @RF00888                                            0888
*           DO;                     /*                       @Y30LB25*/
*             GRONGEN=GRONGEN+FIXONE;/*                      @Y30LB25
*                                      INCR # G-USE VOLS     @Y30LB25*/
*                                                                  0890
         L     @06,GROUPPTR                                        0890
         LA    @15,1                                               0890
         AH    @15,GRONGEN(,@06)                                   0890
         STH   @15,GRONGEN(,@06)                                   0890
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0891
*             ADDSUBGR=ON;          /* ADD                   @Y30LB25*/
         OI    ADDSUBGR,B'00001000'                                0891
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/
         BAL   @14,VUPGH                                           0892
*           END;                    /*                       @Y30LB25*/
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/
@RF00888 DS    0H                                                  0894
@RC00886 LA    @06,GROUPBUF                                        0894
         L     @01,RPLVPTR                                         0894
         ST    @06,RPLVBUF(,@01)                                   0894
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        0895
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0896
         LH    @06,RPLVRETC(,@06)                                  0896
         N     @06,@CF01129                                        0896
         LTR   @06,@06                                             0896
         BNZ   @RT00896                                            0896
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  0897
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0898
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
*                                                                  0898
         L     @06,BASEVPTR                                        0898
         TM    BASGENUS(@06),B'00010000'                           0898
         BNO   @RF00898                                            0898
*         /***********************************************************/
*         /*                                                         */
*         /* ADD A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0899
*         DO;                       /*                       @Y30LB25*/
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 0900
*           ADDSUBSL=ON;            /* ADD                   @Y30LB25*/
         OI    ADDSUBSL,B'00000010'                                0901
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0902
*                                                            @Y30LB25
*                                      CREATE A SLOT         @Y30LB25*/
         L     @15,@CV00767                                        0902
         LA    @01,@AL00902                                        0902
         BALR  @14,@15                                             0902
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0903
         LH    @06,RPLVRETC(,@06)                                  0903
         N     @06,@CF01129                                        0903
         LTR   @06,@06                                             0903
         BNZ   @RT00903                                            0903
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  0906
@RF00898 DS    0H                                                  0907
*   /*****************************************************************/
*   /*                                                               */
*   /* REESABLISH BVR RPL                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0907
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/
@RF00877 L     @06,BASEVPTR                                        0907
         MVC   BVOLKY(6),BASSERNO(@06)                             0907
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            0908
         L     @01,RPLVPTR                                         0908
         ST    @06,RPLVKEY(,@01)                                   0908
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        0909
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         0910
         LH    @15,RPLVRETC(,@06)                                  0910
         N     @15,@CF01129                                        0910
         LTR   @15,@15                                             0910
         BNZ   @RT00910                                            0910
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/
         LA    @15,BASEBUF                                         0912
         ST    @15,RPLVBUF(,@06)                                   0912
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        0913
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00019                                            0914
*   END ACTVOL2;                    /*                       @Y30LB25*/
         B     @EL00019                                            0915
*                                                                  0916
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CVRTOBVR                             @ZDR2054*/
*   /*                                                       @ZDR2054*/
*   /* FUNCTION - MAKE A COPY VOLUME WHOSE BASE VOLUME       @ZDR2054*/
*   /* HAS HAD ITS CARTRIDGES REASSIGNED OR EJECTED          @ZDR2054*/
*   /* INTO A BASE VOLUME WITH THE SAME VOLID. THE           @ZDR2054*/
*   /* CHECK FOR THE CARTRIDGES BEING REASSIGNED OR          @ZDR2054*/
*   /* EJECTED HAS BEEN MADE BY THE ADDV UTILITY.            @ZDR2054*/
*   /*                                                       @ZDR2054*/
*   /* INPUT -                                               @ZDR2054*/
*   /* MSVC REQUEST PARAMETER LIST                           @ZDR2054*/
*   /* BASE VOLUME RECORD                                    @ZDR2054*/
*   /* COPY VOLUME RECORD                                    @ZDR2054*/
*   /*                                                       @ZDR2054*/
*   /* OUTPUT -                                              @ZDR2054*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @ZDR2054*/
*   /* AN ERROR                                              @ZDR2054*/
*   /* BASE VOLUME RECORD                                    @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0916
*CVRTOBVR:                          /*                       @ZDR2054*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0916
CVRTOBVR ST    @14,@SA00020                                        0916
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THE CVR                                        @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0917
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUF ADDR          @ZDR2054*/
         L     @06,RPLVPTR                                         0917
         LA    @15,COPYBUF                                         0917
         ST    @15,RPLVBUF(,@06)                                   0917
*   RPLVTYP=RPLVDEL;                /* DELETE                @ZDR2054*/
         MVI   RPLVTYP(@06),X'05'                                  0918
*   RESPECIFY                                                      0919
*     RG1 RSTD;                     /* RESTRICT REG 1        @ZDR2054*/
*   RG1=RPLVPTR;                    /* PT TO RPLV            @ZDR2054*/
         LR    RG1,@06                                             0920
*   CALL ICBVIO00;                  /* DELET BVR PLC HOLD    @ZDR2054*/
         L     @15,@CV00762                                        0921
         BALR  @14,@15                                             0921
*   RESPECIFY                                                      0922
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @ZDR2054*/
*                                                                  0922
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE BVR FOR UPDATE                               @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0923
*   BVOLKY=COPSERNO;                /* SERIAL NUMBER         @ZDR2054*/
         L     @06,COPYVPTR                                        0923
         MVC   BVOLKY(6),COPSERNO(@06)                             0923
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @ZDR2054*/
         LA    @06,BKEY                                            0924
         L     @01,RPLVPTR                                         0924
         ST    @06,RPLVKEY(,@01)                                   0924
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/
         BAL   @14,READUPD1                                        0925
*   IF RPLVRETC^=FIXZERO THEN       /* ERROR?                @ZDR2054*/
         L     @06,RPLVPTR                                         0926
         LH    @15,RPLVRETC(,@06)                                  0926
         N     @15,@CF01129                                        0926
         LTR   @15,@15                                             0926
         BNZ   @RT00926                                            0926
*     RETURN;                       /* YES                   @ZDR2054*/
*   BASEBUF=BASEBUF1;               /* BVR TO BVR BUF        @ZDR2054*/
*                                                                  0928
         MVC   BASEBUF(224),BASEBUF1                               0928
*   /*****************************************************************/
*   /*                                                               */
*   /* GET AND DELETE THE BVR'S CIRS.                        @ZDR2054*/
*   /* DO NOT CHECK RETURN CODE FROM DELTRECD BECAUSE        @ZDR2054*/
*   /* MSVC WILL CLEAN UP CIR UPON CARTRIDGE ENTRY.          @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0929
*   IVOLKY=BASCSN1;                 /* CIR KEY FOR CSN1      @ZDR2054*/
         L     @01,BASEVPTR                                        0929
         MVC   IVOLKY(12),BASCSN1(@01)                             0929
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @ZDR2054*/
         LA    @15,IKEY                                            0930
         ST    @15,RPLVKEY(,@06)                                   0930
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF ADDR          @ZDR2054*/
         LA    @15,INDEXBUF                                        0931
         ST    @15,RPLVBUF(,@06)                                   0931
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @ZDR2054*/
         MVC   RPLVBLN(4,@06),@CF00339                             0932
*   CALL DELTRECD;                  /* DELT CIR FOR CSN1     @ZDR2054*/
         BAL   @14,DELTRECD                                        0933
*   IVOLKY=BASCSN2;                 /* CIR KEY FOR CSN2      @ZDR2054*/
         L     @06,BASEVPTR                                        0934
         MVC   IVOLKY(12),BASCSN2(@06)                             0934
*   CALL DELTRECD;                  /* DELT CIR FOR CSN2     @ZDR2054*/
*                                                                  0935
         BAL   @14,DELTRECD                                        0935
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AND RESET BVR FIELDS FROM THE CVR          @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0936
*   BASREASS=OFF;                   /* CART NOT REASSIGN     @ZDR2054*/
         L     @06,BASEVPTR                                        0936
         NI    BASREASS(@06),B'11011111'                           0936
*   BASCSN1=COPCSN1;                /* SET CSN 1             @ZDR2054*/
         L     @15,COPYVPTR                                        0937
         MVC   BASCSN1(12,@06),COPCSN1(@15)                        0937
*   BASLIB1=COPLIB1;                /* MSF 1                 @ZDR2054*/
         IC    @14,COPLIB1(,@15)                                   0938
         STC   @14,BASLIB1(,@06)                                   0938
*   BASCSN2=COPCSN2;                /* SET CSN 2             @ZDR2054*/
         MVC   BASCSN2(12,@06),COPCSN2(@15)                        0939
*   BASLIB2=COPLIB2;                /* MSF 2                 @ZDR2054*/
         IC    @14,COPLIB2(,@15)                                   0940
         STC   @14,BASLIB2(,@06)                                   0940
*   BASFRESP=COPFRESP;              /* # FREE CYLANDERS      @ZDR2054*/
         LH    @14,COPFRESP(,@15)                                  0941
         STH   @14,BASFRESP(,@06)                                  0941
*   BASLEXT=COPLEXT;                /* # CYL IN LARGEST      @ZDR2054
*                                      FREE EXTENT           @ZDR2054*/
         LH    @14,COPLEXT(,@15)                                   0942
         STH   @14,BASLEXT(,@06)                                   0942
*   BASFREXT=COPFREXT;              /* # FREE EXTENTS        @ZDR2054*/
         L     @14,COPFREXT(,@15)                                  0943
         ST    @14,BASFREXT(,@06)                                  0943
*   BASOWNER=COPOWNER;              /* OWNER                 @ZDR2054*/
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      0944
*   BASDESCR=COPDESCR;              /* DESCRIPTION           @ZDR2054*/
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      0945
*   IF COPDLSPF=ON THEN             /* DOWN LEVEL SPACE?     @ZDR2054*/
         TM    COPDLSPF(@15),B'01000000'                           0946
         BNO   @RF00946                                            0946
*     BASDLSF=ON;                   /* YES                   @ZDR2054*/
         OI    BASDLSF(@06),B'10000000'                            0947
*   ELSE                                                           0948
*     BASDLSF=OFF;                  /* NO                    @ZDR2054*/
         B     @RC00946                                            0948
@RF00946 L     @06,BASEVPTR                                        0948
         NI    BASDLSF(@06),B'01111111'                            0948
*   BASDLMTD=BLANK4;                /* DATE LAST MOUNT       @ZDR2054*/
@RC00946 L     @06,BASEVPTR                                        0949
         MVI   BASDLMTD+1(@06),C' '                                0949
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   0949
         MVI   BASDLMTD(@06),C' '                                  0949
*   BASDTREM=BLANK4;                /* EJECT DATE            @ZDR2054*/
         MVI   BASDTREM+1(@06),C' '                                0950
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   0950
         MVI   BASDTREM(@06),C' '                                  0950
*   BASDEST=BLANK30;                /* EJECT DESTINATION     @ZDR2054*/
         MVI   BASDEST+1(@06),C' '                                 0951
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    0951
         MVI   BASDEST(@06),C' '                                   0951
*   BASEXPDT=FIX4FS;                /* EXPIRATION DATE       @ZDR2054*/
         MVC   BASEXPDT(4,@06),@CB00677                            0952
*   BASRECOV=BLANK6;                /* RECOVERY VOLID        @ZDR2054*/
*                                                                  0953
         MVI   BASRECOV+1(@06),C' '                                0953
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   0953
         MVI   BASRECOV(@06),C' '                                  0953
*   /*****************************************************************/
*   /*                                                               */
*   /* REESTABLISH THE RPLV                                  @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   BVOLKY=BASSERNO;                /* RESET VOLID           @ZDR2054*/
         MVC   BVOLKY(6),BASSERNO(@06)                             0954
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @ZDR2054*/
         LA    @06,BKEY                                            0955
         L     @01,RPLVPTR                                         0955
         ST    @06,RPLVKEY(,@01)                                   0955
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/
         BAL   @14,READUPD1                                        0956
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/
*     THEN                          /* YES                   @ZDR2054*/
         L     @06,RPLVPTR                                         0957
         LH    @15,RPLVRETC(,@06)                                  0957
         N     @15,@CF01129                                        0957
         LTR   @15,@15                                             0957
         BNZ   @RT00957                                            0957
*     RETURN;                       /*                       @ZDR2054*/
*                                                                  0958
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE BVR                                         @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0959
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @ZDR2054*/
         LA    @15,BASEBUF                                         0959
         ST    @15,RPLVBUF(,@06)                                   0959
*   CALL WRITRECD;                  /* WRITE BVR             @ZDR2054*/
         BAL   @14,WRITRECD                                        0960
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/
*     THEN                          /* YES                   @ZDR2054*/
         L     @06,RPLVPTR                                         0961
         LH    @06,RPLVRETC(,@06)                                  0961
         N     @06,@CF01129                                        0961
         LTR   @06,@06                                             0961
         BNZ   @RT00961                                            0961
*     RETURN;                       /*                       @ZDR2054*/
*                                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE CIRS OF THE NEW BVR.                       @ZDR2054*/
*   /* BCDVPTR IS SET IN ACTVOL2.                            @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0963
*   CALL UPDCIR;                    /* SET NEW VOLID         @ZDR2054*/
         BAL   @14,UPDCIR                                          0963
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/
*     THEN                          /* YES                   @ZDR2054*/
         L     @06,RPLVPTR                                         0964
         LH    @06,RPLVRETC(,@06)                                  0964
         N     @06,@CF01129                                        0964
         LTR   @06,@06                                             0964
         BNZ   @RT00964                                            0964
*     RETURN;                       /*                       @ZDR2054*/
*                                                                  0965
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE NEW BVR TO REFLECT THE DELETION OF         @ZDR2054*/
*   /* THE CVR                                               @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0966
*   ADDSUB=OFF;                     /* CVR DELTED            @ZDR2054*/
         NI    ADDSUB,B'10111111'                                  0966
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @ZDR2054*/
         L     @15,@CV00769                                        0967
         LA    @01,@AL00967                                        0967
         BALR  @14,@15                                             0967
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/
*     THEN                          /* YES                   @ZDR2054*/
         L     @06,RPLVPTR                                         0968
         LH    @15,RPLVRETC(,@06)                                  0968
         N     @15,@CF01129                                        0968
         LTR   @15,@15                                             0968
         BNZ   @RT00968                                            0968
*     RETURN;                       /*                       @ZDR2054*/
*                                                                  0969
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE BVR FOR UPDATE SO PROCESSING CAN             @ZDR2054*/
*   /* CONTINUE IN ACTVOL2. BVOLKY IS STILL OK.              @ZDR2054*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0970
*   RPLVKEY=ADDR(BKEY);             /* BVR KEY ADDR          @ZDR2054*/
         LA    @15,BKEY                                            0970
         ST    @15,RPLVKEY(,@06)                                   0970
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/
         BAL   @14,READUPD1                                        0971
*   BASEBUF=BASEBUF1;               /* CORRECT BVR BUF       @ZDR2054*/
         MVC   BASEBUF(224),BASEBUF1                               0972
*   RETURN;                         /*                       @ZDR2054*/
@EL00020 DS    0H                                                  0973
@EF00020 DS    0H                                                  0973
@ER00020 L     @14,@SA00020                                        0973
         BR    @14                                                 0973
*   END CVRTOBVR;                   /*                       @ZDR2054*/
         B     @EL00020                                            0974
*                                                                  0975
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PRODEFVE                             #Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - PROCESS IEZDEFVE.                          @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/
*   /* POINTER TO COPY OR BASE VOLUME RECORD IN              @Y30LB25*/
*   /* BCDVPTR                                               @Y30LB25*/
*   /* POINTER TO BASE VOLUME RECORD IN BASEVPTR             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0975
*PRODEFVE:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  0975
PRODEFVE ST    @14,@SA00021                                        0975
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPY OR BASE VOLUME RECORD                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0976
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         0976
         TM    BCDCOPY(@06),B'00010000'                            0976
         BNO   @RF00976                                            0976
*     DO;                           /*                       @Y30LB25*/
*       COPYVPTR=BCDVPTR;           /* SET CVR PTR           @Y30LB25*/
         ST    @06,COPYVPTR                                        0978
*       CALL PCVRE;                 /* PROCESS DEFVE         @Y30LB25*/
         BAL   @14,PCVRE                                           0979
*       RETURN;                     /*                       @Y30LB25*/
@EL00021 DS    0H                                                  0980
@EF00021 DS    0H                                                  0980
@ER00021 L     @14,@SA00021                                        0980
         BR    @14                                                 0980
*     END;                          /*                       @Y30LB25*/
*                                                                  0981
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF GROUP WAS SPECIFIED                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0982
*   IF DEFPGRO=ON THEN              /* GOING GROUPED         @Y30LB25*/
@RF00976 TM    DEFPGRO(DEFVEPTR),B'00100000'                       0982
         BNO   @RF00982                                            0982
*     DO;                           /*                       @Y30LB25*/
*                                                                  0983
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF RECORD WAS IN GROUP BEFORE                 @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0984
*       IF BASGRPV=ON THEN          /* VOLUME GROUPED        @Y30LB25*/
*                                                                  0984
         L     @06,BASEVPTR                                        0984
         TM    BASGRPV(@06),B'00100000'                            0984
         BNO   @RF00984                                            0984
*         /***********************************************************/
*         /*                                                         */
*         /* GO REMOVE RECORD FROM GROUP CHAIN               @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0985
*         DO;                       /*                       @Y30LB25*/
*           CALL GROUPOUT;          /* GET REC OUT OF GROUP  @Y30LB25*/
         BAL   @14,GROUPOUT                                        0986
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         0987
         LH    @06,RPLVRETC(,@06)                                  0987
         N     @06,@CF01129                                        0987
         LTR   @06,@06                                             0987
         BNZ   @RT00987                                            0987
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*       ELSE                        /*                       @Y30LB25*/
*                                                                  0990
*         /***********************************************************/
*         /*                                                         */
*         /* GO TAKE RECORD OUT OF NON-GROUP                 @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0990
*         DO;                       /*                       @Y30LB25*/
         B     @RC00984                                            0990
@RF00984 DS    0H                                                  0991
*           GRPFLG=OFF;             /* NON-GRP               @Y30LB25*/
         NI    GRPFLG,B'11101111'                                  0991
*           CALL VUCHO;             /* GET REC OUT NON-GRP   @Y30LB25*/
         BAL   @14,VUCHO                                           0992
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN            @Y30LB25*/
         L     @06,RPLVPTR                                         0993
         LH    @06,RPLVRETC(,@06)                                  0993
         N     @06,@CF01129                                        0993
         LTR   @06,@06                                             0993
         BNZ   @RT00993                                            0993
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  0995
*       /*************************************************************/
*       /*                                                           */
*       /* GO PUT RECORD INTO GROUP                          @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0996
*       CALL GROUPIN;               /* PUT RECORD INTO GRP   @Y30LB25*/
@RC00984 BAL   @14,GROUPIN                                         0996
*       IF RPLVRETC^=FIXZERO THEN   /* WAS IT SUCCESSFUL     @Y30LB25*/
         L     @06,RPLVPTR                                         0997
         LH    @06,RPLVRETC(,@06)                                  0997
         N     @06,@CF01129                                        0997
         LTR   @06,@06                                             0997
         BNZ   @RT00997                                            0997
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  0998
*       /*************************************************************/
*       /*                                                           */
*       /* GO UPDATE THE COMMON FIELDS IN THE BASE REC       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0999
*       CALL COMMON;                /* UPD COM FIELD IN BASE @Y30LB25*/
         BAL   @14,COMMON                                          0999
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00021                                            1000
*     END;                          /*                       @Y30LB25*/
*                                                                  1001
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CHANGE TO NON-GROUPED                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1002
*   IF DEFNGRP=ON&BASGRPV=ON THEN   /* GOING NON-GRP?        @Y30LB25*/
@RF00982 TM    DEFNGRP(DEFVEPTR),B'10000000'                       1002
         BNO   @RF01002                                            1002
         L     @06,BASEVPTR                                        1002
         TM    BASGRPV(@06),B'00100000'                            1002
         BNO   @RF01002                                            1002
*     DO;                           /*                       @Y30LB25*/
*                                                                  1003
*       /*************************************************************/
*       /*                                                           */
*       /* GO TAKE RECORD OUT OF GROUP THAT IT IS NOW IN     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1004
*       CALL GROUPOUT;              /* GET IT OUT OF GRP     @Y30LB25*/
         BAL   @14,GROUPOUT                                        1004
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @Y30LB25*/
         L     @06,RPLVPTR                                         1005
         LH    @06,RPLVRETC(,@06)                                  1005
         N     @06,@CF01129                                        1005
         LTR   @06,@06                                             1005
         BNZ   @RT01005                                            1005
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1006
*       /*************************************************************/
*       /*                                                           */
*       /* GO PUT RECORD IN NON-GROUP CATAGORY               @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1007
*       CALL NGROUPIN;              /* PUT IN NON-GRPED      @Y30LB25*/
         BAL   @14,NGROUPIN                                        1007
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN CODE        @Y30LB25*/
         L     @06,RPLVPTR                                         1008
         LH    @06,RPLVRETC(,@06)                                  1008
         N     @06,@CF01129                                        1008
         LTR   @06,@06                                             1008
         BNZ   @RT01008                                            1008
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1009
*       /*************************************************************/
*       /*                                                           */
*       /* GO UPDATE COMMON FIELDS IN BASE REC               @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1010
*       CALL COMMON;                /* UPDATE COMMON FIELDS  @Y30LB25*/
         BAL   @14,COMMON                                          1010
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00021                                            1011
*     END;                          /*                       @Y30LB25*/
*                                                                  1012
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS A GROUPED VOLUME ?                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1013
*   IF BASGRPV=ON THEN              /* THIS A GRPED VOL?     @Y30LB25*/
@RF01002 L     @06,BASEVPTR                                        1013
         TM    BASGRPV(@06),B'00100000'                            1013
         BNO   @RF01013                                            1013
*     DO;                           /*                       @Y30LB25*/
*                                                                  1014
*       /*************************************************************/
*       /*                                                           */
*       /* WANT TO CHANGE TO GENERAL USE ?                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1015
*       IF DEFGENUS=ON THEN         /* WANT GENERAL USE?     @Y30LB25*/
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1015
         BNO   @RF01015                                            1015
*         DO;                       /*                       @Y30LB25*/
*                                                                  1016
*           /*********************************************************/
*           /*                                                       */
*           /* WAS IT RESTRICTED BEFORE ?                    @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1017
*           IF BASRSTD=ON THEN      /* WAS RESTRICTED?       @Y30LB25*/
*                                                                  1017
         TM    BASRSTD(@06),B'00001000'                            1017
         BNO   @RF01017                                            1017
*             /*******************************************************/
*             /*                                                     */
*             /* SINCE RESTRICTED BEFORE AND GOING GENERAL   @Y30LB25*/
*             /* GO MAKE INTO A GENERAL VOLUME IN THE        @Y30LB25*/
*             /* SAME GROUP                                  @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1018
*             DO;                   /*                       @Y30LB25*/
*               CALL GENERAL;       /* GO FROM RESTRCTED-GEN @Y30LB25*/
         BAL   @14,GENERAL                                         1019
*               IF RPLRCODE^=FIXZERO THEN/* RETURN CODE      @Y30LB25*/
         L     @06,RPLVPTR                                         1020
         LH    @06,RPLRCODE(,@06)                                  1020
         N     @06,@CF01129                                        1020
         LTR   @06,@06                                             1020
         BNZ   @RT01020                                            1020
*                 RETURN;           /*                       @Y30LB25*/
*                                                                  1021
*               /*****************************************************/
*               /*                                                   */
*               /* GO FILL IN ANY COMMON FIELDS IN BASE VOL  @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1022
*               CALL COMMON;        /* UPDATE COMMON FIELDS  @Y30LB25*/
         BAL   @14,COMMON                                          1022
*               RETURN;             /*                       @Y30LB25*/
         B     @EL00021                                            1023
*             END;                  /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  1025
@RF01017 DS    0H                                                  1026
*       /*************************************************************/
*       /*                                                           */
*       /* IS A CHANGE TO RESTRICTED USE BEING CALLED FOR ?  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1026
*       IF DEFRSTD=ON THEN          /* WANT RESTRICTED USE?  @Y30LB25*/
@RF01015 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1026
         BNO   @RF01026                                            1026
*         DO;                       /*                       @Y30LB25*/
*                                                                  1027
*           /*********************************************************/
*           /*                                                       */
*           /* WAS IT A GENERAL USE VOL BEFORE ?             @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1028
*           IF BASGENUS=ON THEN     /* WAS GENERAL BEFORE?   @Y30LB25*/
*                                                                  1028
         L     @06,BASEVPTR                                        1028
         TM    BASGENUS(@06),B'00010000'                           1028
         BNO   @RF01028                                            1028
*             /*******************************************************/
*             /*                                                     */
*             /* SINCE WAS GENERAL USE BEFORE AND IS GOING   @Y30LB25*/
*             /* RESTRICTED, GO MAKE RESTRICTED IN THE SAME  @Y30LB25*/
*             /* GROUP THAT IT WAS IN                        @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1029
*             DO;                   /*                       @Y30LB25*/
*               CALL RESTRICT;      /* PROCESS AS RESTRCTED  @Y30LB25*/
         BAL   @14,RESTRICT                                        1030
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN CODE   @Y30LB25*/
         L     @06,RPLVPTR                                         1031
         LH    @06,RPLVRETC(,@06)                                  1031
         N     @06,@CF01129                                        1031
         LTR   @06,@06                                             1031
         BNZ   @RT01031                                            1031
*                 RETURN;           /*                       @Y30LB25*/
*                                                                  1032
*               /*****************************************************/
*               /*                                                   */
*               /* FILL IN COMMON FIELDS IN BASE REC         @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1033
*               CALL COMMON;        /* FIELD IN COM FIELDS   @Y30LB25*/
         BAL   @14,COMMON                                          1033
*               RETURN;             /*                       @Y30LB25*/
         B     @EL00021                                            1034
*             END;                  /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
@RF01028 DS    0H                                                  1037
*     END;                          /*                       @Y30LB25*/
*                                                                  1037
@RF01026 DS    0H                                                  1038
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME DID NOT CHANGE GROUPS OR CLASIFICATION,     @Y30LB25*/
*   /* CALL COMMON TO CHANGE ANY OTHER FIELDS SPECIFIED      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1038
*   CALL COMMON;                    /* UPDATE REMAINING      @Y30LB25*/
@RF01013 BAL   @14,COMMON                                          1038
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00021                                            1039
*   END PRODEFVE;                   /*                       @Y30LB25*/
         B     @EL00021                                            1040
*                                                                  1041
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - GROUPOUT                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE TAKES A BASE VOLUME RECORD OUT OF        @Y30LB25*/
*   /* THE GROUP IT IS IN AND GETS IT READY TO GO            @Y30LB25*/
*   /* EITHER INTO ANOTHER GROUP OR BECOME NON-GROUPED.      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1041
*GROUPOUT:                                                         1041
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1041
GROUPOUT ST    @14,@SA00022                                        1041
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE OLD GROUP RECORD SO CAN GET VOL OUT OF IT    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1042
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/
         L     @06,BASEVPTR                                        1042
         MVC   GROUPKY(8),BASGROUP(@06)                            1042
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/
         LA    @06,GKEY                                            1043
         L     @01,RPLVPTR                                         1043
         ST    @06,RPLVKEY(,@01)                                   1043
*   CALL READUPD1;                  /* READ GROUP REC        @Y30LB25*/
*                                                                  1044
         BAL   @14,READUPD1                                        1044
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CODE FROM I/O PROCESSOR                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1045
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN             @Y30LB25*/
         L     @06,RPLVPTR                                         1045
         LH    @06,RPLVRETC(,@06)                                  1045
         N     @06,@CF01129                                        1045
         LTR   @06,@06                                             1045
         BNZ   @RT01045                                            1045
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ADDRESS OF RECORD JUST READ                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1047
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GRPBUF1(224),BASEBUF1                               1047
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO BUFFER  @Y30LB25*/
*                                                                  1048
         LA    @06,GRPBUF1                                         1048
         ST    @06,GROUPPTR                                        1048
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GENERAL USE BEFORE, DECREASE COUNT BY ONE          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1049
*   IF BASGENUS=ON&BASINAC=OFF      /* GEN USE & ACT?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,BASEVPTR                                        1049
         TM    BASGENUS(@01),B'00010000'                           1049
         BNO   @RF01049                                            1049
         TM    BASINAC(@01),B'00000100'                            1049
         BNZ   @RF01049                                            1049
*     GRONGEN=GRONGEN-FIXONE;       /* DECREASE COUNT        @Y30LB25*/
*                                                                  1050
         LH    @15,GRONGEN(,@06)                                   1050
         BCTR  @15,0                                               1050
         STH   @15,GRONGEN(,@06)                                   1050
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTRICTED, DECREASE RESTRICTED COUNT                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1051
*   IF BASRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01049 L     @06,BASEVPTR                                        1051
         TM    BASRSTD(@06),B'00001000'                            1051
         BNO   @RF01051                                            1051
         TM    BASINAC(@06),B'00000100'                            1051
         BNZ   @RF01051                                            1051
*     GRONRSTD=GRONRSTD-FIXONE;     /* DECR COUNT            @Y30LB25*/
*                                                                  1052
         L     @06,GROUPPTR                                        1052
         LH    @15,GRONRSTD(,@06)                                  1052
         BCTR  @15,0                                               1052
         STH   @15,GRONRSTD(,@06)                                  1052
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR INACTIVE                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1053
*   IF BASINAC=ON                   /* INACTIVE              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01051 L     @06,BASEVPTR                                        1053
         TM    BASINAC(@06),B'00000100'                            1053
         BNO   @RF01053                                            1053
*     GRONINAC=GRONINAC-FIXONE;     /* DECREM COUNT          @Y30LB25*/
*                                                                  1054
         L     @06,GROUPPTR                                        1054
         LH    @15,GRONINAC(,@06)                                  1054
         BCTR  @15,0                                               1054
         STH   @15,GRONINAC(,@06)                                  1054
*   /*****************************************************************/
*   /*                                                               */
*   /* IF BASE VOL IS A GENERAL USE TYPE, GO REMOVE ITS      @Y30LB25*/
*   /* SLOT IN THE EXTENSION RECORD                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1055
*   IF BASGENUS=ON&BASINAC=OFF THEN /* GEN USE & ACT?        @Y30LB25*/
@RF01053 L     @06,BASEVPTR                                        1055
         TM    BASGENUS(@06),B'00010000'                           1055
         BNO   @RF01055                                            1055
         TM    BASINAC(@06),B'00000100'                            1055
         BNZ   @RF01055                                            1055
*     DO;                           /*                       @Y30LB25*/
*                                                                  1056
*       /*************************************************************/
*       /*                                                           */
*       /* REMOVE THE SLOT                                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1057
*       ADDSUBSL=OFF;               /* DELETE SLOT           @Y30LB25*/
         NI    ADDSUBSL,B'11111101'                                1057
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 1058
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/
         L     @15,@CV00767                                        1059
         LA    @01,@AL01059                                        1059
         BALR  @14,@15                                             1059
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @Y30LB25*/
         L     @06,RPLVPTR                                         1060
         LH    @06,RPLVRETC(,@06)                                  1060
         N     @06,@CF01129                                        1060
         LTR   @06,@06                                             1060
         BNZ   @RT01060                                            1060
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1061
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE GVR                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1062
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/
         NI    ADDSUBGR,B'11110111'                                1062
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/
         BAL   @14,VUPGH                                           1063
*     END;                          /*                       @Y30LB25*/
*                                                                  1064
*   /*****************************************************************/
*   /*                                                               */
*   /* GO GET BASE RECORD OUT OF GROUP CHAIN                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/
@RF01055 OI    GRPFLG,B'00010000'                                  1065
*   CALL VUCHO;                     /*                       @Y30LB25*/
         BAL   @14,VUCHO                                           1066
*   IF RPLVRETC^=FIXZERO THEN       /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         1067
         LH    @06,RPLVRETC(,@06)                                  1067
         N     @06,@CF01129                                        1067
         LTR   @06,@06                                             1067
         BNZ   @RT01067                                            1067
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1068
*   /*****************************************************************/
*   /*                                                               */
*   /* SET REQUIRED DEFAULTS FOR GROUPIN                     @ZA00687*/
*   /* IF VOLUME IS NEITHER RESTRICTED OR GENERAL USE        @ZA00687*/
*   /* DEFAULT IS GENERAL USE                                @ZA00687*/
*   /* OTHERWISE SET REQUIRED DEFAULT TO VOLUME ATTRIBUTE    @ZA00687*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1069
*   IF DEFRSTD=OFF&DEFGENUS=OFF THEN                               1069
         TM    DEFRSTD(DEFVEPTR),B'11000000'                       1069
         BNZ   @RF01069                                            1069
*     DO;                           /*                       @ZA00687*/
*       IF BASRSTD=OFF&BASGENUS=OFF THEN                           1071
         L     @06,BASEVPTR                                        1071
         TM    BASRSTD(@06),B'00011000'                            1071
         BNZ   @RF01071                                            1071
*         DEFGENUS=ON;              /*                       @ZA00687*/
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1072
*       IF BASRSTD=OFF&BASGENUS=ON THEN                            1073
@RF01071 L     @06,BASEVPTR                                        1073
         TM    BASGENUS(@06),B'00010000'                           1073
         BNO   @RF01073                                            1073
         TM    BASRSTD(@06),B'00001000'                            1073
         BNZ   @RF01073                                            1073
*         DEFGENUS=ON;              /*                       @XA07821*/
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1074
*       IF BASRSTD=ON&BASGENUS=OFF THEN                            1075
@RF01073 L     @06,BASEVPTR                                        1075
         TM    BASRSTD(@06),B'00001000'                            1075
         BNO   @RF01075                                            1075
         TM    BASGENUS(@06),B'00010000'                           1075
         BNZ   @RF01075                                            1075
*         DEFRSTD=ON;               /*                       @ZA00687*/
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1076
*     END;                          /*                       @ZA00687*/
*                                                                  1077
@RF01075 DS    0H                                                  1078
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR OUT FIELDS IN THE BASE VOL RECORD THAT          #Y30LB25*/
*   /* HAVE BAD INFORMATION IN THEM FROM PREV GROUP          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1078
*   BASGROUP=BLANK8;                /* NULL GRP NAME         @Y30LB25*/
@RF01069 L     @06,BASEVPTR                                        1078
         MVI   BASGROUP+1(@06),C' '                                1078
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1078
         MVI   BASGROUP(@06),C' '                                  1078
*   BASGRPV=OFF;                    /* NON-GRPED             @Y30LB25*/
*   BASGENUS=OFF;                   /* NOT GENERAL           @Y30LB25*/
*   BASRSTD=OFF;                    /* NOT RESTRICTED        @Y30LB25*/
         NI    BASGRPV(@06),B'11000111'                            1081
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/
*                                                                  1082
         MVC   BASEXPDT(4,@06),@CB00677                            1082
*   /*****************************************************************/
*   /*                                                               */
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1083
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/
         LA    @06,GKEY                                            1083
         L     @01,RPLVPTR                                         1083
         ST    @06,RPLVKEY(,@01)                                   1083
*   CALL READUPD1;                  /* RD GRP REC FOR UPDATE @Y30LB25*/
         BAL   @14,READUPD1                                        1084
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN CODE     @Y30LB25*/
         L     @06,RPLVPTR                                         1085
         LH    @15,RPLVRETC(,@06)                                  1085
         N     @15,@CF01129                                        1085
         LTR   @15,@15                                             1085
         BNZ   @RT01085                                            1085
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1086
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE GROUP RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1087
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR RECORD TO PUT    @Y30LB25*/
         LA    @15,GRPBUF1                                         1087
         ST    @15,RPLVBUF(,@06)                                   1087
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1088
*   RETURN;                         /*                       @Y30LB25*/
@EL00022 DS    0H                                                  1089
@EF00022 DS    0H                                                  1089
@ER00022 L     @14,@SA00022                                        1089
         BR    @14                                                 1089
*   END GROUPOUT;                   /*                       @Y30LB25*/
         B     @EL00022                                            1090
*                                                                  1091
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - GROUPIN                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE PUTS A BASE VOL REC INTO A GROUP.        @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*GROUPIN:                                                          1091
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1091
GROUPIN  ST    @14,@SA00023                                        1091
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE NEW GROUP RECORD                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1092
*   GROUPKY=DEFGROUP;               /* GROUP NAME TO KEY     @Y30LB25*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1092
*   RPLVKEY=ADDR(GKEY);             /* ADDR IF KEY           @Y30LB25*/
         LA    @06,GKEY                                            1093
         L     @01,RPLVPTR                                         1093
         ST    @06,RPLVKEY(,@01)                                   1093
*   CALL READUPD1;                  /* FREE                  @Y30LB25*/
         BAL   @14,READUPD1                                        1094
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/
         L     @06,RPLVPTR                                         1095
         LH    @06,RPLVRETC(,@06)                                  1095
         N     @06,@CF01129                                        1095
         LTR   @06,@06                                             1095
         BNZ   @RT01095                                            1095
*     RETURN;                       /*                       @Y30LB25*/
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GRPBUF1(224),BASEBUF1                               1097
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO RECORD        @Y30LB25*/
*                                                                  1098
         LA    @06,GRPBUF1                                         1098
         ST    @06,GROUPPTR                                        1098
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GENERAL USE THEN ADD ONE TO GENERAL USE            @Y30LB25*/
*   /* IN GROUP RECORD AND INDICATE GENERAL IN               @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1099
*   IF DEFGENUS=ON&BASINAC=OFF      /* GEN-USE & ACT?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1099
         BNO   @RF01099                                            1099
         L     @15,BASEVPTR                                        1099
         TM    BASINAC(@15),B'00000100'                            1099
         BNZ   @RF01099                                            1099
*     DO;                           /*                       @Y30LB25*/
*       GRONGEN=GRONGEN+FIXONE;     /* ADD ON TO GENERAL     @Y30LB25*/
         LA    @14,1                                               1101
         AH    @14,GRONGEN(,@06)                                   1101
         STH   @14,GRONGEN(,@06)                                   1101
*       BASGENUS=ON;                /* INDICATE GENERAL      @Y30LB25*/
         OI    BASGENUS(@15),B'00010000'                           1102
*     END;                          /*                       @Y30LB25*/
*                                                                  1103
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RESTRICTED USE, ADD ONE TO COUNT IN GROUP          @Y30LB25*/
*   /* RECORD AND INDICATE RESTRICTED IN BASE RECORD         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1104
*   IF DEFRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01099 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1104
         BNO   @RF01104                                            1104
         L     @06,BASEVPTR                                        1104
         TM    BASINAC(@06),B'00000100'                            1104
         BNZ   @RF01104                                            1104
*     DO;                           /*                       @Y30LB25*/
*       GRONRSTD=GRONRSTD+FIXONE;   /* ADD ONE RESTRICTED    @Y30LB25*/
         L     @15,GROUPPTR                                        1106
         LA    @14,1                                               1106
         AH    @14,GRONRSTD(,@15)                                  1106
         STH   @14,GRONRSTD(,@15)                                  1106
*       BASRSTD=ON;                 /* INDICATE RESTRICTED   @Y30LB25*/
         OI    BASRSTD(@06),B'00001000'                            1107
*     END;                          /*                       @Y30LB25*/
*                                                                  1108
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR INACTIVE VOLUME AND SET VOLUME TYPE         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1109
*   IF BASINAC=ON                   /* INACTIVE?             @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01104 L     @06,BASEVPTR                                        1109
         TM    BASINAC(@06),B'00000100'                            1109
         BNO   @RF01109                                            1109
*     DO;                           /*                       @Y30LB25*/
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/
*                                                                  1111
         L     @15,GROUPPTR                                        1111
         LA    @14,1                                               1111
         AH    @14,GRONINAC(,@15)                                  1111
         STH   @14,GRONINAC(,@15)                                  1111
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1112
*       IF DEFGENUS=ON              /* GENERAL-USE?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1112
         BNO   @RF01112                                            1112
*         DO;                       /*                       @Y30LB25*/
*           BASGENUS=ON;            /* SET GEN-USE ON        @Y30LB25*/
*           BASRSTD=OFF;            /* SET RESTRICT OFF      @Y30LB25*/
         OI    BASGENUS(@06),B'00010000'                           1115
         NI    BASRSTD(@06),B'11110111'                            1115
*         END;                      /*                       @Y30LB25*/
*                                                                  1116
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1117
*       IF DEFRSTD=ON               /* RESTRICTED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01112 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1117
         BNO   @RF01117                                            1117
*         DO;                       /*                       @Y30LB25*/
*           BASGENUS=OFF;           /* SET GEN-USE OFF       @Y30LB25*/
*           BASRSTD=ON;             /* SET RESTRICT ON       @Y30LB25*/
         L     @06,BASEVPTR                                        1120
         OI    BASRSTD(@06),B'00001000'                            1120
         NI    BASGENUS(@06),B'11101111'                           1120
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1122
@RF01117 DS    0H                                                  1123
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF VOLUME IS GOING TO BE GENERAL USE            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1123
*   IF DEFGENUS=ON&BASINAC=OFF THEN /* GEN-USE & ACT?        @Y30LB25*/
@RF01109 TM    DEFGENUS(DEFVEPTR),B'10000000'                      1123
         BNO   @RF01123                                            1123
         L     @06,BASEVPTR                                        1123
         TM    BASINAC(@06),B'00000100'                            1123
         BNZ   @RF01123                                            1123
*     DO;                           /*                       @Y30LB25*/
*                                                                  1124
*       /*************************************************************/
*       /*                                                           */
*       /* SET FLAG INDICATING ADDING TO GROUP AND GO        @ZM31004*/
*       /* PUT NEW SPACE VALUES IN GROUP RECORD              @ZM31004*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1125
*       ADDSUBGR=ON;                /* INDIC ADDING TO GRP   @ZM31004*/
         OI    ADDSUBGR,B'00001000'                                1125
*       CALL VUPGH;                 /*                       @ZM31004*/
*                                                                  1126
         BAL   @14,VUPGH                                           1126
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK RETURN FROM PROCESS GROUP HEADER            @ZM31004*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1127
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @ZM31004*/
         L     @06,RPLVPTR                                         1127
         LH    @06,RPLVRETC(,@06)                                  1127
         N     @06,@CF01129                                        1127
         LTR   @06,@06                                             1127
         BNZ   @RT01127                                            1127
*         RETURN;                   /*                       @ZM31004*/
*                                                                  1128
*       /*************************************************************/
*       /*                                                           */
*       /* GO PUT A SLOT IN EXTENSION RECORD FOR THIS        @Y30LB25*/
*       /* GROUPED GENERAL USE BASE VOLUME                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1129
*       ADDSUBSL=ON;                /* INDICATE ADDING SLOT  @Y30LB25*/
         OI    ADDSUBSL,B'00000010'                                1129
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 1130
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @ZM31004
*                                      ADD SLOT              @ZM31004*/
         L     @15,@CV00767                                        1131
         LA    @01,@AL01131                                        1131
         BALR  @14,@15                                             1131
*       IF RPLVRETC^=FIXZERO THEN   /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         1132
         LH    @06,RPLVRETC(,@06)                                  1132
         N     @06,@CF01129                                        1132
         LTR   @06,@06                                             1132
         BNZ   @RT01132                                            1132
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE GROUPED AND PUT GROUP NAME IN VOLUME         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*   BASGRPV=ON;                     /* INDICATE GROUPED      @Y30LB25*/
@RF01123 L     @06,BASEVPTR                                        1135
         OI    BASGRPV(@06),B'00100000'                            1135
*   BASGROUP=DEFGROUP;              /* GROUP NAME IN BASE    @Y30LB25*/
*                                                                  1136
         MVC   BASGROUP(8,@06),DEFGROUP(DEFVEPTR)                  1136
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL CHAIN IN ROUTINE TO CHAIN BASE RECORD INTO GROUP @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1137
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/
         OI    GRPFLG,B'00010000'                                  1137
*   CALL VUCHI;                     /*                       @Y30LB25*/
         BAL   @14,VUCHI                                           1138
*   IF RPLVRETC^=FIXZERO THEN       /* ERROR?                @Y30LB25*/
         L     @06,RPLVPTR                                         1139
         LH    @15,RPLVRETC(,@06)                                  1139
         N     @15,@CF01129                                        1139
         LTR   @15,@15                                             1139
         BNZ   @RT01139                                            1139
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1140
*   /*****************************************************************/
*   /*                                                               */
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/
         LA    @15,GKEY                                            1141
         ST    @15,RPLVKEY(,@06)                                   1141
*   CALL READUPD1;                  /* READ GROUP UPDATE     @Y30LB25*/
*                                                                  1142
         BAL   @14,READUPD1                                        1142
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK RETURN FROM DUMMY READ                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1143
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/
         L     @06,RPLVPTR                                         1143
         LH    @15,RPLVRETC(,@06)                                  1143
         N     @15,@CF01129                                        1143
         LTR   @15,@15                                             1143
         BNZ   @RT01143                                            1143
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1144
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE GROUP RECORD THAT IS ALL FIXED UP NOW           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1145
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR READ GROUP REC   @Y30LB25*/
         LA    @15,GRPBUF1                                         1145
         ST    @15,RPLVBUF(,@06)                                   1145
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1146
*   RETURN;                         /*                       @Y30LB25*/
@EL00023 DS    0H                                                  1147
@EF00023 DS    0H                                                  1147
@ER00023 L     @14,@SA00023                                        1147
         BR    @14                                                 1147
*   END GROUPIN;                    /*                       @Y30LB25*/
         B     @EL00023                                            1148
*                                                                  1149
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - NGROUPIN                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE PUTS A BASE VOLUME RECORD INTO           @Y30LB25*/
*   /* THE NON-GROUPED CHAIN.                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1149
*NGROUPIN:                                                         1149
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
NGROUPIN ST    @14,@SA00024                                        1149
*   GRPFLG=OFF;                     /* INDICATE NON-GRPED    @Y30LB25*/
*                                                                  1150
         NI    GRPFLG,B'11101111'                                  1150
*   /*****************************************************************/
*   /*                                                               */
*   /* GO CHAIN VOLUME INTO NON-GROUPED                      @Y30LB25*/
*   /* AND CHECK RETURN CODE                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1151
*   CALL VUCHI;                     /*                       @Y30LB25*/
         BAL   @14,VUCHI                                           1151
*   IF RPLVRETC^=FIXZERO THEN       /*                       @Y30LB25*/
         L     @06,RPLVPTR                                         1152
         LH    @06,RPLVRETC(,@06)                                  1152
         N     @06,@CF01129                                        1152
         LTR   @06,@06                                             1152
         BNZ   @RT01152                                            1152
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/
*   /* NEED TO BE UPDATED WHEN GOING NON-GROUPED CATAGORY    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1154
*   BASGRPV=OFF;                    /* CLEAR GROUP FLAG      @Y30LB25*/
*   BASGENUS=OFF;                   /* CLEAR GENERAL USED    @Y30LB25*/
*   BASRSTD=OFF;                    /* CLEAR RESTRICTED      @Y30LB25*/
         L     @06,BASEVPTR                                        1156
         NI    BASGRPV(@06),B'11000111'                            1156
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/
         MVC   BASEXPDT(4,@06),@CB00677                            1157
*   BASGROUP=BLANK8;                /* BLANK GROUP NAME      @Y30LB25*/
         MVI   BASGROUP+1(@06),C' '                                1158
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1158
         MVI   BASGROUP(@06),C' '                                  1158
*   RETURN;                         /*                       @Y30LB25*/
@EL00024 DS    0H                                                  1159
@EF00024 DS    0H                                                  1159
@ER00024 L     @14,@SA00024                                        1159
         BR    @14                                                 1159
*   END NGROUPIN;                   /*                       @Y30LB25*/
         B     @EL00024                                            1160
*                                                                  1161
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RESTRICT                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE IS CALLED WHEN A GROUPED VOLUME IS       @Y30LB25*/
*   /* CURRENTLY GENERAL USE, BUT IS GOING RESTRICTED        @Y30LB25*/
*   /* IN THE SAME GROUP.                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1161
*RESTRICT:                                                         1161
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1161
RESTRICT ST    @14,@SA00025                                        1161
*   /*****************************************************************/
*   /*                                                               */
*   /* GET GROUP NAME AND SET UP TO READ GROUP RECORD        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1162
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/
         L     @06,BASEVPTR                                        1162
         MVC   GROUPKY(8),BASGROUP(@06)                            1162
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/
         LA    @06,GKEY                                            1163
         L     @01,RPLVPTR                                         1163
         ST    @06,RPLVKEY(,@01)                                   1163
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/
         BAL   @14,READUPD1                                        1164
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/
         L     @06,RPLVPTR                                         1165
         LH    @06,RPLVRETC(,@06)                                  1165
         N     @06,@CF01129                                        1165
         LTR   @06,@06                                             1165
         BNZ   @RT01165                                            1165
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1166
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE FIELDS IN THE GROUP RECORD THAT CHANGE         @Y30LB25*/
*   /* WHEN ONE OF ITS VOLUMES GOES FROM GENERAL TO          @Y30LB25*/
*   /* RESTRICTED                                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1167
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GRPBUF1(224),BASEBUF1                               1167
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO GROUP REC     @Y30LB25*/
*                                                                  1168
         LA    @06,GRPBUF1                                         1168
         ST    @06,GROUPPTR                                        1168
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1169
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,BASEVPTR                                        1169
         TM    BASINAC(@01),B'00000100'                            1169
         BNZ   @RF01169                                            1169
*     DO;                           /*                       @Y30LB25*/
*       GRONGEN=GRONGEN-FIXONE;     /* 1 LESS GENERAL USE    @Y30LB25*/
         LH    @15,GRONGEN(,@06)                                   1171
         BCTR  @15,0                                               1171
         STH   @15,GRONGEN(,@06)                                   1171
*       GRONRSTD=GRONRSTD+FIXONE;   /* ONE MORE RESTRICTED   @Y30LB25*/
         LA    @15,1                                               1172
         AH    @15,GRONRSTD(,@06)                                  1172
         STH   @15,GRONRSTD(,@06)                                  1172
*       ADDSUBGR=OFF;               /* INDICATE TAKING OUT   @Y30LB25*/
*                                                                  1173
         NI    ADDSUBGR,B'11110111'                                1173
*       /*************************************************************/
*       /*                                                           */
*       /* GO TAKE SOME SPACE OUT OF GROUPS GENERAL VOLUME   @Y30LB25*/
*       /* TOTALS SINCE IT IS GOING RESTRICTED               @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1174
*       CALL VUPGH;                 /*                       @Y30LB25*/
         BAL   @14,VUPGH                                           1174
*       IF RPLVRETC^=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/
         L     @06,RPLVPTR                                         1175
         LH    @06,RPLVRETC(,@06)                                  1175
         N     @06,@CF01129                                        1175
         LTR   @06,@06                                             1175
         BNZ   @RT01175                                            1175
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1177
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/
*   /* CHANGE WHEN GOING FRON GENERAL TO RESTRICTED          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1178
*   BASGENUS=OFF;                   /* NOT GENERAL USE       @Y30LB25*/
@RF01169 DS    0H                                                  1179
*   BASRSTD=ON;                     /* RESTRICTED USE        @Y30LB25*/
         L     @06,BASEVPTR                                        1179
         OI    BASRSTD(@06),B'00001000'                            1179
         NI    BASGENUS(@06),B'11101111'                           1179
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/
*                                                                  1180
         MVC   BASEXPDT(4,@06),@CB00677                            1180
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE GROUP RECORD JUST PREVIOUSLY READ           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1181
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/
         LA    @06,GRPBUF1                                         1181
         L     @01,RPLVPTR                                         1181
         ST    @06,RPLVBUF(,@01)                                   1181
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1182
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1183
         LH    @06,RPLVRETC(,@06)                                  1183
         N     @06,@CF01129                                        1183
         LTR   @06,@06                                             1183
         BNZ   @RT01183                                            1183
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1184
*   /*****************************************************************/
*   /*                                                               */
*   /* REMOVE THE SLOT, IF ACTIVE VOLUME                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1185
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        1185
         TM    BASINAC(@06),B'00000100'                            1185
         BNZ   @RF01185                                            1185
*     DO;                           /*                       @Y30LB25*/
*       ADDSUBSL=OFF;               /* DELETE                @Y30LB25*/
         NI    ADDSUBSL,B'11111101'                                1187
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 1188
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/
         L     @15,@CV00767                                        1189
         LA    @01,@AL01189                                        1189
         BALR  @14,@15                                             1189
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00025 DS    0H                                                  1191
@EF00025 DS    0H                                                  1191
@ER00025 L     @14,@SA00025                                        1191
         BR    @14                                                 1191
*   END RESTRICT;                   /*                       @Y30LB25*/
         B     @EL00025                                            1192
*                                                                  1193
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - GENERAL                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS ROUTINE IS CALLED WHEN A BASE VOLUME RECORD      @Y30LB25*/
*   /* IS GOING FROM RESTRICTED TO GENERAL USE IN THE        @Y30LB25*/
*   /* SAME GROUP.                                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*GENERAL:                                                          1193
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1193
GENERAL  ST    @14,@SA00026                                        1193
*   /*****************************************************************/
*   /*                                                               */
*   /* GET GROUP NAME FROM BASE RECORD AND SET UP TO         @Y30LB25*/
*   /* READ THE GROUP RECORD                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*   GROUPKY=BASGROUP;               /* GET NEW GROUP NAME    @Y30LB25*/
         L     @06,BASEVPTR                                        1194
         MVC   GROUPKY(8),BASGROUP(@06)                            1194
*   RPLVKEY=ADDR(GKEY);             /* ADDR GROUP KEY        @Y30LB25*/
         LA    @06,GKEY                                            1195
         L     @01,RPLVPTR                                         1195
         ST    @06,RPLVKEY(,@01)                                   1195
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/
         BAL   @14,READUPD1                                        1196
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/
         L     @06,RPLVPTR                                         1197
         LH    @06,RPLVRETC(,@06)                                  1197
         N     @06,@CF01129                                        1197
         LTR   @06,@06                                             1197
         BNZ   @RT01197                                            1197
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1198
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ADDRESS OF GROUP RECORD, UPDATE REQUIRED FIELDS   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1199
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GRPBUF1(224),BASEBUF1                               1199
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO GRP REC @Y30LB25*/
*                                                                  1200
         LA    @06,GRPBUF1                                         1200
         ST    @06,GROUPPTR                                        1200
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1201
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,BASEVPTR                                        1201
         TM    BASINAC(@01),B'00000100'                            1201
         BNZ   @RF01201                                            1201
*     DO;                           /*                       @Y30LB25*/
*       GRONGEN=GRONGEN+FIXONE;     /* ONE MORE GENERAL USE  @Y30LB25*/
         LA    @15,1                                               1203
         AH    @15,GRONGEN(,@06)                                   1203
         STH   @15,GRONGEN(,@06)                                   1203
*       GRONRSTD=GRONRSTD-FIXONE;   /* ONE LESS RESTRICTED   @Y30LB25*/
*                                                                  1204
         LH    @15,GRONRSTD(,@06)                                  1204
         BCTR  @15,0                                               1204
         STH   @15,GRONRSTD(,@06)                                  1204
*       /*************************************************************/
*       /*                                                           */
*       /* GO ADD SOME SPACE TO THE GROUP FIELDS SINCE IT IS @Y30LB25*/
*       /* GETTING A GENERAL TYPE VOLUME                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1205
*       ADDSUBGR=ON;                /* INDICATE ADDING GEN   @Y30LB25*/
         OI    ADDSUBGR,B'00001000'                                1205
*       CALL VUPGH;                 /*                       @Y30LB25*/
         BAL   @14,VUPGH                                           1206
*       IF RPLVRETC^=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/
         L     @06,RPLVPTR                                         1207
         LH    @06,RPLVRETC(,@06)                                  1207
         N     @06,@CF01129                                        1207
         LTR   @06,@06                                             1207
         BNZ   @RT01207                                            1207
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1209
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE INDICATORS IN BASE VOLUME TO GENERAL-USE       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1210
*   BASGENUS=ON;                    /* GENERAL USE           @Y30LB25*/
@RF01201 DS    0H                                                  1211
*   BASRSTD=OFF;                    /* NOT RESTRICTED USE    @Y30LB25*/
*                                                                  1211
         L     @06,BASEVPTR                                        1211
         OI    BASGENUS(@06),B'00010000'                           1211
         NI    BASRSTD(@06),B'11110111'                            1211
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE GROUP RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1212
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/
         LA    @06,GRPBUF1                                         1212
         L     @01,RPLVPTR                                         1212
         ST    @06,RPLVBUF(,@01)                                   1212
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1213
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1214
         LH    @06,RPLVRETC(,@06)                                  1214
         N     @06,@CF01129                                        1214
         LTR   @06,@06                                             1214
         BNZ   @RT01214                                            1214
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1215
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD A SLOT, IF VOLUME IS ACTIVE                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1216
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        1216
         TM    BASINAC(@06),B'00000100'                            1216
         BNZ   @RF01216                                            1216
*     DO;                           /*                       @Y30LB25*/
*       ADDSUBSL=ON;                /* ADD                   @Y30LB25*/
         OI    ADDSUBSL,B'00000010'                                1218
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 1219
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/
         L     @15,@CV00767                                        1220
         LA    @01,@AL01220                                        1220
         BALR  @14,@15                                             1220
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00026 DS    0H                                                  1222
@EF00026 DS    0H                                                  1222
@ER00026 L     @14,@SA00026                                        1222
         BR    @14                                                 1222
*   END GENERAL;                    /*                       @Y30LB25*/
         B     @EL00026                                            1223
*                                                                  1224
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - COMMON                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* ROUTINE UPDATES THE REMAINING FIELDS IN THE BASE      @Y30LB25*/
*   /* VOLUME RECORD THAT HAVE NOTHING TO DO WITH THE GROUP. @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1224
*COMMON:                                                           1224
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1224
COMMON   ST    @14,@SA00027                                        1224
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GENERAL USE VOLUME THEN HANDLE EXPIRATION          @Y30LB25*/
*   /* CHANGES IF CALLED FOR                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1225
*   IF BASGRPV=ON&BASGENUS=ON&      /* GENERAL USE VOL?      @Y30LB25*/
*       (DEFNEXPD=ON×DEFPFOR=ON×DEFPTO=ON) THEN/* CHNGN EXP  @Y30LB25*/
         L     @06,BASEVPTR                                        1225
         TM    BASGRPV(@06),B'00110000'                            1225
         BNO   @RF01225                                            1225
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1225
         BO    @RT01225                                            1225
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       1225
         BZ    @RF01225                                            1225
@RT01225 DS    0H                                                  1226
*     DO;                           /*                       @Y30LB25*/
*       GROUPKY=BASGROUP;           /* GET GROUP NAME        @Y30LB25*/
         L     @06,BASEVPTR                                        1227
         MVC   GROUPKY(8),BASGROUP(@06)                            1227
*       RPLVKEY=ADDR(GKEY);         /* ADDR GROUP KEY        @Y30LB25*/
         LA    @06,GKEY                                            1228
         L     @01,RPLVPTR                                         1228
         ST    @06,RPLVKEY(,@01)                                   1228
*       CALL READUPD1;              /* READ GROUP RECORD     @ZA13484*/
         BAL   @14,READUPD1                                        1229
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @Y30LB25*/
         L     @06,RPLVPTR                                         1230
         LH    @06,RPLVRETC(,@06)                                  1230
         N     @06,@CF01129                                        1230
         LTR   @06,@06                                             1230
         BNZ   @RT01230                                            1230
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1231
*       /*************************************************************/
*       /*                                                           */
*       /* SET ADDR TO GROUP RECORD JUST READ                @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1232
*       GRPBUF1=BASEBUF1;           /* USE CORRECT BUFF      @ZA13484*/
         MVC   GRPBUF1(224),BASEBUF1                               1232
*       GROUPPTR=ADDR(GRPBUF1);     /* ADDRESSING TO GRP REC @ZA13484*/
*                                                                  1233
         LA    @06,GRPBUF1                                         1233
         ST    @06,GROUPPTR                                        1233
*       /*************************************************************/
*       /*                                                           */
*       /* NULLIFY EXPIRATION DATE BASE RECORD               @Y30LB25*/
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @ZA00687*/
*       /* TO MATCH RETENTION DATE IN BASE VOLUME RECORD     @ZA00687*/
*       /* FOR RETENTION DATE. REMOVE FROM CURRENT SLOT AND  @ZA00687*/
*       /* ADD IN LAST EXTENSION SLOT                        @ZA00687*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1234
*       IF DEFNEXPD=ON THEN         /* NULL EXPIRATION DATE? @ZA00687*/
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1234
         BNO   @RF01234                                            1234
*         DO;                       /*                       @ZA00687*/
*           BASEXPDT=FIX4FS;        /* NULLIFY EXPIRATION    @ZA00687*/
         L     @06,BASEVPTR                                        1236
         MVC   BASEXPDT(4,@06),@CB00677                            1236
*           IF BASINAC=OFF THEN     /* IS VOL INACTIVE       @ZA17177*/
         TM    BASINAC(@06),B'00000100'                            1237
         BNZ   @RF01237                                            1237
*             DO;                   /*                       @ZA17177*/
*               EXPSLOT=OFF;        /* INDICATE DELETE       @ZA00687*/
         NI    EXPSLOT,B'01111111'                                 1239
*               ADDSUBSL=OFF;       /* INDICATE DELETE       @ZA00687*/
         NI    ADDSUBSL,B'11111101'                                1240
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1241
         L     @15,@CV00767                                        1241
         LA    @01,@AL01241                                        1241
         BALR  @14,@15                                             1241
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN        @ZA00687*/
         L     @06,RPLVPTR                                         1242
         LH    @06,RPLVRETC(,@06)                                  1242
         N     @06,@CF01129                                        1242
         LTR   @06,@06                                             1242
         BNZ   @RT01242                                            1242
*                 RETURN;           /*                       @ZA00687*/
*               ADDSUBSL=ON;        /* INDICATE ADD          @ZA00687*/
         OI    ADDSUBSL,B'00000010'                                1244
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1245
         L     @15,@CV00767                                        1245
         LA    @01,@AL01245                                        1245
         BALR  @14,@15                                             1245
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN        @ZA00687*/
         L     @06,RPLVPTR                                         1246
         LH    @06,RPLVRETC(,@06)                                  1246
         N     @06,@CF01129                                        1246
         LTR   @06,@06                                             1246
         BNZ   @RT01246                                            1246
*                 RETURN;           /*                       @ZA00687*/
*             END;                  /*                       @ZA17177*/
*         END;                      /*                       @ZA00687*/
*       ELSE                        /*                       #Y30LB25*/
*                                                                  1250
*         /***********************************************************/
*         /*                                                         */
*         /* OTHERWISE CHECK IF TO OR FOR SPECIFIED          #Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1250
*         DO;                       /*                       @Y30LB25*/
*                                                                  1250
         B     @RC01234                                            1250
@RF01234 DS    0H                                                  1251
*           /*********************************************************/
*           /*                                                       */
*           /* IF FOR SPECIFIED, GO CALCULATE EXPIRATION     @Y30LB25*/
*           /* DATE AND PUT IT IN BASE RECORD                @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1251
*           IF DEFPFOR=ON THEN      /* FOR SPECIFIED?        @Y30LB25*/
         TM    DEFPFOR(DEFVEPTR),B'10000000'                       1251
         BNO   @RF01251                                            1251
*             DO;                   /*                       @Y30LB25*/
*               CALL ICBVUEXP(DEFFOR,EXPRDT);/*              @Y30LB25*/
         LA    @06,DEFFOR(,DEFVEPTR)                               1253
         ST    @06,@AL00001                                        1253
         LA    @06,EXPRDT                                          1253
         ST    @06,@AL00001+4                                      1253
         L     @15,@CV00768                                        1253
         LA    @01,@AL00001                                        1253
         BALR  @14,@15                                             1253
*               BASEXPDT=EXPRDT;    /* RET IN BASE REC       @Y30LB25*/
         L     @06,BASEVPTR                                        1254
         MVC   BASEXPDT(4,@06),EXPRDT                              1254
*             END;                  /*                       @Y30LB25*/
*                                                                  1255
*           /*********************************************************/
*           /*                                                       */
*           /* IF TO WAS SPECIFIED, IF IT EXCEEDS MAXIMUM,   @Y30LB25*/
*           /* PUT IN MAXIMUM DATE, OTHERWISE PUT IN TO DATE @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1256
*           IF DEFPTO=ON THEN       /* TO SPECIFIED?         @Y30LB25*/
@RF01251 TM    DEFPTO(DEFVEPTR),B'00001000'                        1256
         BNO   @RF01256                                            1256
*             DO;                   /*                       @Y30LB25*/
*               IF DEFTO>MAXDATE THEN/* CHECK DATE?          @Y30LB25*/
         CLC   DEFTO(4,DEFVEPTR),MAXDATE                           1258
         BNH   @RF01258                                            1258
*                 BASEXPDT=MAXDATE; /* SET TO MAX DATE       @Y30LB25*/
         L     @06,BASEVPTR                                        1259
         MVC   BASEXPDT(4,@06),MAXDATE                             1259
*               ELSE                /*                       @Y30LB25*/
*                 BASEXPDT=DEFTO;   /* SET TO GIVEN DATE     @Y30LB25*/
         B     @RC01258                                            1260
@RF01258 L     @06,BASEVPTR                                        1260
         MVC   BASEXPDT(4,@06),DEFTO(DEFVEPTR)                     1260
*             END;                  /*                       @Y30LB25*/
@RC01258 DS    0H                                                  1262
*         END;                      /*                       @Y30LB25*/
*                                                                  1262
@RF01256 DS    0H                                                  1263
*       /*************************************************************/
*       /*                                                           */
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @Y30LB25*/
*       /* TO MATCH EXPIRATION DATE IN BASE VOLUME RECORD    @Y30LB25*/
*       /* IF THE VOLUME IS ACTIVE.                          @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1263
*       IF BASINAC=OFF              /* ACTIVE?               @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01234 L     @06,BASEVPTR                                        1263
         TM    BASINAC(@06),B'00000100'                            1263
         BNZ   @RF01263                                            1263
*         DO;                       /*                       @Y30LB25*/
*           EXPSLOT=ON;             /* ADD EXPIR DATE        @Y30LB25*/
         OI    EXPSLOT,B'10000000'                                 1265
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   1266
*                                                            @Y30LB25*/
         L     @15,@CV00767                                        1266
         LA    @01,@AL01266                                        1266
         BALR  @14,@15                                             1266
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN            @Y30LB25*/
         L     @06,RPLVPTR                                         1267
         LH    @06,RPLVRETC(,@06)                                  1267
         N     @06,@CF01129                                        1267
         LTR   @06,@06                                             1267
         BNZ   @RT01267                                            1267
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*       GROUPPTR=ADDR(GROUPBUF);    /* RESET GROUP PTR       @ZA13058*/
@RF01263 LA    @06,GROUPBUF                                        1270
         ST    @06,GROUPPTR                                        1270
*     END;                          /*                       @Y30LB25*/
*                                                                  1271
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NULLIFY DESCRIPTION CALLED FOR, NULLIFY IT         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1272
*   IF DEFNDESC=ON THEN             /* NULLIFY DEXCRIPTION?  @Y30LB25*/
@RF01225 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1272
         BNO   @RF01272                                            1272
*     BASDESCR=BLANK30;             /* NULLIFT DESCRIP       @Y30LB25*/
         L     @06,BASEVPTR                                        1273
         MVI   BASDESCR+1(@06),C' '                                1273
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1273
         MVI   BASDESCR(@06),C' '                                  1273
*   ELSE                            /*                       @Y30LB25*/
*                                                                  1274
*     /***************************************************************/
*     /*                                                             */
*     /* OTHERWISE SEE IF NEW DESCRIPTION CALLED FOR         @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1274
*     IF DEFPDESC=ON THEN           /* DESCR SPEC?           @Y30LB25*/
         B     @RC01272                                            1274
@RF01272 TM    DEFPDESC(DEFVEPTR),B'00010000'                      1274
         BNO   @RF01274                                            1274
*       BASDESCR=DEFDESCR;          /* MODIFY DESCRIPTION    @Y30LB25*/
*                                                                  1275
         L     @06,BASEVPTR                                        1275
         MVC   BASDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1275
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NEW BACKUP NUMBER SPECIFIED, PUT IT IN             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1276
*   IF DEFPBKUP=ON THEN             /* BACKUP SPEC?          @Y30LB25*/
@RF01274 DS    0H                                                  1276
@RC01272 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1276
         BNO   @RF01276                                            1276
*     BASBKLMT=DEFBKUPN;            /* SET MAX BACKUPS       @Y30LB25*/
*                                                                  1277
         IC    @06,DEFBKUPN(,DEFVEPTR)                             1277
         L     @01,BASEVPTR                                        1277
         STC   @06,BASBKLMT(,@01)                                  1277
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1278
*   BCDVPTR=BASEVPTR;               /* PT TO BVR             @Y30LB25*/
@RF01276 L     @06,BASEVPTR                                        1278
         ST    @06,BCDVPTR                                         1278
*   CALL SETCLRDF;                  /* CLEAR - SET RECOVERY  @Y30LB25*/
         BAL   @14,SETCLRDF                                        1279
*   RETURN;                         /*                       @Y30LB25*/
@EL00027 DS    0H                                                  1280
@EF00027 DS    0H                                                  1280
@ER00027 L     @14,@SA00027                                        1280
         BR    @14                                                 1280
*   END COMMON;                     /*                       @Y30LB25*/
         B     @EL00027                                            1281
*                                                                  1282
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PCVRE                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE IEZDEFVE FOR A CVR.                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* COPY VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* COPY VOLUME RECORD                                    @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1282
*PCVRE:                                                            1282
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1282
PCVRE    ST    @14,@SA00028                                        1282
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR DESCRIPTION                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1283
*   IF DEFPDESC=ON                  /* ADD DESCRPT?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFPDESC(DEFVEPTR),B'00010000'                      1283
         BNO   @RF01283                                            1283
*     COPDESCR=DEFDESCR;            /* SET NEW DESCRPT       @Y30LB25*/
         L     @06,COPYVPTR                                        1284
         MVC   COPDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1284
*   IF DEFNDESC=ON                  /* NULLIFY?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01283 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1285
         BNO   @RF01285                                            1285
*     COPDESCR=BLANK30;             /* BLANK DESCRPT         @Y30LB25*/
*                                                                  1286
         L     @06,COPYVPTR                                        1286
         MVI   COPDESCR+1(@06),C' '                                1286
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1286
         MVI   COPDESCR(@06),C' '                                  1286
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THE MAXIMUM NUMBER OF BACKUPS IS TO CHANGE   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1287
*   IF DEFPBKUP=ON                  /* BACKUP?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01285 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1287
         BNO   @RF01287                                            1287
*     DO;                           /*                       @Y30LB25*/
*       BVOLKY=COPSERNO;            /* SET VOLID             @Y30LB25*/
         L     @06,COPYVPTR                                        1289
         MVC   BVOLKY(6),COPSERNO(@06)                             1289
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1290
         L     @01,RPLVPTR                                         1290
         ST    @06,RPLVKEY(,@01)                                   1290
*       CALL READUPD1;              /* READ CVR'S BVR        @Y30LB25*/
         BAL   @14,READUPD1                                        1291
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1292
         LH    @06,RPLVRETC(,@06)                                  1292
         N     @06,@CF01129                                        1292
         LTR   @06,@06                                             1292
         BNZ   @RT01292                                            1292
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* MAP OF BVR            @Y30LB25*/
         LA    @06,BASEBUF1                                        1294
         ST    @06,BASEVPTR                                        1294
*       BASBKLMT=DEFBKUPN;          /* SET MAX # BKUP        @Y30LB25*/
         IC    @15,DEFBKUPN(,DEFVEPTR)                             1295
         STC   @15,BASBKLMT(,@06)                                  1295
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1296
*       BASEVPTR=ADDR(BASEBUF);     /* RESTORE MAP           @Y30LB25*/
         LA    @06,BASEBUF                                         1297
         ST    @06,BASEVPTR                                        1297
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1298
         LH    @06,RPLVRETC(,@06)                                  1298
         N     @06,@CF01129                                        1298
         LTR   @06,@06                                             1298
         BNZ   @RT01298                                            1298
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1300
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*   CALL SETCLRDF;                  /* SET - CLEAR           @Y30LB25
*                                      RECOVERY FLGS         @Y30LB25*/
@RF01287 BAL   @14,SETCLRDF                                        1301
*   RETURN;                         /*                       @Y30LB25*/
@EL00028 DS    0H                                                  1302
@EF00028 DS    0H                                                  1302
@ER00028 L     @14,@SA00028                                        1302
         BR    @14                                                 1302
*   END PCVRE;                      /*                       @Y30LB25*/
         B     @EL00028                                            1303
*                                                                  1304
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - SETCLRDF                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/
*   /* FOR THE DEFINEV.                                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*SETCLRDF:                                                         1304
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/
*                                                                  1304
SETCLRDF STM   @14,@12,12(@13)                                     1304
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1305
*   IF DEFSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFSRCVY(DEFVEPTR),B'10000000'                      1305
         BNO   @RF01305                                            1305
*     DO;                           /*                       @Y30LB25*/
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1307
         BNO   @RF01307                                            1307
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1308
         OI    BCDIVCPY(@06),B'01000000'                           1308
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01307 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1309
         BNO   @RF01309                                            1309
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1310
         OI    BCDIVCRE(@06),B'10000000'                           1310
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01309 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1311
         BNO   @RF01311                                            1311
*         DO;                       /*                       @Y30LB25*/
*           BCDVSMIS=ON;            /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1313
         OI    BCDVSMIS(@06),B'00100000'                           1313
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         TM    BCDBASE(@06),B'00100000'                            1314
         BNO   @RF01314                                            1314
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25
*                                      SET LABEL             @Y30LB25*/
         L     @06,BASEVPTR                                        1315
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1315
*         END;                      /*                       @Y30LB25*/
@RF01314 DS    0H                                                  1317
*     END;                          /*                       @Y30LB25*/
*                                                                  1317
@RF01311 DS    0H                                                  1318
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1318
*   IF DEFCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */
*     THEN                          /* YES                   @Y30LB25*/
@RF01305 TM    DEFCRCVY(DEFVEPTR),B'01000000'                      1318
         BNO   @RF01318                                            1318
*     DO;                           /*                       @Y30LB25*/
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1320
         BNO   @RF01320                                            1320
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1321
         NI    BCDIVCPY(@06),B'10111111'                           1321
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01320 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1322
         BNO   @RF01322                                            1322
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1323
         NI    BCDIVCRE(@06),B'01111111'                           1323
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01322 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1324
         BNO   @RF01324                                            1324
*         DO;                       /*                       @Y30LB25*/
*           BCDVSMIS=OFF;           /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1326
         NI    BCDVSMIS(@06),B'11011111'                           1326
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         TM    BCDBASE(@06),B'00100000'                            1327
         BNO   @RF01327                                            1327
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25
*                                      CLR LABEL             @Y30LB25*/
         L     @06,BASEVPTR                                        1328
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1328
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00029 DS    0H                                                  1331
@EF00029 DS    0H                                                  1331
@ER00029 LM    @14,@12,12(@13)                                     1331
         BR    @14                                                 1331
*   END SETCLRDF;                   /*                       @Y30LB25*/
         B     @EL00029                                            1332
*                                                                  1333
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - SETCLRCV                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/
*   /* FOR THE CVOL.                                         @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1333
*SETCLRCV:                                                         1333
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/
*                                                                  1333
SETCLRCV STM   @14,@12,12(@13)                                     1333
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1334
*   IF COVSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,COVCEPTR                                        1334
         TM    COVSRCVY(@06),B'10000000'                           1334
         BNO   @RF01334                                            1334
*     DO;                           /*                       @Y30LB25*/
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    COVICOPY(@06),B'10000000'                           1336
         BNO   @RF01336                                            1336
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1337
         OI    BCDIVCPY(@06),B'01000000'                           1337
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01336 L     @06,COVCEPTR                                        1338
         TM    COVCREAT(@06),B'01000000'                           1338
         BNO   @RF01338                                            1338
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1339
         OI    BCDIVCRE(@06),B'10000000'                           1339
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01338 L     @06,COVCEPTR                                        1340
         TM    COVLAMIS(@06),B'00100000'                           1340
         BNO   @RF01340                                            1340
*         BCDVSMIS=ON;              /* SET FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1341
         OI    BCDVSMIS(@06),B'00100000'                           1341
*     END;                          /*                       @Y30LB25*/
*                                                                  1342
@RF01340 DS    0H                                                  1343
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1343
*   IF COVCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */
*     THEN                          /* YES                   @Y30LB25*/
@RF01334 L     @06,COVCEPTR                                        1343
         TM    COVCRCVY(@06),B'01000000'                           1343
         BNO   @RF01343                                            1343
*     DO;                           /*                       @Y30LB25*/
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    COVICOPY(@06),B'10000000'                           1345
         BNO   @RF01345                                            1345
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1346
         NI    BCDIVCPY(@06),B'10111111'                           1346
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01345 L     @06,COVCEPTR                                        1347
         TM    COVCREAT(@06),B'01000000'                           1347
         BNO   @RF01347                                            1347
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1348
         NI    BCDIVCRE(@06),B'01111111'                           1348
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01347 L     @06,COVCEPTR                                        1349
         TM    COVLAMIS(@06),B'00100000'                           1349
         BNO   @RF01349                                            1349
*         BCDVSMIS=OFF;             /* CLR FLAG              @Y30LB25*/
         L     @06,BCDVPTR                                         1350
         NI    BCDVSMIS(@06),B'11011111'                           1350
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00030 DS    0H                                                  1352
@EF00030 DS    0H                                                  1352
@ER00030 LM    @14,@12,12(@13)                                     1352
         BR    @14                                                 1352
*   END SETCLRCV;                   /*                       @Y30LB25*/
         B     @EL00030                                            1353
*                                                                  1354
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - REPVFLG1                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* REPLACE VOLUME FLAGS PROCESSING BEFORE THE MSC        @Y30LB25*/
*   /* IS CALLED.                                            @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1354
*REPVFLG1:                                                         1354
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1354
REPVFLG1 ST    @14,@SA00031                                        1354
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE .MSVI.                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1355
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/
*                                                                  1355
         BAL   @14,RMSVIS                                          1355
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1356
*   IF DEFVVEXT^=FIXZERO&DEFPGRO=ON /* GROUP SPECIFIED?      @ZA28871*/
*     THEN                          /* YES                   @VS32198*/
         L     @06,DEFVVEXT(,DEFVPTR)                              1356
         LTR   @06,@06                                             1356
         BZ    @RF01356                                            1356
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1356
         BNO   @RF01356                                            1356
*     DO;                           /*                       @VS32198*/
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1358
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/
         LA    @06,GKEY                                            1359
         L     @01,RPLVPTR                                         1359
         ST    @06,RPLVKEY(,@01)                                   1359
*       CALL READLOC;               /* GET GVR               @VS32198*/
         BAL   @14,READLOC                                         1360
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/
*         THEN                      /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         1361
         LH    @15,RPLVRETC(,@06)                                  1361
         N     @15,@CF01129                                        1361
         LTR   @15,@15                                             1361
         BZ    @RF01361                                            1361
*         DO;                       /*                       @VS32198*/
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/
*             THEN                  /* RIGHT                 @VS32198*/
         CLC   RPLRCODE(2,@06),@CB00711                            1363
         BNE   @RF01363                                            1363
*             RPLRCODE=NOGRPFND;    /*                       @VS32198
*                                      NO GROUP FND          @VS32198*/
         MVC   RPLRCODE(2,@06),@CB00707                            1364
*           RETURN;                 /*                       @VS32198*/
@EL00031 DS    0H                                                  1365
@EF00031 DS    0H                                                  1365
@ER00031 L     @14,@SA00031                                        1365
         BR    @14                                                 1365
*         END;                      /*                       @VS32198*/
*     END;                          /*                       @VS32198*/
*                                                                  1367
@RF01361 DS    0H                                                  1368
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE VOLUME                                        #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1368
*   BVOLKY=DEFVOLD;                 /* SET VOLID             #Y30LB25*/
@RF01356 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1368
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          #Y30LB25*/
         LA    @06,BKEY                                            1369
         L     @01,RPLVPTR                                         1369
         ST    @06,RPLVKEY(,@01)                                   1369
*   CALL READLOC;                   /* READ BVR              #Y30LB25*/
         BAL   @14,READLOC                                         1370
*   IF RPLVRETC^=FIXZERO            /* ERROR?                #Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1371
         LH    @15,RPLVRETC(,@06)                                  1371
         N     @15,@CF01129                                        1371
         LTR   @15,@15                                             1371
         BNZ   @RT01371                                            1371
*     RETURN;                       /*                       @Y30LB25*/
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25
*                                      GVR IS READ           @Y30LB25*/
*                                                                  1373
         L     @06,RPLVBUF(,@06)                                   1373
         MVC   BASEBUF(224),BUFFER(@06)                            1373
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1374
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/
         BAL   @14,EXPCK                                           1374
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1375
         LH    @06,RPLVRETC(,@06)                                  1375
         N     @06,@CF01129                                        1375
         LTR   @06,@06                                             1375
         BNZ   @RT01375                                            1375
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1376
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK ATTRIBUTES IF NECESSARY.                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1377
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/
         BAL   @14,CKATTRIB                                        1377
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00031                                            1378
*   END REPVFLG1;                   /*                       @Y30LB25*/
         B     @EL00031                                            1379
*                                                                  1380
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - REPVFLG2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* REPLACE VOLUME FLAGS PROCESSING AFTER THE MSC         @Y30LB25*/
*   /* WAS CALLED.                                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1380
*REPVFLG2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
REPVFLG2 ST    @14,@SA00032                                        1380
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1381
         LH    @15,RPLRCODE(,@06)                                  1381
         N     @15,@CF01129                                        1381
         LTR   @15,@15                                             1381
         BZ    @RF01381                                            1381
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1383
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1384
*       RETURN;                     /*                       @Y30LB25*/
@EL00032 DS    0H                                                  1385
@EF00032 DS    0H                                                  1385
@ER00032 L     @14,@SA00032                                        1385
         BR    @14                                                 1385
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25
*                                      RESERVE .MSVI         #Y30LB25*/
*                                                                  1387
@RF01381 BAL   @14,HOUSKEEP                                        1387
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE VOLUME RECORD                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1388
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1388
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1389
         L     @01,RPLVPTR                                         1389
         ST    @06,RPLVKEY(,@01)                                   1389
*   CALL READUPD1;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,READUPD1                                        1390
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1391
         LH    @06,RPLVRETC(,@06)                                  1391
         N     @06,@CF01129                                        1391
         LTR   @06,@06                                             1391
         BNZ   @RT01391                                            1391
*     RETURN;                       /*                       @Y30LB25*/
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/
*                                                                  1393
         MVC   BASEBUF(224),BASEBUF1                               1393
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE BVR EXCLUSIVE ATTRIBUTE                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1394
*   IF DEFVEXCL=ON                  /* EXCL ON?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       1394
         BNO   @RF01394                                            1394
*     BASEXCL=ON;                   /* SET ON                @Y30LB25*/
         L     @06,BASEVPTR                                        1395
         OI    BASEXCL(@06),B'00000001'                            1395
*   ELSE                            /* EXCL IS OFF           @Y30LB25*/
*     BASEXCL=OFF;                  /* SET OFF               @Y30LB25*/
*                                                                  1396
         B     @RC01394                                            1396
@RF01394 L     @06,BASEVPTR                                        1396
         NI    BASEXCL(@06),B'11111110'                            1396
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE BVR BIND ATTRIBUTE                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1397
*   IF DEFVBIND=ON                  /* BIND ON?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01394 TM    DEFVBIND(DEFVPTR),B'00000100'                       1397
         BNO   @RF01397                                            1397
*     BASBIND=ON;                   /* SET ON                @Y30LB25*/
         L     @06,BASEVPTR                                        1398
         OI    BASBIND(@06),B'00000010'                            1398
*   ELSE                            /* BIND IS OFF           @Y30LB25*/
*     BASBIND=OFF;                  /* SET OFF               @Y30LB25*/
*                                                                  1399
         B     @RC01397                                            1399
@RF01397 L     @06,BASEVPTR                                        1399
         NI    BASBIND(@06),B'11111101'                            1399
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE DASD ERASE ATTRIBUTE                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1400
*   IF DEFVSEC=ON                   /* SECURE ON?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01397 TM    DEFVSEC(DEFVPTR),B'00100000'                        1400
         BNO   @RF01400                                            1400
*     BASDAERA=ON;                  /* SET ON                @Y30LB25*/
         L     @06,BASEVPTR                                        1401
         OI    BASDAERA(@06),B'10000000'                           1401
*   ELSE                            /* SECURE IS OFF         @Y30LB25*/
*     BASDAERA=OFF;                 /* SET OFF               @Y30LB25*/
*                                                                  1402
         B     @RC01400                                            1402
@RF01400 L     @06,BASEVPTR                                        1402
         NI    BASDAERA(@06),B'01111111'                           1402
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE BVR READ ONLY ATTRIBUTE                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1403
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01400 TM    DEFVWINH(DEFVPTR),B'00000010'                       1403
         BNO   @RF01403                                            1403
*     BASRONLY=ON;                  /* SET ON                @Y30LB25*/
         L     @06,BASEVPTR                                        1404
         OI    BASRONLY(@06),B'01000000'                           1404
*   ELSE                            /* READ ONLY IS OFF      @Y30LB25*/
*     BASRONLY=OFF;                 /* SET OFF               @Y30LB25*/
*                                                                  1405
         B     @RC01403                                            1405
@RF01403 L     @06,BASEVPTR                                        1405
         NI    BASRONLY(@06),B'10111111'                           1405
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR DEVFE TO BE PROCESSED                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1406
*   IF DEFVVEXT^=FIXZERO            /* DEFVE?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01403 L     @06,DEFVVEXT(,DEFVPTR)                              1406
         LTR   @06,@06                                             1406
         BZ    @RF01406                                            1406
*     DO;                           /*                       @Y30LB25*/
*       BCDVPTR=BASEVPTR;           /* SET BVR PTR           @Y30LB25*/
         L     @06,BASEVPTR                                        1408
         ST    @06,BCDVPTR                                         1408
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/
         BAL   @14,PRODEFVE                                        1409
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1410
         LH    @15,RPLVRETC(,@06)                                  1410
         N     @15,@CF01129                                        1410
         LTR   @15,@15                                             1410
         BNZ   @RT01410                                            1410
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1411
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH BVR'S RPLV                            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1412
*       BVOLKY=BASSERNO;            /* RESET VOLID           @Y30LB25*/
         L     @01,BASEVPTR                                        1412
         MVC   BVOLKY(6),BASSERNO(@01)                             1412
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            1413
         ST    @15,RPLVKEY(,@06)                                   1413
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1414
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1415
         LH    @06,RPLVRETC(,@06)                                  1415
         N     @06,@CF01129                                        1415
         LTR   @06,@06                                             1415
         BNZ   @RT01415                                            1415
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   RPLVBUF=ADDR(BASEBUF);          /* ADDR OF BVR BUF       @Y30LB25*/
@RF01406 LA    @06,BASEBUF                                         1418
         L     @01,RPLVPTR                                         1418
         ST    @06,RPLVBUF(,@01)                                   1418
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1419
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00032                                            1420
*   END REPVFLG2;                   /*                       @Y30LB25*/
         B     @EL00032                                            1421
*                                                                  1422
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTINCV1                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME BEFORE     @Y30LB25*/
*   /* THE MSC IS CALLED.                                    @Y30LB25*/
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1422
*CRTINCV1:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1422
CRTINCV1 ST    @14,@SA00033                                        1422
*   /*****************************************************************/
*   /*                                                               */
*   /* RESERVE .MSVI.                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1423
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/
*                                                                  1423
         BAL   @14,RMSVI                                           1423
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1424
*   IF DEFPGRO=ON&DEFVVEXT^=FIXZERO /* GROUP SPECIFIED?      @VS34305*/
*     THEN                          /* YES                   @VS32198*/
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1424
         BNO   @RF01424                                            1424
         L     @06,DEFVVEXT(,DEFVPTR)                              1424
         LTR   @06,@06                                             1424
         BZ    @RF01424                                            1424
*     DO;                           /*                       @VS32198*/
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1426
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/
         LA    @06,GKEY                                            1427
         L     @01,RPLVPTR                                         1427
         ST    @06,RPLVKEY(,@01)                                   1427
*       CALL READLOC;               /* GET GVR               @VS32198*/
         BAL   @14,READLOC                                         1428
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/
*         THEN                      /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         1429
         LH    @15,RPLVRETC(,@06)                                  1429
         N     @15,@CF01129                                        1429
         LTR   @15,@15                                             1429
         BZ    @RF01429                                            1429
*         DO;                       /*                       @VS32198*/
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/
*             THEN                  /* RIGHT                 @VS32198*/
         CLC   RPLRCODE(2,@06),@CB00711                            1431
         BNE   @RF01431                                            1431
*             RPLRCODE=NOGRPFND;    /*                       @VS32198
*                                      NO GROUP FND          @VS32198*/
         MVC   RPLRCODE(2,@06),@CB00707                            1432
*           RETURN;                 /*                       @VS32198*/
@EL00033 DS    0H                                                  1433
@EF00033 DS    0H                                                  1433
@ER00033 L     @14,@SA00033                                        1433
         BR    @14                                                 1433
*         END;                      /*                       @VS32198*/
*     END;                          /*                       @VS32198*/
*                                                                  1435
@RF01429 DS    0H                                                  1436
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CREATE A COPY VOLUME RECORD                 #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1436
*   IF DEFVVEXT^=FIXZERO&DEFCOPY=ON /* CREATE A CVR?         #Y30LB25*/
*     THEN                          /* YES                   #Y30LB25*/
@RF01424 L     @06,DEFVVEXT(,DEFVPTR)                              1436
         LTR   @06,@06                                             1436
         BZ    @RF01436                                            1436
         TM    DEFCOPY(DEFVEPTR),B'00010000'                       1436
         BNO   @RF01436                                            1436
*     DO;                           /*                       @Y30LB25*/
*                                                                  1437
*       /*************************************************************/
*       /*                                                           */
*       /* GET CVR'S BVR                                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1438
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1438
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1439
         L     @05,RPLVPTR                                         1439
         ST    @06,RPLVKEY(,@05)                                   1439
*       CALL READLOC;               /* READ BVR              @Y30LB25*/
         BAL   @14,READLOC                                         1440
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1441
         LH    @05,RPLVRETC(,@06)                                  1441
         N     @05,@CF01129                                        1441
         LTR   @05,@05                                             1441
         BNZ   @RT01441                                            1441
*         RETURN;                   /*                       @Y30LB25*/
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25
*                                      CVR IS READ           @Y30LB25*/
*                                                                  1443
         L     @05,RPLVBUF(,@06)                                   1443
         MVC   BASEBUF(224),BUFFER(@05)                            1443
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF COPIES ARE ALLOWED                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1444
*       IF BASNOCPY=ON              /* COPIES ALLOWED?       @Y30LB25*/
*         THEN                      /* NO                    @Y30LB25*/
         L     @05,BASEVPTR                                        1444
         TM    BASNOCPY(@05),B'01000000'                           1444
         BNO   @RF01444                                            1444
*         DO;                       /*                       @Y30LB25*/
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/
         MVC   RPLVRETC(2,@06),@CH00041                            1446
*           RPLRCODE=NOCPYBVR;      /* ERROR REASON CODE     @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00721                            1447
*         END;                      /*                       @Y30LB25*/
*                                                                  1448
*       /*************************************************************/
*       /*                                                           */
*       /* CREATE A PLACE HOLDER CVR                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1449
*       CALL CRTCVR1;               /* CREATE PLACE HOLD     @Y30LB25*/
@RF01444 BAL   @14,CRTCVR1                                         1449
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00033                                            1450
*     END;                          /*                       @Y30LB25*/
*                                                                  1451
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK ATTRIBUTES, IF NECESSARY.                       @Y30LB25*/
*   /* CKATTRIB WILL ONLY CHECK IF THE VOLUME IS TO          @Y30LB25*/
*   /* BE GROUPED.                                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1452
*   BASGENUS=OFF;                   /* NO GEN-USE            @Y30LB25*/
@RF01436 DS    0H                                                  1453
*   BASGRPV=OFF;                    /* NOT GROUPED           @Y30LB25*/
         L     @06,BASEVPTR                                        1453
         NI    BASGENUS(@06),B'11001111'                           1453
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/
         BAL   @14,CKATTRIB                                        1454
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1455
         LH    @06,RPLVRETC(,@06)                                  1455
         N     @06,@CF01129                                        1455
         LTR   @06,@06                                             1455
         BNZ   @RT01455                                            1455
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1456
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE AND WRITE A PLACE HOLDER BASE VOLUME RECORD    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1457
*   BVOLKY=DEFVOLD;                 /* SET KEY               @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1457
*   CALL CRTPHOLD;                  /* CREATE BVR PLACE      @Y30LB25
*                                      HOLDER                @Y30LB25*/
         BAL   @14,CRTPHOLD                                        1458
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00033                                            1459
*   END CRTINCV1;                   /*                       @Y30LB25*/
         B     @EL00033                                            1460
*                                                                  1461
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - READLOC                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* READ AN MSVC RECORD IN THE LOCATE MODE.               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* ADDRESS OF THE KEY TO READ IN RPLVKEY                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1461
*READLOC:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
READLOC  ST    @14,@SA00034                                        1461
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         L     @06,RPLVPTR                                         1462
         MVI   RPLVTYP(@06),X'00'                                  1462
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         OI    RPLVLOC(@06),B'11000000'                            1464
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/
         NI    RPLVUPD(@06),B'11111101'                            1465
*   RESPECIFY                                                      1466
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@06                                             1467
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/
         L     @15,@CV00762                                        1468
         BALR  @14,@15                                             1468
*   RESPECIFY                                                      1469
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00034 DS    0H                                                  1470
@EF00034 DS    0H                                                  1470
@ER00034 L     @14,@SA00034                                        1470
         BR    @14                                                 1470
*   END READLOC;                    /*                       @Y30LB25*/
*                                                                  1472
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTPHOLD                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CREATE AND WRITE A PLACE HOLDER BVR.                  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BKEY                                                  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1472
*CRTPHOLD:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
CRTPHOLD ST    @14,@SA00035                                        1472
*   BASEBUF=BASEBUF&&BASEBUF;       /* CLEAR BVR BUF         @Y30LB25*/
         XC    BASEBUF(224),BASEBUF                                1473
*   BASNAME=BKEY;                   /* SET KEY               @Y30LB25*/
         L     @06,BASEVPTR                                        1474
         MVC   BASNAME(13,@06),BKEY                                1474
*   BASBASVR=ON;                    /* BVR FLAG              @Y30LB25*/
         OI    BASBASVR(@06),B'00100000'                           1475
*   BASHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/
         OI    BASHOLD(@06),B'10000000'                            1476
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/
         OI    BASINAC(@06),B'00000100'                            1477
*   BASCSN1=BLANK12;                /* CSN1                  @Y30LB25*/
         MVC   BASCSN1(12,@06),@CC00689                            1478
*   BASCSN2=BLANK12;                /* CSN2                  @Y30LB25*/
         MVC   BASCSN2(12,@06),@CC00689                            1479
*   RPLVBLN=LENGTH(BASEBUF);        /* LENGTH BVR BUF        @Y30LB25*/
         LA    @06,224                                             1480
         L     @15,RPLVPTR                                         1480
         ST    @06,RPLVBLN(,@15)                                   1480
*   RPLVRLN=LENGTH(BASEBUF);        /* BVR LENGTH            @Y30LB25*/
         ST    @06,RPLVRLN(,@15)                                   1481
*   RPLVBUF=ADDR(BASEBUF);          /* SET BUF ADDR          @Y30LB25*/
         LA    @06,BASEBUF                                         1482
         ST    @06,RPLVBUF(,@15)                                   1482
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@15),B'01111111'                            1483
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/
         NI    RPLVUPD(@15),B'11111101'                            1484
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1485
*   RETURN;                         /*                       @Y30LB25*/
@EL00035 DS    0H                                                  1486
@EF00035 DS    0H                                                  1486
@ER00035 L     @14,@SA00035                                        1486
         BR    @14                                                 1486
*   END CRTPHOLD;                   /*                       @Y30LB25*/
*                                                                  1488
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTINCV2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME AFTER      @Y30LB25*/
*   /* THE MSC WAS CALLED.                                   @Y30LB25*/
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/
*   /* ONE IS NOT SUPPLIED DURING USER TASK RECOVERY THOUGH. @Y30LB25*/
*   /* CIRS ARE CREATED BY ICBVMS00 WHEN IT RECEIVES         @Y30LB25*/
*   /* THE 04 MESSAGE.                                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1488
*CRTINCV2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
CRTINCV2 ST    @14,@SA00036                                        1488
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
         BAL   @14,HOUSKEEP                                        1489
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1490
         LH    @15,RPLRCODE(,@06)                                  1490
         N     @15,@CF01129                                        1490
         LTR   @15,@15                                             1490
         BZ    @RF01490                                            1490
*     DO;                           /*                       @Y30LB25*/
*                                                                  1491
*       /*************************************************************/
*       /*                                                           */
*       /* ZERO MSC'S RETURN AND REASON CODE                 @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1492
*       RPLVRETC=RPLVRETC&&RPLVRETC;/*                       @Y30LB25
*                                      0 RPLV RETN CODE      @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1492
*       RPLRCODE=RPLRCODE&&RPLRCODE;/*                       @Y30LB25
*                                      0 RPLV RETN CODE      @Y30LB25*/
*                                                                  1493
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1493
*       /*************************************************************/
*       /*                                                           */
*       /* READ FOR THE BVR                                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1494
*       BVOLKY=DEFVOLD;             /*                       @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1494
*       RPLVKEY=ADDR(BKEY);         /*                       @Y30LB25*/
         LA    @05,BKEY                                            1495
         ST    @05,RPLVKEY(,@06)                                   1495
*       CALL READUPD1;              /*                       @Y30LB25*/
         BAL   @14,READUPD1                                        1496
*       BASEBUF=BASEBUF1;           /*                       @Y30LB25*/
         MVC   BASEBUF(224),BASEBUF1                               1497
*       IF RPLVRETC^=FIXZERO THEN                                  1498
         L     @06,RPLVPTR                                         1498
         LH    @05,RPLVRETC(,@06)                                  1498
         N     @05,@CF01129                                        1498
         LTR   @05,@05                                             1498
         BNZ   @RT01498                                            1498
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1499
*       /*************************************************************/
*       /*                                                           */
*       /* DELETE THE PLACE HOLDER BASE OR COPY              @Y30LB25*/
*       /* VOLUME RECORD WHICH WAS CREATED BEFORE THE        @Y30LB25*/
*       /* CALL TO THE MSC.                                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1500
*       IF BASHOLD=ON               /* BVR CREATED?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @05,BASEVPTR                                        1500
         TM    BASHOLD(@05),B'10000000'                            1500
         BNO   @RF01500                                            1500
*         DO;                       /*                       @Y30LB25*/
*                                                                  1501
*           /*********************************************************/
*           /*                                                       */
*           /* DELETE THE BVR PLACE HOLDER                   @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1502
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/
         MVI   RPLVTYP(@06),X'05'                                  1502
*           RESPECIFY                                              1503
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/
         LR    RG1,@06                                             1504
*           CALL ICBVIO00;          /* DELET BVR PLC HOLD    @Y30LB25*/
         L     @15,@CV00762                                        1505
         BALR  @14,@15                                             1505
*           RESPECIFY                                              1506
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  1507
*       /*************************************************************/
*       /*                                                           */
*       /* FIND THE PLACE HOLDER CVR                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1508
*       ELSE                                                       1508
*         DO;                       /*                       @Y30LB25*/
         B     @RC01500                                            1508
@RF01500 DS    0H                                                  1509
*           CALL FNDCVRUP;          /* FIND PLACE HOLD       @Y30LB25*/
         BAL   @14,FNDCVRUP                                        1509
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1510
         LH    @15,RPLVRETC(,@06)                                  1510
         N     @15,@CF01129                                        1510
         LTR   @15,@15                                             1510
         BNZ   @RT01510                                            1510
*             RETURN;               /*                       @Y30LB25*/
*                                                                  1511
*           /*********************************************************/
*           /*                                                       */
*           /* DELETE THE CVR PLACE HOLDER                   @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1512
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/
         MVI   RPLVTYP(@06),X'05'                                  1512
*           RESPECIFY                                              1513
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/
         LR    RG1,@06                                             1514
*           CALL ICBVIO00;          /* DELET CVR PLC HOLD    @Y30LB25*/
         L     @15,@CV00762                                        1515
         BALR  @14,@15                                             1515
*           RESPECIFY                                              1516
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
@RC01500 L     @06,RPLVPTR                                         1518
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1518
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1519
*       RETURN;                     /*                       @Y30LB25*/
@EL00036 DS    0H                                                  1520
@EF00036 DS    0H                                                  1520
@ER00036 L     @14,@SA00036                                        1520
         BR    @14                                                 1520
*     END;                          /*                       @Y30LB25*/
*                                                                  1521
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR THE BVR                                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1522
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
@RF01490 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1522
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/
         LA    @06,BKEY                                            1523
         L     @01,RPLVPTR                                         1523
         ST    @06,RPLVKEY(,@01)                                   1523
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1524
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1525
         LH    @06,RPLVRETC(,@06)                                  1525
         N     @06,@CF01129                                        1525
         LTR   @06,@06                                             1525
         BNZ   @RT01525                                            1525
*     RETURN;                       /*                       @Y30LB25*/
*   BASEBUF=BASEBUF1;               /*                       @Y30LB25*/
*                                                                  1527
         MVC   BASEBUF(224),BASEBUF1                               1527
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE A COPY VOLUME RECORD FROM A PLACE HOLDER       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1528
*   IF BASHOLD=OFF                  /* CREATE CVR?           @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        1528
         TM    BASHOLD(@06),B'10000000'                            1528
         BNZ   @RF01528                                            1528
*     DO;                           /*                       @Y30LB25*/
*       CALL FNDCVRUP;              /* FIND PLACE HOLD       @Y30LB25*/
         BAL   @14,FNDCVRUP                                        1530
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1531
         LH    @06,RPLVRETC(,@06)                                  1531
         N     @06,@CF01129                                        1531
         LTR   @06,@06                                             1531
         BNZ   @RT01531                                            1531
*         RETURN;                   /*                       @Y30LB25*/
*       CALL CRTCVR2;               /* MAKE A CVR            @Y30LB25*/
         BAL   @14,CRTCVR2                                         1533
*     END;                          /*                       @Y30LB25*/
*                                                                  1534
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE A BASE VOLUME RECORD                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1535
*   ELSE                            /* CREATE BVR            @Y30LB25*/
*     CALL CRTBVR;                  /* PROCESS BVR           @Y30LB25*/
         B     @RC01528                                            1535
@RF01528 BAL   @14,CRTBVR                                          1535
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00036                                            1536
*   END CRTINCV2;                   /*                       @Y30LB25*/
         B     @EL00036                                            1537
*                                                                  1538
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTCVR1                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CREATE A PLACE HOLDER COPY VOLUME RECORD.             @Y30LB25*/
*   /* THE PLACE HOLDER CVR IS NEEDED TO INSURE 04           @Y30LB25*/
*   /* SOLICITED MESSAGE CAN BE PROCESSED.                   @Y30LB25*/
*   /* CALLED BEFORE THE MSC.                                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1538
*CRTCVR1:                                                          1538
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1538
CRTCVR1  ST    @14,@SA00037                                        1538
*   /*****************************************************************/
*   /*                                                               */
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1539
*   CALL CALCVRID;                  /* LOC KEY ID            @Y30LB25*/
         BAL   @14,CALCVRID                                        1539
*   IF RPLVRETC^=FIXZERO&RPLVRETC^=NORECFND/* ERROR?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1540
         LH    @05,RPLVRETC(,@06)                                  1540
         N     @05,@CF01129                                        1540
         LTR   @05,@05                                             1540
         BZ    @RF01540                                            1540
         CLC   RPLVRETC(2,@06),@CB00711                            1540
         BNE   @RT01540                                            1540
*     RETURN;                       /*                       @Y30LB25*/
*   COPYVPTR=ADDR(COPYBUF);         /* RESET CVR BUF PTR     @Y30LB25*/
*                                                                  1542
@RF01540 LA    @06,COPYBUF                                         1542
         ST    @06,COPYVPTR                                        1542
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE PLACE HOLDER CVR.                      @Y30LB25*/
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1543
*   COPYBUF=COPYBUF&&COPYBUF;       /* ZERO CVR BUF          @Y30LB25*/
         XC    COPYBUF(224),COPYBUF                                1543
*   COPNAME=CKEY;                   /* SET THE KEY           @Y30LB25*/
         MVC   COPNAME(13,@06),CKEY                                1544
*   COPSERNO=DEFVOLD;               /* RESET VOLID           @Y30LB25*/
         MVC   COPSERNO(6,@06),DEFVOLD(DEFVPTR)                    1545
*   COPCOPYV=ON;                    /* CVR FLAG              @Y30LB25*/
         OI    COPCOPYV(@06),B'00010000'                           1546
*   COPHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/
         OI    COPHOLD(@06),B'10000000'                            1547
*   COPLIB1=DEFVLIB;                /* SET LIB1 ID           @Y30LB25*/
         IC    @05,DEFVLIB(,DEFVPTR)                               1548
         STC   @05,COPLIB1(,@06)                                   1548
*   COPLIB2=DEFVLIB;                /* SET LIB2 ID           @Y30LB25*/
         IC    @05,DEFVLIB(,DEFVPTR)                               1549
         STC   @05,COPLIB2(,@06)                                   1549
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1550
         BE    @RF01550                                            1550
*     COPOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/
         MVC   COPOWNER(10,@06),DEFOWNID(DEFVPTR)                  1551
*   ELSE                            /* NO                    @Y30LB25*/
*     COPOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/
         B     @RC01550                                            1552
@RF01550 L     @06,COPYVPTR                                        1552
         MVI   COPOWNER+1(@06),C' '                                1552
         MVC   COPOWNER+2(8,@06),COPOWNER+1(@06)                   1552
         MVI   COPOWNER(@06),C' '                                  1552
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01550 L     @06,BASEVPTR                                        1553
         TM    BASGRPV(@06),B'00100000'                            1553
         BNO   @RF01553                                            1553
*     COPGROUP=ON;                  /* GROUP                 @Y30LB25*/
         L     @06,COPYVPTR                                        1554
         OI    COPGROUP(@06),B'10000000'                           1554
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01553 L     @06,BASEVPTR                                        1555
         TM    BASGENUS(@06),B'00010000'                           1555
         BNO   @RF01555                                            1555
*     COPGENUS=ON;                  /* GENERAL-USE           @Y30LB25*/
         L     @06,COPYVPTR                                        1556
         OI    COPGENUS(@06),B'00100000'                           1556
*   ELSE                                                           1557
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         B     @RC01555                                            1557
@RF01555 L     @06,BASEVPTR                                        1557
         TM    BASRSTD(@06),B'00001000'                            1557
         BNO   @RF01557                                            1557
*       COPRSTD=ON;                 /* RESTRICTED            @Y30LB25*/
*                                                                  1558
         L     @06,COPYVPTR                                        1558
         OI    COPRSTD(@06),B'00010000'                            1558
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE ATTRIBUTES                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1559
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01557 DS    0H                                                  1559
@RC01555 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1559
         BNO   @RF01559                                            1559
*     COPEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/
         L     @06,COPYVPTR                                        1560
         OI    COPEXCL(@06),B'00000010'                            1560
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01559 TM    DEFVBIND(DEFVPTR),B'00000100'                       1561
         BNO   @RF01561                                            1561
*     COPBIND=ON;                   /* BIND                  @Y30LB25*/
         L     @06,COPYVPTR                                        1562
         OI    COPBIND(@06),B'00000100'                            1562
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01561 TM    DEFVWINH(DEFVPTR),B'00000010'                       1563
         BNO   @RF01563                                            1563
*     COPRONLY=ON;                  /* READ ONLY             @Y30LB25*/
         L     @06,COPYVPTR                                        1564
         OI    COPRONLY(@06),B'10000000'                           1564
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01563 TM    DEFVSEC(DEFVPTR),B'00100000'                        1565
         BNO   @RF01565                                            1565
*     COPDAERA=ON;                  /* DASD ERASE            @Y30LB25*/
*                                                                  1566
         L     @06,COPYVPTR                                        1566
         OI    COPDAERA(@06),B'00000001'                           1566
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RECOVERY AND IF SO USE THE DATE             @ZA13484*/
*   /* THE RPLV WAS CREATED.                                 @ZA13484*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1567
*   IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?       @ZA13484*/
@RF01565 L     @06,RPLVPTR                                         1567
         TM    RPLJRCVY(@06),B'00000010'                           1567
         BNO   @RF01567                                            1567
         CLC   RPLVDATE(4,@06),NULLDATE                            1567
         BE    @RF01567                                            1567
*     COPDATE=RPLVDATE;             /* DATE                  @ZA13484*/
         L     @01,COPYVPTR                                        1568
         MVC   COPDATE(4,@01),RPLVDATE(@06)                        1568
*   ELSE                                                           1569
*     DO;                           /*                       @ZA13484*/
*                                                                  1569
         B     @RC01567                                            1569
@RF01567 DS    0H                                                  1570
*       /*************************************************************/
*       /*                                                           */
*       /* GET AND SET THE CURRENT DATE                      @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1570
*       CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/* GET DATE    @ZA30662*/
         L     @15,@CV00768                                        1570
         LA    @01,@AL01570                                        1570
         BALR  @14,@15                                             1570
*       COPDATE=EXPRDT;             /* DATE COPY MADE        @Y30LB25*/
         L     @06,COPYVPTR                                        1571
         MVC   COPDATE(4,@06),EXPRDT                               1571
*     END;                          /*                       @ZA13484*/
*                                                                  1572
*   /*****************************************************************/
*   /*                                                               */
*   /* BLANK REMAINING FIELDS                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1573
*   COPDESCR=BLANK30;               /* BLANK DESCR           @Y30LB25*/
@RC01567 L     @06,COPYVPTR                                        1573
         MVI   COPDESCR+1(@06),C' '                                1573
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1573
         MVI   COPDESCR(@06),C' '                                  1573
*   COPDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/
         MVI   COPDTREM+1(@06),C' '                                1574
         MVC   COPDTREM+2(2,@06),COPDTREM+1(@06)                   1574
         MVI   COPDTREM(@06),C' '                                  1574
*   COPDEST=BLANK30;                /* DESTINATION           @Y30LB25*/
         MVI   COPDEST+1(@06),C' '                                 1575
         MVC   COPDEST+2(28,@06),COPDEST+1(@06)                    1575
         MVI   COPDEST(@06),C' '                                   1575
*   COPCSN1=BLANK12;                /* CSN1                  @Y30LB25*/
         MVC   COPCSN1(12,@06),@CC00689                            1576
*   COPCSN2=BLANK12;                /* CSN2                  @Y30LB25*/
*                                                                  1577
         MVC   COPCSN2(12,@06),@CC00689                            1577
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE CVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1578
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/
         L     @06,RPLVPTR                                         1578
         NI    RPLVUPD(@06),B'11111101'                            1578
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             1579
*   RPLVBUF=ADDR(COPYBUF);          /* SET BUF ADDR          @Y30LB25*/
         LA    @15,COPYBUF                                         1580
         ST    @15,RPLVBUF(,@06)                                   1580
*   RPLVRLN=LENGTH(COPYV);          /* CVR LENGTH            @Y30LB25*/
         MVC   RPLVRLN(4,@06),@CF01104                             1581
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1582
*   RETURN;                         /*                       @Y30LB25*/
@EL00037 DS    0H                                                  1583
@EF00037 DS    0H                                                  1583
@ER00037 L     @14,@SA00037                                        1583
         BR    @14                                                 1583
*   END CRTCVR1;                    /*                       @Y30LB25*/
         B     @EL00037                                            1584
*                                                                  1585
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CALCVRID                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CALCULATE A NEW COPY VOLUME RECORD ID.                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* COPY VOLUME RECORD ID                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1585
*CALCVRID:                                                         1585
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1585
CALCVRID ST    @14,@SA00038                                        1585
*   /*****************************************************************/
*   /*                                                               */
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1586
*   CVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/
         L     @06,BASEVPTR                                        1586
         MVC   CVOLKY(6),BASSERNO(@06)                             1586
*   CIDKY=FIXONE;                   /* SET CVR ID            @Y30LB25*/
         MVI   CIDKY,X'01'                                         1587
*   IF BASCOPNO=FIX255&BASNCOPY>FIXZERO/* ANY AVAIL CVR KEY? @Y30LB25*/
*     THEN                          /* NO                    @Y30LB25*/
         CLI   BASCOPNO(@06),255                                   1588
         BNE   @RF01588                                            1588
         CLI   BASNCOPY(@06),0                                     1588
         BNH   @RF01588                                            1588
*     DO;                           /*                       @Y30LB25*/
*                                                                  1589
*       /*************************************************************/
*       /*                                                           */
*       /* REORDER AND COMPRESS CVRS.                        @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1590
*       CALL REORDCVR;              /* PROCESS CVRS          @Y30LB25*/
         BAL   @14,REORDCVR                                        1590
*     END;                          /*                       @Y30LB25*/
*                                                                  1591
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE NEXT AVAILABLE CVR KEY FROM ITS BVR.    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1592
*   ELSE                                                           1592
*     DO;                           /*                       @Y30LB25*/
         B     @RC01588                                            1592
@RF01588 DS    0H                                                  1593
*       IF BASNCOPY>FIXZERO         /* CVR EXIST?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        1593
         CLI   BASNCOPY(@06),0                                     1593
         BNH   @RF01593                                            1593
*         BASCOPNO=BASCOPNO+FIXONE; /* INCREM KEY ID         @Y30LB25*/
         LA    @05,1                                               1594
         SLR   @15,@15                                             1594
         IC    @15,BASCOPNO(,@06)                                  1594
         ALR   @05,@15                                             1594
         STC   @05,BASCOPNO(,@06)                                  1594
*       ELSE                        /* NO                    @Y30LB25*/
*         BASCOPNO=FIXONE;          /* SET TO 1              @Y30LB25*/
         B     @RC01593                                            1595
@RF01593 L     @06,BASEVPTR                                        1595
         MVI   BASCOPNO(@06),X'01'                                 1595
*       CIDKY=BASCOPNO;             /* SET KEY ID            @Y30LB25*/
@RC01593 L     @06,BASEVPTR                                        1596
         IC    @05,BASCOPNO(,@06)                                  1596
         STC   @05,CIDKY                                           1596
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00038 DS    0H                                                  1598
@EF00038 DS    0H                                                  1598
@ER00038 L     @14,@SA00038                                        1598
         BR    @14                                                 1598
*   END CALCVRID;                   /*                       @Y30LB25*/
         B     @EL00038                                            1599
*                                                                  1600
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - REORDCVR                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* REORDER AND COMPRESS THE CHAIN OF CVRS.               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* ID NUMBER OF NEXT AVAILABLE COPY VOLUME               @Y30LB25*/
*   /* RECORD IN CIDKY                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1600
*REORDCVR:                                                         1600
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1600
REORDCVR ST    @14,@SA00039                                        1600
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP FOR READ OF CVR CHAIN                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1601
*   COPYVPTR=ADDR(BASEBUF1);        /* SET BUFF PTR          @Y30LB25*/
         LA    @06,BASEBUF1                                        1601
         ST    @06,COPYVPTR                                        1601
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         L     @05,RPLVPTR                                         1602
         OI    RPLVDIR(@05),B'01000000'                            1602
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/
         OI    RPLVUPD(@05),B'00000010'                            1603
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
*   RPLVKGE=ON;                     /* > OR =                @Y30LB25*/
         OI    RPLVKGE(@05),B'00000100'                            1605
         NI    RPLVLOC(@05),B'01111111'                            1605
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/
         LA    @15,CKEY                                            1606
         ST    @15,RPLVKEY(,@05)                                   1606
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         MVI   RPLVTYP(@05),X'00'                                  1607
*   RPLVBLN=LENGTH(BASEBUF1);       /* CVR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@05),@CF01103                             1608
*   RPLVBUF=ADDR(BASEBUF1);         /* CVR BUF ADDR          @Y30LB25*/
         ST    @06,RPLVBUF(,@05)                                   1609
*   A=FIXONE;                       /* FIRST READ            @Y30LB25*/
         MVC   A(4),@CF00046                                       1610
*   RESPECIFY                                                      1611
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@05                                             1612
*   DO WHILE CKY=COPV&COPSERNO=BASSERNO&RPLVRETC=FIXZERO;/*  @Y30LB25
*                                      READ CVR CHAIN        @Y30LB25*/
         B     @DE01613                                            1613
@DL01613 DS    0H                                                  1614
*     CALL ICBVIO00;                /* READ A CVR            @Y30LB25*/
*                                                                  1614
         L     @15,@CV00762                                        1614
         BALR  @14,@15                                             1614
*     /***************************************************************/
*     /*                                                             */
*     /* IF NOT THE SAME CVR, THEN DELETE THE ONE READ       @Y30LB25*/
*     /* AND WRITE THE NEW KEYED CVR                         @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1615
*     IF COPNO^=A                   /* SAME CVR?             @Y30LB25*/
*       THEN                        /* NO                    @Y30LB25*/
         L     @06,COPYVPTR                                        1615
         SLR   @05,@05                                             1615
         IC    @05,COPNO(,@06)                                     1615
         C     @05,A                                               1615
         BE    @RF01615                                            1615
*       DO;                         /*                       @Y30LB25*/
*         RPLVTYP=RPLVDEL;          /* DELETE                @Y30LB25*/
         L     @06,RPLVPTR                                         1617
         MVI   RPLVTYP(@06),X'05'                                  1617
*         CALL ICBVIO00;            /* DELETE THE CVR        @Y30LB25*/
         L     @15,@CV00762                                        1618
         BALR  @14,@15                                             1618
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1619
         LH    @05,RPLVRETC(,@06)                                  1619
         N     @05,@CF01129                                        1619
         LTR   @05,@05                                             1619
         BNZ   @RT01619                                            1619
*           RETURN;                 /*                       @Y30LB25*/
*         COPNO=A;                  /* SET NEW ID            @Y30LB25*/
         L     @05,A                                               1621
         L     @15,COPYVPTR                                        1621
         STC   @05,COPNO(,@15)                                     1621
*         RPLVUPD=OFF;              /* NEW RECORD            @Y30LB25*/
         NI    RPLVUPD(@06),B'11111101'                            1622
*         CALL ICBVIO00;            /* WRITE CVR             @Y30LB25*/
         L     @15,@CV00762                                        1623
         BALR  @14,@15                                             1623
*         RPLVDIR=ON;               /* RESET DIRECT          @Y30LB25*/
         L     @06,RPLVPTR                                         1624
         OI    RPLVDIR(@06),B'01000000'                            1624
*         RPLVTYP=RPLVREAD;         /* RESET RESD            @Y30LB25*/
         MVI   RPLVTYP(@06),X'00'                                  1625
*       END;                        /*                       @Y30LB25*/
*     A=A+FIXONE;                   /* NEXT CVR ID           @Y30LB25*/
@RF01615 LA    @06,1                                               1627
         AL    @06,A                                               1627
         ST    @06,A                                               1627
*     CIDKY=A;                      /* SET CVR ID            @Y30LB25*/
         STC   @06,CIDKY                                           1628
*     IF A=FIX256                   /* END?                  @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         C     @06,@CF00666                                        1629
         BNE   @RF01629                                            1629
*       DO;                         /*                       @Y30LB25*/
*         RPLVRETC=FIXFOUR;         /* ERROR RETURN CODE     @Y30LB25*/
         L     @06,RPLVPTR                                         1631
         MVC   RPLVRETC(2,@06),@CH00041                            1631
*         RPLRCODE=NOCVR;           /* ERROR REASON CODE     @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00703                            1632
*         RETURN;                   /*                       @Y30LB25*/
@EL00039 DS    0H                                                  1633
@EF00039 DS    0H                                                  1633
@ER00039 L     @14,@SA00039                                        1633
         BR    @14                                                 1633
*       END;                        /*                       @Y30LB25*/
*   END;                            /*                       @Y30LB25*/
@RF01629 DS    0H                                                  1635
@DE01613 L     @06,COPYVPTR                                        1635
         CLC   CKY(5),COPV(@06)                                    1635
         BNE   @DC01613                                            1635
         L     @05,BASEVPTR                                        1635
         CLC   COPSERNO(6,@06),BASSERNO(@05)                       1635
         BNE   @DC01613                                            1635
         L     @06,RPLVPTR                                         1635
         LH    @06,RPLVRETC(,@06)                                  1635
         N     @06,@CF01129                                        1635
         LTR   @06,@06                                             1635
         BZ    @DL01613                                            1635
@DC01613 DS    0H                                                  1636
*   RESPECIFY                                                      1636
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/
         L     @06,RPLVPTR                                         1637
         NI    RPLVKGE(@06),B'11111011'                            1637
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00039                                            1638
*   END REORDCVR;                   /*                       @Y30LB25*/
         B     @EL00039                                            1639
*                                                                  1640
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTBVR                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CREATE AND WRITE A BASE VOLUME RECORD FROM A PLACE    @Y30LB25*/
*   /* HOLDER BVR CREATED BEFORE THE MSC WAS CALLED.         @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* PLACE HOLDER BASE VOLUME RECORD IN BASEBUF            @Y30LB25*/
*   /* CSNS SETUP IN BASEBUF FOR RENAME                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1640
*CRTBVR:                                                           1640
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1640
CRTBVR   ST    @14,@SA00040                                        1640
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE BVR.                                   @Y30LB25*/
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/
*   /* USED BY CREATE AN INACTIVE VOLUME                     @Y30LB25*/
*   /* AFTER THE MAS WAS CALLED.                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1641
*   BASHOLD=OFF;                    /* NO PLACE HOLD         @Y30LB25*/
         L     @06,BASEVPTR                                        1641
         NI    BASHOLD(@06),B'01111111'                            1641
*   BASDLSF=ON;                     /* SET DOWN LEV SPC      @Y30LB25*/
         OI    BASDLSF(@06),B'10000000'                            1642
*   BASLIB1=DEFVLIB;                /* LIB1 ID               @Y30LB25*/
         IC    @15,DEFVLIB(,DEFVPTR)                               1643
         STC   @15,BASLIB1(,@06)                                   1643
*   BASLIB2=DEFVLIB;                /* LIB2 ID               @Y30LB25*/
         IC    @15,DEFVLIB(,DEFVPTR)                               1644
         STC   @15,BASLIB2(,@06)                                   1644
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/
         OI    BASINAC(@06),B'00000100'                            1645
*   BASPREV=BLANK6;                 /* PREV PTR              @Y30LB25*/
         MVI   BASPREV+1(@06),C' '                                 1646
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     1646
         MVI   BASPREV(@06),C' '                                   1646
*   BASNEXTV=BLANK6;                /* NEXT PTR              @Y30LB25*/
         MVI   BASNEXTV+1(@06),C' '                                1647
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   1647
         MVI   BASNEXTV(@06),C' '                                  1647
*   BASKLCPY=BLANK13;               /* LASTEST COPY          @Y30LB25*/
         MVC   BASKLCPY(13,@06),@CC00692                           1648
*   BASDLMTD=BLANK4;                /* LAST MNT DATE         @Y30LB25*/
         MVI   BASDLMTD+1(@06),C' '                                1649
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   1649
         MVI   BASDLMTD(@06),C' '                                  1649
*   BASEXPDT=FIX4FS;                /* EXPIR DATE            @Y30LB25*/
         MVC   BASEXPDT(4,@06),@CB00677                            1650
*   BASDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/
         MVI   BASDTREM+1(@06),C' '                                1651
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   1651
         MVI   BASDTREM(@06),C' '                                  1651
*   BASDESCR=BLANK30;               /* DESCRIPTION           @Y30LB25*/
         MVI   BASDESCR+1(@06),C' '                                1652
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1652
         MVI   BASDESCR(@06),C' '                                  1652
*   BASDEST=BLANK30;                /* DESTINATION           @Y30LB25*/
         MVI   BASDEST+1(@06),C' '                                 1653
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    1653
         MVI   BASDEST(@06),C' '                                   1653
*   BASRECOV=BLANK6;                /* SER #                 @Y30LB25*/
         MVI   BASRECOV+1(@06),C' '                                1654
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   1654
         MVI   BASRECOV(@06),C' '                                  1654
*   BASGROUP=BLANK8;                /* GROUP                 @Y30LB25*/
         MVI   BASGROUP+1(@06),C' '                                1655
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1655
         MVI   BASGROUP(@06),C' '                                  1655
*   BASLEXT=FIX2FS;                 /* LARGE EXTENT          @Y30LB25*/
         L     @15,@CF00672                                        1656
         STH   @15,BASLEXT(,@06)                                   1656
*   BASFRESP=FIX2FS;                /* FREE SPACE            @Y30LB25*/
         STH   @15,BASFRESP(,@06)                                  1657
*   BASFREXT=FIX4FS;                /* FREE EXTENTS          @Y30LB25*/
         MVC   BASFREXT(4,@06),@CF00677                            1658
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/
         MVI   BASBKLMT(@06),X'01'                                 1659
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1660
         BE    @RF01660                                            1660
*     BASOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  1661
*   ELSE                            /* NO                    @Y30LB25*/
*     BASOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/
*                                                                  1662
         B     @RC01660                                            1662
@RF01660 L     @06,BASEVPTR                                        1662
         MVI   BASOWNER+1(@06),C' '                                1662
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   1662
         MVI   BASOWNER(@06),C' '                                  1662
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE ATTRIBUTES                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1663
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01660 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1663
         BNO   @RF01663                                            1663
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/
         L     @06,BASEVPTR                                        1664
         OI    BASEXCL(@06),B'00000001'                            1664
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01663 TM    DEFVBIND(DEFVPTR),B'00000100'                       1665
         BNO   @RF01665                                            1665
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/
         L     @06,BASEVPTR                                        1666
         OI    BASBIND(@06),B'00000010'                            1666
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01665 TM    DEFVWINH(DEFVPTR),B'00000010'                       1667
         BNO   @RF01667                                            1667
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/
         L     @06,BASEVPTR                                        1668
         OI    BASRONLY(@06),B'01000000'                           1668
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01667 TM    DEFVSEC(DEFVPTR),B'00100000'                        1669
         BNO   @RF01669                                            1669
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/
*                                                                  1670
         L     @06,BASEVPTR                                        1670
         OI    BASDAERA(@06),B'10000000'                           1670
*   /*****************************************************************/
*   /*                                                               */
*   /* CHAIN BVR INTO NON-GROUP VOLUME RECORD                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1671
*   GRPFLG=OFF;                     /* NGVR                  @Y30LB25*/
@RF01669 NI    GRPFLG,B'11101111'                                  1671
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/
         BAL   @14,VUCHI                                           1672
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1673
         LH    @06,RPLVRETC(,@06)                                  1673
         N     @06,@CF01129                                        1673
         LTR   @06,@06                                             1673
         BNZ   @RT01673                                            1673
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1674
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE DEFINEV EXTENSION.                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1675
*   BCDVPTR=BASEVPTR;               /* SET COMM PTR          @Y30LB25*/
         L     @06,BASEVPTR                                        1675
         ST    @06,BCDVPTR                                         1675
*   IF DEFVVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/
*     THEN                                                         1676
         L     @06,DEFVVEXT(,DEFVPTR)                              1676
         LTR   @06,@06                                             1676
         BZ    @RF01676                                            1676
*     DO;                           /* YES                   @Y30LB25*/
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/
         BAL   @14,PRODEFVE                                        1678
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1679
         LH    @06,RPLVRETC(,@06)                                  1679
         N     @06,@CF01129                                        1679
         LTR   @06,@06                                             1679
         BNZ   @RT01679                                            1679
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   ELSE                                                           1682
*     BCDIVCRE=ON;                  /*                       @Y30LB25*/
*                                                                  1682
         B     @RC01676                                            1682
@RF01676 L     @06,BCDVPTR                                         1682
         OI    BCDIVCRE(@06),B'10000000'                           1682
*   /*****************************************************************/
*   /*                                                               */
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1683
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
@RC01676 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1683
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1684
         L     @01,RPLVPTR                                         1684
         ST    @06,RPLVKEY(,@01)                                   1684
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1685
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1686
         LH    @15,RPLVRETC(,@06)                                  1686
         N     @15,@CF01129                                        1686
         LTR   @15,@15                                             1686
         BNZ   @RT01686                                            1686
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1687
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE BVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1688
*   RPLVBUF=ADDR(BASEBUF);          /* PT TO BVR TO WRITE    @Y30LB25*/
         LA    @15,BASEBUF                                         1688
         ST    @15,RPLVBUF(,@06)                                   1688
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1689
*   RETURN;                         /*                       @Y30LB25*/
@EL00040 DS    0H                                                  1690
@EF00040 DS    0H                                                  1690
@ER00040 L     @14,@SA00040                                        1690
         BR    @14                                                 1690
*   END CRTBVR;                     /*                       @Y30LB25*/
         B     @EL00040                                            1691
*                                                                  1692
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTCVR2                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* MAKE A PLACE HOLDER CVR INTO A CVR AFTER THE MSC.     @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* PLACE HOLDER COPY VOLUME RECORD                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* COPY VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1692
*CRTCVR2:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1692
CRTCVR2  ST    @14,@SA00041                                        1692
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE DEFINE EXTENSION                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1693
*   BCDVPTR=COPYVPTR;               /* SET COMM PTR          @Y30LB25*/
         L     @06,COPYVPTR                                        1693
         ST    @06,BCDVPTR                                         1693
*   COPHOLD=OFF;                    /*                       @Y30LB25*/
         NI    COPHOLD(@06),B'01111111'                            1694
*   IF DEFVVEXT^=FIXZERO            /* DEFINE EXTENSION?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,DEFVVEXT(,DEFVPTR)                              1695
         LTR   @06,@06                                             1695
         BZ    @RF01695                                            1695
*     DO;                           /*                       @Y30LB25*/
*       CALL PRODEFVE;              /* PROC DEFVE            @Y30LB25*/
         BAL   @14,PRODEFVE                                        1697
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1698
         LH    @06,RPLVRETC(,@06)                                  1698
         N     @06,@CF01129                                        1698
         LTR   @06,@06                                             1698
         BNZ   @RT01698                                            1698
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   ELSE                                                           1701
*     BCDIVCPY=ON;                  /*                       @Y30LB25*/
*                                                                  1701
         B     @RC01695                                            1701
@RF01695 L     @06,BCDVPTR                                         1701
         OI    BCDIVCPY(@06),B'01000000'                           1701
*   /*****************************************************************/
*   /*                                                               */
*   /* REESTABLISH THE CVR'S RPLV                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1702
*   CKEY=COPNAME;                   /* SET KEY               @Y30LB25*/
@RC01695 L     @06,COPYVPTR                                        1702
         MVC   CKEY(13),COPNAME(@06)                               1702
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/
         LA    @06,CKEY                                            1703
         L     @01,RPLVPTR                                         1703
         ST    @06,RPLVKEY(,@01)                                   1703
*   CALL READUPD1;                  /* READ CVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1704
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1705
         LH    @15,RPLVRETC(,@06)                                  1705
         N     @15,@CF01129                                        1705
         LTR   @15,@15                                             1705
         BNZ   @RT01705                                            1705
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1706
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE CVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1707
*   RPLVBUF=COPYVPTR;               /*                       @Y30LB25*/
         L     @15,COPYVPTR                                        1707
         ST    @15,RPLVBUF(,@06)                                   1707
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1708
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1709
         LH    @06,RPLVRETC(,@06)                                  1709
         N     @06,@CF01129                                        1709
         LTR   @06,@06                                             1709
         BNZ   @RT01709                                            1709
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1710
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE CVR'S BVR.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1711
*   ADDSUB=ON;                      /* ADD A CVR             @Y30LB25*/
         OI    ADDSUB,B'01000000'                                  1711
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @Y30LB25
*                                      UPDT CVR'S BVR        @Y30LB25*/
         L     @15,@CV00769                                        1712
         LA    @01,@AL01712                                        1712
         BALR  @14,@15                                             1712
*   RETURN;                         /*                       @Y30LB25*/
@EL00041 DS    0H                                                  1713
@EF00041 DS    0H                                                  1713
@ER00041 L     @14,@SA00041                                        1713
         BR    @14                                                 1713
*   END CRTCVR2;                    /*                       @Y30LB25*/
         B     @EL00041                                            1714
*                                                                  1715
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - FNDCVRUP                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* FIND THE PLACE HOLDER CVR CREATED BEFORE THE          @Y30LB25*/
*   /* MSC WAS CALLED.                                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1715
*FNDCVRUP:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1715
FNDCVRUP ST    @14,@SA00042                                        1715
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND THE PLACE HOLDER CVR                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1716
*   CVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
         MVC   CVOLKY(6),DEFVOLD(DEFVPTR)                          1716
*   CIDKY=FIXONE;                   /* ID = 1                @Y30LB25*/
         LA    @06,1                                               1717
         STC   @06,CIDKY                                           1717
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/
         L     @15,RPLVPTR                                         1718
         LA    @14,CKEY                                            1718
         ST    @14,RPLVKEY(,@15)                                   1718
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUFFER            @Y30LB25*/
         LA    @14,COPYBUF                                         1719
         ST    @14,RPLVBUF(,@15)                                   1719
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@15),@CF01103                             1720
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         MVI   RPLVTYP(@15),X'00'                                  1721
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         OI    RPLVDIR(@15),B'01000000'                            1722
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/
         OI    RPLVUPD(@15),B'00000010'                            1723
*   A=CIDKY;                        /* LOOP CONTROL          @Y30LB25*/
         ST    @06,A                                               1724
*   DO CIDKY=A BY 1 TO 255;         /* FIND CVR              @Y30LB25*/
         STC   @06,CIDKY                                           1725
         B     @DE01725                                            1725
@DL01725 DS    0H                                                  1726
*     RESPECIFY                                                    1726
*       RG1 RSTD;                   /* RESTRICT REG 1        @Y30LB25*/
*     RG1=RPLVPTR;                  /* PT TO RPLV            @Y30LB25*/
         L     RG1,RPLVPTR                                         1727
*     CALL ICBVIO00;                /* READ CVR              @Y30LB25*/
         L     @15,@CV00762                                        1728
         BALR  @14,@15                                             1728
*     RESPECIFY                                                    1729
*       RG1 UNRSTD;                 /* UNRESTRICT REG 1      @Y30LB25*/
*                                                                  1729
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR PLACE HOLDER CVR OR AN I/0 ERROR          @Y30LB25*/
*     /* OR END OF DATA.                                     @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1730
*     IF(RPLVRETC^=FIXZERO&RPLRCODE^=NORECFND)×(RPLVRETC=FIXZERO&  1730
*         COPHOLD=ON)               /* CHECK VALID RETURN    @Y30LB25*/
*       THEN                                                       1730
         L     @06,RPLVPTR                                         1730
         LH    @15,RPLVRETC(,@06)                                  1730
         N     @15,@CF01129                                        1730
         LTR   @15,@15                                             1730
         BZ    @GL00078                                            1730
         CLC   RPLRCODE(2,@06),@CB00711                            1730
         BNE   @RT01730                                            1730
@GL00078 L     @06,RPLVPTR                                         1730
         LH    @06,RPLVRETC(,@06)                                  1730
         N     @06,@CF01129                                        1730
         LTR   @06,@06                                             1730
         BNZ   @RF01730                                            1730
         L     @06,COPYVPTR                                        1730
         TM    COPHOLD(@06),B'10000000'                            1730
         BO    @RT01730                                            1730
*       RETURN;                     /*                       @Y30LB25*/
*   END;                            /*                       @Y30LB25*/
*                                                                  1732
@RF01730 LA    @06,1                                               1732
         SLR   @15,@15                                             1732
         IC    @15,CIDKY                                           1732
         ALR   @06,@15                                             1732
         STC   @06,CIDKY                                           1732
@DE01725 C     @06,@CF00668                                        1732
         BNH   @DL01725                                            1732
*   /*****************************************************************/
*   /*                                                               */
*   /* NO CVR PLACE HOLDER WAS FOUND                         @Y30LB25*/
*   /* OCCURRED                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1733
*   RPLVRETC=FIXFOUR;               /* ERROR RETURN CODE     @Y30LB25*/
         L     @06,RPLVPTR                                         1733
         MVC   RPLVRETC(2,@06),@CH00041                            1733
*   RPLRCODE=NORECFND;              /* ERROR REASON CODE     @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00711                            1734
*   RETURN;                         /*                       @Y30LB25*/
@EL00042 DS    0H                                                  1735
@EF00042 DS    0H                                                  1735
@ER00042 L     @14,@SA00042                                        1735
         BR    @14                                                 1735
*   END FNDCVRUP;                   /*                       @Y30LB25*/
         B     @EL00042                                            1736
*                                                                  1737
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ACINACV2                             #Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* TRANSFER DATA FROM AN ACTIVE TO AN INACTIVE VOLUME    @Y30LB25*/
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/
*   /* AN ICBCOVC EXTENSION IS REQUIRED.                     @Y30LB25*/
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1737
*ACINACV2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
ACINACV2 ST    @14,@SA00043                                        1737
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1738
         LH    @15,RPLRCODE(,@06)                                  1738
         N     @15,@CF01129                                        1738
         LTR   @15,@15                                             1738
         BZ    @RF01738                                            1738
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1740
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1741
*       RETURN;                     /*                       @Y30LB25*/
@EL00043 DS    0H                                                  1742
@EF00043 DS    0H                                                  1742
@ER00043 L     @14,@SA00043                                        1742
         BR    @14                                                 1742
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
*                                                                  1744
@RF01738 BAL   @14,HOUSKEEP                                        1744
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET THE MSVC RECORD.                  @Y30LB25*/
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/
*   /* FOR UPDATE                                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1745
*   IVOLKY=CVOLCSN;                 /* SET UP KEY            @Y30LB25*/
         L     @06,CVOLPTR                                         1745
         MVC   IVOLKY(12),CVOLCSN(@06)                             1745
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECUD                                        1746
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1747
         LH    @06,RPLVRETC(,@06)                                  1747
         N     @06,@CF01129                                        1747
         LTR   @06,@06                                             1747
         BNZ   @RT01747                                            1747
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1748
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF A COPY VOLUME RECORD WAS CREATED BY A        @Y30LB25*/
*   /* PREVIOUS CREATE AN INACTIVE VOLUME REQUEST.           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1749
*   IF CVOLVEXT^=FIXZERO&COVREUSE=OFF/* DON'T REUSE OLD      @Y30LB25
*                                      CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,CVOLPTR                                         1749
         L     @06,CVOLVEXT(,@06)                                  1749
         LTR   @06,@06                                             1749
         BZ    @RF01749                                            1749
         L     @06,COVCEPTR                                        1749
         TM    COVREUSE(@06),B'01000000'                           1749
         BNZ   @RF01749                                            1749
*     DO;                           /*                       @Y30LB25*/
*       COPYBUF=BASEBUF;            /* PLACE CVR IN BUF      @Y30LB25*/
         MVC   COPYBUF(224),BASEBUF                                1751
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            @Y30LB25*/
         L     @06,COPYVPTR                                        1752
         ST    @06,BCDVPTR                                         1752
*       CALL PROCOVCE;              /* PROCESS COVC EXTEN    @Y30LB25*/
         BAL   @14,PROCOVCE                                        1753
*       BVOLKY=COPSERNO;            /* SERIAL NUMBER         @ZDR2054*/
         L     @06,COPYVPTR                                        1754
         MVC   BVOLKY(6),COPSERNO(@06)                             1754
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/
         LA    @06,BKEY                                            1755
         L     @01,RPLVPTR                                         1755
         ST    @06,RPLVKEY(,@01)                                   1755
*       CALL READLOC;               /* READ BVR              @ZDR2054*/
         BAL   @14,READLOC                                         1756
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/
         L     @06,RPLVPTR                                         1757
         LH    @15,RPLVRETC(,@06)                                  1757
         N     @15,@CF01129                                        1757
         LTR   @15,@15                                             1757
         BNZ   @RT01757                                            1757
*         RETURN;                   /* YES                   @ZDR2054*/
*       BASEVPTR=RPLVBUF;           /* SET BUF PTR           @ZDR2054*/
         L     @06,RPLVBUF(,@06)                                   1759
         ST    @06,BASEVPTR                                        1759
*       COPFRESP=BASFRESP;          /* # FREE CYLANDERS      @ZDR2054*/
         L     @15,COPYVPTR                                        1760
         LH    @14,BASFRESP(,@06)                                  1760
         N     @14,@CF01129                                        1760
         STH   @14,COPFRESP(,@15)                                  1760
*       COPLEXT=BASLEXT;            /* # CYL IN LARGEST      @ZDR2054
*                                      FREE EXTENT           @ZDR2054*/
         LH    @14,BASLEXT(,@06)                                   1761
         N     @14,@CF01129                                        1761
         STH   @14,COPLEXT(,@15)                                   1761
*       COPFREXT=BASFREXT;          /* # FREE EXTENTS        @ZDR2054*/
         L     @14,BASFREXT(,@06)                                  1762
         ST    @14,COPFREXT(,@15)                                  1762
*       IF BASDLSF=ON THEN          /* DOWN LEVEL SPACE?     @ZDR2054*/
         TM    BASDLSF(@06),B'10000000'                            1763
         BNO   @RF01763                                            1763
*         COPDLSPF=ON;              /* YES                   @ZDR2054*/
         OI    COPDLSPF(@15),B'01000000'                           1764
*       IVOLKY=CVOLCSN;             /* GET CVR               @ZDR2054*/
@RF01763 L     @06,CVOLPTR                                         1765
         MVC   IVOLKY(12),CVOLCSN(@06)                             1765
*       CALL GETRECUD;              /* READ UPDATE           @ZDR2054*/
         BAL   @14,GETRECUD                                        1766
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/
         L     @06,RPLVPTR                                         1767
         LH    @15,RPLVRETC(,@06)                                  1767
         N     @15,@CF01129                                        1767
         LTR   @15,@15                                             1767
         BNZ   @RT01767                                            1767
*         RETURN;                   /* YES                   @ZDR2054*/
*       RPLVBUF=ADDR(COPYBUF);      /* SET CVR BUF PTR       @Y30LB25*/
         LA    @15,COPYBUF                                         1769
         ST    @15,RPLVBUF(,@06)                                   1769
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1770
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00043                                            1771
*     END;                          /*                       @Y30LB25*/
*                                                                  1772
*   /*****************************************************************/
*   /*                                                               */
*   /* NO COPY VOLUME RECORD WAS PREVIOUSLY CREATED.         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1773
*   ELSE                            /* REUSE OLD CVR         @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
@RF01749 DS    0H                                                  1774
*       RPLVTYP=RPLVDEL;            /* DELETE OLD CVR        @Y30LB25*/
         L     @06,RPLVPTR                                         1774
         MVI   RPLVTYP(@06),X'05'                                  1774
*       RESPECIFY                                                  1775
*         RG1 RSTD;                 /*                       @Y30LB25*/
*       RG1=RPLVPTR;                /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@06                                             1776
*       CALL ICBVIO00;              /* DELETE CVR            @Y30LB25*/
         L     @15,@CV00762                                        1777
         BALR  @14,@15                                             1777
*       RESPECIFY                                                  1778
*         RG1 UNRSTD;               /*                       @Y30LB25*/
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1779
         LH    @06,RPLVRETC(,@06)                                  1779
         N     @06,@CF01129                                        1779
         LTR   @06,@06                                             1779
         BNZ   @RT01779                                            1779
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1780
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE CVR'S BVR TO REFLECT ITS DELETION.         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1781
*       ADDSUB=OFF;                 /* CVR DELETED           @Y30LB25*/
         NI    ADDSUB,B'10111111'                                  1781
*       COPYBUF=BASEBUF;            /* CVR IN CVR BUF        @Y30LB25*/
         MVC   COPYBUF(224),BASEBUF                                1782
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25
*                                      UPDATE BVR            @Y30LB25*/
         L     @15,@CV00769                                        1783
         LA    @01,@AL01783                                        1783
         BALR  @14,@15                                             1783
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1784
         LH    @15,RPLVRETC(,@06)                                  1784
         N     @15,@CF01129                                        1784
         LTR   @15,@15                                             1784
         BNZ   @RT01784                                            1784
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1785
*       /*************************************************************/
*       /*                                                           */
*       /* GET CVR'S BVR FOR KEY OF NEXT AVAILABLE CVR       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1786
*       BVOLKY=COPSERNO;            /* BVR VOLID KEY         @Y30LB25*/
         L     @01,COPYVPTR                                        1786
         MVC   BVOLKY(6),COPSERNO(@01)                             1786
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @Y30LB25*/
         LA    @15,BKEY                                            1787
         ST    @15,RPLVKEY(,@06)                                   1787
*       CALL READLOC;               /* GET BVR               @Y30LB25*/
         BAL   @14,READLOC                                         1788
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1789
         LH    @15,RPLVRETC(,@06)                                  1789
         N     @15,@CF01129                                        1789
         LTR   @15,@15                                             1789
         BNZ   @RT01789                                            1789
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/
*                                                                  1791
         L     @06,RPLVBUF(,@06)                                   1791
         ST    @06,BASEVPTR                                        1791
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE THE KEY FOR THE NEXT CVR.               @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1792
*       CALL CALCVRID;              /* GET ID                @Y30LB25*/
         BAL   @14,CALCVRID                                        1792
*       IF RPLVRETC^=FIXZERO&RPLRCODE^=NORECFND/*            @Y30LB25
*                                      ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1793
         LH    @15,RPLVRETC(,@06)                                  1793
         N     @15,@CF01129                                        1793
         LTR   @15,@15                                             1793
         BZ    @RF01793                                            1793
         CLC   RPLRCODE(2,@06),@CB00711                            1793
         BNE   @RT01793                                            1793
*         RETURN;                   /*                       @Y30LB25*/
*       COPYVPTR=ADDR(COPYBUF);     /* RESET BUF PTR         @Y30LB25*/
*                                                                  1795
@RF01793 LA    @06,COPYBUF                                         1795
         ST    @06,COPYVPTR                                        1795
*       /*************************************************************/
*       /*                                                           */
*       /* USE CVR IN THE CVR BUFFER TO CREATE               @Y30LB25*/
*       /* THE NEW CVR.                                      @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1796
*       COPNO=CIDKY;                /* SET NEW ID            @Y30LB25*/
         IC    @15,CIDKY                                           1796
         STC   @15,COPNO(,@06)                                     1796
*       COPBKUP=OFF;                /* NO BACKUP             @Y30LB25*/
         NI    COPBKUP(@06),B'11110111'                            1797
*       COPDESCR=BLANK30;           /* NULL DESCR            @Y30LB25*/
*                                                                  1798
         MVI   COPDESCR+1(@06),C' '                                1798
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1798
         MVI   COPDESCR(@06),C' '                                  1798
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RECOVERY AND IF SO USE THE DATE         @ZA13484*/
*       /* THE RPLV WAS CREATED.                             @ZA13484*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1799
*       IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?   @ZA13484*/
         L     @15,RPLVPTR                                         1799
         TM    RPLJRCVY(@15),B'00000010'                           1799
         BNO   @RF01799                                            1799
         CLC   RPLVDATE(4,@15),NULLDATE                            1799
         BE    @RF01799                                            1799
*         COPDATE=RPLVDATE;         /* DATE                  @ZA13484*/
         MVC   COPDATE(4,@06),RPLVDATE(@15)                        1800
*       ELSE                                                       1801
*         DO;                       /*                       @ZA13484*/
*                                                                  1801
         B     @RC01799                                            1801
@RF01799 DS    0H                                                  1802
*           /*********************************************************/
*           /*                                                       */
*           /* GET AN SET CURRENT DATE                       @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1802
*           CALL ICBVUEXP(FIXZERO,RPLVPRT,EXPRDT);/*         @ZA30662*/
         L     @15,@CV00768                                        1802
         LA    @01,@AL01802                                        1802
         BALR  @14,@15                                             1802
*           COPDATE=EXPRDT;         /* SET CURRENT DATE      @Y30LB25*/
         L     @06,COPYVPTR                                        1803
         MVC   COPDATE(4,@06),EXPRDT                               1803
*         END;                      /*                       @ZA13484*/
*                                                                  1804
*       /*************************************************************/
*       /*                                                           */
*       /* SET GROUPED OR NON-GROUPED                        @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1805
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01799 L     @06,BASEVPTR                                        1805
         TM    BASGRPV(@06),B'00100000'                            1805
         BNO   @RF01805                                            1805
*         COPGROUP=ON;              /* GROUPED               @Y30LB25*/
         L     @06,COPYVPTR                                        1806
         OI    COPGROUP(@06),B'10000000'                           1806
*       ELSE                        /* NON-GRPD              @Y30LB25*/
*         COPGROUP=OFF;             /*                       @Y30LB25*/
*                                                                  1807
         B     @RC01805                                            1807
@RF01805 L     @06,COPYVPTR                                        1807
         NI    COPGROUP(@06),B'01111111'                           1807
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1808
*       IF BASGENUS=ON              /* GEN-USE               @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01805 L     @06,BASEVPTR                                        1808
         TM    BASGENUS(@06),B'00010000'                           1808
         BNO   @RF01808                                            1808
*         COPGENUS=ON;              /*                       @Y30LB25*/
         L     @06,COPYVPTR                                        1809
         OI    COPGENUS(@06),B'00100000'                           1809
*       ELSE                        /* NO GEN-USE            @Y30LB25*/
*         COPGENUS=OFF;             /*                       @Y30LB25*/
*                                                                  1810
         B     @RC01808                                            1810
@RF01808 L     @06,COPYVPTR                                        1810
         NI    COPGENUS(@06),B'11011111'                           1810
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1811
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01808 L     @06,BASEVPTR                                        1811
         TM    BASRSTD(@06),B'00001000'                            1811
         BNO   @RF01811                                            1811
*         COPRSTD=ON;               /* RESTRICTED            @Y30LB25*/
         L     @06,COPYVPTR                                        1812
         OI    COPRSTD(@06),B'00010000'                            1812
*       ELSE                        /* NOT RESTRICTED        @Y30LB25*/
*         COPRSTD=OFF;              /*                       @Y30LB25*/
*                                                                  1813
         B     @RC01811                                            1813
@RF01811 L     @06,COPYVPTR                                        1813
         NI    COPRSTD(@06),B'11101111'                            1813
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR DOWN LEVEL SPACE                        @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1814
*       IF BASDLSF=ON               /* DOWN LEVEL SPACE?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01811 L     @06,BASEVPTR                                        1814
         TM    BASDLSF(@06),B'10000000'                            1814
         BNO   @RF01814                                            1814
*         COPDLSPF=ON;              /* DOWN LEVEL SPACE      @Y30LB25*/
         L     @06,COPYVPTR                                        1815
         OI    COPDLSPF(@06),B'01000000'                           1815
*       ELSE                        /* NO DOWN SPACE         @Y30LB25*/
*         COPDLSPF=OFF;             /*                       @Y30LB25*/
*                                                                  1816
         B     @RC01814                                            1816
@RF01814 L     @06,COPYVPTR                                        1816
         NI    COPDLSPF(@06),B'10111111'                           1816
*       /*************************************************************/
*       /*                                                           */
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1817
*       COPFRESP=BASFRESP;          /* FREE SPACE            @Y30LB25*/
@RC01814 L     @06,COPYVPTR                                        1817
         L     @15,BASEVPTR                                        1817
         LH    @14,BASFRESP(,@15)                                  1817
         N     @14,@CF01129                                        1817
         STH   @14,COPFRESP(,@06)                                  1817
*       COPLEXT=BASLEXT;            /* LARGEST FREE EXTNT    @Y30LB25*/
         LH    @14,BASLEXT(,@15)                                   1818
         N     @14,@CF01129                                        1818
         STH   @14,COPLEXT(,@06)                                   1818
*       COPFREXT=BASFREXT;          /* FREE EXTENTS          @Y30LB25*/
*                                                                  1819
         L     @15,BASFREXT(,@15)                                  1819
         ST    @15,COPFREXT(,@06)                                  1819
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS THE EXTENSION.                            @Y30LB25*/
*       /* NOT REQUIRED FOR RECOVERY.                        @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1820
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            #Y30LB25*/
         ST    @06,BCDVPTR                                         1820
*       IF CVOLVEXT^=FIXZERO        /* EXTENSION?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,CVOLPTR                                         1821
         L     @06,CVOLVEXT(,@06)                                  1821
         LTR   @06,@06                                             1821
         BZ    @RF01821                                            1821
*         CALL PROCOVCE;            /* PROCESS COVC EXTEN    @Y30LB25*/
*                                                                  1822
         BAL   @14,PROCOVCE                                        1822
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE NEW CVR                                 @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1823
*       RPLVBUF=ADDR(COPYBUF);      /* CVR BUF               @Y30LB25*/
@RF01821 L     @06,RPLVPTR                                         1823
         LA    @15,COPYBUF                                         1823
         ST    @15,RPLVBUF(,@06)                                   1823
*       RPLVBLN=LENGTH(COPYBUF);    /* CVR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             1824
*       RPLVRLN=LENGTH(COPYV);      /* CVR LENGTH            @Y30LB25*/
         MVC   RPLVRLN(4,@06),@CF01104                             1825
*       RPLVUPD=OFF;                /* NEW RECORD            @Y30LB25*/
         NI    RPLVUPD(@06),B'11111101'                            1826
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1827
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1828
         LH    @06,RPLVRETC(,@06)                                  1828
         N     @06,@CF01129                                        1828
         LTR   @06,@06                                             1828
         BNZ   @RT01828                                            1828
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1829
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE CVR'S BVR TO REFLECT THE NEW CVR       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1830
*       ADDSUB=ON;                  /* ADD CVR               @Y30LB25*/
         OI    ADDSUB,B'01000000'                                  1830
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25*/
         L     @15,@CV00769                                        1831
         LA    @01,@AL01831                                        1831
         BALR  @14,@15                                             1831
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1832
         LH    @06,RPLVRETC(,@06)                                  1832
         N     @06,@CF01129                                        1832
         LTR   @06,@06                                             1832
         BNZ   @RT01832                                            1832
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1833
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE CIRS TO POINT TO THE NEW CVR           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1834
*       CALL UPDCIR;                /* CORRECT CIRS          @Y30LB25*/
         BAL   @14,UPDCIR                                          1834
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00043                                            1835
*     END;                          /*                       @Y30LB25*/
*   END ACINACV2;                   /*                       @Y30LB25*/
         B     @EL00043                                            1837
*                                                                  1838
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCOVCE                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS IEZCOVCE.                                     @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1838
*PROCOVCE:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
PROCOVCE ST    @14,@SA00044                                        1838
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         1839
         TM    BCDBASE(@06),B'00100000'                            1839
         BNO   @RF01839                                            1839
*     IF COVSPDES=ON                /* DESCRIP GIVEN?        @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         L     @06,COVCEPTR                                        1840
         TM    COVSPDES(@06),B'10000000'                           1840
         BNO   @RF01840                                            1840
*       BASDESCR=COVDESCR;          /* UPDATE DESCR          @Y30LB25*/
         L     @01,BASEVPTR                                        1841
         MVC   BASDESCR(30,@01),COVDESCR(@06)                      1841
*     ELSE                                                         1842
*       ;                           /*                       @Y30LB25*/
@RF01840 DS    0H                                                  1843
*   ELSE                            /* CVR                   @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
         B     @RC01839                                            1843
@RF01839 DS    0H                                                  1844
*       IF COVSPDES=ON              /* DESCRIP GIVEN?        @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,COVCEPTR                                        1844
         TM    COVSPDES(@06),B'10000000'                           1844
         BNO   @RF01844                                            1844
*         COPDESCR=COVDESCR;        /* UPDATE DESCR          @Y30LB25*/
         L     @01,COPYVPTR                                        1845
         MVC   COPDESCR(30,@01),COVDESCR(@06)                      1845
*       IF COVSAM=ON                /* VSAM VOL?             @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF01844 L     @06,COVCEPTR                                        1846
         TM    COVSAM(@06),B'10000000'                             1846
         BNO   @RF01846                                            1846
*         COPVSAM=ON;               /* VSAM VOL              @Y30LB25*/
         L     @06,COPYVPTR                                        1847
         OI    COPVSAM(@06),B'01000000'                            1847
*     END;                          /*                       @Y30LB25*/
*                                                                  1848
@RF01846 DS    0H                                                  1849
*   /*****************************************************************/
*   /*                                                               */
*   /* SET AND/OR CLEAR ERROR RECOVERY FLAGS.                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1849
*   CALL SETCLRCV;                  /* PROC FLAGS            @Y30LB25*/
@RC01839 BAL   @14,SETCLRCV                                        1849
*   RETURN;                         /*                       @Y30LB25*/
@EL00044 DS    0H                                                  1850
@EF00044 DS    0H                                                  1850
@ER00044 L     @14,@SA00044                                        1850
         BR    @14                                                 1850
*   END PROCOVCE;                   /*                       @Y30LB25*/
*                                                                  1852
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - TRANDAT2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* TRANSFER DATA FROM AN INACTIVE TO AN ACTIVE VOLUME    @Y30LB25*/
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/
*   /* TRANSFER DATA FROM DASD TO CARTRIDGE AFTER THE        @Y30LB25*/
*   /* MSC WAS CALLED.                                       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1852
*TRANDAT2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  1852
TRANDAT2 ST    @14,@SA00045                                        1852
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK MSC RETURN CONDITION.                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1853
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1853
         LH    @15,RPLRCODE(,@06)                                  1853
         N     @15,@CF01129                                        1853
         LTR   @15,@15                                             1853
         BZ    @RF01853                                            1853
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1855
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1856
*       RETURN;                     /*                       @Y30LB25*/
@EL00045 DS    0H                                                  1857
@EF00045 DS    0H                                                  1857
@ER00045 L     @14,@SA00045                                        1857
         BR    @14                                                 1857
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
*                                                                  1859
@RF01853 BAL   @14,HOUSKEEP                                        1859
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BVR.                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1860
*   BVOLKY=CVOLID;                  /* SET VOLID             @Y30LB25*/
         L     @06,CVOLPTR                                         1860
         MVC   BVOLKY(6),CVOLID(@06)                               1860
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/
         LA    @06,BKEY                                            1861
         L     @01,RPLVPTR                                         1861
         ST    @06,RPLVKEY(,@01)                                   1861
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1862
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1863
         LH    @06,RPLVRETC(,@06)                                  1863
         N     @06,@CF01129                                        1863
         LTR   @06,@06                                             1863
         BNZ   @RT01863                                            1863
*     RETURN;                       /*                       @Y30LB25*/
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
*                                                                  1865
         MVC   BASEBUF(224),BASEBUF1                               1865
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CARTRIDGE TO DASD.                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1866
*   IF CVODASCR=ON                  /* CART TO DASD          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,CVOLPTR                                         1866
         TM    CVODASCR(@06),B'10000000'                           1866
         BNO   @RF01866                                            1866
*     BASDLSF=ON;                   /* DOWN LEVEL SPACE      @Y30LB25*/
         L     @06,BASEVPTR                                        1867
         OI    BASDLSF(@06),B'10000000'                            1867
*   ELSE                                                           1868
*                                                                  1868
*     /***************************************************************/
*     /*                                                             */
*     /* GET CVR FROM THE CIR                                @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1868
*     DO;                           /*                       @Y30LB25*/
         B     @RC01866                                            1868
@RF01866 DS    0H                                                  1869
*       IVOLKY=CVOLCSN;             /* SET CSN               @Y30LB25*/
         L     @06,CVOLPTR                                         1869
         MVC   IVOLKY(12),CVOLCSN(@06)                             1869
*       CALL GETRECLC;              /* GET CVR               @Y30LB25*/
         BAL   @14,GETRECLC                                        1870
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1871
         LH    @15,RPLVRETC(,@06)                                  1871
         N     @15,@CF01129                                        1871
         LTR   @15,@15                                             1871
         BNZ   @RT01871                                            1871
*         RETURN;                   /*                       @Y30LB25*/
*       COPYVPTR=RPLVBUF;           /* MAP BUFFER            @Y30LB25*/
*                                                                  1873
         L     @06,RPLVBUF(,@06)                                   1873
         ST    @06,COPYVPTR                                        1873
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK DOWN LEVEL SPACE FLAG                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1874
*       IF COPDLSPF=ON              /* DOWN LEVEL SPACE?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    COPDLSPF(@06),B'01000000'                           1874
         BNO   @RF01874                                            1874
*         BASDLSF=ON;               /* DOWN LEVEL SPACE      @Y30LB25*/
         L     @06,BASEVPTR                                        1875
         OI    BASDLSF(@06),B'10000000'                            1875
*       ELSE                        /* NO DOWN LEVEL SPC     @Y30LB25*/
*         BASDLSF=OFF;              /*                       @Y30LB25*/
*                                                                  1876
         B     @RC01874                                            1876
@RF01874 L     @06,BASEVPTR                                        1876
         NI    BASDLSF(@06),B'01111111'                            1876
*       /*************************************************************/
*       /*                                                           */
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1877
*       BASFRESP=COPFRESP;          /* FREE SPACE            @Y30LB25*/
@RC01874 L     @06,BASEVPTR                                        1877
         L     @15,COPYVPTR                                        1877
         LH    @14,COPFRESP(,@15)                                  1877
         STH   @14,BASFRESP(,@06)                                  1877
*       BASLEXT=COPLEXT;            /* LARGE FREE EXTENT     @Y30LB25*/
         LH    @14,COPLEXT(,@15)                                   1878
         STH   @14,BASLEXT(,@06)                                   1878
*       BASFREXT=COPFREXT;          /* FREE EXTENT           @Y30LB25*/
*                                                                  1879
         L     @15,COPFREXT(,@15)                                  1879
         ST    @15,BASFREXT(,@06)                                  1879
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH THE RPL FOR A WRITE                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1880
*       BVOLKY=CVOLID;              /* SET VOLID             @Y30LB25*/
         L     @06,CVOLPTR                                         1880
         MVC   BVOLKY(6),CVOLID(@06)                               1880
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1881
         L     @01,RPLVPTR                                         1881
         ST    @06,RPLVKEY(,@01)                                   1881
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        1882
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1883
         LH    @06,RPLVRETC(,@06)                                  1883
         N     @06,@CF01129                                        1883
         LTR   @06,@06                                             1883
         BNZ   @RT01883                                            1883
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1885
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN ICBCOVC EXTENSION                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1886
*   IF CVOLVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC01866 L     @06,CVOLPTR                                         1886
         L     @06,CVOLVEXT(,@06)                                  1886
         LTR   @06,@06                                             1886
         BZ    @RF01886                                            1886
*     DO;                           /*                       @Y30LB25*/
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/
         L     @06,BASEVPTR                                        1888
         ST    @06,BCDVPTR                                         1888
*       CALL PROCOVCE;              /*                       @Y30LB25*/
         BAL   @14,PROCOVCE                                        1889
*     END;                          /*                       @Y30LB25*/
*                                                                  1890
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE BVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1891
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/
@RF01886 LA    @06,BASEBUF                                         1891
         L     @01,RPLVPTR                                         1891
         ST    @06,RPLVBUF(,@01)                                   1891
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        1892
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00045                                            1893
*   END TRANDAT2;                   /*                       @Y30LB25*/
         B     @EL00045                                            1894
*                                                                  1895
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ELINACV2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE ELIMINATION OF AN INACTIVE VOLUME         @Y30LB25*/
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1895
*ELINACV2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
ELINACV2 ST    @14,@SA00046                                        1895
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1896
         LH    @05,RPLRCODE(,@06)                                  1896
         N     @05,@CF01129                                        1896
         LTR   @05,@05                                             1896
         BZ    @RF01896                                            1896
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1898
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1899
*       RETURN;                     /*                       @Y30LB25*/
@EL00046 DS    0H                                                  1900
@EF00046 DS    0H                                                  1900
@ER00046 L     @14,@SA00046                                        1900
         BR    @14                                                 1900
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25
*                                      RESERVE .MSVI         #Y30LB25*/
*                                                                  1902
@RF01896 BAL   @14,HOUSKEEP                                        1902
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               #Y30LB25*/
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    #Y30LB25*/
*   /* FOR UPDATE                                            #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1903
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            #Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1903
*   CALL GETRECUD;                  /* GET RECORD            #Y30LB25*/
         BAL   @14,GETRECUD                                        1904
*   IF RPLVRETC^=FIXZERO            /* ERROR?                #Y30LB25*/
*     THEN                          /* YES                   #Y30LB25*/
         L     @06,RPLVPTR                                         1905
         LH    @15,RPLVRETC(,@06)                                  1905
         N     @15,@CF01129                                        1905
         LTR   @15,@15                                             1905
         BNZ   @RT01905                                            1905
*     RETURN;                       /*                       #Y30LB25*/
*                                                                  1906
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THE CVR OR BVR.                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1907
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/
         MVI   RPLVTYP(@06),X'05'                                  1907
*   RESPECIFY                                                      1908
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/
         LR    RG1,@06                                             1909
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Y30LB25*/
         L     @15,@CV00762                                        1910
         BALR  @14,@15                                             1910
*   RESPECIFY                                                      1911
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1912
         LH    @15,RPLVRETC(,@06)                                  1912
         N     @15,@CF01129                                        1912
         LTR   @15,@15                                             1912
         BNZ   @RT01912                                            1912
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1913
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THEIR CIRS.                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1914
*   BCDVPTR=BASEVPTR;               /* COMM MAP              @Y30LB25*/
         L     @15,BASEVPTR                                        1914
         ST    @15,BCDVPTR                                         1914
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF               @Y30LB25*/
         LA    @14,INDEXBUF                                        1915
         ST    @14,RPLVBUF(,@06)                                   1915
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF00339                             1916
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @Y30LB25*/
         LA    @14,IKEY                                            1917
         ST    @14,RPLVKEY(,@06)                                   1917
*   IVOLKY=BCDCSN1;                 /* CSN1 TO KEY           @Y30LB25*/
         MVC   IVOLKY(12),BCDCSN1(@15)                             1918
*   CALL DELTRECD;                  /* DELETE CSN1 CIR       @Y30LB25*/
         BAL   @14,DELTRECD                                        1919
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/
         L     @06,RPLVPTR                                         1920
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1920
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1921
*   IVOLKY=BCDCSN2;                 /* CSN2 TO KEY           @Y30LB25*/
         L     @06,BCDVPTR                                         1922
         MVC   IVOLKY(12),BCDCSN2(@06)                             1922
*   CALL DELTRECD;                  /* DELETE CSN2 CIR       @Y30LB25*/
         BAL   @14,DELTRECD                                        1923
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/
         L     @06,RPLVPTR                                         1924
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1924
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/
*                                                                  1925
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1925
*   /*****************************************************************/
*   /*                                                               */
*   /* CKECK FOR A BASE VOLUME RECORD.                       @Y30LB25*/
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1926
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         1926
         TM    BCDBASE(@06),B'00100000'                            1926
         BNO   @RF01926                                            1926
*     DO;                           /*                       @Y30LB25*/
*       IF BASGRPV=ON               /* GROUPED BVR?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        1928
         TM    BASGRPV(@06),B'00100000'                            1928
         BNO   @RF01928                                            1928
*         DO;                       /*                       @Y30LB25*/
*           CALL INACGVR;           /* DECREM # INAC VOLS    @Y30LB25*/
         BAL   @14,INACGVR                                         1930
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1931
         LH    @06,RPLVRETC(,@06)                                  1931
         N     @06,@CF01129                                        1931
         LTR   @06,@06                                             1931
         BNZ   @RT01931                                            1931
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*       CALL PROCBVR;               /* PROCESS THE BVR       @Y30LB25*/
@RF01928 BAL   @14,PROCBVR                                         1934
*     END;                          /*                       @Y30LB25*/
*                                                                  1935
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A DELETED COPY VOLUME RECORD                @Y30LB25*/
*   /* IF PRESENT, THEN UPDATE THE CVR'S BVR TO REFLECT      @Y30LB25*/
*   /* THE DELETION OF THE CVR.                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1936
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01926 L     @06,BCDVPTR                                         1936
         TM    BCDCOPY(@06),B'00010000'                            1936
         BNO   @RF01936                                            1936
*     DO;                           /*                       @Y30LB25*/
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @Y30LB25*/
         MVC   COPYBUF(224),BASEBUF                                1938
*       ADDSUB=OFF;                 /* DELETED CVR           @Y30LB25*/
         NI    ADDSUB,B'10111111'                                  1939
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25
*                                      UPDATE CVR'S BVR      @Y30LB25*/
         L     @15,@CV00769                                        1940
         LA    @01,@AL01940                                        1940
         BALR  @14,@15                                             1940
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00046                                            1942
*   END ELINACV2;                   /*                       @Y30LB25*/
         B     @EL00046                                            1943
*                                                                  1944
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RENAME1                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/
*   /* VOLUME BEFORE THE MSC IS CALLED.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1944
*RENAME1:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
RENAME1  ST    @14,@SA00047                                        1944
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/
*                                                                  1945
         BAL   @14,RMSVI                                           1945
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1946
*   IF DEFPGRO=ON&DEFVVEXT^=FIXZERO /* GROUP SPECIFIED?      @VS34305*/
*     THEN                          /* YES                   @VS32198*/
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1946
         BNO   @RF01946                                            1946
         L     @06,DEFVVEXT(,DEFVPTR)                              1946
         LTR   @06,@06                                             1946
         BZ    @RF01946                                            1946
*     DO;                           /*                       @VS32198*/
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1948
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/
         LA    @06,GKEY                                            1949
         L     @01,RPLVPTR                                         1949
         ST    @06,RPLVKEY(,@01)                                   1949
*       CALL READLOC;               /* GET GVR               @VS32198*/
         BAL   @14,READLOC                                         1950
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/
*         THEN                      /* YES                   @VS32198*/
         L     @06,RPLVPTR                                         1951
         LH    @15,RPLVRETC(,@06)                                  1951
         N     @15,@CF01129                                        1951
         LTR   @15,@15                                             1951
         BZ    @RF01951                                            1951
*         DO;                       /*                       @VS32198*/
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/
*             THEN                  /* RIGHT                 @VS32198*/
         CLC   RPLRCODE(2,@06),@CB00711                            1953
         BNE   @RF01953                                            1953
*             RPLRCODE=NOGRPFND;    /*                       @VS32198
*                                      NO GROUP FND          @VS32198*/
         MVC   RPLRCODE(2,@06),@CB00707                            1954
*           RETURN;                 /*                       @VS32198*/
@EL00047 DS    0H                                                  1955
@EF00047 DS    0H                                                  1955
@ER00047 L     @14,@SA00047                                        1955
         BR    @14                                                 1955
*         END;                      /*                       @VS32198*/
*     END;                          /*                       @VS32198*/
*                                                                  1957
@RF01951 DS    0H                                                  1958
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CREATE A BASE VOLUME RECORD                 #Y30LB25*/
*   /* CHECK IF A BVR ALREADY EXISTS FOR DEFVNVOL.           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1958
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/
@RF01946 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         1958
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1959
         L     @01,RPLVPTR                                         1959
         ST    @06,RPLVKEY(,@01)                                   1959
*   CALL READLOC;                   /* READ FOR BVR          @Y30LB25*/
         BAL   @14,READLOC                                         1960
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1961
         CLC   RPLRCODE(2,@06),@CB00713                            1961
         BE    @RT01961                                            1961
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  1962
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF BVR ALREADY EXISTS FOR DEFVNVOL              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1963
*   IF RPLRCODE=NORECFND            /* NO RECORD FND?        @Y30LB25*/
*     THEN                          /* RIGHT                 @Y30LB25*/
         CLC   RPLRCODE(2,@06),@CB00711                            1963
         BNE   @RF01963                                            1963
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1965
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/
*                                                                  1966
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1966
*       /*************************************************************/
*       /*                                                           */
*       /* RENAME AN INACTIVE VOLUME                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1967
*       IF DEFVRNTR=ON              /* RENAME INAC VOL?      @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       1967
         BNO   @RF01967                                            1967
*         DO;                       /*                       @Y30LB25*/
*                                                                  1968
*           /*********************************************************/
*           /*                                                       */
*           /* GET MSC RECORD FOR THE INACTIVE VOLUME        @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1969
*           IVOLKY=DEFVCSN1;        /* CSN TO CIR            @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1969
*           CALL GETRECLC;          /* GET MSC RECD          @Y30LB25*/
         BAL   @14,GETRECLC                                        1970
*         END;                      /*                       @Y30LB25*/
*                                                                  1971
*       /*************************************************************/
*       /*                                                           */
*       /* RENAME AN ACTIVE VOLUME                           @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1972
*       ELSE                                                       1972
*                                                                  1972
*         /***********************************************************/
*         /*                                                         */
*         /* GET BVR FOR THE ACTIVE VOLUME                   @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1972
*         DO;                       /*                       @Y30LB25*/
         B     @RC01967                                            1972
@RF01967 DS    0H                                                  1973
*           BVOLKY=DEFVOLD;         /* VOLID TO BVR          @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1973
*           RPLVKEY=ADDR(BKEY);     /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            1974
         L     @01,RPLVPTR                                         1974
         ST    @06,RPLVKEY(,@01)                                   1974
*           CALL READLOC;           /* GET BVR               @Y30LB25*/
         BAL   @14,READLOC                                         1975
*         END;                      /*                       @Y30LB25*/
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RC01967 L     @06,RPLVPTR                                         1977
         LH    @15,RPLVRETC(,@06)                                  1977
         N     @15,@CF01129                                        1977
         LTR   @15,@15                                             1977
         BNZ   @RT01977                                            1977
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  1978
*       /*************************************************************/
*       /*                                                           */
*       /* MSVC RECORD FOR VOLUME TO BE RENAMED EXISTS.      @Y30LB25*/
*       /* RENAMED VOLUME IS TO BECOME A BVR.                @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1979
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25
*                                      GVR IS READ           @Y30LB25*/
         L     @06,RPLVBUF(,@06)                                   1979
         MVC   BASEBUF(224),BUFFER(@06)                            1979
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/
         L     @06,BASEVPTR                                        1980
         ST    @06,BCDVPTR                                         1980
*       CALL RENBVR1;               /* PROCESS BVR           @Y30LB25*/
         BAL   @14,RENBVR1                                         1981
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00047                                            1982
*     END;                          /*                       @Y30LB25*/
*                                                                  1983
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/
*   /* FOR RENAME AN ACTIVE VOLUME                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1984
*   IF DEFVRNM=ON                   /* RENAME ACT VOL?       @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01963 TM    DEFVRNM(DEFVPTR),B'00100000'                        1984
         BNO   @RF01984                                            1984
*     DO;                           /*                       @Y30LB25*/
*       IF DEFVOLD=DEFVNVOL         /* NVOLID = VOLID?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                1986
         BNE   @RF01986                                            1986
*         DO;                       /*                       @Y30LB25*/
*           BASEBUF=BUFFER;         /* SAVE BVR IN CASE      @Y30LB25
*                                      GVR IS READ           @Y30LB25*/
         L     @06,RPLVPTR                                         1988
         L     @06,RPLVBUF(,@06)                                   1988
         MVC   BASEBUF(224),BUFFER(@06)                            1988
*           CALL CKATTRIB;          /*                       @Y30LB25*/
         BAL   @14,CKATTRIB                                        1989
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00047                                            1990
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  1992
@RF01986 DS    0H                                                  1993
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/
*   /* RENAME AN INACTIVE VOLUME.                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1993
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01984 TM    DEFVRNTR(DEFVPTR),B'00000100'                       1993
         BNO   @RF01993                                            1993
*     DO;                           /*                       @Y30LB25*/
*       IVOLKY=DEFVCSN1;            /* SET CSN               @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1995
*       CALL GETRECLC;              /* GET MSVC RECORD       @Y30LB25*/
         BAL   @14,GETRECLC                                        1996
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         1997
         LH    @15,RPLVRETC(,@06)                                  1997
         N     @15,@CF01129                                        1997
         LTR   @15,@15                                             1997
         BNZ   @RT01997                                            1997
*         RETURN;                   /*                       @Y30LB25*/
*       BCDVPTR=RPLVBUF;            /* PT TO RECORD          @Y30LB25*/
         L     @06,RPLVBUF(,@06)                                   1999
         ST    @06,BCDVPTR                                         1999
*       IF BCDSERNO=DEFVNVOL        /* SAME VOLIDS?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2000
         BE    @RT02000                                            2000
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2002
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR EXISTS FOR DEFVNVOL. CHECK IF A DVR CAN           @Y30LB25*/
*   /* BE CREATED. AN ICBDEFV EXTENSION MUST EXIST.          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2003
*   IF DEFVVEXT^=FIXZERO&DEFDUP=ON  /* CREATE A DVR?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF01993 L     @06,DEFVVEXT(,DEFVPTR)                              2003
         LTR   @06,@06                                             2003
         BZ    @RF02003                                            2003
         TM    DEFDUP(DEFVEPTR),B'00100000'                        2003
         BNO   @RF02003                                            2003
*     DO;                           /*                       @Y30LB25*/
*       CALL ELACREN1;              /* PROCESS BVR           @Y30LB25*/
         BAL   @14,ELACREN1                                        2005
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00047                                            2006
*     END;                          /*                       @Y30LB25*/
*                                                                  2007
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR - BVR EXISTS FOR DEFVNVOL AND CAN'T             @Y30LB25*/
*   /* CREATE A DVR.                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2008
*   RPLVRETC=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/
@RF02003 L     @06,RPLVPTR                                         2008
         MVC   RPLVRETC(2,@06),@CH00041                            2008
*   RPLRCODE=NODVRSPC;              /* DVR NO SPECIFIED      @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00705                            2009
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00047                                            2010
*   END RENAME1;                    /*                       @Y30LB25*/
         B     @EL00047                                            2011
*                                                                  2012
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RENBVR1                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* MAKE CHECKS FOR RENAME A VOLUME WHICH WILL            @Y30LB25*/
*   /* RESULT IN A BVR BEING CREATED. CALLED BEFORE THE      @Y30LB25*/
*   /* MSC IS CALLED.                                        @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* RPLVBUF - MSC RECORD MAPPED BY BCDVPTR                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* PLACE HOLDER BASE VOLUME RECORD                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2012
*RENBVR1:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2012
RENBVR1  ST    @14,@SA00048                                        2012
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A BVR                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2013
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         2013
         TM    BCDBASE(@06),B'00100000'                            2013
         BNO   @RF02013                                            2013
*     DO;                           /*                       @Y30LB25*/
*       BASEVPTR=BCDVPTR;           /* BVR MAP               @Y30LB25*/
*                                                                  2015
         ST    @06,BASEVPTR                                        2015
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RENAME AN ACTIVE VOLUME                 @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2016
*       IF DEFVRNM=ON               /* RENAME ACT VOL?       @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2016
         BNO   @RF02016                                            2016
*         DO;                       /*                       @Y30LB25*/
*                                                                  2017
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK THE ATTRIBUTES                          @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2018
*           CALL CKATTRIB;          /* CK ATTRIBUTES         @Y30LB25*/
         BAL   @14,CKATTRIB                                        2018
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2019
         LH    @06,RPLVRETC(,@06)                                  2019
         N     @06,@CF01129                                        2019
         LTR   @06,@06                                             2019
         BNZ   @RT02019                                            2019
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  2021
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2022
*       CALL EXPCK;                 /* CK TO OR FOR          @Y30LB25*/
@RF02016 BAL   @14,EXPCK                                           2022
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2023
         LH    @06,RPLVRETC(,@06)                                  2023
         N     @06,@CF01129                                        2023
         LTR   @06,@06                                             2023
         BNZ   @RT02023                                            2023
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2024
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF COPIES EXIST AND STOP COPIES             @Y30LB25*/
*       /* FROM BEING MADE                                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2025
*       CALL ELACREN1;              /* CK COPIES             @Y30LB25*/
         BAL   @14,ELACREN1                                        2025
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2026
         LH    @06,RPLVRETC(,@06)                                  2026
         N     @06,@CF01129                                        2026
         LTR   @06,@06                                             2026
         BNZ   @RT02026                                            2026
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2028
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE A PLACE HOLDER BVR FOR DEFVNVOL                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2029
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/
@RF02013 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2029
*   CALL CRTPHOLD;                  /* CRT PLACE HOLD BVR    @Y30LB25*/
         BAL   @14,CRTPHOLD                                        2030
*   RETURN;                         /*                       @Y30LB25*/
@EL00048 DS    0H                                                  2031
@EF00048 DS    0H                                                  2031
@ER00048 L     @14,@SA00048                                        2031
         BR    @14                                                 2031
*   END RENBVR1;                    /*                       @Y30LB25*/
         B     @EL00048                                            2032
*                                                                  2033
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ELACREN1                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* MAKE CHECKS FOR RENAME AN ACTIVE OR INACTIVE          @Y30LB25*/
*   /* VOLUME WHICH WILL RESULT IN A BVR OR DVR              @Y30LB25*/
*   /* BEING CREATED. ALSO, MAKES CHECKS FOR ELIMINATE       @Y30LB25*/
*   /* AN ACTIVE VOLUME. IN EITHER CASE, THE RESULT          @Y30LB25*/
*   /* IS NO COPIES WILL BE ALLOWED. IT IT CALLED            @Y30LB25*/
*   /* BEFORE THE MSC IS CALLED.                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* RPLVBUF - BVR RECORD MAPPED BY BCDVPTR                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2033
*ELACREN1:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2033
ELACREN1 ST    @14,@SA00049                                        2033
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2034
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2034
         BNO   @RF02034                                            2034
*     DO;                           /*                       @Y30LB25*/
*                                                                  2035
*       /*************************************************************/
*       /*                                                           */
*       /* GET MSC RECORD TO BE RENAMED                      @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2036
*       IVOLKY=DEFVCSN1;            /* SET CSN IN CIR        @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2036
*       CALL GETRECUD;              /* GET RECORD            @Y30LB25*/
         BAL   @14,GETRECUD                                        2037
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2038
         LH    @06,RPLVRETC(,@06)                                  2038
         N     @06,@CF01129                                        2038
         LTR   @06,@06                                             2038
         BNZ   @RT02038                                            2038
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2039
*       /*************************************************************/
*       /*                                                           */
*       /* NEED ONLY A BVR                                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2040
*       BCDVPTR=ADDR(BASEBUF);      /* COMMON MAP            @Y30LB25*/
         LA    @06,BASEBUF                                         2040
         ST    @06,BCDVPTR                                         2040
*       IF BCDCOPY=ON×BCDDUP=ON     /* DVR OR CVR?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         TM    BCDCOPY(@06),B'00010100'                            2041
         BNZ   @RT02041                                            2041
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2043
*   /*****************************************************************/
*   /*                                                               */
*   /* RENAME AN ACTIVE VOLUME OR ELIMINATE AN ACTIVE        @Y30LB25*/
*   /* VOLUME                                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2044
*   ELSE                                                           2044
*     DO;                           /*                       @Y30LB25*/
         B     @RC02034                                            2044
@RF02034 DS    0H                                                  2045
*       BVOLKY=DEFVOLD;             /* VOLID TO KEY          @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2045
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            2046
         L     @05,RPLVPTR                                         2046
         ST    @06,RPLVKEY(,@05)                                   2046
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2047
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2048
         LH    @06,RPLVRETC(,@06)                                  2048
         N     @06,@CF01129                                        2048
         LTR   @06,@06                                             2048
         BNZ   @RT02048                                            2048
*         RETURN;                   /*                       @Y30LB25*/
*       BASEBUF=BASEBUF1;           /* SWAP BUFFERS          @Y30LB25*/
         MVC   BASEBUF(224),BASEBUF1                               2050
*     END;                          /*                       @Y30LB25*/
*                                                                  2051
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR COPIES                                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2052
*   BASEVPTR=ADDR(BASEBUF);         /* MAP BVR               @Y30LB25*/
@RC02034 LA    @06,BASEBUF                                         2052
         ST    @06,BASEVPTR                                        2052
*   IF BASNCOPY^=FIXZERO            /* ANY COPIES?           @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         CLI   BASNCOPY(@06),0                                     2053
         BE    @RF02053                                            2053
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/
         L     @06,RPLVPTR                                         2055
         MVC   RPLVRETC(2,@06),@CH00041                            2055
*       RPLRCODE=BVRWCOPS;          /* BVR HAS COPIES        @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00739                            2056
*       RETURN;                     /*                       @Y30LB25*/
@EL00049 DS    0H                                                  2057
@EF00049 DS    0H                                                  2057
@ER00049 L     @14,@SA00049                                        2057
         BR    @14                                                 2057
*     END;                          /*                       @Y30LB25*/
*                                                                  2058
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOW NO MORE COPIES                                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2059
*   BASNOCPY=ON;                    /* CAN'T COPY            @Y30LB25*/
*                                                                  2059
@RF02053 L     @06,BASEVPTR                                        2059
         OI    BASNOCPY(@06),B'01000000'                           2059
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE BVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2060
*   RPLVBUF=ADDR(BASEBUF);          /* RESET BUF ADDR        @Y30LB25*/
         LA    @06,BASEBUF                                         2060
         L     @05,RPLVPTR                                         2060
         ST    @06,RPLVBUF(,@05)                                   2060
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2061
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00049                                            2062
*   END ELACREN1;                   /*                       @Y30LB25*/
         B     @EL00049                                            2063
*                                                                  2064
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RENAME2                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2064
*RENAME2:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
RENAME2  ST    @14,@SA00050                                        2064
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198
*                                      RESERVE .MSVI         @VS32198*/
*                                                                  2065
         BAL   @14,HOUSKEEP                                        2065
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2066
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2066
         LH    @15,RPLRCODE(,@06)                                  2066
         N     @15,@CF01129                                        2066
         LTR   @15,@15                                             2066
         BZ    @RF02066                                            2066
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2068
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/
*                                                                  2069
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2069
*       /*************************************************************/
*       /*                                                           */
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES,         @Y30LB25*/
*       /* IF RENAME AN ACTIVE VOLUME AND THE NVOLID EQUALS  @Y30LB25*/
*       /* THE OLD VOLID.                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2070
*       IF DEFVRNM=ON&DEFVOLD^=DEFVNVOL/* RENAME ACT VOL &   @Y30LB25*/
*         THEN                      /* OVOLID ^= NVOLID      @Y30LB25*/
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2070
         BNO   @RF02070                                            2070
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2070
         BE    @RF02070                                            2070
*         CALL RMSCERR2;            /* DELETE BEFORE MSC     @Y30LB25
*                                      PROCESSING            @Y30LB25*/
*                                                                  2071
         BAL   @14,RMSCERR2                                        2071
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR RENAME AN INACTIVE VOLUME.              @Y30LB25*/
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES          @Y30LB25*/
*       /* IF VOLIDS ARE NOT EQUAL.                          @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2072
*       IF DEFVRNTR=ON              /* RENAME INACT VOL?     @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF02070 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2072
         BNO   @RF02072                                            2072
*         DO;                       /*                       @Y30LB25*/
*           IVOLKY=DEFVCSN1;        /* SET CSN IN KEY        @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2074
*           CALL GETRECLC;          /* GET BVR               @Y30LB25*/
         BAL   @14,GETRECLC                                        2075
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2076
         LH    @06,RPLVRETC(,@06)                                  2076
         N     @06,@CF01129                                        2076
         LTR   @06,@06                                             2076
         BNZ   @RT02076                                            2076
*             RETURN;               /*                       @Y30LB25*/
*           IF BCDSERNO^=DEFVNVOL   /* VOLS NOT =?           @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,BCDVPTR                                         2078
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2078
         BE    @RF02078                                            2078
*             CALL RMSCERR2;        /* DELETE BEFORE MSC     @Y30LB25
*                                      PROCESSING            @Y30LB25*/
         BAL   @14,RMSCERR2                                        2079
*         END;                      /*                       @Y30LB25*/
*                                                                  2080
@RF02078 DS    0H                                                  2081
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2081
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
@RF02072 L     @06,RPLVPTR                                         2081
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2081
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2082
*       RETURN;                     /*                       @Y30LB25*/
@EL00050 DS    0H                                                  2083
@EF00050 DS    0H                                                  2083
@ER00050 L     @14,@SA00050                                        2083
         BR    @14                                                 2083
*     END;                          /*                       @Y30LB25*/
*                                                                  2084
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE MSVC RECORD FOR THE VOLUME TO BE RENAMED      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2085
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/
@RF02066 BAL   @14,RDRENUPD                                        2085
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2086
         LH    @06,RPLVRETC(,@06)                                  2086
         N     @06,@CF01129                                        2086
         LTR   @06,@06                                             2086
         BNZ   @RT02086                                            2086
*     RETURN;                       /*                       @Y30LB25*/
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/
*                                                                  2088
         LA    @06,BASEBUF                                         2088
         ST    @06,BCDVPTR                                         2088
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME AN ACTIVE VOLUME AND                 @Y30LB25*/
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2089
*   IF DEFVRNM=ON&DEFVOLD=DEFVNVOL  /* VOLIDS = &            @Y30LB25*/
*     THEN                          /* RENAME ACT VOL?       @Y30LB25*/
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2089
         BNO   @RF02089                                            2089
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2089
         BNE   @RF02089                                            2089
*     DO;                           /* YES                   @Y30LB25*/
*                                                                  2090
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR ICBDEFV EXTENSION                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2091
*       IF DEFVVEXT^=FIXZERO        /* EXTENSION?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,DEFVVEXT(,DEFVPTR)                              2091
         LTR   @06,@06                                             2091
         BZ    @RF02091                                            2091
*         DO;                       /*                       @Y30LB25*/
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/
         BAL   @14,PRODEFVE                                        2093
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2094
         LH    @06,RPLVRETC(,@06)                                  2094
         N     @06,@CF01129                                        2094
         LTR   @06,@06                                             2094
         BNZ   @RT02094                                            2094
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  2096
*       /*************************************************************/
*       /*                                                           */
*       /* MAKE BASE VOLUME INACTIVE                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2097
*       BASINAC=ON;                 /* INACT VOL             @Y30LB25*/
*                                                                  2097
@RF02091 L     @06,BASEVPTR                                        2097
         OI    BASINAC(@06),B'00000100'                            2097
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK OWNER ID                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2098
*       IF DEFOWNID(1:10)^=FIX10ZRO /* OWNER ID?             @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2098
         BE    @RF02098                                            2098
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/
*                                                                  2099
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2099
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2100
*       IF DEFVVFLG^=FIX1F          /* NEW ATTRB?            @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF02098 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2100
         BE    @RF02100                                            2100
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/
*                                                                  2101
         BAL   @14,SETATTRB                                        2101
*       /*************************************************************/
*       /*                                                           */
*       /* VOLUME IS NOW INACTIVE, UPDATE ITS GVR AND        @Y30LB25*/
*       /* GVSNER SLOT AS NECESSARY.                         @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2102
*       CALL ACTINAC;               /* BVR INACT NOW         @Y30LB25*/
@RF02100 BAL   @14,ACTINAC                                         2102
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2103
         LH    @06,RPLVRETC(,@06)                                  2103
         N     @06,@CF01129                                        2103
         LTR   @06,@06                                             2103
         BNZ   @RT02103                                            2103
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2104
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2105
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/
         MVC   COPYBUF(224),BASEBUF                                2105
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/
         BAL   @14,RDRENUPD                                        2106
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2107
         LH    @15,RPLVRETC(,@06)                                  2107
         N     @15,@CF01129                                        2107
         LTR   @15,@15                                             2107
         BNZ   @RT02107                                            2107
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2108
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE BVR                                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2109
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/
         LA    @15,COPYBUF                                         2109
         ST    @15,RPLVBUF(,@06)                                   2109
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/
         BAL   @14,WRITRECD                                        2110
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00050                                            2111
*     END;                          /*                       @Y30LB25*/
*                                                                  2112
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME AN INACTIVE VOLUME AND               @Y30LB25*/
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2113
*   IF DEFVRNTR=ON&BCDSERNO=DEFVNVOL/* RENAME INACT VOL&     @Y30LB25*/
*     THEN                          /* VOLIDS = ?            @Y30LB25*/
@RF02089 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2113
         BNO   @RF02113                                            2113
         L     @06,BCDVPTR                                         2113
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2113
         BNE   @RF02113                                            2113
*     DO;                           /* YES                   @Y30LB25*/
*                                                                  2114
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR AN ICBDEFV EXTENSION AND A CVR OR BVR   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2115
*       IF DEFVVEXT^=FIXZERO&BCDDUP=OFF THEN                       2115
         L     @15,DEFVVEXT(,DEFVPTR)                              2115
         LTR   @15,@15                                             2115
         BZ    @RF02115                                            2115
         TM    BCDDUP(@06),B'00000100'                             2115
         BNZ   @RF02115                                            2115
*         DO;                       /*                       @Y30LB25*/
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/
         BAL   @14,PRODEFVE                                        2117
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2118
         LH    @06,RPLVRETC(,@06)                                  2118
         N     @06,@CF01129                                        2118
         LTR   @06,@06                                             2118
         BNZ   @RT02118                                            2118
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  2120
*       /*************************************************************/
*       /*                                                           */
*       /* RENAME AN INACTIVE VOLUME TO ITSELF ONLY          @Y30LB25*/
*       /* SUPPORTS OWNER ID AND ATTRIBITES IF THE VOLUME    @Y30LB25*/
*       /* BEING RENAMED IS A BVR                            @Y30LB25*/
*       /* CHECK OWNER ID                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2121
*       IF DEFOWNID(1:10)^=FIX10ZRO&BCDBASE=ON/*             @Y30LB25*/
*         THEN                      /*                       @Y30LB25*/
@RF02115 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2121
         BE    @RF02121                                            2121
         L     @06,BCDVPTR                                         2121
         TM    BCDBASE(@06),B'00100000'                            2121
         BNO   @RF02121                                            2121
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/
*                                                                  2122
         L     @06,BASEVPTR                                        2122
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2122
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2123
*       IF DEFVVFLG^=FIX1F&BCDBASE=ON/* NEW ATTRB?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
@RF02121 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2123
         BE    @RF02123                                            2123
         L     @06,BCDVPTR                                         2123
         TM    BCDBASE(@06),B'00100000'                            2123
         BNO   @RF02123                                            2123
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/
*                                                                  2124
         BAL   @14,SETATTRB                                        2124
*       /*************************************************************/
*       /*                                                           */
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2125
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/
@RF02123 MVC   COPYBUF(224),BASEBUF                                2125
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/
         BAL   @14,RDRENUPD                                        2126
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2127
         LH    @15,RPLVRETC(,@06)                                  2127
         N     @15,@CF01129                                        2127
         LTR   @15,@15                                             2127
         BNZ   @RT02127                                            2127
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2128
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE BVR                                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2129
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/
         LA    @15,COPYBUF                                         2129
         ST    @15,RPLVBUF(,@06)                                   2129
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/
         BAL   @14,WRITRECD                                        2130
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00050                                            2131
*     END;                          /*                       @Y30LB25*/
*                                                                  2132
*   /*****************************************************************/
*   /*                                                               */
*   /* OLD VOLID IS NOT EQUAL TO THE NEW VOLID.              @Y30LB25*/
*   /* GET AND DELETE THE RECORD TO BE RENAMED.              @Y30LB25*/
*   /* RECORD WILL BE RETURNED IN BASEBUF.                   @Y30LB25*/
*   /* RECORD IS A CVR OR BVR OR DVR.                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2133
*   CALL PROCDREC;                  /* DELT REN'D RECD       @Y30LB25*/
@RF02113 BAL   @14,PROCDREC                                        2133
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2134
         LH    @15,RPLVRETC(,@06)                                  2134
         N     @15,@CF01129                                        2134
         LTR   @15,@15                                             2134
         BNZ   @RT02134                                            2134
*     RETURN;                       /*                       @Y30LB25*/
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/
*                                                                  2136
         LA    @15,BASEBUF                                         2136
         ST    @15,BCDVPTR                                         2136
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF A PLACE HOLDER BVR EXISTS.                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2137
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2137
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2138
         ST    @15,RPLVKEY(,@06)                                   2138
*   CALL READUPD1;                  /* GET PLACE HOLD        @Y30LB25
*                                      BVR                   @Y30LB25*/
         BAL   @14,READUPD1                                        2139
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2140
         LH    @06,RPLVRETC(,@06)                                  2140
         N     @06,@CF01129                                        2140
         LTR   @06,@06                                             2140
         BNZ   @RT02140                                            2140
*     RETURN;                       /*                       @Y30LB25*/
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP PLACE HOLD BVR    @Y30LB25*/
*                                                                  2142
         LA    @06,BASEBUF1                                        2142
         ST    @06,BASEVPTR                                        2142
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF A DVR SHOULD BE CREATED.                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2143
*   IF BASHOLD=OFF                  /* PLACE HOLD BVR?       @Y30LB25*/
*     THEN                          /* NO                    @Y30LB25*/
         TM    BASHOLD(@06),B'10000000'                            2143
         BNZ   @RF02143                                            2143
*     DO;                           /*                       @Y30LB25*/
*                                                                  2144
*       /*************************************************************/
*       /*                                                           */
*       /* CREATE A DVR                                      @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2145
*       CALL CRTDVR;                /* CRT A DVR             @Y30LB25*/
         BAL   @14,CRTDVR                                          2145
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00050                                            2146
*     END;                          /*                       @Y30LB25*/
*                                                                  2147
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE PLACE HOLDER BVR                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2148
*   BASCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/
@RF02143 L     @06,BASEVPTR                                        2148
         L     @15,BCDVPTR                                         2148
         MVC   BASCSN1(12,@06),BCDCSN1(@15)                        2148
*   BASCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/
         MVC   BASCSN2(12,@06),BCDCSN2(@15)                        2149
*   BASLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/
         IC    @14,BCDLIB1(,@15)                                   2150
         STC   @14,BASLIB1(,@06)                                   2150
*   BASLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/
         IC    @14,BCDLIB2(,@15)                                   2151
         STC   @14,BASLIB2(,@06)                                   2151
*   BASHOLD=OFF;                    /* NO PLAC HOLD          @Y30LB25*/
         NI    BASHOLD(@06),B'01111111'                            2152
*   BASPREV=BLANK6;                 /* NO PREV BVR           @Y30LB25*/
         MVI   BASPREV+1(@06),C' '                                 2153
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2153
         MVI   BASPREV(@06),C' '                                   2153
*   BASNEXTV=BLANK6;                /* NO NEXT BVR           @Y30LB25*/
         MVI   BASNEXTV+1(@06),C' '                                2154
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2154
         MVI   BASNEXTV(@06),C' '                                  2154
*   BASGROUP=BLANK8;                /* NO GROUP              @Y30LB25*/
         MVI   BASGROUP+1(@06),C' '                                2155
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   2155
         MVI   BASGROUP(@06),C' '                                  2155
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/
         MVI   BASBKLMT(@06),X'01'                                 2156
*   BASDLMTD=BLANK4;                /* NO MOUNT DATE         @Y30LB25*/
         MVI   BASDLMTD+1(@06),C' '                                2157
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   2157
         MVI   BASDLMTD(@06),C' '                                  2157
*   BASDTREM=BLANK4;                /* NO EJECT DATE         @Y30LB25*/
         MVI   BASDTREM+1(@06),C' '                                2158
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   2158
         MVI   BASDTREM(@06),C' '                                  2158
*   BASEXPDT=FIX4FS;                /* NO EXPIR DATE         @Y30LB25*/
         MVC   BASEXPDT(4,@06),@CB00677                            2159
*   BASDESCR=BLANK30;               /* NO DESCRIPT           @Y30LB25*/
         MVI   BASDESCR+1(@06),C' '                                2160
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  2160
         MVI   BASDESCR(@06),C' '                                  2160
*   BASOWNER=BLANK10;               /* NO OWNER              @Y30LB25*/
         MVI   BASOWNER+1(@06),C' '                                2161
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   2161
         MVI   BASOWNER(@06),C' '                                  2161
*   BASRECOV=BLANK6;                /* RECOVERY SER #        @Y30LB25*/
         MVI   BASRECOV+1(@06),C' '                                2162
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   2162
         MVI   BASRECOV(@06),C' '                                  2162
*   BASDEST=BLANK30;                /* NO DESTINATION        @Y30LB25*/
         MVI   BASDEST+1(@06),C' '                                 2163
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    2163
         MVI   BASDEST(@06),C' '                                   2163
*   BASKLCPY=BLANK13;               /* NO LATEST COPY        @Y30LB25*/
*                                                                  2164
         MVC   BASKLCPY(13,@06),@CC00692                           2164
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF UPDATING FROM A CVR                          @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2165
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    BCDCOPY(@15),B'00010000'                            2165
         BNO   @RF02165                                            2165
*     DO;                           /*                       @Y30LB25*/
*       COPYVPTR=BCDVPTR;           /* MAP CVR TO BE         @Y30LB25
*                                      RENAMED               @Y30LB25*/
         ST    @15,COPYVPTR                                        2167
*       BASOWNER=COPOWNER;          /* SET OWNER             #Y30LB25*/
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      2168
*       BASDESCR=COPDESCR;          /* SET DESCRIPTION       #Y30LB25*/
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      2169
*       BASFREXT=COPFREXT;          /* SET FREE EXTENT       #Y30LB25*/
         L     @14,COPFREXT(,@15)                                  2170
         ST    @14,BASFREXT(,@06)                                  2170
*       BASLEXT=COPLEXT;            /* SET LARGE FREE EXT    #Y30LB25*/
         LH    @14,COPLEXT(,@15)                                   2171
         STH   @14,BASLEXT(,@06)                                   2171
*       BASFRESP=COPFRESP;          /* SET FREE SPACE        #Y30LB25*/
*                                                                  2172
         LH    @14,COPFRESP(,@15)                                  2172
         STH   @14,BASFRESP(,@06)                                  2172
*       /*************************************************************/
*       /*                                                           */
*       /* SET BIND                                          #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2173
*       IF COPBIND=ON               /* BIND?                 #Y30LB25*/
*         THEN                      /* YES                   #Y30LB25*/
         TM    COPBIND(@15),B'00000100'                            2173
         BNO   @RF02173                                            2173
*         BASBIND=ON;               /* BIND                  #Y30LB25*/
         OI    BASBIND(@06),B'00000010'                            2174
*       ELSE                                                       2175
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/
*                                                                  2175
         B     @RC02173                                            2175
@RF02173 L     @06,BASEVPTR                                        2175
         NI    BASBIND(@06),B'11111101'                            2175
*       /*************************************************************/
*       /*                                                           */
*       /* SET EXCLUSIVE                                     #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2176
*       IF COPEXCL=ON               /* EXCLUSIVE?            #Y30LB25*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02173 L     @06,COPYVPTR                                        2176
         TM    COPEXCL(@06),B'00000010'                            2176
         BNO   @RF02176                                            2176
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/
         L     @06,BASEVPTR                                        2177
         OI    BASEXCL(@06),B'00000001'                            2177
*       ELSE                                                       2178
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/
*                                                                  2178
         B     @RC02176                                            2178
@RF02176 L     @06,BASEVPTR                                        2178
         NI    BASEXCL(@06),B'11111110'                            2178
*       /*************************************************************/
*       /*                                                           */
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2179
*       IF COPDAERA=ON              /* SECURE?               #Y30LB25*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02176 L     @06,COPYVPTR                                        2179
         TM    COPDAERA(@06),B'00000001'                           2179
         BNO   @RF02179                                            2179
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/
         L     @06,BASEVPTR                                        2180
         OI    BASDAERA(@06),B'10000000'                           2180
*       ELSE                                                       2181
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/
*                                                                  2181
         B     @RC02179                                            2181
@RF02179 L     @06,BASEVPTR                                        2181
         NI    BASDAERA(@06),B'01111111'                           2181
*       /*************************************************************/
*       /*                                                           */
*       /* SET READ ONLY                                     #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2182
*       IF COPRONLY=ON              /* READ ONLY?            #Y30LB25*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02179 L     @06,COPYVPTR                                        2182
         TM    COPRONLY(@06),B'10000000'                           2182
         BNO   @RF02182                                            2182
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/
         L     @06,BASEVPTR                                        2183
         OI    BASRONLY(@06),B'01000000'                           2183
*       ELSE                                                       2184
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/
*                                                                  2184
         B     @RC02182                                            2184
@RF02182 L     @06,BASEVPTR                                        2184
         NI    BASRONLY(@06),B'10111111'                           2184
*       /*************************************************************/
*       /*                                                           */
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2185
*       IF COPDLSPF=ON              /* DOWN LEVEL SPC?       #Y30LB25*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02182 L     @06,COPYVPTR                                        2185
         TM    COPDLSPF(@06),B'01000000'                           2185
         BNO   @RF02185                                            2185
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/
         L     @06,BASEVPTR                                        2186
         OI    BASDLSF(@06),B'10000000'                            2186
*       ELSE                                                       2187
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/
         B     @RC02185                                            2187
@RF02185 L     @06,BASEVPTR                                        2187
         NI    BASDLSF(@06),B'01111111'                            2187
*     END;                          /*                       #Y30LB25*/
*                                                                  2188
@RC02185 DS    0H                                                  2189
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF UPDATING FROM A BVR                          #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2189
*   IF BCDBASE=ON                   /* BVR?                  #Y30LB25*/
*     THEN                          /* YES                   #Y30LB25*/
@RF02165 L     @06,BCDVPTR                                         2189
         TM    BCDBASE(@06),B'00100000'                            2189
         BNO   @RF02189                                            2189
*     DO;                           /*                       #Y30LB25*/
*                                                                  2190
*       /*************************************************************/
*       /*                                                           */
*       /* SET BIND                                          #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2191
*       IF BCDVPTR->BASBIND=ON      /* BIND?                 @ZA17177*/
*         THEN                      /* YES                   #Y30LB25*/
         TM    BASBIND(@06),B'00000010'                            2191
         BNO   @RF02191                                            2191
*         BASBIND=ON;               /* BIND                  #Y30LB25*/
         L     @06,BASEVPTR                                        2192
         OI    BASBIND(@06),B'00000010'                            2192
*       ELSE                                                       2193
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/
*                                                                  2193
         B     @RC02191                                            2193
@RF02191 L     @06,BASEVPTR                                        2193
         NI    BASBIND(@06),B'11111101'                            2193
*       /*************************************************************/
*       /*                                                           */
*       /* SET EXCLUSIVE                                     #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2194
*       IF BCDVPTR->BASEXCL=ON      /* EXCLUSIVE?            @ZA17177*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02191 L     @06,BCDVPTR                                         2194
         TM    BASEXCL(@06),B'00000001'                            2194
         BNO   @RF02194                                            2194
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/
         L     @06,BASEVPTR                                        2195
         OI    BASEXCL(@06),B'00000001'                            2195
*       ELSE                                                       2196
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/
*                                                                  2196
         B     @RC02194                                            2196
@RF02194 L     @06,BASEVPTR                                        2196
         NI    BASEXCL(@06),B'11111110'                            2196
*       /*************************************************************/
*       /*                                                           */
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2197
*       IF BCDVPTR->BASDAERA=ON     /* SECURE?               @ZA17177*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02194 L     @06,BCDVPTR                                         2197
         TM    BASDAERA(@06),B'10000000'                           2197
         BNO   @RF02197                                            2197
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/
         L     @06,BASEVPTR                                        2198
         OI    BASDAERA(@06),B'10000000'                           2198
*       ELSE                                                       2199
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/
*                                                                  2199
         B     @RC02197                                            2199
@RF02197 L     @06,BASEVPTR                                        2199
         NI    BASDAERA(@06),B'01111111'                           2199
*       /*************************************************************/
*       /*                                                           */
*       /* SET READ ONLY                                     #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2200
*       IF BCDVPTR->BASRONLY=ON     /* READ ONLY?            @ZA17177*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02197 L     @06,BCDVPTR                                         2200
         TM    BASRONLY(@06),B'01000000'                           2200
         BNO   @RF02200                                            2200
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/
         L     @06,BASEVPTR                                        2201
         OI    BASRONLY(@06),B'01000000'                           2201
*       ELSE                                                       2202
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/
*                                                                  2202
         B     @RC02200                                            2202
@RF02200 L     @06,BASEVPTR                                        2202
         NI    BASRONLY(@06),B'10111111'                           2202
*       /*************************************************************/
*       /*                                                           */
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2203
*       IF BCDVPTR->BASDLSF=ON      /* DOWN LEVEL SPC?       @ZA17177*/
*         THEN                      /* YES                   #Y30LB25*/
@RC02200 L     @06,BCDVPTR                                         2203
         TM    BASDLSF(@06),B'10000000'                            2203
         BNO   @RF02203                                            2203
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/
         L     @06,BASEVPTR                                        2204
         OI    BASDLSF(@06),B'10000000'                            2204
*       ELSE                                                       2205
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/
*                                                                  2205
         B     @RC02203                                            2205
@RF02203 L     @06,BASEVPTR                                        2205
         NI    BASDLSF(@06),B'01111111'                            2205
*       /*************************************************************/
*       /*                                                           */
*       /* SET OTHER BVR FIELDS                              #Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2206
*       BASBKLMT=BCDVPTR->BASBKLMT; /* BACKUP LMT            @ZA17177*/
@RC02203 L     @06,BASEVPTR                                        2206
         L     @15,BCDVPTR                                         2206
         IC    @14,BASBKLMT(,@15)                                  2206
         STC   @14,BASBKLMT(,@06)                                  2206
*       BASFRESP=BCDVPTR->BASFRESP; /* FREE SPACE            @ZA17177*/
         LH    @14,BASFRESP(,@15)                                  2207
         N     @14,@CF01129                                        2207
         STH   @14,BASFRESP(,@06)                                  2207
*       BASLEXT=BCDVPTR->BASLEXT;   /* LARGEST FREE EXTNT    @ZA17177*/
         LH    @14,BASLEXT(,@15)                                   2208
         N     @14,@CF01129                                        2208
         STH   @14,BASLEXT(,@06)                                   2208
*       BASFREXT=BCDVPTR->BASFREXT; /* FREE EXTENTS          @ZA17177*/
         L     @14,BASFREXT(,@15)                                  2209
         ST    @14,BASFREXT(,@06)                                  2209
*       BASDLMTD=BCDVPTR->BASDLMTD; /* DATE LAST MNTD        @ZA17177*/
         MVC   BASDLMTD(4,@06),BASDLMTD(@15)                       2210
*       BASEXPDT=BCDVPTR->BASEXPDT; /* EXPIRDATE             @ZA17177*/
         MVC   BASEXPDT(4,@06),BASEXPDT(@15)                       2211
*       BASDESCR=BCDVPTR->BASDESCR; /* DESCRIPTION           @ZA17177*/
         MVC   BASDESCR(30,@06),BASDESCR(@15)                      2212
*       BASOWNER=BCDVPTR->BASOWNER; /* OWNER                 @ZA17177*/
*                                                                  2213
         MVC   BASOWNER(10,@06),BASOWNER(@15)                      2213
*       /*************************************************************/
*       /*                                                           */
*       /* PUT GROUP NAME IN EXTENSION IF NOT THERE          @ZA17177*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2214
*       IF DEFVVEXT^=FIXZERO&DEFPGRO=OFF&/* IS THERE EXT     @ZA17177*/
*           BCDVPTR->BASGRPV=ON THEN/* IS THERE GRP          @ZA17177*/
         L     @06,DEFVVEXT(,DEFVPTR)                              2214
         LTR   @06,@06                                             2214
         BZ    @RF02214                                            2214
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       2214
         BNZ   @RF02214                                            2214
         TM    BASGRPV(@15),B'00100000'                            2214
         BNO   @RF02214                                            2214
*         DO;                       /* YES                   @ZA17177*/
*           DEFGROUP=BCDVPTR->BASGROUP;/* PUT GRP NAME IN EXT      2216
*                                                            @ZA17177*/
         MVC   DEFGROUP(8,DEFVEPTR),BASGROUP(@15)                  2216
*           DEFPGRO=ON;             /* TURN GRP FLG ON       @ZA17177*/
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       2217
*           IF BCDVPTR->BASGENUS=ON THEN/* IS THIS VOL GEN USE     2218
*                                                            @ZA17177*/
         TM    BASGENUS(@15),B'00010000'                           2218
         BNO   @RF02218                                            2218
*             DEFGENUS=ON;          /* GEN USE BIT IN EXT    @ZA17177*/
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      2219
*           ELSE                                                   2220
*             DEFRSTD=ON;           /* RSTD BIT ON IN EXT    @ZA17177*/
         B     @RC02218                                            2220
@RF02218 OI    DEFRSTD(DEFVEPTR),B'01000000'                       2220
*         END;                      /*                       @ZA17177*/
@RC02218 DS    0H                                                  2222
*     END;                          /*                       @ZA28475*/
*                                                                  2222
@RF02214 DS    0H                                                  2223
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ATTRIBUTES CHANGED                           #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2223
*   IF DEFVVFLG^=FIX1F              /* ATTRIBUTES?           #Y30LB25*/
*     THEN                          /* YES                   #Y30LB25*/
@RF02189 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2223
         BE    @RF02223                                            2223
*     CALL SETATTRB;                /* SET ATTRIBUTES        #Y30LB25*/
*                                                                  2224
         BAL   @14,SETATTRB                                        2224
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OWNER                                           #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2225
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER SPECIFIED?      #Y30LB25*/
*     THEN                          /* YES                   #Y30LB25*/
@RF02223 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2225
         BE    @RF02225                                            2225
*     BASOWNER=DEFOWNID;            /* SET NEW OWNER         #Y30LB25*/
*                                                                  2226
         L     @06,BASEVPTR                                        2226
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2226
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE EXISTING CIRS                              #Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2227
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFFER    #Y30LB25*/
@RF02225 MVC   BASEBUF(224),BASEBUF1                               2227
*   BASEVPTR=ADDR(BASEBUF);         /* RESET MAPPING         #Y30LB25*/
         LA    @06,BASEBUF                                         2228
         ST    @06,BASEVPTR                                        2228
*   BCDVPTR=BASEVPTR;               /* COMMON MAP            #Y30LB25*/
         ST    @06,BCDVPTR                                         2229
*   CALL UPDCIR;                    /* UPDT CIRS             @Y30LB25*/
         BAL   @14,UPDCIR                                          2230
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2231
         LH    @06,RPLVRETC(,@06)                                  2231
         N     @06,@CF01129                                        2231
         LTR   @06,@06                                             2231
         BNZ   @RT02231                                            2231
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2232
*   /*****************************************************************/
*   /*                                                               */
*   /* CHAIN BVR INTO NGVR                                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2233
*   GRPFLG=OFF;                     /* CHAIN INTO NGVR       @Y30LB25*/
         NI    GRPFLG,B'11101111'                                  2233
*   CALL VUCHI;                     /* CHAIN IN              @Y30LB25*/
         BAL   @14,VUCHI                                           2234
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2235
         LH    @06,RPLVRETC(,@06)                                  2235
         N     @06,@CF01129                                        2235
         LTR   @06,@06                                             2235
         BNZ   @RT02235                                            2235
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2236
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN ICBDEFV EXTENSION                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2237
*   IF DEFVVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,DEFVVEXT(,DEFVPTR)                              2237
         LTR   @06,@06                                             2237
         BZ    @RF02237                                            2237
*     DO;                           /*                       @Y30LB25*/
*       CALL PRODEFVE;              /* PROCESS EXTEN         @Y30LB25*/
         BAL   @14,PRODEFVE                                        2239
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2240
         LH    @06,RPLVRETC(,@06)                                  2240
         N     @06,@CF01129                                        2240
         LTR   @06,@06                                             2240
         BNZ   @RT02240                                            2240
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2242
*   /*****************************************************************/
*   /*                                                               */
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2243
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/
@RF02237 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2243
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            2244
         L     @01,RPLVPTR                                         2244
         ST    @06,RPLVKEY(,@01)                                   2244
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2245
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2246
         LH    @15,RPLVRETC(,@06)                                  2246
         N     @15,@CF01129                                        2246
         LTR   @15,@15                                             2246
         BNZ   @RT02246                                            2246
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2247
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE BVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2248
*   RPLVBUF=ADDR(BASEBUF);          /* SET BVR BUFF ADDR     @Y30LB25*/
         LA    @15,BASEBUF                                         2248
         ST    @15,RPLVBUF(,@06)                                   2248
*   CALL WRITRECD;                  /* WRITE THE BVR         @Y30LB25*/
         BAL   @14,WRITRECD                                        2249
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00050                                            2250
*   END RENAME2;                    /*                       @Y30LB25*/
         B     @EL00050                                            2251
*                                                                  2252
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - SETATTRB                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* SET THE VOLUME ATTRIBUTES IN THE BVR FROM             @Y30LB25*/
*   /* THOSE SPECIFIED IN THE ICBDEFV EXTENSION.             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* ICBDEFV EXTENSION                                     @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2252
*SETATTRB:                          /*                       @Y30LB25*/
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/
*                                                                  2252
SETATTRB STM   @14,@12,12(@13)                                     2252
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK EXCLUSIVE                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2253
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       2253
         BNO   @RF02253                                            2253
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/
         L     @06,BASEVPTR                                        2254
         OI    BASEXCL(@06),B'00000001'                            2254
*   ELSE                                                           2255
*     BASEXCL=OFF;                  /* NO EXCLUSIVE          @Y30LB25*/
*                                                                  2255
         B     @RC02253                                            2255
@RF02253 L     @06,BASEVPTR                                        2255
         NI    BASEXCL(@06),B'11111110'                            2255
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK BIND                                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2256
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC02253 TM    DEFVBIND(DEFVPTR),B'00000100'                       2256
         BNO   @RF02256                                            2256
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/
         L     @06,BASEVPTR                                        2257
         OI    BASBIND(@06),B'00000010'                            2257
*   ELSE                                                           2258
*     BASBIND=OFF;                  /* NO BIND               @Y30LB25*/
*                                                                  2258
         B     @RC02256                                            2258
@RF02256 L     @06,BASEVPTR                                        2258
         NI    BASBIND(@06),B'11111101'                            2258
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK READ ONLY                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2259
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC02256 TM    DEFVWINH(DEFVPTR),B'00000010'                       2259
         BNO   @RF02259                                            2259
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/
         L     @06,BASEVPTR                                        2260
         OI    BASRONLY(@06),B'01000000'                           2260
*   ELSE                                                           2261
*     BASRONLY=OFF;                 /* NO READ ONLY          @Y30LB25*/
*                                                                  2261
         B     @RC02259                                            2261
@RF02259 L     @06,BASEVPTR                                        2261
         NI    BASRONLY(@06),B'10111111'                           2261
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK DASD ERASE                                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2262
*   IF DEFVSEC=ON                   /* SECURE?               @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RC02259 TM    DEFVSEC(DEFVPTR),B'00100000'                        2262
         BNO   @RF02262                                            2262
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/
         L     @06,BASEVPTR                                        2263
         OI    BASDAERA(@06),B'10000000'                           2263
*   ELSE                                                           2264
*     BASDAERA=OFF;                 /* NO SECURE             @Y30LB25*/
         B     @RC02262                                            2264
@RF02262 L     @06,BASEVPTR                                        2264
         NI    BASDAERA(@06),B'01111111'                           2264
*   RETURN;                         /*                       @Y30LB25*/
@EL00051 DS    0H                                                  2265
@EF00051 DS    0H                                                  2265
@ER00051 LM    @14,@12,12(@13)                                     2265
         BR    @14                                                 2265
*   END SETATTRB;                   /*                       @Y30LB25*/
         B     @EL00051                                            2266
*                                                                  2267
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RMSCERR2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* IF A PLACE HOLDER BVR EXISTS FOR DEFVNVOL, DELETE     @Y30LB25*/
*   /* IT. ALLOW THE BASE VOLUME RECORD WHICH WAS            @Y30LB25*/
*   /* TO BE RENAMED TO BE COPIED.                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2267
*RMSCERR2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2267
RMSCERR2 ST    @14,@SA00052                                        2267
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR PLACE HOLDER BVR AND IF FOUND DELETE IT.    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2268
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2268
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         L     @06,RPLVPTR                                         2269
         LA    @05,BKEY                                            2269
         ST    @05,RPLVKEY(,@06)                                   2269
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/
         LA    @05,BASEBUF                                         2270
         ST    @05,RPLVBUF(,@06)                                   2270
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUFF LENGTH       @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             2271
*   CALL DELTRECD;                  /* DELETE BVR            @Y30LB25*/
*                                                                  2272
         BAL   @14,DELTRECD                                        2272
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR RETURN/REASON CODES, ONLY MSC CODES             @Y30LB25*/
*   /* WILL BE RETURNED.                                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2273
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* CLEAR RETN CODE       @Y30LB25*/
         L     @06,RPLVPTR                                         2273
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2273
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CLEAR REAS CODE       @Y30LB25*/
*                                                                  2274
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2274
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BVR WHICH WAS TO BE RENAMED.                      @Y30LB25*/
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2275
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/
         BAL   @14,RDRENUPD                                        2275
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2276
         LH    @05,RPLVRETC(,@06)                                  2276
         N     @05,@CF01129                                        2276
         LTR   @05,@05                                             2276
         BNZ   @RT02276                                            2276
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2277
*   /*****************************************************************/
*   /*                                                               */
*   /* RECORD RETURNED IN BASEBUF                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2278
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/
         LA    @05,BASEBUF                                         2278
         ST    @05,BCDVPTR                                         2278
*   IF BCDCOPY=ON×BCDDUP=ON         /* CVR OR DVR?           @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    BCDCOPY(@05),B'00010100'                            2279
         BNZ   @RT02279                                            2279
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2280
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLOW COPIES AND WRITE THE BVR.                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2281
*   BASNOCPY=OFF;                   /* ALLOW COPIES          @Y30LB25*/
         L     @01,BASEVPTR                                        2281
         NI    BASNOCPY(@01),B'10111111'                           2281
*   RPLVBUF=ADDR(BASEBUF);          /* INSURE CORRECT BUF    @Y30LB25*/
         ST    @05,RPLVBUF(,@06)                                   2282
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2283
*   RETURN;                         /*                       @Y30LB25*/
@EL00052 DS    0H                                                  2284
@EF00052 DS    0H                                                  2284
@ER00052 L     @14,@SA00052                                        2284
         BR    @14                                                 2284
*   END RMSCERR2;                   /*                       @Y30LB25*/
         B     @EL00052                                            2285
*                                                                  2286
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCDREC                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* DELETE A BVR OR CVR OR DVR WHICH IS TO BE RENAMED.    @Y30LB25*/
*   /* IF A BVR, UPDATE ITS GVR OR NGVR AND IF ACTIVE ITS    @Y30LB25*/
*   /* GVSNER SLOT. IF A CVR, UPDATE ITS BVR.                @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2286
*PROCDREC:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2286
PROCDREC ST    @14,@SA00053                                        2286
*   /*****************************************************************/
*   /*                                                               */
*   /* GET AND DELETE THE CVR OR BVR OR DVR TO BE RENAMED.   @Y30LB25*/
*   /* THE DELETED RECORD WILL BE IN BASEBUF UPON            @Y30LB25*/
*   /* RETURN.                                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2287
*   CALL RDRENUPD;                  /* GET MSVC RECD TO      @Y30LB25
*                                      BE RENAMED            @Y30LB25*/
         BAL   @14,RDRENUPD                                        2287
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2288
         LH    @15,RPLVRETC(,@06)                                  2288
         N     @15,@CF01129                                        2288
         LTR   @15,@15                                             2288
         BNZ   @RT02288                                            2288
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/
         MVI   RPLVTYP(@06),X'05'                                  2290
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/
         LA    @15,BASEBUF                                         2291
         ST    @15,RPLVBUF(,@06)                                   2291
*   RESPECIFY                                                      2292
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@06                                             2293
*   CALL ICBVIO00;                  /* DELETE MSVC RECD              */
         L     @15,@CV00762                                        2294
         BALR  @14,@15                                             2294
*   RESPECIFY                                                      2295
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2296
         LH    @06,RPLVRETC(,@06)                                  2296
         N     @06,@CF01129                                        2296
         LTR   @06,@06                                             2296
         BNZ   @RT02296                                            2296
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2297
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR DELETION OF A BVR OR A CVR                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2298
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/
*                                                                  2298
         LA    @06,BASEBUF                                         2298
         ST    @06,BCDVPTR                                         2298
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME A BVR.                               @Y30LB25*/
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2299
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    BCDBASE(@06),B'00100000'                            2299
         BNO   @RF02299                                            2299
*     DO;                           /*                       @Y30LB25*/
*                                                                  2300
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF GROUPED                                  @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2301
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2301
         TM    BASGRPV(@06),B'00100000'                            2301
         BNO   @RF02301                                            2301
*         DO;                       /*                       @Y30LB25*/
*                                                                  2302
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK FOR INACTIVE                            @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2303
*           IF BASINAC=ON           /* INACTIVE?             @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         TM    BASINAC(@06),B'00000100'                            2303
         BNO   @RF02303                                            2303
*             DO;                   /*                       @Y30LB25*/
*               CALL INACGVR;       /* DEC # INAC VOLS       @Y30LB25*/
         BAL   @14,INACGVR                                         2305
*               IF RPLVRETC^=FIXZERO/* ERROR?                @Y30LB25*/
*                 THEN              /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2306
         LH    @06,RPLVRETC(,@06)                                  2306
         N     @06,@CF01129                                        2306
         LTR   @06,@06                                             2306
         BNZ   @RT02306                                            2306
*                 RETURN;           /*                       @Y30LB25*/
*             END;                  /*                       @Y30LB25*/
*                                                                  2308
*           /*********************************************************/
*           /*                                                       */
*           /* IT IS ACTIVE                                  @Y30LB25*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  2309
*           ELSE                    /* ACTIVE                @Y30LB25*/
*             DO;                   /*                       @Y30LB25*/
*                                                                  2309
         B     @RC02303                                            2309
@RF02303 DS    0H                                                  2310
*               /*****************************************************/
*               /*                                                   */
*               /* UPDATE GVR                                @Y30LB25*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  2310
*               CALL ACTGVR;        /* READ GVR              @Y30LB25*/
         BAL   @14,ACTGVR                                          2310
*               IF RPLVRETC^=FIXZERO/* ERROR?                @Y30LB25*/
*                 THEN              /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2311
         LH    @06,RPLVRETC(,@06)                                  2311
         N     @06,@CF01129                                        2311
         LTR   @06,@06                                             2311
         BNZ   @RT02311                                            2311
*                 RETURN;           /*                       @Y30LB25*/
*             END;                  /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*                                                                  2314
@RC02303 DS    0H                                                  2315
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS BVR                                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2315
*       CALL PROCBVR;               /* PROCESS BVR           @Y30LB25*/
@RF02301 BAL   @14,PROCBVR                                         2315
*     END;                          /*                       @Y30LB25*/
*                                                                  2316
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME A CVR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2317
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02299 L     @06,BCDVPTR                                         2317
         TM    BCDCOPY(@06),B'00010000'                            2317
         BNO   @RF02317                                            2317
*     DO;                           /*                       @Y30LB25*/
*       ADDSUB=OFF;                 /* DELETE CVR            @Y30LB25*/
         NI    ADDSUB,B'10111111'                                  2319
*       CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*           @Y30LB25
*                                      UPDATE CVR'S BVR      @Y30LB25*/
         L     @15,@CV00769                                        2320
         LA    @01,@AL02320                                        2320
         BALR  @14,@15                                             2320
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00053 DS    0H                                                  2322
@EF00053 DS    0H                                                  2322
@ER00053 L     @14,@SA00053                                        2322
         BR    @14                                                 2322
*   END PROCDREC;                   /*                       @Y30LB25*/
         B     @EL00053                                            2323
*                                                                  2324
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ACTGVR                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* DECREMENT EITHER THE NUMBER OF GENERAL-USE            @Y30LB25*/
*   /* OR THE NUMBER OF RESTRICTED VOLUMES KEPT IN           @Y30LB25*/
*   /* THE GROUP VOLUME RECORD. DECREMENT SPACE              @Y30LB25*/
*   /* COUNT IN THE GROUP RECORD. DONE FOR AN ACTIVE         @Y30LB25*/
*   /* VOLUME BEING DELETED.                                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2324
*ACTGVR:                            /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
ACTGVR   ST    @14,@SA00054                                        2324
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/
         L     @06,BASEVPTR                                        2325
         MVC   GROUPKY(8),BASGROUP(@06)                            2325
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,GKEY                                            2326
         L     @01,RPLVPTR                                         2326
         ST    @06,RPLVKEY(,@01)                                   2326
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2327
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2328
         LH    @06,RPLVRETC(,@06)                                  2328
         N     @06,@CF01129                                        2328
         LTR   @06,@06                                             2328
         BNZ   @RT02328                                            2328
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2329
*   /*****************************************************************/
*   /*                                                               */
*   /* DECREMENT TYPE OF VOLUME COUNT                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2330
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              2330
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2331
         TM    BASGENUS(@06),B'00010000'                           2331
         BNO   @RF02331                                            2331
*     DO;                           /*                       @Y30LB25*/
*       GRONGEN=GRONGEN-FIXONE;     /* DEC # GEN-USE         @Y30LB25*/
*                                                                  2333
         L     @06,GROUPPTR                                        2333
         LH    @15,GRONGEN(,@06)                                   2333
         BCTR  @15,0                                               2333
         STH   @15,GRONGEN(,@06)                                   2333
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE GVR                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2334
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/
         NI    ADDSUBGR,B'11110111'                                2334
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/
         BAL   @14,VUPGH                                           2335
*     END;                          /*                       @Y30LB25*/
*   ELSE                            /* RESTRICTED            @Y30LB25*/
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         B     @RC02331                                            2337
@RF02331 L     @06,BASEVPTR                                        2337
         TM    BASRSTD(@06),B'00001000'                            2337
         BNO   @RF02337                                            2337
*       GRONRSTD=GRONRSTD-FIXONE;   /* DEC # RESTD VOLS      @Y30LB25*/
*                                                                  2338
         L     @06,GROUPPTR                                        2338
         LH    @15,GRONRSTD(,@06)                                  2338
         BCTR  @15,0                                               2338
         STH   @15,GRONRSTD(,@06)                                  2338
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE GVR                                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2339
*   RPLVBUF=ADDR(GROUPBUF);         /* SET BUFF ADDR         @Y30LB25*/
@RF02337 DS    0H                                                  2339
@RC02331 LA    @06,GROUPBUF                                        2339
         L     @01,RPLVPTR                                         2339
         ST    @06,RPLVBUF(,@01)                                   2339
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2340
*   RETURN;                         /*                       @Y30LB25*/
@EL00054 DS    0H                                                  2341
@EF00054 DS    0H                                                  2341
@ER00054 L     @14,@SA00054                                        2341
         BR    @14                                                 2341
*   END ACTGVR;                     /*                       @Y30LB25*/
         B     @EL00054                                            2342
*                                                                  2343
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - RERENUPD                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* GET THE MSVC RECORD FOR UPDATE WHICH IS               @Y30LB25*/
*   /* TO BE RENAMED.                                        @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* MSC RECORD TO BE RENAMED IN BASEBUF                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2343
*RDRENUPD:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2343
RDRENUPD ST    @14,@SA00055                                        2343
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2344
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2344
         BNO   @RF02344                                            2344
*     DO;                           /*                       @Y30LB25*/
*       IVOLKY=DEFVCSN1;            /* SET CSN IN KEY        @Y30LB25*/
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2346
*       CALL GETRECUD;              /* GET MSC RECORD        @Y30LB25*/
         BAL   @14,GETRECUD                                        2347
*     END;                          /*                       @Y30LB25*/
*                                                                  2348
*   /*****************************************************************/
*   /*                                                               */
*   /* IT IS RENAME AN ACTIVE VOLUME                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2349
*   ELSE                                                           2349
*     DO;                           /*                       @Y30LB25*/
         B     @RC02344                                            2349
@RF02344 DS    0H                                                  2350
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2350
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            2351
         L     @01,RPLVPTR                                         2351
         ST    @06,RPLVKEY(,@01)                                   2351
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/
         BAL   @14,READUPD1                                        2352
*       BASEBUF=BASEBUF1;           /* USE CORRECT BUFF      @Y30LB25*/
         MVC   BASEBUF(224),BASEBUF1                               2353
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00055 DS    0H                                                  2355
@EF00055 DS    0H                                                  2355
@ER00055 L     @14,@SA00055                                        2355
         BR    @14                                                 2355
*   END RDRENUPD;                   /*                       @Y30LB25*/
         B     @EL00055                                            2356
*                                                                  2357
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ACTINAC                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* THIS PROCEDURE HANDLES A GROUP RECORD FOR             @Y30LB25*/
*   /* RENAMING AN ACTIVE VOLUME BACK TO ITSELF IF IT IS     @Y30LB25*/
*   /* GROUPED AND GENERAL-USE.                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* GROUP VOLUME EXTENSION RECORD                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2357
*ACTINAC:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2357
ACTINAC  ST    @14,@SA00056                                        2357
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR GROUPED BVR                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2358
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2358
         TM    BASGRPV(@06),B'00100000'                            2358
         BNO   @RF02358                                            2358
*     DO;                           /*                       @Y30LB25*/
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/
         MVC   GROUPKY(8),BASGROUP(@06)                            2360
*       RPLVKEY=ADDR(GKEY);         /* KEY ADDR              @Y30LB25*/
         LA    @06,GKEY                                            2361
         L     @05,RPLVPTR                                         2361
         ST    @06,RPLVKEY(,@05)                                   2361
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/
         BAL   @14,READUPD1                                        2362
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2363
         LH    @06,RPLVRETC(,@06)                                  2363
         N     @06,@CF01129                                        2363
         LTR   @06,@06                                             2363
         BNZ   @RT02363                                            2363
*         RETURN;                   /*                       @Y30LB25*/
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUF       @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              2365
*       GROUPPTR=ADDR(GROUPBUF);    /* SET MAPPING           @VS34305*/
*                                                                  2366
         LA    @06,GROUPBUF                                        2366
         ST    @06,GROUPPTR                                        2366
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE GVR                                    @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2367
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/
*                                                                  2367
         LA    @05,1                                               2367
         AH    @05,GRONINAC(,@06)                                  2367
         STH   @05,GRONINAC(,@06)                                  2367
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE NUMBER OF RESTRICTED OR                @Y30LB25*/
*       /* GENERAL-USE VOLUMES                               @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2368
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @05,BASEVPTR                                        2368
         TM    BASRSTD(@05),B'00001000'                            2368
         BNO   @RF02368                                            2368
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25
*                                      DECR # RESTD VOLS     @Y30LB25*/
         LH    @05,GRONRSTD(,@06)                                  2369
         BCTR  @05,0                                               2369
         STH   @05,GRONRSTD(,@06)                                  2369
*       ELSE                                                       2370
*         IF BASGENUS=ON            /* GENEAL-USE?           @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         B     @RC02368                                            2370
@RF02368 L     @06,BASEVPTR                                        2370
         TM    BASGENUS(@06),B'00010000'                           2370
         BNO   @RF02370                                            2370
*           DO;                     /*                       @Y30LB25*/
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25
*                                      DECR # GEN-USE        @Y30LB25*/
*                                                                  2372
         L     @06,GROUPPTR                                        2372
         LH    @05,GRONGEN(,@06)                                   2372
         BCTR  @05,0                                               2372
         STH   @05,GRONGEN(,@06)                                   2372
*             /*******************************************************/
*             /*                                                     */
*             /* UPDATE THE GVR                              @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  2373
*             ADDSUBGR=OFF;         /* DELETE                @Y30LB25*/
         NI    ADDSUBGR,B'11110111'                                2373
*             CALL VUPGH;           /* PROCESS GVR           @Y30LB25*/
         BAL   @14,VUPGH                                           2374
*           END;                    /*                       @Y30LB25*/
*                                                                  2375
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE THE GVR                                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2376
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF PTR           @Y30LB25*/
@RF02370 DS    0H                                                  2376
@RC02368 LA    @06,GROUPBUF                                        2376
         L     @05,RPLVPTR                                         2376
         ST    @06,RPLVBUF(,@05)                                   2376
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2377
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2378
         LH    @06,RPLVRETC(,@06)                                  2378
         N     @06,@CF01129                                        2378
         LTR   @06,@06                                             2378
         BNZ   @RT02378                                            2378
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2379
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR GENERAL-USE TO DELETE ITS SLOT          @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2380
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2380
         TM    BASGENUS(@06),B'00010000'                           2380
         BNO   @RF02380                                            2380
*         DO;                       /*                       @Y30LB25*/
*           EXPSLOT=OFF;            /* NO UPDATE DATE        @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 2382
*           ADDSUBSL=OFF;           /* DELETE                @Y30LB25*/
         NI    ADDSUBSL,B'11111101'                                2383
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2384
*                                                            @Y30LB25*/
         L     @15,@CV00767                                        2384
         LA    @01,@AL02384                                        2384
         BALR  @14,@15                                             2384
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00056 DS    0H                                                  2387
@EF00056 DS    0H                                                  2387
@ER00056 L     @14,@SA00056                                        2387
         BR    @14                                                 2387
*   END ACTINAC;                    /*                       @Y30LB25*/
         B     @EL00056                                            2388
*                                                                  2389
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CRTDVR                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* CREATE A DUPLICATE VOLUME RECORD FROM A BASE          @Y30LB25*/
*   /* VOLUME RECORD (ACTIVE OR INACTIVE) OR FROM A          @Y30LB25*/
*   /* COPY VOLUME RECORD, EITHER OF WHICH HAS ALREADY       @Y30LB25*/
*   /* BEEN DELETED.                                         @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BCDVPTR POINTS TO BASEBUF WHICH CONTAINS              @Y30LB25*/
*   /* THE DELETED BASE OR COPY VOLUME RECORD                @Y30LB25*/
*   /* FOR THE OLD VOLID. BASEVPTR POINTS TO                 @Y30LB25*/
*   /* THE BASE VOLUME RECORD FOR THE NEW VOLID              @Y30LB25*/
*   /* IN BASEBUF1. THE DUPLICATE VOLUME WILL BE             @Y30LB25*/
*   /* CREATE FOR THE NEW VOLID.                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* DUPLICATE VOLUME RECORD                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2389
*CRTDVR:                            /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2389
CRTDVR   ST    @14,@SA00057                                        2389
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND THE ID OF THE NEXT AVAILABLE DVR FOR NVOLID      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2390
*   DVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/
         L     @06,BASEVPTR                                        2390
         MVC   DVOLKY(6),BASSERNO(@06)                             2390
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         L     @06,RPLVPTR                                         2391
         MVI   RPLVTYP(@06),X'00'                                  2391
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         OI    RPLVLOC(@06),B'11000000'                            2393
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/
         NI    RPLVUPD(@06),B'11111101'                            2394
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/
         LA    @15,DKEY                                            2395
         ST    @15,RPLVKEY(,@06)                                   2395
*   DIDKY=FIXZERO;                  /* START DVR 0           @Y30LB25*/
         MVI   DIDKY,X'00'                                         2396
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* PTR TO RPLV           @Y30LB25*/
         LR    RG1,@06                                             2398
*   A=FIXONE;                       /* LOOP CONTROL          @Y30LB25*/
         MVC   A(4),@CF00046                                       2399
*   DO WHILE A=1;                   /* FIND AVAIL DVR        @Y30LB25*/
         B     @DE02400                                            2400
@DL02400 DS    0H                                                  2401
*     DIDKY=DIDKY+FIXONE;           /* NEXT KEY              @Y30LB25*/
         IC    @06,DIDKY                                           2401
         LA    @06,1(,@06)                                         2401
         STC   @06,DIDKY                                           2401
*     CALL ICBVIO00;                /* READ FOR DVR          @Y30LB25*/
         L     @15,@CV00762                                        2402
         BALR  @14,@15                                             2402
*     IF RPLVRETC^=FIXZERO×DIDKY=FIX255/* ERROR?             @Y30LB25*/
*       THEN                        /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2403
         LH    @06,RPLVRETC(,@06)                                  2403
         N     @06,@CF01129                                        2403
         LTR   @06,@06                                             2403
         BNZ   @RT02403                                            2403
         CLI   DIDKY,255                                           2403
         BNE   @RF02403                                            2403
@RT02403 DS    0H                                                  2404
*       A=FIXZERO;                  /* END LOOP              @Y30LB25*/
         SLR   @06,@06                                             2404
         ST    @06,A                                               2404
*   END;                            /*                       @Y30LB25*/
@RF02403 DS    0H                                                  2405
@DE02400 CLC   A(4),@CF00046                                       2405
         BE    @DL02400                                            2405
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   IF RPLVRETC=FIXZERO             /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2407
         LH    @15,RPLVRETC(,@06)                                  2407
         N     @15,@CF01129                                        2407
         LTR   @15,@15                                             2407
         BNZ   @RF02407                                            2407
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/
         MVC   RPLVRETC(2,@06),@CH00041                            2409
*       RPLRCODE=NODVR;             /* 255 DVRS              @Y30LB25*/
         MVC   RPLRCODE(2,@06),@CB00709                            2410
*       RETURN;                     /*                       @Y30LB25*/
@EL00057 DS    0H                                                  2411
@EF00057 DS    0H                                                  2411
@ER00057 L     @14,@SA00057                                        2411
         BR    @14                                                 2411
*     END;                          /*                       @Y30LB25*/
*   IF RPLRCODE=IOERROR             /* I?O ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02407 L     @06,RPLVPTR                                         2413
         CLC   RPLRCODE(2,@06),@CB00713                            2413
         BE    @RT02413                                            2413
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2414
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE DVR FOR NVOLID                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2415
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* ZERO REASON CODE      @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2415
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ZERO RETURN CODE      @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2416
*   DUPVBUF=DUPVBUF&&DUPVBUF;       /* ZERO DVR BUFFER       @Y30LB25*/
         XC    DUPVBUF(224),DUPVBUF                                2417
*   DUPNAME=DKEY;                   /* SET KEY               @Y30LB25*/
         L     @06,DUPVPTR                                         2418
         MVC   DUPNAME(13,@06),DKEY                                2418
*   DUPCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/
         L     @15,BCDVPTR                                         2419
         MVC   DUPCSN1(12,@06),BCDCSN1(@15)                        2419
*   DUPLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/
         IC    @14,BCDLIB1(,@15)                                   2420
         STC   @14,DUPLIB1(,@06)                                   2420
*   DUPCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/
         MVC   DUPCSN2(12,@06),BCDCSN2(@15)                        2421
*   DUPLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/
         IC    @14,BCDLIB2(,@15)                                   2422
         STC   @14,DUPLIB2(,@06)                                   2422
*   DUPDUPLR=ON;                    /* DVR                   @Y30LB25*/
*                                                                  2423
         OI    DUPDUPLR(@06),B'00000100'                           2423
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE THE DVR                                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2424
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/
         L     @06,RPLVPTR                                         2424
         NI    RPLVUPD(@06),B'11111101'                            2424
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@06),B'01111111'                            2425
*   RPLVRLN=LENGTH(DUPV);           /* RECORD LENGTH         @Y30LB25*/
         MVC   RPLVRLN(4,@06),@CF01105                             2426
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             2427
*   RPLVBUF=ADDR(DUPVBUF);          /* DVR BUF ADDR          @Y30LB25*/
         LA    @15,DUPVBUF                                         2428
         ST    @15,RPLVBUF(,@06)                                   2428
*   CALL WRITRECD;                  /* WRITE DVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2429
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2430
         LH    @06,RPLVRETC(,@06)                                  2430
         N     @06,@CF01129                                        2430
         LTR   @06,@06                                             2430
         BNZ   @RT02430                                            2430
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2431
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE CIRS                                       @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2432
*   BCDVPTR=ADDR(DUPVBUF);          /* DVR PTR               @Y30LB25*/
         LA    @06,DUPVBUF                                         2432
         ST    @06,BCDVPTR                                         2432
*   CALL UPDCIR;                    /* UPDATE CIRS           @Y30LB25*/
         BAL   @14,UPDCIR                                          2433
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00057                                            2434
*   END CRTDVR;                     /*                       @Y30LB25*/
         B     @EL00057                                            2435
*                                                                  2436
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - UPDCIR                               @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* GET THE CARTRIDGE INDEX RECORDS FOR THE               @Y30LB25*/
*   /* BASE VOLUME RECORD (ACTIVE OR INACTIVE)               @Y30LB25*/
*   /* OR THE COPY OR DUPLICATE VOLUME RECORD, AND UPDATE    @Y30LB25*/
*   /* THEM TO REFLECT THE VOLID OF THE NEW DUPLICATE OR     @Y30LB25*/
*   /* BASE OR COPY VOLUME RECORD.                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BCDVPTR POINTING TO CONTAINS                          @Y30LB25*/
*   /* THE BASE OR DUPLICATE VOLUME RECORD                   @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* CARTRIDGE INDEX RECORDS                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2436
*UPDCIR:                            /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2436
UPDCIR   ST    @14,@SA00058                                        2436
*   /*****************************************************************/
*   /*                                                               */
*   /* GET AND UPDATE CIR FOR CSN1                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2437
*   IVOLKY=BCDCSN1;                 /* SET CSN1 TO KEY       @Y30LB25*/
         L     @06,BCDVPTR                                         2437
         MVC   IVOLKY(12),BCDCSN1(@06)                             2437
*   RPLVKEY=ADDR(IKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,IKEY                                            2438
         L     @01,RPLVPTR                                         2438
         ST    @06,RPLVKEY(,@01)                                   2438
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/
         BAL   @14,READUPD1                                        2439
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2440
         LH    @06,RPLVRETC(,@06)                                  2440
         N     @06,@CF01129                                        2440
         LTR   @06,@06                                             2440
         BNZ   @RT02440                                            2440
*     RETURN;                       /*                       @Y30LB25*/
*   INDEXPTR=ADDR(BASEBUF1);        /* MAP CIR               @Y30LB25*/
         LA    @06,BASEBUF1                                        2442
         ST    @06,INDEXPTR                                        2442
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/
         L     @01,BCDVPTR                                         2443
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2443
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN1    @Y30LB25*/
         BAL   @14,WRITRECD                                        2444
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2445
         LH    @06,RPLVRETC(,@06)                                  2445
         N     @06,@CF01129                                        2445
         LTR   @06,@06                                             2445
         BNZ   @RT02445                                            2445
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2446
*   /*****************************************************************/
*   /*                                                               */
*   /* GET AND UPDATE CIR FOR CSN2                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2447
*   IVOLKY=BCDCSN2;                 /* SET CSN2 TO KEY       @Y30LB25*/
         L     @06,BCDVPTR                                         2447
         MVC   IVOLKY(12),BCDCSN2(@06)                             2447
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/
         BAL   @14,READUPD1                                        2448
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2449
         LH    @06,RPLVRETC(,@06)                                  2449
         N     @06,@CF01129                                        2449
         LTR   @06,@06                                             2449
         BNZ   @RT02449                                            2449
*     RETURN;                       /*                       @Y30LB25*/
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/
         L     @06,INDEXPTR                                        2451
         L     @01,BCDVPTR                                         2451
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2451
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN2    @Y30LB25*/
         BAL   @14,WRITRECD                                        2452
*   RETURN;                         /*                       @Y30LB25*/
@EL00058 DS    0H                                                  2453
@EF00058 DS    0H                                                  2453
@ER00058 L     @14,@SA00058                                        2453
         BR    @14                                                 2453
*   END UPDCIR;                     /*                       @Y30LB25*/
         B     @EL00058                                            2454
*                                                                  2455
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - ELMACTV2                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE ELIMINATION OF AN ACTIVE                  @Y30LB25*/
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2455
*ELMACTV2:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
ELMACTV2 ST    @14,@SA00059                                        2455
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
*                                                                  2456
         BAL   @14,HOUSKEEP                                        2456
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2457
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2457
         LH    @05,RPLRCODE(,@06)                                  2457
         N     @05,@CF01129                                        2457
         LTR   @05,@05                                             2457
         BZ    @RF02457                                            2457
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2459
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/
*                                                                  2460
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2460
*       /*************************************************************/
*       /*                                                           */
*       /* ALLOW COPIES                                      @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2461
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2461
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2462
         ST    @15,RPLVKEY(,@06)                                   2462
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/
         BAL   @14,READUPD1                                        2463
*       IF RPLVRETC=FIXZERO         /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2464
         LH    @06,RPLVRETC(,@06)                                  2464
         N     @06,@CF01129                                        2464
         LTR   @06,@06                                             2464
         BNZ   @RF02464                                            2464
*         DO;                       /*                       @Y30LB25*/
*           BASEVPTR=ADDR(BASEBUF1);/*                       @Y30LB25
*                                      SET UP MAP            @Y30LB25*/
         LA    @06,BASEBUF1                                        2466
         ST    @06,BASEVPTR                                        2466
*           BASNOCPY=OFF;           /* ALLOW COPIES          @Y30LB25*/
         NI    BASNOCPY(@06),B'10111111'                           2467
*           CALL WRITRECD;          /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2468
*         END;                      /*                       @Y30LB25*/
*                                                                  2469
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2470
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
@RF02464 L     @06,RPLVPTR                                         2470
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2470
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2471
*       RETURN;                     /*                       @Y30LB25*/
@EL00059 DS    0H                                                  2472
@EF00059 DS    0H                                                  2472
@ER00059 L     @14,@SA00059                                        2472
         BR    @14                                                 2472
*     END;                          /*                       @Y30LB25*/
*                                                                  2473
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THE BVR                                        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2474
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
@RF02457 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2474
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         L     @06,RPLVPTR                                         2475
         LA    @15,BKEY                                            2475
         ST    @15,RPLVKEY(,@06)                                   2475
*   RPLVBUF=ADDR(BASEBUF);          /* BVR BUFF ADDR         @Y30LB25*/
         LA    @15,BASEBUF                                         2476
         ST    @15,RPLVBUF(,@06)                                   2476
*   RPLVBLN=LENGTH(BASEBUF);        /* BVR BUFF LENGTH       @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF01103                             2477
*   CALL DELTRECD;                  /* GET & DELETE BVR      @Y30LB25*/
         BAL   @14,DELTRECD                                        2478
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2479
         LH    @15,RPLVRETC(,@06)                                  2479
         N     @15,@CF01129                                        2479
         LTR   @15,@15                                             2479
         BNZ   @RT02479                                            2479
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2480
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THE CIR FOR CSN1                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2481
*   IVOLKY=BASCSN1;                 /* SET CSN1 IN CIR       @Y30LB25*/
         L     @01,BASEVPTR                                        2481
         MVC   IVOLKY(12),BASCSN1(@01)                             2481
*   RPLVKEY=ADDR(IKEY);             /* SET CIR KEY ADDR      @Y30LB25*/
         LA    @15,IKEY                                            2482
         ST    @15,RPLVKEY(,@06)                                   2482
*   RPLVBUF=ADDR(INDEXBUF);         /* SET BUF ADDR          @Y30LB25*/
         LA    @15,INDEXBUF                                        2483
         ST    @15,RPLVBUF(,@06)                                   2483
*   RPLVBLN=LENGTH(INDEXBUF);       /* SET BUFF LENGTH       @Y30LB25*/
         MVC   RPLVBLN(4,@06),@CF00339                             2484
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/
         BAL   @14,DELTRECD                                        2485
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/
         L     @06,RPLVPTR                                         2486
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2486
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/
*                                                                  2487
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2487
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE THE CIR FOR CSN2                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2488
*   IVOLKY=BASCSN2;                 /* SET CSN2 IN CIR       @Y30LB25*/
         L     @06,BASEVPTR                                        2488
         MVC   IVOLKY(12),BASCSN2(@06)                             2488
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/
         BAL   @14,DELTRECD                                        2489
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/
         L     @06,RPLVPTR                                         2490
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2490
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/
*                                                                  2491
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2491
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF GVR NEEDS PROCESSING                         @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2492
*   IF BASGRPV=ON                   /* BVR GROUPED?          @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2492
         TM    BASGRPV(@06),B'00100000'                            2492
         BNO   @RF02492                                            2492
*     DO;                           /*                       @Y30LB25*/
*                                                                  2493
*       /*************************************************************/
*       /*                                                           */
*       /* DECREMENT TYPE OF VOLUME COUNT AND                @Y30LB25*/
*       /* PROCESS GVR                                       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2494
*       CALL ACTGVR;                /* PROCESS GVR           @Y30LB25*/
         BAL   @14,ACTGVR                                          2494
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2495
         LH    @06,RPLVRETC(,@06)                                  2495
         N     @06,@CF01129                                        2495
         LTR   @06,@06                                             2495
         BNZ   @RT02495                                            2495
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2497
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE DELETED BVR                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2498
*   CALL PROCBVR;                   /* PROCESS BVR           @Y30LB25*/
@RF02492 BAL   @14,PROCBVR                                         2498
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00059                                            2499
*   END ELMACTV2;                   /*                       @Y30LB25*/
         B     @EL00059                                            2500
*                                                                  2501
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - DEACTV2                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* PROCESS THE DEACTIVATION OF AN ACTIVE                 @Y30LB25*/
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* RESTRICTIONS -                                        @Y30LB25*/
*   /* GROUP CHANGES DURING ACTIVATE OF A VOLUME SUCH AS -   @Y30LB25*/
*   /* CHANGING A VOLUME FROM GENERAL-USE TO RESTICTED OR    @Y30LB25*/
*   /* RESTRICTED TO GENERAL-USE, REMOVING OR ADDING A       @Y30LB25*/
*   /* VOLUME TO A GROUP, OR CHANGING A VOLUME FROM ONE      @Y30LB25*/
*   /* GROUP TO ANOTHER GROUP, WILL CAUSE INVENTORY          @Y30LB25*/
*   /* PROBLEMS.                                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2501
*DEACTV2:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2501
DEACTV2  ST    @14,@SA00060                                        2501
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2502
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2502
         LH    @15,RPLRCODE(,@06)                                  2502
         N     @15,@CF01129                                        2502
         LTR   @15,@15                                             2502
         BZ    @RF02502                                            2502
*     DO;                           /*                       @Y30LB25*/
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2504
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2505
*       RETURN;                     /*                       @Y30LB25*/
@EL00060 DS    0H                                                  2506
@EF00060 DS    0H                                                  2506
@ER00060 L     @14,@SA00060                                        2506
         BR    @14                                                 2506
*     END;                          /*                       @Y30LB25*/
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25
*                                      RESERVE .MSVI         @Y30LB25*/
*                                                                  2508
@RF02502 BAL   @14,HOUSKEEP                                        2508
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE BVR                                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2509
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2509
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            2510
         L     @01,RPLVPTR                                         2510
         ST    @06,RPLVKEY(,@01)                                   2510
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2511
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2512
         LH    @06,RPLVRETC(,@06)                                  2512
         N     @06,@CF01129                                        2512
         LTR   @06,@06                                             2512
         BNZ   @RT02512                                            2512
*     RETURN;                       /*                       @Y30LB25*/
*                                                                  2513
*   /*****************************************************************/
*   /*                                                               */
*   /* MAKE BVR REFLECT INACTIVE VOLUME                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2514
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/
         MVC   BASEBUF(224),BASEBUF1                               2514
*   BASINAC=ON;                     /* MAKE INACTIVE         @Y30LB25*/
*                                                                  2515
         L     @06,BASEVPTR                                        2515
         OI    BASINAC(@06),B'00000100'                            2515
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2516
*   IF DEFVVEXT^=FIXZERO            /* A DEFVE?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,DEFVVEXT(,DEFVPTR)                              2516
         LTR   @15,@15                                             2516
         BZ    @RF02516                                            2516
*     DO;                           /*                       @Y30LB25*/
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/
         ST    @06,BCDVPTR                                         2518
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/
         BAL   @14,PRODEFVE                                        2519
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2520
         LH    @06,RPLVRETC(,@06)                                  2520
         N     @06,@CF01129                                        2520
         LTR   @06,@06                                             2520
         BNZ   @RT02520                                            2520
*         RETURN;                   /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2522
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2523
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02516 L     @06,BASEVPTR                                        2523
         TM    BASGRPV(@06),B'00100000'                            2523
         BNO   @RF02523                                            2523
*     DO;                           /*                       @Y30LB25*/
*                                                                  2524
*       /*************************************************************/
*       /*                                                           */
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2525
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/
         MVC   GROUPKY(8),BASGROUP(@06)                            2525
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/
         LA    @06,GKEY                                            2526
         L     @01,RPLVPTR                                         2526
         ST    @06,RPLVKEY(,@01)                                   2526
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2527
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2528
         LH    @06,RPLVRETC(,@06)                                  2528
         N     @06,@CF01129                                        2528
         LTR   @06,@06                                             2528
         BNZ   @RT02528                                            2528
*         RETURN;                   /*                       @Y30LB25*/
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/
         MVC   GROUPBUF(224),BASEBUF1                              2530
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/
         L     @06,GROUPPTR                                        2531
         LA    @15,1                                               2531
         AH    @15,GRONINAC(,@06)                                  2531
         STH   @15,GRONINAC(,@06)                                  2531
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,BASEVPTR                                        2532
         TM    BASRSTD(@01),B'00001000'                            2532
         BNO   @RF02532                                            2532
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25
*                                      DECR # RSTD VOLS      @Y30LB25*/
         LH    @15,GRONRSTD(,@06)                                  2533
         BCTR  @15,0                                               2533
         STH   @15,GRONRSTD(,@06)                                  2533
*       ELSE                        /* CK GEN-USE            @Y30LB25*/
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         B     @RC02532                                            2534
@RF02532 L     @06,BASEVPTR                                        2534
         TM    BASGENUS(@06),B'00010000'                           2534
         BNO   @RF02534                                            2534
*           DO;                     /*                       @Y30LB25*/
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25
*                                      DECR # G-USE VOLS     @Y30LB25*/
*                                                                  2536
         L     @06,GROUPPTR                                        2536
         LH    @15,GRONGEN(,@06)                                   2536
         BCTR  @15,0                                               2536
         STH   @15,GRONGEN(,@06)                                   2536
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  2537
*             ADDSUBGR=OFF;         /* SUBTRACT              @Y30LB25*/
         NI    ADDSUBGR,B'11110111'                                2537
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/
         BAL   @14,VUPGH                                           2538
*           END;                    /*                       @Y30LB25*/
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/
@RF02534 DS    0H                                                  2540
@RC02532 LA    @06,GROUPBUF                                        2540
         L     @01,RPLVPTR                                         2540
         ST    @06,RPLVBUF(,@01)                                   2540
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2541
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2542
         LH    @06,RPLVRETC(,@06)                                  2542
         N     @06,@CF01129                                        2542
         LTR   @06,@06                                             2542
         BNZ   @RT02542                                            2542
*         RETURN;                   /*                       @Y30LB25*/
*                                                                  2543
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2544
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
*                                                                  2544
         L     @06,BASEVPTR                                        2544
         TM    BASGENUS(@06),B'00010000'                           2544
         BNO   @RF02544                                            2544
*         /***********************************************************/
*         /*                                                         */
*         /* DELETE A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT      */
*         /*                                                 @Y30LB25*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  2545
*         DO;                       /*                       @Y30LB25*/
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/
         NI    EXPSLOT,B'01111111'                                 2546
*           ADDSUBSL=OFF;           /* SUBTRACT              @Y30LB25*/
         NI    ADDSUBSL,B'11111101'                                2547
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2548
*                                                            @Y30LB25
*                                      CREATE A SLOT         @Y30LB25*/
         L     @15,@CV00767                                        2548
         LA    @01,@AL02548                                        2548
         BALR  @14,@15                                             2548
*           IF RPLVRETC^=FIXZERO    /*                       @Y30LB25
*                                      ERROR?                @Y30LB25*/
*             THEN                  /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2549
         LH    @06,RPLVRETC(,@06)                                  2549
         N     @06,@CF01129                                        2549
         LTR   @06,@06                                             2549
         BNZ   @RT02549                                            2549
*             RETURN;               /*                       @Y30LB25*/
*         END;                      /*                       @Y30LB25*/
*     END;                          /*                       @Y30LB25*/
*                                                                  2552
@RF02544 DS    0H                                                  2553
*   /*****************************************************************/
*   /*                                                               */
*   /* REESABLISH BVR RPL                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2553
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/
@RF02523 L     @06,BASEVPTR                                        2553
         MVC   BVOLKY(6),BASSERNO(@06)                             2553
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @06,BKEY                                            2554
         L     @01,RPLVPTR                                         2554
         ST    @06,RPLVKEY(,@01)                                   2554
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/
         BAL   @14,READUPD1                                        2555
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @06,RPLVPTR                                         2556
         LH    @15,RPLVRETC(,@06)                                  2556
         N     @15,@CF01129                                        2556
         LTR   @15,@15                                             2556
         BNZ   @RT02556                                            2556
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/
         LA    @15,BASEBUF                                         2558
         ST    @15,RPLVBUF(,@06)                                   2558
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2559
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00060                                            2560
*   END DEACTV2;                    /*                       @Y30LB25*/
         B     @EL00060                                            2561
*                                                                  2562
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY NAME - ICBVUCHI                                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR INTO EITHER A GROUP VOLUME     @Y30LB25*/
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/
*   /* (BVR) WHICH WAS CHAINED IN TO EITHER THE GVR OR       @Y30LB25*/
*   /* NGVR. ALSO, IF THE BVR WAS CHAINED IN THE GVR,        @Y30LB25*/
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2562
*ICBVUCHI:                          /*                       @Y30LB25*/
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/
*                                                                  2562
@EP02562 MVC   @PC00001(16),0(@01)                                 2562
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2563
*   DCL                                                            2563
*     PTRGROUP PTR(31);             /* PTR TO GVR            @Y30LB25*/
*   DCL                                                            2564
*     PTRBASEV PTR(31);             /* PTR TO BVR            @Y30LB25*/
*   DCL                                                            2565
*     PTRRPLV PTR(31);              /* RPLV PTR              @Y30LB25*/
*   DCL                                                            2566
*     BYTEPASS CHAR(2);             /* GVR OR NGVR           @Y30LB25
*                                      ADD OR SUBTRACT       @Y30LB25*/
*                                                                  2566
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2567
*   DCL                                                            2567
*     BASEBUF1 CHAR(LENGTH(BASEV)); /* BVR BUFFER            @Y30LB25*/
*   DCL                                                            2568
*     SAVSERNO CHAR(6);             /* SAVE SERNO            @Y30LB25*/
*   DCL                                                            2569
*     SAVSERN1 CHAR(6);             /* SAVE NEXT SERNO       @Y30LB25*/
*   DCL                                                            2570
*     SAVBASPT PTR(31);             /* SAVE BVR PTR          @Y30LB25*/
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/
         L     @06,@PC00001                                        2571
         L     @06,PTRGROUP(,@06)                                  2571
         ST    @06,GROUPPTR                                        2571
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/
         L     @06,@PC00001+4                                      2572
         L     @06,PTRBASEV(,@06)                                  2572
         ST    @06,BASEVPTR                                        2572
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/
         L     @06,@PC00001+8                                      2573
         L     @06,PTRRPLV(,@06)                                   2573
         ST    @06,RPLVPTR                                         2573
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/
         L     @06,@PC00001+12                                     2574
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2574
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/
         MVI   DIDKY,X'01'                                         2575
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/
         MVI   CIDKY,X'01'                                         2576
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/
         BAL   @14,VUCHI                                           2577
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00001                                            2578
*                                                                  2579
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE VUCHI IS CODED SO THAT COMMON ENTRY         @Y30LB25*/
*   /* CODE IN ICBVUCHI CAN BE USED BY THIS MODULE           @Y30LB25*/
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/
*   /* ENTRY ICBVUCHI. THIS MODULE CALLS PROCEDURE           @Y30LB25*/
*   /* VUCHI.                                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2579
*VUCHI:                             /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
VUCHI    ST    @14,@SA00061                                        2579
*   SAVBASPT=BASEVPTR;              /* SAVE BVR PTR          @Y30LB25*/
         L     SAVBASPT,BASEVPTR                                   2580
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/
         LA    NGVRPTR,NGVRBUF                                     2581
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    GRPFLG,B'00010000'                                  2582
         BNO   @RF02582                                            2582
*     DO;                           /*                       @Y30LB25*/
*       CALL PROCGVRI;              /* PROCESS GVR           @Y30LB25*/
         BAL   @14,PROCGVRI                                        2584
*       RETURN;                     /*                       @Y30LB25*/
@EL00061 DS    0H                                                  2585
@EF00061 DS    0H                                                  2585
@ER00061 L     @14,@SA00061                                        2585
         BR    @14                                                 2585
*     END;                          /*                       @Y30LB25*/
*                                                                  2586
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2587
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/
@RF02582 LA    @03,NGKEY                                           2587
         L     @01,RPLVPTR                                         2587
         ST    @03,RPLVKEY(,@01)                                   2587
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/
         BAL   @14,READUPD1                                        2588
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2589
         LH    @15,RPLVRETC(,@03)                                  2589
         N     @15,@CF01129                                        2589
         LTR   @15,@15                                             2589
         BNZ   @RT02589                                            2589
*     RETURN;                       /*                       @Y30LB25*/
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
         MVC   NGVRBUF(224),BASEBUF1                               2591
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR FOR WRITE    @Y30LB25*/
*                                                                  2592
         LA    @15,NGVRBUF                                         2592
         ST    @15,RPLVBUF(,@03)                                   2592
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE NGVR CHAIN. @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2593
*   IF NGVNOVOL=FIXZERO             /* ANY VOLS IN CHAIN?    @Y30LB25*/
*     THEN                          /* NO                    @Y30LB25*/
         LH    @03,NGVNOVOL(,NGVRPTR)                              2593
         LTR   @03,@03                                             2593
         BNZ   @RF02593                                            2593
*     DO;                           /*                       @Y30LB25*/
*       BASFIRST=ON;                /* FIRST IN CHAIN        @Y30LB25*/
*       BASLAST=ON;                 /* ALSO LAST IN CHAIN    @Y30LB25*/
         L     @06,BASEVPTR                                        2596
         OI    BASFIRST(@06),B'00011000'                           2596
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/
         MVI   BASPREV+1(@06),C' '                                 2597
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2597
         MVI   BASPREV(@06),C' '                                   2597
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/
         MVI   BASNEXTV+1(@06),C' '                                2598
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2598
         MVI   BASNEXTV(@06),C' '                                  2598
*       NGVFVOL=BASSERNO;           /* 1ST SERIAL #          @Y30LB25*/
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@06)                    2599
*       NGVLVOL=BASSERNO;           /* LAST SERIAL #         @Y30LB25*/
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@06)                    2600
*       NGVNOVOL=FIXONE;            /* 1 VOL IN CHAIN        @Y30LB25*/
         MVC   NGVNOVOL(2,NGVRPTR),@CH00046                        2601
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2602
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00061                                            2603
*     END;                          /*                       @Y30LB25*/
*                                                                  2604
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2605
*   IF BASSERNO<NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02593 L     @03,BASEVPTR                                        2605
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2605
         BNL   @RF02605                                            2605
*     DO;                           /*                       @Y30LB25*/
*       BASNEXTV=NGVFVOL;           /* PT TO OLD 1ST BVR     @Y30LB25*/
         MVC   BASNEXTV(6,@03),NGVFVOL(NGVRPTR)                    2607
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/
         MVI   BASPREV+1(@03),C' '                                 2608
         MVC   BASPREV+2(4,@03),BASPREV+1(@03)                     2608
         MVI   BASPREV(@03),C' '                                   2608
*       NGVFVOL=BASSERNO;           /* NEW 1ST BVR           @Y30LB25*/
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@03)                    2609
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/
*       BASLAST=OFF;                /* NOT LAST IN CHAIN     @Y30LB25*/
         OI    BASFIRST(@03),B'00010000'                           2611
         NI    BASLAST(@03),B'11110111'                            2611
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/
         LA    @03,1                                               2612
         AH    @03,NGVNOVOL(,NGVRPTR)                              2612
         STH   @03,NGVNOVOL(,NGVRPTR)                              2612
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2613
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2614
         LH    @15,RPLVRETC(,@03)                                  2614
         N     @15,@CF01129                                        2614
         LTR   @15,@15                                             2614
         BNZ   @RT02614                                            2614
*         RETURN;                   /*                       @Y30LB25*/
*       BVOLKY=BASNEXTV;            /* KEY - OLD 1ST BVR     @Y30LB25*/
         L     @01,BASEVPTR                                        2616
         MVC   BVOLKY(6),BASNEXTV(@01)                             2616
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2617
         ST    @15,RPLVKEY(,@03)                                   2617
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/
         BAL   @14,READUPD1                                        2618
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2619
         LH    @03,RPLVRETC(,@03)                                  2619
         N     @03,@CF01129                                        2619
         LTR   @03,@03                                             2619
         BNZ   @RT02619                                            2619
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/
         LA    @03,BASEBUF1                                        2621
         ST    @03,BASEVPTR                                        2621
*       BASFIRST=OFF;               /* 1ST IN CHAIN OFF      @Y30LB25*/
         NI    BASFIRST(@03),B'11101111'                           2622
*       BASPREV=NGVFVOL;            /* PT BACK CHAIN         @Y30LB25*/
         MVC   BASPREV(6,@03),NGVFVOL(NGVRPTR)                     2623
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2624
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2625
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00061                                            2626
*     END;                          /*                       @Y30LB25*/
*                                                                  2627
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2628
*   IF BASSERNO>NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02605 L     @03,BASEVPTR                                        2628
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2628
         BNH   @RF02628                                            2628
*     DO;                           /*                       @Y30LB25*/
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/
         MVI   BASNEXTV+1(@03),C' '                                2630
         MVC   BASNEXTV+2(4,@03),BASNEXTV+1(@03)                   2630
         MVI   BASNEXTV(@03),C' '                                  2630
*       BASPREV=NGVLVOL;            /* PT TO OLD LAST        @Y30LB25
*                                      IN CHAIN              @Y30LB25*/
         MVC   BASPREV(6,@03),NGVLVOL(NGVRPTR)                     2631
*       NGVLVOL=BASSERNO;           /* NEW LAST BVR          @Y30LB25*/
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@03)                    2632
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/
*       BASLAST=ON;                 /* SET LAST FLAG         @Y30LB25*/
         OI    BASLAST(@03),B'00001000'                            2634
         NI    BASFIRST(@03),B'11101111'                           2634
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/
         LA    @03,1                                               2635
         AH    @03,NGVNOVOL(,NGVRPTR)                              2635
         STH   @03,NGVNOVOL(,NGVRPTR)                              2635
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2636
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2637
         LH    @15,RPLVRETC(,@03)                                  2637
         N     @15,@CF01129                                        2637
         LTR   @15,@15                                             2637
         BNZ   @RT02637                                            2637
*         RETURN;                   /*                       @Y30LB25*/
*       BVOLKY=BASPREV;             /* GET OLD LAST BVR      @Y30LB25*/
         L     @01,BASEVPTR                                        2639
         MVC   BVOLKY(6),BASPREV(@01)                              2639
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2640
         ST    @15,RPLVKEY(,@03)                                   2640
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/
         BAL   @14,READUPD1                                        2641
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2642
         LH    @03,RPLVRETC(,@03)                                  2642
         N     @03,@CF01129                                        2642
         LTR   @03,@03                                             2642
         BNZ   @RT02642                                            2642
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/
         LA    @03,BASEBUF1                                        2644
         ST    @03,BASEVPTR                                        2644
*       BASLAST=OFF;                /* LAST IN CHAIN OFF     @Y30LB25*/
         NI    BASLAST(@03),B'11110111'                            2645
*       BASNEXTV=NGVLVOL;           /* PT AHEAD CHAIN        @Y30LB25*/
         MVC   BASNEXTV(6,@03),NGVLVOL(NGVRPTR)                    2646
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2647
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2648
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00061                                            2649
*     END;                          /*                       @Y30LB25*/
*                                                                  2650
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2651
*   NGVNOVOL=NGVNOVOL+FIXONE;       /* INCR # CHAIN VOLS     @Y30LB25*/
@RF02628 LA    @03,1                                               2651
         AH    @03,NGVNOVOL(,NGVRPTR)                              2651
         STH   @03,NGVNOVOL(,NGVRPTR)                              2651
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2652
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2653
         LH    @03,RPLVRETC(,@03)                                  2653
         N     @03,@CF01129                                        2653
         LTR   @03,@03                                             2653
         BNZ   @RT02653                                            2653
*     RETURN;                       /*                       @Y30LB25*/
*   BVOLKY=NGVFVOL;                 /* BEGIN OF CHAIN        @Y30LB25*/
         MVC   BVOLKY(6),NGVFVOL(NGVRPTR)                          2655
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/
         BAL   @14,PROCBVRI                                        2656
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00061                                            2657
*   END VUCHI;                      /*                       @Y30LB25*/
         B     @EL00061                                            2658
*                                                                  2659
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCGVRI                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/
*   /* RECORD (GVR).                                         @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2659
*PROCGVRI:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2659
PROCGVRI ST    @14,@SA00062                                        2659
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE GVR CHAIN.  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2660
*   IF GRONGEN+GRONRSTD+GRONINAC<FIXTWO/* SET BY CALLER      @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,GROUPPTR                                        2660
         LH    @14,GRONGEN(,@15)                                   2660
         AH    @14,GRONRSTD(,@15)                                  2660
         AH    @14,GRONINAC(,@15)                                  2660
         C     @14,@CF00044                                        2660
         BNL   @RF02660                                            2660
*     DO;                           /*                       @Y30LB25*/
*       BASFIRST=ON;                /* 1ST IN CHAIN          @Y30LB25*/
*       BASLAST=ON;                 /* LAST IN CHAIN         @Y30LB25*/
         L     @06,BASEVPTR                                        2663
         OI    BASFIRST(@06),B'00011000'                           2663
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/
         MVI   BASPREV+1(@06),C' '                                 2664
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2664
         MVI   BASPREV(@06),C' '                                   2664
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/
         MVI   BASNEXTV+1(@06),C' '                                2665
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2665
         MVI   BASNEXTV(@06),C' '                                  2665
*       GROFSN=BASSERNO;            /* 1ST SERIAL NUMBER     @Y30LB25*/
         MVC   GROFSN(6,@15),BASSERNO(@06)                         2666
*       GROLSN=BASSERNO;            /* LAST SERIAL #         @Y30LB25*/
         MVC   GROLSN(6,@15),BASSERNO(@06)                         2667
*       RETURN;                     /*                       @Y30LB25*/
@EL00062 DS    0H                                                  2668
@EF00062 DS    0H                                                  2668
@ER00062 L     @14,@SA00062                                        2668
         BR    @14                                                 2668
*     END;                          /*                       @Y30LB25*/
*                                                                  2669
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2670
*   IF BASSERNO<GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02660 L     @15,BASEVPTR                                        2670
         L     @14,GROUPPTR                                        2670
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2670
         BNL   @RF02670                                            2670
*     DO;                           /*                       @Y30LB25*/
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/
         MVI   BASPREV+1(@15),C' '                                 2672
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2672
         MVI   BASPREV(@15),C' '                                   2672
*       BASNEXTV=GROFSN;            /* PT TO OLD 1ST BVR     @Y30LB25*/
         MVC   BASNEXTV(6,@15),GROFSN(@14)                         2673
*       GROFSN=BASSERNO;            /* NEW 1ST BVR           @Y30LB25*/
         MVC   GROFSN(6,@14),BASSERNO(@15)                         2674
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/
*       BASLAST=OFF;                /* NOT LAST              @Y30LB25*/
         OI    BASFIRST(@15),B'00010000'                           2676
         NI    BASLAST(@15),B'11110111'                            2676
*       BVOLKY=BASNEXTV;            /* KEY OF OLD 1ST BVR    @Y30LB25*/
         MVC   BVOLKY(6),BASNEXTV(@15)                             2677
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2678
         L     @14,RPLVPTR                                         2678
         ST    @15,RPLVKEY(,@14)                                   2678
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/
         BAL   @14,READUPD1                                        2679
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2680
         LH    @15,RPLVRETC(,@01)                                  2680
         N     @15,@CF01129                                        2680
         LTR   @15,@15                                             2680
         BNZ   @RT02680                                            2680
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/
         LA    @15,BASEBUF1                                        2682
         ST    @15,BASEVPTR                                        2682
*       BASFIRST=OFF;               /* 1ST FLAG OFF          @Y30LB25*/
         NI    BASFIRST(@15),B'11101111'                           2683
*       BASPREV=GROFSN;             /* PT TO NEW 1ST BVR     @Y30LB25*/
         L     @14,GROUPPTR                                        2684
         MVC   BASPREV(6,@15),GROFSN(@14)                          2684
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2685
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2686
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00062                                            2687
*     END;                          /*                       @Y30LB25*/
*                                                                  2688
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2689
*   IF BASSERNO>GROLSN              /* LAST IN CHAIN?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02670 L     @15,BASEVPTR                                        2689
         L     @14,GROUPPTR                                        2689
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2689
         BNH   @RF02689                                            2689
*     DO;                           /*                       @Y30LB25*/
*       BASPREV=GROLSN;             /* PT TO OLD LAST        @Y30LB25
*                                      IN CHAIN              @Y30LB25*/
         MVC   BASPREV(6,@15),GROLSN(@14)                          2691
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/
         MVI   BASNEXTV+1(@15),C' '                                2692
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2692
         MVI   BASNEXTV(@15),C' '                                  2692
*       GROLSN=BASSERNO;            /* NEW LAST BVR          @Y30LB25*/
         MVC   GROLSN(6,@14),BASSERNO(@15)                         2693
*       BASLAST=ON;                 /* LAST FLAG ON          @Y30LB25*/
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/
         OI    BASLAST(@15),B'00001000'                            2695
         NI    BASFIRST(@15),B'11101111'                           2695
*       BVOLKY=BASPREV;             /* OLD LAST BVR          @Y30LB25*/
         MVC   BVOLKY(6),BASPREV(@15)                              2696
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2697
         L     @14,RPLVPTR                                         2697
         ST    @15,RPLVKEY(,@14)                                   2697
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/
         BAL   @14,READUPD1                                        2698
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2699
         LH    @15,RPLVRETC(,@01)                                  2699
         N     @15,@CF01129                                        2699
         LTR   @15,@15                                             2699
         BNZ   @RT02699                                            2699
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD LAST BVR BUF      @Y30LB25*/
         LA    @15,BASEBUF1                                        2701
         ST    @15,BASEVPTR                                        2701
*       BASLAST=OFF;                /* LAST FLAG OFF         @Y30LB25*/
         NI    BASLAST(@15),B'11110111'                            2702
*       BASNEXTV=GROLSN;            /* PT TO NEW LAST BVR    @Y30LB25*/
         L     @14,GROUPPTR                                        2703
         MVC   BASNEXTV(6,@15),GROLSN(@14)                         2703
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2704
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2705
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00062                                            2706
*     END;                          /*                       @Y30LB25*/
*                                                                  2707
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2708
*   BVOLKY=GROFSN;                  /* 1ST IN CHAIN          @Y30LB25*/
@RF02689 L     @01,GROUPPTR                                        2708
         MVC   BVOLKY(6),GROFSN(@01)                               2708
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/
         BAL   @14,PROCBVRI                                        2709
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00062                                            2710
*   END PROCGVRI;                   /*                       @Y30LB25*/
         B     @EL00062                                            2711
*                                                                  2712
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCBVRI                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2712
*PROCBVRI:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2712
PROCBVRI ST    @14,@SA00063                                        2712
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR CHAIN IN AS SECOND IN THE CHAIN             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2713
*   SAVSERNO=BASSERNO;              /* SAVE - 1ST BVR        @Y30LB25*/
         L     @01,BASEVPTR                                        2713
         MVC   SAVSERNO(6),BASSERNO(@01)                           2713
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP FOR BUF           @Y30LB25*/
         LA    @15,BASEBUF1                                        2714
         ST    @15,BASEVPTR                                        2714
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2715
         L     @14,RPLVPTR                                         2715
         ST    @15,RPLVKEY(,@14)                                   2715
*   CALL READUPD1;                  /* READ 1ST BVR          @Y30LB25
*                                      IN CHAIN              @Y30LB25*/
         BAL   @14,READUPD1                                        2716
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2717
         LH    @15,RPLVRETC(,@01)                                  2717
         N     @15,@CF01129                                        2717
         LTR   @15,@15                                             2717
         BNZ   @RT02717                                            2717
*     RETURN;                       /*                       @Y30LB25*/
*   IF BASNEXTV>SAVSERNO            /* 2ND IN CHAIN?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,BASEVPTR                                        2719
         CLC   BASNEXTV(6,@15),SAVSERNO                            2719
         BNH   @RF02719                                            2719
*     DO;                           /*                       @Y30LB25*/
*       SAVSERN1=BASSERNO;          /* SAVE SERNO OF         @Y30LB25
*                                      BVR READ              @Y30LB25*/
         MVC   SAVSERN1(6),BASSERNO(@15)                           2721
*       CALL CHAININ;               /* CHAIN IN NEW BVR      @Y30LB25*/
         BAL   @14,CHAININ                                         2722
*       RETURN;                     /*                       @Y30LB25*/
@EL00063 DS    0H                                                  2723
@EF00063 DS    0H                                                  2723
@ER00063 L     @14,@SA00063                                        2723
         BR    @14                                                 2723
*     END;                          /*                       @Y30LB25*/
*                                                                  2724
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR TO BE CHAINED IN AFTER SECOND BVR IN THE CHAIN    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2725
*   DO WHILE BASNEXTV<SAVSERNO;     /* LOOP THRU CHAIN       @Y30LB25*/
@RF02719 B     @DE02725                                            2725
@DL02725 DS    0H                                                  2726
*     BVOLKY=BASNEXTV;              /* SAVE KEY FOR          @Y30LB25
*                                      NEXT READ             @Y30LB25*/
         L     @01,BASEVPTR                                        2726
         MVC   BVOLKY(6),BASNEXTV(@01)                             2726
*     RPLVKEY=ADDR(BKEY);           /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2727
         L     @14,RPLVPTR                                         2727
         ST    @15,RPLVKEY(,@14)                                   2727
*     CALL READUPD1;                /* READ A BVR            @Y30LB25*/
         BAL   @14,READUPD1                                        2728
*     IF RPLVRETC^=FIXZERO          /* LOOP CONTROL          @Y30LB25*/
*       THEN                        /* ERROR                 @Y30LB25*/
         L     @01,RPLVPTR                                         2729
         LH    @15,RPLVRETC(,@01)                                  2729
         N     @15,@CF01129                                        2729
         LTR   @15,@15                                             2729
         BNZ   @RT02729                                            2729
*       RETURN;                     /*                       @Y30LB25*/
*     SAVSERN1=BASSERNO;            /* SAVE SERNO OF BVR     @Y30LB25*/
         L     @01,BASEVPTR                                        2731
         MVC   SAVSERN1(6),BASSERNO(@01)                           2731
*   END;                            /*                       @Y30LB25*/
@DE02725 L     @01,BASEVPTR                                        2732
         CLC   BASNEXTV(6,@01),SAVSERNO                            2732
         BL    @DL02725                                            2732
*   CALL CHAININ;                   /* CHAIN IN NEW BVR      @Y30LB25*/
         BAL   @14,CHAININ                                         2733
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00063                                            2734
*   END PROCBVRI;                   /*                       @Y30LB25*/
         B     @EL00063                                            2735
*                                                                  2736
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - READUPD1                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION -                                            @Y30LB25*/
*   /* READ AN MSVC RECORD FOR UPDATE INTO BASEBUF1          @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* ADDRESS OF KEY TO READ IN RPLVKEY                     @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* MSVC RECORD                                           @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2736
*READUPD1:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
READUPD1 ST    @14,@SA00064                                        2736
*   RPLVBUF=ADDR(BASEBUF1);         /* ADDR OF BUF           @Y30LB25*/
         L     @03,RPLVPTR                                         2737
         LA    @15,BASEBUF1                                        2737
         ST    @15,RPLVBUF(,@03)                                   2737
*   RPLVBLN=LENGTH(BASEBUF1);       /* BVR BUF LENGTH        @Y30LB25*/
         MVC   RPLVBLN(4,@03),@CF01103                             2738
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/
         MVI   RPLVTYP(@03),X'00'                                  2739
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/
         OI    RPLVDIR(@03),B'01000000'                            2740
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/
         OI    RPLVUPD(@03),B'00000010'                            2741
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/
         NI    RPLVLOC(@03),B'01111111'                            2742
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@03                                             2744
*   CALL ICBVIO00;                  /* READ BVR              @Y30LB25*/
         L     @15,@CV00762                                        2745
         BALR  @14,@15                                             2745
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00064 DS    0H                                                  2747
@EF00064 DS    0H                                                  2747
@ER00064 L     @14,@SA00064                                        2747
         BR    @14                                                 2747
*   END READUPD1;                   /*                       @Y30LB25*/
*                                                                  2749
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - WRITRECD                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - WRITE AN MSVC RECORD.                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* MSVC RECORD                                           @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2749
*WRITRECD:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
WRITRECD ST    @14,@SA00065                                        2749
*   RPLVTYP=RPLVPUT;                /* WRITE                 @Y30LB25*/
         L     @03,RPLVPTR                                         2750
         MVI   RPLVTYP(@03),X'01'                                  2750
*   RPLVLOC=OFF;                    /* NO LOC                @Y30LB25*/
         NI    RPLVLOC(@03),B'01111111'                            2751
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/
         LR    RG1,@03                                             2753
*   CALL ICBVIO00;                  /* WRITE BVR             @Y30LB25*/
         L     @15,@CV00762                                        2754
         BALR  @14,@15                                             2754
*   RESPECIFY                       /*                       @Y30LB25*/
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/
*   RETURN;                         /*                       @Y30LB25*/
@EL00065 DS    0H                                                  2756
@EF00065 DS    0H                                                  2756
@ER00065 L     @14,@SA00065                                        2756
         BR    @14                                                 2756
*   END WRITRECD;                   /*                       @Y30LB25*/
*                                                                  2758
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - CHAININ                              @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR INTO TNE CHAIN OF BVRS OFF     @Y30LB25*/
*   /* OF EITHER THE GROUP VOLUME RECORD (GVR) OR NON-GROUP  @Y30LB25*/
*   /* VOLUME RECORD (NGVR).                                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2758
*CHAININ:                           /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
CHAININ  ST    @14,@SA00066                                        2758
*   BVOLKY=BASNEXTV;                /* SET KEY FOR           @Y30LB25
*                                      NEXT READ             @Y30LB25*/
         L     @15,BASEVPTR                                        2759
         MVC   BVOLKY(6),BASNEXTV(@15)                             2759
*   BASNEXTV=SAVSERNO;              /* PT TO NEW BVR         @Y30LB25*/
         MVC   BASNEXTV(6,@15),SAVSERNO                            2760
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2761
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES?                  @Y30LB25*/
         L     @15,RPLVPTR                                         2762
         LH    @14,RPLVRETC(,@15)                                  2762
         N     @14,@CF01129                                        2762
         LTR   @14,@14                                             2762
         BNZ   @RT02762                                            2762
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @14,BKEY                                            2764
         ST    @14,RPLVKEY(,@15)                                   2764
*   CALL READUPD1;                  /* READ NEXT BVR IN      @Y30LB25
*                                      CHAIN                 @Y30LB25*/
         BAL   @14,READUPD1                                        2765
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES?                  @Y30LB25*/
         L     @01,RPLVPTR                                         2766
         LH    @15,RPLVRETC(,@01)                                  2766
         N     @15,@CF01129                                        2766
         LTR   @15,@15                                             2766
         BNZ   @RT02766                                            2766
*     RETURN;                       /*                       @Y30LB25*/
*   BASPREV=SAVSERNO;               /* PT BACK TO NEW BVR    @Y30LB25*/
         L     @01,BASEVPTR                                        2768
         MVC   BASPREV(6,@01),SAVSERNO                             2768
*   CALL WRITRECD;                  /* WTITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2769
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES?                  @Y30LB25*/
         L     @01,RPLVPTR                                         2770
         LH    @15,RPLVRETC(,@01)                                  2770
         N     @15,@CF01129                                        2770
         LTR   @15,@15                                             2770
         BNZ   @RT02770                                            2770
*     RETURN;                       /*                       @Y30LB25*/
*   BASEVPTR=SAVBASPT;              /* PT TO NEW BVR         @Y30LB25*/
*                                                                  2772
         ST    SAVBASPT,BASEVPTR                                   2772
*   /*****************************************************************/
*   /*                                                               */
*   /* CHAIN IN NEW BVR                                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2773
*   BASFIRST=OFF;                   /* NOT 1ST IN CHAIN      @Y30LB25*/
*   BASLAST=OFF;                    /* NOT LAST IN CHAIN     @Y30LB25*/
         L     @06,BASEVPTR                                        2774
         NI    BASFIRST(@06),B'11100111'                           2774
*   BASPREV=SAVSERN1;               /* CHAIN BACK            @Y30LB25*/
         MVC   BASPREV(6,@06),SAVSERN1                             2775
*   BASNEXTV=BVOLKY;                /* CHAIN AHEAD           @Y30LB25*/
         MVC   BASNEXTV(6,@06),BVOLKY                              2776
*   RETURN;                         /*                       @Y30LB25*/
@EL00066 DS    0H                                                  2777
@EF00066 DS    0H                                                  2777
@ER00066 L     @14,@SA00066                                        2777
         BR    @14                                                 2777
*   END CHAININ;                    /*                       @Y30LB25*/
         B     @EL00066                                            2778
*                                                                  2779
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY NAME - ICBVUCHO                                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR OUT OF EITHER A GROUP VOLUME   @Y30LB25*/
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/
*   /* (BVR) WHICH WAS CHAINED OUT OF EITHER THE GVR OR      @Y30LB25*/
*   /* NGVR. ALSO, IF THE BVR IS CHAINED IN THE GVR,         @Y30LB25*/
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2779
*ICBVUCHO:                          /*                       @Y30LB25*/
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/
*                                                                  2779
@EP02779 MVC   @PC00001(16),0(@01)                                 2779
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2780
*   DCL                                                            2780
*     SAVPREV CHAR(6);              /* SAVE PREV SERNO       @Y30LB25*/
*   DCL                                                            2781
*     SAVNEXT CHAR(6);              /* SAVE NEXT SERNO       @Y30LB25*/
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/
         L     @06,@PC00001                                        2782
         L     @06,PTRGROUP(,@06)                                  2782
         ST    @06,GROUPPTR                                        2782
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/
         L     @06,@PC00001+4                                      2783
         L     @06,PTRBASEV(,@06)                                  2783
         ST    @06,BASEVPTR                                        2783
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/
         L     @06,@PC00001+8                                      2784
         L     @06,PTRRPLV(,@06)                                   2784
         ST    @06,RPLVPTR                                         2784
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/
         L     @06,@PC00001+12                                     2785
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2785
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/
         MVI   DIDKY,X'01'                                         2786
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/
         MVI   CIDKY,X'01'                                         2787
*   CALL VUCHO;                     /* CHAIN OUT BVR         @Y30LB25*/
         BAL   @14,VUCHO                                           2788
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00001                                            2789
*                                                                  2790
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE VUCHO IS CODED SO THAT COMMON ENTRY         @Y30LB25*/
*   /* CODE IN ICBVUCHO CAN BE USED BY THIS MODULE           @Y30LB25*/
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/
*   /* ENTRY ICBVUCHO. THIS MODULE CALLS PROCEDURE           @Y30LB25*/
*   /* VUCHO.                                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2790
*VUCHO:                             /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
VUCHO    ST    @14,@SA00067                                        2790
*   SAVBASPT=BASEVPTR;              /* SAVE BUF PTR          @Y30LB25*/
         L     SAVBASPT,BASEVPTR                                   2791
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/
         LA    NGVRPTR,NGVRBUF                                     2792
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    GRPFLG,B'00010000'                                  2793
         BNO   @RF02793                                            2793
*     DO;                           /*                       @Y30LB25*/
*       CALL PROCGVRO;              /* PROCESS GVR           @Y30LB25*/
         BAL   @14,PROCGVRO                                        2795
*       BASEVPTR=SAVBASPT;          /* RESTORE BVR PTR       @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2796
*       RETURN;                     /*                       @Y30LB25*/
@EL00067 DS    0H                                                  2797
@EF00067 DS    0H                                                  2797
@ER00067 L     @14,@SA00067                                        2797
         BR    @14                                                 2797
*     END;                          /*                       @Y30LB25*/
*                                                                  2798
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2799
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/
@RF02793 LA    @03,NGKEY                                           2799
         L     @01,RPLVPTR                                         2799
         ST    @03,RPLVKEY(,@01)                                   2799
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/
         BAL   @14,READUPD1                                        2800
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @03,RPLVPTR                                         2801
         LH    @15,RPLVRETC(,@03)                                  2801
         N     @15,@CF01129                                        2801
         LTR   @15,@15                                             2801
         BNZ   @RT02801                                            2801
*     RETURN;                       /*                       @Y30LB25*/
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR              @Y30LB25*/
         LA    @15,NGVRBUF                                         2803
         ST    @15,RPLVBUF(,@03)                                   2803
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/
*                                                                  2804
         MVC   NGVRBUF(224),BASEBUF1                               2804
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2805
*   IF BASSERNO=NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @03,BASEVPTR                                        2805
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2805
         BNE   @RF02805                                            2805
*     DO;                           /*                       @Y30LB25*/
*       NGVFVOL=BASNEXTV;           /* PT TO NEW 1ST BVR     @Y30LB25*/
         MVC   NGVFVOL(6,NGVRPTR),BASNEXTV(@03)                    2807
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/
*                                                                  2808
         LH    @03,NGVNOVOL(,NGVRPTR)                              2808
         BCTR  @03,0                                               2808
         STH   @03,NGVNOVOL(,NGVRPTR)                              2808
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2809
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/
         LTR   @03,@03                                             2809
         BNZ   @RF02809                                            2809
*         DO;                       /*                       @Y30LB25*/
*           NGVLVOL=BLANK6;         /* NO LAST VOL           @Y30LB25*/
         MVI   NGVLVOL+1(NGVRPTR),C' '                             2811
         MVC   NGVLVOL+2(4,NGVRPTR),NGVLVOL+1(NGVRPTR)             2811
         MVI   NGVLVOL(NGVRPTR),C' '                               2811
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2812
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00067                                            2813
*         END;                      /*                       @Y30LB25*/
*                                                                  2814
*       /*************************************************************/
*       /*                                                           */
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2815
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/
@RF02809 BAL   @14,WRITRECD                                        2815
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         2816
         LH    @14,RPLVRETC(,@15)                                  2816
         N     @14,@CF01129                                        2816
         LTR   @14,@14                                             2816
         BNZ   @RT02816                                            2816
*         RETURN;                   /*                       @Y30LB25*/
*       BVOLKY=BASNEXTV;            /* KEY - NEW 1ST BVR     @Y30LB25*/
         L     @01,BASEVPTR                                        2818
         MVC   BVOLKY(6),BASNEXTV(@01)                             2818
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @14,BKEY                                            2819
         ST    @14,RPLVKEY(,@15)                                   2819
*       CALL READUPD1;              /* GET NEW 1ST BVR       @Y30LB25*/
         BAL   @14,READUPD1                                        2820
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2821
         LH    @15,RPLVRETC(,@01)                                  2821
         N     @15,@CF01129                                        2821
         LTR   @15,@15                                             2821
         BNZ   @RT02821                                            2821
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/
         LA    @15,BASEBUF1                                        2823
         ST    @15,BASEVPTR                                        2823
*       BASFIRST=ON;                /* 1ST IN CHAIN ON       @Y30LB25*/
         OI    BASFIRST(@15),B'00010000'                           2824
*       BASPREV=BLANK6;             /* NULL PT BACK          @Y30LB25*/
         MVI   BASPREV+1(@15),C' '                                 2825
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2825
         MVI   BASPREV(@15),C' '                                   2825
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2826
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2827
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00067                                            2828
*     END;                          /*                       @Y30LB25*/
*                                                                  2829
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2830
*   IF BASSERNO=NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02805 L     @03,BASEVPTR                                        2830
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2830
         BNE   @RF02830                                            2830
*     DO;                           /*                       @Y30LB25*/
*       NGVLVOL=BASPREV;            /* PT TO NEW LAST        @Y30LB25
*                                      IN CHAIN              @Y30LB25*/
         MVC   NGVLVOL(6,NGVRPTR),BASPREV(@03)                     2832
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/
*                                                                  2833
         LH    @03,NGVNOVOL(,NGVRPTR)                              2833
         BCTR  @03,0                                               2833
         STH   @03,NGVNOVOL(,NGVRPTR)                              2833
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2834
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/
         LTR   @03,@03                                             2834
         BNZ   @RF02834                                            2834
*         DO;                       /*                       @Y30LB25*/
*           NGVFVOL=BLANK6;         /* NO FIRST VOL          @Y30LB25*/
         MVI   NGVFVOL+1(NGVRPTR),C' '                             2836
         MVC   NGVFVOL+2(4,NGVRPTR),NGVFVOL+1(NGVRPTR)             2836
         MVI   NGVFVOL(NGVRPTR),C' '                               2836
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2837
*           RETURN;                 /*                       @Y30LB25*/
         B     @EL00067                                            2838
*         END;                      /*                       @Y30LB25*/
*                                                                  2839
*       /*************************************************************/
*       /*                                                           */
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2840
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/
@RF02834 BAL   @14,WRITRECD                                        2840
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         2841
         LH    @14,RPLVRETC(,@15)                                  2841
         N     @14,@CF01129                                        2841
         LTR   @14,@14                                             2841
         BNZ   @RT02841                                            2841
*         RETURN;                   /*                       @Y30LB25*/
*       BVOLKY=BASPREV;             /* GET NEW LAST BVR      @Y30LB25*/
         L     @01,BASEVPTR                                        2843
         MVC   BVOLKY(6),BASPREV(@01)                              2843
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/
         LA    @14,BKEY                                            2844
         ST    @14,RPLVKEY(,@15)                                   2844
*       CALL READUPD1;              /* READ NEW LAST BVR     @Y30LB25*/
         BAL   @14,READUPD1                                        2845
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2846
         LH    @15,RPLVRETC(,@01)                                  2846
         N     @15,@CF01129                                        2846
         LTR   @15,@15                                             2846
         BNZ   @RT02846                                            2846
*         RETURN;                   /*                       @Y30LB25*/
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/
         LA    @15,BASEBUF1                                        2848
         ST    @15,BASEVPTR                                        2848
*       BASLAST=ON;                 /* LAST IN CHAIN ON      @Y30LB25*/
         OI    BASLAST(@15),B'00001000'                            2849
*       BASNEXTV=BLANK6;            /* NULL PT AHEAD         @Y30LB25*/
         MVI   BASNEXTV+1(@15),C' '                                2850
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2850
         MVI   BASNEXTV(@15),C' '                                  2850
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2851
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2852
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00067                                            2853
*     END;                          /*                       @Y30LB25*/
*                                                                  2854
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2855
*   NGVNOVOL=NGVNOVOL-FIXONE;       /* DECR # CHAIN VOLS     @Y30LB25*/
@RF02830 LH    @03,NGVNOVOL(,NGVRPTR)                              2855
         BCTR  @03,0                                               2855
         STH   @03,NGVNOVOL(,NGVRPTR)                              2855
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/
         BAL   @14,WRITRECD                                        2856
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2857
         LH    @15,RPLVRETC(,@01)                                  2857
         N     @15,@CF01129                                        2857
         LTR   @15,@15                                             2857
         BNZ   @RT02857                                            2857
*     RETURN;                       /*                       @Y30LB25*/
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/
         BAL   @14,PROCBVRO                                        2859
*   BASEVPTR=SAVBASPT;              /* RESTORE BVR PTR       @Y30LB25*/
         ST    SAVBASPT,BASEVPTR                                   2860
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00067                                            2861
*   END VUCHO;                      /*                       @Y30LB25*/
         B     @EL00067                                            2862
*                                                                  2863
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCGVRO                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/
*   /* RECORD (GVR).                                         @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2863
*PROCGVRO:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2863
PROCGVRO ST    @14,@SA00068                                        2863
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2864
*   IF BASSERNO=GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
*                                                                  2864
         L     @15,BASEVPTR                                        2864
         L     @14,GROUPPTR                                        2864
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2864
         BNE   @RF02864                                            2864
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR NO BVRS IN THE CHAIN.                     @Y30LB25*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  2865
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/
         LH    @03,GRONGEN(,@14)                                   2865
         AH    @03,GRONRSTD(,@14)                                  2865
         AH    @03,GRONINAC(,@14)                                  2865
         LTR   @03,@03                                             2865
         BNP   @RF02865                                            2865
*       DO;                         /*                       @Y30LB25*/
*         GROFSN=BASNEXTV;          /* PT TO NEW 1ST BVR     @Y30LB25*/
         MVC   GROFSN(6,@14),BASNEXTV(@15)                         2867
*         BVOLKY=BASNEXTV;          /* KEY OF NEW 1ST BVR    @Y30LB25*/
         MVC   BVOLKY(6),BASNEXTV(@15)                             2868
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2869
         L     @14,RPLVPTR                                         2869
         ST    @15,RPLVKEY(,@14)                                   2869
*         CALL READUPD1;            /* GET NEW 1ST BVR       @Y30LB25*/
         BAL   @14,READUPD1                                        2870
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2871
         LH    @15,RPLVRETC(,@01)                                  2871
         N     @15,@CF01129                                        2871
         LTR   @15,@15                                             2871
         BNZ   @RT02871                                            2871
*           RETURN;                 /*                       @Y30LB25*/
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW 1ST BVR BUF       @Y30LB25*/
         LA    @15,BASEBUF1                                        2873
         ST    @15,BASEVPTR                                        2873
*         BASFIRST=ON;              /* 1ST FLAG ON           @Y30LB25*/
         OI    BASFIRST(@15),B'00010000'                           2874
*         BASPREV=BLANK6;           /* NULL PREV PTR         @Y30LB25*/
         MVI   BASPREV+1(@15),C' '                                 2875
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2875
         MVI   BASPREV(@15),C' '                                   2875
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2876
*         RETURN;                   /*                       @Y30LB25*/
@EL00068 DS    0H                                                  2877
@EF00068 DS    0H                                                  2877
@ER00068 L     @14,@SA00068                                        2877
         BR    @14                                                 2877
*       END;                        /*                       @Y30LB25*/
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/
*       DO;                         /*                       @Y30LB25*/
@RF02865 DS    0H                                                  2880
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/
         L     @15,GROUPPTR                                        2880
         MVI   GROFSN+1(@15),C' '                                  2880
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2880
         MVI   GROFSN(@15),C' '                                    2880
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/
         MVI   GROLSN+1(@15),C' '                                  2881
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2881
         MVI   GROLSN(@15),C' '                                    2881
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00068                                            2882
*       END;                        /*                       @Y30LB25*/
*                                                                  2883
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2884
*   IF BASSERNO=GROLSN              /* LAST IN CHAIN?        @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
@RF02864 L     @15,BASEVPTR                                        2884
         L     @14,GROUPPTR                                        2884
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2884
         BNE   @RF02884                                            2884
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/
         LH    @03,GRONGEN(,@14)                                   2885
         AH    @03,GRONRSTD(,@14)                                  2885
         AH    @03,GRONINAC(,@14)                                  2885
         LTR   @03,@03                                             2885
         BNP   @RF02885                                            2885
*       DO;                         /*                       @Y30LB25*/
*         GROLSN=BASPREV;           /* PT TO NEW LAST        @Y30LB25
*                                      IN CHAIN              @Y30LB25*/
         MVC   GROLSN(6,@14),BASPREV(@15)                          2887
*         BVOLKY=BASPREV;           /* NEW LAST BVR          @Y30LB25*/
         MVC   BVOLKY(6),BASPREV(@15)                              2888
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2889
         L     @14,RPLVPTR                                         2889
         ST    @15,RPLVKEY(,@14)                                   2889
*         CALL READUPD1;            /* GET NEW LAST BVR      @Y30LB25*/
         BAL   @14,READUPD1                                        2890
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/
*           THEN                    /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2891
         LH    @15,RPLVRETC(,@01)                                  2891
         N     @15,@CF01129                                        2891
         LTR   @15,@15                                             2891
         BNZ   @RT02891                                            2891
*           RETURN;                 /*                       @Y30LB25*/
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW LAST BVR BUF      @Y30LB25*/
         LA    @15,BASEBUF1                                        2893
         ST    @15,BASEVPTR                                        2893
*         BASLAST=ON;               /* LAST FLAG ON          @Y30LB25*/
         OI    BASLAST(@15),B'00001000'                            2894
*         BASNEXTV=BLANK6;          /* NULL NEXT PTR         @Y30LB25*/
         MVI   BASNEXTV+1(@15),C' '                                2895
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2895
         MVI   BASNEXTV(@15),C' '                                  2895
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2896
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00068                                            2897
*       END;                        /*                       @Y30LB25*/
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/
*       DO;                         /*                       @Y30LB25*/
@RF02885 DS    0H                                                  2900
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/
         L     @15,GROUPPTR                                        2900
         MVI   GROFSN+1(@15),C' '                                  2900
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2900
         MVI   GROFSN(@15),C' '                                    2900
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/
         MVI   GROLSN+1(@15),C' '                                  2901
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2901
         MVI   GROLSN(@15),C' '                                    2901
*         RETURN;                   /*                       @Y30LB25*/
         B     @EL00068                                            2902
*       END;                        /*                       @Y30LB25*/
*                                                                  2903
*   /*****************************************************************/
*   /*                                                               */
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2904
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/
@RF02884 BAL   @14,PROCBVRO                                        2904
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00068                                            2905
*   END PROCGVRO;                   /*                       @Y30LB25*/
         B     @EL00068                                            2906
*                                                                  2907
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE NAME - PROCBVRO                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/
*   /* BASE VOLUME RECORD                                    @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/
*   /* AN ERROR                                              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2907
*PROCBVRO:                          /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
PROCBVRO ST    @14,@SA00069                                        2907
*   SAVPREV=BASPREV;                /* SAVE PREV SERNO       @Y30LB25*/
         L     @15,BASEVPTR                                        2908
         MVC   SAVPREV(6),BASPREV(@15)                             2908
*   SAVNEXT=BASNEXTV;               /* SAVE NEXT SERNO       @Y30LB25*/
         MVC   SAVNEXT(6),BASNEXTV(@15)                            2909
*   BASEVPTR=ADDR(BASEBUF1);        /* NEW READ BUF          @Y30LB25*/
*                                                                  2910
         LA    @15,BASEBUF1                                        2910
         ST    @15,BASEVPTR                                        2910
*   /*****************************************************************/
*   /*                                                               */
*   /* RECHAIN PREVIOUS BVR TO THE NEXT BVR                  @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2911
*   BVOLKY=SAVPREV;                 /* SERNO OF PREV BVR     @Y30LB25*/
         MVC   BVOLKY(6),SAVPREV                                   2911
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @15,BKEY                                            2912
         L     @14,RPLVPTR                                         2912
         ST    @15,RPLVKEY(,@14)                                   2912
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/
         BAL   @14,READUPD1                                        2913
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2914
         LH    @15,RPLVRETC(,@01)                                  2914
         N     @15,@CF01129                                        2914
         LTR   @15,@15                                             2914
         BNZ   @RT02914                                            2914
*     RETURN;                       /*                       @Y30LB25*/
*   BASNEXTV=SAVNEXT;               /* PT TO NEW NEXT BVR    @Y30LB25*/
         L     @01,BASEVPTR                                        2916
         MVC   BASNEXTV(6,@01),SAVNEXT                             2916
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2917
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @15,RPLVPTR                                         2918
         LH    @14,RPLVRETC(,@15)                                  2918
         N     @14,@CF01129                                        2918
         LTR   @14,@14                                             2918
         BNZ   @RT02918                                            2918
*     RETURN;                       /*                       @Y30LB25*/
*   BVOLKY=SAVNEXT;                 /* SERNO NEXT BVR        @Y30LB25*/
         MVC   BVOLKY(6),SAVNEXT                                   2920
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/
         LA    @14,BKEY                                            2921
         ST    @14,RPLVKEY(,@15)                                   2921
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/
         BAL   @14,READUPD1                                        2922
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         L     @01,RPLVPTR                                         2923
         LH    @15,RPLVRETC(,@01)                                  2923
         N     @15,@CF01129                                        2923
         LTR   @15,@15                                             2923
         BNZ   @RT02923                                            2923
*     RETURN;                       /*                       @Y30LB25*/
*   BASPREV=SAVPREV;                /* PT TO NEW PREV BVR    @Y30LB25*/
         L     @01,BASEVPTR                                        2925
         MVC   BASPREV(6,@01),SAVPREV                              2925
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/
         BAL   @14,WRITRECD                                        2926
*   RETURN;                         /*                       @Y30LB25*/
@EL00069 DS    0H                                                  2927
@EF00069 DS    0H                                                  2927
@ER00069 L     @14,@SA00069                                        2927
         BR    @14                                                 2927
*   END PROCBVRO;                   /*                       @Y30LB25*/
         B     @EL00069                                            2928
*                                                                  2929
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTRY NAME - ICBVUPGH                                 @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* FUNCTION - UPDATE THE GROUP THRESHOLD, GROUP FREE     @Y30LB25*/
*   /* SPACE, AND/OR GROUP FREE EXTENTS FOR ACTIVE, GROUPED, @Y30LB25*/
*   /* GENERAL-USE VOLUMES. THE CALLER                       @Y30LB25*/
*   /* MUST FIRST UPDATE THE COUNT OF GENERAL-USE VOLUMES    @Y30LB25*/
*   /* IN THE GROUP                                          @Y30LB25*/
*   /* VOLUME RECORD (GVR) BEFORE CALLING THIS ROUTINE.      @Y30LB25*/
*   /* GROUP FREE SPACE AND GROUP FREE EXTENTS ARE           @Y30LB25*/
*   /* INCREMENTED OR DECREMENTED DEPENDING ON HOW           @Y30LB25*/
*   /* ADDSUBGR FLAG IN PASSBYTE IS SET.                     @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* INPUT -                                               @Y30LB25*/
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR                   @Y30LB25*/
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/
*   /* INDICATES ADD OR SUBTRACT                             @Y30LB25*/
*   /*                                                       @Y30LB25*/
*   /* OUTPUT -                                              @Y30LB25*/
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2929
*ICBVUPGH:                          /*                       @Y30LB25*/
*   ENTRY(PTRGROUP,PTRBASEV,BYTEPASS);/*                     @Y30LB25*/
*                                                                  2929
@EP02929 MVC   @PC00001(8),0(@01)                                  2929
         MVC   @PC00001+12(4),8(@01)                               2929
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/
*   /* PTRGROUP, PTRBASEV, PTRRPLV, PASSBYTE                 @Y30LB25*/
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2930
*   DCL                                                            2930
*     FIX404 CONSTANT(404);         /* 404                   @Y30LB25*/
*   DCL                                                            2931
*     FIX403 CONSTANT(403);         /* 403                   @Y30LB25*/
*   DCL                                                            2932
*     FIX100 CONSTANT(100);         /* 100                   @Y30LB25*/
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/
         L     @06,@PC00001                                        2933
         L     @06,PTRGROUP(,@06)                                  2933
         ST    @06,GROUPPTR                                        2933
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/
         L     @06,@PC00001+4                                      2934
         L     @06,PTRBASEV(,@06)                                  2934
         ST    @06,BASEVPTR                                        2934
*   PASSBYTE=BYTEPASS;              /* ADD OR SUBT FLAG      @Y30LB25*/
         L     @06,@PC00001+12                                     2935
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2935
*   CALL VUPGH;                     /* PROCESS GVR           @Y30LB25*/
         BAL   @14,VUPGH                                           2936
*   RETURN;                         /*                       @Y30LB25*/
         B     @EL00001                                            2937
*                                                                  2938
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEDURE VUPGH IS CODED SO THAT COMMON ENTRY         @Y30LB25*/
*   /* CODE IN ICBVUPGH CAN BE USED BY THIS MODULE           @Y30LB25*/
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/
*   /* ENTRY ICBVUPGH. THIS MODULE CALLS PROCEDURE           @Y30LB25*/
*   /* VUPGH.                                                @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2938
*VUPGH:                             /*                       @Y30LB25*/
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/
*                                                                  2938
VUPGH    ST    @14,12(,@13)                                        2938
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE THE GROUP THRESHOLD                            @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2939
*   GROSTRSH=(GRONGEN*FIX404*GROPCENT)/FIX100;/*             @Y30LB25
*                                      SPACE THRESHOLD       @Y30LB25*/
*                                                                  2939
         L     @06,GROUPPTR                                        2939
         LH    @01,GRONGEN(,@06)                                   2939
         MH    @01,@CH01095                                        2939
         SLR   @15,@15                                             2939
         IC    @15,GROPCENT(,@06)                                  2939
         MR    @00,@15                                             2939
         D     @00,@CF01099                                        2939
         ST    @01,GROSTRSH(,@06)                                  2939
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE GROUP FREE SPACE AND FREE EXTENTS              @Y30LB25*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  2940
*   IF ADDSUBGR=ON                  /* INCREMENT?            @Y30LB25*/
*     THEN                          /* YES                   @Y30LB25*/
         TM    ADDSUBGR,B'00001000'                                2940
         BNO   @RF02940                                            2940
*     DO;                           /*                       @Y30LB25*/
*                                                                  2941
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF BVR STILL CONTAINS NULL SPACE VALUES.    @Y30LB25*/
*       /* IF SO, CHANGE THE VALUES TO REFLECT AN EMPTY      @Y30LB25*/
*       /* VOLUME AND INDICATE IT IS DOWN LEVEL SPACE.       @Y30LB25*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  2942
*       IF BASFRESP=FIX2FS          /* NULL FREE SPACE?      @Y30LB25*/
*         THEN                      /* YES                   @Y30LB25*/
         L     @06,BASEVPTR                                        2942
         CLC   BASFRESP(2,@06),@CH00672                            2942
         BNE   @RF02942                                            2942
*         DO;                       /*                       @Y30LB25*/
*           BASFRESP=FIX403;        /* SET FREE SPACE        @Y30LB25*/
         LA    @15,403                                             2944
         STH   @15,BASFRESP(,@06)                                  2944
*           BASLEXT=FIX403;         /* LARGE FREE EXTENT     @Y30LB25*/
         STH   @15,BASLEXT(,@06)                                   2945
*           BASFREXT=FIXONE;        /* # FREE EXTENTS        @Y30LB25*/
         MVC   BASFREXT(4,@06),@CF00046                            2946
*           BASDLSF=ON;             /* DOWN LEVEL SPACE      @Y30LB25*/
         OI    BASDLSF(@06),B'10000000'                            2947
*         END;                      /*                       @Y30LB25*/
*       GROFRESP=GROFRESP+BASFRESP; /* NEW FREE SPACE        @Y30LB25*/
@RF02942 L     @06,GROUPPTR                                        2949
         L     @15,BASEVPTR                                        2949
         LH    @14,BASFRESP(,@15)                                  2949
         N     @14,@CF01129                                        2949
         AL    @14,GROFRESP(,@06)                                  2949
         ST    @14,GROFRESP(,@06)                                  2949
*       GROFREXT=GROFREXT+BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/
         L     @14,GROFREXT(,@06)                                  2950
         AL    @14,BASFREXT(,@15)                                  2950
         ST    @14,GROFREXT(,@06)                                  2950
*       GROMSG1=OFF;                /* MOUNT MSG             @Y30LB25*/
         NI    GROMSG1(@06),B'11111101'                            2951
*       RETURN;                     /*                       @Y30LB25*/
@EL00070 DS    0H                                                  2952
@EF00070 DS    0H                                                  2952
@ER00070 L     @14,12(,@13)                                        2952
         BR    @14                                                 2952
*     END;                          /*                       @Y30LB25*/
*   ELSE                            /* DECREMENT             @Y30LB25*/
*     DO;                           /*                       @Y30LB25*/
@RF02940 DS    0H                                                  2955
*       GROFRESP=GROFRESP-BASFRESP; /* NEW FREE SPACE        @Y30LB25*/
         L     @06,GROUPPTR                                        2955
         L     @15,BASEVPTR                                        2955
         L     @14,GROFRESP(,@06)                                  2955
         LH    @03,BASFRESP(,@15)                                  2955
         N     @03,@CF01129                                        2955
         SLR   @14,@03                                             2955
         ST    @14,GROFRESP(,@06)                                  2955
*       GROFREXT=GROFREXT-BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/
         L     @14,GROFREXT(,@06)                                  2956
         SL    @14,BASFREXT(,@15)                                  2956
         ST    @14,GROFREXT(,@06)                                  2956
*       RETURN;                     /*                       @Y30LB25*/
         B     @EL00070                                            2957
*     END;                          /*                       @Y30LB25*/
*   END VUPGH;                      /*                       @Y30LB25*/
*   END ICBVUT00                    /* THE END -- AT LAST    @Y30LB25*/
*                                                                  2960
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */
*                                                                  2960
*       ;                                                          2960
@DATA    DS    0H
@CH00041 DC    H'4'
@CH01095 DC    H'404'
         DS    0F
@AL00517 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01570 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)
         DC    A(RPLVPTR)
         DC    A(EXPRDT)
@AL00572 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL02320 DC    A(BCDVPTR)              LIST WITH   3 ARGUMENT(S)
         DC    A(RPLVPTR)
         DC    A(PASSBYTE)
@AL00640 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00902 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01059 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01131 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01189 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01220 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01241 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01245 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL01266 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL02384 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL02548 DC    A(GROUPPTR)             LIST WITH   4 ARGUMENT(S)
         DC    A(BASEVPTR)
         DC    A(RPLVPTR)
         DC    A(PASSBYTE)
@AL00677 EQU   *                       LIST WITH   6 ARGUMENT(S)
@AL00691 DC    A(DUPVPTR)              LIST WITH   4 ARGUMENT(S)
         DC    A(BASEVPTR)
         DC    A(RPLVPTR)
         DC    A(PASSBYTE)
         DC    A(@CF00086)
         DC    A(@CF00086)
@AL00967 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01712 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01783 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01831 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01940 DC    A(COPYVPTR)             LIST WITH   3 ARGUMENT(S)
         DC    A(RPLVPTR)
         DC    A(PASSBYTE)
@AL01802 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)
         DC    A(RPLVPRT)
         DC    A(EXPRDT)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00002 DS    1F
@SA00003 DS    1F
@SA00016 DS    1F
@SA00033 DS    1F
@SA00031 DS    1F
@SA00047 DS    1F
@SA00049 DS    1F
@SA00007 DS    1F
@SA00019 DS    1F
@SA00036 DS    1F
@SA00032 DS    1F
@SA00050 DS    1F
@SA00059 DS    1F
@SA00046 DS    1F
@SA00060 DS    1F
@SA00009 DS    1F
@SA00045 DS    1F
@SA00043 DS    1F
@SA00012 DS    1F
@SA00010 DS    1F
@SA00013 DS    1F
@SA00015 DS    1F
@SA00067 DS    1F
@SA00061 DS    1F
@SA00017 DS    1F
@SA00018 DS    1F
@SA00020 DS    1F
@SA00021 DS    1F
@SA00058 DS    1F
@SA00028 DS    1F
@SA00022 DS    1F
@SA00023 DS    1F
@SA00027 DS    1F
@SA00024 DS    1F
@SA00026 DS    1F
@SA00025 DS    1F
@SA00037 DS    1F
@SA00035 DS    1F
@SA00041 DS    1F
@SA00040 DS    1F
@SA00038 DS    1F
@SA00044 DS    1F
@SA00048 DS    1F
@SA00052 DS    1F
@SA00055 DS    1F
@SA00056 DS    1F
@SA00053 DS    1F
@SA00057 DS    1F
@SA00054 DS    1F
@SA00062 DS    1F
@SA00063 DS    1F
@SA00066 DS    1F
@SA00068 DS    1F
@SA00069 DS    1F
@SA00039 DS    0F
@SA00042 DS    0F
@SA00064 DS    0F
@SA00014 DS    0F
@SA00065 DS    0F
@SA00011 DS    0F
@SA00034 DS    0F
@SA00008 DS    0F
@SA00006 DS    0F
@SA00005 DS    0F
@SA00004 DS    0F
         DS    1F
@AL00001 DS    6A
         DS    0F
@CF00086 DC    F'0'
@CF00046 DC    F'1'
@CH00046 EQU   @CF00046+2
@CF00044 DC    F'2'
@CF00339 DC    F'36'
@CF01105 DC    F'65'
@CF01099 DC    F'100'
@CF01104 DC    F'164'
@CF01103 DC    F'224'
@CF00668 DC    F'255'
@CF00666 DC    F'256'
@CF00677 DC    XL4'FFFFFFFF'
@CF01129 DC    XL4'0000FFFF'
@CF00672 DC    XL4'FFFF'
@CH00672 EQU   @CF00672+2
@CV00762 DC    V(ICBVIO00)
@CV00763 DC    V(ICBVRR00)
@CV00764 DC    V(ICBVJL00)
@CV00766 DC    V(ICBVUDBR)
@CV00767 DC    V(ICBVUEXT)
@CV00768 DC    V(ICBVUEXP)
@CV00769 DC    V(ICBVUBVR)
@CV00765 DC    V(ICBVOP00)
         DS    0D
VVIPTR   DS    A
RPLVPTR  DS    A
INDEXPTR DS    A
GROUPPTR DS    A
BCDVPTR  DS    A
BASEVPTR DS    A
COPYVPTR DS    A
DUPVPTR  DS    A
MCRTEPTR DS    A
COVCEPTR DS    A
CVOLPTR  DS    A
A        DS    F
RPLVPRT  DS    F
MCRLEN   DC    AL2(44)
DEFLEN   DC    AL2(64)
COVLEN   DC    AL2(43)
@CC00692 DC    C'             '
@CC00689 EQU   @CC00692
@CB00681 DC    X'00000000000000000000'
@CB00677 DC    X'FFFFFFFF'
@CB00701 DC    X'004C'
@CB00703 DC    X'0203'
@CB00705 DC    X'0204'
@CB00707 DC    X'0205'
@CB00709 DC    X'0206'
@CB00711 DC    X'0208'
@CB00713 DC    X'0209'
@CB00717 DC    X'020E'
@CB00719 DC    X'020F'
@CB00721 DC    X'0210'
@CB00723 DC    X'0213'
@CB00725 DC    X'0214'
@CB00727 DC    X'0217'
@CB00729 DC    X'0227'
@CB00731 DC    X'0228'
@CB00733 DC    X'0235'
@CB00735 DC    X'0236'
@CB00737 DC    X'0237'
@CB00739 DC    X'0238'
GROUPBUF DS    CL224
GRPBUF1  DS    CL224
NGVRBUF  DS    CL224
BASEBUF  DS    CL224
COPYBUF  DS    CL224
INDEXBUF DS    CL36
DUPVBUF  DS    CL224
         DS    CL1
GKEY     DS    CL13
         ORG   GKEY
GKY      DC    CL3'G  '
GROUPKY  DS    CL8
GBLKKY   DC    CL1' '
GIDKY    DC    XL1'00'
         ORG   GKEY+13
         DS    CL3
BKEY     DS    CL13
         ORG   BKEY
BKY      DC    CL5'V    '
BVOLKY   DS    CL6
BBLKKY   DC    CL1' '
BIDKY    DC    XL1'00'
         ORG   BKEY+13
         DS    CL3
DKEY     DS    CL13
         ORG   DKEY
DKY      DC    CL5'D    '
DVOLKY   DS    CL6
DBLKKY   DC    CL1' '
DIDKY    DS    FL1
         ORG   DKEY+13
         DS    CL3
CKEY     DS    CL13
         ORG   CKEY
CKY      DC    CL5'V    '
CVOLKY   DS    CL6
CBLKKY   DC    CL1' '
CIDKY    DS    FL1
         ORG   CKEY+13
         DS    CL3
IKEY     DS    CL13
         ORG   IKEY
IKY      DC    CL1'I'
IVOLKY   DS    CL12
         ORG   IKEY+13
         DS    CL3
NGKEY    DC    CL13'N   HEADER   '
         DS    CL3
WORKAREA DS    CL23
         ORG   WORKAREA
REACODE  DS    CL2
RETCODE  DS    CL2
BCDKEY   DS    CL13
EXPRDT   DS    CL4
PASSBYTE DS    CL2
         ORG   PASSBYTE
GRPDV    DS    BL1
FRSTDV   EQU   PASSBYTE+0
LASTDV   EQU   PASSBYTE+0
GRPFLG   EQU   PASSBYTE+0
ADDSUBGR EQU   PASSBYTE+0
CSNUMBER EQU   PASSBYTE+0
ADDSUBSL EQU   PASSBYTE+0
RPLVFLG  EQU   PASSBYTE+0
EXPSLOT  DS    BL1
ADDSUB   EQU   PASSBYTE+1
@NM00054 EQU   PASSBYTE+1
         ORG   WORKAREA+23
MAXDATE  DC    X'0099365C'
NULLDATE DC    X'00000000'
         DS    CL1
VU0PATCH DS    CL400
         ORG   VU0PATCH
@NM00055 DC    400X'00'
         ORG   VU0PATCH+400
BASEBUF1 DS    CL224
SAVSERNO DS    CL6
SAVSERN1 DS    CL6
SAVPREV  DS    CL6
SAVNEXT  DS    CL6
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SAVBASPT EQU   @06
DEFVPTR  EQU   @04
MCRTPTR  EQU   @06
DEFVEPTR EQU   @05
NGVRPTR  EQU   @02
RG0      EQU   @00
RG1      EQU   @01
RG14     EQU   @14
CVOLR1   EQU   @01
DEFVR1   EQU   @01
MCR1     EQU   @01
RG10     EQU   @10
RG11     EQU   @11
RG12     EQU   @12
RG13     EQU   @13
RG15     EQU   @15
RG2      EQU   @02
RG3      EQU   @03
RG4      EQU   @04
RG5      EQU   @05
RG6      EQU   @06
RG7      EQU   @07
RG8      EQU   @08
RG9      EQU   @09
VVICB    EQU   0
VVIFLGA  EQU   VVICB+15
VVIFLG0  EQU   VVIFLGA
VVIFLG2  EQU   VVIFLGA
RPLV     EQU   0
RPLTCBPR EQU   RPLV+8
RPLVVICB EQU   RPLV+12
RPLFLAGA EQU   RPLV+28
RPLFTIME EQU   RPLFLAGA
RPLJRCVY EQU   RPLFLAGA
RPLRCODE EQU   RPLV+32
RPLVRETC EQU   RPLV+34
RPLVDATE EQU   RPLV+38
RPLVSAM  EQU   RPLV+56
RPLVTYP  EQU   RPLVSAM+2
RPLVBUF  EQU   RPLVSAM+32
RPLVKEY  EQU   RPLVSAM+36
RPLVOPT  EQU   RPLVSAM+40
RPLVLOC  EQU   RPLVOPT
RPLVDIR  EQU   RPLVOPT
RPLVKGE  EQU   RPLVOPT
RPLVUPD  EQU   RPLVOPT+1
RPLVRLN  EQU   RPLVSAM+48
RPLVBLN  EQU   RPLVSAM+52
RPLVUTIL EQU   RPLV+132
INDEX    EQU   0
INDNAME  EQU   INDEX
INDTYPE  EQU   INDEX+13
INDRECKY EQU   INDEX+15
INDPREFX EQU   INDRECKY
INDRECID EQU   INDRECKY+11
GROUP    EQU   0
GRONAME  EQU   GROUP
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROBIND  EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GROFSN   EQU   GROUP+17
GROLSN   EQU   GROUP+23
GROPCENT EQU   GROUP+29
GRONGEN  EQU   GROUP+30
GRONRSTD EQU   GROUP+32
GRONINAC EQU   GROUP+34
GROSTRSH EQU   GROUP+40
GROFRESP EQU   GROUP+44
GROFREXT EQU   GROUP+48
GROERRTS EQU   GROUP+56
NGVR     EQU   0
NGVRTYPE EQU   NGVR+13
NGVFVOL  EQU   NGVR+17
NGVLVOL  EQU   NGVR+23
NGVNOVOL EQU   NGVR+30
BCDV     EQU   0
BCDNAME  EQU   BCDV
BCDPREFX EQU   BCDNAME
BCDSERNO EQU   BCDNAME+5
BCDID    EQU   BCDNAME+11
BCDFLAGA EQU   BCDV+14
BCDTYPE  EQU   BCDFLAGA
BCDBASE  EQU   BCDTYPE
BCDCOPY  EQU   BCDTYPE
BCDDUP   EQU   BCDTYPE
BCDFLAGB EQU   BCDFLAGA+2
BCDRCVYF EQU   BCDV+20
BCDSATIA EQU   BCDRCVYF
BCDIVCRE EQU   BCDSATIA
BCDIVCPY EQU   BCDSATIA
BCDVSMIS EQU   BCDSATIA
BCDMISCF EQU   BCDRCVYF+2
BCDCSN1  EQU   BCDV+24
BCDLIB1  EQU   BCDV+36
BCDLID1  EQU   BCDLIB1
BCDCSN2  EQU   BCDV+37
BCDLIB2  EQU   BCDV+49
BCDLID2  EQU   BCDLIB2
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASBASVR EQU   BASTYPE
BASDLSF  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASEXCL  EQU   BASFLAGA+2
BASDAERA EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASHOLD  EQU   BASMISCF
BASCSN1  EQU   BASEV+24
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASCSN2  EQU   BASEV+37
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASPREV  EQU   BASEV+50
BASNEXTV EQU   BASEV+56
BASNCOPY EQU   BASEV+62
BASBKLMT EQU   BASEV+64
BASFRESP EQU   BASEV+68
BASLEXT  EQU   BASEV+70
BASFREXT EQU   BASEV+72
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASCOPNO EQU   BASCOPID+1
BASDLMTD EQU   BASEV+92
BASEXPDT EQU   BASEV+96
BASDTREM EQU   BASEV+100
BASDESCR EQU   BASEV+104
BASOWNER EQU   BASEV+134
BASDEST  EQU   BASEV+144
BASRECOV EQU   BASEV+174
BASGROUP EQU   BASEV+180
COPYV    EQU   0
COPNAME  EQU   COPYV
COPV     EQU   COPNAME
COPSERNO EQU   COPNAME+5
COPID    EQU   COPNAME+11
COPNO    EQU   COPID+1
COPFLAGA EQU   COPYV+14
COPTYPE  EQU   COPFLAGA
COPCOPYV EQU   COPTYPE
COPGROUP EQU   COPFLAGA+2
COPVSAM  EQU   COPFLAGA+2
COPGENUS EQU   COPFLAGA+2
COPRSTD  EQU   COPFLAGA+2
COPBKUP  EQU   COPFLAGA+2
COPBIND  EQU   COPFLAGA+2
COPEXCL  EQU   COPFLAGA+2
COPDAERA EQU   COPFLAGA+2
COPRONLY EQU   COPFLAGA+3
COPDLSPF EQU   COPFLAGA+3
COPRCVYF EQU   COPYV+20
COPSATIA EQU   COPRCVYF
COPMISCF EQU   COPRCVYF+2
COPHOLD  EQU   COPMISCF
COPCSN1  EQU   COPYV+24
COPLIB1  EQU   COPYV+36
COPLID1  EQU   COPLIB1
COPCSN2  EQU   COPYV+37
COPLIB2  EQU   COPYV+49
COPLID2  EQU   COPLIB2
COPDATE  EQU   COPYV+50
COPDTREM EQU   COPYV+54
COPDESCR EQU   COPYV+58
COPDEST  EQU   COPYV+88
COPOWNER EQU   COPYV+118
COPFRESP EQU   COPYV+128
COPLEXT  EQU   COPYV+130
COPFREXT EQU   COPYV+132
DUPV     EQU   0
DUPNAME  EQU   DUPV
DUPD     EQU   DUPNAME
DUPSERNO EQU   DUPNAME+5
DUPID    EQU   DUPNAME+11
DUPFLAGA EQU   DUPV+14
DUPTYPE  EQU   DUPFLAGA
DUPDUPLR EQU   DUPTYPE
DUPRCVYF EQU   DUPV+20
DUPCSN1  EQU   DUPV+24
DUPLIB1  EQU   DUPV+36
DUPLID1  EQU   DUPLIB1
DUPCSN2  EQU   DUPV+37
DUPLIB2  EQU   DUPV+49
DUPLID2  EQU   DUPLIB2
MCRTE    EQU   0
MCRLOC   EQU   MCRTE+4
MCRFLAGA EQU   MCRTE+34
MCRSPLOC EQU   MCRFLAGA
MCRFLAGB EQU   MCRTE+36
MCRTYPE  EQU   MCRFLAGB+2
MCRREC   EQU   MCRTYPE
DEFVE    EQU   0
DEFGROUP EQU   DEFVE+4
DEFDESCR EQU   DEFVE+12
DEFTO    EQU   DEFVE+42
DEFFOR   EQU   DEFVE+46
DEFBKUPN EQU   DEFVE+48
DEFLABEL EQU   DEFVE+49
DEFFLAGA EQU   DEFVE+55
DEFPFOR  EQU   DEFFLAGA
DEFPGRO  EQU   DEFFLAGA
DEFPDESC EQU   DEFFLAGA
DEFPTO   EQU   DEFFLAGA
DEFPBKUP EQU   DEFFLAGA
DEFFLAGB EQU   DEFVE+56
DEFSETFL EQU   DEFFLAGB
DEFSRCVY EQU   DEFSETFL
DEFCRCVY EQU   DEFSETFL
DEFRECFL EQU   DEFFLAGB+1
DEFICOPY EQU   DEFRECFL
DEFCREAT EQU   DEFRECFL
DEFLAMIS EQU   DEFRECFL
DEFTYPFL EQU   DEFFLAGB+2
DEFGENUS EQU   DEFTYPFL
DEFRSTD  EQU   DEFTYPFL
DEFDUP   EQU   DEFTYPFL
DEFCOPY  EQU   DEFTYPFL
DEFNULFL EQU   DEFFLAGB+3
DEFNGRP  EQU   DEFNULFL
DEFNDESC EQU   DEFNULFL
DEFNEXPD EQU   DEFNULFL
COVCE    EQU   0
COVDESCR EQU   COVCE+4
COVFLAGA EQU   COVCE+34
COVSPDES EQU   COVFLAGA
COVFLAGB EQU   COVCE+35
COVSETFL EQU   COVFLAGB
COVSRCVY EQU   COVSETFL
COVCRCVY EQU   COVSETFL
COVRECFL EQU   COVFLAGB+1
COVICOPY EQU   COVRECFL
COVCREAT EQU   COVRECFL
COVLAMIS EQU   COVRECFL
COVTYPE  EQU   COVFLAGB+2
COVSAM   EQU   COVTYPE
COVREUSE EQU   COVTYPE
LSTMCRT  EQU   0
MCRTLEN  EQU   LSTMCRT
MCRTOPCD EQU   LSTMCRT+4
MCRTFLG  EQU   LSTMCRT+6
MCRTTRAN EQU   MCRTFLG
MCRTLIB  EQU   LSTMCRT+7
MCRTCSN  EQU   LSTMCRT+24
MCRTVEXT EQU   LSTMCRT+44
LSTDEFV  EQU   0
DEFVLEN  EQU   LSTDEFV
DEFVOPCD EQU   LSTDEFV+4
DEFVFLG  EQU   LSTDEFV+6
DEFVCR   EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
DEFVRNM  EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVDACT EQU   DEFVFLG
DEFVLIB  EQU   LSTDEFV+7
DEFVOLD  EQU   LSTDEFV+8
DEFVVFLG EQU   LSTDEFV+14
DEFVSEC  EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVNVOL EQU   LSTDEFV+16
DEFVCSN1 EQU   LSTDEFV+24
DEFVDATA EQU   LSTDEFV+56
DEFOWNID EQU   DEFVDATA+29
DEFVVEXT EQU   LSTDEFV+128
LSTCVOL  EQU   0
CVOLLEN  EQU   LSTCVOL
CVOLOPCD EQU   LSTCVOL+4
CVOLFLG  EQU   LSTCVOL+6
CVODASCR EQU   CVOLFLG
CVOCRCR  EQU   CVOLFLG
CVOCRCRV EQU   CVOLFLG
CVOLID   EQU   LSTCVOL+8
CVOLCSN  EQU   LSTCVOL+20
CVOLVEXT EQU   LSTCVOL+36
BUFFER   EQU   0
PTRGROUP EQU   0
PTRBASEV EQU   0
PTRRPLV  EQU   0
BYTEPASS EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVOLRES2 EQU   LSTCVOL+34
CVOLRUA  EQU   LSTCVOL+32
CVOLECB  EQU   LSTCVOL+16
CVOLASID EQU   LSTCVOL+14
@NM00053 EQU   CVOLFLG
CVOCRDAS EQU   CVOLFLG
CVOLRES1 EQU   LSTCVOL+5
DEFTLAB  EQU   DEFVDATA+71
DEFR60   EQU   DEFVDATA+43
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   LSTDEFV+52
DEFVASID EQU   LSTDEFV+50
@NM00052 EQU   LSTDEFV+48
DEFVCSN2 EQU   LSTDEFV+36
@NM00051 EQU   LSTDEFV+22
@NM00050 EQU   LSTDEFV+15
@NM00049 EQU   DEFVVFLG
@NM00048 EQU   DEFVVFLG
@NM00047 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00046 EQU   DEFVLIB
@NM00045 EQU   LSTDEFV+5
MCRTECB  EQU   LSTMCRT+40
MCRTASID EQU   LSTMCRT+38
MCRTRES4 EQU   LSTMCRT+36
MCRTRES3 EQU   LSTMCRT+16
MCRTRES2 EQU   LSTMCRT+8
MCRTLD   EQU   MCRTLIB
@NM00044 EQU   MCRTLIB
@NM00043 EQU   MCRTFLG
MCRTSCT  EQU   MCRTFLG
@NM00042 EQU   MCRTFLG
MCRTRES1 EQU   LSTMCRT+5
@NM00041 EQU   COVCE+39
@NM00040 EQU   COVFLAGB+3
@NM00039 EQU   COVTYPE
@NM00038 EQU   COVRECFL
@NM00037 EQU   COVSETFL
@NM00036 EQU   COVFLAGA
COVLNGTH EQU   COVCE
@NM00035 EQU   DEFVE+60
@NM00034 EQU   DEFNULFL
@NM00033 EQU   DEFTYPFL
@NM00032 EQU   DEFRECFL
@NM00031 EQU   DEFSETFL
@NM00030 EQU   DEFFLAGA
DEFPVLAB EQU   DEFFLAGA
DEFLNGTH EQU   DEFVE
@NM00029 EQU   MCRTE+40
@NM00028 EQU   MCRFLAGB+3
@NM00027 EQU   MCRTYPE
@NM00026 EQU   MCRFLAGB+1
@NM00025 EQU   MCRFLAGB
MCRBLNK1 EQU   MCRTE+35
@NM00024 EQU   MCRFLAGA
MCRLNGTH EQU   MCRTE
@NM00023 EQU   DUPV+50
DUP2BIT2 EQU   DUPLID2
DUP2BIT1 EQU   DUPLID2
DUPRES4  EQU   DUPLIB2
DUP1BIT2 EQU   DUPLID1
DUP1BIT1 EQU   DUPLID1
DUPRES3  EQU   DUPLIB1
DUPMISCF EQU   DUPRCVYF+2
DUPSATIA EQU   DUPRCVYF
@NM00022 EQU   DUPV+18
@NM00021 EQU   DUPFLAGA+2
DUPRES2  EQU   DUPTYPE
DUPRES1  EQU   DUPTYPE
DUPRES5  EQU   DUPV+13
DUPNO    EQU   DUPID+1
DUPBLANK EQU   DUPID
@NM00020 EQU   COPYV+136
COP2BIT2 EQU   COPLID2
COP2BIT1 EQU   COPLID2
COPRES5  EQU   COPLIB2
COP1BIT2 EQU   COPLID1
COP1BIT1 EQU   COPLID1
COPRES4  EQU   COPLIB1
@NM00019 EQU   COPMISCF
COPRES3  EQU   COPSATIA
COPVSMIS EQU   COPSATIA
COPIVCPY EQU   COPSATIA
COPIVCRE EQU   COPSATIA
@NM00018 EQU   COPYV+18
@NM00017 EQU   COPFLAGA+3
COPRES2  EQU   COPTYPE
COPRES1  EQU   COPTYPE
COPRES6  EQU   COPYV+13
COPBLANK EQU   COPID
@NM00016 EQU   BASEV+188
BASRES6  EQU   BASEV+89
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
@NM00015 EQU   BASEV+65
BASNBKUP EQU   BASEV+63
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASRES3  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00014 EQU   BASFLAGA+3
BASRES2  EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
BCD2BIT2 EQU   BCDLID2
BCD2BIT1 EQU   BCDLID2
BCDRES8  EQU   BCDLIB2
BCD1BIT2 EQU   BCDLID1
BCD1BIT1 EQU   BCDLID1
BCDRE10  EQU   BCDLIB1
BCDRES7A EQU   BCDMISCF
BCDHOLD  EQU   BCDMISCF
BCDRES7  EQU   BCDSATIA
BCDCPUID EQU   BCDV+18
BCDRES5  EQU   BCDFLAGB+1
BCDREASS EQU   BCDFLAGB+1
BCDRES4  EQU   BCDFLAGB
BCDRES3  EQU   BCDTYPE
BCDRES2  EQU   BCDTYPE
BCDRES1  EQU   BCDTYPE
BCDRES9  EQU   BCDV+13
BCDINDEX EQU   BCDID+1
BCDBLNK2 EQU   BCDID
BCDBLNK1 EQU   BCDPREFX+1
BCDALPHA EQU   BCDPREFX
@NM00013 EQU   NGVR+32
@NM00012 EQU   NGVR+29
@NM00011 EQU   NGVR+15
NGVRES2  EQU   NGVRTYPE+1
NGVHDR   EQU   NGVRTYPE
NGVRES1  EQU   NGVRTYPE
NGVNAME  EQU   NGVR
@NM00010 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROSSPD  EQU   GROUP+38
GROPSPD  EQU   GROUP+36
@NM00009 EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROVVGRP EQU   GRONAME+3
GROG     EQU   GRONAME
@NM00008 EQU   INDEX+28
INDEXREC EQU   INDRECID+1
INDBLNK2 EQU   INDRECID
INDVSRNO EQU   INDRECKY+5
INDBLNK1 EQU   INDPREFX+1
INDALPHA EQU   INDPREFX
INDRES2  EQU   INDTYPE
INDINDEX EQU   INDTYPE
INDRES1  EQU   INDTYPE
INDSERNO EQU   INDNAME+1
INDI     EQU   INDNAME
@NM00007 EQU   RPLVSAM+44
@NM00006 EQU   RPLVOPT
@NM00005 EQU   RPLVOPT
RPLVNEXT EQU   RPLVOPT
@NM00004 EQU   RPLVSAM+28
RPLVACB  EQU   RPLVSAM+24
@NM00003 EQU   RPLVSAM+3
@NM00002 EQU   RPLVSAM
@NM00001 EQU   RPLV+42
RPLRMSCC EQU   RPLV+36
RPLVTLEN EQU   RPLV+30
RPLVRES1 EQU   RPLFLAGA+1
RPLVJRNL EQU   RPLFLAGA
RPLVVOP  EQU   RPLFLAGA
RPLVVIN  EQU   RPLFLAGA
RPLVCOMP EQU   RPLFLAGA
RPLVPROG EQU   RPLFLAGA
RPLVPOST EQU   RPLFLAGA
RPLVRSV3 EQU   RPLV+24
RPLVRSV2 EQU   RPLV+20
RPLVRSV1 EQU   RPLV+16
RPLASCBP EQU   RPLTCBPR
RPLVECB  EQU   RPLV+4
RPLVQPTR EQU   RPLV
VVIUNUSD EQU   VVICB+116
VVINUSDC EQU   VVICB+112
VVITPFCH EQU   VVICB+108
VVIDVMEL EQU   VVICB+104
VVIVBSTF EQU   VVICB+100
VVISSOBA EQU   VVICB+96
VVIVSCRA EQU   VVICB+92
VVISTPTB EQU   VVICB+88
VVIDVMTA EQU   VVICB+84
VVIJUCB  EQU   VVICB+80
VVIIUCB  EQU   VVICB+76
VVIRES6  EQU   VVICB+72
VVIRES5  EQU   VVICB+68
VVIRES4  EQU   VVICB+64
VVIUCB   EQU   VVICB+60
VVIVJL   EQU   VVICB+56
VVIVRR   EQU   VVICB+52
VVIQLSPL EQU   VVICB+48
VVIQRPL2 EQU   VVICB+44
VVIQRPL1 EQU   VVICB+40
VVIVTRK  EQU   VVICB+37
VVIOPCD  EQU   VVICB+36
VVIVQMP  EQU   VVICB+32
VVIECB1  EQU   VVICB+28
VVICATAD EQU   VVICB+24
VVIDCBAD EQU   VVICB+20
VVIACBAD EQU   VVICB+16
VVIFLG7  EQU   VVIFLGA
VVIFLG6  EQU   VVIFLGA
VVIFLG5  EQU   VVIFLGA
VVIFLG4  EQU   VVIFLGA
VVIFLG3  EQU   VVIFLGA
VVIFLG1  EQU   VVIFLGA
VVIALCON EQU   VVICB+14
VVICPUID EQU   VVICB+12
VVIUCAT  EQU   VVICB+4
VVICID   EQU   VVICB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00191 EQU   @EL00002
@RF00203 EQU   @EL00002
@RF00211 EQU   @EL00002
@RT00255 EQU   @EL00002
@RT00261 EQU   @EL00002
@RT00335 EQU   @EL00003
@RT00377 EQU   @EL00007
@RT00391 EQU   @EL00007
@RT00405 EQU   @EL00008
@RT00430 EQU   @EL00009
@RT00461 EQU   @EL00011
@RF00490 EQU   @EL00012
@RF00513 EQU   @RC00506
@RT00549 EQU   @EL00012
@RT00551 EQU   @EL00012
@RT00567 EQU   @EL00012
@RT00578 EQU   @EL00012
@RC00569 EQU   @EL00012
@RT00591 EQU   @EL00013
@RT00607 EQU   @EL00014
@RT00620 EQU   @EL00015
@RT00625 EQU   @EL00015
@RT00630 EQU   @EL00015
@RT00634 EQU   @EL00015
@RT00641 EQU   @EL00015
@RT00660 EQU   @EL00015
@RF00666 EQU   @EL00015
@RT00678 EQU   @EL00015
@RT00682 EQU   @EL00015
@RT00692 EQU   @EL00015
@RT00709 EQU   @EL00016
@RT00714 EQU   @EL00016
@RT00736 EQU   @EL00016
@RT00753 EQU   @EL00017
@RF00744 EQU   @EL00017
@RC00746 EQU   @EL00017
@RT00780 EQU   @EL00018
@RC00785 EQU   @RC00783
@RC00812 EQU   @RC00810
@RT00835 EQU   @EL00018
@RF00773 EQU   @EL00018
@RF00772 EQU   @EL00018
@RF00834 EQU   @EL00018
@RT00854 EQU   @EL00019
@RT00861 EQU   @EL00019
@RT00874 EQU   @EL00019
@RT00882 EQU   @EL00019
@RT00896 EQU   @EL00019
@RT00903 EQU   @EL00019
@RT00910 EQU   @EL00019
@RT00926 EQU   @EL00020
@RT00957 EQU   @EL00020
@RT00961 EQU   @EL00020
@RT00964 EQU   @EL00020
@RT00968 EQU   @EL00020
@RT00987 EQU   @EL00021
@RT00993 EQU   @EL00021
@RT00997 EQU   @EL00021
@RT01005 EQU   @EL00021
@RT01008 EQU   @EL00021
@RT01020 EQU   @EL00021
@RT01031 EQU   @EL00021
@RT01045 EQU   @EL00022
@RT01060 EQU   @EL00022
@RT01067 EQU   @EL00022
@RT01085 EQU   @EL00022
@RT01095 EQU   @EL00023
@RT01127 EQU   @EL00023
@RT01132 EQU   @EL00023
@RT01139 EQU   @EL00023
@RT01143 EQU   @EL00023
@RT01152 EQU   @EL00024
@RT01165 EQU   @EL00025
@RT01175 EQU   @EL00025
@RT01183 EQU   @EL00025
@RF01185 EQU   @EL00025
@RT01197 EQU   @EL00026
@RT01207 EQU   @EL00026
@RT01214 EQU   @EL00026
@RF01216 EQU   @EL00026
@RT01230 EQU   @EL00027
@RT01242 EQU   @EL00027
@RT01246 EQU   @EL00027
@RF01237 EQU   @RC01234
@RT01267 EQU   @EL00027
@RT01292 EQU   @EL00028
@RT01298 EQU   @EL00028
@RF01318 EQU   @EL00029
@RF01324 EQU   @EL00029
@RF01327 EQU   @EL00029
@RF01343 EQU   @EL00030
@RF01349 EQU   @EL00030
@RF01363 EQU   @EL00031
@RT01371 EQU   @EL00031
@RT01375 EQU   @EL00031
@RT01391 EQU   @EL00032
@RT01410 EQU   @EL00032
@RT01415 EQU   @EL00032
@RF01431 EQU   @EL00033
@RT01441 EQU   @EL00033
@RT01455 EQU   @EL00033
@RT01498 EQU   @EL00036
@RT01510 EQU   @EL00036
@RT01525 EQU   @EL00036
@RT01531 EQU   @EL00036
@RC01528 EQU   @EL00036
@RT01540 EQU   @EL00037
@RC01588 EQU   @EL00038
@RT01619 EQU   @EL00039
@RT01673 EQU   @EL00040
@RT01679 EQU   @EL00040
@RT01686 EQU   @EL00040
@RT01698 EQU   @EL00041
@RT01705 EQU   @EL00041
@RT01709 EQU   @EL00041
@RT01730 EQU   @EL00042
@RT01747 EQU   @EL00043
@RT01757 EQU   @EL00043
@RT01767 EQU   @EL00043
@RT01779 EQU   @EL00043
@RT01784 EQU   @EL00043
@RT01789 EQU   @EL00043
@RT01793 EQU   @EL00043
@RT01828 EQU   @EL00043
@RT01832 EQU   @EL00043
@RT01863 EQU   @EL00045
@RT01871 EQU   @EL00045
@RT01883 EQU   @EL00045
@RT01905 EQU   @EL00046
@RT01912 EQU   @EL00046
@RT01931 EQU   @EL00046
@RF01936 EQU   @EL00046
@RF01953 EQU   @EL00047
@RT01961 EQU   @EL00047
@RT01977 EQU   @EL00047
@RT01997 EQU   @EL00047
@RT02000 EQU   @EL00047
@RT02019 EQU   @EL00048
@RT02023 EQU   @EL00048
@RT02026 EQU   @EL00048
@RT02038 EQU   @EL00049
@RT02041 EQU   @EL00049
@RT02048 EQU   @EL00049
@RT02076 EQU   @EL00050
@RT02086 EQU   @EL00050
@RT02094 EQU   @EL00050
@RT02103 EQU   @EL00050
@RT02107 EQU   @EL00050
@RT02118 EQU   @EL00050
@RT02127 EQU   @EL00050
@RT02134 EQU   @EL00050
@RT02140 EQU   @EL00050
@RT02231 EQU   @EL00050
@RT02235 EQU   @EL00050
@RT02240 EQU   @EL00050
@RT02246 EQU   @EL00050
@RC02262 EQU   @EL00051
@RT02276 EQU   @EL00052
@RT02279 EQU   @EL00052
@RT02288 EQU   @EL00053
@RT02296 EQU   @EL00053
@RT02306 EQU   @EL00053
@RT02311 EQU   @EL00053
@RF02317 EQU   @EL00053
@RT02328 EQU   @EL00054
@RC02344 EQU   @EL00055
@RT02363 EQU   @EL00056
@RT02378 EQU   @EL00056
@RF02358 EQU   @EL00056
@RF02380 EQU   @EL00056
@RT02413 EQU   @EL00057
@RT02430 EQU   @EL00057
@RT02440 EQU   @EL00058
@RT02445 EQU   @EL00058
@RT02449 EQU   @EL00058
@RT02479 EQU   @EL00059
@RT02495 EQU   @EL00059
@RT02512 EQU   @EL00060
@RT02520 EQU   @EL00060
@RT02528 EQU   @EL00060
@RT02542 EQU   @EL00060
@RT02549 EQU   @EL00060
@RT02556 EQU   @EL00060
@RT02589 EQU   @EL00061
@RT02614 EQU   @EL00061
@RT02619 EQU   @EL00061
@RT02637 EQU   @EL00061
@RT02642 EQU   @EL00061
@RT02653 EQU   @EL00061
@RT02680 EQU   @EL00062
@RT02699 EQU   @EL00062
@RT02717 EQU   @EL00063
@RT02729 EQU   @EL00063
@RT02762 EQU   @EL00066
@RT02766 EQU   @EL00066
@RT02770 EQU   @EL00066
@RT02801 EQU   @EL00067
@RT02816 EQU   @EL00067
@RT02821 EQU   @EL00067
@RT02841 EQU   @EL00067
@RT02846 EQU   @EL00067
@RT02857 EQU   @EL00067
@RT02871 EQU   @EL00068
@RT02891 EQU   @EL00068
@RT02914 EQU   @EL00069
@RT02918 EQU   @EL00069
@RT02923 EQU   @EL00069
@RF00756 EQU   @RC00746
@RC00787 EQU   @RC00785
@RC00814 EQU   @RC00812
@RC00789 EQU   @RC00787
@ENDDATA EQU   *
         END   ICBVUT00,(C'PLS1248',0701,78157)

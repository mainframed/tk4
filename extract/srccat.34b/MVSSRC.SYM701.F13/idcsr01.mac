         TITLE '******* IDCSR01: STOREV FUNCTION SUPPORT ROUTINE ****  *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCSR01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCSR01   76.100'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @08,0                                               0002
@PSTART  LA    @09,4095(,@08)                                      0002
         LA    @10,4095(,@09)                                      0002
         USING @PSTART,@08                                         0002
         USING @PSTART+4095,@09                                    0002
         USING @PSTART+8190,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0002
         USING @DATD,@12                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @12,8(,@13)                                         0002
         LR    @13,@12                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*   OLDERID2=NEWERID2;                                             0273
         L     @11,@PC00001                                        0273
         L     @15,GDTTR2(,@11)                                    0273
         MVC   @TS00001(95),NEWERID2(@15)                          0273
         MVC   OLDERID2(95,@15),@TS00001                           0273
*   NEWID2='SR01';                  /*                       @Y30LB31*/
*                                                                  0274
         MVC   NEWID2(4,@15),@CC01332                              0274
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A FULL REGION DUMP UPON ENTRY TO MODULE          @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0275
*   IF GDTDBG=NULLPTR THEN                                         0275
         L     @11,GDTDBG(,@11)                                    0275
         LTR   @11,@11                                             0275
         BZ    @RT00275                                            0275
*     ;                                                            0276
*   ELSE                                                           0277
*     CALL IDCDB010(GDTTBL,'SRBG'); /*                       @Y30LB31*/
*                                                                  0277
         L     @11,@PC00001                                        0277
         ST    @11,@AL00001                                        0277
         LA    @15,@CC01421                                        0277
         ST    @15,@AL00001+4                                      0277
         MVI   @AL00001+4,X'80'                                    0277
         L     @15,GDTDBG(,@11)                                    0277
         LA    @01,@AL00001                                        0277
         BALR  @14,@15                                             0277
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP ADDRESSABILITY TO THE ARGUMENT LISTS CONSTRUCTED BY     */
*   /* STOREV. ZERO OUT THESE LISTS AND INITIALIZE THE HEADERS USED  */
*   /* FOR DEBUGGING.                                        @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*   STORETBL=''B;                   /* INTERNAL TABLE        @Y30LB31*/
@RT00275 XC    STORETBL(45),STORETBL                               0278
*   STOREHDR='STORETBL';            /*                       @Y30LB31*/
         MVC   STOREHDR(8),@CC01423                                0279
*   MSVIVOL#=VOLVAL;                /*                       @Y30LB31*/
         L     @11,@PC00001+4                                      0280
         L     @11,FDTPTR(,@11)                                    0280
         MVC   MSVIVOL#(6),VOLVAL(@11)                             0280
*   DDSTRU=ADDR(PRINTTBL);          /* PRINT ARGUMENT LIST   @Y30LB31*/
         LA    @04,PRINTTBL                                        0281
         ST    @04,DDSTRU                                          0281
*   PRINTTBL=''B;                   /* ZERO PRINT ARG LIST   @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0282
*   PRINTHDR='DARGLIST';            /* PRINT ARG LIST ID     @Y30LB31*/
         MVC   PRINTHDR(8),@CC01424                                0283
*   SVOLHDR='VOLREC';               /* VOL REC BUFFER ID     @Y30LB31*/
         MVI   SVOLHDR+6,C' '                                      0284
         MVI   SVOLHDR+7,C' '                                      0284
         MVC   SVOLHDR(6),@CC01425                                 0284
*   SVOLREC=''B;                    /* ZERO OUT BUFFER       @Y30LB31*/
         XC    SVOLREC(224),SVOLREC                                0285
*   BASEVPTR=ADDR(SVOLREC);         /* BASE VOL REC FORMAT   @Y30LB31*/
         LA    BASEVPTR,SVOLREC                                    0286
*   SRALLTBL=''B;                   /* ZERO OUT ALLAGL       @Y30LB31*/
         XC    SRALLTBL(31),SRALLTBL                               0287
*   SRALLHDR='ALLAGL';              /* ARG LIST IDENTIFIER   @Y30LB31*/
         MVI   SRALLHDR+6,C' '                                     0288
         MVI   SRALLHDR+7,C' '                                     0288
         MVC   SRALLHDR(6),@CC01426                                0288
*   RESPECIFY                                                      0289
*     ALLAGL BASED(ADDR(SRALLTBL)); /*                       @Y30LB31*/
*   RESPECIFY                                                      0290
*     MDAGL BASED(ADDR(SRMDAGL));   /*                       @Y30LB31*/
*   SRMDAGL=''B;                    /* ZERO OUT MDAGL        @Y30LB31*/
         XC    SRMDAGL(31),SRMDAGL                                 0291
*   RFY                                                            0292
*     EXCLAGL BASED(ADDR(SREXCLST));/*                       @YD00175*/
*                                                                  0293
*   /*****************************************************************/
*   /*                                                               */
*   /* ENQUEUE ON THE VOLUME SERIAL NO. TO INSURE THE VOLUME RECORD  */
*   /* IS NOT UPDATED DURING STOREV PROCESSING.              @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*   RNMLEN=LENGTH(RNAME);           /*                       @Y30LB31*/
         MVI   RNMLEN,X'16'                                        0293
*   RNMTRAIL='.VIRTUAL.ENQUEUE';    /*                       @Y30LB31*/
         MVC   RNMTRAIL(16),@CC01433                               0294
*   RNMSERNO=VOLVAL;                /*                       @Y30LB31*/
         MVC   RNMSERNO(6),VOLVAL(@11)                             0295
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MAJORNM,MINORNM);/*       @Y30LB31*/
*                                                                  0296
         MVC   @AL00001+4(12),@AL00296                             0296
         L     @11,@PC00001                                        0296
         ST    @11,@AL00001                                        0296
         LA    @04,MINORNM                                         0296
         ST    @04,@AL00001+16                                     0296
         MVI   @AL00001+16,X'80'                                   0296
         L     @15,GDTENQ(,@11)                                    0296
         LA    @01,@AL00001                                        0296
         BALR  @14,@15                                             0296
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK OUT THE VOLUME TO BE DEACTIVATED.               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*   CALL SETUPRTN;                  /*                       @Y30LB31*/
         BAL   @14,SETUPRTN                                        0297
*   RESPECIFY                                                      0298
*     RTNREG RSTD;                                                 0298
*   TESTRC=RTNREG;                                                 0299
         LR    TESTRC,RTNREG                                       0299
*   RESPECIFY                                                      0300
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0301
         BZ    @RF00301                                            0301
*     LASTCOND=LASTCC12;            /*                       @Y30LB31*/
*                                                                  0302
         L     @11,@PC00001+8                                      0302
         MVC   LASTCOND(2,@11),@CH00565                            0302
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEED WITH DEACTIVATE REQUEST IF NO CONFLICTS EXIST @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0303
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC00301                                            0303
@RF00301 DS    0H                                                  0304
*       CALL WORKRTN;               /*                       @Y30LB31*/
         BAL   @14,WORKRTN                                         0304
*       RESPECIFY                                                  0305
*         RTNREG RSTD;                                             0305
*       TESTRC=RTNREG;                                             0306
         LR    TESTRC,RTNREG                                       0306
*       RESPECIFY                                                  0307
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0307
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE FINAL CONDITION CODE TO 8 IF THE VOLUME WAS DEACT-*/
*       /* IVATED BUT COULD NOT BE EJECTED. IF THE VOL COULD NOT BE  */
*       /* DEACTIVATED, THE FINAL CODE IS 12.                @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0308
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0308
         BZ    @RF00308                                            0308
*         IF TESTRC=LASTCC08 THEN   /*                       @Y30LB31*/
         LA    @11,8                                               0309
         CR    TESTRC,@11                                          0309
         BNE   @RF00309                                            0309
*           LASTCOND=LASTCC08;      /*                       @Y30LB31*/
         L     @15,@PC00001+8                                      0310
         STH   @11,LASTCOND(,@15)                                  0310
*         ELSE                      /*                       @Y30LB31*/
*           LASTCOND=LASTCC12;      /*                       @Y30LB31*/
         B     @RC00309                                            0311
@RF00309 L     @11,@PC00001+8                                      0311
         MVC   LASTCOND(2,@11),@CH00565                            0311
*     END;                          /*                       @Y30LB31*/
*                                                                  0312
@RC00309 DS    0H                                                  0312
@RF00308 DS    0H                                                  0313
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A UNIT WAS DYNAMICALLY ALLOCATED DURING PROCESSING         */
*   /* DEALLOCATE IT.                                        @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*   IF ALLOCFLG=ON THEN             /*                       @Y30LB31*/
@RC00301 TM    ALLOCFLG,B'00100000'                                0313
         BNO   @RF00313                                            0313
*     DO;                           /*                       @Y30LB31*/
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Y30LB31*/
         L     @11,@PC00001                                        0315
         ST    @11,@AL00001                                        0315
         LA    @02,SRALLTBL                                        0315
         ST    @02,@AL00001+4                                      0315
         MVI   @AL00001+4,X'80'                                    0315
         L     @15,GDTDLC(,@11)                                    0315
         LA    @01,@AL00001                                        0315
         BALR  @14,@15                                             0315
*       RESPECIFY                                                  0316
*         RTNREG RSTD;                                             0316
*       TESTRC=RTNREG;                                             0317
         LR    TESTRC,RTNREG                                       0317
*       RESPECIFY                                                  0318
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0318
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE FINAL CONDITION CODE ONLY IF UDEALLOC RETURN   */
*       /* CODE IS HIGHER. IF UDEALLOC FAILED, THE RETURN CODE IS 4. */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0319
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB31*/
         L     @11,@PC00001+8                                      0319
         LH    @02,LASTCOND(,@11)                                  0319
         CR    @02,TESTRC                                          0319
         BNL   *+6
         LR    @02,TESTRC                                          0319
         STH   @02,LASTCOND(,@11)                                  0319
*     END;                          /*                       @Y30LB31*/
*                                                                  0320
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A MINOR ERROR OCCURRED DURING PROCESSING BUT THE VOLUME WAS*/
*   /* SUCESSFULLY ACTIVATED AND RELABELED, INSURE THE FINAL         */
*   /* CONDITION CODE IS AT LEAST 4.                         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0321
*   IF CC04FLG=ON THEN              /*                       @Y30LB31*/
@RF00313 TM    CC04FLG,B'10000000'                                 0321
         BNO   @RF00321                                            0321
*     LASTCOND=MAX(LASTCOND,LASTCC04);/*                     @Y30LB31*/
*                                                                  0322
         L     @11,@PC00001+8                                      0322
         LH    @15,LASTCOND(,@11)                                  0322
         LA    @14,4                                               0322
         CR    @15,@14                                             0322
         BNL   *+6
         LR    @15,@14                                             0322
         STH   @15,LASTCOND(,@11)                                  0322
*   /*****************************************************************/
*   /*                                                               */
*   /* RELEASE THE ENQUEUE ESTABLISHED AT THE START OF THE PROGRAM.  */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   RNMSERNO=VOLVAL;                /*                       @Y30LB31*/
@RF00321 L     @11,@PC00001+4                                      0323
         L     @11,FDTPTR(,@11)                                    0323
         MVC   RNMSERNO(6),VOLVAL(@11)                             0323
*   RNMTRAIL='.VIRTUAL.ENQUEUE';    /*                       @ZA05138*/
         MVC   RNMTRAIL(16),@CC01433                               0324
*   CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*                 @Y30LB31*/
*                                                                  0325
         L     @11,@PC00001                                        0325
         ST    @11,@AL00001                                        0325
         LA    @15,@CC01366                                        0325
         ST    @15,@AL00001+4                                      0325
         LA    @15,MINORNM                                         0325
         ST    @15,@AL00001+8                                      0325
         MVI   @AL00001+8,X'80'                                    0325
         L     @15,GDTDEQ(,@11)                                    0325
         LA    @01,@AL00001                                        0325
         BALR  @14,@15                                             0325
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE APPROPRIATE EOJ MESSAGE                         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0326
*   PRINTTBL=''B;                   /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0326
*   DARGSMOD=UNIVMSGS;              /*                       @Y30LB31*/
         L     @11,DDSTRU                                          0327
         MVC   DARGSMOD(3,@11),@CC01402                            0327
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB31*/
         L     @15,@PC00001+8                                      0328
         ST    @15,DARGDBP(,@11)                                   0328
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB31*/
         MVC   DARGILP(2,@11),@CH00153                             0329
*   IF LASTCOND>LASTCC08 THEN       /*                       @Y30LB31*/
         LH    @15,LASTCOND(,@15)                                  0330
         C     @15,@CF00179                                        0330
         BNH   @RF00330                                            0330
*     DARGSENT=MSG3003I;            /*                       @Y30LB31*/
         MVI   DARGSENT(@11),X'03'                                 0331
*   ELSE                            /*                       @Y30LB31*/
*     DARGSENT=MSG0001I;            /*                       @Y30LB31*/
         B     @RC00330                                            0332
@RF00330 L     @11,DDSTRU                                          0332
         MVI   DARGSENT(@11),X'01'                                 0332
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB31*/
@RC00330 L     @11,@PC00001                                        0333
         ST    @11,@AL00001                                        0333
         LA    @15,@CF00115                                        0333
         ST    @15,@AL00001+4                                      0333
         LA    @15,DDSTRU                                          0333
         ST    @15,@AL00001+8                                      0333
         MVI   @AL00001+8,X'80'                                    0333
         L     @15,GDTPRT(,@11)                                    0333
         LA    @01,@AL00001                                        0333
         BALR  @14,@15                                             0333
*                                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A FULL REGION DUMP UPON EXIT FROM MODULE.        @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*   IF GDTDBG=NULLPTR THEN                                         0334
         L     @11,@PC00001                                        0334
         L     @11,GDTDBG(,@11)                                    0334
         LTR   @11,@11                                             0334
         BZ    @RT00334                                            0334
*     ;                                                            0335
*   ELSE                                                           0336
*     CALL IDCDB010(GDTTBL,'SRND'); /*                       @Y30LB31*/
*                                                                  0336
         L     @11,@PC00001                                        0336
         ST    @11,@AL00001                                        0336
         LA    @15,@CC01437                                        0336
         ST    @15,@AL00001+4                                      0336
         MVI   @AL00001+4,X'80'                                    0336
         L     @15,GDTDBG(,@11)                                    0336
         LA    @01,@AL00001                                        0336
         BALR  @14,@15                                             0336
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE AMS EXECUTIVE, PASSING THE FINAL CODE FROM      */
*   /* STOREV.                                               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0337
*                                                                  0337
@RT00334 L     @11,@PC00001                                        0337
         ST    @11,@AL00001                                        0337
         LA    @15,MODID                                           0337
         ST    @15,@AL00001+4                                      0337
         L     @15,@PC00001+8                                      0337
         ST    @15,@AL00001+8                                      0337
         MVI   @AL00001+8,X'80'                                    0337
         L     @15,GDTEPL(,@11)                                    0337
         LA    @01,@AL00001                                        0337
         BALR  @14,@15                                             0337
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*                                                                  0338
*/********************************************************** @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - SETUPRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DIRECTS THE CHECKOUT OF USER SPECIFICATIONS   @Y30LB31*/
*/*            FROM THE COMMAND STATEMENT AGAINST THE        @Y30LB31*/
*/*            PRESENT STATUS OF THE VOL BEING DEACTIVATED.  @Y30LB31*/
*/*            CALLS RVVIRTN TO RETRIEVE THE BASE VOLUME     @Y30LB31*/
*/*            RECORD FROM THE INVENTORY.  CALLS VOLCKRTN    @Y30LB31*/
*/*            TO CHECK THE RECORD FOR CONFLICTS WHICH       @Y30LB31*/
*/*            PREVENT THE DEACTIVATE.  CALLS ALLOCRTN TO    @Y30LB31*/
*/*            CHECK OUT THE UNIT REQUIREMENTS.  CALLS       @Y30LB31*/
*/*            SECCKRTN TO HANDLE THE SECURITY CHECK OUT     @Y30LB31*/
*/*            REQUIRED TO DEACTIVATE THE VOLUME.  NO        @Y30LB31*/
*/*            MESSAGES ARE ISSUED BY THE PROC.              @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - NONE                                             @ZM32529*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFULL VOLUME   @Y30LB31*/
*/*          CHECKOUT.                                       @Y30LB31*/
*/*          RETURN CODE OF 4 IF CHECKOUT FAILED AND         @Y30LB31*/
*/*          CANNOT BE DEACTIVATED.                          @Y30LB31*/
*/*                                                          @Y30LB31*/
*/********************************************************** @Y30LB31*/
*                                                                  0338
*SETUPRTN:                                                         0338
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0338
@EL00001 L     @13,4(,@13)                                         0338
@EF00001 L     @00,@SIZDATD                                        0338
         LR    @01,@12                                             0338
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0338
         BR    @14                                                 0338
SETUPRTN DS    0H                                                  0339
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0339
*   DCL                                                            0339
*     SETUPRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0339
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   RETADDR1=REG14;                 /*                       @Y30LB31*/
         ST    REG14,RETADDR1                                      0340
*   OLDERID2=NEWERID2;                                             0341
         L     @11,@PC00001                                        0341
         L     @11,GDTTR2(,@11)                                    0341
         MVC   @TS00001(95),NEWERID2(@11)                          0341
         MVC   OLDERID2(95,@11),@TS00001                           0341
*   NEWID2='SRUP';                  /*                       @Y30LB31*/
*                                                                  0342
         MVC   NEWID2(4,@11),@CC01442                              0342
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */
*   /* PROCEDURE.                                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   SETUPRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0343
         SLR   @11,@11                                             0343
         STH   @11,SETUPRC                                         0343
*   /*****************************************************************/
*   /*                                                               */
*   /* RETRIEVE THE BASE VOL RECORD FROM THE MSVI FOR THE VOLUME     */
*   /* BEING DEACTIVATED.                                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0344
*   CALL RVVIRTN;                   /*                       @Y30LB31*/
         BAL   @14,RVVIRTN                                         0344
*   RESPECIFY                                                      0345
*     RTNREG RSTD;                                                 0345
*   TESTRC=RTNREG;                                                 0346
         LR    TESTRC,RTNREG                                       0346
*   RESPECIFY                                                      0347
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  0347
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM THIS PROC IF THE READ FAILED.               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0348
         BZ    @RF00348                                            0348
*     SETUPRC=4;                    /*                       @Y30LB31*/
*                                                                  0349
         MVC   SETUPRC(2),@CH00042                                 0349
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE VOL RECORD FOR CONFLICTS PROHIBITING THE DEACTIVATE.*/
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC00348                                            0350
@RF00348 DS    0H                                                  0351
*       CALL VOLCKRTN;              /*                       @Y30LB31*/
         BAL   @14,VOLCKRTN                                        0351
*       RESPECIFY                                                  0352
*         RTNREG RSTD;                                             0352
*       TESTRC=RTNREG;                                             0353
         LR    TESTRC,RTNREG                                       0353
*       RESPECIFY                                                  0354
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0354
*       /*************************************************************/
*       /*                                                           */
*       /* EXIT FROM THIS PROC IF A CONFLICT EXISTS WHICH PROHIBITS  */
*       /* THE DEACTIVATE.                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0355
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0355
         BZ    @RF00355                                            0355
*         SETUPRC=4;                /*                       @Y30LB31*/
*                                                                  0356
         MVC   SETUPRC(2),@CH00042                                 0356
*       /*************************************************************/
*       /*                                                           */
*       /* VERIFY THAT UNIT ALLOCATION REQUIREMENTS HAVE BEEN MET.   */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0357
*       ELSE                        /*                       @Y30LB31*/
*         DO;                       /*                       @Y30LB31*/
         B     @RC00355                                            0357
@RF00355 DS    0H                                                  0358
*           CALL ALLOCRTN;          /*                       @Y30LB31*/
         BAL   @14,ALLOCRTN                                        0358
*           RESPECIFY                                              0359
*             RTNREG RSTD;                                         0359
*           TESTRC=RTNREG;                                         0360
         LR    TESTRC,RTNREG                                       0360
*           RESPECIFY                                              0361
*             RTNREG UNRSTD;        /*                       @Y30LB31*/
*                                                                  0361
*           /*********************************************************/
*           /*                                                       */
*           /* EXIT FROM THIS PROC IF THE UNIT ALLOCATION            */
*           /* REQUIREMENTS WERE NOT MET.                    @Y30LB31*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0362
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0362
         BZ    @RF00362                                            0362
*             SETUPRC=4;            /*                       @Y30LB31*/
*                                                                  0363
         MVC   SETUPRC(2),@CH00042                                 0363
*           /*********************************************************/
*           /*                                                       */
*           /* PERFORM THE APPROPRIATE SECURITY CHECKS REQUIRED TO   */
*           /* DEACTIVATE THE VOLUME.                        @Y30LB31*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0364
*           ELSE                    /*                       @Y30LB31*/
*             DO;                   /*                       @Y30LB31*/
         B     @RC00362                                            0364
@RF00362 DS    0H                                                  0365
*               CALL SECCKRTN;      /*                       @Y30LB31*/
         BAL   @14,SECCKRTN                                        0365
*               RESPECIFY                                          0366
*                 RTNREG RSTD;                                     0366
*               TESTRC=RTNREG;                                     0367
         LR    TESTRC,RTNREG                                       0367
*               RESPECIFY                                          0368
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/
*                                                                  0368
*               /*****************************************************/
*               /*                                                   */
*               /* EXIT WITH AN ERROR RETURN CODE IF THE SECURITY    */
*               /* CHECKS FAILED.                            @Y30LB31*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0369
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0369
         BZ    @RF00369                                            0369
*                 SETUPRC=4;        /*                       @Y30LB31*/
         MVC   SETUPRC(2),@CH00042                                 0370
*             END;                  /*                       @Y30LB31*/
@RF00369 DS    0H                                                  0372
*         END;                      /*                       @Y30LB31*/
@RC00362 DS    0H                                                  0373
*     END;                          /*                       @Y30LB31*/
*                                                                  0373
@RC00355 DS    0H                                                  0374
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER AND EXIT FROM*/
*   /* SETUPRTN, PASSING THE CONDITION CODE IN REG 15.       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0374
*   REG14=RETADDR1;                 /*                       @Y30LB31*/
@RC00348 L     REG14,RETADDR1                                      0374
*   RETURN CODE(SETUPRC);           /*                       @Y30LB31*/
         LH    @15,SETUPRC                                         0375
@EL00002 DS    0H                                                  0375
@EF00002 DS    0H                                                  0375
@ER00002 BR    @14                                                 0375
*   END SETUPRTN;                   /*                       @Y30LB31*/
*                                                                  0377
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - RVVIRTN                                 @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - READS A BASE VOLUME RECORD.  CALLS SSCMSG     @Y30LB31*/
*/*            TO OUTPUT ANY MSSC ERROR MESSAGES.            @Y30LB31*/
*/*            MESSAGE IDC2080I MAY BE ISSUED.               @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, VOLUME RECORD BUFFER, AND PRINTTBL       @Y30LB31*/
*/*         FOR MESSAGE.                                     @ZM32529*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 4 IF READ FAILED.  RETURN        @Y30LB31*/
*/*          CODE OF 0 INDICATES SUCCESSFUL READ AND         @Y30LB31*/
*/*          BUFFER CONTAINS THE RECORD.                     @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0377
*RVVIRTN:                                                          0377
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0377
RVVIRTN  DS    0H                                                  0378
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @ZM32529*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0378
*   DCL                                                            0378
*     RVRTNRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0378
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP LOCAL STORAGE AREA TO BUILD MSVC RVVI PARAMETER LIST TO */
*   /* READ A RECORD FROM MSVI.                              @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0379
*   DCL                                                            0379
*     1 SR01RVVI BDY(WORD),         /*                       @Y30LB31*/
*      2 SRVVIHDR CHAR(8),          /* RVVI ARG LIST ID      @Y30LB31*/
*      2 SRVVITBL CHAR(LENGTH(RVVI)) BDY(WORD);/*            @Y30LB31*/
*                                                                  0380
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0380
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      0380
*   OLDERID2=NEWERID2;                                             0381
         L     @11,@PC00001                                        0381
         L     @06,GDTTR2(,@11)                                    0381
         MVC   @TS00001(95),NEWERID2(@06)                          0381
         MVC   OLDERID2(95,@06),@TS00001                           0381
*   NEWID2='SRRV';                  /*                       @Y30LB31*/
*                                                                  0382
         MVC   NEWID2(4,@06),@CC01454                              0382
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */
*   /* PROCEDURE.                                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0383
*   RVRTNRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0383
         SLR   @06,@06                                             0383
         LR    RVRTNRC,@06                                         0383
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MSVC READ PARM LIST.                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0384
*   SRVVIHDR='RVVI';                /*                       @Y30LB31*/
         MVI   SRVVIHDR+4,C' '                                     0384
         MVC   SRVVIHDR+5(3),SRVVIHDR+4                            0384
         MVC   SRVVIHDR(4),@CC01455                                0384
*   RVVIPTR=ADDR(SRVVITBL);         /*                       @Y30LB31*/
         LA    @15,SRVVITBL                                        0385
         ST    @15,RVVIPTR                                         0385
*   RVVI=''B;                       /*                       @Y30LB31*/
         XC    RVVI(68,@15),RVVI(@15)                              0386
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB31*/
         LH    @14,RVVLEN                                          0387
         ST    @14,RVVLNGTH(,@15)                                  0387
*   RVVCODE=RVVOP;                  /*                       @Y30LB31*/
         MVI   RVVCODE(@15),X'87'                                  0388
*   RVVRDR=ON;                      /*                       @Y30LB31*/
         OI    RVVRDR(@15),B'10000000'                             0389
*   RVVBVRCD=ON;                    /*                       @Y30LB31*/
         OI    RVVBVRCD(@15),B'10000000'                           0390
*   RVVOLUME=VOLVAL;                /*                       @Y30LB31*/
         L     @14,@PC00001+4                                      0391
         L     @01,FDTPTR(,@14)                                    0391
         MVC   RVVOLUME(6,@15),VOLVAL(@01)                         0391
*   RVVSVOL=ON;                     /*                       @Y30LB31*/
         OI    RVVSVOL(@15),B'00000001'                            0392
*   RVVRTBUF=ADDR(SVOLREC);         /*                       @Y30LB31*/
         LA    @14,SVOLREC                                         0393
         ST    @14,RVVRTBUF(,@15)                                  0393
*   RVVBUFLN=LENGTH(SVOLREC);       /*                       @Y30LB31*/
*                                                                  0394
         MVC   RVVBUFLN(2,@15),@CH01699                            0394
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE RVVI PARM LIST BEFORE THE READ.   */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*   IF GDTDBG=NULLPTR THEN                                         0395
         C     @06,GDTDBG(,@11)                                    0395
         BE    @RT00395                                            0395
*     ;                                                            0396
*   ELSE                                                           0397
*     DO;                                                          0397
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0398
*       DMPITMNM='SR01RVVI';                                       0399
         MVC   DMPITMNM(8,DMPINDEX),@CC01456                       0399
*       DMPITMPT=ADDR(SR01RVVI);                                   0400
         LA    @11,SR01RVVI                                        0400
         ST    @11,DMPITMPT(,DMPINDEX)                             0400
*       DMPITMLN=LENGTH(SR01RVVI);                                 0401
         MVC   DMPITMLN(2,DMPINDEX),@CH01700                       0401
*       DMPITMTP='H';                                              0402
         MVI   DMPITMTP(DMPINDEX),C'H'                             0402
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0403
         AL    DMPINDEX,@CF00473                                   0403
*       DMPTRM=DMPTRMVL;                                           0404
         MVI   DMPTRM(DMPINDEX),X'FF'                              0404
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         0406
@RT00395 L     @11,@PC00001                                        0406
         L     @11,GDTDBG(,@11)                                    0406
         LTR   @11,@11                                             0406
         BZ    @RT00406                                            0406
*     ;                                                            0407
*   ELSE                                                           0408
*     CALL IDCDB010(GDTTBL,'SRRD',ADDR(DUMPLIST));/*         @Y30LB31*/
*                                                                  0408
         L     @11,@PC00001                                        0408
         ST    @11,@AL00001                                        0408
         LA    @06,@CC01458                                        0408
         ST    @06,@AL00001+4                                      0408
         LA    @06,DUMPLIST                                        0408
         ST    @06,@AFTEMPS                                        0408
         LA    @06,@AFTEMPS                                        0408
         ST    @06,@AL00001+8                                      0408
         MVI   @AL00001+8,X'80'                                    0408
         L     @15,GDTDBG(,@11)                                    0408
         LA    @01,@AL00001                                        0408
         BALR  @14,@15                                             0408
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE RECORD SPECIFIED IN THE RVVI PARM LIST.      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASON);/*             @Y30LB31*/
@RT00406 L     @11,@PC00001                                        0409
         ST    @11,@AL00001                                        0409
         LA    @06,VVIC                                            0409
         ST    @06,@AL00001+4                                      0409
         LA    @06,RVVIPTR                                         0409
         ST    @06,@AL00001+8                                      0409
         LA    @06,REASON                                          0409
         ST    @06,@AL00001+12                                     0409
         MVI   @AL00001+12,X'80'                                   0409
         L     @15,GDTSSC(,@11)                                    0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*   RESPECIFY                                                      0410
*     RTNREG RSTD;                                                 0410
*   TESTRC=RTNREG;                                                 0411
         LR    TESTRC,RTNREG                                       0411
*   RESPECIFY                                                      0412
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  0413
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE READ FAILED, PRINT A MESSAGE WITH THE MSVC REASON CODE.*/
*   /* THEN PRINT AN ACCOMPANYING SECONDARY MSG IDC2080I INDICATING  */
*   /* THE RECORD COULD NOT BE RETRIEVED.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0413
         BZ    @RF00413                                            0413
*     DO;                           /*                       @Y30LB31*/
*       RVRTNRC=4;                  /*                       @Y30LB31*/
         LA    RVRTNRC,4                                           0415
*       CALL SSCMSG(REASON);        /* PRINT MSVC MSG        @Y30LB31*/
         LA    @11,REASON                                          0416
         ST    @11,@AL00001                                        0416
         LA    @01,@AL00001                                        0416
         BAL   @14,SSCMSG                                          0416
*       PRINTTBL=''B;               /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0417
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/
         L     @11,DDSTRU                                          0418
         MVC   DARGSMOD(3,@11),@CC01387                            0418
*       DARGSENT=MSG2080I;          /* STID = CM026          @Y30LB31*/
         MVI   DARGSENT(@11),X'1A'                                 0419
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB31*/
         L     @06,@PC00001+4                                      0420
         L     @06,FDTPTR(,@06)                                    0420
         LA    @15,VOLVAL(,@06)                                    0420
         ST    @15,DARGDBP(,@11)                                   0420
*       DARGILP=VOLLEN;             /*                       @Y30LB31*/
         SLR   @15,@15                                             0421
         IC    @15,VOLLEN(,@06)                                    0421
         STH   @15,DARGILP(,@11)                                   0421
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/
*                                                                  0422
         L     @11,@PC00001                                        0422
         ST    @11,@AL00001                                        0422
         LA    @06,@CF00115                                        0422
         ST    @06,@AL00001+4                                      0422
         LA    @06,DDSTRU                                          0422
         ST    @06,@AL00001+8                                      0422
         MVI   @AL00001+8,X'80'                                    0422
         L     @15,GDTPRT(,@11)                                    0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE DO GROUP THAT HANDLES READ FAILURE.         @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0423
*     END;                          /*                       @Y30LB31*/
*                                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER, VTYPERTN.   */
*   /* EXIT FROM RVVIRTN PASSING CONDITION CODE IN REG 15.   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0424
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RF00413 LR    REG14,RETADDR2                                      0424
*   RETURN CODE(RVRTNRC);           /*                       @Y30LB31*/
         LR    @15,RVRTNRC                                         0425
@EL00003 DS    0H                                                  0425
@EF00003 DS    0H                                                  0425
@ER00003 BR    @14                                                 0425
*   END RVVIRTN;                    /*                       @Y30LB31*/
*                                                                  0427
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - VOLCKRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - CHECKS THE VOLUME RECORD FOR CONFLICTS THAT   @Y30LB31*/
*/*            PROHIBIT DEACTIVATING THE VOLUME.  ISSUES     @Y30LB31*/
*/*            MESSAGES IDC3730I, IDC3074I, IDC3097I,        @Y30LB31*/
*/*            IDC3096I, IDC3095I, AND IDC3090I FOR THE      @Y30LB31*/
*/*            PARTICULAR ERROR THAT EXISTS.                 @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, DARGLIST, BASEV.                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL CHECKOUT  @Y30LB31*/
*/*          RETURN CODE OF 4 INDICATES A CONFLICT EXISTS.   @Y30LB31*/
*/*          VOLUME CANNOT BE DEACTIVATED.  APPROPRIATE MSGS @Y30LB31*/
*/*          WERE ISSUED.                                    @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0427
*VOLCKRTN:                                                         0427
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0427
VOLCKRTN DS    0H                                                  0428
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS.                                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0428
*   DCL                                                            0428
*     VOLCKRC FIXED(15);            /* LOCAL CONDITION CODE  @Y30LB31*/
*   DCL                                                            0429
*     ZEROES BIT(16) CONSTANT('0000'X);/*                    @Y30LB31*/
*                                                                  0429
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE CALLERS RETURN ADDR SINCE THERE IS NO SAVE AREA. REG 14  */
*   /* WILL BE RESTORED UPON EXIT FROM THIS PROC.            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0430
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      0430
*   OLDERID2=NEWERID2;                                             0431
         L     @11,@PC00001                                        0431
         L     @06,GDTTR2(,@11)                                    0431
         MVC   @TS00001(95),NEWERID2(@06)                          0431
         MVC   OLDERID2(95,@06),@TS00001                           0431
*   NEWID2='SRVO';                  /*                       @Y30LB31*/
*                                                                  0432
         MVC   NEWID2(4,@06),@CC01466                              0432
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE COND CODE SET BY THIS PROC.    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   VOLCKRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0433
         SLR   VOLCKRC,VOLCKRC                                     0433
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE AN ERROR MESSAGE AND EXIT FROM THIS PROCEDURE IF THE    */
*   /* VOLUME TO BE ACTIVATED IS ALREADY INACTIVE.           @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0434
*   IF BASINAC=ON THEN              /*                       @Y30LB31*/
         TM    BASINAC(BASEVPTR),B'00000100'                       0434
         BNO   @RF00434                                            0434
*     DO;                           /*                       @Y30LB31*/
*       VOLCKRC=4;                  /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0436
*       PRINTTBL=''B;               /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0437
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/
         L     @06,DDSTRU                                          0438
         MVC   DARGSMOD(3,@06),@CC01387                            0438
*       DARGSENT=MSG3074I;          /* STID = CM032          @Y30LB31*/
         MVI   DARGSENT(@06),X'20'                                 0439
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB31*/
         L     @04,@PC00001+4                                      0440
         L     @04,FDTPTR(,@04)                                    0440
         LA    @02,VOLVAL(,@04)                                    0440
         ST    @02,DARGDBP(,@06)                                   0440
*       DARGILP=VOLLEN;             /*                       @Y30LB31*/
         SLR   @02,@02                                             0441
         IC    @02,VOLLEN(,@04)                                    0441
         STH   @02,DARGILP(,@06)                                   0441
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/
         ST    @11,@AL00001                                        0442
         LA    @06,@CF00115                                        0442
         ST    @06,@AL00001+4                                      0442
         LA    @06,DDSTRU                                          0442
         ST    @06,@AL00001+8                                      0442
         MVI   @AL00001+8,X'80'                                    0442
         L     @15,GDTPRT(,@11)                                    0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*     END;                          /*                       @Y30LB31*/
*                                                                  0443
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE AN ERROR MSG IF THE VOLUME IS FLAGGED FOR RECOVERY      */
*   /* REASONS AS UNUSABLE. THEN EXIT FROM THIS PROCEDURE.   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*   ELSE                            /*                       @Y30LB31*/
*     IF BASSATIA^=ZEROES THEN      /*                       @Y30LB31*/
         B     @RC00434                                            0444
@RF00434 CLC   BASSATIA(2,BASEVPTR),@CB01465                       0444
         BE    @RF00444                                            0444
*       DO;                         /*                       @Y30LB31*/
*         PRINTTBL=''B;             /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0446
*         DARGSMOD=COMMSGS;         /*                       @Y30LB31*/
         L     @11,DDSTRU                                          0447
         MVC   DARGSMOD(3,@11),@CC01387                            0447
*         DARGDBP=ADDR(VOLVAL);     /*                       @Y30LB31*/
         L     @06,@PC00001+4                                      0448
         L     @06,FDTPTR(,@06)                                    0448
         LA    @04,VOLVAL(,@06)                                    0448
         ST    @04,DARGDBP(,@11)                                   0448
*         DARGILP=VOLLEN;           /*                       @Y30LB31*/
*                                                                  0449
         SLR   @04,@04                                             0449
         IC    @04,VOLLEN(,@06)                                    0449
         STH   @04,DARGILP(,@11)                                   0449
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MSG IDC3097I IF THE VOLUME IS INCOMPLETELY        */
*         /* CREATED.                                        @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0450
*         IF BASIVCRE=ON THEN       /*                       @Y30LB31*/
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0450
         BNO   @RF00450                                            0450
*           DO;                     /*                       @Y30LB31*/
*             VOLCKRC=4;            /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0452
*             DARGSENT=MSG3097I;    /* STID=CM03             @Y30LB31*/
         MVI   DARGSENT(@11),X'03'                                 0453
*           END;                    /*                       @Y30LB31*/
*                                                                  0454
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MSG IDC3096I IF THE VOLUME IS AN INCOMPLETE COPY. */
*         /*                                                 @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0455
*         ELSE                      /*                       @Y30LB31*/
*           IF BASIVCPY=ON THEN     /*                       @Y30LB31*/
         B     @RC00450                                            0455
@RF00450 TM    BASIVCPY(BASEVPTR),B'01000000'                      0455
         BNO   @RF00455                                            0455
*             DO;                   /*                       @Y30LB31*/
*               VOLCKRC=4;          /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0457
*               DARGSENT=MSG3096I;  /* STID=CM06             @Y30LB31*/
         L     @11,DDSTRU                                          0458
         MVI   DARGSENT(@11),X'06'                                 0458
*             END;                  /*                       @Y30LB31*/
*                                                                  0459
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE MSG IDC3095I IF THE VOLUME HAS A SERIAL MISMATCH  */
*         /* AND A NEW SERIAL WAS NOT SPECIFIED.             @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0460
*           ELSE                    /*                       @Y30LB31*/
*             IF BASVSMIS=ON&ADDR(NSER)=NULLPTR THEN/*       @Y30LB31*/
         B     @RC00455                                            0460
@RF00455 TM    BASVSMIS(BASEVPTR),B'00100000'                      0460
         BNO   @RF00460                                            0460
         L     @11,@PC00001+4                                      0460
         L     @11,FDTPTR+4(,@11)                                  0460
         LTR   @11,@11                                             0460
         BNZ   @RF00460                                            0460
*               DO;                 /*                       @Y30LB31*/
*                 VOLCKRC=4;        /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0462
*                 DARGSENT=MSG3095I;/* STID=CM09             @Y30LB31*/
         L     @11,DDSTRU                                          0463
         MVI   DARGSENT(@11),X'09'                                 0463
*               END;                /*                       @Y30LB31*/
*                                                                  0464
*         /***********************************************************/
*         /*                                                         */
*         /* PRINT THE APPROPRIATE MESSAGE IF THE VOLUME IS FLAGGED  */
*         /* FOR A CONDITION FROM WHICH ADDV CANNOT RECOVER. @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0465
*         IF DARGSENT^=0 THEN       /*                       @Y30LB31*/
@RF00460 DS    0H                                                  0465
@RC00455 DS    0H                                                  0465
@RC00450 L     @11,DDSTRU                                          0465
         CLI   DARGSENT(@11),0                                     0465
         BE    @RF00465                                            0465
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
         L     @11,@PC00001                                        0466
         ST    @11,@AL00001                                        0466
         LA    @06,@CF00115                                        0466
         ST    @06,@AL00001+4                                      0466
         LA    @06,DDSTRU                                          0466
         ST    @06,@AL00001+8                                      0466
         MVI   @AL00001+8,X'80'                                    0466
         L     @15,GDTPRT(,@11)                                    0466
         LA    @01,@AL00001                                        0466
         BALR  @14,@15                                             0466
*       END;                        /*                       @Y30LB31*/
*     ELSE                          /*                       @Y30LB31*/
*       DO;                         /*                       @Y30LB31*/
*                                                                  0468
         B     @RC00444                                            0468
@RF00444 DS    0H                                                  0469
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE AN ERROR MSG IF A NEW VOLUME SERIAL NO. IS        */
*         /* REQUESTED BUT THE VOLUME HAS COPIES.            @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0469
*         IF BASNCOPY^=0&           /*                       @Y30LB31*/
*             ADDR(NSER)^=NULLPTR THEN/*                     @Y30LB31*/
         CLI   BASNCOPY(BASEVPTR),0                                0469
         BE    @RF00469                                            0469
         L     @11,@PC00001+4                                      0469
         L     @06,FDTPTR+4(,@11)                                  0469
         LTR   @06,@06                                             0469
         BZ    @RF00469                                            0469
*           DO;                     /*                       @Y30LB31*/
*             VOLCKRC=4;            /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0471
*             PRINTTBL=''B;         /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0472
*             DARGSMOD=STORMSGS;    /*                       @Y30LB31*/
         L     @06,DDSTRU                                          0473
         MVC   DARGSMOD(3,@06),@CC01378                            0473
*             DARGSENT=MSG3730I;    /* STID=SR01             @Y30LB31*/
         MVI   DARGSENT(@06),X'01'                                 0474
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB31*/
         L     @11,FDTPTR(,@11)                                    0475
         LA    @04,VOLVAL(,@11)                                    0475
         ST    @04,DARGDBP(,@06)                                   0475
*             DARGILP=VOLLEN;       /*                       @Y30LB31*/
         SLR   @04,@04                                             0476
         IC    @04,VOLLEN(,@11)                                    0476
         STH   @04,DARGILP(,@06)                                   0476
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/
         L     @11,@PC00001                                        0477
         ST    @11,@AL00001                                        0477
         LA    @06,@CF00115                                        0477
         ST    @06,@AL00001+4                                      0477
         LA    @06,DDSTRU                                          0477
         ST    @06,@AL00001+8                                      0477
         MVI   @AL00001+8,X'80'                                    0477
         L     @15,GDTPRT(,@11)                                    0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*           END;                    /*                       @Y30LB31*/
*                                                                  0478
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE AN ERROR MSG IF A NEW VOLUME SERIAL NO. IS        */
*         /* REQUESTED BUT THE VOLUME IS READONLY.           @Y30LB31*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0479
*         IF BASRONLY=ON&           /*                       @Y30LB31*/
*             ADDR(NSER)^=NULLPTR THEN/*                     @Y30LB31*/
@RF00469 TM    BASRONLY(BASEVPTR),B'01000000'                      0479
         BNO   @RF00479                                            0479
         L     @11,@PC00001+4                                      0479
         L     @06,FDTPTR+4(,@11)                                  0479
         LTR   @06,@06                                             0479
         BZ    @RF00479                                            0479
*           DO;                     /*                       @Y30LB31*/
*             VOLCKRC=4;            /*                       @Y30LB31*/
         LA    VOLCKRC,4                                           0481
*             PRINTTBL=''B;         /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0482
*             DARGSMOD=COMMSGS;     /*                       @Y30LB31*/
         L     @06,DDSTRU                                          0483
         MVC   DARGSMOD(3,@06),@CC01387                            0483
*             DARGSENT=MSG3090I;    /* STID=CM016            @Y30LB31*/
         MVI   DARGSENT(@06),X'10'                                 0484
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB31*/
         L     @11,FDTPTR(,@11)                                    0485
         LA    @04,VOLVAL(,@11)                                    0485
         ST    @04,DARGDBP(,@06)                                   0485
*             DARGILP=VOLLEN;       /*                       @Y30LB31*/
         SLR   @04,@04                                             0486
         IC    @04,VOLLEN(,@11)                                    0486
         STH   @04,DARGILP(,@06)                                   0486
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/
         L     @11,@PC00001                                        0487
         ST    @11,@AL00001                                        0487
         LA    @06,@CF00115                                        0487
         ST    @06,@AL00001+4                                      0487
         LA    @06,DDSTRU                                          0487
         ST    @06,@AL00001+8                                      0487
         MVI   @AL00001+8,X'80'                                    0487
         L     @15,GDTPRT(,@11)                                    0487
         LA    @01,@AL00001                                        0487
         BALR  @14,@15                                             0487
*           END;                    /*                       @Y30LB31*/
*       END;                        /*                       @Y30LB31*/
*                                                                  0489
@RF00479 DS    0H                                                  0490
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */
*   /* FROM VOLCKRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RC00444 DS    0H                                                  0490
@RC00434 LR    REG14,RETADDR2                                      0490
*   RETURN CODE(VOLCKRC);           /*                       @Y30LB31*/
         LR    @15,VOLCKRC                                         0491
@EL00004 DS    0H                                                  0491
@EF00004 DS    0H                                                  0491
@ER00004 BR    @14                                                 0491
*   END VOLCKRTN;                   /*                       @Y30LB31*/
*                                                                  0493
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - ALLOCRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - IF FILE IS NOT SPECIFIED EITHER SELECTS       @YD00175*/
*/*            AN EXCLUSIVE UNIT TO USE OR DYNAMICALLY       @YD00175*/
*/*            ALLOCATES A UNIT. VERIFIES THAT THE UNIT IN   @YD00175*/
*/*            THE FILE PARAMETER IS VIRTUAL.                @YD00175*/
*/*            MESSAGE IDC3092I IS ISSUED BY THIS ROUTINE.   @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, BASEV.                                   @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL ALLOC-    @Y30LB31*/
*/*          TION AND CHECK OUT AND UPDATED STORETBL. RETURN @Y30LB31*/
*/*          CODE OF 4 INDICATES DYNAMIC ALLOCATION FAILED   @Y30LB31*/
*/*          OR THE UNIT NOT VIRTUAL OR UNIT COULD NOT       @YD00175*/
*/*          BE OBTAINED FOR EXCLUSIVE USE                   @YD00175*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0493
*ALLOCRTN:                                                         0493
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0493
ALLOCRTN DS    0H                                                  0494
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0494
*   DCL                                                            0494
*     ALLOCRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0494
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP STORAGE AREA TO BUILD CKAGL FOR UNIT CHECKOUT.  @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*   DCL                                                            0495
*     SRCKAGL CHAR(LENGTH(CKAGL)) BDY(WORD);/*               @Y30LB31*/
*                                                                  0495
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0496
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      0496
*   OLDERID2=NEWERID2;                                             0497
         L     @11,@PC00001                                        0497
         L     @06,GDTTR2(,@11)                                    0497
         MVC   @TS00001(95),NEWERID2(@06)                          0497
         MVC   OLDERID2(95,@06),@TS00001                           0497
*   NEWID2='SRAL';                  /*                       @Y30LB31*/
*                                                                  0498
         MVC   NEWID2(4,@06),@CC01472                              0498
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS PROCEDURE. */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   ALLOCRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0499
         SLR   @06,@06                                             0499
         LR    ALLOCRC,@06                                         0499
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FILE IS NOT SPECIFIED, A UNIT CAN BE DYNAMICALLY ALLOCATED */
*   /* IF THE VOLUME BEING DEACTIVATED IS NOT CURRENTLY FLAGGED DUE  */
*   /* TO A PREVIOUS RENAME FAILURE. ISSUE ERROR MSG IDC3092I AND    */
*   /* EXIT FROM THIS PROC IF THE UNIT CANNOT BE DYNAMICALLY         */
*   /* ALLOCATED BECAUSE DEFERRED MOUNT IS REQUIRED FOR A VOL WITH A */
*   /* LABEL MISMATCH.                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0500
*   IF ADDR(FILE)=NULLPTR&BASVSMIS=ON THEN/*                 @Y30LB31*/
         L     @15,@PC00001+4                                      0500
         C     @06,FDTPTR+40(,@15)                                 0500
         BNE   @RF00500                                            0500
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0500
         BNO   @RF00500                                            0500
*     DO;                           /*                       @Y30LB31*/
*       ALLOCRC=4;                  /*                       @Y30LB31*/
         LA    ALLOCRC,4                                           0502
*       PRINTTBL=''B;               /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0503
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/
         L     @06,DDSTRU                                          0504
         MVC   DARGSMOD(3,@06),@CC01387                            0504
*       DARGSENT=MSG3092I;          /* STID=CM014            @Y30LB31*/
         MVI   DARGSENT(@06),X'0E'                                 0505
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/
         ST    @11,@AL00001                                        0506
         LA    @06,@CF00115                                        0506
         ST    @06,@AL00001+4                                      0506
         LA    @06,DDSTRU                                          0506
         ST    @06,@AL00001+8                                      0506
         MVI   @AL00001+8,X'80'                                    0506
         L     @15,GDTPRT(,@11)                                    0506
         LA    @01,@AL00001                                        0506
         BALR  @14,@15                                             0506
*     END;                          /*                       @Y30LB31*/
*   ELSE                            /*                       @Y30LB31*/
*                                                                  0508
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE FILE PARAMETER IS NOT SPECIFIED, TRY TO OBTAIN A UNIT*/
*     /* FOR EXCLUSIVE USE. IF THAT FAILS, DYNAMICALLY ALLOCATE A    */
*     /* UNIT.                                               @YD00175*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0508
*     IF ADDR(FILE)=NULLPTR THEN    /*                       @Y30LB31*/
         B     @RC00500                                            0508
@RF00500 L     @11,@PC00001+4                                      0508
         L     @06,FDTPTR+40(,@11)                                 0508
         LTR   @06,@06                                             0508
         BNZ   @RF00508                                            0508
*       DO;                         /*                       @Y30LB31*/
*                                                                  0509
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP THE PARAMETER LIST FOR UMSSUNIT          @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0510
*         EXCLAGL=''B;              /*                       @YD00175*/
         LA    @06,SREXCLST                                        0510
         XC    EXCLAGL(23,@06),EXCLAGL(@06)                        0510
*         EXCLDDP=ADDR(SUNITDDN);   /*                       @YD00175*/
         LA    @02,SUNITDDN                                        0511
         ST    @02,EXCLDDP(,@06)                                   0511
*         EXCLUCBP=ADDR(SUNITUCB);  /*                       @YD00175*/
         LA    @02,SUNITUCB                                        0512
         ST    @02,EXCLUCBP(,@06)                                  0512
*         EXCLVOL=VOLVAL;           /*                       @YD00175*/
*                                                                  0513
         L     @11,FDTPTR(,@11)                                    0513
         MVC   EXCLVOL(6,@06),VOLVAL(@11)                          0513
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UMSSUNIT TO SELECT A UNIT FOR REUSE IF THE VOLUME */
*         /* IS ALREADY ALLOCATED EXCLUSIVELY.               @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0514
*         CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*           @YD00175*/
         L     @11,@PC00001                                        0514
         ST    @11,@AL00001                                        0514
         LA    @02,SELECTX                                         0514
         ST    @02,@AL00001+4                                      0514
         ST    @06,@AL00001+8                                      0514
         MVI   @AL00001+8,X'80'                                    0514
         L     @15,GDTUNT(,@11)                                    0514
         LA    @01,@AL00001                                        0514
         BALR  @14,@15                                             0514
*         RESPECIFY                                                0515
*           RTNREG RSTD;                                           0515
*         TESTRC=RTNREG;                                           0516
         LR    TESTRC,RTNREG                                       0516
*         RESPECIFY                                                0517
*           RTNREG UNRSTD;          /*                       @YD00175*/
*                                                                  0517
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE RETURN CODE IS NOT ZERO, EXIT PROC       @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0518
*         IF TESTRC>0 THEN                                         0518
         LTR   TESTRC,TESTRC                                       0518
         BNP   @RF00518                                            0518
*           ALLOCRC=LASTCC04;       /*                       @YD00175*/
*                                                                  0519
         LA    ALLOCRC,4                                           0519
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO ERROR BUT NO UCB RETURNED, DO DYNAMIC ALLOCATION. */
*         /*                                                 @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0520
*         ELSE                      /*                       @YD00175*/
*           IF SUNITUCB=0 THEN      /*                       @YD00175*/
         B     @RC00518                                            0520
@RF00518 L     @11,SUNITUCB                                        0520
         LTR   @11,@11                                             0520
         BNZ   @RF00520                                            0520
*             DO;                   /*                       @YD00175*/
*               ALLOPTVL=ON;        /*                       @Y30LB31*/
         LA    @11,SRALLTBL                                        0522
         OI    ALLOPTVL(@11),B'10000000'                           0522
*               ALLVLCNT=1;         /*                       @YD00175*/
         MVI   ALLVLCNT(@11),X'01'                                 0523
*               ALLUNCNT=1;         /*                       @Y30LB31*/
         MVI   ALLUNCNT(@11),X'01'                                 0524
*               ALLOPTPV=ON;        /*                       @Y30LB31*/
         OI    ALLOPTPV(@11),B'00100000'                           0525
*               ALLULP=ADDR(SUNITLST);/*                     @Y30LB31*/
         LA    @06,SUNITLST                                        0526
         ST    @06,ALLULP(,@11)                                    0526
*               SUNITCNT=1;         /*                       @Y30LB31*/
         LA    @06,1                                               0527
         STH   @06,SUNITCNT                                        0527
*               SUNITLEN=LENGTH(DEV3330V);/*                 @Y30LB31*/
         MVC   SUNITLEN(2),@CH00430                                0528
*               SUNITVAL=DEV3330V;  /*                       @Y30LB31*/
         MVI   SUNITVAL+5,C' '                                     0529
         MVC   SUNITVAL+6(2),SUNITVAL+5                            0529
         MVC   SUNITVAL(5),@CC01354                                0529
*               ALLVLP=ADDR(SVOLLST);/*                      @Y30LB31*/
         LA    @02,SVOLLST                                         0530
         ST    @02,ALLVLP(,@11)                                    0530
*               SERCNT=1;           /*                       @Y30LB31*/
         STH   @06,SERCNT                                          0531
*               SERLEN=VOLLEN;      /*                       @Y30LB31*/
         L     @06,@PC00001+4                                      0532
         L     @06,FDTPTR(,@06)                                    0532
         SLR   @02,@02                                             0532
         IC    @02,VOLLEN(,@06)                                    0532
         STH   @02,SERLEN                                          0532
*               SERNO=VOLVAL;       /*                       @Y30LB31*/
         MVC   SERNO(6),VOLVAL(@06)                                0533
*               CALL IDCSAAL0(GDTTBL,ALLAGL);/*              @Y30LB31*/
         L     @06,@PC00001                                        0534
         ST    @06,@AL00001                                        0534
         ST    @11,@AL00001+4                                      0534
         MVI   @AL00001+4,X'80'                                    0534
         L     @15,GDTALC(,@06)                                    0534
         LA    @01,@AL00001                                        0534
         BALR  @14,@15                                             0534
*               RESPECIFY                                          0535
*                 RTNREG RSTD;                                     0535
*               TESTRC=RTNREG;                                     0536
         LR    TESTRC,RTNREG                                       0536
*               RESPECIFY                                          0537
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/
*                                                                  0537
*               /*****************************************************/
*               /*                                                   */
*               /* TEST RETURN CODE FROM DYNAMIC ALLOCATION REQUEST  */
*               /* AND EXIT FROM THIS PROC IF DYNAMIC ALLOCATION     */
*               /* FAILED.                                   @Y30LB31*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0538
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0538
         BZ    @RF00538                                            0538
*                 ALLOCRC=4;        /*                       @Y30LB31*/
*                                                                  0539
         LA    ALLOCRC,4                                           0539
*               /*****************************************************/
*               /*                                                   */
*               /* SAVE THE DDNAME OF THE DYNAMICALLY ALLOCATED UNIT */
*               /* AND SET AN INDICATOR FOR UDEALLOC AT EOJ. @Y30LB31*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0540
*               ELSE                /*                       @Y30LB31*/
*                 DO;               /*                       @Y30LB31*/
         B     @RC00538                                            0540
@RF00538 DS    0H                                                  0541
*                   ALLOCFLG=ON;    /*                       @Y30LB31*/
         OI    ALLOCFLG,B'00100000'                                0541
*                   SUNITDDN=ALLDDN;/*                       @Y30LB31*/
         LA    @11,SRALLTBL                                        0542
         MVC   SUNITDDN(8),ALLDDN(@11)                             0542
*                 END;              /*                       @Y30LB31*/
*                                                                  0543
*               /*****************************************************/
*               /*                                                   */
*               /* CLOSE DO GROUP FOR DYNAMIC ALLOCATION.    @Y30LB31*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0544
*             END;                  /*                       @Y30LB31*/
*       END;                        /*                       @YD00175*/
*                                                                  0545
*   /*****************************************************************/
*   /*                                                               */
*   /* DYNAMIC ALLOCATION IS NOT REQUIRED. SAVE THE DDNAME OF THE    */
*   /* UNIT OBTAINED VIA THE FILE PARM.                      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*     ELSE                          /*                       @Y30LB31*/
*       SUNITDDN=FILEVAL;           /*                       @Y30LB31*/
         B     @RC00508                                            0546
@RF00508 L     @11,@PC00001+4                                      0546
         L     @11,FDTPTR+40(,@11)                                 0546
         MVC   SUNITDDN(8),FILEVAL(@11)                            0546
*                                                                  0547
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FILE KEYWORD WAS SPECIFIED, SETUP CKAGL TO VERIFY THAT THE */
*   /* DEVICE IS VIRTUAL.                                    @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0547
*   IF ALLOCRC=0&ADDR(FILE)>NULLPTR THEN/*                   @YD00175*/
@RC00508 DS    0H                                                  0547
@RC00500 SLR   @11,@11                                             0547
         CR    ALLOCRC,@11                                         0547
         BNE   @RF00547                                            0547
         L     @06,@PC00001+4                                      0547
         C     @11,FDTPTR+40(,@06)                                 0547
         BNL   @RF00547                                            0547
*     DO;                           /*                       @YD00175*/
*       RESPECIFY                                                  0549
*         CKAGL BASED(ADDR(SRCKAGL));/*                      @Y30LB31*/
*       CKAGL=''B;                  /*                       @Y30LB31*/
         LA    @06,SRCKAGL                                         0550
         XC    CKAGL(29,@06),CKAGL(@06)                            0550
*       CKTESTVT=ON;                /*                       @Y30LB31*/
         OI    CKTESTVT(@06),B'10000000'                           0551
*       CKDDNAME=SUNITDDN;          /*                       @Y30LB31*/
         MVC   CKDDNAME(8,@06),SUNITDDN                            0552
*       CKUCBPTR=ADDR(SUNITUCB);    /* RETURNED BY UMSSUNIT  @Y30LB31*/
*                                                                  0553
         LA    @15,SUNITUCB                                        0553
         ST    @15,CKUCBPTR(,@06)                                  0553
*       /*************************************************************/
*       /*                                                           */
*       /* TAKE A SYMBOLIC DUMP OF CKAGL BEFORE CHECKING OUT THE     */
*       /* UNIT.                                             @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0554
*       IF GDTDBG=NULLPTR THEN                                     0554
         L     @06,@PC00001                                        0554
         C     @11,GDTDBG(,@06)                                    0554
         BE    @RT00554                                            0554
*         ;                                                        0555
*       ELSE                                                       0556
*         DO;                                                      0556
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0557
*           DMPITMNM='SRCKAGL';                                    0558
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0558
         MVC   DMPITMNM(7,DMPINDEX),@CC01475                       0558
*           DMPITMPT=ADDR(SRCKAGL);                                0559
         LA    @11,SRCKAGL                                         0559
         ST    @11,DMPITMPT(,DMPINDEX)                             0559
*           DMPITMLN=LENGTH(CKAGL);                                0560
         MVC   DMPITMLN(2,DMPINDEX),@CH00810                       0560
*           DMPITMTP='H';                                          0561
         MVI   DMPITMTP(DMPINDEX),C'H'                             0561
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0562
*                                                                  0562
         AL    DMPINDEX,@CF00473                                   0562
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB31*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0563
*           DMPTRM=DMPTRMVL;                                       0563
         MVI   DMPTRM(DMPINDEX),X'FF'                              0563
*         END;                      /*                       @Y30LB31*/
*       IF GDTDBG=NULLPTR THEN                                     0565
@RT00554 L     @11,@PC00001                                        0565
         L     @11,GDTDBG(,@11)                                    0565
         LTR   @11,@11                                             0565
         BZ    @RT00565                                            0565
*         ;                                                        0566
*       ELSE                                                       0567
*         CALL IDCDB010(GDTTBL,'SRCK',ADDR(DUMPLIST));/*     @Y30LB31*/
*                                                                  0567
         L     @11,@PC00001                                        0567
         ST    @11,@AL00001                                        0567
         LA    @06,@CC01476                                        0567
         ST    @06,@AL00001+4                                      0567
         LA    @06,DUMPLIST                                        0567
         ST    @06,@AFTEMPS+4                                      0567
         LA    @06,@AFTEMPS+4                                      0567
         ST    @06,@AL00001+8                                      0567
         MVI   @AL00001+8,X'80'                                    0567
         L     @15,GDTDBG(,@11)                                    0567
         LA    @01,@AL00001                                        0567
         BALR  @14,@15                                             0567
*       /*************************************************************/
*       /*                                                           */
*       /* PERFORM THE UNIT CHECK OUT.                       @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0568
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB31*/
@RT00565 L     @11,@PC00001                                        0568
         ST    @11,@AL00001                                        0568
         LA    @06,CHECK                                           0568
         ST    @06,@AL00001+4                                      0568
         LA    @06,SRCKAGL                                         0568
         ST    @06,@AL00001+8                                      0568
         MVI   @AL00001+8,X'80'                                    0568
         L     @15,GDTUNT(,@11)                                    0568
         LA    @01,@AL00001                                        0568
         BALR  @14,@15                                             0568
*       RESPECIFY                                                  0569
*         RTNREG RSTD;                                             0569
*       TESTRC=RTNREG;                                             0570
         LR    TESTRC,RTNREG                                       0570
*       RESPECIFY                                                  0571
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0572
         BZ    @RF00572                                            0572
*         ALLOCRC=4;                /*                       @Y30LB31*/
         LA    ALLOCRC,4                                           0573
*     END;                          /*                       @Y30LB31*/
*                                                                  0574
@RF00572 DS    0H                                                  0575
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDR OF CALLER. EXIT FROM      */
*   /* ALLOCRTN PASSING THE COND CODE IN REG 15.             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0575
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RF00547 LR    REG14,RETADDR2                                      0575
*   RETURN CODE(ALLOCRC);           /*                       @Y30LB31*/
         LR    @15,ALLOCRC                                         0576
@EL00005 DS    0H                                                  0576
@EF00005 DS    0H                                                  0576
@ER00005 BR    @14                                                 0576
*   END ALLOCRTN;                   /*                       @Y30LB31*/
*                                                                  0578
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - SECCKRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DIRECTS THE VSAM AND SECURITY CHECK REQUIRED  @Y30LB31*/
*/*            BEFORE DEACTIVATING THE VOLUME AND            @Y30LB31*/
*/*            OPTIONALLY CHANGING THE VOL SERIAL NUMBER.    @YD00175*/
*/*            OBTAINS EXCLUSIVE USE OF THE VOLUME AND CALLS @YD00175*/
*/*            VPREPRTN TO MOUNT THE VOL IF THE VOL ALREADY  @Y30LB31*/
*/*            HAS A VOL SERIAL MISMATCH.  CALLS VTOCKRTN TO @Y30LB31*/
*/*            PERFORM THE VTOC SECURITY AND VSAM CHECKS     @Y30LB31*/
*/*            UNLESS THE SECURITY CHECK MUST BE BYPASSED    @Y30LB31*/
*/*            BECAUSE THE ORIGINAL VOL SERIAL NO. IS BEING  @Y30LB31*/
*/*            RESTORED DUE TO A PREVIOUS RENAME FAILURE.    @Y30LB31*/
*/*            OBTAINS EXCLUSIVE CONTROL OF THE VOLUME       @YD00175*/
*/*            AFTER THE SECURITY CHECK.                     @YD00175*/
*/*            NO MSGS ARE ISSUED BY THIS PROC.              @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STOREVTBL, BASEV VOLUME RECORD.          @ZM32529*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE SECURITY CHECK @Y30LB31*/
*/*          FOR A BASE VOL WAS SUCCESSFUL.                  @Y30LB31*/
*/*          A RETURN CODE OF 4 INDICATES THE VOL COULD NOT  @Y30LB31*/
*/*          BE MOUNTED FOR THE VTOC CHECK OR THAT THE VTOC  @Y30LB31*/
*/*          CHECK WAS UNSUCCESSFUL, OR THE VOLUME COULD     @YD00175*/
*/*          NOT BE OBTAINED FOR EXCLUSIVE CONTROL           @YD00175*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0578
*SECCKRTN:                                                         0578
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0578
SECCKRTN DS    0H                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*   DCL                                                            0579
*     SECCKRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0580
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      0580
*   OLDERID2=NEWERID2;                                             0581
         L     @11,@PC00001                                        0581
         L     @11,GDTTR2(,@11)                                    0581
         MVC   @TS00001(95),NEWERID2(@11)                          0581
         MVC   OLDERID2(95,@11),@TS00001                           0581
*   NEWID2='SRSE';                  /*                       @Y30LB31*/
*                                                                  0582
         MVC   NEWID2(4,@11),@CC01481                              0582
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS PROC.  */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0583
*   SECCKRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0583
         SLR   @11,@11                                             0583
         LR    SECCKRC,@11                                         0583
*   /*****************************************************************/
*   /*                                                               */
*   /* BYPASS THE ACTIVATE AND SECURITY CHECK IF A PREVIOUS RENAME   */
*   /* JOB FAILED AND NOW THE ORIGINAL VOLUME SERIAL NO. IS BEING    */
*   /* RESTORED.                                             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0584
*   IF ADDR(NSER)^=NULLPTR&BASVSMIS=ON&/*                    @Y30LB31*/
*       NSERVAL=BASRECOV THEN       /*                       @Y30LB31*/
         L     @04,@PC00001+4                                      0584
         L     @04,FDTPTR+4(,@04)                                  0584
         CR    @04,@11                                             0584
         BE    @RF00584                                            0584
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0584
         BNO   @RF00584                                            0584
         CLC   NSERVAL(6,@04),BASRECOV(BASEVPTR)                   0584
         BNE   @RF00584                                            0584
*     RECOVFLG=ON;                  /*                       @Y30LB31*/
*                                                                  0585
         OI    RECOVFLG,B'00010000'                                0585
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME HAS A LABEL MISMATCH, GET EXCLUSIVE CONTROL OF  */
*   /* THE UNIT.                                             @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*   IF BASVSMIS=ON THEN             /*                       @Y30LB31*/
@RF00584 TM    BASVSMIS(BASEVPTR),B'00100000'                      0586
         BNO   @RF00586                                            0586
*     DO;                           /*                       @Y30LB31*/
*       EXCLAGL=''B;                /*                       @YD00175*/
         LA    @11,SREXCLST                                        0588
         XC    EXCLAGL(23,@11),EXCLAGL(@11)                        0588
*       EXCLDDP=ADDR(SUNITDDN);     /*                       @YD00175*/
         LA    @04,SUNITDDN                                        0589
         ST    @04,EXCLDDP(,@11)                                   0589
*       EXCLUCBP=ADDR(SUNITUCB);    /*                       @YD00175*/
*                                                                  0590
         LA    @04,SUNITUCB                                        0590
         ST    @04,EXCLUCBP(,@11)                                  0590
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0591
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/
         L     @04,@PC00001                                        0591
         ST    @04,@AL00001                                        0591
         LA    @02,CHANGEX                                         0591
         ST    @02,@AL00001+4                                      0591
         ST    @11,@AL00001+8                                      0591
         MVI   @AL00001+8,X'80'                                    0591
         L     @15,GDTUNT(,@04)                                    0591
         LA    @01,@AL00001                                        0591
         BALR  @14,@15                                             0591
*       RESPECIFY                                                  0592
*         RTNREG RSTD;                                             0592
*       TESTRC=RTNREG;                                             0593
         LR    TESTRC,RTNREG                                       0593
*       RESPECIFY                                                  0594
*         RTNREG UNRSTD;            /*                       @YD00175*/
*                                                                  0594
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE DO NOT GET EXCLUSIVE CONTROL, EXIT FROM THE         */
*       /* PROCEDURE.                                        @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0595
*       IF TESTRC>0 THEN            /*                       @YD00175*/
         LTR   TESTRC,TESTRC                                       0595
         BNP   @RF00595                                            0595
*         SECCKRC=LASTCC04;         /*                       @YD00175*/
         LA    SECCKRC,4                                           0596
*       ELSE                        /*                       @YD00175*/
*         DO;                       /*                       @YD00175*/
*                                                                  0597
         B     @RC00595                                            0597
@RF00595 DS    0H                                                  0598
*           /*********************************************************/
*           /*                                                       */
*           /* CALL AN AMS SYSTEM ADAPTER ROUTINE TO MOUNT THE VOLUME*/
*           /* IF A VOLUME SERIAL MISMATCH EXISTS BETWEEN THE CART   */
*           /* AND VOL LABELS. OTHERWISE, AN OPEN VTOC EXECUTED BY   */
*           /* EITHER VOLUME SERVICES ROUTINE WILL CAUSE THE VOL TO  */
*           /* BE MOUNTED.                                   @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0598
*           MOUNTFLG=ON;            /* VOL MOUNT REQUESTED   @Y30LB31*/
         OI    MOUNTFLG,B'01000000'                                0598
*           VPREPVOL=MSVIVOL#;      /*                       @Y30LB31*/
         MVC   VPREPVOL(6),MSVIVOL#                                0599
*           CALL VPREPRTN;          /*                       @Y30LB31*/
         BAL   @14,VPREPRTN                                        0600
*           RESPECIFY                                              0601
*             RTNREG RSTD;                                         0601
*           TESTRC=RTNREG;                                         0602
         LR    TESTRC,RTNREG                                       0602
*           RESPECIFY                                              0603
*             RTNREG UNRSTD;        /*                       @Y30LB31*/
*                                                                  0603
*           /*********************************************************/
*           /*                                                       */
*           /* EXIT FROM THIS PROC IF THE SPECIAL MOUNT FAILED FOR   */
*           /* THE VOL WITH A SERIAL MISMATCH.               @Y30LB31*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0604
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0604
         BZ    @RF00604                                            0604
*             SECCKRC=4;            /*                       @Y30LB31*/
         LA    SECCKRC,4                                           0605
*         END;                      /*                       @Y30LB31*/
@RF00604 DS    0H                                                  0607
*     END;                          /*                       @YD00175*/
@RC00595 DS    0H                                                  0608
*                                                                  0608
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE IS NO PROBLEM MOUNTING THE VOLUME FOR THE SECURITY   */
*   /* AND VSAM CHECK OUT, CALL VTOCKRTN TO PERFORM THIS VTOC        */
*   /* FUNCTION UNLESS THE SECURITY CHECK IS TO BE BYPASSED. @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0608
*   IF SECCKRC=0&RECOVFLG=OFF THEN  /*                       @Y30LB31*/
@RF00586 LTR   SECCKRC,SECCKRC                                     0608
         BNZ   @RF00608                                            0608
         TM    RECOVFLG,B'00010000'                                0608
         BNZ   @RF00608                                            0608
*     DO;                           /*                       @Y30LB31*/
*       CALL VTOCKRTN;              /*                       @Y30LB31*/
         BAL   @14,VTOCKRTN                                        0610
*       RESPECIFY                                                  0611
*         RTNREG RSTD;                                             0611
*       TESTRC=RTNREG;                                             0612
         LR    TESTRC,RTNREG                                       0612
*       RESPECIFY                                                  0613
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0613
*       /*************************************************************/
*       /*                                                           */
*       /* SET AN UNSUCCESSFUL CONDITION CODE IF THE VSAM AND        */
*       /* SECURITY CHECK COULD NOT BE PERFORMED.            @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0614
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0614
         BZ    @RF00614                                            0614
*         SECCKRC=4;                /*                       @Y30LB31*/
*                                                                  0615
         LA    SECCKRC,4                                           0615
*       /*************************************************************/
*       /*                                                           */
*       /* IF SECURITY CHECK SUCCESSFUL, GET EXCLUSIVE CONTROL OF THE*/
*       /* VOLUME IF NOT ALREADY OBTAINED. EXCLUSIVE CONTROL HAS     */
*       /* ALREADY BEEN OBTAINED IF THERE IS A VOLUME SERIAL         */
*       /* MISMATCH.                                         @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0616
*       ELSE                                                       0616
*         IF BASVSMIS=OFF THEN      /*                       @YD00175*/
         B     @RC00614                                            0616
@RF00614 TM    BASVSMIS(BASEVPTR),B'00100000'                      0616
         BNZ   @RF00616                                            0616
*           DO;                     /*                       @YD00175*/
*             EXCLAGL=''B;          /*                       @YD00175*/
         LA    @11,SREXCLST                                        0618
         XC    EXCLAGL(23,@11),EXCLAGL(@11)                        0618
*             EXCLDDP=ADDR(SUNITDDN);/*                      @YD00175*/
         LA    @04,SUNITDDN                                        0619
         ST    @04,EXCLDDP(,@11)                                   0619
*             EXCLUCBP=ADDR(SUNITUCB);/*                     @YD00175*/
*                                                                  0620
         LA    @04,SUNITUCB                                        0620
         ST    @04,EXCLUCBP(,@11)                                  0620
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL     @YD00175*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0621
*             CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*       @YD00175*/
         L     @04,@PC00001                                        0621
         ST    @04,@AL00001                                        0621
         LA    @02,CHANGEX                                         0621
         ST    @02,@AL00001+4                                      0621
         ST    @11,@AL00001+8                                      0621
         MVI   @AL00001+8,X'80'                                    0621
         L     @15,GDTUNT(,@04)                                    0621
         LA    @01,@AL00001                                        0621
         BALR  @14,@15                                             0621
*             RESPECIFY                                            0622
*               RTNREG RSTD;                                       0622
*             TESTRC=RTNREG;                                       0623
         LR    TESTRC,RTNREG                                       0623
*             RESPECIFY                                            0624
*               RTNREG UNRSTD;      /*                       @YD00175*/
*                                                                  0624
*             /*******************************************************/
*             /*                                                     */
*             /* IF RETURN CODE NOT ZERO, SET INTERNAL CODE TO 4     */
*             /*                                             @YD00175*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0625
*             IF TESTRC>0 THEN      /*                       @YD00175*/
         LTR   TESTRC,TESTRC                                       0625
         BNP   @RF00625                                            0625
*               SECCKRC=LASTCC04;   /*                       @YD00175*/
         LA    SECCKRC,4                                           0626
*           END;                    /*                       @YD00175*/
@RF00625 DS    0H                                                  0628
*     END;                          /*                       @Y30LB31*/
*                                                                  0628
@RF00616 DS    0H                                                  0628
@RC00614 DS    0H                                                  0629
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER AND EXIT   */
*   /* FROM SECCKRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0629
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RF00608 LR    REG14,RETADDR2                                      0629
*   RETURN CODE(SECCKRC);           /*                       @Y30LB31*/
         LR    @15,SECCKRC                                         0630
@EL00006 DS    0H                                                  0630
@EF00006 DS    0H                                                  0630
@ER00006 BR    @14                                                 0630
*   END SECCKRTN;                   /*                       @Y30LB31*/
*                                                                  0632
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - VPREPRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - MOUNTS AND DEMOUNTS THE VOLUME AND FOLLOWING  @Y30LB31*/
*/*            A DEMOUNT RELEASES THE RESERVE SET BY THE VOL @Y30LB31*/
*/*            SERVICES ROUTINES.  NO MESSAGES ARE ISSUED BY @Y30LB31*/
*/*            THIS PROC.                                    @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL, MDAGL.                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL SUCCESSFULLY   @Y30LB31*/
*/*          MOUNTED OR DEMOUNTED.  A RETURN CODE OF 4       @Y30LB31*/
*/*          INDICATES A MOUNT OR DEMOUNT FAILURE.           @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0632
*VPREPRTN:                                                         0632
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0632
VPREPRTN DS    0H                                                  0633
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0633
*   DCL                                                            0633
*     VPREPRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0633
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP AN AREA USED WITH THE UMSSUNIT MACRO. IT DESCRIBES      */
*   /* WHETHER THE REQUEST IF A MOUNT OR DEMOUNT.            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0634
*   DCL                                                            0634
*     SRMDTYPE CHAR(8);             /*                       @Y30LB31*/
*   DCL                                                            0635
*     NODDNAME BIT(64) CONSTANT('0000000000000000'X);/*      @Y30LB31*/
*                                                                  0635
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0636
*   RETADDR3=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR3,REG14                                      0636
*   OLDERID2=NEWERID2;                                             0637
         L     @15,@PC00001                                        0637
         L     @15,GDTTR2(,@15)                                    0637
         MVC   @TS00001(95),NEWERID2(@15)                          0637
         MVC   OLDERID2(95,@15),@TS00001                           0637
*   NEWID2='SRVP';                  /*                       @Y30LB31*/
*                                                                  0638
         MVC   NEWID2(4,@15),@CC01493                              0638
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0639
*   VPREPRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0639
         SLR   VPREPRC,VPREPRC                                     0639
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MOUNT-DEMOUNT ARGUMENT LIST HAS NOT BEEN INITIALIZED,  */
*   /* DO SO. THEN REUSE THE LIST FOR EACH SUBSEQUENT REQUEST IN     */
*   /* ORDER NOT TO DESTROY THE ENQUEUE FLAG SET BY THE MOUNT ROUTINE*/
*   /* AND USED BY THE DEMOUNT ROUTINE THAT IS INVOKED.      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0640
*   IF MDDDNAME=NODDNAME THEN       /*                       @Y30LB31*/
         LA    @15,SRMDAGL                                         0640
         CLC   MDDDNAME(8,@15),@CB01491                            0640
         BNE   @RF00640                                            0640
*     DO;                           /*                       @Y30LB31*/
*       MDDDNAME=SUNITDDN;          /*                       @Y30LB31*/
         MVC   MDDDNAME(8,@15),SUNITDDN                            0642
*       MDUCBPTR=ADDR(SUNITUCB);    /*                       @Y30LB31*/
         LA    @14,SUNITUCB                                        0643
         ST    @14,MDUCBPTR(,@15)                                  0643
*     END;                          /*                       @Y30LB31*/
*   MDLABEL=VPREPVOL;               /*                       @Y30LB31*/
@RF00640 LA    @15,SRMDAGL                                         0645
         MVC   MDLABEL(6,@15),VPREPVOL                             0645
*   IF MOUNTFLG=OFF THEN            /*                       @Y30LB31*/
         TM    MOUNTFLG,B'01000000'                                0646
         BNZ   @RF00646                                            0646
*     DO;                           /*                       @Y30LB31*/
*       MDWAIT=ON;                  /*                       @Y30LB31*/
         OI    MDWAIT(@15),B'00010000'                             0648
*       SRMDTYPE=DEMOUNT;           /*                       @Y30LB31*/
         MVC   SRMDTYPE(8),DEMOUNT                                 0649
*     END;                          /*                       @Y30LB31*/
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC00646                                            0651
@RF00646 DS    0H                                                  0652
*       MDWAIT=OFF;                 /*                       @Y30LB31*/
         LA    @15,SRMDAGL                                         0652
         NI    MDWAIT(@15),B'11101111'                             0652
*       SRMDTYPE=MOUNT;             /*                       @Y30LB31*/
         MVC   SRMDTYPE(8),MOUNT                                   0653
*     END;                          /*                       @Y30LB31*/
*                                                                  0654
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE MOUNT-DEMOUNT PARM LIST BEFORE    */
*   /* INVOKING THE MOUNT-DEMOUNT ROUTINE.                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0655
*   IF GDTDBG=NULLPTR THEN                                         0655
@RC00646 L     @15,@PC00001                                        0655
         L     @15,GDTDBG(,@15)                                    0655
         LTR   @15,@15                                             0655
         BZ    @RT00655                                            0655
*     ;                                                            0656
*   ELSE                                                           0657
*     DO;                                                          0657
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0658
*       DMPITMNM='SRMDAGL';                                        0659
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0659
         MVC   DMPITMNM(7,DMPINDEX),@CC01494                       0659
*       DMPITMPT=ADDR(SRMDAGL);                                    0660
         LA    @03,SRMDAGL                                         0660
         ST    @03,DMPITMPT(,DMPINDEX)                             0660
*       DMPITMLN=LENGTH(SRMDAGL);                                  0661
         MVC   DMPITMLN(2,DMPINDEX),@CH00044                       0661
*       DMPITMTP='H';                                              0662
         MVI   DMPITMTP(DMPINDEX),C'H'                             0662
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0663
*                                                                  0663
         LA    @03,16                                              0663
         ALR   DMPINDEX,@03                                        0663
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0664
*       DMPITMNM='STORETBL';                                       0664
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0664
*       DMPITMPT=ADDR(STORETBL);                                   0665
         LA    @15,STORETBL                                        0665
         ST    @15,DMPITMPT(,DMPINDEX)                             0665
*       DMPITMLN=LENGTH(STORETBL);                                 0666
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0666
*       DMPITMTP='H';                                              0667
         MVI   DMPITMTP(DMPINDEX),C'H'                             0667
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0668
*                                                                  0668
         ALR   DMPINDEX,@03                                        0668
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0669
*       DMPTRM=DMPTRMVL;                                           0669
         MVI   DMPTRM(DMPINDEX),X'FF'                              0669
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         0671
@RT00655 L     @15,@PC00001                                        0671
         L     @15,GDTDBG(,@15)                                    0671
         LTR   @15,@15                                             0671
         BZ    @RT00671                                            0671
*     ;                                                            0672
*   ELSE                                                           0673
*     CALL IDCDB010(GDTTBL,'SRMD',ADDR(DUMPLIST));/*         @Y30LB31*/
         L     @15,@PC00001                                        0673
         ST    @15,@AL00001                                        0673
         LA    @14,@CC01495                                        0673
         ST    @14,@AL00001+4                                      0673
         LA    @14,DUMPLIST                                        0673
         ST    @14,@AFTEMPS+8                                      0673
         LA    @14,@AFTEMPS+8                                      0673
         ST    @14,@AL00001+8                                      0673
         MVI   @AL00001+8,X'80'                                    0673
         L     @15,GDTDBG(,@15)                                    0673
         LA    @01,@AL00001                                        0673
         BALR  @14,@15                                             0673
*                                                                  0674
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A VOLUME DEMOUNT WAS REQUESTED, RELEASE THE RESERVE SET BY */
*   /* EITHER IDCVS01 WHEN CHECKING THE VTOC OR BY IDCVS02 WHEN      */
*   /* UPDATING THE VOL LABEL.                               @ZA05125*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0674
*   IF MOUNTFLG=OFF THEN            /*                       @ZA05125*/
@RT00671 TM    MOUNTFLG,B'01000000'                                0674
         BNZ   @RF00674                                            0674
*     DO;                           /*                       @ZA05125*/
*       RNMSERNO=VPREPVOL;          /*                       @ZA05125*/
         MVC   RNMSERNO(6),VPREPVOL                                0676
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/
         MVC   RNMTRAIL(16),@CC01496                               0677
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @ZA05125*/
         L     @15,@PC00001                                        0678
         ST    @15,@AL00001                                        0678
         LA    @14,@CC01366                                        0678
         ST    @14,@AL00001+4                                      0678
         LA    @14,MINORNM                                         0678
         ST    @14,@AL00001+8                                      0678
         MVI   @AL00001+8,X'80'                                    0678
         L     @15,GDTDEQ(,@15)                                    0678
         LA    @01,@AL00001                                        0678
         BALR  @14,@15                                             0678
*     END;                          /*                       @ZA05125*/
*                                                                  0679
*   /*****************************************************************/
*   /*                                                               */
*   /* MOUNT OR DEMOUNT THE VOLUME AS REQUESTED.             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0680
*   CALL IDCSA060(GDTTBL,SRMDTYPE,MDAGL);/*                  @Y30LB31*/
@RF00674 L     @02,@PC00001                                        0680
         ST    @02,@AL00001                                        0680
         LA    @15,SRMDTYPE                                        0680
         ST    @15,@AL00001+4                                      0680
         LA    @15,SRMDAGL                                         0680
         ST    @15,@AL00001+8                                      0680
         MVI   @AL00001+8,X'80'                                    0680
         L     @15,GDTUNT(,@02)                                    0680
         LA    @01,@AL00001                                        0680
         BALR  @14,@15                                             0680
*   RESPECIFY                                                      0681
*     RTNREG RSTD;                                                 0681
*   TESTRC=RTNREG;                                                 0682
         LR    TESTRC,RTNREG                                       0682
*   RESPECIFY                                                      0683
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0684
         BZ    @RF00684                                            0684
*     VPREPRC=4;                    /*                       @Y30LB31*/
*                                                                  0685
         LA    VPREPRC,4                                           0685
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */
*   /* FROM VPREPRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0686
*   REG14=RETADDR3;                 /*                       @Y30LB31*/
@RF00684 LR    REG14,RETADDR3                                      0686
*   RETURN CODE(VPREPRC);           /*                       @Y30LB31*/
         LR    @15,VPREPRC                                         0687
@EL00007 DS    0H                                                  0687
@EF00007 DS    0H                                                  0687
@ER00007 BR    @14                                                 0687
*   END VPREPRTN;                   /*                       @Y30LB31*/
*                                                                  0689
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - VTOCKRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - CHECKS FOR NON-VSAM WRITE-LEVEL PROTECTED     @Y30LB31*/
*/*            DATA SETS AND UNEXPIRED DATA SETS.            @Y30LB31*/
*/*            VERIFIES THAT THE VOL IS NOT OWNED BY VSAM    @Y30LB31*/
*/*            IF THE VOL IS BEING RELABELED.  IF THE VOL IS @Y30LB31*/
*/*            ONLY BEING DEACTIVATED, CHECKS FOR VSAM       @Y30LB31*/
*/*            WRITE-LEVEL PROTECTED DATA SETS.              @ZM32529*/
*/*            MESSAGES IDC3744I AND IDC3745I ARE ISSUED BY  @ZM32529*/
*/*            THIS ROUTINE.                                 @ZM32529*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL                                 @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL       @Y30LB31*/
*/*          SECURITY CHECK.  A RETURN CODE OF 4 INDICATES   @Y30LB31*/
*/*          AN UNSUCCESSFUL SECURITY CHECK OR THE VOL IS    @Y30LB31*/
*/*          VSAM AND MUST NOT BE RELABELED OR THAT EITHER   @ZM32529*/
*/*          NO DD CARD WAS SPECIFIED FOR A VSAM CATALOG ON  @ZM32529*/
*/*          THE STORED VOLUME OR A JOBCAT OR STEPCAT DD WAS @ZM32529*/
*/*          SPECIFIED FOR THE CATALOG BEING OPENED.         @ZM32529*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0689
*VTOCKRTN:                                                         0689
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0689
VTOCKRTN DS    0H                                                  0690
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0690
*   DCL                                                            0690
*     VTOCKRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0690
*   /*****************************************************************/
*   /*                                                               */
*   /* CATALOG DD NAME HOLD AREA                             @ZM01185*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0691
*   DCL                                                            0691
*     CATDDHLD CHAR(8);             /*                       @ZM01185*/
*                                                                  0691
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP STORAGE AREA TO BUILD THE VOLUME SERVICES ARGUMENT LIST */
*   /* USED TO CHECK THE VTOC.                               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0692
*   DCL                                                            0692
*     SRVS1LST CHAR(LENGTH(VS1AGL)) BDY(WORD);/*             @Y30LB31*/
*   DCL                                                            0693
*     IDCVS01 CHAR(8) CONSTANT('IDCVS01 ');/*                @Y30LB31*/
*                                                                  0693
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*   RETADDR3=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR3,REG14                                      0694
*   OLDERID2=NEWERID2;                                             0695
         L     @15,@PC00001                                        0695
         L     @15,GDTTR2(,@15)                                    0695
         MVC   @TS00001(95),NEWERID2(@15)                          0695
         MVC   OLDERID2(95,@15),@TS00001                           0695
*   NEWID2='SRVT';                  /*                       @Y30LB31*/
*                                                                  0696
         MVC   NEWID2(4,@15),@CC01506                              0696
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0697
*   VTOCKRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0697
         SLR   @15,@15                                             0697
         LR    VTOCKRC,@15                                         0697
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP THE ARG LIST TO BE PASSED TO THE VOLUME SERVICES ROUTINE*/
*   /* FOR THE VTOC CHECK.                                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   RESPECIFY                                                      0698
*     VS1AGL BASED(ADDR(SRVS1LST)); /*                       @Y30LB31*/
*   VS1AGL=''B;                     /*                       @Y30LB31*/
         LA    @14,SRVS1LST                                        0699
         XC    VS1AGL(74,@14),VS1AGL(@14)                          0699
*   VSRES=ON;                       /*                       @Y30LB31*/
         OI    VSRES(@14),B'10000000'                              0700
*   VSUCBP=ADDR(SUNITUCB);          /*                       @Y30LB31*/
         LA    @03,SUNITUCB                                        0701
         ST    @03,VSUCBP(,@14)                                    0701
*   VSVOLP=ADDR(MSVIVOL#);          /*                       @Y30LB31*/
         LA    @03,MSVIVOL#                                        0702
         ST    @03,VSVOLP(,@14)                                    0702
*   VSFILEP=ADDR(SUNITDDN);         /*                       @Y30LB31*/
         LA    @03,SUNITDDN                                        0703
         ST    @03,VSFILEP(,@14)                                   0703
*   VSWRITE=ON;                     /*                       @Y30LB31*/
         OI    VSWRITE(@14),B'00001000'                            0704
*   IF ADDR(PFILE)^=NULLPTR THEN    /*                       @Y30LB31*/
         L     @03,@PC00001+4                                      0705
         L     @03,FDTPTR+44(,@03)                                 0705
         CR    @03,@15                                             0705
         BE    @RF00705                                            0705
*     VSPFILEP=ADDR(PFILE);         /*                       @Y30LB31*/
*                                                                  0706
         ST    @03,VSPFILEP(,@14)                                  0706
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOL IS TO BE RELABELED AS WELL AS DEACTIVATED, IT      */
*   /* CANNOT BE OWNED BY VSAM. VERIFY THAT THE VOL IS NOT VSAM.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0707
*   IF ADDR(NSER)^=NULLPTR THEN     /*                       @Y30LB31*/
@RF00705 L     @15,@PC00001+4                                      0707
         L     @15,FDTPTR+4(,@15)                                  0707
         LTR   @15,@15                                             0707
         BZ    @RF00707                                            0707
*     VSNOVSAM=ON;                  /*                       @Y30LB31*/
*                                                                  0708
         LA    @15,SRVS1LST                                        0708
         OI    VSNOVSAM(@15),B'10000000'                           0708
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOL IS TO BE DEACTIVATED ONLY, CHECK FOR VSAM          */
*   /* WRITE-LEVEL PASSWORD PROTECTED DATA SETS.             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC00707                                            0709
@RF00707 DS    0H                                                  0710
*       VSUCTEST=ON;                /*                       @ZM32529*/
*       VSMASTER=ON;                /*                       @Y30LB31*/
         LA    @15,SRVS1LST                                        0711
         OI    VSUCTEST(@15),B'01000100'                           0711
*       IF ADDR(CAT)^=NULLPTR THEN  /*                       @Y30LB31*/
         L     @14,@PC00001+4                                      0712
         L     @03,FDTPTR+28(,@14)                                 0712
         LTR   @03,@03                                             0712
         BZ    @RF00712                                            0712
*         DO;                       /*                       @Y30LB31*/
*           VSCATP=ADDR(CATNMVAL);  /*                       @Y30LB31*/
         L     @14,FDTPTR+32(,@14)                                 0714
         LA    @03,CATNMVAL(,@14)                                  0714
         ST    @03,VSCATP(,@15)                                    0714
*           IF CATNMPLN^=0 THEN     /*                       @Y30LB31*/
         CLI   CATNMPLN(@14),0                                     0715
         BE    @RF00715                                            0715
*             VSPSWDP=ADDR(CATNMPAS);/*                      @Y30LB31*/
         LA    @14,CATNMPAS(,@14)                                  0716
         ST    @14,VSPSWDP(,@15)                                   0716
*         END;                      /*                       @Y30LB31*/
@RF00715 DS    0H                                                  0718
*       IF ADDR(CATDN)^=NULLPTR THEN/*                       @Y30LB31*/
@RF00712 L     @15,@PC00001+4                                      0718
         L     @15,FDTPTR+36(,@15)                                 0718
         LTR   @15,@15                                             0718
         BZ    @RF00718                                            0718
*         CATDDHLD=CATDNVAL;        /*                       @ZM01185*/
         MVC   CATDDHLD(8),CATDNVAL(@15)                           0719
*       ELSE                                                       0720
*         CATDDHLD=' ';             /*                       @ZM01185*/
         B     @RC00718                                            0720
@RF00718 MVI   CATDDHLD+1,C' '                                     0720
         MVC   CATDDHLD+2(6),CATDDHLD+1                            0720
         MVI   CATDDHLD,C' '                                       0720
*       VSCATDDP=ADDR(CATDDHLD);    /*                       @ZM01185*/
@RC00718 LA    @15,SRVS1LST                                        0721
         LA    @14,CATDDHLD                                        0721
         ST    @14,VSCATDDP(,@15)                                  0721
*       VSOPCAT=ON;                 /*                       @ZM01185*/
         OI    VSOPCAT(@15),B'00000010'                            0722
*     END;                          /*                       @Y30LB31*/
*                                                                  0723
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE VOL SERVICES PARM LIST BEFORE     */
*   /* CHECKING THE VTOC.                                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*   IF GDTDBG=NULLPTR THEN                                         0724
@RC00707 L     @15,@PC00001                                        0724
         L     @15,GDTDBG(,@15)                                    0724
         LTR   @15,@15                                             0724
         BZ    @RT00724                                            0724
*     ;                                                            0725
*   ELSE                                                           0726
*     DO;                                                          0726
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0727
*       DMPITMNM='SRVS1LST';                                       0728
         MVC   DMPITMNM(8,DMPINDEX),@CC01509                       0728
*       DMPITMPT=ADDR(SRVS1LST);                                   0729
         LA    @03,SRVS1LST                                        0729
         ST    @03,DMPITMPT(,DMPINDEX)                             0729
*       DMPITMLN=LENGTH(SRVS1LST);                                 0730
         MVC   DMPITMLN(2,DMPINDEX),@CH01702                       0730
*       DMPITMTP='H';                                              0731
         MVI   DMPITMTP(DMPINDEX),C'H'                             0731
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0732
*                                                                  0732
         LA    @03,16                                              0732
         ALR   DMPINDEX,@03                                        0732
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0733
*       DMPITMNM='STORETBL';                                       0733
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0733
*       DMPITMPT=ADDR(STORETBL);                                   0734
         LA    @15,STORETBL                                        0734
         ST    @15,DMPITMPT(,DMPINDEX)                             0734
*       DMPITMLN=LENGTH(STORETBL);                                 0735
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0735
*       DMPITMTP='H';                                              0736
         MVI   DMPITMTP(DMPINDEX),C'H'                             0736
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0737
*                                                                  0737
         ALR   DMPINDEX,@03                                        0737
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0738
*       DMPTRM=DMPTRMVL;                                           0738
         MVI   DMPTRM(DMPINDEX),X'FF'                              0738
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         0740
@RT00724 L     @15,@PC00001                                        0740
         L     @15,GDTDBG(,@15)                                    0740
         LTR   @15,@15                                             0740
         BZ    @RT00740                                            0740
*     ;                                                            0741
*   ELSE                                                           0742
*     CALL IDCDB010(GDTTBL,'SRS1',ADDR(DUMPLIST));/*         @Y30LB31*/
         L     @15,@PC00001                                        0742
         ST    @15,@AL00001                                        0742
         LA    @14,@CC01510                                        0742
         ST    @14,@AL00001+4                                      0742
         LA    @14,DUMPLIST                                        0742
         ST    @14,@AFTEMPS+12                                     0742
         LA    @14,@AFTEMPS+12                                     0742
         ST    @14,@AL00001+8                                      0742
         MVI   @AL00001+8,X'80'                                    0742
         L     @15,GDTDBG(,@15)                                    0742
         LA    @01,@AL00001                                        0742
         BALR  @14,@15                                             0742
*                                                                  0743
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL THE VOLUME SERVICE ROUTINE WHICH PERFORMS THE VTOC CHECK.*/
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0743
*   CALL IDCSACL0(GDTTBL,IDCVS01,SECCHECK,VS1AGL);/*         @Y30LB31*/
@RT00740 L     @02,@PC00001                                        0743
         ST    @02,@AL00001                                        0743
         LA    @15,@CC01505                                        0743
         ST    @15,@AL00001+4                                      0743
         LA    @15,SECCHECK                                        0743
         ST    @15,@AL00001+8                                      0743
         LA    @15,SRVS1LST                                        0743
         ST    @15,@AL00001+12                                     0743
         MVI   @AL00001+12,X'80'                                   0743
         L     @15,GDTCAL(,@02)                                    0743
         LA    @01,@AL00001                                        0743
         BALR  @14,@15                                             0743
*   RESPECIFY                                                      0744
*     RTNREG RSTD;                                                 0744
*   TESTRC=RTNREG;                                                 0745
         LR    TESTRC,RTNREG                                       0745
*   RESPECIFY                                                      0746
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  0746
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS THE RETURN CODE FROM THE VOL SERVICE ROUTINE. @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0747
*   IF TESTRC=4 THEN                /*                       @Y30LB31*/
         LA    @02,4                                               0747
         CR    TESTRC,@02                                          0747
         BNE   @RF00747                                            0747
*     VTOCKRC=4;                    /* SECURITY CHECK FAILED OR VSAM
*                                      STATUS NOT RETRIEVED. @Y30LB31*/
         LR    VTOCKRC,@02                                         0748
*   ELSE                            /*                       @Y30LB31*/
*     IF TESTRC=LASTCC08 THEN       /*                       @Y30LB31*/
         B     @RC00747                                            0749
@RF00747 C     TESTRC,@CF00179                                     0749
         BNE   @RF00749                                            0749
*       CC04FLG=ON;                 /* A PASSWORD PROTECTED DATA SET
*                                      NOT CLOSED.           @Y30LB31*/
*                                                                  0750
         OI    CC04FLG,B'10000000'                                 0750
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE THE VTOC IF NOT CLOSED BY THE VOL SERVICES ROUTINE.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0751
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB31*/
@RF00749 DS    0H                                                  0751
@RC00747 LA    @15,SRVS1LST                                        0751
         L     @14,VSIOP(,@15)                                     0751
         LTR   @14,@14                                             0751
         BZ    @RF00751                                            0751
*     DO;                           /*                       @Y30LB31*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB31*/
         L     @02,@PC00001                                        0753
         ST    @02,@AL00001                                        0753
         LA    @15,VSIOP(,@15)                                     0753
         ST    @15,@AL00001+4                                      0753
         MVI   @AL00001+4,X'80'                                    0753
         L     @15,GDTCLS(,@02)                                    0753
         LA    @01,@AL00001                                        0753
         BALR  @14,@15                                             0753
*       RESPECIFY                                                  0754
*         RTNREG RSTD;                                             0754
*       TESTRC=RTNREG;                                             0755
         LR    TESTRC,RTNREG                                       0755
*       RESPECIFY                                                  0756
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0756
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE EOJ COND CODE FLAG IF THE CLOSE FAILED.   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0757
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0757
         BZ    @RF00757                                            0757
*         CC04FLG=ON;               /*                       @Y30LB31*/
         OI    CC04FLG,B'10000000'                                 0758
*     END;                          /*                       @Y30LB31*/
*                                                                  0759
@RF00757 DS    0H                                                  0760
*   /*****************************************************************/
*   /*                                                               */
*   /* RELEASE THE RESERVE SET BY THE VOL SERVICES ROUTINE IF THE    */
*   /* DEACTIVATE PROCESSING MUST TERMINATE.                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0760
*   IF VTOCKRC^=0 THEN              /*                       @Y30LB31*/
@RF00751 LTR   VTOCKRC,VTOCKRC                                     0760
         BZ    @RF00760                                            0760
*     DO;                           /*                       @Y30LB31*/
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/
         MVC   RNMSERNO(6),MSVIVOL#                                0762
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/
         MVC   RNMTRAIL(16),@CC01496                               0763
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/
         L     @15,@PC00001                                        0764
         ST    @15,@AL00001                                        0764
         LA    @14,@CC01366                                        0764
         ST    @14,@AL00001+4                                      0764
         LA    @14,MINORNM                                         0764
         ST    @14,@AL00001+8                                      0764
         MVI   @AL00001+8,X'80'                                    0764
         L     @15,GDTDEQ(,@15)                                    0764
         LA    @01,@AL00001                                        0764
         BALR  @14,@15                                             0764
*     END;                          /*                       @Y30LB31*/
*                                                                  0765
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS A USER CATALOG SPECIFIED? IF IT WAS AND AND IF THE DDNAME */
*   /* WAS NOT SPECIFIED OR WAS SPECIFIED AS JOBCAT OR STEPCAT THEN  */
*   /* IT IS AN ERROR. TERMINATION FOLLOWS.                  @ZM32529*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0766
*   IF VSUCAT=ON THEN               /*                       @ZM32529*/
@RF00760 LA    @15,SRVS1LST                                        0766
         TM    VSUCAT(@15),B'01000000'                             0766
         BNO   @RF00766                                            0766
*     DO;                           /*                       @ZM32529*/
*       IF VSCATDDP=NULLPTRCATDDHLD=' ' THEN/*              @ZA09518*/
         L     @15,VSCATDDP(,@15)                                  0768
         LTR   @15,@15                                             0768
         BZ    @RT00768                                            0768
         CLI   CATDDHLD,C' '                                       0768
         BNE   @RF00768                                            0768
@RT00768 DS    0H                                                  0769
*         DO;                       /*                       @ZM32529*/
*           VTOCKRC=4;              /*                       @ZM32529*/
         LA    VTOCKRC,4                                           0770
*           PRINTTBL=''B;           /*                       @ZM32529*/
         XC    PRINTTBL(20),PRINTTBL                               0771
*           DARGSMOD=STORMSGS;      /*                       @ZM32529*/
         L     @15,DDSTRU                                          0772
         MVC   DARGSMOD(3,@15),@CC01378                            0772
*           DARGSENT=MSG3745I;      /*                       @ZM32529*/
         MVI   DARGSENT(@15),X'07'                                 0773
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @ZM32529*/
         L     @15,@PC00001                                        0774
         ST    @15,@AL00001                                        0774
         LA    @14,@CF00115                                        0774
         ST    @14,@AL00001+4                                      0774
         LA    @14,DDSTRU                                          0774
         ST    @14,@AL00001+8                                      0774
         MVI   @AL00001+8,X'80'                                    0774
         L     @15,GDTPRT(,@15)                                    0774
         LA    @01,@AL00001                                        0774
         BALR  @14,@15                                             0774
*         END;                      /*                       @ZM32529*/
*       ELSE                        /*                       @ZM32529*/
*         IF CATDDHLD='JOBCAT  'CATDDHLD='STEPCAT ' THEN          0776
         B     @RC00768                                            0776
@RF00768 CLC   CATDDHLD(8),@CC01511                                0776
         BE    @RT00776                                            0776
         CLC   CATDDHLD(8),@CC01512                                0776
         BNE   @RF00776                                            0776
@RT00776 DS    0H                                                  0777
*           DO;                     /*                       @ZM32529*/
*             VTOCKRC=4;            /*                       @ZM32529*/
         LA    VTOCKRC,4                                           0778
*             PRINTTBL=''B;         /*                       @ZM32529*/
         XC    PRINTTBL(20),PRINTTBL                               0779
*             DARGSMOD=STORMSGS;    /*                       @ZM32529*/
         L     @15,DDSTRU                                          0780
         MVC   DARGSMOD(3,@15),@CC01378                            0780
*             DARGSENT=MSG3744I;    /*                       @ZM32529*/
         MVI   DARGSENT(@15),X'06'                                 0781
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @ZM32529*/
         L     @15,@PC00001                                        0782
         ST    @15,@AL00001                                        0782
         LA    @14,@CF00115                                        0782
         ST    @14,@AL00001+4                                      0782
         LA    @14,DDSTRU                                          0782
         ST    @14,@AL00001+8                                      0782
         MVI   @AL00001+8,X'80'                                    0782
         L     @15,GDTPRT(,@15)                                    0782
         LA    @01,@AL00001                                        0782
         BALR  @14,@15                                             0782
*           END;                    /*                       @ZM32529*/
*     END;                          /*                       @ZM32529*/
*                                                                  0784
@RF00776 DS    0H                                                  0784
@RC00768 DS    0H                                                  0785
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT  */
*   /* FROM VTOCKRTN. PASS THE CONDITION CODE IN REG 15.     @ZM32529*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0785
*   REG14=RETADDR3;                 /*                       @Y30LB31*/
@RF00766 LR    REG14,RETADDR3                                      0785
*   RETURN CODE(VTOCKRC);           /*                       @Y30LB31*/
         LR    @15,VTOCKRC                                         0786
@EL00008 DS    0H                                                  0786
@EF00008 DS    0H                                                  0786
@ER00008 BR    @14                                                 0786
*   END VTOCKRTN;                   /*                       @Y30LB31*/
*                                                                  0788
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - WORKRTN                                 @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DIRECTS THE VOLUME AND CARTRIDGE LABEL UPDATE @Y30LB31*/
*/*            FOR A NEW VOLUME SERIAL NO., THE DEACTIVATE,  @Y30LB31*/
*/*            OPTIONAL VOLUME EJECT, AND RENAME BACKOUT DUE @Y30LB31*/
*/*            TO ERRORS.  CALLS VLABLRTN, STORERTN, AND     @Y30LB31*/
*/*            BKOUTRTN.  NO MESSAGES ARE ISSUED BY THIS     @Y30LB31*/
*/*            PROC.                                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL                                           @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME SUCCESSFULLY  @Y30LB31*/
*/*          DEACTIVATED AND, IF SPECIFIED, RENAMED AND/OR   @Y30LB31*/
*/*          EJECTED.                                        @Y30LB31*/
*/*          RETURN CODE OF 8 INDICATES VOLUME DEACTIVATED   @Y30LB31*/
*/*          BUT COULD NOT BE EJECTED.  RETURN CODE OF 12    @Y30LB31*/
*/*          INDICATES THE VOLUME COULD NOT BE DEACTIVATED   @Y30LB31*/
*/*          OR RELABELED.                                   @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0788
*WORKRTN:                                                          0788
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0788
WORKRTN  DS    0H                                                  0789
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0789
*   DCL                                                            0789
*     WORKRC FIXED(15);             /*                       @Y30LB31*/
*                                                                  0789
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0790
*   RETADDR1=REG14;                 /*                       @Y30LB31*/
         ST    REG14,RETADDR1                                      0790
*   OLDERID2=NEWERID2;                                             0791
         L     @11,@PC00001                                        0791
         L     @11,GDTTR2(,@11)                                    0791
         MVC   @TS00001(95),NEWERID2(@11)                          0791
         MVC   OLDERID2(95,@11),@TS00001                           0791
*   NEWID2='SRWK';                  /*                       @Y30LB31*/
*                                                                  0792
         MVC   NEWID2(4,@11),@CC01517                              0792
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0793
*   WORKRC=LASTCC00;                /*                       @Y30LB31*/
*                                                                  0793
         SLR   @11,@11                                             0793
         STH   @11,WORKRC                                          0793
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOL IS BEING RENAMED AS WELL AS DEACTIVATED, CALL      */
*   /* VLABLRTN TO SET THE SERIAL MISMATCH FLAG IN THE MSVI AND TO   */
*   /* UPDATE THE VOL LABEL WITH THE NEW VOL SER NO.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0794
*   IF ADDR(NSER)^=NULLPTR THEN     /*                       @Y30LB31*/
         L     @04,@PC00001+4                                      0794
         C     @11,FDTPTR+4(,@04)                                  0794
         BE    @RF00794                                            0794
*     DO;                           /*                       @Y30LB31*/
*       CALL VLABLRTN;              /*                       @Y30LB31*/
         BAL   @14,VLABLRTN                                        0796
*       RESPECIFY                                                  0797
*         RTNREG RSTD;                                             0797
*       TESTRC=RTNREG;                                             0798
         LR    TESTRC,RTNREG                                       0798
*       RESPECIFY                                                  0799
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0799
*       /*************************************************************/
*       /*                                                           */
*       /* EXIT FROM THIS PROC IF THE VOL LABEL COULD NOT BE UPDATED.*/
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0800
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0800
         BZ    @RF00800                                            0800
*         WORKRC=4;                 /*                       @Y30LB31*/
         MVC   WORKRC(2),@CH00042                                  0801
*     END;                          /*                       @Y30LB31*/
@RF00800 DS    0H                                                  0803
*                                                                  0803
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCEED TO DEACTIVATE THE VOLUME.                     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0803
*   IF WORKRC=0 THEN                /*                       @Y30LB31*/
@RF00794 LH    @11,WORKRC                                          0803
         LTR   @11,@11                                             0803
         BNZ   @RF00803                                            0803
*     DO;                           /*                       @Y30LB31*/
*       CALL STORERTN;              /*                       @Y30LB31*/
         BAL   @14,STORERTN                                        0805
*       RESPECIFY                                                  0806
*         RTNREG RSTD;                                             0806
*       TESTRC=RTNREG;                                             0807
         LR    TESTRC,RTNREG                                       0807
*       RESPECIFY                                                  0808
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0808
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHETHER AN ERROR OCCURRED STORING THE VOLUME.   */
*       /* EXIT FROM THIS PROC IF THE VOLUME WAS DEACTIVATED ALTHOUGH*/
*       /* NOT EJECTED AS REQUESTED.                         @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0809
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0809
         BZ    @RF00809                                            0809
*         IF TESTRC=LASTCC08 THEN   /*                       @Y30LB31*/
         LA    @11,8                                               0810
         CR    TESTRC,@11                                          0810
         BNE   @RF00810                                            0810
*           WORKRC=LASTCC08;        /*                       @Y30LB31*/
*                                                                  0811
         STH   @11,WORKRC                                          0811
*       /*************************************************************/
*       /*                                                           */
*       /* EXIT FROM THIS PROC WITH A TERMINATING ERROR CODE AFTER   */
*       /* RESTORING THE VOLUME LABEL TO ITS ORIGINAL STATUS, IF     */
*       /* NECESSARY.                                        @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0812
*         ELSE                      /*                       @Y30LB31*/
*           DO;                     /*                       @Y30LB31*/
         B     @RC00810                                            0812
@RF00810 DS    0H                                                  0813
*             WORKRC=4;             /*                       @Y30LB31*/
         MVC   WORKRC(2),@CH00042                                  0813
*             IF ADDR(NSER)^=NULLPTR THEN/*                  @Y30LB31*/
         L     @11,@PC00001+4                                      0814
         L     @11,FDTPTR+4(,@11)                                  0814
         LTR   @11,@11                                             0814
         BZ    @RF00814                                            0814
*               CALL BKOUTRTN;      /*                       @Y30LB31*/
         BAL   @14,BKOUTRTN                                        0815
*           END;                    /*                       @Y30LB31*/
*                                                                  0816
@RF00814 DS    0H                                                  0817
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE DO GROUP THAT DEACTIVATED THE VOLUME.       @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0817
*     END;                          /*                       @Y30LB31*/
*                                                                  0817
@RC00810 DS    0H                                                  0817
@RF00809 DS    0H                                                  0818
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT. */
*   /* PASS THE CONDITION CODE IN REG 15.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0818
*   REG14=RETADDR1;                 /*                       @Y30LB31*/
@RF00803 L     REG14,RETADDR1                                      0818
*   RETURN CODE(WORKRC);            /*                       @Y30LB31*/
         LH    @15,WORKRC                                          0819
@EL00009 DS    0H                                                  0819
@EF00009 DS    0H                                                  0819
@ER00009 BR    @14                                                 0819
*   END WORKRTN;                    /*                       @Y30LB31*/
*                                                                  0821
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - VLABLRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DIRECT THE VOLUME LABEL UPDATE FOR THE NEW    @Y30LB31*/
*/*            VOL SER NO. AND SETTING OF THE SERIAL MIS-    @Y30LB31*/
*/*            MATCH FLAG IN THE MSVI.  CALLS VS2RTN AND     @Y30LB31*/
*/*            MVRRTN, TO PERFORM THESE FUNCTIONS.           @Y30LB31*/
*/*            MESSAGE IDC0086I IS ISSUED IN THIS PROC.      @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - STORETBL, PRINTTBL FOR MSGS, BASEV FOR           @Y30LB31*/
*/*         VOL RECORD.                                      @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL LABEL UPDATED  @Y30LB31*/
*/*          WITH NEW VOL SER NO. AND SERIAL MISMATCH        @Y30LB31*/
*/*          FLAG SET IN MSVI.  A RETURN CODE OF 4 INDICATES @Y30LB31*/
*/*          THAT THE MISMATCH FLAG COULD NOT BE SET BEFORE  @Y30LB31*/
*/*          UPDATING THE VOL LABEL OR THE VOL LABEL UPDATE  @Y30LB31*/
*/*          FAILED.                                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0821
*VLABLRTN:                                                         0821
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0821
VLABLRTN DS    0H                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   DCL                                                            0822
*     VLABLRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT FOR THIS */
*   /* PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS PROC.*/
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0823
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      0823
*   OLDERID2=NEWERID2;                                             0824
         L     @11,@PC00001                                        0824
         L     @11,GDTTR2(,@11)                                    0824
         MVC   @TS00001(95),NEWERID2(@11)                          0824
         MVC   OLDERID2(95,@11),@TS00001                           0824
*   NEWID2='SRVL';                  /*                       @Y30LB31*/
         MVC   NEWID2(4,@11),@CC01525                              0825
*   VLABLRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  0826
         SLR   VLABLRC,VLABLRC                                     0826
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE MISMATCH FLAG AND UPDATE THE RECOVERY DATA IN THE MSVI*/
*   /* IF 1) THE VOLUME IS NOT ALREADY FLAGGED DUE TO A PREVIOUS     */
*   /* RENAME FAILURE OR 2) THE VOLUME IS FLAGGED BUT THE RECOVERY   */
*   /* LABEL IN THE MSVI IS NOT THE SAME AS THE NEW SERIAL NO.       */
*   /* SPECIFIED.                                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*   IF BASVSMIS=OFFRECOVFLG=OFF THEN/*                      @Y30LB31*/
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0827
         BZ    @RT00827                                            0827
         TM    RECOVFLG,B'00010000'                                0827
         BNZ   @RF00827                                            0827
@RT00827 DS    0H                                                  0828
*     DO;                           /*                       @Y30LB31*/
*       SETVSFLG=ON;                /*                       @Y30LB31*/
         OI    SETVSFLG,B'00000010'                                0829
*       CALL MVRRTN;                /*                       @Y30LB31*/
         BAL   @14,MVRRTN                                          0830
*       RESPECIFY                                                  0831
*         RTNREG RSTD;                                             0831
*       TESTRC=RTNREG;                                             0832
         LR    TESTRC,RTNREG                                       0832
*       RESPECIFY                                                  0833
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0834
         BZ    @RF00834                                            0834
*         VLABLRC=4;                /*                       @Y30LB31*/
         LA    VLABLRC,4                                           0835
*     END;                          /*                       @Y30LB31*/
@RF00834 DS    0H                                                  0837
*                                                                  0837
*   /*****************************************************************/
*   /*                                                               */
*   /* AFTER SETTING THE MISMATCH FLAG IN THE MSVI, UPDATE THE VOLUME*/
*   /* LABEL WITH THE NEW VOL SER NO.                        @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*   IF VLABLRC=0 THEN               /*                       @Y30LB31*/
@RF00827 LTR   VLABLRC,VLABLRC                                     0837
         BNZ   @RF00837                                            0837
*     DO;                           /*                       @Y30LB31*/
*       CALL VS2RTN;                /*                       @Y30LB31*/
         BAL   @14,VS2RTN                                          0839
*       RESPECIFY                                                  0840
*         RTNREG RSTD;                                             0840
*       TESTRC=RTNREG;                                             0841
         LR    TESTRC,RTNREG                                       0841
*       RESPECIFY                                                  0842
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  0842
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOL LABEL UPDATE FAILED, CLEAR THE MISMATCH FLAG   */
*       /* FROM THE MSVI BEFORE TERMINATING UNLESS IT WAS SET BY A   */
*       /* PREVIOUS JOB. IF SO, RESET THE RECOVERY DATA TO ITS       */
*       /* ORIGINAL STATUS AT THE START OF THE JOB.          @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0843
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       0843
         BZ    @RF00843                                            0843
*         DO;                       /*                       @Y30LB31*/
*           VLABLRC=4;              /*                       @Y30LB31*/
         LA    VLABLRC,4                                           0845
*           IF VSMISFLG=ON THEN     /*                       @Y30LB31*/
         TM    VSMISFLG,B'00000100'                                0846
         BNO   @RF00846                                            0846
*             DO;                   /*                       @Y30LB31*/
*               SETVSFLG=OFF;       /*                       @Y30LB31*/
         NI    SETVSFLG,B'11111101'                                0848
*               CALL MVRRTN;        /*                       @Y30LB31*/
         BAL   @14,MVRRTN                                          0849
*             END;                  /*                       @Y30LB31*/
*         END;                      /*                       @Y30LB31*/
*                                                                  0851
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MSG IDC0086I TO INDICATE THE VOLUME LABEL HAS BEEN  */
*       /* UPDATED.                                          @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0852
*       ELSE                        /*                       @Y30LB31*/
*         DO;                       /*                       @Y30LB31*/
         B     @RC00843                                            0852
@RF00843 DS    0H                                                  0853
*           PRINTTBL=''B;           /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0853
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/
         L     @11,DDSTRU                                          0854
         MVC   DARGSMOD(3,@11),@CC01387                            0854
*           DARGSENT=MSG0086I;      /* STID=CM020            @Y30LB31*/
         MVI   DARGSENT(@11),X'14'                                 0855
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
         L     @11,@PC00001                                        0856
         ST    @11,@AL00001                                        0856
         LA    @06,@CF00115                                        0856
         ST    @06,@AL00001+4                                      0856
         LA    @06,DDSTRU                                          0856
         ST    @06,@AL00001+8                                      0856
         MVI   @AL00001+8,X'80'                                    0856
         L     @15,GDTPRT(,@11)                                    0856
         LA    @01,@AL00001                                        0856
         BALR  @14,@15                                             0856
*         END;                      /*                       @Y30LB31*/
*                                                                  0857
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE DO GROUP WHICH UPDATED THE VOLUME LABEL.    @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0858
*     END;                          /*                       @Y30LB31*/
*                                                                  0858
@RC00843 DS    0H                                                  0859
*   /*****************************************************************/
*   /*                                                               */
*   /* RELEASE THE RESERVE SET BY IDCVS01 OR IDCVS02 IF ERRORS WERE  */
*   /* ENCOUNTERED UPDATING THE VOL LABEL.                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0859
*   IF VLABLRC^=0 THEN              /*                       @Y30LB31*/
@RF00837 LTR   VLABLRC,VLABLRC                                     0859
         BZ    @RF00859                                            0859
*     DO;                           /*                       @Y30LB31*/
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/
         MVC   RNMSERNO(6),MSVIVOL#                                0861
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/
         MVC   RNMTRAIL(16),@CC01496                               0862
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/
         L     @11,@PC00001                                        0863
         ST    @11,@AL00001                                        0863
         LA    @06,@CC01366                                        0863
         ST    @06,@AL00001+4                                      0863
         LA    @06,MINORNM                                         0863
         ST    @06,@AL00001+8                                      0863
         MVI   @AL00001+8,X'80'                                    0863
         L     @15,GDTDEQ(,@11)                                    0863
         LA    @01,@AL00001                                        0863
         BALR  @14,@15                                             0863
*     END;                          /*                       @Y30LB31*/
*                                                                  0864
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER AND EXIT   */
*   /* FROM VLABLRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0865
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RF00859 LR    REG14,RETADDR2                                      0865
*   RETURN CODE(VLABLRC);           /*                       @Y30LB31*/
         LR    @15,VLABLRC                                         0866
@EL00010 DS    0H                                                  0866
@EF00010 DS    0H                                                  0866
@ER00010 BR    @14                                                 0866
*   END VLABLRTN;                   /*                       @Y30LB31*/
*                                                                  0868
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - MVRRTN                                  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - SETS AND CLEARS THE VOLUME SERIAL MISMATCH    @Y30LB31*/
*/*            FLAG FROM THE VOL RECORD IN THE MSVI.  CALLS  @Y30LB31*/
*/*            SSCMSG TO OUTPUT A MSSC REASON CODE MESSAGE   @Y30LB31*/
*/*            IF THE UPDATE FAILS.  ALSO ISSUES A SECONDARY @Y30LB31*/
*/*            ERROR MSG IDC2065I.                           @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL, BASEV, PRINTTBL FOR MESSAGES   @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE MISMATCH FLAG  @Y30LB31*/
*/*          WAS SET CLEARED.  STORETBL MAY BE UPDATED.  A   @Y30LB31*/
*/*          RETURN CODE OF 4 INDICATES THE MISMATCH FLAG    @Y30LB31*/
*/*          WAS NOT SET OR CLEARED.                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0868
*MVRRTN:                                                           0868
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0868
MVRRTN   DS    0H                                                  0869
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0869
*   DCL                                                            0869
*     MVRRTNRC FIXED(15);           /*                       @Y30LB31*/
*                                                                  0869
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP A LOCAL STORAGE AREA TO BUILD THE MSVC MODIFY-VOL-RECORD*/
*   /* PARM LIST.                                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0870
*   DCL                                                            0870
*     1 SR01MVR BDY(WORD),          /*                       @Y30LB31*/
*      2 SRMVRHDR CHAR(8),          /* MVR ARG LIST ID       @Y30LB31*/
*      2 SRMVRTBL CHAR(LENGTH(MVR));/*                       @Y30LB31*/
*                                                                  0870
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT FROM    */
*   /* THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS */
*   /* PROC.                                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0871
*   RETADDR3=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR3,REG14                                      0871
*   OLDERID2=NEWERID2;                                             0872
         L     @15,@PC00001                                        0872
         L     @15,GDTTR2(,@15)                                    0872
         MVC   @TS00001(95),NEWERID2(@15)                          0872
         MVC   OLDERID2(95,@15),@TS00001                           0872
*   NEWID2='SRMV';                  /*                       @Y30LB31*/
         MVC   NEWID2(4,@15),@CC01535                              0873
*   MVRRTNRC=LASTCC00;              /*                       @Y30LB31*/
*                                                                  0874
         SLR   MVRRTNRC,MVRRTNRC                                   0874
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE MVR PARM LIST TO UPDATE THE SERIAL MISMATCH    */
*   /* RECOVERY DATA IN THE MSVI.                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0875
*   SRMVRHDR='MVR';                 /*                       @Y30LB31*/
         MVI   SRMVRHDR+3,C' '                                     0875
         MVC   SRMVRHDR+4(4),SRMVRHDR+3                            0875
         MVC   SRMVRHDR(3),@CC01536                                0875
*   SRMVRTBL=''B;                   /*                       @Y30LB31*/
         XC    SRMVRTBL(88),SRMVRTBL                               0876
*   MVRPTR=ADDR(SRMVRTBL);          /*                       @Y30LB31*/
         LA    @15,SRMVRTBL                                        0877
         ST    @15,MVRPTR                                          0877
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB31*/
         LH    @14,MVRLEN                                          0878
         ST    @14,MVRLNGTH(,@15)                                  0878
*   MVRCODE=MVROP;                  /*                       @Y30LB31*/
         XC    MVRCODE+1(3,@15),MVRCODE+1(@15)                     0879
         MVI   MVRCODE(@15),X'85'                                  0879
*   MVRBVOL=MSVIVOL#;               /*                       @Y30LB31*/
         MVC   MVRBVOL(6,@15),MSVIVOL#                             0880
*   MVRFLBAS=ON;                    /*                       @Y30LB31*/
*   MVRFLLAB=ON;                    /*                       @Y30LB31*/
*                                                                  0882
         OI    MVRFLBAS(@15),B'00100001'                           0882
*   /*****************************************************************/
*   /*                                                               */
*   /* SET OR UPDATE THE MISMATCH RECOVERY DATA IN THE MSVI. @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0883
*   IF SETVSFLG=ON THEN             /*                       @Y30LB31*/
         TM    SETVSFLG,B'00000010'                                0883
         BNO   @RF00883                                            0883
*     DO;                           /*                       @Y30LB31*/
*       MVRSLMIS=ON;                /* SET MISMATCH FLAG ON  @Y30LB31*/
         OI    MVRSLMIS(@15),B'00000010'                           0885
*       MVRLABEL=NSERVAL;           /*                       @Y30LB31*/
         L     @14,@PC00001+4                                      0886
         L     @01,FDTPTR+4(,@14)                                  0886
         MVC   MVRLABEL(6,@15),NSERVAL(@01)                        0886
*     END;                          /*                       @Y30LB31*/
*                                                                  0887
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR THE MISMATCH RECOVERY DATA FROM THE MSVI ONLY IF THE    */
*   /* VOLUME WAS NOT FLAGGED DUE TO A PREVIOUS RENAME FAILURE.      */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0888
*   ELSE                            /*                       @Y30LB31*/
*     IF BASVSMIS=OFF THEN          /*                       @Y30LB31*/
         B     @RC00883                                            0888
@RF00883 TM    BASVSMIS(BASEVPTR),B'00100000'                      0888
         BNZ   @RF00888                                            0888
*       DO;                         /*                       @Y30LB31*/
*         MVRCLMIS=ON;              /* CLEAR MISMATCH FLAG   @Y30LB31*/
         L     @15,MVRPTR                                          0890
         OI    MVRCLMIS(@15),B'00000001'                           0890
*         MVRLABEL=BLANKIT;         /*                       @Y30LB31*/
         MVI   MVRLABEL+1(@15),C' '                                0891
         MVC   MVRLABEL+2(4,@15),MVRLABEL+1(@15)                   0891
         MVI   MVRLABEL(@15),C' '                                  0891
*       END;                        /*                       @Y30LB31*/
*                                                                  0892
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET THE MISMATCH RECOVERY DATA TO ITS ORIGINAL STATUS AT THE*/
*   /* START OF THE JOB IF THE VOLUME WAS FLAGGED DUE TO A PREVIOUS  */
*   /* RENAME FAILURE.                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0893
*     ELSE                          /*                       @Y30LB31*/
*       DO;                         /*                       @Y30LB31*/
         B     @RC00888                                            0893
@RF00888 DS    0H                                                  0894
*         MVRSLMIS=ON;              /* RESET MISMATCH DATA   @Y30LB31*/
         L     @15,MVRPTR                                          0894
         OI    MVRSLMIS(@15),B'00000010'                           0894
*         MVRLABEL=BASRECOV;        /*                       @Y30LB31*/
         MVC   MVRLABEL(6,@15),BASRECOV(BASEVPTR)                  0895
*       END;                        /*                       @Y30LB31*/
*                                                                  0896
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE MOFIFY-VOL-REC PARM LIST BEFORE   */
*   /* INVOKING MSVC TO UPDATE THE MISMATCH FLAG IN THE VOLUME       */
*   /* RECORD.                                               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0897
*   IF GDTDBG=NULLPTR THEN                                         0897
@RC00888 DS    0H                                                  0897
@RC00883 L     @15,@PC00001                                        0897
         L     @15,GDTDBG(,@15)                                    0897
         LTR   @15,@15                                             0897
         BZ    @RT00897                                            0897
*     ;                                                            0898
*   ELSE                                                           0899
*     DO;                                                          0899
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0900
*       DMPITMNM='SR01MVR';                                        0901
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0901
         MVC   DMPITMNM(7,DMPINDEX),@CC01537                       0901
*       DMPITMPT=ADDR(SR01MVR);                                    0902
         LA    @03,SR01MVR                                         0902
         ST    @03,DMPITMPT(,DMPINDEX)                             0902
*       DMPITMLN=LENGTH(SR01MVR);                                  0903
         MVC   DMPITMLN(2,DMPINDEX),@CH01703                       0903
*       DMPITMTP='H';                                              0904
         MVI   DMPITMTP(DMPINDEX),C'H'                             0904
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/
         LA    @03,16                                              0905
         ALR   DMPINDEX,@03                                        0905
*       DMPITMNM='STORETBL';                                       0906
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0906
*       DMPITMPT=ADDR(STORETBL);                                   0907
         LA    @15,STORETBL                                        0907
         ST    @15,DMPITMPT(,DMPINDEX)                             0907
*       DMPITMLN=LENGTH(STORETBL);                                 0908
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0908
*       DMPITMTP='H';                                              0909
         MVI   DMPITMTP(DMPINDEX),C'H'                             0909
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0910
*                                                                  0910
         ALR   DMPINDEX,@03                                        0910
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0911
*       DMPTRM=DMPTRMVL;                                           0911
         MVI   DMPTRM(DMPINDEX),X'FF'                              0911
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         0913
@RT00897 L     @15,@PC00001                                        0913
         L     @15,GDTDBG(,@15)                                    0913
         LTR   @15,@15                                             0913
         BZ    @RT00913                                            0913
*     ;                                                            0914
*   ELSE                                                           0915
*     CALL IDCDB010(GDTTBL,'SRSM',ADDR(DUMPLIST));/*         @Y30LB31*/
*                                                                  0915
         L     @15,@PC00001                                        0915
         ST    @15,@AL00001                                        0915
         LA    @14,@CC01538                                        0915
         ST    @14,@AL00001+4                                      0915
         LA    @14,DUMPLIST                                        0915
         ST    @14,@AFTEMPS+16                                     0915
         LA    @14,@AFTEMPS+16                                     0915
         ST    @14,@AL00001+8                                      0915
         MVI   @AL00001+8,X'80'                                    0915
         L     @15,GDTDBG(,@15)                                    0915
         LA    @01,@AL00001                                        0915
         BALR  @14,@15                                             0915
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE MSVC TO UPDATE THE SERIAL MISMATCH FLAG IN THE         */
*   /* INVENTORY RECORD.                                     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0916
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASON);/*              @Y30LB31*/
@RT00913 L     @02,@PC00001                                        0916
         ST    @02,@AL00001                                        0916
         LA    @15,VVIC                                            0916
         ST    @15,@AL00001+4                                      0916
         LA    @15,MVRPTR                                          0916
         ST    @15,@AL00001+8                                      0916
         LA    @15,REASON                                          0916
         ST    @15,@AL00001+12                                     0916
         MVI   @AL00001+12,X'80'                                   0916
         L     @15,GDTSSC(,@02)                                    0916
         LA    @01,@AL00001                                        0916
         BALR  @14,@15                                             0916
*   RESPECIFY                                                      0917
*     RTNREG RSTD;                                                 0917
*   TESTRC=RTNREG;                                                 0918
         LR    TESTRC,RTNREG                                       0918
*   RESPECIFY                                                      0919
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  0919
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MSVC ENCOUNTERED AN I/O ERROR UPDATING THE INVENTORY, TREAT*/
*   /* THIS AS A MINOR ERROR REQUIRING AN EOJ FINAL CONDITION CODE OF*/
*   /* AT LEAST 4.                                           @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0920
*   IF TESTRC=12 THEN               /*                       @Y30LB31*/
         C     TESTRC,@CF00565                                     0920
         BNE   @RF00920                                            0920
*     DO;                           /*                       @Y30LB31*/
*       TESTRC=LASTCC00;            /*                       @Y30LB31*/
         SLR   TESTRC,TESTRC                                       0922
*       CC04FLG=ON;                 /*                       @Y30LB31*/
         OI    CC04FLG,B'10000000'                                 0923
*     END;                          /*                       @Y30LB31*/
*                                                                  0925
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MISMATCH FLAG COULD NOT BE UPDATED IN THE VOLUME       */
*   /* RECORD, ISSUE THE APPROPRIATE MESSAGE CONTAINING THE MSSC     */
*   /* REASON CODE.                                          @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0925
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
@RF00920 LTR   TESTRC,TESTRC                                       0925
         BZ    @RF00925                                            0925
*     DO;                           /*                       @Y30LB31*/
*       MVRRTNRC=4;                 /*                       @Y30LB31*/
         LA    MVRRTNRC,4                                          0927
*       CALL SSCMSG(REASON);        /*                       @Y30LB31*/
*                                                                  0928
         LA    @15,REASON                                          0928
         ST    @15,@AL00001                                        0928
         LA    @01,@AL00001                                        0928
         BAL   @14,SSCMSG                                          0928
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT SECONDARY ERROR MSG IDC2065I, IF THE MISMATCH FLAG */
*       /* COULD NOT BE CLEARED.                             @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0929
*       IF SETVSFLG=OFF THEN        /*                       @Y30LB31*/
         TM    SETVSFLG,B'00000010'                                0929
         BNZ   @RF00929                                            0929
*         DO;                       /*                       @Y30LB31*/
*           PRINTTBL=''B;           /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               0931
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/
         L     @15,DDSTRU                                          0932
         MVC   DARGSMOD(3,@15),@CC01387                            0932
*           DARGSENT=MSG2065I;      /* STID=CM045            @Y30LB31*/
         MVI   DARGSENT(@15),X'2D'                                 0933
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
         L     @15,@PC00001                                        0934
         ST    @15,@AL00001                                        0934
         LA    @14,@CF00115                                        0934
         ST    @14,@AL00001+4                                      0934
         LA    @14,DDSTRU                                          0934
         ST    @14,@AL00001+8                                      0934
         MVI   @AL00001+8,X'80'                                    0934
         L     @15,GDTPRT(,@15)                                    0934
         LA    @01,@AL00001                                        0934
         BALR  @14,@15                                             0934
*         END;                      /*                       @Y30LB31*/
*     END;                          /*                       @Y30LB31*/
*                                                                  0936
*   /*****************************************************************/
*   /*                                                               */
*   /* SET AN INDICATOR THAT THE MISMATCH FLAG MUST BE CLEARED BEFORE*/
*   /* EOJ OR HAS BEEN CLEARED.                              @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0937
*   ELSE                            /*                       @Y30LB31*/
*     IF SETVSFLG=ON THEN           /*                       @Y30LB31*/
         B     @RC00925                                            0937
@RF00925 TM    SETVSFLG,B'00000010'                                0937
         BNO   @RF00937                                            0937
*       VSMISFLG=ON;                /*                       @Y30LB31*/
         OI    VSMISFLG,B'00000100'                                0938
*     ELSE                          /*                       @Y30LB31*/
*       VSMISFLG=OFF;               /*                       @Y30LB31*/
*                                                                  0939
         B     @RC00937                                            0939
@RF00937 NI    VSMISFLG,B'11111011'                                0939
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH CALLERS RETURN ADDRESS AND EXIT FROM      */
*   /* MVRRTN. PASS THE CONDITION CODE IN REG 15.            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0940
*   REG14=RETADDR3;                 /*                       @Y30LB31*/
@RC00937 DS    0H                                                  0940
@RC00925 LR    REG14,RETADDR3                                      0940
*   RETURN CODE(MVRRTNRC);          /*                       @Y30LB31*/
         LR    @15,MVRRTNRC                                        0941
@EL00011 DS    0H                                                  0941
@EF00011 DS    0H                                                  0941
@ER00011 BR    @14                                                 0941
*   END MVRRTN;                     /*                       @Y30LB31*/
*                                                                  0943
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - VS2RTN                                  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - UPDATES THE VOLUME LABEL WITH THE NEW VOLUME  @Y30LB31*/
*/*            SERIAL NO.  NO MESSAGES ARE ISSUED BY THIS    @Y30LB31*/
*/*            PROC.                                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL, BASEV                          @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL VOL   @Y30LB31*/
*/*          LABEL UDPATE.  ADDVTBL MAY BE UPDATED.          @Y30LB31*/
*/*          A RETURN CODE OF 4 INDICATES THE VOL LABEL      @Y30LB31*/
*/*          UPDATE FAILED.                                  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0943
*VS2RTN:                                                           0943
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0943
VS2RTN   DS    0H                                                  0944
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0944
*   DCL                                                            0944
*     VS2RTNRC FIXED(15);           /*                       @Y30LB31*/
*                                                                  0944
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP LOCAL STORAGE AREA TO BUILD THE PARM LIST FOR THE SECOND*/
*   /* VOLUME SERVICES ROUTINE WHICH READS AND UPDATES VOLUME LABELS.*/
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0945
*   DCL                                                            0945
*     SRVS2LST CHAR(LENGTH(VS2AGL)) BDY(WORD);/*             @Y30LB31*/
*   DCL                                                            0946
*     IDCVS02 CHAR(8) CONSTANT('IDCVS02 ');/*                @Y30LB31*/
*                                                                  0946
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT FROM */
*   /* THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS */
*   /* PROC.                                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0947
*   RETADDR3=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR3,REG14                                      0947
*   OLDERID2=NEWERID2;                                             0948
         L     @15,@PC00001                                        0948
         L     @15,GDTTR2(,@15)                                    0948
         MVC   @TS00001(95),NEWERID2(@15)                          0948
         MVC   OLDERID2(95,@15),@TS00001                           0948
*   NEWID2='SRS2';                  /*                       @Y30LB31*/
         MVC   NEWID2(4,@15),@CC01546                              0949
*   VS2RTNRC=LASTCC00;              /*                       @Y30LB31*/
*                                                                  0950
         SLR   VS2RTNRC,VS2RTNRC                                   0950
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT AND INITIALIZE THE VS2 ARGUMENT LIST IF THE VOLUME   */
*   /* LABEL IS BEING UPDATED WITH THE NEW SERIAL NO.        @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0951
*   IF BKOUTFLG=OFF THEN            /*                       @Y30LB31*/
         TM    BKOUTFLG,B'00001000'                                0951
         BNZ   @RF00951                                            0951
*     DO;                           /*                       @Y30LB31*/
*       RESPECIFY                                                  0953
*         VS2AGL BASED(ADDR(SRVS2LST));/*                    @Y30LB31*/
*       SRVS2LST=''B;               /*                       @Y30LB31*/
         XC    SRVS2LST(45),SRVS2LST                               0954
*       VSVOLSER=ON;                /* UPDATE VOL SER FLAG   @Y30LB31*/
         LA    @15,SRVS2LST                                        0955
         OI    VSVOLSER(@15),B'01000000'                           0955
*       VSDDNAME=SUNITDDN;          /*                       @Y30LB31*/
         MVC   VSDDNAME(8,@15),SUNITDDN                            0956
*       VSVOLUME=MSVIVOL#;          /*                       @Y30LB31*/
         MVC   VSVOLUME(6,@15),MSVIVOL#                            0957
*       VSUCBPTR=ADDR(SUNITUCB);    /*                       @Y30LB31*/
         LA    @14,SUNITUCB                                        0958
         ST    @14,VSUCBPTR(,@15)                                  0958
*       VSVOLPTR=ADDR(NSERVAL);     /*                       @Y30LB31*/
         L     @14,@PC00001+4                                      0959
         L     @01,FDTPTR+4(,@14)                                  0959
         LA    @14,NSERVAL(,@01)                                   0959
         ST    @14,VSVOLPTR(,@15)                                  0959
*     END;                          /*                       @Y30LB31*/
*                                                                  0960
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE VOL LABEL TO ITS ORIGINAL STATUS IF THE DEACTIVATE*/
*   /* FAILED. USE THE RECOVERY DATA FROM THE MSVI RECORD RETRIEVED  */
*   /* AT THE START OF THE PROGRAM IF THE VOLUME IS FLAGGED DUE TO A */
*   /* PREVIOUS RENAME FAILURE. THE RECOVERY DATA REFLECTS THE VOL   */
*   /* SERIAL NO. ACTUALLY RECORDED IN THE VOLUME LABEL.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0961
*   ELSE                            /*                       @Y30LB31*/
*     IF BASVSMIS=OFF THEN          /*                       @Y30LB31*/
         B     @RC00951                                            0961
@RF00951 TM    BASVSMIS(BASEVPTR),B'00100000'                      0961
         BNZ   @RF00961                                            0961
*       VSVOLPTR=ADDR(VOLVAL);      /*                       @Y30LB31*/
         LA    @15,SRVS2LST                                        0962
         L     @14,@PC00001+4                                      0962
         L     @01,FDTPTR(,@14)                                    0962
         LA    @14,VOLVAL(,@01)                                    0962
         ST    @14,VSVOLPTR(,@15)                                  0962
*     ELSE                          /*                       @Y30LB31*/
*       VSVOLPTR=ADDR(BASRECOV);    /*                       @Y30LB31*/
*                                                                  0963
         B     @RC00961                                            0963
@RF00961 LA    @15,SRVS2LST                                        0963
         LA    @14,BASRECOV(,BASEVPTR)                             0963
         ST    @14,VSVOLPTR(,@15)                                  0963
*   /*****************************************************************/
*   /*                                                               */
*   /* REQUEST A RESERVE BE SET DURING THE VOLUME LABEL UPDATE UNLESS*/
*   /* A PREVIOUS RESERVE SET BY THE VTOC VOLUME SERVICES ROUTINE IS */
*   /* STILL IN EFFECT.                                      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0964
*   IF RECOVFLG=ONBKOUTFLG=ON THEN /*                       @Y30LB31*/
@RC00961 DS    0H                                                  0964
@RC00951 TM    RECOVFLG,B'00011000'                                0964
         BZ    @RF00964                                            0964
*     VS2RES=ON;                    /*                       @Y30LB31*/
         LA    @15,SRVS2LST                                        0965
         OI    VS2RES(@15),B'10000000'                             0965
*   ELSE                            /*                       @Y30LB31*/
*     VS2RES=OFF;                   /*                       @Y30LB31*/
*                                                                  0966
         B     @RC00964                                            0966
@RF00964 LA    @15,SRVS2LST                                        0966
         NI    VS2RES(@15),B'01111111'                             0966
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE VS2 PARM LIST BEFORE INVOKING THE */
*   /* VOLUME SERIVCES ROUTINE THAT UPDATE THE VOLUME LABEL. @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0967
*   IF GDTDBG=NULLPTR THEN                                         0967
@RC00964 L     @15,@PC00001                                        0967
         L     @15,GDTDBG(,@15)                                    0967
         LTR   @15,@15                                             0967
         BZ    @RT00967                                            0967
*     ;                                                            0968
*   ELSE                                                           0969
*     DO;                                                          0969
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   0970
*       DMPITMNM='SRVS2LST';                                       0971
         MVC   DMPITMNM(8,DMPINDEX),@CC01549                       0971
*       DMPITMPT=ADDR(SRVS2LST);                                   0972
         LA    @03,SRVS2LST                                        0972
         ST    @03,DMPITMPT(,DMPINDEX)                             0972
*       DMPITMLN=LENGTH(SRVS2LST);                                 0973
         LA    @03,45                                              0973
         STH   @03,DMPITMLN(,DMPINDEX)                             0973
*       DMPITMTP='H';                                              0974
         MVI   DMPITMTP(DMPINDEX),C'H'                             0974
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0975
*                                                                  0975
         LA    @15,16                                              0975
         ALR   DMPINDEX,@15                                        0975
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0976
*       DMPITMNM='STORETBL';                                       0976
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0976
*       DMPITMPT=ADDR(STORETBL);                                   0977
         LA    @14,STORETBL                                        0977
         ST    @14,DMPITMPT(,DMPINDEX)                             0977
*       DMPITMLN=LENGTH(STORETBL);                                 0978
         STH   @03,DMPITMLN(,DMPINDEX)                             0978
*       DMPITMTP='H';                                              0979
         MVI   DMPITMTP(DMPINDEX),C'H'                             0979
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0980
*                                                                  0980
         ALR   DMPINDEX,@15                                        0980
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0981
*       DMPTRM=DMPTRMVL;                                           0981
         MVI   DMPTRM(DMPINDEX),X'FF'                              0981
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         0983
@RT00967 L     @15,@PC00001                                        0983
         L     @15,GDTDBG(,@15)                                    0983
         LTR   @15,@15                                             0983
         BZ    @RT00983                                            0983
*     ;                                                            0984
*   ELSE                                                           0985
*     CALL IDCDB010(GDTTBL,'SRNS',ADDR(DUMPLIST));/*         @Y30LB31*/
*                                                                  0985
         L     @15,@PC00001                                        0985
         ST    @15,@AL00001                                        0985
         LA    @14,@CC01550                                        0985
         ST    @14,@AL00001+4                                      0985
         LA    @14,DUMPLIST                                        0985
         ST    @14,@AFTEMPS+20                                     0985
         LA    @14,@AFTEMPS+20                                     0985
         ST    @14,@AL00001+8                                      0985
         MVI   @AL00001+8,X'80'                                    0985
         L     @15,GDTDBG(,@15)                                    0985
         LA    @01,@AL00001                                        0985
         BALR  @14,@15                                             0985
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE THE SECOND VOLUME SERVICES ROUTINE TO PERFORM THE      */
*   /* VOLUME LABEL UPDATE FOR THE NEW VOLUME SERIAL NO.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0986
*   CALL IDCSACL0(GDTTBL,IDCVS02,PUTLABEL,VS2AGL);/*         @Y30LB31*/
@RT00983 L     @02,@PC00001                                        0986
         ST    @02,@AL00001                                        0986
         LA    @15,@CC01545                                        0986
         ST    @15,@AL00001+4                                      0986
         LA    @15,PUTLABEL                                        0986
         ST    @15,@AL00001+8                                      0986
         LA    @15,SRVS2LST                                        0986
         ST    @15,@AL00001+12                                     0986
         MVI   @AL00001+12,X'80'                                   0986
         L     @15,GDTCAL(,@02)                                    0986
         LA    @01,@AL00001                                        0986
         BALR  @14,@15                                             0986
*   RESPECIFY                                                      0987
*     RTNREG RSTD;                                                 0987
*   TESTRC=RTNREG;                                                 0988
         LR    TESTRC,RTNREG                                       0988
*   RESPECIFY                                                      0989
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  0990
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST THE RETURN CODE FROM THE REQUEST TO UPDATE THE VOLUME    */
*   /* LABEL. IF THE UPDATE WAS SUCCESSFUL BUT THE VTOC COULD NOT BE */
*   /* CLOSED BY THE VOL SERV ROUTINE, TREAT THIS AS A MINOR ERROR   */
*   /* REQUIRING AN EOJ FINAL CONDITION CODE OF AT LEAST 4.  @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0990
*   IF TESTRC=8 THEN                /*                       @Y30LB31*/
         C     TESTRC,@CF00179                                     0990
         BNE   @RF00990                                            0990
*     CC04FLG=ON;                   /*                       @Y30LB31*/
*                                                                  0991
         OI    CC04FLG,B'10000000'                                 0991
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT WITH AN UNSUCCESSFUL CONDITION CODE IF THE VOLUME UPDATE */
*   /* FAILED.                                               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0992
*   ELSE                            /*                       @Y30LB31*/
*     IF TESTRC=4 THEN              /*                       @Y30LB31*/
         B     @RC00990                                            0992
@RF00990 LA    @02,4                                               0992
         CR    TESTRC,@02                                          0992
         BNE   @RF00992                                            0992
*       VS2RTNRC=4;                 /*                       @Y30LB31*/
*                                                                  0993
         LR    VS2RTNRC,@02                                        0993
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE CALLERS RETURN ADDRESS AND EXIT FROM  */
*   /* THIS PROC. PASS THE CONDITION CODE TO THE CALLER IN REG 15.   */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0994
*   REG14=RETADDR3;                 /*                       @Y30LB31*/
@RF00992 DS    0H                                                  0994
@RC00990 LR    REG14,RETADDR3                                      0994
*   RETURN CODE(VS2RTNRC);          /*                       @Y30LB31*/
         LR    @15,VS2RTNRC                                        0995
@EL00012 DS    0H                                                  0995
@EF00012 DS    0H                                                  0995
@ER00012 BR    @14                                                 0995
*   END VS2RTN;                     /*                       @Y30LB31*/
*                                                                  0997
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - STORERTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DIRECTS THE VOLUME DEMOUNT, DEACTIVATE,       @Y30LB31*/
*/*            AND OPTIONAL VOLUME EJECT.  CALLS VPREPRTN,   @Y30LB31*/
*/*            DEACTRTN, AND VOLEXIT TO EPRFORM THESE        @Y30LB31*/
*/*            FUNCTIONS.  NO MESSAGES ARE ISSUED BY THIS    @Y30LB31*/
*/*            PROC.                                         @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL                                 @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - A RETURN CODE OF 0 INDICATES                    @Y30LB31*/
*/*          VOL DEACTIVATED AND OPTIONALLY EJECTED.         @Y30LB31*/
*/*          A RETURN CODE OF 4 INDICATES VOL NOT DEACTI-    @Y30LB31*/
*/*          VATED.  A RETURN CODE OF 8 INDICATES VOL        @Y30LB31*/
*/*          DEACTIVATED BUT NOT EJECTED.                    @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  0997
*STORERTN:                                                         0997
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  0997
STORERTN DS    0H                                                  0998
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0998
*   DCL                                                            0998
*     STORERC FIXED(15);            /*                       @Y30LB31*/
*                                                                  0998
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS REQUIRED TO INVOKE VOLEXIT TO EJECT THE    */
*   /* DEACTIVATED VOLUME.                                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0999
*   DCL                                                            0999
*     RECDISP BIT(8);               /* SAVE OR DELETE PARM   @Y30LB31*/
*   DCL                                                            1000
*     SAVEREC BIT(8) CONSTANT('80'X);/* SAVE MSVI RECORD     @Y30LB31*/
*   DCL                                                            1001
*     ERASEREC BIT(8) CONSTANT('00'X);/* DELETE MSVI RECORD  @Y30LB31*/
*   DCL                                                            1002
*     LOCDATA CHAR(30);             /* DESTINATION INFO      @Y30LB31*/
*   DCL                                                            1003
*     1 IOERRFLG BIT(8),            /*                       @Y30LB31*/
*      2 ERRORBIT BIT(1);           /* MSVC I/O ERROR FLAG   @Y30LB31*/
*                                                                  1003
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1004
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      1004
*   OLDERID2=NEWERID2;                                             1005
         L     @11,@PC00001                                        1005
         L     @11,GDTTR2(,@11)                                    1005
         MVC   @TS00001(95),NEWERID2(@11)                          1005
         MVC   OLDERID2(95,@11),@TS00001                           1005
*   NEWID2='SRSR';                  /*                       @Y30LB31*/
*                                                                  1006
         MVC   NEWID2(4,@11),@CC01562                              1006
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1007
*   STORERC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  1007
         SLR   @11,@11                                             1007
         STH   @11,STORERC                                         1007
*   /*****************************************************************/
*   /*                                                               */
*   /* DEMOUNT THE VOLUME IN ORDER TO DEACTIVATE IT.         @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1008
*   MOUNTFLG=OFF;                   /*                       @Y30LB31*/
         NI    MOUNTFLG,B'10111111'                                1008
*   VPREPVOL=MSVIVOL#;              /*                       @Y30LB31*/
         MVC   VPREPVOL(6),MSVIVOL#                                1009
*   CALL VPREPRTN;                  /*                       @Y30LB31*/
         BAL   @14,VPREPRTN                                        1010
*   RESPECIFY                                                      1011
*     RTNREG RSTD;                                                 1011
*   TESTRC=RTNREG;                                                 1012
         LR    TESTRC,RTNREG                                       1012
*   RESPECIFY                                                      1013
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  1013
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM THIS PROC. IF THE DEMOUNT FAILED.           @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1014
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1014
         BZ    @RF01014                                            1014
*     STORERC=4;                    /*                       @Y30LB31*/
         MVC   STORERC(2),@CH00042                                 1015
*                                                                  1016
*   /*****************************************************************/
*   /*                                                               */
*   /* DEACTIVATE THE VOLUME AND IF THE VOLUME IS BEING RENAMED,     */
*   /* CHANGE THE VOLUME SERIAL NO. IN THE CARTRIDGE LABELS AND CLEAR*/
*   /* THE MISMATCH FLAG FROM THE MSVI.                      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1016
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC01014                                            1016
@RF01014 DS    0H                                                  1017
*       CALL DEACTRTN;              /*                       @Y30LB31*/
         BAL   @14,DEACTRTN                                        1017
*       RESPECIFY                                                  1018
*         RTNREG RSTD;                                             1018
*       TESTRC=RTNREG;                                             1019
         LR    TESTRC,RTNREG                                       1019
*       RESPECIFY                                                  1020
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  1020
*       /*************************************************************/
*       /*                                                           */
*       /* EXIT FROM THIS PROC. IF THE DEACTIVATE FAILED.    @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1021
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1021
         BZ    @RF01021                                            1021
*         STORERC=4;                /*                       @Y30LB31*/
*                                                                  1022
         MVC   STORERC(2),@CH00042                                 1022
*       /*************************************************************/
*       /*                                                           */
*       /* EJECT THE DEACTIVATED VOLUME IF REQUESTED.        @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1023
*       ELSE                        /*                       @Y30LB31*/
*         IF ADDR(EJECT)^=NULLPTR THEN/*                     @Y30LB31*/
         B     @RC01021                                            1023
@RF01021 SLR   @11,@11                                             1023
         L     @06,@PC00001+4                                      1023
         C     @11,FDTPTR+8(,@06)                                  1023
         BE    @RF01023                                            1023
*           DO;                     /*                       @Y30LB31*/
*             IF ADDR(REC)^=NULLPTR THEN/*                   @Y30LB31*/
         C     @11,FDTPTR+16(,@06)                                 1025
         BE    @RF01025                                            1025
*               RECDISP=SAVEREC;    /*                       @Y30LB31*/
         MVI   RECDISP,X'80'                                       1026
*             ELSE                  /*                       @Y30LB31*/
*               RECDISP=ERASEREC;   /*                       @Y30LB31*/
         B     @RC01025                                            1027
@RF01025 MVI   RECDISP,X'00'                                       1027
*             IF ADDR(LOC)^=NULLPTR THEN/*                   @Y30LB31*/
@RC01025 L     @11,@PC00001+4                                      1028
         L     @11,FDTPTR+24(,@11)                                 1028
         LTR   @11,@11                                             1028
         BZ    @RF01028                                            1028
*               LOCDATA=LOCVAL;     /*                       @Y30LB31*/
         MVC   LOCDATA(30),LOCVAL(@11)                             1029
*             ELSE                  /*                       @Y30LB31*/
*               LOCDATA=BLANKIT;    /*                       @Y30LB31*/
         B     @RC01028                                            1030
@RF01028 MVI   LOCDATA+1,C' '                                      1030
         MVC   LOCDATA+2(28),LOCDATA+1                             1030
         MVI   LOCDATA,C' '                                        1030
*             ERRORBIT=OFF;         /*                       @Y30LB31*/
@RC01028 NI    ERRORBIT,B'01111111'                                1031
*             CALL VOLEXIT(CSN1,MSVIVOL#,IOERRFLG,/*         @Y30LB31*/
*                 RECDISP,LOCDATA); /*                       @Y30LB31*/
         LA    @11,CSN1                                            1032
         ST    @11,@AL00001                                        1032
         LA    @11,MSVIVOL#                                        1032
         ST    @11,@AL00001+4                                      1032
         LA    @11,IOERRFLG                                        1032
         ST    @11,@AL00001+8                                      1032
         LA    @11,RECDISP                                         1032
         ST    @11,@AL00001+12                                     1032
         LA    @11,LOCDATA                                         1032
         ST    @11,@AL00001+16                                     1032
         LA    @01,@AL00001                                        1032
         BAL   @14,VOLEXIT                                         1032
*             RESPECIFY                                            1033
*               RTNREG RSTD;                                       1033
*             TESTRC=RTNREG;                                       1034
         LR    TESTRC,RTNREG                                       1034
*             RESPECIFY                                            1035
*               RTNREG UNRSTD;      /*                       @Y30LB31*/
*             IF TESTRC^=0 THEN     /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1036
         BZ    @RF01036                                            1036
*               STORERC=LASTCC08;   /*                       @Y30LB31*/
*                                                                  1037
         MVC   STORERC(2),@CH00179                                 1037
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK WHETHER MSVC HAD AN I/O ERROR UPDATING THE    */
*             /* MSVI DURING THE EJECT OPERATION.            @Y30LB31*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1038
*             IF ERRORBIT=ON THEN   /*                       @Y30LB31*/
@RF01036 TM    ERRORBIT,B'10000000'                                1038
         BNO   @RF01038                                            1038
*               CC04FLG=ON;         /*                       @Y30LB31*/
         OI    CC04FLG,B'10000000'                                 1039
*           END;                    /*                       @Y30LB31*/
@RF01038 DS    0H                                                  1041
*     END;                          /*                       @Y30LB31*/
*                                                                  1041
@RF01023 DS    0H                                                  1041
@RC01021 DS    0H                                                  1042
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT. */
*   /* PASS THE CONDITION CODE IN REG 15.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1042
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RC01014 LR    REG14,RETADDR2                                      1042
*   RETURN CODE(STORERC);           /*                       @Y30LB31*/
         LH    @15,STORERC                                         1043
@EL00013 DS    0H                                                  1043
@EF00013 DS    0H                                                  1043
@ER00013 BR    @14                                                 1043
*   END STORERTN;                   /*                       @Y30LB31*/
*                                                                  1045
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - DEACTRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUNCTION - DEACTIVATES THE VOLUME AND OPTIONALLY CHANGES @Y30LB31*/
*/*            THE VOLUME SERIAL NO. IN THE CART LABELS      @Y30LB31*/
*/*            AND IN THE INVENTORY.  CALLS SSCMSG TO PRINT  @Y30LB31*/
*/*            A MESSAGE WITH MSSC REASON CODE IF THE MSC    @Y30LB31*/
*/*            AND DEACTIVATE RENAME ORDER FAILED.  MSGS     @Y30LB31*/
*/*            IDC0731I, IDC3732I, AND IDC0064I ARE ISSUED.  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, STORETBL, DARGLIST FOR MSGS, CMMSG.      @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL           @Y30LB31*/
*/*          DEACTIVATE WITH OPTIONAL RENAME RETURN CODE OF  @Y30LB31*/
*/*          4 INDICATES DEACTIVATE FAILED.                  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  1045
*DEACTRTN:                                                         1045
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  1045
DEACTRTN DS    0H                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS.                                   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*   DCL                                                            1046
*     DEACTRC FIXED(15);            /* LOCAL CONDITION CODE  @Y30LB31*/
*   DCL                                                            1047
*     NOCHANGE BIT(8) CONSTANT('FF'X);/*                     @Y30LB31*/
*                                                                  1047
*   /*****************************************************************/
*   /*                                                               */
*   /* SETUP STORAGE AREA TO BUILD THE MSSC AND MSIC DEFINE PARAMETER*/
*   /* LISTS.                                                @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   DECLARE                         /*                       @Y30LB31*/
*     1 SR01DEFV BDY(WORD),         /*                       @Y30LB31*/
*      2 SDEFVHDR CHAR(8),          /* DEFLIST IDENTIFIER    @Y30LB31*/
*      2 SDEFVLST CHAR(LENGTH(DEFLIST)),/*                   @Y30LB31*/
*      2 SDEFVEHD CHAR(8),          /* DEFVE IDENTIFIER      @Y30LB31*/
*      2 SDEFVEXT CHAR(LENGTH(DEFVE));/*                     @Y30LB31*/
*                                                                  1048
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1049
*   RETADDR3=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR3,REG14                                      1049
*   OLDERID2=NEWERID2;                                             1050
         L     @06,@PC00001                                        1050
         L     @06,GDTTR2(,@06)                                    1050
         MVC   @TS00001(95),NEWERID2(@06)                          1050
         MVC   OLDERID2(95,@06),@TS00001                           1050
*   NEWID2='SRDE';                  /*                       @Y30LB31*/
*                                                                  1051
         MVC   NEWID2(4,@06),@CC01575                              1051
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */
*   /* PROCEDURE. ZERO THE PARM LISTS BEFORE INITIALIZING.   @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1052
*   DEACTRC=LASTCC00;               /*                       @Y30LB31*/
         SLR   @06,@06                                             1052
         LR    DEACTRC,@06                                         1052
*   SR01DEFV=''B;                   /* ZERO DEF TBL + EXTS   @Y30LB31*/
         XC    SR01DEFV(212),SR01DEFV                              1053
*   SDEFVHDR='DEFLIST';             /* DEFINE TBL IDENTIFIER @Y30LB31*/
         MVI   SDEFVHDR+7,C' '                                     1054
         MVC   SDEFVHDR(7),@CC01576                                1054
*   SDEFVEHD='DEFVE';               /* DEF TBL EXTENSIONS ID @Y30LB31*/
         MVI   SDEFVEHD+5,C' '                                     1055
         MVC   SDEFVEHD+6(2),SDEFVEHD+5                            1055
         MVC   SDEFVEHD(5),@CC01577                                1055
*   DEFVEPTR=ADDR(SDEFVEXT);        /* MSIC DEFINE ARG LIST  @Y30LB31*/
         LA    DEFVEPTR,SDEFVEXT                                   1056
*   DEFVPTR=ADDR(SDEFVLST);         /* MSS DEFINE ARG LIST   @Y30LB31*/
         LA    @02,SDEFVLST                                        1057
         ST    @02,DEFVPTR                                         1057
*   DEFVOLD=MSVIVOL#;               /*                       @Y30LB31*/
         MVC   DEFVOLD(6,@02),MSVIVOL#                             1058
*   DEFVVFLG=NOCHANGE;              /*                       @Y30LB31*/
*                                                                  1059
         MVI   DEFVVFLG(@02),X'FF'                                 1059
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE APPROPRIATE REQUEST OPTION DETERMINED BY WHETHER THE  */
*   /* VOLUME IS ONLY BEING DEACTIVATED OR DEACTIVATED PLUS RENAMED. */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1060
*   IF ADDR(NSER)=NULLPTR THEN      /*                       @Y30LB31*/
         L     @15,@PC00001+4                                      1060
         C     @06,FDTPTR+4(,@15)                                  1060
         BNE   @RF01060                                            1060
*     DEFVDACT=ON;                  /*                       @Y30LB31*/
         OI    DEFVDACT(@02),B'00000001'                           1061
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC01060                                            1062
@RF01060 DS    0H                                                  1063
*       DEFVRNM=ON;                 /*                       @Y30LB31*/
         L     @06,DEFVPTR                                         1063
         OI    DEFVRNM(@06),B'00100000'                            1063
*       DEFVNVOL=NSERVAL;           /*                       @Y30LB31*/
         L     @02,@PC00001+4                                      1064
         L     @01,FDTPTR+4(,@02)                                  1064
         MVC   DEFVNVOL(6,@06),NSERVAL(@01)                        1064
*       DEFVVEXT=DEFVEPTR;          /*                       @Y30LB31*/
*                                                                  1065
         ST    DEFVEPTR,DEFVVEXT(,@06)                             1065
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE DEFVE PARM LIST TO CLEAR THE MISMATCH FLAG. IF */
*       /* NO RECORD AND EJECT ARE SPECIFIED, SET THE DUPLICATE VOL  */
*       /* INDICATOR TO ALLOW FOR A DUPLICATE WHEN RENAMING. @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1066
*       DEFLABEL=BLANKIT;           /*                       @Y30LB31*/
         MVI   DEFLABEL+1(DEFVEPTR),C' '                           1066
         MVC   DEFLABEL+2(4,DEFVEPTR),DEFLABEL+1(DEFVEPTR)         1066
         MVI   DEFLABEL(DEFVEPTR),C' '                             1066
*       DEFPVLAB=ON;                /*                       @Y30LB31*/
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1067
*       DEFCRCVY=ON;                /*                       @Y30LB31*/
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1068
*       DEFLAMIS=ON;                /*                       @Y30LB31*/
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1069
*       DEFLNGTH=DEFLEN;            /*                       @Y30LB31*/
         LH    @06,DEFLEN                                          1070
         ST    @06,DEFLNGTH(,DEFVEPTR)                             1070
*       IF ADDR(EJECT)^=NULLPTR&ADDR(NREC)^=NULLPTR THEN/*   @Y30LB31*/
         SLR   @06,@06                                             1071
         C     @06,FDTPTR+8(,@02)                                  1071
         BE    @RF01071                                            1071
         C     @06,FDTPTR+20(,@02)                                 1071
         BE    @RF01071                                            1071
*         DEFDUP=ON;                /*                       @Y30LB31*/
         OI    DEFDUP(DEFVEPTR),B'00100000'                        1072
*     END;                          /*                       @Y30LB31*/
*                                                                  1073
@RF01071 DS    0H                                                  1074
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A SYMBOLIC DUMP OF THE DEFINE ORDER PARM LIST BEFORE THE */
*   /* DEACTIVATE OR RENAME REQUEST IS EXECUTED.             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1074
*   IF GDTDBG=NULLPTR THEN                                         1074
@RC01060 L     @06,@PC00001                                        1074
         L     @06,GDTDBG(,@06)                                    1074
         LTR   @06,@06                                             1074
         BZ    @RT01074                                            1074
*     ;                                                            1075
*   ELSE                                                           1076
*     DO;                                                          1076
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/
         LA    DMPINDEX,DUMPLIST                                   1077
*       DMPITMNM='SR01DEFV';                                       1078
         MVC   DMPITMNM(8,DMPINDEX),@CC01578                       1078
*       DMPITMPT=ADDR(SR01DEFV);                                   1079
         LA    @06,SR01DEFV                                        1079
         ST    @06,DMPITMPT(,DMPINDEX)                             1079
*       DMPITMLN=LENGTH(SR01DEFV);                                 1080
         MVC   DMPITMLN(2,DMPINDEX),@CH01704                       1080
*       DMPITMTP='H';                                              1081
         MVI   DMPITMTP(DMPINDEX),C'H'                             1081
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1082
*                                                                  1082
         LA    @06,16                                              1082
         ALR   DMPINDEX,@06                                        1082
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1083
*       DMPITMNM='STORETBL';                                       1083
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       1083
*       DMPITMPT=ADDR(STORETBL);                                   1084
         LA    @03,STORETBL                                        1084
         ST    @03,DMPITMPT(,DMPINDEX)                             1084
*       DMPITMLN=LENGTH(STORETBL);                                 1085
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       1085
*       DMPITMTP='H';                                              1086
         MVI   DMPITMTP(DMPINDEX),C'H'                             1086
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1087
*                                                                  1087
         ALR   DMPINDEX,@06                                        1087
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1088
*       DMPTRM=DMPTRMVL;                                           1088
         MVI   DMPTRM(DMPINDEX),X'FF'                              1088
*     END;                          /*                       @Y30LB31*/
*   IF GDTDBG=NULLPTR THEN                                         1090
@RT01074 L     @06,@PC00001                                        1090
         L     @06,GDTDBG(,@06)                                    1090
         LTR   @06,@06                                             1090
         BZ    @RT01090                                            1090
*     ;                                                            1091
*   ELSE                                                           1092
*     CALL IDCDB010(GDTTBL,'SRBD',ADDR(DUMPLIST));/*         @Y30LB31*/
*                                                                  1092
         L     @06,@PC00001                                        1092
         ST    @06,@AL00001                                        1092
         LA    @15,@CC01579                                        1092
         ST    @15,@AL00001+4                                      1092
         LA    @15,DUMPLIST                                        1092
         ST    @15,@AFTEMPS+24                                     1092
         LA    @15,@AFTEMPS+24                                     1092
         ST    @15,@AL00001+8                                      1092
         MVI   @AL00001+8,X'80'                                    1092
         L     @15,GDTDBG(,@06)                                    1092
         LA    @01,@AL00001                                        1092
         BALR  @14,@15                                             1092
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE THE VOLUME SERIAL NO. IN THE CART LABELS AND MSVI.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1093
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,ECBMSPTR);/*
*                                                            @Y30LB31*/
@RT01090 L     @06,@PC00001                                        1093
         ST    @06,@AL00001                                        1093
         LA    @02,DEFINE                                          1093
         ST    @02,@AL00001+4                                      1093
         LA    @02,DEFVPTR                                         1093
         ST    @02,@AL00001+8                                      1093
         LA    @02,REASON                                          1093
         ST    @02,@AL00001+12                                     1093
         LA    @02,ECBCODE                                         1093
         ST    @02,@AL00001+16                                     1093
         LA    @02,ECBMSPTR                                        1093
         ST    @02,@AL00001+20                                     1093
         MVI   @AL00001+20,X'80'                                   1093
         L     @15,GDTSSC(,@06)                                    1093
         LA    @01,@AL00001                                        1093
         BALR  @14,@15                                             1093
*   RESPECIFY                                                      1094
*     RTNREG RSTD;                                                 1094
*   TESTRC=RTNREG;                                                 1095
         LR    TESTRC,RTNREG                                       1095
*   RESPECIFY                                                      1096
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  1097
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST RETURN CODE FROM MSC DEFINE ORDER. TREAT A MSVI I/O ERROR*/
*   /* AS A MINOR ERROR.                                     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1097
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1097
         BZ    @RF01097                                            1097
*     IF TESTRC=12 THEN             /*                       @Y30LB31*/
         C     TESTRC,@CF00565                                     1098
         BNE   @RF01098                                            1098
*       CC04FLG=ON;                 /*                       @Y30LB31*/
*                                                                  1099
         OI    CC04FLG,B'10000000'                                 1099
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MSC DEACTIVATE OR RENAME FAILED, UPDATE THE COND CODE. */
*   /* PRINT A MESSAGE WITH THE MSSC REASON CODE AND A SECONDARY     */
*   /* ERROR MSG. AND EXIT FROM THIS PROCEDURE.              @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1100
*     ELSE                          /*                       @Y30LB31*/
*       DO;                         /*                       @Y30LB31*/
         B     @RC01098                                            1100
@RF01098 DS    0H                                                  1101
*         DEACTRC=4;                /*                       @Y30LB31*/
         LA    @06,4                                               1101
         LR    DEACTRC,@06                                         1101
*         IF TESTRC=4 THEN          /*                       @Y30LB31*/
         CR    TESTRC,@06                                          1102
         BNE   @RF01102                                            1102
*           CALL SSCMSG(REASON,ECBCODE);/*                   @Y30LB31*/
         LA    @06,REASON                                          1103
         ST    @06,@AL00001                                        1103
         LA    @06,ECBCODE                                         1103
         ST    @06,@AL00001+4                                      1103
         LA    @01,@AL00001                                        1103
         BAL   @14,SSCMSG                                          1103
*         PRINTTBL=''B;             /*                       @Y30LB31*/
@RF01102 XC    PRINTTBL(20),PRINTTBL                               1104
*         DARGSMOD=STORMSGS;        /*                       @Y30LB31*/
         L     @06,DDSTRU                                          1105
         MVC   DARGSMOD(3,@06),@CC01378                            1105
*         DARGSENT=MSG3732I;        /* STID=SR03             @Y30LB31*/
         MVI   DARGSENT(@06),X'03'                                 1106
*         DARGDBP=ADDR(MSVIVOL#);   /*                       @Y30LB31*/
         LA    @15,MSVIVOL#                                        1107
         ST    @15,DARGDBP(,@06)                                   1107
*         DARGILP=LENGTH(MSVIVOL#); /*                       @Y30LB31*/
         MVC   DARGILP(2,@06),@CH00156                             1108
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB31*/
         L     @06,@PC00001                                        1109
         ST    @06,@AL00001                                        1109
         LA    @15,@CF00115                                        1109
         ST    @15,@AL00001+4                                      1109
         LA    @15,DDSTRU                                          1109
         ST    @15,@AL00001+8                                      1109
         MVI   @AL00001+8,X'80'                                    1109
         L     @15,GDTPRT(,@06)                                    1109
         LA    @01,@AL00001                                        1109
         BALR  @14,@15                                             1109
*       END;                        /*                       @Y30LB31*/
*                                                                  1110
*   /*****************************************************************/
*   /*                                                               */
*   /* FOLLOWING THE SUCCESSFUL DEACTIVATE WITH OPTIONAL RENAME, SAVE*/
*   /* THE VOL SER NO. OF THE DEACTIVATED VOLUME. ALSO SAVE CSN1     */
*   /* NEEDED TO EJECT IT. ISSUE THE APPROPRIATE INFORMATIVE MESSAGES*/
*   /* AND THEN FREE THE MSC MESSAGE STORAGE AREA.           @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1111
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC01097                                            1111
@RF01097 DS    0H                                                  1112
*       CMMSGPTR=ECBMSPTR+ECBLENN;  /*                       @Y30LB31*/
         LA    CMMSGPTR,4                                          1112
         AL    CMMSGPTR,ECBMSPTR                                   1112
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/
         L     @06,@PC00001+4                                      1113
         L     @06,FDTPTR+4(,@06)                                  1113
         LTR   @06,@06                                             1113
         BZ    @RF01113                                            1113
*         MSVIVOL#=CMNEWVOL;        /*                       @Y30LB31*/
         MVC   MSVIVOL#(6),CMNEWVOL(CMMSGPTR)                      1114
*       CSN1=CMCSN1;                /*                       @Y30LB31*/
*                                                                  1115
@RF01113 MVC   CSN1(12),CMCSN1(CMMSGPTR)                           1115
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOL WAS RENAMED, ISSUE MESSAGE IDC0064I INDICATING */
*       /* THE VOL SER NO. WAS CHANGED IN THE CART LABELS AND MSVI.  */
*       /*                                                   @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1116
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/
         L     @06,@PC00001+4                                      1116
         L     @06,FDTPTR+4(,@06)                                  1116
         LTR   @06,@06                                             1116
         BZ    @RF01116                                            1116
*         DO;                       /*                       @Y30LB31*/
*           PRINTTBL=''B;           /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               1118
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/
         L     @06,DDSTRU                                          1119
         MVC   DARGSMOD(3,@06),@CC01387                            1119
*           DARGSENT=MSG0064I;      /* STID=CM046            @Y30LB31*/
         MVI   DARGSENT(@06),X'2E'                                 1120
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
         L     @06,@PC00001                                        1121
         ST    @06,@AL00001                                        1121
         LA    @15,@CF00115                                        1121
         ST    @15,@AL00001+4                                      1121
         LA    @15,DDSTRU                                          1121
         ST    @15,@AL00001+8                                      1121
         MVI   @AL00001+8,X'80'                                    1121
         L     @15,GDTPRT(,@06)                                    1121
         LA    @01,@AL00001                                        1121
         BALR  @14,@15                                             1121
*         END;                      /*                       @Y30LB31*/
*                                                                  1122
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MSG IDC0731I INDICATING THAT THE VOL HAS BEEN       */
*       /* DEACTIVATED.                                      @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1123
*       PRINTTBL=''B;               /*                       @Y30LB31*/
@RF01116 XC    PRINTTBL(20),PRINTTBL                               1123
*       DARGSMOD=STORMSGS;          /*                       @Y30LB31*/
         L     @06,DDSTRU                                          1124
         MVC   DARGSMOD(3,@06),@CC01378                            1124
*       DARGSENT=MSG0731I;          /* STID=SR02             @Y30LB31*/
         MVI   DARGSENT(@06),X'02'                                 1125
*       DARGDBP=ADDR(MSVIVOL#);     /*                       @Y30LB31*/
         LA    @15,MSVIVOL#                                        1126
         ST    @15,DARGDBP(,@06)                                   1126
*       DARGILP=LENGTH(MSVIVOL#);   /*                       @Y30LB31*/
         MVC   DARGILP(2,@06),@CH00156                             1127
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/
*                                                                  1128
         L     @06,@PC00001                                        1128
         ST    @06,@AL00001                                        1128
         LA    @15,@CF00115                                        1128
         ST    @15,@AL00001+4                                      1128
         LA    @15,DDSTRU                                          1128
         ST    @15,@AL00001+8                                      1128
         MVI   @AL00001+8,X'80'                                    1128
         L     @15,GDTPRT(,@06)                                    1128
         LA    @01,@AL00001                                        1128
         BALR  @14,@15                                             1128
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE MSSC MESSAGE STORAGE AREA.               @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1129
*       CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                    @Y30LB31*/
         L     @06,@PC00001                                        1129
         ST    @06,@AL00001                                        1129
         LA    @15,ECBMSPTR                                        1129
         ST    @15,@AL00001+4                                      1129
         L     @15,GDTFSP(,@06)                                    1129
         LA    @01,@AL00001                                        1129
         BALR  @14,@15                                             1129
*     END;                          /*                       @Y30LB31*/
*                                                                  1130
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER TO REG 14 AND RETURN */
*   /* TO CALLER, PASSING THE CONDITION CODE IN REG 15.      @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1131
*   REG14=RETADDR3;                 /*                       @Y30LB31*/
@RC01097 LR    REG14,RETADDR3                                      1131
*   RETURN CODE(DEACTRC);           /*                       @Y30LB31*/
         LR    @15,DEACTRC                                         1132
@EL00014 DS    0H                                                  1132
@EF00014 DS    0H                                                  1132
@ER00014 BR    @14                                                 1132
*   END DEACTRTN;                   /*                       @Y30LB31*/
*                                                                  1134
*/*********************************************************  @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* PROCEDURE NAME - BKOUTRTN                                @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* FUCNTION - CALLS VPREPRTN TO MOUNT THE VOLUME THAT       @Y30LB31*/
*/*            CANNOT BE DEACTIVATED AND CALLS VS2RTN        @Y30LB31*/
*/*            TO RESTORE THE VOL LABEL TO ITS ORIGINAL      @Y30LB31*/
*/*            STATUS.  ISSUES MESSAGES IDC07338 AND         @Y30LB31*/
*/*            IDC3734I.                                     @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* INPUT - FDTTBL, PRINTTBL FOR MESSAGES, STORETBL          @Y30LB31*/
*/*                                                          @Y30LB31*/
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME LABEL         @Y30LB31*/
*/*          RESTORED.  RETURN CODE OF 4 INDICATES EITHER    @Y30LB31*/
*/*          THE MOUNT FAILED THAT IS REQUIRED FOR THE       @Y30LB31*/
*/*          BACKOUT OPERATIONS, OR THE VOL LABEL COULD NOT  @Y30LB31*/
*/*          BE RESTORED.                                    @Y30LB31*/
*/*                                                          @Y30LB31*/
*/*********************************************************  @Y30LB31*/
*                                                                  1134
*BKOUTRTN:                                                         1134
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/
*                                                                  1134
BKOUTRTN DS    0H                                                  1135
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*   DCL                                                            1135
*     BKOUTRC FIXED(15);            /*                       @Y30LB31*/
*                                                                  1135
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1136
*   RETADDR2=REG14;                 /*                       @Y30LB31*/
         LR    RETADDR2,REG14                                      1136
*   OLDERID2=NEWERID2;                                             1137
         L     @11,@PC00001                                        1137
         L     @11,GDTTR2(,@11)                                    1137
         MVC   @TS00001(95),NEWERID2(@11)                          1137
         MVC   OLDERID2(95,@11),@TS00001                           1137
*   NEWID2='SRBK';                  /*                       @Y30LB31*/
*                                                                  1138
         MVC   NEWID2(4,@11),@CC01584                              1138
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO OUT CONDITION CODE SET BY THIS PROC.             @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1139
*   BKOUTRC=LASTCC00;               /*                       @Y30LB31*/
*                                                                  1139
         SLR   @11,@11                                             1139
         STH   @11,BKOUTRC                                         1139
*   /*****************************************************************/
*   /*                                                               */
*   /* MOUNT THE VOLUME IN ORDER TO RESTORE THE VOLUME LABEL.        */
*   /*                                                       @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1140
*   MOUNTFLG=ON;                    /* MOUNT REQUIRED        @Y30LB31*/
         OI    MOUNTFLG,B'01000000'                                1140
*   VPREPVOL=MSVIVOL#;              /*                       @Y30LB31*/
         MVC   VPREPVOL(6),MSVIVOL#                                1141
*   CALL VPREPRTN;                  /*                       @Y30LB31*/
         BAL   @14,VPREPRTN                                        1142
*   RESPECIFY                                                      1143
*     RTNREG RSTD;                                                 1143
*   TESTRC=RTNREG;                                                 1144
         LR    TESTRC,RTNREG                                       1144
*   RESPECIFY                                                      1145
*     RTNREG UNRSTD;                /*                       @Y30LB31*/
*                                                                  1145
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MOUNT FAILED, ISSUE MSG IDC3734I BEFORE EXITING FROM   */
*   /* THIS PROC.                                            @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1146
         BZ    @RF01146                                            1146
*     DO;                           /*                       @Y30LB31*/
*       BKOUTRC=4;                  /*                       @Y30LB31*/
         MVC   BKOUTRC(2),@CH00042                                 1148
*       PRINTTBL=''B;               /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               1149
*       DARGSMOD=STORMSGS;          /*                       @Y30LB31*/
         L     @11,DDSTRU                                          1150
         MVC   DARGSMOD(3,@11),@CC01378                            1150
*       DARGSENT=MSG3734I;          /* STID=SR05             @Y30LB31*/
         MVI   DARGSENT(@11),X'05'                                 1151
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/
         L     @11,@PC00001                                        1152
         ST    @11,@AL00001                                        1152
         LA    @06,@CF00115                                        1152
         ST    @06,@AL00001+4                                      1152
         LA    @06,DDSTRU                                          1152
         ST    @06,@AL00001+8                                      1152
         MVI   @AL00001+8,X'80'                                    1152
         L     @15,GDTPRT(,@11)                                    1152
         LA    @01,@AL00001                                        1152
         BALR  @14,@15                                             1152
*     END;                          /*                       @Y30LB31*/
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* AFTER MOUNTING THE VOL, RESTORE THE VOL LABEL TO ITS ORIGINAL */
*   /* STATUS.                                               @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1154
*   ELSE                            /*                       @Y30LB31*/
*     DO;                           /*                       @Y30LB31*/
         B     @RC01146                                            1154
@RF01146 DS    0H                                                  1155
*       BKOUTFLG=ON;                /*                       @Y30LB31*/
         OI    BKOUTFLG,B'00001000'                                1155
*       CALL VS2RTN;                /*                       @Y30LB31*/
         BAL   @14,VS2RTN                                          1156
*       RESPECIFY                                                  1157
*         RTNREG RSTD;                                             1157
*       TESTRC=RTNREG;                                             1158
         LR    TESTRC,RTNREG                                       1158
*       RESPECIFY                                                  1159
*         RTNREG UNRSTD;            /*                       @Y30LB31*/
*                                                                  1159
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOL LABEL COULD NOT BE RESTORED, ISSUE MSG IDC3734I*/
*       /* AND PROCEED TO RELEASE THE RESERVE BEFORE EXITING FROM    */
*       /* THIS PROC.                                        @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1160
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1160
         BZ    @RF01160                                            1160
*         DO;                       /*                       @Y30LB31*/
*           BKOUTRC=4;              /*                       @Y30LB31*/
         MVC   BKOUTRC(2),@CH00042                                 1162
*           PRINTTBL=''B;           /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               1163
*           DARGSMOD=STORMSGS;      /*                       @Y30LB31*/
         L     @11,DDSTRU                                          1164
         MVC   DARGSMOD(3,@11),@CC01378                            1164
*           DARGSENT=MSG3734I;      /* STID=SR05             @Y30LB31*/
         MVI   DARGSENT(@11),X'05'                                 1165
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
         L     @11,@PC00001                                        1166
         ST    @11,@AL00001                                        1166
         LA    @06,@CF00115                                        1166
         ST    @06,@AL00001+4                                      1166
         LA    @06,DDSTRU                                          1166
         ST    @06,@AL00001+8                                      1166
         MVI   @AL00001+8,X'80'                                    1166
         L     @15,GDTPRT(,@11)                                    1166
         LA    @01,@AL00001                                        1166
         BALR  @14,@15                                             1166
*         END;                      /*                       @Y30LB31*/
*                                                                  1168
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MSG IDC0733I INDICATING THE VOLUME LABEL WAS        */
*       /* RESTORED.                                         @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1168
*       ELSE                        /*                       @Y30LB31*/
*         DO;                       /*                       @Y30LB31*/
         B     @RC01160                                            1168
@RF01160 DS    0H                                                  1169
*           PRINTTBL=''B;           /*                       @Y30LB31*/
         XC    PRINTTBL(20),PRINTTBL                               1169
*           DARGSMOD=STORMSGS;      /*                       @Y30LB31*/
         L     @11,DDSTRU                                          1170
         MVC   DARGSMOD(3,@11),@CC01378                            1170
*           DARGSENT=MSG0733I;      /* STID=SR04             @Y30LB31*/
         MVI   DARGSENT(@11),X'04'                                 1171
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/
*                                                                  1172
         L     @11,@PC00001                                        1172
         ST    @11,@AL00001                                        1172
         LA    @06,@CF00115                                        1172
         ST    @06,@AL00001+4                                      1172
         LA    @06,DDSTRU                                          1172
         ST    @06,@AL00001+8                                      1172
         MVI   @AL00001+8,X'80'                                    1172
         L     @15,GDTPRT(,@11)                                    1172
         LA    @01,@AL00001                                        1172
         BALR  @14,@15                                             1172
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE MISMATCH FLAG AND RECOVERY DATA WAS UPDATED BY */
*           /* THIS STOREV REQUEST, CLEAR THE MISMATCH FLAG FROM THE */
*           /* MSVI OR RESET THE RECOVERY DATA TO ITS ORIGINAL STATUS*/
*           /* IF THE VOLUME WAS FLAGGED DUE TO A PREVIOUS RENAME    */
*           /* FAILURE.                                      @Y30LB31*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1173
*           IF VSMISFLG=ON THEN     /*                       @Y30LB31*/
         TM    VSMISFLG,B'00000100'                                1173
         BNO   @RF01173                                            1173
*             DO;                   /*                       @Y30LB31*/
*               SETVSFLG=OFF;       /*                       @Y30LB31*/
         NI    SETVSFLG,B'11111101'                                1175
*               CALL MVRRTN;        /*                       @Y30LB31*/
         BAL   @14,MVRRTN                                          1176
*               RESPECIFY                                          1177
*                 RTNREG RSTD;                                     1177
*               TESTRC=RTNREG;                                     1178
         LR    TESTRC,RTNREG                                       1178
*               RESPECIFY                                          1179
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/
         LTR   TESTRC,TESTRC                                       1180
         BZ    @RF01180                                            1180
*                 BKOUTRC=4;        /*                       @Y30LB31*/
         MVC   BKOUTRC(2),@CH00042                                 1181
*             END;                  /*                       @Y30LB31*/
@RF01180 DS    0H                                                  1183
*         END;                      /*                       @Y30LB31*/
*                                                                  1183
@RF01173 DS    0H                                                  1184
*       /*************************************************************/
*       /*                                                           */
*       /* RELEASE THE RESERVE SET BY IDCVS02 WHEN RESTORING THE     */
*       /* VOLUME LABEL.                                     @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1184
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/
@RC01160 MVC   RNMSERNO(6),MSVIVOL#                                1184
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/
         MVC   RNMTRAIL(16),@CC01496                               1185
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/
*                                                                  1186
         L     @11,@PC00001                                        1186
         ST    @11,@AL00001                                        1186
         LA    @06,@CC01366                                        1186
         ST    @06,@AL00001+4                                      1186
         LA    @06,MINORNM                                         1186
         ST    @06,@AL00001+8                                      1186
         MVI   @AL00001+8,X'80'                                    1186
         L     @15,GDTDEQ(,@11)                                    1186
         LA    @01,@AL00001                                        1186
         BALR  @14,@15                                             1186
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE DO GROUP WHICH RESTORED THE VOL LABEL AND CLEARED   */
*       /* THE MISMATCH FLAG.                                @Y30LB31*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1187
*     END;                          /*                       @Y30LB31*/
*                                                                  1187
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */
*   /* FROM BKOUTRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1188
*   REG14=RETADDR2;                 /*                       @Y30LB31*/
@RC01146 LR    REG14,RETADDR2                                      1188
*   RETURN CODE(BKOUTRC);           /*                       @Y30LB31*/
         LH    @15,BKOUTRC                                         1189
@EL00015 DS    0H                                                  1189
@EF00015 DS    0H                                                  1189
@ER00015 BR    @14                                                 1189
*   END BKOUTRTN;                   /*                       @Y30LB31*/
*                                                                  1191
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/
*/*                TO SYSPRINT.                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/
*/*             PASSED AS INPUT:                             @Y30LB38*/
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/
*/*                         SUCCESSFULLY                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1191
*VOLEXIT:                                                          1191
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/
VOLEXIT  MVC   @PC00016(20),0(@01)                                 1191
*                                                                  1192
*/********************************************************************/
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/
*/*                                                                  */
*/*          NAME: IEZMCRTE                                  @Y30LB22*/
*/*                                                                  */
*/*          FUNCTION:                                       @Y30LB22*/
*/*                  MAPS THE REQUEST BLOCK                  @Y30LB22*/
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/
*/*                  AN MOVE CARTRIDGE REQUEST.              @Y30LB22*/
*/*                                                                  */
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/
*/*                                                          @Y30LB22*/
*/********************************************************************/
*                                                                  1192
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1192
*   DCL                                                            1192
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22
*                                      OF EXTENSION          @Y30LB22*/
*                                                                  1192
*   /*****************************************************************/
*   /*                                                               */
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*   DCL                                                            1193
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           1193
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 1193
*                                      AFTER EJECTION        @Y30LB22*/
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22
*                                      BIT 0=0, REC DELETE   @Y30LB22*/
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/
*                                                                  1194
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*   DCL                                                            1194
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/
*   DCL                                                            1195
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */
*   DCL                                                            1196
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/
*   DCL                                                            1197
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/
*   DCL                                                            1198
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/
*   DCL                                                            1199
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/
*   DCL                                                            1200
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/
*   DCL                                                            1201
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/
*   DCL                                                            1202
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/
*   DCL                                                            1203
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/
*                                                                  1203
*   /*****************************************************************/
*   /*                                                               */
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1204
*   DCL                                                            1204
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/
*                                                                  1204
*   /*****************************************************************/
*   /*                                                               */
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1205
*   DCL                                                            1205
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/
*   DCL                                                            1206
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/
*   DCL                                                            1207
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/
*   DCL                                                            1208
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/
*   DCL                                                            1209
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/
*   DCL                                                            1210
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/
*                                                                  1210
*   /*****************************************************************/
*   /*                                                               */
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1211
*   DCL                                                            1211
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    1211
*                                                            @Y30LB02*/
*                                                                  1211
*   /*****************************************************************/
*   /*                                                               */
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/
*   /* ********************************************************      */
*   /*                                                       @Y30LB02*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1212
*   DCL                                                            1212
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK
*                                                            @Y30LB02*/
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    1212
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX
*                                                            @Y30LB02*/
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   1212
*                                                            @Y30LB02*/
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  1212
*                                      SPECD                 @Y30LB02*/
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE
*                                                            @Y30LB02*/
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   1212
*                                                            @Y30LB02*/
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   1212
*                                                            @Y30LB02*/
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 1212
*                                                            @Y30LB02*/
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 1212
*                                                            @Y30LB02*/
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/
*                                                                  1212
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1213
*                                                                  1213
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1213
*   DCL                                                            1213
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/
*   DCL                                                            1214
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/
*                                                                  1214
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/
*   /* USYSINFO MACRO                                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1215
*   DCL                                                            1215
*     1 VESYSIN CHAR(16),                                          1215
*      2 VEJOBNAM CHAR(8),                                         1215
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/
*                                                                  1215
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1216
*   DCL                                                            1216
*     1 VEROUTCD BIT(16),                                          1216
*      2 VECD1 BIT(1),                                             1216
*      2 * BIT(15);                 /*                       @Y30LB38*/
*   DCL                                                            1217
*     1 VEDESCCD BIT(16),                                          1217
*      2 * BIT(2),                                                 1217
*      2 VEDESC3 BIT(1),                                           1217
*      2 * BIT(12);                 /*                       @Y30LB38*/
*                                                                  1217
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1218
*   DCL                                                            1218
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/
*                                                                  1218
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/
*   /* COMMON FSR'S                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1219
*   DCL                                                            1219
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/
*   DCL                                                            1220
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            1221
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/
*   DCL                                                            1222
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/
*                                                                  1222
*   /*****************************************************************/
*   /*                                                               */
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1223
*   DCL                                                            1223
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/
*                                                                  1224
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1224
*   VERETADR=REG14;                 /*                       @Y30LB38*/
         LR    VERETADR,REG14                                      1224
*   OLDERID2=NEWERID2;                                             1225
         L     @11,@PC00001                                        1225
         L     @11,GDTTR2(,@11)                                    1225
         MVC   @TS00001(95),NEWERID2(@11)                          1225
         MVC   OLDERID2(95,@11),@TS00001                           1225
*   NEWID2='VESR';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@11),@CC01668                              1226
*   VELIST=''B;                     /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1227
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/
         LA    @11,VELIST                                          1228
         ST    @11,VEDDSTRU                                        1228
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/
         LA    @11,VEMCLIST                                        1229
         ST    @11,MCLSTPTR                                        1229
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/
         LA    MCRTEPTR,VEEXLIST                                   1230
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/
         LA    @02,VEWTOMSG                                        1231
         ST    @02,VEWTOPTR                                        1231
*   MCLIST=''B;                     /*                       @Y30LB38*/
         XC    MCLIST(48,@11),MCLIST(@11)                          1232
*   MCRTE=''B;                      /*                       @Y30LB38*/
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  1233
*   VECOND='0'X;                    /*                       @Y30LB38*/
*                                                                  1234
         SLR   VECOND,VECOND                                       1234
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1235
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/
         LH    @02,MCRLEN                                          1235
         ST    @02,MCRLNGTH(,MCRTEPTR)                             1235
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/
         L     @02,@PC00016                                        1236
         MVC   MCRTCSN(12,@11),VECSN1(@02)                         1236
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/
         OI    MCRTTRAN(@11),B'00100000'                           1237
*   IF VERECFLG=ON THEN                                            1238
         L     @11,@PC00016+12                                     1238
         TM    VERECFLG(@11),B'10000000'                           1238
         BNO   @RF01238                                            1238
*     MCRREC=ON;                    /*                       @Y30LB38*/
         OI    MCRREC(MCRTEPTR),B'10000000'                        1239
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/
@RF01238 L     @11,@PC00016+16                                     1240
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@11)                   1240
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/
         L     @11,MCLSTPTR                                        1241
         ST    MCRTEPTR,MCRTVEXT(,@11)                             1241
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/
*                                                                  1242
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      1242
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1243
*   IF GDTDBG=NULLPTR THEN                                         1243
         L     @11,@PC00001                                        1243
         L     @11,GDTDBG(,@11)                                    1243
         LTR   @11,@11                                             1243
         BZ    @RT01243                                            1243
*     ;                                                            1244
*   ELSE                                                           1245
*     DO;                                                          1245
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/
         LA    DMPINDEX,VEDMPSTG                                   1246
*       DMPITMNM='MCLIST';                                         1247
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1247
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1247
         MVC   DMPITMNM(6,DMPINDEX),@CC01670                       1247
*       DMPITMPT=ADDR(MCLSTPTR);                                   1248
         LA    @11,MCLSTPTR                                        1248
         ST    @11,DMPITMPT(,DMPINDEX)                             1248
*       DMPITMLN=LENGTH(MCLIST);                                   1249
         MVC   DMPITMLN(2,DMPINDEX),@CH01161                       1249
*       DMPITMTP='H';                                              1250
         MVI   DMPITMTP(DMPINDEX),C'H'                             1250
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1251
*                                                                  1251
         AL    DMPINDEX,@CF00473                                   1251
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1252
*       DMPTRM=DMPTRMVL;                                           1252
         MVI   DMPTRM(DMPINDEX),X'FF'                              1252
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         1254
@RT01243 L     @11,@PC00001                                        1254
         L     @11,GDTDBG(,@11)                                    1254
         LTR   @11,@11                                             1254
         BZ    @RT01254                                            1254
*     ;                                                            1255
*   ELSE                                                           1256
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/
*                                                                  1256
         L     @11,@PC00001                                        1256
         ST    @11,@AL00001                                        1256
         LA    @15,@CC01671                                        1256
         ST    @15,@AL00001+4                                      1256
         LA    @15,VEDMPSTG                                        1256
         ST    @15,@AFTEMPS+28                                     1256
         LA    @15,@AFTEMPS+28                                     1256
         ST    @15,@AL00001+8                                      1256
         MVI   @AL00001+8,X'80'                                    1256
         L     @15,GDTDBG(,@11)                                    1256
         LA    @01,@AL00001                                        1256
         BALR  @14,@15                                             1256
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1257
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 1257
*                                                            @Y30LB38*/
@RT01254 L     @11,@PC00001                                        1257
         ST    @11,@AL00001                                        1257
         LA    @02,MOVE                                            1257
         ST    @02,@AL00001+4                                      1257
         LA    @02,MCLSTPTR                                        1257
         ST    @02,@AL00001+8                                      1257
         LA    @02,VERESNCD                                        1257
         ST    @02,@AL00001+12                                     1257
         LA    @02,VEECB                                           1257
         ST    @02,@AL00001+16                                     1257
         LA    @02,VEMSGPTR                                        1257
         ST    @02,@AL00001+20                                     1257
         MVI   @AL00001+20,X'80'                                   1257
         L     @15,GDTSSC(,@11)                                    1257
         LA    @01,@AL00001                                        1257
         BALR  @14,@15                                             1257
*   RESPECIFY                                                      1258
*     RTNREG RSTD;                                                 1258
*   TESTRC=RTNREG;                                                 1259
         LR    TESTRC,RTNREG                                       1259
*   RESPECIFY                                                      1260
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  1260
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1261
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/
         LA    @11,4                                               1261
         AL    @11,VEMSGPTR                                        1261
         ST    @11,VEMSGPTR                                        1261
*                                                                  1262
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1262
*   IF TESTRC=LASTCC00TESTRC=LASTCC12 THEN                        1262
         LTR   TESTRC,TESTRC                                       1262
         BZ    @RT01262                                            1262
         C     TESTRC,@CF00565                                     1262
         BNE   @RF01262                                            1262
@RT01262 DS    0H                                                  1263
*     DO;                           /*                       @Y30LB38*/
*                                                                  1263
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1264
*       IF TESTRC=LASTCC12 THEN                                    1264
         C     TESTRC,@CF00565                                     1264
         BNE   @RF01264                                            1264
*         VEVVIERR=ON;              /*                       @Y30LB38*/
*                                                                  1265
         L     @11,@PC00016+8                                      1265
         OI    VEVVIERR(@11),B'10000000'                           1265
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */
*       /*                                                   @Y30LB38*/
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1266
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/
*                                                                  1266
@RF01264 L     @11,@PC00001                                        1266
         ST    @11,@AL00001                                        1266
         LA    @15,NAMES                                           1266
         ST    @15,@AL00001+4                                      1266
         LA    @15,VESYSIN                                         1266
         ST    @15,@AFTEMPS+28                                     1266
         LA    @15,@AFTEMPS+28                                     1266
         ST    @15,@AL00001+8                                      1266
         MVI   @AL00001+8,X'80'                                    1266
         L     @15,GDTSFO(,@11)                                    1266
         LA    @01,@AL00001                                        1266
         BALR  @14,@15                                             1266
*       /*************************************************************/
*       /*                                                           */
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1267
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @11,VEDDSTRU                                        1267
         MVC   DARGSMOD(3,@11),@CC01387                            1267
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/
         MVI   DARGSENT(@11),X'17'                                 1268
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @15,VEMSGPTR                                        1269
         LA    @14,CMCSN1(,@15)                                    1269
         ST    @14,DARGDBP(,@11)                                   1269
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @14,12                                              1270
         STH   @14,DARGILP(,@11)                                   1270
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/
         L     @03,VEWTOPTR                                        1271
         ST    @03,DARGRETP(,@11)                                  1271
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/
*                                                                  1272
         MVC   DARGRETL(2,@11),@CH01281                            1272
*       /*************************************************************/
*       /*                                                           */
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */
*       /*                                                   @Y30LB38*/
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1273
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@15),X'F2'                                 1273
         BNE   @RF01273                                            1273
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/
         LA    @03,4                                               1275
         STH   @03,DARGCNT(,@11)                                   1275
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         LA    @02,1                                               1276
         STH   @02,DARGINS(,@11)                                   1276
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @14,DARGINL(,@11)                                   1277
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @02,CMCSN2(,@15)                                    1278
         ST    @02,DARGDTM(,@11)                                   1278
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/
         LA    @02,2                                               1279
         STH   @02,DARGINS+8(,@11)                                 1279
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL+8(2,@11),@CH00156                           1280
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @02,@PC00016+4                                      1281
         ST    @02,DARGDTM+8(,@11)                                 1281
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/
         LA    @02,3                                               1282
         STH   @02,DARGINS+16(,@11)                                1282
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @02,8                                               1283
         STH   @02,DARGINL+16(,@11)                                1283
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @15,VEJOBNAM                                        1284
         ST    @15,DARGDTM+16(,@11)                                1284
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/
         STH   @03,DARGINS+24(,@11)                                1285
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @02,DARGINL+24(,@11)                                1286
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @15,VESTEPNM                                        1287
         ST    @15,DARGDTM+24(,@11)                                1287
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       1289
*         DO;                       /*                       @Y30LB38*/
         B     @RC01273                                            1289
@RF01273 DS    0H                                                  1290
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/
         LA    @11,3                                               1290
         L     @15,VEDDSTRU                                        1290
         STH   @11,DARGCNT(,@15)                                   1290
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/
         LA    @14,2                                               1291
         STH   @14,DARGINS(,@15)                                   1291
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/
         MVC   DARGINL(2,@15),@CH00156                             1292
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/
         L     @14,@PC00016+4                                      1293
         ST    @14,DARGDTM(,@15)                                   1293
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/
         STH   @11,DARGINS+8(,@15)                                 1294
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/
         LA    @11,8                                               1295
         STH   @11,DARGINL+8(,@15)                                 1295
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/
         LA    @14,VEJOBNAM                                        1296
         ST    @14,DARGDTM+8(,@15)                                 1296
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/
         LA    @14,4                                               1297
         STH   @14,DARGINS+16(,@15)                                1297
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/
         STH   @11,DARGINL+16(,@15)                                1298
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/
         LA    @11,VESTEPNM                                        1299
         ST    @11,DARGDTM+16(,@15)                                1299
*         END;                      /*                       @Y30LB38*/
*                                                                  1300
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1301
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  1301
@RC01273 L     @11,@PC00001                                        1301
         ST    @11,@AL00001                                        1301
         LA    @15,@CF00115                                        1301
         ST    @15,@AL00001+4                                      1301
         LA    @15,VEDDSTRU                                        1301
         ST    @15,@AL00001+8                                      1301
         MVI   @AL00001+8,X'80'                                    1301
         L     @15,GDTPRT(,@11)                                    1301
         LA    @01,@AL00001                                        1301
         BALR  @14,@15                                             1301
*       /*************************************************************/
*       /*                                                           */
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */
*       /*                                                   @Y30LB38*/
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1302
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01281                                1302
*       VEROUTCD=''B;               /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                1303
*       VECD1=ON;                   /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   1304
*       VEDESCCD=''B;               /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                1305
*       VEDESC3=ON;                 /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 1306
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*
*                                                            @Y30LB38*/
         L     @11,@PC00001                                        1307
         ST    @11,@AL00001                                        1307
         LA    @15,VEWTOLEN                                        1307
         ST    @15,@AL00001+4                                      1307
         LA    @15,VEWTOPTR                                        1307
         ST    @15,@AL00001+8                                      1307
         LA    @15,VEROUTCD                                        1307
         ST    @15,@AL00001+12                                     1307
         LA    @15,VEDESCCD                                        1307
         ST    @15,@AL00001+16                                     1307
         MVI   @AL00001+16,X'80'                                   1307
         L     @15,GDTWTO(,@11)                                    1307
         LA    @01,@AL00001                                        1307
         BALR  @14,@15                                             1307
*                                                                  1308
*       /*************************************************************/
*       /*                                                           */
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1308
*       VELIST=''B;                 /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1308
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/
         L     @11,VEDDSTRU                                        1309
         MVC   DARGSMOD(3,@11),@CC01387                            1309
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/
         MVI   DARGSENT(@11),X'15'                                 1310
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/
         L     @15,VEMSGPTR                                        1311
         LA    @14,CMCSN1(,@15)                                    1311
         ST    @14,DARGDBP(,@11)                                   1311
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/
         LA    @14,12                                              1312
         STH   @14,DARGILP(,@11)                                   1312
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/
         CLI   CMNUMCRT(@15),X'F2'                                 1313
         BNE   @RF01313                                            1313
*         DO;                       /*                       @Y30LB38*/
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/
         LA    @03,1                                               1315
         STH   @03,DARGCNT(,@11)                                   1315
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/
         STH   @03,DARGINS(,@11)                                   1316
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/
         STH   @14,DARGINL(,@11)                                   1317
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/
         LA    @15,CMCSN2(,@15)                                    1318
         ST    @15,DARGDTM(,@11)                                   1318
*         END;                      /*                       @Y30LB38*/
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/
*                                                                  1320
@RF01313 L     @11,@PC00001                                        1320
         ST    @11,@AL00001                                        1320
         LA    @15,@CF00115                                        1320
         ST    @15,@AL00001+4                                      1320
         LA    @15,VEDDSTRU                                        1320
         ST    @15,@AL00001+8                                      1320
         MVI   @AL00001+8,X'80'                                    1320
         L     @15,GDTPRT(,@11)                                    1320
         LA    @01,@AL00001                                        1320
         BALR  @14,@15                                             1320
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/
*       /* FROM THE USSC MACRO                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1321
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/
         L     @11,VEMSGPTR                                        1321
         SL    @11,@CF00042                                        1321
         ST    @11,VEMSGPTR                                        1321
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/
         L     @11,@PC00001                                        1322
         ST    @11,@AL00001                                        1322
         LA    @15,VEMSGPTR                                        1322
         ST    @15,@AL00001+4                                      1322
         L     @15,GDTFSP(,@11)                                    1322
         LA    @01,@AL00001                                        1322
         BALR  @14,@15                                             1322
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           1324
*     DO;                           /*                       @Y30LB38*/
*                                                                  1324
         B     @RC01262                                            1324
@RF01262 DS    0H                                                  1325
*       /*************************************************************/
*       /*                                                           */
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */
*       /*                                                   @Y30LB38*/
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1325
*       IF TESTRC=LASTCC08 THEN                                    1325
         C     TESTRC,@CF00179                                     1325
         BNE   @RF01325                                            1325
*         DO;                       /*                       @Y30LB38*/
*           VELIST=''B;             /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1327
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/
         L     @11,VEDDSTRU                                        1328
         MVC   DARGSMOD(3,@11),@CC01387                            1328
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/
         MVI   DARGSENT(@11),X'16'                                 1329
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/
         L     @11,@PC00001                                        1330
         ST    @11,@AL00001                                        1330
         LA    @15,@CF00115                                        1330
         ST    @15,@AL00001+4                                      1330
         LA    @15,VEDDSTRU                                        1330
         ST    @15,@AL00001+8                                      1330
         MVI   @AL00001+8,X'80'                                    1330
         L     @15,GDTPRT(,@11)                                    1330
         LA    @01,@AL00001                                        1330
         BALR  @14,@15                                             1330
*           VECOND=LASTCC04;        /*                       @Y30LB38*/
         LA    VECOND,4                                            1331
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       1333
*         DO;                       /*                       @Y30LB38*/
*                                                                  1333
         B     @RC01325                                            1333
@RF01325 DS    0H                                                  1334
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */
*           /*                                               @Y30LB38*/
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */
*           /* IDC0085I TO THE USER.                         @Y30LB38*/
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */
*           /*                                               @Y30LB38*/
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1334
*           IF VERESNCD='4C'X THEN                                 1334
         CLC   VERESNCD(4),@CF01677                                1334
         BNE   @RF01334                                            1334
*             DO;                   /*                       @Y30LB38*/
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/
         L     @11,@PC00001                                        1336
         ST    @11,@AL00001                                        1336
         LA    @04,NAMES                                           1336
         ST    @04,@AL00001+4                                      1336
         LA    @04,VESYSIN                                         1336
         ST    @04,@AFTEMPS+28                                     1336
         LA    @04,@AFTEMPS+28                                     1336
         ST    @04,@AL00001+8                                      1336
         MVI   @AL00001+8,X'80'                                    1336
         L     @15,GDTSFO(,@11)                                    1336
         LA    @01,@AL00001                                        1336
         BALR  @14,@15                                             1336
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @11,VEDDSTRU                                        1337
         MVC   DARGSMOD(3,@11),@CC01387                            1337
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/
         MVI   DARGSENT(@11),X'17'                                 1338
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @04,@PC00016                                        1339
         ST    @04,DARGDBP(,@11)                                   1339
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@11),@CH00565                             1340
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/
         L     @04,VEWTOPTR                                        1341
         ST    @04,DARGRETP(,@11)                                  1341
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/
         MVC   DARGRETL(2,@11),@CH01281                            1342
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/
         LA    @04,3                                               1343
         STH   @04,DARGCNT(,@11)                                   1343
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/
         LA    @15,2                                               1344
         STH   @15,DARGINS(,@11)                                   1344
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/
         MVC   DARGINL(2,@11),@CH00156                             1345
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/
         L     @15,@PC00016+4                                      1346
         ST    @15,DARGDTM(,@11)                                   1346
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/
         STH   @04,DARGINS+8(,@11)                                 1347
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/
         LA    @04,8                                               1348
         STH   @04,DARGINL+8(,@11)                                 1348
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/
         LA    @15,VEJOBNAM                                        1349
         ST    @15,DARGDTM+8(,@11)                                 1349
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/
         LA    @15,4                                               1350
         STH   @15,DARGINS+16(,@11)                                1350
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/
         STH   @04,DARGINL+16(,@11)                                1351
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/
         LA    @04,VESTEPNM                                        1352
         ST    @04,DARGDTM+16(,@11)                                1352
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  1353
         L     @11,@PC00001                                        1353
         ST    @11,@AL00001                                        1353
         LA    @04,@CF00115                                        1353
         ST    @04,@AL00001+4                                      1353
         LA    @04,VEDDSTRU                                        1353
         ST    @04,@AL00001+8                                      1353
         MVI   @AL00001+8,X'80'                                    1353
         L     @15,GDTPRT(,@11)                                    1353
         LA    @01,@AL00001                                        1353
         BALR  @14,@15                                             1353
*               /*****************************************************/
*               /*                                                   */
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */
*               /* CODES                                     @Y30LB38*/
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1354
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/
         MVC   VEWTOLEN(2),@CH01281                                1354
*               VEROUTCD=''B;       /*                       @Y30LB38*/
         XC    VEROUTCD(2),VEROUTCD                                1355
*               VECD1=ON;           /*                       @Y30LB38*/
         OI    VECD1,B'10000000'                                   1356
*               VEDESCCD=''B;       /*                       @Y30LB38*/
         XC    VEDESCCD(2),VEDESCCD                                1357
*               VEDESC3=ON;         /*                       @Y30LB38*/
         OI    VEDESC3,B'00100000'                                 1358
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   1359
*                   VEDESCCD);      /*                       @Y30LB38*/
*                                                                  1359
         L     @11,@PC00001                                        1359
         ST    @11,@AL00001                                        1359
         LA    @04,VEWTOLEN                                        1359
         ST    @04,@AL00001+4                                      1359
         LA    @04,VEWTOPTR                                        1359
         ST    @04,@AL00001+8                                      1359
         LA    @04,VEROUTCD                                        1359
         ST    @04,@AL00001+12                                     1359
         LA    @04,VEDESCCD                                        1359
         ST    @04,@AL00001+16                                     1359
         MVI   @AL00001+16,X'80'                                   1359
         L     @15,GDTWTO(,@11)                                    1359
         LA    @01,@AL00001                                        1359
         BALR  @14,@15                                             1359
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */
*               /*                                           @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1360
*               VELIST=''B;         /*                       @Y30LB38*/
         XC    VELIST(52),VELIST                                   1360
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @11,VEDDSTRU                                        1361
         MVC   DARGSMOD(3,@11),@CC01387                            1361
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/
         MVI   DARGSENT(@11),X'15'                                 1362
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/
         L     @04,@PC00016                                        1363
         ST    @04,DARGDBP(,@11)                                   1363
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/
         MVC   DARGILP(2,@11),@CH00565                             1364
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
*                                                                  1365
         L     @11,@PC00001                                        1365
         ST    @11,@AL00001                                        1365
         LA    @04,@CF00115                                        1365
         ST    @04,@AL00001+4                                      1365
         LA    @04,VEDDSTRU                                        1365
         ST    @04,@AL00001+8                                      1365
         MVI   @AL00001+8,X'80'                                    1365
         L     @15,GDTPRT(,@11)                                    1365
         LA    @01,@AL00001                                        1365
         BALR  @14,@15                                             1365
*               /*****************************************************/
*               /*                                                   */
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */
*               /*                                           @Y30LB38*/
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */
*               /* EJECTED.                                  @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1366
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @11,VERESNCD                                        1366
         ST    @11,@AL00001                                        1366
         LA    @01,@AL00001                                        1366
         BAL   @14,SSCMSG                                          1366
*               VECOND=LASTCC08;    /*                       @Y30LB38*/
         LA    VECOND,8                                            1367
*             END;                  /*                       @Y30LB38*/
*           ELSE                                                   1369
*             DO;                   /*                       @Y30LB38*/
*                                                                  1369
         B     @RC01334                                            1369
@RF01334 DS    0H                                                  1370
*               /*****************************************************/
*               /*                                                   */
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */
*               /*                                           @Y30LB38*/
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1370
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/
         LA    @11,VERESNCD                                        1370
         ST    @11,@AL00001                                        1370
         LA    @01,@AL00001                                        1370
         BAL   @14,SSCMSG                                          1370
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/
         L     @11,VEDDSTRU                                        1371
         MVC   DARGSMOD(3,@11),@CC01387                            1371
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/
         MVI   DARGSENT(@11),X'16'                                 1372
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/
         L     @11,@PC00001                                        1373
         ST    @11,@AL00001                                        1373
         LA    @15,@CF00115                                        1373
         ST    @15,@AL00001+4                                      1373
         LA    @15,VEDDSTRU                                        1373
         ST    @15,@AL00001+8                                      1373
         MVI   @AL00001+8,X'80'                                    1373
         L     @15,GDTPRT(,@11)                                    1373
         LA    @01,@AL00001                                        1373
         BALR  @14,@15                                             1373
*               VECOND=LASTCC04;    /*                       @Y30LB38*/
         LA    VECOND,4                                            1374
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
@RC01334 DS    0H                                                  1377
*     END;                          /*                       @Y30LB38*/
*                                                                  1377
@RC01325 DS    0H                                                  1378
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1378
*   REG14=VERETADR;                 /*                       @Y30LB38*/
@RC01262 LR    REG14,VERETADR                                      1378
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/
         LR    @15,VECOND                                          1379
@EL00016 DS    0H                                                  1379
@EF00016 DS    0H                                                  1379
@ER00016 BR    @14                                                 1379
*   END VOLEXIT;                    /*                       @Y30LB38*/
*                                                                  1381
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1381
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1381
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00017                                    1381
         MVC   @PC00017(8),0(@01)                                  1381
*                                   /*                       @Y30LB39*/
*                                                                  1382
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1382
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1382
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1382
*                                   /*                       @Y30LB39*/
*   DCL                                                            1382
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1383
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1383
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1384
*                                   /*                       @Y30LB39*/
*   DCL                                                            1384
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1385
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1385
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1386
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1386
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1386
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1387
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1387
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1387
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1388
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1388
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1388
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1389
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1389
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1389
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1390
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1390
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1391
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1391
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1391
         L     @11,@PC00001                                        1391
         L     @15,GDTTR2(,@11)                                    1391
         MVC   @TS00001(95),NEWERID2(@15)                          1391
         MVC   OLDERID2(95,@15),@TS00001                           1391
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1392
         MVC   NEWID2(4,@15),@CC01698                              1392
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1393
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1393
         LA    @15,SSDRGLT                                         1393
         ST    @15,SSDLPTR                                         1393
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1394
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1394
         L     @14,@PC00017                                        1394
         L     @14,SSRCODE(,@14)                                   1394
         LTR   @14,@14                                             1394
         BNP   @RF01394                                            1394
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1395
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1396
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1396
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1397
         ST    @03,DARGRETP(,@15)                                  1397
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),SSMODSS0                            1398
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 1399
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1400
         MVC   DARGRETL(2,@15),@CH01705                            1400
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1401
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1401
         ST    @11,@AL00001                                        1401
         LA    @03,@CF00115                                        1401
         ST    @03,@AL00001+4                                      1401
         LA    @03,SSDLPTR                                         1401
         ST    @03,@AL00001+8                                      1401
         MVI   @AL00001+8,X'80'                                    1401
         L     @15,GDTPRT(,@11)                                    1401
         LA    @01,@AL00001                                        1401
         BALR  @14,@15                                             1401
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1402
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1402
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)SSARRAY(ENTRYNUM)=0);   1403
@DL01403 DS    0H                                                  1404
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00219                                   1404
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1405
@DE01403 L     @11,@PC00017                                        1405
         LR    @03,ENTRYNUM                                        1405
         ALR   @03,@03                                             1405
         LH    @03,SSARRAY-2(@03)                                  1405
         CH    @03,SSRHALF(,@11)                                   1405
         BE    @DC01403                                            1405
         SLR   @15,@15                                             1405
         CR    @03,@15                                             1405
         BNE   @DL01403                                            1405
@DC01403 DS    0H                                                  1406
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1406
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1406
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @14,SSDLPTR                                         1407
         MVC   DARGSMOD(3,@14),SSMODSS0                            1407
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@14)                             1408
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @03,@15                                             1409
         BNE   @RF01409                                            1409
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @11,DARGDBP(,@14)                                   1411
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@14),@CH00042                             1412
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1415
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1415
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01394                                            1415
@RF01394 DS    0H                                                  1416
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1416
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @11,SSDLPTR                                         1417
         MVC   DARGSMOD(3,@11),SSMODCM0                            1417
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@11),SSMSGNUM                            1418
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @15,@PC00017+4                                      1419
         ST    @15,DARGDBP(,@11)                                   1419
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@11),@CH00219                             1420
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1421
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1422
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1422
@RC01394 L     @11,@PC00001                                        1422
         ST    @11,@AL00001                                        1422
         LA    @15,@CF00115                                        1422
         ST    @15,@AL00001+4                                      1422
         LA    @15,SSDLPTR                                         1422
         ST    @15,@AL00001+8                                      1422
         MVI   @AL00001+8,X'80'                                    1422
         L     @15,GDTPRT(,@11)                                    1422
         LA    @01,@AL00001                                        1422
         BALR  @14,@15                                             1422
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1423
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1423
         L     @14,@SA00017                                        1423
         LM    @00,@12,@SA00017+8                                  1423
         BR    @14                                                 1423
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCSR01                     /*                       @Y30LB31*/
*                                                                  1425
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSSR )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1425
*       ;                                                          1425
@DATA    DS    0H
@CH00153 DC    H'2'
@CH00430 DC    H'5'
@CH00156 DC    H'6'
@CH00810 DC    H'29'
@CH00044 DC    H'31'
@CH01398 DC    H'45'
@CH01161 DC    H'48'
@CH01281 DC    H'72'
@CH01702 DC    H'74'
@CH01700 DC    H'76'
@CH01703 DC    H'96'
@CH01705 DC    H'120'
@CH01704 DC    H'212'
@CH01699 DC    H'224'
         DS    0F
@AL00296 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01366)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00017 DS    15F
@PC00017 DS    2F
@PC00016 DS    5F
@AL00001 DS    6A
@AFTEMPS DS    8F
IDCSR01  CSECT
         DS    0F
@CF00115 DC    F'0'
@CF00219 DC    F'1'
@CH00219 EQU   @CF00219+2
@CF00042 DC    F'4'
@CH00042 EQU   @CF00042+2
@CF00179 DC    F'8'
@CH00179 EQU   @CF00179+2
@CF00565 DC    F'12'
@CH00565 EQU   @CF00565+2
@CF00473 DC    F'16'
@CF01677 DC    XL4'4C'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
MVRPTR   DS    A
DEFVPTR  DS    A
REASON   DS    F
ECBMSPTR DS    A
RETADDR1 DS    F
VEDDSTRU DS    A
MCLSTPTR DS    A
VEMSGPTR DS    A
VEWTOPTR DS    A
VERESNCD DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
SETUPRC  DS    H
WORKRC   DS    H
STORERC  DS    H
BKOUTRC  DS    H
VEWTOLEN DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
ECBCODE  DS    CL1
         DS    CL3
MSGPARMS DS    CL28
         ORG   MSGPARMS
PRINTHDR DS    CL8
PRINTTBL DS    CL20
         ORG   MSGPARMS+28
SRALLOC  DS    CL39
         ORG   SRALLOC
SRALLHDR DS    CL8
SRALLTBL DS    CL31
         ORG   SRALLOC+39
         DS    CL1
SUNITLST DS    CL12
         ORG   SUNITLST
SUNITCNT DS    FL2
SUNITLEN DS    FL2
SUNITVAL DS    CL8
         ORG   SUNITLST+12
SVOLLST  DS    CL10
         ORG   SVOLLST
SERCNT   DS    FL2
SERLEN   DS    FL2
SERNO    DS    CL6
         ORG   SVOLLST+10
         DS    CL2
SRMDAGL  DS    CL31
         DS    CL1
SREXCLST DS    CL23
         DS    CL1
SVOLBUFF DS    CL232
         ORG   SVOLBUFF
SVOLHDR  DS    CL8
SVOLREC  DS    CL224
         ORG   SVOLBUFF+232
DUMPLIST DS    CL33
MINORNM  DS    CL23
         ORG   MINORNM
RNMLEN   DS    FL1
RNAME    DS    CL22
         ORG   RNAME
RNMSERNO DS    CL6
RNMTRAIL DS    CL16
         ORG   MINORNM+23
STORETBL DS    CL45
         ORG   STORETBL
STOREHDR DS    CL8
SUNITDDN DS    CL8
SUNITUCB DS    AL4
CSN1     DS    CL12
VPREPVOL DS    CL6
MSVIVOL# DS    CL6
@NM00115 DS    BL1
         ORG   @NM00115
CC04FLG  DS    BL1
MOUNTFLG EQU   @NM00115+0
ALLOCFLG EQU   @NM00115+0
RECOVFLG EQU   @NM00115+0
BKOUTFLG EQU   @NM00115+0
VSMISFLG EQU   @NM00115+0
SETVSFLG EQU   @NM00115+0
@NM00116 EQU   @NM00115+0
         ORG   STORETBL+45
         DS    CL3
SR01RVVI DS    CL76
         ORG   SR01RVVI
SRVVIHDR DS    CL8
SRVVITBL DS    CL68
         ORG   SR01RVVI+76
SRCKAGL  DS    CL29
SRMDTYPE DS    CL8
CATDDHLD DS    CL8
         DS    CL3
SRVS1LST DS    CL74
         DS    CL2
SR01MVR  DS    CL96
         ORG   SR01MVR
SRMVRHDR DS    CL8
SRMVRTBL DS    CL88
         ORG   SR01MVR+96
SRVS2LST DS    CL45
RECDISP  DS    BL1
LOCDATA  DS    CL30
IOERRFLG DS    BL1
         ORG   IOERRFLG
ERRORBIT DS    BL1
         ORG   IOERRFLG+1
         DS    CL3
SR01DEFV DS    CL212
         ORG   SR01DEFV
SDEFVHDR DS    CL8
SDEFVLST DS    CL132
SDEFVEHD DS    CL8
SDEFVEXT DS    CL64
         ORG   SR01DEFV+212
VEECB    DS    CL1
VELIST   DS    CL52
VEWTOMSG DS    CL72
VEMCLIST DS    CL48
VEEXLIST DS    CL44
VESYSIN  DS    CL16
         ORG   VESYSIN
VEJOBNAM DS    CL8
VESTEPNM DS    CL8
         ORG   VESYSIN+16
VEROUTCD DS    BL2
         ORG   VEROUTCD
VECD1    DS    BL1
@NM00126 EQU   VEROUTCD+0
         ORG   VEROUTCD+2
VEDESCCD DS    BL2
         ORG   VEDESCCD
@NM00127 DS    BL1
VEDESC3  EQU   VEDESCCD+0
@NM00128 EQU   VEDESCCD+0
         ORG   VEDESCCD+2
VEDMPSTG DS    CL17
SSDRGLT  DS    CL20
         DS    CL2
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSR01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
MVRLEN   DC    AL2(88)
DEFLEN   DC    AL2(64)
MCRLEN   DC    AL2(44)
SSMSGNUM DC    AL1(56)
@CC01433 DC    C'.VIRTUAL.ENQUEUE'
@CC01496 DC    C'.VIRTUAL.RESERVE'
@CC01366 DC    C'SYSZAMS '
@CC01423 DC    C'STORETBL'
@CC01424 DC    C'DARGLIST'
@CC01456 DC    C'SR01RVVI'
@CC01505 DC    C'IDCVS01 '
@CC01509 DC    C'SRVS1LST'
@CC01511 DC    C'JOBCAT  '
@CC01512 DC    C'STEPCAT '
@CC01545 DC    C'IDCVS02 '
@CC01549 DC    C'SRVS2LST'
@CC01578 DC    C'SR01DEFV'
@CC01475 DC    C'SRCKAGL'
@CC01494 DC    C'SRMDAGL'
@CC01537 DC    C'SR01MVR'
@CC01576 DC    C'DEFLIST'
@CC01425 DC    C'VOLREC'
@CC01426 DC    C'ALLAGL'
@CC01670 DC    C'MCLIST'
@CC01354 DC    C'3330V'
@CC01577 DC    C'DEFVE'
@CC01332 EQU   @CC01456
@CC01421 DC    C'SRBG'
@CC01437 DC    C'SRND'
@CC01442 DC    C'SRUP'
@CC01454 DC    C'SRRV'
@CC01455 DC    C'RVVI'
@CC01458 DC    C'SRRD'
@CC01466 DC    C'SRVO'
@CC01472 DC    C'SRAL'
@CC01476 EQU   @CC01475
@CC01481 DC    C'SRSE'
@CC01493 DC    C'SRVP'
@CC01495 EQU   @CC01494
@CC01506 DC    C'SRVT'
@CC01510 DC    C'SRS1'
@CC01517 DC    C'SRWK'
@CC01525 DC    C'SRVL'
@CC01535 DC    C'SRMV'
@CC01538 DC    C'SRSM'
@CC01546 DC    C'SRS2'
@CC01550 DC    C'SRNS'
@CC01562 DC    C'SRSR'
@CC01575 DC    C'SRDE'
@CC01579 DC    C'SRBD'
@CC01584 DC    C'SRBK'
@CC01668 DC    C'VESR'
@CC01671 DC    C'VEBM'
@CC01698 DC    C'SSAA'
@CC01378 EQU   @CC01456
@CC01387 DC    C'CM0'
@CC01402 DC    C'UV0'
@CC01536 DC    C'MVR'
@CB01491 DC    X'0000000000000000'
@CB01465 EQU   @CB01491
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODID    DC    CL4'SR01'
FIXAREA  DS    CL456
         ORG   FIXAREA
@NM00113 DC    256X'00'
@NM00114 DC    200X'00'
         ORG   FIXAREA+456
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
VECOND   EQU   @04
VERETADR EQU   @06
MCRTEPTR EQU   @03
DEACTRC  EQU   @04
VS2RTNRC EQU   @06
MVRRTNRC EQU   @06
VLABLRC  EQU   @04
VTOCKRC  EQU   @04
VPREPRC  EQU   @04
SECCKRC  EQU   @06
ALLOCRC  EQU   @04
VOLCKRC  EQU   @03
RVRTNRC  EQU   @04
RETADDR3 EQU   @11
RETADDR2 EQU   @07
DEFVEPTR EQU   @03
BASEVPTR EQU   @05
CMMSGPTR EQU   @02
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG8     EQU   @08
REG9     EQU   @09
REG10    EQU   @10
RTNREG   EQU   @15
REG14    EQU   @14
DEFVR1   EQU   @01
MCR1     EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMNEWVOL EQU   CMMSG+8
CMNUMCRT EQU   CMMSG+15
CMCSN1   EQU   CMMSG+16
CMCSN2   EQU   CMMSG+28
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDWAIT   EQU   MDFLAGS
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLVOL  EQU   EXCLAGL+16
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSUCBPTR EQU   VS2AGL+8
VSVOLPTR EQU   VS2AGL+20
VSLABOPT EQU   VS2AGL+28
VSVOLSER EQU   VSLABOPT
VSVOLUME EQU   VS2AGL+29
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS2RES   EQU   VS2RESOP
VSDDNAME EQU   VS2AGL+37
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSCATP   EQU   VS1AGL+32
VSCATDDP EQU   VS1AGL+40
VSPSWDP  EQU   VS1AGL+44
VSPFILEP EQU   VS1AGL+48
VSSECOPT EQU   VS1AGL+68
VSNOVSAM EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSUCAT   EQU   VSRETURN
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00065 EQU   SV82LIST+4
SV82DCBP EQU   @NM00065
@NM00066 EQU   SV82LIST+12
SV82WRKP EQU   @NM00066
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
VOL      EQU   0
VOLLEN   EQU   VOL
VOLVAL   EQU   VOL+1
NSER     EQU   0
NSERVAL  EQU   NSER+1
EJECT    EQU   0
REC      EQU   0
NREC     EQU   0
LOC      EQU   0
LOCVAL   EQU   LOC+1
CAT      EQU   0
CATNM    EQU   0
CATNMPLN EQU   CATNM
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATNMVAL EQU   CATNM+21
CATDN    EQU   0
CATDNVAL EQU   CATDN+1
FILE     EQU   0
FILEVAL  EQU   FILE+1
PFILE    EQU   0
@NM00084 EQU   PFILE+2
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASRONLY EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASNCOPY EQU   BASEV+62
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASRECOV EQU   BASEV+174
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSVOL  EQU   RVVSPEC
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVRFLAGA EQU   MVR+8
MVRFLBAS EQU   MVRFLAGA
MVRFLLAB EQU   MVRFLAGA
MVRSLMIS EQU   MVRFLAGA+1
MVRCLMIS EQU   MVRFLAGA+1
MVRBVOL  EQU   MVR+12
MVRLABEL EQU   MVR+76
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVRNM  EQU   DEFVFLG
DEFVDACT EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVNVOL EQU   DEFLIST+16
DEFVDATA EQU   DEFLIST+56
DEFVVEXT EQU   DEFLIST+128
DEFVE    EQU   0
DEFLNGTH EQU   DEFVE
DEFLABEL EQU   DEFVE+49
DEFFLAGA EQU   DEFVE+55
DEFPVLAB EQU   DEFFLAGA
DEFFLAGB EQU   DEFVE+56
DEFSETFL EQU   DEFFLAGB
DEFCRCVY EQU   DEFSETFL
DEFRECFL EQU   DEFFLAGB+1
DEFLAMIS EQU   DEFRECFL
DEFTYPFL EQU   DEFFLAGB+2
DEFDUP   EQU   DEFTYPFL
DEFNULFL EQU   DEFFLAGB+3
MCRTE    EQU   0
MCRLNGTH EQU   MCRTE
MCRLOC   EQU   MCRTE+4
MCRFLAGA EQU   MCRTE+34
MCRSPLOC EQU   MCRFLAGA
MCRFLAGB EQU   MCRTE+36
MCRTYPE  EQU   MCRFLAGB+2
MCRREC   EQU   MCRTYPE
MCLIST   EQU   0
MCRTFLG  EQU   MCLIST+6
MCRTTRAN EQU   MCRTFLG
MCRTLIB  EQU   MCLIST+7
MCRTCSN  EQU   MCLIST+24
MCRTVEXT EQU   MCLIST+44
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEJEC    EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
VECSN1   EQU   0
VEVOLUME EQU   0
VEVVIERR EQU   0
VERECFLG EQU   0
VEVOLLOC EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00129 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
MCRTECB  EQU   MCLIST+40
MCRTASID EQU   MCLIST+38
MCRTRES4 EQU   MCLIST+36
MCRTRES3 EQU   MCLIST+16
MCRTRES2 EQU   MCLIST+8
MCRTLD   EQU   MCRTLIB
@NM00125 EQU   MCRTLIB
@NM00124 EQU   MCRTFLG
MCRTSCT  EQU   MCRTFLG
@NM00123 EQU   MCRTFLG
MCRTRES1 EQU   MCLIST+5
MCRTOPCD EQU   MCLIST+4
MCRTLEN  EQU   MCLIST
@NM00122 EQU   MCRTE+40
@NM00121 EQU   MCRFLAGB+3
@NM00120 EQU   MCRTYPE
@NM00119 EQU   MCRFLAGB+1
@NM00118 EQU   MCRFLAGB
MCRBLNK1 EQU   MCRTE+35
@NM00117 EQU   MCRFLAGA
@NM00112 EQU   DEFVE+60
@NM00111 EQU   DEFNULFL
DEFNEXPD EQU   DEFNULFL
DEFNDESC EQU   DEFNULFL
DEFNGRP  EQU   DEFNULFL
@NM00110 EQU   DEFTYPFL
DEFCOPY  EQU   DEFTYPFL
DEFRSTD  EQU   DEFTYPFL
DEFGENUS EQU   DEFTYPFL
@NM00109 EQU   DEFRECFL
DEFCREAT EQU   DEFRECFL
DEFICOPY EQU   DEFRECFL
@NM00108 EQU   DEFSETFL
DEFSRCVY EQU   DEFSETFL
@NM00107 EQU   DEFFLAGA
DEFPBKUP EQU   DEFFLAGA
DEFPTO   EQU   DEFFLAGA
DEFPDESC EQU   DEFFLAGA
DEFPGRO  EQU   DEFFLAGA
DEFPFOR  EQU   DEFFLAGA
DEFBKUPN EQU   DEFVE+48
DEFFOR   EQU   DEFVE+46
DEFTO    EQU   DEFVE+42
DEFDESCR EQU   DEFVE+12
DEFGROUP EQU   DEFVE+4
DEFTLAB  EQU   DEFVDATA+71
DEFR60   EQU   DEFVDATA+43
DEFOWNID EQU   DEFVDATA+29
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00106 EQU   DEFLIST+48
DEFVCSN2 EQU   DEFLIST+36
DEFVCSN1 EQU   DEFLIST+24
@NM00105 EQU   DEFLIST+22
@NM00104 EQU   DEFLIST+15
@NM00103 EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
@NM00102 EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVSEC  EQU   DEFVVFLG
@NM00101 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00100 EQU   DEFVLIB
DEFVACT  EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
DEFVCR   EQU   DEFVFLG
@NM00099 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00098 EQU   MVR+82
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRTO    EQU   MVR+58
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00097 EQU   MVRFLAGA+2
MVRCICPY EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00096 EQU   MVRCODE+1
MVROPCD  EQU   MVRCODE
@NM00095 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00094 EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
@NM00093 EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
@NM00092 EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00091 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00090 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00089 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00088 EQU   RVVOPCOD+1
@NM00087 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00086 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00085 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
PFILEVAL EQU   @NM00084+1
PFILELEN EQU   @NM00084
PFILECNT EQU   PFILE
FILELEN  EQU   FILE
CATDNLEN EQU   CATDN
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
LOCLEN   EQU   LOC
NSERLEN  EQU   NSER
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00083 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00082 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00081 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00080 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00079 EQU   VSDSCR+5
@NM00078 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00077 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00076 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00075 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00074 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00073 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00072 EQU   VSDVTOC
@NM00071 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00070 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00069 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00068 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00067 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00064 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00063 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00062 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00061 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00060 EQU   RCTAGL+10
@NM00059 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00058 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
@NM00057 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00056 EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00055 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00054 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSACBP   EQU   VS1AGL+36
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSHEAD   EQU   VS1AGL
@NM00053 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
@NM00052 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
@NM00051 EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00050 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00044 EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
@NM00042 EQU   CMMSG+14
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00465 EQU   @RC00444
@RF00520 EQU   @RC00508
@RC00518 EQU   @RC00508
@RC00538 EQU   @RC00508
@RF00846 EQU   @RC00843
@RF00929 EQU   @RC00925
@RC01098 EQU   @RC01097
@RF01409 EQU   @RC01394
@PB00017 EQU   @EL00001
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCSR01,(C'PLS1729',0603,76100)

         TITLE '*************** IDCVS03:  VOLUME SERVICE ROUTINE *******
               *********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCVS03  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCVS03   78.165'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @02,4095(,@12)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@02                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                            @Z40LB35*/
*   OLDERID2=NEWERID2;                                             0269
         L     @04,@PC00001                                        0269
         L     @15,GDTTR2(,@04)                                    0269
         MVC   @TS00001(95),NEWERID2(@15)                          0269
         MVC   OLDERID2(95,@15),@TS00001                           0269
*   NEWID2='VS03';                  /*                       @Z40LB35
*                                                            @Z40LB35*/
         MVC   NEWID2(4,@15),@CC01112                              0270
*   IF GDTDBG=NULLPTR THEN                                         0271
         L     @04,GDTDBG(,@04)                                    0271
         LTR   @04,@04                                             0271
         BZ    @RT00271                                            0271
*     ;                                                            0272
*   ELSE                                                           0273
*     CALL IDCDB010(GDTTBL,'VS03'); /*                       @Z40LB35
*                                                            @Z40LB35*/
         L     @04,@PC00001                                        0273
         ST    @04,@AL00001                                        0273
         LA    @15,@CC01112                                        0273
         ST    @15,@AL00001+4                                      0273
         MVI   @AL00001+4,X'80'                                    0273
         L     @15,GDTDBG(,@04)                                    0273
         LA    @01,@AL00001                                        0273
         BALR  @14,@15                                             0273
*   DDSTRU=ADDR(PRINTARG);          /*                       @Z40LB35
*                                                            @Z40LB35*/
@RT00271 LA    @04,PRINTARG                                        0274
         ST    @04,DDSTRU                                          0274
*   TESTRC=0;                       /*                       @Z40LB35
*                                                            @Z40LB35*/
         SLR   @04,@04                                             0275
         STH   @04,TESTRC                                          0275
*   FINALRC=0;                      /*                       @Z40LB35
*                                                            @Z40LB35*/
         STH   @04,FINALRC                                         0276
*   TRACKPTR=NULLPTR;               /*                       @Z40LB35
*                                                            @Z40LB35*/
*                                                                  0277
         ST    @04,TRACKPTR                                        0277
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE REQUEST NAME INTO CALLER'S PARMLIST              @Z40LB35*/
*   /* THIS WILL AID TO DETERMINE IF LIST WAS PASSED         @Z40LB35*/
*   /* IF A DUMP IS BEING READ.                              @Z40LB35*/
*   /* IF THE FIRST 8 CHAR CONTAIN THE REQUEST NAME          @Z40LB35*/
*   /* WHICH IS "SELECTDS"                                   @Z40LB35*/
*   /* IT INDICATES THAT THIS MODULE WAS CALLED.             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0278
*   VS3HEAD=REQUEST;                /*                       @Z40LB35
*                                                            @Z40LB35*/
         L     @04,@PC00001+8                                      0278
         L     @15,@PC00001+4                                      0278
         MVC   VS3HEAD(8,@04),REQUEST(@15)                         0278
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS PORTION OF THE MODULE IS CONSIDERED              @Z40LB35*/
*   /* THE CONTROLLER AND DETERMINES WHICH SERVICE           @Z40LB35*/
*   /* THE CALLER HAS REQUESTED                              @Z40LB35*/
*   /* AND DIRECTS CONTROL TO PROPER SUBROUTINE.             @Z40LB35*/
*   /* IF THE REQUEST IS INVALID, UABORT IS ISSUED           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   IF REQUEST=SELECTDS THEN        /*                       @Z40LB35*/
         CLC   REQUEST(8,@15),SELECTDS                             0279
         BNE   @RF00279                                            0279
*     DO;                           /*                       @Z40LB35*/
*       CALL INITIAL;               /*                       @Z40LB35*/
         BAL   @14,INITIAL                                         0281
*       RESPECIFY                                                  0282
*         RTNREG RSTD;                                             0282
*       TESTRC=RTNREG;                                             0283
         STH   RTNREG,TESTRC                                       0283
*       RESPECIFY                                                  0284
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/
         LH    @04,TESTRC                                          0285
         LTR   @04,@04                                             0285
         BZ    @RF00285                                            0285
*         FINALRC=TESTRC;           /*                       @Z40LB35*/
         STH   @04,FINALRC                                         0286
*     END;                          /*                       @Z40LB35*/
*   ELSE                            /*                       @Z40LB35*/
*     DO;                                                          0288
         B     @RC00279                                            0288
@RF00279 DS    0H                                                  0289
*       RESPECIFY                                                  0289
*        (REG13,                                                   0289
*         REG14,                                                   0289
*         REG15) RSTD;                                             0289
*       REG15=40;                                                  0290
         LA    REG15,40                                            0290
*       REG14=GDTABT;                                              0291
         L     @04,@PC00001                                        0291
         L     REG14,GDTABT(,@04)                                  0291
*       REG13=GDTABH;                                              0292
         L     REG13,GDTABH(,@04)                                  0292
*       GEN(BR    REG14);                                          0293
         BR    REG14
*       RESPECIFY                                                  0294
*        (REG13,                                                   0294
*         REG14,                                                   0294
*         REG15) UNRSTD;                                           0294
*     END;                          /*                       @Z40LB35*/
*                                                                  0295
*   /*****************************************************************/
*   /*                                                               */
*   /* AFTER THE VTOC HAS BEEN OPENED AND                    @Z40LB35*/
*   /* STORAGE HAS BEEN OBTAINED, THE VTOC IS                @Z40LB35*/
*   /* PROCESSED TO FIND DSNS THAT MEET THE                  @Z40LB35*/
*   /* CRITERIA.                                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*   IF FINALRC=0 THEN               /*                       @Z40LB35*/
@RC00279 LH    @04,FINALRC                                         0296
         LTR   @04,@04                                             0296
         BNZ   @RF00296                                            0296
*     DO;                           /*                       @Z40LB35*/
*       CALL SELECTOR;              /*                       @Z40LB35*/
         BAL   @14,SELECTOR                                        0298
*       RESPECIFY                                                  0299
*         RTNREG RSTD;                                             0299
*       TESTRC=RTNREG;                                             0300
         STH   RTNREG,TESTRC                                       0300
*       RESPECIFY                                                  0301
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0302
         LTR   @10,@10                                             0302
         BZ    @RF00302                                            0302
*         FINALRC=TESTRC;           /*                       @Z40LB35*/
         STH   @10,FINALRC                                         0303
*     END;                          /*                       @Z40LB35*/
*                                                                  0304
@RF00302 DS    0H                                                  0305
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP IS CALLED TO CLOSE THE VTOC AND               @Z40LB35*/
*   /* FREE THE TRACK BUFFER.                                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0305
*   CALL CLEANUP;                   /*                       @Z40LB35*/
@RF00296 BAL   @14,CLEANUP                                         0305
*   RESPECIFY                                                      0306
*     RTNREG RSTD;                                                 0306
*   TESTRC=RTNREG;                                                 0307
         STH   RTNREG,TESTRC                                       0307
*   RESPECIFY                                                      0308
*     RTNREG UNRSTD;                /*                       @Z40LB35*/
*                                                                  0308
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE FINAL RETURN CODE IS SET.                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   IF FINALRC=0&TESTRC^=0 THEN     /*                       @Z40LB35*/
         SLR   @10,@10                                             0309
         CH    @10,FINALRC                                         0309
         BNE   @RF00309                                            0309
         LH    @03,TESTRC                                          0309
         CR    @03,@10                                             0309
         BE    @RF00309                                            0309
*     FINALRC=TESTRC;               /*                       @Z40LB35
*                                                            @Z40LB35*/
*                                                                  0310
         STH   @03,FINALRC                                         0310
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE IDCVS03 WILL EXIT. BEFORE EXIT, THE              @Z40LB35*/
*   /* DUMP POINT FOR A FULL REGION DUMP OF 'VS3X'           @Z40LB35*/
*   /* CAN BE ISSUED.                                        @Z40LB35*/
*   /* THE RETURN CODE SAVED IN FINALRC IS RETURNED.         @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0311
*   IF GDTDBG=NULLPTR THEN                                         0311
@RF00309 L     @10,@PC00001                                        0311
         L     @10,GDTDBG(,@10)                                    0311
         LTR   @10,@10                                             0311
         BZ    @RT00311                                            0311
*     ;                                                            0312
*   ELSE                                                           0313
*     CALL IDCDB010(GDTTBL,'VS3X'); /*                       @Z40LB35*/
         L     @10,@PC00001                                        0313
         ST    @10,@AL00001                                        0313
         LA    @03,@CC01290                                        0313
         ST    @03,@AL00001+4                                      0313
         MVI   @AL00001+4,X'80'                                    0313
         L     @15,GDTDBG(,@10)                                    0313
         LA    @01,@AL00001                                        0313
         BALR  @14,@15                                             0313
*   CALL IDCSAEP0(GDTTBL,MODID,FINALRC);                           0314
*                                                                  0314
@RT00311 L     @10,@PC00001                                        0314
         ST    @10,@AL00001                                        0314
         LA    @03,MODID                                           0314
         ST    @03,@AL00001+4                                      0314
         LA    @03,FINALRC                                         0314
         ST    @03,@AL00001+8                                      0314
         MVI   @AL00001+8,X'80'                                    0314
         L     @15,GDTEPL(,@10)                                    0314
         LA    @01,@AL00001                                        0314
         BALR  @14,@15                                             0314
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*                                                                  0315
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - INITIAL                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  CONTROL THE INITIALIZATION PROCESS BY        @Z40LB35*/
*/*             CALLING THE SUBORDINATE PROCEDURES OF        @Z40LB35*/
*/*             OPENVTOC AND GETBLK.                         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     NONE                                         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN OPENVTOC PROC      @Z40LB35*/
*/*                           4, ERROR IN GETBLK PROC        @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0315
*                                   /*                       @Z40LB35*/
*INITIAL:                                                          0315
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0315
@EL00001 L     @13,4(,@13)                                         0315
@EF00001 L     @00,@SIZDATD                                        0315
         LR    @01,@11                                             0315
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0315
         BR    @14                                                 0315
INITIAL  STM   @14,@04,@SA00002                                    0315
         STM   @06,@08,@SA00002+28                                 0315
         STM   @10,@12,@SA00002+40                                 0315
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSIT' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0316
*   OLDERID2=NEWERID2;                                             0316
         L     @10,@PC00001                                        0316
         L     @10,GDTTR2(,@10)                                    0316
         MVC   @TS00001(95),NEWERID2(@10)                          0316
         MVC   OLDERID2(95,@10),@TS00001                           0316
*   NEWID2='VSIT';                  /*                       @Z40LB35*/
*                                                                  0317
         MVC   NEWID2(4,@10),@CC01294                              0317
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL OPENVTOC TO PREPARE FOR I/O TO VTOC              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0318
*   CALL OPENVTOC;                  /*                       @Z40LB35*/
         BAL   @14,OPENVTOC                                        0318
*   RESPECIFY                                                      0319
*     RTNREG RSTD;                                                 0319
*   TESTRC=RTNREG;                                                 0320
         STH   RTNREG,TESTRC                                       0320
*   RESPECIFY                                                      0321
*     RTNREG UNRSTD;                /*                       @Z40LB35*/
*                                                                  0321
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE OPENVTOC PROCEDURE WAS SUCCESSFUL,             @Z40LB35*/
*   /* GETBLK IS CALLED TO OBTAIN STORAGE.                   @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0322
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0322
         LTR   @10,@10                                             0322
         BNZ   @RF00322                                            0322
*     DO;                           /*                       @Z40LB35*/
*       CALL GETBLK;                /*                       @Z40LB35*/
         BAL   @14,GETBLK                                          0324
*       RESPECIFY                                                  0325
*         RTNREG RSTD;                                             0325
*       TESTRC=RTNREG;                                             0326
         STH   RTNREG,TESTRC                                       0326
*       RESPECIFY                                                  0327
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0328
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE CONTROL IS RETURNED TO IDCVS03 WITH              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00322 LH    @15,TESTRC                                          0329
         L     @14,@SA00002                                        0329
         LM    @00,@04,@SA00002+8                                  0329
         LM    @06,@08,@SA00002+28                                 0329
         LM    @10,@12,@SA00002+40                                 0329
         BR    @14                                                 0329
*   END INITIAL;                    /*                       @Z40LB35*/
*                                                                  0331
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - GETBLK                                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE OBTAINS STORAGE FOR THE TRACK @Z40LB35*/
*/*             BUFFER AND THE VSDBLOCK WHICH IS RETURNED    @Z40LB35*/
*/*             TO THE CALLER OF IDCVS03.                    @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*             IDC22011I ISSUED IF UNABLE TO OBTAIN STORAGE @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS4VTOCE FROM THE IECSDSL1 FMT 4 DSCB        @Z40LB35*/
*/*             DS1IDFMT ('F1') FROM THE IECSDSL1 FMT 1 DSCB @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    TRACKPTR (POINTER TO I/O BUFFER)             @Z40LB35*/
*/*             VSDPTR   (POINTER TO THE VSDBLOCK)           @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN UGSPACE            @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0331
*                                   /*                       @Z40LB35*/
*GETBLK:                                                           0331
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0331
GETBLK   STM   @14,@04,@SA00003                                    0331
         STM   @06,@08,@SA00003+28                                 0331
         STM   @10,@12,@SA00003+40                                 0331
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0332
*   DCL                                                            0332
*     1 DS4EXTS BASED(ADDR(DS4VTOCE)),/*                     @Z40LB35*/
*      2 DS4BEGCY FIXED(15),        /* BEGIN CYL OF VTOC     @Z40LB35*/
*      2 DS4BEGTK FIXED(15),        /* BEGIN TRK OF VTOC     @Z40LB35*/
*      2 DS4ENDCY FIXED(15),        /* END CYL OF VTOC       @Z40LB35*/
*      2 DS4ENDTK FIXED(15);        /* END TRK OF VTOC       @Z40LB35*/
*   DCL                                                            0333
*     FMT1DSCB FIXED(31);           /* DO LOOP COUNTER       @Z40LB35*/
*   DCL                                                            0334
*     VSDSIZE FIXED(31);            /* SIZE STORAGE FOR BLOCK      0334
*                                                            @Z40LB35*/
*                                                                  0334
*   /*****************************************************************/
*   /*                                                               */
*   /* STATIC CONSTANTS                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   DCL                                                            0335
*     FMT4KEY FIXED(8) UNSIGNED INITIAL(44);/*               @Z40LB35
*                                      LEN OF FMT4 DSCB KEY  @Z40LB35*/
*                                                                  0336
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSGB' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*   OLDERID2=NEWERID2;                                             0336
         L     @10,@PC00001                                        0336
         L     @08,GDTTR2(,@10)                                    0336
         MVC   @TS00001(95),NEWERID2(@08)                          0336
         MVC   OLDERID2(95,@08),@TS00001                           0336
*   NEWID2='VSGB';                  /*                       @Z40LB35*/
*                                                                  0337
         MVC   NEWID2(4,@08),@CC01308                              0337
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UGSPACE TO OBTAIN CORE FOR VTOC TRACK           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   CALL IDCSAGS0(GDTTBL,TRACKLEN,TRACKPTR,SETZERO);/*       @Z40LB35*/
         ST    @10,@AL00001                                        0338
         LA    @08,TRACKLEN                                        0338
         ST    @08,@AL00001+4                                      0338
         LA    @08,TRACKPTR                                        0338
         ST    @08,@AL00001+8                                      0338
         LA    @08,SETZERO                                         0338
         ST    @08,@AL00001+12                                     0338
         MVI   @AL00001+12,X'80'                                   0338
         L     @15,GDTGSP(,@10)                                    0338
         LA    @01,@AL00001                                        0338
         BALR  @14,@15                                             0338
*   RESPECIFY                                                      0339
*     RTNREG RSTD;                                                 0339
*   TESTRC=RTNREG;                                                 0340
         STH   RTNREG,TESTRC                                       0340
*   RESPECIFY                                                      0341
*     RTNREG UNRSTD;                /*                       @Z40LB35*/
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* IF UGSPACE FAILED, BUILD DARGLIST TO ISSUE            @Z40LB35*/
*   /* MESSAGE "IDC2011I FUNCTION CANNOT BE                  @Z40LB35*/
*   /* EXECUTED. INSUFFICIENT MAIN STOARAGE"                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   IF TESTRC^=0 THEN               /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0342
         LTR   @10,@10                                             0342
         BZ    @RF00342                                            0342
*     DO;                           /*                       @Z40LB35*/
*       DARGLIST=''B;               /*                       @Z40LB35*/
         L     @10,DDSTRU                                          0344
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0344
*       DARGSMOD=IDCTSUV0;          /*                       @Z40LB35*/
         MVC   DARGSMOD(3,@10),@CC01119                            0345
*       DARGSENT=MSG2011A;          /*                       @Z40LB35*/
         MVI   DARGSENT(@10),X'0C'                                 0346
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB35*/
         L     @10,@PC00001                                        0347
         ST    @10,@AL00001                                        0347
         LA    @08,@CF00115                                        0347
         ST    @08,@AL00001+4                                      0347
         LA    @08,DDSTRU                                          0347
         ST    @08,@AL00001+8                                      0347
         MVI   @AL00001+8,X'80'                                    0347
         L     @15,GDTPRT(,@10)                                    0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*     END;                          /*                       @Z40LB35*/
*                                                                  0348
*   /*****************************************************************/
*   /*                                                               */
*   /* IF TRACK BUFFER OBTAINED OK, READ THE ENTIRE          @Z40LB35*/
*   /* VTOC TO DETERMINE HOW MANY FMT1 DSCBS                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   ELSE                            /*                       @Z40LB35*/
*     DO;                           /*                       @Z40LB35*/
         B     @RC00342                                            0349
@RF00342 DS    0H                                                  0350
*       CALL TRKREAD;               /*                       @Z40LB35*/
         BAL   @14,TRKREAD                                         0350
*       RESPECIFY                                                  0351
*         RTNREG RSTD;                                             0351
*       TESTRC=RTNREG;                                             0352
         STH   RTNREG,TESTRC                                       0352
*       RESPECIFY                                                  0353
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0353
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FIRST VTOC TRACK WAS READ SUCCESSFUL       @Z40LB35*/
*       /* THEN INTERROGATE THE FORMAT 4 DSCB TO             @Z40LB35*/
*       /* DETERMINE THE DEB EXTENTS OF THE VTOC             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0354
*       IF TESTRC=0 THEN            /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0354
         SLR   @08,@08                                             0354
         CR    @10,@08                                             0354
         BNE   @RF00354                                            0354
*         DO;                       /*                       @Z40LB35*/
*           FMT1CTR=0;              /*                       @Z40LB35*/
         SLR   FMT1CTR,FMT1CTR                                     0356
*           FMT0CTR=0;              /*                       @Z40LB35*/
         ST    @08,FMT0CTR                                         0357
*           F4PTR=TRACKPTR+FMT4KEY; /*                       @Z40LB35*/
         L     @10,TRACKPTR                                        0358
         SLR   F4PTR,F4PTR                                         0358
         IC    F4PTR,FMT4KEY                                       0358
         ALR   F4PTR,@10                                           0358
*           F1PTR=TRACKPTR;         /*                       @Z40LB35*/
*                                                                  0359
         LR    F1PTR,@10                                           0359
*           /*********************************************************/
*           /*                                                       */
*           /* THE FOLLOWING DO GROUP WILL READ THE VTOC     @Z40LB35*/
*           /* AND COUNT UP THE NUMBER OF FMT 1 DSCBS        @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0360
*           DO WHILE TESTRC=0;      /*                       @Z40LB35*/
         B     @DE00360                                            0360
@DL00360 DS    0H                                                  0361
*             DO FMT1DSCB=1 TO VTOCTRK;/*                    @Z40LB35*/
         LA    FMT1DSCB,1                                          0361
         B     @DE00361                                            0361
@DL00361 DS    0H                                                  0362
*               IF DS1FMTID=FMT1ID THEN/*                    @Z40LB35*/
         CLC   DS1FMTID(1,F1PTR),FMT1ID                            0362
         BNE   @RF00362                                            0362
*                 FMT1CTR=FMT1CTR+1;/*                       @Z40LB35*/
         AL    FMT1CTR,@CF00219                                    0363
*               IF DS1FMTID=FMT0ID THEN/*                    @Z40LB35*/
@RF00362 CLC   DS1FMTID(1,F1PTR),FMT0ID                            0364
         BNE   @RF00364                                            0364
*                 FMT0CTR=FMT0CTR+1;/*                       @Z40LB35*/
         LA    @10,1                                               0365
         AL    @10,FMT0CTR                                         0365
         ST    @10,FMT0CTR                                         0365
*               F1PTR=F1PTR+LENGTH(IECSDSF1);/*              @Z40LB35*/
@RF00364 AL    F1PTR,@CF01203                                      0366
*             END;                  /*                       @Z40LB35*/
         AL    FMT1DSCB,@CF00219                                   0367
@DE00361 CH    FMT1DSCB,VTOCTRK                                    0367
         BNH   @DL00361                                            0367
*             CALL TRKREAD;         /*                       @Z40LB35*/
         BAL   @14,TRKREAD                                         0368
*             RESPECIFY                                            0369
*               RTNREG RSTD;                                       0369
*             TESTRC=RTNREG;                                       0370
         STH   RTNREG,TESTRC                                       0370
*             RESPECIFY                                            0371
*               RTNREG UNRSTD;      /*                       @Z40LB35*/
*             F1PTR=TRACKPTR;       /*                       @Z40LB35*/
         L     F1PTR,TRACKPTR                                      0372
*           END;                    /*                       @Z40LB35*/
@DE00360 LH    @10,TESTRC                                          0373
         LTR   @10,@10                                             0373
         BZ    @DL00360                                            0373
*         END;                      /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0375
@RF00354 DS    0H                                                  0376
*   /*****************************************************************/
*   /*                                                               */
*   /* THE EOF RETURN CODE IS TRANSLATED TO                  @Z40LB35*/
*   /* SUCCESSFUL.                                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0376
*   IF TESTRC=EOF THEN              /*                       @Z40LB35*/
@RC00342 CLC   TESTRC(2),EOF                                       0376
         BNE   @RF00376                                            0376
*     TESTRC=0;                     /*                       @Z40LB35*/
*                                                                  0377
         SLR   @10,@10                                             0377
         STH   @10,TESTRC                                          0377
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDED THE OPERATION WAS SUCCESSFUL THUS            @Z40LB35*/
*   /* FAR, THE UGPOOL IS CALLED TO OBTAIN THE               @Z40LB35*/
*   /* VSDBLOCK THAT IS RETURNED TO CALLER OF THIS           @Z40LB35*/
*   /* MODULE. THE POOL ID IS PROVIDED BY CALLER             @Z40LB35*/
*   /* AND THE CALLER WILL FREE THE CORE.                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0378
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
@RF00376 LH    @10,TESTRC                                          0378
         LTR   @10,@10                                             0378
         BNZ   @RF00378                                            0378
*     DO;                           /*                       @Z40LB35*/
*       VSDSIZE=(FMT1CTR*LENGTH(VSDARRAY))+LENGTH(VSDBLOCK);       0380
         LR    @10,FMT1CTR                                         0380
         MH    @10,@CH01471                                        0380
         AL    @10,@CF00506                                        0380
         ST    @10,VSDSIZE                                         0380
*       CALL IDCSAGP0(GDTTBL,VSDSIZE,VSDPTR,VS3POOL,SETZERO);/*    0381
*                                                            @Z40LB35*/
         L     @10,@PC00001                                        0381
         ST    @10,@AL00001                                        0381
         LA    @08,VSDSIZE                                         0381
         ST    @08,@AL00001+4                                      0381
         L     @08,@PC00001+8                                      0381
         L     @04,VS3LISTP(,@08)                                  0381
         ST    @04,@AL00001+8                                      0381
         LA    @08,VS3POOL(,@08)                                   0381
         ST    @08,@AL00001+12                                     0381
         LA    @08,SETZERO                                         0381
         ST    @08,@AL00001+16                                     0381
         MVI   @AL00001+16,X'80'                                   0381
         L     @15,GDTGPL(,@10)                                    0381
         LA    @01,@AL00001                                        0381
         BALR  @14,@15                                             0381
*       RESPECIFY                                                  0382
*         RTNREG RSTD;                                             0382
*       TESTRC=RTNREG;                                             0383
         STH   RTNREG,TESTRC                                       0383
*       RESPECIFY                                                  0384
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0384
*       /*************************************************************/
*       /*                                                           */
*       /* IF UGPOOL FAILED, BUILD DARGLIST TO ISSUE         @Z40LB35*/
*       /* MESSAGE "IDC2011I FUNCTION CANNOT BE              @Z40LB35*/
*       /* EXECUTED. INSUFFICIENT MAIN STOARAGE"             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0385
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0385
         LTR   @10,@10                                             0385
         BZ    @RF00385                                            0385
*         DO;                       /*                       @Z40LB35*/
*           DARGLIST=''B;           /*                       @Z40LB35*/
         L     @10,DDSTRU                                          0387
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0387
*           DARGSMOD=IDCTSUV0;      /*                       @Z40LB35*/
         MVC   DARGSMOD(3,@10),@CC01119                            0388
*           DARGSENT=MSG2011A;      /*                       @Z40LB35*/
         MVI   DARGSENT(@10),X'0C'                                 0389
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB35*/
         L     @10,@PC00001                                        0390
         ST    @10,@AL00001                                        0390
         LA    @08,@CF00115                                        0390
         ST    @08,@AL00001+4                                      0390
         LA    @08,DDSTRU                                          0390
         ST    @08,@AL00001+8                                      0390
         MVI   @AL00001+8,X'80'                                    0390
         L     @15,GDTPRT(,@10)                                    0390
         LA    @01,@AL00001                                        0390
         BALR  @14,@15                                             0390
*         END;                      /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0392
@RF00385 DS    0H                                                  0393
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CALLER WITH THE CODE           @Z40LB35*/
*   /* SAVED IN TESTRC.                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00378 LH    @15,TESTRC                                          0393
         L     @14,@SA00003                                        0393
         LM    @00,@04,@SA00003+8                                  0393
         LM    @06,@08,@SA00003+28                                 0393
         LM    @10,@12,@SA00003+40                                 0393
         BR    @14                                                 0393
*   END GETBLK;                     /*                       @Z40LB35*/
*                                                                  0395
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - TRKREAD                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE READS THE NEXT TRACK FROM     @Z40LB35*/
*/*             THE VTOC OR RETURNS AN EOF CONDITION IF      @Z40LB35*/
*/*             THE VTOC IS ENTIRELY PROCESSED.              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1DSNAM FROM THE IECSDSL1 FMT 1 DSCB        @Z40LB35*/
*/*             BEGCCHH FROM IOBLOCK                         @Z40LB35*/
*/*             ENDCCHH FROM IOBLOCK                         @Z40LB35*/
*/*             LASTCCHH FROM IOBLOCK                        @Z40LB35*/
*/*             HH FROM IOBLOCK                              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    HH OF IOBLOCK                                @Z40LB35*/
*/*             CC OF IOBLOCK                                @Z40LB35*/
*/*             LASTCCHH OF IOBLOCK                          @Z40LB35*/
*/*             EXGCTLBK OF EXGAGL                           @Z40LB35*/
*/*             EXGCCHH2 OF EXGAGL                           @Z40LB35*/
*/*             EXGRECNO OF EXGAGL                           @Z40LB35*/
*/*             EXGDATAP OF EXGAGL                           @Z40LB35*/
*/*             EXGKEYLN OF EXGAGL                           @Z40LB35*/
*/*             EXGDATAL OF EXGAGL                           @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN UEXCP              @Z40LB35*/
*/*                           8, EOF - END OF FILE           @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0395
*                                   /*                       @Z40LB35*/
*TRKREAD:                                                          0395
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0395
TRKREAD  STM   @14,@12,@SA00004                                    0395
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSTK' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0396
*   OLDERID2=NEWERID2;                                             0396
         L     @10,@PC00001                                        0396
         L     @10,GDTTR2(,@10)                                    0396
         MVC   @TS00001(95),NEWERID2(@10)                          0396
         MVC   OLDERID2(95,@10),@TS00001                           0396
*   NEWID2='VSTK';                  /*                       @Z40LB35*/
         MVC   NEWID2(4,@10),@CC01314                              0397
*   GETPTR=ADDR(EXGPARM1);          /*                       @Z40LB35*/
*                                                                  0398
         LA    GETPTR,EXGPARM1                                     0398
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LAST CCHHR IS ZERO, THE EXGAGL IS                  @Z40LB35*/
*   /* INITIALIZED TO READ FIRST TRACK.                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   IF LASTCCHH=0 THEN              /*                       @Z40LB35*/
         L     @10,LASTCCHH                                        0399
         LTR   @10,@10                                             0399
         BNZ   @RF00399                                            0399
*     DO;                           /*                       @Z40LB35*/
*       LASTCCHH=BEGCCHH;           /*                       @Z40LB35*/
         L     @10,BEGCCHH                                         0401
         ST    @10,LASTCCHH                                        0401
*       LR=1;                       /*                       @Z40LB35*/
         MVI   LR,X'01'                                            0402
*       EXGARG=''B;                 /*                       @Z40LB35*/
         XC    EXGARG(32,GETPTR),EXGARG(GETPTR)                    0403
*       EXGCTLBK=IOXPTR;            /*                       @Z40LB35*/
         L     @10,IOXPTR                                          0404
         ST    @10,EXGCTLBK(,GETPTR)                               0404
*       EXGCCHH2=ADDR(LASTCCHH);    /*                       @Z40LB35*/
         LA    @10,LASTCCHH                                        0405
         ST    @10,EXGCCHH2(,GETPTR)                               0405
*       EXGRECNO=VTOCTRK;           /*                       @Z40LB35*/
         LH    @10,VTOCTRK                                         0406
         ST    @10,EXGRECNO(,GETPTR)                               0406
*       EXGDATAP=TRACKPTR;          /*                       @Z40LB35*/
         L     @10,TRACKPTR                                        0407
         ST    @10,EXGDATAP(,GETPTR)                               0407
*       EXGKEYLN=LENGTH(DS1DSNAM);  /*                       @Z40LB35*/
         MVI   EXGKEYLN(GETPTR),X'2C'                              0408
*       EXGDATAL=LENGTH(IECSDSL1)-LENGTH(DS1DSNAM);/*        @Z40LB35*/
         MVC   EXGDATAL(2,GETPTR),@CH01243                         0409
*     END;                          /*                       @Z40LB35*/
*                                                                  0410
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE TEST IS MADE TO DETERMINE IF THE             @Z40LB35*/
*   /* NEXT TRACK TO READ IS BEYOND THE VTOC.                @Z40LB35*/
*   /* IF THE NEXT TRACK TO READ IS BEYOND THE               @Z40LB35*/
*   /* VTOC EXTENTS, THEN THE END-OF-FILE IS SET.            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   IF LASTCCHH>ENDCCHH THEN        /*                       @Z40LB35*/
@RF00399 L     @10,LASTCCHH                                        0411
         ICM   @07,15,ENDCCHH                                      0411
         CR    @10,@07                                             0411
         BNH   @RF00411                                            0411
*     TESTRC=EOF;                   /*                       @Z40LB35*/
*                                                                  0412
         LH    @10,EOF                                             0412
         STH   @10,TESTRC                                          0412
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT EOF, THE NEXT TRACK IS READ.                   @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   ELSE                            /*                       @Z40LB35*/
*     DO;                           /*                       @Z40LB35*/
         B     @RC00411                                            0413
@RF00411 DS    0H                                                  0414
*       CALL IDCIO050(GDTTBL,GET,EXGARG);/*                  @Z40LB35*/
         L     @10,@PC00001                                        0414
         ST    @10,@AL00001                                        0414
         LA    @07,GET                                             0414
         ST    @07,@AL00001+4                                      0414
         ST    GETPTR,@AL00001+8                                   0414
         MVI   @AL00001+8,X'80'                                    0414
         L     @15,GDTEXP(,@10)                                    0414
         LA    @01,@AL00001                                        0414
         BALR  @14,@15                                             0414
*       RESPECIFY                                                  0415
*         RTNREG RSTD;                                             0415
*       TESTRC=RTNREG;                                             0416
         STH   RTNREG,TESTRC                                       0416
*       RESPECIFY                                                  0417
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0417
*       /*************************************************************/
*       /*                                                           */
*       /* TRACK IS SET UP TO BE READ FOR NEXT CALL          @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0418
*       DO;                         /*                       @Z40LB35*/
*         IF LHH=MAXTRKS THEN       /*                       @Z40LB35*/
         CLC   LHH(2),MAXTRKS                                      0419
         BNE   @RF00419                                            0419
*           DO;                     /*                       @Z40LB35*/
*             LHH=0;                /*                       @Z40LB35*/
         SLR   @10,@10                                             0421
         STH   @10,LHH                                             0421
*             LCC=LCC+1;            /*                       @Z40LB35*/
         LH    @10,LCC                                             0422
         LA    @10,1(,@10)                                         0422
         STH   @10,LCC                                             0422
*           END;                    /*                       @Z40LB35*/
*         ELSE                      /*                       @Z40LB35*/
*           LHH=LHH+1;              /*                       @Z40LB35*/
         B     @RC00419                                            0424
@RF00419 LH    @10,LHH                                             0424
         LA    @10,1(,@10)                                         0424
         STH   @10,LHH                                             0424
*       END;                        /*                       @Z40LB35*/
@RC00419 DS    0H                                                  0426
*     END;                          /*                       @Z40LB35*/
*                                                                  0426
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LAST CCHHR IS NOT ZERO, THEN THE NEXT              @Z40LB35*/
*   /* CONTROL IS RETURNED TO CALLER WITH CODE               @Z40LB35*/
*   /* THAT WAS SAVED IN TESTRC.                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RC00411 LH    @15,TESTRC                                          0427
         L     @14,@SA00004                                        0427
         LM    @00,@12,@SA00004+8                                  0427
         BR    @14                                                 0427
*   END TRKREAD;                    /*                       @Z40LB35*/
*                                                                  0429
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - OPENVTOC                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE PERFORMS THE OPEN OF THE      @Z40LB35*/
*/*             VOLUME VTOC AND ISSUES URESERVE ON VOL VTOC  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VSD3DD OF THE VS3AGL                         @Z40LB35*/
*/*             VS3VOL OF THE VS3AGL                         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    EXODDN OF EXOARG                             @Z40LB35*/
*/*             EXOVSN OF EXOARG                             @Z40LB35*/
*/*             EXOCTLBK OF EXOARG                           @Z40LB35*/
*/*             EXOREAD OF EXOARG                            @Z40LB35*/
*/*             EXOVTOC OF EXOARG                            @Z40LB35*/
*/*             EXOEXT OF EXOARG                             @Z40LB35*/
*/*             UNITABL                                      @Z40LB35*/
*/*             IOXPTR                                       @Z40LB35*/
*/*             RLENGTH                                      @Z40LB35*/
*/*             RVOLSER                                      @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN UEXCP (OPEN)       @Z40LB35*/
*/*                           4, ERROR IN USYSINFO           @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0429
*                                   /*                       @Z40LB35*/
*OPENVTOC:                                                         0429
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0429
OPENVTOC STM   @14,@12,@SA00005                                    0429
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0430
*   DCL                                                            0430
*     UNITABLP PTR(31) BDY(WORD);   /* PTR UNITABL - USYSINFO      0430
*                                                            @Z40LB35*/
*                                                                  0431
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSOP' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   OLDERID2=NEWERID2;                                             0431
         L     @10,@PC00001                                        0431
         L     @03,GDTTR2(,@10)                                    0431
         MVC   @TS00001(95),NEWERID2(@03)                          0431
         MVC   OLDERID2(95,@03),@TS00001                           0431
*   NEWID2='VSOP';                  /*                       @Z40LB35*/
*                                                                  0432
         MVC   NEWID2(4,@03),@CC01319                              0432
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE EXOARG IS INITIALIZED TO OPEN                @Z40LB35*/
*   /* THE VOLUME VTOC. THE VOLSER IS PASSED                 @Z40LB35*/
*   /* AND THE READ BIT IS SET BECAUSE NO UP-                @Z40LB35*/
*   /* DATING IS DONE.                                       @Z40LB35*/
*   /* CALL OPENVTOC TO PREPARE FOR I/O TO VTOC              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0433
*   EXOARG=''B;                     /*                       @Z40LB35*/
         LA    @03,EXOPARM                                         0433
         XC    EXOARG(34,@03),EXOARG(@03)                          0433
*   IOXPTR=''B;                     /*                       @Z40LB35*/
         SLR   @15,@15                                             0434
         ST    @15,IOXPTR                                          0434
*   EXODDN=ADDR(VS3DD);             /*                       @Z40LB35*/
         L     @15,@PC00001+8                                      0435
         LA    @14,VS3DD(,@15)                                     0435
         ST    @14,EXODDN(,@03)                                    0435
*   EXOVSN=ADDR(VS3VOL);            /*                       @Z40LB35*/
         LA    @15,VS3VOL(,@15)                                    0436
         ST    @15,EXOVSN(,@03)                                    0436
*   EXOCTLBK=ADDR(IOXPTR);          /*                       @Z40LB35*/
         LA    @15,IOXPTR                                          0437
         ST    @15,EXOCTLBK(,@03)                                  0437
*   EXOREAD=ON;                     /*                       @Z40LB35*/
         OI    EXOREAD(@03),B'10000000'                            0438
*   EXOVTOC=ON;                     /*                       @Z40LB35*/
         OI    EXOVTOC(@03),B'00001000'                            0439
*   IOBLOCK=''B;                    /*                       @Z40LB35*/
         XC    IOBLOCK(28),IOBLOCK                                 0440
*   EXOEXT=ADDR(IOBLOCK);           /*                       @Z40LB35*/
         LA    @15,IOBLOCK                                         0441
         ST    @15,EXOEXT(,@03)                                    0441
*   CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                     @Z40LB35*/
         ST    @10,@AL00001                                        0442
         LA    @15,OPEN                                            0442
         ST    @15,@AL00001+4                                      0442
         ST    @03,@AL00001+8                                      0442
         MVI   @AL00001+8,X'80'                                    0442
         L     @15,GDTEXP(,@10)                                    0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*   RESPECIFY                                                      0443
*     RTNREG RSTD;                                                 0443
*   TESTRC=RTNREG;                                                 0444
         STH   RTNREG,TESTRC                                       0444
*   RESPECIFY                                                      0445
*     RTNREG UNRSTD;                /*                       @Z40LB35*/
*                                                                  0445
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE OPEN WAS SUCCESSFUL, THE                @Z40LB35*/
*   /* USYSINFO ROUTINE IS USED TO OBTAIN THE                @Z40LB35*/
*   /* UCB ADDRESS WHICH IS NEEDED TO RESERVE                @Z40LB35*/
*   /* THE VOLUME VIA THE URESERVE MACRO CALL.               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0446
*   IF TESTRC=0&VS3UCBP=NULLPTR THEN/*                       @Z40LB35*/
         LH    @10,TESTRC                                          0446
         SLR   @03,@03                                             0446
         CR    @10,@03                                             0446
         BNE   @RF00446                                            0446
         L     @10,@PC00001+8                                      0446
         C     @03,VS3UCBP(,@10)                                   0446
         BNE   @RF00446                                            0446
*     DO;                           /*                       @Z40LB35*/
*       UNITABLP=ADDR(UNITABL);     /*                       @Z40LB35*/
         LA    @03,RTNUNIT                                         0448
         ST    @03,UNITABLP                                        0448
*       UNITABL=''B;                /*                       @Z40LB35*/
         XC    UNITABL(11,@03),UNITABL(@03)                        0449
*       CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,VS3DD);/*         @Z40LB35*/
         L     @03,@PC00001                                        0450
         ST    @03,@AL00001                                        0450
         LA    @15,UNIT                                            0450
         ST    @15,@AL00001+4                                      0450
         LA    @15,UNITABLP                                        0450
         ST    @15,@AL00001+8                                      0450
         LA    @10,VS3DD(,@10)                                     0450
         ST    @10,@AL00001+12                                     0450
         MVI   @AL00001+12,X'80'                                   0450
         L     @15,GDTSFO(,@03)                                    0450
         LA    @01,@AL00001                                        0450
         BALR  @14,@15                                             0450
*       RESPECIFY                                                  0451
*         RTNREG RSTD;                                             0451
*       TESTRC=RTNREG;                                             0452
         STH   RTNREG,TESTRC                                       0452
*       RESPECIFY                                                  0453
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*   ELSE                            /*                       @Z40LB35*/
*     UNITUCB=VS3UCBP;              /*                       @Z40LB35*/
*                                                                  0455
         B     @RC00446                                            0455
@RF00446 LA    @10,RTNUNIT                                         0455
         L     @03,@PC00001+8                                      0455
         L     @03,VS3UCBP(,@03)                                   0455
         ST    @03,UNITUCB(,@10)                                   0455
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE OPERATIONS THUS FAR ARE                 @Z40LB35*/
*   /* SUCCESSFUL, THE URESERVE IS ISSUED.                   @Z40LB35*/
*   /* THE URESERVE IS BEING USED TO ENSURE THE              @Z40LB35*/
*   /* VTOC INFORMATION DOES NOT CHANGE WHILE                @Z40LB35*/
*   /* THE VTOC IS BEING PROCESSED.                          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0456
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
@RC00446 LH    @10,TESTRC                                          0456
         LTR   @10,@10                                             0456
         BNZ   @RF00456                                            0456
*     DO;                           /*                       @Z40LB35*/
*       ENQ=ON;                     /*                       @Z40LB35*/
         OI    ENQ,B'10000000'                                     0458
*       RLENGTH=LENGTH(RVOLSER);    /*                       @Z40LB35*/
         MVI   RLENGTH,X'06'                                       0459
*       RVOLSER=VS3VOL;             /*                       @Z40LB35*/
         L     @10,@PC00001+8                                      0460
         MVC   RVOLSER(6),VS3VOL(@10)                              0460
*       CALL IDCSARV0(GDTTBL,SHR,WAIT,UNITUCB,QNAME,RNAME);        0461
         L     @10,@PC00001                                        0461
         ST    @10,@AL00001                                        0461
         LA    @03,SHR                                             0461
         ST    @03,@AL00001+4                                      0461
         LA    @03,WAIT                                            0461
         ST    @03,@AL00001+8                                      0461
         LA    @03,RTNUNIT                                         0461
         ST    @03,@AL00001+12                                     0461
         LA    @03,QNAME                                           0461
         ST    @03,@AL00001+16                                     0461
         LA    @03,RNAME                                           0461
         ST    @03,@AL00001+20                                     0461
         MVI   @AL00001+20,X'80'                                   0461
         L     @15,GDTRSV(,@10)                                    0461
         LA    @01,@AL00001                                        0461
         BALR  @14,@15                                             0461
*     END;                          /*                       @Z40LB35*/
*   ELSE                            /*                       @Z40LB35*/
*                                                                  0463
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE RESERVE WAS NOT ISSUED, INITIALIZE THE       @Z40LB35*/
*     /* ENQ BIT OFF.                                        @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0463
*     ENQ=OFF;                      /*                       @Z40LB35*/
*                                                                  0463
         B     @RC00456                                            0463
@RF00456 NI    ENQ,B'01111111'                                     0463
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO INITIAL PROC WITH              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0464
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RC00456 LH    @15,TESTRC                                          0464
         L     @14,@SA00005                                        0464
         LM    @00,@12,@SA00005+8                                  0464
         BR    @14                                                 0464
*   END OPENVTOC;                   /*                       @Z40LB35*/
*                                                                  0466
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - SELECTOR                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE IS THE CONTROLLING ROUTINE    @Z40LB35*/
*/*             FOR THE DATA SET SELECTION.  IT CALLS        @Z40LB35*/
*/*             SUB PROCEDURES GETFMT1, STATUS, AND USAGE.   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3STAT OF THE VS3AGL                        @Z40LB35*/
*/*             VS3USAGE OF THE VS3AGL                       @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    VSDARRAY OF VSDBLOCK                         @Z40LB35*/
*/*             EXOVSN OF EXOARG                             @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN CRITERIA           @Z40LB35*/
*/*                           4, ERROR IN USAGE              @Z40LB35*/
*/*                           4, ERROR IN STATUS             @Z40LB35*/
*/*                           8, MESSAGE SENT ON CONFLICTS   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0466
*                                   /*                       @Z40LB35*/
*SELECTOR:                                                         0466
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0466
SELECTOR STM   @14,@12,@SA00006                                    0466
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARES                                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*   DCL                                                            0467
*     FMT1S FIXED(31);              /* CTR MAX NUM POSSIBILE @Z40LB35*/
*   DCL                                                            0468
*     LSPACE FIXED(31) CONSTANT(78);/*                       @Z40LB35
*                                      EQUATE FOR LSPACE SVC @Z40LB35*/
*   DCL                                                            0469
*     LSPACESZ FIXED(31) CONSTANT(36);/*                     @Z40LB35
*                                      EQUATE LSPACE BUF SIZE      0469
*                                                            @Z40LB35*/
*   DCL                                                            0470
*     UCBREG REGISTER(0);           /* ASGN REG 0 FOR LSPACE @Z40LB35*/
*   DCL                                                            0471
*     LSPACEBF REGISTER(1);         /* ASGN REG 1 FOR LSPACE @Z40LB35*/
*                                                                  0472
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSSR' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*   OLDERID2=NEWERID2;                                             0472
         L     @07,@PC00001                                        0472
         L     @07,GDTTR2(,@07)                                    0472
         MVC   @TS00001(95),NEWERID2(@07)                          0472
         MVC   OLDERID2(95,@07),@TS00001                           0472
*   NEWID2='VSSR';                  /*                       @Z40LB35*/
*                                                                  0473
         MVC   NEWID2(4,@07),@CC01330                              0473
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MSG SENT BIT OFF                           @Z40LB35*/
*   /* AND INITIALIZE THE FIELDS VSDELEM AND ELEMENT         @Z40LB35*/
*   /* ALSO INITIALIZED IS THE VTOC CCHHR.                   @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*   MSGSENT=OFF;                    /*                       @Z40LB35*/
         NI    MSGSENT,B'01111111'                                 0474
*   LOCATESW=OFF;                   /*                       @Z40LB35*/
         NI    LOCATESW,B'01111111'                                0475
*   VSDELEM=0;                      /*                       @Z40LB35*/
         L     @07,@PC00001+8                                      0476
         L     @07,VS3LISTP(,@07)                                  0476
         L     @07,VSDPTR(,@07)                                    0476
         SLR   @15,@15                                             0476
         ST    @15,VSDELEM(,@07)                                   0476
*   ELEMENT=1;                      /*                       @Z40LB35*/
         LA    ELEMENT,1                                           0477
*   FMT1S=0;                        /*                       @Z40LB35*/
         SLR   FMT1S,FMT1S                                         0478
*   LASTCCHH=BEGCCHH;               /*                       @Z40LB35*/
         L     @07,BEGCCHH                                         0479
         ST    @07,LASTCCHH                                        0479
*   LR=''B;                         /*                       @Z40LB35*/
*                                                                  0480
         SLR   @07,@07                                             0480
         STC   @07,LR                                              0480
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE LOOP WILL OCCUR UNTIL ALL FMT1               @Z40LB35*/
*   /* DSCBS HAVE BEEN PROCESSED                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*   DO WHILE TESTRC=0&FMT1S<FMT1CTR;/*                       @Z40LB35*/
         B     @DE00481                                            0481
@DL00481 DS    0H                                                  0482
*     CALL GETFMT1;                 /*                       @Z40LB35*/
         BAL   @14,GETFMT1                                         0482
*     RESPECIFY                                                    0483
*       RTNREG RSTD;                                               0483
*     TESTRC=RTNREG;                                               0484
         STH   RTNREG,TESTRC                                       0484
*     RESPECIFY                                                    0485
*       RTNREG UNRSTD;              /*                       @Z40LB35*/
*                                                                  0485
*     /***************************************************************/
*     /*                                                             */
*     /* AFTER THE NEXT FMT1 HAS BEEN READ, IT IS            @Z40LB35*/
*     /* PROCESSED BY THE SUBPROCEDURE CRITERIA.             @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0486
*     IF TESTRC=0 THEN              /*                       @Z40LB35*/
         LH    @07,TESTRC                                          0486
         LTR   @07,@07                                             0486
         BNZ   @RF00486                                            0486
*       DO;                         /*                       @Z40LB35*/
*         FMT1S=FMT1S+1;            /*                       @Z40LB35*/
         AL    FMT1S,@CF00219                                      0488
*         VSDDSN(ELEMENT)=DS1DSNAM; /*                       @Z40LB35*/
         LR    @07,ELEMENT                                         0489
         MH    @07,@CH01471                                        0489
         L     @15,@PC00001+8                                      0489
         L     @01,VS3LISTP(,@15)                                  0489
         L     @01,VSDPTR(,@01)                                    0489
         ALR   @01,@07                                             0489
         AL    @01,@CF01484                                        0489
         MVC   VSDDSN-20(44,@01),DS1DSNAM(F1PTR)                   0489
*         CALL CRITERIA;            /*                       @Z40LB35*/
         BAL   @14,CRITERIA                                        0490
*         RESPECIFY                                                0491
*           RTNREG RSTD;                                           0491
*         TESTRC=RTNREG;                                           0492
         STH   RTNREG,TESTRC                                       0492
*         RESPECIFY                                                0493
*           RTNREG UNRSTD;          /*                       @Z40LB35*/
*                                                                  0493
*         /***********************************************************/
*         /*                                                         */
*         /* PROVIDING THE DSN MET THE CRITERIA, THE         @Z40LB35*/
*         /* POINTERS ARE ADJUSTED TO THE NEXT ELEMENT.      @Z40LB35*/
*         /* IF THE SERVICE LISTDSET IS CALLING FOR THE      @Z40LB35*/
*         /* STATUS REPORT, IT WILL NEED THE DSN FOR         @Z40LB35*/
*         /* THE REPORT EVEN WHEN ULOCATE HAS ISSUED         @Z40LB35*/
*         /* AN ERROR MESSAGE.                               @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0494
*         IF TESTRC=0(TESTRC=MSGCODE&VS3STAT=ON) THEN/*     @Z40LB35*/
         LH    @07,TESTRC                                          0494
         LTR   @07,@07                                             0494
         BZ    @RT00494                                            0494
         SLR   @15,@15                                             0494
         IC    @15,MSGCODE                                         0494
         CR    @07,@15                                             0494
         BNE   @RF00494                                            0494
         L     @07,@PC00001+8                                      0494
         TM    VS3STAT(@07),B'10000000'                            0494
         BNO   @RF00494                                            0494
@RT00494 DS    0H                                                  0495
*           DO;                     /*                       @Z40LB35*/
*                                                                  0495
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE LISTDSET SERVICE IS CALLING FOR USAGE        */
*             /*                                             @Z40LB35*/
*             /* REPORT THE INFOMATION NEEDED IS PROVIDED    @Z40LB35*/
*             /* BY USAGE PROCEDURE.                         @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0496
*             IF TESTRC=0&VS3USAGE=ON THEN/*                 @Z40LB35*/
         LH    @07,TESTRC                                          0496
         LTR   @07,@07                                             0496
         BNZ   @RF00496                                            0496
         L     @07,@PC00001+8                                      0496
         TM    VS3USAGE(@07),B'01000000'                           0496
         BNO   @RF00496                                            0496
*               DO;                 /*                       @Z40LB35*/
*                 CALL USAGE;       /*                       @Z40LB35*/
         BAL   @14,USAGE                                           0498
*                 RESPECIFY                                        0499
*                   RTNREG RSTD;                                   0499
*                 TESTRC=RTNREG;                                   0500
         STH   RTNREG,TESTRC                                       0500
*                 RESPECIFY                                        0501
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/
*               END;                /*                       @Z40LB35*/
*                                                                  0502
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE LISTDSET SERVICE IS CALLING FOR STATUS       */
*             /*                                             @Z40LB35*/
*             /* REPORT THE INFOMATION NEEDED IS PROVIDED    @Z40LB35*/
*             /* BY STATUS PROCEDURE.                        @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0503
*             IF VS3STAT=ON THEN    /*                       @Z40LB35*/
@RF00496 L     @07,@PC00001+8                                      0503
         TM    VS3STAT(@07),B'10000000'                            0503
         BNO   @RF00503                                            0503
*               DO;                 /*                       @Z40LB35*/
*                 CALL STATUS;      /*                       @Z40LB35*/
         BAL   @14,STATUS                                          0505
*                 RESPECIFY                                        0506
*                   RTNREG RSTD;                                   0506
*                 TESTRC=RTNREG;                                   0507
         STH   RTNREG,TESTRC                                       0507
*                 RESPECIFY                                        0508
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/
*               END;                /*                       @Z40LB35*/
*                                                                  0509
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE DS STILL MEETS CRITERIA, ADVANCE     @Z40LB35*/
*             /* TO NEXT ELEMENT IN VSDBLOCK.                @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0510
*             IF TESTRC^=NOMEET THEN/*                       @Z40LB35*/
@RF00503 CLC   TESTRC(2),NOMEET                                    0510
         BE    @RF00510                                            0510
*               DO;                 /*                       @Z40LB35*/
*                 VSDELEM=VSDELEM+1;/*                       @Z40LB35*/
         L     @07,@PC00001+8                                      0512
         L     @07,VS3LISTP(,@07)                                  0512
         L     @07,VSDPTR(,@07)                                    0512
         LA    @15,1                                               0512
         L     @14,VSDELEM(,@07)                                   0512
         ALR   @14,@15                                             0512
         ST    @14,VSDELEM(,@07)                                   0512
*                 ELEMENT=ELEMENT+1;/*                       @Z40LB35*/
         ALR   ELEMENT,@15                                         0513
*               END;                /*                       @Z40LB35*/
*                                                                  0514
*             /*******************************************************/
*             /*                                                     */
*             /* ELSE NULL OUT ENTRY                         @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0515
*             ELSE                  /*                       @Z40LB35*/
*               VSDARRAY(ELEMENT)=''B;/*                     @Z40LB35*/
         B     @RC00510                                            0515
@RF00510 LR    @07,ELEMENT                                         0515
         MH    @07,@CH01471                                        0515
         L     @15,@PC00001+8                                      0515
         L     @01,VS3LISTP(,@15)                                  0515
         L     @01,VSDPTR(,@01)                                    0515
         ALR   @01,@07                                             0515
         AL    @01,@CF01485                                        0515
         XC    VSDARRAY-16(80,@01),VSDARRAY-16(@01)                0515
*           END;                    /*                       @Z40LB35*/
*         ELSE                      /*                       @Z40LB35*/
*                                                                  0517
*           /*********************************************************/
*           /*                                                       */
*           /* IF DSN IS NOT BEING PASSED BACK, THE ELEMENT  @Z40LB35*/
*           /* IS ZEROED OUT.                                @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0517
*           VSDARRAY(ELEMENT)=''B;  /*                       @Z40LB35*/
*                                                                  0517
         B     @RC00494                                            0517
@RF00494 LR    @07,ELEMENT                                         0517
         MH    @07,@CH01471                                        0517
         L     @15,@PC00001+8                                      0517
         L     @01,VS3LISTP(,@15)                                  0517
         L     @01,VSDPTR(,@01)                                    0517
         ALR   @01,@07                                             0517
         AL    @01,@CF01485                                        0517
         XC    VSDARRAY-16(80,@01),VSDARRAY-16(@01)                0517
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DSN DOES NOT MEET THE CRITERIA           @Z40LB35*/
*         /* OR AN ERROR MESSAGE WAS ISSUED, THE             @Z40LB35*/
*         /* CODE IS TRANSLATED INTO RCOK.                   @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0518
*         IF TESTRC>4 THEN          /*                       @Z40LB35*/
@RC00494 LH    @07,TESTRC                                          0518
         C     @07,@CF00041                                        0518
         BNH   @RF00518                                            0518
*           TESTRC=0;               /*                       @Z40LB35*/
         SLR   @07,@07                                             0519
         STH   @07,TESTRC                                          0519
*       END;                        /*                       @Z40LB35*/
@RF00518 DS    0H                                                  0521
*   END;                            /*                       @Z40LB35*/
*                                                                  0521
@RF00486 DS    0H                                                  0521
@DE00481 LH    @07,TESTRC                                          0521
         LTR   @07,@07                                             0521
         BNZ   @DC00481                                            0521
         CR    FMT1S,FMT1CTR                                       0521
         BL    @DL00481                                            0521
@DC00481 DS    0H                                                  0522
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UDEQ TO FREE UP VTOC                            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0522
*   IF ENQ=ON THEN                  /*                       @Z40LB35*/
         TM    ENQ,B'10000000'                                     0522
         BNO   @RF00522                                            0522
*     DO;                           /*                       @Z40LB35*/
*       ENQ=OFF;                    /*                       @Z40LB35*/
         NI    ENQ,B'01111111'                                     0524
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                 @Z40LB35*/
         L     @10,@PC00001                                        0525
         ST    @10,@AL00001                                        0525
         LA    @03,QNAME                                           0525
         ST    @03,@AL00001+4                                      0525
         LA    @03,RNAME                                           0525
         ST    @03,@AL00001+8                                      0525
         MVI   @AL00001+8,X'80'                                    0525
         L     @15,GDTDEQ(,@10)                                    0525
         LA    @01,@AL00001                                        0525
         BALR  @14,@15                                             0525
*     END;                          /*                       @Z40LB35*/
*                                                                  0526
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VTOC IS FULLY PROCESSED THE CODE               @Z40LB35*/
*   /* IS RESET TO RCOK.                                     @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0527
*   IF TESTRC=EOF THEN              /*                       @Z40LB35*/
@RF00522 CLC   TESTRC(2),EOF                                       0527
         BNE   @RF00527                                            0527
*     TESTRC=0;                     /*                       @Z40LB35*/
*                                                                  0528
         SLR   @10,@10                                             0528
         STH   @10,TESTRC                                          0528
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE VOLUME SPACE INFORMATION IS RETRIEVED FROM THE VOLUME*/
*   /* VTOC VIA THE LSPACE SVC.                              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   IF TESTRC^=4&VS3USAGE=ON THEN   /*                       @Z40LB35*/
@RF00527 CLC   TESTRC(2),@CH00041                                  0529
         BE    @RF00529                                            0529
         L     @10,@PC00001+8                                      0529
         TM    VS3USAGE(@10),B'01000000'                           0529
         BNO   @RF00529                                            0529
*     DO;                           /*                       @Z40LB35*/
*       RESPECIFY                                                  0531
*        (UCBREG,                                                  0531
*         LSPACEBF) RSTD;           /*                       @Z40LB35*/
*                                                                  0531
*       /*************************************************************/
*       /*                                                           */
*       /* THE UGPOOL IS CALLED TO OBTAIN THE LSPACE BUF     @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0532
*       CALL IDCSAGP0(GDTTBL,LSPACESZ,VSDSPACE,VS3POOL,SETZERO);   0532
         L     @03,@PC00001                                        0532
         ST    @03,@AL00001                                        0532
         LA    @15,@CF01327                                        0532
         ST    @15,@AL00001+4                                      0532
         L     @15,VS3LISTP(,@10)                                  0532
         L     @15,VSDPTR(,@15)                                    0532
         LA    @15,VSDSPACE(,@15)                                  0532
         ST    @15,@AL00001+8                                      0532
         LA    @10,VS3POOL(,@10)                                   0532
         ST    @10,@AL00001+12                                     0532
         LA    @10,SETZERO                                         0532
         ST    @10,@AL00001+16                                     0532
         MVI   @AL00001+16,X'80'                                   0532
         L     @15,GDTGPL(,@03)                                    0532
         LA    @01,@AL00001                                        0532
         BALR  @14,@15                                             0532
*       RESPECIFY                                                  0533
*         RTNREG RSTD;                                             0533
*       TESTRC=RTNREG;                                             0534
         STH   RTNREG,TESTRC                                       0534
*       RESPECIFY                                                  0535
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*                                                                  0535
*       /*************************************************************/
*       /*                                                           */
*       /* IF UGPOOL FAILED, BUILD DARGLIST TO ISSUE         @Z40LB35*/
*       /* MESSAGE "IDC2011I FUNCTION CANNOT BE              @Z40LB35*/
*       /* EXECUTED. INSUFFICIENT MAIN STOARAGE"             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0536
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0536
         LTR   @10,@10                                             0536
         BZ    @RF00536                                            0536
*         DO;                       /*                       @Z40LB35*/
*           DARGLIST=''B;           /*                       @Z40LB35*/
         L     @10,DDSTRU                                          0538
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0538
*           DARGSMOD=IDCTSUV0;      /*                       @Z40LB35*/
         MVC   DARGSMOD(3,@10),@CC01119                            0539
*           DARGSENT=MSG2011A;      /*                       @Z40LB35*/
         MVI   DARGSENT(@10),X'0C'                                 0540
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB35*/
         L     @10,@PC00001                                        0541
         ST    @10,@AL00001                                        0541
         LA    @03,@CF00115                                        0541
         ST    @03,@AL00001+4                                      0541
         LA    @03,DDSTRU                                          0541
         ST    @03,@AL00001+8                                      0541
         MVI   @AL00001+8,X'80'                                    0541
         L     @15,GDTPRT(,@10)                                    0541
         LA    @01,@AL00001                                        0541
         BALR  @14,@15                                             0541
*         END;                      /*                       @Z40LB35*/
*       ELSE                        /*                       @Z40LB35*/
*         DO;                       /*                       @Z40LB35*/
         B     @RC00536                                            0543
@RF00536 DS    0H                                                  0544
*           VSDVTOC=''B;            /*                       @Z40LB35*/
         L     @10,@PC00001+8                                      0544
         L     @10,VS3LISTP(,@10)                                  0544
         L     @10,VSDPTR(,@10)                                    0544
         L     @10,VSDSPACE(,@10)                                  0544
         XC    VSDVTOC(25,@10),VSDVTOC(@10)                        0544
*           UCBREG=UNITUCB;         /*                       @Z40LB35*/
         LA    @03,RTNUNIT                                         0545
         L     UCBREG,UNITUCB(,@03)                                0545
*           LSPACEBF=0;             /*                       @Z40LB35*/
         SLR   LSPACEBF,LSPACEBF                                   0546
*           LSPACEBF=ADDR(VSDVTOC); /*                       @Z40LB35*/
         LR    LSPACEBF,@10                                        0547
*LLSPACE1:                                                         0548
*           SVC(LSPACE);            /*                       @Z40LB35*/
LLSPACE1 SVC   78                                                  0548
*           RESPECIFY                                              0549
*             RTNREG RSTD;                                         0549
*           TESTRC=RTNREG;                                         0550
         STH   RTNREG,TESTRC                                       0550
*           RESPECIFY                                              0551
*             RTNREG UNRSTD;        /*                       @Z40LB35*/
*           RESPECIFY                                              0552
*            (UCBREG,                                              0552
*             LSPACEBF) UNRSTD;     /*                       @Z40LB35*/
*                                                                  0552
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE LSPACE WAS UNSUCCESSFUL, THE ERROR     @Z40LB35*/
*           /* MESSAGE "IDC2972I LSPACE ERROR. LSPACE        @Z40LB35*/
*           /* RETURN CODE ( )." WILL BE ISSUED.             @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0553
*           IF TESTRC^=0 THEN       /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0553
         LTR   @10,@10                                             0553
         BZ    @RF00553                                            0553
*             DO;                   /*                       @Z40LB35*/
*               DARGLIST=''B;       /*                       @Z40LB35*/
         L     @10,DDSTRU                                          0555
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0555
*               DARGSMOD=IDCTSVS0;  /*                       @Z40LB35*/
         MVC   DARGSMOD(3,@10),@CC01121                            0556
*               DARGSENT=MSG2972A;  /*                       @Z40LB35*/
         MVI   DARGSENT(@10),X'17'                                 0557
*               DARGDBP=ADDR(TESTRC);/*                      @Z40LB35*/
         LA    @03,TESTRC                                          0558
         ST    @03,DARGDBP(,@10)                                   0558
*               DARGILP=LENGTH(TESTRC);/*                    @Z40LB35*/
         MVC   DARGILP(2,@10),@CH00036                             0559
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB35*/
         L     @10,@PC00001                                        0560
         ST    @10,@AL00001                                        0560
         LA    @03,@CF00115                                        0560
         ST    @03,@AL00001+4                                      0560
         LA    @03,DDSTRU                                          0560
         ST    @03,@AL00001+8                                      0560
         MVI   @AL00001+8,X'80'                                    0560
         L     @15,GDTPRT(,@10)                                    0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*               TESTRC=4;           /*                       @Z40LB35*/
         MVC   TESTRC(2),@CH00041                                  0561
*             END;                  /*                       @Z40LB35*/
*         END;                      /*                       @Z40LB35*/
*                                                                  0563
@RF00553 DS    0H                                                  0564
*       /*************************************************************/
*       /*                                                           */
*       /* HERE THE NUMBER OF FMT 0 DSCB IS INITIALIZED      @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0564
*       VSDFMT0=FMT0CTR;            /*                       @Z40LB35*/
*                                                                  0564
@RC00536 L     @10,@PC00001+8                                      0564
         L     @10,VS3LISTP(,@10)                                  0564
         L     @10,VSDPTR(,@10)                                    0564
         L     @03,FMT0CTR                                         0564
         ST    @03,VSDFMT0(,@10)                                   0564
*       /*************************************************************/
*       /*                                                           */
*       /* THE TRACKS ALLOCATED FOR VTOC IS CALCULATED       @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0565
*       VSDVTOCS=(ENDCC*TRACKSIZ)+ENDHH+1;/*                 @Z40LB35*/
         LH    @03,TRACKSIZ                                        0565
         ICM   @01,12,ENDCC                                        0565
         SRA   @01,16                                              0565
         MR    @00,@03                                             0565
         ICM   @00,12,ENDHH                                        0565
         SRA   @00,16                                              0565
         ALR   @01,@00                                             0565
         AL    @01,@CF00219                                        0565
         ST    @01,VSDVTOCS(,@10)                                  0565
*       VSDVTOCS=VSDVTOCS-((BEGCC*TRACKSIZ)+BEGHH);                0566
         MH    @03,BEGCC                                           0566
         AH    @03,BEGHH                                           0566
         SLR   @01,@03                                             0566
         ST    @01,VSDVTOCS(,@10)                                  0566
*     END;                          /*                       @Z40LB35*/
*                                                                  0567
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE TERMINATING ERROR DID NOT               @Z40LB35*/
*   /* OCCUR AND AN ERROR MESSAGE WAS ISSUED BY              @Z40LB35*/
*   /* ULOCATE THE 8 - CODE IS SET.                          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0568
*   IF TESTRC^=4&MSGSENT=ON THEN    /*                       @Z40LB35*/
@RF00529 CLC   TESTRC(2),@CH00041                                  0568
         BE    @RF00568                                            0568
         TM    MSGSENT,B'10000000'                                 0568
         BNO   @RF00568                                            0568
*     TESTRC=8;                     /*                       @Z40LB35*/
*                                                                  0569
         MVC   TESTRC(2),@CH00179                                  0569
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCVS03                        @Z40LB35*/
*   /* WITH THE CODE SAVED IN TESTRC.                        @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0570
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00568 LH    @15,TESTRC                                          0570
         L     @14,@SA00006                                        0570
         LM    @00,@12,@SA00006+8                                  0570
         BR    @14                                                 0570
*   END SELECTOR;                   /*                       @Z40LB35*/
*                                                                  0572
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - CLEANUP                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE PERFORMS THE CLOSE OF THE     @Z40LB35*/
*/*             VOLUME VTOC AND FREES THE TRACK BUFFER.      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     IOXPTR PTR TO IOXCTLBK FOR EXCP PROCESSING   @Z40LB35*/
*/*             TRACKPTR PTR TO THE VTOC TRACK BUFFER        @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          12, ERROR CLOSE - UEXCP         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0572
*                                   /*                       @Z40LB35*/
*CLEANUP:                                                          0572
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0572
CLEANUP  STM   @14,@12,@SA00007                                    0572
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSCU' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   OLDERID2=NEWERID2;                                             0573
         L     @10,@PC00001                                        0573
         L     @03,GDTTR2(,@10)                                    0573
         MVC   @TS00001(95),NEWERID2(@03)                          0573
         MVC   OLDERID2(95,@03),@TS00001                           0573
*   NEWID2='VSCU';                  /*                       @Z40LB35*/
*                                                                  0574
         MVC   NEWID2(4,@03),@CC01341                              0574
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UDEQ TO FREE UP VTOC                            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0575
*   IF ENQ=ON THEN                  /*                       @Z40LB35*/
         TM    ENQ,B'10000000'                                     0575
         BNO   @RF00575                                            0575
*     CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                   @Z40LB35*/
*                                                                  0576
         ST    @10,@AL00001                                        0576
         LA    @03,QNAME                                           0576
         ST    @03,@AL00001+4                                      0576
         LA    @03,RNAME                                           0576
         ST    @03,@AL00001+8                                      0576
         MVI   @AL00001+8,X'80'                                    0576
         L     @15,GDTDEQ(,@10)                                    0576
         LA    @01,@AL00001                                        0576
         BALR  @14,@15                                             0576
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UEXCP TO CLOSE THE VTOC                         @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   TESTRC=0;                       /*                       @Z40LB35*/
@RF00575 SLR   @10,@10                                             0577
         STH   @10,TESTRC                                          0577
*   IF IOXPTR^=NULLPTR THEN         /*                       @Z40LB35*/
         C     @10,IOXPTR                                          0578
         BE    @RF00578                                            0578
*     DO;                           /*                       @Z40LB35*/
*       CALL IDCIO050(GDTTBL,CLOSE,IOXPTR);/*                @Z40LB35*/
         L     @10,@PC00001                                        0580
         ST    @10,@AL00001                                        0580
         LA    @03,CLOSE                                           0580
         ST    @03,@AL00001+4                                      0580
         LA    @03,IOXPTR                                          0580
         ST    @03,@AL00001+8                                      0580
         MVI   @AL00001+8,X'80'                                    0580
         L     @15,GDTEXP(,@10)                                    0580
         LA    @01,@AL00001                                        0580
         BALR  @14,@15                                             0580
*       RESPECIFY                                                  0581
*         RTNREG RSTD;                                             0581
*       TESTRC=RTNREG;                                             0582
         STH   RTNREG,TESTRC                                       0582
*       RESPECIFY                                                  0583
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0584
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CLOSE FAILED, SET THE CLOSE ERROR              @Z40LB35*/
*   /* CODE. THIS IS NOT A TERMINATING ERROR AND             @Z40LB35*/
*   /* REQUIRES A SPECIAL CODE.                              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*   IF TESTRC^=0 THEN               /*                       @Z40LB35*/
@RF00578 LH    @10,TESTRC                                          0585
         LTR   @10,@10                                             0585
         BZ    @RF00585                                            0585
*     TESTRC=12;                    /*                       @Z40LB35*/
*                                                                  0586
         MVC   TESTRC(2),@CH00035                                  0586
*   /*****************************************************************/
*   /*                                                               */
*   /* PROVIDING THE UGSPACE WAS SUCCESSFUL OR NOT           @Z40LB35*/
*   /* FREE THE STORAGE FOR THE VTOC TRACK BUFFER.           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0587
*   IF TRACKPTR^=NULLPTR THEN       /*                       @Z40LB35*/
@RF00585 L     @10,TRACKPTR                                        0587
         LTR   @10,@10                                             0587
         BZ    @RF00587                                            0587
*     CALL IDCSAFS0(GDTTBL,TRACKPTR);/*                      @Z40LB35*/
*                                                                  0588
         L     @10,@PC00001                                        0588
         ST    @10,@AL00001                                        0588
         LA    @03,TRACKPTR                                        0588
         ST    @03,@AL00001+4                                      0588
         L     @15,GDTFSP(,@10)                                    0588
         LA    @01,@AL00001                                        0588
         BALR  @14,@15                                             0588
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO IDCVS03 WITH THE CODE          @Z40LB35*/
*   /* SAVED IN TESTRC.                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0589
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00587 LH    @15,TESTRC                                          0589
         L     @14,@SA00007                                        0589
         LM    @00,@12,@SA00007+8                                  0589
         BR    @14                                                 0589
*   END CLEANUP;                    /*                       @Z40LB35*/
*                                                                  0591
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - GETFMT1                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE CALLS TRKREAD PROCEDURE       @Z40LB35*/
*/*             TO READ A TRACK IF NECESSARY AND LOCATES THE @Z40LB35*/
*/*             NEXT FMT1 DSCB FOR THE CALLER (SELECTOR      @Z40LB35*/
*/*             PROCEDURE).                                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1FMTID FROM IECSDSL1 FMT1 DSCB             @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    F1PTR TO THE DSCB                            @Z40LB35*/
*/*             LR FROM THE IOBLOCK                          @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           4, ERROR IN TRKREAD            @Z40LB35*/
*/*                          12, EOF END OF FILE             @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0591
*                                   /*                       @Z40LB35*/
*GETFMT1:                                                          0591
*   PROC;                           /*                       @Z40LB35*/
GETFMT1  STM   @14,@04,@SA00008                                    0591
         STM   @06,@09,@SA00008+28                                 0591
         STM   @11,@12,@SA00008+44                                 0591
*   DCL                                                            0592
*     TRACKRSW BIT(1);              /* SWITCH FOR READ TRACK @Z40LB35*/
*   DCL                                                            0593
*     FMT1SW BIT(1);                /* FMT1 SWITCH           @Z40LB35*/
*   DCL                                                            0594
*     DSCBNUM FIXED(31);            /* DSCB COUNTER          @Z40LB35*/
*                                                                  0595
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSF1' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0595
*   OLDERID2=NEWERID2;                                             0595
         L     @04,@PC00001                                        0595
         L     @04,GDTTR2(,@04)                                    0595
         MVC   @TS00001(95),NEWERID2(@04)                          0595
         MVC   OLDERID2(95,@04),@TS00001                           0595
*   NEWID2='VSF1';                  /*                       @Z40LB35*/
*                                                                  0596
         MVC   NEWID2(4,@04),@CC01348                              0596
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD NUMBER IS STILL INITIALIZED TO          @Z40LB35*/
*   /* ZERO, THE FIRST TRACK HAS STILL TO BE READ.           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*   IF LR=0 THEN                    /*                       @Z40LB35*/
         CLI   LR,0                                                0597
         BNE   @RF00597                                            0597
*     DO;                           /*                       @Z40LB35*/
*       TRACKRSW=ON;                /*                       @Z40LB35*/
         OI    TRACKRSW,B'10000000'                                0599
*       LR=1;                       /*                       @Z40LB35*/
         MVI   LR,X'01'                                            0600
*     END;                          /*                       @Z40LB35*/
*                                                                  0601
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE FMT1 SWITCH OFF                            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   FMT1SW=OFF;                     /*                       @Z40LB35*/
*                                                                  0602
@RF00597 NI    FMT1SW,B'01111111'                                  0602
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING DO LOOP WILL LOCATE THE NEXT            @Z40LB35*/
*   /* FMT 1 DSCB OR REACH AN EOF.                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0603
*   DO WHILE TESTRC=0&FMT1SW=OFF;   /*                       @Z40LB35*/
*                                                                  0603
         B     @DE00603                                            0603
@DL00603 DS    0H                                                  0604
*     /***************************************************************/
*     /*                                                             */
*     /* THE DSCB COUNT IS ADVANCED AND THE PTR              @Z40LB35*/
*     /* TO THE NEXT DSCB IS POSITIONED.                     @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0604
*     DSCBNUM=DSCBNUM+1;            /*                       @Z40LB35*/
         AL    DSCBNUM,@CF00219                                    0604
*     F1PTR=F1PTR+LENGTH(IECSDSL1); /*                       @Z40LB35*/
*                                                                  0605
         AL    F1PTR,@CF01203                                      0605
*     /***************************************************************/
*     /*                                                             */
*     /* HERE THE DETERMINATION IS MADE WHETHER THE          @Z40LB35*/
*     /* END OF THE TRACK HAS BEEN REACHED.                  @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0606
*     IF TRACKRSW=ON THEN           /*                       @Z40LB35*/
*                                                                  0606
         TM    TRACKRSW,B'10000000'                                0606
         BNO   @RF00606                                            0606
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE END OF TRACK HAS BEEN REACHED,             @Z40LB35*/
*       /* THE NEXT TRACK IS READ.                           @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0607
*       DO;                         /*                       @Z40LB35*/
*         CALL TRKREAD;             /*                       @Z40LB35*/
         BAL   @14,TRKREAD                                         0608
*         RESPECIFY                                                0609
*           RTNREG RSTD;                                           0609
*         TESTRC=RTNREG;                                           0610
         STH   RTNREG,TESTRC                                       0610
*         RESPECIFY                                                0611
*           RTNREG UNRSTD;          /*                       @Z40LB35*/
*         DSCBNUM=1;                /*                       @Z40LB35*/
         LA    DSCBNUM,1                                           0612
*         LR=1;                     /*                       @Z40LB35*/
         MVI   LR,X'01'                                            0613
*         F1PTR=TRACKPTR;           /*                       @Z40LB35*/
         L     F1PTR,TRACKPTR                                      0614
*         TRACKRSW=OFF;             /*                       @Z40LB35*/
         NI    TRACKRSW,B'01111111'                                0615
*       END;                        /*                       @Z40LB35*/
*                                                                  0616
*     /***************************************************************/
*     /*                                                             */
*     /* HERE A TEST IS MADE TO DETERMINE IF THE             @Z40LB35*/
*     /* CURRENT DSCB IS A FMT 1 DSCB AND NOT VSAM           @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0617
*     IF DS1FMTID=FMT1ID&DS1VSAM=OFF THEN/*                  @Z40LB35*/
@RF00606 CLC   DS1FMTID(1,F1PTR),FMT1ID                            0617
         BNE   @RF00617                                            0617
         TM    DS1VSAM(F1PTR),B'00001000'                          0617
         BNZ   @RF00617                                            0617
*       FMT1SW=ON;                  /*                       @Z40LB35*/
*                                                                  0618
         OI    FMT1SW,B'10000000'                                  0618
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DSCB COUNT IS GREATER THAN 39, THE           @Z40LB35*/
*     /* TRACK READ SWITCH IS SET FOR THE NEXT               @Z40LB35*/
*     /* COMPARISON.                                         @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0619
*     IF DSCBNUM>=VTOCTRK THEN      /*                       @Z40LB35*/
@RF00617 CH    DSCBNUM,VTOCTRK                                     0619
         BL    @RF00619                                            0619
*       TRACKRSW=ON;                /*                       @Z40LB35*/
         OI    TRACKRSW,B'10000000'                                0620
*   END;                            /*                       @Z40LB35*/
*                                                                  0621
@RF00619 DS    0H                                                  0621
@DE00603 LH    @04,TESTRC                                          0621
         LTR   @04,@04                                             0621
         BNZ   @DC00603                                            0621
         TM    FMT1SW,B'10000000'                                  0621
         BZ    @DL00603                                            0621
@DC00603 DS    0H                                                  0622
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO SELECTOR PROC WITH             @Z40LB35*/
*   /* CODE SAVE IN TESTRC.                                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
         LH    @15,TESTRC                                          0622
         L     @14,@SA00008                                        0622
         LM    @00,@04,@SA00008+8                                  0622
         LM    @06,@09,@SA00008+28                                 0622
         LM    @11,@12,@SA00008+44                                 0622
         BR    @14                                                 0622
*   END GETFMT1;                    /*                       @Z40LB35*/
*                                                                  0624
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - CRITERIA                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE IS THE CONTROLLING PROCEDURE  @Z40LB35*/
*/*             FOR A SPECIFIC DATA SET CRITERIA STATUS.     @Z40LB35*/
*/*             CALLS SUB PROCEDURES CATLG, QUAL, CREATION,  @Z40LB35*/
*/*             EXPIRATN, SYSNAMES, AND EXCLUDE.             @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3UNCAT FROM THE VS3AGL                     @Z40LB35*/
*/*             VS3EXDSP FROM THE VS3AGL                     @Z40LB35*/
*/*             VS3LEVP  FROM THE VS3AGL                     @Z40LB35*/
*/*             VS3CREAT FROM THE VS3AGL                     @Z40LB35*/
*/*             VS3EXPIR FROM THE VS3AGL                     @Z40LB35*/
*/*             VS3SYSNM FROM THE VS3AGL                     @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    F1PTR TO THE DSCB                            @Z40LB35*/
*/*             LR FROM THE IOBLOCK                          @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           8, ERROR CLOSE - UEXCP         @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0624
*                                   /*                       @Z40LB35*/
*CRITERIA:                                                         0624
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0624
CRITERIA STM   @14,@12,@SA00009                                    0624
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSCT' IN TRACE TABLE              @ZM41110*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   OLDERID2=NEWERID2;                                             0625
         L     @10,@PC00001                                        0625
         L     @10,GDTTR2(,@10)                                    0625
         MVC   @TS00001(95),NEWERID2(@10)                          0625
         MVC   OLDERID2(95,@10),@TS00001                           0625
*   NEWID2='VSCT';                  /*                       @ZM41110*/
*                                                                  0626
         MVC   NEWID2(4,@10),@CC01352                              0626
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE RETURN CODE TO ZERO                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*   TESTRC=0;                       /*                       @Z40LB35*/
*                                                                  0627
         SLR   @10,@10                                             0627
         STH   @10,TESTRC                                          0627
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE EXCLUDED DSN LIST IS PASSED                    @Z40LB35*/
*   /* THE EXCLUDE SUB PROCEDURE IS CALLED.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   IF VS3EXDSP^=NULLPTR THEN       /*                       @Z40LB35*/
         L     @03,@PC00001+8                                      0628
         C     @10,VS3EXDSP(,@03)                                  0628
         BE    @RF00628                                            0628
*     DO;                           /*                       @Z40LB35*/
*       CALL EXCLUDE;               /*                       @Z40LB35*/
         BAL   @14,EXCLUDE                                         0630
*       RESPECIFY                                                  0631
*         RTNREG RSTD;                                             0631
*       TESTRC=RTNREG;                                             0632
         STH   RTNREG,TESTRC                                       0632
*       RESPECIFY                                                  0633
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0634
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DSN HIGHER LEVEL QUALIFIER IS PASSED,            @Z40LB35*/
*   /* THE SUB PROCEDURE QUAL IS CALLED.                     @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*   IF TESTRC=0&VS3LEVP^=NULLPTR THEN/*                      @Z40LB35*/
@RF00628 SLR   @10,@10                                             0635
         CH    @10,TESTRC                                          0635
         BNE   @RF00635                                            0635
         L     @03,@PC00001+8                                      0635
         C     @10,VS3LEVP(,@03)                                   0635
         BE    @RF00635                                            0635
*     DO;                           /*                       @Z40LB35*/
*       CALL QUAL;                  /*                       @Z40LB35*/
         BAL   @14,QUAL                                            0637
*       RESPECIFY                                                  0638
*         RTNREG RSTD;                                             0638
*       TESTRC=RTNREG;                                             0639
         STH   RTNREG,TESTRC                                       0639
*       RESPECIFY                                                  0640
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0641
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALLER WANTS THE SYSNAME CRITERIA, THE         @Z40LB35*/
*   /* SUB PROCEDURE SYSNAMES IS CALLED.                     @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0642
*   IF TESTRC=0&VS3SYSNM=ON THEN    /*                       @Z40LB35*/
@RF00635 LH    @10,TESTRC                                          0642
         LTR   @10,@10                                             0642
         BNZ   @RF00642                                            0642
         L     @10,@PC00001+8                                      0642
         TM    VS3SYSNM(@10),B'00001000'                           0642
         BNO   @RF00642                                            0642
*     DO;                           /*                       @Z40LB35*/
*       CALL SYSNAMES;              /*                       @Z40LB35*/
         BAL   @14,SYSNAMES                                        0644
*       RESPECIFY                                                  0645
*         RTNREG RSTD;                                             0645
*       TESTRC=RTNREG;                                             0646
         STH   RTNREG,TESTRC                                       0646
*       RESPECIFY                                                  0647
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0648
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION IS MADE WHETHER THE            @Z40LB35*/
*   /* CATALOG SHOULD BE SEARCHED FOR THE DSN.               @Z40LB35*/
*   /* THE SCRDSET SERVICE WILL NEED TO KNOW IF A            @Z40LB35*/
*   /* DATA SET IS CATLG OR NOT TO UNCATLG IT                @Z40LB35*/
*   /* WHEN THE DSN IS SCRATCHED.                            @Z40LB35*/
*   /* THE LISTDSET WILL NEED TO KNOW IF A DSN               @Z40LB35*/
*   /* IS CATLG WHEN IT PREPARES THE STATUS REPORT.          @Z40LB35*/
*   /* IF ANY CALLER HAS SPECIFIED THE VS3UNCAT              @Z40LB35*/
*   /* CRITERIA, CATLG WILL BE SEARCHED TO DETERMINE         @Z40LB35*/
*   /* IF THE DATA SET MEETS THE CRITERIAN.                  @Z40LB35*/
*   /* AND FINALLY IF THE USER HAS USED EXPIRATION           @Z40LB35*/
*   /* OR CREATION DATE CRITERIA, THE VSAM CATLG             @Z40LB35*/
*   /* ENTRY WILL BE NEEDED TO TEST THE DATES.               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0649
*   IF TESTRC^=NOMEET&(VS3STAT=ONVS3UNCAT=ONVS3EXPIR^=NULLPTR   0649
*       VS3CREAT^=NULLPTRVS3SCR=ON) THEN                          0649
*                                                                  0649
@RF00642 CLC   TESTRC(2),NOMEET                                    0649
         BE    @RF00649                                            0649
         L     @10,@PC00001+8                                      0649
         TM    VS3STAT(@10),B'10010000'                            0649
         BNZ   @RT00649                                            0649
         SLR   @03,@03                                             0649
         C     @03,VS3EXPIR(,@10)                                  0649
         BNE   @RT00649                                            0649
         C     @03,VS3CREAT(,@10)                                  0649
         BNE   @RT00649                                            0649
         TM    VS3SCR(@10),B'00100000'                             0649
         BNO   @RF00649                                            0649
@RT00649 DS    0H                                                  0650
*     /***************************************************************/
*     /*                                                             */
*     /* THE SUB PROCEDURE CATLG WILL DO THE ULOCATE.        @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0650
*     DO;                           /*                       @Z40LB35*/
*       CALL CATLG;                 /*                       @Z40LB35*/
         BAL   @14,CATLG                                           0651
*       RESPECIFY                                                  0652
*         RTNREG RSTD;                                             0652
*       TESTRC=RTNREG;                                             0653
         STH   RTNREG,TESTRC                                       0653
*       RESPECIFY                                                  0654
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0655
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALLER HAS SUPPLIED A CREATION DATE            @Z40LB35*/
*   /* THE SUB PROCEDURE CREATION IS CALLED.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*   IF TESTRC^=NOMEET&VS3CREAT^=NULLPTR THEN/*               @Z40LB35*/
@RF00649 CLC   TESTRC(2),NOMEET                                    0656
         BE    @RF00656                                            0656
         L     @10,@PC00001+8                                      0656
         L     @10,VS3CREAT(,@10)                                  0656
         LTR   @10,@10                                             0656
         BZ    @RF00656                                            0656
*     DO;                           /*                       @Z40LB35*/
*       CALL CREATION;              /*                       @Z40LB35*/
         BAL   @14,CREATION                                        0658
*       RESPECIFY                                                  0659
*         RTNREG RSTD;                                             0659
*       TESTRC=RTNREG;                                             0660
         STH   RTNREG,TESTRC                                       0660
*       RESPECIFY                                                  0661
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0662
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CALLER HAS SUPPLIED A EXPIRATION DATE          @Z40LB35*/
*   /* THE SUB PROCEDURE EXPIRATN IS CALLED.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0663
*   IF TESTRC^=NOMEET&VS3EXPIR^=NULLPTR THEN/*               @Z40LB35*/
@RF00656 CLC   TESTRC(2),NOMEET                                    0663
         BE    @RF00663                                            0663
         L     @10,@PC00001+8                                      0663
         L     @10,VS3EXPIR(,@10)                                  0663
         LTR   @10,@10                                             0663
         BZ    @RF00663                                            0663
*     DO;                           /*                       @Z40LB35*/
*       CALL EXPIRATN;              /*                       @Z40LB35*/
         BAL   @14,EXPIRATN                                        0665
*       RESPECIFY                                                  0666
*         RTNREG RSTD;                                             0666
*       TESTRC=RTNREG;                                             0667
         STH   RTNREG,TESTRC                                       0667
*       RESPECIFY                                                  0668
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0669
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ULOCATE ISSUED AN DSN ERROR OR CONFLICT            @Z40LB35*/
*   /* MESSAGE, THEN THE CODE 8 IS RETURNED.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0670
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/
@RF00663 CLC   TESTRC(2),@CH00041                                  0670
         BNE   @RF00670                                            0670
*     TESTRC=MSGCODE;               /*                       @Z40LB35*/
*                                                                  0671
         SLR   @10,@10                                             0671
         IC    @10,MSGCODE                                         0671
         STH   @10,TESTRC                                          0671
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE CODE         @Z40LB35*/
*   /* SAVED IN TESTRC.                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0672
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00670 LH    @15,TESTRC                                          0672
         L     @14,@SA00009                                        0672
         LM    @00,@12,@SA00009+8                                  0672
         BR    @14                                                 0672
*   END CRITERIA;                   /*                       @Z40LB35*/
*                                                                  0674
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - USAGE                                   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE INITIALIZES THE VSDUSAGE      @Z40LB35*/
*/*             PORTION OF THE VSDBLOCK.                     @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1DSORG FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS1SCALO FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS1EXT1  FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS1LSTAR FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS3FMTID FROM IECDSF3 OF THE DSCB FMT3       @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    VSDOPS   OF VSDUSAGE                         @Z40LB35*/
*/*             VSDOPO   OF VSDUSAGE                         @Z40LB35*/
*/*             VSDOIS   OF VSDUSAGE                         @Z40LB35*/
*/*             VSDODA   OF VSDUSAGE                         @Z40LB35*/
*/*             VSDOU    OF VSDUSAGE                         @Z40LB35*/
*/*             VSDACYL  OF VSDUSAGE                         @Z40LB35*/
*/*             VSDATRK  OF VSDUSAGE                         @Z40LB35*/
*/*             VSDABLK  OF VSDUSAGE                         @Z40LB35*/
*/*             VSDBSTR  OF VSDUSAGE                         @Z40LB35*/
*/*             VSDSECAL OF VSDUSAGE                         @Z40LB35*/
*/*             VSDCALFR OF VSDUSAGE                         @Z40LB35*/
*/*             VSDFTRK  OF VSDUSAGE                         @Z40LB35*/
*/*             VSDTRKS  OF VSDUSAGE                         @Z40LB35*/
*/*             EXGCTLBK OF EXGARG                           @Z40LB35*/
*/*             EXGCCHH2 OF EXGARG                           @Z40LB35*/
*/*             EXGRECNO OF EXGARG                           @Z40LB35*/
*/*             EXGDATAP OF EXGARG                           @Z40LB35*/
*/*             EXGKEYLN OF EXGARG                           @Z40LB35*/
*/*             EXGDATAL OF EXGARG                           @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0674
*                                   /*                       @Z40LB35*/
*USAGE:                                                            0674
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0674
USAGE    STM   @14,@02,@SA00010                                    0674
         STM   @04,@07,@SA00010+20                                 0674
         STM   @09,@12,@SA00010+36                                 0674
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINE THE SECONDARY          @Z40LB35*/
*   /* ALLOCATION INTO A FIXED NUMBER.                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0675
*   DCL                                                            0675
*     1 * DEFINED(DS1SCALO) BDY(BYTE),/*                     @Z40LB35*/
*      2 * FIXED(8),                /* RESERVED              @Z40LB35*/
*      2 DS1SECAL FIXED(24);        /* SECONDARY ALLOC UNITS @Z40LB35*/
*                                                                  0675
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING BIT DEFINES THE TRACK UNIT BIT          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0676
*   DCL                                                            0676
*     DS1TRACK BIT(1) DEFINED(DS1SCALO);/* DS ALLOC - TRKS   @Z40LB35*/
*                                                                  0676
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING BIT DEFINES THE ABSOLUTE                @Z40LB35*/
*   /* TRACK ALLOCATION.                                     @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0677
*   DCL                                                            0677
*     1 * DEFINED(DS1SCALO),        /*                       @Z40LB35*/
*      2 * BIT(4),                  /*                       @Z40LB35*/
*      2 DS1ABSTR BIT(1);           /* DS ALLOC-ABSOLUTE TRKS      0677
*                                                            @Z40LB35*/
*                                                                  0677
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING BIT DEFINES THE CYL UNIT BIT            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0678
*   DCL                                                            0678
*     1 DS1SCAL DEFINED(DS1SCALO),  /*                       @Z40LB35*/
*      2 DS1CAL1 BIT(1),            /* DS ALLOC              @Z40LB35*/
*      2 DS1CAL2 BIT(1);            /* DS ALLOC              @Z40LB35*/
*   DCL                                                            0679
*     NOFMT3 BIT(1);                /* NO FMT 3 FOR DS       @Z40LB35*/
*   DCL                                                            0680
*     FMT3 CHAR(LENGTH(IECSDSF3));  /* FMT 3 BUFFER          @Z40LB35*/
*   DCL                                                            0681
*     DSNSCRAT FIXED(8) CONSTANT(16);/* DS SCRATCHED         @Z40LB35*/
*                                                                  0681
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES A DSCB                @Z40LB35*/
*   /* DEB EXTENTS.                                          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0682
*   DCL                                                            0682
*     1 DSEXTS BASED(EXTENTP),      /*                       @Z40LB35*/
*      2 * CHAR(2),                 /*                       @Z40LB35*/
*      2 DSBG FIXED(31) BDY(BYTE),  /*                       @Z40LB35*/
*       3 DSBGCYLS FIXED(15),       /* BEGINNING CYL         @Z40LB35*/
*       3 DSBGTRKS FIXED(15),       /* BEGINNING TRACK       @Z40LB35*/
*      2 DSENCYLS FIXED(15),        /* ENDING CYL            @Z40LB35*/
*      2 DSENTRKS FIXED(15);        /* ENDING TRACK          @Z40LB35*/
*                                                                  0682
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE DEFINES THE                   @Z40LB35*/
*   /* LAST TTR OF LAST RECORD WRITTEN.                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0683
*   DCL                                                            0683
*     1 * DEFINED(DS1LSTAR) BDY(BYTE),/*                     @Z40LB35*/
*      2 DS1LSTTT FIXED(15),        /* LAST TRACK            @Z40LB35*/
*      2 DS1LSTR FIXED(8);          /* LAST RECORD           @Z40LB35*/
*   DCL                                                            0684
*     1 * DEFINED(DS1TRBAL) BDY(BYTE),/*                     @ZA29215*/
*      2 DS1TBAL FIXED(15);         /* TRACK BALANCE         @ZA29215*/
*   DCL                                                            0685
*     1 * DEFINED(DS1RECFM) BDY(BYTE),/*                     @Z40LB35*/
*      2 * BIT(2),                  /* RESERVED              @Z40LB35*/
*      2 DS1TRKOV BIT(1);           /* TRACK OVERFLOW        @Z40LB35*/
*   DCL                                                            0686
*     EXTENTCT FIXED(31);           /* NUM OF EXTENTS CTR    @Z40LB35*/
*   DCL                                                            0687
*     EXTELEM FIXED(31);            /* EXTENT ELEMENT        @Z40LB35*/
*   DCL                                                            0688
*     FMT1EXTS FIXED(8) STATIC INITIAL(3);/*                 @Z40LB35
*                                      NUM OF PRIMARY EXTS.  @Z40LB35*/
*   DCL                                                            0689
*     FMT3EXT1 FIXED(8) INITIAL(4); /*                       @Z40LB35
*                                      NUM OF FMT3 EXTS      @Z40LB35
*                                      IN FIRST PORTION      @Z40LB35*/
*   DCL                                                            0690
*     FMT3EXT2 FIXED(8) INITIAL(9); /*                       @Z40LB35
*                                      NUM OF FMT3 EXTS      @Z40LB35
*                                      IN SECOND PORTION     @Z40LB35*/
*   DCL                                                            0691
*     FMT3ID CHAR(1) INITIAL('F3'X);/*                       @Z40LB35
*                                      FMT3 IDENTIFIER       @Z40LB35*/
*   DCL                                                            0692
*     NULLCCHH CHAR(5) STATIC INITIAL('0000000000'X);/*      @Z40LB35
*                                      NULL EXTENT           @Z40LB35*/
*   DCL                                                            0693
*     EXTENTP PTR(31);              /* EXTENT POINTER        @Z40LB35*/
*   DCL                                                            0694
*     STARTEXT FIXED(31);           /* START EXTENT          @Z40LB35*/
*   DCL                                                            0695
*     ENDEXT FIXED(31);             /* END EXTENT            @Z40LB35*/
*                                                                  0696
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSUS' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0696
*   OLDERID2=NEWERID2;                                             0696
         L     @10,@PC00001                                        0696
         L     @10,GDTTR2(,@10)                                    0696
         MVC   @TS00001(95),NEWERID2(@10)                          0696
         MVC   OLDERID2(95,@10),@TS00001                           0696
*   NEWID2='VSUS';                  /*                       @Z40LB35*/
*                                                                  0697
         MVC   NEWID2(4,@10),@CC01404                              0697
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE WILL DETERMINE WHAT TYPE           @Z40LB35*/
*   /* DATA SET WE HAVE AND SET THE PROPER TYPE              @Z40LB35*/
*   /* IN VSDSTAT.                                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   IF DS1DSPS=ON THEN              /*                       @Z40LB35*/
         TM    DS1DSPS(F1PTR),B'01000000'                          0698
         BNO   @RF00698                                            0698
*     VSDOPS=ON;                    /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0699
         MH    @10,@CH01471                                        0699
         L     @09,@PC00001+8                                      0699
         L     @09,VS3LISTP(,@09)                                  0699
         L     @09,VSDPTR(,@09)                                    0699
         AL    @09,@CF01486                                        0699
         LA    @10,VSDVARY-64(@10,@09)                             0699
         OI    VSDOPS(@10),B'01000000'                             0699
*   ELSE                            /*                       @Z40LB35*/
*     IF DS1DSPO=ON THEN            /*                       @Z40LB35*/
         B     @RC00698                                            0700
@RF00698 TM    DS1DSPO(F1PTR),B'00000010'                          0700
         BNO   @RF00700                                            0700
*       VSDOPO=ON;                  /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0701
         MH    @10,@CH01471                                        0701
         L     @09,@PC00001+8                                      0701
         L     @09,VS3LISTP(,@09)                                  0701
         L     @09,VSDPTR(,@09)                                    0701
         AL    @09,@CF01486                                        0701
         LA    @10,VSDVARY-64(@10,@09)                             0701
         OI    VSDOPO(@10),B'10000000'                             0701
*     ELSE                          /*                       @Z40LB35*/
*       IF DS1DSIS=ON THEN          /*                       @Z40LB35*/
         B     @RC00700                                            0702
@RF00700 TM    DS1DSIS(F1PTR),B'10000000'                          0702
         BNO   @RF00702                                            0702
*         VSDOIS=ON;                /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0703
         MH    @10,@CH01471                                        0703
         L     @09,@PC00001+8                                      0703
         L     @09,VS3LISTP(,@09)                                  0703
         L     @09,VSDPTR(,@09)                                    0703
         AL    @09,@CF01486                                        0703
         LA    @10,VSDVARY-64(@10,@09)                             0703
         OI    VSDOIS(@10),B'00001000'                             0703
*       ELSE                        /*                       @Z40LB35*/
*         IF DS1DSDA=ON THEN        /*                       @Z40LB35*/
         B     @RC00702                                            0704
@RF00702 TM    DS1DSDA(F1PTR),B'00100000'                          0704
         BNO   @RF00704                                            0704
*           VSDODA=ON;              /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0705
         MH    @10,@CH01471                                        0705
         L     @09,@PC00001+8                                      0705
         L     @09,VS3LISTP(,@09)                                  0705
         L     @09,VSDPTR(,@09)                                    0705
         AL    @09,@CF01486                                        0705
         LA    @10,VSDVARY-64(@10,@09)                             0705
         OI    VSDODA(@10),B'00010000'                             0705
*         ELSE                      /*                       @Z40LB35*/
*           VSDOUN=ON;              /*                       @Z40LB35*/
*                                                                  0706
         B     @RC00704                                            0706
@RF00704 LR    @10,ELEMENT                                         0706
         MH    @10,@CH01471                                        0706
         L     @09,@PC00001+8                                      0706
         L     @09,VS3LISTP(,@09)                                  0706
         L     @09,VSDPTR(,@09)                                    0706
         AL    @09,@CF01486                                        0706
         LA    @10,VSDVARY-64(@10,@09)                             0706
         OI    VSDOUN(@10),B'00100000'                             0706
*   /*****************************************************************/
*   /*                                                               */
*   /* THE UNMOVEABLE BIT WILL BE SET IF DSN IS              @Z40LB35*/
*   /* UNMOVEABLE                                            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0707
*   IF DS1DSU=ON THEN               /*                       @Z40LB35*/
@RC00704 DS    0H                                                  0707
@RC00702 DS    0H                                                  0707
@RC00700 DS    0H                                                  0707
@RC00698 TM    DS1DSU(F1PTR),B'00000001'                           0707
         BNO   @RF00707                                            0707
*     VSDOU=ON;                     /*                       @Z40LB35*/
*                                                                  0708
         LR    @10,ELEMENT                                         0708
         MH    @10,@CH01471                                        0708
         L     @09,@PC00001+8                                      0708
         L     @09,VS3LISTP(,@09)                                  0708
         L     @09,VSDPTR(,@09)                                    0708
         AL    @09,@CF01486                                        0708
         LA    @10,VSDVARY-64(@10,@09)                             0708
         OI    VSDOU(@10),B'00000100'                              0708
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE WILL DETERMINE WHAT TYPE           @Z40LB35*/
*   /* UNIT ALLOCATION THE DATA SET HAS AND SET              @Z40LB35*/
*   /* THE PROPER TYPE IN VSDSTAT.                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*   IF DS1CAL1=ON&DS1CAL2=ON THEN   /*                       @Z40LB35*/
@RF00707 TM    DS1CAL1(F1PTR),B'11000000'                          0709
         BNO   @RF00709                                            0709
*     VSDACYL=ON;                   /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0710
         MH    @10,@CH01471                                        0710
         L     @09,@PC00001+8                                      0710
         L     @09,VS3LISTP(,@09)                                  0710
         L     @09,VSDPTR(,@09)                                    0710
         AL    @09,@CF01486                                        0710
         LA    @10,VSDVARY-64(@10,@09)                             0710
         OI    VSDACYL(@10),B'10000000'                            0710
*   ELSE                            /*                       @Z40LB35*/
*     IF DS1CAL1=ON&DS1CAL2=OFF THEN/*                       @Z40LB35*/
         B     @RC00709                                            0711
@RF00709 TM    DS1CAL1(F1PTR),B'10000000'                          0711
         BNO   @RF00711                                            0711
         TM    DS1CAL2(F1PTR),B'01000000'                          0711
         BNZ   @RF00711                                            0711
*       VSDATRK=ON;                 /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0712
         MH    @10,@CH01471                                        0712
         L     @09,@PC00001+8                                      0712
         L     @09,VS3LISTP(,@09)                                  0712
         L     @09,VSDPTR(,@09)                                    0712
         AL    @09,@CF01486                                        0712
         LA    @10,VSDVARY-64(@10,@09)                             0712
         OI    VSDATRK(@10),B'01000000'                            0712
*     ELSE                          /*                       @Z40LB35*/
*       IF DS1CAL1=OFF&DS1CAL2=OFF THEN/*                    @Z40LB35*/
         B     @RC00711                                            0713
@RF00711 TM    DS1CAL1(F1PTR),B'11000000'                          0713
         BNZ   @RF00713                                            0713
*         VSDABSTR=ON;              /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0714
         MH    @10,@CH01471                                        0714
         L     @09,@PC00001+8                                      0714
         L     @09,VS3LISTP(,@09)                                  0714
         L     @09,VSDPTR(,@09)                                    0714
         AL    @09,@CF01486                                        0714
         LA    @10,VSDVARY-64(@10,@09)                             0714
         OI    VSDABSTR(@10),B'00010000'                           0714
*       ELSE                        /*                       @Z40LB35*/
*         VSDABLK=ON;               /*                       @Z40LB35*/
*                                                                  0715
         B     @RC00713                                            0715
@RF00713 LR    @10,ELEMENT                                         0715
         MH    @10,@CH01471                                        0715
         L     @09,@PC00001+8                                      0715
         L     @09,VS3LISTP(,@09)                                  0715
         L     @09,VSDPTR(,@09)                                    0715
         AL    @09,@CF01486                                        0715
         LA    @10,VSDVARY-64(@10,@09)                             0715
         OI    VSDABLK(@10),B'00100000'                            0715
*   /*****************************************************************/
*   /*                                                               */
*   /* THE SECONDARY UNIT ALLOCATION WILL BE SET             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0716
*   VSDSECAL=DS1SECAL;              /*                       @Z40LB35*/
*                                                                  0716
@RC00713 DS    0H                                                  0716
@RC00711 DS    0H                                                  0716
@RC00709 LR    @10,ELEMENT                                         0716
         MH    @10,@CH01471                                        0716
         L     @09,@PC00001+8                                      0716
         L     @09,VS3LISTP(,@09)                                  0716
         L     @09,VSDPTR(,@09)                                    0716
         AL    @09,@CF01486                                        0716
         LA    @10,VSDVARY-64(@10,@09)                             0716
         SLR   @09,@09                                             0716
         ICM   @09,7,DS1SECAL(F1PTR)                               0716
         ST    @09,VSDSECAL(,@10)                                  0716
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DATA SET IS NOT PARTITIONED OR                 @Z40LB35*/
*   /* PHYSICAL SEQUENTIAL, THE UNABLE TO CALCULATE          @Z40LB35*/
*   /* FREE SPACE BIT IS SET.                                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*   IF DS1DSPO^=ON&DS1DSPS^=ON THEN /*                       @Z40LB35*/
         TM    DS1DSPO(F1PTR),B'01000010'                          0717
         BNZ   @RF00717                                            0717
*     VSDCALFR=ON;                  /*                       @Z40LB35*/
*                                                                  0718
         OI    VSDCALFR(@10),B'10000000'                           0718
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DATA SET HAS TRACK OVERFLOW, THEN THE          @Z40LB35*/
*   /* VSDCALFR IS SET TO INDICATE UNABLE TO CAL.            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0719
*   IF DS1TRKOV=ON THEN             /*                       @Z40LB35*/
@RF00717 TM    DS1TRKOV(F1PTR),B'00100000'                         0719
         BNO   @RF00719                                            0719
*     VSDCALFR=ON;                  /*                       @Z40LB35*/
*                                                                  0720
         LR    @10,ELEMENT                                         0720
         MH    @10,@CH01471                                        0720
         L     @09,@PC00001+8                                      0720
         L     @09,VS3LISTP(,@09)                                  0720
         L     @09,VSDPTR(,@09)                                    0720
         AL    @09,@CF01486                                        0720
         LA    @10,VSDVARY-64(@10,@09)                             0720
         OI    VSDCALFR(@10),B'10000000'                           0720
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE IS A FMT3 FOR THE DATA SET AND               @Z40LB35*/
*   /* THE SPACE CAN BE CALCULATED, THE UEXCP IS             @Z40LB35*/
*   /* CALLED TO READ IT.                                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0721
*   IF VSDCALFR^=ON&DS1PTRDS^=NULLCCHH THEN/*                @Z40LB35*/
@RF00719 LR    @10,ELEMENT                                         0721
         MH    @10,@CH01471                                        0721
         L     @09,@PC00001+8                                      0721
         L     @09,VS3LISTP(,@09)                                  0721
         L     @09,VSDPTR(,@09)                                    0721
         AL    @09,@CF01486                                        0721
         LA    @10,VSDVARY-64(@10,@09)                             0721
         TM    VSDCALFR(@10),B'10000000'                           0721
         BO    @RF00721                                            0721
         CLC   DS1PTRDS(5,F1PTR),NULLCCHH                          0721
         BE    @RF00721                                            0721
*     DO;                           /*                       @Z40LB35*/
*       NOFMT3=OFF;                 /*                       @Z40LB35*/
         NI    NOFMT3,B'01111111'                                  0723
*       GETPTR=ADDR(EXGPARM2);      /*                       @Z40LB35*/
         LA    GETPTR,EXGPARM2                                     0724
*       EXGARG=''B;                 /*                       @Z40LB35*/
         XC    EXGARG(32,GETPTR),EXGARG(GETPTR)                    0725
*       EXGCTLBK=IOXPTR;            /*                       @Z40LB35*/
         L     @10,IOXPTR                                          0726
         ST    @10,EXGCTLBK(,GETPTR)                               0726
*       EXGCCHH2=ADDR(DS1PTRDS);    /*                       @Z40LB35*/
         LA    @10,DS1PTRDS(,F1PTR)                                0727
         ST    @10,EXGCCHH2(,GETPTR)                               0727
*       EXGRECNO=1;                 /*                       @Z40LB35*/
         MVC   EXGRECNO(4,GETPTR),@CF00219                         0728
*       EXGDATAP=ADDR(FMT3);        /*                       @Z40LB35*/
         LA    @10,FMT3                                            0729
         ST    @10,EXGDATAP(,GETPTR)                               0729
*       EXGKEYLN=LENGTH(DS1DSNAM);  /*                       @Z40LB35*/
         MVI   EXGKEYLN(GETPTR),X'2C'                              0730
*       EXGDATAL=LENGTH(IECSDSL3)-LENGTH(DS1DSNAM);/*        @Z40LB35*/
         MVC   EXGDATAL(2,GETPTR),@CH01243                         0731
*       CALL IDCIO050(GDTTBL,GET,EXGARG);/*                  @Z40LB35*/
         L     @10,@PC00001                                        0732
         ST    @10,@AL00001                                        0732
         LA    @09,GET                                             0732
         ST    @09,@AL00001+4                                      0732
         ST    GETPTR,@AL00001+8                                   0732
         MVI   @AL00001+8,X'80'                                    0732
         L     @15,GDTEXP(,@10)                                    0732
         LA    @01,@AL00001                                        0732
         BALR  @14,@15                                             0732
*       RESPECIFY                                                  0733
*         RTNREG RSTD;                                             0733
*       TESTRC=RTNREG;                                             0734
         STH   RTNREG,TESTRC                                       0734
*       RESPECIFY                                                  0735
*         RTNREG UNRSTD;            /*                       @Z40LB35*/
*       F3PTR=ADDR(FMT3);           /*                       @Z40LB35*/
*                                                                  0736
         LA    F3PTR,FMT3                                          0736
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE DSCB READ IS NOT A FMT3 DSCB               @Z40LB35*/
*       /* THE CODE 16 IS SET BECAUSE THE DS WAS             @Z40LB35*/
*       /* SCRATCHED OUT FROM UNDER US.                      @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0737
*       IF DS3FMTID^=FMT3ID&TESTRC=0 THEN/*                  @Z40LB35*/
         CLC   DS3FMTID(1,F3PTR),FMT3ID                            0737
         BE    @RF00737                                            0737
         LH    @10,TESTRC                                          0737
         LTR   @10,@10                                             0737
         BNZ   @RF00737                                            0737
*         TESTRC=DSNSCRAT;          /*                       @Z40LB35*/
         MVC   TESTRC(2),@CH00506                                  0738
*     END;                          /*                       @Z40LB35*/
*                                                                  0739
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE SET NO FMT3 DSCB SWITCH.                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0740
*   ELSE                            /*                       @Z40LB35*/
*     NOFMT3=ON;                    /*                       @Z40LB35*/
*                                                                  0740
         B     @RC00721                                            0740
@RF00721 OI    NOFMT3,B'10000000'                                  0740
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE WILL CALCULATE THE                 @Z40LB35*/
*   /* SPACE ALLOCATED BY THE DSN.                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0741
*   EXTENTCT=0;                     /*                       @Z40LB35*/
@RC00721 SLR   EXTENTCT,EXTENTCT                                   0741
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0742
         LTR   @10,@10                                             0742
         BNZ   @RF00742                                            0742
*     EXTENTP=ADDR(DS1EXT1);        /*                       @Z40LB35*/
*                                                                  0743
         LA    EXTENTP,DS1EXT1(,F1PTR)                             0743
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THRU THE PRIMARY EXTENTS                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
@RF00742 LH    @10,TESTRC                                          0744
         LTR   @10,@10                                             0744
         BNZ   @RF00744                                            0744
*     DO EXTELEM=1 TO FMT1EXTS WHILE DSBG^=0;/*              @Z40LB35*/
         LA    EXTELEM,1                                           0745
         B     @DE00745                                            0745
@DL00745 ICM   @10,15,DSBG(EXTENTP)                                0745
         BZ    @DC00745                                            0745
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/
         LH    @15,TRACKSIZ                                        0746
         LR    STARTEXT,@15                                        0746
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0746
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0746
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/
         LA    @14,1                                               0747
         MH    @15,DSENCYLS(,EXTENTP)                              0747
         AH    @15,DSENTRKS(,EXTENTP)                              0747
         ALR   @15,@14                                             0747
         LR    ENDEXT,@15                                          0747
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/
         LR    @15,ELEMENT                                         0748
         MH    @15,@CH01471                                        0748
         L     @01,@PC00001+8                                      0748
         L     @01,VS3LISTP(,@01)                                  0748
         L     @01,VSDPTR(,@01)                                    0748
         AL    @01,@CF01486                                        0748
         LA    @15,VSDVARY-64(@15,@01)                             0748
         LR    @01,ENDEXT                                          0748
         AH    @01,VSDTRKS(,@15)                                   0748
         SLR   @01,STARTEXT                                        0748
         STH   @01,VSDTRKS(,@15)                                   0748
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/
         ALR   EXTENTCT,@14                                        0749
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/
         AL    EXTENTP,@CF00476                                    0750
*     END;                          /*                       @Z40LB35*/
*                                                                  0751
         AL    EXTELEM,@CF00219                                    0751
@DE00745 SLR   @10,@10                                             0751
         IC    @10,FMT1EXTS                                        0751
         CR    EXTELEM,@10                                         0751
         BNH   @DL00745                                            0751
@DC00745 DS    0H                                                  0752
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THRU THE SECONDARY EXTENTS                     @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0752
*   EXTENTP=ADDR(DS3EXTNT);         /*                       @Z40LB35*/
@RF00744 LA    EXTENTP,DS3EXTNT(,F3PTR)                            0752
*   IF TESTRC=0&NOFMT3^=ON THEN     /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0753
         LTR   @10,@10                                             0753
         BNZ   @RF00753                                            0753
         TM    NOFMT3,B'10000000'                                  0753
         BO    @RF00753                                            0753
*     DO EXTELEM=1 TO FMT3EXT1 WHILE DSBG^=0;/*              @Z40LB35*/
         LA    EXTELEM,1                                           0754
         B     @DE00754                                            0754
@DL00754 ICM   @10,15,DSBG(EXTENTP)                                0754
         BZ    @DC00754                                            0754
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/
         LH    @15,TRACKSIZ                                        0755
         LR    STARTEXT,@15                                        0755
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0755
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0755
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/
         LA    @14,1                                               0756
         MH    @15,DSENCYLS(,EXTENTP)                              0756
         AH    @15,DSENTRKS(,EXTENTP)                              0756
         ALR   @15,@14                                             0756
         LR    ENDEXT,@15                                          0756
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/
         LR    @15,ELEMENT                                         0757
         MH    @15,@CH01471                                        0757
         L     @01,@PC00001+8                                      0757
         L     @01,VS3LISTP(,@01)                                  0757
         L     @01,VSDPTR(,@01)                                    0757
         AL    @01,@CF01486                                        0757
         LA    @15,VSDVARY-64(@15,@01)                             0757
         LR    @01,ENDEXT                                          0757
         AH    @01,VSDTRKS(,@15)                                   0757
         SLR   @01,STARTEXT                                        0757
         STH   @01,VSDTRKS(,@15)                                   0757
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/
         ALR   EXTENTCT,@14                                        0758
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/
         AL    EXTENTP,@CF00476                                    0759
*     END;                          /*                       @Z40LB35*/
*                                                                  0760
         AL    EXTELEM,@CF00219                                    0760
@DE00754 SLR   @10,@10                                             0760
         IC    @10,FMT3EXT1                                        0760
         CR    EXTELEM,@10                                         0760
         BNH   @DL00754                                            0760
@DC00754 DS    0H                                                  0761
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THRU THE LAST HALF OF SECONDARY EXTS           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*   EXTENTP=ADDR(DS3ADEXT);         /*                       @Z40LB35*/
@RF00753 LA    EXTENTP,DS3ADEXT(,F3PTR)                            0761
*   IF TESTRC=0&NOFMT3^=ON THEN     /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0762
         LTR   @10,@10                                             0762
         BNZ   @RF00762                                            0762
         TM    NOFMT3,B'10000000'                                  0762
         BO    @RF00762                                            0762
*     DO EXTELEM=1 TO FMT3EXT2 WHILE DSBG^=0;/*              @Z40LB35*/
         LA    EXTELEM,1                                           0763
         B     @DE00763                                            0763
@DL00763 ICM   @10,15,DSBG(EXTENTP)                                0763
         BZ    @DC00763                                            0763
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/
         LH    @15,TRACKSIZ                                        0764
         LR    STARTEXT,@15                                        0764
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0764
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0764
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/
         LA    @14,1                                               0765
         MH    @15,DSENCYLS(,EXTENTP)                              0765
         AH    @15,DSENTRKS(,EXTENTP)                              0765
         ALR   @15,@14                                             0765
         LR    ENDEXT,@15                                          0765
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/
         LR    @15,ELEMENT                                         0766
         MH    @15,@CH01471                                        0766
         L     @01,@PC00001+8                                      0766
         L     @01,VS3LISTP(,@01)                                  0766
         L     @01,VSDPTR(,@01)                                    0766
         AL    @01,@CF01486                                        0766
         LA    @15,VSDVARY-64(@15,@01)                             0766
         LR    @01,ENDEXT                                          0766
         AH    @01,VSDTRKS(,@15)                                   0766
         SLR   @01,STARTEXT                                        0766
         STH   @01,VSDTRKS(,@15)                                   0766
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/
         ALR   EXTENTCT,@14                                        0767
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/
         AL    EXTENTP,@CF00476                                    0768
*     END;                          /*                       @Z40LB35*/
         AL    EXTELEM,@CF00219                                    0769
@DE00763 SLR   @10,@10                                             0769
         IC    @10,FMT3EXT2                                        0769
         CR    EXTELEM,@10                                         0769
         BNH   @DL00763                                            0769
@DC00763 DS    0H                                                  0770
*   VSDEXTS=EXTENTCT;               /*                       @Z40LB35*/
*                                                                  0770
@RF00762 LR    @10,ELEMENT                                         0770
         MH    @10,@CH01471                                        0770
         L     @09,@PC00001+8                                      0770
         L     @09,VS3LISTP(,@09)                                  0770
         L     @09,VSDPTR(,@09)                                    0770
         AL    @09,@CF01486                                        0770
         LA    @10,VSDVARY-64(@10,@09)                             0770
         STC   EXTENTCT,VSDEXTS(,@10)                              0770
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE FREE SPACE.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0771
*   VSDFTRK=0;                      /* ZERO FREE SPACE       @ZA29215*/
         SLR   @09,@09                                             0771
         STH   @09,VSDFTRK(,@10)                                   0771
*   IF TESTRC=0&VSDCALFR^=ON THEN   /*                       @Z40LB35*/
         CH    @09,TESTRC                                          0772
         BNE   @RF00772                                            0772
         TM    VSDCALFR(@10),B'10000000'                           0772
         BO    @RF00772                                            0772
*     DO;                           /*                       @Z40LB35*/
*       IF DS1LSTR^=0 THEN          /*                       @Z40LB35*/
         CLI   DS1LSTR(F1PTR),0                                    0774
         BE    @RF00774                                            0774
*         VSDFTRK=VSDTRKS-(DS1LSTTT+1);/*                    @Z40LB35*/
         LA    @09,1                                               0775
         ICM   @15,12,DS1LSTTT(F1PTR)                              0775
         SRA   @15,16                                              0775
         ALR   @09,@15                                             0775
         LCR   @09,@09                                             0775
         AH    @09,VSDTRKS(,@10)                                   0775
         STH   @09,VSDFTRK(,@10)                                   0775
*       ELSE                        /*                       @Z40LB35*/
*         IF DS1TBAL^=0 THEN        /* IF NON-ZERO, VALID    @ZA29215*/
         B     @RC00774                                            0776
@RF00774 ICM   @10,3,DS1TBAL(F1PTR)                                0776
         BZ    @RF00776                                            0776
*           VSDFTRK=VSDTRKS-DS1LSTTT;/*                      @Z40LB35*/
         LR    @10,ELEMENT                                         0777
         MH    @10,@CH01471                                        0777
         L     @09,@PC00001+8                                      0777
         L     @09,VS3LISTP(,@09)                                  0777
         L     @09,VSDPTR(,@09)                                    0777
         AL    @09,@CF01486                                        0777
         LA    @10,VSDVARY-64(@10,@09)                             0777
         LH    @09,VSDTRKS(,@10)                                   0777
         ICM   @15,12,DS1LSTTT(F1PTR)                              0777
         SRA   @15,16                                              0777
         SLR   @09,@15                                             0777
         STH   @09,VSDFTRK(,@10)                                   0777
*         ELSE                      /* IF ZERO, INVALID      @ZA29215*/
*           VSDCALFR=ON;            /* SET CANNOT CALCULATE  @ZA20215*/
         B     @RC00776                                            0778
@RF00776 LR    @10,ELEMENT                                         0778
         MH    @10,@CH01471                                        0778
         L     @09,@PC00001+8                                      0778
         L     @09,VS3LISTP(,@09)                                  0778
         L     @09,VSDPTR(,@09)                                    0778
         AL    @09,@CF01486                                        0778
         LA    @10,VSDVARY-64(@10,@09)                             0778
         OI    VSDCALFR(@10),B'10000000'                           0778
*     END;                          /*                       @Z40LB35*/
*                                                                  0779
@RC00776 DS    0H                                                  0779
@RC00774 DS    0H                                                  0780
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0780
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00772 LH    @15,TESTRC                                          0780
         L     @14,@SA00010                                        0780
         LM    @00,@02,@SA00010+8                                  0780
         LM    @04,@07,@SA00010+20                                 0780
         LM    @09,@12,@SA00010+36                                 0780
         BR    @14                                                 0780
*   END USAGE;                      /*                       @Z40LB35*/
*                                                                  0782
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - STATUS                                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE INITIALIZES THE VSDSTAT       @Z40LB35*/
*/*             PORTION OF THE VSDBLOCK.                     @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1CREDT FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS1EXPDT FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             DS1DSIND FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/
*/*             LCTCREAT OF THE LCTINFO                      @Z40LB35*/
*/*             LCTEXPIR OF THE LCTINFO                      @Z40LB35*/
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/
*/*             LCTOWNER OF THE LCTINFO                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    VSDCVSAM OF VSDSTAT                          @Z40LB35*/
*/*             VSDCREAT OF VSDSTAT                          @Z40LB35*/
*/*             VSDVTOCC OF VSDSTAT                          @Z40LB35*/
*/*             VSDVTOCE OF VSDSTAT                          @Z40LB35*/
*/*             VSDVSAMC OF VSDSTAT                          @Z40LB35*/
*/*             VSDVSAME OF VSDSTAT                          @Z40LB35*/
*/*             VSDVSAMC OF VSDSTAT                          @Z40LB35*/
*/*             VSDEXPIR OF VSDSTAT                          @Z40LB35*/
*/*             VSDCREAT OF VSDSTAT                          @Z40LB35*/
*/*             VSDOWNER OF VSDSTAT                          @Z40LB35*/
*/*             VSDPWR   OF VSDSTAT                          @Z40LB35*/
*/*             VSDPWW   OF VSDSTAT                          @Z40LB35*/
*/*             VSDPROT  OF VSDSTAT                          @Z40LB35*/
*/*             VSDRACF  OF VSDSTAT                          @G24LB31*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0782
*                                   /*                       @Z40LB35*/
*STATUS:                                                           0782
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0782
STATUS   STM   @14,@12,12(@13)                                     0782
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE MAPS THE PROTECTION           @Z40LB35*/
*   /* BITS IN THE FMT1 DSCBS                                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0783
*   DCL                                                            0783
*     1 * DEFINED(DS1DSIND),        /*                       @Z40LB35*/
*      2 * BIT(1),                  /*                       @G24LB31*/
*      2 DS1RACF BIT(1),            /* RACF PROTECTED        @G24LB31*/
*      2 * BIT(1),                  /*                       @G24LB31*/
*      2 DS1PW BIT(1),              /* PROTECTED             @Z40LB35*/
*      2 * BIT(1),                  /*                       @Z40LB35*/
*      2 DS1PWW BIT(1);             /* WRITE PROTECTED       @Z40LB35*/
*                                                                  0784
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSST' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0784
*   OLDERID2=NEWERID2;                                             0784
         L     @10,@PC00001                                        0784
         L     @10,GDTTR2(,@10)                                    0784
         MVC   @TS00001(95),NEWERID2(@10)                          0784
         MVC   OLDERID2(95,@10),@TS00001                           0784
*   NEWID2='VSST';                  /*                       @Z40LB35*/
*                                                                  0785
         MVC   NEWID2(4,@10),@CC01415                              0785
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DSN WAS LOCATED IN THE CATLG,                  @Z40LB35*/
*   /* THE VSAM BIT IS CHECKED TO DETERMINE                  @Z40LB35*/
*   /* IF THE DSN WAS FOUND IN THE VSAM                      @Z40LB35*/
*   /* CATLG.                                                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0786
*   IF LOCATESW=ON THEN             /*                       @Z40LB35*/
         TM    LOCATESW,B'10000000'                                0786
         BNO   @RF00786                                            0786
*     DO;                           /*                       @Z40LB35*/
*       VSDCATLG=ON;                /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0788
         MH    @10,@CH01471                                        0788
         L     @03,@PC00001+8                                      0788
         L     @03,VS3LISTP(,@03)                                  0788
         L     @03,VSDPTR(,@03)                                    0788
         AL    @03,@CF01486                                        0788
         LA    @10,VSDVARY-64(@10,@03)                             0788
         OI    VSDCATLG(@10),B'00001000'                           0788
*       IF LCTVSCAT=ON THEN         /*                       @Z40LB35*/
*                                                                  0789
         LA    @03,LCTAREA                                         0789
         TM    LCTVSCAT(@03),B'10000000'                           0789
         BNO   @RF00789                                            0789
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DSN WAS FOUND IN THE VSAM CATLG,         @Z40LB35*/
*         /* THE EXPIRATION AND CREATION DATES ARE           @Z40LB35*/
*         /* COMPARED WITH THE DSCB TO FIND OUT WHICH        @Z40LB35*/
*         /* HAS THE LATER DATES.                            @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0790
*         DO;                       /*                       @Z40LB35*/
*           VSDCVSAM=ON;            /*                       @Z40LB35*/
*                                                                  0791
         OI    VSDCVSAM(@10),B'00000100'                           0791
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VSAM CREATION DATE IS EQUAL OR         @Z40LB35*/
*           /* GREATER, IT IS USED AND RETURNED TO           @Z40LB35*/
*           /* THE CALLER.                                   @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0792
*           IF CATCREAT>=DSCREAT&CATCREAT^=NULLENTY THEN           0792
         L     @03,CATCREAT(,@03)                                  0792
         SLR   @15,@15                                             0792
         ICM   @15,7,DSCREAT(F1PTR)                                0792
         CR    @03,@15                                             0792
         BL    @RF00792                                            0792
         C     @03,NULLENTY                                        0792
         BE    @RF00792                                            0792
*             DO;                   /*                       @Z40LB35*/
*               VSDCREAT=CATCREAT;  /*                       @Z40LB35*/
         ST    @03,VSDCREAT(,@10)                                  0794
*               VSDVSAMC=ON;        /*                       @Z40LB35*/
         OI    VSDVSAMC(@10),B'00100000'                           0795
*             END;                  /*                       @Z40LB35*/
*                                                                  0796
*           /*********************************************************/
*           /*                                                       */
*           /* OTHERWISE THE FMT1 DSCB CREATION DATE         @Z40LB35*/
*           /* IS RETURNED.                                  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0797
*           ELSE                    /*                       @Z40LB35*/
*             DO;                   /*                       @Z40LB35*/
         B     @RC00792                                            0797
@RF00792 DS    0H                                                  0798
*               VSDCREAT=DSCREAT;   /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0798
         MH    @10,@CH01471                                        0798
         L     @03,@PC00001+8                                      0798
         L     @03,VS3LISTP(,@03)                                  0798
         L     @03,VSDPTR(,@03)                                    0798
         AL    @03,@CF01486                                        0798
         LA    @10,VSDVARY-64(@10,@03)                             0798
         SLR   @03,@03                                             0798
         ICM   @03,7,DSCREAT(F1PTR)                                0798
         ST    @03,VSDCREAT(,@10)                                  0798
*               VSDVTOCC=ON;        /*                       @Z40LB35*/
         OI    VSDVTOCC(@10),B'10000000'                           0799
*             END;                  /*                       @Z40LB35*/
*                                                                  0800
*           /*********************************************************/
*           /*                                                       */
*           /* IF BOTH DATES ARE EQUAL, THEN SET             @Z40LB35*/
*           /* BOTH BITS INDICATING TO THE CALLER            @Z40LB35*/
*           /* THAT THEY ARE EQUAL.                          @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0801
*           IF CATCREAT=DSCREAT&CATCREAT^=NULLENTY THEN            0801
@RC00792 LA    @10,LCTAREA                                         0801
         L     @10,CATCREAT(,@10)                                  0801
         SLR   @03,@03                                             0801
         ICM   @03,7,DSCREAT(F1PTR)                                0801
         CR    @10,@03                                             0801
         BNE   @RF00801                                            0801
         C     @10,NULLENTY                                        0801
         BE    @RF00801                                            0801
*             VSDVTOCC=ON;          /*                       @Z40LB35*/
*                                                                  0802
         LR    @10,ELEMENT                                         0802
         MH    @10,@CH01471                                        0802
         L     @03,@PC00001+8                                      0802
         L     @03,VS3LISTP(,@03)                                  0802
         L     @03,VSDPTR(,@03)                                    0802
         AL    @03,@CF01486                                        0802
         LA    @10,VSDVARY-64(@10,@03)                             0802
         OI    VSDVTOCC(@10),B'10000000'                           0802
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE VSAM EXPIRATION DATE IS EQUAL OR       @Z40LB35*/
*           /* GREATER, IT IS USED AND RETURNED TO           @Z40LB35*/
*           /* THE CALLER.                                   @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0803
*           IF CATEXPIR>=DSEXPIR&CATEXPIR^=NULLENTY THEN           0803
@RF00801 LA    @10,LCTAREA                                         0803
         L     @10,CATEXPIR(,@10)                                  0803
         SLR   @03,@03                                             0803
         ICM   @03,7,DSEXPIR(F1PTR)                                0803
         CR    @10,@03                                             0803
         BL    @RF00803                                            0803
         C     @10,NULLENTY                                        0803
         BE    @RF00803                                            0803
*             DO;                   /*                       @Z40LB35*/
*               VSDEXPIR=CATEXPIR;  /*                       @Z40LB35*/
         LR    @03,ELEMENT                                         0805
         MH    @03,@CH01471                                        0805
         L     @15,@PC00001+8                                      0805
         L     @01,VS3LISTP(,@15)                                  0805
         L     @01,VSDPTR(,@01)                                    0805
         AL    @01,@CF01486                                        0805
         LA    @03,VSDVARY-64(@03,@01)                             0805
         ST    @10,VSDEXPIR(,@03)                                  0805
*               VSDVSAME=ON;        /*                       @Z40LB35*/
         OI    VSDVSAME(@03),B'00010000'                           0806
*             END;                  /*                       @Z40LB35*/
*                                                                  0807
*           /*********************************************************/
*           /*                                                       */
*           /* OTHERWISE THE FMT1 DSCB EXPIRATION DATE       @Z40LB35*/
*           /* IS RETURNED.                                  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0808
*           ELSE                    /*                       @Z40LB35*/
*             DO;                   /*                       @Z40LB35*/
         B     @RC00803                                            0808
@RF00803 DS    0H                                                  0809
*               VSDEXPIR=DSEXPIR;   /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0809
         MH    @10,@CH01471                                        0809
         L     @03,@PC00001+8                                      0809
         L     @03,VS3LISTP(,@03)                                  0809
         L     @03,VSDPTR(,@03)                                    0809
         AL    @03,@CF01486                                        0809
         LA    @10,VSDVARY-64(@10,@03)                             0809
         SLR   @03,@03                                             0809
         ICM   @03,7,DSEXPIR(F1PTR)                                0809
         ST    @03,VSDEXPIR(,@10)                                  0809
*               VSDVTOCE=ON;        /*                       @Z40LB35*/
         OI    VSDVTOCE(@10),B'01000000'                           0810
*             END;                  /*                       @Z40LB35*/
*                                                                  0811
*           /*********************************************************/
*           /*                                                       */
*           /* IF BOTH DATES ARE EQUAL, THEN SET             @Z40LB35*/
*           /* BOTH BITS INDICATING TO THE CALLER            @Z40LB35*/
*           /* THAT THEY ARE EQUAL.                          @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0812
*           IF CATEXPIR=DSEXPIR&CATEXPIR^=NULLENTY THEN            0812
@RC00803 LA    @10,LCTAREA                                         0812
         L     @10,CATEXPIR(,@10)                                  0812
         SLR   @03,@03                                             0812
         ICM   @03,7,DSEXPIR(F1PTR)                                0812
         CR    @10,@03                                             0812
         BNE   @RF00812                                            0812
         C     @10,NULLENTY                                        0812
         BE    @RF00812                                            0812
*             VSDVTOCE=ON;          /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0813
         MH    @10,@CH01471                                        0813
         L     @03,@PC00001+8                                      0813
         L     @03,VS3LISTP(,@03)                                  0813
         L     @03,VSDPTR(,@03)                                    0813
         AL    @03,@CF01486                                        0813
         LA    @10,VSDVARY-64(@10,@03)                             0813
         OI    VSDVTOCE(@10),B'01000000'                           0813
*           VSDOWNER=LCTOWNER;      /*                       @Z40LB35*/
@RF00812 LR    @10,ELEMENT                                         0814
         MH    @10,@CH01471                                        0814
         L     @03,@PC00001+8                                      0814
         L     @03,VS3LISTP(,@03)                                  0814
         L     @03,VSDPTR(,@03)                                    0814
         AL    @03,@CF01486                                        0814
         LA    @10,VSDVARY-64(@10,@03)                             0814
         LA    @03,LCTAREA                                         0814
         MVC   VSDOWNER(8,@10),LCTOWNER(@03)                       0814
*         END;                      /*                       @Z40LB35*/
*       ELSE                        /*                       @Z40LB35*/
*         DO;                       /*                       @Z40LB35*/
         B     @RC00789                                            0816
@RF00789 DS    0H                                                  0817
*           VSDOWNER=BLANK;         /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0817
         MH    @10,@CH01471                                        0817
         L     @03,@PC00001+8                                      0817
         L     @03,VS3LISTP(,@03)                                  0817
         L     @03,VSDPTR(,@03)                                    0817
         AL    @03,@CF01486                                        0817
         LA    @10,VSDVARY-64(@10,@03)                             0817
         MVI   VSDOWNER+1(@10),C' '                                0817
         MVC   VSDOWNER+2(6,@10),VSDOWNER+1(@10)                   0817
         MVC   VSDOWNER(1,@10),BLANK                               0817
*           VSDVTOCC=ON;            /*                       @Z40LB35*/
*           VSDVTOCE=ON;            /*                       @Z40LB35*/
         OI    VSDVTOCC(@10),B'11000000'                           0819
*           VSDCREAT=DSCREAT;       /*                       @Z40LB35*/
         SLR   @03,@03                                             0820
         ICM   @03,7,DSCREAT(F1PTR)                                0820
         ST    @03,VSDCREAT(,@10)                                  0820
*           VSDEXPIR=DSEXPIR;       /*                       @Z40LB35*/
         SLR   @03,@03                                             0821
         ICM   @03,7,DSEXPIR(F1PTR)                                0821
         ST    @03,VSDEXPIR(,@10)                                  0821
*         END;                      /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0823
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DSN NOT FOUND IN A CATLG, THE DATES                @Z40LB35*/
*   /* FOUND IN THE FMT1 DSCB ARE RETURNED.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0824
*   ELSE                            /*                       @Z40LB35*/
*     DO;                           /*                       @Z40LB35*/
         B     @RC00786                                            0824
@RF00786 DS    0H                                                  0825
*       VSDOWNER=BLANK;             /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0825
         MH    @10,@CH01471                                        0825
         L     @03,@PC00001+8                                      0825
         L     @03,VS3LISTP(,@03)                                  0825
         L     @03,VSDPTR(,@03)                                    0825
         AL    @03,@CF01486                                        0825
         LA    @10,VSDVARY-64(@10,@03)                             0825
         MVI   VSDOWNER+1(@10),C' '                                0825
         MVC   VSDOWNER+2(6,@10),VSDOWNER+1(@10)                   0825
         MVC   VSDOWNER(1,@10),BLANK                               0825
*       VSDVTOCC=ON;                /*                       @Z40LB35*/
*       VSDVTOCE=ON;                /*                       @Z40LB35*/
         OI    VSDVTOCC(@10),B'11000000'                           0827
*       VSDCREAT=DSCREAT;           /*                       @Z40LB35*/
         SLR   @03,@03                                             0828
         ICM   @03,7,DSCREAT(F1PTR)                                0828
         ST    @03,VSDCREAT(,@10)                                  0828
*       VSDEXPIR=DSEXPIR;           /*                       @Z40LB35*/
         SLR   @03,@03                                             0829
         ICM   @03,7,DSEXPIR(F1PTR)                                0829
         ST    @03,VSDEXPIR(,@10)                                  0829
*     END;                          /*                       @Z40LB35*/
*                                                                  0830
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DSN IS TESTED TO DETERMINE                   @Z40LB35*/
*   /* WHETHER OR NOT THE DSN IS PROTECTED.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0831
*   IF(DS1PW=ON)(DS1RACF=ON) THEN  /*                       @G24LB31*/
*                                                                  0831
@RC00786 TM    DS1PW(F1PTR),B'01010000'                            0831
         BZ    @RF00831                                            0831
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DSN IS PROTECTED, THE TYPE PROTECTION        @Z40LB35*/
*     /* IS RETURNED.                                        @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0832
*     DO;                           /*                       @Z40LB35*/
*       VSDPROT=ON;                 /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0833
         MH    @10,@CH01471                                        0833
         L     @03,@PC00001+8                                      0833
         L     @03,VS3LISTP(,@03)                                  0833
         L     @03,VSDPTR(,@03)                                    0833
         AL    @03,@CF01486                                        0833
         LA    @10,VSDVARY-64(@10,@03)                             0833
         OI    VSDPROT(@10),B'00100000'                            0833
*       IF DS1RACF=ON THEN          /*                       @G24LB31*/
         TM    DS1RACF(F1PTR),B'01000000'                          0834
         BNO   @RF00834                                            0834
*         VSDRACF=ON;               /* RACF                  @G24LB31*/
         OI    VSDRACF(@10),B'00001000'                            0835
*       IF DS1PWW=ON THEN           /*                       @Z40LB35*/
@RF00834 TM    DS1PWW(F1PTR),B'00000100'                           0836
         BNO   @RF00836                                            0836
*         VSDPWW=ON;                /* WRITE                 @G24LB31*/
         LR    @10,ELEMENT                                         0837
         MH    @10,@CH01471                                        0837
         L     @03,@PC00001+8                                      0837
         L     @03,VS3LISTP(,@03)                                  0837
         L     @03,VSDPTR(,@03)                                    0837
         AL    @03,@CF01486                                        0837
         LA    @10,VSDVARY-64(@10,@03)                             0837
         OI    VSDPWW(@10),B'01000000'                             0837
*       ELSE                        /*                       @G24LB31*/
*         IF DS1PW=ON THEN          /*                       @G24LB31*/
         B     @RC00836                                            0838
@RF00836 TM    DS1PW(F1PTR),B'00010000'                            0838
         BNO   @RF00838                                            0838
*           VSDPWR=ON;              /* READ/WRITE            @G24LB31*/
         LR    @10,ELEMENT                                         0839
         MH    @10,@CH01471                                        0839
         L     @03,@PC00001+8                                      0839
         L     @03,VS3LISTP(,@03)                                  0839
         L     @03,VSDPTR(,@03)                                    0839
         AL    @03,@CF01486                                        0839
         LA    @10,VSDVARY-64(@10,@03)                             0839
         OI    VSDPWR(@10),B'10000000'                             0839
*     END;                          /*                       @Z40LB35*/
*                                                                  0840
@RF00838 DS    0H                                                  0840
@RC00836 DS    0H                                                  0841
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE CODE         @Z40LB35*/
*   /* ZERO BECAUSE THERE ARE NO LOGICAL ERRORS              @Z40LB35*/
*   /* POSSIBLE.                                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*   RETURN CODE(0);                 /*                       @Z40LB35*/
@RF00831 SLR   @15,@15                                             0841
         L     @14,12(,@13)                                        0841
         LM    @00,@12,20(@13)                                     0841
         BR    @14                                                 0841
*   END STATUS;                     /*                       @Z40LB35*/
*                                                                  0843
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - CATLG                                   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE ISSUES ULOCATE AND DETERMINES @Z40LB35*/
*/*             IF A DATA SET IS CATALOGED IN A VSAM OR OS   @Z40LB35*/
*/*             CATALOG.                                     @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3SCR   OF THE VS3AGL                       @Z40LB35*/
*/*             VS3UNCAT OF THE VS3AGL                       @Z40LB35*/
*/*             VS3DEV   OF THE VS3AGL                       @Z40LB35*/
*/*             VS3VOL   OF THE VS3AGL                       @Z40LB35*/
*/*             DS1DSNAM OF THE IECDSF1 DSCB FMT 1           @Z40LB35*/
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    VSDVSAMC OF VSDSCR                           @Z40LB35*/
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                           8, ERROR IN ULOCATE            @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0843
*                                   /*                       @Z40LB35*/
*CATLG:                                                            0843
*   PROC;                           /*                       @Z40LB35*/
CATLG    STM   @14,@12,@SA00012                                    0843
*                                                                  0844
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSCG' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*   OLDERID2=NEWERID2;                                             0844
         L     @10,@PC00001                                        0844
         L     @03,GDTTR2(,@10)                                    0844
         MVC   @TS00001(95),NEWERID2(@03)                          0844
         MVC   OLDERID2(95,@03),@TS00001                           0844
*   NEWID2='VSCG';                  /*                       @Z40LB35*/
*                                                                  0845
         MVC   NEWID2(4,@03),@CC01419                              0845
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE LOCATE IN CATLG SWITCH OFF.            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0846
*   LOCATESW=OFF;                   /*                       @Z40LB35*/
*                                                                  0846
         NI    LOCATESW,B'01111111'                                0846
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE ULOCATE TO DETERMINE WHETHER A DSN              @Z40LB35*/
*   /* IS CATLG OR NOT.                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0847
*   LCTINFO=''B;                    /*                       @Z40LB35*/
         LA    @03,LCTAREA                                         0847
         XC    LCTINFO(33,@03),LCTINFO(@03)                        0847
*   LCTINFOP=ADDR(LCTINFO);         /*                       @Z40LB35*/
         ST    @03,LCTINFOP                                        0848
*   CALL IDCSALC0(GDTTBL,DS1DSNAM,VS3VOL,VS3DEV,LCTINFOP);/* @Z40LB35*/
         ST    @10,@AL00001                                        0849
         ST    F1PTR,@AL00001+4                                    0849
         L     @03,@PC00001+8                                      0849
         LA    @15,VS3VOL(,@03)                                    0849
         ST    @15,@AL00001+8                                      0849
         LA    @03,VS3DEV(,@03)                                    0849
         ST    @03,@AL00001+12                                     0849
         LA    @03,LCTINFOP                                        0849
         ST    @03,@AL00001+16                                     0849
         MVI   @AL00001+16,X'80'                                   0849
         L     @15,GDTLOC(,@10)                                    0849
         LA    @01,@AL00001                                        0849
         BALR  @14,@15                                             0849
*   RESPECIFY                                                      0850
*     RTNREG RSTD;                                                 0850
*   TESTRC=RTNREG;                                                 0851
         STH   RTNREG,TESTRC                                       0851
*   RESPECIFY                                                      0852
*     RTNREG UNRSTD;                /*                       @Z40LB35*/
*                                                                  0852
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DSN IS CATLG AND THE USER WANTED                 @Z40LB35*/
*   /* ONLY DSNS THAT ARE NOT CATLG, THE DOES NOT            @Z40LB35*/
*   /* MEET THE CRITERION CODE IS SET.                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0853
*   IF TESTRC=0&VS3UNCAT=ON THEN    /*                       @Z40LB35*/
         LH    @10,TESTRC                                          0853
         LTR   @10,@10                                             0853
         BNZ   @RF00853                                            0853
         L     @10,@PC00001+8                                      0853
         TM    VS3UNCAT(@10),B'00010000'                           0853
         BNO   @RF00853                                            0853
*     TESTRC=NOMEET;                /*                       @Z40LB35*/
*                                                                  0854
         LH    @10,NOMEET                                          0854
         STH   @10,TESTRC                                          0854
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DSN WAS LOCATED IN A CATLG,                    @Z40LB35*/
*   /* THE VOLUME COUNT IS MOVED INTO                        @Z40LB35*/
*   /* THE VSDBLOCK.                                         @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0855
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/
@RF00853 LH    @10,TESTRC                                          0855
         LTR   @10,@10                                             0855
         BNZ   @RF00855                                            0855
*     DO;                           /*                       @Z40LB35*/
*       VSDVOLCT(ELEMENT)=LCTMULVC; /*                       @Z40LB35*/
         LR    @10,ELEMENT                                         0857
         MH    @10,@CH01471                                        0857
         L     @03,@PC00001+8                                      0857
         L     @03,VS3LISTP(,@03)                                  0857
         L     @03,VSDPTR(,@03)                                    0857
         LA    @15,LCTAREA                                         0857
         L     @15,LCTMULVC(,@15)                                  0857
         AL    @03,@CF01485                                        0857
         ST    @15,VSDVOLCT-16(@10,@03)                            0857
*       LOCATESW=ON;                /*                       @Z40LB35*/
         OI    LOCATESW,B'10000000'                                0858
*     END;                          /*                       @Z40LB35*/
*                                                                  0859
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DSN WAS NOT LOCATED IN A CATLG,                @Z40LB35*/
*   /* THE VOLUME COUNT IS SET TO ONE.                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0860
*   ELSE                            /*                       @Z40LB35*/
*     VSDVOLCT(ELEMENT)=1;          /*                       @Z40LB35*/
*                                                                  0860
         B     @RC00855                                            0860
@RF00855 LR    @10,ELEMENT                                         0860
         MH    @10,@CH01471                                        0860
         L     @03,@PC00001+8                                      0860
         L     @03,VS3LISTP(,@03)                                  0860
         L     @03,VSDPTR(,@03)                                    0860
         LA    @15,1                                               0860
         AL    @03,@CF01485                                        0860
         ST    @15,VSDVOLCT-16(@10,@03)                            0860
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ULOCATE HAS ISSUED A MESSAGE ABOUT CATLG           @Z40LB35*/
*   /* CONFLICT PROBLEMS OR OTHER CATLG PROBLEMS,            @Z40LB35*/
*   /* THE DOES NOT MEET CRITERIA CODE IS SET.               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0861
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/
@RC00855 CLC   TESTRC(2),@CH00041                                  0861
         BNE   @RF00861                                            0861
*     MSGSENT=ON;                   /*                       @Z40LB35*/
*                                                                  0862
         OI    MSGSENT,B'10000000'                                 0862
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SCRDSET SERVICE IS THE CALLER,                 @Z40LB35*/
*   /* INITIALIZE THE CATLG INFO IN THE                      @Z40LB35*/
*   /* VSDSCR PORTION OF THE VSDBLOCK.                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0863
*   IF TESTRC=0&VS3SCR=ON THEN      /*                       @Z40LB35*/
@RF00861 LH    @10,TESTRC                                          0863
         LTR   @10,@10                                             0863
         BNZ   @RF00863                                            0863
         L     @10,@PC00001+8                                      0863
         TM    VS3SCR(@10),B'00100000'                             0863
         BNO   @RF00863                                            0863
*     DO;                           /*                       @Z40LB35*/
*       VSDCATLC=ON;                /*                       @Z40LB35*/
         LR    @03,ELEMENT                                         0865
         MH    @03,@CH01471                                        0865
         L     @10,VS3LISTP(,@10)                                  0865
         L     @10,VSDPTR(,@10)                                    0865
         AL    @10,@CF01486                                        0865
         LA    @10,VSDVARY-64(@03,@10)                             0865
         OI    VSDCATLC(@10),B'10000000'                           0865
*       IF LCTVSCAT=ON THEN         /*                       @Z40LB35*/
         LA    @03,LCTAREA                                         0866
         TM    LCTVSCAT(@03),B'10000000'                           0866
         BNO   @RF00866                                            0866
*         DO;                       /*                       @Z40LB35*/
*           VSDVSAM=ON;             /*                       @Z40LB35*/
         OI    VSDVSAM(@10),B'01000000'                            0868
*           VSDACBPT=LCTACBP;       /*                       @Z40LB35*/
         L     @03,LCTACBP(,@03)                                   0869
         ST    @03,VSDACBPT(,@10)                                  0869
*         END;                      /*                       @Z40LB35*/
*     END;                          /*                       @Z40LB35*/
*                                                                  0871
@RF00866 DS    0H                                                  0872
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LISTDSET SERVICE IS THE CALLER                 @Z40LB35*/
*   /* FOR THE STATUS REPORT, THE VSDSTAT                    @Z40LB35*/
*   /* PORTION OF THE VSDBLOCK IS INITIALIZED.               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0872
*   IF TESTRC=4&VS3STAT=ON THEN     /*                       @Z40LB35*/
@RF00863 CLC   TESTRC(2),@CH00041                                  0872
         BNE   @RF00872                                            0872
         L     @10,@PC00001+8                                      0872
         TM    VS3STAT(@10),B'10000000'                            0872
         BNO   @RF00872                                            0872
*     VSDERROR=ON;                  /*                       @Z40LB35*/
         LR    @03,ELEMENT                                         0873
         MH    @03,@CH01471                                        0873
         L     @10,VS3LISTP(,@10)                                  0873
         L     @10,VSDPTR(,@10)                                    0873
         AL    @10,@CF01486                                        0873
         LA    @10,VSDVARY-64(@03,@10)                             0873
         OI    VSDERROR(@10),B'00010000'                           0873
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/
@RF00872 CLC   TESTRC(2),@CH00041                                  0874
         BNE   @RF00874                                            0874
*     IF(VS3UNCAT=ONVS3SCR=ON     /*                       @Z40LB35*/
*         VS3CREAT^=NULLPTRVS3EXPIR^=NULLPTR) THEN/*        @Z40LB35*/
         L     @10,@PC00001+8                                      0875
         TM    VS3UNCAT(@10),B'00110000'                           0875
         BNZ   @RT00875                                            0875
         SLR   @04,@04                                             0875
         C     @04,VS3CREAT(,@10)                                  0875
         BNE   @RT00875                                            0875
         C     @04,VS3EXPIR(,@10)                                  0875
         BE    @RF00875                                            0875
@RT00875 DS    0H                                                  0876
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
         LH    @10,NOMEET                                          0876
         STH   @10,TESTRC                                          0876
*     ELSE                          /*                       @Z40LB35*/
*       TESTRC=0;                   /*                       @Z40LB35*/
*                                                                  0877
         B     @RC00875                                            0877
@RF00875 SLR   @10,@10                                             0877
         STH   @10,TESTRC                                          0877
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DSN WAS NOT LOCATED IN A CATLG                 @Z40LB35*/
*   /* THE CODE IS TRANSLATED TO ZERO AS THIS                @Z40LB35*/
*   /* IS NOT AN ERROR SITUATION.                            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0878
*   IF TESTRC=8 THEN                /*                       @Z40LB35*/
@RC00875 DS    0H                                                  0878
@RF00874 CLC   TESTRC(2),@CH00179                                  0878
         BNE   @RF00878                                            0878
*     TESTRC=0;                     /*                       @Z40LB35*/
*                                                                  0879
         SLR   @10,@10                                             0879
         STH   @10,TESTRC                                          0879
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0880
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00878 LH    @15,TESTRC                                          0880
         L     @14,@SA00012                                        0880
         LM    @00,@12,@SA00012+8                                  0880
         BR    @14                                                 0880
*   END CATLG;                      /*                       @Z40LB35*/
*                                                                  0882
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - QUAL                                    @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF A DATA SET      @Z40LB35*/
*/*             POSSESSES THE USERS QUALIFIER.               @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3AST   OF THE VS3AGL                       @Z40LB35*/
*/*             VS3LEVLN OF THE VS3AGL                       @Z40LB35*/
*/*             VS3LEVP  OF THE VS3AGL                       @Z40LB35*/
*/*             DS1DSNAM OF THE IECDSF1 DSCB FMT 1           @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0882
*                                   /*                       @Z40LB35*/
*QUAL:                                                             0882
*   PROC;                           /*                       @Z40LB35*/
QUAL     STM   @14,@12,12(@13)                                     0882
*   DCL                                                            0883
*     PERIOD CHAR(1) STATIC INITIAL('.');/*                  @Z40LB35
*                                      PERIOD DEFINED TO     @Z40LB35
*                                      PARSE DSN QUALIFIERS. @Z40LB35*/
*   DCL                                                            0884
*     DSNQUAL CHAR(44) BASED(VS3LEVP);/*                     @Z40LB35
*                                      DEFINE CALLERS QUAL   @Z40LB35*/
*   DCL                                                            0885
*     LEADLEV FIXED(15);            /*                       @Z40LB35
*                                      OFFSET COUNTER        @Z40LB35*/
*   DCL                                                            0886
*     TRAILLEV FIXED(15);           /*                       @Z40LB35
*                                      OFFSET COUNTER        @Z40LB35*/
*   DCL                                                            0887
*     BEGTRAIL FIXED(15);           /*                       @Z40LB35
*                                      OFFSET COUNTER        @Z40LB35*/
*   DCL                                                            0888
*     ENDQUAL FIXED(15);            /* LOOP CONTROL          @Z40LB35*/
*                                                                  0889
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSQL' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0889
*   OLDERID2=NEWERID2;                                             0889
         L     @10,@PC00001                                        0889
         L     @10,GDTTR2(,@10)                                    0889
         MVC   @TS00001(95),NEWERID2(@10)                          0889
         MVC   OLDERID2(95,@10),@TS00001                           0889
*   NEWID2='VSQL';                  /*                       @Z40LB35*/
*                                                                  0890
         MVC   NEWID2(4,@10),@CC01430                              0890
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE END OF THE                              @Z40LB35*/
*   /* LEADING QUALIFIER.                                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0891
*   IF VS3AST^=0 THEN               /*                       @Z40LB35*/
         L     @10,@PC00001+8                                      0891
         LH    @10,VS3AST(,@10)                                    0891
         LTR   @10,@10                                             0891
         BZ    @RF00891                                            0891
*     LEADLEV=VS3AST-1;             /*                       @Z40LB35*/
         BCTR  @10,0                                               0892
         LR    LEADLEV,@10                                         0892
*   ELSE                            /*                       @Z40LB35*/
*     LEADLEV=VS3LEVLN;             /*                       @Z40LB35*/
*                                                                  0893
         B     @RC00891                                            0893
@RF00891 L     @10,@PC00001+8                                      0893
         LH    LEADLEV,VS3LEVLN(,@10)                              0893
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE BEGINNING OF                            @Z40LB35*/
*   /* THE TRAILING QUALIFIER.                               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0894
*   TRAILLEV=VS3LEVLN;              /*                       @Z40LB35*/
*                                                                  0894
@RC00891 L     @10,@PC00001+8                                      0894
         LH    TRAILLEV,VS3LEVLN(,@10)                             0894
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE RETURN CODE TO ZERO                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0895
*   TESTRC=0;                       /*                       @Z40LB35*/
*                                                                  0895
         SLR   @07,@07                                             0895
         STH   @07,TESTRC                                          0895
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST THE LEADING QUALIFIER FOR A MATCH.               @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0896
*   IF DSNQUAL(1:LEADLEV)=DS1DSNAM(1:LEADLEV) THEN/*         @Z40LB35*/
*                                                                  0896
         L     @03,VS3LEVP(,@10)                                   0896
         LR    @15,LEADLEV                                         0896
         BCTR  @15,0                                               0896
         EX    @15,@SC01491                                        0896
         BNE   @RF00896                                            0896
*     /***************************************************************/
*     /*                                                             */
*     /* IF LEADING QUALIFIER MATCHES, DETERMINE IF          @Z40LB35*/
*     /* THERE IS A TRAILING QUALIFIER.                      @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0897
*     IF VS3AST^=0 THEN             /*                       @Z40LB35*/
         CH    @07,VS3AST(,@10)                                    0897
         BE    @RF00897                                            0897
*       DO;                         /*                       @Z40LB35*/
*                                                                  0898
*         /***********************************************************/
*         /*                                                         */
*         /* IF THERE IS A TRAILING QUALIFIER,               @Z40LB35*/
*         /* INDEX TO TRAILING QUALIFIER.                    @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0899
*         ENDQUAL=LEADLEV+8;        /*                       @Z40LB35*/
         LA    ENDQUAL,8                                           0899
         ALR   ENDQUAL,LEADLEV                                     0899
*         DO BEGTRAIL=(LEADLEV+2) TO ENDQUAL WHILE/*         @Z40LB35*/
*               DS1DSNAM(BEGTRAIL:BEGTRAIL)^=PERIOD;/*       @Z40LB35*/
*                                                                  0900
         LA    BEGTRAIL,2                                          0900
         ALR   BEGTRAIL,LEADLEV                                    0900
         B     @DE00900                                            0900
@DL00900 LR    @10,F1PTR                                           0900
         ALR   @10,BEGTRAIL                                        0900
         BCTR  @10,0                                               0900
         CLC   DS1DSNAM(1,@10),PERIOD                              0900
         BE    @DC00900                                            0900
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Z40LB35*/
*           /*                                               @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0901
*           TRAILLEV=TRAILLEV+1;    /*                       @Z40LB35*/
         AL    TRAILLEV,@CF00219                                   0901
*         END;                      /*                       @Z40LB35*/
*                                                                  0902
         AL    BEGTRAIL,@CF00219                                   0902
@DE00900 CR    BEGTRAIL,ENDQUAL                                    0902
         BNH   @DL00900                                            0902
@DC00900 DS    0H                                                  0903
*         /***********************************************************/
*         /*                                                         */
*         /* IF THERE IS A TRAILING QUALIFIER,               @Z40LB35*/
*         /* TEST FOR A MATCH.                               @Z40LB35*/
*         /* IF THE TRAILING QUALIFIER DOES NOT MATCH,       @Z40LB35*/
*         /* SET THE DOES NOT MEET CRITERION CODE.           @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0903
*         IF DS1DSNAM(BEGTRAIL:TRAILLEV)^=DSNQUAL(VS3AST+1:VS3LEVLN)
*           THEN                    /*                       @Z40LB35*/
         L     @10,@PC00001+8                                      0903
         LH    @06,VS3AST(,@10)                                    0903
         L     @03,VS3LEVP(,@10)                                   0903
         LH    @10,VS3LEVLN(,@10)                                  0903
         SLR   @10,@06                                             0903
         BCTR  @10,0                                               0903
         LR    @01,F1PTR                                           0903
         ALR   @01,BEGTRAIL                                        0903
         BCTR  @01,0                                               0903
         ALR   @03,@06                                             0903
         EX    @10,@SC01493                                        0903
         BE    @RF00903                                            0903
*           TESTRC=NOMEET;          /*                       @Z40LB35*/
         LH    @10,NOMEET                                          0904
         STH   @10,TESTRC                                          0904
*         ELSE                      /*                       @Z40LB35*/
*           IF TRAILLEV<LENGTH(DS1DSNAM)&(DS1DSNAM(TRAILLEV+1:TRAILLEV+
*               1)^=BLANK&DS1DSNAM(TRAILLEV+1:TRAILLEV+1)^=PERIOD) THEN
         B     @RC00903                                            0905
@RF00903 C     TRAILLEV,@CF00847                                   0905
         BNL   @RF00905                                            0905
         LR    @10,F1PTR                                           0905
         ALR   @10,TRAILLEV                                        0905
         CLC   DS1DSNAM(1,@10),BLANK                               0905
         BE    @RF00905                                            0905
         LR    @10,F1PTR                                           0905
         ALR   @10,TRAILLEV                                        0905
         CLC   DS1DSNAM(1,@10),PERIOD                              0905
         BE    @RF00905                                            0905
*             TESTRC=NOMEET;        /*                       @Z40LB35*/
*                                                                  0906
         LH    @10,NOMEET                                          0906
         STH   @10,TESTRC                                          0906
*         /***********************************************************/
*         /*                                                         */
*         /* IF LEADING QUALIFIER DOES NOT MATCH,            @Z40LB35*/
*         /* SET THE DOES NOT MEET CRITERION CODE.           @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0907
*       END;                        /*                       @Z40LB35*/
*     ELSE                                                         0908
*       ;                           /*                       @Z40LB35*/
@RF00897 DS    0H                                                  0909
*   ELSE                            /*                       @Z40LB35*/
*     TESTRC=NOMEET;                /*                       @Z40LB35*/
*                                                                  0909
         B     @RC00896                                            0909
@RF00896 LH    @10,NOMEET                                          0909
         STH   @10,TESTRC                                          0909
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0910
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RC00896 LH    @15,TESTRC                                          0910
         L     @14,12(,@13)                                        0910
         LM    @00,@12,20(@13)                                     0910
         BR    @14                                                 0910
*   END QUAL;                       /*                       @Z40LB35*/
*                                                                  0912
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - CREATION                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE             @Z40LB35*/
*/*             CREATION DATE CRITERION IS MET.              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3CREAT OF THE VS3AGL                       @Z40LB35*/
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0912
*                                   /*                       @Z40LB35*/
*CREATION:                                                         0912
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0912
CREATION STM   @14,@12,12(@13)                                     0912
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSCR' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0913
*   OLDERID2=NEWERID2;                                             0913
         L     @10,@PC00001                                        0913
         L     @10,GDTTR2(,@10)                                    0913
         MVC   @TS00001(95),NEWERID2(@10)                          0913
         MVC   OLDERID2(95,@10),@TS00001                           0913
*   NEWID2='VSCR';                  /*                       @Z40LB35*/
*                                                                  0914
         MVC   NEWID2(4,@10),@CC01434                              0914
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO DETERMINE WHETHER THE               @Z40LB35*/
*   /* DSN IS CATLG IN A VSAM CATLG.                         @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*   IF LOCATESW=ON&LCTVSCAT=ON THEN /*                       @Z40LB35*/
*                                                                  0915
         TM    LOCATESW,B'10000000'                                0915
         BNO   @RF00915                                            0915
         LA    @10,LCTAREA                                         0915
         TM    LCTVSCAT(@10),B'10000000'                           0915
         BNO   @RF00915                                            0915
*     /***************************************************************/
*     /*                                                             */
*     /* IF DSN IS CATLG IN VSAM CATLG, THEN                 @Z40LB35*/
*     /* DATES ARE COMPARED IN BOTH THE VSAM AS              @Z40LB35*/
*     /* WELL AS THE DSCB.                                   @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0916
*     IF(DSCREAT<=CREATDTE&CATCREAT<=CREATDTE)(CATCREAT=NULLENTY& 0916
*         DSCREAT<=CREATDTE) THEN                                  0916
         L     @04,@PC00001+8                                      0916
         L     @04,VS3CREAT(,@04)                                  0916
         L     @04,CREATDTE(,@04)                                  0916
         SLR   @03,@03                                             0916
         ICM   @03,7,DSCREAT(F1PTR)                                0916
         CR    @04,@03                                             0916
         BL    @GL00036                                            0916
         C     @04,CATCREAT(,@10)                                  0916
         BNL   @RT00916                                            0916
@GL00036 LA    @10,LCTAREA                                         0916
         CLC   CATCREAT(4,@10),NULLENTY                            0916
         BNE   @RF00916                                            0916
         L     @10,@PC00001+8                                      0916
         L     @10,VS3CREAT(,@10)                                  0916
         SLR   @04,@04                                             0916
         ICM   @04,7,DSCREAT(F1PTR)                                0916
         C     @04,CREATDTE(,@10)                                  0916
         BH    @RF00916                                            0916
@RT00916 DS    0H                                                  0917
*       TESTRC=0;                   /*                       @Z40LB35*/
         SLR   @10,@10                                             0917
         STH   @10,TESTRC                                          0917
*     ELSE                          /*                       @Z40LB35*/
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
*                                                                  0918
         B     @RC00916                                            0918
@RF00916 LH    @10,NOMEET                                          0918
         STH   @10,TESTRC                                          0918
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DSN NOT FOUND IN VSAM CATLG, THE                   @Z40LB35*/
*   /* DSCB DATE IS THE ONLY DATE COMPARED.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0919
*   ELSE                            /*                       @Z40LB35*/
*     IF DSCREAT>CREATDTE THEN      /*                       @Z40LB35*/
         B     @RC00915                                            0919
@RF00915 L     @10,@PC00001+8                                      0919
         L     @10,VS3CREAT(,@10)                                  0919
         SLR   @04,@04                                             0919
         ICM   @04,7,DSCREAT(F1PTR)                                0919
         C     @04,CREATDTE(,@10)                                  0919
         BNH   @RF00919                                            0919
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
*                                                                  0920
         LH    @10,NOMEET                                          0920
         STH   @10,TESTRC                                          0920
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0921
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00919 DS    0H                                                  0921
@RC00915 LH    @15,TESTRC                                          0921
         L     @14,12(,@13)                                        0921
         LM    @00,@12,20(@13)                                     0921
         BR    @14                                                 0921
*   END CREATION;                   /*                       @Z40LB35*/
*                                                                  0923
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - EXPIRATN                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE             @Z40LB35*/
*/*             EXPIRATION DATE CRITERION IS MET.            @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     VS3EXPIR OF THE VS3AGL                       @Z40LB35*/
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0923
*                                   /*                       @Z40LB35*/
*EXPIRATN:                                                         0923
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0923
EXPIRATN STM   @14,@12,12(@13)                                     0923
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSEX' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*   OLDERID2=NEWERID2;                                             0924
         L     @10,@PC00001                                        0924
         L     @10,GDTTR2(,@10)                                    0924
         MVC   @TS00001(95),NEWERID2(@10)                          0924
         MVC   OLDERID2(95,@10),@TS00001                           0924
*   NEWID2='VSEX';                  /*                       @Z40LB35*/
*                                                                  0925
         MVC   NEWID2(4,@10),@CC01438                              0925
*   /*****************************************************************/
*   /*                                                               */
*   /* A TEST IS MADE TO DETERMINE WHETHER THE               @Z40LB35*/
*   /* DSN IS CATLG IN A VSAM CATLG.                         @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0926
*   IF LOCATESW=ON&LCTVSCAT=ON THEN /*                       @Z40LB35*/
*                                                                  0926
         TM    LOCATESW,B'10000000'                                0926
         BNO   @RF00926                                            0926
         LA    @10,LCTAREA                                         0926
         TM    LCTVSCAT(@10),B'10000000'                           0926
         BNO   @RF00926                                            0926
*     /***************************************************************/
*     /*                                                             */
*     /* IF DSN IS CATLG IN VSAM CATLG, THE                  @Z40LB35*/
*     /* DATES ARE COMPARED IN BOTH THE VSAM AS              @Z40LB35*/
*     /* WELL AS THE DSCB.                                   @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0927
*     IF(DSEXPIR<=EXPIRDTE&CATEXPIR<=EXPIRDTE)(CATEXPIR=NULLENTY& 0927
*         DSEXPIR<=EXPIRDTE) THEN                                  0927
         L     @04,@PC00001+8                                      0927
         L     @04,VS3EXPIR(,@04)                                  0927
         L     @04,EXPIRDTE(,@04)                                  0927
         SLR   @03,@03                                             0927
         ICM   @03,7,DSEXPIR(F1PTR)                                0927
         CR    @04,@03                                             0927
         BL    @GL00040                                            0927
         C     @04,CATEXPIR(,@10)                                  0927
         BNL   @RT00927                                            0927
@GL00040 LA    @10,LCTAREA                                         0927
         CLC   CATEXPIR(4,@10),NULLENTY                            0927
         BNE   @RF00927                                            0927
         L     @10,@PC00001+8                                      0927
         L     @10,VS3EXPIR(,@10)                                  0927
         SLR   @04,@04                                             0927
         ICM   @04,7,DSEXPIR(F1PTR)                                0927
         C     @04,EXPIRDTE(,@10)                                  0927
         BH    @RF00927                                            0927
@RT00927 DS    0H                                                  0928
*       TESTRC=0;                   /*                       @Z40LB35*/
         SLR   @10,@10                                             0928
         STH   @10,TESTRC                                          0928
*     ELSE                          /*                       @Z40LB35*/
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
*                                                                  0929
         B     @RC00927                                            0929
@RF00927 LH    @10,NOMEET                                          0929
         STH   @10,TESTRC                                          0929
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DSN NOT FOUND IN VSAM CATLG, THE                   @Z40LB35*/
*   /* DSCB DATE IS THE ONLY DATE COMPARED.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*   ELSE                            /*                       @Z40LB35*/
*     IF DSEXPIR>EXPIRDTE THEN      /*                       @Z40LB35*/
         B     @RC00926                                            0930
@RF00926 L     @10,@PC00001+8                                      0930
         L     @10,VS3EXPIR(,@10)                                  0930
         SLR   @04,@04                                             0930
         ICM   @04,7,DSEXPIR(F1PTR)                                0930
         C     @04,EXPIRDTE(,@10)                                  0930
         BNH   @RF00930                                            0930
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
*                                                                  0931
         LH    @10,NOMEET                                          0931
         STH   @10,TESTRC                                          0931
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0932
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00930 DS    0H                                                  0932
@RC00926 LH    @15,TESTRC                                          0932
         L     @14,12(,@13)                                        0932
         LM    @00,@12,20(@13)                                     0932
         BR    @14                                                 0932
*   END EXPIRATN;                   /*                       @Z40LB35*/
*                                                                  0934
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - SYSNAMES                                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE SYSNAMES    @Z40LB35*/
*/*             CRITERION IS MET.                            @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1DSNAM OF IECDSF1 - DSCB FMT1              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0934
*                                   /*                       @Z40LB35*/
*SYSNAMES:                                                         0934
*   PROC;                           /*                       @Z40LB35*/
SYSNAMES STM   @14,@12,12(@13)                                     0934
*   DCL                                                            0935
*     AAAAAASW BIT(1);              /* SW IF AAAAAAAA. DSN   @Z40LB35*/
*   DCL                                                            0936
*     AAAANAME CHAR(35) STATIC      /*                       @Z40LB35*/
*         INITIAL('AAAAAAAA.AAAAAAAA.AAAAAAAA.AAAAAAAA');/*  @Z40LB35
*                                      SYSTEM NAMED DSN      @Z40LB35*/
*   DCL                                                            0937
*     SYSNAMNO FIXED(8) BASED(NUMPTR);/*                     @Z40LB35
*                                      TEST FOR NUMBERS      @Z40LB35*/
*   DCL                                                            0938
*     NUMPTR PTR(31);               /* POINTER SYSNAME PTR   @Z40LB35*/
*   DCL                                                            0939
*     NUMCTR PTR(31);               /* COUNTER FOR SYS NUM   @Z40LB35*/
*                                                                  0940
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSSN' IN TRACE TABLE              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0940
*   OLDERID2=NEWERID2;                                             0940
         L     @10,@PC00001                                        0940
         L     @10,GDTTR2(,@10)                                    0940
         MVC   @TS00001(95),NEWERID2(@10)                          0940
         MVC   OLDERID2(95,@10),@TS00001                           0940
*   NEWID2='VSSN';                  /*                       @Z40LB35*/
*                                                                  0941
         MVC   NEWID2(4,@10),@CC01451                              0941
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AAAAAAAA. SW OFF                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0942
*   AAAAAASW=OFF;                   /*                       @Z40LB35*/
*                                                                  0942
         NI    AAAAAASW,B'01111111'                                0942
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR AAAAAAAA. TYPE DSN                           @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*   IF DS1DSNAM(1:LENGTH(AAAANAME))=AAAANAME THEN/*          @Z40LB35*/
         CLC   DS1DSNAM(35,F1PTR),AAAANAME                         0943
         BNE   @RF00943                                            0943
*     AAAAAASW=ON;                  /*                       @Z40LB35*/
*                                                                  0944
         OI    AAAAAASW,B'10000000'                                0944
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT AAAAAAAA. SYSTEM NAME DSN,                     @Z40LB35*/
*   /* TEST FOR OTHER SYSTEM NAMES.                          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0945
*   IF AAAAAASW=OFF THEN            /*                       @Z40LB35*/
@RF00943 TM    AAAAAASW,B'10000000'                                0945
         BNZ   @RF00945                                            0945
*     DO;                           /*                       @Z40LB35*/
*                                                                  0946
*       /*************************************************************/
*       /*                                                           */
*       /* THE FOLLOWING CODE WILL TEST FOR THE SYSTEM       @Z40LB35*/
*       /* NAME THAT LOOKS LIKE "SYSNNNNN.TXXXXXXXXY"        @Z40LB35*/
*       /* WHERE Y CAN BE A,V,F, OR P AND THE N IS           @Z40LB35*/
*       /* CHAR NUMBER FROM 0 TO 9.                          @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0947
*       IF DS1DSNAM(1:LENGTH('SYS'))='SYS' THEN/*            @Z40LB35*/
         CLC   DS1DSNAM(3,F1PTR),@CC01452                          0947
         BNE   @RF00947                                            0947
*         IF DS1DSNAM(9:10)='.T' THEN/*                      @Z40LB35*/
         CLC   DS1DSNAM+8(2,F1PTR),@CC01453                        0948
         BNE   @RF00948                                            0948
*           IF DS1DSNAM(19)='A'DS1DSNAM(19)=/*              @Z40LB35*/
*               'V'DS1DSNAM(19)='F'DS1DSNAM(19)='P' THEN         0949
         CLI   DS1DSNAM+18(F1PTR),C'A'                             0949
         BE    @RT00949                                            0949
         CLI   DS1DSNAM+18(F1PTR),C'V'                             0949
         BE    @RT00949                                            0949
         CLI   DS1DSNAM+18(F1PTR),C'F'                             0949
         BE    @RT00949                                            0949
         CLI   DS1DSNAM+18(F1PTR),C'P'                             0949
         BNE   @RF00949                                            0949
@RT00949 DS    0H                                                  0950
*             DO;                   /*                       @Z40LB35*/
*               NUMPTR=ADDR(DS1DSNAM)+3;/*                   @Z40LB35*/
         LA    NUMPTR,3                                            0951
         ALR   NUMPTR,F1PTR                                        0951
*               DO NUMCTR=1 TO 5 WHILE TESTRC=0;                   0952
         LA    NUMCTR,1                                            0952
@DL00952 LH    @10,TESTRC                                          0952
         LTR   @10,@10                                             0952
         BNZ   @DC00952                                            0952
*                 IF SYSNAMNO>'F9'XSYSNAMNO<'F0'X THEN            0953
         CLI   SYSNAMNO(NUMPTR),249                                0953
         BH    @RT00953                                            0953
         CLI   SYSNAMNO(NUMPTR),240                                0953
         BNL   @RF00953                                            0953
@RT00953 DS    0H                                                  0954
*                   TESTRC=NOMEET;  /*                       @Z40LB35*/
         LH    @10,NOMEET                                          0954
         STH   @10,TESTRC                                          0954
*                 ELSE              /*                       @Z40LB35*/
*                   NUMPTR=NUMPTR+1;/*                       @Z40LB35*/
         B     @RC00953                                            0955
@RF00953 AL    NUMPTR,@CF00219                                     0955
*               END;                /*                       @Z40LB35*/
@RC00953 AL    NUMCTR,@CF00219                                     0956
         C     NUMCTR,@CF00295                                     0956
         BNH   @DL00952                                            0956
@DC00952 DS    0H                                                  0957
*             END;                  /*                       @Z40LB35*/
*           ELSE                    /*                       @Z40LB35*/
*             TESTRC=NOMEET;        /*                       @Z40LB35*/
         B     @RC00949                                            0958
@RF00949 LH    @10,NOMEET                                          0958
         STH   @10,TESTRC                                          0958
*         ELSE                      /*                       @Z40LB35*/
*           TESTRC=NOMEET;          /*                       @Z40LB35*/
         B     @RC00948                                            0959
@RF00948 LH    @10,NOMEET                                          0959
         STH   @10,TESTRC                                          0959
*       ELSE                        /*                       @Z40LB35*/
*         TESTRC=NOMEET;            /*                       @Z40LB35*/
         B     @RC00947                                            0960
@RF00947 LH    @10,NOMEET                                          0960
         STH   @10,TESTRC                                          0960
*     END;                          /*                       @Z40LB35*/
*                                                                  0961
@RC00947 DS    0H                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE CODE SAVE IN TESTRC. */
*   /*                                                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
@RF00945 LH    @15,TESTRC                                          0962
         L     @14,12(,@13)                                        0962
         LM    @00,@12,20(@13)                                     0962
         BR    @14                                                 0962
*   END SYSNAMES;                   /*                       @Z40LB35*/
*                                                                  0964
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - EXCLUDE                                 @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE DSN         @Z40LB35*/
*/*             CRITERION IS MET.                            @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT -     DS1DSNAM OF IECDSF1 - DSCB FMT1              @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  0964
*                                   /*                       @Z40LB35*/
*EXCLUDE:                                                          0964
*   PROC;                           /*                       @Z40LB35*/
*                                                                  0964
EXCLUDE  STM   @14,@12,12(@13)                                     0964
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE WILL OVERLAY THE              @Z40LB35*/
*   /* EXCLUDED DSN ARRAY PASSED BY CALLER.                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*   DCL                                                            0965
*     1 EXCLDSNS BASED(VS3EXDSP) BDY(WORD),/*                @Z40LB35*/
*      2 EXCLDCNT FIXED(15),        /* NUMBER OF ELEMENTS    @Z40LB35*/
*      2 *(*) BDY(HWORD),           /*                       @Z40LB35*/
*       3 * CHAR(20),               /*                       @Z40LB35*/
*       3 EXCLDLEN FIXED(8),        /* LENGTH OF DSN         @Z40LB35*/
*       3 EXCLDVAL CHAR(44);        /* DSN                   @Z40LB35*/
*   DCL                                                            0966
*     EXCNUM FIXED(31);             /* COUNTER TO PROCESS    @Z40LB35
*                                      ARRAY                 @Z40LB35
*                                                            @Z40LB35*/
*                                                                  0967
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TRACE POINT 'VSEL' IN TRACE TABLE              @ZM41110*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0967
*   OLDERID2=NEWERID2;                                             0967
         L     @10,@PC00001                                        0967
         L     @10,GDTTR2(,@10)                                    0967
         MVC   @TS00001(95),NEWERID2(@10)                          0967
         MVC   OLDERID2(95,@10),@TS00001                           0967
*   NEWID2='VSEL';                  /*                       @ZM41110*/
*                                                                  0968
         MVC   NEWID2(4,@10),@CC01470                              0968
*   /*****************************************************************/
*   /*                                                               */
*   /* THE ARRAY IS INDEXED THROUGH TO DETERMINE             @Z40LB35*/
*   /* IF THE CURRENT DSN IS AMONG THE EXCLUDE               @Z40LB35*/
*   /* DSNS                                                  @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0969
*   DO EXCNUM=1 TO EXCLDCNT WHILE TESTRC=0;/*                @Z40LB35*/
*                                                                  0969
         LA    EXCNUM,1                                            0969
         B     @DE00969                                            0969
@DL00969 LH    @10,TESTRC                                          0969
         LTR   @10,@10                                             0969
         BNZ   @DC00969                                            0969
*     /***************************************************************/
*     /*                                                             */
*     /* IF DSN IS AMONG THE DSN EXCLUDE LIST                @Z40LB35*/
*     /* THE DOES NOT MEET CRITERION CODE IS SET             @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0970
*     IF DS1DSNAM=EXCLDVAL(EXCNUM) THEN/*                    @Z40LB35*/
         LR    @10,EXCNUM                                          0970
         MH    @10,@CH01472                                        0970
         L     @03,@PC00001+8                                      0970
         L     @03,VS3EXDSP(,@03)                                  0970
         ALR   @03,@10                                             0970
         AL    @03,@CF01495                                        0970
         CLC   DS1DSNAM(44,F1PTR),EXCLDVAL-23(@03)                 0970
         BNE   @RF00970                                            0970
*       TESTRC=NOMEET;              /*                       @Z40LB35*/
         LH    @10,NOMEET                                          0971
         STH   @10,TESTRC                                          0971
*   END;                            /*                       @Z40LB35*/
*                                                                  0972
@RF00970 AL    EXCNUM,@CF00219                                     0972
@DE00969 L     @10,@PC00001+8                                      0972
         L     @10,VS3EXDSP(,@10)                                  0972
         CH    EXCNUM,EXCLDCNT(,@10)                               0972
         BNH   @DL00969                                            0972
@DC00969 DS    0H                                                  0973
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0973
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/
         LH    @15,TESTRC                                          0973
         L     @14,12(,@13)                                        0973
         LM    @00,@12,20(@13)                                     0973
         BR    @14                                                 0973
*   END EXCLUDE;                    /*                       @Z40LB35*/
*   END IDCVS03                     /*                       @Z40LB35*/
*                                                                  0975
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */
*                                                                  0975
*       ;                                                          0975
@DATA    DS    0H
@CH00036 DC    H'2'
@CH00179 DC    H'8'
@CH00035 DC    H'12'
@CH01472 DC    H'66'
@CH01471 DC    H'80'
@CH01243 DC    H'96'
@SC01491 CLC   DSNQUAL(0,@03),DS1DSNAM(F1PTR)
@SC01493 CLC   DS1DSNAM(0,@01),DSNQUAL(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    13F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00005 DS    15F
@SA00003 DS    13F
@SA00004 DS    15F
@SA00008 DS    13F
@SA00009 DS    15F
@SA00010 DS    13F
@SA00012 DS    15F
@AL00001 DS    6A
IDCVS03  CSECT
         DS    0F
@CF00115 DC    F'0'
@CF00219 DC    F'1'
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00295 DC    F'5'
@CF00476 DC    F'10'
@CF00506 DC    F'16'
@CH00506 EQU   @CF00506+2
@CF01327 DC    F'36'
@CF00847 DC    F'44'
@CF01203 DC    F'140'
@CF01485 DC    F'-64'
@CF01484 DC    F'-60'
@CF01495 DC    F'-43'
@CF01486 DC    F'-16'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
IOXPTR   DS    A
TRACKPTR DS    A
LCTINFOP DS    A
FMT0CTR  DS    F
VSDSIZE  DS    F
UNITABLP DS    A
LISTPTR  DS    A
TESTRC   DS    H
FINALRC  DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
         DS    CL2
PRINTARG DS    CL20
LOCATESW DS    BL1
MSGSENT  DS    BL1
ENQ      DS    BL1
         DS    CL1
EXOPARM  DS    CL34
         DS    CL2
EXGPARM1 DS    CL32
EXGPARM2 DS    CL32
RTNUNIT  DS    CL11
         DS    CL1
LCTAREA  DS    CL33
RNAME    DS    CL7
         ORG   RNAME
RLENGTH  DS    FL1
RVOLSER  DS    CL6
         ORG   RNAME+7
IOBLOCK  DS    CL28
         ORG   IOBLOCK
BEGCCHH  DS    FL4
         ORG   BEGCCHH
BEGCC    DS    FL2
BEGHH    DS    FL2
         ORG   IOBLOCK+4
@NM00094 DS    CL1
ENDCCHH  DS    FL4
         ORG   ENDCCHH
ENDCC    DS    FL2
ENDHH    DS    FL2
         ORG   IOBLOCK+9
@NM00095 DS    CL1
         DS    CL2
LASTCCHH DS    FL4
         ORG   LASTCCHH
LCC      DS    FL2
LHH      DS    FL2
         ORG   IOBLOCK+16
LR       DS    FL1
@NM00096 DS    CL3
FMT1CNT  DS    FL4
FMT1PTR  DS    AL4
         ORG   IOBLOCK+28
TRACKRSW DS    BL1
FMT1SW   DS    BL1
NOFMT3   DS    BL1
FMT3     DS    CL140
AAAAAASW DS    BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCVS03  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NULLENTY DC    XL4'FFFFFF'
TRACKLEN DC    F'5460'
MAXTRKS  DC    H'18'
TRACKSIZ DC    H'19'
VTOCTRK  DC    H'39'
EOF      DC    H'12'
NOMEET   DC    H'16'
MSGCODE  DC    AL1(8)
FMT4KEY  DC    AL1(44)
FMT1EXTS DC    AL1(3)
FMT3EXT1 DC    AL1(4)
FMT3EXT2 DC    AL1(9)
@CC01112 DC    C'VS03'
@CC01290 DC    C'VS3X'
@CC01294 DC    C'VSIT'
@CC01308 DC    C'VSGB'
@CC01314 DC    C'VSTK'
@CC01319 DC    C'VSOP'
@CC01330 DC    C'VSSR'
@CC01341 DC    C'VSCU'
@CC01348 DC    C'VSF1'
@CC01352 DC    C'VSCT'
@CC01404 DC    C'VSUS'
@CC01415 DC    C'VSST'
@CC01419 DC    C'VSCG'
@CC01430 DC    C'VSQL'
@CC01434 DC    C'VSCR'
@CC01438 DC    C'VSEX'
@CC01451 DC    C'VSSN'
@CC01470 DC    C'VSEL'
@CC01119 DC    C'UV0'
@CC01121 EQU   @CC01112
@CC01452 DC    C'SYS'
@CC01453 DC    C'.T'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
MODID    DC    CL4'VS03'
         DS    CL2
FIXAREA  DS    CL350
         ORG   FIXAREA
@NM00093 DC    350X'00'
         ORG   FIXAREA+350
BLANK    DC    CL1' '
FMT1ID   DC    X'F1'
FMT0ID   DC    X'00'
QNAME    DC    CL8'SYSVTOC'
FMT3ID   DC    X'F3'
NULLCCHH DC    X'0000000000'
PERIOD   DC    CL1'.'
AAAANAME DC    CL35'AAAAAAAA.AAAAAAAA.AAAAAAAA.AAAAAAAA'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
EXCNUM   EQU   @04
NUMCTR   EQU   @06
NUMPTR   EQU   @04
ENDQUAL  EQU   @08
BEGTRAIL EQU   @07
TRAILLEV EQU   @04
LEADLEV  EQU   @06
ENDEXT   EQU   @07
STARTEXT EQU   @10
EXTELEM  EQU   @09
EXTENTCT EQU   @06
EXTENTP  EQU   @08
DSCBNUM  EQU   @10
FMT1S    EQU   @06
FMT1DSCB EQU   @04
FMT1CTR  EQU   @09
GETPTR   EQU   @06
F1PTR    EQU   @05
F3PTR    EQU   @03
F4PTR    EQU   @04
ELEMENT  EQU   @04
RTNREG   EQU   @15
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
UCBREG   EQU   @00
LSPACEBF EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSARV0 EQU   0
IDCSADQ0 EQU   0
IDCSASI0 EQU   0
IDCSALC0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITUCB  EQU   UNITABL
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXODDN   EQU   EXOARG+8
EXOVSN   EQU   EXOARG+16
EXOEXT   EQU   EXOARG+24
EXOCTLBK EQU   EXOARG+28
EXOPT    EQU   EXOARG+32
EXOVTOC  EQU   EXOPT
EXFLG    EQU   EXOARG+33
EXOREAD  EQU   EXFLG
EXGARG   EQU   0
EXGCTLBK EQU   EXGARG+8
EXGCCHH2 EQU   EXGARG+16
EXGRECNO EQU   EXGARG+20
EXGDATAP EQU   EXGARG+24
EXGKEYLN EQU   EXGARG+28
EXGDATAL EQU   EXGARG+30
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00073 EQU   SV82LIST+4
SV82DCBP EQU   @NM00073
@NM00074 EQU   SV82LIST+12
SV82WRKP EQU   @NM00074
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTMULVC EQU   LCTINFO+8
LCTACBP  EQU   LCTINFO+12
LCTCREAT EQU   LCTINFO+16
LCTEXPIR EQU   LCTINFO+20
LCTOWNER EQU   LCTINFO+24
LCTFLAGS EQU   LCTINFO+32
LCTVSCAT EQU   LCTFLAGS
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3HEAD  EQU   VS3AGL
VS3LISTP EQU   VS3AGL+8
VS3EXDSP EQU   VS3AGL+12
VS3LEVP  EQU   VS3AGL+16
VS3LEVLN EQU   VS3AGL+20
VS3AST   EQU   VS3AGL+22
VS3EXPIR EQU   VS3AGL+24
VS3CREAT EQU   VS3AGL+28
VS3UCBP  EQU   VS3AGL+32
VS3DEV   EQU   VS3AGL+36
VS3POOL  EQU   VS3AGL+40
VS3VOL   EQU   VS3AGL+44
VS3DD    EQU   VS3AGL+50
VS3FLAGS EQU   VS3AGL+58
VS3STAT  EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDCREAT EQU   VSDSTAT
VSDEXPIR EQU   VSDSTAT+4
VSDOWNER EQU   VSDSTAT+8
VSDSFLG1 EQU   VSDSTAT+16
VSDVTOCC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDFLG2  EQU   VSDSTAT+17
VSDPWR   EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDSCR   EQU   0
VSDACBPT EQU   VSDSCR
VSDSCRFL EQU   VSDSCR+4
VSDCATLC EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDUSAGE EQU   0
VSDTRKS  EQU   VSDUSAGE
VSDFTRK  EQU   VSDUSAGE+2
VSDSECAL EQU   VSDUSAGE+4
VSDEXTS  EQU   VSDUSAGE+8
VSDDORG  EQU   VSDUSAGE+9
VSDOPO   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDALLOC EQU   VSDUSAGE+10
VSDACYL  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDUSEF  EQU   VSDUSAGE+11
VSDCALFR EQU   VSDUSEF
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDELEM  EQU   VSDBLOCK
VSDVTOCS EQU   VSDBLOCK+4
VSDFMT0  EQU   VSDBLOCK+8
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVOLCT EQU   VSDARRAY
VSDDSN   EQU   VSDARRAY+4
VSDVARY  EQU   VSDARRAY+48
VSDPTR   EQU   0
CREATDTE EQU   0
EXPIRDTE EQU   0
IECSDSF1 EQU   0
IECSDSL1 EQU   0
DS1DSNAM EQU   IECSDSL1
DS1FMTID EQU   IECSDSL1+44
DS1CREDT EQU   IECSDSL1+53
DS1EXPDT EQU   IECSDSL1+56
DS1DSORG EQU   IECSDSL1+82
DS1RECFM EQU   IECSDSL1+84
DS1DSIND EQU   IECSDSL1+93
DS1SCALO EQU   IECSDSL1+94
DS1LSTAR EQU   IECSDSL1+98
DS1TRBAL EQU   IECSDSL1+101
DS1EXT1  EQU   IECSDSL1+105
DS1PTRDS EQU   IECSDSL1+135
IECSDSF3 EQU   0
IECSDSL3 EQU   0
DS3EXTNT EQU   IECSDSL3+4
DS3FMTID EQU   IECSDSL3+44
DS3ADEXT EQU   IECSDSL3+45
IECSDSF4 EQU   0
IECSDSL4 EQU   0
DS4DEVCT EQU   IECSDSL4+18
DS4DEVOV EQU   DS4DEVCT+6
DS4AMCAT EQU   IECSDSL4+40
DS4VSIND EQU   DS4AMCAT
DS4VTOCE EQU   IECSDSL4+61
DS4EXTS  EQU   0
DSEXTS   EQU   0
DSBG     EQU   DSEXTS+2
DSBGCYLS EQU   DSBG
DSBGTRKS EQU   DSBG+2
DSENCYLS EQU   DSEXTS+6
DSENTRKS EQU   DSEXTS+8
DSNQUAL  EQU   0
SYSNAMNO EQU   0
EXCLDSNS EQU   0
EXCLDCNT EQU   EXCLDSNS
@NM00123 EQU   EXCLDSNS+2
EXCLDVAL EQU   @NM00123+21
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSASC0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTABT   EQU   GDTTBL+152
GDTABH   EQU   GDTTBL+156
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
REQUEST  EQU   0
ARGLIST  EQU   0
DSCREAT  EQU   DS1CREDT
DSEXPIR  EQU   DS1EXPDT
CATCREAT EQU   LCTCREAT
CATEXPIR EQU   LCTEXPIR
DSORG    EQU   DS1DSORG
DS1DSIS  EQU   DSORG
DS1DSPS  EQU   DSORG
DS1DSDA  EQU   DSORG
DS1DSPO  EQU   DSORG
DS1DSU   EQU   DSORG
DS1VSAM  EQU   DSORG+1
@NM00110 EQU   DS1SCALO
DS1SECAL EQU   @NM00110+1
@NM00112 EQU   DS1SCALO
DS1SCAL  EQU   DS1SCALO
DS1CAL1  EQU   DS1SCAL
DS1CAL2  EQU   DS1SCAL
@NM00115 EQU   DS1LSTAR
DS1LSTTT EQU   @NM00115
DS1LSTR  EQU   @NM00115+2
@NM00116 EQU   DS1TRBAL
DS1TBAL  EQU   @NM00116
@NM00117 EQU   DS1RECFM
DS1TRKOV EQU   @NM00117
@NM00119 EQU   DS1DSIND
DS1RACF  EQU   @NM00119
DS1PW    EQU   @NM00119
DS1PWW   EQU   @NM00119
DS1TRACK EQU   DS1SCALO
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00122 EQU   @NM00119
@NM00121 EQU   @NM00119
@NM00120 EQU   @NM00119
@NM00118 EQU   @NM00117
DS1ABSTR EQU   @NM00112
@NM00113 EQU   @NM00112
@NM00111 EQU   @NM00110
@NM00098 EQU   DSORG+1
@NM00097 EQU   DSORG
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
EXCLDLEN EQU   @NM00123+20
@NM00124 EQU   @NM00123
@NM00114 EQU   DSEXTS
DS4ENDTK EQU   DS4EXTS+6
DS4ENDCY EQU   DS4EXTS+4
DS4BEGTK EQU   DS4EXTS+2
DS4BEGCY EQU   DS4EXTS
DS4END   EQU   IECSDSL4+96
@NM00109 EQU   IECSDSL4+71
DS4F6PTR EQU   IECSDSL4+56
@NM00108 EQU   IECSDSL4+51
DS4R2TIM EQU   IECSDSL4+43
DS4VSCRA EQU   DS4AMCAT+1
@NM00107 EQU   DS4VSIND
DS4VSBAD EQU   DS4VSIND
DS4VSREF EQU   DS4VSIND
DS4AMTIM EQU   IECSDSL4+32
DS4DEVDB EQU   DS4DEVCT+13
DS4DEVDT EQU   DS4DEVCT+12
DS4DEVTL EQU   DS4DEVCT+10
DS4DEVFG EQU   DS4DEVCT+9
DS4DEVK  EQU   DS4DEVCT+8
DS4DEVL  EQU   DS4DEVOV+1
DS4DEVI  EQU   DS4DEVOV
DS4DEVTK EQU   DS4DEVCT+4
DS4DEVSZ EQU   DS4DEVCT
@NM00106 EQU   IECSDSL4+16
DS4NOEXT EQU   IECSDSL4+15
DS4VTOCI EQU   IECSDSL4+14
DS4NOATK EQU   IECSDSL4+12
DS4HCCHH EQU   IECSDSL4+8
DS4DSREC EQU   IECSDSL4+6
DS4HPCHR EQU   IECSDSL4+1
DS4IDFMT EQU   IECSDSL4
@NM00105 EQU   IECSDSF4
DS3END   EQU   IECSDSL3+140
DS3PTRDS EQU   IECSDSL3+135
@NM00104 EQU   IECSDSL3
@NM00103 EQU   IECSDSF3
DS1END   EQU   IECSDSL1+140
DS1EXT3  EQU   IECSDSL1+125
DS1EXT2  EQU   IECSDSL1+115
@NM00102 EQU   IECSDSL1+103
DS1RKP   EQU   IECSDSL1+91
DS1KEYL  EQU   IECSDSL1+90
DS1LRECL EQU   IECSDSL1+88
DS1BLKL  EQU   IECSDSL1+86
DS1OPTCD EQU   IECSDSL1+85
@NM00101 EQU   IECSDSL1+75
DS1SYSCD EQU   IECSDSL1+62
@NM00100 EQU   IECSDSL1+61
DS1NOBDB EQU   IECSDSL1+60
DS1NOEPV EQU   IECSDSL1+59
DS1VOLSQ EQU   IECSDSL1+51
DS1DSSN  EQU   IECSDSL1+45
@NM00099 EQU   IECSDSF1
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00092 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00091 EQU   VSDUSEF
@NM00090 EQU   VSDALLOC
@NM00089 EQU   VSDDORG
@NM00088 EQU   VSDSCR+5
@NM00087 EQU   VSDSCRFL
@NM00086 EQU   VSDSTAT+29
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00085 EQU   VSDFLG2
@NM00084 EQU   VSDSFLG1
VSDFRCCL EQU   VSDVTOC+21
@NM00083 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00082 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00081 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00080 EQU   VSDVTOC
@NM00079 EQU   VS3FLAGS
@NM00078 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00077 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00076 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00075 EQU   LCTFLAGS
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00072 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00071 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00070 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00069 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00068 EQU   RCTAGL+10
@NM00067 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00066 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00065 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00064 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00063 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00062 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00061 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00060 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00059 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00058 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00057 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00056 EQU   EXSPACE+8
@NM00055 EQU   EXSPACE+6
@NM00054 EQU   EXSPACE+4
@NM00053 EQU   EXSPACE+1
@NM00052 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00051 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
@NM00050 EQU   EXGARG+29
EXGCCHH1 EQU   EXGARG+12
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00049 EQU   EXFLG
@NM00048 EQU   EXOPT
EXOREP   EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOUCB   EQU   EXOARG+20
EXODSN   EQU   EXOARG+12
EXOHEAD  EQU   EXOARG
@NM00047 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00046 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00045 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00044 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00043 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00042 EQU   CMMSG+7
@NM00041 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00040 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00039 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00038 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00037 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00036 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00035 EQU   ERCNVTAB+4
@NM00034 EQU   ERCNVTAB+3
@NM00033 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00032 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00031 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00030 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00029 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00028 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGDTM  EQU   DARGARY+4
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00027 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGCNT  EQU   DARGLIST+14
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00026 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00025 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNM EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00285 EQU   @RC00279
@RC00510 EQU   @RC00494
@RF00737 EQU   @RC00721
@RC00789 EQU   @RC00786
@RC00897 EQU   @RC00896
@RC00916 EQU   @RC00915
@RC00927 EQU   @RC00926
@RC00948 EQU   @RC00947
@PB00017 EQU   @EL00001
@RF00905 EQU   @RC00897
@RC00903 EQU   @RC00897
@RC00949 EQU   @RC00948
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCVS03,(C'PLS2002',0701,78165)

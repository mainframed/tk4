         TITLE '***** IDCTU01: TUNE FUNCTION SUPPORT ROUTINE  ******   *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCTU01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCTU01   75.255'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @12,4095(,@10)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                      DISPLAY OF PREVIOUS   @Y30LB00
*                                      LRUGROUPS DATA LINE   @Y30LB00
*                                      FOR CHANGE            @Y30LB00*/
*                                                                  0226
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE CENTRAL SECTION OF THE TUNE               @Y30LB00*/
*   /* ROUTINE. THIS SECTION PERFORMS THE                    @Y30LB00*/
*   /* INITIALIZATION AND TERMINATION FUNCTIONS AND          @Y30LB00*/
*   /* ROUTES CONTROL AMONG THE SUB=PROCEDURES. THE          @Y30LB00*/
*   /* EXIT FROM THE TUNE ROUTINE OCCURS FROM HERE.          @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   OLDERID2=NEWERID2;                                             0226
         L     @15,@PC00001                                        0226
         L     @14,GDTTR2(,@15)                                    0226
         MVC   @TS00001(95),NEWERID2(@14)                          0226
         MVC   OLDERID2(95,@14),@TS00001                           0226
*   NEWID2='TUEN';                  /* TRACE POINT AT ENTRY  @Y30LB00
*                                      TO TUNE FSR           @Y30LB00*/
         MVC   NEWID2(4,@14),@CC01011                              0227
*   IF GDTDBG=NULLPTR THEN                                         0228
         L     @15,GDTDBG(,@15)                                    0228
         LTR   @15,@15                                             0228
         BZ    @RT00228                                            0228
*     ;                                                            0229
*   ELSE                                                           0230
*     CALL IDCDB010(GDTTBL,'TUND'); /* FULL REGION DUMP AT   @Y30LB00
*                                      ENTRY TO TUNE FSR     @Y30LB00*/
*                                                                  0230
         L     @15,@PC00001                                        0230
         ST    @15,@AL00001                                        0230
         LA    @14,@CC01012                                        0230
         ST    @14,@AL00001+4                                      0230
         MVI   @AL00001+4,X'80'                                    0230
         L     @15,GDTDBG(,@15)                                    0230
         LA    @01,@AL00001                                        0230
         BALR  @14,@15                                             0230
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE PRINT ARGUMENT LIST                    @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0231
*   DDSTRU=ADDR(PRINTTAB);          /*                       @Y30LB00*/
@RT00228 LA    @15,PRINTTAB                                        0231
         ST    @15,DDSTRU                                          0231
*   PRINTTAB=''B;                   /*                       @Y30LB00*/
*                                                                  0232
         XC    PRINTTAB(68),PRINTTAB                               0232
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE INTERNAL TUNE TABLE                    @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   TUTBL=''B;                      /*                       @Y30LB00*/
         XC    TUTBL(60),TUTBL                                     0233
*   TABLNAME='TUTBL   ';            /*                       @Y30LB00*/
*                                                                  0234
         MVC   TABLNAME(8),@CC01015                                0234
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDRESS THE TUNELIST - TUNE REQUEST BLOCK             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0235
*   TUPTR=ADDR(TUAREA);             /*                       @Y30LB00*/
*                                                                  0235
         LA    @15,TUAREA                                          0235
         ST    @15,TUPTR                                           0235
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF DISPLAY OR CHANGE WAS SPECIFIED          @Y30LB00*/
*   /* AND ROUTE THE REQUEST TO THE APPROPRIATE              @Y30LB00*/
*   /* SUB-PROCEDURE CONTROLLER. SET LAST CONDITION          @Y30LB00*/
*   /* TO RETURN CODE RETURNED FROM SUB-PROCEDURE            @Y30LB00*/
*   /* CONTROLLERS                                           @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0236
*   IF ADDR(DIS)^=NULLPTR           /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         L     @15,@PC00001+4                                      0236
         L     @15,FDTPTR(,@15)                                    0236
         LTR   @15,@15                                             0236
         BZ    @RF00236                                            0236
*     DO;                           /*                       @Y30LB00*/
*       CALL DISRTN;                /*                       @Y30LB00*/
         BAL   @14,DISRTN                                          0238
*       RESPECIFY                                                  0239
*         RTNREG RSTD;                                             0239
*       TESTRC=RTNREG;                                             0240
         LR    TESTRC,RTNREG                                       0240
*       RESPECIFY                                                  0241
*         RTNREG UNRSTD;            /*                       @Y30LB00*/
*       IF TESTRC^=0                /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0242
         BZ    @RF00242                                            0242
*         LASTCOND=TESTRC;          /*                       @Y30LB00*/
         L     @05,@PC00001+8                                      0243
         STH   TESTRC,LASTCOND(,@05)                               0243
*     END;                          /*                       @Y30LB00*/
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
         B     @RC00236                                            0245
@RF00236 DS    0H                                                  0246
*       CALL CHNGRTN;               /*                       @Y30LB00*/
         BAL   @14,CHNGRTN                                         0246
*       RESPECIFY                                                  0247
*         RTNREG RSTD;                                             0247
*       TESTRC=RTNREG;                                             0248
         LR    TESTRC,RTNREG                                       0248
*       RESPECIFY                                                  0249
*         RTNREG UNRSTD;            /*                       @Y30LB00*/
*       IF TESTRC^=0                /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0250
         BZ    @RF00250                                            0250
*         LASTCOND=TESTRC;          /*                       @Y30LB00*/
         L     @05,@PC00001+8                                      0251
         STH   TESTRC,LASTCOND(,@05)                               0251
*     END;                          /*                       @Y30LB00*/
*                                                                  0252
@RF00250 DS    0H                                                  0253
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE A COMPLETION MESSAGE IF SOME OR ALL OF THE      @Y30LB00*/
*   /* FUNCTION HAS BEEN COMPLETED OR A TERMINATION          @Y30LB00*/
*   /* MESSAGE IF NO FUNCTION COULD BE PERFORMED             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0253
*   DARGLIST=''B;                   /*                       @Y30LB00*/
@RC00236 L     @15,DDSTRU                                          0253
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0253
*   IF LASTCOND<LASTCC12            /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         L     @14,@PC00001+8                                      0254
         LH    @14,LASTCOND(,@14)                                  0254
         C     @14,@CF00565                                        0254
         BNL   @RF00254                                            0254
*     DARGSENT=ENDMSG;              /*                       @Y30LB00*/
         MVI   DARGSENT(@15),X'01'                                 0255
*   ELSE                            /*                       @Y30LB00*/
*     DARGSENT=TERMMSG;             /*                       @Y30LB00*/
         B     @RC00254                                            0256
@RF00254 L     @01,DDSTRU                                          0256
         MVI   DARGSENT(@01),X'03'                                 0256
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB00*/
@RC00254 L     @15,DDSTRU                                          0257
         MVC   DARGSMOD(3,@15),@CC00985                            0257
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB00*/
         L     @14,@PC00001+8                                      0258
         ST    @14,DARGDBP(,@15)                                   0258
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB00*/
         MVC   DARGILP(2,@15),@CH00152                             0259
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB00*/
*                                                                  0260
         L     @15,@PC00001                                        0260
         ST    @15,@AL00001                                        0260
         LA    @14,@CF00114                                        0260
         ST    @14,@AL00001+4                                      0260
         LA    @14,DDSTRU                                          0260
         ST    @14,@AL00001+8                                      0260
         MVI   @AL00001+8,X'80'                                    0260
         L     @15,GDTPRT(,@15)                                    0260
         LA    @01,@AL00001                                        0260
         BALR  @14,@15                                             0260
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE AMS EXECUTIVE                           @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*   IF GDTDBG=NULLPTR THEN                                         0261
         L     @15,@PC00001                                        0261
         L     @15,GDTDBG(,@15)                                    0261
         LTR   @15,@15                                             0261
         BZ    @RT00261                                            0261
*     ;                                                            0262
*   ELSE                                                           0263
*     CALL IDCDB010(GDTTBL,'TUXD'); /*                       @Y30LB00*/
         L     @15,@PC00001                                        0263
         ST    @15,@AL00001                                        0263
         LA    @14,@CC01018                                        0263
         ST    @14,@AL00001+4                                      0263
         MVI   @AL00001+4,X'80'                                    0263
         L     @15,GDTDBG(,@15)                                    0263
         LA    @01,@AL00001                                        0263
         BALR  @14,@15                                             0263
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0264
*                                                                  0264
@RT00261 L     @15,@PC00001                                        0264
         ST    @15,@AL00001                                        0264
         LA    @14,MODID                                           0264
         ST    @14,@AL00001+4                                      0264
         L     @14,@PC00001+8                                      0264
         ST    @14,@AL00001+8                                      0264
         MVI   @AL00001+8,X'80'                                    0264
         L     @15,GDTEPL(,@15)                                    0264
         LA    @01,@AL00001                                        0264
         BALR  @14,@15                                             0264
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*                                                                  0265
*/********************************************************   @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - CHNGRTN                                 @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - ROUTE THE REQUEST TO THE APPROPRIATE          @Y30LB00*/
*/*            SUB-PROCEDURES SUCH THAT THE                  @Y30LB00*/
*/*            PREVIOUS TUNING PARAMETERS ARE                @Y30LB00*/
*/*            DISPLAYED AND THEN CHANGED                    @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - FUNCTION DEFINITION TABLE                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15 -  THE               @Y30LB00*/
*/*          RETURN CODE PASSED TO THE CALLER                @Y30LB00*/
*/*          IS THE LAST CONDITION CODE FOR THE              @Y30LB00*/
*/*          REQUEST                                         @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - TUNE SUCCESSFUL               @Y30LB00*/
*/*          RETURN CODE = 8 - TUNE PARTIALLY                @Y30LB00*/
*/*                            COMPLETED                     @Y30LB00*/
*/*          RETURN CODE = 12 - TUNE NOT SUCCESSFUL          @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0265
*CHNGRTN:                                                          0265
*   PROCEDURE;                      /*                       @Y30LB00*/
@EL00001 L     @13,4(,@13)                                         0265
@EF00001 L     @00,@SIZDATD                                        0265
         LR    @01,@11                                             0265
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0265
         BR    @14                                                 0265
CHNGRTN  STM   @14,@12,@SA00002                                    0265
*                                                                  0266
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0266
*   OLDERID2=NEWERID2;                                             0266
         L     @02,@PC00001                                        0266
         L     @02,GDTTR2(,@02)                                    0266
         MVC   @TS00001(95),NEWERID2(@02)                          0266
         MVC   OLDERID2(95,@02),@TS00001                           0266
*   NEWID2='TUCR';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01022                              0267
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0268
         SLR   SETRC,SETRC                                         0268
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNTAX CHECK THE INPUT PARAMETERS SPECIFIED           @Y30LB00*/
*   /* WITH CHANGE                                           @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0269
*   CALL SYNCHK;                    /*                       @Y30LB00*/
         BAL   @14,SYNCHK                                          0269
*   RESPECIFY                                                      0270
*     RTNREG RSTD;                                                 0270
*   TESTRC=RTNREG;                                                 0271
         LR    TESTRC,RTNREG                                       0271
*   RESPECIFY                                                      0272
*     RTNREG UNRSTD;                /*                       @Y30LB00*/
*                                                                  0272
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE INPUT PARAMETER(S) IS IMPROPERLY               @Y30LB00*/
*   /* SPECIFIED, SET THE RETURN CODE TO TERMINATION         @Y30LB00*/
*   /* ERROR                                                 @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*   IF TESTRC^=0                    /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0273
         BZ    @RF00273                                            0273
*     SETRC=LASTCC12;               /*                       @Y30LB00*/
         LA    SETRC,12                                            0274
*                                                                  0275
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE INPUT PARAMETER(S) IS PROPERLY SPECIFIED       @Y30LB00*/
*   /* DISPLAY AND CHANGE THE APPROPRIATE TUNING             @Y30LB00*/
*   /* PARAMETER(S)                                          @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0275
*   ELSE                            /* INPUT PARAMETER(S)    @Y30LB00
*                                      PROPERLY SPECIFIED    @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
*                                                                  0275
         B     @RC00273                                            0275
@RF00273 DS    0H                                                  0276
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE LRU CLOCK UNIT IS TO BE CHANGED            @Y30LB00*/
*       /* DISPLAY THE PREVIOUS LRU CLOCK UNIT AND           @Y30LB00*/
*       /* AND THEN CHANGE THE LRUCLOCK UNIT                 @Y30LB00*/
*       /* APPROPRIATELY.                                    @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0276
*       IF ADDR(LRUC)^=NULLPTR      /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         L     @02,@PC00001+4                                      0276
         L     @02,FDTPTR+8(,@02)                                  0276
         LTR   @02,@02                                             0276
         BZ    @RF00276                                            0276
*         DO;                       /*                       @Y30LB00*/
*           CHNGLRUK=ON;            /*                       @Y30LB00*/
         OI    CHNGLRUK,B'00100000'                                0278
*           CALL DISLRUC;           /*                       @Y30LB00*/
         BAL   @14,DISLRUC                                         0279
*           RESPECIFY                                              0280
*             RTNREG RSTD;                                         0280
*           TESTRC=RTNREG;                                         0281
         LR    TESTRC,RTNREG                                       0281
*           RESPECIFY                                              0282
*             RTNREG UNRSTD;        /*                       @Y30LB00*/
*           IF TESTRC^=0            /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0283
         BZ    @RF00283                                            0283
*             SETRC=LASTCC12;       /*                       @Y30LB00*/
         LA    SETRC,12                                            0284
*           ELSE                    /*                       @Y30LB00*/
*             DO;                   /*                       @Y30LB00*/
         B     @RC00283                                            0285
@RF00283 DS    0H                                                  0286
*               CALL CHNGLRUC;      /*                       @Y30LB00*/
         BAL   @14,CHNGLRUC                                        0286
*               RESPECIFY                                          0287
*                 RTNREG RSTD;                                     0287
*               TESTRC=RTNREG;                                     0288
         LR    TESTRC,RTNREG                                       0288
*               RESPECIFY                                          0289
*                 RTNREG UNRSTD;    /*                       @Y30LB00*/
*               IF TESTRC^=0        /*                       @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0290
         BZ    @RF00290                                            0290
*                 SETRC=LASTCC12;   /*                       @Y30LB00*/
         LA    SETRC,12                                            0291
*             END;                  /*                       @Y30LB00*/
@RF00290 DS    0H                                                  0293
*           CHNGLRUK=OFF;           /*                       @Y30LB00*/
@RC00283 NI    CHNGLRUK,B'11011111'                                0293
*         END;                      /*                       @Y30LB00*/
*                                                                  0295
*       /*************************************************************/
*       /*                                                           */
*       /* IF LRUCLOCK WAS NOT SPECIFIED OR WAS              @Y30LB00*/
*       /* SPECIFIED AND SUCCESSFULLY CHANGED,               @Y30LB00*/
*       /* DETERMINE IF ACTIVEPAGES IS SPECIFIED.            @Y30LB00*/
*       /* IF ACTIVEPAGES IS TO BE CHANGED, DISPLAY          @Y30LB00*/
*       /* THE PREVIOUS ACTIVEPAGES VALUES AND THEN          @Y30LB00*/
*       /* CHANGE THE ACTIVEPAGES APPROPRIATELY.             @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0295
*       IF SETRC=0                  /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
@RF00276 SLR   @02,@02                                             0295
         CR    SETRC,@02                                           0295
         BNE   @RF00295                                            0295
*         DO;                       /*                       @Y30LB00*/
*           IF ADDR(ACTP)^=NULLPTR  /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         L     @15,@PC00001+4                                      0297
         C     @02,FDTPTR+16(,@15)                                 0297
         BE    @RF00297                                            0297
*             DO;                   /*                       @Y30LB00*/
*               CHNGACTP=ON;        /*                       @Y30LB00*/
         OI    CHNGACTP,B'10000000'                                0299
*               CALL DISSDG;        /*                       @Y30LB00*/
         BAL   @14,DISSDG                                          0300
*               RESPECIFY                                          0301
*                 RTNREG RSTD;                                     0301
*               TESTRC=RTNREG;                                     0302
         LR    TESTRC,RTNREG                                       0302
*               RESPECIFY                                          0303
*                 RTNREG UNRSTD;    /*                       @Y30LB00*/
*               IF TESTRC^=0        /*                       @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         SLR   @05,@05                                             0304
         CR    TESTRC,@05                                          0304
         BE    @RF00304                                            0304
*                 DO;               /*                       @Y30LB00*/
*                                                                  0305
*                   /*************************************************/
*                   /*                                               */
*                   /* IF LRUC PROCESSING HAS BEEN           @Y30LB00*/
*                   /* DONE PRIOR TO THIS ERROR, THE         @Y30LB00*/
*                   /* TUNE REQUEST WAS PARTIALLY            @Y30LB00*/
*                   /* COMPLETED - SET THE CONDITION         @Y30LB00*/
*                   /* CODE TO 8. OR PROCESSING FOR          @Y30LB00*/
*                   /* ACTIVEPAGES IS THE FIRST THING        @Y30LB00*/
*                   /* TO BE DONE, SET THE                   @Y30LB00*/
*                   /* COMPLETION CODE TO 12                 @Y30LB00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0306
*                   IF ADDR(LRUC)^=NULLPTR/*                 @Y30LB00*/
*                     THEN          /*                       @Y30LB00*/
         L     @04,@PC00001+4                                      0306
         C     @05,FDTPTR+8(,@04)                                  0306
         BE    @RF00306                                            0306
*                     SETRC=LASTCC08;/*                      @Y30LB00*/
         LA    SETRC,8                                             0307
*                   ELSE            /*                       @Y30LB00*/
*                     SETRC=LASTCC12;/*                      @Y30LB00*/
         B     @RC00306                                            0308
@RF00306 LA    SETRC,12                                            0308
*                 END;              /*                       @Y30LB00*/
*               ELSE                /*                       @Y30LB00*/
*                 DO;               /*                       @Y30LB00*/
         B     @RC00304                                            0310
@RF00304 DS    0H                                                  0311
*                   CALL CHNGSDG;   /*                       @Y30LB00*/
         BAL   @14,CHNGSDG                                         0311
*                   RESPECIFY                                      0312
*                     RTNREG RSTD;                                 0312
*                   TESTRC=RTNREG;                                 0313
         LR    TESTRC,RTNREG                                       0313
*                   RESPECIFY                                      0314
*                     RTNREG UNRSTD;/*                       @Y30LB00*/
*                   IF TESTRC^=0    /*                       @Y30LB00*/
*                     THEN          /*                       @Y30LB00*/
         SLR   @05,@05                                             0315
         CR    TESTRC,@05                                          0315
         BE    @RF00315                                            0315
*                     DO;           /*                       @Y30LB00*/
*                                                                  0316
*                       /*********************************************/
*                       /*                                           */
*                       /* IF LRUC PROCESSING HAS BEEN       @Y30LB00*/
*                       /* DONE PRIOR TO THIS ERROR          @Y30LB00*/
*                       /* THE TUNE REQUEST WAS              @Y30LB00*/
*                       /* PARTIALLY COMPLETED - SET         @Y30LB00*/
*                       /* THE CONDITION CODE TO 8.          @Y30LB00*/
*                       /* OR PROCESSING OF ACTIVEPAGES      @Y30LB00*/
*                       /* IS THE FIRST THING TO BE          @Y30LB00*/
*                       /* DONE - SET THE COMPLETION         @Y30LB00*/
*                       /* CODE TO 12                        @Y30LB00*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0317
*                       IF ADDR(LRUC)^=NULLPTR/*             @Y30LB00*/
*                         THEN      /*                       @Y30LB00*/
         L     @04,@PC00001+4                                      0317
         C     @05,FDTPTR+8(,@04)                                  0317
         BE    @RF00317                                            0317
*                         SETRC=LASTCC08;/*                  @Y30LB00*/
         LA    SETRC,8                                             0318
*                       ELSE        /*                       @Y30LB00*/
*                         SETRC=LASTCC12;/*                  @Y30LB00*/
         B     @RC00317                                            0319
@RF00317 LA    SETRC,12                                            0319
*                     END;          /*                       @Y30LB00*/
@RC00317 DS    0H                                                  0321
*                 END;              /*                       @Y30LB00*/
@RF00315 DS    0H                                                  0322
*               CHNGACTP=OFF;       /*                       @Y30LB00*/
@RC00304 NI    CHNGACTP,B'01111111'                                0322
*             END;                  /*                       @Y30LB00*/
*                                                                  0324
*           /*********************************************************/
*           /*                                                       */
*           /* IF ACTIVEPAGES WAS NOT SPECIFIED OR WAS       @Y30LB00*/
*           /* SPECIFIED AND SUCCESSFULLY CHANGED,           @Y30LB00*/
*           /* DETERMINE IF LRUGROUPS IS SPECIFIED.          @Y30LB00*/
*           /* IF LRUGROUPS IS SPECIFIED, DISPLAY            @Y30LB00*/
*           /* THE PREVIOUS GROUP-UNITS AND THEN             @Y30LB00*/
*           /* CHANGE THE LRUGROUPS APPROPRIATELY.           @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0324
*           IF SETRC=0              /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
@RF00297 SLR   @02,@02                                             0324
         CR    SETRC,@02                                           0324
         BNE   @RF00324                                            0324
*             DO;                   /*                       @Y30LB00*/
*               IF ADDR(LRUGR)^=NULLPTR/*                    @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         L     @15,@PC00001+4                                      0326
         C     @02,FDTPTR+28(,@15)                                 0326
         BE    @RF00326                                            0326
*                 DO;               /*                       @Y30LB00*/
*                   CHNGLRUG=ON;    /*                       @Y30LB00*/
         OI    CHNGLRUG,B'01000000'                                0328
*                   CALL DISSDG;    /*                       @Y30LB00*/
         BAL   @14,DISSDG                                          0329
*                   RESPECIFY                                      0330
*                     RTNREG RSTD;                                 0330
*                   TESTRC=RTNREG;                                 0331
         LR    TESTRC,RTNREG                                       0331
*                   RESPECIFY                                      0332
*                     RTNREG UNRSTD;/*                       @Y30LB00*/
*                   IF TESTRC^=0    /*                       @Y30LB00*/
*                     THEN          /*                       @Y30LB00*/
         SLR   @05,@05                                             0333
         CR    TESTRC,@05                                          0333
         BE    @RF00333                                            0333
*                     DO;           /*                       @Y30LB00*/
*                                                                  0334
*                       /*********************************************/
*                       /*                                           */
*                       /* IF EITHER LRUC OR ACTIVEPAGES     @Y30LB00*/
*                       /* PROCESSING HAS BEEN DONE          @Y30LB00*/
*                       /* PRIOR TO THIS ERROR, THE TUNE     @Y30LB00*/
*                       /* REQUEST WAS PARTIALLY COMPLETED   @Y30LB00*/
*                       /* SET THE CONDITION CODE TO 8.      @Y30LB00*/
*                       /* OR PROCESSING FOR LRUGR IS THE    @Y30LB00*/
*                       /* ONLY PROCESSING TO BE DONE -      @Y30LB00*/
*                       /* SET THE CONDITION CODE TO 12      @Y30LB00*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0335
*                       IF ADDR(LRUC)^=NULLPTR×/*            @Y30LB00*/
*                           ADDR(ACTP)^=NULLPTR/*            @Y30LB00*/
*                         THEN      /*                       @Y30LB00*/
         L     @04,@PC00001+4                                      0335
         C     @05,FDTPTR+8(,@04)                                  0335
         BNE   @RT00335                                            0335
         C     @05,FDTPTR+16(,@04)                                 0335
         BE    @RF00335                                            0335
@RT00335 DS    0H                                                  0336
*                         SETRC=LASTCC08;/*                  @Y30LB00*/
         LA    SETRC,8                                             0336
*                       ELSE        /*                       @Y30LB00*/
*                         SETRC=LASTCC12;/*                  @Y30LB00*/
         B     @RC00335                                            0337
@RF00335 LA    SETRC,12                                            0337
*                     END;          /*                       @Y30LB00*/
*                   ELSE            /*                       @Y30LB00*/
*                     DO;           /*                       @Y30LB00*/
         B     @RC00333                                            0339
@RF00333 DS    0H                                                  0340
*                       CALL CHNGSDG;/*                      @Y30LB00*/
         BAL   @14,CHNGSDG                                         0340
*                       RESPECIFY                                  0341
*                         RTNREG RSTD;                             0341
*                       TESTRC=RTNREG;                             0342
         LR    TESTRC,RTNREG                                       0342
*                       RESPECIFY                                  0343
*                         RTNREG UNRSTD;/*                   @Y30LB00*/
*                       IF TESTRC^=0/*                       @Y30LB00*/
*                         THEN      /*                       @Y30LB00*/
         SLR   @05,@05                                             0344
         CR    TESTRC,@05                                          0344
         BE    @RF00344                                            0344
*                         DO;       /*                       @Y30LB00*/
*                                                                  0345
*                           /*****************************************/
*                           /*                                       */
*                           /* IF EITHER LRUC OR ACTPAGE     @Y30LB00*/
*                           /* PROCESSING HAS BEEN DONE      @Y30LB00*/
*                           /* PRIOR TO THIS ERROR, THE      @Y30LB00*/
*                           /* TUNE REQUEST WAS PARTIALLY    @Y30LB00*/
*                           /* COMPLETED - SET THE           @Y30LB00*/
*                           /* CONDITION CODE TO 8. OR       @Y30LB00*/
*                           /* PROCESSING FOR LRUGR IS THE   @Y30LB00*/
*                           /* ONLY PROCESSING TO BE DONE    @Y30LB00*/
*                           /* SET THE CONDITION CODE TO     @Y30LB00*/
*                           /* 12                            @Y30LB00*/
*                           /*                                       */
*                           /*****************************************/
*                                                                  0346
*                           IF ADDR(LRUC)^=NULLPTR×/*        @Y30LB00*/
*                               ADDR(ACTP)^=NULLPTR/*        @Y30LB00*/
*                             THEN  /*                       @Y30LB00*/
         L     @04,@PC00001+4                                      0346
         C     @05,FDTPTR+8(,@04)                                  0346
         BNE   @RT00346                                            0346
         C     @05,FDTPTR+16(,@04)                                 0346
         BE    @RF00346                                            0346
@RT00346 DS    0H                                                  0347
*                             SETRC=LASTCC08;/*              @Y30LB00*/
         LA    SETRC,8                                             0347
*                           ELSE    /*                       @Y30LB00*/
*                             SETRC=LASTCC12;/*              @Y30LB00*/
         B     @RC00346                                            0348
@RF00346 LA    SETRC,12                                            0348
*                         END;      /*                       @Y30LB00*/
@RC00346 DS    0H                                                  0350
*                     END;          /*                       @Y30LB00*/
@RF00344 DS    0H                                                  0351
*                   CHNGLRUG=OFF;   /*                       @Y30LB00*/
@RC00333 NI    CHNGLRUG,B'10111111'                                0351
*                 END;              /*                       @Y30LB00*/
*             END;                  /*                       @Y30LB00*/
@RF00326 DS    0H                                                  0354
*         END;                      /*                       @Y30LB00*/
@RF00324 DS    0H                                                  0355
*     END;                          /*                       @Y30LB00*/
*                                                                  0355
@RF00295 DS    0H                                                  0356
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCTU01                                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0356
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00273 LR    @15,SETRC                                           0356
         L     @14,@SA00002                                        0356
         LM    @00,@12,@SA00002+8                                  0356
         BR    @14                                                 0356
*   END CHNGRTN;                    /*                       @Y30LB00*/
*                                                                  0358
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - SYNCHK                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - SYNTAX CHECK THE VALUES OF LRUCLOCK,          @Y30LB00*/
*/*            ACTIVEPAGES, AND LRUGROUPS TO INSURE THAT     @Y30LB00*/
*/*            VALID PARAMETERS HAVE BEEN PASSED             @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          MESSAGES TO SYSPRINT                            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          IDC3850I                                        @Y30LB00*/
*/*          IDC3851I                                        @Y30LB00*/
*/*          IDC3852I                                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - FUNCTION DEFINITION TABLE                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - TULRUC IN TUTBL, IF LRUCLOCK                    @Y30LB00*/
*/*          SPECIFIED AND SPECIFIED PROPERLY                @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN = 0 - ALL PARAMETER VALUES               @Y30LB00*/
*/*                       PROPERLY SPECIFIED                 @Y30LB00*/
*/*          RETURN CODE = 4 - SYNTAX ERROR                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0358
*SYNCHK:                                                           0358
*   PROCEDURE;                      /*                       @Y30LB00*/
SYNCHK   STM   @14,@02,@SA00003                                    0358
         STM   @04,@12,@SA00003+20                                 0358
*                                                                  0359
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   OLDERID2=NEWERID2;                                             0359
         L     @02,@PC00001                                        0359
         L     @02,GDTTR2(,@02)                                    0359
         MVC   @TS00001(95),NEWERID2(@02)                          0359
         MVC   OLDERID2(95,@02),@TS00001                           0359
*   NEWID2='TUSY';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01031                              0360
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0361
         SLR   @15,@15                                             0361
         LR    SETRC,@15                                           0361
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LRUCLOCK IS SPECIFIED, CHECK TO INSURE THAT        @Y30LB00*/
*   /* THE VALUE SPECIFIED IS VALID - 128, 258, 512,         @Y30LB00*/
*   /* 1024, 2048, 4096, 8192, 16384.                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*   IF ADDR(LRUC)^=NULLPTR          /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         L     @02,@PC00001+4                                      0362
         C     @15,FDTPTR+8(,@02)                                  0362
         BE    @RF00362                                            0362
*     DO;                           /*                       @Y30LB00*/
*                                                                  0363
*       /*************************************************************/
*       /*                                                           */
*       /* A TABLE CONTAINING THE VALID VALUES FOR           @Y30LB00*/
*       /* THE LRUCLOCK PARAMETER WITH THE CORRES-           @Y30LB00*/
*       /* PONDING HEX VALUES FOR THE MSC IS USED TO         @Y30LB00*/
*       /* DETERMINE IF THE VALUE PASSED IS VALID.           @Y30LB00*/
*       /* IF A MATCH IS FOUND, THE CORRESPONDING            @Y30LB00*/
*       /* HEX VALUE IS PUT IN TUTBL, TO BE                  @Y30LB00*/
*       /* USED LATER WHEN THE CHANGE IS PROCESSED           @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0364
*       DO INDEX=1 TO CLOCKCNT;     /*                       @Y30LB00*/
         LA    @02,1                                               0364
         B     @DE00364                                            0364
@DL00364 DS    0H                                                  0365
*         IF LRUCVAL=CLOCKVAL(INDEX)/*                       @Y30LB00*/
*           THEN                    /*                       @Y30LB00*/
         L     @15,@PC00001+4                                      0365
         L     @01,FDTPTR+8(,@15)                                  0365
         LR    @15,@02                                             0365
         SLA   @15,2                                               0365
         L     @14,LRUCVAL(,@01)                                   0365
         C     @14,CLOCKVAL-4(@15)                                 0365
         BNE   @RF00365                                            0365
*           TULRUC=TUVALS(INDEX);   /*                       @Y30LB00*/
         SLR   @15,@15                                             0366
         IC    @15,TUVALS-1(@02)                                   0366
         STC   @15,TULRUC                                          0366
*       END;                        /*                       @Y30LB00*/
*                                                                  0367
@RF00365 LA    @02,1                                               0367
         SLR   @15,@15                                             0367
         IC    @15,INDEX                                           0367
         ALR   @02,@15                                             0367
@DE00364 STC   @02,INDEX                                           0367
         C     @02,CLOCKCNT                                        0367
         BNH   @DL00364                                            0367
*       /*************************************************************/
*       /*                                                           */
*       /* IF A MATCH IS NOT FOUND FOR THE LRUCLOCK          @Y30LB00*/
*       /* VALUE PASSED, THE RETURN CODE IS SET AND          @Y30LB00*/
*       /* A MESSAGE IS ISSUED INDICATING INVALID            @Y30LB00*/
*       /* VALUE                                             @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0368
*       IF TULRUC=0                 /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         CLI   TULRUC,0                                            0368
         BNE   @RF00368                                            0368
*         DO;                       /*                       @Y30LB00*/
*           SETRC=4;                /*                       @Y30LB00*/
         LA    SETRC,4                                             0370
*           DARGLIST=''B;           /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0371
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0371
*           DARGSMOD=TUNEMSG;       /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0372
*           DARGSENT=MSG3850I;      /*                       @Y30LB00*/
         MVI   DARGSENT(@02),X'01'                                 0373
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB00*/
         L     @02,@PC00001                                        0374
         ST    @02,@AL00001                                        0374
         LA    @15,@CF00114                                        0374
         ST    @15,@AL00001+4                                      0374
         LA    @15,DDSTRU                                          0374
         ST    @15,@AL00001+8                                      0374
         MVI   @AL00001+8,X'80'                                    0374
         L     @15,GDTPRT(,@02)                                    0374
         LA    @01,@AL00001                                        0374
         BALR  @14,@15                                             0374
*         END;                      /*                       @Y30LB00*/
*     END;                          /*                       @Y30LB00*/
@RF00368 DS    0H                                                  0377
*                                                                  0377
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ACTPAGE IS SPECIFIED, CHECK TO INSURE THAT         @Y30LB00*/
*   /* LOWER NUMBER OF PAGES IS LESS THAN THE HIGHER         @Y30LB00*/
*   /* NUMBER OF PAGES                                       @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   IF ADDR(ACTP)^=NULLPTR          /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
@RF00362 L     @02,@PC00001+4                                      0377
         L     @15,FDTPTR+16(,@02)                                 0377
         LTR   @15,@15                                             0377
         BZ    @RF00377                                            0377
*     DO;                           /*                       @Y30LB00*/
*       IF ACTPLVAL=>ACTPHVAL       /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         L     @01,FDTPTR+20(,@02)                                 0379
         L     @02,FDTPTR+24(,@02)                                 0379
         L     @15,ACTPLVAL(,@01)                                  0379
         C     @15,ACTPHVAL(,@02)                                  0379
         BL    @RF00379                                            0379
*         DO;                       /*                       @Y30LB00*/
*                                                                  0380
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE LOWER NUMBER OF PAGES SPECIFIED        @Y30LB00*/
*           /* IS EQUAL TO OR GREATER THAN THE HIGHER        @Y30LB00*/
*           /* NUMBER OF PAGES, THE RETURN CODE IS SET       @Y30LB00*/
*           /* AND A MESSAGE IS ISSUED INDICATING THE        @Y30LB00*/
*           /* ABOVE.                                        @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0381
*           SETRC=4;                /*                       @Y30LB00*/
         LA    SETRC,4                                             0381
*           DARGLIST=''B;           /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0382
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0382
*           DARGSMOD=TUNEMSG;       /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0383
*           DARGSENT=MSG3851I;      /*                       @Y30LB00*/
         MVI   DARGSENT(@02),X'02'                                 0384
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB00*/
         L     @02,@PC00001                                        0385
         ST    @02,@AL00001                                        0385
         LA    @15,@CF00114                                        0385
         ST    @15,@AL00001+4                                      0385
         LA    @15,DDSTRU                                          0385
         ST    @15,@AL00001+8                                      0385
         MVI   @AL00001+8,X'80'                                    0385
         L     @15,GDTPRT(,@02)                                    0385
         LA    @01,@AL00001                                        0385
         BALR  @14,@15                                             0385
*         END;                      /*                       @Y30LB00*/
*     END;                          /*                       @Y30LB00*/
@RF00379 DS    0H                                                  0388
*                                                                  0388
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LRUGROUPS IS SPECIFIED, CHECK THE SUMMATION        @Y30LB00*/
*   /* OF THE GROUP-UNITS SPECIFIED TO INSURE THAT           @Y30LB00*/
*   /* IT IS NOT GREATER THAN 16.                            @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0388
*   IF ADDR(LRUGR)^=NULLPTR         /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
@RF00377 L     @02,@PC00001+4                                      0388
         L     @02,FDTPTR+28(,@02)                                 0388
         LTR   @02,@02                                             0388
         BZ    @RF00388                                            0388
*     DO;                           /*                       @Y30LB00*/
*       LRUGRSUM=0;                 /*                       @Y30LB00*/
         MVI   LRUGRSUM,X'00'                                      0390
*       DO INDEX=1 TO LRUGRCNT;     /*                       @Y30LB00*/
         LA    @02,1                                               0391
         B     @DE00391                                            0391
@DL00391 DS    0H                                                  0392
*         LRUGRSUM=LRUGRSUM+LRUGRVAL(INDEX);/*               @Y30LB00*/
         LR    @15,@02                                             0392
         SLA   @15,2                                               0392
         L     @14,@PC00001+4                                      0392
         L     @01,FDTPTR+28(,@14)                                 0392
         SLR   @14,@14                                             0392
         IC    @14,LRUGRSUM                                        0392
         AL    @14,LRUGRVAL-4(@15,@01)                             0392
         STC   @14,LRUGRSUM                                        0392
*       END;                        /*                       @Y30LB00*/
         AL    @02,@CF00218                                        0393
@DE00391 STC   @02,INDEX                                           0393
         L     @15,@PC00001+4                                      0393
         L     @01,FDTPTR+28(,@15)                                 0393
         C     @02,LRUGRCNT(,@01)                                  0393
         BNH   @DL00391                                            0393
*       IF LRUGRSUM>16              /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         CLI   LRUGRSUM,16                                         0394
         BNH   @RF00394                                            0394
*         DO;                       /*                       @Y30LB00*/
*                                                                  0395
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE SUM OF LRUGROUPS UNITS IS              @Y30LB00*/
*           /* GREATER THAN 16, THE RETURN CODE IS SET       @Y30LB00*/
*           /* AND A MESSAGE IS ISSUED INDICATING            @Y30LB00*/
*           /* THE ABOVE                                     @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0396
*           SETRC=4;                /*                       @Y30LB00*/
         LA    SETRC,4                                             0396
*           DARGLIST=''B;           /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0397
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0397
*           DARGSMOD=TUNEMSG;       /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0398
*           DARGSENT=MSG3852I;      /*                       @Y30LB00*/
         MVI   DARGSENT(@02),X'03'                                 0399
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB00*/
         L     @02,@PC00001                                        0400
         ST    @02,@AL00001                                        0400
         LA    @15,@CF00114                                        0400
         ST    @15,@AL00001+4                                      0400
         LA    @15,DDSTRU                                          0400
         ST    @15,@AL00001+8                                      0400
         MVI   @AL00001+8,X'80'                                    0400
         L     @15,GDTPRT(,@02)                                    0400
         LA    @01,@AL00001                                        0400
         BALR  @14,@15                                             0400
*         END;                      /*                       @Y30LB00*/
*     END;                          /*                       @Y30LB00*/
*                                                                  0402
@RF00394 DS    0H                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CHNGRTN                                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RF00388 LR    @15,SETRC                                           0403
         L     @14,@SA00003                                        0403
         LM    @00,@02,@SA00003+8                                  0403
         LM    @04,@12,@SA00003+20                                 0403
         BR    @14                                                 0403
*   END SYNCHK;                     /*                       @Y30LB00*/
*                                                                  0405
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - DISRTN                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - ROUTE THE REQUEST TO THE APPROPRIATE          @Y30LB00*/
*/*            SUB-PROCEDURE SUCH THAT ALL THE               @Y30LB00*/
*/*            MSC TUNING PARAMETERS ARE DISPLAYED           @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - FUNCTION DEFINITION TABLE                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15 - THE                @Y30LB00*/
*/*          RETURN CODE PASSED TO THE CALLER                @Y30LB00*/
*/*          IS THE LAST CONDITION CODE FOR THE              @Y30LB00*/
*/*          REQUEST                                         @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - TUNE SUCCESSFUL               @Y30LB00*/
*/*          RETURN CODE = 8 - TUNE PARTIALLY COMPLETED      @Y30LB00*/
*/*          RETURN CODE = 12 - TUNE NOT SUCCESSFUL          @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0405
*DISRTN:                                                           0405
*   PROCEDURE;                      /*                       @Y30LB00*/
DISRTN   STM   @14,@12,@SA00004                                    0405
*                                                                  0406
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0406
*   OLDERID2=NEWERID2;                                             0406
         L     @02,@PC00001                                        0406
         L     @02,GDTTR2(,@02)                                    0406
         MVC   @TS00001(95),NEWERID2(@02)                          0406
         MVC   OLDERID2(95,@02),@TS00001                           0406
*   NEWID2='TUDR';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01035                              0407
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0408
         SLR   SETRC,SETRC                                         0408
*   /*****************************************************************/
*   /*                                                               */
*   /* DISPLAY THE LRUCLOCK                                  @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   CALL DISLRUC;                   /*                       @Y30LB00*/
         BAL   @14,DISLRUC                                         0409
*   RESPECIFY                                                      0410
*     RTNREG RSTD;                                                 0410
*   TESTRC=RTNREG;                                                 0411
         LR    TESTRC,RTNREG                                       0411
*   RESPECIFY                                                      0412
*     RTNREG UNRSTD;                /*                       @Y30LB00*/
*                                                                  0412
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DISPLAY OF LRUCLOCK FAILED, SET THE            @Y30LB00*/
*   /* LAST CONDITION CODE. IF THE DISPLAY OF LRUCLOCK       @Y30LB00*/
*   /* WAS SUCCESSFUL, DISPLAY THE ACTIVEPAGES AND           @Y30LB00*/
*   /* LRUGROUPS TUNING PARAMETERS FOR THE VALID RANGE       @Y30LB00*/
*   /* OF STAGING DRIVE GROUPS                               @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   IF TESTRC^=0                    /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0413
         BZ    @RF00413                                            0413
*     SETRC=LASTCC12;               /*                       @Y30LB00*/
         LA    SETRC,12                                            0414
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
         B     @RC00413                                            0415
@RF00413 DS    0H                                                  0416
*       CALL DISSDG;                /*                       @Y30LB00*/
         BAL   @14,DISSDG                                          0416
*       RESPECIFY                                                  0417
*         RTNREG RSTD;                                             0417
*       TESTRC=RTNREG;                                             0418
         LR    TESTRC,RTNREG                                       0418
*       RESPECIFY                                                  0419
*         RTNREG UNRSTD;            /*                       @Y30LB00*/
*       IF TESTRC^=0                /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0420
         BZ    @RF00420                                            0420
*         SETRC=LASTCC08;           /*                       @Y30LB00*/
         LA    SETRC,8                                             0421
*     END;                          /*                       @Y30LB00*/
*                                                                  0422
@RF00420 DS    0H                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCTU01                                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00413 LR    @15,SETRC                                           0423
         L     @14,@SA00004                                        0423
         LM    @00,@12,@SA00004+8                                  0423
         BR    @14                                                 0423
*   END DISRTN;                     /*                       @Y30LB00*/
*                                                                  0425
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - LRUGTRAN                                @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - TRANSLATE FOR A CHANGE REQUEST, THE           @Y30LB00*/
*/*            LRUGROUP INPUT VALUES INTO                    @Y30LB00*/
*/*            ACCEPTABLE MSC TUNING PARAMETERS              @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*            TRANSLATE FOR A DISPLAY REQUEST,              @Y30LB00*/
*/*            MESSAGE DATA FOR A DISPLAY LRUGROUPS          @Y30LB00*/
*/*            INTO VALUES READABLE BY THE UTILITY           @Y30LB00*/
*/*            USER                                          @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - TUTBL - CHNGLRUG                                 @Y30LB00*/
*/*         FDTTBL - LRUGCNT AND LRUGRVAL                    @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*         TUTBL - MESSAGE DATA FROM THE DISPLAY            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - TUTBL - INPUT DATA TRANSLATED INTO              @Y30LB00*/
*/*                    ACCEPTABLE MSC TUNING PARMS           @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          TUTBL - MESSAGE DATA TRANSLATED INTO            @Y30LB00*/
*/*                    VALUES READABLE BY THE                @Y30LB00*/
*/*                    UTILITY USER                          @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0425
*LRUGTRAN:                                                         0425
*   PROCEDURE;                      /*                       @Y30LB00*/
LRUGTRAN STM   @14,@02,@SA00005                                    0425
         STM   @04,@12,@SA00005+20                                 0425
*                                                                  0426
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0426
*   OLDERID2=NEWERID2;                                             0426
         L     @02,@PC00001                                        0426
         L     @02,GDTTR2(,@02)                                    0426
         MVC   @TS00001(95),NEWERID2(@02)                          0426
         MVC   OLDERID2(95,@02),@TS00001                           0426
*   NEWID2='TULR';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01040                              0427
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0428
         SLR   SETRC,SETRC                                         0428
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CHNGLRUG IS SPECIFIED, TRANSLATE THE INPUT         @Y30LB00*/
*   /* LRUGROUPS VALUES INTO DATA ACCEPTABLE BY THE          @Y30LB00*/
*   /* MSC.                                                  @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0429
*   IF CHNGLRUG=ON                  /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         TM    CHNGLRUG,B'01000000'                                0429
         BNO   @RF00429                                            0429
*     DO;                           /*                       @Y30LB00*/
*                                                                  0430
*       /*************************************************************/
*       /*                                                           */
*       /* THE INPUT VALUES FOR LRUGROUPS ARE                @Y30LB00*/
*       /* TRANSLATED INTO VALUES ACCEPTABLE TO THE          @Y30LB00*/
*       /* MSC.                                              @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* THE LRUGROUPS PARAMETER CAN HAVE VALUES           @Y30LB00*/
*       /* A, B, C, D, THEY ARE TRANSLATED AS FOLLOWS        @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* TA - (A - 1) ×× 0                                 @Y30LB00*/
*       /* TB - ((A+B) - 1) ×× 0                             @Y30LB00*/
*       /* TC - ((A+B+C) - 1) ×× 0                           @Y30LB00*/
*       /* TD - ((A+B+C+D) - 1) ×× 0                         @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* IF ALL FOUR VALUES ARE NOT SPECIFIED              @Y30LB00*/
*       /* THE VALUE(S) NOT SPECIFIED ARE EQUATED TO         @Y30LB00*/
*       /* THE LAST VALUE CALCULATED                         @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0431
*       LRUGRSUM=-1;                /*                       @Y30LB00*/
         SLR   @02,@02                                             0431
         BCTR  @02,0                                               0431
         STC   @02,LRUGRSUM                                        0431
*       DO INDEX=1 TO LRUGRCNT;     /*                       @Y30LB00*/
         LA    @02,1                                               0432
         B     @DE00432                                            0432
@DL00432 DS    0H                                                  0433
*         LRUGRSUM=LRUGRSUM+LGRPVAL(INDEX);/*                @Y30LB00*/
         LR    @15,@02                                             0433
         SLA   @15,2                                               0433
         L     @14,@PC00001+4                                      0433
         L     @01,FDTPTR+28(,@14)                                 0433
         SLR   @14,@14                                             0433
         IC    @14,LRUGRSUM                                        0433
         SLR   @00,@00                                             0433
         IC    @00,LGRPVAL-4(@15,@01)                              0433
         ALR   @14,@00                                             0433
         STC   @14,LRUGRSUM                                        0433
*         TRANSBYT=LRUGRSUM;        /*                       @Y30LB00*/
         STC   @14,TRANSBYT                                        0434
*         PACK(CHNGLRGU(INDEX),TRANBYTE);/*                  @Y30LB00*/
         LA    @01,CHNGLRGU-1(@02)                                 0435
         PACK  0(1,@01),TRANBYTE(1)                                0435
*       END;                        /*                       @Y30LB00*/
         AL    @02,@CF00218                                        0436
@DE00432 STC   @02,INDEX                                           0436
         L     @15,@PC00001+4                                      0436
         L     @01,FDTPTR+28(,@15)                                 0436
         C     @02,LRUGRCNT(,@01)                                  0436
         BNH   @DL00432                                            0436
*       IF LRUGRCNT<4               /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         L     @02,@PC00001+4                                      0437
         L     @02,FDTPTR+28(,@02)                                 0437
         L     @02,LRUGRCNT(,@02)                                  0437
         C     @02,@CF00041                                        0437
         BNL   @RF00437                                            0437
*         DO;                       /*                       @Y30LB00*/
*           DO INDEX=(LRUGRCNT+1) TO 4;/*                    @Y30LB00*/
         AL    @02,@CF00218                                        0439
         B     @DE00439                                            0439
@DL00439 DS    0H                                                  0440
*             CHNGLRGU(INDEX)=CHNGLRGU(INDEX-1);/*           @Y30LB00*/
         LA    @01,CHNGLRGU-1(@02)                                 0440
         LA    @15,CHNGLRGU-2(@02)                                 0440
         MVC   0(1,@01),0(@15)                                     0440
*           END;                    /*                       @Y30LB00*/
         AL    @02,@CF00218                                        0441
@DE00439 STC   @02,INDEX                                           0441
         C     @02,@CF00041                                        0441
         BNH   @DL00439                                            0441
*         END;                      /*                       @Y30LB00*/
*     END;                          /*                       @Y30LB00*/
*                                                                  0444
*   /*****************************************************************/
*   /*                                                               */
*   /* THE MSC TUNING PARAMETER FOR LRUGROUPS WAS            @Y30LB00*/
*   /* DISPLAYED. TRANSLATE THE MSC TUNING PARAMETER         @Y30LB00*/
*   /* INTO VALUES READABLE BY THE UTILITY USER.             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
*                                                                  0444
         B     @RC00429                                            0444
@RF00429 DS    0H                                                  0445
*       /*************************************************************/
*       /*                                                           */
*       /* THE MSC DATA VALUES FOR LRUGROUPS ARE             @Y30LB00*/
*       /* TRANSLATED INTO VALUES READABLE BY THE            @Y30LB00*/
*       /* UTILITY USER.                                     @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* EACH VALUE FROM THE MSC IS 1 BYTE CONTAINING      @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* N0                                                @Y30LB00*/
*       /*                                                   @Y30LB00*/
*       /* FOR THE FIRST BYTE THE 'N' AND '0' MUST           @Y30LB00*/
*       /* BE REVERSED '0N' AND ONE ADDED TO OBTAIN          @Y30LB00*/
*       /* THE FIRST GROUP-UNIT. THE SECOND AND              @Y30LB00*/
*       /* SUBSEQUENT GROUP UNITS ARE CALCULATED BY          @Y30LB00*/
*       /* REVERSING 'N0' TO '0N' AND SUBTRACTING            @Y30LB00*/
*       /* THE SUM OF THE LAST GROUP-UNITS CALCULATED        @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0445
*       NUMLRGS=4;                  /*                       @Y30LB00*/
         MVC   NUMLRGS(2),@CH00041                                 0445
*       LRUGRSUM=0;                 /*                       @Y30LB00*/
         MVI   LRUGRSUM,X'00'                                      0446
*       TRANSBYT=MSGGBYTE(1);       /*                       @Y30LB00*/
         MVC   TRANSBYT(1),MSGGBYTE                                0447
*       PACK(LRUGSUM,TRANBYTE);     /*                       @Y30LB00*/
         PACK  LRUGSUM(1),TRANBYTE(1)                              0448
*       DISDLRGS(1)=LRUGRSUM+1;     /*                       @Y30LB00*/
         LA    @02,1                                               0449
         SLR   @15,@15                                             0449
         IC    @15,LRUGRSUM                                        0449
         ALR   @15,@02                                             0449
         STH   @15,DISDLRGS                                        0449
*       DO INDEX=1 TO 3;            /*                       @Y30LB00*/
         STC   @02,INDEX                                           0450
@DL00450 DS    0H                                                  0451
*         IF MSGGBYTE(INDEX+1)=MSGGBYTE(INDEX)/*             @Y30LB00*/
*           THEN                    /*                       @Y30LB00*/
         SLR   @15,@15                                             0451
         IC    @15,MSGGBYTE(@02)                                   0451
         SLR   @14,@14                                             0451
         IC    @14,MSGGBYTE-1(@02)                                 0451
         CR    @15,@14                                             0451
         BNE   @RF00451                                            0451
*           NUMLRGS=NUMLRGS-1;      /*                       @Y30LB00*/
         LH    @02,NUMLRGS                                         0452
         N     @02,@CF01099                                        0452
         BCTR  @02,0                                               0452
         STH   @02,NUMLRGS                                         0452
*         ELSE                      /*                       @Y30LB00*/
*           DO;                     /*                       @Y30LB00*/
         B     @RC00451                                            0453
@RF00451 DS    0H                                                  0454
*             NEXTLGRP=0;           /*                       @Y30LB00*/
         MVI   NEXTLGRP,X'00'                                      0454
*             TRANSBYT=MSGGBYTE(INDEX+1);/*                  @Y30LB00*/
*                                                                  0455
         SLR   @02,@02                                             0455
         IC    @02,INDEX                                           0455
         SLR   @15,@15                                             0455
         IC    @15,MSGGBYTE(@02)                                   0455
         STC   @15,TRANSBYT                                        0455
*             /*******************************************************/
*             /*                                                     */
*             /* USE PACK TO REVERSE                         @Y30LB00*/
*             /* 'N0' TO '0N'                                @Y30LB00*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0456
*             PACK(NXTLGRP,TRANBYTE);/*                      @Y30LB00*/
         PACK  NXTLGRP(1),TRANBYTE(1)                              0456
*             DISDLRGS(INDEX+1)=NEXTLGRP-LRUGRSUM;/*         @Y30LB00*/
         ALR   @02,@02                                             0457
         SLR   @15,@15                                             0457
         IC    @15,NEXTLGRP                                        0457
         LR    @14,@15                                             0457
         SLR   @09,@09                                             0457
         IC    @09,LRUGRSUM                                        0457
         SLR   @14,@09                                             0457
         STH   @14,DISDLRGS(@02)                                   0457
*             LRUGRSUM=NEXTLGRP;    /*                       @Y30LB00*/
         STC   @15,LRUGRSUM                                        0458
*           END;                    /*                       @Y30LB00*/
*       END;                        /*                       @Y30LB00*/
@RC00451 LA    @02,1                                               0460
         SLR   @15,@15                                             0460
         IC    @15,INDEX                                           0460
         ALR   @02,@15                                             0460
         STC   @02,INDEX                                           0460
         C     @02,@CF00161                                        0460
         BNH   @DL00450                                            0460
*     END;                          /*                       @Y30LB00*/
*                                                                  0461
*   /*****************************************************************/
*   /*                                                               */
*   /* THE TUTBL IS DUMPED ONCE THE LRUGR INPUT DATA         @Y30LB00*/
*   /* OR THE MSSC DATA FOR LRUGR HAS BEEN TRANSLATED        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0462
*   IF GDTDBG=NULLPTR THEN                                         0462
@RC00429 L     @02,@PC00001                                        0462
         L     @02,GDTDBG(,@02)                                    0462
         LTR   @02,@02                                             0462
         BZ    @RT00462                                            0462
*     ;                                                            0463
*   ELSE                                                           0464
*     DO;                                                          0464
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB00*/
         LA    DMPINDEX,DUMPAREA                                   0465
*       DMPITMNM='TUTBL';                                          0466
         MVI   DMPITMNM+5(DMPINDEX),C' '                           0466
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         0466
         MVC   DMPITMNM(5,DMPINDEX),@CC01043                       0466
*       DMPITMPT=ADDR(TUTBL);                                      0467
         LA    @15,TUTBL                                           0467
         ST    @15,DMPITMPT(,DMPINDEX)                             0467
*       DMPITMLN=LENGTH(TUTBL);                                    0468
         MVC   DMPITMLN(2,DMPINDEX),@CH01085                       0468
*       DMPITMTP='H';                                              0469
         MVI   DMPITMTP(DMPINDEX),C'H'                             0469
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0470
*                                                                  0470
         AL    DMPINDEX,@CF00472                                   0470
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0471
*       DMPTRM=DMPTRMVL;                                           0471
         MVI   DMPTRM(DMPINDEX),X'FF'                              0471
*     END;                          /*                       @Y30LB00*/
*   IF GDTDBG=NULLPTR THEN                                         0473
@RT00462 L     @02,@PC00001                                        0473
         L     @02,GDTDBG(,@02)                                    0473
         LTR   @02,@02                                             0473
         BZ    @RT00473                                            0473
*     ;                                                            0474
*   ELSE                                                           0475
*     CALL IDCDB010(GDTTBL,'TULA',ADDR(DUMPAREA));/*         @Y30LB00*/
*                                                                  0475
         L     @02,@PC00001                                        0475
         ST    @02,@AL00001                                        0475
         LA    @15,@CC01045                                        0475
         ST    @15,@AL00001+4                                      0475
         LA    @15,DUMPAREA                                        0475
         ST    @15,@AFTEMPS                                        0475
         LA    @15,@AFTEMPS                                        0475
         ST    @15,@AL00001+8                                      0475
         MVI   @AL00001+8,X'80'                                    0475
         L     @15,GDTDBG(,@02)                                    0475
         LA    @01,@AL00001                                        0475
         BALR  @14,@15                                             0475
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER - CHNGSDG OR DISSDG                  @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RT00473 LR    @15,SETRC                                           0476
         L     @14,@SA00005                                        0476
         LM    @00,@02,@SA00005+8                                  0476
         LM    @04,@12,@SA00005+20                                 0476
         BR    @14                                                 0476
*   END LRUGTRAN;                   /*                       @Y30LB00*/
*                                                                  0478
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - DISLRUC                                 @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - DISPLAY THE MSC TUNING PARAMETER              @Y30LB00*/
*/*            FOR LRUCLOCK                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          MESSAGES TO SYSPRINT                            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          IDC2853I                                        @Y30LB00*/
*/*          DATA LINE - DISPLAY OF THE LRUCLOCK             @Y30LB00*/
*/*                      VALUE                               @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - TUNELIST                                         @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - DISPLAY SUCCESSFUL            @Y30LB00*/
*/*          RETURN CODE = 4 - DISPLAY NOT                   @Y30LB00*/
*/*                            SUCCESSFUL                    @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0478
*DISLRUC:                                                          0478
*   PROCEDURE;                      /*                       @Y30LB00*/
DISLRUC  STM   @14,@12,@SA00006                                    0478
*                                                                  0479
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0479
*   OLDERID2=NEWERID2;                                             0479
         L     @02,@PC00001                                        0479
         L     @15,GDTTR2(,@02)                                    0479
         MVC   @TS00001(95),NEWERID2(@15)                          0479
         MVC   OLDERID2(95,@15),@TS00001                           0479
*   NEWID2='TUDL';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@15),@CC01049                              0480
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0481
         SLR   @15,@15                                             0481
         LR    SETRC,@15                                           0481
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE TUNE REQUEST BLOCK                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0482
*   TULIST=''B;                     /*                       @Y30LB00*/
         L     @14,TUPTR                                           0482
         XC    TULIST(20,@14),TULIST(@14)                          0482
*   TUNCLOCK=ON;                    /*                       @Y30LB00*/
*                                                                  0483
         OI    TUNCLOCK(@14),B'00100000'                           0483
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO DISPLAY THE MSC LRUCLOCK TUNING         @Y30LB00*/
*   /* PARAMETER                                             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   IF GDTDBG=NULLPTR THEN                                         0484
         C     @15,GDTDBG(,@02)                                    0484
         BE    @RT00484                                            0484
*     ;                                                            0485
*   ELSE                                                           0486
*     CALL IDCDB010(GDTTBL,'TUDU'); /*                       @Y30LB00*/
         L     @02,@PC00001                                        0486
         ST    @02,@AL00001                                        0486
         LA    @15,@CC01050                                        0486
         ST    @15,@AL00001+4                                      0486
         MVI   @AL00001+4,X'80'                                    0486
         L     @15,GDTDBG(,@02)                                    0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*   CALL IDCSASS0(GDTTBL,TUNE,TUPTR,REASONCD,/*              @Y30LB00*/
*       ECBCODE,TUMSGPTR);          /*                       @Y30LB00*/
@RT00484 L     @05,@PC00001                                        0487
         ST    @05,@AL00001                                        0487
         LA    @02,TUNE                                            0487
         ST    @02,@AL00001+4                                      0487
         LA    @02,TUPTR                                           0487
         ST    @02,@AL00001+8                                      0487
         LA    @02,REASONCD                                        0487
         ST    @02,@AL00001+12                                     0487
         LA    @02,ECBCODE                                         0487
         ST    @02,@AL00001+16                                     0487
         LA    @02,TUMSGPTR                                        0487
         ST    @02,@AL00001+20                                     0487
         MVI   @AL00001+20,X'80'                                   0487
         L     @15,GDTSSC(,@05)                                    0487
         LA    @01,@AL00001                                        0487
         BALR  @14,@15                                             0487
*   RESPECIFY                                                      0488
*     RTNREG RSTD;                                                 0488
*   TESTRC=RTNREG;                                                 0489
         LR    TESTRC,RTNREG                                       0489
*   RESPECIFY                                                      0490
*     RTNREG UNRSTD;                /*                       @Y30LB00*/
*                                                                  0490
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DISPLAY FAILED, SET THE RETURN CODE AND        @Y30LB00*/
*   /* POSSIBLY, CALL SSCMSG TO PRINT THE                    @Y30LB00*/
*   /* APPROPRIATE MESSAGE REASON CODE. PRINT THE            @Y30LB00*/
*   /* SECONDARY MESSAGE WHICH INDICATES THAT THE            @Y30LB00*/
*   /* DISPLAY OF LRUCLOCK WAS NOT SUCCESSFUL                @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0491
*   IF TESTRC^=0                    /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0491
         BZ    @RF00491                                            0491
*     DO;                           /*                       @Y30LB00*/
*       SETRC=4;                    /*                       @Y30LB00*/
         LA    @05,4                                               0493
         LR    SETRC,@05                                           0493
*       IF TESTRC=4                 /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         CR    TESTRC,@05                                          0494
         BNE   @RF00494                                            0494
*         CALL SSCMSG(REASONCD);    /*                       @Y30LB00*/
         LA    @02,REASONCD                                        0495
         ST    @02,@AL00001                                        0495
         LA    @01,@AL00001                                        0495
         BAL   @14,SSCMSG                                          0495
*       DARGLIST=''B;               /*                       @Y30LB00*/
@RF00494 L     @02,DDSTRU                                          0496
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0496
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0497
*       DARGSENT=MSG2853I(1);       /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG2853I                            0498
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
         L     @02,@PC00001                                        0499
         ST    @02,@AL00001                                        0499
         LA    @15,@CF00114                                        0499
         ST    @15,@AL00001+4                                      0499
         LA    @15,DDSTRU                                          0499
         ST    @15,@AL00001+8                                      0499
         MVI   @AL00001+8,X'80'                                    0499
         L     @15,GDTPRT(,@02)                                    0499
         LA    @01,@AL00001                                        0499
         BALR  @14,@15                                             0499
*     END;                          /*                       @Y30LB00*/
*                                                                  0500
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE DISPLAY WAS SUCCESSFUL, SAVE THE               @Y30LB00*/
*   /* MESSAGE DATA RETURN FROM THE MSC AND                  @Y30LB00*/
*   /* ISSUE UFSPACE TO FREE THE MESSAGE DATA AREA.          @Y30LB00*/
*   /* TRANSLATE THE MESSAGE DATA INTO VALUES                @Y30LB00*/
*   /* READABLE BY THE UTILITY USER, AND PRINT               @Y30LB00*/
*   /* THE DATA LINE WHICH DISPLAYES THE MSC                 @Y30LB00*/
*   /* LRUCLOCK TUNING PARAMETER                             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
         B     @RC00491                                            0501
@RF00491 DS    0H                                                  0502
*       MESGCLK=TUMSG;              /*                       @Y30LB00*/
         L     @02,TUMSGPTR                                        0502
         L     @02,TUMSG(,@02)                                     0502
         ST    @02,MESGCLK                                         0502
*       CALL IDCSAFS0(GDTTBL,TUMSGPTR);/*                    @Y30LB00*/
*                                                                  0503
         L     @02,@PC00001                                        0503
         ST    @02,@AL00001                                        0503
         LA    @15,TUMSGPTR                                        0503
         ST    @15,@AL00001+4                                      0503
         L     @15,GDTFSP(,@02)                                    0503
         LA    @01,@AL00001                                        0503
         BALR  @14,@15                                             0503
*       /*************************************************************/
*       /*                                                           */
*       /* USING THE TABLE WHICH CONTAINS VALID VALUES       @Y30LB00*/
*       /* FOR THE LRUCLOCK WITH THE CORRESPONDING           @Y30LB00*/
*       /* HEX VALUES FOR THE MSC, FIND A MATCH TO           @Y30LB00*/
*       /* THE MSC VALUE AND SAVE THE CORRESPONDING          @Y30LB00*/
*       /* VALID VALUE IN THE TUTBL                          @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0504
*       DO INDEX=1 TO CLOCKCNT;     /*                       @Y30LB00*/
         LA    @02,1                                               0504
         B     @DE00504                                            0504
@DL00504 DS    0H                                                  0505
*         IF MSGCLK=TUVALS(INDEX)   /*                       @Y30LB00*/
*           THEN                    /*                       @Y30LB00*/
         SLR   @15,@15                                             0505
         IC    @15,MSGCLK                                          0505
         SLR   @14,@14                                             0505
         IC    @14,TUVALS-1(@02)                                   0505
         CR    @15,@14                                             0505
         BNE   @RF00505                                            0505
*           DISCLK=CLOCKVAL(INDEX); /*                       @Y30LB00*/
         SLA   @02,2                                               0506
         L     @02,CLOCKVAL-4(@02)                                 0506
         STCM  @02,7,DISCLK                                        0506
*       END;                        /*                       @Y30LB00*/
*                                                                  0507
@RF00505 LA    @02,1                                               0507
         SLR   @15,@15                                             0507
         IC    @15,INDEX                                           0507
         ALR   @02,@15                                             0507
@DE00504 STC   @02,INDEX                                           0507
         C     @02,CLOCKCNT                                        0507
         BNH   @DL00504                                            0507
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE APPROPRIATE MESSAGE EITHER              @Y30LB00*/
*       /* DISPLAYING THE MSC LRUCLOCK VALUE OR              @Y30LB00*/
*       /* DISPLAYING THE PREVIOUS MSC LRUCLOCK VALUE        @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0508
*       DARGLIST=''B;               /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0508
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0508
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0509
*       IF CHNGLRUK=ON              /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         TM    CHNGLRUK,B'00100000'                                0510
         BNO   @RF00510                                            0510
*         DARGSENT=PPCLKMSG;        /*                       @Y30LB00*/
         MVI   DARGSENT(@02),X'0E'                                 0511
*       ELSE                        /*                       @Y30LB00*/
*         DARGSENT=PLRUCMSG;        /*                       @Y30LB00*/
         B     @RC00510                                            0512
@RF00510 L     @02,DDSTRU                                          0512
         MVI   DARGSENT(@02),X'0D'                                 0512
*       DARGDBP=ADDR(DISCLK);       /*                       @Y30LB00*/
@RC00510 L     @02,DDSTRU                                          0513
         LA    @15,DISCLK                                          0513
         ST    @15,DARGDBP(,@02)                                   0513
*       DARGILP=LENGTH(DISCLK);     /*                       @Y30LB00*/
         MVC   DARGILP(2,@02),@CH00161                             0514
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
         L     @02,@PC00001                                        0515
         ST    @02,@AL00001                                        0515
         LA    @15,@CF00114                                        0515
         ST    @15,@AL00001+4                                      0515
         LA    @15,DDSTRU                                          0515
         ST    @15,@AL00001+8                                      0515
         MVI   @AL00001+8,X'80'                                    0515
         L     @15,GDTPRT(,@02)                                    0515
         LA    @01,@AL00001                                        0515
         BALR  @14,@15                                             0515
*     END;                          /*                       @Y30LB00*/
*                                                                  0516
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER - DISRTN OR CHNGRTN                  @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00491 LR    @15,SETRC                                           0517
         L     @14,@SA00006                                        0517
         LM    @00,@12,@SA00006+8                                  0517
         BR    @14                                                 0517
*   END DISLRUC;                    /*                       @Y30LB00*/
*                                                                  0519
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - CHNGLRUC                                @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - CHANGE THE MSC TUNING PARAMETER               @Y30LB00*/
*/*            FOR LRUCLOCK                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          MESSAGES TO SYSPRINT                            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          IDC2854I                                        @Y30LB00*/
*/*          IDC0855I                                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - TUNELIST                                         @Y30LB00*/
*/*         TUTBL - TUNLRUC                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - CHANGE OF LRUCLOCK            @Y30LB00*/
*/*                            SUCCESSFUL                    @Y30LB00*/
*/*          RETURN CODE = 4 - CHANGE OF LRUCLOCK            @Y30LB00*/
*/*                            NOT SUCCESSFUL                @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0519
*CHNGLRUC:                                                         0519
*   PROCEDURE;                      /*                       @Y30LB00*/
CHNGLRUC STM   @14,@02,@SA00007                                    0519
         STM   @04,@12,@SA00007+20                                 0519
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*   OLDERID2=NEWERID2;                                             0520
         L     @05,@PC00001                                        0520
         L     @02,GDTTR2(,@05)                                    0520
         MVC   @TS00001(95),NEWERID2(@02)                          0520
         MVC   OLDERID2(95,@02),@TS00001                           0520
*   NEWID2='TUCL';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01055                              0521
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0522
         SLR   SETRC,SETRC                                         0522
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE TUNE REQUEST BLOCK                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0523
*   TULIST=''B;                     /*                       @Y30LB00*/
         L     @02,TUPTR                                           0523
         XC    TULIST(20,@02),TULIST(@02)                          0523
*   TUNMODE=ON;                     /*                       @Y30LB00*/
         OI    TUNMODE(@02),B'10000000'                            0524
*   TUNCLOCK=ON;                    /*                       @Y30LB00*/
         OI    TUNCLOCK(@02),B'00100000'                           0525
*   TUCLK=TULRUC;                   /*                       @Y30LB00*/
*                                                                  0526
         MVC   TUCLK(1,@02),TULRUC                                 0526
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO CHANGE THE MSC LRUCLOCK TUNING          @Y30LB00*/
*   /* PARAMETER                                             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0527
*   CALL IDCSASS0(GDTTBL,TUNE,TUPTR,REASONCD);/*             @Y30LB00*/
         ST    @05,@AL00001                                        0527
         LA    @02,TUNE                                            0527
         ST    @02,@AL00001+4                                      0527
         LA    @02,TUPTR                                           0527
         ST    @02,@AL00001+8                                      0527
         LA    @02,REASONCD                                        0527
         ST    @02,@AL00001+12                                     0527
         MVI   @AL00001+12,X'80'                                   0527
         L     @15,GDTSSC(,@05)                                    0527
         LA    @01,@AL00001                                        0527
         BALR  @14,@15                                             0527
*   RESPECIFY                                                      0528
*     RTNREG RSTD;                                                 0528
*   TESTRC=RTNREG;                                                 0529
         LR    TESTRC,RTNREG                                       0529
*   RESPECIFY                                                      0530
*     RTNREG UNRSTD;                /*                       @Y30LB00*/
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CHANGE FAILED, SET THE RETURN CODE AND         @Y30LB00*/
*   /* POSSIBLY, CALL SSCMSG TO PRINT THE                    @Y30LB00*/
*   /* APPROPRIATE MESSAGE REASON CODE. PRINT THE            @Y30LB00*/
*   /* SECONDARY MESSAGE WHICH INDICATES THAT THE            @Y30LB00*/
*   /* OF LRUCLOCK WAS NOT SUCCESSFUL                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   IF TESTRC^=0                    /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0531
         BZ    @RF00531                                            0531
*     DO;                           /*                       @Y30LB00*/
*       SETRC=4;                    /*                       @Y30LB00*/
         LA    @05,4                                               0533
         LR    SETRC,@05                                           0533
*       IF TESTRC=4                 /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         CR    TESTRC,@05                                          0534
         BNE   @RF00534                                            0534
*         CALL SSCMSG(REASONCD);    /*                       @Y30LB00*/
         LA    @02,REASONCD                                        0535
         ST    @02,@AL00001                                        0535
         LA    @01,@AL00001                                        0535
         BAL   @14,SSCMSG                                          0535
*       DARGLIST=''B;               /*                       @Y30LB00*/
@RF00534 L     @02,DDSTRU                                          0536
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0536
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0537
*       DARGSENT=MSG2854I(1);       /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG2854I                            0538
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
         L     @02,@PC00001                                        0539
         ST    @02,@AL00001                                        0539
         LA    @15,@CF00114                                        0539
         ST    @15,@AL00001+4                                      0539
         LA    @15,DDSTRU                                          0539
         ST    @15,@AL00001+8                                      0539
         MVI   @AL00001+8,X'80'                                    0539
         L     @15,GDTPRT(,@02)                                    0539
         LA    @01,@AL00001                                        0539
         BALR  @14,@15                                             0539
*     END;                          /*                       @Y30LB00*/
*                                                                  0540
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE OF LRUCLOCK WAS SUCCESSFUL, PRINT THE          @Y30LB00*/
*   /* MESSAGE THAT INDICATES SUCCESSFUL CHANGE OF           @Y30LB00*/
*   /* LRUCLOCK                                              @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
         B     @RC00531                                            0541
@RF00531 DS    0H                                                  0542
*       DARGLIST=''B;               /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0542
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0542
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0543
*       DARGSENT=MSG0855I(3);       /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG0855I+2                          0544
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
         L     @02,@PC00001                                        0545
         ST    @02,@AL00001                                        0545
         LA    @15,@CF00114                                        0545
         ST    @15,@AL00001+4                                      0545
         LA    @15,DDSTRU                                          0545
         ST    @15,@AL00001+8                                      0545
         MVI   @AL00001+8,X'80'                                    0545
         L     @15,GDTPRT(,@02)                                    0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*     END;                          /*                       @Y30LB00*/
*                                                                  0546
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CHNGRTN                                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0547
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00531 LR    @15,SETRC                                           0547
         L     @14,@SA00007                                        0547
         LM    @00,@02,@SA00007+8                                  0547
         LM    @04,@12,@SA00007+20                                 0547
         BR    @14                                                 0547
*   END CHNGLRUC;                   /*                       @Y30LB00*/
*                                                                  0549
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - DISSDG                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - DISPLAYS THE MSC ACTIVEPAGES OR LRUGROUPS     @Y30LB00*/
*/*            TUNING PARAMETER IF CHANGE IS                 @Y30LB00*/
*/*            SPECIFIED                                     @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*            DISPLAYS THE MSC ACTIVEPAGES AND LRUGROUPS    @Y30LB00*/
*/*            TUNING PARAMETERS FOR EACH VALID              @Y30LB00*/
*/*            STAGING DRIVE GROUP (SDG) IF DISPLAY          @Y30LB00*/
*/*            IS SPECIFIED                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          MESSAGES TO SYSPRINT                            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          IDC2853I                                        @Y30LB00*/
*/*          DATA LINE(S) - DISPLAY OF                       @Y30LB00*/
*/*                         ACTIVEPAGES AND/OR               @Y30LB00*/
*/*                         LRUGROUPS VALUES                 @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - TUTBL - CHNGACTP FLAG                            @Y30LB00*/
*/*                 CHNFLRUG FLAG                            @Y30LB00*/
*/*         FDTTBL -  SDGVAL                                 @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*         TUNELIST                                         @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - DISPLAY IS SUCCESSFUL         @Y30LB00*/
*/*          RETURN CODE = 4 - DISPLAY IS NOT SUCCESSFUL     @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0549
*DISSDG:                                                           0549
*   PROCEDURE;                      /*                       @Y30LB00*/
DISSDG   STM   @14,@02,@SA00008                                    0549
         STM   @04,@12,@SA00008+20                                 0549
*                                                                  0550
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   OLDERID2=NEWERID2;                                             0550
         L     @02,@PC00001                                        0550
         L     @02,GDTTR2(,@02)                                    0550
         MVC   @TS00001(95),NEWERID2(@02)                          0550
         MVC   OLDERID2(95,@02),@TS00001                           0550
*   NEWID2='TUDS';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01059                              0551
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0552
         SLR   SETRC,SETRC                                         0552
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CHANGE ACTPAGE OR LRUGROUPS IS SPECIFIED,          @Y30LB00*/
*   /* DISPLAY THE APPROPRIATE MSC TUNING PARAMETER          @Y30LB00*/
*   /* AND PRINT THE PREVIOUS PARAMETERS                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   IF CHNGACTP=ON×CHNGLRUG=ON      /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         TM    CHNGACTP,B'11000000'                                0553
         BZ    @RF00553                                            0553
*     DO;                           /*                       @Y30LB00*/
*       TULIST=''B;                 /*                       @Y30LB00*/
         L     @02,TUPTR                                           0555
         XC    TULIST(20,@02),TULIST(@02)                          0555
*       TUNESDGN=CHNGSDGV;          /*                       @Y30LB00*/
*                                                                  0556
         L     @15,@PC00001+4                                      0556
         L     @01,FDTPTR+12(,@15)                                 0556
         MVC   TUNESDGN(1,@02),CHNGSDGV(@01)                       0556
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE APPROPRIATE TUNING REQUEST BLOCK          @Y30LB00*/
*       /* ATTRIBUTE DEPENDING UPON WHICH CHANGE IS          @Y30LB00*/
*       /* BEING REQUESTED                                   @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0557
*       IF CHNGACTP=ON              /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0557
         BNO   @RF00557                                            0557
*         TUNTHRES=ON;              /*                       @Y30LB00*/
         OI    TUNTHRES(@02),B'10000000'                           0558
*       ELSE                        /*                       @Y30LB00*/
*         TUNSLICE=ON;              /*                       @Y30LB00*/
         B     @RC00557                                            0559
@RF00557 L     @02,TUPTR                                           0559
         OI    TUNSLICE(@02),B'01000000'                           0559
*       IF GDTDBG=NULLPTR THEN                                     0560
@RC00557 L     @02,@PC00001                                        0560
         L     @02,GDTDBG(,@02)                                    0560
         LTR   @02,@02                                             0560
         BZ    @RT00560                                            0560
*         ;                                                        0561
*       ELSE                                                       0562
*         CALL IDCDB010(GDTTBL,'TUDG');/*                    @Y30LB00*/
*                                                                  0562
         L     @02,@PC00001                                        0562
         ST    @02,@AL00001                                        0562
         LA    @15,@CC01060                                        0562
         ST    @15,@AL00001+4                                      0562
         MVI   @AL00001+4,X'80'                                    0562
         L     @15,GDTDBG(,@02)                                    0562
         LA    @01,@AL00001                                        0562
         BALR  @14,@15                                             0562
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO DISPLAY THE PREVIOUS TUNING         @Y30LB00*/
*       /* PARAMETERS                                        @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0563
*       CALL IDCSASS0(GDTTBL,TUNE,TUPTR,REASONCD,/*          @Y30LB00*/
*           ECBCODE,TUMSGPTR);      /*                       @Y30LB00*/
@RT00560 L     @05,@PC00001                                        0563
         ST    @05,@AL00001                                        0563
         LA    @02,TUNE                                            0563
         ST    @02,@AL00001+4                                      0563
         LA    @02,TUPTR                                           0563
         ST    @02,@AL00001+8                                      0563
         LA    @02,REASONCD                                        0563
         ST    @02,@AL00001+12                                     0563
         LA    @02,ECBCODE                                         0563
         ST    @02,@AL00001+16                                     0563
         LA    @02,TUMSGPTR                                        0563
         ST    @02,@AL00001+20                                     0563
         MVI   @AL00001+20,X'80'                                   0563
         L     @15,GDTSSC(,@05)                                    0563
         LA    @01,@AL00001                                        0563
         BALR  @14,@15                                             0563
*       RESPECIFY                                                  0564
*         RTNREG RSTD;                                             0564
*       TESTRC=RTNREG;                                             0565
         LR    TESTRC,RTNREG                                       0565
*       RESPECIFY                                                  0566
*         RTNREG UNRSTD;            /*                       @Y30LB00*/
*                                                                  0566
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE DISPLAYED FAILED, POSSIBLY CALL            @Y30LB00*/
*       /* SSCMSG TO PRINT THE APPROPRIATE MESSAGE           @Y30LB00*/
*       /* REASON CODE. PRINT THE SECONDARY MESSAGE          @Y30LB00*/
*       /* WHICH INDICATES THAT THE DISPLAY OF               @Y30LB00*/
*       /* ACTIVEPAGES/LRUGROUPS WAS NOT SUCCESSFUL          @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0567
*       IF TESTRC^=0                /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0567
         BZ    @RF00567                                            0567
*         DO;                       /*                       @Y30LB00*/
*           SETRC=4;                /*                       @Y30LB00*/
         LA    @05,4                                               0569
         LR    SETRC,@05                                           0569
*           IF TESTRC=4             /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         CR    TESTRC,@05                                          0570
         BNE   @RF00570                                            0570
*             CALL SSCMSG(REASONCD);/*                       @Y30LB00*/
*                                                                  0571
         LA    @02,REASONCD                                        0571
         ST    @02,@AL00001                                        0571
         LA    @01,@AL00001                                        0571
         BAL   @14,SSCMSG                                          0571
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE THE APPROPRIATE MESSAGE WHICH           @Y30LB00*/
*           /* INDICATES THAT THE DISPLAY OF ACTPAGE/        @Y30LB00*/
*           /* LRUGROUPS WAS NOT SUCCESSFUL                  @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0572
*           DARGLIST=''B;           /*                       @Y30LB00*/
@RF00570 L     @02,DDSTRU                                          0572
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0572
*           DARGSMOD=TUNEMSG;       /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0573
*           IF CHNGACTP=ON          /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0574
         BNO   @RF00574                                            0574
*             DARGSENT=MSG2853I(2); /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG2853I+1                          0575
*           ELSE                    /*                       @Y30LB00*/
*             DARGSENT=MSG2853I(3); /*                       @Y30LB00*/
         B     @RC00574                                            0576
@RF00574 L     @02,DDSTRU                                          0576
         MVC   DARGSENT(1,@02),MSG2853I+2                          0576
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB00*/
@RC00574 L     @02,@PC00001                                        0577
         ST    @02,@AL00001                                        0577
         LA    @15,@CF00114                                        0577
         ST    @15,@AL00001+4                                      0577
         LA    @15,DDSTRU                                          0577
         ST    @15,@AL00001+8                                      0577
         MVI   @AL00001+8,X'80'                                    0577
         L     @15,GDTPRT(,@02)                                    0577
         LA    @01,@AL00001                                        0577
         BALR  @14,@15                                             0577
*         END;                      /*                       @Y30LB00*/
*                                                                  0578
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE APPROPRIATE MESSAGE EITHER              @Y30LB00*/
*       /* DISPLAYING THE PREVIOUS MSC ACTIVEPAGES           @Y30LB00*/
*       /* VALUES OR DISPLAYING THE PREVIOUS                 @Y30LB00*/
*       /* LRUGROUPS VALUES                                  @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0579
*       ELSE                        /*                       @Y30LB00*/
*         DO;                       /*                       @Y30LB00*/
         B     @RC00567                                            0579
@RF00567 DS    0H                                                  0580
*           IF CHNGACTP=ON          /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0580
         BNO   @RF00580                                            0580
*             MSGACTP=TUMSG;        /*                       @Y30LB00*/
         L     @02,TUMSGPTR                                        0581
         L     @02,TUMSG(,@02)                                     0581
         ST    @02,MSGACTP                                         0581
*           ELSE                    /*                       @Y30LB00*/
*             MSGDLRGS=TUMSG;       /*                       @Y30LB00*/
         B     @RC00580                                            0582
@RF00580 L     @02,TUMSGPTR                                        0582
         L     @02,TUMSG(,@02)                                     0582
         ST    @02,MSGDLRGS                                        0582
*           CALL IDCSAFS0(GDTTBL,TUMSGPTR);/*                @Y30LB00*/
@RC00580 L     @02,@PC00001                                        0583
         ST    @02,@AL00001                                        0583
         LA    @15,TUMSGPTR                                        0583
         ST    @15,@AL00001+4                                      0583
         L     @15,GDTFSP(,@02)                                    0583
         LA    @01,@AL00001                                        0583
         BALR  @14,@15                                             0583
*           DARGLIST=''B;           /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0584
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0584
*           DARGSMOD=TUNEMSG;       /*                       @Y30LB00*/
*                                                                  0585
         MVC   DARGSMOD(3,@02),@CC00987                            0585
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE DISPLAY DATA LINE FOR ACTIVEPAGES       @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0586
*           IF CHNGACTP=ON          /*                       @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0586
         BNO   @RF00586                                            0586
*             DO;                   /*                       @Y30LB00*/
*               DISACTPL=MSGACTPL;  /*                       @Y30LB00*/
         SLR   @15,@15                                             0588
         IC    @15,MSGACTPL                                        0588
         STH   @15,DISACTPL                                        0588
*               DISACTPH=MSGACTPH;  /*                       @Y30LB00*/
         SLR   @15,@15                                             0589
         IC    @15,MSGACTPH                                        0589
         STH   @15,DISACTPH                                        0589
*               DARGSENT=PACTPMSG;  /*                       @Y30LB00*/
         MVI   DARGSENT(@02),X'13'                                 0590
*               DARGDBP=ADDR(DISACTPL);/*                    @Y30LB00*/
         LA    @15,DISACTPL                                        0591
         ST    @15,DARGDBP(,@02)                                   0591
*               DARGILP=LENGTH(DISACTPL);/*                  @Y30LB00*/
         LA    @15,2                                               0592
         STH   @15,DARGILP(,@02)                                   0592
*               DARGCNT=1;          /*                       @Y30LB00*/
         LA    @14,1                                               0593
         STH   @14,DARGCNT(,@02)                                   0593
*               DARGINS(1)=1;       /*                       @Y30LB00*/
         STH   @14,DARGINS(,@02)                                   0594
*               DARGINL(1)=LENGTH(DISACTPH);/*               @Y30LB00*/
         STH   @15,DARGINL(,@02)                                   0595
*               DARGDTM(1)=ADDR(DISACTPH);/*                 @Y30LB00*/
         LA    @15,DISACTPH                                        0596
         ST    @15,DARGDTM(,@02)                                   0596
*             END;                  /*                       @Y30LB00*/
*                                                                  0597
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE DISPLAY DATA LINE FOR LRUGROUPS         @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0598
*           ELSE                    /*                       @Y30LB00*/
*             DO;                   /*                       @Y30LB00*/
         B     @RC00586                                            0598
@RF00586 DS    0H                                                  0599
*               CHNGLRUG=OFF;       /*                       @Y30LB00*/
         NI    CHNGLRUG,B'10111111'                                0599
*               CALL LRUGTRAN;      /*                       @Y30LB00*/
         BAL   @14,LRUGTRAN                                        0600
*               CHNGLRUG=ON;        /*                       @Y30LB00*/
         OI    CHNGLRUG,B'01000000'                                0601
*               DARGSENT=PPGRPMSG(NUMLRGS);/*                @Y30LB00*/
         L     @02,DDSTRU                                          0602
         LH    @15,NUMLRGS                                         0602
         N     @15,@CF01099                                        0602
         SLR   @14,@14                                             0602
         IC    @14,PPGRPMSG-1(@15)                                 0602
         STC   @14,DARGSENT(,@02)                                  0602
*               DARGDBP=ADDR(DISDLRGS(1));/*                 @Y30LB00*/
         LA    @14,DISDLRGS                                        0603
         ST    @14,DARGDBP(,@02)                                   0603
*               DARGILP=LENGTH(DISDLRGS(1));/*               @Y30LB00*/
*                                                                  0604
         MVC   DARGILP(2,@02),@CH00152                             0604
*               /*****************************************************/
*               /*                                                   */
*               /* IF THERE IS MORE THAN ONE GROUP-          @Y30LB00*/
*               /* UNIT IN LRUGROUPS, SET UP INSERTS         @Y30LB00*/
*               /* IN DARGLIST FOR EACH ONE                  @Y30LB00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0605
*               IF NUMLRGS>1 THEN   /*                       @Y30LB00*/
         C     @15,@CF00218                                        0605
         BNH   @RF00605                                            0605
*                 DO;               /*                       @Y30LB00*/
*                   DO INDEX=1 TO(NUMLRGS-1);/*              @Y30LB00*/
         LA    @02,1                                               0607
         B     @DE00607                                            0607
@DL00607 DS    0H                                                  0608
*                     DARGCNT=NUMLRGS-1;/*                   @Y30LB00*/
         L     @15,DDSTRU                                          0608
         LH    @14,NUMLRGS                                         0608
         N     @14,@CF01099                                        0608
         BCTR  @14,0                                               0608
         STH   @14,DARGCNT(,@15)                                   0608
*                     DARGINS(INDEX)=INDEX;/*                @Y30LB00*/
         LR    @14,@02                                             0609
         SLA   @14,3                                               0609
         STH   @02,DARGINS-8(@14,@15)                              0609
*                     DARGINL(INDEX)=/*                      @Y30LB00*/
*                         LENGTH(DISDLRGS(INDEX+1));/*       @Y30LB00*/
         LA    @09,2                                               0610
         STH   @09,DARGINL-8(@14,@15)                              0610
*                     DARGDTM(INDEX)=/*                      @Y30LB00*/
*                         ADDR(DISDLRGS(INDEX+1));/*         @Y30LB00*/
         LR    @09,@02                                             0611
         ALR   @09,@09                                             0611
         LA    @09,DISDLRGS(@09)                                   0611
         ST    @09,DARGDTM-8(@14,@15)                              0611
*                   END;            /*                       @Y30LB00*/
         AL    @02,@CF00218                                        0612
@DE00607 STC   @02,INDEX                                           0612
         LH    @15,NUMLRGS                                         0612
         N     @15,@CF01099                                        0612
         BCTR  @15,0                                               0612
         CR    @02,@15                                             0612
         BNH   @DL00607                                            0612
*                 END;              /*                       @Y30LB00*/
*             END;                  /*                       @Y30LB00*/
@RF00605 DS    0H                                                  0615
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB00*/
@RC00586 L     @02,@PC00001                                        0615
         ST    @02,@AL00001                                        0615
         LA    @15,@CF00114                                        0615
         ST    @15,@AL00001+4                                      0615
         LA    @15,DDSTRU                                          0615
         ST    @15,@AL00001+8                                      0615
         MVI   @AL00001+8,X'80'                                    0615
         L     @15,GDTPRT(,@02)                                    0615
         LA    @01,@AL00001                                        0615
         BALR  @14,@15                                             0615
*         END;                      /*                       @Y30LB00*/
*     END;                          /*                       @Y30LB00*/
*                                                                  0618
*   /*****************************************************************/
*   /*                                                               */
*   /* DISPLAY IS SPECIFIED, DISPLAY FOR EACH VALID          @Y30LB00*/
*   /* STAGING DRIVE GROUP (SDG) THE ACTIVEPAGES             @Y30LB00*/
*   /* AND LRUGROUPS MSC TUNING PARAMETERS AND PRINT         @Y30LB00*/
*   /* THE INFORMATION                                       @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0618
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
*                                                                  0618
         B     @RC00553                                            0618
@RF00553 DS    0H                                                  0619
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THROUGH EACH VALID SDG NUMBER DISPLAY-       @Y30LB00*/
*       /* THE ACTIVEPAGES AND LRUGROUPS VALUES UNTIL        @Y30LB00*/
*       /* ALL ARE DISPLAYED OR AN ERROR OCCURS              @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0619
*       REASONCD=0;                 /*                       @Y30LB00*/
         SLR   @02,@02                                             0619
         ST    @02,REASONCD                                        0619
*       DO LOOPSDG=1 TO 28 WHILE REASONCD=0;/*               @Y30LB00*/
         LA    @02,1                                               0620
         STH   @02,LOOPSDG                                         0620
@DL00620 L     @15,REASONCD                                        0620
         LTR   @15,@15                                             0620
         BNZ   @DC00620                                            0620
*         TULIST=''B;               /*                       @Y30LB00*/
         L     @15,TUPTR                                           0621
         XC    TULIST(20,@15),TULIST(@15)                          0621
*         TUNESDGN=LOOPSDG-1;       /*                       @Y30LB00*/
         BCTR  @02,0                                               0622
         STC   @02,TUNESDGN(,@15)                                  0622
*         TUNTHRES=ON;              /*                       @Y30LB00*/
*                                                                  0623
         OI    TUNTHRES(@15),B'10000000'                           0623
*         /***********************************************************/
*         /*                                                         */
*         /* FOR EACH SDG LOOP, FIRST DISPLAY THE            @Y30LB00*/
*         /* ACTPAGE VALUES AND THEN LRUGROUPS VALUES.       @Y30LB00*/
*         /* THE LOOP SWITCH IS SET OFF ONCE LRUGROUPS       @Y30LB00*/
*         /* UNITS HAVE BEEN DISPLAYED OR ONCE AN ERROR      @Y30LB00*/
*         /* OCCURS                                          @Y30LB00*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0624
*         LOOPSW=ON;                /*                       @Y30LB00*/
         OI    LOOPSW,B'10000000'                                  0624
*         DO WHILE LOOPSW=ON;       /*                       @Y30LB00*/
         B     @DE00625                                            0625
@DL00625 DS    0H                                                  0626
*           IF GDTDBG=NULLPTR THEN                                 0626
         L     @02,@PC00001                                        0626
         L     @02,GDTDBG(,@02)                                    0626
         LTR   @02,@02                                             0626
         BZ    @RT00626                                            0626
*             ;                                                    0627
*           ELSE                                                   0628
*             CALL IDCDB010(GDTTBL,'TUDG');/*                @Y30LB00*/
         L     @02,@PC00001                                        0628
         ST    @02,@AL00001                                        0628
         LA    @15,@CC01060                                        0628
         ST    @15,@AL00001+4                                      0628
         MVI   @AL00001+4,X'80'                                    0628
         L     @15,GDTDBG(,@02)                                    0628
         LA    @01,@AL00001                                        0628
         BALR  @14,@15                                             0628
*           CALL IDCSASS0(GDTTBL,TUNE,TUPTR,REASONCD,/*      @Y30LB00*/
*               ECBCODE,TUMSGPTR);  /*                       @Y30LB00*/
@RT00626 L     @05,@PC00001                                        0629
         ST    @05,@AL00001                                        0629
         LA    @02,TUNE                                            0629
         ST    @02,@AL00001+4                                      0629
         LA    @02,TUPTR                                           0629
         ST    @02,@AL00001+8                                      0629
         LA    @02,REASONCD                                        0629
         ST    @02,@AL00001+12                                     0629
         LA    @02,ECBCODE                                         0629
         ST    @02,@AL00001+16                                     0629
         LA    @02,TUMSGPTR                                        0629
         ST    @02,@AL00001+20                                     0629
         MVI   @AL00001+20,X'80'                                   0629
         L     @15,GDTSSC(,@05)                                    0629
         LA    @01,@AL00001                                        0629
         BALR  @14,@15                                             0629
*           RESPECIFY                                              0630
*             RTNREG RSTD;                                         0630
*           TESTRC=RTNREG;                                         0631
         LR    TESTRC,RTNREG                                       0631
*           RESPECIFY                                              0632
*             RTNREG UNRSTD;        /*                       @Y30LB00*/
*                                                                  0633
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE DISPLAY FAILED BUT NOT BECAUSE         @Y30LB00*/
*           /* THE SDG IS INVALID IN THE MSC                 @Y30LB00*/
*           /* CONFIGURATION, ISSUE A MESSAGE INDICATING     @Y30LB00*/
*           /* WHICH DISPLAY ACTIVEPAGES/LRUGROUPS           @Y30LB00*/
*           /* FAILED. IF THE DISPLAY FAILED WITH            @Y30LB00*/
*           /* A 'B5' ERROR CODE SKIP TO THE NEXT SDG        @Y30LB00*/
*           /* AND CONTINUE TO DISPLAY                       @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0633
*           IF TESTRC^=0&REASONCD^=INVALSDG/*                @Y30LB00*/
*             THEN                  /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0633
         BZ    @RF00633                                            0633
         CLC   REASONCD(4),@CF00983                                0633
         BE    @RF00633                                            0633
*             DO;                   /*                       @Y30LB00*/
*                                                                  0634
*               /*****************************************************/
*               /*                                                   */
*               /* POSSIBLY CALL SSCMSG TO PRINT THE         @Y30LB00*/
*               /* APPROPRIATE REASON CODE MESSAGE.          @Y30LB00*/
*               /* PRINT THE APPROPRIATE MESSAGE             @Y30LB00*/
*               /* WHICH INDICATES WHICH DISPLAY FAILED      @Y30LB00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0635
*               SETRC=4;            /*                       @Y30LB00*/
         LA    @05,4                                               0635
         LR    SETRC,@05                                           0635
*               IF TESTRC=4         /*                       @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         CR    TESTRC,@05                                          0636
         BNE   @RF00636                                            0636
*                 CALL SSCMSG(REASONCD);/*                   @Y30LB00*/
         LA    @02,REASONCD                                        0637
         ST    @02,@AL00001                                        0637
         LA    @01,@AL00001                                        0637
         BAL   @14,SSCMSG                                          0637
*               DARGLIST=''B;       /*                       @Y30LB00*/
@RF00636 L     @02,DDSTRU                                          0638
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0638
*               DARGSMOD=TUNEMSG;   /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0639
*               IF TUNTHRES=ON      /*                       @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         L     @01,TUPTR                                           0640
         TM    TUNTHRES(@01),B'10000000'                           0640
         BNO   @RF00640                                            0640
*                 DARGSENT=MSG2853I(2);/*                    @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG2853I+1                          0641
*               ELSE                /*                       @Y30LB00*/
*                 DARGSENT=MSG2853I(3);/*                    @Y30LB00*/
         B     @RC00640                                            0642
@RF00640 L     @02,DDSTRU                                          0642
         MVC   DARGSENT(1,@02),MSG2853I+2                          0642
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB00*/
@RC00640 L     @02,@PC00001                                        0643
         ST    @02,@AL00001                                        0643
         LA    @15,@CF00114                                        0643
         ST    @15,@AL00001+4                                      0643
         LA    @15,DDSTRU                                          0643
         ST    @15,@AL00001+8                                      0643
         MVI   @AL00001+8,X'80'                                    0643
         L     @15,GDTPRT(,@02)                                    0643
         LA    @01,@AL00001                                        0643
         BALR  @14,@15                                             0643
*               LOOPSW=OFF;         /*                       @Y30LB00*/
*                                                                  0644
         NI    LOOPSW,B'01111111'                                  0644
*               /*****************************************************/
*               /*                                                   */
*               /* SET THE REASON CODE TO                    @Y30LB00*/
*               /* 'FFFF' IN ORDER TO                        @Y30LB00*/
*               /* INSURE THAT THE                           @Y30LB00*/
*               /* DISPLAY OF ALL VALID                      @Y30LB00*/
*               /* SDGS IS TERMINATED -                      @Y30LB00*/
*               /* IF USSC FAILS AND                         @Y30LB00*/
*               /* RETURNS WITH AN 8 AND                     @Y30LB00*/
*               /* NO REASON CODE IS SET                     @Y30LB00*/
*               /* THE TUNE REQUEST MUST                     @Y30LB00*/
*               /* BE TERMINATED                             @Y30LB00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0645
*               REASONCD='FFFF'X;   /*                       @Y30LB00*/
         L     @02,@CF01062                                        0645
         ST    @02,REASONCD                                        0645
*             END;                  /*                       @Y30LB00*/
*                                                                  0647
*           /*********************************************************/
*           /*                                                       */
*           /* THE DISPLAY REQUEST COMPLETED WITHOUT         @Y30LB00*/
*           /* ERROR OR THE SDG SPECIFIED ON THE             @Y30LB00*/
*           /* DISPLAY IS INVALID IN THE MSC                 @Y30LB00*/
*           /* CONFIGURATION                                 @Y30LB00*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0647
*           ELSE                    /*                       @Y30LB00*/
*             DO;                   /*                       @Y30LB00*/
*                                                                  0647
         B     @RC00633                                            0647
@RF00633 DS    0H                                                  0648
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE DISPLAY COMPLETED WITHOUT          @Y30LB00*/
*               /* ERROR SAVE THE MSC MESSAGE DATA           @Y30LB00*/
*               /* AND FREE THE MESSAGE STORAGE AREA         @Y30LB00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0648
*               IF REASONCD^='B5'X  /*                       @Y30LB00*/
*                 THEN              /*                       @Y30LB00*/
         CLC   REASONCD(4),@CF01063                                0648
         BE    @RF00648                                            0648
*                 DO;               /*                       @Y30LB00*/
*                   IF TUNTHRES=ON  /*                       @Y30LB00*/
*                     THEN          /*                       @Y30LB00*/
         L     @02,TUPTR                                           0650
         TM    TUNTHRES(@02),B'10000000'                           0650
         BNO   @RF00650                                            0650
*                     MSGACTP=TUMSG;/*                       @Y30LB00*/
         L     @02,TUMSGPTR                                        0651
         L     @02,TUMSG(,@02)                                     0651
         ST    @02,MSGACTP                                         0651
*                   ELSE            /*                       @Y30LB00*/
*                     MSGDLRGS=TUMSG;/*                      @Y30LB00*/
         B     @RC00650                                            0652
@RF00650 L     @02,TUMSGPTR                                        0652
         L     @02,TUMSG(,@02)                                     0652
         ST    @02,MSGDLRGS                                        0652
*                   CALL IDCSAFS0(GDTTBL,TUMSGPTR);/*        @Y30LB00*/
*                                                                  0653
@RC00650 L     @02,@PC00001                                        0653
         ST    @02,@AL00001                                        0653
         LA    @15,TUMSGPTR                                        0653
         ST    @15,@AL00001+4                                      0653
         L     @15,GDTFSP(,@02)                                    0653
         LA    @01,@AL00001                                        0653
         BALR  @14,@15                                             0653
*                   /*************************************************/
*                   /*                                               */
*                   /* IF ACTPAGE VALUES WERE DISPLAYED,     @Y30LB00*/
*                   /* INITIALIZE THE TUNE REQUEST BLOCK     @Y30LB00*/
*                   /* TO INDICATE DISPLAY THE LRUGROUPS     @Y30LB00*/
*                   /* UNITS FOR THE SAME SDG                @Y30LB00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0654
*                   IF TUNTHRES=ON  /*                       @Y30LB00*/
*                     THEN          /*                       @Y30LB00*/
         L     @02,TUPTR                                           0654
         TM    TUNTHRES(@02),B'10000000'                           0654
         BNO   @RF00654                                            0654
*                     DO;           /*                       @Y30LB00*/
*                       DISACTPL=MSGACTPL;/*                 @Y30LB00*/
         SLR   @15,@15                                             0656
         IC    @15,MSGACTPL                                        0656
         STH   @15,DISACTPL                                        0656
*                       DISACTPH=MSGACTPH;/*                 @Y30LB00*/
         SLR   @15,@15                                             0657
         IC    @15,MSGACTPH                                        0657
         STH   @15,DISACTPH                                        0657
*                       TULIST=''B; /*                       @Y30LB00*/
         XC    TULIST(20,@02),TULIST(@02)                          0658
*                       TUNESDGN=LOOPSDG-1;/*                @Y30LB00*/
         LH    @15,LOOPSDG                                         0659
         N     @15,@CF01099                                        0659
         BCTR  @15,0                                               0659
         STC   @15,TUNESDGN(,@02)                                  0659
*                       TUNSLICE=ON;/*                       @Y30LB00*/
         OI    TUNSLICE(@02),B'01000000'                           0660
*                     END;          /*                       @Y30LB00*/
*                                                                  0661
*                   /*************************************************/
*                   /*                                               */
*                   /* CALL LRUGTRAN TO TRANSLATE THE        @Y30LB00*/
*                   /* MSC MESSAGE DATA AND THEN PRINT       @Y30LB00*/
*                   /* A MESSAGE DISPLAYING THE SDG          @Y30LB00*/
*                   /* NUMBER AND ITS ACTIVEPAGES AND        @Y30LB00*/
*                   /* LRUGROUPS TUNING PARAMETERS           @Y30LB00*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0662
*                   ELSE            /*                       @Y30LB00*/
*                     DO;           /*                       @Y30LB00*/
         B     @RC00654                                            0662
@RF00654 DS    0H                                                  0663
*                       CALL LRUGTRAN;/*                     @Y30LB00*/
         BAL   @14,LRUGTRAN                                        0663
*                       LOOPSW=OFF; /*                       @Y30LB00*/
         NI    LOOPSW,B'01111111'                                  0664
*                       DARGSENT=PSDGMSG(NUMLRGS);/*         @Y30LB00*/
         L     @02,DDSTRU                                          0665
         LH    @15,NUMLRGS                                         0665
         N     @15,@CF01099                                        0665
         SLR   @14,@14                                             0665
         IC    @14,PSDGMSG-1(@15)                                  0665
         STC   @14,DARGSENT(,@02)                                  0665
*                       INSRTSDG=LOOPSDG-1;/*                @Y30LB00*/
         LH    @14,LOOPSDG                                         0666
         N     @14,@CF01099                                        0666
         BCTR  @14,0                                               0666
         STH   @14,INSRTSDG                                        0666
*                       DARGDBP=ADDR(INSRTSDG);/*            @Y30LB00*/
         LA    @14,INSRTSDG                                        0667
         ST    @14,DARGDBP(,@02)                                   0667
*                       DARGILP=LENGTH(INSRTSDG);/*          @Y30LB00*/
         LA    @14,2                                               0668
         STH   @14,DARGILP(,@02)                                   0668
*                       DARGCNT=NUMLRGS+2;/*                 @Y30LB00*/
         ALR   @15,@14                                             0669
         STH   @15,DARGCNT(,@02)                                   0669
*                       DARGINS(1)=1;/*                      @Y30LB00*/
         LA    @15,1                                               0670
         STH   @15,DARGINS(,@02)                                   0670
*                       DARGINL(1)=LENGTH(DISACTPL);/*       @Y30LB00*/
         STH   @14,DARGINL(,@02)                                   0671
*                       DARGDTM(1)=ADDR(DISACTPL);/*         @Y30LB00*/
         LA    @09,DISACTPL                                        0672
         ST    @09,DARGDTM(,@02)                                   0672
*                       DARGINS(2)=2;/*                      @Y30LB00*/
         STH   @14,DARGINS+8(,@02)                                 0673
*                       DARGINL(2)=LENGTH(DISACTPH);/*       @Y30LB00*/
         STH   @14,DARGINL+8(,@02)                                 0674
*                       DARGDTM(2)=ADDR(DISACTPH);/*         @Y30LB00*/
         LA    @14,DISACTPH                                        0675
         ST    @14,DARGDTM+8(,@02)                                 0675
*                       DO INSRTLP=1 TO NUMLRGS;/*           @Y30LB00*/
         LR    INSRTLP,@15                                         0676
         B     @DE00676                                            0676
@DL00676 DS    0H                                                  0677
*                         DARGINS(INSRTLP+2)=/*              @Y30LB00*/
*                             INSRTLP+2;/*                   @Y30LB00*/
         L     @15,DDSTRU                                          0677
         LR    @14,INSRTLP                                         0677
         SLA   @14,3                                               0677
         LA    @09,2                                               0677
         LR    @08,INSRTLP                                         0677
         ALR   @08,@09                                             0677
         STH   @08,DARGINS+8(@14,@15)                              0677
*                         DARGINL(INSRTLP+2)=/*              @Y30LB00*/
*                             LENGTH(DISDLRGS(INSRTLP));/*   @Y30LB00*/
         STH   @09,DARGINL+8(@14,@15)                              0678
*                         DARGDTM(INSRTLP+2)=/*              @Y30LB00*/
*                             ADDR(DISDLRGS(INSRTLP));/*     @Y30LB00*/
         LR    @09,INSRTLP                                         0679
         ALR   @09,@09                                             0679
         LA    @09,DISDLRGS-2(@09)                                 0679
         ST    @09,DARGDTM+8(@14,@15)                              0679
*                       END;        /*                       @Y30LB00*/
         AL    INSRTLP,@CF00218                                    0680
@DE00676 LH    @15,NUMLRGS                                         0680
         N     @15,@CF01099                                        0680
         CR    INSRTLP,@15                                         0680
         BNH   @DL00676                                            0680
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0681
*                                                            @Y30LB00*/
         L     @02,@PC00001                                        0681
         ST    @02,@AL00001                                        0681
         LA    @15,@CF00114                                        0681
         ST    @15,@AL00001+4                                      0681
         LA    @15,DDSTRU                                          0681
         ST    @15,@AL00001+8                                      0681
         MVI   @AL00001+8,X'80'                                    0681
         L     @15,GDTPRT(,@02)                                    0681
         LA    @01,@AL00001                                        0681
         BALR  @14,@15                                             0681
*                     END;          /*                       @Y30LB00*/
*                 END;              /*                       @Y30LB00*/
*                                                                  0683
*               /*****************************************************/
*               /*                                                   */
*               /* THE SDG SPECIFIED IN THE DISPLAY          @Y30LB00*/
*               /* IS INVALID IN THE MSC                     @Y30LB00*/
*               /* CONFIGURATION. CLEAR THE REASON           @Y30LB00*/
*               /* CODE AND SET THE LOOP SWITCH OFF          @Y30LB00*/
*               /* SUCH THAT THE NEXT SDGS ACTPAGE           @Y30LB00*/
*               /* AND LRUGROUPS TUNING PARAMETERS ARE       @Y30LB00*/
*               /* DISPLAYED                                 @Y30LB00*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0684
*               ELSE                /*                       @Y30LB00*/
*                 DO;               /*                       @Y30LB00*/
         B     @RC00648                                            0684
@RF00648 DS    0H                                                  0685
*                   REASONCD=0;     /*                       @Y30LB00*/
         SLR   @02,@02                                             0685
         ST    @02,REASONCD                                        0685
*                   LOOPSW=OFF;     /*                       @Y30LB00*/
         NI    LOOPSW,B'01111111'                                  0686
*                 END;              /*                       @Y30LB00*/
*             END;                  /*                       @Y30LB00*/
@RC00648 DS    0H                                                  0689
*         END;                      /*                       @Y30LB00*/
@RC00633 DS    0H                                                  0689
@DE00625 TM    LOOPSW,B'10000000'                                  0689
         BO    @DL00625                                            0689
*       END;                        /*                       @Y30LB00*/
         LA    @02,1                                               0690
         LH    @15,LOOPSDG                                         0690
         N     @15,@CF01099                                        0690
         ALR   @02,@15                                             0690
         STH   @02,LOOPSDG                                         0690
         C     @02,@CF01061                                        0690
         BNH   @DL00620                                            0690
@DC00620 DS    0H                                                  0691
*     END;                          /*                       @Y30LB00*/
*                                                                  0692
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER - CHNGSDG OR DISSDG                  @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0692
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00553 LR    @15,SETRC                                           0692
         L     @14,@SA00008                                        0692
         LM    @00,@02,@SA00008+8                                  0692
         LM    @04,@12,@SA00008+20                                 0692
         BR    @14                                                 0692
*   END DISSDG;                     /*                       @Y30LB00*/
*                                                                  0694
*/*********************************************************  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* PROCEDURE NAME - CHNGSDG                                 @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* FUNCTION - CHANGES THE ACTIVEPAGES OR LRUGROUPS MSC      @Y30LB00*/
*/*            TUNING PARAMETER                              @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          MESSAGES TO SYSPRINT                            @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          IDC2854I                                        @Y30LB00*/
*/*          IDC2855I                                        @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* INPUT - TULIST                                           @Y30LB00*/
*/*         TUNETAB -   CHGACTPL                             @Y30LB00*/
*/*                     CHGACTPH                             @Y30LB00*/
*/*                     CHNGLRUG                             @Y30LB00*/
*/*                     CHNGACTP                             @Y30LB00*/
*/*                     CHNGLRGS                             @Y30LB00*/
*/*         FDTTBL - SDGVAL                                  @Y30LB00*/
*/*                                                          @Y30LB00*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*          RETURN CODE = 0 - CHANGE SUCCESSFUL             @Y30LB00*/
*/*          RETURN CODE = 4 - CHANGE NOT                    @Y30LB00*/
*/*                            SUCCESSFUL                    @Y30LB00*/
*/*                                                          @Y30LB00*/
*/*********************************************************  @Y30LB00*/
*                                                                  0694
*CHNGSDG:                                                          0694
*   PROCEDURE;                      /*                       @Y30LB00*/
CHNGSDG  STM   @14,@02,@SA00009                                    0694
         STM   @04,@12,@SA00009+20                                 0694
*                                                                  0695
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE TO ZERO                        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0695
*   OLDERID2=NEWERID2;                                             0695
         L     @02,@PC00001                                        0695
         L     @02,GDTTR2(,@02)                                    0695
         MVC   @TS00001(95),NEWERID2(@02)                          0695
         MVC   OLDERID2(95,@02),@TS00001                           0695
*   NEWID2='TUCS';                  /*                       @Y30LB00*/
         MVC   NEWID2(4,@02),@CC01067                              0696
*   SETRC=0;                        /*                       @Y30LB00*/
*                                                                  0697
         SLR   SETRC,SETRC                                         0697
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE TUNELIST                                   @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   TULIST=''B;                     /*                       @Y30LB00*/
         L     @02,TUPTR                                           0698
         XC    TULIST(20,@02),TULIST(@02)                          0698
*   TUNMODE=ON;                     /*                       @Y30LB00*/
         OI    TUNMODE(@02),B'10000000'                            0699
*   TUNESDGN=CHNGSDGV;              /*                       @Y30LB00*/
*                                                                  0700
         L     @15,@PC00001+4                                      0700
         L     @01,FDTPTR+12(,@15)                                 0700
         MVC   TUNESDGN(1,@02),CHNGSDGV(@01)                       0700
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CHANGE ACTPAGE IS SPECIFIED, SET UP TULIST         @Y30LB00*/
*   /* TO CHANGE THE MSC ACTIVEPAGES TUNING PARAMETER        @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0701
*   IF CHNGACTP=ON                  /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0701
         BNO   @RF00701                                            0701
*     DO;                           /*                       @Y30LB00*/
*                                                                  0702
*       /*************************************************************/
*       /*                                                           */
*       /* PUT THE ACTIVEPAGES VALUES INTO THE TUNE          @Y30LB00*/
*       /* BLOCK                                             @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0703
*       TUNTHRES=ON;                /*                       @Y30LB00*/
         OI    TUNTHRES(@02),B'10000000'                           0703
*       CHGACTPL=APLVAL;            /*                       @Y30LB00*/
         L     @01,FDTPTR+20(,@15)                                 0704
         MVC   CHGACTPL(1),APLVAL(@01)                             0704
*       CHGACTPH=APHVAL;            /*                       @Y30LB00*/
         L     @01,FDTPTR+24(,@15)                                 0705
         MVC   CHGACTPH(1),APHVAL(@01)                             0705
*       TUACTPL=CHGACTPL;           /*                       @Y30LB00*/
         MVC   TUACTPL(1,@02),CHGACTPL                             0706
*       TUACTPH=CHGACTPH;           /*                       @Y30LB00*/
         MVC   TUACTPH(1,@02),CHGACTPH                             0707
*     END;                          /*                       @Y30LB00*/
*                                                                  0708
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE LRUGROUPS IS SPECIFIED, SET UP                 @Y30LB00*/
*   /* TULIST TO CHANGE THE MSC LRUGROUPS TUNING             @Y30LB00*/
*   /* PARAMETERS                                            @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
*                                                                  0709
         B     @RC00701                                            0709
@RF00701 DS    0H                                                  0710
*       /*************************************************************/
*       /*                                                           */
*       /* CALL LRUGTRAN TO TRANSLATE THE INPUT VALUES       @Y30LB00*/
*       /* FOR LRUGROUPS INTO VALUES ACCEPTABLE BY           @Y30LB00*/
*       /* MSC. PUT THE TRANSLATED VALUES INTO THE           @Y30LB00*/
*       /* TUNE REQUEST BLOCK                                @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0710
*       TUNSLICE=ON;                /*                       @Y30LB00*/
         L     @02,TUPTR                                           0710
         OI    TUNSLICE(@02),B'01000000'                           0710
*       CALL LRUGTRAN;              /*                       @Y30LB00*/
         BAL   @14,LRUGTRAN                                        0711
*       TUNEDATA=CHNGLRGS;          /*                       @Y30LB00*/
         L     @02,CHNGLRGS                                        0712
         L     @01,TUPTR                                           0712
         ST    @02,TUNEDATA(,@01)                                  0712
*     END;                          /*                       @Y30LB00*/
*   IF GDTDBG=NULLPTR THEN                                         0714
@RC00701 L     @02,@PC00001                                        0714
         L     @02,GDTDBG(,@02)                                    0714
         LTR   @02,@02                                             0714
         BZ    @RT00714                                            0714
*     ;                                                            0715
*   ELSE                                                           0716
*     CALL IDCDB010(GDTTBL,'TUCG'); /*                       @Y30LB00*/
*                                                                  0716
         L     @02,@PC00001                                        0716
         ST    @02,@AL00001                                        0716
         LA    @15,@CC01068                                        0716
         ST    @15,@AL00001+4                                      0716
         MVI   @AL00001+4,X'80'                                    0716
         L     @15,GDTDBG(,@02)                                    0716
         LA    @01,@AL00001                                        0716
         BALR  @14,@15                                             0716
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO CHANGE THE APPROPRIATE MSC TUNING       @Y30LB00*/
*   /* PARAMETERS                                            @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*   CALL IDCSASS0(GDTTBL,TUNE,TUPTR,REASONCD);/*             @Y30LB00*/
@RT00714 L     @05,@PC00001                                        0717
         ST    @05,@AL00001                                        0717
         LA    @02,TUNE                                            0717
         ST    @02,@AL00001+4                                      0717
         LA    @02,TUPTR                                           0717
         ST    @02,@AL00001+8                                      0717
         LA    @02,REASONCD                                        0717
         ST    @02,@AL00001+12                                     0717
         MVI   @AL00001+12,X'80'                                   0717
         L     @15,GDTSSC(,@05)                                    0717
         LA    @01,@AL00001                                        0717
         BALR  @14,@15                                             0717
*   RESPECIFY                                                      0718
*     RTNREG RSTD;                                                 0718
*   TESTRC=RTNREG;                                                 0719
         LR    TESTRC,RTNREG                                       0719
*   RESPECIFY                                                      0720
*     RTNREG UNRSTD;                /*                       @Y30LB00*/
*                                                                  0720
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CHANGE REQUEST FAILED, SET THE RETURN          @Y30LB00*/
*   /* CODE AND POSSIBLY, CALL SSCMSG TO PRINT THE           @Y30LB00*/
*   /* APPROPRIATE REASON CODE MESSAGE. ISSUE THE            @Y30LB00*/
*   /* APPROPRIATE MESSAGE WHICH INDICATES THAT THE          @Y30LB00*/
*   /* CHANGE FOR ACTPAGE/LRUGROUPS WAS NOT SUCCESSFUL       @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0721
*   IF TESTRC^=0                    /*                       @Y30LB00*/
*     THEN                          /*                       @Y30LB00*/
         LTR   TESTRC,TESTRC                                       0721
         BZ    @RF00721                                            0721
*     DO;                           /*                       @Y30LB00*/
*       SETRC=4;                    /*                       @Y30LB00*/
         LA    @05,4                                               0723
         LR    SETRC,@05                                           0723
*       IF TESTRC=4                 /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         CR    TESTRC,@05                                          0724
         BNE   @RF00724                                            0724
*         CALL SSCMSG(REASONCD);    /*                       @Y30LB00*/
*                                                                  0725
         LA    @02,REASONCD                                        0725
         ST    @02,@AL00001                                        0725
         LA    @01,@AL00001                                        0725
         BAL   @14,SSCMSG                                          0725
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE MESSAGE WHICH INDICATES THAT THE            @Y30LB00*/
*       /* CHANGE FAILED FOR ACTIVEPAGES/LRUGROUPS           @Y30LB00*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*       DARGLIST=''B;               /*                       @Y30LB00*/
@RF00724 L     @02,DDSTRU                                          0726
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0726
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0727
*       IF CHNGACTP=ON              /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0728
         BNO   @RF00728                                            0728
*         DARGSENT=MSG2854I(2);     /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG2854I+1                          0729
*       ELSE                        /*                       @Y30LB00*/
*         DARGSENT=MSG2854I(3);     /*                       @Y30LB00*/
         B     @RC00728                                            0730
@RF00728 L     @02,DDSTRU                                          0730
         MVC   DARGSENT(1,@02),MSG2854I+2                          0730
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
@RC00728 L     @02,@PC00001                                        0731
         ST    @02,@AL00001                                        0731
         LA    @15,@CF00114                                        0731
         ST    @15,@AL00001+4                                      0731
         LA    @15,DDSTRU                                          0731
         ST    @15,@AL00001+8                                      0731
         MVI   @AL00001+8,X'80'                                    0731
         L     @15,GDTPRT(,@02)                                    0731
         LA    @01,@AL00001                                        0731
         BALR  @14,@15                                             0731
*     END;                          /*                       @Y30LB00*/
*                                                                  0732
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CHANGE REQUEST COMPLETED WITHOUT ERROR -          @Y30LB00*/
*   /* PRINT THE APPROPRIATE MESSAGE INDICATING THAT         @Y30LB00*/
*   /* THE CHANGE TO THE ACTIVEPAGES/LRUGROUPS TUNING        @Y30LB00*/
*   /* PARAMETERS WAS SUCCESSFUL                             @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0733
*   ELSE                            /*                       @Y30LB00*/
*     DO;                           /*                       @Y30LB00*/
         B     @RC00721                                            0733
@RF00721 DS    0H                                                  0734
*       DARGLIST=''B;               /*                       @Y30LB00*/
         L     @02,DDSTRU                                          0734
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0734
*       DARGSMOD=TUNEMSG;           /*                       @Y30LB00*/
         MVC   DARGSMOD(3,@02),@CC00987                            0735
*       IF CHNGACTP=ON              /*                       @Y30LB00*/
*         THEN                      /*                       @Y30LB00*/
         TM    CHNGACTP,B'10000000'                                0736
         BNO   @RF00736                                            0736
*         DARGSENT=MSG0855I(1);     /*                       @Y30LB00*/
         MVC   DARGSENT(1,@02),MSG0855I                            0737
*       ELSE                        /*                       @Y30LB00*/
*         DARGSENT=MSG0855I(2);     /*                       @Y30LB00*/
         B     @RC00736                                            0738
@RF00736 L     @02,DDSTRU                                          0738
         MVC   DARGSENT(1,@02),MSG0855I+1                          0738
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB00*/
@RC00736 L     @02,@PC00001                                        0739
         ST    @02,@AL00001                                        0739
         LA    @15,@CF00114                                        0739
         ST    @15,@AL00001+4                                      0739
         LA    @15,DDSTRU                                          0739
         ST    @15,@AL00001+8                                      0739
         MVI   @AL00001+8,X'80'                                    0739
         L     @15,GDTPRT(,@02)                                    0739
         LA    @01,@AL00001                                        0739
         BALR  @14,@15                                             0739
*     END;                          /*                       @Y30LB00*/
*                                                                  0740
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CHNGRTN                                     @Y30LB00*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0741
*   RETURN CODE(SETRC);             /*                       @Y30LB00*/
@RC00721 LR    @15,SETRC                                           0741
         L     @14,@SA00009                                        0741
         LM    @00,@02,@SA00009+8                                  0741
         LM    @04,@12,@SA00009+20                                 0741
         BR    @14                                                 0741
*   END CHNGSDG;                    /*                       @Y30LB00*/
*                                                                  0743
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0743
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0743
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00010                                    0743
         MVC   @PC00010(8),0(@01)                                  0743
*                                   /*                       @Y30LB39*/
*                                                                  0744
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0744
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*                                   /*                       @Y30LB39*/
*   DCL                                                            0744
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0745
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0745
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0746
*                                   /*                       @Y30LB39*/
*   DCL                                                            0746
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0747
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0747
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0748
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0748
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0748
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0749
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0749
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0749
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0750
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0750
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0750
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0751
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0751
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0751
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0752
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0752
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0753
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0753
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0753
         L     @15,@PC00001                                        0753
         L     @14,GDTTR2(,@15)                                    0753
         MVC   @TS00001(95),NEWERID2(@14)                          0753
         MVC   OLDERID2(95,@14),@TS00001                           0753
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0754
         MVC   NEWID2(4,@14),@CC01090                              0754
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0755
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0755
         LA    @14,SSDRGLT                                         0755
         ST    @14,SSDLPTR                                         0755
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0756
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0756
         L     @09,@PC00010                                        0756
         L     @09,SSRCODE(,@09)                                   0756
         LTR   @09,@09                                             0756
         BNP   @RF00756                                            0756
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0757
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0758
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0758
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0759
         ST    @03,DARGRETP(,@14)                                  0759
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            0760
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 0761
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0762
         MVC   DARGRETL(2,@14),@CH01091                            0762
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0763
         ST    @15,@AL00001                                        0763
         LA    @03,@CF00114                                        0763
         ST    @03,@AL00001+4                                      0763
         LA    @03,SSDLPTR                                         0763
         ST    @03,@AL00001+8                                      0763
         MVI   @AL00001+8,X'80'                                    0763
         L     @15,GDTPRT(,@15)                                    0763
         LA    @01,@AL00001                                        0763
         BALR  @14,@15                                             0763
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0764
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0764
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   0765
@DL00765 DS    0H                                                  0766
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00218                                   0766
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0767
@DE00765 L     @03,@PC00010                                        0767
         LR    @15,ENTRYNUM                                        0767
         ALR   @15,@15                                             0767
         LH    @15,SSARRAY-2(@15)                                  0767
         CH    @15,SSRHALF(,@03)                                   0767
         BE    @DC00765                                            0767
         SLR   @14,@14                                             0767
         CR    @15,@14                                             0767
         BNE   @DL00765                                            0767
@DC00765 DS    0H                                                  0768
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0768
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0768
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         0769
         MVC   DARGSMOD(3,@09),SSMODSS0                            0769
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             0770
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             0771
         BNE   @RF00771                                            0771
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   0773
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             0774
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0777
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0777
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00756                                            0777
@RF00756 DS    0H                                                  0778
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0778
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         0779
         MVC   DARGSMOD(3,@15),SSMODCM0                            0779
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            0780
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00010+4                                      0781
         ST    @14,DARGDBP(,@15)                                   0781
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00218                             0782
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0783
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0784
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0784
@RC00756 L     @15,@PC00001                                        0784
         ST    @15,@AL00001                                        0784
         LA    @14,@CF00114                                        0784
         ST    @14,@AL00001+4                                      0784
         LA    @14,SSDLPTR                                         0784
         ST    @14,@AL00001+8                                      0784
         MVI   @AL00001+8,X'80'                                    0784
         L     @15,GDTPRT(,@15)                                    0784
         LA    @01,@AL00001                                        0784
         BALR  @14,@15                                             0784
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0785
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0785
         L     @14,@SA00010                                        0785
         LM    @00,@12,@SA00010+8                                  0785
         BR    @14                                                 0785
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCTU01                     /*                       @Y30LB00*/
*                                                                  0787
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSTU )                                       */
*/*%INCLUDE SYSLIB  (ICBTUNE )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  0787
*       ;                                                          0787
@DATA    DS    0H
@CH00152 DC    H'2'
@CH01085 DC    H'60'
@CH01091 DC    H'120'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00004 DS    15F
@SA00002 DS    15F
@SA00003 DS    14F
@SA00006 DS    15F
@SA00007 DS    14F
@SA00008 DS    14F
@SA00009 DS    14F
@SA00005 DS    14F
@SA00010 DS    15F
@PC00010 DS    2F
@AL00001 DS    6A
@AFTEMPS DS    1F
IDCTU01  CSECT
         DS    0F
@CF00114 DC    F'0'
@CF00218 DC    F'1'
@CH00218 EQU   @CF00218+2
@CF00161 DC    F'3'
@CH00161 EQU   @CF00161+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00565 DC    F'12'
@CF00472 DC    F'16'
@CF01061 DC    F'28'
@CF00983 DC    F'181'
@CF01099 DC    XL4'0000FFFF'
@CF01062 DC    XL4'FFFF'
@CF01063 DC    XL4'B5'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
TUPTR    DS    A
REASONCD DS    F
TUMSGPTR DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
INSRTSDG DS    H
ECBCODE  DS    AL1
LISTLN   DS    FL1
@TS00001 DS    CL95
PRINTTAB DS    CL68
DUMPAREA DS    CL17
TUAREA   DS    CL20
TUTBL    DS    CL60
         ORG   TUTBL
TABLNAME DS    CL8
TUFLGS   DS    FL2
         ORG   TUFLGS
CHNGACTP DS    BL1
CHNGLRUG EQU   TUFLGS+0
CHNGLRUK EQU   TUFLGS+0
         ORG   TUTBL+10
TUSWTCH  DS    FL2
         ORG   TUSWTCH
LOOPSW   DS    BL1
         ORG   TUTBL+12
MESGCLK  DS    FL4
         ORG   MESGCLK
MSGCLK   DS    FL1
         ORG   TUTBL+16
CHNGCLK  DS    FL4
         ORG   CHNGCLK
TULRUC   DS    FL1
         ORG   TUTBL+20
@NM00070 DS    FL4
         ORG   @NM00070
@NM00071 DS    CL1
DISCLK   DS    AL3
         ORG   TUTBL+24
MSGACTP  DS    FL4
         ORG   MSGACTP
MSGACTPH DS    FL1
MSGACTPL DS    FL1
         ORG   TUTBL+28
CHGACTPL DS    FL1
CHGACTPH DS    FL1
@NM00072 DS    CL2
DISACTP  DS    FL4
         ORG   DISACTP
DISACTPL DS    FL2
DISACTPH DS    FL2
         ORG   TUTBL+36
NUMLRGS  DS    FL2
LOOPSDG  DS    FL2
MSGDLRGS DS    FL4
         ORG   MSGDLRGS
MSGGBYTE DS    4AL1
         ORG   TUTBL+44
CHNGLRGS DS    FL4
         ORG   CHNGLRGS
CHNGLRGU DS    4CL1
         ORG   TUTBL+48
DISLRGS  DS    CL8
         ORG   DISLRGS
DISDLRGS DS    4H
         ORG   TUTBL+56
INDEX    DS    FL1
LRUGRSUM DS    FL1
         ORG   LRUGRSUM
LRUGSUM  DS    CL1
         ORG   TUTBL+58
NEXTLGRP DS    FL1
         ORG   NEXTLGRP
NXTLGRP  DS    CL1
         ORG   TUTBL+59
TRANSBYT DS    FL1
         ORG   TRANSBYT
TRANBYTE DS    CL1
         ORG   TUTBL+60
ENDTBL   DS    0C
         ORG   TUTBL+60
SSDRGLT  DS    CL20
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCTU01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
SSMSGNUM DC    AL1(56)
@CC01015 DC    C'TUTBL   '
@CC01043 EQU   @CC01015
@CC01011 DC    C'TUEN'
@CC01012 DC    C'TUND'
@CC01018 DC    C'TUXD'
@CC01022 DC    C'TUCR'
@CC01031 DC    C'TUSY'
@CC01035 DC    C'TUDR'
@CC01040 DC    C'TULR'
@CC01045 DC    C'TULA'
@CC01049 DC    C'TUDL'
@CC01050 DC    C'TUDU'
@CC01055 DC    C'TUCL'
@CC01059 DC    C'TUDS'
@CC01060 DC    C'TUDG'
@CC01067 DC    C'TUCS'
@CC01068 DC    C'TUCG'
@CC01090 DC    C'SSAA'
@CC00985 DC    C'UV0'
@CC00987 DC    C'TU0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
MODID    DC    CL4'TU01'
         DS    CL2
CLKUNITS DS    CL44
         ORG   CLKUNITS
CLOCKCNT DC    F'8'
CLOCKVAL DC    F'128'
         DC    F'256'
         DC    F'512'
         DC    F'1024'
         DC    F'2048'
         DC    F'4096'
         DC    F'8192'
         DC    F'16384'
TUVALS   DC    XL1'80'
         DC    XL1'40'
         DC    XL1'20'
         DC    XL1'10'
         DC    XL1'08'
         DC    XL1'04'
         DC    XL1'02'
         DC    XL1'01'
         ORG   CLKUNITS+44
FIXAREA  DS    CL274
         ORG   FIXAREA
@NM00081 DC    274X'00'
         ORG   FIXAREA+274
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
MSG2853I DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
MSG2854I DC    AL1(7)
         DC    AL1(8)
         DC    AL1(9)
MSG0855I DC    AL1(10)
         DC    AL1(11)
         DC    AL1(12)
PSDGMSG  DC    AL1(18)
         DC    AL1(17)
         DC    AL1(16)
         DC    AL1(15)
PPGRPMSG DC    AL1(23)
         DC    AL1(22)
         DC    AL1(21)
         DC    AL1(20)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
INSRTLP  EQU   @02
DMPINDEX EQU   @02
TESTRC   EQU   @04
SETRC    EQU   @03
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
TUNER1   EQU   @01
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSASS0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00065 EQU   SV82LIST+4
SV82DCBP EQU   @NM00065
@NM00066 EQU   SV82LIST+12
SV82WRKP EQU   @NM00066
DIS      EQU   0
LRUC     EQU   0
LRUCVAL  EQU   LRUC
SDG      EQU   0
SDGVAL   EQU   SDG
ACTP     EQU   0
ACTPL    EQU   0
ACTPLVAL EQU   ACTPL
ACTPH    EQU   0
ACTPHVAL EQU   ACTPH
LRUGR    EQU   0
LRUGRCNT EQU   LRUGR
LRUGRVAL EQU   LRUGR+4
TULIST   EQU   0
TUNEFLAG EQU   TULIST+6
TUNMODE  EQU   TUNEFLAG
TUNTHRES EQU   TUNEFLAG+1
TUNSLICE EQU   TUNEFLAG+1
TUNCLOCK EQU   TUNEFLAG+1
TUNESDGN EQU   TULIST+8
TUNEDATA EQU   TULIST+16
@NM00067 EQU   0
TUMSG    EQU   @NM00067+4
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CHNG     EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
@NM00068 EQU   TUNEDATA
TUCLK    EQU   @NM00068
@NM00069 EQU   TUNEDATA
TUACTPH  EQU   @NM00069
TUACTPL  EQU   @NM00069+1
@NM00073 EQU   LRUGRVAL
LGRPVAL  EQU   @NM00073+3
@NM00075 EQU   ACTPLVAL
APLVAL   EQU   @NM00075+3
@NM00077 EQU   ACTPHVAL
APHVAL   EQU   @NM00077+3
@NM00079 EQU   SDGVAL
CHNGSDGV EQU   @NM00079+3
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00080 EQU   @NM00079
@NM00078 EQU   @NM00077
@NM00076 EQU   @NM00075
@NM00074 EQU   @NM00073
@NM00082 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
TUECB    EQU   @NM00067
TUNEECB  EQU   TULIST+12
TUNEASID EQU   TULIST+10
TUNERES2 EQU   TULIST+9
TUNRES2  EQU   TUNEFLAG+1
TUNRES1  EQU   TUNEFLAG
TUNERES1 EQU   TULIST+5
TUNEOPCD EQU   TULIST+4
TUNELEN  EQU   TULIST
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
@NM00064 EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00063 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00062 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00061 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00060 EQU   RCTAGL+10
@NM00059 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00058 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00057 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00056 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00055 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00054 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00053 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00052 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00051 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00050 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00044 EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00242 EQU   @RC00236
@RC00306 EQU   @RC00304
@RC00335 EQU   @RC00333
@RF00437 EQU   @RC00429
@RC00567 EQU   @RC00553
@RC00654 EQU   @RC00648
@RF00771 EQU   @RC00756
@PB00010 EQU   @EL00001
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCTU01,(C'PLS1546',0603,75255)

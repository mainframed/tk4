         TITLE '********** IDCSV01: SCRATCHV FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCSV01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCSV01   75.091'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @10,4095(,@12)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*   BASEVPTR=ADDR(BASEAREA);        /*                       @Y30LB11*/
         LA    BASEVPTR,BASEAREA                                   0240
*   COPYVPTR=ADDR(COPYAREA);        /*                       @Y30LB11*/
         LA    COPYVPTR,COPYAREA                                   0241
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB11*/
         LA    @15,DARGAREA                                        0242
         ST    @15,DDSTRU                                          0242
*   DEFLPTR=ADDR(DEFAREA);          /*                       @Y30LB11*/
         LA    @15,DEFAREA                                         0243
         ST    @15,DEFLPTR                                         0243
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB11*/
*                                                                  0244
         LA    @15,RVVIAREA                                        0244
         ST    @15,RVVIPTR                                         0244
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO SCRATCHV PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   OLDERID2=NEWERID2;                                             0245
         L     @15,@PC00001                                        0245
         L     @14,GDTTR2(,@15)                                    0245
         MVC   @TS00001(95),NEWERID2(@14)                          0245
         MVC   OLDERID2(95,@14),@TS00001                           0245
*   NEWID2='SVSC';                  /*                       @Y30LB11*/
*                                                                  0246
         MVC   NEWID2(4,@14),@CC01174                              0246
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE PROCESSING SCRATCH VOLUME REQUEST     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*                                   /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0247
         L     @15,GDTDBG(,@15)                                    0247
         LTR   @15,@15                                             0247
         BZ    @RT00247                                            0247
*     ;                                                            0248
*   ELSE                                                           0249
*     CALL IDCDB010(GDTTBL,'SVSV'); /*                       @Y30LB11*/
*                                                                  0249
         L     @15,@PC00001                                        0249
         ST    @15,@AL00001                                        0249
         LA    @14,@CC01175                                        0249
         ST    @14,@AL00001+4                                      0249
         MVI   @AL00001+4,X'80'                                    0249
         L     @15,GDTDBG(,@15)                                    0249
         LA    @01,@AL00001                                        0249
         BALR  @14,@15                                             0249
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*   ALLAGL=''B;                     /*                       @Y30LB11*/
@RT00247 LA    @15,ALLGAREA                                        0250
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0250
*   EXCLAGL=''B;                    /*                       @YD00175*/
         LA    @15,EXCLAREA                                        0251
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0251
*   BASEV=''B;                      /*                       @Y30LB11*/
         XC    BASEV(224,BASEVPTR),BASEV(BASEVPTR)                 0252
*   CKAGL=''B;                      /*                       @Y30LB11*/
         LA    @15,CKAGAREA                                        0253
         XC    CKAGL(29,@15),CKAGL(@15)                            0253
*   COMTBL=''B;                     /*                       @Y30LB11*/
         MVI   COMTBL,X'00'                                        0254
*   COPYV=''B;                      /*                       @Y30LB11*/
         XC    COPYV(164,COPYVPTR),COPYV(COPYVPTR)                 0255
*   DEFLIST=''B;                    /*                       @Y30LB11*/
         L     @15,DEFLPTR                                         0256
         XC    DEFLIST(132,@15),DEFLIST(@15)                       0256
*   DARGLIST=''B;                   /*                       @Y30LB11*/
         L     @01,DDSTRU                                          0257
         XC    DARGLIST(20,@01),DARGLIST(@01)                      0257
*   MDAGL=''B;                      /*                       @Y30LB11*/
         LA    @14,MDAGAREA                                        0258
         XC    MDAGL(31,@14),MDAGL(@14)                            0258
*   RVVI=''B;                       /*                       @Y30LB11*/
         L     @14,RVVIPTR                                         0259
         XC    RVVI(68,@14),RVVI(@14)                              0259
*   VS1AGL=''B;                     /*                       @Y30LB11*/
         LA    @09,VSAGAREA                                        0260
         XC    VS1AGL(74,@09),VS1AGL(@09)                          0260
*   Z8=''B;                         /*                       @Y30LB11*/
*                                                                  0261
         XC    Z8(8),Z8                                            0261
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DEFLIST AND RVVI PARAMETER LISTS           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB11*/
         L     @09,@PC00001+4                                      0262
         L     @09,FDTPTR(,@09)                                    0262
         MVC   DEFVOLD(6,@15),VOLVAL(@09)                          0262
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB11*/
         LH    @15,RVVLEN                                          0263
         ST    @15,RVVLNGTH(,@14)                                  0263
*   RVVOLUME=VOLVAL;                /*                       @Y30LB11*/
         MVC   RVVOLUME(6,@14),VOLVAL(@09)                         0264
*   RVVCODE=RVVOP;                  /*                       @Y30LB11*/
*                                                                  0265
         MVI   RVVCODE(@14),X'87'                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* ENQUE TO GET EXCLUSIVE USE OF THE VOLUME SPECIFIED BY @Y30LB11*/
*   /* THE USER.                                             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0266
*   RNAME=RN1;                      /*                       @Y30LB11*/
         MVC   RNAME(16),@CC01125                                  0266
*   RVOLVAL=VOLVAL;                 /*                       @Y30LB11*/
         MVC   RVOLVAL(6),VOLVAL(@09)                              0267
*   RLENGTH=LENGTH(NAMELNG);        /*                       @Y30LB11*/
         MVI   RLENGTH,X'16'                                       0268
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MAJNAME,UQUENAME);/*      @Y30LB11*/
         MVC   @AL00001+4(12),@AL00269                             0269
         L     @15,@PC00001                                        0269
         ST    @15,@AL00001                                        0269
         LA    @14,UQUENAME                                        0269
         ST    @14,@AL00001+16                                     0269
         MVI   @AL00001+16,X'80'                                   0269
         L     @15,GDTENQ(,@15)                                    0269
         LA    @01,@AL00001                                        0269
         BALR  @14,@15                                             0269
*                                                                  0270
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYDATE WAS SPECIFIED THEN CALL COPYPROC TO SCRATCH THE   */
*   /* SPECIFIED COPY.                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0270
*   IF ADDR(CDATE)^=NULLPTR THEN    /*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0270
         L     @15,FDTPTR+8(,@15)                                  0270
         LTR   @15,@15                                             0270
         BZ    @RF00270                                            0270
*     DO;                           /*                       @Y30LB11*/
*       CALL COPYPROC;              /*                       @Y30LB11*/
         BAL   @14,COPYPROC                                        0272
*       RESPECIFY                                                  0273
*         RTNREG RSTD;                                             0273
*       TESTRC=RTNREG;                                             0274
         LR    TESTRC,RTNREG                                       0274
*       RESPECIFY                                                  0275
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0275
*       /*************************************************************/
*       /*                                                           */
*       /* IF COPYPROC WAS UNSUCCESSFUL, THEN SET RETURN CODE TO     */
*       /* INDICATE FAILURE.                                 @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0276
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0276
         BNE   @RF00276                                            0276
*         LASTCOND=LASTCC08;        /*                       @Y30LB11*/
         L     @15,@PC00001+8                                      0277
         MVC   LASTCOND(2,@15),@CH00173                            0277
*     END;                          /*                       @Y30LB11*/
*                                                                  0279
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYDATE WAS NOT SPECIFIED, CHECK OUT THE BASE VOLUME,     */
*   /* SCRATCH ALL COPIES, IF NECESSARY, AND SCRATCH THE BASE VOLUME.*/
*   /*                                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
*                                                                  0279
         B     @RC00270                                            0279
@RF00270 DS    0H                                                  0280
*       /*************************************************************/
*       /*                                                           */
*       /* CALL BASECHK TO CHECK THE VOLUME RECORD AND THE VTOC OF   */
*       /* THE BASE VOLUME.                                  @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0280
*       CALL BASECHK;               /*                       @Y30LB11*/
         BAL   @14,BASECHK                                         0280
*       RESPECIFY                                                  0281
*         RTNREG RSTD;                                             0281
*       TESTRC=RTNREG;                                             0282
         LR    TESTRC,RTNREG                                       0282
*       RESPECIFY                                                  0283
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0283
*       /*************************************************************/
*       /*                                                           */
*       /* IF BASECHK WAS UNSUCCESSFUL, THEN SET RETURN CODE @Y30LB11*/
*       /* TO INDICATE FAILURE.                              @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0284
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0284
         BNE   @RF00284                                            0284
*         LASTCOND=LASTCC08;        /*                       @Y30LB11*/
         L     @15,@PC00001+8                                      0285
         MVC   LASTCOND(2,@15),@CH00173                            0285
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
*                                                                  0286
         B     @RC00284                                            0286
@RF00284 DS    0H                                                  0287
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE PARAMETER 'ALL' WAS SPECIFIED, THEN CALL THE   */
*           /* ALLCOPY ROUTINE TO SCRATCH ALL COPIES FOR THE BASE    */
*           /* VOLUME.                                       @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0287
*           IF ADDR(ALLC)^=NULLPTR THEN/*                    @Y30LB11*/
         L     @15,@PC00001+4                                      0287
         L     @15,FDTPTR+4(,@15)                                  0287
         LTR   @15,@15                                             0287
         BZ    @RF00287                                            0287
*             DO;                   /*                       @Y30LB11*/
*               CALL ALLCOPY;       /*                       @Y30LB11*/
         BAL   @14,ALLCOPY                                         0289
*               RESPECIFY                                          0290
*                 RTNREG RSTD;                                     0290
*               TESTRC=RTNREG;                                     0291
         LR    TESTRC,RTNREG                                       0291
*               RESPECIFY                                          0292
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/
*                                                                  0292
*               /*****************************************************/
*               /*                                                   */
*               /* IF ALLCOPY WAS UNSUCCESSFUL, THEN SET THE RETURN  */
*               /* CODE.                                     @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0293
*               IF TESTRC=4 THEN    /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0293
         BNE   @RF00293                                            0293
*                 LASTCOND=LASTCC08;/*                       @Y30LB11*/
         L     @04,@PC00001+8                                      0294
         MVC   LASTCOND(2,@04),@CH00173                            0294
*             END;                  /*                       @Y30LB11*/
*                                                                  0295
@RF00293 DS    0H                                                  0296
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE THE ALLCOPY ROUTINE FAILED, PRINT THE MESSAGE: */
*           /* VOLUME (VOLSER) NOT SCRATCHED, COPIES EXIST.  @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0296
*           IF LASTCOND=LASTCC08 THEN/*                      @Y30LB11*/
@RF00287 L     @04,@PC00001+8                                      0296
         CLC   LASTCOND(2,@04),@CH00173                            0296
         BNE   @RF00296                                            0296
*             DO;                   /*                       @Y30LB11*/
*               DARGAREA=''B;       /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0298
*               DARGSMOD=SCRTCHMG;  /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0299
         MVC   DARGSMOD(3,@15),@CC01131                            0299
*               DARGSENT=MSG2753I;  /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'01'                                 0300
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB11*/
         L     @14,@PC00001+4                                      0301
         L     @01,FDTPTR(,@14)                                    0301
         LA    @14,VOLVAL(,@01)                                    0301
         ST    @14,DARGDBP(,@15)                                   0301
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0302
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB11*/
         L     @15,@PC00001                                        0303
         ST    @15,@AL00001                                        0303
         LA    @14,@CF00111                                        0303
         ST    @14,@AL00001+4                                      0303
         LA    @14,DDSTRU                                          0303
         ST    @14,@AL00001+8                                      0303
         MVI   @AL00001+8,X'80'                                    0303
         L     @15,GDTPRT(,@15)                                    0303
         LA    @01,@AL00001                                        0303
         BALR  @14,@15                                             0303
*             END;                  /*                       @Y30LB11*/
*                                                                  0304
*           /*********************************************************/
*           /*                                                       */
*           /* IF ALLCOPY WAS SUCCESSFUL OR WAS NOT CALLED, CALL     */
*           /* BASEPROC TO SCRATCH THE BASE VOLUME.          @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0305
*           ELSE                    /*                       @Y30LB11*/
*             DO;                   /*                       @Y30LB11*/
         B     @RC00296                                            0305
@RF00296 DS    0H                                                  0306
*               CALL BASEPROC;      /*                       @Y30LB11*/
         BAL   @14,BASEPROC                                        0306
*               RESPECIFY                                          0307
*                 RTNREG RSTD;                                     0307
*               TESTRC=RTNREG;                                     0308
         LR    TESTRC,RTNREG                                       0308
*               RESPECIFY                                          0309
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/
*                                                                  0309
*               /*****************************************************/
*               /*                                                   */
*               /* IF BASEPROC WAS UNSUCCESSFUL, THEN SET THE RETURN */
*               /* CODE.                                     @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0310
*               IF TESTRC=4 THEN    /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0310
         BNE   @RF00310                                            0310
*                 LASTCOND=LASTCC08;/*                       @Y30LB11*/
         L     @15,@PC00001+8                                      0311
         MVC   LASTCOND(2,@15),@CH00173                            0311
*             END;                  /*                       @Y30LB11*/
@RF00310 DS    0H                                                  0313
*         END;                      /*                       @Y30LB11*/
*                                                                  0313
@RC00296 DS    0H                                                  0314
*       /*************************************************************/
*       /*                                                           */
*       /* IF A UNIT WAS ALLOCATED, THE UDEALLOC MACRO IS ISSUED TO  */
*       /* DEALLOCATE THE UNIT BEFORE EXITING SCRATCHV.      @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0314
*       IF ALLOCFLG=ON THEN         /*                       @Y30LB11*/
@RC00284 TM    ALLOCFLG,B'00010000'                                0314
         BNO   @RF00314                                            0314
*         DO;                       /*                       @Y30LB11*/
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Y30LB11*/
         L     @02,@PC00001                                        0316
         ST    @02,@AL00001                                        0316
         LA    @15,ALLGAREA                                        0316
         ST    @15,@AL00001+4                                      0316
         MVI   @AL00001+4,X'80'                                    0316
         L     @15,GDTDLC(,@02)                                    0316
         LA    @01,@AL00001                                        0316
         BALR  @14,@15                                             0316
*           RESPECIFY                                              0317
*             RTNREG RSTD;                                         0317
*           TESTRC=RTNREG;                                         0318
         LR    TESTRC,RTNREG                                       0318
*           RESPECIFY                                              0319
*             RTNREG UNRSTD;        /*                       @Y30LB11*/
*                                                                  0319
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE UDEALOC MACRO FAILED, SET THE RETURN CODE.     */
*           /*                                               @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0320
*           IF TESTRC>0 THEN        /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0320
         BNP   @RF00320                                            0320
*             LASTCOND=MAX(LASTCC04,LASTCOND);/*             @Y30LB11*/
         L     @15,@PC00001+8                                      0321
         LH    @14,LASTCOND(,@15)                                  0321
         LA    @09,4                                               0321
         CR    @14,@09                                             0321
         BNL   *+6
         LR    @14,@09                                             0321
         STH   @14,LASTCOND(,@15)                                  0321
*         END;                      /*                       @Y30LB11*/
*                                                                  0322
@RF00320 DS    0H                                                  0323
*       /*************************************************************/
*       /*                                                           */
*       /* IF A RESERVE WAS DONE THEN THE UDEQ IS ISSUED TO          */
*       /* UNRESERVE.                                        @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0323
*       IF VSRES=ON THEN            /*                       @Y30LB11*/
@RF00314 LA    @15,VSAGAREA                                        0323
         TM    VSRES(@15),B'10000000'                              0323
         BNO   @RF00323                                            0323
*         DO;                       /*                       @Y30LB11*/
*           RNAME=RN2;              /*                       @Y30LB11*/
         MVC   RNAME(16),@CC01128                                  0325
*           CALL IDCSADQ0(GDTTBL,MAJNAME,UQUENAME);/*        @Y30LB11*/
         L     @15,@PC00001                                        0326
         ST    @15,@AL00001                                        0326
         LA    @14,@CC01113                                        0326
         ST    @14,@AL00001+4                                      0326
         LA    @14,UQUENAME                                        0326
         ST    @14,@AL00001+8                                      0326
         MVI   @AL00001+8,X'80'                                    0326
         L     @15,GDTDEQ(,@15)                                    0326
         LA    @01,@AL00001                                        0326
         BALR  @14,@15                                             0326
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RF00323 DS    0H                                                  0329
*                                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* FINALLY, THE UDEQ MACRO IS USSUED TO DEQUE THE UENQ ISSUED    */
*   /* EARLIER.                                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*   RNAME=RN1;                      /*                       @Y30LB11*/
@RC00270 MVC   RNAME(16),@CC01125                                  0329
*   CALL IDCSADQ0(GDTTBL,MAJNAME,UQUENAME);/*                @Y30LB11*/
*                                                                  0330
         L     @15,@PC00001                                        0330
         ST    @15,@AL00001                                        0330
         LA    @14,@CC01113                                        0330
         ST    @14,@AL00001+4                                      0330
         LA    @14,UQUENAME                                        0330
         ST    @14,@AL00001+8                                      0330
         MVI   @AL00001+8,X'80'                                    0330
         L     @15,GDTDEQ(,@15)                                    0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE HAS BEEN SET TO 8 AND NO COPIES WERE       */
*   /* SCRATCHED AT ALL, THE FINAL RETURN CODE IS SET TO 12. @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   IF LASTCOND=LASTCC08 THEN       /*                       @Y30LB11*/
         L     @15,@PC00001+8                                      0331
         CLC   LASTCOND(2,@15),@CH00173                            0331
         BNE   @RF00331                                            0331
*     IF SCRDFLG=OFF THEN           /*                       @Y30LB11*/
         TM    SCRDFLG,B'01000000'                                 0332
         BNZ   @RF00332                                            0332
*       LASTCOND=LASTCC12;          /*                       @Y30LB11*/
         MVC   LASTCOND(2,@15),@CH00035                            0333
*     ELSE                                                         0334
*       ;                           /*                       @Y30LB11*/
*                                                                  0334
@RF00332 DS    0H                                                  0335
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS 0 OR 4 AND EITHER THE INVENTORY RECORD  */
*   /* WAS NOT UPDATED OR THE UCLOSE MACRO FAILED THEN THE FINAL     */
*   /* RETURN CODE IS SET TO 4.                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   ELSE                            /*                       @Y30LB11*/
*     IF(VIERRFLG=ON×UCLOSERR=ON) THEN/*                     @Y30LB11*/
         B     @RC00331                                            0335
@RF00331 TM    VIERRFLG,B'10100000'                                0335
         BZ    @RF00335                                            0335
*       LASTCOND=LASTCC04;          /*                       @Y30LB11*/
*                                                                  0336
         L     @15,@PC00001+8                                      0336
         MVC   LASTCOND(2,@15),@CH00041                            0336
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE FINAL COMPLETION MESSAGE                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   DARGAREA=''B;                   /*                       @Y30LB11*/
@RF00335 DS    0H                                                  0337
@RC00331 XC    DARGAREA(36),DARGAREA                               0337
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0338
         MVC   DARGSMOD(3,@15),@CC01133                            0338
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB11*/
         L     @14,@PC00001+8                                      0339
         ST    @14,DARGDBP(,@15)                                   0339
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB11*/
*                                                                  0340
         MVC   DARGILP(2,@15),@CH00147                             0340
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL RETURN CODE IS 12 THEN THE MESSAGE: FUNCTION     */
*   /* TERMINATED, CONDITION CODE IS (NN), IS WRITTEN.       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   IF LASTCOND=LASTCC12 THEN       /*                       @Y30LB11*/
         CLC   LASTCOND(2,@14),@CH00035                            0341
         BNE   @RF00341                                            0341
*     DARGSENT=MSG3003I;            /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'03'                                 0342
*   ELSE                            /*                       @Y30LB11*/
*                                                                  0343
*     /***************************************************************/
*     /*                                                             */
*     /* OTHERWISE, THE MESSAGE: FUNCTION COMPLETED, HIGHEST         */
*     /* CONDITION CODE WAS (NN), IS WRITTEN.                @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0343
*     DARGSENT=MSG0001I;            /*                       @Y30LB11*/
         B     @RC00341                                            0343
@RF00341 L     @01,DDSTRU                                          0343
         MVI   DARGSENT(@01),X'01'                                 0343
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/
*                                                                  0344
@RC00341 L     @15,@PC00001                                        0344
         ST    @15,@AL00001                                        0344
         LA    @14,@CF00111                                        0344
         ST    @14,@AL00001+4                                      0344
         LA    @14,DDSTRU                                          0344
         ST    @14,@AL00001+8                                      0344
         MVI   @AL00001+8,X'80'                                    0344
         L     @15,GDTPRT(,@15)                                    0344
         LA    @01,@AL00001                                        0344
         BALR  @14,@15                                             0344
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE EXITING SCRATCHV              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0345
*   IF GDTDBG=NULLPTR THEN                                         0345
         L     @15,@PC00001                                        0345
         L     @15,GDTDBG(,@15)                                    0345
         LTR   @15,@15                                             0345
         BZ    @RT00345                                            0345
*     ;                                                            0346
*   ELSE                                                           0347
*     CALL IDCDB010(GDTTBL,'SVRC'); /*                       @Y30LB11*/
*                                                                  0347
         L     @15,@PC00001                                        0347
         ST    @15,@AL00001                                        0347
         LA    @14,@CC01182                                        0347
         ST    @14,@AL00001+4                                      0347
         MVI   @AL00001+4,X'80'                                    0347
         L     @15,GDTDBG(,@15)                                    0347
         LA    @01,@AL00001                                        0347
         BALR  @14,@15                                             0347
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0348
*                                                                  0348
@RT00345 L     @15,@PC00001                                        0348
         ST    @15,@AL00001                                        0348
         LA    @14,MODID                                           0348
         ST    @14,@AL00001+4                                      0348
         L     @14,@PC00001+8                                      0348
         ST    @14,@AL00001+8                                      0348
         MVI   @AL00001+8,X'80'                                    0348
         L     @15,GDTEPL(,@15)                                    0348
         LA    @01,@AL00001                                        0348
         BALR  @14,@15                                             0348
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*                                                                  0349
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - ALLCOPY                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CALL       @Y30LB11*/
*/*            THE SCRCOPY ROUTINE TO SCRATCH ALL COPIES     @Y30LB11*/
*/*            OF A VIRTUAL VOLUME.                          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2078I ** COPY RECORDS FOR VOLUME (VOLSER)  @Y30LB11*/
*/*            CANNOT BE RETRIEVED.                          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/
*/*         AS INPUT TO READ THE COPYV RECORDS TO BE         @Y30LB11*/
*/*         SCRATCHED.                                       @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/
*/*          SCRDFLG IS SET ON IF SCRCOPY IS SUCCESSFUL.     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - COPY RECORD COULD NOT BE READ OR COPY NOT   @Y30LB11*/
*/*              SCRATCHED.                                  @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0349
*ALLCOPY:                           /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
@EL00001 L     @13,4(,@13)                                         0349
@EF00001 L     @00,@SIZDATD                                        0349
         LR    @01,@11                                             0349
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0349
         BR    @14                                                 0349
ALLCOPY  STM   @14,@12,@SA00002                                    0349
*   DCL                                                            0350
*     ALLCOND FIXED(15);            /*                       @Y30LB11*/
*                                                                  0351
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLCOPY RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0351
*   ALLCOND=0;                      /*                       @Y30LB11*/
*                                                                  0351
         SLR   @15,@15                                             0351
         LR    ALLCOND,@15                                         0351
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO ALLCOPY PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*   OLDERID2=NEWERID2;                                             0352
         L     @14,@PC00001                                        0352
         L     @09,GDTTR2(,@14)                                    0352
         MVC   @TS00001(95),NEWERID2(@09)                          0352
         MVC   OLDERID2(95,@09),@TS00001                           0352
*   NEWID2='SVAC';                  /*                       @Y30LB11*/
*                                                                  0353
         MVC   NEWID2(4,@09),@CC01187                              0353
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI VARIABLES FOR READING ALL COPIES      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0354
*   RVVRDR=OFF;                     /*                       @Y30LB11*/
         L     @09,RVVIPTR                                         0354
         NI    RVVRDR(@09),B'01111111'                             0354
*   RVVBVRCD=OFF;                   /*                       @Y30LB11*/
         NI    RVVBVRCD(@09),B'01111111'                           0355
*   RVVCPYID=0;                     /*                       @Y30LB11*/
         MVI   RVVCPYID(@09),X'00'                                 0356
*   RVVSCPY=ON;                     /*                       @Y30LB11*/
         OI    RVVSCPY(@09),B'00000100'                            0357
*   RVVRDNR=ON;                     /*                       @Y30LB11*/
         OI    RVVRDNR(@09),B'01000000'                            0358
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/
         OI    RVVCPYRC(@09),B'00100000'                           0359
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/
         MVC   RVVBUFLN(2,@09),@CH01285                            0360
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/
*                                                                  0361
         ST    COPYVPTR,RVVRTBUF(,@09)                             0361
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0362
*   IF GDTDBG=NULLPTR THEN                                         0362
         C     @15,GDTDBG(,@14)                                    0362
         BE    @RT00362                                            0362
*     ;                                                            0363
*   ELSE                                                           0364
*     DO;                                                          0364
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0365
*       DMPITMNM='RVVI';                                           0366
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0366
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0366
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0366
*       DMPITMPT=ADDR(RVVI);                                       0367
         L     @03,RVVIPTR                                         0367
         ST    @03,DMPITMPT(,DMPINDEX)                             0367
*       DMPITMLN=LENGTH(RVVI);                                     0368
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0368
*       DMPITMTP='H';                                              0369
         MVI   DMPITMTP(DMPINDEX),C'H'                             0369
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0370
*                                                                  0370
         AL    DMPINDEX,@CF00464                                   0370
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0371
*       DMPTRM=DMPTRMVL;                                           0371
         MVI   DMPTRM(DMPINDEX),X'FF'                              0371
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0373
@RT00362 L     @15,@PC00001                                        0373
         L     @15,GDTDBG(,@15)                                    0373
         LTR   @15,@15                                             0373
         BZ    @RT00373                                            0373
*     ;                                                            0374
*   ELSE                                                           0375
*     CALL IDCDB010(GDTTBL,'SVRA',ADDR(DUMPAREA));/*         @Y30LB11*/
         L     @15,@PC00001                                        0375
         ST    @15,@AL00001                                        0375
         LA    @14,@CC01190                                        0375
         ST    @14,@AL00001+4                                      0375
         LA    @14,DUMPAREA                                        0375
         ST    @14,@AFTEMPS                                        0375
         LA    @14,@AFTEMPS                                        0375
         ST    @14,@AL00001+8                                      0375
         MVI   @AL00001+8,X'80'                                    0375
         L     @15,GDTDBG(,@15)                                    0375
         LA    @01,@AL00001                                        0375
         BALR  @14,@15                                             0375
*                                                                  0376
*/*   REASONCD IS INITIALIZED TO 0 FOR THE FIRST READ        @Y30LB11*/
*                                                                  0376
*   REASONCD=0;                     /*                       @Y30LB11*/
*                                                                  0376
@RT00373 SLR   @15,@15                                             0376
         ST    @15,REASONCD                                        0376
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CODE IS EXECUTED REPEATEDLY UNTIL EITHER THE RETURN CODE */
*   /* IS SET TO 4 OR UNTIL END OF FILE IS REACHED.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   DO WHILE ALLCOND^=4&REASONCD^=EOFILE;/*                  @Y30LB11*/
*                                                                  0377
         B     @DE00377                                            0377
@DL00377 DS    0H                                                  0378
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE THE USSC MACRO TO READ THE NEXT COPY RECORD.  @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0378
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*         @Y30LB11*/
         L     @02,@PC00001                                        0378
         ST    @02,@AL00001                                        0378
         LA    @15,VVIC                                            0378
         ST    @15,@AL00001+4                                      0378
         LA    @15,RVVIPTR                                         0378
         ST    @15,@AL00001+8                                      0378
         LA    @15,REASONCD                                        0378
         ST    @15,@AL00001+12                                     0378
         MVI   @AL00001+12,X'80'                                   0378
         L     @15,GDTSSC(,@02)                                    0378
         LA    @01,@AL00001                                        0378
         BALR  @14,@15                                             0378
*     RESPECIFY                                                    0379
*       RTNREG RSTD;                                               0379
*     TESTRC=RTNREG;                                               0380
         LR    TESTRC,RTNREG                                       0380
*     RESPECIFY                                                    0381
*       RTNREG UNRSTD;              /*                       @Y30LB11*/
*                                                                  0381
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE COPY RECORD WAS READ SUCCESSFULLY, THE SCRCOPY       */
*     /* PROCEDURE IS CALLED TO SCRATCH EACH COPY REQUESTED. @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0382
*     IF TESTRC=0 THEN              /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0382
         BNZ   @RF00382                                            0382
*       DO;                         /*                       @Y30LB11*/
*         CALL SCRCOPY(COMTBL);     /*                       @Y30LB11*/
         LA    @15,COMTBL                                          0384
         ST    @15,@AL00001                                        0384
         LA    @01,@AL00001                                        0384
         BAL   @14,SCRCOPY                                         0384
*         RESPECIFY                                                0385
*           RTNREG RSTD;                                           0385
*         TESTRC=RTNREG;                                           0386
         LR    TESTRC,RTNREG                                       0386
*         RESPECIFY                                                0387
*           RTNREG UNRSTD;          /*                       @Y30LB11*/
*                                                                  0387
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SCRCOPY PROC EXECUTED SUCCESSFULLY THE SCRDFLG IS*/
*         /* SET ON INDICATING THAT AT LEAST ONE COPY WAS SCRATCHED. */
*         /*                                                 @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0388
*         IF TESTRC=0 THEN          /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0388
         BNZ   @RF00388                                            0388
*           SCRDFLG=ON;             /*                       @Y30LB11*/
*                                                                  0389
         OI    SCRDFLG,B'01000000'                                 0389
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE SCRATCH FAILED, THE CONDITION CODE IS SET TO 8 TO*/
*         /* INDICATE THAT THE REST OF THE COPIES CAN STILL BE       */
*         /* SCRATCHED. OTHERWISE, STORAGE IS NOT AVAILABLE TO ISSUE */
*         /* FURTHER MSC MACROS, SO SET THE CONDITION CODE TO 4 TO   */
*         /* TERMINATEINATE THE LOOP OF SCRATCHING COPIES.   @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0390
*         ELSE                      /*                       @Y30LB11*/
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/
         B     @RC00388                                            0390
@RF00388 C     TESTRC,@CF00041                                     0390
         BNE   @RF00390                                            0390
*             ALLCOND=8;            /*                       @Y30LB11*/
         LA    ALLCOND,8                                           0391
*           ELSE                    /*                       @Y30LB11*/
*             ALLCOND=4;            /*                       @Y30LB11*/
*                                                                  0392
         B     @RC00390                                            0392
@RF00390 LA    ALLCOND,4                                           0392
*         /***********************************************************/
*         /*                                                         */
*         /* THE NEXT COPY ID IS SET FOR THE NEXT ICBDEFV MACRO      */
*         /* EXECUTION.                                      @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0393
*         RVVCPYID=COPNO;           /*                       @Y30LB11*/
@RC00390 DS    0H                                                  0393
@RC00388 L     @01,RVVIPTR                                         0393
         MVC   RVVCPYID(1,@01),COPNO(COPYVPTR)                     0393
*       END;                        /*                       @Y30LB11*/
*     ELSE                          /*                       @Y30LB11*/
*                                                                  0395
*       /*************************************************************/
*       /*                                                           */
*       /* IF END OF FILE IS NOT REACHED, THE SSCMSG PROCEDURE IS    */
*       /* CALLED TO ISSUE AN ERROR MSG CORRESPONDING TO THE REASON  */
*       /* CODE THEN THE MESSAGE: ** COPY RECORDS FOR VOLUME (VOLSER)*/
*       /* CANNOT BE RETRIEVED, IS WRITTEN.                  @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0395
*       IF REASONCD^=EOFILE THEN    /*                       @Y30LB11*/
         B     @RC00382                                            0395
@RF00382 CLC   REASONCD(4),@CF01111                                0395
         BE    @RF00395                                            0395
*         DO;                       /*                       @Y30LB11*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/
         LA    @05,REASONCD                                        0397
         ST    @05,@AL00001                                        0397
         LA    @01,@AL00001                                        0397
         BAL   @14,SSCMSG                                          0397
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0398
*           DARGSMOD=COMMSG;        /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0399
         MVC   DARGSMOD(3,@15),@CC01105                            0399
*           DARGSENT=MSG2078I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'1C'                                 0400
*           DARGDBP=ADDR(RVVOLUME); /*                       @Y30LB11*/
         L     @01,RVVIPTR                                         0401
         LA    @14,RVVOLUME(,@01)                                  0401
         ST    @14,DARGDBP(,@15)                                   0401
*           DARGILP=LENGTH(RVVOLUME);/*                      @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0402
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
*                                                                  0403
         L     @15,@PC00001                                        0403
         ST    @15,@AL00001                                        0403
         LA    @14,@CF00111                                        0403
         ST    @14,@AL00001+4                                      0403
         LA    @14,DDSTRU                                          0403
         ST    @14,@AL00001+8                                      0403
         MVI   @AL00001+8,X'80'                                    0403
         L     @15,GDTPRT(,@15)                                    0403
         LA    @01,@AL00001                                        0403
         BALR  @14,@15                                             0403
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE CONDITION CODE TO RCFAIL TO TERMINATE THE LOOP*/
*           /* OF SCRATCHING COPIES.                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0404
*           ALLCOND=4;              /*                       @Y30LB11*/
         LA    ALLCOND,4                                           0404
*         END;                      /*                       @Y30LB11*/
*   END;                            /*                       @Y30LB11*/
@RF00395 DS    0H                                                  0406
@RC00382 DS    0H                                                  0406
@DE00377 C     ALLCOND,@CF00041                                    0406
         BE    @DC00377                                            0406
         CLC   REASONCD(4),@CF01111                                0406
         BNE   @DL00377                                            0406
@DC00377 DS    0H                                                  0407
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /* FINALLY, IF THE RETURN CODE IS NOT 0 THEN THE FINAL RETURN    */
*   /* CODE IS SET TO 4.                                     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   IF ALLCOND^=0 THEN              /*                       @Y30LB11*/
         LTR   ALLCOND,ALLCOND                                     0407
         BZ    @RF00407                                            0407
*     ALLCOND=4;                    /*                       @Y30LB11*/
*                                                                  0408
         LA    ALLCOND,4                                           0408
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN IS MADE TO IDCSV01.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   RETURN CODE(ALLCOND);           /*                       @Y30LB11*/
@RF00407 LR    @15,ALLCOND                                         0409
         L     @14,@SA00002                                        0409
         LM    @00,@12,@SA00002+8                                  0409
         BR    @14                                                 0409
*   END ALLCOPY;                    /*                       @Y30LB11*/
*                                                                  0411
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - BASECHK                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO READ       @Y30LB11*/
*/*            THE BASE VOLUME RECORD AND TO CALL THE        @Y30LB11*/
*/*            CHKVTOC AND UNITCHK ROUTINES.                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC3095I VOLUME (VOLSER) WAS INCOMPLETELY     @Y30LB11*/
*/*            RENAMED IN A PRIOR OPERATION.                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2080I ** RECORD FOR VOL (VOLSER) CANNOT    @Y30LB11*/
*/*            BE RETRIEVED FROM INVENTORY.                  @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC3074I VOLUME (VOLSER) NOT ACTIVE           @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/
*/*         AS INPUT TO READ THE BASEV RECORD.               @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*              MISMATCH FLAG WAS SET, OR UNIT CHECK        @Y30LB11*/
*/*              FAILED, OR VTOC WAS NOT EMPTY, OR BASE      @Y30LB11*/
*/*              VOLUME IS INACTIVE AND NOT INCOMPLETELY     @Y30LB11*/
*/*              CREATED.                                    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0411
*BASECHK:                           /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
BASECHK  STM   @14,@12,@SA00003                                    0411
*   DCL                                                            0412
*     BCHKCOND FIXED(15);           /*                       @Y30LB11*/
*                                                                  0413
*   /*****************************************************************/
*   /*                                                               */
*   /* BASECHK RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0413
*   BCHKCOND=0;                     /*                       @Y30LB11*/
*                                                                  0413
         SLR   @15,@15                                             0413
         LR    BCHKCOND,@15                                        0413
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO BASECHK PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   OLDERID2=NEWERID2;                                             0414
         L     @14,@PC00001                                        0414
         L     @09,GDTTR2(,@14)                                    0414
         MVC   @TS00001(95),NEWERID2(@09)                          0414
         MVC   OLDERID2(95,@09),@TS00001                           0414
*   NEWID2='SVBC';                  /*                       @Y30LB11*/
*                                                                  0415
         MVC   NEWID2(4,@09),@CC01197                              0415
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI VARIABLES FOR READING BASEV RECORD    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   RVVBVRCD=ON;                    /*                       @Y30LB11*/
         L     @09,RVVIPTR                                         0416
         OI    RVVBVRCD(@09),B'10000000'                           0416
*   RVVRDR=ON;                      /*                       @Y30LB11*/
         OI    RVVRDR(@09),B'10000000'                             0417
*   RVVRTBUF=BASEVPTR;              /*                       @Y30LB11*/
         ST    BASEVPTR,RVVRTBUF(,@09)                             0418
*   RVVBUFLN=LENGTH(BASEAREA);      /*                       @Y30LB11*/
*                                                                  0419
         MVC   RVVBUFLN(2,@09),@CH01287                            0419
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0420
*   IF GDTDBG=NULLPTR THEN                                         0420
         C     @15,GDTDBG(,@14)                                    0420
         BE    @RT00420                                            0420
*     ;                                                            0421
*   ELSE                                                           0422
*     DO;                                                          0422
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0423
*       DMPITMNM='RVVI';                                           0424
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0424
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0424
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0424
*       DMPITMPT=ADDR(RVVI);                                       0425
         L     @03,RVVIPTR                                         0425
         ST    @03,DMPITMPT(,DMPINDEX)                             0425
*       DMPITMLN=LENGTH(RVVI);                                     0426
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0426
*       DMPITMTP='H';                                              0427
         MVI   DMPITMTP(DMPINDEX),C'H'                             0427
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0428
*                                                                  0428
         AL    DMPINDEX,@CF00464                                   0428
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0429
*       DMPTRM=DMPTRMVL;                                           0429
         MVI   DMPTRM(DMPINDEX),X'FF'                              0429
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0431
@RT00420 L     @15,@PC00001                                        0431
         L     @15,GDTDBG(,@15)                                    0431
         LTR   @15,@15                                             0431
         BZ    @RT00431                                            0431
*     ;                                                            0432
*   ELSE                                                           0433
*     CALL IDCDB010(GDTTBL,'SVRB',ADDR(DUMPAREA));/*         @Y30LB11*/
*                                                                  0433
         L     @15,@PC00001                                        0433
         ST    @15,@AL00001                                        0433
         LA    @14,@CC01198                                        0433
         ST    @14,@AL00001+4                                      0433
         LA    @14,DUMPAREA                                        0433
         ST    @14,@AFTEMPS+4                                      0433
         LA    @14,@AFTEMPS+4                                      0433
         ST    @14,@AL00001+8                                      0433
         MVI   @AL00001+8,X'80'                                    0433
         L     @15,GDTDBG(,@15)                                    0433
         LA    @01,@AL00001                                        0433
         BALR  @14,@15                                             0433
*   /*****************************************************************/
*   /*                                                               */
*   /* USSC MACRO TO GET BASEV RECORD                        @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0434
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/
@RT00431 L     @02,@PC00001                                        0434
         ST    @02,@AL00001                                        0434
         LA    @15,VVIC                                            0434
         ST    @15,@AL00001+4                                      0434
         LA    @15,RVVIPTR                                         0434
         ST    @15,@AL00001+8                                      0434
         LA    @15,REASONCD                                        0434
         ST    @15,@AL00001+12                                     0434
         MVI   @AL00001+12,X'80'                                   0434
         L     @15,GDTSSC(,@02)                                    0434
         LA    @01,@AL00001                                        0434
         BALR  @14,@15                                             0434
*   RESPECIFY                                                      0435
*     RTNREG RSTD;                                                 0435
*   TESTRC=RTNREG;                                                 0436
         LR    TESTRC,RTNREG                                       0436
*   RESPECIFY                                                      0437
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0438
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE READ WAS SUCCESSFUL FIELDS WITHIN THE BASE     @Y30LB11*/
*   /* VOLUME RECORD ARE CHECKED IN ORDER TO CALL THE        @Y30LB11*/
*   /* UNITCHK PROCEDURE.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0438
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0438
         BNZ   @RF00438                                            0438
*     DO;                           /*                       @Y30LB11*/
*                                                                  0439
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS ACTIVE, THE RECOVERY AND MISMATCH FLAGS  */
*       /* ARE TESTED AND THE UNIT AND VTOC ARE CHECKED.     @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0440
*       IF BASINAC=OFF THEN         /*                       @Y30LB11*/
         TM    BASINAC(BASEVPTR),B'00000100'                       0440
         BNZ   @RF00440                                            0440
*         DO;                       /*                       @Y30LB11*/
*                                                                  0441
*           /*********************************************************/
*           /*                                                       */
*           /* IF ANY RECOVERY FLAGS ARE ON, THE NOVTOCCK FLAG IS SET*/
*           /* FOR USE BY THE UNITCHK PROCEDURE.             @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0442
*           IF BASSATIA^=ZERO THEN  /*                       @Y30LB11*/
         CLC   BASSATIA(2,BASEVPTR),ZERO                           0442
         BE    @RF00442                                            0442
*             NOVTOCCK=ON;          /*                       @Y30LB11*/
*                                                                  0443
         OI    NOVTOCCK,B'00001000'                                0443
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE MISMATCH FLAG IS ON, THE RETURN CODE IS SET TO */
*           /* 4 AND THE MESSAGE: VOLUME (VOLSER) WAS INCOMPLETELY   */
*           /* RENAMED IN A PRIOR OPERATION, IS WRITTEN.     @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0444
*           IF BASVSMIS=ON THEN     /*                       @Y30LB11*/
@RF00442 TM    BASVSMIS(BASEVPTR),B'00100000'                      0444
         BNO   @RF00444                                            0444
*             DO;                   /*                       @Y30LB11*/
*               BCHKCOND=4;         /*                       @Y30LB11*/
         LA    BCHKCOND,4                                          0446
*               DARGAREA=''B;       /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0447
*               DARGSMOD=COMMSG;    /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0448
         MVC   DARGSMOD(3,@15),@CC01105                            0448
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB11*/
         L     @14,@PC00001+4                                      0449
         L     @01,FDTPTR(,@14)                                    0449
         LA    @14,VOLVAL(,@01)                                    0449
         ST    @14,DARGDBP(,@15)                                   0449
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0450
*               DARGSENT=MSG3095I;  /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'09'                                 0451
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB11*/
         L     @15,@PC00001                                        0452
         ST    @15,@AL00001                                        0452
         LA    @14,@CF00111                                        0452
         ST    @14,@AL00001+4                                      0452
         LA    @14,DDSTRU                                          0452
         ST    @14,@AL00001+8                                      0452
         MVI   @AL00001+8,X'80'                                    0452
         L     @15,GDTPRT(,@15)                                    0452
         LA    @01,@AL00001                                        0452
         BALR  @14,@15                                             0452
*             END;                  /*                       @Y30LB11*/
*                                                                  0453
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE PREVIOUS STEP GAVE A GOOD CONDITION CODE       */
*           /*                                               @Y30LB11*/
*           /* THE UNITCHK PROCEDURE IS CALLED TO CHECK OR ASSIGN A  */
*           /* UNIT.                                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0454
*           IF BCHKCOND=0 THEN      /*                       @Y30LB11*/
@RF00444 LTR   BCHKCOND,BCHKCOND                                   0454
         BNZ   @RF00454                                            0454
*             DO;                   /*                       @Y30LB11*/
*               CALL UNITCHK;       /*                       @Y30LB11*/
         BAL   @14,UNITCHK                                         0456
*               RESPECIFY                                          0457
*                 RTNREG RSTD;                                     0457
*               TESTRC=RTNREG;                                     0458
         LR    TESTRC,RTNREG                                       0458
*               RESPECIFY                                          0459
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/
*                                                                  0459
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE UNITCHK PROCEDURE WAS SUCCESSFUL THE       */
*               /*                                           @Y30LB11*/
*               /* NOVTOCCK FLAG IS INTERROGATED.            @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0460
*               IF TESTRC=0 THEN    /*                       @Y30LB11*/
*                                                                  0460
         LTR   TESTRC,TESTRC                                       0460
         BNZ   @RF00460                                            0460
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE NOVTOCCK FLAG IS OFF CHKVTOC IS CALLED TO*/
*                 /* CHECK FOR AN EMPTY VTOC.                @Y30LB11*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0461
*                 IF NOVTOCCK=OFF THEN/*                     @Y30LB11*/
         TM    NOVTOCCK,B'00001000'                                0461
         BNZ   @RF00461                                            0461
*                   DO;             /*                       @Y30LB11*/
*                     CALL CHKVTOC; /*                       @Y30LB11*/
         BAL   @14,CHKVTOC                                         0463
*                     RESPECIFY                                    0464
*                       RTNREG RSTD;                               0464
*                     TESTRC=RTNREG;                               0465
         LR    TESTRC,RTNREG                                       0465
*                     RESPECIFY                                    0466
*                       RTNREG UNRSTD;/*                     @Y30LB11*/
*                                                                  0466
*                     /***********************************************/
*                     /*                                             */
*                     /* IF CHKVTOC FAILS, A FAILING RETURN CODE IS  */
*                     /* SET.                                @Y30LB11*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0467
*                     IF TESTRC=4 THEN/*                     @Y30LB11*/
         LA    @02,4                                               0467
         CR    TESTRC,@02                                          0467
         BNE   @RF00467                                            0467
*                       BCHKCOND=4; /*                       @Y30LB11*/
         LR    BCHKCOND,@02                                        0468
*                   END;            /*                       @Y30LB11*/
*                 ELSE                                             0470
*                   ;               /*                       @Y30LB11*/
*                                                                  0470
@RF00461 DS    0H                                                  0471
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE UNITCHK PROC WAS NOT SUCCESSFUL, SET A     */
*               /* FAILING CONDITION CODE.                   @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0471
*               ELSE                /*                       @Y30LB11*/
*                 BCHKCOND=4;       /*                       @Y30LB11*/
         B     @RC00460                                            0471
@RF00460 LA    BCHKCOND,4                                          0471
*             END;                  /*                       @Y30LB11*/
*         END;                      /*                       @Y30LB11*/
*                                                                  0473
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS INACTIVE WHILE THE INCOMPLETE CREATE FLAG*/
*       /* IS OFF, THE MESSAGE: VOLUME (VOLSER) NOT ACTIVE, IS       */
*       /* WRITTEN AND THE RETURN CODE IS SET TO 4.          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0474
*       ELSE                        /*                       @Y30LB11*/
*         IF BASIVCRE=OFF THEN      /*                       @Y30LB11*/
         B     @RC00440                                            0474
@RF00440 TM    BASIVCRE(BASEVPTR),B'10000000'                      0474
         BNZ   @RF00474                                            0474
*           DO;                     /*                       @Y30LB11*/
*             DARGAREA=''B;         /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0476
*             DARGSMOD=COMMSG;      /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0477
         MVC   DARGSMOD(3,@15),@CC01105                            0477
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB11*/
         L     @14,@PC00001+4                                      0478
         L     @01,FDTPTR(,@14)                                    0478
         LA    @14,VOLVAL(,@01)                                    0478
         ST    @14,DARGDBP(,@15)                                   0478
*             DARGILP=LENGTH(VOLVAL);/*                      @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0479
*             DARGSENT=MSG3074I;    /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'20'                                 0480
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/
         L     @15,@PC00001                                        0481
         ST    @15,@AL00001                                        0481
         LA    @14,@CF00111                                        0481
         ST    @14,@AL00001+4                                      0481
         LA    @14,DDSTRU                                          0481
         ST    @14,@AL00001+8                                      0481
         MVI   @AL00001+8,X'80'                                    0481
         L     @15,GDTPRT(,@15)                                    0481
         LA    @01,@AL00001                                        0481
         BALR  @14,@15                                             0481
*             BCHKCOND=4;           /*                       @Y30LB11*/
         LA    BCHKCOND,4                                          0482
*           END;                    /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0485
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VVIC READ WAS UNSUCCESSFUL, THE SSCMSG         @Y30LB11*/
*   /* ROUTINE IS CALLED TO WRITE AN ERROR CORRESPONDING     @Y30LB11*/
*   /* TO THE REASON CODE. THEN THE MESSAGE : **             @Y30LB11*/
*   /* RECORD FOR VOL (VOLSER) CANNOT BE RETRIEVED           @Y30LB11*/
*   /* FROM INVENTORY, IS WRITTEN TO THE SYSPRINT DATA       @Y30LB11*/
*   /* SET AND A RETURN CODE OF 4 IS SET.                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0485
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00438                                            0485
@RF00438 DS    0H                                                  0486
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/
         LA    @04,REASONCD                                        0486
         ST    @04,@AL00001                                        0486
         LA    @01,@AL00001                                        0486
         BAL   @14,SSCMSG                                          0486
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0487
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0488
         MVC   DARGSMOD(3,@15),@CC01105                            0488
*       DARGSENT=MSG2080I;          /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'1A'                                 0489
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/
         L     @14,@PC00001+4                                      0490
         L     @01,FDTPTR(,@14)                                    0490
         LA    @14,VOLVAL(,@01)                                    0490
         ST    @14,DARGDBP(,@15)                                   0490
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0491
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/
         L     @15,@PC00001                                        0492
         ST    @15,@AL00001                                        0492
         LA    @14,@CF00111                                        0492
         ST    @14,@AL00001+4                                      0492
         LA    @14,DDSTRU                                          0492
         ST    @14,@AL00001+8                                      0492
         MVI   @AL00001+8,X'80'                                    0492
         L     @15,GDTPRT(,@15)                                    0492
         LA    @01,@AL00001                                        0492
         BALR  @14,@15                                             0492
*       BCHKCOND=4;                 /*                       @Y30LB11*/
         LA    BCHKCOND,4                                          0493
*     END;                          /*                       @Y30LB11*/
*                                                                  0494
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCSV01                                     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*   RETURN CODE(BCHKCOND);          /*                       @Y30LB11*/
@RC00438 LR    @15,BCHKCOND                                        0495
         L     @14,@SA00003                                        0495
         LM    @00,@12,@SA00003+8                                  0495
         BR    @14                                                 0495
*   END BASECHK;                    /*                       @Y30LB11*/
*                                                                  0497
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - BASEPROC                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO SCRATCH    @Y30LB11*/
*/*            THE BASE VOLUME AND ITS INVENTORY RECORD.     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2752I ** CARTS CSN (CSN) NOT SCRATCHED FOR @Y30LB11*/
*/*            (VOLSER).                                     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0751I CARTS CSN (CSN) SCRATCHED FOR VOLUME @Y30LB11*/
*/*            (VOLSER).                                     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE MDAGL MAPPING MACRO IS INITIALIZED WITH      @Y30LB11*/
*/*         THE DDNAME.  THE ARGUMENT LIST FOR ICBDEFV IS    @Y30LB11*/
*/*         INITIALIZED WITH VOLUME SERIAL NUMBER.  THE BASE @Y30LB11*/
*/*         VOLUME RECORD HAS BEEN READ.                     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - VOLUME WAS NOT SCRATCHED SUCCESSFULLY,      @Y30LB11*/
*/*              VOLUME COULD NOT BE DEMOUNTED, OR VOLUME    @Y30LB11*/
*/*              COULD NOT BE SCRATCHED, OR USSC UMACRO      @Y30LB11*/
*/*              COULD NOT OBTAIN STORAGE FOR ECB/MESSAGE    @Y30LB11*/
*/********************************************************************/
*                                                                  0497
*BASEPROC:                                                         0497
*   PROC;                           /*                       @Y30LB11*/
BASEPROC STM   @14,@12,@SA00004                                    0497
*   DCL                                                            0498
*     BPROCOND FIXED(15);           /*                       @Y30LB11*/
*                                                                  0499
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO BASEPROC PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   OLDERID2=NEWERID2;                                             0499
         L     @15,@PC00001                                        0499
         L     @14,GDTTR2(,@15)                                    0499
         MVC   @TS00001(95),NEWERID2(@14)                          0499
         MVC   OLDERID2(95,@14),@TS00001                           0499
*   NEWID2='SVBP';                  /*                       @Y30LB11*/
*                                                                  0500
         MVC   NEWID2(4,@14),@CC01205                              0500
*   /*****************************************************************/
*   /*                                                               */
*   /* BASEPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   BPROCOND=0;                     /*                       @Y30LB11*/
         SLR   BPROCOND,BPROCOND                                   0501
*                                                                  0502
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF DDNAME ALLOCATED IN MDAGL. IF SO, ISSUE      @Y30LB11*/
*   /* THE UMSSUNIT MACRO TO DEMOUNT THE VOLUME ON THAT UNIT.@Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*   IF MDDDNAME^=Z8 THEN            /*                       @Y30LB11*/
         LA    @14,MDAGAREA                                        0502
         CLC   MDDDNAME(8,@14),Z8                                  0502
         BE    @RF00502                                            0502
*     DO;                           /*                       @Y30LB11*/
*       MDLABEL=VOLVAL;             /*                       @Y30LB11*/
         L     @02,@PC00001+4                                      0504
         L     @02,FDTPTR(,@02)                                    0504
         MVC   MDLABEL(6,@14),VOLVAL(@02)                          0504
*       MDUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB11*/
         LA    @02,UCBPTR                                          0505
         ST    @02,MDUCBPTR(,@14)                                  0505
*       MDWAIT=ON;                  /*                       @Y30LB11*/
*       MDDEQ=ON;                   /*                       @YD00175*/
         OI    MDWAIT(@14),B'00010100'                             0507
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB11*/
         ST    @15,@AL00001                                        0508
         LA    @02,DEMOUNT                                         0508
         ST    @02,@AL00001+4                                      0508
         ST    @14,@AL00001+8                                      0508
         MVI   @AL00001+8,X'80'                                    0508
         L     @15,GDTUNT(,@15)                                    0508
         LA    @01,@AL00001                                        0508
         BALR  @14,@15                                             0508
*       RESPECIFY                                                  0509
*         RTNREG RSTD;                                             0509
*       TESTRC=RTNREG;                                             0510
         LR    TESTRC,RTNREG                                       0510
*       RESPECIFY                                                  0511
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0511
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEMOUNT WAS NOT SUCCESSFUL, THE MESSAGE:       @Y30LB11*/
*       /* ** CARTS CSN (CSN) NOT SCRATCHED FOR (VOLSER),    @Y30LB11*/
*       /* IS WRITTEN TO THE SYSPRINT DATA SET.              @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0512
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0512
         BNE   @RF00512                                            0512
*         DO;                       /*                       @Y30LB11*/
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0514
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0515
         MVC   DARGSMOD(3,@15),@CC01131                            0515
*           DARGSENT=MSG2752I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'03'                                 0516
*           DARGDBP=ADDR(BASCSN1);  /*                       @Y30LB11*/
         LA    @14,BASCSN1(,BASEVPTR)                              0517
         ST    @14,DARGDBP(,@15)                                   0517
*           DARGILP=LENGTH(BASCSN1);/*                       @Y30LB11*/
         LA    @14,12                                              0518
         STH   @14,DARGILP(,@15)                                   0518
*           DARGCNT=2;              /*                       @Y30LB11*/
         LA    @09,2                                               0519
         STH   @09,DARGCNT(,@15)                                   0519
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/
         MVC   DARGINS(2,@15),@CH00213                             0520
*           DARGINL(1)=LENGTH(BASCSN2);/*                    @Y30LB11*/
         STH   @14,DARGINL(,@15)                                   0521
*           DARGDTM(1)=ADDR(BASCSN2);/*                      @Y30LB11*/
         LA    @14,BASCSN2(,BASEVPTR)                              0522
         ST    @14,DARGDTM(,@15)                                   0522
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/
         STH   @09,DARGINS+8(,@15)                                 0523
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/
         MVC   DARGINL+8(2,@15),@CH00150                           0524
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/
         L     @14,@PC00001+4                                      0525
         L     @01,FDTPTR(,@14)                                    0525
         LA    @14,VOLVAL(,@01)                                    0525
         ST    @14,DARGDTM+8(,@15)                                 0525
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
*                                                                  0526
         L     @15,@PC00001                                        0526
         ST    @15,@AL00001                                        0526
         LA    @14,@CF00111                                        0526
         ST    @14,@AL00001+4                                      0526
         LA    @14,DDSTRU                                          0526
         ST    @14,@AL00001+8                                      0526
         MVI   @AL00001+8,X'80'                                    0526
         L     @15,GDTPRT(,@15)                                    0526
         LA    @01,@AL00001                                        0526
         BALR  @14,@15                                             0526
*           /*********************************************************/
*           /*                                                       */
*           /* SET RETURN CODE TO RCFAIL                     @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0527
*           BPROCOND=4;             /*                       @Y30LB11*/
         LA    BPROCOND,4                                          0527
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
@RF00512 DS    0H                                                  0530
*                                                                  0530
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE RETURN CODE. IF RCOK, SCRATCH THE VOLUME.   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0530
*   IF BPROCOND=0 THEN              /*                       @Y30LB11*/
@RF00502 LTR   BPROCOND,BPROCOND                                   0530
         BNZ   @RF00530                                            0530
*     DO;                           /*                       @Y30LB11*/
*                                                                  0531
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS ACTIVE, DEFVELM IS SET TO SCRATCH AN     */
*       /* ACTIVE VOLUME. OTHERWISE, DEFLIST IS SET TO SCRATCH A     */
*       /* TRANSIENT VOLUME.                                 @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0532
*       IF BASINAC=OFF THEN         /*                       @Y30LB11*/
         TM    BASINAC(BASEVPTR),B'00000100'                       0532
         BNZ   @RF00532                                            0532
*         DEFVELM=ON;               /*                       @Y30LB11*/
         L     @01,DEFLPTR                                         0533
         OI    DEFVELM(@01),B'01000000'                            0533
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
         B     @RC00532                                            0534
@RF00532 DS    0H                                                  0535
*           DEFVCSN1=BASCSN1;       /*                       @Y30LB11*/
         L     @15,DEFLPTR                                         0535
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  0535
*           DEFVELTR=ON;            /*                       @Y30LB11*/
         OI    DEFVELTR(@15),B'00001000'                           0536
*         END;                      /*                       @Y30LB11*/
*                                                                  0537
*       /*************************************************************/
*       /*                                                           */
*       /* SYMBOLIC DUMP OF INITIALIZED PARM LIST FOR        @Y30LB11*/
*       /* DEFINE MACRO.                                     @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0538
*       IF GDTDBG=NULLPTR THEN                                     0538
@RC00532 L     @15,@PC00001                                        0538
         L     @15,GDTDBG(,@15)                                    0538
         LTR   @15,@15                                             0538
         BZ    @RT00538                                            0538
*         ;                                                        0539
*       ELSE                                                       0540
*         DO;                                                      0540
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0541
*           DMPITMNM='DEFLIST';                                    0542
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0542
         MVC   DMPITMNM(7,DMPINDEX),@CC01206                       0542
*           DMPITMPT=ADDR(DEFLIST);                                0543
         L     @03,DEFLPTR                                         0543
         ST    @03,DMPITMPT(,DMPINDEX)                             0543
*           DMPITMLN=LENGTH(DEFLIST);                              0544
         MVC   DMPITMLN(2,DMPINDEX),@CH01288                       0544
*           DMPITMTP='H';                                          0545
         MVI   DMPITMTP(DMPINDEX),C'H'                             0545
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0546
*                                                                  0546
         AL    DMPINDEX,@CF00464                                   0546
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0547
*           DMPTRM=DMPTRMVL;                                       0547
         MVI   DMPTRM(DMPINDEX),X'FF'                              0547
*         END;                      /*                       @Y30LB11*/
*       IF GDTDBG=NULLPTR THEN                                     0549
@RT00538 L     @15,@PC00001                                        0549
         L     @15,GDTDBG(,@15)                                    0549
         LTR   @15,@15                                             0549
         BZ    @RT00549                                            0549
*         ;                                                        0550
*       ELSE                                                       0551
*         CALL IDCDB010(GDTTBL,'SVSB',ADDR(DUMPAREA));/*     @Y30LB11*/
*                                                                  0551
         L     @15,@PC00001                                        0551
         ST    @15,@AL00001                                        0551
         LA    @14,@CC01207                                        0551
         ST    @14,@AL00001+4                                      0551
         LA    @14,DUMPAREA                                        0551
         ST    @14,@AFTEMPS+8                                      0551
         LA    @14,@AFTEMPS+8                                      0551
         ST    @14,@AL00001+8                                      0551
         MVI   @AL00001+8,X'80'                                    0551
         L     @15,GDTDBG(,@15)                                    0551
         LA    @01,@AL00001                                        0551
         BALR  @14,@15                                             0551
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE THE ICBDEFV MACRO                          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0552
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFLPTR,REASONCD,ECBCODE,MSGPTR);
@RT00549 L     @02,@PC00001                                        0552
         ST    @02,@AL00001                                        0552
         LA    @15,DEFINE                                          0552
         ST    @15,@AL00001+4                                      0552
         LA    @15,DEFLPTR                                         0552
         ST    @15,@AL00001+8                                      0552
         LA    @15,REASONCD                                        0552
         ST    @15,@AL00001+12                                     0552
         LA    @15,ECBCODE                                         0552
         ST    @15,@AL00001+16                                     0552
         LA    @15,MSGPTR                                          0552
         ST    @15,@AL00001+20                                     0552
         MVI   @AL00001+20,X'80'                                   0552
         L     @15,GDTSSC(,@02)                                    0552
         LA    @01,@AL00001                                        0552
         BALR  @14,@15                                             0552
*       RESPECIFY                                                  0553
*         RTNREG RSTD;                                             0553
*       TESTRC=RTNREG;                                             0554
         LR    TESTRC,RTNREG                                       0554
*       RESPECIFY                                                  0555
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0555
*       /*************************************************************/
*       /*                                                           */
*       /* IF CARTRIDGES WERE SCRATCHED (RC=0 OR 12), HANDLE IT.     */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0556
*       IF TESTRC=0×TESTRC=12 THEN  /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0556
         BZ    @RT00556                                            0556
         C     TESTRC,@CF00035                                     0556
         BNE   @RF00556                                            0556
@RT00556 DS    0H                                                  0557
*         DO;                       /*                       @Y30LB11*/
*                                                                  0557
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE IS 12, THE VIERRFLG IS     @Y30LB11*/
*           /* SET, THE MESSAGE: CARTS CSN (CSN) SCRATCHED FOR VOLUME*/
*           /* (VOLSER), IS WRITTEN AND THE                  @Y30LB11*/
*           /* UFSPACE UMACRO IS ISSUED TO FREE THE AREA     @Y30LB11*/
*           /* OBTAINED FOR THE ECB/MESSAGE AREA.            @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0558
*           IF TESTRC=12 THEN       /*                       @Y30LB11*/
         C     TESTRC,@CF00035                                     0558
         BNE   @RF00558                                            0558
*             VIERRFLG=ON;          /*                       @Y30LB11*/
*                                                                  0559
         OI    VIERRFLG,B'10000000'                                0559
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP DARGLIST TO PRINT MESSAGE: CARTS CSN (CSN)     */
*           /* SCRATCHED FOR VOLUME (VOLSER).                @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0560
*           CMMSGPTR=MSGPTR+ECBLEN; /* ADDRESSABILITY TO USSC MSG  0560
*                                      AREA                  @Y30LB11*/
@RF00558 LA    CMMSGPTR,4                                          0560
         AL    CMMSGPTR,MSGPTR                                     0560
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0561
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0562
         MVC   DARGSMOD(3,@05),@CC01131                            0562
*           DARGSENT=MSG0751I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'02'                                 0563
*           DARGDBP=ADDR(CMCSN1);   /*                       @Y30LB11*/
         LA    @03,CMCSN1(,CMMSGPTR)                               0564
         ST    @03,DARGDBP(,@05)                                   0564
*           DARGILP=LENGTH(CMCSN1); /*                       @Y30LB11*/
         LA    @03,12                                              0565
         STH   @03,DARGILP(,@05)                                   0565
*           DARGCNT=2;              /*                       @Y30LB11*/
         LA    @15,2                                               0566
         STH   @15,DARGCNT(,@05)                                   0566
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/
         MVC   DARGINS(2,@05),@CH00213                             0567
*           DARGINL(1)=LENGTH(CMCSN2);/*                     @Y30LB11*/
         STH   @03,DARGINL(,@05)                                   0568
*           DARGDTM(1)=ADDR(CMCSN2);/*                       @Y30LB11*/
         LA    @03,CMCSN2(,CMMSGPTR)                               0569
         ST    @03,DARGDTM(,@05)                                   0569
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/
         STH   @15,DARGINS+8(,@05)                                 0570
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/
         MVC   DARGINL+8(2,@05),@CH00150                           0571
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0572
         L     @01,FDTPTR(,@15)                                    0572
         LA    @15,VOLVAL(,@01)                                    0572
         ST    @15,DARGDTM+8(,@05)                                 0572
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
         L     @05,@PC00001                                        0573
         ST    @05,@AL00001                                        0573
         LA    @15,@CF00111                                        0573
         ST    @15,@AL00001+4                                      0573
         LA    @15,DDSTRU                                          0573
         ST    @15,@AL00001+8                                      0573
         MVI   @AL00001+8,X'80'                                    0573
         L     @15,GDTPRT(,@05)                                    0573
         LA    @01,@AL00001                                        0573
         BALR  @14,@15                                             0573
*           CALL IDCSAFS0(GDTTBL,MSGPTR);/*                  @Y30LB11*/
         L     @05,@PC00001                                        0574
         ST    @05,@AL00001                                        0574
         LA    @15,MSGPTR                                          0574
         ST    @15,@AL00001+4                                      0574
         L     @15,GDTFSP(,@05)                                    0574
         LA    @01,@AL00001                                        0574
         BALR  @14,@15                                             0574
*         END;                      /*                       @Y30LB11*/
*                                                                  0575
*       /*************************************************************/
*       /*                                                           */
*       /* IF CARTRIDGES WERE NOT SCRATCHED SUCCESSFULLY, HANDLE IT. */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0576
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
*                                                                  0576
         B     @RC00556                                            0576
@RF00556 DS    0H                                                  0577
*           /*********************************************************/
*           /*                                                       */
*           /* IF MSC FAILED, SSCMSG IS CALLED TO PRINT THE MESSAGE  */
*           /* CORRESPONDING TO THE REASON CODE.             @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0577
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0577
         BNE   @RF00577                                            0577
*             CALL SSCMSG(REASONCD);/*                       @Y30LB11*/
*                                                                  0578
         LA    @04,REASONCD                                        0578
         ST    @04,@AL00001                                        0578
         LA    @01,@AL00001                                        0578
         BAL   @14,SSCMSG                                          0578
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE MESSAGE: ** CARTS CSN (CSN)         @Y30LB11*/
*           /* NOT SCRATCHED FOR (VOLSER).                   @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0579
*           DARGAREA=''B;           /*                       @Y30LB11*/
@RF00577 XC    DARGAREA(36),DARGAREA                               0579
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0580
         MVC   DARGSMOD(3,@15),@CC01131                            0580
*           DARGSENT=MSG2752I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'03'                                 0581
*           DARGDBP=ADDR(BASCSN1);  /*                       @Y30LB11*/
         LA    @14,BASCSN1(,BASEVPTR)                              0582
         ST    @14,DARGDBP(,@15)                                   0582
*           DARGILP=LENGTH(BASCSN1);/*                       @Y30LB11*/
         LA    @14,12                                              0583
         STH   @14,DARGILP(,@15)                                   0583
*           DARGCNT=2;              /*                       @Y30LB11*/
         LA    @09,2                                               0584
         STH   @09,DARGCNT(,@15)                                   0584
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/
         MVC   DARGINS(2,@15),@CH00213                             0585
*           DARGINL(1)=LENGTH(BASCSN2);/*                    @Y30LB11*/
         STH   @14,DARGINL(,@15)                                   0586
*           DARGDTM(1)=ADDR(BASCSN2);/*                      @Y30LB11*/
         LA    @14,BASCSN2(,BASEVPTR)                              0587
         ST    @14,DARGDTM(,@15)                                   0587
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/
         STH   @09,DARGINS+8(,@15)                                 0588
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/
         MVC   DARGINL+8(2,@15),@CH00150                           0589
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/
         L     @05,@PC00001+4                                      0590
         L     @05,FDTPTR(,@05)                                    0590
         LA    @05,VOLVAL(,@05)                                    0590
         ST    @05,DARGDTM+8(,@15)                                 0590
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
*                                                                  0591
         L     @05,@PC00001                                        0591
         ST    @05,@AL00001                                        0591
         LA    @15,@CF00111                                        0591
         ST    @15,@AL00001+4                                      0591
         LA    @15,DDSTRU                                          0591
         ST    @15,@AL00001+8                                      0591
         MVI   @AL00001+8,X'80'                                    0591
         L     @15,GDTPRT(,@05)                                    0591
         LA    @01,@AL00001                                        0591
         BALR  @14,@15                                             0591
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE RETURN CODE TO 4.                     @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0592
*           BPROCOND=4;             /*                       @Y30LB11*/
         LA    BPROCOND,4                                          0592
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0594
@RC00556 DS    0H                                                  0595
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCSV01.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0595
*   RETURN CODE(BPROCOND);          /*                       @Y30LB11*/
@RF00530 LR    @15,BPROCOND                                        0595
         L     @14,@SA00004                                        0595
         LM    @00,@12,@SA00004+8                                  0595
         BR    @14                                                 0595
*   END BASEPROC;                   /*                       @Y30LB11*/
*                                                                  0597
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - CHKVTOC                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/
*/*            FOR AN EMPTY VTOC.                            @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE VS1AGL MAPPING MACRO IS INITIALIZED.         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/
*/*          UCLOSERR IS SET ON IF ERROR CLOSING VTOC        @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*          4 - VTOC WAS NOT EMPTY                          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0597
*CHKVTOC:                                                          0597
*   PROC;                           /*                       @Y30LB11*/
CHKVTOC  STM   @14,@12,@SA00005                                    0597
*   DCL                                                            0598
*     CHKCOND FIXED(15);            /*                       @Y30LB11*/
*                                                                  0599
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO CHKVTOC PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0599
*   OLDERID2=NEWERID2;                                             0599
         L     @05,@PC00001                                        0599
         L     @02,GDTTR2(,@05)                                    0599
         MVC   @TS00001(95),NEWERID2(@02)                          0599
         MVC   OLDERID2(95,@02),@TS00001                           0599
*   NEWID2='SVCV';                  /*                       @Y30LB11*/
*                                                                  0600
         MVC   NEWID2(4,@02),@CC01212                              0600
*   /*****************************************************************/
*   /*                                                               */
*   /* CHKVTOC RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0601
*   CHKCOND=0;                      /*                       @Y30LB11*/
*                                                                  0601
         SLR   CHKCOND,CHKCOND                                     0601
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE VS1AGL MAPPING MACRO FOR CALL TO IDCVS01. NO VSAM  */
*   /* NOR NON-VSAM DATA SETS SHOULD BE FOUND AND THE VOLUME SHOULD  */
*   /* BE RESERVED PRIOR TO CHECKING THE VTOC.               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   VSNOVSAM=ON;                    /*                       @Y30LB11*/
*   VSNONONV=ON;                    /*                       @Y30LB11*/
         LA    @02,VSAGAREA                                        0603
         OI    VSNOVSAM(@02),B'10100000'                           0603
*   VSVOLP=ADDR(VOLVAL);            /*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0604
         L     @01,FDTPTR(,@15)                                    0604
         LA    @15,VOLVAL(,@01)                                    0604
         ST    @15,VSVOLP(,@02)                                    0604
*   VSRES=ON;                       /*                       @Y30LB11*/
         OI    VSRES(@02),B'10000000'                              0605
*   VSUCBP=ADDR(UCBPTR);            /*                       @Y30LB11*/
*                                                                  0606
         LA    @15,UCBPTR                                          0606
         ST    @15,VSUCBP(,@02)                                    0606
*   /*****************************************************************/
*   /*                                                               */
*   /* SECURITY CHECK                                        @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0607
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*      @Y30LB11*/
         ST    @05,@AL00001                                        0607
         LA    @15,@CC01213                                        0607
         ST    @15,@AL00001+4                                      0607
         LA    @15,SECCHECK                                        0607
         ST    @15,@AL00001+8                                      0607
         ST    @02,@AL00001+12                                     0607
         MVI   @AL00001+12,X'80'                                   0607
         L     @15,GDTCAL(,@05)                                    0607
         LA    @01,@AL00001                                        0607
         BALR  @14,@15                                             0607
*   RESPECIFY                                                      0608
*     RTNREG RSTD;                                                 0608
*   TESTRC=RTNREG;                                                 0609
         LR    TESTRC,RTNREG                                       0609
*   RESPECIFY                                                      0610
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS 4, THE VTOC IS NOT EMPTY AND    @Y30LB11*/
*   /* A BAD RETURN CODE IS SET.                             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0611
*   IF TESTRC=4 THEN                /*                       @Y30LB11*/
         LA    @05,4                                               0611
         CR    TESTRC,@05                                          0611
         BNE   @RF00611                                            0611
*     CHKCOND=4;                    /*                       @Y30LB11*/
*                                                                  0612
         LR    CHKCOND,@05                                         0612
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VSIOP FIELD IS NOT ZERO THEN THE VTOC NEEDS TO @Y30LB11*/
*   /* BE CLOSED. THE UCLOSE UMACRO IS ISSUED.               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0613
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB11*/
@RF00611 LA    @05,VSAGAREA                                        0613
         L     @15,VSIOP(,@05)                                     0613
         LTR   @15,@15                                             0613
         BZ    @RF00613                                            0613
*     DO;                           /*                       @Y30LB11*/
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB11*/
         L     @02,@PC00001                                        0615
         ST    @02,@AL00001                                        0615
         LA    @05,VSIOP(,@05)                                     0615
         ST    @05,@AL00001+4                                      0615
         MVI   @AL00001+4,X'80'                                    0615
         L     @15,GDTCLS(,@02)                                    0615
         LA    @01,@AL00001                                        0615
         BALR  @14,@15                                             0615
*       RESPECIFY                                                  0616
*         RTNREG RSTD;                                             0616
*       TESTRC=RTNREG;                                             0617
         LR    TESTRC,RTNREG                                       0617
*       RESPECIFY                                                  0618
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0618
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CLOSE FAILED, THE UCLOSERR FLAG IS SET ON. @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0619
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0619
         BNE   @RF00619                                            0619
*         UCLOSERR=ON;              /*                       @Y30LB11*/
         OI    UCLOSERR,B'00100000'                                0620
*     END;                          /*                       @Y30LB11*/
*                                                                  0621
@RF00619 DS    0H                                                  0622
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO BASECHK.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*   RETURN CODE(CHKCOND);           /*                       @Y30LB11*/
@RF00613 LR    @15,CHKCOND                                         0622
         L     @14,@SA00005                                        0622
         LM    @00,@12,@SA00005+8                                  0622
         BR    @14                                                 0622
*   END CHKVTOC;                    /*                       @Y30LB11*/
*                                                                  0624
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - COPYPROC                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO SCRATCH    @Y30LB11*/
*/*            A SPECIFIC COPY VOLUME.                       @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/
*/*         TO READ THE SPECIFIED COPY VOLUME RECORD.        @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/
*/*          SCRDFLG IS SET ON IF THE COPY WAS SCRATCHED.    @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - COPYPROC WAS UNSUCCESSFUL, COPY RECORD      @Y30LB11*/
*/*              COULD NOT BE READ, OR COPY WAS NOT          @Y30LB11*/
*/*              SCRATCHED.                                  @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0624
*COPYPROC:                                                         0624
*   PROC;                           /*                       @Y30LB11*/
COPYPROC STM   @14,@12,@SA00006                                    0624
*   DCL                                                            0625
*     COPYCOND FIXED(15);           /*                       @Y30LB11*/
*                                                                  0626
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO COPYPROC PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*   OLDERID2=NEWERID2;                                             0626
         L     @15,@PC00001                                        0626
         L     @15,GDTTR2(,@15)                                    0626
         MVC   @TS00001(95),NEWERID2(@15)                          0626
         MVC   OLDERID2(95,@15),@TS00001                           0626
*   NEWID2='SVCP';                  /*                       @Y30LB11*/
*                                                                  0627
         MVC   NEWID2(4,@15),@CC01218                              0627
*   /*****************************************************************/
*   /*                                                               */
*   /* COPYPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0628
*   COPYCOND=0;                     /*                       @Y30LB11*/
*                                                                  0628
         SLR   @15,@15                                             0628
         LR    COPYCOND,@15                                        0628
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION TO GET COPYV RECORD                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0629
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/
         L     @14,RVVIPTR                                         0629
         OI    RVVCPYRC(@14),B'00100000'                           0629
*   RVVRDR=ON;                      /*                       @Y30LB11*/
         OI    RVVRDR(@14),B'10000000'                             0630
*   RVVSDTE=ON;                     /*                       @Y30LB11*/
         OI    RVVSDTE(@14),B'00100000'                            0631
*   CVD(DATEVAL,RVVCDATE);          /*                       @Y30LB11*/
         L     @09,@PC00001+4                                      0632
         L     @01,FDTPTR+12(,@09)                                 0632
         L     @08,DATEVAL(,@01)                                   0632
         CVD   @08,@TS00001                                        0632
         MVC   RVVCDATE(4,@14),@TS00001+4                          0632
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/
         ST    COPYVPTR,RVVRTBUF(,@14)                             0633
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/
*                                                                  0634
         MVC   RVVBUFLN(2,@14),@CH01285                            0634
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A COPY NUMBER IS SPECIFIED, THE SEQUENCE SWITCH AND        */
*   /* SEQUENCE NUMBER ARE SET.                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0635
*   IF ADDR(SEQ)^=NULLPTR THEN      /*                       @Y30LB11*/
         L     @09,FDTPTR+16(,@09)                                 0635
         CR    @09,@15                                             0635
         BE    @RF00635                                            0635
*     DO;                           /*                       #Y30LB11*/
*       RVVSSEQ=ON;                 /*                       #Y30LB11*/
         OI    RVVSSEQ(@14),B'00010000'                            0637
*       RVVRDSEQ=SEQVAL;            /*                       #Y30LB11*/
         MVC   RVVRDSEQ(1,@14),SEQVAL+3(@09)                       0638
*     END;                          /*                       @Y30LB11*/
*                                                                  0639
*   /*****************************************************************/
*   /*                                                               */
*   /* SYMBOLIC DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO.   */
*   /*                                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0640
*   IF GDTDBG=NULLPTR THEN                                         0640
@RF00635 L     @15,@PC00001                                        0640
         L     @15,GDTDBG(,@15)                                    0640
         LTR   @15,@15                                             0640
         BZ    @RT00640                                            0640
*     ;                                                            0641
*   ELSE                                                           0642
*     DO;                                                          0642
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0643
*       DMPITMNM='RVVI';                                           0644
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0644
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0644
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0644
*       DMPITMPT=ADDR(RVVI);                                       0645
         L     @03,RVVIPTR                                         0645
         ST    @03,DMPITMPT(,DMPINDEX)                             0645
*       DMPITMLN=LENGTH(RVVI);                                     0646
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0646
*       DMPITMTP='H';                                              0647
         MVI   DMPITMTP(DMPINDEX),C'H'                             0647
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0648
*                                                                  0648
         AL    DMPINDEX,@CF00464                                   0648
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0649
*       DMPTRM=DMPTRMVL;                                           0649
         MVI   DMPTRM(DMPINDEX),X'FF'                              0649
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0651
@RT00640 L     @15,@PC00001                                        0651
         L     @15,GDTDBG(,@15)                                    0651
         LTR   @15,@15                                             0651
         BZ    @RT00651                                            0651
*     ;                                                            0652
*   ELSE                                                           0653
*     CALL IDCDB010(GDTTBL,'SVRV',ADDR(DUMPAREA));/*         @Y30LB11*/
         L     @15,@PC00001                                        0653
         ST    @15,@AL00001                                        0653
         LA    @14,@CC01220                                        0653
         ST    @14,@AL00001+4                                      0653
         LA    @14,DUMPAREA                                        0653
         ST    @14,@AFTEMPS+12                                     0653
         LA    @14,@AFTEMPS+12                                     0653
         ST    @14,@AL00001+8                                      0653
         MVI   @AL00001+8,X'80'                                    0653
         L     @15,GDTDBG(,@15)                                    0653
         LA    @01,@AL00001                                        0653
         BALR  @14,@15                                             0653
*                                                                  0654
*   /*****************************************************************/
*   /*                                                               */
*   /* USSC MACRO TO GET COPYV RECORD                        @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0654
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/
@RT00651 L     @02,@PC00001                                        0654
         ST    @02,@AL00001                                        0654
         LA    @15,VVIC                                            0654
         ST    @15,@AL00001+4                                      0654
         LA    @15,RVVIPTR                                         0654
         ST    @15,@AL00001+8                                      0654
         LA    @15,REASONCD                                        0654
         ST    @15,@AL00001+12                                     0654
         MVI   @AL00001+12,X'80'                                   0654
         L     @15,GDTSSC(,@02)                                    0654
         LA    @01,@AL00001                                        0654
         BALR  @14,@15                                             0654
*   RESPECIFY                                                      0655
*     RTNREG RSTD;                                                 0655
*   TESTRC=RTNREG;                                                 0656
         LR    TESTRC,RTNREG                                       0656
*   RESPECIFY                                                      0657
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0657
*   /*****************************************************************/
*   /*                                                               */
*   /* IF READ OF THE RECORD FAILED, INVOKE SSCMSG TO PRINT AN ERROR */
*   /* MESSAGE CORRESPONDING TO THE REASON CODE.             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   IF TESTRC=4 THEN                /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0658
         BNE   @RF00658                                            0658
*     DO;                           /*                       @Y30LB11*/
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/
         LA    @15,REASONCD                                        0660
         ST    @15,@AL00001                                        0660
         LA    @01,@AL00001                                        0660
         BAL   @14,SSCMSG                                          0660
*       RESPECIFY                                                  0661
*         RTNREG RSTD;                                             0661
*       TESTRC=RTNREG;                                             0662
         LR    TESTRC,RTNREG                                       0662
*       RESPECIFY                                                  0663
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*       COPYCOND=4;                 /*                       @Y30LB11*/
         LA    COPYCOND,4                                          0664
*     END;                          /*                       @Y30LB11*/
*                                                                  0665
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE READ OF THE RECORD WAS SUCCESSFUL, CALL SCRCOPY TO     */
*   /* SCRATCH THE COPY AND ITS VOLUME RECORD.               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0666
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00658                                            0666
@RF00658 DS    0H                                                  0667
*       CALL SCRCOPY(COMTBL);       /*                       @Y30LB11*/
         LA    @15,COMTBL                                          0667
         ST    @15,@AL00001                                        0667
         LA    @01,@AL00001                                        0667
         BAL   @14,SCRCOPY                                         0667
*       RESPECIFY                                                  0668
*         RTNREG RSTD;                                             0668
*       TESTRC=RTNREG;                                             0669
         LR    TESTRC,RTNREG                                       0669
*       RESPECIFY                                                  0670
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0670
*       /*************************************************************/
*       /*                                                           */
*       /* IF SCRCOPY WAS SUCCESSFUL, SET THE SCRDFLG ON,    @Y30LB11*/
*       /* OTHERWISE SET THE RETURN CODE TO 4.               @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0671
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0671
         BNZ   @RF00671                                            0671
*         SCRDFLG=ON;               /*                       @Y30LB11*/
         OI    SCRDFLG,B'01000000'                                 0672
*       ELSE                        /*                       @Y30LB11*/
*         COPYCOND=4;               /*                       @Y30LB11*/
         B     @RC00671                                            0673
@RF00671 LA    COPYCOND,4                                          0673
*     END;                          /*                       @Y30LB11*/
*                                                                  0674
@RC00671 DS    0H                                                  0675
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCSV01.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0675
*   RETURN CODE(COPYCOND);          /*                       @Y30LB11*/
@RC00658 LR    @15,COPYCOND                                        0675
         L     @14,@SA00006                                        0675
         LM    @00,@12,@SA00006+8                                  0675
         BR    @14                                                 0675
*   END COPYPROC;                   /*                       @Y30LB11*/
*                                                                  0677
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0677
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0677
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00007                                    0677
         MVC   @PC00007(8),0(@01)                                  0677
*                                   /*                       @Y30LB39*/
*                                                                  0678
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0678
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0678
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0678
*                                   /*                       @Y30LB39*/
*   DCL                                                            0678
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0679
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0679
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0680
*                                   /*                       @Y30LB39*/
*   DCL                                                            0680
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0681
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0681
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0682
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0682
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0682
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0683
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0683
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0683
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0684
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0684
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0684
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0685
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0685
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0685
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0686
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0686
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0687
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0687
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0687
         L     @15,@PC00001                                        0687
         L     @14,GDTTR2(,@15)                                    0687
         MVC   @TS00001(95),NEWERID2(@14)                          0687
         MVC   OLDERID2(95,@14),@TS00001                           0687
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0688
         MVC   NEWID2(4,@14),@CC01241                              0688
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0689
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0689
         LA    @14,SSDRGLT                                         0689
         ST    @14,SSDLPTR                                         0689
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0690
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0690
         L     @09,@PC00007                                        0690
         L     @09,SSRCODE(,@09)                                   0690
         LTR   @09,@09                                             0690
         BNP   @RF00690                                            0690
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0691
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0692
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0692
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0693
         ST    @03,DARGRETP(,@14)                                  0693
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            0694
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 0695
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0696
         MVC   DARGRETL(2,@14),@CH01289                            0696
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0697
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0697
         ST    @15,@AL00001                                        0697
         LA    @03,@CF00111                                        0697
         ST    @03,@AL00001+4                                      0697
         LA    @03,SSDLPTR                                         0697
         ST    @03,@AL00001+8                                      0697
         MVI   @AL00001+8,X'80'                                    0697
         L     @15,GDTPRT(,@15)                                    0697
         LA    @01,@AL00001                                        0697
         BALR  @14,@15                                             0697
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0698
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0698
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   0699
@DL00699 DS    0H                                                  0700
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00213                                   0700
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0701
@DE00699 L     @03,@PC00007                                        0701
         LR    @15,ENTRYNUM                                        0701
         ALR   @15,@15                                             0701
         LH    @15,SSARRAY-2(@15)                                  0701
         CH    @15,SSRHALF(,@03)                                   0701
         BE    @DC00699                                            0701
         SLR   @14,@14                                             0701
         CR    @15,@14                                             0701
         BNE   @DL00699                                            0701
@DC00699 DS    0H                                                  0702
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0702
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0702
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         0703
         MVC   DARGSMOD(3,@09),SSMODSS0                            0703
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             0704
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             0705
         BNE   @RF00705                                            0705
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   0707
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             0708
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0711
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0711
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00690                                            0711
@RF00690 DS    0H                                                  0712
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0712
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         0713
         MVC   DARGSMOD(3,@15),SSMODCM0                            0713
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            0714
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00007+4                                      0715
         ST    @14,DARGDBP(,@15)                                   0715
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00213                             0716
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0717
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0718
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0718
@RC00690 L     @15,@PC00001                                        0718
         ST    @15,@AL00001                                        0718
         LA    @14,@CF00111                                        0718
         ST    @14,@AL00001+4                                      0718
         LA    @14,SSDLPTR                                         0718
         ST    @14,@AL00001+8                                      0718
         MVI   @AL00001+8,X'80'                                    0718
         L     @15,GDTPRT(,@15)                                    0718
         LA    @01,@AL00001                                        0718
         BALR  @14,@15                                             0718
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0719
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0719
         L     @14,@SA00007                                        0719
         LM    @00,@12,@SA00007+8                                  0719
         BR    @14                                                 0719
*   END SSCMSG;                     /*                       @Y30LB39*/
*                                                                  0721
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - SCRCOPY                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE PRINCIPLE FUNCTION OF THIS ROUTINE IS TO  @Y30LB11*/
*/*            SCRATCH AN MSS COPY VOLUME.                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0088I CARTRIDGES CSN (CSN) SCRATCHED FOR   @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0098I ** LOCATION OF VOLUME: (LOCATION)    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2076I ** CART CSN (CSN) NOT IN MSF FOR     @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2087I ** CART CSN (CSN) NOT SCRATCHED FOR  @Y30LB11*/
*/*            COPY YYDDD.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - A PARAMETER CONSISTING OF A SINGLE BYTE.  THE    @Y30LB11*/
*/*         FIRST BIT OF THE BYTE IS SET TO '1' BY SCRCOPY   @Y30LB11*/
*/*         AN ERROR OCCURS UPDATING THE INVENTORY.          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*         THE COPY RECORD MUST HAVE BEEN READ AND THE      @Y30LB11*/
*/*         COPYV MAPPING MACRO BASED ON THE RECORD PRIOR TO @Y30LB11*/
*/*         THE CALL TO SCRCOPY.   FURTHER, THE DEFLIST      @Y30LB11*/
*/*         MUST HAVE BEEN INCLUDED PRIOR TO THE CALL TO     @Y30LB11*/
*/*         SCRCOPY.                                         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - FIRST BIT OF INPUT BYTE SET IF INVENTORY ERROR. @Y30LB11*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - CARTRIDGE OR CARTRIDGES FOR COPY VOLUME     @Y30LB11*/
*/*              SCRATCHED SUCCESSFULLY.                     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - CARTRIDGES NOT IN LIBRARY, OR DSM FAILURE   @Y30LB11*/
*/*              OCCURRED.                                   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE        @Y30LB11*/
*/*              FOR ECB/MESSAGE AREA.                       @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0721
*SCRCOPY:                           /*                       @Y30LB11*/
*   PROCEDURE(SCINPUT);             /*                       @Y30LB11*/
SCRCOPY  STM   @14,@12,@SA00008                                    0721
         MVC   @PC00008(4),0(@01)                                  0721
*   DCL                                                            0722
*     SCCMPTR PTR(31);              /* PTR TO ECB/MSG AREA   @Y30LB11*/
*   DCL                                                            0723
*     SCECBCD FIXED(8);             /* SCRCOPY ECB CODE      @Y30LB11*/
*   DCL                                                            0724
*     SCRCOND FIXED(15);            /* SCRCOPY COND CODE     @Y30LB11*/
*   DCL                                                            0725
*     SCMSGCD PTR(31);              /* SSCMSG REASON CODE    @Y30LB11*/
*   DCL                                                            0726
*     SCMSGPTR PTR(31);             /* MESSAGE AREA POINTER  @Y30LB11*/
*   DCL                                                            0727
*     SCDEFLST CHAR(LENGTH(DEFLIST));/* SCRCOPY DEFLIST      @Y30LB11*/
*   DCL                                                            0728
*     SCDEFPTR PTR(31);             /* DEFLIST POINTER       @Y30LB11*/
*   DCL                                                            0729
*     SCDDSTRU PTR(31);             /* DARGLIST POINTER      @Y30LB11*/
*                                                                  0729
*   /*****************************************************************/
*   /*                                                               */
*   /* DARGLIST WITH UP TO 3 INSERTS                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0730
*   DCL                                                            0730
*     SCDARG CHAR(LENGTH(DARGLIST)+2*(LENGTH(DARGARY)));/*   @Y30LB11*/
*   DCL                                                            0731
*     1 SCINPUT BIT(8),             /* PARAMETER LIST        @Y30LB11*/
*      2 SCERRFLG BIT(1),           /* RETURNED FLAG         @Y30LB11*/
*      2 * BIT(7);                  /* UNUSED                @Y30LB11*/
*                                                                  0731
*   /*****************************************************************/
*   /*                                                               */
*   /* CONSTANT SECTION DECLARATIONS FOR SCRCOPY             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0732
*   DCL                                                            0732
*     1 SCBLANKS CHAR(30) STATIC LOCAL,/* BLANK FIELD        @Y30LB11*/
*      2 *(30) CHAR(1) INIT((30)'40'X);/*                    @Y30LB11*/
*   DCL                                                            0733
*     SCCSN2# FIXED(15) CONSTANT(1);/* CSN2 INSERT           @Y30LB11*/
*   DCL                                                            0734
*     SCDATE# FIXED(15) CONSTANT(2);/* DATE INSERT           @Y30LB11*/
*   DCL                                                            0735
*     SCECBLEN FIXED(15) CONSTANT(4);/* ECB LENGTH           @Y30LB11*/
*   DCL                                                            0736
*     SCNOCSNS BIT(8) CONSTANT('23'X);/* NEITHER CSN FOUND   @Y30LB11*/
*   DCL                                                            0737
*     SCNOCSN1 BIT(8) CONSTANT('26'X);/* CSN1 NOT FOUND      @Y30LB11*/
*   DCL                                                            0738
*     SCNOCSN2 BIT(8) CONSTANT('2A'X);/* CSN2 NOT FOUND      @Y30LB11*/
*   DCL                                                            0739
*     SCCOMMSG CHAR(3) CONSTANT('CM0');/* STATIC TEST MOD    @Y30LB11*/
*   DCL                                                            0740
*     SCM0088I PTR(8) CONSTANT(18); /* CARTS SCRATCHED       @Y30LB11*/
*   DCL                                                            0741
*     SCM0098I PTR(8) CONSTANT(2);  /* LOCATION OF VOLUME    @Y30LB11*/
*   DCL                                                            0742
*     SCM2076I PTR(8) CONSTANT(30); /* CART NOT SCRATCHED    @Y30LB11*/
*   DCL                                                            0743
*     SCM2087I PTR(8) CONSTANT(19); /* CARTS NOT IN LIBRARY  @Y30LB11*/
*                                                                  0744
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO SCRCOPY PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*   OLDERID2=NEWERID2;                                             0744
         L     @15,@PC00001                                        0744
         L     @14,GDTTR2(,@15)                                    0744
         MVC   @TS00001(95),NEWERID2(@14)                          0744
         MVC   OLDERID2(95,@14),@TS00001                           0744
*   NEWID2='SCSC';                  /*                       @Y30LB11*/
*                                                                  0745
         MVC   NEWID2(4,@14),@CC01277                              0745
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION CONSISTS OF ZEROING THE RETURN CODE, ZEROING   */
*   /* THE DEFLIST, AND THE PRINT ARGUMENT LIST.             @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0746
*   SCRCOND=0;                      /*                       @Y30LB11*/
         SLR   @14,@14                                             0746
         LR    SCRCOND,@14                                         0746
*   SCDDSTRU=ADDR(SCDARG);          /*                       @Y30LB11*/
         LA    @09,SCDARG                                          0747
         ST    @09,SCDDSTRU                                        0747
*   SCDEFPTR=ADDR(SCDEFLST);        /*                       @Y30LB11*/
         LA    @08,SCDEFLST                                        0748
         ST    @08,SCDEFPTR                                        0748
*   SCDEFLST=''B;                   /*                       @Y30LB11*/
         XC    SCDEFLST(132),SCDEFLST                              0749
*   SCDARG=''B;                     /*                       @Y30LB11*/
         XC    SCDARG(36),SCDARG                                   0750
*   SCDDSTRU->DARGSMOD=SCCOMMSG;    /* COMMON MESSAGE MODULE @Y30LB11*/
*                                                                  0751
         MVC   DARGSMOD(3,@09),@CC01105                            0751
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE AN INACTIVE VOLUME IS TO BE SCRATCHED AND PICK UP THE*/
*   /* CSN1 FROM THE COPY RECORD.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0752
*   SCDEFPTR->DEFVELTR=ON;          /*                       @Y30LB11*/
         OI    DEFVELTR(@08),B'00001000'                           0752
*   SCDEFPTR->DEFVCSN1=COPCSN1;     /*                       @Y30LB11*/
*                                                                  0753
         MVC   DEFVCSN1(12,@08),COPCSN1(COPYVPTR)                  0753
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE EXECUTING THE ICBDEFV MACRO.  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0754
*   IF GDTDBG=NULLPTR THEN                                         0754
         C     @14,GDTDBG(,@15)                                    0754
         BE    @RT00754                                            0754
*     ;                                                            0755
*   ELSE                                                           0756
*     CALL IDCDB010(GDTTBL,'SCDF'); /*                       @Y30LB11*/
*                                                                  0756
         L     @15,@PC00001                                        0756
         ST    @15,@AL00001                                        0756
         LA    @14,@CC01278                                        0756
         ST    @14,@AL00001+4                                      0756
         MVI   @AL00001+4,X'80'                                    0756
         L     @15,GDTDBG(,@15)                                    0756
         LA    @01,@AL00001                                        0756
         BALR  @14,@15                                             0756
*   /*****************************************************************/
*   /*                                                               */
*   /* THE USSC MACRO IS ISSUED TO EXECUTE THE ICBDEFV MACRO @Y30LB11*/
*   /* TO SCRATCH THE COPY.                                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0757
*   CALL IDCSASS0(GDTTBL,DEFINE,SCDEFPTR,SCMSGCD,SCECBCD,SCMSGPTR);/*
*                                                            @Y30LB11*/
@RT00754 L     @02,@PC00001                                        0757
         ST    @02,@AL00001                                        0757
         LA    @15,DEFINE                                          0757
         ST    @15,@AL00001+4                                      0757
         LA    @15,SCDEFPTR                                        0757
         ST    @15,@AL00001+8                                      0757
         LA    @15,SCMSGCD                                         0757
         ST    @15,@AL00001+12                                     0757
         LA    @15,SCECBCD                                         0757
         ST    @15,@AL00001+16                                     0757
         LA    @15,SCMSGPTR                                        0757
         ST    @15,@AL00001+20                                     0757
         MVI   @AL00001+20,X'80'                                   0757
         L     @15,GDTSSC(,@02)                                    0757
         LA    @01,@AL00001                                        0757
         BALR  @14,@15                                             0757
*   RESPECIFY                                                      0758
*     RTNREG RSTD;                                                 0758
*   TESTRC=RTNREG;                                                 0759
         LR    TESTRC,RTNREG                                       0759
*   RESPECIFY                                                      0760
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0761
*   /*****************************************************************/
*   /*                                                               */
*   /* A RETURN CODE OF 0 OR 12 INDICATES THAT THE MACRO WAS EXECUTED*/
*   /* SUCCESSFULLY.                                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*   IF TESTRC=0×TESTRC=12 THEN      /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0761
         BZ    @RT00761                                            0761
         C     TESTRC,@CF00035                                     0761
         BNE   @RF00761                                            0761
@RT00761 DS    0H                                                  0762
*     DO;                           /*                       @Y30LB11*/
*                                                                  0762
*       /*************************************************************/
*       /*                                                           */
*       /* IF A RETURN CODE OF 12 IS PASSED, SCERRFLG IS SET ON TO   */
*       /* INDICATE THAT THE INVENTORY RECORD WAS NOT UPDATED.       */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*       IF TESTRC=12 THEN           /*                       @Y30LB11*/
         C     TESTRC,@CF00035                                     0763
         BNE   @RF00763                                            0763
*         SCERRFLG=ON;              /*                       @Y30LB11*/
*                                                                  0764
         L     @15,@PC00008                                        0764
         OI    SCERRFLG(@15),B'10000000'                           0764
*       /*************************************************************/
*       /*                                                           */
*       /* THE MESSAGE: CARTRIDGES CSN (CSN) SCRATCHED FOR COPY      */
*       /* YYDDD, IS ISSUED.                                 @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0765
*       SCCMPTR=SCMSGPTR+SCECBLEN;  /*                       @Y30LB11*/
@RF00763 LA    @15,4                                               0765
         L     SCCMPTR,SCMSGPTR                                    0765
         ALR   SCCMPTR,@15                                         0765
*       SCDDSTRU->DARGSENT=SCM0088I;/*                       @Y30LB11*/
         L     @03,SCDDSTRU                                        0766
         MVI   DARGSENT(@03),X'12'                                 0766
*       SCDDSTRU->DARGDBP=ADDR(SCCMPTR->CMCSN1);/*           @Y30LB11*/
         LA    @14,CMCSN1(,SCCMPTR)                                0767
         ST    @14,DARGDBP(,@03)                                   0767
*       SCDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB11*/
         LA    @14,12                                              0768
         STH   @14,DARGILP(,@03)                                   0768
*       SCDDSTRU->DARGCNT=2;        /*                       @Y30LB11*/
         LA    @09,2                                               0769
         STH   @09,DARGCNT(,@03)                                   0769
*       SCDDSTRU->DARGINS(1)=SCCSN2#;/*                      @Y30LB11*/
         MVC   DARGINS(2,@03),@CH00213                             0770
*       SCDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*               @Y30LB11*/
         STH   @14,DARGINL(,@03)                                   0771
*       SCDDSTRU->DARGDTM(1)=ADDR(SCCMPTR->CMCSN2);/*        @Y30LB11*/
         LA    @14,CMCSN2(,SCCMPTR)                                0772
         ST    @14,DARGDTM(,@03)                                   0772
*       SCDDSTRU->DARGINS(2)=SCDATE#;/*                      @Y30LB11*/
         STH   @09,DARGINS+8(,@03)                                 0773
*       SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*              @Y30LB11*/
         STH   @15,DARGINL+8(,@03)                                 0774
*       SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*                @Y30LB11*/
         LA    @02,COPDATE(,COPYVPTR)                              0775
         ST    @02,DARGDTM+8(,@03)                                 0775
*       CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*            @Y30LB11*/
*                                                                  0776
         L     @15,@PC00001                                        0776
         ST    @15,@AL00001                                        0776
         LA    @14,@CF00111                                        0776
         ST    @14,@AL00001+4                                      0776
         LA    @14,SCDDSTRU                                        0776
         ST    @14,@AL00001+8                                      0776
         MVI   @AL00001+8,X'80'                                    0776
         L     @15,GDTPRT(,@15)                                    0776
         LA    @01,@AL00001                                        0776
         BALR  @14,@15                                             0776
*       /*************************************************************/
*       /*                                                           */
*       /* BECAUSE THE MESSAGE AREA POINTER IS SET, AND THE ICBDEFV  */
*       /* MACRO IS SUCCESSFUL, THE UFSPACE IS ISSUED TO FREE THE    */
*       /* ECB/MESSAGE AREA GOTTEN BY THE ICBDEFV MACRO.     @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0777
*       CALL IDCSAFS0(GDTTBL,SCMSGPTR);/*                    @Y30LB11*/
         L     @15,@PC00001                                        0777
         ST    @15,@AL00001                                        0777
         LA    @14,SCMSGPTR                                        0777
         ST    @14,@AL00001+4                                      0777
         L     @15,GDTFSP(,@15)                                    0777
         LA    @01,@AL00001                                        0777
         BALR  @14,@15                                             0777
*     END;                          /*                       @Y30LB11*/
*                                                                  0779
*   /*****************************************************************/
*   /*                                                               */
*   /* A RETURN CODE OF 4 OR 8 INDICATES THAT THE MACRO WAS NOT      */
*   /* EXECUTED SUCCESSFULLY.                                @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0779
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
*                                                                  0779
         B     @RC00761                                            0779
@RF00761 DS    0H                                                  0780
*       /*************************************************************/
*       /*                                                           */
*       /* A RETURN CODE OF 8 FROM THE ICBDEFV MACRO INDICATES THAT  */
*       /* NO CORE WAS AVAILABLE FOR THE ECB/MESSAGE AREA. THE       */
*       /* MESSAGE: ** CART CSN (CSN) NOT SCRATCHED COPY YYDDD, IS   */
*       /* ISSUED AND THE RETURN CODE IS SET TO 8.           @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0780
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/
         C     TESTRC,@CF00173                                     0780
         BNE   @RF00780                                            0780
*         DO;                       /*                       @Y30LB11*/
*           SCDDSTRU->DARGSENT=SCM2087I;/*                   @Y30LB11*/
         L     @15,SCDDSTRU                                        0782
         MVI   DARGSENT(@15),X'13'                                 0782
*           SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*               @Y30LB11*/
         LA    @14,COPCSN1(,COPYVPTR)                              0783
         ST    @14,DARGDBP(,@15)                                   0783
*           SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*             @Y30LB11*/
         LA    @14,12                                              0784
         STH   @14,DARGILP(,@15)                                   0784
*           SCDDSTRU->DARGCNT=2;    /*                       @Y30LB11*/
         LA    @09,2                                               0785
         STH   @09,DARGCNT(,@15)                                   0785
*           SCDDSTRU->DARGINS(1)=SCCSN2#;/*                  @Y30LB11*/
         MVC   DARGINS(2,@15),@CH00213                             0786
*           SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*          @Y30LB11*/
         STH   @14,DARGINL(,@15)                                   0787
*           SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*            @Y30LB11*/
         LA    @14,COPCSN2(,COPYVPTR)                              0788
         ST    @14,DARGDTM(,@15)                                   0788
*           SCDDSTRU->DARGINS(2)=SCDATE#;/*                  @Y30LB11*/
         STH   @09,DARGINS+8(,@15)                                 0789
*           SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*          @Y30LB11*/
         MVC   DARGINL+8(2,@15),@CH00041                           0790
*           SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*            @Y30LB11*/
         LA    @14,COPDATE(,COPYVPTR)                              0791
         ST    @14,DARGDTM+8(,@15)                                 0791
*           CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*        @Y30LB11*/
*                                                                  0792
         L     @15,@PC00001                                        0792
         ST    @15,@AL00001                                        0792
         LA    @14,@CF00111                                        0792
         ST    @14,@AL00001+4                                      0792
         LA    @14,SCDDSTRU                                        0792
         ST    @14,@AL00001+8                                      0792
         MVI   @AL00001+8,X'80'                                    0792
         L     @15,GDTPRT(,@15)                                    0792
         LA    @01,@AL00001                                        0792
         BALR  @14,@15                                             0792
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE RETURN CODE TO 8 INDICATING THAT THE USSC     */
*           /* UMACRO COULD NOT OBTAIN STORAGE FOR THE ECB/MESSAGE   */
*           /* AREA.                                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0793
*           SCRCOND=8;              /*                       @Y30LB11*/
         LA    SCRCOND,8                                           0793
*         END;                      /*                       @Y30LB11*/
*                                                                  0794
*       /*************************************************************/
*       /*                                                           */
*       /* A RETURN CODE OF 4 INDICATES THAT THE ICBDEFV MACRO WAS   */
*       /* EXECUTED, BUT FAILED.                             @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0795
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
*                                                                  0795
         B     @RC00780                                            0795
@RF00780 DS    0H                                                  0796
*           /*********************************************************/
*           /*                                                       */
*           /* THE SSCMSG ROUTINE IS CALLED TO PRINT COMMON MESSAGES */
*           /* FROM IDCTSSS0 AND IDCTSSS1 AS DIRECTED BY THE REASON  */
*           /* CODE PASSED BACK FROM THE ICBDEFV MACRO.      @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0796
*           CALL SSCMSG(SCMSGCD);   /*                       @Y30LB11*/
*                                                                  0796
         LA    @05,SCMSGCD                                         0796
         ST    @05,@AL00001                                        0796
         LA    @01,@AL00001                                        0796
         BAL   @14,SSCMSG                                          0796
*           /*********************************************************/
*           /*                                                       */
*           /* IF EITHER OR BOTH CARTRIDGES ARE NOT IN THE MSF A     */
*           /* MESSAGE INDICATING THAT SITUATION IS PRINTED. @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0797
*           IF SCMSGCD=SCNOCSN1×    /*                       @Y30LB11*/
*               SCMSGCD=SCNOCSN2×   /*                       @Y30LB11*/
*               SCMSGCD=SCNOCSNS THEN/*                      @Y30LB11*/
         L     @05,SCMSGCD                                         0797
         C     @05,@CF01267                                        0797
         BE    @RT00797                                            0797
         C     @05,@CF01269                                        0797
         BE    @RT00797                                            0797
         C     @05,@CF01265                                        0797
         BNE   @RF00797                                            0797
@RT00797 DS    0H                                                  0798
*             DO;                   /*                       @Y30LB11*/
*                                                                  0798
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP TO ISSUE MESSAGE THAT CARTS ARE OUT OF THE */
*               /* MSF.                                      @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0799
*               SCDDSTRU->DARGSENT=SCM2076I;/*               @Y30LB11*/
*                                                                  0799
         L     @05,SCDDSTRU                                        0799
         MVI   DARGSENT(@05),X'1E'                                 0799
*               /*****************************************************/
*               /*                                                   */
*               /* INSERT COPYDATE FROM COPY RECORD          @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0800
*               SCDDSTRU->DARGINS(1)=SCDATE#;/*              @Y30LB11*/
         LA    @15,2                                               0800
         STH   @15,DARGINS(,@05)                                   0800
*               SCDDSTRU->DARGINL(1)=LENGTH(COPDATE);/*      @Y30LB11*/
         MVC   DARGINL(2,@05),@CH00041                             0801
*               SCDDSTRU->DARGDTM(1)=ADDR(COPDATE);/*        @Y30LB11*/
*                                                                  0802
         LA    @14,COPDATE(,COPYVPTR)                              0802
         ST    @14,DARGDTM(,@05)                                   0802
*               /*****************************************************/
*               /*                                                   */
*               /* IF 2 CARTS OUT OF LIBRARY, INSERT 2 CSNS  @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0803
*               IF SCMSGCD=SCNOCSNS THEN                           0803
         CLC   SCMSGCD(4),@CF01265                                 0803
         BNE   @RF00803                                            0803
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/
         LA    @14,COPCSN1(,COPYVPTR)                              0805
         ST    @14,DARGDBP(,@05)                                   0805
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/
         LA    @14,12                                              0806
         STH   @14,DARGILP(,@05)                                   0806
*                   SCDDSTRU->DARGCNT=2;/*                   @Y30LB11*/
         STH   @15,DARGCNT(,@05)                                   0807
*                   SCDDSTRU->DARGINS(2)=SCCSN2#;/*          @Y30LB11*/
         MVC   DARGINS+8(2,@05),@CH00213                           0808
*                   SCDDSTRU->DARGINL(2)=LENGTH(COPCSN2);/*  @Y30LB11*/
         STH   @14,DARGINL+8(,@05)                                 0809
*                   SCDDSTRU->DARGDTM(2)=ADDR(COPCSN2);/*    @Y30LB11*/
         LA    @15,COPCSN2(,COPYVPTR)                              0810
         ST    @15,DARGDTM+8(,@05)                                 0810
*                 END;              /*                       @Y30LB11*/
*                                                                  0811
*               /*****************************************************/
*               /*                                                   */
*               /* IF CSN1 OUT OF LIBRARY, INSERT CSN1       @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0812
*               IF SCMSGCD=SCNOCSN1 THEN                           0812
@RF00803 CLC   SCMSGCD(4),@CF01267                                 0812
         BNE   @RF00812                                            0812
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/
         L     @05,SCDDSTRU                                        0814
         LA    @15,COPCSN1(,COPYVPTR)                              0814
         ST    @15,DARGDBP(,@05)                                   0814
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/
         MVC   DARGILP(2,@05),@CH00035                             0815
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/
         MVC   DARGCNT(2,@05),@CH00213                             0816
*                 END;              /*                       @Y30LB11*/
*                                                                  0817
*               /*****************************************************/
*               /*                                                   */
*               /* IF CSN2 OUT OF LIBRARY, INSERT CSN2       @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0818
*               IF SCMSGCD=SCNOCSN2 THEN                           0818
@RF00812 CLC   SCMSGCD(4),@CF01269                                 0818
         BNE   @RF00818                                            0818
*                 DO;               /*                       @Y30LB11*/
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN2);/*       @Y30LB11*/
         L     @05,SCDDSTRU                                        0820
         LA    @15,COPCSN2(,COPYVPTR)                              0820
         ST    @15,DARGDBP(,@05)                                   0820
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN2);/*     @Y30LB11*/
         MVC   DARGILP(2,@05),@CH00035                             0821
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/
         MVC   DARGCNT(2,@05),@CH00213                             0822
*                 END;              /*                       @Y30LB11*/
*                                                                  0823
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE THE UPRINT MACRO TO PRINT THE MESSAGE       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0824
*                                   /*                       @Y30LB11*/
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/
*                                                                  0824
@RF00818 L     @05,@PC00001                                        0824
         ST    @05,@AL00001                                        0824
         LA    @15,@CF00111                                        0824
         ST    @15,@AL00001+4                                      0824
         LA    @15,SCDDSTRU                                        0824
         ST    @15,@AL00001+8                                      0824
         MVI   @AL00001+8,X'80'                                    0824
         L     @15,GDTPRT(,@05)                                    0824
         LA    @01,@AL00001                                        0824
         BALR  @14,@15                                             0824
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE LOCATION OF THE VOLUME HAS BEEN DETERMINED */
*               /* THE MESSAGE: ** LOCATION OF VOLUME: (LOCATION), IS*/
*               /* ISSUED.                                   @Y30LB11*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0825
*               IF COPDEST^=SCBLANKS THEN/*                  @Y30LB11*/
         CLC   COPDEST(30,COPYVPTR),SCBLANKS                       0825
         BE    @RF00825                                            0825
*                 DO;               /*                       @Y30LB11*/
*                   SCDARG=''B;     /*                       @Y30LB11*/
         XC    SCDARG(36),SCDARG                                   0827
*                   SCDDSTRU->DARGSENT=SCM0098I;/*           @Y30LB11*/
         L     @05,SCDDSTRU                                        0828
         MVI   DARGSENT(@05),X'02'                                 0828
*                   SCDDSTRU->DARGSMOD=SCCOMMSG;/*           @Y30LB11*/
         MVC   DARGSMOD(3,@05),@CC01105                            0829
*                   SCDDSTRU->DARGDBP=ADDR(COPDEST);/*       @Y30LB11*/
         LA    @15,COPDEST(,COPYVPTR)                              0830
         ST    @15,DARGDBP(,@05)                                   0830
*                   SCDDSTRU->DARGILP=LENGTH(COPDEST);/*     @Y30LB11*/
         MVC   DARGILP(2,@05),@CH00909                             0831
*                   CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*      0832
*                                                            @Y30LB11*/
         L     @05,@PC00001                                        0832
         ST    @05,@AL00001                                        0832
         LA    @15,@CF00111                                        0832
         ST    @15,@AL00001+4                                      0832
         LA    @15,SCDDSTRU                                        0832
         ST    @15,@AL00001+8                                      0832
         MVI   @AL00001+8,X'80'                                    0832
         L     @15,GDTPRT(,@05)                                    0832
         LA    @01,@AL00001                                        0832
         BALR  @14,@15                                             0832
*                 END;              /*                       @Y30LB11*/
*             END;                  /*                       @Y30LB11*/
*                                                                  0834
*           /*********************************************************/
*           /*                                                       */
*           /* A RETURN CODE OF 4 FROM THE ICBDEFV MACRO INDICATES   */
*           /* THAT THE ICBDEFV MACRO FAILED. A MESSAGE INDICATING   */
*           /* THAT COPY VOLUMES WERE NOT SCRATCHED, IS PRINTED.     */
*           /*                                               @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0835
*           ELSE                                                   0835
*             DO;                   /*                       @Y30LB11*/
         B     @RC00797                                            0835
@RF00797 DS    0H                                                  0836
*               SCDDSTRU->DARGSENT=SCM2087I;/*               @Y30LB11*/
         L     @05,SCDDSTRU                                        0836
         MVI   DARGSENT(@05),X'13'                                 0836
*               SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*           @Y30LB11*/
         LA    @15,COPCSN1(,COPYVPTR)                              0837
         ST    @15,DARGDBP(,@05)                                   0837
*               SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*         @Y30LB11*/
         LA    @15,12                                              0838
         STH   @15,DARGILP(,@05)                                   0838
*               SCDDSTRU->DARGCNT=2;/*                       @Y30LB11*/
         LA    @14,2                                               0839
         STH   @14,DARGCNT(,@05)                                   0839
*               SCDDSTRU->DARGINS(1)=SCCSN2#;/*              @Y30LB11*/
         MVC   DARGINS(2,@05),@CH00213                             0840
*               SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*      @Y30LB11*/
         STH   @15,DARGINL(,@05)                                   0841
*               SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*        @Y30LB11*/
         LA    @15,COPCSN2(,COPYVPTR)                              0842
         ST    @15,DARGDTM(,@05)                                   0842
*               SCDDSTRU->DARGINS(2)=SCDATE#;/*              @Y30LB11*/
         STH   @14,DARGINS+8(,@05)                                 0843
*               SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*      @Y30LB11*/
         MVC   DARGINL+8(2,@05),@CH00041                           0844
*               SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*        @Y30LB11*/
         LA    @15,COPDATE(,COPYVPTR)                              0845
         ST    @15,DARGDTM+8(,@05)                                 0845
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/
         L     @05,@PC00001                                        0846
         ST    @05,@AL00001                                        0846
         LA    @15,@CF00111                                        0846
         ST    @15,@AL00001+4                                      0846
         LA    @15,SCDDSTRU                                        0846
         ST    @15,@AL00001+8                                      0846
         MVI   @AL00001+8,X'80'                                    0846
         L     @15,GDTPRT(,@05)                                    0846
         LA    @01,@AL00001                                        0846
         BALR  @14,@15                                             0846
*             END;                  /*                       @Y30LB11*/
*                                                                  0847
*           /*********************************************************/
*           /*                                                       */
*           /* INDICATE THAT SCRCOPY FAILED WITH A RETURN CODE OF 4. */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0848
*                                   /*                       @Y30LB11*/
*           SCRCOND=4;              /*                       @Y30LB11*/
@RC00797 LA    SCRCOND,4                                           0848
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0850
@RC00780 DS    0H                                                  0851
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO SCRCOPY CALLER                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0851
*   RETURN CODE(SCRCOND);           /*                       @Y30LB11*/
@RC00761 LR    @15,SCRCOND                                         0851
         L     @14,@SA00008                                        0851
         LM    @00,@12,@SA00008+8                                  0851
         BR    @14                                                 0851
*   END SCRCOPY;                    /*                       @Y30LB11*/
*                                                                  0853
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - UNITCHK                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/
*/*            OR ASSIGN A UNIT.                             @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE FDT, CKAGL, VS1AGL, MDAGL, AND ALLAGL        @Y30LB11*/
*/*         MACROS ARE USED AS INPUT TO THE UNITCHK ROUTINE. @Y30LB11*/
*/*         NOVTOCCK IS ON IF THE VTOC NEEDS TO BE CHECKED.  @Y30LB11*/
*/*         IF IT IS ON, UNITCHK ASSIGNS A UNIT FOR MOUNTING @Y30LB11*/
*/*         THE VOLUME.                                      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS PASSED IN REGISTER 15.           @Y30LB11*/
*/*          VS1AGL AND MDAGL ARE INITIALIZED WITH DDNAME    @Y30LB11*/
*/*          ALLOCFLG SET IF UNIT WAS DYNAMICALLY ALLOCATED. @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - UNIT SPECIFIED WAS NOT A VIRTUAL UNIT,      @Y30LB11*/
*/*              OR DID NOT HAVE EXCLUSIVE CONTROL, OR       @Y30LB11*/
*/*              UNIT COULD NOT BE OBTAINED.                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0853
*UNITCHK:                                                          0853
*   PROC;                           /*                       @Y30LB11*/
UNITCHK  STM   @14,@12,@SA00009                                    0853
*   DCL                                                            0854
*     UNITCOND FIXED(15);           /*                       @Y30LB11*/
*                                                                  0855
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO UNITCHK PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0855
*   OLDERID2=NEWERID2;                                             0855
         L     @15,@PC00001                                        0855
         L     @14,GDTTR2(,@15)                                    0855
         MVC   @TS00001(95),NEWERID2(@14)                          0855
         MVC   OLDERID2(95,@14),@TS00001                           0855
*   NEWID2='SVUC';                  /*                       @Y30LB11*/
*                                                                  0856
         MVC   NEWID2(4,@14),@CC01283                              0856
*   /*****************************************************************/
*   /*                                                               */
*   /* UNITCHK RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0857
*   UNITCOND=0;                     /*                       @Y30LB11*/
         SLR   @14,@14                                             0857
         LR    UNITCOND,@14                                        0857
*   UCBPTR=NULLPTR;                 /*                       @YD00175*/
         ST    @14,UCBPTR                                          0858
*                                                                  0859
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THERE IS A FILE PARAMETER SPECIFIED. IF SO,  @Y30LB11*/
*   /* INITIALIZE THE CKAGL MAPPING MACRO TO CHECK THE UNIT  @Y30LB11*/
*   /* FOR VIRTUAL DEVICE TYPE                               @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0859
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Y30LB11*/
         L     @09,@PC00001+4                                      0859
         L     @09,FDTPTR+20(,@09)                                 0859
         CR    @09,@14                                             0859
         BE    @RF00859                                            0859
*     DO;                           /*                       @Y30LB11*/
*       UCBPTR=NULLPTR;             /*                       @Y30LB11*/
         ST    @14,UCBPTR                                          0861
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB11*/
         LA    @02,CKAGAREA                                        0862
         LA    @08,UCBPTR                                          0862
         ST    @08,CKUCBPTR(,@02)                                  0862
*       CKDDNAME=FILEVAL;           /*                       @Y30LB11*/
         MVC   CKDDNAME(8,@02),FILEVAL(@09)                        0863
*       CKTESTVT=ON;                /*                       @Y30LB11*/
*                                                                  0864
         OI    CKTESTVT(@02),B'10000000'                           0864
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UMSSUNIT UMACRO.                        @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0865
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB11*/
         ST    @15,@AL00001                                        0865
         LA    @14,CHECK                                           0865
         ST    @14,@AL00001+4                                      0865
         ST    @02,@AL00001+8                                      0865
         MVI   @AL00001+8,X'80'                                    0865
         L     @15,GDTUNT(,@15)                                    0865
         LA    @01,@AL00001                                        0865
         BALR  @14,@15                                             0865
*       RESPECIFY                                                  0866
*         RTNREG RSTD;                                             0866
*       TESTRC=RTNREG;                                             0867
         LR    TESTRC,RTNREG                                       0867
*       RESPECIFY                                                  0868
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0868
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CHECK WAS SUCCESSFUL, SET THE DDNAME IN THE        */
*       /* ARGUMENT LIST FOR IDCVS01(SECURITY CHECK) AND             */
*       /* UMSSUNIT(DEMOUNT).                                @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0869
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0869
         BNZ   @RF00869                                            0869
*         DO;                       /*                       @Y30LB11*/
*           VSFILEP=ADDR(FILEVAL);  /*                       @Y30LB11*/
         LA    @15,VSAGAREA                                        0871
         L     @14,@PC00001+4                                      0871
         L     @09,FDTPTR+20(,@14)                                 0871
         LA    @08,FILEVAL(,@09)                                   0871
         ST    @08,VSFILEP(,@15)                                   0871
*           MDDDNAME=FILEVAL;       /*                       @Y30LB11*/
*                                                                  0872
         LA    @15,MDAGAREA                                        0872
         MVC   MDDDNAME(8,@15),FILEVAL(@09)                        0872
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP TO GET EXCLUSIVE CONTROL               @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0873
*           EXCLUCBP=ADDR(UCBPTR);  /*                       @YD00175*/
         LA    @09,EXCLAREA                                        0873
         LA    @15,UCBPTR                                          0873
         ST    @15,EXCLUCBP(,@09)                                  0873
*           EXCLDDP=ADDR(FILEVAL);  /*                       @YD00175*/
         ST    @08,EXCLDDP(,@09)                                   0874
*           EXCLVOL=VOLVAL;         /*                       @YD00175*/
*                                                                  0875
         L     @01,FDTPTR(,@14)                                    0875
         MVC   EXCLVOL(6,@09),VOLVAL(@01)                          0875
*           /*********************************************************/
*           /*                                                       */
*           /* IF VOLUME WAS INCOMPLETELY CREATED, GET       @YD00175*/
*           /* EXCLUSIVE CONTROL ONLY IF THE VOLUME IS       @YD00175*/
*           /* MOUNTED                                       @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0876
*           IF BASIVCRE=ON THEN                                    0876
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0876
         BNO   @RF00876                                            0876
*             EXCLMNT=ON;           /*                       @YD00175*/
*                                                                  0877
         OI    EXCLMNT(@09),B'10000000'                            0877
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL       @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0878
*           CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*         @YD00175*/
@RF00876 L     @02,@PC00001                                        0878
         ST    @02,@AL00001                                        0878
         LA    @15,CHANGEX                                         0878
         ST    @15,@AL00001+4                                      0878
         LA    @15,EXCLAREA                                        0878
         ST    @15,@AL00001+8                                      0878
         MVI   @AL00001+8,X'80'                                    0878
         L     @15,GDTUNT(,@02)                                    0878
         LA    @01,@AL00001                                        0878
         BALR  @14,@15                                             0878
*           RESPECIFY                                              0879
*             RTNREG RSTD;                                         0879
*           TESTRC=RTNREG;                                         0880
         LR    TESTRC,RTNREG                                       0880
*           RESPECIFY                                              0881
*             RTNREG UNRSTD;        /*                       @YD00175*/
*                                                                  0881
*           /*********************************************************/
*           /*                                                       */
*           /* IF EXCLUSIVE CONTROL NOT OBTAINED,            @YD00175*/
*           /* SET RETURN CODE TO 4                          @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0882
*           IF TESTRC>0 THEN                                       0882
         LTR   TESTRC,TESTRC                                       0882
         BNP   @RF00882                                            0882
*             UNITCOND=4;           /*                       @YD00175*/
         LA    UNITCOND,4                                          0883
*         END;                      /*                       #Y30LB11*/
*                                                                  0884
*       /*************************************************************/
*       /*                                                           */
*       /* IF CHECK WAS NOT SUCCESSFUL, SET THE RETURN CODE TO 4.    */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0885
*       ELSE                                                       0885
*         UNITCOND=4;               /*                       @Y30LB11*/
         B     @RC00869                                            0885
@RF00869 LA    UNITCOND,4                                          0885
*     END;                          /*                       @Y30LB11*/
*                                                                  0887
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FILE WAS NOT SPECIFIED, CHECK IF NOVTOCCK IS OFF.  @YD00175*/
*   /* IF IT IS OFF, TRY TO FIND A UCB WITH EXCLUSIVE        @YD00175*/
*   /* CONTROL WITH THE VOLUME ON IT.                        @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0887
*   ELSE                            /*                       @Y30LB11*/
*     IF NOVTOCCK=OFF THEN          /*                       @Y30LB11*/
         B     @RC00859                                            0887
@RF00859 TM    NOVTOCCK,B'00001000'                                0887
         BNZ   @RF00887                                            0887
*       DO;                         /*                       @Y30LB11*/
*                                                                  0888
*         /***********************************************************/
*         /*                                                         */
*         /* SET UP FOR UMSSUNIT(SELECTX)                    @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0889
*         EXCLUCBP=ADDR(UCBPTR);    /*                       @YD00175*/
         LA    @02,EXCLAREA                                        0889
         LA    @15,UCBPTR                                          0889
         ST    @15,EXCLUCBP(,@02)                                  0889
*         EXCLDDP=ADDR(SVFILE);     /*                       @YD00175*/
         LA    @15,SVFILE                                          0890
         ST    @15,EXCLDDP(,@02)                                   0890
*         EXCLVOL=VOLVAL;           /*                       @YD00175*/
*                                                                  0891
         L     @15,@PC00001+4                                      0891
         L     @01,FDTPTR(,@15)                                    0891
         MVC   EXCLVOL(6,@02),VOLVAL(@01)                          0891
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UMSSUNIT(SELECTX) TO FIND UNIT            @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0892
*         CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*           @YD00175*/
         L     @15,@PC00001                                        0892
         ST    @15,@AL00001                                        0892
         LA    @14,SELECTX                                         0892
         ST    @14,@AL00001+4                                      0892
         ST    @02,@AL00001+8                                      0892
         MVI   @AL00001+8,X'80'                                    0892
         L     @15,GDTUNT(,@15)                                    0892
         LA    @01,@AL00001                                        0892
         BALR  @14,@15                                             0892
*         RESPECIFY                                                0893
*           RTNREG RSTD;                                           0893
*         TESTRC=RTNREG;                                           0894
         LR    TESTRC,RTNREG                                       0894
*         RESPECIFY                                                0895
*           RTNREG UNRSTD;          /*                       @YD00175*/
*                                                                  0895
*         /***********************************************************/
*         /*                                                         */
*         /* TEST RETURN CODE FOR FAILURE                    @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0896
*         IF TESTRC>0 THEN                                         0896
         LTR   TESTRC,TESTRC                                       0896
         BNP   @RF00896                                            0896
*           UNITCOND=4;             /*                       @YD00175*/
*                                                                  0897
         LA    UNITCOND,4                                          0897
*         /***********************************************************/
*         /*                                                         */
*         /* OTHERWISE, TEST FOR NO UNIT FOUND. IF NOT       @YD00175*/
*         /* FOUND, ALLOCATE A UNIT                          @YD00175*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0898
*         ELSE                                                     0898
*           DO;                     /*                       @YD00175*/
         B     @RC00896                                            0898
@RF00896 DS    0H                                                  0899
*             IF UCBPTR=NULLPTR THEN                               0899
         L     @15,UCBPTR                                          0899
         LTR   @15,@15                                             0899
         BNZ   @RF00899                                            0899
*               DO;                 /*                       @YD00175*/
*                 ALLOPTVL=ON;      /*                       #Y30LB11*/
         LA    @02,ALLGAREA                                        0901
         OI    ALLOPTVL(@02),B'10000000'                           0901
*                 ULP1=1;           /*                       @Y30LB11*/
         LA    @15,1                                               0902
         STH   @15,ULP1                                            0902
*                 ULP2=LENGTH(DEVTYPE);/*                    @Y30LB11*/
         MVC   ULP2(2),@CH00266                                    0903
*                 ULP3=DEVTYPE;     /*                       @Y30LB11*/
         MVI   ULP3+5,C' '                                         0904
         MVC   ULP3+6(2),ULP3+5                                    0904
         MVC   ULP3(5),@CC01108                                    0904
*                 ALLULP=ADDR(ULP); /*                       @Y30LB11*/
         LA    @14,ULP                                             0905
         ST    @14,ALLULP(,@02)                                    0905
*                 VLP1=1;           /*                       @Y30LB11*/
         STH   @15,VLP1                                            0906
*                 VLP2=VOLLEN;      /*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0907
         L     @15,FDTPTR(,@15)                                    0907
         SLR   @14,@14                                             0907
         IC    @14,VOLLEN(,@15)                                    0907
         STH   @14,VLP2                                            0907
*                 VLP3=VOLVAL;      /*                       @Y30LB11*/
         MVC   VLP3(6),VOLVAL(@15)                                 0908
*                 ALLVLP=ADDR(VLP); /*                       @Y30LB11*/
         LA    @15,VLP                                             0909
         ST    @15,ALLVLP(,@02)                                    0909
*                 ALLOPTPV=ON;      /*                       @Y30LB11*/
         OI    ALLOPTPV(@02),B'00100000'                           0910
*                 ALLVLCNT=1;       /*                       @YD00175*/
         MVI   ALLVLCNT(@02),X'01'                                 0911
*                 ALLUNCNT=1;       /*                       @Y30LB11*/
*                                                                  0912
         MVI   ALLUNCNT(@02),X'01'                                 0912
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE THE UALLOC UMACRO.                @Y30LB11*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0913
*                 CALL IDCSAAL0(GDTTBL,ALLAGL);/*            @Y30LB11*/
         L     @15,@PC00001                                        0913
         ST    @15,@AL00001                                        0913
         ST    @02,@AL00001+4                                      0913
         MVI   @AL00001+4,X'80'                                    0913
         L     @15,GDTALC(,@15)                                    0913
         LA    @01,@AL00001                                        0913
         BALR  @14,@15                                             0913
*                 RESPECIFY                                        0914
*                   RTNREG RSTD;                                   0914
*                 TESTRC=RTNREG;                                   0915
         LR    TESTRC,RTNREG                                       0915
*                 RESPECIFY                                        0916
*                   RTNREG UNRSTD;  /*                       @Y30LB11*/
*                                                                  0916
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF ALLOCATION FAILED, SET THE CONDITION CODE TO */
*                 /* 4.                                      @Y30LB11*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0917
*                 IF TESTRC=4 THEN  /*                       @Y30LB11*/
         LA    @02,4                                               0917
         CR    TESTRC,@02                                          0917
         BNE   @RF00917                                            0917
*                   UNITCOND=4;     /*                       @Y30LB11*/
*                                                                  0918
         LR    UNITCOND,@02                                        0918
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF ALLOCATION WAS SUCCESSFUL,           @YD00175*/
*                 /* GET EXCLUSIVE CONTROL OF THE VOLUME     @YD00175*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0919
*                 ELSE              /*                       @Y30LB11*/
*                   DO;             /*                       @Y30LB11*/
         B     @RC00917                                            0919
@RF00917 DS    0H                                                  0920
*                     ALLOCFLG=ON;  /*                       @Y30LB11*/
*                                                                  0920
         OI    ALLOCFLG,B'00010000'                                0920
*                     /***********************************************/
*                     /*                                             */
*                     /* SET UP TO GET EXCLUSIVE CONTROL     @YD00175*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0921
*                     EXCLAGL=EXCLAGL&&EXCLAGL;/*            @YD00175*/
         LA    @02,EXCLAREA                                        0921
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        0921
*                     EXCLUCBP=ADDR(UCBPTR);/*               @YD00175*/
         LA    @15,UCBPTR                                          0922
         ST    @15,EXCLUCBP(,@02)                                  0922
*                     EXCLDDP=ADDR(ALLDDN);/*                @YD00175*/
         LA    @15,ALLGAREA                                        0923
         LA    @15,ALLDDN(,@15)                                    0923
         ST    @15,EXCLDDP(,@02)                                   0923
*                     EXCLVOL=VOLVAL;/*                      @YD00175*/
*                                                                  0924
         L     @15,@PC00001+4                                      0924
         L     @01,FDTPTR(,@15)                                    0924
         MVC   EXCLVOL(6,@02),VOLVAL(@01)                          0924
*                     /***********************************************/
*                     /*                                             */
*                     /* ISSUE UMSSUNIT FOR EXCLUSIVE CONTROL        */
*                     /*                                     @YD00175*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0925
*                     CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*     0925
*                                                            @YD00175*/
         L     @15,@PC00001                                        0925
         ST    @15,@AL00001                                        0925
         LA    @14,CHANGEX                                         0925
         ST    @14,@AL00001+4                                      0925
         ST    @02,@AL00001+8                                      0925
         MVI   @AL00001+8,X'80'                                    0925
         L     @15,GDTUNT(,@15)                                    0925
         LA    @01,@AL00001                                        0925
         BALR  @14,@15                                             0925
*                     RESPECIFY                                    0926
*                       RTNREG RSTD;                               0926
*                     TESTRC=RTNREG;                               0927
         LR    TESTRC,RTNREG                                       0927
*                     RESPECIFY                                    0928
*                       RTNREG UNRSTD;/*                     @Y30LB11*/
*                                                                  0928
*                     /***********************************************/
*                     /*                                             */
*                     /* IF THE THE CHANGE WAS SUCCESSFUL, SET THE   */
*                     /* DDNAME IN THE ARGUMENT LIST FOR IDCVS01     */
*                     /* (SECURITY CHECK) AND USSUNIT(DEMOUNT).      */
*                     /*                                     @Y30LB11*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0929
*                     IF TESTRC=0 THEN/*                     @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0929
         BNZ   @RF00929                                            0929
*                       DO;         /*                       @Y30LB11*/
*                         VSFILEP=ADDR(ALLDDN);/*            @Y30LB11*/
         LA    @15,VSAGAREA                                        0931
         LA    @14,ALLGAREA                                        0931
         LA    @09,ALLDDN(,@14)                                    0931
         ST    @09,VSFILEP(,@15)                                   0931
*                         MDDDNAME=ALLDDN;/*                 @Y30LB11*/
         LA    @15,MDAGAREA                                        0932
         MVC   MDDDNAME(8,@15),ALLDDN(@14)                         0932
*                       END;        /*                       @Y30LB11*/
*                                                                  0933
*                     /***********************************************/
*                     /*                                             */
*                     /* IF THE UNIT CHECK WAS NOT SUCCESSFUL, SET   */
*                     /* THE CONDITION CODE TO 4.            @Y30LB11*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0934
*                     ELSE          /*                       @Y30LB11*/
*                       UNITCOND=4; /*                       @Y30LB11*/
         B     @RC00929                                            0934
@RF00929 LA    UNITCOND,4                                          0934
*                   END;            /*                       @Y30LB11*/
*               END;                /*                       @YD00175*/
*                                                                  0936
*             /*******************************************************/
*             /*                                                     */
*             /* IF SELECTX FOUND A UNIT, SET THE DDNAME IN THE      */
*             /*                                             @YD00175*/
*             /* ARGUMENT LIST FOR IDCVS01 AND UMSSUNIT      @YD00175*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0937
*             ELSE                                                 0937
*               DO;                 /*                       @YD00175*/
         B     @RC00899                                            0937
@RF00899 DS    0H                                                  0938
*                 VSFILEP=EXCLDDP;  /*                       @YD00175*/
         LA    @15,VSAGAREA                                        0938
         LA    @14,EXCLAREA                                        0938
         L     @14,EXCLDDP(,@14)                                   0938
         ST    @14,VSFILEP(,@15)                                   0938
*                 MDDDNAME=SVFILE;  /*                       @YD00175*/
         LA    @15,MDAGAREA                                        0939
         MVC   MDDDNAME(8,@15),SVFILE                              0939
*               END;                /*                       @YD00175*/
*           END;                    /*                       @Y30LB11*/
@RC00899 DS    0H                                                  0942
*       END;                        /*                       @YD00175*/
*                                                                  0942
@RC00896 DS    0H                                                  0943
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO BASECHK.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*   RETURN CODE(UNITCOND);          /*                       @Y30LB11*/
@RF00887 DS    0H                                                  0943
@RC00859 LR    @15,UNITCOND                                        0943
         L     @14,@SA00009                                        0943
         LM    @00,@12,@SA00009+8                                  0943
         BR    @14                                                 0943
*   END UNITCHK;                    /*                       @Y30LB11*/
*   END IDCSV01                     /*                       @Y30LB11*/
*                                                                  0945
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSSV )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF53 )                                       */
*                                                                  0945
*       ;                                                          0945
@DATA    DS    0H
@CH00147 DC    H'2'
@CH00266 DC    H'5'
@CH00150 DC    H'6'
@CH00909 DC    H'30'
@CH01286 DC    H'68'
@CH01289 DC    H'120'
@CH01288 DC    H'132'
@CH01285 DC    H'164'
@CH01287 DC    H'224'
         DS    0F
@AL00269 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01113)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00006 DS    15F
@SA00003 DS    15F
@SA00002 DS    15F
@SA00004 DS    15F
@SA00008 DS    15F
@PC00008 DS    1F
@SA00007 DS    15F
@PC00007 DS    2F
@SA00009 DS    15F
@SA00005 DS    15F
@AL00001 DS    6A
@AFTEMPS DS    4F
IDCSV01  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00213 DC    F'1'
@CH00213 EQU   @CF00213+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00173 DC    F'8'
@CH00173 EQU   @CF00173+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00464 DC    F'16'
@CF01111 DC    XL4'0208'
@CF01265 DC    XL4'23'
@CF01267 DC    XL4'26'
@CF01269 DC    XL4'2A'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
CCMSGPTR DS    A
CTMSGPTR DS    A
RVVIPTR  DS    A
DEFLPTR  DS    A
MSGPTR   DS    A
REASONCD DS    F
UCBPTR   DS    A
SSDLPTR  DS    A
SCMSGCD  DS    A
SCMSGPTR DS    A
SCDEFPTR DS    A
SCDDSTRU DS    A
LISTPTR  DS    A
SETRC    DS    H
ECBCODE  DS    FL1
SCECBCD  DS    FL1
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
ALLGAREA DS    CL31
BASEAREA DS    CL224
         DS    CL1
CKAGAREA DS    CL29
COPYAREA DS    CL164
DARGAREA DS    CL36
         DS    CL3
EXCLAREA DS    CL23
DEFAREA  DS    CL132
DUMPAREA DS    CL17
MDAGAREA DS    CL31
RVVIAREA DS    CL68
         DS    CL1
VSAGAREA DS    CL74
SVFILE   DS    CL8
COMTBL   DS    BL1
         ORG   COMTBL
VIERRFLG DS    BL1
SCRDFLG  EQU   COMTBL+0
UCLOSERR EQU   COMTBL+0
ALLOCFLG EQU   COMTBL+0
NOVTOCCK EQU   COMTBL+0
@NM00082 EQU   COMTBL+0
         ORG   COMTBL+1
UQUENAME DS    CL23
         ORG   UQUENAME
RLENGTH  DS    FL1
NAMELNG  DS    CL22
         ORG   NAMELNG
RVOLVAL  DS    CL6
RNAME    DS    CL16
         ORG   UQUENAME+23
ULP      DS    CL12
         ORG   ULP
ULP1     DS    FL2
ULP2     DS    FL2
ULP3     DS    CL8
         ORG   ULP+12
VLP      DS    CL10
         ORG   VLP
VLP1     DS    FL2
VLP2     DS    FL2
VLP3     DS    CL6
         ORG   VLP+10
Z8       DS    CL8
         ORG   Z8
ZERO     DS    BL2
@NM00084 DS    BL2
@NM00085 DS    BL4
         ORG   Z8+8
SSDRGLT  DS    CL20
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
SCDEFLST DS    CL132
SCDARG   DS    CL36
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSV01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
SSMSGNUM DC    AL1(56)
@CC01125 DC    C'.VIRTUAL.ENQUEUE'
@CC01128 DC    C'.VIRTUAL.RESERVE'
@CC01113 DC    C'SYSZAMS '
@CC01213 DC    C'IDCVS01 '
@CC01206 DC    C'DEFLIST'
@CC01108 DC    C'3330V'
@CC01174 DC    C'SVSC'
@CC01175 DC    C'SVSV'
@CC01182 DC    C'SVRC'
@CC01187 DC    C'SVAC'
@CC01188 DC    C'RVVI'
@CC01190 DC    C'SVRA'
@CC01197 DC    C'SVBC'
@CC01198 DC    C'SVRB'
@CC01205 DC    C'SVBP'
@CC01207 DC    C'SVSB'
@CC01212 DC    C'SVCV'
@CC01218 DC    C'SVCP'
@CC01220 DC    C'SVRV'
@CC01241 DC    C'SSAA'
@CC01277 DC    C'SCSC'
@CC01278 DC    C'SCDF'
@CC01283 DC    C'SVUC'
@CC01105 DC    C'CM0'
@CC01131 DC    C'SV0'
@CC01133 DC    C'UV0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
MODID    DC    CL4'SV01'
FIXAREA  DS    CL300
         ORG   FIXAREA
@NM00083 DC    300X'00'
         ORG   FIXAREA+300
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
SCBLANKS DS    CL30
         ORG   SCBLANKS
@NM00088 DC    30X'40'
         ORG   SCBLANKS+30
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
UNITCOND EQU   @04
SCRCOND  EQU   @05
SCCMPTR  EQU   @02
ENTRYNUM EQU   @02
COPYCOND EQU   @05
CHKCOND  EQU   @04
BPROCOND EQU   @04
BCHKCOND EQU   @04
ALLCOND  EQU   @05
COPYVPTR EQU   @04
BASEVPTR EQU   @05
CMMSGPTR EQU   @02
DMPINDEX EQU   @02
TESTRC   EQU   @03
RTNREG   EQU   @15
DEFVR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFS0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
VOL      EQU   0
VOLLEN   EQU   VOL
VOLVAL   EQU   VOL+1
ALLC     EQU   0
CDATE    EQU   0
DATE     EQU   0
DATEVAL  EQU   DATE
SEQ      EQU   0
SEQVAL   EQU   SEQ
FILE     EQU   0
FILEVAL  EQU   FILE+1
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CMCSN1   EQU   CMMSG+16
CMCSN2   EQU   CMMSG+28
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDWAIT   EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLVOL  EQU   EXCLAGL+16
EXCLFLAG EQU   EXCLAGL+22
EXCLMNT  EQU   EXCLFLAG
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSSECOPT EQU   VS1AGL+68
VSNOVSAM EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00057 EQU   SV82LIST+4
SV82DCBP EQU   @NM00057
@NM00058 EQU   SV82LIST+12
SV82WRKP EQU   @NM00058
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASCSN1  EQU   BASEV+24
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASCSN2  EQU   BASEV+37
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
COPYV    EQU   0
COPNAME  EQU   COPYV
COPID    EQU   COPNAME+11
COPNO    EQU   COPID+1
COPFLAGA EQU   COPYV+14
COPTYPE  EQU   COPFLAGA
COPRCVYF EQU   COPYV+20
COPSATIA EQU   COPRCVYF
COPMISCF EQU   COPRCVYF+2
COPCSN1  EQU   COPYV+24
COPLIB1  EQU   COPYV+36
COPLID1  EQU   COPLIB1
COPCSN2  EQU   COPYV+37
COPLIB2  EQU   COPYV+49
COPLID2  EQU   COPLIB2
COPDATE  EQU   COPYV+50
COPDEST  EQU   COPYV+88
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVCDATE EQU   RVVI+38
RVVRDSEQ EQU   RVVI+43
RVVCPYID EQU   RVVI+56
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSDTE  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVELM  EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVCSN1 EQU   DEFLIST+24
DEFVDATA EQU   DEFLIST+56
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSAFP0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
SCINPUT  EQU   0
SCERRFLG EQU   SCINPUT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00087 EQU   SCINPUT
@NM00086 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
DEFVVEXT EQU   DEFLIST+128
DEFTLAB  EQU   DEFVDATA+71
DEFR60   EQU   DEFVDATA+43
DEFOWNID EQU   DEFVDATA+29
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00081 EQU   DEFLIST+48
DEFVCSN2 EQU   DEFLIST+36
@NM00080 EQU   DEFLIST+22
DEFVNVOL EQU   DEFLIST+16
@NM00079 EQU   DEFLIST+15
@NM00078 EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
@NM00077 EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVSEC  EQU   DEFVVFLG
@NM00076 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00075 EQU   DEFVLIB
DEFVDACT EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVRNM  EQU   DEFVFLG
DEFVCR   EQU   DEFVFLG
@NM00074 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00073 EQU   RVVI+64
RVVSVOL  EQU   RVVSPEC
RVVSDUP  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00072 EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
@NM00071 EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
@NM00070 EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00069 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00068 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVRDCSN EQU   RVVI+44
RVVBLNK1 EQU   RVVI+42
RVVEXPIR EQU   RVVI+36
@NM00067 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00066 EQU   RVVOPCOD+1
@NM00065 EQU   COPYV+136
COPFREXT EQU   COPYV+132
COPLEXT  EQU   COPYV+130
COPFRESP EQU   COPYV+128
COPOWNER EQU   COPYV+118
COPDESCR EQU   COPYV+58
COPDTREM EQU   COPYV+54
COP2BIT2 EQU   COPLID2
COP2BIT1 EQU   COPLID2
COPRES5  EQU   COPLIB2
COP1BIT2 EQU   COPLID1
COP1BIT1 EQU   COPLID1
COPRES4  EQU   COPLIB1
@NM00064 EQU   COPMISCF
COPHOLD  EQU   COPMISCF
COPRES3  EQU   COPSATIA
COPVSMIS EQU   COPSATIA
COPIVCPY EQU   COPSATIA
COPIVCRE EQU   COPSATIA
@NM00063 EQU   COPYV+18
@NM00062 EQU   COPFLAGA+3
COPDLSPF EQU   COPFLAGA+3
COPRONLY EQU   COPFLAGA+3
COPDAERA EQU   COPFLAGA+2
COPEXCL  EQU   COPFLAGA+2
COPBIND  EQU   COPFLAGA+2
COPBKUP  EQU   COPFLAGA+2
COPRSTD  EQU   COPFLAGA+2
COPGENUS EQU   COPFLAGA+2
COPVSAM  EQU   COPFLAGA+2
COPGROUP EQU   COPFLAGA+2
COPRES2  EQU   COPTYPE
COPCOPYV EQU   COPTYPE
COPRES1  EQU   COPTYPE
COPRES6  EQU   COPYV+13
COPBLANK EQU   COPID
COPSERNO EQU   COPNAME+5
COPV     EQU   COPNAME
@NM00061 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00060 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00059 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
@NM00056 EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00055 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00054 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00053 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00052 EQU   RCTAGL+10
@NM00051 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00050 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
@NM00049 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00048 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00047 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00046 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00045 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00044 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00043 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00042 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00041 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00040 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00039 EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00038 EQU   EXCLFLAG
EXCLHEAD EQU   EXCLAGL
@NM00037 EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00036 EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00035 EQU   CTMSG
CMNUMCRT EQU   CMMSG+15
@NM00034 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00033 EQU   CMMSG+7
@NM00032 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00031 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00030 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
FILELEN  EQU   FILE
@NM00029 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00028 EQU   DMPITM+15
@NM00027 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00026 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00025 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00024 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00023 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00022 EQU   OPNAGL+43
@NM00021 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNF EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00020 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00019 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00018 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00017 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00016 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00015 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACNF EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
@NM00009 EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00276 EQU   @RC00270
@RF00474 EQU   @RC00438
@RC00440 EQU   @RC00438
@RF00705 EQU   @RC00690
@RF00825 EQU   @RC00797
@RC00869 EQU   @RC00859
@RC00917 EQU   @RC00899
@RC00929 EQU   @RC00899
@PB00009 EQU   @EL00001
@RF00454 EQU   @RC00440
@RC00460 EQU   @RC00440
@PB00008 EQU   @PB00009
@RF00882 EQU   @RC00869
@RC00461 EQU   @RC00460
@PB00007 EQU   @PB00008
@RF00467 EQU   @RC00461
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCSV01,(C'PLS0752',0603,75091)

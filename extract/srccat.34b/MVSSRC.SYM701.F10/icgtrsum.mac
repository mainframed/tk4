         TITLE '***** ICGTRSUM MSS TRACE SDG AND RWU SUMMARY REPORT ****
               ***      '
ICGTRSUM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGTRSUM  77.089'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0001
         LA    @09,4095(,@10)                                      0001
         USING @DATD,@10                                           0001
         USING @DATD+4095,@09                                      0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         L     R1,0(R1)
*   PARMPTR=R1;                     /* SAVE JCL PARMS ADDRESS      0086
*                                                            @Y30LB40*/
         LR    PARMPTR,R1                                          0086
*   RFY                                                            0087
*     R1 UNRSTD;                    /*                       @Y30LB40*/
*   CALL INIT;                      /* INITIALIZE VALUES     @OZ11673*/
         BAL   @14,INIT                                            0088
*   CALL OPENFILE;                  /* OPEN PRINT, TRACEIN   @OZ11673*/
         BAL   @14,OPENFILE                                        0089
*   IF RETURNCD=4                   /* SYSPRINT NOT OPEN     @OZ11673*/
*     THEN                          /*                       @OZ11673*/
         LH    @06,RETURNCD                                        0090
         C     @06,@CF00104                                        0090
         BNE   @RF00090                                            0090
*     RETURN CODE(RETURNCD);        /* RETURN, NO MESSAGE    @OZ11673*/
         L     @13,4(,@13)                                         0091
         L     @00,@SIZDATD                                        0091
         LR    @01,@10                                             0091
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@06                                             0091
         L     @14,12(,@13)                                        0091
         LM    @00,@12,20(@13)                                     0091
         BR    @14                                                 0091
*   ELSE                                                           0092
*     IF RETURNCD=8                 /* TRACEIN NOT OPEN      @OZ11673*/
*       THEN                        /*                       @OZ11673*/
@RF00090 CLC   RETURNCD(2),@CH00069                                0092
         BE    @RT00092                                            0092
*       GO TO CLOSEFIL;             /* CLOSE OPENED FILES    @OZ11673*/
*   IF PARMLEN^=0                   /* IF PARMS PASSED       @OZ11673*/
*     THEN                          /*                       @OZ11673*/
         LH    @06,PARMLEN(,PARMPTR)                               0094
         LTR   @06,@06                                             0094
         BZ    @RF00094                                            0094
*     CALL GETPARMS;                /* PROCESS PARMS         @OZ11673*/
         BAL   @14,GETPARMS                                        0095
*   IF RETURNCD=8                   /* IF ERROR IN           @OZ11673*/
*     THEN                          /* PROCESSING PARMS      @OZ11673*/
@RF00094 CLC   RETURNCD(2),@CH00069                                0096
         BE    @RT00096                                            0096
*     GO TO CLOSEFIL;               /* CLOSE OPENED FILES    @OZ11673*/
*   RFY                                                            0098
*    (R0,                                                          0098
*     R1,                                                          0098
*     R14,                                                         0098
*     R15) RSTD;                    /*                       @OZ11673*/
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0099
*                                                            @OZ11673*/
         TIME
*   GEN(ST    R1,DOUBLEWD);         /*                       @OZ11673*/
         ST    R1,DOUBLEWD
*   RFY                                                            0101
*    (R0,                                                          0101
*     R1,                                                          0101
*     R14,                                                         0101
*     R15) UNRSTD;                  /*                       @OZ11673*/
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @OZ11673*/
*                                                                  0102
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0102
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************      @OZ11673*/
*   /* SET UP INITIAL TIMESLICE COMPARE RECORD USING         @OZ11673*/
*   /* THE STARTING TIME SPECIFIED IN THE DATE AND           @OZ11673*/
*   /* TIME PARAMETERS, OR THE DEFAULT VALUES.               @OZ11673*/
*   /* ************************************************      @OZ11673*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0103
*   TSBEG=CKSTIME;                  /*                       @OZ11673*/
         MVC   TSBEG(7),CKSTIME                                    0103
*   TSEND=CKSTIME;                  /*                       @OZ11673*/
         MVC   TSEND(7),CKSTIME                                    0104
*   TSETIME=TSETIME+TIMESL;         /*                       @OZ11673*/
         L     @06,TSETIME                                         0105
         AL    @06,TIMESL                                          0105
         ST    @06,TSETIME                                         0105
*   GO TO RDTRACE;                                                 0106
         B     RDTRACE                                             0106
*                                                                  0107
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PRODEDURE NAME - RDTRACE (SUBSECTION WITHIN MAINLINE)    @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - READ A RECORD FROM TRACEIN, AND DETERMINE     @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0107
*RDTRACE:                                                          0107
*   RFY                                                            0107
*    (R0,                                                          0107
*     R1,                                                          0107
*     R14,                                                         0107
*     R15) RSTD;                    /*                       @Y30LB40*/
RDTRACE  DS    0H                                                  0108
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/
         GET   INDCB,RCDIN
*   RFY                                                            0109
*    (R0,                                                          0109
*     R1,                                                          0109
*     R14,                                                         0109
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF CKTIME<CKSTIME×CKTIME>CKETIME/* IF NOT IN TIME RANGE          */
*     THEN                                                         0110
         CLC   CKTIME(7),CKSTIME                                   0110
         BL    @RT00110                                            0110
         CLC   CKTIME(7),CKETIME                                   0110
         BH    @RT00110                                            0110
*     GO TO RDTRACE;                /* READ NEXT RECORD              */
*   IF SELECTSW='1'B                /* WAS SDG OR LU ENTERED @ZA16140*/
*     THEN                                                         0112
         TM    SELECTSW,B'10000000'                                0112
         BNO   @RF00112                                            0112
*     IF PARMSW='D' THEN                                           0113
         CLI   PARMSW,C'D'                                         0113
         BNE   @RF00113                                            0113
*       DO;                         /* SDG ENTERED,IS THIS THE     0114
*                                      DESIRED SDG           @ZA16140*/
*         IF SDGINBIN^=SELSDG THEN                                 0115
         CLC   SDGINBIN(1),SELSDG                                  0115
         BNE   @RT00115                                            0115
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0118
*       DO;                         /* LU ENTERED,IS THIS THE DESIRED
*                                      LU                    @Y30LB40*/
         B     @RC00113                                            0118
@RF00113 DS    0H                                                  0119
*         IF L^=LIBRARY×U^=READWRIT THEN                           0119
         SLR   @06,@06                                             0119
         IC    @06,LIBRARY                                         0119
         CR    L,@06                                               0119
         BNE   @RT00119                                            0119
         SLR   @06,@06                                             0119
         IC    @06,READWRIT                                        0119
         CR    U,@06                                               0119
         BNE   @RT00119                                            0119
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/
*       END;                        /*                       @Y30LB40*/
*   IF(DSTGD+STGD)^>0 THEN                                         0122
@RC00113 DS    0H                                                  0122
@RF00112 L     @06,DSTGD                                           0122
         AL    @06,STGD                                            0122
         LTR   @06,@06                                             0122
         BNP   @RT00122                                            0122
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/
*     THEN                                                         0124
         TM    FIRSTSW,B'10000000'                                 0124
         BNO   @RF00124                                            0124
*     DO;                           /*                       @Y30LB40*/
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */
         NI    FIRSTSW,B'01111111'                                 0126
*       CKSEQ=CKTIME;               /* SETUP TIME SLICE START AND END*/
         MVC   CKSEQ(7),CKTIME                                     0127
*       CALL GETSLICE;              /*                       @OZ11673*/
         BAL   @14,GETSLICE                                        0128
*     END;                          /*                       @Y30LB40*/
*   IF CKTIME<CKSEQ                 /* CHECK INPUT SEQUENCE  @Y30LB40*/
*     THEN                                                         0130
@RF00124 CLC   CKTIME(7),CKSEQ                                     0130
         BNL   @RF00130                                            0130
*     DO;                           /* OUT OF SEQUENCE,PRINT MESSAGE
*                                      AND                   @Y30LB40*/
*       DSLINE=SEQMSG;              /* EXIT WITH RC=8        @Y30LB40*/
         MVI   DSLINE+43,C' '                                      0132
         MVC   DSLINE+44(81),DSLINE+43                             0132
         MVC   DSLINE(43),SEQMSG                                   0132
*       RFY                                                        0133
*        (R0,                                                      0133
*         R1,                                                      0133
*         R14,                                                     0133
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0135
*        (R0,                                                      0135
*         R1,                                                      0135
*         R14,                                                     0135
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /*                       @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0136
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0137
*     END;                          /*                       @Y30LB40*/
*   CKSEQ=CKTIME;                   /* UPDATE SEQUENCE CHECK @Y30LB40*/
@RF00130 MVC   CKSEQ(7),CKTIME                                     0139
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/
         LA    @06,1                                               0140
         AL    @06,RCDCOUNT                                        0140
         ST    @06,RCDCOUNT                                        0140
*CHECKEOF:                                                         0141
*   IF CKTIME>TSEND                 /*                       @OZ11673*/
*       ×EOFSW='1'B                 /* END OF JOB YET        @OZ11673*/
*     THEN                          /*                       @OZ11673*/
CHECKEOF CLC   CKTIME(7),TSEND                                     0141
         BH    @RT00141                                            0141
         TM    EOFSW,B'10000000'                                   0141
         BNO   @RF00141                                            0141
@RT00141 DS    0H                                                  0142
*     DO;                           /*                       @OZ11673*/
*       IF PARMSW='R'               /*                       @OZ11673*/
*         THEN                      /*                       @OZ11673*/
         CLI   PARMSW,C'R'                                         0143
         BNE   @RF00143                                            0143
*         CALL RWCTLBRK;            /*                       @OZ11673*/
         BAL   @14,RWCTLBRK                                        0144
*       ELSE                        /*                       @OZ11673*/
*         CALL DSCTLBRK;            /*                       @OZ11673*/
         B     @RC00143                                            0145
@RF00143 BAL   @14,DSCTLBRK                                        0145
*       CALL GETSLICE;              /*                       @OZ11673*/
@RC00143 BAL   @14,GETSLICE                                        0146
*     END;                          /*                       @OZ11673*/
*   IF EOFSW='1'B                   /* END OF JOB YET        @OZ11673*/
*     THEN                          /*                       @OZ11673*/
@RF00141 TM    EOFSW,B'10000000'                                   0148
         BNO   @RF00148                                            0148
*     DO;                           /*                       @OZ11673*/
*       CALL TESTEOF;               /*                       @OZ11673*/
         BAL   @14,TESTEOF                                         0150
*       IF I=2                      /* REPORT TOTALS WRITTEN,GETOUT  */
*         THEN                      /*                       @OZ11673*/
         C     I,@CF00051                                          0151
         BNE   @RF00151                                            0151
*         DO;                       /*                       @OZ11673*/
*           CALL EOJ;               /*                       @OZ11673*/
         BAL   @14,EOJ                                             0153
*           GO TO CLOSEFIL;         /*                       @OZ11673*/
         B     CLOSEFIL                                            0154
*         END;                      /*                       @OZ11673*/
*     END;                          /*                       @OZ11673*/
@RF00151 DS    0H                                                  0157
*   IF PARMSW='R'                   /*                       @OZ11673*/
*     THEN                          /*                       @OZ11673*/
@RF00148 CLI   PARMSW,C'R'                                         0157
         BNE   @RF00157                                            0157
*     CALL RWACCUM;                 /*                       @OZ11673*/
         BAL   @14,RWACCUM                                         0158
*   ELSE                            /*                       @OZ11673*/
*     CALL DSACCUM;                 /*                       @OZ11673*/
         B     @RC00157                                            0159
@RF00157 BAL   @14,DSACCUM                                         0159
*   GO TO RDTRACE;                  /*                       @OZ11673*/
         B     RDTRACE                                             0160
*CLOSEFIL:                                                         0161
*   RFY                                                            0161
*    (R0,                                                          0161
*     R1,                                                          0161
*     R14,                                                         0161
*     R15) RSTD;                    /*                       @Y30LB40*/
CLOSEFIL DS    0H                                                  0162
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/
         CLOSE INDCB,MF=(E,OPENCLOS)
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/
         CLOSE PRNTDCB,MF=(E,OPENCLOS)
*   RFY                                                            0164
*    (R0,                                                          0164
*     R1,                                                          0164
*     R14,                                                         0164
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   RETURN CODE(RETURNCD);          /* TERMINATE WITH RETURN CODE  0165
*                                                            @Y30LB40*/
         LH    @08,RETURNCD                                        0165
         L     @13,4(,@13)                                         0165
         L     @00,@SIZDATD                                        0165
         LR    @01,@10                                             0165
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@08                                             0165
         L     @14,12(,@13)                                        0165
         LM    @00,@12,20(@13)                                     0165
         BR    @14                                                 0165
*                                                                  0166
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - INIT                                    @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - INITIALIZE LOCAL VARIABLES                    @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0166
*INIT:                                                             0166
*   PROCEDURE;                      /*                       @OZ11673*/
INIT     STM   @14,@12,12(@13)                                     0166
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/
         SLR   @08,@08                                             0167
         ST    @08,RCDCOUNT                                        0167
*   RETURNCD=0;                     /*                       @Y30LB40*/
         STH   @08,RETURNCD                                        0168
*   TIMESL=600;                     /*                       @Y30LB40*/
         MVC   TIMESL(4),@CF00700                                  0169
*   HOUR=0;                         /*                       @Y30LB40*/
         ST    @08,HOUR                                            0170
*   MINUTE=0;                       /*                       @Y30LB40*/
         ST    @08,MINUTE                                          0171
*   SECOND=0;                       /*                       @Y30LB40*/
         ST    @08,SECOND                                          0172
*   SELECTSW='0'B;                  /*                       @Y30LB40*/
         NI    SELECTSW,B'01111111'                                0173
*   LINECNT=56;                     /*                       @Y30LB40*/
         MVC   LINECNT(2),@CH00701                                 0174
*   OPENCLOS=0;                     /*                       @Y30LB40*/
         ST    @08,OPENCLOS                                        0175
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/
         MVI   OPCLB1,B'10000000'                                  0176
*   PAGECNT=0;                      /*                       @Y30LB40*/
         ST    @08,PAGECNT                                         0177
*   EOFSW='0'B;                     /*                       @Y30LB40*/
         NI    EOFSW,B'01111111'                                   0178
*   HLDSYR=0;                       /*                       @Y30LB40*/
         MVI   HLDSYR,X'00'                                        0179
*   HLDSDAY=1;                      /*                       @Y30LB40*/
         LA    @15,1                                               0180
         STH   @15,HLDSDAY                                         0180
*   HLDSTIME=0;                     /*                       @Y30LB40*/
         ST    @08,HLDSTIME                                        0181
*   HLDEYR=99;                      /*                       @Y30LB40*/
         MVI   HLDEYR,X'63'                                        0182
*   HLDEDAY=365;                    /*                       @Y30LB40*/
         MVC   HLDEDAY(2),@CH00704                                 0183
*   HLDETIME=86399;                 /*                       @Y30LB40*/
         MVC   HLDETIME(4),@CF00705                                0184
*   PARMSW='D';                     /*                       @Y30LB40*/
         MVI   PARMSW,C'D'                                         0185
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/
         OI    FIRSTSW,B'10000000'                                 0186
*   PARMERR='0'B;                   /*                       @Y30LB40*/
         NI    PARMERR,B'01111111'                                 0187
*   DATEINSW='0'B;                  /*                       @Y30LB40*/
         NI    DATEINSW,B'01111111'                                0188
*   SPACE1=' ';                     /*                       @Y30LB40*/
         MVI   SPACE1+1,C' '                                       0189
         MVC   SPACE1+2(119),SPACE1+1                              0189
         MVI   SPACE1,C' '                                         0189
*   DO I=1 TO 2;                    /*                       @Y30LB40*/
         LR    I,@15                                               0190
@DL00190 DS    0H                                                  0191
*     DO J=1 TO 2;                  /*                       @ZA16140*/
         LA    J,1                                                 0191
@DL00191 DS    0H                                                  0192
*       DO K=1 TO 29;               /*                       @ZA16140*/
         LA    K,1                                                 0192
@DL00192 DS    0H                                                  0193
*         BKT1(I,J,K)=0;            /*                       @Y30LB40*/
         SLR   @15,@15                                             0193
         LR    @14,I                                               0193
         ALR   @14,@14                                             0193
         ALR   @14,J                                               0193
         MH    @14,@CH00643                                        0193
         ALR   @14,K                                               0193
         SLA   @14,2                                               0193
         ST    @15,BKT1-352(@14)                                   0193
*         BKT2(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT2-352(@14)                                   0194
*         BKT3(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT3-352(@14)                                   0195
*         BKT4(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT4-352(@14)                                   0196
*         BKT5(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT5-352(@14)                                   0197
*         BKT6(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT6-352(@14)                                   0198
*         BKT7(I,J,K)=0;            /*                       @Y30LB40*/
         ST    @15,BKT7-352(@14)                                   0199
*       END;                        /*                       @Y30LB40*/
         AL    K,@CF00044                                          0200
         C     K,@CF00643                                          0200
         BNH   @DL00192                                            0200
*     END;                          /*                       @Y30LB40*/
         AL    J,@CF00044                                          0201
         C     J,@CF00051                                          0201
         BNH   @DL00191                                            0201
*   END;                            /*                       @Y30LB40*/
         AL    I,@CF00044                                          0202
         C     I,@CF00051                                          0202
         BNH   @DL00190                                            0202
*   END INIT;                       /*                       @OZ11673*/
@EL00002 DS    0H                                                  0203
@EF00002 DS    0H                                                  0203
@ER00002 LM    @14,@12,12(@13)                                     0203
         BR    @14                                                 0203
*                                                                  0204
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - OPENFILE                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SET UP DCBS FOR SYSPRINT AND TRACEIN.  IF     @OZ11673*/
*/*            SYSPRINT CANNOT BE OPENED,SET A RETURN CODE   @OZ11673*/
*/*            OF 4 AND RETURN TO THE MAINLINE.  IF TRACEIN  @OZ11673*/
*/*            CANNOT BE OPENED, WRITE MESSAGE 'ICG901I      @OZ11673*/
*/*            TRACEIN CANNOT BE OPENED', SET A RETURN CODE  @OZ11673*/
*/*            OF 8, AND RETURN TO THE MAINLINE.             @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0204
*OPENFILE:                                                         0204
*   PROCEDURE;                      /*                       @OZ11673*/
OPENFILE STM   @14,@12,@SA00003                                    0204
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/
         MVC   PRNTDCB(PDCBL),PPATDCB
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/
         MVC   INDCB(IDCBL),IPATDCB
*   RFY                                                            0207
*    (R0,                                                          0207
*     R1,                                                          0207
*     R14,                                                         0207
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0209
*    (R0,                                                          0209
*     R1,                                                          0209
*     R14,                                                         0209
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B THEN               0210
         MVC   @TS00001(1),PRNTDCB+48                              0210
         NI    @TS00001,B'00010000'                                0210
         CLI   @TS00001,B'00010000'                                0210
         BE    @RF00210                                            0210
*     DO;                           /*                       @Y30LB40*/
*       RETURNCD=4;                 /* SET RETURN CODE = 4   @OZ11673*/
         MVC   RETURNCD(2),@CH00104                                0212
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/
@EL00003 DS    0H                                                  0213
@EF00003 DS    0H                                                  0213
@ER00003 LM    @14,@12,@SA00003                                    0213
         BR    @14                                                 0213
*     END;                          /*                       @Y30LB40*/
*   RFY                                                            0215
*    (R0,                                                          0215
*     R1,                                                          0215
*     R14,                                                         0215
*     R15) RSTD;                    /*                       @Y30LB40*/
@RF00210 DS    0H                                                  0216
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0217
*    (R0,                                                          0217
*     R1,                                                          0217
*     R14,                                                         0217
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B THEN                 0218
         MVC   @TS00001(1),INDCB+48                                0218
         NI    @TS00001,B'00010000'                                0218
         CLI   @TS00001,B'00010000'                                0218
         BE    @RF00218                                            0218
*     DO;                           /* OPEN BAD,PRINT MESSAGE,EXIT 0219
*                                      WITH RC=8             @Y30LB40*/
*       DSLINE=TRINMSG;             /*                       @Y30LB40*/
         MVI   DSLINE+31,C' '                                      0220
         MVC   DSLINE+32(93),DSLINE+31                             0220
         MVC   DSLINE(31),TRINMSG                                  0220
*       RFY                                                        0221
*        (R0,                                                      0221
*         R1,                                                      0221
*         R14,                                                     0221
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0223
*        (R0,                                                      0223
*         R1,                                                      0223
*         R14,                                                     0223
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /*                       @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0224
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/
         B     @EL00003                                            0225
*     END;                          /*                       @Y30LB40*/
*   END OPENFILE;                   /*                       @OZ11673*/
         B     @EL00003                                            0227
*                                                                  0228
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - GETPARMS                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN THE PARAMETERS PASSED IN THE PARM FIELD  @OZ11673*/
*/*            OF THE EXEC STATEMENT FOR VALID PARAMETERS.   @OZ11673*/
*/*            IF AN INVALID PARAMETER IS FOUND, WRITE MSG   @OZ11673*/
*/*            'ICG900I INVALID PARM VALUES', SET A RETURN   @OZ11673*/
*/*            CODE OF 8, AND RETURN TO THE MAINLINE.  IF    @OZ11673*/
*/*            PARAMETERS ARE GOOD, RETURN TO THE MAINLINE   @OZ11673*/
*/*            WITH A RETURN CODE OF 0.                      @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0228
*GETPARMS:                                                         0228
*   PROCEDURE;                      /*                       @OZ11673*/
GETPARMS STM   @14,@06,@SA00004                                    0228
         STM   @09,@12,@SA00004+36                                 0228
*   IF PARMLEN>31                   /*                       @OZ05079*/
*     THEN                                                         0229
         LH    @06,PARMLEN(,PARMPTR)                               0229
         C     @06,@CF00067                                        0229
         BNH   @RF00229                                            0229
*     DO;                           /* IF PARMS TOO LONG,SET ERROR 0230
*                                      AND GETOUT            @Y30LB40*/
*       PARMERR='1'B;               /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0231
*       GO TO PARMEND;              /*                       @Y30LB40*/
         B     PARMEND                                             0232
*     END;                          /*                       @Y30LB40*/
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0234
*                                                            @Y30LB40*/
@RF00229 MVI   PARMHOLD,C','                                       0234
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @OZ05079*/
         MVC   PARMHOLD+1(30),PARMHOLD                             0235
*   SS=1;                           /* SET SUBSTRING POINTER TO 1  0236
*                                                            @Y30LB40*/
         LA    SS,1                                                0236
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0237
*                                                            @Y30LB40*/
         LH    @06,PARMLEN(,PARMPTR)                               0237
         BCTR  @06,0                                               0237
         EX    @06,@SM00832                                        0237
*                                                                  0238
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN FOR EITHER 'D' (SDG REPORT)              @ZA16140*/
*/*            OR 'R' (DATA RECORDING DEVICE REPORT) IN THE  @OZ11673*/
*/*            FIRST PARAMETER.  (IF NEITHER SPECIFIED, 'D'  @OZ11673*/
*/*            IS DEFAULTED.)  IF AN ERROR IS FOUND, SCAN OF @OZ11673*/
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0238
*   IF PARMHOLD(1:1)=','            /* WAS REPORT SELECTOR ENTERED 0238
*                                                            @Y30LB40*/
*     THEN                                                         0238
         CLI   PARMHOLD,C','                                       0238
         BNE   @RF00238                                            0238
*     SS=2;                         /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         LA    SS,2                                                0239
*   ELSE                                                           0240
*     DO;                           /* YES,CHECK FOR D OR R  @Y30LB40*/
         B     @RC00238                                            0240
@RF00238 DS    0H                                                  0241
*       IF PARMHOLD(1:1)='D'×PARMHOLD(1:1)='R' THEN                0241
         CLI   PARMHOLD,C'D'                                       0241
         BE    @RT00241                                            0241
         CLI   PARMHOLD,C'R'                                       0241
         BNE   @RF00241                                            0241
@RT00241 DS    0H                                                  0242
*         DO;                       /*                       @Y30LB40*/
*           PARMSW=PARMHOLD(1:1);   /* SELECTOR OK SAVE IT   @Y30LB40*/
         MVC   PARMSW(1),PARMHOLD                                  0243
*           SS=3;                   /* BUMP POINTER TO NEXT VALUE    */
         LA    SS,3                                                0244
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0246
*         DO;                       /*                       @Y30LB40*/
         B     @RC00241                                            0246
@RF00241 DS    0H                                                  0247
*           PARMERR='1'B;           /* INVALID SELECTOR,ERROR        */
         OI    PARMERR,B'10000000'                                 0247
*           GO TO PARMEND;          /*                       @Y30LB40*/
         B     PARMEND                                             0248
*         END;                      /*                       @Y30LB40*/
*     END;                          /*                       @Y30LB40*/
@RC00241 DS    0H                                                  0251
*                                                                  0251
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN FOR THE TIME SLICE SPECIFIED IN MINUTES. @OZ11673*/
*/*            (IF NO TIMESLICE IS SPECIFIED, DEFAULT IS     @OZ11673*/
*/*            010.)  IF AN ERROR IS FOUND, SCAN OF          @OZ11673*/
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0251
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0251
*                                                            @Y30LB40*/
*     THEN                                                         0251
@RC00238 LA    @06,PARMHOLD-1(SS)                                  0251
         CLI   0(@06),C','                                         0251
         BNE   @RF00251                                            0251
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0252
*   ELSE                                                           0253
*     DO;                           /* YES,CHECK TIME SLICE  @Y30LB40*/
         B     @RC00251                                            0253
@RF00251 DS    0H                                                  0254
*       DO I=SS TO(SS+2);           /* CHECK FOR NON NUMERICS      0254
*                                                            @Y30LB40*/
         LR    I,SS                                                0254
         B     @DE00254                                            0254
@DL00254 DS    0H                                                  0255
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0255
         LA    @03,PARMHOLD-1(I)                                   0255
         CLI   0(@03),C'0'                                         0255
         BL    @RF00255                                            0255
         LA    @03,PARMHOLD-1(I)                                   0255
         CLI   0(@03),C'9'                                         0255
         BNH   @RT00255                                            0255
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0257
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0257
*                                                            @Y30LB40*/
@RF00255 OI    PARMERR,B'10000000'                                 0257
*       END;                        /*                       @Y30LB40*/
@RT00255 AL    I,@CF00044                                          0258
@DE00254 LA    @03,2                                               0258
         ALR   @03,SS                                              0258
         CR    I,@03                                               0258
         BNH   @DL00254                                            0258
*       IF PARMERR='1'B THEN                                       0259
         TM    PARMERR,B'10000000'                                 0259
         BO    @RT00259                                            0259
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */
*       IF PARMHOLD(SS:SS+2)='000' THEN                            0261
         LA    @06,PARMHOLD-1(SS)                                  0261
         CLC   0(3,@06),@CC00717                                   0261
         BNE   @RF00261                                            0261
*         DO;                       /*                       @Y30LB40*/
*           PARMERR='1'B;           /* TIME SLICE CANNOT BE 000,ERROR*/
         OI    PARMERR,B'10000000'                                 0263
*           GO TO PARMEND;          /*                       @Y30LB40*/
         B     PARMEND                                             0264
*         END;                      /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/
@RF00261 LA    @06,PARMHOLD-1(SS)                                  0266
         PACK  DOUBLEWD(8),0(3,@06)                                0266
*       CVB(TIMESL,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @06,DOUBLEWD                                        0267
         ST    @06,TIMESL                                          0267
*       TIMESL=TIMESL*60;           /* CONVERT TIME SLICE TO SECONDS
*                                                            @Y30LB40*/
         MH    @06,@CH00335                                        0268
         ST    @06,TIMESL                                          0268
*       SS=SS+4;                    /*                       @Y30LB40*/
         AL    SS,@CF00104                                         0269
*     END;                          /*                       @Y30LB40*/
*                                                                  0271
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN FOR JULIAN DATES.                        @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0271
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/
*     THEN                                                         0271
@RC00251 LA    @06,PARMHOLD-1(SS)                                  0271
         CLI   0(@06),C','                                         0271
         BNE   @RF00271                                            0271
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0272
*   ELSE                                                           0273
*     DO;                           /* YES,CHECK DATES       @Y30LB40*/
         B     @RC00271                                            0273
@RF00271 DS    0H                                                  0274
*       DO I=SS TO(SS+9);           /* CHECK FOR NON NUMERICS      0274
*                                                            @Y30LB40*/
         LR    I,SS                                                0274
         B     @DE00274                                            0274
@DL00274 DS    0H                                                  0275
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0275
         LA    @03,PARMHOLD-1(I)                                   0275
         CLI   0(@03),C'0'                                         0275
         BL    @RF00275                                            0275
         LA    @03,PARMHOLD-1(I)                                   0275
         CLI   0(@03),C'9'                                         0275
         BNH   @RT00275                                            0275
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0277
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0277
*                                                            @Y30LB40*/
@RF00275 OI    PARMERR,B'10000000'                                 0277
*       END;                        /*                       @Y30LB40*/
@RT00275 AL    I,@CF00044                                          0278
@DE00274 LA    @03,9                                               0278
         ALR   @03,SS                                              0278
         CR    I,@03                                               0278
         BNH   @DL00274                                            0278
*       IF PARMERR='1'B THEN                                       0279
         TM    PARMERR,B'10000000'                                 0279
         BO    @RT00279                                            0279
*         GO TO PARMEND;            /* IF ERRORS FOUND GETOUT        */
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/
         LA    @06,PARMHOLD-1(SS)                                  0281
         PACK  DOUBLEWD(8),0(2,@06)                                0281
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @06,DOUBLEWD                                        0282
         STC   @06,HLDSYR                                          0282
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/
         LA    @06,PARMHOLD+1(SS)                                  0283
         PACK  DOUBLEWD(8),0(3,@06)                                0283
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @06,DOUBLEWD                                        0284
         STH   @06,HLDSDAY                                         0284
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/
         LA    @03,PARMHOLD+4(SS)                                  0285
         PACK  DOUBLEWD(8),0(2,@03)                                0285
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0286
         STC   @03,HLDEYR                                          0286
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/
         LA    @03,PARMHOLD+6(SS)                                  0287
         PACK  DOUBLEWD(8),0(3,@03)                                0287
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0288
         STH   @03,HLDEDAY                                         0288
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAY   @Y30LB40*/
*         THEN                                                     0289
         LTR   @06,@06                                             0289
         BNP   @RF00289                                            0289
         C     @06,@CF00720                                        0289
         BL    @RT00289                                            0289
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0291
*         DO;                       /*                       @Y30LB40*/
@RF00289 DS    0H                                                  0292
*           IF HLDSDAY=366 THEN                                    0292
         CLC   HLDSDAY(2),@CH00720                                 0292
         BNE   @RF00292                                            0292
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0294
         MVC   @TS00001(1),CKSTIME                                 0294
         NI    @TS00001,B'00000011'                                0294
         CLI   @TS00001,B'00000000'                                0294
         BE    @RF00294                                            0294
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0295
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0297
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/
         B     @RC00292                                            0297
@RF00292 OI    PARMERR,B'10000000'                                 0297
*         END;                      /*                       @Y30LB40*/
@RC00292 DS    0H                                                  0299
*       IF HLDEDAY>0&HLDEDAY<366    /* SAME AS FOR START DAY         */
*         THEN                                                     0299
@RT00289 LH    @06,HLDEDAY                                         0299
         LTR   @06,@06                                             0299
         BNP   @RF00299                                            0299
         C     @06,@CF00720                                        0299
         BL    @RT00299                                            0299
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0301
*         DO;                       /*                       @Y30LB40*/
@RF00299 DS    0H                                                  0302
*           IF HLDEDAY=366 THEN                                    0302
         CLC   HLDEDAY(2),@CH00720                                 0302
         BNE   @RF00302                                            0302
*             DO;                   /*                       @Y30LB40*/
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0304
         MVC   @TS00001(1),CKETIME                                 0304
         NI    @TS00001,B'00000011'                                0304
         CLI   @TS00001,B'00000000'                                0304
         BE    @RF00304                                            0304
*                 PARMERR='1'B;     /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0305
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0307
*             PARMERR='1'B;         /*                       @Y30LB40*/
         B     @RC00302                                            0307
@RF00302 OI    PARMERR,B'10000000'                                 0307
*         END;                      /*                       @Y30LB40*/
@RC00302 DS    0H                                                  0309
*       IF HLDSYR<=HLDEYR           /* START YEAR MUST BE <= END YEAR
*                                                            @Y30LB40*/
*         THEN                                                     0309
@RT00299 CLC   HLDSYR(1),HLDEYR                                    0309
         BNH   @RT00309                                            0309
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0311
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0311
*       IF HLDSDAY<=HLDEDAY         /* CHECK YEARS AND DAYS TOGETHER */
*         THEN                                                     0312
@RT00309 LH    @06,HLDSDAY                                         0312
         CH    @06,HLDEDAY                                         0312
         BNH   @RT00312                                            0312
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0314
*         DO;                       /*                       @Y30LB40*/
*           IF HLDSYR=HLDEYR THEN                                  0315
         CLC   HLDSYR(1),HLDEYR                                    0315
         BNE   @RF00315                                            0315
*             PARMERR='1'B;         /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0316
*         END;                      /*                       @Y30LB40*/
@RF00315 DS    0H                                                  0318
*       IF PARMERR='1'B THEN                                       0318
@RT00312 TM    PARMERR,B'10000000'                                 0318
         BO    @RT00318                                            0318
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */
*       DATEINSW='1'B;              /* DATES VALID,SET INDICATOR   0320
*                                                            @Y30LB40*/
         OI    DATEINSW,B'10000000'                                0320
*       SS=SS+11;                   /* BUMP TO NEXT VALUE    @Y30LB40*/
         AL    SS,@CF00033                                         0321
*     END;                          /*                       @Y30LB40*/
*                                                                  0323
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN FOR TIME-OF-DAY PARAMETER                @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0323
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/
*     THEN                                                         0323
@RC00271 LA    @06,PARMHOLD-1(SS)                                  0323
         CLI   0(@06),C','                                         0323
         BNE   @RF00323                                            0323
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0324
*   ELSE                                                           0325
*     DO;                           /* YES,CHECK TIMES       @Y30LB40*/
         B     @RC00323                                            0325
@RF00323 DS    0H                                                  0326
*       DO I=SS TO(SS+7);           /* CHECK FOR NON NUMERICS      0326
*                                                            @Y30LB40*/
         LR    I,SS                                                0326
         B     @DE00326                                            0326
@DL00326 DS    0H                                                  0327
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0327
         LA    @03,PARMHOLD-1(I)                                   0327
         CLI   0(@03),C'0'                                         0327
         BL    @RF00327                                            0327
         LA    @03,PARMHOLD-1(I)                                   0327
         CLI   0(@03),C'9'                                         0327
         BNH   @RT00327                                            0327
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0329
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0329
*                                                            @Y30LB40*/
@RF00327 OI    PARMERR,B'10000000'                                 0329
*       END;                        /*                       @Y30LB40*/
@RT00327 AL    I,@CF00044                                          0330
@DE00326 LA    @03,7                                               0330
         ALR   @03,SS                                              0330
         CR    I,@03                                               0330
         BNH   @DL00326                                            0330
*       IF PARMERR='1'B THEN                                       0331
         TM    PARMERR,B'10000000'                                 0331
         BO    @RT00331                                            0331
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/
         LA    @06,PARMHOLD-1(SS)                                  0333
         PACK  DOUBLEWD(8),0(2,@06)                                0333
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0334
*       IF TIMEWORK>23 THEN                                        0335
         C     TIMEWORK,@CF00723                                   0335
         BNH   @RF00335                                            0335
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0336
*       ELSE                                                       0337
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00335                                            0337
@RF00335 LR    @06,TIMEWORK                                        0337
         MH    @06,@CH00724                                        0337
         ST    @06,HLDSTIME                                        0337
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/
@RC00335 LA    @06,PARMHOLD+1(SS)                                  0338
         PACK  DOUBLEWD(8),0(2,@06)                                0338
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0339
*       IF TIMEWORK>59 THEN                                        0340
         C     TIMEWORK,@CF00725                                   0340
         BNH   @RF00340                                            0340
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0341
*       ELSE                                                       0342
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/
         B     @RC00340                                            0342
@RF00340 LR    @06,TIMEWORK                                        0342
         MH    @06,@CH00335                                        0342
         AL    @06,HLDSTIME                                        0342
         ST    @06,HLDSTIME                                        0342
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/
@RC00340 LA    @06,PARMHOLD+3(SS)                                  0343
         PACK  DOUBLEWD(8),0(2,@06)                                0343
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0344
*       IF TIMEWORK>23 THEN                                        0345
         C     TIMEWORK,@CF00723                                   0345
         BNH   @RF00345                                            0345
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0346
*       ELSE                                                       0347
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00345                                            0347
@RF00345 LR    @06,TIMEWORK                                        0347
         MH    @06,@CH00724                                        0347
         ST    @06,HLDETIME                                        0347
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/
@RC00345 LA    @06,PARMHOLD+5(SS)                                  0348
         PACK  DOUBLEWD(8),0(2,@06)                                0348
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0349
*       IF TIMEWORK>59 THEN                                        0350
         C     TIMEWORK,@CF00725                                   0350
         BNH   @RF00350                                            0350
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0351
*       ELSE                                                       0352
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/
         B     @RC00350                                            0352
@RF00350 LR    @06,TIMEWORK                                        0352
         MH    @06,@CH00335                                        0352
         AL    @06,HLDETIME                                        0352
         AL    @06,@CF00725                                        0352
         ST    @06,HLDETIME                                        0352
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0353
@RC00350 CLC   HLDSYR(1),HLDEYR                                    0353
         BNE   @RF00353                                            0353
         CLC   HLDSDAY(2),HLDEDAY                                  0353
         BNE   @RF00353                                            0353
*         IF HLDSTIME>HLDETIME THEN                                0354
         L     @06,HLDSTIME                                        0354
         C     @06,HLDETIME                                        0354
         BNH   @RF00354                                            0354
*           PARMERR='1'B;           /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0355
*       IF PARMERR='0'B&DATEINSW='0'B THEN                         0356
@RF00354 DS    0H                                                  0356
@RF00353 TM    PARMERR,B'10000000'                                 0356
         BNZ   @RF00356                                            0356
         TM    DATEINSW,B'10000000'                                0356
         BNZ   @RF00356                                            0356
*         PARMERR='1'B;             /* IF DATES NOT ENTERED,ERROR  0357
*                                                            @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0357
*       SS=SS+9;                    /* OK SO FAR,BUMP TO NEXT VALUE
*                                                            @Y30LB40*/
@RF00356 AL    SS,@CF00035                                         0358
*     END;                          /*                       @Y30LB40*/
*                                                                  0360
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SCAN FOR THE SSID OR SDG OF THE DEVICE        @ZA16140*/
*/*            SELECTED FOR                                  @ZA16140*/
*/*            THE REPORT TO BE PRODUCED.                    @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0360
*   IF PARMERR='1'B THEN                                           0360
@RC00323 TM    PARMERR,B'10000000'                                 0360
         BO    @RT00360                                            0360
*     GO TO PARMEND;                /* IF ERRORS FOUND,GETOUT        */
*   IF PARMHOLD(SS:SS)=','          /* WERE SDG OR LU ENTERED      0362
*                                                            @ZA16140*/
*     THEN                                                         0362
         LA    @06,PARMHOLD-1(SS)                                  0362
         CLI   0(@06),C','                                         0362
         BE    @RT00362                                            0362
*     ;                             /* NO,FINISH PROCESS     @Y30LB40*/
*   ELSE                                                           0364
*     DO;                           /* YES,CHECK VALUES      @Y30LB40*/
*       SELECTSW='1'B;              /* SET SELECTOR SWITCH   @Y30LB40*/
         OI    SELECTSW,B'10000000'                                0365
*       IF PARMSW='D'               /* IF SDG REPORT         @ZA16140*/
*         THEN                                                     0366
         CLI   PARMSW,C'D'                                         0366
         BNE   @RF00366                                            0366
*         DO;                       /* CHECK FOR VALID SDG VALUES  0367
*                                                            @ZA16140*/
*           IF((PARMHOLD(SS:SS+2)='SDG')&(PARMHOLD(SS+3:SS+3)>='0')&(
*               PARMHOLD(SS+3:SS+3)<='2')&(PARMHOLD(SS+4:SS+4)>='0')&(
*               PARMHOLD(SS+4:SS+4)<='9')&(PARMHOLD(SS+3:SS+4)<='27'))
*             THEN                                                 0368
         LA    @06,PARMHOLD-1(SS)                                  0368
         CLC   0(3,@06),@CC00726                                   0368
         BNE   @RF00368                                            0368
         LA    @06,PARMHOLD+2(SS)                                  0368
         CLI   0(@06),C'0'                                         0368
         BL    @RF00368                                            0368
         LA    @06,PARMHOLD+2(SS)                                  0368
         CLI   0(@06),C'2'                                         0368
         BH    @RF00368                                            0368
         LA    @06,PARMHOLD+3(SS)                                  0368
         CLI   0(@06),C'0'                                         0368
         BL    @RF00368                                            0368
         LA    @06,PARMHOLD+3(SS)                                  0368
         CLI   0(@06),C'9'                                         0368
         BH    @RF00368                                            0368
         LA    @06,PARMHOLD+2(SS)                                  0368
         CLC   0(2,@06),@CC00727                                   0368
         BH    @RF00368                                            0368
*             DO;                   /*                       @ZA16140*/
*               PACK(DOUBLEWD,PARMHOLD(SS+3:SS+4));/*        @ZA16140*/
         LA    @06,PARMHOLD+2(SS)                                  0370
         PACK  DOUBLEWD(8),0(2,@06)                                0370
*               CVB(SELSDG,DOUBLEWD);/*                      @ZA16140*/
         CVB   @06,DOUBLEWD                                        0371
         STC   @06,SELSDG                                          0371
*             END;                  /*                       @ZA16140*/
*           ELSE                                                   0373
*             DO;                   /*                       @ZA16140*/
         B     @RC00368                                            0373
@RF00368 DS    0H                                                  0374
*               PARMERR='1'B;       /*                       @ZA16140*/
         OI    PARMERR,B'10000000'                                 0374
*               GO TO PARMEND;      /*                       @ZA16140*/
         B     PARMEND                                             0375
*             END;                  /*                       @ZA16140*/
*         END;                      /*                       @ZA16140*/
*       ELSE                                                       0378
*         DO;                       /* CHECK LIBRARY AND RWU @Y30LB40*/
         B     @RC00366                                            0378
@RF00366 DS    0H                                                  0379
*           IF PARMHOLD(SS:SS)^='2' /* 1ST DIGIT ALWAYS 2    @OZ05079*/
*             THEN                  /*                       @OZ05079*/
         LA    @06,PARMHOLD-1(SS)                                  0379
         CLI   0(@06),C'2'                                         0379
         BE    @RF00379                                            0379
*             DO;                   /*                       @OZ05079*/
*               PARMERR='1'B;       /*                       @OZ05079*/
         OI    PARMERR,B'10000000'                                 0381
*               GO TO PARMEND;      /*                       @OZ05079*/
         B     PARMEND                                             0382
*             END;                  /*                       @OZ05079*/
*           IF PARMHOLD(SS+1:SS+1)='0'/* MSF = 0             @OZ05079*/
*               ×PARMHOLD(SS+1:SS+1)='1'/* MSF = 1           @OZ05079*/
*             THEN                                                 0384
@RF00379 LA    @06,PARMHOLD(SS)                                    0384
         CLI   0(@06),C'0'                                         0384
         BE    @RT00384                                            0384
         LA    @06,PARMHOLD(SS)                                    0384
         CLI   0(@06),C'1'                                         0384
         BNE   @RF00384                                            0384
@RT00384 DS    0H                                                  0385
*             DO;                   /*                       @Y30LB40*/
*               PACK(DOUBLEWD,PARMHOLD(SS+1:SS+1));/* LIB OK @OZ05079*/
         LA    @06,PARMHOLD(SS)                                    0386
         PACK  DOUBLEWD(8),0(1,@06)                                0386
*               CVB(L,DOUBLEWD);    /*                       @Y30LB40*/
         CVB   L,DOUBLEWD                                          0387
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0389
*             DO;                   /*                       @Y30LB40*/
         B     @RC00384                                            0389
@RF00384 DS    0H                                                  0390
*               PARMERR='1'B;       /* LIB BAD,SET ERROR     @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0390
*               GO TO PARMEND;      /*                       @Y30LB40*/
         B     PARMEND                                             0391
*             END;                  /*                       @Y30LB40*/
*           IF PARMHOLD(SS+2:SS+2)>='0'/* VALID RANGE        @OZ05079*/
*               &PARMHOLD(SS+2:SS+2)<='7'/*                  @OZ05079*/
*             THEN                                                 0393
@RC00384 LA    @06,PARMHOLD+1(SS)                                  0393
         CLI   0(@06),C'0'                                         0393
         BL    @RF00393                                            0393
         LA    @06,PARMHOLD+1(SS)                                  0393
         CLI   0(@06),C'7'                                         0393
         BH    @RF00393                                            0393
*             DO;                   /*                       @Y30LB40*/
*               PACK(DOUBLEWD,PARMHOLD(SS+2:SS+2));/* RWU OK @OZ05079*/
         LA    @06,PARMHOLD+1(SS)                                  0395
         PACK  DOUBLEWD(8),0(1,@06)                                0395
*               CVB(U,DOUBLEWD);    /*                       @Y30LB40*/
         CVB   U,DOUBLEWD                                          0396
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0398
*             DO;                   /*                       @Y30LB40*/
         B     @RC00393                                            0398
@RF00393 DS    0H                                                  0399
*               PARMERR='1'B;       /* RWU BAD,SET ERROR     @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0399
*               GO TO PARMEND;      /*                       @Y30LB40*/
         B     PARMEND                                             0400
*             END;                  /*                       @Y30LB40*/
*         END;                      /*                       @Y30LB40*/
@RC00393 DS    0H                                                  0403
*     END;                          /*                       @Y30LB40*/
@RC00366 DS    0H                                                  0404
*                                                                  0404
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - PARMEND (SUBSECTION WITHIN GETPARMS)    @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - TEST FOR ERROR INDICATOR FOR BAD SCAN OF A    @OZ11673*/
*/*            PARAMETER.  IF ERROR WAS ENCOUNTERED, SET     @OZ11673*/
*/*            UP ERROR MESSAGE ICG910, SET RETURN CODE TO   @OZ11673*/
*/*            8.  IN ANY CASE, RETURN TO MAINLINE.          @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0404
*PARMEND:                                                          0404
*   IF PARMERR='1'B                 /* WERE THERE ANY ERRORS @Y30LB40*/
*     THEN                                                         0404
@RT00362 DS    0H                                                  0404
PARMEND  TM    PARMERR,B'10000000'                                 0404
         BNO   @RF00404                                            0404
*     DO;                           /* YES,PRINT MESSAGE     @Y30LB40*/
*       DSLINE=PARMMSG;             /*                       @Y30LB40*/
         MVI   DSLINE+28,C' '                                      0406
         MVC   DSLINE+29(96),DSLINE+28                             0406
         MVC   DSLINE(28),PARMMSG                                  0406
*       RFY                                                        0407
*        (R0,                                                      0407
*         R1,                                                      0407
*         R14,                                                     0407
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0409
*        (R0,                                                      0409
*         R1,                                                      0409
*         R14,                                                     0409
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /* SET RC=8 AND TERMINATE      0410
*                                                            @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0410
*     END;                          /*                       @Y30LB40*/
*   END GETPARMS;                   /*                       @OZ11673*/
@EL00004 DS    0H                                                  0412
@EF00004 DS    0H                                                  0412
@ER00004 LM    @14,@06,@SA00004                                    0412
         LM    @09,@12,@SA00004+36                                 0412
         BR    @14                                                 0412
*                                                                  0413
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - DSACCUM                                 @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - ACCUUMLATE TOTALS FROM THE DETAIL ACTIVITY    @OZ11673*/
*/*            WITHIN A TIME SLICE FOR THE SDG               @ZA16140*/
*/*            ACTIVITY REPORT.                              @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0413
*DSACCUM:                                                          0413
*   PROCEDURE;                      /*                       @OZ11673*/
DSACCUM  STM   @14,@12,@SA00005                                    0413
*   J=1;                            /* SET ARRAY POINTER     @ZA16140*/
         LA    @06,1                                               0414
         LR    J,@06                                               0414
*   K=SDGINBIN+1;                   /* SET ARRAY POINTER     @ZA16140*/
         SLR   K,K                                                 0415
         IC    K,SDGINBIN                                          0415
         ALR   K,@06                                               0415
*   IF K>8 THEN                                                    0416
         C     K,@CF00069                                          0416
         BNH   @RF00416                                            0416
*     K=K+1;                        /* BYPASS INDEX 9        @ZA16140*/
         ALR   K,@06                                               0417
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0418
*                                      TOTALS                @Y30LB40*/
@RF00416 LA    I,1                                                 0418
@DL00418 DS    0H                                                  0419
*     CALL BUCKETS;                                                0419
         BAL   @14,BUCKETS                                         0419
*     DSBKT6(I,J,K)=DSBKT6(I,J,K)+MININUM;/* NUMBER OF MINI HDRS     */
         LR    @15,I                                               0420
         ALR   @15,@15                                             0420
         ALR   @15,J                                               0420
         MH    @15,@CH00643                                        0420
         ALR   @15,K                                               0420
         SLA   @15,2                                               0420
         SLR   @14,@14                                             0420
         IC    @14,MININUM                                         0420
         AL    @14,DSBKT6-352(@15)                                 0420
         ST    @14,DSBKT6-352(@15)                                 0420
*     DSBKT7(I,J,K)=DSBKT7(I,J,K)+HITNUM;/* NUMBER OF PRELOADS       */
         SLR   @14,@14                                             0421
         IC    @14,HITNUM                                          0421
         AL    @14,DSBKT7-352(@15)                                 0421
         ST    @14,DSBKT7-352(@15)                                 0421
*   END;                            /*                       @Y30LB40*/
         AL    I,@CF00044                                          0422
         C     I,@CF00051                                          0422
         BNH   @DL00418                                            0422
*   END DSACCUM;                    /* GO READ NEXT RECORD   @Y30LB40*/
@EL00005 DS    0H                                                  0423
@EF00005 DS    0H                                                  0423
@ER00005 LM    @14,@12,@SA00005                                    0423
         BR    @14                                                 0423
*                                                                  0424
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - DATETIME                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SET UP DATE AND TIME IN THE FIRST LINE OF     @OZ11673*/
*/*            THE TIMESLICE SUMMARY FOR EITHER A STAGING    @OZ11673*/
*/*            ADAPTER ACTIVITY REPORT OR A DATA RECORDING   @OZ11673*/
*/*            DEVICE ACTIVITY REPORT.                       @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0424
*DATETIME:                                                         0424
*   PROCEDURE;                      /*                       @OZ11673*/
DATETIME STM   @14,@12,@SA00006                                    0424
*   DSLINE=' ';                     /* CLEAR PRINT LINE      @Y30LB40*/
         MVI   DSLINE+1,C' '                                       0425
         MVC   DSLINE+2(123),DSLINE+1                              0425
         MVI   DSLINE,C' '                                         0425
*   FLD1='0';                       /*                       @OZ11673*/
         MVI   FLD1,C'0'                                           0426
*   FLD2='  /   ';                  /*                       @OZ11673*/
         MVC   FLD2(6),@CC00737                                    0427
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00428                              0428
         LA    @08,TSSYR                                           0428
         ST    @08,@AFTEMPS                                        0428
         LA    @08,@AFTEMPS                                        0428
         ST    @08,@AL00001                                        0428
         LA    @01,@AL00001                                        0428
         BAL   @14,EDITFIX                                         0428
*   FLD2(1:2)=FIXOUT(12:13);        /*                       @OZ11673*/
         MVC   FLD2(2),FIXOUT+11                                   0429
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00430                              0430
         LA    @08,TSSDAY                                          0430
         ST    @08,@AFTEMPS                                        0430
         LA    @08,@AFTEMPS                                        0430
         ST    @08,@AL00001                                        0430
         LA    @01,@AL00001                                        0430
         BAL   @14,EDITFIX                                         0430
*   FLD2(4:6)=FIXOUT(11:13);        /*                       @OZ11673*/
         MVC   FLD2+3(3),FIXOUT+10                                 0431
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/
         L     @08,TSSTIME                                         0432
         LA    @15,3600                                            0432
         LR    @00,@08                                             0432
         SRDA  @00,32                                              0432
         DR    @00,@15                                             0432
         ST    @01,HOUR                                            0432
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/
         LA    @14,60                                              0433
         MR    @00,@15                                             0433
         LR    @02,@08                                             0433
         SLR   @02,@01                                             0433
         SRDA  @02,32                                              0433
         DR    @02,@14                                             0433
         ST    @03,MINUTE                                          0433
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/
         MR    @02,@14                                             0434
         ALR   @01,@03                                             0434
         SLR   @08,@01                                             0434
         ST    @08,SECOND                                          0434
*   FLD2A='  :  :  ';               /*                       @OZ11673*/
         MVC   FLD2A(8),@CC00740                                   0435
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00436                              0436
         LA    @08,HOUR                                            0436
         ST    @08,@AFTEMPS                                        0436
         LA    @08,@AFTEMPS                                        0436
         ST    @08,@AL00001                                        0436
         LA    @01,@AL00001                                        0436
         BAL   @14,EDITFIX                                         0436
*   FLD2A(1:2)=FIXOUT(12:13);       /*                       @OZ11673*/
         MVC   FLD2A(2),FIXOUT+11                                  0437
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00438                              0438
         LA    @08,MINUTE                                          0438
         ST    @08,@AFTEMPS                                        0438
         LA    @08,@AFTEMPS                                        0438
         ST    @08,@AL00001                                        0438
         LA    @01,@AL00001                                        0438
         BAL   @14,EDITFIX                                         0438
*   FLD2A(4:5)=FIXOUT(12:13);       /*                       @OZ11673*/
         MVC   FLD2A+3(2),FIXOUT+11                                0439
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00440                              0440
         LA    @08,SECOND                                          0440
         ST    @08,@AFTEMPS                                        0440
         LA    @08,@AFTEMPS                                        0440
         ST    @08,@AL00001                                        0440
         LA    @01,@AL00001                                        0440
         BAL   @14,EDITFIX                                         0440
*   FLD2A(7:8)=FIXOUT(12:13);       /*                       @OZ11673*/
         MVC   FLD2A+6(2),FIXOUT+11                                0441
*   END DATETIME;                   /*                       @OZ11673*/
@EL00006 DS    0H                                                  0442
@EF00006 DS    0H                                                  0442
@ER00006 LM    @14,@12,@SA00006                                    0442
         BR    @14                                                 0442
*                                                                  0443
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - DSCTLBRK                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - PRINT ONE LINE FOR EACH STAGING ADAPTER THAT  @OZ11673*/
*/*            HAD ACTIVITY DURING THE SELECTED TIMESLICE.   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0443
*DSCTLBRK:                                                         0443
*   PROCEDURE;                      /*                       @OZ11673*/
DSCTLBRK STM   @14,@12,@SA00007                                    0443
*   ACCUMTOT=BKT5(1,1,9);           /* T-SLICE TOT STAGNG    @ZA16140*/
         L     @08,BKT5+32                                         0444
         ST    @08,ACCUMTOT                                        0444
*   BKT5(1,1,9)=0;                  /* CLEAR TIME SLICE TOT STGNG  0445
*                                      BUCKTS                        */
         SLR   @08,@08                                             0445
         ST    @08,BKT5+32                                         0445
*   I=1;                            /* SET I TO DETAIL BUCKETS     0446
*                                                            @Y30LB40*/
         LA    I,1                                                 0446
*   CALL DATETIME;                  /* PRINT DATE & TIME     @OZ11673*/
         BAL   @14,DATETIME                                        0447
*   CALL PROCDSBK;                                                 0448
         BAL   @14,PROCDSBK                                        0448
*   END DSCTLBRK;                                                  0449
@EL00007 DS    0H                                                  0449
@EF00007 DS    0H                                                  0449
@ER00007 LM    @14,@12,@SA00007                                    0449
         BR    @14                                                 0449
*                                                                  0450
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - PROCDSBK                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION -                                               @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0450
*PROCDSBK:                                                         0450
*   PROCEDURE;                                                     0450
PROCDSBK STM   @14,@12,@SA00008                                    0450
*   J=1;                            /*                       @ZA16140*/
         LA    @07,1                                               0451
         LR    J,@07                                               0451
*   DO K=1 TO 29;                   /* LOOP THROUGH SDGS 0 - 27    0452
*                                                            @ZA16140*/
         LA    @15,1                                               0452
         LR    K,@15                                               0452
@DL00452 DS    0H                                                  0453
*     IF LINECNT>55 THEN                                           0453
         LH    @15,LINECNT                                         0453
         C     @15,@CF00749                                        0453
         BNH   @RF00453                                            0453
*       DO;                         /* SKIP TO A NEW PAGE    @Y30LB40*/
*         LINECNT=5;                /* RESET LINE COUNT      @Y30LB40*/
         MVC   LINECNT(2),@CH00372                                 0455
*         PAGECNT=PAGECNT+1;        /* UP PAGE COUNTER       @Y30LB40*/
         LA    @15,1                                               0456
         AL    @15,PAGECNT                                         0456
         ST    @15,PAGECNT                                         0456
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/
         MVC   HEADHOLD(121),HDNG1                                 0457
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/
         MVC   @AL00001+4(8),@AL00458                              0458
         LA    @15,PAGECNT                                         0458
         ST    @15,@AFTEMPS+4                                      0458
         LA    @15,@AFTEMPS+4                                      0458
         ST    @15,@AL00001                                        0458
         LA    @01,@AL00001                                        0458
         BAL   @14,EDITFIX                                         0458
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/
         MVC   HEADHOLD+117(4),FIXOUT+9                            0459
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/
         MVC   HEADHOLD+106(5),TODAY                               0460
*         RFY                                                      0461
*          (R0,                                                    0461
*           R1,                                                    0461
*           R14,                                                   0461
*           R15) RSTD;              /*                       @Y30LB40*/
*         GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES      */
         PUT   PRNTDCB,HEADHOLD
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/
         PUT   PRNTDCB,HDNG2
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/
         PUT   PRNTDCB,HDNG3
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*         RFY                                                      0466
*          (R0,                                                    0466
*           R1,                                                    0466
*           R14,                                                   0466
*           R15) UNRSTD;            /*                       @Y30LB40*/
*         FLD1=' ';                 /*                       @Y30LB40*/
         MVI   FLD1,C' '                                           0467
*       END;                        /*                       @Y30LB40*/
*     IF(K^=9&BKT5(I,J,K)^=0) THEN                                 0469
@RF00453 LA    @15,9                                               0469
         CR    K,@15                                               0469
         BE    @RF00469                                            0469
         LR    @14,I                                               0469
         ALR   @14,@14                                             0469
         ALR   @14,J                                               0469
         MH    @14,@CH00643                                        0469
         ALR   @14,K                                               0469
         SLA   @14,2                                               0469
         L     @14,BKT5-352(@14)                                   0469
         LTR   @14,@14                                             0469
         BZ    @RF00469                                            0469
*       DO;                         /*                       @ZA16140*/
*         IF K>9 THEN                                              0471
         CR    K,@15                                               0471
         BNH   @RF00471                                            0471
*           CALCFLD=K-2;            /* GET SDG NO.           @ZA16140*/
         LR    @15,K                                               0472
         BCTR  @15,0                                               0472
         BCTR  @15,0                                               0472
         ST    @15,CALCFLD                                         0472
*         ELSE                                                     0473
*           CALCFLD=K-1;            /* GET SDG NO.           @ZA16140*/
         B     @RC00471                                            0473
@RF00471 LR    @15,K                                               0473
         BCTR  @15,0                                               0473
         ST    @15,CALCFLD                                         0473
*         CALL EDITFIX(ADDR(CALCFLD),4,'N');/* EDIT SDG      @ZA16140*/
@RC00471 MVC   @AL00001+4(8),@AL00474                              0474
         LA    @15,CALCFLD                                         0474
         ST    @15,@AFTEMPS+4                                      0474
         LA    @15,@AFTEMPS+4                                      0474
         ST    @15,@AL00001                                        0474
         LA    @01,@AL00001                                        0474
         BAL   @14,EDITFIX                                         0474
*         SDGFLD=FIXOUT(12:13);     /*                       @ZA16140*/
         MVC   SDGFLD(2),FIXOUT+11                                 0475
*         IF DSBKT6(I,J,K)^=0 THEN                                 0476
         LR    @15,I                                               0476
         ALR   @15,@15                                             0476
         ALR   @15,J                                               0476
         MH    @15,@CH00643                                        0476
         ALR   @15,K                                               0476
         SLA   @15,2                                               0476
         L     @14,DSBKT6-352(@15)                                 0476
         LTR   @14,@14                                             0476
         BZ    @RF00476                                            0476
*           DO;                     /* CALC PRELOAD PERCENT          */
*             CALCFLD=DSBKT7(I,J,K)*1000;/*                  @Y30LB40*/
         L     @03,DSBKT7-352(@15)                                 0478
         MH    @03,@CH00753                                        0478
         ST    @03,CALCFLD                                         0478
*             CALCFLD2=DSBKT6(I,J,K);/*                      @Y30LB40*/
         LR    CALCFLD2,@14                                        0479
*             CALCFLD=((CALCFLD/CALCFLD2)+5)/10;                   0480
         LR    @00,@03                                             0480
         SRDA  @00,32                                              0480
         DR    @00,CALCFLD2                                        0480
         LR    @04,@01                                             0480
         AL    @04,@CF00372                                        0480
         SRDA  @04,32                                              0480
         D     @04,@CF00034                                        0480
         ST    @05,CALCFLD                                         0480
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00481                              0481
         LA    @15,CALCFLD                                         0481
         ST    @15,@AFTEMPS+4                                      0481
         LA    @15,@AFTEMPS+4                                      0481
         ST    @15,@AL00001                                        0481
         LA    @01,@AL00001                                        0481
         BAL   @14,EDITFIX                                         0481
*             DSFLD18=FIXOUT(11:13);/*                       @Y30LB40*/
         MVC   DSFLD18(3),FIXOUT+10                                0482
*           END;                    /*                       @Y30LB40*/
*         ELSE                                                     0484
*           DSFLD18(3:3)='0';       /* PRELOAD PERCENT       @Y30LB40*/
         B     @RC00476                                            0484
@RF00476 MVI   DSFLD18+2,C'0'                                      0484
*         DSBKT6(I,J,K)=0;          /* CLEAR MININUM BUCKET  @Y30LB40*/
@RC00476 SLR   @15,@15                                             0485
         LR    @14,I                                               0485
         ALR   @14,@14                                             0485
         ALR   @14,J                                               0485
         MH    @14,@CH00643                                        0485
         ALR   @14,K                                               0485
         SLA   @14,2                                               0485
         ST    @15,DSBKT6-352(@14)                                 0485
*         DSBKT7(I,J,K)=0;          /* CLEAR HITNUM BUCKET   @Y30LB40*/
         ST    @15,DSBKT7-352(@14)                                 0486
*         CALL DOCOMMON;                                           0487
         BAL   @14,DOCOMMON                                        0487
*         RFY                                                      0488
*          (R0,                                                    0488
*           R1,                                                    0488
*           R14,                                                   0488
*           R15) RSTD;              /*                       @Y30LB40*/
*         GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL LINE             */
         PUT   PRNTDCB,DSLINE
*         RFY                                                      0490
*          (R0,                                                    0490
*           R1,                                                    0490
*           R14,                                                   0490
*           R15) UNRSTD;            /*                       @Y30LB40*/
*         IF FLD1='0'               /* BUMP LINECOUNT        @Y30LB40*/
*           THEN                                                   0491
         CLI   FLD1,C'0'                                           0491
         BNE   @RF00491                                            0491
*           LINECNT=LINECNT+2;      /*                       @Y30LB40*/
         LA    @15,2                                               0492
         AH    @15,LINECNT                                         0492
         STH   @15,LINECNT                                         0492
*         ELSE                                                     0493
*           LINECNT=LINECNT+1;      /*                       @Y30LB40*/
         B     @RC00491                                            0493
@RF00491 LA    @15,1                                               0493
         AH    @15,LINECNT                                         0493
         STH   @15,LINECNT                                         0493
*         FLD1=' ';                 /* CLEAR CONSTANT INFO   @Y30LB40*/
@RC00491 MVI   FLD1,C' '                                           0494
*         FLD2=' ';                 /*                       @Y30LB40*/
         MVI   FLD2+1,C' '                                         0495
         MVC   FLD2+2(4),FLD2+1                                    0495
         MVI   FLD2,C' '                                           0495
*         FLD2A=' ';                /*                       @Y30LB40*/
         MVI   FLD2A+1,C' '                                        0496
         MVC   FLD2A+2(6),FLD2A+1                                  0496
         MVI   FLD2A,C' '                                          0496
*       END;                        /*                       @Y30LB40*/
*   END;                            /*                       @Y30LB40*/
@RF00469 AL    K,@CF00044                                          0498
         C     K,@CF00643                                          0498
         BNH   @DL00452                                            0498
*   END PROCDSBK;                   /*                       @OZ11673*/
@EL00008 DS    0H                                                  0499
@EF00008 DS    0H                                                  0499
@ER00008 LM    @14,@12,@SA00008                                    0499
         BR    @14                                                 0499
*                                                                  0500
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - TESTEOF                                 @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - IF THE LAST RECORD HAS BEEN ENCOUNTERED,      @OZ11673*/
*/*            FIRST WRITE TOTALS FOR THE REPORT TYPE, AND   @OZ11673*/
*/*            THEN WRITE COMMON JOB-END TOTALS.             @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0500
*TESTEOF:                                                          0500
*   PROCEDURE;                      /*                       @OZ11673*/
TESTEOF  STM   @14,@05,@SA00009                                    0500
         STM   @07,@12,@SA00009+32                                 0500
*   RFY                                                            0501
*    (R0,                                                          0501
*     R1,                                                          0501
*     R14,                                                         0501
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(PUT   PRNTDCB,SPACE1);      /* SKIP A LINE           @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*   RFY                                                            0503
*    (R0,                                                          0503
*     R1,                                                          0503
*     R14,                                                         0503
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/
         LA    @08,1                                               0504
         AH    @08,LINECNT                                         0504
         STH   @08,LINECNT                                         0504
*   I=2;                            /* INDICATE REPORT TOTALS WANTED */
         LA    I,2                                                 0505
*   DSLINE=' ';                     /*                       @Y30LB40*/
         MVI   DSLINE+1,C' '                                       0506
         MVC   DSLINE+2(123),DSLINE+1                              0506
         MVI   DSLINE,C' '                                         0506
*   FLD2='TOTALS';                  /* SETUP CONSTANT INFO   @OZ11673*/
         MVC   FLD2(6),@CC00758                                    0507
*   IF PARMSW='R' THEN                                             0508
         CLI   PARMSW,C'R'                                         0508
         BNE   @RF00508                                            0508
*     ACCUMTOT=BKT5(2,1,9)+BKT5(2,2,9);/*                    @OZ11673*/
         L     @08,BKT5+264                                        0509
         AL    @08,BKT5+380                                        0509
         ST    @08,ACCUMTOT                                        0509
*   ELSE                                                           0510
*     ACCUMTOT=BKT5(2,1,9);         /*                       @ZA16140*/
         B     @RC00508                                            0510
@RF00508 L     @08,BKT5+264                                        0510
         ST    @08,ACCUMTOT                                        0510
*   IF PARMSW='R'                   /*                       @OZ11673*/
*     THEN                          /*                       @OZ11673*/
@RC00508 CLI   PARMSW,C'R'                                         0511
         BNE   @RF00511                                            0511
*     CALL PROCRWBK;                /*                       @OZ11673*/
         BAL   @14,PROCRWBK                                        0512
*   ELSE                            /*                       @OZ11673*/
*     CALL PROCDSBK;                /* WRITE REPORT TOTALS   @OZ11673*/
         B     @RC00511                                            0513
@RF00511 BAL   @14,PROCDSBK                                        0513
*   END TESTEOF;                    /* NEXT SLICE PERIOD     @OZ11673*/
@EL00009 DS    0H                                                  0514
@EF00009 DS    0H                                                  0514
@ER00009 LM    @14,@05,@SA00009                                    0514
         LM    @07,@12,@SA00009+32                                 0514
         BR    @14                                                 0514
*                                                                  0515
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0515
*GETSLICE:                                                         0515
*   PROCEDURE;                      /*                       @OZ11673*/
GETSLICE STM   @14,@12,12(@13)                                     0515
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/
         B     @DE00516                                            0516
@DL00516 DS    0H                                                  0517
*     TSBEG=TSEND;                  /*                       @Y30LB40*/
         MVC   TSBEG(7),TSEND                                      0517
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/
         L     @08,TSETIME                                         0518
         AL    @08,TIMESL                                          0518
         ST    @08,TSETIME                                         0518
*     IF TSETIME>86399 THEN                                        0519
         C     @08,@CF00705                                        0519
         BNH   @RF00519                                            0519
*       DO;                         /*                       @Y30LB40*/
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/
         SL    @08,@CF00763                                        0521
         ST    @08,TSETIME                                         0521
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/
         LA    @08,1                                               0522
         LH    @15,TSEDAY                                          0522
         ALR   @15,@08                                             0522
         STH   @15,TSEDAY                                          0522
*         IF TSEDAY>365 THEN                                       0523
         C     @15,@CF00704                                        0523
         BNH   @RF00523                                            0523
*           DO;                     /*                       @Y30LB40*/
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0525
         MVC   @TS00001(1),TSEND                                   0525
         NI    @TS00001,B'00000011'                                0525
         CLI   @TS00001,B'00000000'                                0525
         BNE   @RF00525                                            0525
*               IF TSEDAY>366 THEN                                 0526
         LA    @14,366                                             0526
         CR    @15,@14                                             0526
         BNH   @RF00526                                            0526
*                 DO;               /*                       @Y30LB40*/
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/
         SLR   @15,@14                                             0528
         STH   @15,TSEDAY                                          0528
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/
         SLR   @15,@15                                             0529
         IC    @15,TSEYR                                           0529
         ALR   @08,@15                                             0529
         STC   @08,TSEYR                                           0529
*                 END;              /*                       @Y30LB40*/
*               ELSE                                               0531
*                 ;                 /*                       @Y30LB40*/
@RF00526 DS    0H                                                  0532
*             ELSE                                                 0532
*               DO;                 /*                       @Y30LB40*/
         B     @RC00525                                            0532
@RF00525 DS    0H                                                  0533
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/
         LH    @08,TSEDAY                                          0533
         SL    @08,@CF00704                                        0533
         STH   @08,TSEDAY                                          0533
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/
         LA    @08,1                                               0534
         SLR   @15,@15                                             0534
         IC    @15,TSEYR                                           0534
         ALR   @08,@15                                             0534
         STC   @08,TSEYR                                           0534
*               END;                /*                       @Y30LB40*/
*           END;                    /*                       @Y30LB40*/
@RC00525 DS    0H                                                  0537
*       END;                        /*                       @Y30LB40*/
@RF00523 DS    0H                                                  0538
*   END;                            /*                       @Y30LB40*/
@RF00519 DS    0H                                                  0538
@DE00516 CLC   CKTIME(7),TSEND                                     0538
         BH    @DL00516                                            0538
*   END GETSLICE;                   /*                       @OZ11673*/
@EL00010 DS    0H                                                  0539
@EF00010 DS    0H                                                  0539
@ER00010 LM    @14,@12,12(@13)                                     0539
         BR    @14                                                 0539
*                                                                  0540
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - BUCKETS                                 @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - UPDATE THOSE BUCKETS THAT ARE COMMON TO BOTH  @OZ11673*/
*/*            THE STAGING ADAPTER ACTIVITY REPORT ABD THE   @OZ11673*/
*/*            DATA RECORDING DEVICE ACTIVITY REPORT.        @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0540
*BUCKETS:                                                          0540
*   PROCEDURE;                      /*                       @OZ11673*/
BUCKETS  STM   @14,@12,12(@13)                                     0540
*   BKT1(I,J,K)=BKT1(I,J,K)+STGD;   /* CYLS STAGED           @OZ11673*/
         LR    @15,I                                               0541
         ALR   @15,@15                                             0541
         ALR   @15,J                                               0541
         LR    @14,@15                                             0541
         MH    @14,@CH00643                                        0541
         ALR   @14,K                                               0541
         SLA   @14,2                                               0541
         L     @05,STGD                                            0541
         L     @04,BKT1-352(@14)                                   0541
         ALR   @04,@05                                             0541
         ST    @04,BKT1-352(@14)                                   0541
*   BKT2(I,J,K)=BKT2(I,J,K)+CFAULT; /* C FAULT CSD           @OZ11673*/
         L     @04,BKT2-352(@14)                                   0542
         AL    @04,CFAULT                                          0542
         ST    @04,BKT2-352(@14)                                   0542
*   BKT3(I,J,K)=BKT3(I,J,K)+DSTGD;  /* CYLS DESTAGED         @OZ11673*/
         L     @04,DSTGD                                           0543
         L     @03,BKT3-352(@14)                                   0543
         ALR   @03,@04                                             0543
         ST    @03,BKT3-352(@14)                                   0543
*   BKT4(I,J,K)=BKT4(I,J,K)+SALLOC; /* S ALLOC CSD           @OZ11673*/
         L     @03,BKT4-352(@14)                                   0544
         AL    @03,SALLOC                                          0544
         ST    @03,BKT4-352(@14)                                   0544
*   BKT5(I,J,K)=BKT5(I,J,K)+(STGD+DSTGD);/* TOT STAGING              */
         ALR   @05,@04                                             0545
         L     @04,BKT5-352(@14)                                   0545
         ALR   @04,@05                                             0545
         ST    @04,BKT5-352(@14)                                   0545
*   BKT5(I,J,9)=BKT5(I,J,9)+(STGD+DSTGD);/*                  @OZ11673*/
         MH    @15,@CH00823                                        0546
         AL    @05,BKT5-316(@15)                                   0546
         ST    @05,BKT5-316(@15)                                   0546
*   END BUCKETS;                    /*                       @OZ11673*/
@EL00011 DS    0H                                                  0547
@EF00011 DS    0H                                                  0547
@ER00011 LM    @14,@12,12(@13)                                     0547
         BR    @14                                                 0547
*                                                                  0548
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - RWACCUM                                 @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - ACCUMULATE TOTALS FROM DETAIL FOR DATA        @OZ11673*/
*/*            RECORDING DEVICE ACTIVITY REPORT.             @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0548
*RWACCUM:                                                          0548
*   PROCEDURE;                      /*                       @OZ11673*/
RWACCUM  STM   @14,@12,@SA00012                                    0548
*   J=LIBRARY+1;                    /* ALLOW FOR LIBRARY 0   @Y30LB40*/
         LA    @06,1                                               0549
         SLR   J,J                                                 0549
         IC    J,LIBRARY                                           0549
         ALR   J,@06                                               0549
*   K=READWRIT+1;                   /* ALLOW FOR READ/WRITE UNIT 0   */
         SLR   K,K                                                 0550
         IC    K,READWRIT                                          0550
         ALR   @06,K                                               0550
         LR    K,@06                                               0550
*   IF K>8 THEN                                                    0551
         LA    @06,8                                               0551
         CR    K,@06                                               0551
         BNH   @RF00551                                            0551
*     K=8;                          /* SET TO MAX VALUE      @Y30LB40*/
         LR    K,@06                                               0552
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0553
*                                      TOTALS                @Y30LB40*/
@RF00551 LA    I,1                                                 0553
@DL00553 DS    0H                                                  0554
*     CALL BUCKETS;                                                0554
         BAL   @14,BUCKETS                                         0554
*     BKT6(I,J,K)=BKT6(I,J,K)+LOADNUM;/* NO. OF LOADS                */
         LR    @15,I                                               0555
         ALR   @15,@15                                             0555
         ALR   @15,J                                               0555
         MH    @15,@CH00643                                        0555
         ALR   @15,K                                               0555
         SLA   @15,2                                               0555
         SLR   @14,@14                                             0555
         IC    @14,LOADNUM                                         0555
         AL    @14,BKT6-352(@15)                                   0555
         ST    @14,BKT6-352(@15)                                   0555
*     BKT7(I,J,K)=BKT7(I,J,K)+LOADTIME;/* LOAD TIME          @Y30LB40*/
         L     @14,BKT7-352(@15)                                   0556
         AL    @14,LOADTIME                                        0556
         ST    @14,BKT7-352(@15)                                   0556
*   END;                            /*                       @Y30LB40*/
         AL    I,@CF00044                                          0557
         C     I,@CF00051                                          0557
         BNH   @DL00553                                            0557
*   END RWACCUM;                    /*                       @OZ11673*/
@EL00012 DS    0H                                                  0558
@EF00012 DS    0H                                                  0558
@ER00012 LM    @14,@12,@SA00012                                    0558
         BR    @14                                                 0558
*                                                                  0559
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - RWCTLBRK                                @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0559
*RWCTLBRK:                                                         0559
*   PROCEDURE;                                                     0559
RWCTLBRK STM   @14,@12,@SA00013                                    0559
*   ACCUMTOT=0;                     /*                       @Y30LB40*/
         SLR   @08,@08                                             0560
         ST    @08,ACCUMTOT                                        0560
*   DO J=1 TO 2;                    /*                       @ZA16140*/
         LA    J,1                                                 0561
@DL00561 DS    0H                                                  0562
*     ACCUMTOT=ACCUMTOT+BKT5(1,J,9);/* TSLICE TOT STGNG              */
         LR    @15,J                                               0562
         MH    @15,@CH00823                                        0562
         L     @14,ACCUMTOT                                        0562
         AL    @14,BKT5-84(@15)                                    0562
         ST    @14,ACCUMTOT                                        0562
*     BKT5(1,J,9)=0;                /*                       @Y30LB40*/
         SLR   @14,@14                                             0563
         ST    @14,BKT5-84(@15)                                    0563
*   END;                            /*                       @Y30LB40*/
         AL    J,@CF00044                                          0564
         C     J,@CF00051                                          0564
         BNH   @DL00561                                            0564
*   I=1;                            /* SET I TO DETAIL BUCKETS     0565
*                                                            @Y30LB40*/
         LA    I,1                                                 0565
*   CALL DATETIME;                  /*                       @OZ11673*/
         BAL   @14,DATETIME                                        0566
*   CALL PROCRWBK;                                                 0567
         BAL   @14,PROCRWBK                                        0567
*   END RWCTLBRK;                                                  0568
@EL00013 DS    0H                                                  0568
@EF00013 DS    0H                                                  0568
@ER00013 LM    @14,@12,@SA00013                                    0568
         BR    @14                                                 0568
*                                                                  0569
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - PROCRWBK                                @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0569
*PROCRWBK:                                                         0569
*   PROCEDURE;                                                     0569
PROCRWBK STM   @14,@12,@SA00014                                    0569
*   DO J=1 TO 2;                    /* LOOP THROUGH LIBRARIES      0570
*                                                            @ZA16140*/
         LA    J,1                                                 0570
@DL00570 DS    0H                                                  0571
*     DO K=1 TO 8;                  /* LOOP THROUGH READ WRITE UNITS
*                                                            @ZA16140*/
         LA    K,1                                                 0571
@DL00571 DS    0H                                                  0572
*       IF LINECNT>55 THEN                                         0572
         LH    @15,LINECNT                                         0572
         C     @15,@CF00749                                        0572
         BNH   @RF00572                                            0572
*         DO;                       /* SKIP TO A NEW PAGE    @Y30LB40*/
*           LINECNT=5;              /* RESET LINE COUNT      @Y30LB40*/
         MVC   LINECNT(2),@CH00372                                 0574
*           PAGECNT=PAGECNT+1;      /* UP PAGE COUNTER       @Y30LB40*/
         LA    @15,1                                               0575
         AL    @15,PAGECNT                                         0575
         ST    @15,PAGECNT                                         0575
*           HEADHOLD=HDNGA;         /*                       @Y30LB40*/
         MVC   HEADHOLD(121),HDNGA                                 0576
*           CALL EDITFIX(ADDR(PAGECNT),4,'S');/*             @Y30LB40*/
         MVC   @AL00001+4(8),@AL00577                              0577
         LA    @15,PAGECNT                                         0577
         ST    @15,@AFTEMPS+8                                      0577
         LA    @15,@AFTEMPS+8                                      0577
         ST    @15,@AL00001                                        0577
         LA    @01,@AL00001                                        0577
         BAL   @14,EDITFIX                                         0577
*           HEADHOLD(118:121)=FIXOUT(10:13);/*               @Y30LB40*/
         MVC   HEADHOLD+117(4),FIXOUT+9                            0578
*           HEADHOLD(107:111)=TODAY;/*                       @Y30LB40*/
         MVC   HEADHOLD+106(5),TODAY                               0579
*           RFY                                                    0580
*            (R0,                                                  0580
*             R1,                                                  0580
*             R14,                                                 0580
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES    */
         PUT   PRNTDCB,HEADHOLD
*           GEN(PUT   PRNTDCB,HDNGB);/*                      @Y30LB40*/
         PUT   PRNTDCB,HDNGB
*           GEN(PUT   PRNTDCB,HDNGC);/*                      @Y30LB40*/
         PUT   PRNTDCB,HDNGC
*           GEN(PUT   PRNTDCB,SPACE1);/*                     @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*           RFY                                                    0585
*            (R0,                                                  0585
*             R1,                                                  0585
*             R14,                                                 0585
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           FLD1=' ';               /*                       @Y30LB40*/
         MVI   FLD1,C' '                                           0586
*         END;                      /*                       @Y30LB40*/
*       IF BKT5(I,J,K)^=0 THEN                                     0588
@RF00572 LR    @15,I                                               0588
         ALR   @15,@15                                             0588
         ALR   @15,J                                               0588
         MH    @15,@CH00643                                        0588
         ALR   @15,K                                               0588
         SLA   @15,2                                               0588
         L     @15,BKT5-352(@15)                                   0588
         LTR   @15,@15                                             0588
         BZ    @RF00588                                            0588
*         DO;                       /* PROCESS ALL NON 0 BUCKETS     */
*           RWFLD4=SSIDEQ(J);       /* 2ND INDEX = MSF       @OZ05079*/
         LA    @01,SSIDEQ-1(J)                                     0590
         MVC   RWFLD4(1),0(@01)                                    0590
*           CHAR2='2';              /* ALWAYS 2 FOR DRD      @OZ05079*/
         MVI   CHAR2,C'2'                                          0591
*           DRDMSFID=SSIDEQ(J);     /* 2ND CHAR = MSF        @OZ05079*/
         LA    @01,SSIDEQ-1(J)                                     0592
         MVC   DRDMSFID(1),0(@01)                                  0592
*           RWFLD6=SSIDEQ(K);       /* PHYSICAL DRD          @OZ05079*/
         LA    @01,SSIDEQ-1(K)                                     0593
         MVC   RWFLD6(1),0(@01)                                    0593
*           CALL DOCOMMON;          /*                       @OZ11673*/
         BAL   @14,DOCOMMON                                        0594
*           CALL EDITFIX(ADDR(BKT6(I,J,K)),4,'E');/*         @OZ11673*/
         MVC   @AL00001+4(8),@AL00595                              0595
         LR    @15,I                                               0595
         ALR   @15,@15                                             0595
         ALR   @15,J                                               0595
         MH    @15,@CH00643                                        0595
         ALR   @15,K                                               0595
         SLA   @15,2                                               0595
         LA    @15,BKT6-352(@15)                                   0595
         ST    @15,@AFTEMPS+8                                      0595
         LA    @15,@AFTEMPS+8                                      0595
         ST    @15,@AL00001                                        0595
         LA    @01,@AL00001                                        0595
         BAL   @14,EDITFIX                                         0595
*           RWFLD18=FIXOUT(8:13);   /* NO. OF CARTRIDGE LOADS        */
         MVC   RWFLD18(6),FIXOUT+7                                 0596
*           BKT7(I,J,K)=BKT7(I,J,K)/4;/* LOAD TIME TO SECS           */
         LR    @15,I                                               0597
         ALR   @15,@15                                             0597
         ALR   @15,J                                               0597
         MH    @15,@CH00643                                        0597
         ALR   @15,K                                               0597
         SLA   @15,2                                               0597
         L     @00,BKT7-352(@15)                                   0597
         SRDA  @00,32                                              0597
         D     @00,@CF00104                                        0597
         ST    @01,BKT7-352(@15)                                   0597
*           CALL EDITFIX(ADDR(BKT7(I,J,K)),4,'E');/*         @OZ11673*/
         MVC   @AL00001+4(8),@AL00598                              0598
         LA    @15,BKT7-352(@15)                                   0598
         ST    @15,@AFTEMPS+8                                      0598
         LA    @15,@AFTEMPS+8                                      0598
         ST    @15,@AL00001                                        0598
         LA    @01,@AL00001                                        0598
         BAL   @14,EDITFIX                                         0598
*           RWFLD20=FIXOUT(8:13);   /* LOAD TIME             @Y30LB40*/
         MVC   RWFLD20(6),FIXOUT+7                                 0599
*           IF BKT6(I,J,K)>0 THEN                                  0600
         LR    @15,I                                               0600
         ALR   @15,@15                                             0600
         ALR   @15,J                                               0600
         MH    @15,@CH00643                                        0600
         ALR   @15,K                                               0600
         SLA   @15,2                                               0600
         L     @14,BKT6-352(@15)                                   0600
         LTR   @14,@14                                             0600
         BNP   @RF00600                                            0600
*             DO;                   /*                       @OZ11673*/
*               CALCFLD=(BKT7(I,J,K)/BKT6(I,J,K));/* C RATE          */
         L     @00,BKT7-352(@15)                                   0602
         SRDA  @00,32                                              0602
         DR    @00,@14                                             0602
         ST    @01,CALCFLD                                         0602
*               CALL EDITFIX(ADDR(CALCFLD),4,'E');/*         @OZ11673*/
         MVC   @AL00001+4(8),@AL00603                              0603
         LA    @15,CALCFLD                                         0603
         ST    @15,@AFTEMPS+8                                      0603
         LA    @15,@AFTEMPS+8                                      0603
         ST    @15,@AL00001                                        0603
         LA    @01,@AL00001                                        0603
         BAL   @14,EDITFIX                                         0603
*               RWFLD22=FIXOUT(8:13);/* C RATE               @Y30LB40*/
         MVC   RWFLD22(6),FIXOUT+7                                 0604
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0606
*             RWFLD22(6:6)='0';     /*                       @Y30LB40*/
         B     @RC00600                                            0606
@RF00600 MVI   RWFLD22+5,C'0'                                      0606
*           BKT6(I,J,K)=0;          /*                       @OZ11673*/
@RC00600 SLR   @15,@15                                             0607
         LR    @14,I                                               0607
         ALR   @14,@14                                             0607
         ALR   @14,J                                               0607
         MH    @14,@CH00643                                        0607
         ALR   @14,K                                               0607
         SLA   @14,2                                               0607
         ST    @15,BKT6-352(@14)                                   0607
*           BKT7(I,J,K)=0;          /*                       @OZ11673*/
         ST    @15,BKT7-352(@14)                                   0608
*           RFY                                                    0609
*            (R0,                                                  0609
*             R1,                                                  0609
*             R14,                                                 0609
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL PRINT LINE     */
         PUT   PRNTDCB,DSLINE
*           RFY                                                    0611
*            (R0,                                                  0611
*             R1,                                                  0611
*             R14,                                                 0611
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           IF FLD1='0'             /* BUMP LINE COUNT       @OZ11673*/
*             THEN                                                 0612
         CLI   FLD1,C'0'                                           0612
         BNE   @RF00612                                            0612
*             LINECNT=LINECNT+2;    /*                       @Y30LB40*/
         LA    @15,2                                               0613
         AH    @15,LINECNT                                         0613
         STH   @15,LINECNT                                         0613
*           ELSE                                                   0614
*             LINECNT=LINECNT+1;    /*                       @Y30LB40*/
         B     @RC00612                                            0614
@RF00612 LA    @15,1                                               0614
         AH    @15,LINECNT                                         0614
         STH   @15,LINECNT                                         0614
*           FLD1=' ';               /*                       @OZ11673*/
@RC00612 MVI   FLD1,C' '                                           0615
*           FLD2=' ';               /* CLEAR CONSTANT INFO   @OZ11673*/
         MVI   FLD2+1,C' '                                         0616
         MVC   FLD2+2(4),FLD2+1                                    0616
         MVI   FLD2,C' '                                           0616
*           FLD2A=' ';              /*                       @OZ11673*/
         MVI   FLD2A+1,C' '                                        0617
         MVC   FLD2A+2(6),FLD2A+1                                  0617
         MVI   FLD2A,C' '                                          0617
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0619
*         ;                         /*                       @Y30LB40*/
@RF00588 DS    0H                                                  0620
*     END;                          /*                       @Y30LB40*/
         AL    K,@CF00044                                          0620
         C     K,@CF00069                                          0620
         BNH   @DL00571                                            0620
*   END;                            /*                       @Y30LB40*/
         AL    J,@CF00044                                          0621
         C     J,@CF00051                                          0621
         BNH   @DL00570                                            0621
*   END PROCRWBK;                                                  0622
@EL00014 DS    0H                                                  0622
@EF00014 DS    0H                                                  0622
@ER00014 LM    @14,@12,@SA00014                                    0622
         BR    @14                                                 0622
*                                                                  0623
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - DOCOMMON                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - SET UP PRINT FOR BUCKETS THAT ARE COMMON TO   @OZ11673*/
*/*            BOTH THE STAGING ADAPTER ACTIVITY REPORT AND  @OZ11673*/
*/*            THE DATA RECORDING DEVICE ACTIVITY REPORT.    @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0623
*DOCOMMON:                                                         0623
*   PROCEDURE;                      /*                       @OZ11673*/
DOCOMMON STM   @14,@12,@SA00015                                    0623
*   CALL EDITFIX(ADDR(BKT1(I,J,K)),4,'E');/*                 @OZ11673*/
         MVC   @AL00001+4(8),@AL00624                              0624
         LR    @15,I                                               0624
         ALR   @15,@15                                             0624
         ALR   @15,J                                               0624
         MH    @15,@CH00643                                        0624
         ALR   @15,K                                               0624
         SLA   @15,2                                               0624
         LA    @15,BKT1-352(@15)                                   0624
         ST    @15,@AFTEMPS+12                                     0624
         LA    @15,@AFTEMPS+12                                     0624
         ST    @15,@AL00001                                        0624
         LA    @01,@AL00001                                        0624
         BAL   @14,EDITFIX                                         0624
*   FLD8=FIXOUT(3:13);              /* CYLINDERS STAGED      @OZ11673*/
         MVC   FLD8(11),FIXOUT+2                                   0625
*   BKT1(I,J,K)=0;                  /* CLEAR CYLS STAGED     @OZ11673*/
         LR    @15,I                                               0626
         ALR   @15,@15                                             0626
         ALR   @15,J                                               0626
         MH    @15,@CH00643                                        0626
         ALR   @15,K                                               0626
         SLA   @15,2                                               0626
         SLR   @14,@14                                             0626
         ST    @14,BKT1-352(@15)                                   0626
*   CALL EDITFIX(ADDR(BKT2(I,J,K)),4,'E');/*                 @OZ11673*/
         MVC   @AL00001+4(8),@AL00627                              0627
         LA    @15,BKT2-352(@15)                                   0627
         ST    @15,@AFTEMPS+12                                     0627
         LA    @15,@AFTEMPS+12                                     0627
         ST    @15,@AL00001                                        0627
         LA    @01,@AL00001                                        0627
         BAL   @14,EDITFIX                                         0627
*   FLD9=FIXOUT(3:13);              /* CYL FAULT CAUSED      @OZ11673*/
         MVC   FLD9(11),FIXOUT+2                                   0628
*   BKT2(I,J,K)=0;                  /* CLEAR CYL FAULT CAUSED      0629
*                                                            @OZ11673*/
         LR    @15,I                                               0629
         ALR   @15,@15                                             0629
         ALR   @15,J                                               0629
         MH    @15,@CH00643                                        0629
         ALR   @15,K                                               0629
         SLA   @15,2                                               0629
         SLR   @14,@14                                             0629
         ST    @14,BKT2-352(@15)                                   0629
*   CALL EDITFIX(ADDR(BKT3(I,J,K)),4,'E');/*                 @OZ11673*/
         MVC   @AL00001+4(8),@AL00630                              0630
         LA    @15,BKT3-352(@15)                                   0630
         ST    @15,@AFTEMPS+12                                     0630
         LA    @15,@AFTEMPS+12                                     0630
         ST    @15,@AL00001                                        0630
         LA    @01,@AL00001                                        0630
         BAL   @14,EDITFIX                                         0630
*   FLD11=FIXOUT(3:13);             /* CYLINDERS DESTAGED    @OZ11673*/
         MVC   FLD11(11),FIXOUT+2                                  0631
*   BKT3(I,J,K)=0;                  /* CLEAR CYLS DESTAGED   @OZ11673*/
         LR    @15,I                                               0632
         ALR   @15,@15                                             0632
         ALR   @15,J                                               0632
         MH    @15,@CH00643                                        0632
         ALR   @15,K                                               0632
         SLA   @15,2                                               0632
         SLR   @14,@14                                             0632
         ST    @14,BKT3-352(@15)                                   0632
*   CALL EDITFIX(ADDR(BKT4(I,J,K)),4,'E');/*                 @OZ11673*/
         MVC   @AL00001+4(8),@AL00633                              0633
         LA    @15,BKT4-352(@15)                                   0633
         ST    @15,@AFTEMPS+12                                     0633
         LA    @15,@AFTEMPS+12                                     0633
         ST    @15,@AL00001                                        0633
         LA    @01,@AL00001                                        0633
         BAL   @14,EDITFIX                                         0633
*   FLD12=FIXOUT(3:13);             /* SPACE ALLOC CAUSED    @OZ11673*/
         MVC   FLD12(11),FIXOUT+2                                  0634
*   BKT4(I,J,K)=0;                  /* CLEAR SPACE ALLOC     @OZ11673*/
         LR    @15,I                                               0635
         ALR   @15,@15                                             0635
         ALR   @15,J                                               0635
         MH    @15,@CH00643                                        0635
         ALR   @15,K                                               0635
         SLA   @15,2                                               0635
         SLR   @14,@14                                             0635
         ST    @14,BKT4-352(@15)                                   0635
*   CALL EDITFIX(ADDR(BKT5(I,J,K)),4,'E');/*                 @OZ11673*/
         MVC   @AL00001+4(8),@AL00636                              0636
         LA    @15,BKT5-352(@15)                                   0636
         ST    @15,@AFTEMPS+12                                     0636
         LA    @15,@AFTEMPS+12                                     0636
         ST    @15,@AL00001                                        0636
         LA    @01,@AL00001                                        0636
         BAL   @14,EDITFIX                                         0636
*   FLD14=FIXOUT(3:13);             /* TOTAL STAGING ACTIVITY      0637
*                                                            @OZ11673*/
         MVC   FLD14(11),FIXOUT+2                                  0637
*   CALCFLD=BKT5(I,J,K)*1000;       /*                       @OZ11673*/
         LR    @15,I                                               0638
         ALR   @15,@15                                             0638
         ALR   @15,J                                               0638
         MH    @15,@CH00643                                        0638
         ALR   @15,K                                               0638
         SLA   @15,2                                               0638
         L     @15,BKT5-352(@15)                                   0638
         MH    @15,@CH00753                                        0638
         ST    @15,CALCFLD                                         0638
*   CALCFLD=((CALCFLD/ACCUMTOT)+5)/10;/*                     @OZ11673*/
         LR    @00,@15                                             0639
         SRDA  @00,32                                              0639
         D     @00,ACCUMTOT                                        0639
         LR    @02,@01                                             0639
         AL    @02,@CF00372                                        0639
         SRDA  @02,32                                              0639
         D     @02,@CF00034                                        0639
         ST    @03,CALCFLD                                         0639
*   CALL EDITFIX(ADDR(CALCFLD),4,'S');/*                     @OZ11673*/
         MVC   @AL00001+4(8),@AL00640                              0640
         LA    @15,CALCFLD                                         0640
         ST    @15,@AFTEMPS+12                                     0640
         LA    @15,@AFTEMPS+12                                     0640
         ST    @15,@AL00001                                        0640
         LA    @01,@AL00001                                        0640
         BAL   @14,EDITFIX                                         0640
*   FLD16=FIXOUT(11:13);            /* TIME SLICE PERCENT    @OZ11673*/
         MVC   FLD16(3),FIXOUT+10                                  0641
*   BKT5(I,J,K)=0;                  /* CLEAR TOT STAGING     @OZ11673*/
         LR    @15,I                                               0642
         ALR   @15,@15                                             0642
         ALR   @15,J                                               0642
         MH    @15,@CH00643                                        0642
         ALR   @15,K                                               0642
         SLA   @15,2                                               0642
         SLR   @14,@14                                             0642
         ST    @14,BKT5-352(@15)                                   0642
*   END DOCOMMON;                   /*                       @OZ11673*/
@EL00015 DS    0H                                                  0643
@EF00015 DS    0H                                                  0643
@ER00015 LM    @14,@12,@SA00015                                    0643
         BR    @14                                                 0643
*EOF:                               /* END OF FILE FOUND     @Y30LB40*/
*   EOFSW='1'B;                     /* INDICATE END OF FILE HIT    0644
*                                                            @Y30LB40*/
EOF      OI    EOFSW,B'10000000'                                   0644
*   GO TO CHECKEOF;                                                0645
         B     CHECKEOF                                            0645
*                                                                  0646
*/********************************************************************
*                                                                    */
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0646
*EOJ:                                                              0646
*   PROCEDURE;                                                     0646
EOJ      STM   @14,@12,@SA00016                                    0646
*   DSLINE=RCDTOTAL;                /*                       @Y30LB40*/
         MVI   DSLINE+121,C' '                                     0647
         MVC   DSLINE+122(3),DSLINE+121                            0647
         MVC   DSLINE(121),RCDTOTAL                                0647
*   DSLINE(16:16)=PARMSW;           /*                       @Y30LB40*/
         MVC   DSLINE+15(1),PARMSW                                 0648
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/
         L     @00,TIMESL                                          0649
         SRDA  @00,32                                              0649
         D     @00,@CF00335                                        0649
         ST    @01,TIMESL                                          0649
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00650                              0650
         LA    @06,TIMESL                                          0650
         ST    @06,@AFTEMPS+16                                     0650
         LA    @06,@AFTEMPS+16                                     0650
         ST    @06,@AL00001                                        0650
         LA    @01,@AL00001                                        0650
         BAL   @14,EDITFIX                                         0650
*   DSLINE(29:31)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+28(3),FIXOUT+10                              0651
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00652                              0652
         LA    @06,HLDSYR                                          0652
         ST    @06,@AFTEMPS+16                                     0652
         LA    @06,@AFTEMPS+16                                     0652
         ST    @06,@AL00001                                        0652
         LA    @01,@AL00001                                        0652
         BAL   @14,EDITFIX                                         0652
*   DSLINE(42:43)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+41(2),FIXOUT+11                              0653
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00654                              0654
         LA    @06,HLDSDAY                                         0654
         ST    @06,@AFTEMPS+16                                     0654
         LA    @06,@AFTEMPS+16                                     0654
         ST    @06,@AL00001                                        0654
         LA    @01,@AL00001                                        0654
         BAL   @14,EDITFIX                                         0654
*   DSLINE(44:46)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+43(3),FIXOUT+10                              0655
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00656                              0656
         LA    @06,HLDEYR                                          0656
         ST    @06,@AFTEMPS+16                                     0656
         LA    @06,@AFTEMPS+16                                     0656
         ST    @06,@AL00001                                        0656
         LA    @01,@AL00001                                        0656
         BAL   @14,EDITFIX                                         0656
*   DSLINE(48:49)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+47(2),FIXOUT+11                              0657
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00658                              0658
         LA    @06,HLDEDAY                                         0658
         ST    @06,@AFTEMPS+16                                     0658
         LA    @06,@AFTEMPS+16                                     0658
         ST    @06,@AL00001                                        0658
         LA    @01,@AL00001                                        0658
         BAL   @14,EDITFIX                                         0658
*   DSLINE(50:52)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+49(3),FIXOUT+10                              0659
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/
         L     @06,HLDSTIME                                        0660
         LA    @15,3600                                            0660
         LR    @00,@06                                             0660
         SRDA  @00,32                                              0660
         DR    @00,@15                                             0660
         ST    @01,HOUR                                            0660
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@15                                             0661
         LR    @02,@06                                             0661
         SLR   @02,@01                                             0661
         SRDA  @02,32                                              0661
         D     @02,@CF00335                                        0661
         ST    @03,MINUTE                                          0661
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00662                              0662
         LA    @06,HOUR                                            0662
         ST    @06,@AFTEMPS+16                                     0662
         LA    @06,@AFTEMPS+16                                     0662
         ST    @06,@AL00001                                        0662
         LA    @01,@AL00001                                        0662
         BAL   @14,EDITFIX                                         0662
*   DSLINE(63:64)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+62(2),FIXOUT+11                              0663
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00664                              0664
         LA    @06,MINUTE                                          0664
         ST    @06,@AFTEMPS+16                                     0664
         LA    @06,@AFTEMPS+16                                     0664
         ST    @06,@AL00001                                        0664
         LA    @01,@AL00001                                        0664
         BAL   @14,EDITFIX                                         0664
*   DSLINE(65:66)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+64(2),FIXOUT+11                              0665
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/
         L     @06,HLDETIME                                        0666
         LA    @15,3600                                            0666
         LR    @00,@06                                             0666
         SRDA  @00,32                                              0666
         DR    @00,@15                                             0666
         ST    @01,HOUR                                            0666
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@15                                             0667
         LR    @02,@06                                             0667
         SLR   @02,@01                                             0667
         SRDA  @02,32                                              0667
         D     @02,@CF00335                                        0667
         ST    @03,MINUTE                                          0667
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00668                              0668
         LA    @06,HOUR                                            0668
         ST    @06,@AFTEMPS+16                                     0668
         LA    @06,@AFTEMPS+16                                     0668
         ST    @06,@AL00001                                        0668
         LA    @01,@AL00001                                        0668
         BAL   @14,EDITFIX                                         0668
*   DSLINE(68:69)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+67(2),FIXOUT+11                              0669
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00670                              0670
         LA    @06,MINUTE                                          0670
         ST    @06,@AFTEMPS+16                                     0670
         LA    @06,@AFTEMPS+16                                     0670
         ST    @06,@AL00001                                        0670
         LA    @01,@AL00001                                        0670
         BAL   @14,EDITFIX                                         0670
*   DSLINE(70:71)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+69(2),FIXOUT+11                              0671
*   IF SELECTSW='1'B                /* PRINT THE SDG OR LU IF      0672
*                                      SELECTSW ON           @ZA16140*/
*     THEN                                                         0672
         TM    SELECTSW,B'10000000'                                0672
         BNO   @RF00672                                            0672
*     IF PARMSW='D' THEN                                           0673
         CLI   PARMSW,C'D'                                         0673
         BNE   @RF00673                                            0673
*       DO;                         /*                       @Y30LB40*/
*         DSLINE(73:80)='SDGXX   '; /*                       @ZA16140*/
         MVC   DSLINE+72(8),@CC00795                               0675
*         CALL EDITFIX(ADDR(SELSDG),1,'N');/*                @ZA16140*/
         MVC   @AL00001+4(8),@AL00676                              0676
         LA    @08,SELSDG                                          0676
         ST    @08,@AFTEMPS+16                                     0676
         LA    @08,@AFTEMPS+16                                     0676
         ST    @08,@AL00001                                        0676
         LA    @01,@AL00001                                        0676
         BAL   @14,EDITFIX                                         0676
*         DSLINE(76:77)=FIXOUT(12:13);/*                     @ZA16140*/
         MVC   DSLINE+75(2),FIXOUT+11                              0677
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0679
*       DO;                         /*                       @Y30LB40*/
         B     @RC00673                                            0679
@RF00673 DS    0H                                                  0680
*         DSLINE(78:78)='2';        /*                       @OZ05079*/
         MVI   DSLINE+77,C'2'                                      0680
*         DSLINE(79:79)=SSIDEQ(L+1);/*                       @OZ05079*/
         LA    @06,SSIDEQ(L)                                       0681
         MVC   DSLINE+78(1),0(@06)                                 0681
*         DSLINE(80:80)=SSIDEQ(U+1);/*                       @OZ05079*/
         LA    @01,SSIDEQ(U)                                       0682
         MVC   DSLINE+79(1),0(@01)                                 0682
*       END;                        /*                       @Y30LB40*/
*   ELSE                                                           0684
*     DSLINE(73:80)='       ';      /*                       @OZ05079*/
         B     @RC00672                                            0684
@RF00672 MVI   DSLINE+79,C' '                                      0684
         MVC   DSLINE+72(7),@CC00800                               0684
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/
@RC00672 MVC   @AL00001+4(8),@AL00685                              0685
         LA    @08,RCDCOUNT                                        0685
         ST    @08,@AFTEMPS+16                                     0685
         LA    @08,@AFTEMPS+16                                     0685
         ST    @08,@AL00001                                        0685
         LA    @01,@AL00001                                        0685
         BAL   @14,EDITFIX                                         0685
*   DSLINE(108:113)=FIXOUT(8:13);   /*                       @Y30LB40*/
         MVC   DSLINE+107(6),FIXOUT+7                              0686
*   RFY                                                            0687
*    (R0,                                                          0687
*     R1,                                                          0687
*     R14,                                                         0687
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(PUT   PRNTDCB,DSLINE);      /* PRINT PARM LINE       @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*   RFY                                                            0689
*    (R0,                                                          0689
*     R1,                                                          0689
*     R14,                                                         0689
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   END EOJ;                                                       0690
@EL00016 DS    0H                                                  0690
@EF00016 DS    0H                                                  0690
@ER00016 LM    @14,@12,@SA00016                                    0690
         BR    @14                                                 0690
*                                                                  0691
*/********************************************************************
*                                                                    */
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4
*                                                                    */
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */
*/* LONG.                                                    @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0691
*EDITFIX:                                                          0691
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/
EDITFIX  STM   @14,@12,@SA00017                                    0691
         MVC   @PC00017(12),0(@01)                                 0691
*   DCL                                                            0692
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0692
*                                                            @Y30LB40*/
*   DCL                                                            0693
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/
*   DCL                                                            0694
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0694
*                                                            @Y30LB40*/
*   RFY                                                            0695
*    (R2,                                                          0695
*     R3) RSTD;                     /*                       @Y30LB40*/
*   R2=FIXADDR;                     /*                       @Y30LB40*/
         L     @08,@PC00017                                        0696
         L     R2,FIXADDR(,@08)                                    0696
*   R3=0;                           /*                       @Y30LB40*/
         SLR   R3,R3                                               0697
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE
*                                                            @Y30LB40*/
*     THEN                                                         0698
         L     @08,@PC00017+4                                      0698
         CLC   FIXLEN(4,@08),@CF00044                              0698
         BNE   @RF00698                                            0698
*     DO;                           /*                       @Y30LB40*/
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/
         IC    R3,0(R2)
*     END;                          /*                       @Y30LB40*/
*   ELSE                                                           0702
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0702
*                                      BYTES                 @Y30LB40*/
*       THEN                                                       0702
         B     @RC00698                                            0702
@RF00698 L     @08,@PC00017+4                                      0702
         CLC   FIXLEN(4,@08),@CF00051                              0702
         BNE   @RF00702                                            0702
*       DO;                         /*                       @Y30LB40*/
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/
         LH    R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0706
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/
         B     @RC00702                                            0706
@RF00702 DS    0H                                                  0707
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/
         L     R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*   GEN;                                                           0709
@RC00702 DS    0H                                                  0709
@RC00698 DS    0H                                                  0709
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/
  CVD   R3,DOUBLEWD
  OI    DOUBLEWD+7,X'0F'
  UNPK  FIXOUT(13),DOUBLEWD+2(6)
*   IF FIXOPT='N' THEN                                             0710
         L     @08,@PC00017+8                                      0710
         CLI   FIXOPT(@08),C'N'                                    0710
         BE    @RT00710                                            0710
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */
*   IF FIXOPT='S' THEN                                             0712
         CLI   FIXOPT(@08),C'S'                                    0712
         BE    @RT00712                                            0712
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0713
*                                      INSERTION                     */
*   GEN;                                                           0714
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/
  MVC   FIXOUT(1),FIXOUT+3
  MVI   FIXOUT+1,C','
  MVC   FIXOUT+2(3),FIXOUT+4
  MVI   FIXOUT+5,C','
  MVC   FIXOUT+6(3),FIXOUT+7
  MVI   FIXOUT+9,C','
*EF4:                               /* ZERO AND COMMA SUPPRESS     0715
*                                                            @Y30LB40*/
*   GEN;                                                           0715
EF4      DS    0H                                                  0715
*                                                         /*@Y30LB40*/
         LA    R2,FIXOUT
         LA    R3,12
EF5      EQU   *
         CLI   0(R2),C','
         BE    EF6
         CLI   0(R2),C'0'
         BNE   EFEND
EF6      EQU   *
         MVI   0(R2),C' '
         LA    R2,1(R2)
         BCT   R3,EF5
*EFEND:                                                            0716
*   RFY                                                            0716
*    (R2,                                                          0716
*     R3) UNRSTD;                   /*                       @Y30LB40*/
*   END EDITFIX;                    /*                       @Y30LB40*/
@EL00017 DS    0H                                                  0717
@EF00017 DS    0H                                                  0717
@ER00017 LM    @14,@12,@SA00017                                    0717
         BR    @14                                                 0717
*                                                                  0718
*/********************************************************** @OZ05124*/
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/
*/********************************************************** @OZ05124*/
*                                                                  0718
*READERR:                                                          0718
*   ;                               /*                       @OZ05124*/
READERR  DS    0H                                                  0719
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/
         SYNADAF ACSMETH=QSAM
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/
         MVC   PRNTLINE+30(79),49(R1)
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/
         MVC   PRNTLINE(30),ICGTR904                               0721
*   SAVE14=R14;                     /*                       @OZ09522*/
         LR    SAVE14,R14                                          0722
*   RFY                                                            0723
*    (R0,                                                          0723
*     R1,                                                          0723
*     R14,                                                         0723
*     R15) RSTD;                    /*                       @OZ05124*/
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/
         PUT PRNTDCB,PRNTLINE
*   RFY                                                            0725
*    (R0,                                                          0725
*     R1,                                                          0725
*     R14,                                                         0725
*     R15) UNRSTD;                  /*                       @OZ05124*/
*   R14=SAVE14;                     /*                       @OZ09522*/
         LR    R14,SAVE14                                          0726
*   GEN(SYNADRLS);                  /*                       @OZ05124*/
         SYNADRLS
*   RETURNCD=4;                     /*                       @OZ05124*/
         MVC   RETURNCD(2),@CH00104                                0728
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/
         BR    R14
*   END ICGTRSUM                    /*                       @Y30LB40*/
*                                                                  0730
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0730
*       ;                                                          0730
@EL00001 L     @13,4(,@13)                                         0730
@EF00001 L     @00,@SIZDATD                                        0730
         LR    @01,@10                                             0730
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0730
         BR    @14                                                 0730
@DATA    DS    0H
@CH00701 DC    H'56'
@CH00823 DC    H'116'
@CH00753 DC    H'1000'
@CH00724 DC    H'3600'
@SM00832 MVC   PARMHOLD(0),PARMS(PARMPTR)
         DS    0F
@AL00428 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00652 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00656 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00676 DC    A(@CF00044)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00739)
@AL00430 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00654 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00658 DC    A(@CF00051)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00739)
@AL00436 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00458 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00481 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00577 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00640 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00650 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00685 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00741)
@AL00438 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00440 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00474 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00662 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00664 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00668 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00670 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00739)
@AL00595 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00598 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00603 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00624 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00627 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00630 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00633 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00636 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00668)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@SA00004 DS    13F
@SA00013 DS    15F
@SA00007 DS    15F
@SA00009 DS    14F
@SA00016 DS    15F
@SA00012 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00017 DS    15F
@PC00017 DS    3F
@SA00008 DS    15F
@SA00015 DS    15F
@SA00014 DS    15F
@AL00001 DS    3A
@AFTEMPS DS    5F
ICGTRSUM CSECT
         DS    0F
@CF00044 DC    F'1'
@CF00051 DC    F'2'
@CF00104 DC    F'4'
@CH00104 EQU   @CF00104+2
@CF00372 DC    F'5'
@CH00372 EQU   @CF00372+2
@CF00069 DC    F'8'
@CH00069 EQU   @CF00069+2
@CF00035 DC    F'9'
@CF00034 DC    F'10'
@CF00033 DC    F'11'
@CF00723 DC    F'23'
@CF00643 DC    F'29'
@CH00643 EQU   @CF00643+2
@CF00067 DC    F'31'
@CF00749 DC    F'55'
@CF00725 DC    F'59'
@CF00335 DC    F'60'
@CH00335 EQU   @CF00335+2
@CF00704 DC    F'365'
@CH00704 EQU   @CF00704+2
@CF00720 DC    F'366'
@CH00720 EQU   @CF00720+2
@CF00700 DC    F'600'
@CF00705 DC    F'86399'
@CF00763 DC    F'86400'
@DATD    DSECT
         DS    0D
DCBPTR   DS    A
RCDCOUNT DS    F
PAGECNT  DS    F
OPENCLOS DS    FL4
         ORG   OPENCLOS
OPCLB1   DS    BL1
OPCLB234 DS    CL3
         ORG   OPENCLOS+4
TIMESL   DS    F
HOUR     DS    F
MINUTE   DS    F
SECOND   DS    F
ACCUMTOT DS    F
CALCFLD  DS    F
LINECNT  DS    H
RETURNCD DS    H
SAINDEX  DS    H
SELSDG   DS    FL1
@TS00001 DS    CL1
RCDIN    DS    CL72
         ORG   RCDIN
STGD     DS    FL4
CFAULT   DS    FL4
SYSSGTM  DS    FL4
DEVSGTM  DS    FL4
DSTGD    DS    FL4
SALLOC   DS    FL4
SYSDSTM  DS    FL4
DEVDSTM  DS    FL4
BUSYTIME DS    FL4
LOADTIME DS    FL4
LOADNUM  DS    FL1
CKTIME   DS    CL7
         ORG   CKTIME
SVEYEAR  DS    FL1
SVEJUL   DS    FL2
SVETIME  DS    FL4
         ORG   RCDIN+48
PAGES    DS    FL1
MININUM  DS    FL1
HITNUM   DS    FL1
STGDNUM  DS    FL1
DSTGDNUM DS    FL1
VTOCSTG  DS    FL1
VTOCDSTG DS    FL1
LIBRARY  DS    FL1
DSPORT   DS    FL1
DSCU     DS    FL1
Z        DS    FL1
Y        DS    FL1
X        DS    FL1
CARTPAIR DS    FL1
READWRIT DS    FL1
VOLID    DS    CL6
CHARDRC  DS    CL1
SDGINBIN DS    FL1
@NM00030 DS    CL1
         ORG   RCDIN+72
DSLINE   DS    CL125
         ORG   DSLINE
FLD1     DS    CL1
FLD2     DS    CL6
@NM00031 DS    CL1
FLD2A    DS    CL8
@NM00032 DS    CL2
RWFLD4   DS    CL1
@NM00033 DS    CL1
SDGID    DS    CL3
         ORG   SDGID
@NM00034 DS    CL1
SDGFLD   DS    CL2
         ORG   DSLINE+23
@NM00035 DS    CL1
FLD8     DS    CL11
@NM00036 DS    CL1
FLD9     DS    CL11
@NM00037 DS    CL1
FLD11    DS    CL11
@NM00038 DS    CL2
FLD12    DS    CL11
@NM00039 DS    CL2
FLD14    DS    CL11
@NM00040 DS    CL6
FLD16    DS    CL3
@NM00041 DS    CL7
DSFLD18  DS    CL3
@NM00042 DS    CL21
         ORG   DSLINE+125
SPACE1   DS    CL121
HEADHOLD DS    CL121
PRNTLINE DS    CL121
PRNTDCB  DS    CL100
INDCB    DS    CL100
STARTTIM DS    CL16
         ORG   STARTTIM
@NM00073 DS    CL1
CKSTIME  DS    CL7
         ORG   CKSTIME
HLDSYR   DS    FL1
HLDSDAY  DS    FL2
HLDSTIME DS    FL4
         ORG   STARTTIM+8
@NM00074 DS    CL1
CKETIME  DS    CL7
         ORG   CKETIME
HLDEYR   DS    FL1
HLDEDAY  DS    FL2
HLDETIME DS    FL4
         ORG   STARTTIM+16
TSTIMES  DS    CL16
         ORG   TSTIMES
@NM00075 DS    CL1
TSBEG    DS    CL7
         ORG   TSBEG
TSSYR    DS    FL1
TSSDAY   DS    FL2
TSSTIME  DS    FL4
         ORG   TSTIMES+8
@NM00076 DS    CL1
TSEND    DS    CL7
         ORG   TSEND
TSEYR    DS    FL1
TSEDAY   DS    FL2
TSETIME  DS    FL4
         ORG   TSTIMES+16
DOUBLEWD DS    CL8
TODAY    DS    CL5
PARMSW   DS    CL1
PARMHOLD DS    CL31
CKSEQ    DS    CL7
FIXOUT   DS    CL13
PARMERR  DS    BL1
DATEINSW DS    BL1
SELECTSW DS    BL1
FIRSTSW  DS    BL1
EOFSW    DS    BL1
         DS    CL2
ARRAY1   DS    CL2320
         ORG   ARRAY1
RWTBLE   DS    CL2320
         ORG   RWTBLE
BKT1     DS    116F
BKT2     DS    116F
BKT3     DS    116F
BKT4     DS    116F
BKT5     DS    116F
         ORG   ARRAY1+2320
ARRAY1A  DS    CL928
         ORG   ARRAY1A
BKT6     DS    116F
BKT7     DS    116F
         ORG   ARRAY1A+928
ICGTRSUM CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00740 DC    C'  :  :  '
@CC00795 DC    C'SDGXX   '
@CC00800 DC    C'       '
@CC00737 DC    C'  /   '
@CC00758 DC    C'TOTALS'
@CC00717 DC    C'000'
@CC00726 EQU   @CC00795
@CC00727 DC    C'27'
@CC00668 DC    C'E'
@CC00739 DC    C'N'
@CC00741 EQU   @CC00795
HDNG1    DS    CL121
         ORG   HDNG1
@NM00047 DC    CL36'1ICGTRSUM'
@NM00048 DC    CL65'MSS TRACE STAGING DRIVE GROUP ACTIVITY'
@NM00049 DC    CL20'DATE YYDDD  PAGEXXXX'
         ORG   HDNG1+121
HDNG2    DS    CL121
         ORG   HDNG2
@NM00050 DC    CL1'0'
@NM00051 DC    CL40'                           CYLINDERS   C'
@NM00052 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'
@NM00053 DC    CL40' STGNG  % TOTAL  % CARTG                '
         ORG   HDNG2+121
HDNG3    DS    CL121
         ORG   HDNG3
@NM00054 DC    CL1' '
@NM00055 DC    CL40' DATE    TIME       SDG      STAGED     '
@NM00056 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'
@NM00057 DC    CL40'IVITY   T-SLICE  PRELOADED              '
         ORG   HDNG3+121
HDNGA    DS    CL121
         ORG   HDNGA
@NM00058 DC    CL35'1ICGTRSUM'
@NM00059 DC    CL66'MSS TRACE DATA RECORDING DEVICE ACTIVITY'
@NM00060 DC    CL20'DATE YYDDD  PAGEXXXX'
         ORG   HDNGA+121
HDNGB    DS    CL121
         ORG   HDNGB
@NM00061 DC    CL1'0'
@NM00062 DC    CL40'                           CYLINDERS   C'
@NM00063 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'
@NM00064 DC    CL40' STGNG  % TOTAL  CARTG   LOAD  EFFECTIVE'
         ORG   HDNGB+121
HDNGC    DS    CL121
         ORG   HDNGC
@NM00065 DC    CL1' '
@NM00066 DC    CL40' DATE    TIME   MSF DRD      STAGED     '
@NM00067 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'
@NM00068 DC    CL40'IVITY   T-SLICE  LOADS   TIME CARTG RATE'
         ORG   HDNGC+121
RCDTOTAL DS    CL121
         ORG   RCDTOTAL
@NM00069 DC    CL1'1'
@NM00070 DC    CL40'PARM OPTION - X  T-SLICE - XXX  DATES - '
@NM00071 DC    CL40'YYDDD-YYDDD  TIMES - HHMM-HHMM SSID-XXX '
@NM00072 DC    CL40' INPUT RECORDS SELECTED - XXXXXX        '
         ORG   RCDTOTAL+121
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '
         DS    CL3
FIXAREA  DS    CL200
         ORG   FIXAREA
@NM00077 DC    200CL1'Z'
         ORG   FIXAREA+200
SSIDEQ   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
ICGTRSUM CSECT
*                                                         /*@Y30LB40*/
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **
               EODAD=EOF,EROPT=SKP,SYNAD=READERR
IDCBL    EQU   *-IPATDCB
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121
PDCBL    EQU   *-PPATDCB
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGTRSUM CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
U        EQU   @08
L        EQU   @07
SS       EQU   @02
CALCFLD2 EQU   @02
PARMPTR  EQU   @03
TIMEWORK EQU   @03
SAVE14   EQU   @06
K        EQU   @07
J        EQU   @08
I        EQU   @06
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R14      EQU   @14
R15      EQU   @15
IHADCB   EQU   0
IHADCS05 EQU   0
DCBMODE  EQU   IHADCS05
DCBSTACK EQU   DCBMODE
DCBFUNC  EQU   IHADCS05+3
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00026 EQU   IHADCS40+12
DCBEROPT EQU   @NM00026
PARMVALS EQU   0
PARMLEN  EQU   PARMVALS
PARMS    EQU   PARMVALS+2
FIXADDR  EQU   0
FIXLEN   EQU   0
FIXOPT   EQU   0
RW       EQU   SDGID
DRDSSID  EQU   RW
CHAR2    EQU   DRDSSID
DRDMSFID EQU   DRDSSID+1
RWFLD6   EQU   DRDSSID+2
RWLINE   EQU   FLD16
RWFLD18  EQU   RWLINE+6
RWFLD20  EQU   RWLINE+13
RWFLD22  EQU   RWLINE+22
ARRAY2   EQU   ARRAY1A
DSTABLE  EQU   ARRAY2
DSBKT6   EQU   DSTABLE
DSBKT7   EQU   DSTABLE+464
*                                      START UNREFERENCED COMPONENTS
@NM00046 EQU   RWLINE+28
@NM00045 EQU   RWLINE+19
@NM00044 EQU   RWLINE+12
@NM00043 EQU   RWLINE
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00029 EQU   IHADCS40+16
@NM00028 EQU   @NM00026+1
@NM00027 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00025 EQU   IHADCS40+10
@NM00024 EQU   IHADCS40+9
@NM00023 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00022 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00021 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00020 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00019 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00018 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00017 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00016 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00015 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00014 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00013 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00012 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00011 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00010 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00009 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00008 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00007 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00006 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
@NM00005 EQU   DCBFUNC
DCBFNCBT EQU   DCBFUNC
DCBFNCBX EQU   DCBFUNC
DCBFNCBD EQU   DCBFUNC
DCBFNCBW EQU   DCBFUNC
DCBFNCBP EQU   DCBFUNC
DCBFNCBR EQU   DCBFUNC
DCBFNCBI EQU   DCBFUNC
@NM00004 EQU   IHADCS05+2
@NM00003 EQU   IHADCS05+1
DCBSTCK1 EQU   DCBSTACK
DCBSTCK2 EQU   DCBSTACK
@NM00002 EQU   DCBSTACK
DCBMODER EQU   DCBSTACK
DCBMODEO EQU   DCBSTACK
DCBMODEE EQU   DCBSTACK
DCBMODEC EQU   DCBSTACK
@NM00001 EQU   IHADCB
*                                      END UNREFERENCED COMPONENTS
@RT00092 EQU   CLOSEFIL
@RT00096 EQU   CLOSEFIL
@RT00110 EQU   RDTRACE
@RT00115 EQU   RDTRACE
@RT00119 EQU   RDTRACE
@RT00122 EQU   RDTRACE
@RC00157 EQU   RDTRACE
@RF00218 EQU   @EL00003
@RT00259 EQU   PARMEND
@RT00279 EQU   PARMEND
@RF00294 EQU   @RC00292
@RF00304 EQU   @RC00302
@RT00318 EQU   PARMEND
@RT00331 EQU   PARMEND
@RT00360 EQU   PARMEND
@RC00368 EQU   @RC00366
@RF00404 EQU   @EL00004
@RC00511 EQU   @EL00009
@RC00673 EQU   @RC00672
@RT00712 EQU   EF4
EFEND    EQU   @EL00017
@RT00710 EQU   EFEND
@ENDDATA EQU   *
         END   ICGTRSUM,(C'PLS1449',0603,77089)

         TITLE '***** ICGTRDST MSS TRACE SDG AND RWU DISTRIBUTION REPOR*
               RT ****  '
ICGTRDST CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGTRDST  77.089'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         L     R1,0(R1)
*   PARMPTR=R1;                     /* SAVE PARMS LOCATION   @Y30LB40*/
         LR    PARMPTR,R1                                          0097
*   RFY                                                            0098
*     R1 UNRSTD;                    /*                       @Y30LB40*/
*   RFY                                                            0099
*    (R0,                                                          0099
*     R1) RSTD;                     /*                       @Y30LB40*/
*   R0=LENGTH(DSARRAY);             /*                       @ZA16140*/
         L     R0,@CF00997                                         0100
*   GEN(GETMAIN  R,LV=(0));         /* GETMAIN FOR ARRAYS    @Y30LB40*/
         GETMAIN  R,LV=(0)
*   ARRAYLOC=R1;                    /*                       @Y30LB40*/
         LR    ARRAYLOC,R1                                         0102
*   RFY                                                            0103
*    (R0,                                                          0103
*     R1) UNRSTD;                   /*                       @Y30LB40*/
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/
         SLR   @15,@15                                             0104
         ST    @15,RCDCOUNT                                        0104
*   RETURNCD=0;                     /*                       @Y30LB40*/
         STH   @15,RETURNCD                                        0105
*   TIMESL=600;                     /*                       @Y30LB40*/
         MVC   TIMESL(4),@CF00865                                  0106
*   HOUR=0;                         /*                       @Y30LB40*/
         ST    @15,HOUR                                            0107
*   MINUTE=0;                       /*                       @Y30LB40*/
         ST    @15,MINUTE                                          0108
*   SECOND=0;                       /*                       @Y30LB40*/
         ST    @15,SECOND                                          0109
*   SELECTSW='0'B;                  /*                       @Y30LB40*/
         NI    SELECTSW,B'01111111'                                0110
*   LINECNT=56;                     /*                       @Y30LB40*/
         LA    LINECNT,56                                          0111
*   OPENCLOS=0;                     /*                       @Y30LB40*/
         ST    @15,OPENCLOS                                        0112
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/
         MVI   OPCLB1,B'10000000'                                  0113
*   PAGECNT=0;                      /*                       @Y30LB40*/
         ST    @15,PAGECNT                                         0114
*   EOFSW='0'B;                     /*                       @Y30LB40*/
         NI    EOFSW,B'01111111'                                   0115
*   HLDSYR=0;                       /*                       @Y30LB40*/
         MVI   HLDSYR,X'00'                                        0116
*   HLDSDAY=1;                      /*                       @Y30LB40*/
         LA    @14,1                                               0117
         STH   @14,HLDSDAY                                         0117
*   HLDSTIME=0;                     /*                       @Y30LB40*/
         ST    @15,HLDSTIME                                        0118
*   HLDEYR=99;                      /*                       @Y30LB40*/
         MVI   HLDEYR,X'63'                                        0119
*   HLDEDAY=365;                    /*                       @Y30LB40*/
         MVC   HLDEDAY(2),@CH00870                                 0120
*   HLDETIME=86399;                 /*                       @Y30LB40*/
         MVC   HLDETIME(4),@CF00871                                0121
*   PARMSW='D';                     /*                       @Y30LB40*/
         MVI   PARMSW,C'D'                                         0122
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/
         OI    FIRSTSW,B'10000000'                                 0123
*   PARMERR='0'B;                   /*                       @Y30LB40*/
         NI    PARMERR,B'01111111'                                 0124
*   DATEINSW='0'B;                  /*                       @Y30LB40*/
         NI    DATEINSW,B'01111111'                                0125
*   SPACE1=' ';                     /*                       @Y30LB40*/
         MVI   SPACE1+1,C' '                                       0126
         MVC   SPACE1+2(119),SPACE1+1                              0126
         MVI   SPACE1,C' '                                         0126
*   DO J=1 TO 28;                   /*                       @ZA16140*/
         ST    @14,J                                               0127
@DL00127 DS    0H                                                  0128
*     DO K=1 TO 2;                  /*                       @ZA16140*/
         LA    @15,1                                               0128
         ST    @15,K                                               0128
@DL00128 DS    0H                                                  0129
*       DO L=1 TO 11;               /*                       @ZA16140*/
         LA    @15,1                                               0129
         ST    @15,L                                               0129
@DL00129 DS    0H                                                  0130
*         CALL CALCDSA(J,K,L);      /*                       @ZA16140*/
         LA    @15,J                                               0130
         ST    @15,@AL00001                                        0130
         LA    @15,K                                               0130
         ST    @15,@AL00001+4                                      0130
         LA    @15,L                                               0130
         ST    @15,@AL00001+8                                      0130
         LA    @01,@AL00001                                        0130
         BAL   @14,CALCDSA                                         0130
*         DSB1=0;                   /*                       @ZA16140*/
         SLR   @15,@15                                             0131
         L     @14,ARRAYPTR                                        0131
         ST    @15,DSB1(,@14)                                      0131
*         DSB2=0;                   /*                       @ZA16140*/
         ST    @15,DSB2(,@14)                                      0132
*         DSB3=0;                   /*                       @ZA16140*/
         ST    @15,DSB3(,@14)                                      0133
*         DSB4=0;                   /*                       @ZA16140*/
         ST    @15,DSB4(,@14)                                      0134
*         DSB5=0;                   /*                       @ZA16140*/
         ST    @15,DSB5(,@14)                                      0135
*         DSB6=0;                   /*                       @ZA16140*/
         ST    @15,DSB6(,@14)                                      0136
*         DSB7=0;                   /*                       @ZA16140*/
         ST    @15,DSB7(,@14)                                      0137
*         DSB8=0;                   /*                       @ZA16140*/
         ST    @15,DSB8(,@14)                                      0138
*         DSB9=0;                   /*                       @ZA16140*/
         ST    @15,DSB9(,@14)                                      0139
*         DSB10=0;                  /*                       @ZA16140*/
         ST    @15,DSB10(,@14)                                     0140
*         DSB11=0;                  /*                       @ZA16140*/
         ST    @15,DSB11(,@14)                                     0141
*       END;                        /*                       @Y30LB40*/
         LA    @15,1                                               0142
         AL    @15,L                                               0142
         ST    @15,L                                               0142
         C     @15,@CF00033                                        0142
         BNH   @DL00129                                            0142
*     END;                          /*                       @Y30LB40*/
         LA    @15,1                                               0143
         AL    @15,K                                               0143
         ST    @15,K                                               0143
         C     @15,@CF00051                                        0143
         BNH   @DL00128                                            0143
*   END;                            /*                       @Y30LB40*/
         LA    @14,1                                               0144
         AL    @14,J                                               0144
         ST    @14,J                                               0144
         C     @14,@CF00615                                        0144
         BNH   @DL00127                                            0144
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/
         MVC   PRNTDCB(PDCBL),PPATDCB
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/
         MVC   INDCB(IDCBL),IPATDCB
*   RFY                                                            0147
*    (R0,                                                          0147
*     R1,                                                          0147
*     R14,                                                         0147
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0149
*    (R0,                                                          0149
*     R1,                                                          0149
*     R14,                                                         0149
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B THEN               0150
         MVC   @TS00001(1),PRNTDCB+48                              0150
         NI    @TS00001,B'00010000'                                0150
         CLI   @TS00001,B'00010000'                                0150
         BE    @RF00150                                            0150
*     DO;                           /* OPEN BAD,EXIT WITH RC=4     0151
*                                                            @Y30LB40*/
*       RETURN CODE(4);             /*                       @Y30LB40*/
         L     @13,4(,@13)                                         0152
         L     @00,@SIZDATD                                        0152
         LR    @01,@09                                             0152
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,4                                               0152
         L     @14,12(,@13)                                        0152
         LM    @00,@12,20(@13)                                     0152
         BR    @14                                                 0152
*     END;                          /*                       @Y30LB40*/
*   RFY                                                            0154
*    (R0,                                                          0154
*     R1,                                                          0154
*     R14,                                                         0154
*     R15) RSTD;                    /*                       @Y30LB40*/
@RF00150 DS    0H                                                  0155
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0156
*    (R0,                                                          0156
*     R1,                                                          0156
*     R14,                                                         0156
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B THEN                 0157
         MVC   @TS00001(1),INDCB+48                                0157
         NI    @TS00001,B'00010000'                                0157
         CLI   @TS00001,B'00010000'                                0157
         BE    @RF00157                                            0157
*     DO;                           /* OPEN BAD              @Y30LB40*/
*       DSLINE=TRINMSG;             /*                       @Y30LB40*/
         MVI   DSLINE+31,C' '                                      0159
         MVC   DSLINE+32(89),DSLINE+31                             0159
         MVC   DSLINE(31),TRINMSG                                  0159
*       RFY                                                        0160
*        (R0,                                                      0160
*         R1,                                                      0160
*         R14,                                                     0160
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0162
*        (R0,                                                      0162
*         R1,                                                      0162
*         R14,                                                     0162
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0163
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0164
*     END;                          /*                       @Y30LB40*/
*   IF PARMLEN=0 THEN                                              0166
@RF00157 LH    @15,PARMLEN(,PARMPTR)                               0166
         LTR   @15,@15                                             0166
         BZ    @RT00166                                            0166
*     GO TO PARMEND;                /* IF NO PARMS,BYPASS PROCESS    */
*   IF PARMLEN>31                   /*                       @OZ05079*/
*     THEN                                                         0168
         C     @15,@CF00067                                        0168
         BNH   @RF00168                                            0168
*     DO;                           /* IF PARMS TOO LONG,EXIT WITH 0169
*                                      ERROR SWITCH ON       @Y30LB40*/
*       PARMERR='1'B;               /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0170
*       GO TO PARMEND;              /*                       @Y30LB40*/
         B     PARMEND                                             0171
*     END;                          /*                       @Y30LB40*/
*   PARMHOLD(1:1)=',';              /*                       @Y30LB40*/
@RF00168 MVI   PARMHOLD,C','                                       0173
*   MVC(PARMHOLD(2:31),PARMHOLD);   /* SET PARMHOLD TO ALL         0174
*                                      COMMAS,,,,,,,                 */
         MVC   PARMHOLD+1(30),PARMHOLD                             0174
*   SS=1;                           /* SET SUBSTRING POINTER TO 1  0175
*                                                            @Y30LB40*/
         LA    SS,1                                                0175
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0176
*                                                            @Y30LB40*/
         LH    @15,PARMLEN(,PARMPTR)                               0176
         BCTR  @15,0                                               0176
         EX    @15,@SM01014                                        0176
*   IF PARMHOLD(1:1)=','            /* WAS REPORT SELECTOR ENTERED 0177
*                                                            @Y30LB40*/
*     THEN                                                         0177
         CLI   PARMHOLD,C','                                       0177
         BNE   @RF00177                                            0177
*     SS=2;                         /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         LA    SS,2                                                0178
*   ELSE                                                           0179
*     DO;                           /* YES,CHECK FOR D OR R  @Y30LB40*/
         B     @RC00177                                            0179
@RF00177 DS    0H                                                  0180
*       IF PARMHOLD(1:1)='D'×PARMHOLD(1:1)='R' THEN                0180
         CLI   PARMHOLD,C'D'                                       0180
         BE    @RT00180                                            0180
         CLI   PARMHOLD,C'R'                                       0180
         BNE   @RF00180                                            0180
@RT00180 DS    0H                                                  0181
*         DO;                       /*                       @Y30LB40*/
*           PARMSW=PARMHOLD(1:1);   /* VALID SELECTOR,SAVE IT        */
         MVC   PARMSW(1),PARMHOLD                                  0182
*           SS=3;                   /*                       @Y30LB40*/
         LA    SS,3                                                0183
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0185
*         DO;                       /*                       @Y30LB40*/
         B     @RC00180                                            0185
@RF00180 DS    0H                                                  0186
*           PARMERR='1'B;           /* ERROR,BAD SELECTOR    @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0186
*           GO TO PARMEND;          /*                       @Y30LB40*/
         B     PARMEND                                             0187
*         END;                      /*                       @Y30LB40*/
*     END;                          /*                       @Y30LB40*/
@RC00180 DS    0H                                                  0190
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0190
*                                                            @Y30LB40*/
*     THEN                                                         0190
@RC00177 LA    @07,PARMHOLD-1(SS)                                  0190
         CLI   0(@07),C','                                         0190
         BNE   @RF00190                                            0190
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0191
*   ELSE                                                           0192
*     DO;                           /* YES                   @Y30LB40*/
         B     @RC00190                                            0192
@RF00190 DS    0H                                                  0193
*       DO J=SS TO(SS+2);           /* CHECK FOR NON NUMERICS      0193
*                                                            @Y30LB40*/
         LR    @07,SS                                              0193
         B     @DE00193                                            0193
@DL00193 DS    0H                                                  0194
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0194
         LA    @03,PARMHOLD-1(@07)                                 0194
         CLI   0(@03),C'0'                                         0194
         BL    @RF00194                                            0194
         LA    @03,PARMHOLD-1(@07)                                 0194
         CLI   0(@03),C'9'                                         0194
         BNH   @RT00194                                            0194
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0196
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0196
*                                                            @Y30LB40*/
@RF00194 OI    PARMERR,B'10000000'                                 0196
*       END;                        /*                       @Y30LB40*/
@RT00194 LA    @07,1                                               0197
         AL    @07,J                                               0197
@DE00193 ST    @07,J                                               0197
         LA    @03,2                                               0197
         ALR   @03,SS                                              0197
         CR    @07,@03                                             0197
         BNH   @DL00193                                            0197
*       IF PARMERR='1'B THEN                                       0198
         TM    PARMERR,B'10000000'                                 0198
         BO    @RT00198                                            0198
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       IF PARMHOLD(SS:SS+2)='000' THEN                            0200
         LA    @07,PARMHOLD-1(SS)                                  0200
         CLC   0(3,@07),@CC00881                                   0200
         BNE   @RF00200                                            0200
*         DO;                       /* ERROR,TIME SLICE CANNOT BE  0201
*                                      ZERO                          */
*           PARMERR='1'B;           /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0202
*           GO TO PARMEND;          /*                       @Y30LB40*/
         B     PARMEND                                             0203
*         END;                      /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/* TIME SLICE OK,CONVERT IT */
@RF00200 LA    @07,PARMHOLD-1(SS)                                  0205
         PACK  DOUBLEWD(8),0(3,@07)                                0205
*       CVB(TIMESL,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @07,DOUBLEWD                                        0206
         ST    @07,TIMESL                                          0206
*       TIMESL=TIMESL*60;           /*                       @Y30LB40*/
         MH    @07,@CH00335                                        0207
         ST    @07,TIMESL                                          0207
*       SS=SS+4;                    /* BUMP TO NEXT VALUE    @Y30LB40*/
         AL    SS,@CF00104                                         0208
*     END;                          /*                       @Y30LB40*/
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/
*     THEN                                                         0210
@RC00190 LA    @07,PARMHOLD-1(SS)                                  0210
         CLI   0(@07),C','                                         0210
         BNE   @RF00210                                            0210
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0211
*   ELSE                                                           0212
*     DO;                           /* YES,CHECK FOR NON NUMERICS  0212
*                                                            @Y30LB40*/
         B     @RC00210                                            0212
@RF00210 DS    0H                                                  0213
*       DO J=SS TO(SS+9);           /*                       @Y30LB40*/
         LR    @07,SS                                              0213
         B     @DE00213                                            0213
@DL00213 DS    0H                                                  0214
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0214
         LA    @03,PARMHOLD-1(@07)                                 0214
         CLI   0(@03),C'0'                                         0214
         BL    @RF00214                                            0214
         LA    @03,PARMHOLD-1(@07)                                 0214
         CLI   0(@03),C'9'                                         0214
         BNH   @RT00214                                            0214
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0216
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0216
*                                                            @Y30LB40*/
@RF00214 OI    PARMERR,B'10000000'                                 0216
*       END;                        /*                       @Y30LB40*/
@RT00214 LA    @07,1                                               0217
         AL    @07,J                                               0217
@DE00213 ST    @07,J                                               0217
         LA    @03,9                                               0217
         ALR   @03,SS                                              0217
         CR    @07,@03                                             0217
         BNH   @DL00213                                            0217
*       IF PARMERR='1'B THEN                                       0218
         TM    PARMERR,B'10000000'                                 0218
         BO    @RT00218                                            0218
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/
         LA    @07,PARMHOLD-1(SS)                                  0220
         PACK  DOUBLEWD(8),0(2,@07)                                0220
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @07,DOUBLEWD                                        0221
         STC   @07,HLDSYR                                          0221
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/
         LA    @07,PARMHOLD+1(SS)                                  0222
         PACK  DOUBLEWD(8),0(3,@07)                                0222
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @07,DOUBLEWD                                        0223
         STH   @07,HLDSDAY                                         0223
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/
         LA    @03,PARMHOLD+4(SS)                                  0224
         PACK  DOUBLEWD(8),0(2,@03)                                0224
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0225
         STC   @03,HLDEYR                                          0225
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/
         LA    @03,PARMHOLD+6(SS)                                  0226
         PACK  DOUBLEWD(8),0(3,@03)                                0226
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0227
         STH   @03,HLDEDAY                                         0227
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAYS          */
*         THEN                                                     0228
         LTR   @07,@07                                             0228
         BNP   @RF00228                                            0228
         C     @07,@CF00884                                        0228
         BL    @RT00228                                            0228
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0230
*         DO;                       /*                       @Y30LB40*/
@RF00228 DS    0H                                                  0231
*           IF HLDSDAY=366 THEN                                    0231
         CLC   HLDSDAY(2),@CH00884                                 0231
         BNE   @RF00231                                            0231
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0233
         MVC   @TS00001(1),CKSTIME                                 0233
         NI    @TS00001,B'00000011'                                0233
         CLI   @TS00001,B'00000000'                                0233
         BE    @RF00233                                            0233
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0234
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0236
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/
         B     @RC00231                                            0236
@RF00231 OI    PARMERR,B'10000000'                                 0236
*         END;                      /*                       @Y30LB40*/
@RC00231 DS    0H                                                  0238
*       IF HLDEDAY>0&HLDEDAY<366    /* CHECK FOR VALID DAYS          */
*         THEN                                                     0238
@RT00228 LH    @07,HLDEDAY                                         0238
         LTR   @07,@07                                             0238
         BNP   @RF00238                                            0238
         C     @07,@CF00884                                        0238
         BL    @RT00238                                            0238
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0240
*         DO;                       /*                       @Y30LB40*/
@RF00238 DS    0H                                                  0241
*           IF HLDEDAY=366 THEN                                    0241
         CLC   HLDEDAY(2),@CH00884                                 0241
         BNE   @RF00241                                            0241
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0243
         MVC   @TS00001(1),CKETIME                                 0243
         NI    @TS00001,B'00000011'                                0243
         CLI   @TS00001,B'00000000'                                0243
         BE    @RF00243                                            0243
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0244
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0246
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/
         B     @RC00241                                            0246
@RF00241 OI    PARMERR,B'10000000'                                 0246
*         END;                      /*                       @Y30LB40*/
@RC00241 DS    0H                                                  0248
*       IF HLDSYR<=HLDEYR           /* CHECK YEARS AND DAYS IN     0248
*                                      COMBINATION                   */
*         THEN                                                     0248
@RT00238 CLC   HLDSYR(1),HLDEYR                                    0248
         BNH   @RT00248                                            0248
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0250
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0250
*       IF HLDSDAY<=HLDEDAY THEN                                   0251
@RT00248 LH    @07,HLDSDAY                                         0251
         CH    @07,HLDEDAY                                         0251
         BNH   @RT00251                                            0251
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0253
*         DO;                       /*                       @Y30LB40*/
*           IF HLDSYR=HLDEYR THEN                                  0254
         CLC   HLDSYR(1),HLDEYR                                    0254
         BNE   @RF00254                                            0254
*             PARMERR='1'B;         /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0255
*         END;                      /*                       @Y30LB40*/
@RF00254 DS    0H                                                  0257
*       IF PARMERR='1'B THEN                                       0257
@RT00251 TM    PARMERR,B'10000000'                                 0257
         BO    @RT00257                                            0257
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       DATEINSW='1'B;              /* DATES OK, SET INDICATOR     0259
*                                                            @Y30LB40*/
         OI    DATEINSW,B'10000000'                                0259
*       SS=SS+11;                   /* BUMP TO NEXT VALUE    @Y30LB40*/
         AL    SS,@CF00033                                         0260
*     END;                          /*                       @Y30LB40*/
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/
*     THEN                                                         0262
@RC00210 LA    @07,PARMHOLD-1(SS)                                  0262
         CLI   0(@07),C','                                         0262
         BNE   @RF00262                                            0262
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/
         AL    SS,@CF00044                                         0263
*   ELSE                                                           0264
*     DO;                           /*                       @Y30LB40*/
         B     @RC00262                                            0264
@RF00262 DS    0H                                                  0265
*       DO J=SS TO(SS+7);           /* YES,CHECK FOR NON NUMERICS  0265
*                                                            @Y30LB40*/
         LR    @07,SS                                              0265
         B     @DE00265                                            0265
@DL00265 DS    0H                                                  0266
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0266
         LA    @03,PARMHOLD-1(@07)                                 0266
         CLI   0(@03),C'0'                                         0266
         BL    @RF00266                                            0266
         LA    @03,PARMHOLD-1(@07)                                 0266
         CLI   0(@03),C'9'                                         0266
         BNH   @RT00266                                            0266
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0268
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0268
*                                                            @Y30LB40*/
@RF00266 OI    PARMERR,B'10000000'                                 0268
*       END;                        /*                       @Y30LB40*/
@RT00266 LA    @07,1                                               0269
         AL    @07,J                                               0269
@DE00265 ST    @07,J                                               0269
         LA    @03,7                                               0269
         ALR   @03,SS                                              0269
         CR    @07,@03                                             0269
         BNH   @DL00265                                            0269
*       IF PARMERR='1'B THEN                                       0270
         TM    PARMERR,B'10000000'                                 0270
         BO    @RT00270                                            0270
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/
         LA    @07,PARMHOLD-1(SS)                                  0272
         PACK  DOUBLEWD(8),0(2,@07)                                0272
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0273
*       IF TIMEWORK>23 THEN                                        0274
         C     TIMEWORK,@CF00887                                   0274
         BNH   @RF00274                                            0274
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0275
*       ELSE                                                       0276
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00274                                            0276
@RF00274 LR    @07,TIMEWORK                                        0276
         MH    @07,@CH00888                                        0276
         ST    @07,HLDSTIME                                        0276
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/
@RC00274 LA    @07,PARMHOLD+1(SS)                                  0277
         PACK  DOUBLEWD(8),0(2,@07)                                0277
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0278
*       IF TIMEWORK>59 THEN                                        0279
         C     TIMEWORK,@CF00889                                   0279
         BNH   @RF00279                                            0279
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0280
*       ELSE                                                       0281
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/
         B     @RC00279                                            0281
@RF00279 LR    @07,TIMEWORK                                        0281
         MH    @07,@CH00335                                        0281
         AL    @07,HLDSTIME                                        0281
         ST    @07,HLDSTIME                                        0281
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/
@RC00279 LA    @07,PARMHOLD+3(SS)                                  0282
         PACK  DOUBLEWD(8),0(2,@07)                                0282
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0283
*       IF TIMEWORK>23 THEN                                        0284
         C     TIMEWORK,@CF00887                                   0284
         BNH   @RF00284                                            0284
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0285
*       ELSE                                                       0286
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00284                                            0286
@RF00284 LR    @07,TIMEWORK                                        0286
         MH    @07,@CH00888                                        0286
         ST    @07,HLDETIME                                        0286
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/
@RC00284 LA    @07,PARMHOLD+5(SS)                                  0287
         PACK  DOUBLEWD(8),0(2,@07)                                0287
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0288
*       IF TIMEWORK>59 THEN                                        0289
         C     TIMEWORK,@CF00889                                   0289
         BNH   @RF00289                                            0289
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0290
*       ELSE                                                       0291
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/
         B     @RC00289                                            0291
@RF00289 LR    @07,TIMEWORK                                        0291
         MH    @07,@CH00335                                        0291
         AL    @07,HLDETIME                                        0291
         AL    @07,@CF00889                                        0291
         ST    @07,HLDETIME                                        0291
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY/* CHECK DATES AND           */
*         THEN                                                     0292
@RC00289 CLC   HLDSYR(1),HLDEYR                                    0292
         BNE   @RF00292                                            0292
         CLC   HLDSDAY(2),HLDEDAY                                  0292
         BNE   @RF00292                                            0292
*         IF HLDSTIME>HLDETIME      /* TIMES IN COMBINATION          */
*           THEN                                                   0293
         L     @07,HLDSTIME                                        0293
         C     @07,HLDETIME                                        0293
         BNH   @RF00293                                            0293
*           PARMERR='1'B;           /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0294
*       IF PARMERR='0'B&DATEINSW='0'B THEN                         0295
@RF00293 DS    0H                                                  0295
@RF00292 TM    PARMERR,B'10000000'                                 0295
         BNZ   @RF00295                                            0295
         TM    DATEINSW,B'10000000'                                0295
         BNZ   @RF00295                                            0295
*         PARMERR='1'B;             /* ERROR,DATES NOT ENTERED     0296
*                                                            @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0296
*       SS=SS+9;                    /* BUMP TO NEXT VALUE    @Y30LB40*/
@RF00295 AL    SS,@CF00035                                         0297
*     END;                          /*                       @Y30LB40*/
*   IF PARMERR='1'B THEN                                           0299
@RC00262 TM    PARMERR,B'10000000'                                 0299
         BO    @RT00299                                            0299
*     GO TO PARMEND;                /*                       @Y30LB40*/
*   IF PARMHOLD(SS:SS)=','          /* WERE SDG OR LU ENTERED      0301
*                                                            @ZA16140*/
*     THEN                                                         0301
         LA    @07,PARMHOLD-1(SS)                                  0301
         CLI   0(@07),C','                                         0301
         BE    @RT00301                                            0301
*     ;                             /* NO,FINISH PROCESS     @Y30LB40*/
*   ELSE                                                           0303
*     DO;                           /* YES                   @Y30LB40*/
*       SELECTSW='1'B;              /* INDICATE SPECIFIC SELECTION 0304
*                                                            @Y30LB40*/
         OI    SELECTSW,B'10000000'                                0304
*       IF PARMSW='D' THEN                                         0305
         CLI   PARMSW,C'D'                                         0305
         BNE   @RF00305                                            0305
*         DO;                       /* CHECK FOR VALID SDG NUMBER  0306
*                                                            @ZA16140*/
*           IF((PARMHOLD(SS:SS+2)='SDG')&(PARMHOLD(SS+3:SS+3)>='0')&(
*               PARMHOLD(SS+3:SS+3)<='2')&(PARMHOLD(SS+4:SS+4)>='0')&(
*               PARMHOLD(SS+4:SS+4)<='9')&(PARMHOLD(SS+3:SS+4)<='27'))
*             THEN                                                 0307
         LA    @07,PARMHOLD-1(SS)                                  0307
         CLC   0(3,@07),@CC00890                                   0307
         BNE   @RF00307                                            0307
         LA    @07,PARMHOLD+2(SS)                                  0307
         CLI   0(@07),C'0'                                         0307
         BL    @RF00307                                            0307
         LA    @07,PARMHOLD+2(SS)                                  0307
         CLI   0(@07),C'2'                                         0307
         BH    @RF00307                                            0307
         LA    @07,PARMHOLD+3(SS)                                  0307
         CLI   0(@07),C'0'                                         0307
         BL    @RF00307                                            0307
         LA    @07,PARMHOLD+3(SS)                                  0307
         CLI   0(@07),C'9'                                         0307
         BH    @RF00307                                            0307
         LA    @07,PARMHOLD+2(SS)                                  0307
         CLC   0(2,@07),@CC00891                                   0307
         BH    @RF00307                                            0307
*             DO;                   /*                       @ZA16140*/
*               PACK(DOUBLEWD,PARMHOLD(SS+3:SS+4));/*        @ZA16140*/
         LA    @07,PARMHOLD+2(SS)                                  0309
         PACK  DOUBLEWD(8),0(2,@07)                                0309
*               CVB(SELSDG,DOUBLEWD);/*                      @ZA16140*/
         CVB   @07,DOUBLEWD                                        0310
         STC   @07,SELSDG                                          0310
*             END;                  /*                       @ZA16140*/
*           ELSE                                                   0312
*             DO;                   /*                       @ZA16140*/
         B     @RC00307                                            0312
@RF00307 DS    0H                                                  0313
*               PARMERR='1'B;       /*                       @ZA16140*/
         OI    PARMERR,B'10000000'                                 0313
*               GO TO PARMEND;      /*                       @ZA16140*/
         B     PARMEND                                             0314
*             END;                  /*                       @ZA16140*/
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0317
*         DO;                       /* CHECK FOR VALID LIBRARY AND 0317
*                                      RWU                   @Y30LB40*/
         B     @RC00305                                            0317
@RF00305 DS    0H                                                  0318
*           IF PARMHOLD(SS:SS)^='2' /* 1ST DIGIT ALWAYS 2    @OZ05079*/
*             THEN                                                 0318
         LA    @07,PARMHOLD-1(SS)                                  0318
         CLI   0(@07),C'2'                                         0318
         BE    @RF00318                                            0318
*             DO;                   /*                       @Y30LB40*/
*               PARMERR='1'B;       /* ERROR,INVALID LIBRARY @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0320
*               GO TO PARMEND;      /*                       @Y30LB40*/
         B     PARMEND                                             0321
*             END;                  /*                       @Y30LB40*/
*           IF PARMHOLD(SS+1:SS+1)='0'/* MSF = 0             @OZ05079*/
*               ×PARMHOLD(SS+1:SS+1)='1'/* MSF = 1           @OZ05079*/
*             THEN                                                 0323
@RF00318 LA    @07,PARMHOLD(SS)                                    0323
         CLI   0(@07),C'0'                                         0323
         BE    @RT00323                                            0323
         LA    @07,PARMHOLD(SS)                                    0323
         CLI   0(@07),C'1'                                         0323
         BNE   @RF00323                                            0323
@RT00323 DS    0H                                                  0324
*             DO;                   /*                       @Y30LB40*/
*               PACK(DOUBLEWD,PARMHOLD(SS+1:SS+1));/* MSF OK @OZ05079*/
         LA    @07,PARMHOLD(SS)                                    0325
         PACK  DOUBLEWD(8),0(1,@07)                                0325
*               CVB(LIB,DOUBLEWD);  /*                       @OZ05079*/
         CVB   @07,DOUBLEWD                                        0326
         STC   @07,LIB                                             0326
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0328
*             DO;                   /*                       @Y30LB40*/
         B     @RC00323                                            0328
@RF00323 DS    0H                                                  0329
*               PARMERR='1'B;       /* ERROR,INVALID RWU     @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0329
*               GO TO PARMEND;      /*                       @Y30LB40*/
         B     PARMEND                                             0330
*             END;                  /*                       @Y30LB40*/
*           IF PARMHOLD(SS+2:SS+2)>='0'/* RANGE OKAY         @OZ05079*/
*               &PARMHOLD(SS+2:SS+2)<='7'/*                  @OZ05079*/
*             THEN                                                 0332
@RC00323 LA    @07,PARMHOLD+1(SS)                                  0332
         CLI   0(@07),C'0'                                         0332
         BL    @RF00332                                            0332
         LA    @07,PARMHOLD+1(SS)                                  0332
         CLI   0(@07),C'7'                                         0332
         BH    @RF00332                                            0332
*             DO;                   /*                       @Y30LB40*/
*               PACK(DOUBLEWD,PARMHOLD(SS+2:SS+2));/* DRD OKAY     0334
*                                                            @OZ05079*/
         LA    @07,PARMHOLD+1(SS)                                  0334
         PACK  DOUBLEWD(8),0(1,@07)                                0334
*               CVB(U,DOUBLEWD);    /*                       @Y30LB40*/
         CVB   @07,DOUBLEWD                                        0335
         STC   @07,U                                               0335
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0337
*             DO;                   /*                       @Y30LB40*/
         B     @RC00332                                            0337
@RF00332 DS    0H                                                  0338
*               PARMERR='1'B;       /* ERROR,INVALID RWU     @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0338
*               GO TO PARMEND;      /*                       @Y30LB40*/
         B     PARMEND                                             0339
*             END;                  /*                       @Y30LB40*/
*         END;                      /*                       @Y30LB40*/
@RC00332 DS    0H                                                  0342
*     END;                          /*                       @Y30LB40*/
@RC00305 DS    0H                                                  0343
*PARMEND:                                                          0343
*   IF PARMERR='1'B THEN                                           0343
@RT00301 DS    0H                                                  0343
PARMEND  TM    PARMERR,B'10000000'                                 0343
         BNO   @RF00343                                            0343
*     DO;                           /* IF ERRORS FOUND       @Y30LB40*/
*       DSLINE=PARMMSG;             /*                       @Y30LB40*/
         MVI   DSLINE+28,C' '                                      0345
         MVC   DSLINE+29(92),DSLINE+28                             0345
         MVC   DSLINE(28),PARMMSG                                  0345
*       RFY                                                        0346
*        (R0,                                                      0346
*         R1,                                                      0346
*         R14,                                                     0346
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0348
*        (R0,                                                      0348
*         R1,                                                      0348
*         R14,                                                     0348
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0349
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0350
*     END;                          /*                       @Y30LB40*/
*   RFY                                                            0352
*    (R0,                                                          0352
*     R1,                                                          0352
*     R14,                                                         0352
*     R15) RSTD;                    /*                       @Y30LB40*/
@RF00343 DS    0H                                                  0353
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0353
*                                                            @Y30LB40*/
         TIME
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/
         ST    R1,DOUBLEWD
*   RFY                                                            0355
*    (R0,                                                          0355
*     R1,                                                          0355
*     R14,                                                         0355
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0356
*   TSBEG=CKSTIME;                  /*                       @OZ11673*/
         MVC   TSBEG(7),CKSTIME                                    0357
*   TSEND=CKSTIME;                  /*                       @OZ11673*/
         MVC   TSEND(7),CKSTIME                                    0358
*   TSETIME=TSETIME+TIMESL;         /*                       @OZ11673*/
         L     @07,TSETIME                                         0359
         AL    @07,TIMESL                                          0359
         ST    @07,TSETIME                                         0359
*                                                                  0360
*/********************************************************************/
*/* BEGIN PROCESSING THE FILE                                @Y30LB40*/
*/********************************************************************/
*                                                                  0360
*RDTRACE:                                                          0360
*   RFY                                                            0360
*    (R0,                                                          0360
*     R1,                                                          0360
*     R14,                                                         0360
*     R15) RSTD;                    /*                       @Y30LB40*/
RDTRACE  DS    0H                                                  0361
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/
         GET   INDCB,RCDIN
*   RFY                                                            0362
*    (R0,                                                          0362
*     R1,                                                          0362
*     R14,                                                         0362
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF CKTIME<CKSTIME×CKTIME>CKETIME THEN                          0363
         CLC   CKTIME(7),CKSTIME                                   0363
         BL    @RT00363                                            0363
         CLC   CKTIME(7),CKETIME                                   0363
         BH    @RT00363                                            0363
*     GO TO RDTRACE;                /* IF NOT IN DATE AND TIME     0364
*                                      RANGE,READ NEXT               */
*   IF SELECTSW='1'B                /* WAS SPECIFIC SELECTION ENTERED
*                                                            @Y30LB40*/
*     THEN                                                         0365
         TM    SELECTSW,B'10000000'                                0365
         BNO   @RF00365                                            0365
*     IF PARMSW='D'                 /* YES                   @Y30LB40*/
*       THEN                                                       0366
         CLI   PARMSW,C'D'                                         0366
         BNE   @RF00366                                            0366
*       DO;                         /*                       @Y30LB40*/
*         IF SDGINBIN^=SELSDG THEN                                 0368
         CLC   SDGINBIN(1),SELSDG                                  0368
         BNE   @RT00368                                            0368
*           GO TO RDTRACE;          /* NOT RIGHT ONE,READ NEXT RECORD*/
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0371
*       DO;                         /*                       @Y30LB40*/
         B     @RC00366                                            0371
@RF00366 DS    0H                                                  0372
*         IF LIB^=LIBRARY×U^=READWRIT THEN                         0372
         CLC   LIB(1),LIBRARY                                      0372
         BNE   @RT00372                                            0372
         CLC   U(1),READWRIT                                       0372
         BNE   @RT00372                                            0372
*           GO TO RDTRACE;          /* NOT RIGHT ONE,READ NEXT RECORD*/
*       END;                        /*                       @Y30LB40*/
*   IF(DSTGD+STGD)^>0 THEN                                         0375
@RC00366 DS    0H                                                  0375
@RF00365 L     @07,DSTGD                                           0375
         AL    @07,STGD                                            0375
         LTR   @07,@07                                             0375
         BNP   @RT00375                                            0375
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/
*     THEN                                                         0377
         TM    FIRSTSW,B'10000000'                                 0377
         BNO   @RF00377                                            0377
*     DO;                           /*                       @Y30LB40*/
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */
         NI    FIRSTSW,B'01111111'                                 0379
*       CKSEQ=CKTIME;               /* SETUP TIMESLICE START AND END
*                                                            @Y30LB40*/
         MVC   CKSEQ(7),CKTIME                                     0380
*       CALL GETSLICE;              /*                       @OZ11673*/
         BAL   @14,GETSLICE                                        0381
*     END;                          /*                       @Y30LB40*/
*   IF CKTIME<CKSEQ                 /* CHECK INPUT SEQUENCE  @Y30LB40*/
*     THEN                                                         0383
@RF00377 CLC   CKTIME(7),CKSEQ                                     0383
         BNL   @RF00383                                            0383
*     DO;                           /* OUT OF SEQUENCE       @Y30LB40*/
*       DSLINE=SEQMSG;              /*                       @Y30LB40*/
         MVI   DSLINE+43,C' '                                      0385
         MVC   DSLINE+44(77),DSLINE+43                             0385
         MVC   DSLINE(43),SEQMSG                                   0385
*       RFY                                                        0386
*        (R0,                                                      0386
*         R1,                                                      0386
*         R14,                                                     0386
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,DSLINE);  /* PRINT ERROR MESSAGE   @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*       RFY                                                        0388
*        (R0,                                                      0388
*         R1,                                                      0388
*         R14,                                                     0388
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /* EXIT WITH RC=8        @Y30LB40*/
         MVC   RETURNCD(2),@CH00069                                0389
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0390
*     END;                          /*                       @Y30LB40*/
*   CKSEQ=CKTIME;                   /* UPDATE SEQUENCE CHECK @Y30LB40*/
@RF00383 MVC   CKSEQ(7),CKTIME                                     0392
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT SELECTED INPUT RECORDS
*                                                            @Y30LB40*/
         LA    @07,1                                               0393
         AL    @07,RCDCOUNT                                        0393
         ST    @07,RCDCOUNT                                        0393
*   IF PARMSW='R' THEN                                             0394
         CLI   PARMSW,C'R'                                         0394
         BE    @RT00394                                            0394
*     GO TO ROUTINE2;               /* READ/WRITE UNIT REPORT        */
*CHECKTIM:                          /* CHECK IF IN THE PROPER TIME 0396
*                                      SLICE                         */
*   IF CKTIME>TSEND THEN                                           0396
CHECKTIM CLC   CKTIME(7),TSEND                                     0396
         BH    @RT00396                                            0396
*     GO TO DSCTLBRK;               /* NEW TIME SLICE        @Y30LB40*/
*DSACCUM:                           /* ROUTINE TO ACCUMULATE       0398
*                                      NECESSARY TOTALS              */
*   K=SDGINBIN+1;                   /*                       @ZA16140*/
DSACCUM  LA    @07,1                                               0398
         SLR   @15,@15                                             0398
         IC    @15,SDGINBIN                                        0398
         ALR   @15,@07                                             0398
         ST    @15,K                                               0398
*   M=((LOADTIME/4)/3)+1;           /* BUILD CLASS INTERVAL FOR LOAD
*                                      TIME                          */
         L     @00,LOADTIME                                        0399
         SRDA  @00,32                                              0399
         D     @00,@CF00032                                        0399
         ALR   @01,@07                                             0399
         ST    @01,M                                               0399
*   IF M>10 THEN                                                   0400
         LA    @07,10                                              0400
         CR    @01,@07                                             0400
         BNH   @RF00400                                            0400
*     M=10;                         /* SET TO MAX            @Y30LB40*/
         ST    @07,M                                               0401
*   DO L=1 TO 2;                    /* DETAIL AND JOB TOTALS @Y30LB40*/
@RF00400 LA    @07,1                                               0402
         ST    @07,L                                               0402
@DL00402 DS    0H                                                  0403
*     CALL CALCDSA(K,L,11);         /* GET ARRAY ENTRY       @ZA16140*/
         LA    @07,K                                               0403
         ST    @07,@AL00001                                        0403
         LA    @07,L                                               0403
         ST    @07,@AL00001+4                                      0403
         LA    @07,@CF00033                                        0403
         ST    @07,@AL00001+8                                      0403
         LA    @01,@AL00001                                        0403
         BAL   @14,CALCDSA                                         0403
*     DSB1=DSB1+LOADNUM;            /* SUM CARTRIDGE LOADS   @Y30LB40*/
         L     @07,ARRAYPTR                                        0404
         SLR   @15,@15                                             0404
         IC    @15,LOADNUM                                         0404
         AL    @15,DSB1(,@07)                                      0404
         ST    @15,DSB1(,@07)                                      0404
*     DSB2=DSB2+LOADTIME;           /* SUM LOAD TIME         @Y30LB40*/
         L     @15,DSB2(,@07)                                      0405
         AL    @15,LOADTIME                                        0405
         ST    @15,DSB2(,@07)                                      0405
*     DSB3=DSB3+STGD;               /* SUM CYLS STAGED       @Y30LB40*/
         L     @15,STGD                                            0406
         L     @14,DSB3(,@07)                                      0406
         ALR   @14,@15                                             0406
         ST    @14,DSB3(,@07)                                      0406
*     DSB6=DSB6+DSTGD;              /* SUM CYLS DESTAGED     @Y30LB40*/
         L     @14,DSTGD                                           0407
         L     @05,DSB6(,@07)                                      0407
         ALR   @05,@14                                             0407
         ST    @05,DSB6(,@07)                                      0407
*     DSB9=DSB9+(STGD+DSTGD);       /* TOT STGNG             @Y30LB40*/
         ALR   @14,@15                                             0408
         AL    @14,DSB9(,@07)                                      0408
         ST    @14,DSB9(,@07)                                      0408
*     DSB10=DSB10+(DEVSGTM+DEVDSTM);/* SUM DEV TIME          @Y30LB40*/
         L     @14,DEVSGTM                                         0409
         LR    @05,@14                                             0409
         AL    @05,DEVDSTM                                         0409
         AL    @05,DSB10(,@07)                                     0409
         ST    @05,DSB10(,@07)                                     0409
*     DSB11=DSB11+(SYSSGTM+SYSDSTM);/* SUM SYS TIME          @Y30LB40*/
         L     @05,SYSSGTM                                         0410
         LR    @04,@05                                             0410
         AL    @04,SYSDSTM                                         0410
         AL    @04,DSB11(,@07)                                     0410
         ST    @04,DSB11(,@07)                                     0410
*     IF STGDNUM^=0                 /* WERE THERE CYLINDERS STAGED 0411
*                                                            @Y30LB40*/
*       THEN                                                       0411
         CLI   STGDNUM,0                                           0411
         BE    @RF00411                                            0411
*       DO;                         /* YES                   @Y30LB40*/
*         DSB4=DSB4+DEVSGTM;        /* DEV STAGE TIME        @Y30LB40*/
         L     @04,DSB4(,@07)                                      0413
         ALR   @04,@14                                             0413
         ST    @04,DSB4(,@07)                                      0413
*         DSB5=DSB5+SYSSGTM;        /* SYS STAGE TIME        @Y30LB40*/
         AL    @05,DSB5(,@07)                                      0414
         ST    @05,DSB5(,@07)                                      0414
*         IF DEVSGTM=0 THEN                                        0415
         LTR   @14,@14                                             0415
         BNZ   @RF00415                                            0415
*           N=(STGD*4)+1;           /*                       @Y30LB40*/
         SLA   @15,2                                               0416
         AL    @15,@CF00044                                        0416
         ST    @15,N                                               0416
*         ELSE                                                     0417
*           N=((STGD*4)/DEVSGTM)+1; /*                       @Y30LB40*/
         B     @RC00415                                            0417
@RF00415 L     @01,STGD                                            0417
         M     @00,@CF00104                                        0417
         D     @00,DEVSGTM                                         0417
         AL    @01,@CF00044                                        0417
         ST    @01,N                                               0417
*         IF N>10 THEN                                             0418
@RC00415 LA    @07,10                                              0418
         C     @07,N                                               0418
         BNL   @RF00418                                            0418
*           N=10;                   /*                       @Y30LB40*/
         ST    @07,N                                               0419
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/
@RF00418 LA    @07,K                                               0420
         ST    @07,@AL00001                                        0420
         LA    @07,L                                               0420
         ST    @07,@AL00001+4                                      0420
         LA    @07,N                                               0420
         ST    @07,@AL00001+8                                      0420
         LA    @01,@AL00001                                        0420
         BAL   @14,CALCDSA                                         0420
*         DSB3=DSB3+STGDNUM;        /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0421
         SLR   @15,@15                                             0421
         IC    @15,STGDNUM                                         0421
         AL    @15,DSB3(,@07)                                      0421
         ST    @15,DSB3(,@07)                                      0421
*         IF SYSSGTM=0 THEN                                        0422
         L     @07,SYSSGTM                                         0422
         LTR   @07,@07                                             0422
         BNZ   @RF00422                                            0422
*           N=(STGD*4)+1;           /*                       @Y30LB40*/
         L     @07,STGD                                            0423
         SLA   @07,2                                               0423
         AL    @07,@CF00044                                        0423
         ST    @07,N                                               0423
*         ELSE                                                     0424
*           N=((STGD*4)/SYSSGTM)+1; /*                       @Y30LB40*/
         B     @RC00422                                            0424
@RF00422 L     @01,STGD                                            0424
         M     @00,@CF00104                                        0424
         D     @00,SYSSGTM                                         0424
         AL    @01,@CF00044                                        0424
         ST    @01,N                                               0424
*         IF N>10 THEN                                             0425
@RC00422 LA    @07,10                                              0425
         C     @07,N                                               0425
         BNL   @RF00425                                            0425
*           N=10;                   /*                       @Y30LB40*/
         ST    @07,N                                               0426
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/
@RF00425 LA    @07,K                                               0427
         ST    @07,@AL00001                                        0427
         LA    @07,L                                               0427
         ST    @07,@AL00001+4                                      0427
         LA    @07,N                                               0427
         ST    @07,@AL00001+8                                      0427
         LA    @01,@AL00001                                        0427
         BAL   @14,CALCDSA                                         0427
*         DSB5=DSB5+STGDNUM;        /* COUNT FOR SYSTEM      @Y30LB40*/
         L     @07,ARRAYPTR                                        0428
         SLR   @15,@15                                             0428
         IC    @15,STGDNUM                                         0428
         AL    @15,DSB5(,@07)                                      0428
         ST    @15,DSB5(,@07)                                      0428
*       END;                        /*                       @Y30LB40*/
*     IF DSTGDNUM^=0                /* WERE CYLINDERS DESTAGED     0430
*                                                            @Y30LB40*/
*       THEN                                                       0430
@RF00411 CLI   DSTGDNUM,0                                          0430
         BE    @RF00430                                            0430
*       DO;                         /* YES                   @Y30LB40*/
*         CALL CALCDSA(K,L,11);     /* GET ARRAY ADDRESS     @ZA16140*/
         LA    @07,K                                               0432
         ST    @07,@AL00001                                        0432
         LA    @07,L                                               0432
         ST    @07,@AL00001+4                                      0432
         LA    @07,@CF00033                                        0432
         ST    @07,@AL00001+8                                      0432
         LA    @01,@AL00001                                        0432
         BAL   @14,CALCDSA                                         0432
*         DSB7=DSB7+DEVDSTM;        /* DEV DESTAGE TIME      @Y30LB40*/
         L     @07,ARRAYPTR                                        0433
         L     @15,DEVDSTM                                         0433
         L     @14,DSB7(,@07)                                      0433
         ALR   @14,@15                                             0433
         ST    @14,DSB7(,@07)                                      0433
*         DSB8=DSB8+SYSDSTM;        /* SYS DESTAGE TIME      @Y30LB40*/
         L     @14,DSB8(,@07)                                      0434
         AL    @14,SYSDSTM                                         0434
         ST    @14,DSB8(,@07)                                      0434
*         IF DEVDSTM=0 THEN                                        0435
         LTR   @15,@15                                             0435
         BNZ   @RF00435                                            0435
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/
         L     @07,DSTGD                                           0436
         SLA   @07,2                                               0436
         AL    @07,@CF00044                                        0436
         ST    @07,N                                               0436
*         ELSE                                                     0437
*           N=((DSTGD*4)/DEVDSTM)+1;/*                       @Y30LB40*/
         B     @RC00435                                            0437
@RF00435 L     @01,DSTGD                                           0437
         M     @00,@CF00104                                        0437
         D     @00,DEVDSTM                                         0437
         AL    @01,@CF00044                                        0437
         ST    @01,N                                               0437
*         IF N>10 THEN                                             0438
@RC00435 LA    @07,10                                              0438
         C     @07,N                                               0438
         BNL   @RF00438                                            0438
*           N=10;                   /*                       @Y30LB40*/
         ST    @07,N                                               0439
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/
@RF00438 LA    @07,K                                               0440
         ST    @07,@AL00001                                        0440
         LA    @07,L                                               0440
         ST    @07,@AL00001+4                                      0440
         LA    @07,N                                               0440
         ST    @07,@AL00001+8                                      0440
         LA    @01,@AL00001                                        0440
         BAL   @14,CALCDSA                                         0440
*         DSB6=DSB6+DSTGDNUM;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0441
         SLR   @15,@15                                             0441
         IC    @15,DSTGDNUM                                        0441
         AL    @15,DSB6(,@07)                                      0441
         ST    @15,DSB6(,@07)                                      0441
*         IF SYSDSTM=0 THEN                                        0442
         L     @07,SYSDSTM                                         0442
         LTR   @07,@07                                             0442
         BNZ   @RF00442                                            0442
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/
         L     @07,DSTGD                                           0443
         SLA   @07,2                                               0443
         AL    @07,@CF00044                                        0443
         ST    @07,N                                               0443
*         ELSE                                                     0444
*           N=((DSTGD*4)/SYSDSTM)+1;/*                       @Y30LB40*/
         B     @RC00442                                            0444
@RF00442 L     @01,DSTGD                                           0444
         M     @00,@CF00104                                        0444
         D     @00,SYSDSTM                                         0444
         AL    @01,@CF00044                                        0444
         ST    @01,N                                               0444
*         IF N>10 THEN                                             0445
@RC00442 LA    @07,10                                              0445
         C     @07,N                                               0445
         BNL   @RF00445                                            0445
*           N=10;                   /*                       @Y30LB40*/
         ST    @07,N                                               0446
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/
@RF00445 LA    @07,K                                               0447
         ST    @07,@AL00001                                        0447
         LA    @07,L                                               0447
         ST    @07,@AL00001+4                                      0447
         LA    @07,N                                               0447
         ST    @07,@AL00001+8                                      0447
         LA    @01,@AL00001                                        0447
         BAL   @14,CALCDSA                                         0447
*         DSB8=DSB8+DSTGDNUM;       /* COUNT FOR SYSTEM      @Y30LB40*/
         L     @07,ARRAYPTR                                        0448
         SLR   @15,@15                                             0448
         IC    @15,DSTGDNUM                                        0448
         AL    @15,DSB8(,@07)                                      0448
         ST    @15,DSB8(,@07)                                      0448
*       END;                        /*                       @Y30LB40*/
*     CALL CALCDSA(K,L,M);          /* GET ARRAY ADDRESS     @ZA16140*/
@RF00430 LA    @07,K                                               0450
         ST    @07,@AL00001                                        0450
         LA    @07,L                                               0450
         ST    @07,@AL00001+4                                      0450
         LA    @07,M                                               0450
         ST    @07,@AL00001+8                                      0450
         LA    @01,@AL00001                                        0450
         BAL   @14,CALCDSA                                         0450
*     IF LOADNUM=0 THEN                                            0451
         CLI   LOADNUM,0                                           0451
         BE    @RT00451                                            0451
*       ;                           /*                       @Y30LB40*/
*     ELSE                                                         0453
*       DSB2=DSB2+1;                /* COUNT FOR LOAD TIME   @Y30LB40*/
         L     @07,ARRAYPTR                                        0453
         LA    @15,1                                               0453
         AL    @15,DSB2(,@07)                                      0453
         ST    @15,DSB2(,@07)                                      0453
*     IF MININUM=0 THEN                                            0454
@RT00451 CLI   MININUM,0                                           0454
         BE    @RT00454                                            0454
*       ;                           /*                       @Y30LB40*/
*     ELSE                                                         0456
*       DO;                         /*                       @Y30LB40*/
*         N=(PAGES/MININUM)+1;      /*                       @Y30LB40*/
         SLR   @01,@01                                             0457
         IC    @01,PAGES                                           0457
         SLR   @00,@00                                             0457
         SLR   @07,@07                                             0457
         IC    @07,MININUM                                         0457
         DR    @00,@07                                             0457
         AL    @01,@CF00044                                        0457
         ST    @01,N                                               0457
*         IF N>10 THEN                                             0458
         LA    @07,10                                              0458
         CR    @01,@07                                             0458
         BNH   @RF00458                                            0458
*           N=10;                   /*                       @Y30LB40*/
         ST    @07,N                                               0459
*         CALL CALCDSA(K,L,N);      /* GET ARRAY ADDRESS     @ZA16140*/
@RF00458 LA    @07,K                                               0460
         ST    @07,@AL00001                                        0460
         LA    @07,L                                               0460
         ST    @07,@AL00001+4                                      0460
         LA    @07,N                                               0460
         ST    @07,@AL00001+8                                      0460
         LA    @01,@AL00001                                        0460
         BAL   @14,CALCDSA                                         0460
*         DSB9=DSB9+1;              /* PAGES PER MINI        @Y30LB40*/
         L     @07,ARRAYPTR                                        0461
         LA    @15,1                                               0461
         AL    @15,DSB9(,@07)                                      0461
         ST    @15,DSB9(,@07)                                      0461
*       END;                        /*                       @Y30LB40*/
*     N=((STGD+DSTGD)/PAGES)+1;     /*                       @Y30LB40*/
@RT00454 L     @00,STGD                                            0463
         AL    @00,DSTGD                                           0463
         SRDA  @00,32                                              0463
         SLR   @07,@07                                             0463
         IC    @07,PAGES                                           0463
         DR    @00,@07                                             0463
         AL    @01,@CF00044                                        0463
         ST    @01,N                                               0463
*     IF N>10 THEN                                                 0464
         LA    @07,10                                              0464
         CR    @01,@07                                             0464
         BNH   @RF00464                                            0464
*       N=10;                       /*                       @Y30LB40*/
         ST    @07,N                                               0465
*     CALL CALCDSA(K,L,N);          /* GET ARRAY ADDRESS     @ZA16140*/
@RF00464 LA    @07,K                                               0466
         ST    @07,@AL00001                                        0466
         LA    @07,L                                               0466
         ST    @07,@AL00001+4                                      0466
         LA    @07,N                                               0466
         ST    @07,@AL00001+8                                      0466
         LA    @01,@AL00001                                        0466
         BAL   @14,CALCDSA                                         0466
*     DSB10=DSB10+1;                /* COUNT CYLS PER PAGE   @Y30LB40*/
         L     @07,ARRAYPTR                                        0467
         LA    @15,1                                               0467
         AL    @15,DSB10(,@07)                                     0467
         ST    @15,DSB10(,@07)                                     0467
*   END;                            /*                       @Y30LB40*/
         LA    @07,1                                               0468
         AL    @07,L                                               0468
         ST    @07,L                                               0468
         C     @07,@CF00051                                        0468
         BNH   @DL00402                                            0468
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/
         B     RDTRACE                                             0469
*/********************************************************************/
*                                                                  0470
*                                                                  0470
*/********************************************************************/
*/* PRINT SDG TIME SLICE TOTALS                              @ZA16140*/
*/********************************************************************/
*                                                                  0470
*DSCTLBRK:                          /* DATA STAGER TIME SLICE CTL  0470
*                                      BREAK                         */
*   L=1;                            /* DETAIL ONLY           @Y30LB40*/
DSCTLBRK MVC   L(4),@CF00044                                       0470
*PROCDSBK:                                                         0471
*   DO K=1 TO 28;                   /* PROCESS SDGS 0 - 27   @ZA16140*/
PROCDSBK LA    @07,1                                               0471
         ST    @07,K                                               0471
@DL00471 DS    0H                                                  0472
*     DSLINE=' ';                   /*                       @Y30LB40*/
         MVI   DSLINE+1,C' '                                       0472
         MVC   DSLINE+2(119),DSLINE+1                              0472
         MVI   DSLINE,C' '                                         0472
*     CALCFLD=K-1;                  /* GET SDG NUMBER        @ZA16140*/
         BCTR  @07,0                                               0473
         ST    @07,CALCFLD                                         0473
*     CALL EDITFIX(ADDR(CALCFLD),4,'N');/* EDIT SDG          @ZA16140*/
         MVC   @AL00001+4(8),@AL00474                              0474
         LA    @07,CALCFLD                                         0474
         ST    @07,@AFTEMPS                                        0474
         LA    @07,@AFTEMPS                                        0474
         ST    @07,@AL00001                                        0474
         LA    @01,@AL00001                                        0474
         BAL   @14,EDITFIX                                         0474
*     SDGFLD=FIXOUT(12:13);         /*                       @ZA16140*/
         MVC   SDGFLD(2),FIXOUT+11                                 0475
*     IF L=2&EOFSW='1'B             /* ARE REPORT TOTALS WANTED      */
*       THEN                                                       0476
         CLC   L(4),@CF00051                                       0476
         BNE   @RF00476                                            0476
         TM    EOFSW,B'10000000'                                   0476
         BNO   @RF00476                                            0476
*       DO;                         /* YES,SET TOTALS CONSTANT INFO  */
*         DSFLD2='DISTR.';          /*                       @Y30LB40*/
         MVC   DSFLD2(6),@CC00908                                  0478
*         DSFLD2A='SUMMARY ';       /*                       @Y30LB40*/
         MVC   DSFLD2A(8),@CC00909                                 0479
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0481
*       DO;                         /* TIME SLICE TOTALS,SET CONSTANT
*                                      INFO                          */
         B     @RC00476                                            0481
@RF00476 DS    0H                                                  0482
*         DSFLD2='  /   ';          /*                       @Y30LB40*/
         MVC   DSFLD2(6),@CC00910                                  0482
*         CALL EDITFIX(ADDR(TSSYR),1,'N');/*                 @Y30LB40*/
         MVC   @AL00001+4(8),@AL00483                              0483
         LA    @07,TSSYR                                           0483
         ST    @07,@AFTEMPS                                        0483
         LA    @07,@AFTEMPS                                        0483
         ST    @07,@AL00001                                        0483
         LA    @01,@AL00001                                        0483
         BAL   @14,EDITFIX                                         0483
*         DSFLD2(1:2)=FIXOUT(12:13);/*                       @Y30LB40*/
         MVC   DSFLD2(2),FIXOUT+11                                 0484
*         CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00485                              0485
         LA    @07,TSSDAY                                          0485
         ST    @07,@AFTEMPS                                        0485
         LA    @07,@AFTEMPS                                        0485
         ST    @07,@AL00001                                        0485
         LA    @01,@AL00001                                        0485
         BAL   @14,EDITFIX                                         0485
*         DSFLD2(4:6)=FIXOUT(11:13);/*                       @Y30LB40*/
         MVC   DSFLD2+3(3),FIXOUT+10                               0486
*         HOUR=TSSTIME/3600;        /*                       @Y30LB40*/
         L     @07,TSSTIME                                         0487
         LA    @15,3600                                            0487
         LR    @00,@07                                             0487
         SRDA  @00,32                                              0487
         DR    @00,@15                                             0487
         ST    @01,HOUR                                            0487
*         MINUTE=(TSSTIME-(HOUR*3600))/60;/*                 @Y30LB40*/
         LA    @14,60                                              0488
         MR    @00,@15                                             0488
         LR    @02,@07                                             0488
         SLR   @02,@01                                             0488
         SRDA  @02,32                                              0488
         DR    @02,@14                                             0488
         ST    @03,MINUTE                                          0488
*         SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));                0489
         MR    @02,@14                                             0489
         ALR   @01,@03                                             0489
         SLR   @07,@01                                             0489
         ST    @07,SECOND                                          0489
*         DSFLD2A='  :  :  ';       /*                       @Y30LB40*/
         MVC   DSFLD2A(8),@CC00911                                 0490
*         CALL EDITFIX(ADDR(HOUR),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00491                              0491
         LA    @07,HOUR                                            0491
         ST    @07,@AFTEMPS                                        0491
         LA    @07,@AFTEMPS                                        0491
         ST    @07,@AL00001                                        0491
         LA    @01,@AL00001                                        0491
         BAL   @14,EDITFIX                                         0491
*         DSFLD2A(1:2)=FIXOUT(12:13);/*                      @Y30LB40*/
         MVC   DSFLD2A(2),FIXOUT+11                                0492
*         CALL EDITFIX(ADDR(MINUTE),4,'N');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00493                              0493
         LA    @07,MINUTE                                          0493
         ST    @07,@AFTEMPS                                        0493
         LA    @07,@AFTEMPS                                        0493
         ST    @07,@AL00001                                        0493
         LA    @01,@AL00001                                        0493
         BAL   @14,EDITFIX                                         0493
*         DSFLD2A(4:5)=FIXOUT(12:13);/*                      @Y30LB40*/
         MVC   DSFLD2A+3(2),FIXOUT+11                              0494
*         CALL EDITFIX(ADDR(SECOND),4,'N');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00495                              0495
         LA    @07,SECOND                                          0495
         ST    @07,@AFTEMPS                                        0495
         LA    @07,@AFTEMPS                                        0495
         ST    @07,@AL00001                                        0495
         LA    @01,@AL00001                                        0495
         BAL   @14,EDITFIX                                         0495
*         DSFLD2A(7:8)=FIXOUT(12:13);/*                      @Y30LB40*/
         MVC   DSFLD2A+6(2),FIXOUT+11                              0496
*       END;                        /*                       @Y30LB40*/
*     CALL CALCDSA(K,L,11);         /* GET ARRAY ADDRESS     @ZA16140*/
@RC00476 LA    @07,K                                               0498
         ST    @07,@AL00001                                        0498
         LA    @07,L                                               0498
         ST    @07,@AL00001+4                                      0498
         LA    @07,@CF00033                                        0498
         ST    @07,@AL00001+8                                      0498
         LA    @01,@AL00001                                        0498
         BAL   @14,CALCDSA                                         0498
*     IF DSB9^=0 THEN                                              0499
         L     @07,ARRAYPTR                                        0499
         L     @07,DSB9(,@07)                                      0499
         LTR   @07,@07                                             0499
         BZ    @RF00499                                            0499
*       DO M=1 TO 10;               /* CLASSES 1-10          @Y30LB40*/
         LA    @07,1                                               0500
         ST    @07,M                                               0500
@DL00500 DS    0H                                                  0501
*         IF LINECNT>43 THEN                                       0501
         C     LINECNT,@CF00712                                    0501
         BNH   @RF00501                                            0501
*           DO;                     /* SKIP TO A NEW PAGE    @Y30LB40*/
*             LINECNT=2;            /* RESET THE LINE COUNTER      0503
*                                                            @Y30LB40*/
         LA    LINECNT,2                                           0503
*             PAGECNT=PAGECNT+1;    /* UP PAGE COUNTER BY 1          */
         LA    @07,1                                               0504
         AL    @07,PAGECNT                                         0504
         ST    @07,PAGECNT                                         0504
*             HEADHOLD=HDNG1;       /*                       @Y30LB40*/
         MVC   HEADHOLD(121),HDNG1                                 0505
*             CALL EDITFIX(ADDR(PAGECNT),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00506                              0506
         LA    @07,PAGECNT                                         0506
         ST    @07,@AFTEMPS                                        0506
         LA    @07,@AFTEMPS                                        0506
         ST    @07,@AL00001                                        0506
         LA    @01,@AL00001                                        0506
         BAL   @14,EDITFIX                                         0506
*             HEADHOLD(118:121)=FIXOUT(10:13);/*             @Y30LB40*/
         MVC   HEADHOLD+117(4),FIXOUT+9                            0507
*             HEADHOLD(107:111)=TODAY;/*                     @Y30LB40*/
         MVC   HEADHOLD+106(5),TODAY                               0508
*             RFY                                                  0509
*              (R0,                                                0509
*               R1,                                                0509
*               R14,                                               0509
*               R15) RSTD;          /*                       @Y30LB40*/
*             GEN(PUT   PRNTDCB,HEADHOLD);/*                 @Y30LB40*/
         PUT   PRNTDCB,HEADHOLD
*             RFY                                                  0511
*              (R0,                                                0511
*               R1,                                                0511
*               R14,                                               0511
*               R15) UNRSTD;        /*                       @Y30LB40*/
*           END;                    /*                       @Y30LB40*/
*         IF M=1 THEN                                              0513
@RF00501 CLC   M(4),@CF00044                                       0513
         BNE   @RF00513                                            0513
*           DO;                     /* 1ST TIME THROUGH, PRINT     0514
*                                      HEADINGS                      */
*             RFY                                                  0515
*              (R0,                                                0515
*               R1,                                                0515
*               R14,                                               0515
*               R15) RSTD;          /*                       @Y30LB40*/
*             GEN(PUT   PRNTDCB,HDNG2);/*                    @Y30LB40*/
         PUT   PRNTDCB,HDNG2
*             GEN(PUT   PRNTDCB,HDNG3);/*                    @Y30LB40*/
         PUT   PRNTDCB,HDNG3
*             GEN(PUT   PRNTDCB,HDNG4);/*                    @Y30LB40*/
         PUT   PRNTDCB,HDNG4
*             GEN(PUT   PRNTDCB,SPACE1);/*                   @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*             RFY                                                  0520
*              (R0,                                                0520
*               R1,                                                0520
*               R14,                                               0520
*               R15) UNRSTD;        /*                       @Y30LB40*/
*             LINECNT=LINECNT+5;    /*                       @Y30LB40*/
         AL    LINECNT,@CF00372                                    0521
*           END;                    /*                       @Y30LB40*/
*         CALL SETLINE(M);          /* SET INTERVALS IN PRINT LINE   */
@RF00513 LA    @07,M                                               0523
         ST    @07,@AL00001                                        0523
         LA    @01,@AL00001                                        0523
         BAL   @14,SETLINE                                         0523
*         CALL CALCDSA(K,L,M);      /* GET ARRAY ADDRESS     @ZA16140*/
         LA    @07,K                                               0524
         ST    @07,@AL00001                                        0524
         LA    @07,L                                               0524
         ST    @07,@AL00001+4                                      0524
         LA    @07,M                                               0524
         ST    @07,@AL00001+8                                      0524
         LA    @01,@AL00001                                        0524
         BAL   @14,CALCDSA                                         0524
*         CALL EDITFIX(ADDR(DSB2),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00525                              0525
         L     @07,ARRAYPTR                                        0525
         LA    @07,DSB2(,@07)                                      0525
         ST    @07,@AFTEMPS                                        0525
         LA    @07,@AFTEMPS                                        0525
         ST    @07,@AL00001                                        0525
         LA    @01,@AL00001                                        0525
         BAL   @14,EDITFIX                                         0525
*         DSFLD10=FIXOUT(9:13);     /* LOAD TIME COUNT       @Y30LB40*/
         MVC   DSFLD10(5),FIXOUT+8                                 0526
*         CALL EDITFIX(ADDR(DSB3),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00527                              0527
         L     @07,ARRAYPTR                                        0527
         LA    @07,DSB3(,@07)                                      0527
         ST    @07,@AFTEMPS                                        0527
         LA    @07,@AFTEMPS                                        0527
         ST    @07,@AL00001                                        0527
         LA    @01,@AL00001                                        0527
         BAL   @14,EDITFIX                                         0527
*         DSFLD12=FIXOUT(8:13);     /* DEV STG RATE          @Y30LB40*/
         MVC   DSFLD12(6),FIXOUT+7                                 0528
*         CALL EDITFIX(ADDR(DSB5),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00529                              0529
         L     @07,ARRAYPTR                                        0529
         LA    @07,DSB5(,@07)                                      0529
         ST    @07,@AFTEMPS                                        0529
         LA    @07,@AFTEMPS                                        0529
         ST    @07,@AL00001                                        0529
         LA    @01,@AL00001                                        0529
         BAL   @14,EDITFIX                                         0529
*         DSFLD14=FIXOUT(8:13);     /* SYS STG RATE          @Y30LB40*/
         MVC   DSFLD14(6),FIXOUT+7                                 0530
*         CALL EDITFIX(ADDR(DSB6),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00531                              0531
         L     @07,ARRAYPTR                                        0531
         LA    @07,DSB6(,@07)                                      0531
         ST    @07,@AFTEMPS                                        0531
         LA    @07,@AFTEMPS                                        0531
         ST    @07,@AL00001                                        0531
         LA    @01,@AL00001                                        0531
         BAL   @14,EDITFIX                                         0531
*         DSFLD16=FIXOUT(8:13);     /* DEV DSTG RATE         @Y30LB40*/
         MVC   DSFLD16(6),FIXOUT+7                                 0532
*         CALL EDITFIX(ADDR(DSB8),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00533                              0533
         L     @07,ARRAYPTR                                        0533
         LA    @07,DSB8(,@07)                                      0533
         ST    @07,@AFTEMPS                                        0533
         LA    @07,@AFTEMPS                                        0533
         ST    @07,@AL00001                                        0533
         LA    @01,@AL00001                                        0533
         BAL   @14,EDITFIX                                         0533
*         DSFLD18=FIXOUT(8:13);     /* SYS DSTG RATE         @Y30LB40*/
         MVC   DSFLD18(6),FIXOUT+7                                 0534
*         CALL EDITFIX(ADDR(DSB9),4,'S');/*                  @Y30LB40*/
         MVC   @AL00001+4(8),@AL00535                              0535
         L     @07,ARRAYPTR                                        0535
         LA    @07,DSB9(,@07)                                      0535
         ST    @07,@AFTEMPS                                        0535
         LA    @07,@AFTEMPS                                        0535
         ST    @07,@AL00001                                        0535
         LA    @01,@AL00001                                        0535
         BAL   @14,EDITFIX                                         0535
*         DSFLD20=FIXOUT(8:13);     /* PAGES PER MINI        @Y30LB40*/
         MVC   DSFLD20(6),FIXOUT+7                                 0536
*         CALL EDITFIX(ADDR(DSB10),4,'S');/*                 @Y30LB40*/
         MVC   @AL00001+4(8),@AL00537                              0537
         L     @07,ARRAYPTR                                        0537
         LA    @07,DSB10(,@07)                                     0537
         ST    @07,@AFTEMPS                                        0537
         LA    @07,@AFTEMPS                                        0537
         ST    @07,@AL00001                                        0537
         LA    @01,@AL00001                                        0537
         BAL   @14,EDITFIX                                         0537
*         DSFLD22=FIXOUT(8:13);     /* CYLS PER PAGE         @Y30LB40*/
         MVC   DSFLD22(6),FIXOUT+7                                 0538
*         DSB2=0;                   /* CLEAR BUCKETS         @Y30LB40*/
         SLR   @07,@07                                             0539
         L     @15,ARRAYPTR                                        0539
         ST    @07,DSB2(,@15)                                      0539
*         DSB3=0;                   /*                       @Y30LB40*/
         ST    @07,DSB3(,@15)                                      0540
*         DSB5=0;                   /*                       @Y30LB40*/
         ST    @07,DSB5(,@15)                                      0541
*         DSB6=0;                   /*                       @Y30LB40*/
         ST    @07,DSB6(,@15)                                      0542
*         DSB8=0;                   /*                       @Y30LB40*/
         ST    @07,DSB8(,@15)                                      0543
*         DSB9=0;                   /*                       @Y30LB40*/
         ST    @07,DSB9(,@15)                                      0544
*         DSB10=0;                  /*                       @Y30LB40*/
         ST    @07,DSB10(,@15)                                     0545
*         RFY                                                      0546
*          (R0,                                                    0546
*           R1,                                                    0546
*           R14,                                                   0546
*           R15) RSTD;              /*                       @Y30LB40*/
*         GEN(PUT   PRNTDCB,DSLINE);/* PRINT LINE            @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*         RFY                                                      0548
*          (R0,                                                    0548
*           R1,                                                    0548
*           R14,                                                   0548
*           R15) UNRSTD;            /*                       @Y30LB40*/
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNT       @Y30LB40*/
         AL    LINECNT,@CF00044                                    0549
*         DSFLD2=' ';               /* CLEAR CONSTANT INFO   @Y30LB40*/
         MVI   DSFLD2+1,C' '                                       0550
         MVC   DSFLD2+2(4),DSFLD2+1                                0550
         MVI   DSFLD2,C' '                                         0550
*         DSFLD2A=' ';              /*                       @Y30LB40*/
         MVI   DSFLD2A+1,C' '                                      0551
         MVC   DSFLD2A+2(6),DSFLD2A+1                              0551
         MVI   DSFLD2A,C' '                                        0551
*         SDGFLD=' ';               /*                       @ZA16140*/
         MVI   SDGFLD+1,C' '                                       0552
         MVI   SDGFLD,C' '                                         0552
*         IF M=10 THEN                                             0553
         CLC   M(4),@CF00034                                       0553
         BNE   @RF00553                                            0553
*           DO;                     /* LAST TIME THROUGH THE LOOP    */
*             RFY                                                  0555
*              (R0,                                                0555
*               R1,                                                0555
*               R14,                                               0555
*               R15) RSTD;          /*                       @Y30LB40*/
*             GEN(PUT   PRNTDCB,HDNG5);/* PRINT TIME SLICE TOTALS    */
         PUT   PRNTDCB,HDNG5
*             GEN(PUT   PRNTDCB,HDNG6);/*                    @Y30LB40*/
         PUT   PRNTDCB,HDNG6
*             GEN(PUT   PRNTDCB,SPACE1);/*                   @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*             RFY                                                  0559
*              (R0,                                                0559
*               R1,                                                0559
*               R14,                                               0559
*               R15) UNRSTD;        /*                       @Y30LB40*/
*             LINECNT=LINECNT+4;    /* ADD 4 TO LINE COUNTER         */
         AL    LINECNT,@CF00104                                    0560
*             DSTLINE=' ';          /*                       @Y30LB40*/
         MVI   DSTLINE+1,C' '                                      0561
         MVC   DSTLINE+2(119),DSTLINE+1                            0561
         MVI   DSTLINE,C' '                                        0561
*             CALL CALCDSA(K,L,11); /* GET ARRAY ADDRESS     @ZA16140*/
         LA    @07,K                                               0562
         ST    @07,@AL00001                                        0562
         LA    @07,L                                               0562
         ST    @07,@AL00001+4                                      0562
         LA    @07,@CF00033                                        0562
         ST    @07,@AL00001+8                                      0562
         LA    @01,@AL00001                                        0562
         BAL   @14,CALCDSA                                         0562
*             CALL EDITFIX(ADDR(DSB1),4,'S');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00563                              0563
         LA    @07,ARRAYPTR                                        0563
         ST    @07,@AL00001                                        0563
         LA    @01,@AL00001                                        0563
         BAL   @14,EDITFIX                                         0563
*             DSTFLD2=FIXOUT(8:13); /* TOTAL CARTRIDGES              */
         MVC   DSTFLD2(6),FIXOUT+7                                 0564
*             CALCFLD=DSB2/4;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0565
         L     @00,DSB2(,@07)                                      0565
         SRDA  @00,32                                              0565
         D     @00,@CF00104                                        0565
         ST    @01,CALCFLD                                         0565
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00566                              0566
         LA    @07,CALCFLD                                         0566
         ST    @07,@AFTEMPS                                        0566
         LA    @07,@AFTEMPS                                        0566
         ST    @07,@AL00001                                        0566
         LA    @01,@AL00001                                        0566
         BAL   @14,EDITFIX                                         0566
*             DSTFLD4=FIXOUT(8:13); /* TOTAL LOAD TIME               */
         MVC   DSTFLD4(6),FIXOUT+7                                 0567
*             CALL EDITFIX(ADDR(DSB3),4,'S');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00568                              0568
         L     @07,ARRAYPTR                                        0568
         LA    @07,DSB3(,@07)                                      0568
         ST    @07,@AFTEMPS                                        0568
         LA    @07,@AFTEMPS                                        0568
         ST    @07,@AL00001                                        0568
         LA    @01,@AL00001                                        0568
         BAL   @14,EDITFIX                                         0568
*             DSTFLD6=FIXOUT(8:13); /* TOTAL CYLS STAGED             */
         MVC   DSTFLD6(6),FIXOUT+7                                 0569
*             CALCFLD=DSB4/4;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0570
         L     @00,DSB4(,@07)                                      0570
         SRDA  @00,32                                              0570
         D     @00,@CF00104                                        0570
         ST    @01,CALCFLD                                         0570
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00571                              0571
         LA    @07,CALCFLD                                         0571
         ST    @07,@AFTEMPS                                        0571
         LA    @07,@AFTEMPS                                        0571
         ST    @07,@AL00001                                        0571
         LA    @01,@AL00001                                        0571
         BAL   @14,EDITFIX                                         0571
*             DSTFLD8=FIXOUT(8:13); /* TOT DEV STG TIME              */
         MVC   DSTFLD8(6),FIXOUT+7                                 0572
*             CALCFLD=DSB5/4;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0573
         L     @00,DSB5(,@07)                                      0573
         SRDA  @00,32                                              0573
         D     @00,@CF00104                                        0573
         ST    @01,CALCFLD                                         0573
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00574                              0574
         LA    @07,CALCFLD                                         0574
         ST    @07,@AFTEMPS                                        0574
         LA    @07,@AFTEMPS                                        0574
         ST    @07,@AL00001                                        0574
         LA    @01,@AL00001                                        0574
         BAL   @14,EDITFIX                                         0574
*             DSTFLD10=FIXOUT(8:13);/* TOT SYS STG TIME              */
         MVC   DSTFLD10(6),FIXOUT+7                                0575
*             CALL EDITFIX(ADDR(DSB6),4,'S');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00576                              0576
         L     @07,ARRAYPTR                                        0576
         LA    @07,DSB6(,@07)                                      0576
         ST    @07,@AFTEMPS                                        0576
         LA    @07,@AFTEMPS                                        0576
         ST    @07,@AL00001                                        0576
         LA    @01,@AL00001                                        0576
         BAL   @14,EDITFIX                                         0576
*             DSTFLD12=FIXOUT(8:13);/* TOT CYLS DESTAGED             */
         MVC   DSTFLD12(6),FIXOUT+7                                0577
*             CALCFLD=DSB7/4;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0578
         L     @00,DSB7(,@07)                                      0578
         SRDA  @00,32                                              0578
         D     @00,@CF00104                                        0578
         ST    @01,CALCFLD                                         0578
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00579                              0579
         LA    @07,CALCFLD                                         0579
         ST    @07,@AFTEMPS                                        0579
         LA    @07,@AFTEMPS                                        0579
         ST    @07,@AL00001                                        0579
         LA    @01,@AL00001                                        0579
         BAL   @14,EDITFIX                                         0579
*             DSTFLD14=FIXOUT(8:13);/* TOT DEV DSTG TIME             */
         MVC   DSTFLD14(6),FIXOUT+7                                0580
*             CALCFLD=DSB8/4;       /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0581
         L     @00,DSB8(,@07)                                      0581
         SRDA  @00,32                                              0581
         D     @00,@CF00104                                        0581
         ST    @01,CALCFLD                                         0581
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00582                              0582
         LA    @07,CALCFLD                                         0582
         ST    @07,@AFTEMPS                                        0582
         LA    @07,@AFTEMPS                                        0582
         ST    @07,@AL00001                                        0582
         LA    @01,@AL00001                                        0582
         BAL   @14,EDITFIX                                         0582
*             DSTFLD16=FIXOUT(8:13);/* TOT SYS DSTG TIME             */
         MVC   DSTFLD16(6),FIXOUT+7                                0583
*             CALL EDITFIX(ADDR(DSB9),4,'S');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00584                              0584
         L     @07,ARRAYPTR                                        0584
         LA    @07,DSB9(,@07)                                      0584
         ST    @07,@AFTEMPS                                        0584
         LA    @07,@AFTEMPS                                        0584
         ST    @07,@AL00001                                        0584
         LA    @01,@AL00001                                        0584
         BAL   @14,EDITFIX                                         0584
*             DSTFLD18=FIXOUT(8:13);/* TOT CYLS TRANSFRD             */
         MVC   DSTFLD18(6),FIXOUT+7                                0585
*             CALCFLD=DSB10/4;      /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0586
         L     @00,DSB10(,@07)                                     0586
         SRDA  @00,32                                              0586
         D     @00,@CF00104                                        0586
         ST    @01,CALCFLD                                         0586
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00587                              0587
         LA    @07,CALCFLD                                         0587
         ST    @07,@AFTEMPS                                        0587
         LA    @07,@AFTEMPS                                        0587
         ST    @07,@AL00001                                        0587
         LA    @01,@AL00001                                        0587
         BAL   @14,EDITFIX                                         0587
*             DSTFLD20=FIXOUT(8:13);/* TOT DEVICE TIME               */
         MVC   DSTFLD20(6),FIXOUT+7                                0588
*             CALCFLD=DSB11/4;      /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0589
         L     @00,DSB11(,@07)                                     0589
         SRDA  @00,32                                              0589
         D     @00,@CF00104                                        0589
         ST    @01,CALCFLD                                         0589
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00590                              0590
         LA    @07,CALCFLD                                         0590
         ST    @07,@AFTEMPS                                        0590
         LA    @07,@AFTEMPS                                        0590
         ST    @07,@AL00001                                        0590
         LA    @01,@AL00001                                        0590
         BAL   @14,EDITFIX                                         0590
*             DSTFLD22=FIXOUT(8:13);/* TOT SYSTEM TIME               */
         MVC   DSTFLD22(6),FIXOUT+7                                0591
*             IF DSB10=0 THEN                                      0592
         L     @07,ARRAYPTR                                        0592
         L     @15,DSB10(,@07)                                     0592
         LTR   @15,@15                                             0592
         BNZ   @RF00592                                            0592
*               DSB10=1;            /*                       @Y30LB40*/
         MVC   DSB10(4,@07),@CF00044                               0593
*             CALCFLD=((DSB9*4)/DSB10);/*                    @Y30LB40*/
@RF00592 L     @07,ARRAYPTR                                        0594
         L     @15,DSB9(,@07)                                      0594
         SLA   @15,2                                               0594
         LR    @00,@15                                             0594
         SRDA  @00,32                                              0594
         D     @00,DSB10(,@07)                                     0594
         ST    @01,CALCFLD                                         0594
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00595                              0595
         LA    @07,CALCFLD                                         0595
         ST    @07,@AFTEMPS                                        0595
         LA    @07,@AFTEMPS                                        0595
         ST    @07,@AL00001                                        0595
         LA    @01,@AL00001                                        0595
         BAL   @14,EDITFIX                                         0595
*             DSTFLD24=FIXOUT(8:13);/* DEVICE RATE           @Y30LB40*/
         MVC   DSTFLD24(6),FIXOUT+7                                0596
*             IF DSB11=0 THEN                                      0597
         L     @07,ARRAYPTR                                        0597
         L     @15,DSB11(,@07)                                     0597
         LTR   @15,@15                                             0597
         BNZ   @RF00597                                            0597
*               DSB11=1;            /*                       @Y30LB40*/
         MVC   DSB11(4,@07),@CF00044                               0598
*             CALCFLD=((DSB9*4)/DSB11);/*                    @Y30LB40*/
@RF00597 L     @07,ARRAYPTR                                        0599
         L     @15,DSB9(,@07)                                      0599
         SLA   @15,2                                               0599
         LR    @00,@15                                             0599
         SRDA  @00,32                                              0599
         D     @00,DSB11(,@07)                                     0599
         ST    @01,CALCFLD                                         0599
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00600                              0600
         LA    @07,CALCFLD                                         0600
         ST    @07,@AFTEMPS                                        0600
         LA    @07,@AFTEMPS                                        0600
         ST    @07,@AL00001                                        0600
         LA    @01,@AL00001                                        0600
         BAL   @14,EDITFIX                                         0600
*             DSTFLD26=FIXOUT(8:13);/* SYSTEM RATE           @Y30LB40*/
         MVC   DSTFLD26(6),FIXOUT+7                                0601
*             RFY                                                  0602
*              (R0,                                                0602
*               R1,                                                0602
*               R14,                                               0602
*               R15) RSTD;          /*                       @Y30LB40*/
*             GEN(PUT   PRNTDCB,DSTLINE);/* PRINT TOTAL LINE         */
         PUT   PRNTDCB,DSTLINE
*             GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE       @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*             RFY                                                  0605
*              (R0,                                                0605
*               R1,                                                0605
*               R14,                                               0605
*               R15) UNRSTD;        /*                       @Y30LB40*/
*             LINECNT=LINECNT+2;    /* BUMP LINE COUNT       @Y30LB40*/
         AL    LINECNT,@CF00051                                    0606
*             DSB1=0;               /* CLEAR BUCKETS         @Y30LB40*/
         SLR   @07,@07                                             0607
         L     @15,ARRAYPTR                                        0607
         ST    @07,DSB1(,@15)                                      0607
*             DSB2=0;               /*                       @Y30LB40*/
         ST    @07,DSB2(,@15)                                      0608
*             DSB3=0;               /*                       @Y30LB40*/
         ST    @07,DSB3(,@15)                                      0609
*             DSB4=0;               /*                       @Y30LB40*/
         ST    @07,DSB4(,@15)                                      0610
*             DSB5=0;               /*                       @Y30LB40*/
         ST    @07,DSB5(,@15)                                      0611
*             DSB6=0;               /*                       @Y30LB40*/
         ST    @07,DSB6(,@15)                                      0612
*             DSB7=0;               /*                       @Y30LB40*/
         ST    @07,DSB7(,@15)                                      0613
*             DSB8=0;               /*                       @Y30LB40*/
         ST    @07,DSB8(,@15)                                      0614
*             DSB9=0;               /*                       @Y30LB40*/
         ST    @07,DSB9(,@15)                                      0615
*             DSB10=0;              /*                       @Y30LB40*/
         ST    @07,DSB10(,@15)                                     0616
*             DSB11=0;              /*                       @Y30LB40*/
         ST    @07,DSB11(,@15)                                     0617
*           END;                    /*                       @Y30LB40*/
*       END;                        /*                       @Y30LB40*/
@RF00553 LA    @07,1                                               0619
         AL    @07,M                                               0619
         ST    @07,M                                               0619
         C     @07,@CF00034                                        0619
         BNH   @DL00500                                            0619
*   END;                            /*                       @Y30LB40*/
@RF00499 LA    @07,1                                               0620
         AL    @07,K                                               0620
         ST    @07,K                                               0620
         C     @07,@CF00615                                        0620
         BNH   @DL00471                                            0620
*   IF EOFSW='1'B THEN                                             0621
         TM    EOFSW,B'10000000'                                   0621
         BNO   @RF00621                                            0621
*     DO;                           /* END OF JOB YET        @Y30LB40*/
*       IF L=2 THEN                                                0623
         LA    @07,2                                               0623
         C     @07,L                                               0623
         BE    @RT00623                                            0623
*         GO TO EOJ;                /* REPORT TOTALS WRITTEN,GETOUT  */
*       ELSE                                                       0625
*         DO;                       /* FORCE TOTAL LINES OUT @Y30LB40*/
*           L=2;                    /* INDICATE REPORT TOTALS      0626
*                                                            @Y30LB40*/
         ST    @07,L                                               0626
*           LINECNT=56;             /* FORCE TO A NEW PAGE   @Y30LB40*/
         LA    LINECNT,56                                          0627
*           GO TO PROCDSBK;         /* GO PRINT TOTALS       @Y30LB40*/
         B     PROCDSBK                                            0628
*         END;                      /*                       @Y30LB40*/
*     END;                          /*                       @Y30LB40*/
*   CALL GETSLICE;                  /* SET UP NEXT TIME SLICE      0631
*                                      INTERVAL              @OZ11673*/
@RF00621 BAL   @14,GETSLICE                                        0631
*   GO TO CHECKTIM;                 /*                       @Y30LB40*/
         B     CHECKTIM                                            0632
*/********************************************************************/
*                                                                  0633
*                                                                  0633
*/********************************************************************/
*/* ROUTINE TO BUILD READ/WRITE REPORT                       @Y30LB40*/
*/********************************************************************/
*                                                                  0633
*ROUTINE2:                          /* CHECK IF IN PROPER TIME SLICE */
*   IF CKTIME>TSEND THEN                                           0633
ROUTINE2 CLC   CKTIME(7),TSEND                                     0633
         BH    @RT00633                                            0633
*     GO TO RWCTLBRK;               /* NEW TIME SLICE        @Y30LB40*/
*RWACCUM:                           /* ACCUMULATE NECESSARY RW TOTALS*/
*   J=LIBRARY+1;                    /* LIBRARY 0 THRU 1      @ZA16140*/
RWACCUM  LA    @07,1                                               0635
         SLR   @15,@15                                             0635
         IC    @15,LIBRARY                                         0635
         ALR   @15,@07                                             0635
         ST    @15,J                                               0635
*   K=READWRIT+1;                   /* READ WRITE UNIT       @Y30LB40*/
         SLR   @15,@15                                             0636
         IC    @15,READWRIT                                        0636
         ALR   @07,@15                                             0636
         ST    @07,K                                               0636
*   IF K>8 THEN                                                    0637
         LA    @15,8                                               0637
         CR    @07,@15                                             0637
         BNH   @RF00637                                            0637
*     K=8;                          /* IF GREATER THEN 8 SET TO MAX  */
         ST    @15,K                                               0638
*   M=((LOADTIME/4)/3)+1;           /* BUILD CLASS INTERVAL FOR LOAD
*                                      TIME                          */
@RF00637 L     @00,LOADTIME                                        0639
         SRDA  @00,32                                              0639
         D     @00,@CF00032                                        0639
         AL    @01,@CF00044                                        0639
         ST    @01,M                                               0639
*   IF M>10 THEN                                                   0640
         LA    @07,10                                              0640
         CR    @01,@07                                             0640
         BNH   @RF00640                                            0640
*     M=10;                         /* SET TO MAX            @Y30LB40*/
         ST    @07,M                                               0641
*   DO L=1 TO 2;                    /* DETAIL AND JOB TOTALS @Y30LB40*/
@RF00640 LA    @07,1                                               0642
         ST    @07,L                                               0642
@DL00642 DS    0H                                                  0643
*     CALL CALCRWA(J,K,L,11);       /* GET ARRAY ADDRESS     @Y30LB40*/
         LA    @07,J                                               0643
         ST    @07,@AL00001                                        0643
         LA    @07,K                                               0643
         ST    @07,@AL00001+4                                      0643
         LA    @07,L                                               0643
         ST    @07,@AL00001+8                                      0643
         LA    @07,@CF00033                                        0643
         ST    @07,@AL00001+12                                     0643
         LA    @01,@AL00001                                        0643
         BAL   @14,CALCRWA                                         0643
*     RWB1=RWB1+LOADNUM;            /* SUM CARTRIDGE LOADS   @Y30LB40*/
         L     @07,ARRAYPTR                                        0644
         SLR   @15,@15                                             0644
         IC    @15,LOADNUM                                         0644
         AL    @15,RWB1(,@07)                                      0644
         ST    @15,RWB1(,@07)                                      0644
*     CALL CALCRWA(J,K,L,M);        /* GET ARRAY ADDRESS     @Y30LB40*/
         LA    @07,J                                               0645
         ST    @07,@AL00001                                        0645
         LA    @07,K                                               0645
         ST    @07,@AL00001+4                                      0645
         LA    @07,L                                               0645
         ST    @07,@AL00001+8                                      0645
         LA    @07,M                                               0645
         ST    @07,@AL00001+12                                     0645
         LA    @01,@AL00001                                        0645
         BAL   @14,CALCRWA                                         0645
*     IF LOADNUM=0 THEN                                            0646
         CLI   LOADNUM,0                                           0646
         BE    @RT00646                                            0646
*       ;                           /*                       @Y30LB40*/
*     ELSE                                                         0648
*       RWB2=RWB2+1;                /* COUNT FOR LOAD TIME   @Y30LB40*/
         L     @07,ARRAYPTR                                        0648
         LA    @15,1                                               0648
         AL    @15,RWB2(,@07)                                      0648
         ST    @15,RWB2(,@07)                                      0648
*     CALL CALCRWA(J,K,L,11);       /* GET ARRAY ADDRESS     @Y30LB40*/
@RT00646 LA    @07,J                                               0649
         ST    @07,@AL00001                                        0649
         LA    @07,K                                               0649
         ST    @07,@AL00001+4                                      0649
         LA    @07,L                                               0649
         ST    @07,@AL00001+8                                      0649
         LA    @07,@CF00033                                        0649
         ST    @07,@AL00001+12                                     0649
         LA    @01,@AL00001                                        0649
         BAL   @14,CALCRWA                                         0649
*     RWB2=RWB2+LOADTIME;           /* SUM LOAD TIME         @Y30LB40*/
         L     @07,ARRAYPTR                                        0650
         L     @15,RWB2(,@07)                                      0650
         AL    @15,LOADTIME                                        0650
         ST    @15,RWB2(,@07)                                      0650
*     IF STGDNUM^=0 THEN                                           0651
         CLI   STGDNUM,0                                           0651
         BE    @RF00651                                            0651
*       DO;                         /* SUM STAGING FIELDS    @Y30LB40*/
*         CALL CALCRWA(J,K,L,11);   /* GET ARRAY ADDRESS     @Y30LB40*/
         LA    @07,J                                               0653
         ST    @07,@AL00001                                        0653
         LA    @07,K                                               0653
         ST    @07,@AL00001+4                                      0653
         LA    @07,L                                               0653
         ST    @07,@AL00001+8                                      0653
         LA    @07,@CF00033                                        0653
         ST    @07,@AL00001+12                                     0653
         LA    @01,@AL00001                                        0653
         BAL   @14,CALCRWA                                         0653
*         RWB3=RWB3+STGD;           /* SUM TOT CYLS          @Y30LB40*/
         L     @07,ARRAYPTR                                        0654
         L     @15,STGD                                            0654
         L     @14,RWB3(,@07)                                      0654
         ALR   @14,@15                                             0654
         ST    @14,RWB3(,@07)                                      0654
*         RWB4=RWB4+DEVSGTM;        /* DEV STG TIME          @Y30LB40*/
         L     @14,DEVSGTM                                         0655
         L     @05,RWB4(,@07)                                      0655
         ALR   @05,@14                                             0655
         ST    @05,RWB4(,@07)                                      0655
*         IF DEVSGTM=0 THEN                                        0656
         LTR   @14,@14                                             0656
         BNZ   @RF00656                                            0656
*           N=(STGD*4)+1;           /*                       @Y30LB40*/
         SLA   @15,2                                               0657
         AL    @15,@CF00044                                        0657
         ST    @15,N                                               0657
*         ELSE                                                     0658
*           N=((STGD*4)/DEVSGTM)+1; /*                       @Y30LB40*/
         B     @RC00656                                            0658
@RF00656 L     @01,STGD                                            0658
         M     @00,@CF00104                                        0658
         D     @00,DEVSGTM                                         0658
         AL    @01,@CF00044                                        0658
         ST    @01,N                                               0658
*         IF N>10 THEN                                             0659
@RC00656 LA    @07,10                                              0659
         C     @07,N                                               0659
         BNL   @RF00659                                            0659
*           N=10;                   /* SET TO MAX            @Y30LB40*/
         ST    @07,N                                               0660
*         CALL CALCRWA(J,K,L,N);    /* GET ARRAY ADDRESS     @Y30LB40*/
@RF00659 LA    @07,J                                               0661
         ST    @07,@AL00001                                        0661
         LA    @07,K                                               0661
         ST    @07,@AL00001+4                                      0661
         LA    @07,L                                               0661
         ST    @07,@AL00001+8                                      0661
         LA    @07,N                                               0661
         ST    @07,@AL00001+12                                     0661
         LA    @01,@AL00001                                        0661
         BAL   @14,CALCRWA                                         0661
*         RWB7=RWB7+STGDNUM;        /* DEVICE STG RATE       @Y30LB40*/
         L     @07,ARRAYPTR                                        0662
         SLR   @15,@15                                             0662
         IC    @15,STGDNUM                                         0662
         AL    @15,RWB7(,@07)                                      0662
         ST    @15,RWB7(,@07)                                      0662
*       END;                        /*                       @Y30LB40*/
*     IF DSTGDNUM^=0 THEN                                          0664
@RF00651 CLI   DSTGDNUM,0                                          0664
         BE    @RF00664                                            0664
*       DO;                         /* SUM DESTAGING FIELDS  @Y30LB40*/
*         CALL CALCRWA(J,K,L,11);   /* GET ARRAY ADDRESS     @Y30LB40*/
         LA    @07,J                                               0666
         ST    @07,@AL00001                                        0666
         LA    @07,K                                               0666
         ST    @07,@AL00001+4                                      0666
         LA    @07,L                                               0666
         ST    @07,@AL00001+8                                      0666
         LA    @07,@CF00033                                        0666
         ST    @07,@AL00001+12                                     0666
         LA    @01,@AL00001                                        0666
         BAL   @14,CALCRWA                                         0666
*         RWB5=RWB5+DSTGD;          /* SUM TOT CYLS          @Y30LB40*/
         L     @07,ARRAYPTR                                        0667
         L     @15,DSTGD                                           0667
         L     @14,RWB5(,@07)                                      0667
         ALR   @14,@15                                             0667
         ST    @14,RWB5(,@07)                                      0667
*         RWB6=RWB6+DEVDSTM;        /* DEV DSTG TME          @Y30LB40*/
         L     @14,DEVDSTM                                         0668
         L     @05,RWB6(,@07)                                      0668
         ALR   @05,@14                                             0668
         ST    @05,RWB6(,@07)                                      0668
*         IF DEVDSTM=0 THEN                                        0669
         LTR   @14,@14                                             0669
         BNZ   @RF00669                                            0669
*           N=(DSTGD*4)+1;          /*                       @Y30LB40*/
         SLA   @15,2                                               0670
         AL    @15,@CF00044                                        0670
         ST    @15,N                                               0670
*         ELSE                                                     0671
*           N=((DSTGD*4)/DEVDSTM)+1;/*                       @Y30LB40*/
         B     @RC00669                                            0671
@RF00669 L     @01,DSTGD                                           0671
         M     @00,@CF00104                                        0671
         D     @00,DEVDSTM                                         0671
         AL    @01,@CF00044                                        0671
         ST    @01,N                                               0671
*         IF N>10 THEN                                             0672
@RC00669 LA    @07,10                                              0672
         C     @07,N                                               0672
         BNL   @RF00672                                            0672
*           N=10;                   /* SET TO MAX            @Y30LB40*/
         ST    @07,N                                               0673
*         CALL CALCRWA(J,K,L,N);    /* GET ARRAY ADDRESS     @Y30LB40*/
@RF00672 LA    @07,J                                               0674
         ST    @07,@AL00001                                        0674
         LA    @07,K                                               0674
         ST    @07,@AL00001+4                                      0674
         LA    @07,L                                               0674
         ST    @07,@AL00001+8                                      0674
         LA    @07,N                                               0674
         ST    @07,@AL00001+12                                     0674
         LA    @01,@AL00001                                        0674
         BAL   @14,CALCRWA                                         0674
*         RWB8=RWB8+DSTGDNUM;       /* DSTG RATE             @Y30LB40*/
         L     @07,ARRAYPTR                                        0675
         SLR   @15,@15                                             0675
         IC    @15,DSTGDNUM                                        0675
         AL    @15,RWB8(,@07)                                      0675
         ST    @15,RWB8(,@07)                                      0675
*       END;                        /*                       @Y30LB40*/
*     N=((BUSYTIME/4)/6)+1;         /*                       @Y30LB40*/
@RF00664 L     @00,BUSYTIME                                        0677
         SRDA  @00,32                                              0677
         D     @00,@CF00071                                        0677
         AL    @01,@CF00044                                        0677
         ST    @01,N                                               0677
*     IF N>10 THEN                                                 0678
         LA    @07,10                                              0678
         CR    @01,@07                                             0678
         BNH   @RF00678                                            0678
*       N=10;                       /*                       @Y30LB40*/
         ST    @07,N                                               0679
*     CALL CALCRWA(J,K,L,N);        /* GET ARRAY ADDRESS     @Y30LB40*/
@RF00678 LA    @07,J                                               0680
         ST    @07,@AL00001                                        0680
         LA    @07,K                                               0680
         ST    @07,@AL00001+4                                      0680
         LA    @07,L                                               0680
         ST    @07,@AL00001+8                                      0680
         LA    @07,N                                               0680
         ST    @07,@AL00001+12                                     0680
         LA    @01,@AL00001                                        0680
         BAL   @14,CALCRWA                                         0680
*     RWB9=RWB9+1;                  /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0681
         LA    @15,1                                               0681
         AL    @15,RWB9(,@07)                                      0681
         ST    @15,RWB9(,@07)                                      0681
*   END;                            /*                       @Y30LB40*/
         LA    @07,1                                               0682
         AL    @07,L                                               0682
         ST    @07,L                                               0682
         C     @07,@CF00051                                        0682
         BNH   @DL00642                                            0682
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/
         B     RDTRACE                                             0683
*/********************************************************************/
*                                                                  0684
*                                                                  0684
*/********************************************************************/
*/* PRINT RW TIME SLICE TOTALS                               @Y30LB40*/
*/********************************************************************/
*                                                                  0684
*RWCTLBRK:                          /* READ WRITE TIME SLICE CTL   0684
*                                      BREAK                         */
*   L=1;                            /* DETAIL ONLY           @Y30LB40*/
RWCTLBRK MVC   L(4),@CF00044                                       0684
*PROCRWBK:                                                         0685
*   RWLINE=' ';                     /*                       @Y30LB40*/
PROCRWBK MVI   RWLINE+1,C' '                                       0685
         MVC   RWLINE+2(119),RWLINE+1                              0685
         MVI   RWLINE,C' '                                         0685
*   DO J=1 TO 2;                    /* PROCESS LIBRARIES 0 THRU 1    */
         LA    @07,1                                               0686
         ST    @07,J                                               0686
@DL00686 DS    0H                                                  0687
*     DO K=1 TO 8;                  /* PROCESS RWU 0 THRU 7  @Y30LB40*/
         LA    @07,1                                               0687
         ST    @07,K                                               0687
@DL00687 DS    0H                                                  0688
*       RWLINE=' ';                 /*                       @Y30LB40*/
         MVI   RWLINE+1,C' '                                       0688
         MVC   RWLINE+2(119),RWLINE+1                              0688
         MVI   RWLINE,C' '                                         0688
*       RWFLD4=SSIDEQ(J);           /* LIBRARY               @OZ05079*/
         L     @15,J                                               0689
         LA    @14,SSIDEQ-1(@15)                                   0689
         MVC   RWFLD4(1),0(@14)                                    0689
*       CHAR2='2';                  /* 1ST DIGIT ALWAYS 2    @OZ05079*/
         MVI   CHAR2,C'2'                                          0690
*       DRDMSFID=SSIDEQ(J);         /* 2ND CHAR = MSF        @OZ05079*/
         LA    @14,SSIDEQ-1(@15)                                   0691
         MVC   DRDMSFID(1),0(@14)                                  0691
*       RWFLD6=SSIDEQ(K);           /* PHYSICAL DRD          @OZ05079*/
         LA    @01,SSIDEQ-1(@07)                                   0692
         MVC   RWFLD6(1),0(@01)                                    0692
*       IF L=2&EOFSW='1'B THEN                                     0693
         CLC   L(4),@CF00051                                       0693
         BNE   @RF00693                                            0693
         TM    EOFSW,B'10000000'                                   0693
         BNO   @RF00693                                            0693
*         DO;                       /*                       @Y30LB40*/
*           RWFLD2='DISTR.';        /*                       @Y30LB40*/
         MVC   RWFLD2(6),@CC00908                                  0695
*           RWFLD2A='SUMMARY ';     /*                       @Y30LB40*/
         MVC   RWFLD2A(8),@CC00909                                 0696
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0698
*         DO;                       /*                       @Y30LB40*/
         B     @RC00693                                            0698
@RF00693 DS    0H                                                  0699
*           RWFLD2='  /   ';        /*                       @Y30LB40*/
         MVC   RWFLD2(6),@CC00910                                  0699
*           CALL EDITFIX(ADDR(TSSYR),1,'N');/*               @Y30LB40*/
         MVC   @AL00001+4(8),@AL00700                              0700
         LA    @07,TSSYR                                           0700
         ST    @07,@AFTEMPS                                        0700
         LA    @07,@AFTEMPS                                        0700
         ST    @07,@AL00001                                        0700
         LA    @01,@AL00001                                        0700
         BAL   @14,EDITFIX                                         0700
*           RWFLD2(1:2)=FIXOUT(12:13);/*                     @Y30LB40*/
         MVC   RWFLD2(2),FIXOUT+11                                 0701
*           CALL EDITFIX(ADDR(TSSDAY),2,'N');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00702                              0702
         LA    @07,TSSDAY                                          0702
         ST    @07,@AFTEMPS                                        0702
         LA    @07,@AFTEMPS                                        0702
         ST    @07,@AL00001                                        0702
         LA    @01,@AL00001                                        0702
         BAL   @14,EDITFIX                                         0702
*           RWFLD2(4:6)=FIXOUT(11:13);/*                     @Y30LB40*/
         MVC   RWFLD2+3(3),FIXOUT+10                               0703
*           HOUR=TSSTIME/3600;      /*                       @Y30LB40*/
         L     @07,TSSTIME                                         0704
         LA    @15,3600                                            0704
         LR    @00,@07                                             0704
         SRDA  @00,32                                              0704
         DR    @00,@15                                             0704
         ST    @01,HOUR                                            0704
*           MINUTE=(TSSTIME-(HOUR*3600))/60;/*               @Y30LB40*/
         LA    @14,60                                              0705
         MR    @00,@15                                             0705
         LR    @02,@07                                             0705
         SLR   @02,@01                                             0705
         SRDA  @02,32                                              0705
         DR    @02,@14                                             0705
         ST    @03,MINUTE                                          0705
*           SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));              0706
         MR    @02,@14                                             0706
         ALR   @01,@03                                             0706
         SLR   @07,@01                                             0706
         ST    @07,SECOND                                          0706
*           RWFLD2A='  :  :  ';     /*                       @Y30LB40*/
         MVC   RWFLD2A(8),@CC00911                                 0707
*           CALL EDITFIX(ADDR(HOUR),4,'S');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00708                              0708
         LA    @07,HOUR                                            0708
         ST    @07,@AFTEMPS                                        0708
         LA    @07,@AFTEMPS                                        0708
         ST    @07,@AL00001                                        0708
         LA    @01,@AL00001                                        0708
         BAL   @14,EDITFIX                                         0708
*           RWFLD2A(1:2)=FIXOUT(12:13);/*                    @Y30LB40*/
         MVC   RWFLD2A(2),FIXOUT+11                                0709
*           CALL EDITFIX(ADDR(MINUTE),4,'N');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00710                              0710
         LA    @07,MINUTE                                          0710
         ST    @07,@AFTEMPS                                        0710
         LA    @07,@AFTEMPS                                        0710
         ST    @07,@AL00001                                        0710
         LA    @01,@AL00001                                        0710
         BAL   @14,EDITFIX                                         0710
*           RWFLD2A(4:5)=FIXOUT(12:13);/*                    @Y30LB40*/
         MVC   RWFLD2A+3(2),FIXOUT+11                              0711
*           CALL EDITFIX(ADDR(SECOND),4,'N');/*              @Y30LB40*/
         MVC   @AL00001+4(8),@AL00712                              0712
         LA    @07,SECOND                                          0712
         ST    @07,@AFTEMPS                                        0712
         LA    @07,@AFTEMPS                                        0712
         ST    @07,@AL00001                                        0712
         LA    @01,@AL00001                                        0712
         BAL   @14,EDITFIX                                         0712
*           RWFLD2A(7:8)=FIXOUT(12:13);/*                    @Y30LB40*/
         MVC   RWFLD2A+6(2),FIXOUT+11                              0713
*         END;                      /*                       @Y30LB40*/
*       CALL CALCRWA(J,K,L,11);     /* GET ARRAY ADDRESS     @Y30LB40*/
@RC00693 LA    @07,J                                               0715
         ST    @07,@AL00001                                        0715
         LA    @07,K                                               0715
         ST    @07,@AL00001+4                                      0715
         LA    @07,L                                               0715
         ST    @07,@AL00001+8                                      0715
         LA    @07,@CF00033                                        0715
         ST    @07,@AL00001+12                                     0715
         LA    @01,@AL00001                                        0715
         BAL   @14,CALCRWA                                         0715
*       IF RWB3+RWB5^=0 THEN                                       0716
         L     @07,ARRAYPTR                                        0716
         L     @15,RWB3(,@07)                                      0716
         AL    @15,RWB5(,@07)                                      0716
         LTR   @15,@15                                             0716
         BZ    @RF00716                                            0716
*         DO M=1 TO 10;             /*                       @Y30LB40*/
         LA    @07,1                                               0717
         ST    @07,M                                               0717
@DL00717 DS    0H                                                  0718
*           IF LINECNT>43 THEN                                     0718
         C     LINECNT,@CF00712                                    0718
         BNH   @RF00718                                            0718
*             DO;                   /* SKIP TO A NEW PAGE    @Y30LB40*/
*               LINECNT=2;          /* RESET LINE COUNTER    @Y30LB40*/
         LA    LINECNT,2                                           0720
*               PAGECNT=PAGECNT+1;  /* UP PAGE COUNTER       @Y30LB40*/
         LA    @07,1                                               0721
         AL    @07,PAGECNT                                         0721
         ST    @07,PAGECNT                                         0721
*               HEADHOLD=HDNGA;     /*                       @Y30LB40*/
         MVC   HEADHOLD(121),HDNGA                                 0722
*               CALL EDITFIX(ADDR(PAGECNT),4,'S');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00723                              0723
         LA    @07,PAGECNT                                         0723
         ST    @07,@AFTEMPS                                        0723
         LA    @07,@AFTEMPS                                        0723
         ST    @07,@AL00001                                        0723
         LA    @01,@AL00001                                        0723
         BAL   @14,EDITFIX                                         0723
*               HEADHOLD(118:121)=FIXOUT(10:13);/*           @Y30LB40*/
         MVC   HEADHOLD+117(4),FIXOUT+9                            0724
*               HEADHOLD(107:111)=TODAY;/*                   @Y30LB40*/
         MVC   HEADHOLD+106(5),TODAY                               0725
*               RFY                                                0726
*                (R0,                                              0726
*                 R1,                                              0726
*                 R14,                                             0726
*                 R15) RSTD;        /*                       @Y30LB40*/
*               GEN(PUT   PRNTDCB,HEADHOLD);/*               @Y30LB40*/
         PUT   PRNTDCB,HEADHOLD
*               RFY                                                0728
*                (R0,                                              0728
*                 R1,                                              0728
*                 R14,                                             0728
*                 R15) UNRSTD;      /*                       @Y30LB40*/
*             END;                  /*                       @Y30LB40*/
*           IF M=1 THEN                                            0730
@RF00718 CLC   M(4),@CF00044                                       0730
         BNE   @RF00730                                            0730
*             DO;                   /* 1ST TIME THROUGH, PRINT     0731
*                                      HEADINGS                      */
*               RFY                                                0732
*                (R0,                                              0732
*                 R1,                                              0732
*                 R14,                                             0732
*                 R15) RSTD;        /*                       @Y30LB40*/
*               GEN(PUT   PRNTDCB,HDNGB);/*                  @Y30LB40*/
         PUT   PRNTDCB,HDNGB
*               GEN(PUT   PRNTDCB,HDNGC);/*                  @Y30LB40*/
         PUT   PRNTDCB,HDNGC
*               GEN(PUT   PRNTDCB,HDNGD);/*                  @Y30LB40*/
         PUT   PRNTDCB,HDNGD
*               GEN(PUT   PRNTDCB,SPACE1);/*                 @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*               RFY                                                0737
*                (R0,                                              0737
*                 R1,                                              0737
*                 R14,                                             0737
*                 R15) UNRSTD;      /*                       @Y30LB40*/
*               LINECNT=LINECNT+5;  /*                       @Y30LB40*/
         AL    LINECNT,@CF00372                                    0738
*             END;                  /*                       @Y30LB40*/
*           CALL SETLINE(M);        /* SET INTERVALS IN PRINT LINE   */
@RF00730 LA    @07,M                                               0740
         ST    @07,@AL00001                                        0740
         LA    @01,@AL00001                                        0740
         BAL   @14,SETLINE                                         0740
*           CALL CALCRWA(J,K,L,M);  /* GET ARRAY ADDRESS     @Y30LB40*/
         LA    @07,J                                               0741
         ST    @07,@AL00001                                        0741
         LA    @07,K                                               0741
         ST    @07,@AL00001+4                                      0741
         LA    @07,L                                               0741
         ST    @07,@AL00001+8                                      0741
         LA    @07,M                                               0741
         ST    @07,@AL00001+12                                     0741
         LA    @01,@AL00001                                        0741
         BAL   @14,CALCRWA                                         0741
*           CALL EDITFIX(ADDR(RWB2),4,'S');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00742                              0742
         L     @07,ARRAYPTR                                        0742
         LA    @07,RWB2(,@07)                                      0742
         ST    @07,@AFTEMPS                                        0742
         LA    @07,@AFTEMPS                                        0742
         ST    @07,@AL00001                                        0742
         LA    @01,@AL00001                                        0742
         BAL   @14,EDITFIX                                         0742
*           RWFLD10=FIXOUT(9:13);   /* LOAD TIME             @Y30LB40*/
         MVC   RWFLD10(5),FIXOUT+8                                 0743
*           CALL EDITFIX(ADDR(RWB7),4,'S');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00744                              0744
         L     @07,ARRAYPTR                                        0744
         LA    @07,RWB7(,@07)                                      0744
         ST    @07,@AFTEMPS                                        0744
         LA    @07,@AFTEMPS                                        0744
         ST    @07,@AL00001                                        0744
         LA    @01,@AL00001                                        0744
         BAL   @14,EDITFIX                                         0744
*           RWFLD20=FIXOUT(7:13);   /* TOTAL STG RATE        @Y30LB40*/
         MVC   RWFLD20(7),FIXOUT+6                                 0745
*           CALL EDITFIX(ADDR(RWB8),4,'S');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00746                              0746
         L     @07,ARRAYPTR                                        0746
         LA    @07,RWB8(,@07)                                      0746
         ST    @07,@AFTEMPS                                        0746
         LA    @07,@AFTEMPS                                        0746
         ST    @07,@AL00001                                        0746
         LA    @01,@AL00001                                        0746
         BAL   @14,EDITFIX                                         0746
*           RWFLD22=FIXOUT(7:13);   /* TOTAL DSTG RATE       @Y30LB40*/
         MVC   RWFLD22(7),FIXOUT+6                                 0747
*           CALL EDITFIX(ADDR(RWB9),4,'S');/*                @Y30LB40*/
         MVC   @AL00001+4(8),@AL00748                              0748
         L     @07,ARRAYPTR                                        0748
         LA    @07,RWB9(,@07)                                      0748
         ST    @07,@AFTEMPS                                        0748
         LA    @07,@AFTEMPS                                        0748
         ST    @07,@AL00001                                        0748
         LA    @01,@AL00001                                        0748
         BAL   @14,EDITFIX                                         0748
*           RWFLD24=FIXOUT(8:13);   /* RWU BUSY TIME         @Y30LB40*/
         MVC   RWFLD24(6),FIXOUT+7                                 0749
*           RFY                                                    0750
*            (R0,                                                  0750
*             R1,                                                  0750
*             R14,                                                 0750
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,RWLINE);/* PRINT CLASS LINE    @Y30LB40*/
         PUT   PRNTDCB,RWLINE
*           RFY                                                    0752
*            (R0,                                                  0752
*             R1,                                                  0752
*             R14,                                                 0752
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           LINECNT=LINECNT+1;      /* BUMP LINE COUNT       @Y30LB40*/
         AL    LINECNT,@CF00044                                    0753
*           RWFLD2=' ';             /* CLEAR CONSTANT INFO   @Y30LB40*/
         MVI   RWFLD2+1,C' '                                       0754
         MVC   RWFLD2+2(4),RWFLD2+1                                0754
         MVI   RWFLD2,C' '                                         0754
*           RWFLD2A=' ';            /*                       @Y30LB40*/
         MVI   RWFLD2A+1,C' '                                      0755
         MVC   RWFLD2A+2(6),RWFLD2A+1                              0755
         MVI   RWFLD2A,C' '                                        0755
*           RWFLD4=' ';             /*                       @Y30LB40*/
         MVI   RWFLD4,C' '                                         0756
*           DRDSSID='   ';          /*                       @OZ05079*/
         MVC   DRDSSID(3),@CC00926                                 0757
*           RWB2=0;                 /* CLEAR BUCKETS         @Y30LB40*/
         SLR   @07,@07                                             0758
         L     @15,ARRAYPTR                                        0758
         ST    @07,RWB2(,@15)                                      0758
*           RWB7=0;                 /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB7(,@15)                                      0759
*           RWB8=0;                 /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB8(,@15)                                      0760
*           RWB9=0;                 /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB9(,@15)                                      0761
*           IF M=10 THEN                                           0762
         CLC   M(4),@CF00034                                       0762
         BNE   @RF00762                                            0762
*             DO;                   /* LAST TIME THROUGH THE LOOP    */
*               RFY                                                0764
*                (R0,                                              0764
*                 R1,                                              0764
*                 R14,                                             0764
*                 R15) RSTD;        /*                       @Y30LB40*/
*               GEN(PUT   PRNTDCB,HDNGE);/* PRINT TIME SLICE TOTALS  */
         PUT   PRNTDCB,HDNGE
*               GEN(PUT   PRNTDCB,HDNGF);/*                  @Y30LB40*/
         PUT   PRNTDCB,HDNGF
*               GEN(PUT   PRNTDCB,SPACE1);/*                 @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*               RFY                                                0768
*                (R0,                                              0768
*                 R1,                                              0768
*                 R14,                                             0768
*                 R15) UNRSTD;      /*                       @Y30LB40*/
*               LINECNT=LINECNT+4;  /* ADD 4 TO LINE COUNTER         */
         AL    LINECNT,@CF00104                                    0769
*               RWTLINE=' ';        /*                       @Y30LB40*/
         MVI   RWTLINE+1,C' '                                      0770
         MVC   RWTLINE+2(119),RWTLINE+1                            0770
         MVI   RWTLINE,C' '                                        0770
*               CALL CALCRWA(J,K,L,11);/* GET ARRAY ADDRESS          */
         LA    @07,J                                               0771
         ST    @07,@AL00001                                        0771
         LA    @07,K                                               0771
         ST    @07,@AL00001+4                                      0771
         LA    @07,L                                               0771
         ST    @07,@AL00001+8                                      0771
         LA    @07,@CF00033                                        0771
         ST    @07,@AL00001+12                                     0771
         LA    @01,@AL00001                                        0771
         BAL   @14,CALCRWA                                         0771
*               CALL EDITFIX(ADDR(RWB1),4,'S');/*            @Y30LB40*/
         MVC   @AL00001+4(8),@AL00772                              0772
         LA    @07,ARRAYPTR                                        0772
         ST    @07,@AL00001                                        0772
         LA    @01,@AL00001                                        0772
         BAL   @14,EDITFIX                                         0772
*               RWTFLD2=FIXOUT(8:13);/* TOTAL CARTRIDGES             */
         MVC   RWTFLD2(6),FIXOUT+7                                 0773
*               CALCFLD=RWB2/4;     /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0774
         L     @00,RWB2(,@07)                                      0774
         SRDA  @00,32                                              0774
         D     @00,@CF00104                                        0774
         ST    @01,CALCFLD                                         0774
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00775                              0775
         LA    @07,CALCFLD                                         0775
         ST    @07,@AFTEMPS                                        0775
         LA    @07,@AFTEMPS                                        0775
         ST    @07,@AL00001                                        0775
         LA    @01,@AL00001                                        0775
         BAL   @14,EDITFIX                                         0775
*               RWTFLD4=FIXOUT(8:13);/* LOAD TIME            @Y30LB40*/
         MVC   RWTFLD4(6),FIXOUT+7                                 0776
*               CALL EDITFIX(ADDR(RWB3),4,'S');/*            @Y30LB40*/
         MVC   @AL00001+4(8),@AL00777                              0777
         L     @07,ARRAYPTR                                        0777
         LA    @07,RWB3(,@07)                                      0777
         ST    @07,@AFTEMPS                                        0777
         LA    @07,@AFTEMPS                                        0777
         ST    @07,@AL00001                                        0777
         LA    @01,@AL00001                                        0777
         BAL   @14,EDITFIX                                         0777
*               RWTFLD6=FIXOUT(7:13);/* TOT CYLS STG         @Y30LB40*/
         MVC   RWTFLD6(7),FIXOUT+6                                 0778
*               CALCFLD=RWB4/4;     /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0779
         L     @00,RWB4(,@07)                                      0779
         SRDA  @00,32                                              0779
         D     @00,@CF00104                                        0779
         ST    @01,CALCFLD                                         0779
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00780                              0780
         LA    @07,CALCFLD                                         0780
         ST    @07,@AFTEMPS                                        0780
         LA    @07,@AFTEMPS                                        0780
         ST    @07,@AL00001                                        0780
         LA    @01,@AL00001                                        0780
         BAL   @14,EDITFIX                                         0780
*               RWTFLD8=FIXOUT(8:13);/* TOT DEV STG TIME             */
         MVC   RWTFLD8(6),FIXOUT+7                                 0781
*               CALL EDITFIX(ADDR(RWB5),4,'S');/*            @Y30LB40*/
         MVC   @AL00001+4(8),@AL00782                              0782
         L     @07,ARRAYPTR                                        0782
         LA    @07,RWB5(,@07)                                      0782
         ST    @07,@AFTEMPS                                        0782
         LA    @07,@AFTEMPS                                        0782
         ST    @07,@AL00001                                        0782
         LA    @01,@AL00001                                        0782
         BAL   @14,EDITFIX                                         0782
*               RWTFLD10=FIXOUT(7:13);/* TOT CYLS DSTG       @Y30LB40*/
         MVC   RWTFLD10(7),FIXOUT+6                                0783
*               CALCFLD=RWB6/4;     /*                       @Y30LB40*/
         L     @07,ARRAYPTR                                        0784
         L     @00,RWB6(,@07)                                      0784
         SRDA  @00,32                                              0784
         D     @00,@CF00104                                        0784
         ST    @01,CALCFLD                                         0784
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00785                              0785
         LA    @07,CALCFLD                                         0785
         ST    @07,@AFTEMPS                                        0785
         LA    @07,@AFTEMPS                                        0785
         ST    @07,@AL00001                                        0785
         LA    @01,@AL00001                                        0785
         BAL   @14,EDITFIX                                         0785
*               RWTFLD12=FIXOUT(8:13);/* TOT DEV DSTG TIME           */
         MVC   RWTFLD12(6),FIXOUT+7                                0786
*               IF RWB1=0 THEN                                     0787
         L     @07,ARRAYPTR                                        0787
         L     @15,RWB1(,@07)                                      0787
         LTR   @15,@15                                             0787
         BNZ   @RF00787                                            0787
*                 RWB1=1;           /*                       @Y30LB40*/
         MVC   RWB1(4,@07),@CF00044                                0788
*               CALCFLD=((RWB2/4)/RWB1);/*                   @Y30LB40*/
@RF00787 L     @07,ARRAYPTR                                        0789
         L     @00,RWB2(,@07)                                      0789
         SRDA  @00,32                                              0789
         D     @00,@CF00104                                        0789
         LR    @02,@01                                             0789
         SRDA  @02,32                                              0789
         D     @02,RWB1(,@07)                                      0789
         ST    @03,CALCFLD                                         0789
*               CALL EDITFIX(ADDR(CALCFLD),4,'S');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00790                              0790
         LA    @07,CALCFLD                                         0790
         ST    @07,@AFTEMPS                                        0790
         LA    @07,@AFTEMPS                                        0790
         ST    @07,@AL00001                                        0790
         LA    @01,@AL00001                                        0790
         BAL   @14,EDITFIX                                         0790
*               RWTFLD14=FIXOUT(8:13);/* CARTRIDGE RATE      @Y30LB40*/
         MVC   RWTFLD14(6),FIXOUT+7                                0791
*               RFY                                                0792
*                (R0,                                              0792
*                 R1,                                              0792
*                 R14,                                             0792
*                 R15) RSTD;        /*                       @Y30LB40*/
*               GEN(PUT   PRNTDCB,RWTLINE);/* PRINT TOTAL LINE       */
         PUT   PRNTDCB,RWTLINE
*               GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE     @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*               RFY                                                0795
*                (R0,                                              0795
*                 R1,                                              0795
*                 R14,                                             0795
*                 R15) UNRSTD;      /*                       @Y30LB40*/
*               LINECNT=LINECNT+2;  /* BUMP LINE COUNT               */
         AL    LINECNT,@CF00051                                    0796
*               RWB1=0;             /* CLEAR BUCKETS         @Y30LB40*/
         SLR   @07,@07                                             0797
         L     @15,ARRAYPTR                                        0797
         ST    @07,RWB1(,@15)                                      0797
*               RWB2=0;             /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB2(,@15)                                      0798
*               RWB3=0;             /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB3(,@15)                                      0799
*               RWB4=0;             /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB4(,@15)                                      0800
*               RWB5=0;             /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB5(,@15)                                      0801
*               RWB6=0;             /* CLEAR BUCKETS         @Y30LB40*/
         ST    @07,RWB6(,@15)                                      0802
*             END;                  /*                       @Y30LB40*/
*         END;                      /*                       @Y30LB40*/
@RF00762 LA    @07,1                                               0804
         AL    @07,M                                               0804
         ST    @07,M                                               0804
         C     @07,@CF00034                                        0804
         BNH   @DL00717                                            0804
*     END;                          /*                       @Y30LB40*/
@RF00716 LA    @07,1                                               0805
         AL    @07,K                                               0805
         ST    @07,K                                               0805
         C     @07,@CF00069                                        0805
         BNH   @DL00687                                            0805
*   END;                            /*                       @Y30LB40*/
         LA    @07,1                                               0806
         AL    @07,J                                               0806
         ST    @07,J                                               0806
         C     @07,@CF00051                                        0806
         BNH   @DL00686                                            0806
*   IF EOFSW='1'B THEN                                             0807
         TM    EOFSW,B'10000000'                                   0807
         BNO   @RF00807                                            0807
*     DO;                           /* END OF JOB YET        @Y30LB40*/
*       IF L=2 THEN                                                0809
         LA    @07,2                                               0809
         C     @07,L                                               0809
         BE    @RT00809                                            0809
*         GO TO EOJ;                /* IF REPORT TOTALS            0810
*                                      WRITTEN,GETOUT                */
*       ELSE                                                       0811
*         L=2;                      /* SETUP FOR REPORT TOTALS     0811
*                                                            @Y30LB40*/
         ST    @07,L                                               0811
*       LINECNT=56;                 /* FORCE NEW PAGE        @Y30LB40*/
         LA    LINECNT,56                                          0812
*       GO TO PROCRWBK;             /* GO WRITE TOTALS       @Y30LB40*/
         B     PROCRWBK                                            0813
*     END;                          /*                       @Y30LB40*/
*   CALL GETSLICE;                  /* SETUP NEW TIME SLICE INTERVAL
*                                                            @OZ11673*/
@RF00807 BAL   @14,GETSLICE                                        0815
*   GO TO ROUTINE2;                 /*                       @Y30LB40*/
         B     ROUTINE2                                            0816
*/********************************************************************/
*                                                                  0817
*                                                                  0817
*/********************************************************************/
*                                                                  0817
*EOF:                               /* END OF FILE REACHED   @Y30LB40*/
*   EOFSW='1'B;                     /* INDICATE END OF FILE  @Y30LB40*/
EOF      OI    EOFSW,B'10000000'                                   0817
*   IF PARMSW='D' THEN                                             0818
         CLI   PARMSW,C'D'                                         0818
         BE    @RT00818                                            0818
*     GO TO DSCTLBRK;               /* GO FORCE SDG TOTALS   @ZA16140*/
*   ELSE                                                           0820
*     GO TO RWCTLBRK;               /* GO FORCE RW TOTALS    @Y30LB40*/
         B     RWCTLBRK                                            0820
*                                                                  0821
*/********************************************************************/
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/
*/********************************************************************/
*                                                                  0821
*EOJ:                               /* REPORTS COMPLETE PRINT PARMS
*                                      VALUES LINE           @Y30LB40*/
*   DSLINE=RCDTOTAL;                /*                       @Y30LB40*/
EOJ      MVC   DSLINE(121),RCDTOTAL                                0821
*   DSLINE(16:16)=PARMSW;           /*                       @Y30LB40*/
         MVC   DSLINE+15(1),PARMSW                                 0822
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/
         L     @00,TIMESL                                          0823
         SRDA  @00,32                                              0823
         D     @00,@CF00335                                        0823
         ST    @01,TIMESL                                          0823
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00824                              0824
         LA    @07,TIMESL                                          0824
         ST    @07,@AFTEMPS                                        0824
         LA    @07,@AFTEMPS                                        0824
         ST    @07,@AL00001                                        0824
         LA    @01,@AL00001                                        0824
         BAL   @14,EDITFIX                                         0824
*   DSLINE(29:31)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+28(3),FIXOUT+10                              0825
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00826                              0826
         LA    @07,HLDSYR                                          0826
         ST    @07,@AFTEMPS                                        0826
         LA    @07,@AFTEMPS                                        0826
         ST    @07,@AL00001                                        0826
         LA    @01,@AL00001                                        0826
         BAL   @14,EDITFIX                                         0826
*   DSLINE(42:43)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+41(2),FIXOUT+11                              0827
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00828                              0828
         LA    @07,HLDSDAY                                         0828
         ST    @07,@AFTEMPS                                        0828
         LA    @07,@AFTEMPS                                        0828
         ST    @07,@AL00001                                        0828
         LA    @01,@AL00001                                        0828
         BAL   @14,EDITFIX                                         0828
*   DSLINE(44:46)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+43(3),FIXOUT+10                              0829
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00830                              0830
         LA    @07,HLDEYR                                          0830
         ST    @07,@AFTEMPS                                        0830
         LA    @07,@AFTEMPS                                        0830
         ST    @07,@AL00001                                        0830
         LA    @01,@AL00001                                        0830
         BAL   @14,EDITFIX                                         0830
*   DSLINE(48:49)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+47(2),FIXOUT+11                              0831
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00832                              0832
         LA    @07,HLDEDAY                                         0832
         ST    @07,@AFTEMPS                                        0832
         LA    @07,@AFTEMPS                                        0832
         ST    @07,@AL00001                                        0832
         LA    @01,@AL00001                                        0832
         BAL   @14,EDITFIX                                         0832
*   DSLINE(50:52)=FIXOUT(11:13);    /*                       @Y30LB40*/
         MVC   DSLINE+49(3),FIXOUT+10                              0833
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/
         L     @07,HLDSTIME                                        0834
         LA    @15,3600                                            0834
         LR    @00,@07                                             0834
         SRDA  @00,32                                              0834
         DR    @00,@15                                             0834
         ST    @01,HOUR                                            0834
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@15                                             0835
         LR    @02,@07                                             0835
         SLR   @02,@01                                             0835
         SRDA  @02,32                                              0835
         D     @02,@CF00335                                        0835
         ST    @03,MINUTE                                          0835
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00836                              0836
         LA    @07,HOUR                                            0836
         ST    @07,@AFTEMPS                                        0836
         LA    @07,@AFTEMPS                                        0836
         ST    @07,@AL00001                                        0836
         LA    @01,@AL00001                                        0836
         BAL   @14,EDITFIX                                         0836
*   DSLINE(63:64)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+62(2),FIXOUT+11                              0837
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00838                              0838
         LA    @07,MINUTE                                          0838
         ST    @07,@AFTEMPS                                        0838
         LA    @07,@AFTEMPS                                        0838
         ST    @07,@AL00001                                        0838
         LA    @01,@AL00001                                        0838
         BAL   @14,EDITFIX                                         0838
*   DSLINE(65:66)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+64(2),FIXOUT+11                              0839
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/
         L     @07,HLDETIME                                        0840
         LA    @15,3600                                            0840
         LR    @00,@07                                             0840
         SRDA  @00,32                                              0840
         DR    @00,@15                                             0840
         ST    @01,HOUR                                            0840
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@15                                             0841
         LR    @02,@07                                             0841
         SLR   @02,@01                                             0841
         SRDA  @02,32                                              0841
         D     @02,@CF00335                                        0841
         ST    @03,MINUTE                                          0841
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00842                              0842
         LA    @07,HOUR                                            0842
         ST    @07,@AFTEMPS                                        0842
         LA    @07,@AFTEMPS                                        0842
         ST    @07,@AL00001                                        0842
         LA    @01,@AL00001                                        0842
         BAL   @14,EDITFIX                                         0842
*   DSLINE(68:69)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+67(2),FIXOUT+11                              0843
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00844                              0844
         LA    @07,MINUTE                                          0844
         ST    @07,@AFTEMPS                                        0844
         LA    @07,@AFTEMPS                                        0844
         ST    @07,@AL00001                                        0844
         LA    @01,@AL00001                                        0844
         BAL   @14,EDITFIX                                         0844
*   DSLINE(70:71)=FIXOUT(12:13);    /*                       @Y30LB40*/
         MVC   DSLINE+69(2),FIXOUT+11                              0845
*   IF SELECTSW='1'B THEN                                          0846
         TM    SELECTSW,B'10000000'                                0846
         BNO   @RF00846                                            0846
*     IF PARMSW='D' THEN                                           0847
         CLI   PARMSW,C'D'                                         0847
         BNE   @RF00847                                            0847
*       DO;                         /*                       @Y30LB40*/
*         DSLINE(73:80)='SDGXX   '; /*                       @ZA16140*/
         MVC   DSLINE+72(8),@CC00943                               0849
*         CALL EDITFIX(ADDR(SELSDG),1,'N');/*                @ZA16140*/
         MVC   @AL00001+4(8),@AL00850                              0850
         LA    @07,SELSDG                                          0850
         ST    @07,@AFTEMPS                                        0850
         LA    @07,@AFTEMPS                                        0850
         ST    @07,@AL00001                                        0850
         LA    @01,@AL00001                                        0850
         BAL   @14,EDITFIX                                         0850
*         DSLINE(76:77)=FIXOUT(12:13);/*                     @ZA16140*/
         MVC   DSLINE+75(2),FIXOUT+11                              0851
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0853
*       DO;                         /*                       @Y30LB40*/
         B     @RC00847                                            0853
@RF00847 DS    0H                                                  0854
*         DSLINE(78:78)='2';        /*                       @OZ05079*/
         MVI   DSLINE+77,C'2'                                      0854
*         DSLINE(79:79)=SSIDEQ(LIB+1);/*                     @OZ05079*/
         SLR   @07,@07                                             0855
         IC    @07,LIB                                             0855
         LA    @01,SSIDEQ(@07)                                     0855
         MVC   DSLINE+78(1),0(@01)                                 0855
*         DSLINE(80:80)=SSIDEQ(U+1);/*                       @OZ05079*/
         SLR   @07,@07                                             0856
         IC    @07,U                                               0856
         LA    @01,SSIDEQ(@07)                                     0856
         MVC   DSLINE+79(1),0(@01)                                 0856
*       END;                        /*                       @Y30LB40*/
*   ELSE                                                           0858
*     DSLINE(73:80)='        ';     /*                       @OZ05079*/
         B     @RC00846                                            0858
@RF00846 MVC   DSLINE+72(8),@CC00948                               0858
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/
@RC00846 MVC   @AL00001+4(8),@AL00859                              0859
         LA    @07,RCDCOUNT                                        0859
         ST    @07,@AFTEMPS                                        0859
         LA    @07,@AFTEMPS                                        0859
         ST    @07,@AL00001                                        0859
         LA    @01,@AL00001                                        0859
         BAL   @14,EDITFIX                                         0859
*   DSLINE(108:113)=FIXOUT(8:13);   /*                       @Y30LB40*/
         MVC   DSLINE+107(6),FIXOUT+7                              0860
*   RFY                                                            0861
*    (R0,                                                          0861
*     R1,                                                          0861
*     R14,                                                         0861
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(PUT   PRNTDCB,DSLINE);      /*                       @Y30LB40*/
         PUT   PRNTDCB,DSLINE
*   RFY                                                            0863
*    (R0,                                                          0863
*     R1,                                                          0863
*     R14,                                                         0863
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*CLOSEFIL:                                                         0864
*   RFY                                                            0864
*    (R0,                                                          0864
*     R1,                                                          0864
*     R14,                                                         0864
*     R15) RSTD;                    /*                       @Y30LB40*/
CLOSEFIL DS    0H                                                  0865
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/
         CLOSE INDCB,MF=(E,OPENCLOS)
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/
         CLOSE PRNTDCB,MF=(E,OPENCLOS)
*   RFY                                                            0867
*    (R0,                                                          0867
*     R1,                                                          0867
*     R14,                                                         0867
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   RFY                                                            0868
*    (R0,                                                          0868
*     R1) RSTD;                     /*                       @Y30LB40*/
*   R0=LENGTH(DSARRAY);             /*                       @ZA16140*/
         L     R0,@CF00997                                         0869
*   R1=ARRAYLOC;                    /*                       @Y30LB40*/
         LR    R1,ARRAYLOC                                         0870
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* FREEMAIN ARRAYS       @Y30LB40*/
         FREEMAIN R,LV=(0),A=(1)
*   RFY                                                            0872
*    (R0,                                                          0872
*     R1) UNRSTD;                   /*                       @Y30LB40*/
*   RETURN CODE(RETURNCD);          /* TERMINATE WITH RETURN CODE  0873
*                                                            @Y30LB40*/
         LH    @07,RETURNCD                                        0873
         L     @13,4(,@13)                                         0873
         L     @00,@SIZDATD                                        0873
         LR    @01,@09                                             0873
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@07                                             0873
         L     @14,12(,@13)                                        0873
         LM    @00,@12,20(@13)                                     0873
         BR    @14                                                 0873
*                                                                  0874
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0874
*GETSLICE:                                                         0874
*   PROCEDURE;                      /*                       @OZ11673*/
GETSLICE STM   @14,@12,12(@13)                                     0874
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/
         B     @DE00875                                            0875
@DL00875 DS    0H                                                  0876
*     TSBEG=TSEND;                  /*                       @Y30LB40*/
         MVC   TSBEG(7),TSEND                                      0876
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/
         L     @07,TSETIME                                         0877
         AL    @07,TIMESL                                          0877
         ST    @07,TSETIME                                         0877
*     IF TSETIME>86399 THEN                                        0878
         C     @07,@CF00871                                        0878
         BNH   @RF00878                                            0878
*       DO;                         /*                       @Y30LB40*/
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/
         SL    @07,@CF00955                                        0880
         ST    @07,TSETIME                                         0880
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/
         LA    @07,1                                               0881
         LH    @15,TSEDAY                                          0881
         ALR   @15,@07                                             0881
         STH   @15,TSEDAY                                          0881
*         IF TSEDAY>365 THEN                                       0882
         C     @15,@CF00870                                        0882
         BNH   @RF00882                                            0882
*           DO;                     /*                       @Y30LB40*/
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0884
         MVC   @TS00001(1),TSEND                                   0884
         NI    @TS00001,B'00000011'                                0884
         CLI   @TS00001,B'00000000'                                0884
         BNE   @RF00884                                            0884
*               IF TSEDAY>366 THEN                                 0885
         LA    @14,366                                             0885
         CR    @15,@14                                             0885
         BNH   @RF00885                                            0885
*                 DO;               /*                       @Y30LB40*/
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/
         SLR   @15,@14                                             0887
         STH   @15,TSEDAY                                          0887
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/
         SLR   @15,@15                                             0888
         IC    @15,TSEYR                                           0888
         ALR   @07,@15                                             0888
         STC   @07,TSEYR                                           0888
*                 END;              /*                       @Y30LB40*/
*               ELSE                                               0890
*                 ;                 /*                       @Y30LB40*/
@RF00885 DS    0H                                                  0891
*             ELSE                                                 0891
*               DO;                 /*                       @Y30LB40*/
         B     @RC00884                                            0891
@RF00884 DS    0H                                                  0892
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/
         LH    @07,TSEDAY                                          0892
         SL    @07,@CF00870                                        0892
         STH   @07,TSEDAY                                          0892
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/
         LA    @07,1                                               0893
         SLR   @15,@15                                             0893
         IC    @15,TSEYR                                           0893
         ALR   @07,@15                                             0893
         STC   @07,TSEYR                                           0893
*               END;                /*                       @Y30LB40*/
*           END;                    /*                       @Y30LB40*/
@RC00884 DS    0H                                                  0896
*       END;                        /*                       @Y30LB40*/
@RF00882 DS    0H                                                  0897
*   END;                            /*                       @Y30LB40*/
@RF00878 DS    0H                                                  0897
@DE00875 CLC   CKTIME(7),TSEND                                     0897
         BH    @DL00875                                            0897
*   END GETSLICE;                   /*                       @OZ11673*/
@EL00002 DS    0H                                                  0898
@EF00002 DS    0H                                                  0898
@ER00002 LM    @14,@12,12(@13)                                     0898
         BR    @14                                                 0898
*                                                                  0899
*/********************************************************************/
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1,2, OR 4*/
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */
*/* LONG.                                                    @Y30LB40*/
*/********************************************************************/
*                                                                  0899
*EDITFIX:                                                          0899
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/
EDITFIX  STM   @14,@12,@SA00003                                    0899
         MVC   @PC00003(12),0(@01)                                 0899
*   DCL                                                            0900
*     FIXADDR PTR(31);              /*                       @Y30LB40*/
*   DCL                                                            0901
*     FIXLEN PTR(31);               /*                       @Y30LB40*/
*   DCL                                                            0902
*     FIXOPT CHAR(1);               /*                       @Y30LB40*/
*   RFY                                                            0903
*    (R2,                                                          0903
*     R3) RSTD;                     /*                       @Y30LB40*/
*   R2=FIXADDR;                     /*                       @Y30LB40*/
         L     @07,@PC00003                                        0904
         L     R2,FIXADDR(,@07)                                    0904
*   R3=0;                           /*                       @Y30LB40*/
         SLR   R3,R3                                               0905
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE
*                                                            @Y30LB40*/
*     THEN                                                         0906
         L     @07,@PC00003+4                                      0906
         CLC   FIXLEN(4,@07),@CF00044                              0906
         BNE   @RF00906                                            0906
*     DO;                           /*                       @Y30LB40*/
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/
         IC    R3,0(R2)
*     END;                          /*                       @Y30LB40*/
*   ELSE                                                           0910
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0910
*                                      BYTES                 @Y30LB40*/
*       THEN                                                       0910
         B     @RC00906                                            0910
@RF00906 L     @07,@PC00003+4                                      0910
         CLC   FIXLEN(4,@07),@CF00051                              0910
         BNE   @RF00910                                            0910
*       DO;                         /*                       @Y30LB40*/
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/
         LH    R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0914
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/
         B     @RC00910                                            0914
@RF00910 DS    0H                                                  0915
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/
         L     R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*   GEN;                                                           0917
@RC00910 DS    0H                                                  0917
@RC00906 DS    0H                                                  0917
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/
  CVD   R3,DOUBLEWD
  OI    DOUBLEWD+7,X'0F'
  UNPK  FIXOUT(13),DOUBLEWD+2(6)
*   IF FIXOPT='N' THEN                                             0918
         L     @07,@PC00003+8                                      0918
         CLI   FIXOPT(@07),C'N'                                    0918
         BE    @RT00918                                            0918
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */
*   IF FIXOPT='S' THEN                                             0920
         CLI   FIXOPT(@07),C'S'                                    0920
         BE    @RT00920                                            0920
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0921
*                                      INSERTION                     */
*   GEN;                                                           0922
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/
  MVC   FIXOUT(1),FIXOUT+3
  MVI   FIXOUT+1,C','
  MVC   FIXOUT+2(3),FIXOUT+4
  MVI   FIXOUT+5,C','
  MVC   FIXOUT+6(3),FIXOUT+7
  MVI   FIXOUT+9,C','
*EF4:                               /* ZERO AND COMMA SUPPRESS     0923
*                                                            @Y30LB40*/
*   GEN;                                                           0923
EF4      DS    0H                                                  0923
*                                                         /*@Y30LB40*/
         LA    R2,FIXOUT
         LA    R3,12
EF5      EQU   *
         CLI   0(R2),C','
         BE    EF6
         CLI   0(R2),C'0'
         BNE   EFEND
EF6      EQU   *
         MVI   0(R2),C' '
         LA    R2,1(R2)
         BCT   R3,EF5
*EFEND:                                                            0924
*   RFY                                                            0924
*    (R2,                                                          0924
*     R3) UNRSTD;                   /*                       @Y30LB40*/
*   END EDITFIX;                    /*                       @Y30LB40*/
@EL00003 DS    0H                                                  0925
@EF00003 DS    0H                                                  0925
@ER00003 LM    @14,@12,@SA00003                                    0925
         BR    @14                                                 0925
*                                                                  0926
*/********************************************************************/
*/* ROUTINE TO CALCULATE ADDRESS INTO SDG ARRAY              @ZA16140*/
*/********************************************************************/
*                                                                  0926
*CALCDSA:                                                          0926
*   PROC(DSS1,DSS2,DSS3) OPTIONS(SAVE);/*                    @ZA16140*/
CALCDSA  STM   @14,@12,12(@13)                                     0926
         MVC   @PC00004(12),0(@01)                                 0926
*   DCL                                                            0927
*    (DSS1,                                                        0927
*     DSS2,                                                        0927
*     DSS3) PTR(31);                /* THREE DIMENTIONS      @ZA16140*/
*   ARRAYPTR=ARRAYLOC+((DSS1-1)*(LENGTH(DSARRAY)/DIM(DSENTS,1)))+((DSS2
*       -1)*(LENGTH(DSARRAY)/(DIM(DSENTS,1)*DIM(DSENTS,2))))+((DSS3-1)*
*       (LENGTH(DSARRAY)/(DIM(DSENTS,1)*DIM(DSENTS,2)*DIM(DSENTS,3))));
         L     @07,@PC00004                                        0928
         L     @07,DSS1(,@07)                                      0928
         BCTR  @07,0                                               0928
         MH    @07,@CH01005                                        0928
         ALR   @07,ARRAYLOC                                        0928
         L     @15,@PC00004+4                                      0928
         L     @15,DSS2(,@15)                                      0928
         BCTR  @15,0                                               0928
         MH    @15,@CH01006                                        0928
         ALR   @07,@15                                             0928
         L     @15,@PC00004+8                                      0928
         L     @15,DSS3(,@15)                                      0928
         BCTR  @15,0                                               0928
         MH    @15,@CH00837                                        0928
         ALR   @07,@15                                             0928
         ST    @07,ARRAYPTR                                        0928
*                                   /*                       @ZA16140*/
*   END CALCDSA;                    /*                       @Y30LB40*/
@EL00004 DS    0H                                                  0929
@EF00004 DS    0H                                                  0929
@ER00004 LM    @14,@12,12(@13)                                     0929
         BR    @14                                                 0929
*                                                                  0930
*/********************************************************************/
*/* ROUTINE TO CALCULATE ADDRESS INTO READ WRITE UNIT ARRAY  @Y30LB40*/
*/********************************************************************/
*                                                                  0930
*CALCRWA:                                                          0930
*   PROC(RWS1,RWS2,RWS3,RWS4) OPTIONS(SAVE);/*               @Y30LB40*/
CALCRWA  STM   @14,@12,12(@13)                                     0930
         MVC   @PC00005(16),0(@01)                                 0930
*   DCL                                                            0931
*    (RWS1,                                                        0931
*     RWS2,                                                        0931
*     RWS3,                                                        0931
*     RWS4) PTR(31);                /* FOUR DIMENTIONS       @Y30LB40*/
*   ARRAYPTR=ARRAYLOC+((RWS1-1)*(LENGTH(RWARRAY)/DIM(RWENTS,1)))+((RWS2
*       -1)*(LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2))))+((RWS3-1)*
*       (LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2)*DIM(RWENTS,3))))+
*       ((RWS4-1)*(LENGTH(RWARRAY)/(DIM(RWENTS,1)*DIM(RWENTS,2)*DIM(
*       RWENTS,3)*DIM(RWENTS,4)))); /*                       @Y30LB40*/
         L     @07,@PC00005                                        0932
         L     @07,RWS1(,@07)                                      0932
         BCTR  @07,0                                               0932
         MH    @07,@CH01009                                        0932
         ALR   @07,ARRAYLOC                                        0932
         L     @15,@PC00005+4                                      0932
         L     @15,RWS2(,@15)                                      0932
         BCTR  @15,0                                               0932
         MH    @15,@CH01010                                        0932
         ALR   @07,@15                                             0932
         L     @15,@PC00005+8                                      0932
         L     @15,RWS3(,@15)                                      0932
         BCTR  @15,0                                               0932
         MH    @15,@CH01011                                        0932
         ALR   @07,@15                                             0932
         L     @15,@PC00005+12                                     0932
         L     @15,RWS4(,@15)                                      0932
         BCTR  @15,0                                               0932
         MH    @15,@CH00499                                        0932
         ALR   @07,@15                                             0932
         ST    @07,ARRAYPTR                                        0932
*   END CALCRWA;                    /*                       @Y30LB40*/
@EL00005 DS    0H                                                  0933
@EF00005 DS    0H                                                  0933
@ER00005 LM    @14,@12,12(@13)                                     0933
         BR    @14                                                 0933
*                                                                  0934
*/********************************************************************/
*/* ROUTINE TO SET UP CLASS INTERVALS IN PRINT LINES         @Y30LB40*/
*/********************************************************************/
*                                                                  0934
*SETLINE:                                                          0934
*   PROC(SLN) OPTIONS(SAVE);        /*                       @Y30LB40*/
SETLINE  STM   @14,@12,12(@13)                                     0934
         MVC   @PC00006(4),0(@01)                                  0934
*   DCL                                                            0935
*     SLN FIXED BINARY(31);         /* PRINT LINE NUMBER OF A DISTR.
*                                      1-10                          */
*   IF PARMSW='D' THEN                                             0936
         CLI   PARMSW,C'D'                                         0936
         BNE   @RF00936                                            0936
*     DO;                           /* SETUP DATA STAGER           0937
*                                      DISTRIBUTIONS         @Y30LB40*/
*       DSFLD8=SEC3ARRY(SLN);       /*                       @Y30LB40*/
         L     @07,@PC00006                                        0938
         L     @07,SLN(,@07)                                       0938
         LR    @15,@07                                             0938
         MH    @15,@CH00372                                        0938
         LA    @14,SEC3ARRY-5(@15)                                 0938
         MVC   DSFLD8(5),0(@14)                                    0938
*       DSFLD11=SEC1ARRY(SLN);      /*                       @Y30LB40*/
         LA    @01,SEC1ARRY-1(@07)                                 0939
         MVC   DSFLD11(1),0(@01)                                   0939
*       DSFLD19=SEC1ARRY(SLN);      /*                       @Y30LB40*/
         LA    @01,SEC1ARRY-1(@07)                                 0940
         MVC   DSFLD19(1),0(@01)                                   0940
*     END;                          /*                       @Y30LB40*/
*   ELSE                                                           0942
*     DO;                           /* SETUP READ WRITE UNIT       0942
*                                      DISTRIBUTIONS         @Y30LB40*/
         B     @RC00936                                            0942
@RF00936 DS    0H                                                  0943
*       RWFLD8=SEC3ARRY(SLN);       /*                       @Y30LB40*/
         L     @07,@PC00006                                        0943
         L     @07,SLN(,@07)                                       0943
         LR    @15,@07                                             0943
         MH    @15,@CH00372                                        0943
         LA    @14,SEC3ARRY-5(@15)                                 0943
         MVC   RWFLD8(5),0(@14)                                    0943
*       RWFLD11=SEC1ARRY(SLN);      /*                       @Y30LB40*/
         LA    @01,SEC1ARRY-1(@07)                                 0944
         MVC   RWFLD11(1),0(@01)                                   0944
*       RWFLD23=SEC6ARRY(SLN);      /*                       @Y30LB40*/
         LA    @07,SEC6ARRY-5(@15)                                 0945
         MVC   RWFLD23(5),0(@07)                                   0945
*     END;                          /*                       @Y30LB40*/
*   END SETLINE;                    /*                       @Y30LB40*/
@EL00006 DS    0H                                                  0947
@EF00006 DS    0H                                                  0947
@ER00006 LM    @14,@12,12(@13)                                     0947
         BR    @14                                                 0947
*                                                                  0948
*/********************************************************** @OZ05124*/
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/
*/********************************************************** @OZ05124*/
*                                                                  0948
*READERR:                                                          0948
*   ;                               /*                       @OZ05124*/
READERR  DS    0H                                                  0949
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/
         SYNADAF ACSMETH=QSAM
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/
         MVC   PRNTLINE+30(79),49(R1)
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/
         MVC   PRNTLINE(30),ICGTR904                               0951
*   SAVE14=R14;                     /*                       @OZ09522*/
         LR    SAVE14,R14                                          0952
*   RFY                                                            0953
*    (R0,                                                          0953
*     R1,                                                          0953
*     R14,                                                         0953
*     R15) RSTD;                    /*                       @OZ05124*/
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/
         PUT PRNTDCB,PRNTLINE
*   RFY                                                            0955
*    (R0,                                                          0955
*     R1,                                                          0955
*     R14,                                                         0955
*     R15) UNRSTD;                  /*                       @OZ05124*/
*   R14=SAVE14;                     /*                       @OZ09522*/
         LR    R14,SAVE14                                          0956
*   GEN(SYNADRLS);                  /*                       @OZ05124*/
         SYNADRLS
*   RETURNCD=4;                     /*                       @OZ05124*/
         MVC   RETURNCD(2),@CH00104                                0958
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/
         BR    R14
*   END ICGTRDST                    /*                       @Y30LB40*/
*                                                                  0960
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0960
*       ;                                                          0960
@EL00001 L     @13,4(,@13)                                         0960
@EF00001 L     @00,@SIZDATD                                        0960
         LR    @01,@09                                             0960
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0960
         BR    @14                                                 0960
@DATA    DS    0H
@CH00499 DC    H'36'
@CH00837 DC    H'44'
@CH01011 DC    H'396'
@CH01006 DC    H'484'
@CH01010 DC    H'792'
@CH01005 DC    H'968'
@CH00888 DC    H'3600'
@CH01009 DC    H'6336'
@SM01014 MVC   PARMHOLD(0),PARMS(PARMPTR)
         DS    0F
@AL00474 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00493 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00495 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00710 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00712 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00836 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00838 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00842 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00844 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00907)
@AL00483 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00700 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00826 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00830 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00850 DC    A(@CF00044)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00907)
@AL00485 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00702 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00828 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00832 DC    A(@CF00051)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00907)
@AL00491 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00506 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00525 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00527 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00529 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00531 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00533 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00535 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00537 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00563 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00566 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00568 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00571 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00574 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00576 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00579 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00582 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00584 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00587 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00590 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00595 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00600 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00708 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00723 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00742 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00744 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00746 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00748 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00772 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00775 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00777 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00780 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00782 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00785 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00790 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00824 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00859 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00912)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00004 DS    3F
@SA00003 DS    15F
@PC00003 DS    3F
@PC00006 DS    1F
@PC00005 DS    4F
@AL00001 DS    4A
@AFTEMPS DS    1F
ICGTRDST CSECT
         DS    0F
@CF00044 DC    F'1'
@CF00051 DC    F'2'
@CF00104 DC    F'4'
@CH00104 EQU   @CF00104+2
@CF00372 DC    F'5'
@CH00372 EQU   @CF00372+2
@CF00069 DC    F'8'
@CH00069 EQU   @CF00069+2
@CF00035 DC    F'9'
@CF00034 DC    F'10'
@CF00033 DC    F'11'
@CF00032 DC    F'12'
@CF00887 DC    F'23'
@CF00071 DC    F'24'
@CF00615 DC    F'28'
@CF00067 DC    F'31'
@CF00712 DC    F'43'
@CF00889 DC    F'59'
@CF00335 DC    F'60'
@CH00335 EQU   @CF00335+2
@CF00870 DC    F'365'
@CH00870 EQU   @CF00870+2
@CF00884 DC    F'366'
@CH00884 EQU   @CF00884+2
@CF00865 DC    F'600'
@CF00997 DC    F'27104'
@CF00871 DC    F'86399'
@CF00955 DC    F'86400'
@DATD    DSECT
         DS    0D
DCBPTR   DS    A
ARRAYPTR DS    A
RCDCOUNT DS    F
PAGECNT  DS    F
TIMESL   DS    F
OPENCLOS DS    FL4
         ORG   OPENCLOS
OPCLB1   DS    BL1
OPCLB234 DS    CL3
         ORG   OPENCLOS+4
HOUR     DS    F
MINUTE   DS    F
SECOND   DS    F
CALCFLD  DS    F
J        DS    F
K        DS    F
L        DS    F
M        DS    F
N        DS    F
RETURNCD DS    H
SAINDEX  DS    H
SELSDG   DS    FL1
LIB      DS    FL1
U        DS    FL1
@TS00001 DS    CL1
RCDIN    DS    CL72
         ORG   RCDIN
STGD     DS    FL4
CFAULT   DS    FL4
SYSSGTM  DS    FL4
DEVSGTM  DS    FL4
DSTGD    DS    FL4
SALLOC   DS    FL4
SYSDSTM  DS    FL4
DEVDSTM  DS    FL4
BUSYTIME DS    FL4
LOADTIME DS    FL4
LOADNUM  DS    FL1
CKTIME   DS    CL7
         ORG   CKTIME
SVEYEAR  DS    FL1
SVEJUL   DS    FL2
SVETIME  DS    FL4
         ORG   RCDIN+48
PAGES    DS    FL1
MININUM  DS    FL1
HITNUM   DS    FL1
STGDNUM  DS    FL1
DSTGDNUM DS    FL1
VTOCSTG  DS    FL1
VTOCDSTG DS    FL1
LIBRARY  DS    FL1
DSPORT   DS    FL1
DSCU     DS    FL1
Z        DS    FL1
Y        DS    FL1
X        DS    FL1
CARTPAIR DS    FL1
READWRIT DS    FL1
VOLID    DS    CL6
CHARDRC  DS    CL1
SDGINBIN DS    FL1
@NM00030 DS    CL1
         ORG   RCDIN+72
DSLINE   DS    CL121
         ORG   DSLINE
DSFLD1   DS    CL1
DSFLD2   DS    CL6
@NM00031 DS    CL1
DSFLD2A  DS    CL8
@NM00032 DS    CL2
SDGID    DS    CL3
         ORG   SDGID
@NM00033 DS    CL1
SDGFLD   DS    CL2
         ORG   DSLINE+21
@NM00034 DS    CL5
DSFLD8   DS    CL5
@NM00035 DS    CL1
DSFLD10  DS    CL5
@NM00036 DS    CL10
DSFLD11  DS    CL1
@NM00037 DS    CL4
DSFLD12  DS    CL6
@NM00038 DS    CL1
DSFLD14  DS    CL6
@NM00039 DS    CL3
DSFLD16  DS    CL6
@NM00040 DS    CL1
DSFLD18  DS    CL6
@NM00041 DS    CL11
DSFLD19  DS    CL1
@NM00042 DS    CL3
DSFLD20  DS    CL6
@NM00043 DS    CL4
DSFLD22  DS    CL6
@NM00044 DS    CL9
         ORG   DSLINE+121
SPACE1   DS    CL121
HEADHOLD DS    CL121
PRNTLINE DS    CL121
PRNTDCB  DS    CL100
INDCB    DS    CL100
DOUBLEWD DS    CL8
STARTTIM DS    CL16
         ORG   STARTTIM
@NM00130 DS    CL1
CKSTIME  DS    CL7
         ORG   CKSTIME
HLDSYR   DS    FL1
HLDSDAY  DS    FL2
HLDSTIME DS    FL4
         ORG   STARTTIM+8
@NM00131 DS    CL1
CKETIME  DS    CL7
         ORG   CKETIME
HLDEYR   DS    FL1
HLDEDAY  DS    FL2
HLDETIME DS    FL4
         ORG   STARTTIM+16
TSTIMES  DS    CL16
         ORG   TSTIMES
@NM00132 DS    CL1
TSBEG    DS    CL7
         ORG   TSBEG
TSSYR    DS    FL1
TSSDAY   DS    FL2
TSSTIME  DS    FL4
         ORG   TSTIMES+8
@NM00133 DS    CL1
TSEND    DS    CL7
         ORG   TSEND
TSEYR    DS    FL1
TSEDAY   DS    FL2
TSETIME  DS    FL4
         ORG   TSTIMES+16
CKSEQ    DS    CL7
PARMSW   DS    CL1
PARMHOLD DS    CL31
TODAY    DS    CL5
FIXOUT   DS    CL13
SELECTSW DS    BL1
DATEINSW DS    BL1
PARMERR  DS    BL1
FIRSTSW  DS    BL1
EOFSW    DS    BL1
ICGTRDST CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00909 DC    C'SUMMARY '
@CC00911 DC    C'  :  :  '
@CC00943 DC    C'SDGXX   '
@CC00948 DC    C'        '
@CC00908 DC    C'DISTR.'
@CC00910 DC    C'  /   '
@CC00881 DC    C'000'
@CC00890 EQU   @CC00943
@CC00926 EQU   @CC00948
@CC00891 DC    C'27'
@CC00907 DC    C'N'
@CC00912 EQU   @CC00909
HDNG1    DS    CL121
         ORG   HDNG1
@NM00078 DC    CL34'1ICGTRDST'
@NM00079 DC    CL30'MSS TRACE STAGING DRIVE GROUP '
@NM00080 DC    CL37'DISTRIBUTION'
@NM00081 DC    CL20'DATE YYDDD  PAGEXXXX'
         ORG   HDNG1+121
HDNG2    DS    CL121
         ORG   HDNG2
@NM00082 DC    CL1'0'
@NM00083 DC    CL40'                        --LOAD TIMES--  '
@NM00084 DC    CL40'   --------STAGE AND DESTAGE RATES------'
@NM00085 DC    CL40'---     ---PAGE AND CYL AVERAGES---     '
         ORG   HDNG2+121
HDNG3    DS    CL121
         ORG   HDNG3
@NM00086 DC    CL1' '
@NM00087 DC    CL40'                                        '
@NM00088 DC    CL40'     CYLS/  DEVICE SYSTEM   DEVICE SYSTE'
@NM00089 DC    CL40'M               PAGES      CYLS         '
         ORG   HDNG3+121
HDNG4    DS    CL121
         ORG   HDNG4
@NM00090 DC    CL1' '
@NM00091 DC    CL40' DATE    TIME     SDG     SECS COUNT    '
@NM00092 DC    CL40'     SEC    STAGE  STAGE    DSTAGE DSTAG'
@NM00093 DC    CL40'E         NUM  PER REQ   PER PAGE       '
         ORG   HDNG4+121
HDNG5    DS    CL121
         ORG   HDNG5
@NM00094 DC    CL1'0'
@NM00095 DC    CL40'*TOTALS*         LOAD    CYLS   DEV-STG '
@NM00096 DC    CL40' SYS-STG    CYLS   DEV-DSTG  SYS-DSTG  C'
@NM00097 DC    CL40'YLS    DEVICE   SYSTEM   DEVICE   SYSTEM'
         ORG   HDNG5+121
HDNG6    DS    CL121
         ORG   HDNG6
@NM00098 DC    CL1' '
@NM00099 DC    CL40'      CARTGS     TIME   STAGED    TIME  '
@NM00100 DC    CL40'   TIME   DESTAGED   TIME      TIME   TR'
@NM00101 DC    CL40'ANSF    TIME     TIME     RATE     RATE '
         ORG   HDNG6+121
HDNGA    DS    CL121
         ORG   HDNGA
@NM00102 DC    CL33'1ICGTRDST'
@NM00103 DC    CL28'MSS TRACE DATA RECORDING DEV'
@NM00104 DC    CL40'ICE DISTRIBUTION'
@NM00105 DC    CL20'DATE YYDDD  PAGEXXXX'
         ORG   HDNGA+121
HDNGB    DS    CL121
         ORG   HDNGB
@NM00106 DC    CL1'0'
@NM00107 DC    CL40'                          --LOAD TIMES--'
@NM00108 DC    CL40'   -------DATA RATES--------   ---DRD BU'
@NM00109 DC    CL40'SY----                                  '
         ORG   HDNGB+121
HDNGC    DS    CL121
         ORG   HDNGC
@NM00110 DC    CL1' '
@NM00111 DC    CL40'                                        '
@NM00112 DC    CL40'     CYLS/  TOTAL  TOTAL                '
@NM00113 DC    CL40'                                        '
         ORG   HDNGC+121
HDNGD    DS    CL121
         ORG   HDNGD
@NM00114 DC    CL1' '
@NM00115 DC    CL40' DATE    TIME   MSF DRD     SECS COUNT  '
@NM00116 DC    CL40'     SEC    STAGE  DESTAGE       SECS  C'
@NM00117 DC    CL40'OUNT                                    '
         ORG   HDNGD+121
HDNGE    DS    CL121
         ORG   HDNGE
@NM00118 DC    CL1'0'
@NM00119 DC    CL40'*TOTALS*            LOAD    CYLS   DEV-S'
@NM00120 DC    CL40'TG    CYLS    DEV-DSTG  CARTG           '
@NM00121 DC    CL40'                                        '
         ORG   HDNGE+121
HDNGF    DS    CL121
         ORG   HDNGF
@NM00122 DC    CL1' '
@NM00123 DC    CL40'         CARTGS     TIME   STAGED    TIM'
@NM00124 DC    CL40'E   DESTAGED    TIME    RATE            '
@NM00125 DC    CL40'                                        '
         ORG   HDNGF+121
RCDTOTAL DS    CL121
         ORG   RCDTOTAL
@NM00126 DC    CL1'1'
@NM00127 DC    CL40'PARM OPTION - X  T-SLICE - XXX  DATES - '
@NM00128 DC    CL40'YYDDD-YYDDD  TIMES - HHMM-HHMM SSID-XXX '
@NM00129 DC    CL40' INPUT RECORDS SELECTED - XXXXXX        '
         ORG   RCDTOTAL+121
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '
         DS    CL1
FIXAREA  DS    CL200
         ORG   FIXAREA
@NM00134 DC    200CL1'Z'
         ORG   FIXAREA+200
SEC1ARRY DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
SEC3ARRY DC    CL5' 0- 2'
         DC    CL5' 3- 5'
         DC    CL5' 6- 8'
         DC    CL5' 9-11'
         DC    CL5'12-14'
         DC    CL5'15-17'
         DC    CL5'18-20'
         DC    CL5'21-23'
         DC    CL5'24-26'
         DC    CL5'27   '
SEC6ARRY DC    CL5' 0- 5'
         DC    CL5' 6-11'
         DC    CL5'12-17'
         DC    CL5'18-23'
         DC    CL5'24-29'
         DC    CL5'30-35'
         DC    CL5'36-41'
         DC    CL5'42-47'
         DC    CL5'48-53'
         DC    CL5'54   '
SSIDEQ   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
ICGTRDST CSECT
*                                                         /*@Y30LB40*/
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **
               EODAD=EOF,EROPT=SKP,SYNAD=READERR
IDCBL    EQU   *-IPATDCB
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121
PDCBL    EQU   *-PPATDCB
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGTRDST CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SS       EQU   @02
LINECNT  EQU   @06
PARMPTR  EQU   @07
TIMEWORK EQU   @03
SAVE14   EQU   @07
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
ARRAYLOC EQU   @08
R14      EQU   @14
R15      EQU   @15
IHADCB   EQU   0
IHADCS05 EQU   0
DCBMODE  EQU   IHADCS05
DCBSTACK EQU   DCBMODE
DCBFUNC  EQU   IHADCS05+3
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00026 EQU   IHADCS40+12
DCBEROPT EQU   @NM00026
PARMVALS EQU   0
PARMLEN  EQU   PARMVALS
PARMS    EQU   PARMVALS+2
RWARRAY  EQU   0
RWENTS   EQU   RWARRAY
RWA      EQU   0
RWB1     EQU   RWA
RWB2     EQU   RWA+4
RWB3     EQU   RWA+8
RWB4     EQU   RWA+12
RWB5     EQU   RWA+16
RWB6     EQU   RWA+20
RWB7     EQU   RWA+24
RWB8     EQU   RWA+28
RWB9     EQU   RWA+32
DSARRAY  EQU   0
DSENTS   EQU   DSARRAY
DSA      EQU   0
DSB1     EQU   DSA
DSB2     EQU   DSA+4
DSB3     EQU   DSA+8
DSB4     EQU   DSA+12
DSB5     EQU   DSA+16
DSB6     EQU   DSA+20
DSB7     EQU   DSA+24
DSB8     EQU   DSA+28
DSB9     EQU   DSA+32
DSB10    EQU   DSA+36
DSB11    EQU   DSA+40
FIXADDR  EQU   0
FIXLEN   EQU   0
FIXOPT   EQU   0
DSS1     EQU   0
DSS2     EQU   0
DSS3     EQU   0
RWS1     EQU   0
RWS2     EQU   0
RWS3     EQU   0
RWS4     EQU   0
SLN      EQU   0
DSTLINE  EQU   DSLINE
DSTFLD2  EQU   DSTLINE+6
DSTFLD4  EQU   DSTLINE+16
DSTFLD6  EQU   DSTLINE+24
DSTFLD8  EQU   DSTLINE+33
DSTFLD10 EQU   DSTLINE+42
DSTFLD12 EQU   DSTLINE+51
DSTFLD14 EQU   DSTLINE+60
DSTFLD16 EQU   DSTLINE+70
DSTFLD18 EQU   DSTLINE+78
DSTFLD20 EQU   DSTLINE+87
DSTFLD22 EQU   DSTLINE+96
DSTFLD24 EQU   DSTLINE+105
DSTFLD26 EQU   DSTLINE+114
RWLINE   EQU   DSLINE
RWFLD2   EQU   RWLINE+1
RWFLD2A  EQU   RWLINE+8
RWFLD4   EQU   RWLINE+18
DRDSSID  EQU   RWLINE+21
CHAR2    EQU   DRDSSID
DRDMSFID EQU   DRDSSID+1
RWFLD6   EQU   DRDSSID+2
RWFLD8   EQU   RWLINE+28
RWFLD10  EQU   RWLINE+34
RWFLD11  EQU   RWLINE+47
RWFLD20  EQU   RWLINE+50
RWFLD22  EQU   RWLINE+59
RWFLD23  EQU   RWLINE+73
RWFLD24  EQU   RWLINE+79
RWTLINE  EQU   DSLINE
RWTFLD2  EQU   RWTLINE+9
RWTFLD4  EQU   RWTLINE+18
RWTFLD6  EQU   RWTLINE+26
RWTFLD8  EQU   RWTLINE+36
RWTFLD10 EQU   RWTLINE+45
RWTFLD12 EQU   RWTLINE+55
RWTFLD14 EQU   RWTLINE+63
*                                      START UNREFERENCED COMPONENTS
@NM00077 EQU   RWTLINE+69
@NM00076 EQU   RWTLINE+61
@NM00075 EQU   RWTLINE+52
@NM00074 EQU   RWTLINE+42
@NM00073 EQU   RWTLINE+33
@NM00072 EQU   RWTLINE+24
@NM00071 EQU   RWTLINE+15
@NM00070 EQU   RWTLINE+1
RWTFLD0  EQU   RWTLINE
@NM00069 EQU   RWLINE+85
@NM00068 EQU   RWLINE+78
@NM00067 EQU   RWLINE+66
@NM00066 EQU   RWLINE+57
@NM00065 EQU   RWLINE+48
@NM00064 EQU   RWLINE+39
@NM00063 EQU   RWLINE+33
@NM00062 EQU   RWLINE+24
@NM00061 EQU   RWLINE+19
@NM00060 EQU   RWLINE+16
@NM00059 EQU   RWLINE+7
RWFLD1   EQU   RWLINE
@NM00058 EQU   DSTLINE+120
@NM00057 EQU   DSTLINE+111
@NM00056 EQU   DSTLINE+102
@NM00055 EQU   DSTLINE+93
@NM00054 EQU   DSTLINE+84
@NM00053 EQU   DSTLINE+76
@NM00052 EQU   DSTLINE+66
@NM00051 EQU   DSTLINE+57
@NM00050 EQU   DSTLINE+48
@NM00049 EQU   DSTLINE+39
@NM00048 EQU   DSTLINE+30
@NM00047 EQU   DSTLINE+22
@NM00046 EQU   DSTLINE+12
@NM00045 EQU   DSTLINE+1
DSTFLD1  EQU   DSTLINE
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00029 EQU   IHADCS40+16
@NM00028 EQU   @NM00026+1
@NM00027 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00025 EQU   IHADCS40+10
@NM00024 EQU   IHADCS40+9
@NM00023 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00022 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00021 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00020 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00019 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00018 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00017 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00016 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00015 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00014 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00013 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00012 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00011 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00010 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00009 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00008 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00007 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00006 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
@NM00005 EQU   DCBFUNC
DCBFNCBT EQU   DCBFUNC
DCBFNCBX EQU   DCBFUNC
DCBFNCBD EQU   DCBFUNC
DCBFNCBW EQU   DCBFUNC
DCBFNCBP EQU   DCBFUNC
DCBFNCBR EQU   DCBFUNC
DCBFNCBI EQU   DCBFUNC
@NM00004 EQU   IHADCS05+2
@NM00003 EQU   IHADCS05+1
DCBSTCK1 EQU   DCBSTACK
DCBSTCK2 EQU   DCBSTACK
@NM00002 EQU   DCBSTACK
DCBMODER EQU   DCBSTACK
DCBMODEO EQU   DCBSTACK
DCBMODEE EQU   DCBSTACK
DCBMODEC EQU   DCBSTACK
@NM00001 EQU   IHADCB
*                                      END UNREFERENCED COMPONENTS
@RT00166 EQU   PARMEND
@RT00198 EQU   PARMEND
@RT00218 EQU   PARMEND
@RF00233 EQU   @RC00231
@RF00243 EQU   @RC00241
@RT00257 EQU   PARMEND
@RT00270 EQU   PARMEND
@RT00299 EQU   PARMEND
@RC00307 EQU   @RC00305
@RT00363 EQU   RDTRACE
@RT00368 EQU   RDTRACE
@RT00372 EQU   RDTRACE
@RT00375 EQU   RDTRACE
@RT00394 EQU   ROUTINE2
@RT00396 EQU   DSCTLBRK
@RT00623 EQU   EOJ
@RT00633 EQU   RWCTLBRK
@RT00809 EQU   EOJ
@RT00818 EQU   DSCTLBRK
@RF00818 EQU   RWCTLBRK
@RC00847 EQU   @RC00846
@RT00920 EQU   EF4
EFEND    EQU   @EL00003
@RC00936 EQU   @EL00006
@RT00918 EQU   EFEND
@ENDDATA EQU   *
         END   ICGTRDST,(C'PLS1209',0603,77089)

         TITLE '***** ICGTRVID MSS TRACE VOLUME IDENTIFICATION REPORT **
               *****    '
ICGTRVID CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGTRVID  76.198'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         L     R1,0(R1)
*   PARMPTR=R1;                     /* SAVE PTR TO PARMS     @Y30LB40*/
         ST    R1,PARMPTR                                          0077
*   RFY                                                            0078
*     R1 UNRSTD;                    /*                       @Y30LB40*/
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/
         SLR   @15,@15                                             0079
         ST    @15,RCDCOUNT                                        0079
*   RETURNCD=0;                     /*                       @Y30LB40*/
         LR    RETURNCD,@15                                        0080
*   TIMESL=600;                     /*                       @Y30LB40*/
         MVC   TIMESL(4),@CF00631                                  0081
*   HOUR=0;                         /*                       @Y30LB40*/
         ST    @15,HOUR                                            0082
*   MINUTE=0;                       /*                       @Y30LB40*/
         ST    @15,MINUTE                                          0083
*   SECOND=0;                       /*                       @Y30LB40*/
         ST    @15,SECOND                                          0084
*   LINECNT=56;                     /*                       @Y30LB40*/
         LA    LINECNT,56                                          0085
*   OPENCLOS=0;                     /*                       @Y30LB40*/
         ST    @15,OPENCLOS                                        0086
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/
         MVI   OPCLB1,B'10000000'                                  0087
*   PAGECNT=0;                      /*                       @Y30LB40*/
         ST    @15,PAGECNT                                         0088
*   EOFSW='0'B;                     /*                       @Y30LB40*/
         NI    EOFSW,B'01111111'                                   0089
*   HLDSYR=0;                       /*                       @Y30LB40*/
         MVI   HLDSYR,X'00'                                        0090
*   HLDSDAY=1;                      /*                       @Y30LB40*/
         LA    @14,1                                               0091
         STH   @14,HLDSDAY                                         0091
*   HLDSTIME=0;                     /*                       @Y30LB40*/
         ST    @15,HLDSTIME                                        0092
*   HLDEYR=99;                      /*                       @Y30LB40*/
         MVI   HLDEYR,X'63'                                        0093
*   HLDEDAY=365;                    /*                       @Y30LB40*/
         MVC   HLDEDAY(2),@CH00636                                 0094
*   HLDETIME=86399;                 /*                       @Y30LB40*/
         MVC   HLDETIME(4),@CF00637                                0095
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/
         OI    FIRSTSW,B'10000000'                                 0096
*   PARMERR='0'B;                   /*                       @Y30LB40*/
         NI    PARMERR,B'01111111'                                 0097
*   DATEINSW='0'B;                  /*                       @Y30LB40*/
         NI    DATEINSW,B'01111111'                                0098
*   VOL=' ';                        /*                       @Y30LB40*/
         MVI   VOL+1,C' '                                          0099
         MVC   VOL+2(4),VOL+1                                      0099
         MVI   VOL,C' '                                            0099
*   LIBSW='0'B;                     /*                       @Y30LB40*/
         NI    LIBSW,B'01111111'                                   0100
*   VOLSW='0'B;                     /*                       @Y30LB40*/
         NI    VOLSW,B'01111111'                                   0101
*   TMESW='0'B;                     /*                       @Y30LB40*/
         NI    TMESW,B'01111111'                                   0102
*   SPACE1=' ';                     /*                       @Y30LB40*/
         MVI   SPACE1+1,C' '                                       0103
         MVC   SPACE1+2(119),SPACE1+1                              0103
         MVI   SPACE1,C' '                                         0103
*   DO I=1 TO 2;                    /*                       @Y30LB40*/
         LR    I,@14                                               0104
@DL00104 DS    0H                                                  0105
*     DO J=1 TO 2;                  /*                       @Y30LB40*/
         LA    J,1                                                 0105
@DL00105 DS    0H                                                  0106
*       SMSTGD(I,J)=0;              /*                       @Y30LB40*/
         SLR   @15,@15                                             0106
         LR    @14,I                                               0106
         ALR   @14,@14                                             0106
         ALR   @14,J                                               0106
         MH    @14,@CH00729                                        0106
         ST    @15,SMSTGD-108(@14)                                 0106
*       SMCFAULT(I,J)=0;            /*                       @Y30LB40*/
         ST    @15,SMCFAULT-108(@14)                               0107
*       SMDSTGD(I,J)=0;             /*                       @Y30LB40*/
         ST    @15,SMDSTGD-108(@14)                                0108
*       SMSALLOC(I,J)=0;            /*                       @Y30LB40*/
         ST    @15,SMSALLOC-108(@14)                               0109
*       LOADS(I,J)=0;               /*                       @Y30LB40*/
         ST    @15,LOADS-108(@14)                                  0110
*       STGDTOT(I,J)=0;             /*                       @Y30LB40*/
         ST    @15,STGDTOT-108(@14)                                0111
*       VTOCSG(I,J)=0;              /*                       @Y30LB40*/
         ST    @15,VTOCSG-108(@14)                                 0112
*       DSTGDTOT(I,J)=0;            /*                       @Y30LB40*/
         ST    @15,DSTGDTOT-108(@14)                               0113
*       VTOCDS(I,J)=0;              /*                       @Y30LB40*/
         ST    @15,VTOCDS-108(@14)                                 0114
*     END;                          /*                       @Y30LB40*/
         AL    J,@CF00043                                          0115
         C     J,@CF00050                                          0115
         BNH   @DL00105                                            0115
*   END;                            /*                       @Y30LB40*/
         AL    I,@CF00043                                          0116
         C     I,@CF00050                                          0116
         BNH   @DL00104                                            0116
*   SEQOLD=SEQOLD&&SEQOLD;          /*                       @Y30LB40*/
         XC    SEQOLD(14),SEQOLD                                   0117
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/
         MVC   PRNTDCB(PDCBL),PPATDCB
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/
         MVC   INDCB(IDCBL),IPATDCB
*   RFY                                                            0120
*    (R0,                                                          0120
*     R1,                                                          0120
*     R14,                                                         0120
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0122
*    (R0,                                                          0122
*     R1,                                                          0122
*     R14,                                                         0122
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B THEN               0123
         MVC   @TS00001(1),PRNTDCB+48                              0123
         NI    @TS00001,B'00010000'                                0123
         CLI   @TS00001,B'00010000'                                0123
         BE    @RF00123                                            0123
*     DO;                           /* IF OPEN BAD EXIT WITH RC=4  0124
*                                                            @Y30LB40*/
*       RETURN CODE(4);             /*                       @Y30LB40*/
         L     @13,4(,@13)                                         0125
         L     @00,@SIZDATD                                        0125
         LR    @01,@10                                             0125
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,4                                               0125
         L     @14,12(,@13)                                        0125
         LM    @00,@12,20(@13)                                     0125
         BR    @14                                                 0125
*     END;                          /*                       @Y30LB40*/
*   RFY                                                            0127
*    (R0,                                                          0127
*     R1,                                                          0127
*     R14,                                                         0127
*     R15) RSTD;                    /*                       @Y30LB40*/
@RF00123 DS    0H                                                  0128
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)
*   RFY                                                            0129
*    (R0,                                                          0129
*     R1,                                                          0129
*     R14,                                                         0129
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B THEN                 0130
         MVC   @TS00001(1),INDCB+48                                0130
         NI    @TS00001,B'00010000'                                0130
         CLI   @TS00001,B'00010000'                                0130
         BE    @RF00130                                            0130
*     DO;                           /* IF OPEN BAD,PRINT ERROR MSG 0131
*                                      AND EXIT WITH RC=8            */
*       PRINTLN=TRINMSG;            /*                       @Y30LB40*/
         MVI   PRINTLN+31,C' '                                     0132
         MVC   PRINTLN+32(89),PRINTLN+31                           0132
         MVC   PRINTLN(31),TRINMSG                                 0132
*       RFY                                                        0133
*        (R0,                                                      0133
*         R1,                                                      0133
*         R14,                                                     0133
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/
         PUT   PRNTDCB,PRINTLN
*       RFY                                                        0135
*        (R0,                                                      0135
*         R1,                                                      0135
*         R14,                                                     0135
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /*                       @Y30LB40*/
         LA    RETURNCD,8                                          0136
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0137
*     END;                          /*                       @Y30LB40*/
*   IF PARMLEN=0 THEN                                              0139
@RF00130 L     @01,PARMPTR                                         0139
         LH    @15,PARMLEN(,@01)                                   0139
         LTR   @15,@15                                             0139
         BZ    @RT00139                                            0139
*     GO TO PARMEND;                /* IF NO PARMS BYPASS PROCESS    */
*   IF PARMLEN>30                   /* ARE PARMS TOO LONG    @Y30LB40*/
*     THEN                                                         0141
         C     @15,@CF00539                                        0141
         BNH   @RF00141                                            0141
*     DO;                           /* YES,SET ERROR SWITCH AND EXIT
*                                                            @Y30LB40*/
*       PARMERR='1'B;               /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0143
*       GO TO PARMEND;              /*                       @Y30LB40*/
         B     PARMEND                                             0144
*     END;                          /*                       @Y30LB40*/
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0146
*                                                            @Y30LB40*/
@RF00141 MVI   PARMHOLD,C','                                       0146
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @Y30LB40*/
         MVC   PARMHOLD+1(30),PARMHOLD                             0147
*   SS=1;                           /* SET SUBSTRING PTR TO 1      0148
*                                                            @Y30LB40*/
         LA    @15,1                                               0148
         LR    SS,@15                                              0148
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0149
*                                                            @Y30LB40*/
         L     @03,PARMPTR                                         0149
         LH    @14,PARMLEN(,@03)                                   0149
         BCTR  @14,0                                               0149
         EX    @14,@SM00738                                        0149
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0150
*                                                            @Y30LB40*/
*     THEN                                                         0150
         LA    @03,PARMHOLD-1(SS)                                  0150
         CLI   0(@03),C','                                         0150
         BNE   @RF00150                                            0150
*     SS=SS+1;                      /* NO, BUMP POINTER      @Y30LB40*/
         ALR   SS,@15                                              0151
*   ELSE                                                           0152
*     DO;                           /* YES,VALIDATE AND CONVERT TIME
*                                      SLICE                         */
         B     @RC00150                                            0152
@RF00150 DS    0H                                                  0153
*       DO J=SS TO(SS+2);           /* CHECK FOR NUMERICS    @Y30LB40*/
         LR    J,SS                                                0153
         B     @DE00153                                            0153
@DL00153 DS    0H                                                  0154
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0154
         LA    @07,PARMHOLD-1(J)                                   0154
         CLI   0(@07),C'0'                                         0154
         BL    @RF00154                                            0154
         LA    @07,PARMHOLD-1(J)                                   0154
         CLI   0(@07),C'9'                                         0154
         BNH   @RT00154                                            0154
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0156
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0156
*                                                            @Y30LB40*/
@RF00154 OI    PARMERR,B'10000000'                                 0156
*       END;                        /*                       @Y30LB40*/
@RT00154 AL    J,@CF00043                                          0157
@DE00153 LA    @07,2                                               0157
         ALR   @07,SS                                              0157
         CR    J,@07                                               0157
         BNH   @DL00153                                            0157
*       IF PARMERR='1'B THEN                                       0158
         TM    PARMERR,B'10000000'                                 0158
         BO    @RT00158                                            0158
*         GO TO PARMEND;            /* IF ERROR EXIT         @Y30LB40*/
*       IF PARMHOLD(SS:SS+2)='000'  /* TIME SLICE 000 NOT ALLOWED    */
*         THEN                                                     0160
         LA    @03,PARMHOLD-1(SS)                                  0160
         CLC   0(3,@03),@CC00646                                   0160
         BNE   @RF00160                                            0160
*         DO;                       /*                       @Y30LB40*/
*           PARMERR='1'B;           /* SET ERROR AND EXIT    @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0162
*           GO TO PARMEND;          /*                       @Y30LB40*/
         B     PARMEND                                             0163
*         END;                      /*                       @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/
@RF00160 LA    @03,PARMHOLD-1(SS)                                  0165
         PACK  DOUBLEWD(8),0(3,@03)                                0165
*       CVB(TIMESL,DOUBLEWD);       /* CONVERT TIME SLICE TO SECONDS */
         CVB   @03,DOUBLEWD                                        0166
         ST    @03,TIMESL                                          0166
*       TIMESL=TIMESL*60;           /*                       @Y30LB40*/
         MH    @03,@CH00334                                        0167
         ST    @03,TIMESL                                          0167
*       SS=SS+4;                    /* BUMP POINTER TO NEXT VALUE  0168
*                                                            @Y30LB40*/
         AL    SS,@CF00103                                         0168
*     END;                          /*                       @Y30LB40*/
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/
*     THEN                                                         0170
@RC00150 LA    @03,PARMHOLD-1(SS)                                  0170
         CLI   0(@03),C','                                         0170
         BNE   @RF00170                                            0170
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE
*                                                            @Y30LB40*/
         AL    SS,@CF00043                                         0171
*   ELSE                                                           0172
*     DO;                           /* YES,VALIDATE AND CONVERT DATES
*                                                            @Y30LB40*/
         B     @RC00170                                            0172
@RF00170 DS    0H                                                  0173
*       DO J=SS TO(SS+9);           /* CHECK FOR NUMERICS    @Y30LB40*/
         LR    J,SS                                                0173
         B     @DE00173                                            0173
@DL00173 DS    0H                                                  0174
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0174
         LA    @07,PARMHOLD-1(J)                                   0174
         CLI   0(@07),C'0'                                         0174
         BL    @RF00174                                            0174
         LA    @07,PARMHOLD-1(J)                                   0174
         CLI   0(@07),C'9'                                         0174
         BNH   @RT00174                                            0174
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0176
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0176
*                                                            @Y30LB40*/
@RF00174 OI    PARMERR,B'10000000'                                 0176
*       END;                        /*                       @Y30LB40*/
@RT00174 AL    J,@CF00043                                          0177
@DE00173 LA    @07,9                                               0177
         ALR   @07,SS                                              0177
         CR    J,@07                                               0177
         BNH   @DL00173                                            0177
*       IF PARMERR='1'B THEN                                       0178
         TM    PARMERR,B'10000000'                                 0178
         BO    @RT00178                                            0178
*         GO TO PARMEND;            /* IF ERROR,EXIT         @Y30LB40*/
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/
         LA    @03,PARMHOLD-1(SS)                                  0180
         PACK  DOUBLEWD(8),0(2,@03)                                0180
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0181
         STC   @03,HLDSYR                                          0181
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/
         LA    @03,PARMHOLD+1(SS)                                  0182
         PACK  DOUBLEWD(8),0(3,@03)                                0182
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @03,DOUBLEWD                                        0183
         STH   @03,HLDSDAY                                         0183
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/
         LA    @01,PARMHOLD+4(SS)                                  0184
         PACK  DOUBLEWD(8),0(2,@01)                                0184
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/
         CVB   @15,DOUBLEWD                                        0185
         STC   @15,HLDEYR                                          0185
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/
         LA    @01,PARMHOLD+6(SS)                                  0186
         PACK  DOUBLEWD(8),0(3,@01)                                0186
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/
         CVB   @15,DOUBLEWD                                        0187
         STH   @15,HLDEDAY                                         0187
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAYS          */
*         THEN                                                     0188
         LTR   @03,@03                                             0188
         BNP   @RF00188                                            0188
         C     @03,@CF00649                                        0188
         BL    @RT00188                                            0188
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0190
*         DO;                       /*                       @Y30LB40*/
@RF00188 DS    0H                                                  0191
*           IF HLDSDAY=366 THEN                                    0191
         CLC   HLDSDAY(2),@CH00649                                 0191
         BNE   @RF00191                                            0191
*             DO;                   /* DAY = 366 CHECK FOR LEAP YEAR
*                                                            @Y30LB40*/
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0193
         MVC   @TS00001(1),CKSTIME                                 0193
         NI    @TS00001,B'00000011'                                0193
         CLI   @TS00001,B'00000000'                                0193
         BE    @RF00193                                            0193
*                 PARMERR='1'B;     /* BAD DAY,ERROR         @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0194
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0196
*             PARMERR='1'B;         /* BAD DAY,ERROR         @Y30LB40*/
         B     @RC00191                                            0196
@RF00191 OI    PARMERR,B'10000000'                                 0196
*         END;                      /*                       @Y30LB40*/
@RC00191 DS    0H                                                  0198
*       IF HLDEDAY>0&HLDEDAY<366    /* CHECK END DAY FOR SAME        */
*         THEN                                                     0198
@RT00188 LH    @03,HLDEDAY                                         0198
         LTR   @03,@03                                             0198
         BNP   @RF00198                                            0198
         C     @03,@CF00649                                        0198
         BL    @RT00198                                            0198
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0200
*         DO;                       /*                       @Y30LB40*/
@RF00198 DS    0H                                                  0201
*           IF HLDEDAY=366 THEN                                    0201
         CLC   HLDEDAY(2),@CH00649                                 0201
         BNE   @RF00201                                            0201
*             DO;                   /*                       @Y30LB40*/
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0203
         MVC   @TS00001(1),CKETIME                                 0203
         NI    @TS00001,B'00000011'                                0203
         CLI   @TS00001,B'00000000'                                0203
         BE    @RF00203                                            0203
*                 PARMERR='1'B;     /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0204
*             END;                  /*                       @Y30LB40*/
*           ELSE                                                   0206
*             PARMERR='1'B;         /*                       @Y30LB40*/
         B     @RC00201                                            0206
@RF00201 OI    PARMERR,B'10000000'                                 0206
*         END;                      /*                       @Y30LB40*/
@RC00201 DS    0H                                                  0208
*       IF HLDSYR<=HLDEYR           /* END YEAR MUST BE >= START YEAR
*                                                            @Y30LB40*/
*         THEN                                                     0208
@RT00198 CLC   HLDSYR(1),HLDEYR                                    0208
         BNH   @RT00208                                            0208
*         ;                         /*                       @Y30LB40*/
*       ELSE                                                       0210
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0210
*       IF HLDSDAY<=HLDEDAY         /* END DAY MUST BE >= END DAY  0211
*                                      UNLESS                        */
*         THEN                                                     0211
@RT00208 LH    @03,HLDSDAY                                         0211
         CH    @03,HLDEDAY                                         0211
         BNH   @RT00211                                            0211
*         ;                         /* YEARS ARE DIFFERENT   @Y30LB40*/
*       ELSE                                                       0213
*         DO;                       /*                       @Y30LB40*/
*           IF HLDSYR=HLDEYR THEN                                  0214
         CLC   HLDSYR(1),HLDEYR                                    0214
         BNE   @RF00214                                            0214
*             PARMERR='1'B;         /* ERROR                         */
         OI    PARMERR,B'10000000'                                 0215
*         END;                      /*                       @Y30LB40*/
@RF00214 DS    0H                                                  0217
*       IF PARMERR='1'B THEN                                       0217
@RT00211 TM    PARMERR,B'10000000'                                 0217
         BO    @RT00217                                            0217
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */
*       DATEINSW='1'B;              /* INDICATE VALID DATES ENTERED
*                                                            @Y30LB40*/
         OI    DATEINSW,B'10000000'                                0219
*       SS=SS+11;                   /* BUMP POINTER TO NEXT VALUE  0220
*                                                            @Y30LB40*/
         AL    SS,@CF00033                                         0220
*     END;                          /*                       @Y30LB40*/
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/
*     THEN                                                         0222
@RC00170 LA    @03,PARMHOLD-1(SS)                                  0222
         CLI   0(@03),C','                                         0222
         BNE   @RF00222                                            0222
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE
*                                                            @Y30LB40*/
         AL    SS,@CF00043                                         0223
*   ELSE                                                           0224
*     DO;                           /* YES                   @Y30LB40*/
         B     @RC00222                                            0224
@RF00222 DS    0H                                                  0225
*       DO J=SS TO(SS+7);           /* VALIDATE AND CONVERT TIMES  0225
*                                                            @Y30LB40*/
         LR    J,SS                                                0225
         B     @DE00225                                            0225
@DL00225 DS    0H                                                  0226
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0226
         LA    @07,PARMHOLD-1(J)                                   0226
         CLI   0(@07),C'0'                                         0226
         BL    @RF00226                                            0226
         LA    @07,PARMHOLD-1(J)                                   0226
         CLI   0(@07),C'9'                                         0226
         BNH   @RT00226                                            0226
*           ;                       /*                       @Y30LB40*/
*         ELSE                                                     0228
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0228
*                                                            @Y30LB40*/
@RF00226 OI    PARMERR,B'10000000'                                 0228
*       END;                        /*                       @Y30LB40*/
@RT00226 AL    J,@CF00043                                          0229
@DE00225 LA    @07,7                                               0229
         ALR   @07,SS                                              0229
         CR    J,@07                                               0229
         BNH   @DL00225                                            0229
*       IF PARMERR='1'B THEN                                       0230
         TM    PARMERR,B'10000000'                                 0230
         BO    @RT00230                                            0230
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/
         LA    @01,PARMHOLD-1(SS)                                  0232
         PACK  DOUBLEWD(8),0(2,@01)                                0232
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0233
*       IF TIMEWORK>23 THEN                                        0234
         C     TIMEWORK,@CF00652                                   0234
         BNH   @RF00234                                            0234
*         PARMERR='1'B;             /* HOUR MUST BE <= 23            */
         OI    PARMERR,B'10000000'                                 0235
*       ELSE                                                       0236
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00234                                            0236
@RF00234 LR    @15,TIMEWORK                                        0236
         MH    @15,@CH00653                                        0236
         ST    @15,HLDSTIME                                        0236
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/
@RC00234 LA    @01,PARMHOLD+1(SS)                                  0237
         PACK  DOUBLEWD(8),0(2,@01)                                0237
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0238
*       IF TIMEWORK>59 THEN                                        0239
         C     TIMEWORK,@CF00654                                   0239
         BNH   @RF00239                                            0239
*         PARMERR='1'B;             /* MINUTE MUST BE <= 59          */
         OI    PARMERR,B'10000000'                                 0240
*       ELSE                                                       0241
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/
         B     @RC00239                                            0241
@RF00239 LR    @15,TIMEWORK                                        0241
         MH    @15,@CH00334                                        0241
         AL    @15,HLDSTIME                                        0241
         ST    @15,HLDSTIME                                        0241
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/
@RC00239 LA    @01,PARMHOLD+3(SS)                                  0242
         PACK  DOUBLEWD(8),0(2,@01)                                0242
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0243
*       IF TIMEWORK>23 THEN                                        0244
         C     TIMEWORK,@CF00652                                   0244
         BNH   @RF00244                                            0244
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0245
*       ELSE                                                       0246
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/
         B     @RC00244                                            0246
@RF00244 LR    @15,TIMEWORK                                        0246
         MH    @15,@CH00653                                        0246
         ST    @15,HLDETIME                                        0246
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/
@RC00244 LA    @01,PARMHOLD+5(SS)                                  0247
         PACK  DOUBLEWD(8),0(2,@01)                                0247
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/
         CVB   TIMEWORK,DOUBLEWD                                   0248
*       IF TIMEWORK>59 THEN                                        0249
         C     TIMEWORK,@CF00654                                   0249
         BNH   @RF00249                                            0249
*         PARMERR='1'B;             /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0250
*       ELSE                                                       0251
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/
         B     @RC00249                                            0251
@RF00249 LR    @15,TIMEWORK                                        0251
         MH    @15,@CH00334                                        0251
         AL    @15,HLDETIME                                        0251
         AL    @15,@CF00654                                        0251
         ST    @15,HLDETIME                                        0251
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0252
@RC00249 CLC   HLDSYR(1),HLDEYR                                    0252
         BNE   @RF00252                                            0252
         CLC   HLDSDAY(2),HLDEDAY                                  0252
         BNE   @RF00252                                            0252
*         IF HLDSTIME>HLDETIME THEN                                0253
         L     @03,HLDSTIME                                        0253
         C     @03,HLDETIME                                        0253
         BNH   @RF00253                                            0253
*           PARMERR='1'B;           /*                       @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0254
*       IF PARMERR='0'B&DATEINSW='0'B/* WERE DATES ENTERED           */
*         THEN                                                     0255
@RF00253 DS    0H                                                  0255
@RF00252 TM    PARMERR,B'10000000'                                 0255
         BNZ   @RF00255                                            0255
         TM    DATEINSW,B'10000000'                                0255
         BNZ   @RF00255                                            0255
*         PARMERR='1'B;             /* NO,ERROR              @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0256
*       SS=SS+9;                    /* YES,BUMP TO NEXT VALUE        */
@RF00255 AL    SS,@CF00423                                         0257
*     END;                          /*                       @Y30LB40*/
*   IF PARMERR='1'B THEN                                           0259
@RC00222 TM    PARMERR,B'10000000'                                 0259
         BO    @RT00259                                            0259
*     GO TO PARMEND;                /* IF ERRORS FOUND,EXIT          */
*   IF PARMHOLD(SS:SS)=','          /* WAS VOLID SPECIFIED   @Y30LB40*/
*     THEN                                                         0261
         LA    @03,PARMHOLD-1(SS)                                  0261
         CLI   0(@03),C','                                         0261
         BE    @RT00261                                            0261
*     ;                             /* NO, PROCESS FINISHED  @Y30LB40*/
*   ELSE                                                           0263
*     DO;                           /* YES,CHECK FOR SIX BYTES     0263
*                                      ENTERED                       */
*       DO J=SS TO(SS+5);           /*                       @Y30LB40*/
         LR    J,SS                                                0264
         B     @DE00264                                            0264
@DL00264 DS    0H                                                  0265
*         IF PARMHOLD(J:J)=',' THEN                                0265
         LA    @07,PARMHOLD-1(J)                                   0265
         CLI   0(@07),C','                                         0265
         BNE   @RF00265                                            0265
*           DO;                     /*                       @Y30LB40*/
*             PARMERR='1'B;         /* COMMA FOUND BEFORE END,ERROR
*                                                            @Y30LB40*/
         OI    PARMERR,B'10000000'                                 0267
*             J=SS+5;               /* STOP LOOP             @Y30LB40*/
         LA    J,5                                                 0268
         ALR   J,SS                                                0268
*           END;                    /*                       @Y30LB40*/
*       END;                        /*                       @Y30LB40*/
@RF00265 AL    J,@CF00043                                          0270
@DE00264 LA    @07,5                                               0270
         ALR   @07,SS                                              0270
         CR    J,@07                                               0270
         BNH   @DL00264                                            0270
*       IF PARMERR='1'B             /* IF ERROR FOUND,EXIT   @Y30LB40*/
*         THEN                                                     0271
         TM    PARMERR,B'10000000'                                 0271
         BO    @RT00271                                            0271
*         GO TO PARMEND;            /*                       @Y30LB40*/
*       ELSE                                                       0273
*         VOL=PARMHOLD(SS:SS+5);    /* NO ERROR,SAVE VOLID   @Y30LB40*/
         LA    @03,PARMHOLD-1(SS)                                  0273
         MVC   VOL(6),0(@03)                                       0273
*     END;                          /*                       @Y30LB40*/
*PARMEND:                                                          0275
*   IF PARMERR='1'B                 /* IF ERRORS FOUND,PRINT ERROR 0275
*                                      MSG,EXIT WITH                 */
*     THEN                                                         0275
@RT00261 DS    0H                                                  0275
PARMEND  TM    PARMERR,B'10000000'                                 0275
         BNO   @RF00275                                            0275
*     DO;                           /* RETURN CODE = 8       @Y30LB40*/
*       PRINTLN=PARMMSG;            /*                       @Y30LB40*/
         MVI   PRINTLN+28,C' '                                     0277
         MVC   PRINTLN+29(92),PRINTLN+28                           0277
         MVC   PRINTLN(28),PARMMSG                                 0277
*       RFY                                                        0278
*        (R0,                                                      0278
*         R1,                                                      0278
*         R14,                                                     0278
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/
         PUT   PRNTDCB,PRINTLN
*       RFY                                                        0280
*        (R0,                                                      0280
*         R1,                                                      0280
*         R14,                                                     0280
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /*                       @Y30LB40*/
         LA    RETURNCD,8                                          0281
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/
         B     CLOSEFIL                                            0282
*     END;                          /*                       @Y30LB40*/
*   RFY                                                            0284
*    (R0,                                                          0284
*     R1,                                                          0284
*     R14,                                                         0284
*     R15) RSTD;                    /*                       @Y30LB40*/
@RF00275 DS    0H                                                  0285
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0285
*                                                            @Y30LB40*/
         TIME
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/
         ST    R1,DOUBLEWD
*   RFY                                                            0287
*    (R0,                                                          0287
*     R1,                                                          0287
*     R14,                                                         0287
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0288
*                                                                  0289
*/********************************************************************
*                                                                    */
*/* BEGIN PROCESSING THE FILE                                @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0289
*RDTRACE:                                                          0289
*   RFY                                                            0289
*    (R0,                                                          0289
*     R1,                                                          0289
*     R14,                                                         0289
*     R15) RSTD;                    /*                       @Y30LB40*/
RDTRACE  DS    0H                                                  0290
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/
         GET   INDCB,RCDIN
*   RFY                                                            0291
*    (R0,                                                          0291
*     R1,                                                          0291
*     R14,                                                         0291
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   IF CKTIME<CKSTIME×CKTIME>CKETIME/* IF NOT IN DATE AND TIME       */
*     THEN                                                         0292
         CLC   CKTIME(7),CKSTIME                                   0292
         BL    @RT00292                                            0292
         CLC   CKTIME(7),CKETIME                                   0292
         BH    @RT00292                                            0292
*     GO TO RDTRACE;                /* RANGE,READ NEXT RECORD        */
*   IF(DSTGD+STGD)^>0 THEN                                         0294
         L     @15,DSTGD                                           0294
         AL    @15,STGD                                            0294
         LTR   @15,@15                                             0294
         BNP   @RT00294                                            0294
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */
*   IF VOL^='      '                /* IF VOLID SPECIFIED AND      0296
*                                                            @Y30LB40*/
*     THEN                                                         0296
         CLC   VOL(6),@CC00659                                     0296
         BE    @RF00296                                            0296
*     IF VOLID^=VOL                 /* RECORD DOES NOT MATCH @Y30LB40*/
*       THEN                                                       0297
         CLC   VOLID(6),VOL                                        0297
         BNE   @RT00297                                            0297
*       GO TO RDTRACE;              /* THEN READ NEXT RECORD @Y30LB40*/
*   SNL=LIBRARY;                    /* SET UP NEW LIBRARY    @Y30LB40*/
@RF00296 MVC   SNL(1),LIBRARY                                      0299
*   SNV=VOLID;                      /* SET UP NEW VOLID      @Y30LB40*/
         MVC   SNV(6),VOLID                                        0300
*   SNT=CKTIME;                     /* SET UP NEW DATE AND TIME    0301
*                                                            @Y30LB40*/
         MVC   SNT(7),CKTIME                                       0301
*   IF SEQNEW<SEQOLD                /* IS FILE OUT OF SEQUENCE     0302
*                                                            @Y30LB40*/
*     THEN                                                         0302
         CLC   SEQNEW(14),SEQOLD                                   0302
         BNL   @RF00302                                            0302
*     DO;                           /* YES                   @Y30LB40*/
*       PRINTLN=SEQMSG;             /* SET UP ERROR MESSAGE  @Y30LB40*/
         MVI   PRINTLN+43,C' '                                     0304
         MVC   PRINTLN+44(77),PRINTLN+43                           0304
         MVC   PRINTLN(43),SEQMSG                                  0304
*       RFY                                                        0305
*        (R0,                                                      0305
*         R1,                                                      0305
*         R14,                                                     0305
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,PRINTLN); /* PRINT MESSAGE         @Y30LB40*/
         PUT   PRNTDCB,PRINTLN
*       RFY                                                        0307
*        (R0,                                                      0307
*         R1,                                                      0307
*         R14,                                                     0307
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       RETURNCD=8;                 /* SET UP RETURN CODE    @Y30LB40*/
         LA    RETURNCD,8                                          0308
*       GO TO CLOSEFIL;             /* GET OUT OF PROGRAM    @Y30LB40*/
         B     CLOSEFIL                                            0309
*     END;                          /*                       @Y30LB40*/
*   ELSE                                                           0311
*     SEQOLD=SEQNEW;                /* FILE OK,SAVE SEQUENCE @Y30LB40*/
@RF00302 MVC   SEQOLD(14),SEQNEW                                   0311
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/
         LA    @15,1                                               0312
         AL    @15,RCDCOUNT                                        0312
         ST    @15,RCDCOUNT                                        0312
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/
*     THEN                                                         0313
         TM    FIRSTSW,B'10000000'                                 0313
         BNO   @RF00313                                            0313
*     DO;                           /*                       @Y30LB40*/
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */
         NI    FIRSTSW,B'01111111'                                 0315
*NEWLIB:                                                           0316
*                                                                  0316
*       /*************************************************************/
*       /*                                                           */
*       /* ************************************************  @OZ11673*/
*       /* SET UP INITIAL TIMESLICE COMPARE RECORD USING     @OZ11673*/
*       /* THE STARTING TIME SPECIFIED IN THE DATE AND       @OZ11673*/
*       /* TIME PARAMETERS, OR THE DEFAULT VALUES.           @OZ11673*/
*       /* ************************************************  @OZ11673*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0316
*       TSBEG=CKSTIME;              /*                       @OZ11673*/
NEWLIB   MVC   TSBEG(7),CKSTIME                                    0316
*       TSEND=CKSTIME;              /*                       @OZ11673*/
         MVC   TSEND(7),CKSTIME                                    0317
*       TSEYR=SVEYEAR;              /*                       @OZ11673*/
         MVC   TSEYR(1),SVEYEAR                                    0318
*       TSETIME=TSETIME+TIMESL;     /*                       @OZ11673*/
         L     @15,TSETIME                                         0319
         AL    @15,TIMESL                                          0319
         ST    @15,TSETIME                                         0319
*       CALL GETSLICE;              /*                       @OZ11673*/
         BAL   @14,GETSLICE                                        0320
*       VOLUME=VOLID;               /* STORE 1ST VOLUME IDENT      0321
*                                                            @Y30LB40*/
         MVC   VOLUME(6),VOLID                                     0321
*       LIB=LIBRARY;                /* STORE 1ST LIBRARY     @Y30LB40*/
         MVC   LIB(1),LIBRARY                                      0322
*     END;                          /*                       @Y30LB40*/
*CHECKTIM:                          /* CHECK FOR CONTROL BREAKS    0324
*                                                            @Y30LB40*/
*   IF LIBRARY^=LIB THEN                                           0324
@RF00313 DS    0H                                                  0324
CHECKTIM CLC   LIBRARY(1),LIB                                      0324
         BE    @RF00324                                            0324
*     DO;                           /* IF LIBRARY CHANGED,CONTROL  0325
*                                      BREAK                 @Y30LB40*/
*       LIBSW='1'B;                 /*                       @Y30LB40*/
         OI    LIBSW,B'10000000'                                   0326
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/
         B     VOLIDBRK                                            0327
*     END;                          /*                       @Y30LB40*/
*   IF VOLUME^=VOLID THEN                                          0329
@RF00324 CLC   VOLUME(6),VOLID                                     0329
         BE    @RF00329                                            0329
*     DO;                           /* IF VOLUME CHANGED,CONTROL   0330
*                                      BREAK                 @Y30LB40*/
*       VOLSW='1'B;                 /*                       @Y30LB40*/
         OI    VOLSW,B'10000000'                                   0331
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/
         B     VOLIDBRK                                            0332
*     END;                          /*                       @Y30LB40*/
*   IF CKTIME>TSEND THEN                                           0334
@RF00329 CLC   CKTIME(7),TSEND                                     0334
         BNH   @RF00334                                            0334
*     DO;                           /* IF TIME SLICE EXCEEDED,CONTROL
*                                      BREAK                 @Y30LB40*/
*       TMESW='1'B;                 /*                       @Y30LB40*/
         OI    TMESW,B'10000000'                                   0336
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/
         B     VOLIDBRK                                            0337
*     END;                          /*                       @Y30LB40*/
*SUMIT:                             /* ACCUM VALUES FOR TIMESLICE AND
*                                      VOLID                 @Y30LB40*/
*   DO I=1 TO 2;                    /*                       @Y30LB40*/
@RF00334 DS    0H                                                  0339
SUMIT    LA    I,1                                                 0339
@DL00339 DS    0H                                                  0340
*     IF CARTPAIR=0                 /* SET J ACCORDING TO CARTRIDGE
*                                      PAIR NUMBER                   */
*       THEN                                                       0340
         CLI   CARTPAIR,0                                          0340
         BNE   @RF00340                                            0340
*       J=1;                        /*                       @Y30LB40*/
         LA    J,1                                                 0341
*     ELSE                                                         0342
*       J=2;                        /*                       @Y30LB40*/
         B     @RC00340                                            0342
@RF00340 LA    J,2                                                 0342
*     SMSTGD(I,J)=SMSTGD(I,J)+STGD; /* ACCUM CYLS STAGED     @Y30LB40*/
@RC00340 LR    @15,I                                               0343
         ALR   @15,@15                                             0343
         ALR   @15,J                                               0343
         MH    @15,@CH00729                                        0343
         L     @14,SMSTGD-108(@15)                                 0343
         AL    @14,STGD                                            0343
         ST    @14,SMSTGD-108(@15)                                 0343
*     SMCFAULT(I,J)=SMCFAULT(I,J)+CFAULT;/* ACCUM CYL FAULT CAUSED   */
         L     @14,SMCFAULT-108(@15)                               0344
         AL    @14,CFAULT                                          0344
         ST    @14,SMCFAULT-108(@15)                               0344
*     SMDSTGD(I,J)=SMDSTGD(I,J)+DSTGD;/* ACCUM CYLS DESTAGED         */
         L     @14,SMDSTGD-108(@15)                                0345
         AL    @14,DSTGD                                           0345
         ST    @14,SMDSTGD-108(@15)                                0345
*     SMSALLOC(I,J)=SMSALLOC(I,J)+SALLOC;/* ACCUM SPACE ALLOC CAUSED */
         L     @14,SMSALLOC-108(@15)                               0346
         AL    @14,SALLOC                                          0346
         ST    @14,SMSALLOC-108(@15)                               0346
*     LOADS(I,J)=LOADS(I,J)+LOADNUM;/* ACCUM NUMBER OF LOADS         */
         SLR   @14,@14                                             0347
         IC    @14,LOADNUM                                         0347
         AL    @14,LOADS-108(@15)                                  0347
         ST    @14,LOADS-108(@15)                                  0347
*     STGDTOT(I,J)=STGDTOT(I,J)+STGDNUM;/* ACCUM NUMBER OF STAGES    */
         SLR   @14,@14                                             0348
         IC    @14,STGDNUM                                         0348
         AL    @14,STGDTOT-108(@15)                                0348
         ST    @14,STGDTOT-108(@15)                                0348
*     DSTGDTOT(I,J)=DSTGDTOT(I,J)+DSTGDNUM;/* ACCUM DESTAGES         */
         SLR   @14,@14                                             0349
         IC    @14,DSTGDNUM                                        0349
         AL    @14,DSTGDTOT-108(@15)                               0349
         ST    @14,DSTGDTOT-108(@15)                               0349
*     IF CARTPAIR=0                 /* IF PAIR 0 ACCUM VTOC STAGES 0350
*                                      AND                   @Y30LB40*/
*       THEN                                                       0350
         CLI   CARTPAIR,0                                          0350
         BNE   @RF00350                                            0350
*       DO;                         /* DESTAGES              @Y30LB40*/
*         VTOCSG(I,J)=VTOCSG(I,J)+VTOCSTG;/*                 @Y30LB40*/
         SLR   @14,@14                                             0352
         IC    @14,VTOCSTG                                         0352
         AL    @14,VTOCSG-108(@15)                                 0352
         ST    @14,VTOCSG-108(@15)                                 0352
*         VTOCDS(I,J)=VTOCDS(I,J)+VTOCDSTG;/*                @Y30LB40*/
         SLR   @14,@14                                             0353
         IC    @14,VTOCDSTG                                        0353
         AL    @14,VTOCDS-108(@15)                                 0353
         ST    @14,VTOCDS-108(@15)                                 0353
*       END;                        /*                       @Y30LB40*/
*   END;                            /*                       @Y30LB40*/
@RF00350 AL    I,@CF00043                                          0355
         C     I,@CF00050                                          0355
         BNH   @DL00339                                            0355
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/
         B     RDTRACE                                             0356
*                                                                  0357
*/********************************************************************
*                                                                    */
*/**ROUTINE TO PRINT VOL ID DETAIL AND PROCESS CONTROL BREAKS*       */
*/********************************************************************
*                                                                    */
*                                                                  0357
*VOLIDBRK:                                                         0357
*   I=1;                            /* SET I FOR TIME SLICE TOTAL  0357
*                                                            @Y30LB40*/
VOLIDBRK LA    I,1                                                 0357
*PROCBRK:                                                          0358
*   CALL SETLINE;                   /* GET PRINT LINE CONSTANT INFO
*                                                            @Y30LB40*/
PROCBRK  BAL   @14,SETLINE                                         0358
*   IF I=2                          /* IF DOING VOLID TOTALS @Y30LB40*/
*     THEN                                                         0359
         C     I,@CF00050                                          0359
         BNE   @RF00359                                            0359
*     DO;                           /*                       @Y30LB40*/
*       PF1='TOTALS';               /* INDICATE VOLID TOTALS @Y30LB40*/
         MVC   PF1(6),@CC00672                                     0361
*       PF3='        ';             /*                       @Y30LB40*/
         MVC   PF3(8),@CC00673                                     0362
*     END;                          /*                       @Y30LB40*/
*   DO J=1 TO 2;                    /* CHECK FOR BOTH CARTRIDGE PAIRS
*                                                            @Y30LB40*/
@RF00359 LA    J,1                                                 0364
@DL00364 DS    0H                                                  0365
*     IF LINECNT>55 THEN                                           0365
         C     LINECNT,@CF00674                                    0365
         BNH   @RF00365                                            0365
*       DO;                         /* FORCE NEW PAGE HEADING      0366
*                                                            @Y30LB40*/
*         LINECNT=6;                /* RESET PAGE COUNTER AND PRINT  */
         LA    LINECNT,6                                           0367
*         PAGECNT=PAGECNT+1;        /* HEADINGS              @Y30LB40*/
         LA    @15,1                                               0368
         AL    @15,PAGECNT                                         0368
         ST    @15,PAGECNT                                         0368
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/
         MVC   HEADHOLD(121),HDNG1                                 0369
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/
         MVC   @AL00001+4(8),@AL00370                              0370
         LA    @15,PAGECNT                                         0370
         ST    @15,@AFTEMPS+4                                      0370
         LA    @15,@AFTEMPS+4                                      0370
         ST    @15,@AL00001                                        0370
         LA    @01,@AL00001                                        0370
         BAL   @14,EDITFIX                                         0370
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/
         MVC   HEADHOLD+117(4),FIXOUT+9                            0371
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/
         MVC   HEADHOLD+106(5),TODAY                               0372
*         RFY                                                      0373
*          (R0,                                                    0373
*           R1,                                                    0373
*           R14,                                                   0373
*           R15) RSTD;              /*                       @Y30LB40*/
*         GEN(PUT   PRNTDCB,HEADHOLD);/*                     @Y30LB40*/
         PUT   PRNTDCB,HEADHOLD
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/
         PUT   PRNTDCB,HDNG2
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/
         PUT   PRNTDCB,HDNG3
*         GEN(PUT   PRNTDCB,HDNG4); /*                       @Y30LB40*/
         PUT   PRNTDCB,HDNG4
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*         RFY                                                      0379
*          (R0,                                                    0379
*           R1,                                                    0379
*           R14,                                                   0379
*           R15) UNRSTD;            /*                       @Y30LB40*/
*       END;                        /*                       @Y30LB40*/
*     IF SMSTGD(I,J)+SMDSTGD(I,J)^=0 THEN                          0381
@RF00365 LR    @15,I                                               0381
         ALR   @15,@15                                             0381
         ALR   @15,J                                               0381
         MH    @15,@CH00729                                        0381
         L     @14,SMSTGD-108(@15)                                 0381
         AL    @14,SMDSTGD-108(@15)                                0381
         LTR   @14,@14                                             0381
         BZ    @RF00381                                            0381
*       DO;                         /* IF ANY ACTIVITY,PRINT VALUES
*                                                            @Y30LB40*/
*         IF J=1 THEN                                              0383
         C     J,@CF00043                                          0383
         BNE   @RF00383                                            0383
*           PF13A='0';              /* SET CARTRIDGE PAIR NUMBER   0384
*                                                            @Y30LB40*/
         MVI   PF13A,C'0'                                          0384
*         ELSE                                                     0385
*           PF13A='1';              /*                       @Y30LB40*/
         B     @RC00383                                            0385
@RF00383 MVI   PF13A,C'1'                                          0385
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/
@RC00383 MVC   @AL00001+4(8),@AL00386                              0386
         LR    @15,I                                               0386
         ALR   @15,@15                                             0386
         ALR   @15,J                                               0386
         MH    @15,@CH00729                                        0386
         LA    @15,SMSTGD-108(@15)                                 0386
         ST    @15,@AFTEMPS+4                                      0386
         LA    @15,@AFTEMPS+4                                      0386
         ST    @15,@AL00001                                        0386
         LA    @01,@AL00001                                        0386
         BAL   @14,EDITFIX                                         0386
*         PF15=FIXOUT(5:13);        /* CYLINDERS STAGED      @Y30LB40*/
         MVC   PF15(9),FIXOUT+4                                    0387
*         CALL EDITFIX(ADDR(SMCFAULT(I,J)),4,'E');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00388                              0388
         LR    @15,I                                               0388
         ALR   @15,@15                                             0388
         ALR   @15,J                                               0388
         MH    @15,@CH00729                                        0388
         LA    @15,SMCFAULT-108(@15)                               0388
         ST    @15,@AFTEMPS+4                                      0388
         LA    @15,@AFTEMPS+4                                      0388
         ST    @15,@AL00001                                        0388
         LA    @01,@AL00001                                        0388
         BAL   @14,EDITFIX                                         0388
*         PF17=FIXOUT(5:13);        /* CYLINDER FAULT CAUSED @Y30LB40*/
         MVC   PF17(9),FIXOUT+4                                    0389
*         CALL EDITFIX(ADDR(SMDSTGD(I,J)),4,'E');/*          @Y30LB40*/
         MVC   @AL00001+4(8),@AL00390                              0390
         LR    @15,I                                               0390
         ALR   @15,@15                                             0390
         ALR   @15,J                                               0390
         MH    @15,@CH00729                                        0390
         LA    @15,SMDSTGD-108(@15)                                0390
         ST    @15,@AFTEMPS+4                                      0390
         LA    @15,@AFTEMPS+4                                      0390
         ST    @15,@AL00001                                        0390
         LA    @01,@AL00001                                        0390
         BAL   @14,EDITFIX                                         0390
*         PF19=FIXOUT(5:13);        /* CYLINDERS DESTAGED    @Y30LB40*/
         MVC   PF19(9),FIXOUT+4                                    0391
*         CALL EDITFIX(ADDR(SMSALLOC(I,J)),4,'E');/*         @Y30LB40*/
         MVC   @AL00001+4(8),@AL00392                              0392
         LR    @15,I                                               0392
         ALR   @15,@15                                             0392
         ALR   @15,J                                               0392
         MH    @15,@CH00729                                        0392
         LA    @15,SMSALLOC-108(@15)                               0392
         ST    @15,@AFTEMPS+4                                      0392
         LA    @15,@AFTEMPS+4                                      0392
         ST    @15,@AL00001                                        0392
         LA    @01,@AL00001                                        0392
         BAL   @14,EDITFIX                                         0392
*         PF21=FIXOUT(5:13);        /* SPACE ALLOCATOR CAUSED      0393
*                                                            @Y30LB40*/
         MVC   PF21(9),FIXOUT+4                                    0393
*         SMSTGD(I,J)=SMSTGD(I,J)+SMDSTGD(I,J);/* TOT STAGING        */
         LR    @15,I                                               0394
         ALR   @15,@15                                             0394
         ALR   @15,J                                               0394
         MH    @15,@CH00729                                        0394
         L     @14,SMSTGD-108(@15)                                 0394
         AL    @14,SMDSTGD-108(@15)                                0394
         ST    @14,SMSTGD-108(@15)                                 0394
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/
         MVC   @AL00001+4(8),@AL00395                              0395
         LA    @15,SMSTGD-108(@15)                                 0395
         ST    @15,@AFTEMPS+4                                      0395
         LA    @15,@AFTEMPS+4                                      0395
         ST    @15,@AL00001                                        0395
         LA    @01,@AL00001                                        0395
         BAL   @14,EDITFIX                                         0395
*         PF23=FIXOUT(5:13);        /*                       @Y30LB40*/
         MVC   PF23(9),FIXOUT+4                                    0396
*         CALL EDITFIX(ADDR(LOADS(I,J)),4,'S');/*            @Y30LB40*/
         MVC   @AL00001+4(8),@AL00397                              0397
         LR    @15,I                                               0397
         ALR   @15,@15                                             0397
         ALR   @15,J                                               0397
         MH    @15,@CH00729                                        0397
         LA    @15,LOADS-108(@15)                                  0397
         ST    @15,@AFTEMPS+4                                      0397
         LA    @15,@AFTEMPS+4                                      0397
         ST    @15,@AL00001                                        0397
         LA    @01,@AL00001                                        0397
         BAL   @14,EDITFIX                                         0397
*         PF31=FIXOUT(10:13);       /* NUMBER OF LOADS       @Y30LB40*/
         MVC   PF31(4),FIXOUT+9                                    0398
*         CALL EDITFIX(ADDR(STGDTOT(I,J)),4,'S');/*          @Y30LB40*/
         MVC   @AL00001+4(8),@AL00399                              0399
         LR    @15,I                                               0399
         ALR   @15,@15                                             0399
         ALR   @15,J                                               0399
         MH    @15,@CH00729                                        0399
         LA    @15,STGDTOT-108(@15)                                0399
         ST    @15,@AFTEMPS+4                                      0399
         LA    @15,@AFTEMPS+4                                      0399
         ST    @15,@AL00001                                        0399
         LA    @01,@AL00001                                        0399
         BAL   @14,EDITFIX                                         0399
*         PF33=FIXOUT(10:13);       /* NUMBER OF STAGES      @Y30LB40*/
         MVC   PF33(4),FIXOUT+9                                    0400
*         IF J=1 THEN                                              0401
         C     J,@CF00043                                          0401
         BNE   @RF00401                                            0401
*           DO;                     /* VTOC STAGES IF CART PAIR 0  0402
*                                                            @Y30LB40*/
*             CALL EDITFIX(ADDR(VTOCSG(I,J)),4,'S');/*       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00403                              0403
         LR    @15,I                                               0403
         ALR   @15,@15                                             0403
         ALR   @15,J                                               0403
         MH    @15,@CH00729                                        0403
         LA    @15,VTOCSG-108(@15)                                 0403
         ST    @15,@AFTEMPS+4                                      0403
         LA    @15,@AFTEMPS+4                                      0403
         ST    @15,@AL00001                                        0403
         LA    @01,@AL00001                                        0403
         BAL   @14,EDITFIX                                         0403
*             PF35=FIXOUT(10:13);   /*                       @Y30LB40*/
         MVC   PF35(4),FIXOUT+9                                    0404
*           END;                    /*                       @Y30LB40*/
*         ELSE                                                     0406
*           PF35='    ';            /*                       @Y30LB40*/
         B     @RC00401                                            0406
@RF00401 MVC   PF35(4),@CC00681                                    0406
*         CALL EDITFIX(ADDR(DSTGDTOT(I,J)),4,'S');/*         @Y30LB40*/
@RC00401 MVC   @AL00001+4(8),@AL00407                              0407
         LR    @15,I                                               0407
         ALR   @15,@15                                             0407
         ALR   @15,J                                               0407
         MH    @15,@CH00729                                        0407
         LA    @15,DSTGDTOT-108(@15)                               0407
         ST    @15,@AFTEMPS+4                                      0407
         LA    @15,@AFTEMPS+4                                      0407
         ST    @15,@AL00001                                        0407
         LA    @01,@AL00001                                        0407
         BAL   @14,EDITFIX                                         0407
*         PF37=FIXOUT(10:13);       /* NUMBER OF DESTAGES    @Y30LB40*/
         MVC   PF37(4),FIXOUT+9                                    0408
*         IF J=1 THEN                                              0409
         C     J,@CF00043                                          0409
         BNE   @RF00409                                            0409
*           DO;                     /* VTOC DESTAGES IF CART PAIR 0
*                                                            @Y30LB40*/
*             CALL EDITFIX(ADDR(VTOCDS(I,J)),4,'S');/*       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00411                              0411
         LR    @15,I                                               0411
         ALR   @15,@15                                             0411
         ALR   @15,J                                               0411
         MH    @15,@CH00729                                        0411
         LA    @15,VTOCDS-108(@15)                                 0411
         ST    @15,@AFTEMPS+4                                      0411
         LA    @15,@AFTEMPS+4                                      0411
         ST    @15,@AL00001                                        0411
         LA    @01,@AL00001                                        0411
         BAL   @14,EDITFIX                                         0411
*             PF39=FIXOUT(10:13);   /*                       @Y30LB40*/
         MVC   PF39(4),FIXOUT+9                                    0412
*           END;                    /*                       @Y30LB40*/
*         ELSE                                                     0414
*           PF39='    ';            /*                       @Y30LB40*/
         B     @RC00409                                            0414
@RF00409 MVC   PF39(4),@CC00681                                    0414
*         RFY                                                      0415
*          (R0,                                                    0415
*           R1,                                                    0415
*           R14,                                                   0415
*           R15) RSTD;              /*                       @Y30LB40*/
@RC00409 DS    0H                                                  0416
*         GEN(PUT   PRNTDCB,PRINTLN);/* PRINT THE LINE       @Y30LB40*/
         PUT   PRNTDCB,PRINTLN
*         RFY                                                      0417
*          (R0,                                                    0417
*           R1,                                                    0417
*           R14,                                                   0417
*           R15) UNRSTD;            /*                       @Y30LB40*/
*         LINECNT=LINECNT+1;        /* INCREMENT LINE COUNTER      0418
*                                                            @Y30LB40*/
         AL    LINECNT,@CF00043                                    0418
*         PF1='      ';             /* CLEAR CONSTANT INFO   @Y30LB40*/
         MVC   PF1(6),@CC00659                                     0419
*         PF3='        ';           /*                       @Y30LB40*/
         MVC   PF3(8),@CC00673                                     0420
*         PF0A=' ';                 /*                       @Y30LB40*/
         MVI   PF0A,C' '                                           0421
*         PF13='      ';            /*                       @Y30LB40*/
*                                                                  0422
         MVC   PF13(6),@CC00659                                    0422
*         /***********************************************************/
*         /*                                                         */
*         /* ** CLEAR ARRAY **                               @Y30LB40*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0423
*         SMSTGD(I,J)=0;            /*                       @Y30LB40*/
         SLR   @15,@15                                             0423
         LR    @14,I                                               0423
         ALR   @14,@14                                             0423
         ALR   @14,J                                               0423
         MH    @14,@CH00729                                        0423
         ST    @15,SMSTGD-108(@14)                                 0423
*         SMCFAULT(I,J)=0;          /*                       @Y30LB40*/
         ST    @15,SMCFAULT-108(@14)                               0424
*         SMDSTGD(I,J)=0;           /*                       @Y30LB40*/
         ST    @15,SMDSTGD-108(@14)                                0425
*         SMSALLOC(I,J)=0;          /*                       @Y30LB40*/
         ST    @15,SMSALLOC-108(@14)                               0426
*         LOADS(I,J)=0;             /*                       @Y30LB40*/
         ST    @15,LOADS-108(@14)                                  0427
*         STGDTOT(I,J)=0;           /*                       @Y30LB40*/
         ST    @15,STGDTOT-108(@14)                                0428
*         VTOCSG(I,J)=0;            /*                       @Y30LB40*/
         ST    @15,VTOCSG-108(@14)                                 0429
*         DSTGDTOT(I,J)=0;          /*                       @Y30LB40*/
         ST    @15,DSTGDTOT-108(@14)                               0430
*         VTOCDS(I,J)=0;            /*                       @Y30LB40*/
         ST    @15,VTOCDS-108(@14)                                 0431
*       END;                        /*                       @Y30LB40*/
*   END;                            /*                       @Y30LB40*/
@RF00381 AL    J,@CF00043                                          0433
         C     J,@CF00050                                          0433
         BNH   @DL00364                                            0433
*   IF EOFSW='1'B THEN                                             0434
         TM    EOFSW,B'10000000'                                   0434
         BNO   @RF00434                                            0434
*     DO;                           /* IF END OF FILE REACHED      0435
*                                                            @Y30LB40*/
*       IF I=2 THEN                                                0436
         C     I,@CF00050                                          0436
         BE    @RT00436                                            0436
*         GO TO EOJ;                /* IF VOLID TOTAL WRITTEN,EXIT   */
*       RFY                                                        0438
*        (R0,                                                      0438
*         R1,                                                      0438
*         R14,                                                     0438
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*       RFY                                                        0440
*        (R0,                                                      0440
*         R1,                                                      0440
*         R14,                                                     0440
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNTER     @Y30LB40*/
         AL    LINECNT,@CF00043                                    0441
*       I=2;                        /* SET FOR VOLID TOTALS  @Y30LB40*/
         LA    I,2                                                 0442
*       GO TO PROCBRK;              /* GO PRINT VOLID TOTALS @Y30LB40*/
         B     PROCBRK                                             0443
*     END;                          /*                       @Y30LB40*/
*   IF LIBSW='1'B THEN                                             0445
@RF00434 TM    LIBSW,B'10000000'                                   0445
         BNO   @RF00445                                            0445
*     DO;                           /* IF LIBRARY CONTROL BREAK    0446
*                                                            @Y30LB40*/
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0447
*                                                            @Y30LB40*/
*         THEN                                                     0447
         C     I,@CF00050                                          0447
         BNE   @RF00447                                            0447
*         DO;                       /* FORCE NEW PAGE        @Y30LB40*/
*           LIBSW='0'B;             /*                       @Y30LB40*/
         NI    LIBSW,B'01111111'                                   0449
*           LINECNT=56;             /*                       @Y30LB40*/
         LA    LINECNT,56                                          0450
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0451
*                                                            @Y30LB40*/
         B     NEWLIB                                              0451
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0453
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN
*                                                            @Y30LB40*/
@RF00447 DS    0H                                                  0454
*           RFY                                                    0454
*            (R0,                                                  0454
*             R1,                                                  0454
*             R14,                                                 0454
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*           RFY                                                    0456
*            (R0,                                                  0456
*             R1,                                                  0456
*             R14,                                                 0456
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0457
*                                                            @Y30LB40*/
         AL    LINECNT,@CF00043                                    0457
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/
         LA    I,2                                                 0458
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/
         B     PROCBRK                                             0459
*         END;                      /*                       @Y30LB40*/
*     END;                          /*                       @Y30LB40*/
*   IF VOLSW='1'B THEN                                             0462
@RF00445 TM    VOLSW,B'10000000'                                   0462
         BNO   @RF00462                                            0462
*     DO;                           /* IF VOLUME CONTROL BREAK     0463
*                                                            @Y30LB40*/
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0464
*                                                            @Y30LB40*/
*         THEN                                                     0464
         C     I,@CF00050                                          0464
         BNE   @RF00464                                            0464
*         DO;                       /* SKIP TWO LINES        @Y30LB40*/
*           VOLSW='0'B;             /*                       @Y30LB40*/
         NI    VOLSW,B'01111111'                                   0466
*           RFY                                                    0467
*            (R0,                                                  0467
*             R1,                                                  0467
*             R14,                                                 0467
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*           RFY                                                    0470
*            (R0,                                                  0470
*             R1,                                                  0470
*             R14,                                                 0470
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           LINECNT=LINECNT+2;      /* INCREMENT LINE COUNTER      0471
*                                                            @Y30LB40*/
         AL    LINECNT,@CF00050                                    0471
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0472
*                                                            @Y30LB40*/
         B     NEWLIB                                              0472
*         END;                      /*                       @Y30LB40*/
*       ELSE                                                       0474
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN
*                                                            @Y30LB40*/
@RF00464 DS    0H                                                  0475
*           RFY                                                    0475
*            (R0,                                                  0475
*             R1,                                                  0475
*             R14,                                                 0475
*             R15) RSTD;            /*                       @Y30LB40*/
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*           RFY                                                    0477
*            (R0,                                                  0477
*             R1,                                                  0477
*             R14,                                                 0477
*             R15) UNRSTD;          /*                       @Y30LB40*/
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0478
*                                                            @Y30LB40*/
         AL    LINECNT,@CF00043                                    0478
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/
         LA    I,2                                                 0479
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/
         B     PROCBRK                                             0480
*         END;                      /*                       @Y30LB40*/
*     END;                          /*                       @Y30LB40*/
*   IF TMESW='1'B THEN                                             0483
@RF00462 TM    TMESW,B'10000000'                                   0483
         BNO   @RF00483                                            0483
*     DO;                           /* TIME SLICE EXCEEDED   @Y30LB40*/
*       TMESW='0'B;                 /*                       @Y30LB40*/
         NI    TMESW,B'01111111'                                   0485
*       RFY                                                        0486
*        (R0,                                                      0486
*         R1,                                                      0486
*         R14,                                                     0486
*         R15) RSTD;                /*                       @Y30LB40*/
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/
         PUT   PRNTDCB,SPACE1
*       RFY                                                        0488
*        (R0,                                                      0488
*         R1,                                                      0488
*         R14,                                                     0488
*         R15) UNRSTD;              /*                       @Y30LB40*/
*       LINECNT=LINECNT+1;          /* INCREMENT LINE COUNTER      0489
*                                                            @Y30LB40*/
         AL    LINECNT,@CF00043                                    0489
*       CALL GETSLICE;              /*                       @OZ11673*/
         BAL   @14,GETSLICE                                        0490
*     END;                          /*                       @OZ11673*/
*   GO TO CHECKTIM;                 /* GO ACCUMULATE TOTALS  @Y30LB40*/
         B     CHECKTIM                                            0492
*/********************************************************************
*                                                                    */
*                                                                  0493
*EOF:                               /* IF END OF FILE REACHED      0493
*                                                            @Y30LB40*/
*   EOFSW='1'B;                     /* INDICATE END OF FILE  @Y30LB40*/
EOF      OI    EOFSW,B'10000000'                                   0493
*   GO TO VOLIDBRK;                 /* GO PRINT FINAL TOTALS @Y30LB40*/
         B     VOLIDBRK                                            0494
*                                                                  0495
*/********************************************************************
*                                                                    */
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0495
*EOJ:                                                              0495
*   PRINTLN=RCDTOTAL;               /* PRINT JCL PARMS AND RECORD  0495
*                                      TOTALS                @Y30LB40*/
EOJ      MVC   PRINTLN(121),RCDTOTAL                               0495
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/
         L     @00,TIMESL                                          0496
         SRDA  @00,32                                              0496
         D     @00,@CF00334                                        0496
         ST    @01,TIMESL                                          0496
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00497                              0497
         LA    @15,TIMESL                                          0497
         ST    @15,@AFTEMPS+4                                      0497
         LA    @15,@AFTEMPS+4                                      0497
         ST    @15,@AL00001                                        0497
         LA    @01,@AL00001                                        0497
         BAL   @14,EDITFIX                                         0497
*   PRINTLN(12:14)=FIXOUT(11:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+11(3),FIXOUT+10                             0498
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00499                              0499
         LA    @15,HLDSYR                                          0499
         ST    @15,@AFTEMPS+4                                      0499
         LA    @15,@AFTEMPS+4                                      0499
         ST    @15,@AL00001                                        0499
         LA    @01,@AL00001                                        0499
         BAL   @14,EDITFIX                                         0499
*   PRINTLN(25:26)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+24(2),FIXOUT+11                             0500
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00501                              0501
         LA    @15,HLDSDAY                                         0501
         ST    @15,@AFTEMPS+4                                      0501
         LA    @15,@AFTEMPS+4                                      0501
         ST    @15,@AL00001                                        0501
         LA    @01,@AL00001                                        0501
         BAL   @14,EDITFIX                                         0501
*   PRINTLN(27:29)=FIXOUT(11:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+26(3),FIXOUT+10                             0502
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00503                              0503
         LA    @15,HLDEYR                                          0503
         ST    @15,@AFTEMPS+4                                      0503
         LA    @15,@AFTEMPS+4                                      0503
         ST    @15,@AL00001                                        0503
         LA    @01,@AL00001                                        0503
         BAL   @14,EDITFIX                                         0503
*   PRINTLN(31:32)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+30(2),FIXOUT+11                             0504
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/
         MVC   @AL00001+4(8),@AL00505                              0505
         LA    @15,HLDEDAY                                         0505
         ST    @15,@AFTEMPS+4                                      0505
         LA    @15,@AFTEMPS+4                                      0505
         ST    @15,@AL00001                                        0505
         LA    @01,@AL00001                                        0505
         BAL   @14,EDITFIX                                         0505
*   PRINTLN(33:35)=FIXOUT(11:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+32(3),FIXOUT+10                             0506
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/
         L     @15,HLDSTIME                                        0507
         LA    @14,3600                                            0507
         LR    @00,@15                                             0507
         SRDA  @00,32                                              0507
         DR    @00,@14                                             0507
         ST    @01,HOUR                                            0507
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@14                                             0508
         LR    @02,@15                                             0508
         SLR   @02,@01                                             0508
         SRDA  @02,32                                              0508
         D     @02,@CF00334                                        0508
         ST    @03,MINUTE                                          0508
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00509                              0509
         LA    @15,HOUR                                            0509
         ST    @15,@AFTEMPS+4                                      0509
         LA    @15,@AFTEMPS+4                                      0509
         ST    @15,@AL00001                                        0509
         LA    @01,@AL00001                                        0509
         BAL   @14,EDITFIX                                         0509
*   PRINTLN(46:47)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+45(2),FIXOUT+11                             0510
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00511                              0511
         LA    @15,MINUTE                                          0511
         ST    @15,@AFTEMPS+4                                      0511
         LA    @15,@AFTEMPS+4                                      0511
         ST    @15,@AL00001                                        0511
         LA    @01,@AL00001                                        0511
         BAL   @14,EDITFIX                                         0511
*   PRINTLN(48:49)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+47(2),FIXOUT+11                             0512
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/
         L     @15,HLDETIME                                        0513
         LA    @14,3600                                            0513
         LR    @00,@15                                             0513
         SRDA  @00,32                                              0513
         DR    @00,@14                                             0513
         ST    @01,HOUR                                            0513
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/
         MR    @00,@14                                             0514
         LR    @02,@15                                             0514
         SLR   @02,@01                                             0514
         SRDA  @02,32                                              0514
         D     @02,@CF00334                                        0514
         ST    @03,MINUTE                                          0514
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00515                              0515
         LA    @15,HOUR                                            0515
         ST    @15,@AFTEMPS+4                                      0515
         LA    @15,@AFTEMPS+4                                      0515
         ST    @15,@AL00001                                        0515
         LA    @01,@AL00001                                        0515
         BAL   @14,EDITFIX                                         0515
*   PRINTLN(51:52)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+50(2),FIXOUT+11                             0516
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00517                              0517
         LA    @15,MINUTE                                          0517
         ST    @15,@AFTEMPS+4                                      0517
         LA    @15,@AFTEMPS+4                                      0517
         ST    @15,@AL00001                                        0517
         LA    @01,@AL00001                                        0517
         BAL   @14,EDITFIX                                         0517
*   PRINTLN(53:54)=FIXOUT(12:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+52(2),FIXOUT+11                             0518
*   IF VOL^='      '                /* IF VOLUME SPECIFIED   @Y30LB40*/
*     THEN                                                         0519
         CLC   VOL(6),@CC00659                                     0519
         BE    @RF00519                                            0519
*     PRINTLN(66:71)=VOL;           /* PRINT IT              @Y30LB40*/
         MVC   PRINTLN+65(6),VOL                                   0520
*   ELSE                                                           0521
*     PRINTLN(57:71)='               ';/* ELSE BLANK IT              */
         B     @RC00519                                            0521
@RF00519 MVC   PRINTLN+56(15),@CC00701                             0521
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/
@RC00519 MVC   @AL00001+4(8),@AL00522                              0522
         LA    @15,RCDCOUNT                                        0522
         ST    @15,@AFTEMPS+4                                      0522
         LA    @15,@AFTEMPS+4                                      0522
         ST    @15,@AL00001                                        0522
         LA    @01,@AL00001                                        0522
         BAL   @14,EDITFIX                                         0522
*   PRINTLN(99:104)=FIXOUT(8:13);   /*                       @Y30LB40*/
         MVC   PRINTLN+98(6),FIXOUT+7                              0523
*   RFY                                                            0524
*    (R0,                                                          0524
*     R1,                                                          0524
*     R14,                                                         0524
*     R15) RSTD;                    /*                       @Y30LB40*/
*   GEN(PUT   PRNTDCB,PRINTLN);     /*                       @Y30LB40*/
         PUT   PRNTDCB,PRINTLN
*   RFY                                                            0526
*    (R0,                                                          0526
*     R1,                                                          0526
*     R14,                                                         0526
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*CLOSEFIL:                                                         0527
*   RFY                                                            0527
*    (R0,                                                          0527
*     R1,                                                          0527
*     R14,                                                         0527
*     R15) RSTD;                    /*                       @Y30LB40*/
CLOSEFIL DS    0H                                                  0528
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/
         CLOSE INDCB,MF=(E,OPENCLOS)
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/
         CLOSE PRNTDCB,MF=(E,OPENCLOS)
*   RFY                                                            0530
*    (R0,                                                          0530
*     R1,                                                          0530
*     R14,                                                         0530
*     R15) UNRSTD;                  /*                       @Y30LB40*/
*   RETURN CODE(RETURNCD);          /* EXIT WITH RETURN CODE @Y30LB40*/
         L     @13,4(,@13)                                         0531
         L     @00,@SIZDATD                                        0531
         LR    @01,@10                                             0531
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@09                                             0531
         L     @14,12(,@13)                                        0531
         LM    @00,@12,20(@13)                                     0531
         BR    @14                                                 0531
*/********************************************************************
*                                                                    */
*                                                                  0532
*                                                                  0532
*/********************************************************** @OZ11673*/
*/*                                                          @OZ11673*/
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/
*/*                                                          @OZ11673*/
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/
*/*                                                          @OZ11673*/
*/********************************************************** @OZ11673*/
*                                                                  0532
*GETSLICE:                                                         0532
*   PROCEDURE;                      /*                       @OZ11673*/
GETSLICE STM   @14,@12,12(@13)                                     0532
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/
         B     @DE00533                                            0533
@DL00533 DS    0H                                                  0534
*     TSBEG=TSEND;                  /*                       @Y30LB40*/
         MVC   TSBEG(7),TSEND                                      0534
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/
         L     @15,TSETIME                                         0535
         AL    @15,TIMESL                                          0535
         ST    @15,TSETIME                                         0535
*     IF TSETIME>86399 THEN                                        0536
         C     @15,@CF00637                                        0536
         BNH   @RF00536                                            0536
*       DO;                         /*                       @Y30LB40*/
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/
         SL    @15,@CF00708                                        0538
         ST    @15,TSETIME                                         0538
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/
         LA    @15,1                                               0539
         LH    @14,TSEDAY                                          0539
         ALR   @14,@15                                             0539
         STH   @14,TSEDAY                                          0539
*         IF TSEDAY>365 THEN                                       0540
         C     @14,@CF00636                                        0540
         BNH   @RF00540                                            0540
*           DO;                     /*                       @Y30LB40*/
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0542
         MVC   @TS00001(1),TSEND                                   0542
         NI    @TS00001,B'00000011'                                0542
         CLI   @TS00001,B'00000000'                                0542
         BNE   @RF00542                                            0542
*               IF TSEDAY>366 THEN                                 0543
         LA    @07,366                                             0543
         CR    @14,@07                                             0543
         BNH   @RF00543                                            0543
*                 DO;               /*                       @Y30LB40*/
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/
         SLR   @14,@07                                             0545
         STH   @14,TSEDAY                                          0545
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/
         SLR   @14,@14                                             0546
         IC    @14,TSEYR                                           0546
         ALR   @15,@14                                             0546
         STC   @15,TSEYR                                           0546
*                 END;              /*                       @Y30LB40*/
*               ELSE                                               0548
*                 ;                 /*                       @Y30LB40*/
@RF00543 DS    0H                                                  0549
*             ELSE                                                 0549
*               DO;                 /*                       @Y30LB40*/
         B     @RC00542                                            0549
@RF00542 DS    0H                                                  0550
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/
         LH    @15,TSEDAY                                          0550
         SL    @15,@CF00636                                        0550
         STH   @15,TSEDAY                                          0550
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/
         LA    @15,1                                               0551
         SLR   @14,@14                                             0551
         IC    @14,TSEYR                                           0551
         ALR   @15,@14                                             0551
         STC   @15,TSEYR                                           0551
*               END;                /*                       @Y30LB40*/
*           END;                    /*                       @Y30LB40*/
@RC00542 DS    0H                                                  0554
*       END;                        /*                       @Y30LB40*/
@RF00540 DS    0H                                                  0555
*   END;                            /*                       @Y30LB40*/
@RF00536 DS    0H                                                  0555
@DE00533 CLC   CKTIME(7),TSEND                                     0555
         BH    @DL00533                                            0555
*   END GETSLICE;                   /*                       @OZ11673*/
@EL00002 DS    0H                                                  0556
@EF00002 DS    0H                                                  0556
@ER00002 LM    @14,@12,12(@13)                                     0556
         BR    @14                                                 0556
*                                                                  0557
*/********************************************************************
*                                                                    */
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4
*                                                                    */
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */
*/* LONG.                                                    @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0557
*EDITFIX:                                                          0557
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/
EDITFIX  STM   @14,@12,@SA00003                                    0557
         MVC   @PC00003(12),0(@01)                                 0557
*   DCL                                                            0558
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0558
*                                                            @Y30LB40*/
*   DCL                                                            0559
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/
*   DCL                                                            0560
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0560
*                                                            @Y30LB40*/
*   RFY                                                            0561
*    (R2,                                                          0561
*     R3) RSTD;                     /*                       @Y30LB40*/
*   R2=FIXADDR;                     /*                       @Y30LB40*/
         L     @15,@PC00003                                        0562
         L     R2,FIXADDR(,@15)                                    0562
*   R3=0;                           /*                       @Y30LB40*/
         SLR   R3,R3                                               0563
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE
*                                                            @Y30LB40*/
*     THEN                                                         0564
         L     @15,@PC00003+4                                      0564
         CLC   FIXLEN(4,@15),@CF00043                              0564
         BNE   @RF00564                                            0564
*     DO;                           /*                       @Y30LB40*/
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/
         IC    R3,0(R2)
*     END;                          /*                       @Y30LB40*/
*   ELSE                                                           0568
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0568
*                                      BYTES                 @Y30LB40*/
*       THEN                                                       0568
         B     @RC00564                                            0568
@RF00564 L     @15,@PC00003+4                                      0568
         CLC   FIXLEN(4,@15),@CF00050                              0568
         BNE   @RF00568                                            0568
*       DO;                         /*                       @Y30LB40*/
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/
         LH    R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*     ELSE                                                         0572
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/
         B     @RC00568                                            0572
@RF00568 DS    0H                                                  0573
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/
         L     R3,0(R2)
*       END;                        /*                       @Y30LB40*/
*   GEN;                                                           0575
@RC00568 DS    0H                                                  0575
@RC00564 DS    0H                                                  0575
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/
  CVD   R3,DOUBLEWD
  OI    DOUBLEWD+7,X'0F'
  UNPK  FIXOUT(13),DOUBLEWD+2(6)
*   IF FIXOPT='N' THEN                                             0576
         L     @15,@PC00003+8                                      0576
         CLI   FIXOPT(@15),C'N'                                    0576
         BE    @RT00576                                            0576
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */
*   IF FIXOPT='S' THEN                                             0578
         CLI   FIXOPT(@15),C'S'                                    0578
         BE    @RT00578                                            0578
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0579
*                                      INSERTION                     */
*   GEN;                                                           0580
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/
  MVC   FIXOUT(1),FIXOUT+3
  MVI   FIXOUT+1,C','
  MVC   FIXOUT+2(3),FIXOUT+4
  MVI   FIXOUT+5,C','
  MVC   FIXOUT+6(3),FIXOUT+7
  MVI   FIXOUT+9,C','
*EF4:                               /* ZERO AND COMMA SUPPRESS     0581
*                                                            @Y30LB40*/
*   GEN;                                                           0581
EF4      DS    0H                                                  0581
*                                                         /*@Y30LB40*/
         LA    R2,FIXOUT
         LA    R3,12
EF5      EQU   *
         CLI   0(R2),C','
         BE    EF6
         CLI   0(R2),C'0'
         BNE   EFEND
EF6      EQU   *
         MVI   0(R2),C' '
         LA    R2,1(R2)
         BCT   R3,EF5
*EFEND:                                                            0582
*   RFY                                                            0582
*    (R2,                                                          0582
*     R3) UNRSTD;                   /*                       @Y30LB40*/
*   END EDITFIX;                    /*                       @Y30LB40*/
@EL00003 DS    0H                                                  0583
@EF00003 DS    0H                                                  0583
@ER00003 LM    @14,@12,@SA00003                                    0583
         BR    @14                                                 0583
*                                                                  0584
*/********************************************************************
*                                                                    */
*/* ROUTINE TO SETUP CONSTANT INFO IN PRINT LINE             @Y30LB40*/
*/********************************************************************
*                                                                    */
*                                                                  0584
*SETLINE:                                                          0584
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/
SETLINE  STM   @14,@12,@SA00004                                    0584
*   PRINTLN=' ';                    /* CLEAR PRINT LINE      @Y30LB40*/
         MVI   PRINTLN+1,C' '                                      0585
         MVC   PRINTLN+2(119),PRINTLN+1                            0585
         MVI   PRINTLN,C' '                                        0585
*   PF1='  /   ';                   /*                       @Y30LB40*/
         MVC   PF1(6),@CC00725                                     0586
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00587                              0587
         LA    @15,TSSYR                                           0587
         ST    @15,@AFTEMPS                                        0587
         LA    @15,@AFTEMPS                                        0587
         ST    @15,@AL00001                                        0587
         LA    @01,@AL00001                                        0587
         BAL   @14,EDITFIX                                         0587
*   PF1(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE YEAR @Y30LB40*/
         MVC   PF1(2),FIXOUT+11                                    0588
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00589                              0589
         LA    @15,TSSDAY                                          0589
         ST    @15,@AFTEMPS                                        0589
         LA    @15,@AFTEMPS                                        0589
         ST    @15,@AL00001                                        0589
         LA    @01,@AL00001                                        0589
         BAL   @14,EDITFIX                                         0589
*   PF1(4:6)=FIXOUT(11:13);         /* PRINT TIME SLICE DAY  @Y30LB40*/
         MVC   PF1+3(3),FIXOUT+10                                  0590
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/
         L     @15,TSSTIME                                         0591
         LA    @14,3600                                            0591
         LR    @00,@15                                             0591
         SRDA  @00,32                                              0591
         DR    @00,@14                                             0591
         ST    @01,HOUR                                            0591
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/
         LA    @07,60                                              0592
         MR    @00,@14                                             0592
         LR    @02,@15                                             0592
         SLR   @02,@01                                             0592
         SRDA  @02,32                                              0592
         DR    @02,@07                                             0592
         ST    @03,MINUTE                                          0592
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/
         MR    @02,@07                                             0593
         ALR   @01,@03                                             0593
         SLR   @15,@01                                             0593
         ST    @15,SECOND                                          0593
*   PF3='  :  :  ';                 /*                       @Y30LB40*/
         MVC   PF3(8),@CC00726                                     0594
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00595                              0595
         LA    @15,HOUR                                            0595
         ST    @15,@AFTEMPS                                        0595
         LA    @15,@AFTEMPS                                        0595
         ST    @15,@AL00001                                        0595
         LA    @01,@AL00001                                        0595
         BAL   @14,EDITFIX                                         0595
*   PF3(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE HOURS      0596
*                                                            @Y30LB40*/
         MVC   PF3(2),FIXOUT+11                                    0596
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00597                              0597
         LA    @15,MINUTE                                          0597
         ST    @15,@AFTEMPS                                        0597
         LA    @15,@AFTEMPS                                        0597
         ST    @15,@AL00001                                        0597
         LA    @01,@AL00001                                        0597
         BAL   @14,EDITFIX                                         0597
*   PF3(4:5)=FIXOUT(12:13);         /* PRINT TIME SLICE MINUTES    0598
*                                                            @Y30LB40*/
         MVC   PF3+3(2),FIXOUT+11                                  0598
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/
         MVC   @AL00001+4(8),@AL00599                              0599
         LA    @15,SECOND                                          0599
         ST    @15,@AFTEMPS                                        0599
         LA    @15,@AFTEMPS                                        0599
         ST    @15,@AL00001                                        0599
         LA    @01,@AL00001                                        0599
         BAL   @14,EDITFIX                                         0599
*   PF3(7:8)=FIXOUT(12:13);         /* PRINT TIME SLICE SECONDS    0600
*                                                            @Y30LB40*/
         MVC   PF3+6(2),FIXOUT+11                                  0600
*   PF13=VOLUME;                    /* PRINT VOLUME IDENTIFICATION 0601
*                                                            @Y30LB40*/
         MVC   PF13(6),VOLUME                                      0601
*   CALL EDITFIX(ADDR(LIB),1,'N');  /*                       @Y30LB40*/
         MVC   @AL00001+4(8),@AL00602                              0602
         LA    @15,LIB                                             0602
         ST    @15,@AFTEMPS                                        0602
         LA    @15,@AFTEMPS                                        0602
         ST    @15,@AL00001                                        0602
         LA    @01,@AL00001                                        0602
         BAL   @14,EDITFIX                                         0602
*   PF0A=FIXOUT(13:13);             /* PRINT LIBRARY NUMBER  @Y30LB40*/
         MVC   PF0A(1),FIXOUT+12                                   0603
*   END SETLINE;                    /*                       @Y30LB40*/
@EL00004 DS    0H                                                  0604
@EF00004 DS    0H                                                  0604
@ER00004 LM    @14,@12,@SA00004                                    0604
         BR    @14                                                 0604
*                                                                  0605
*/********************************************************** @OZ05124*/
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/
*/********************************************************** @OZ05124*/
*                                                                  0605
*READERR:                                                          0605
*   ;                               /*                       @OZ05124*/
READERR  DS    0H                                                  0606
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/
         SYNADAF ACSMETH=QSAM
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/
         MVC   PRNTLINE+30(79),49(R1)
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/
         MVC   PRNTLINE(30),ICGTR904                               0608
*   SAVE14=R14;                     /*                       @OZ09522*/
         LR    SAVE14,R14                                          0609
*   RFY                                                            0610
*    (R0,                                                          0610
*     R1,                                                          0610
*     R14,                                                         0610
*     R15) RSTD;                    /*                       @OZ05124*/
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/
         PUT PRNTDCB,PRNTLINE
*   RFY                                                            0612
*    (R0,                                                          0612
*     R1,                                                          0612
*     R14,                                                         0612
*     R15) UNRSTD;                  /*                       @OZ05124*/
*   R14=SAVE14;                     /*                       @OZ09522*/
         LR    R14,SAVE14                                          0613
*   GEN(SYNADRLS);                  /*                       @OZ05124*/
         SYNADRLS
*   RETURNCD=4;                     /*                       @OZ05124*/
         LA    RETURNCD,4                                          0615
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/
         BR    R14
*   END ICGTRVID                    /*                       @Y30LB40*/
*                                                                  0617
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0617
*       ;                                                          0617
@EL00001 L     @13,4(,@13)                                         0617
@EF00001 L     @00,@SIZDATD                                        0617
         LR    @01,@10                                             0617
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0617
         BR    @14                                                 0617
@DATA    DS    0H
@CH00729 DC    H'36'
@CH00653 DC    H'3600'
@SM00738 MVC   PARMHOLD(0),PARMS(@03)
         DS    0F
@AL00370 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00397 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00399 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00403 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00407 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00411 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00497 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00522 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00595 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00676)
@AL00386 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00388 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00390 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00392 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00395 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00680)
@AL00499 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00503 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00587 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00602 DC    A(@CF00043)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00686)
@AL00501 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00505 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00589 DC    A(@CF00050)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00686)
@AL00509 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00511 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00515 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00517 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00597 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00599 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CC00686)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00004 DS    15F
@SA00003 DS    15F
@PC00003 DS    3F
@AL00001 DS    3A
@AFTEMPS DS    2F
ICGTRVID CSECT
         DS    0F
@CF00043 DC    F'1'
@CF00050 DC    F'2'
@CF00103 DC    F'4'
@CF00423 DC    F'9'
@CF00033 DC    F'11'
@CF00652 DC    F'23'
@CF00539 DC    F'30'
@CF00674 DC    F'55'
@CF00654 DC    F'59'
@CF00334 DC    F'60'
@CH00334 EQU   @CF00334+2
@CF00636 DC    F'365'
@CH00636 EQU   @CF00636+2
@CF00649 DC    F'366'
@CH00649 EQU   @CF00649+2
@CF00631 DC    F'600'
@CF00637 DC    F'86399'
@CF00708 DC    F'86400'
@DATD    DSECT
         DS    0D
DCBPTR   DS    A
TIMESL   DS    F
PARMPTR  DS    A
OPENCLOS DS    FL4
         ORG   OPENCLOS
OPCLB1   DS    BL1
OPCLB234 DS    CL3
         ORG   OPENCLOS+4
RCDCOUNT DS    F
PAGECNT  DS    F
HOUR     DS    F
MINUTE   DS    F
SECOND   DS    F
LIB      DS    FL1
@TS00001 DS    CL1
         DS    CL2
RCDIN    DS    CL72
         ORG   RCDIN
STGD     DS    FL4
CFAULT   DS    FL4
SYSSGTM  DS    FL4
DEVSGTM  DS    FL4
DSTGD    DS    FL4
SALLOC   DS    FL4
SYSDSTM  DS    FL4
DEVDSTM  DS    FL4
BUSYTIME DS    FL4
LOADTIME DS    FL4
LOADNUM  DS    FL1
CKTIME   DS    CL7
         ORG   CKTIME
SVEYEAR  DS    FL1
SVEJUL   DS    FL2
SVETIME  DS    FL4
         ORG   RCDIN+48
PAGES    DS    FL1
MININUM  DS    FL1
HITNUM   DS    FL1
STGDNUM  DS    FL1
DSTGDNUM DS    FL1
VTOCSTG  DS    FL1
VTOCDSTG DS    FL1
LIBRARY  DS    FL1
DSPORT   DS    FL1
DSCU     DS    FL1
Z        DS    FL1
Y        DS    FL1
X        DS    FL1
CARTPAIR DS    FL1
READWRIT DS    FL1
VOLID    DS    CL6
@NM00030 DS    CL3
         ORG   RCDIN+72
PRINTLN  DS    CL121
         ORG   PRINTLN
PF0      DS    CL1
PF1      DS    CL6
@NM00031 DS    CL1
PF3      DS    CL8
@NM00032 DS    CL1
PF0A     DS    CL1
@NM00033 DS    CL1
PF13     DS    CL6
@NM00034 DS    CL4
PF13A    DS    CL1
@NM00035 DS    CL5
PF15     DS    CL9
@NM00036 DS    CL1
PF17     DS    CL9
@NM00037 DS    CL1
PF19     DS    CL9
@NM00038 DS    CL1
PF21     DS    CL9
@NM00039 DS    CL1
PF23     DS    CL9
@NM00040 DS    CL2
PF31     DS    CL4
@NM00041 DS    CL2
PF33     DS    CL4
@NM00042 DS    CL2
PF35     DS    CL4
@NM00043 DS    CL2
PF37     DS    CL4
@NM00044 DS    CL2
PF39     DS    CL4
@NM00045 DS    CL7
         ORG   PRINTLN+121
SPACE1   DS    CL121
HEADHOLD DS    CL121
PRNTLINE DS    CL121
PRNTDCB  DS    CL100
INDCB    DS    CL100
STARTTIM DS    CL16
         ORG   STARTTIM
@NM00065 DS    CL1
CKSTIME  DS    CL7
         ORG   CKSTIME
HLDSYR   DS    FL1
HLDSDAY  DS    FL2
HLDSTIME DS    FL4
         ORG   STARTTIM+8
@NM00066 DS    CL1
CKETIME  DS    CL7
         ORG   CKETIME
HLDEYR   DS    FL1
HLDEDAY  DS    FL2
HLDETIME DS    FL4
         ORG   STARTTIM+16
TSTIMES  DS    CL16
         ORG   TSTIMES
@NM00067 DS    CL1
TSBEG    DS    CL7
         ORG   TSBEG
TSSYR    DS    FL1
TSSDAY   DS    FL2
TSSTIME  DS    FL4
         ORG   TSTIMES+8
@NM00068 DS    CL1
TSEND    DS    CL7
         ORG   TSEND
TSEYR    DS    FL1
TSEDAY   DS    FL2
TSETIME  DS    FL4
         ORG   TSTIMES+16
         DS    CL4
DOUBLEWD DS    CL8
TODAY    DS    CL5
PARMHOLD DS    CL31
SEQOLD   DS    CL14
         ORG   SEQOLD
SOL      DS    FL1
SOV      DS    CL6
SOT      DS    CL7
         ORG   SEQOLD+14
SEQNEW   DS    CL14
         ORG   SEQNEW
SNL      DS    FL1
SNV      DS    CL6
SNT      DS    CL7
         ORG   SEQNEW+14
DATEINSW DS    BL1
FIXOUT   DS    CL13
VOL      DS    CL6
PARMERR  DS    BL1
LIBSW    DS    BL1
VOLSW    DS    BL1
TMESW    DS    BL1
FIRSTSW  DS    BL1
EOFSW    DS    BL1
VOLUME   DS    CL6
SUMARRAY DS    CL36
         ORG   SUMARRAY+0
SMSTGD   DS    FL4
SMCFAULT DS    FL4
SMDSTGD  DS    FL4
SMSALLOC DS    FL4
LOADS    DS    FL4
STGDTOT  DS    FL4
VTOCSG   DS    FL4
DSTGDTOT DS    FL4
VTOCDS   DS    FL4
         ORG   SUMARRAY+144
ICGTRVID CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00701 DC    C'               '
@CC00673 EQU   @CC00701
@CC00726 DC    C'  :  :  '
@CC00659 EQU   @CC00701
@CC00672 DC    C'TOTALS'
@CC00725 DC    C'  /   '
@CC00681 EQU   @CC00701
@CC00646 DC    C'000'
@CC00676 DC    C'S'
@CC00680 DC    C'E'
@CC00686 DC    C'N'
HDNG1    DS    CL121
         ORG   HDNG1
@NM00046 DC    CL43'1ICGTRVID'
@NM00047 DC    CL58'MSS TRACE VOLUME ACTIVITY'
@NM00048 DC    CL20'DATE YYDDD  PAGEXXXX'
         ORG   HDNG1+121
HDNG2    DS    CL121
         ORG   HDNG2
@NM00049 DC    CL1'0'
@NM00050 DC    CL40'                                        '
@NM00051 DC    CL40'       CYLINDER            SPACE   TOTAL'
@NM00052 DC    CL40'                                        '
         ORG   HDNG2+121
HDNG3    DS    CL121
         ORG   HDNG3
@NM00053 DC    CL1' '
@NM00054 DC    CL40'                         CARTRIDGE   CYL'
@NM00055 DC    CL40'INDERS FAULT    CYLINDERS  ALLOC   STAGI'
@NM00056 DC    CL40'NG   CARTG       VTOC        VTOC       '
         ORG   HDNG3+121
HDNG4    DS    CL121
         ORG   HDNG4
@NM00057 DC    CL1' '
@NM00058 DC    CL40' DATE    TIME  MSF VOLID  NUMBER     STA'
@NM00059 DC    CL40'GED    CAUSED   DESTAGED   CAUSED  ACTIV'
@NM00060 DC    CL40'ITY  LOADS STGS  STGS  DSTGS DSTGS      '
         ORG   HDNG4+121
RCDTOTAL DS    CL121
         ORG   RCDTOTAL
@NM00061 DC    CL1'1'
@NM00062 DC    CL40'T-SLICE - XXX  DATES - YYDDD-YYDDD  TIME'
@NM00063 DC    CL40'S - HHMM-HHMM  VOLUME - VVVVVV  INPUT RE'
@NM00064 DC    CL40'CORDS SELECTED - XXXXXX                 '
         ORG   RCDTOTAL+121
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '
         DS    CL2
FIXAREA  DS    CL200
         ORG   FIXAREA
@NM00069 DC    200CL1'Z'
         ORG   FIXAREA+200
ICGTRVID CSECT
*                                                         /*@Y30LB40*/
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **
               EODAD=EOF,EROPT=SKP,SYNAD=READERR
IDCBL    EQU   *-IPATDCB
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121
PDCBL    EQU   *-PPATDCB
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGTRVID CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
J        EQU   @06
I        EQU   @07
SS       EQU   @02
RETURNCD EQU   @09
TIMEWORK EQU   @03
SAVE14   EQU   @06
LINECNT  EQU   @08
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R14      EQU   @14
R15      EQU   @15
IHADCB   EQU   0
IHADCS05 EQU   0
DCBMODE  EQU   IHADCS05
DCBSTACK EQU   DCBMODE
DCBFUNC  EQU   IHADCS05+3
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00026 EQU   IHADCS40+12
DCBEROPT EQU   @NM00026
PARMVALS EQU   0
PARMLEN  EQU   PARMVALS
PARMS    EQU   PARMVALS+2
FIXADDR  EQU   0
FIXLEN   EQU   0
FIXOPT   EQU   0
*                                      START UNREFERENCED COMPONENTS
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00029 EQU   IHADCS40+16
@NM00028 EQU   @NM00026+1
@NM00027 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00025 EQU   IHADCS40+10
@NM00024 EQU   IHADCS40+9
@NM00023 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00022 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00021 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00020 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00019 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00018 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00017 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBBLKSI EQU   IHADCS36+10
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00016 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00015 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00014 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00013 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00012 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00011 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00010 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00009 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00008 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00007 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00006 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
@NM00005 EQU   DCBFUNC
DCBFNCBT EQU   DCBFUNC
DCBFNCBX EQU   DCBFUNC
DCBFNCBD EQU   DCBFUNC
DCBFNCBW EQU   DCBFUNC
DCBFNCBP EQU   DCBFUNC
DCBFNCBR EQU   DCBFUNC
DCBFNCBI EQU   DCBFUNC
@NM00004 EQU   IHADCS05+2
@NM00003 EQU   IHADCS05+1
DCBSTCK1 EQU   DCBSTACK
DCBSTCK2 EQU   DCBSTACK
@NM00002 EQU   DCBSTACK
DCBMODER EQU   DCBSTACK
DCBMODEO EQU   DCBSTACK
DCBMODEE EQU   DCBSTACK
DCBMODEC EQU   DCBSTACK
@NM00001 EQU   IHADCB
*                                      END UNREFERENCED COMPONENTS
@RT00139 EQU   PARMEND
@RT00158 EQU   PARMEND
@RT00178 EQU   PARMEND
@RF00193 EQU   @RC00191
@RF00203 EQU   @RC00201
@RT00217 EQU   PARMEND
@RT00230 EQU   PARMEND
@RT00259 EQU   PARMEND
@RT00271 EQU   PARMEND
@RT00292 EQU   RDTRACE
@RT00294 EQU   RDTRACE
@RT00297 EQU   RDTRACE
@RT00436 EQU   EOJ
@RF00483 EQU   CHECKTIM
@RT00578 EQU   EF4
EFEND    EQU   @EL00003
@RT00576 EQU   EFEND
@ENDDATA EQU   *
         END   ICGTRVID,(C'PLS2119',0603,76198)

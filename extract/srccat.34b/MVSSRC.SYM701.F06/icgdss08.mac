         TITLE 'ICGDSS08 MSC TABLE CREATE, SCAN CREATE STATEMENT       *
                        '
ICGDSS08 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSS08  77.354'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                      STRUCTURE KEYWORD     @OZ28368*/
*                                                                  0040
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/*                  ICGDSS08 (MAINLINE)                     @YD00113*/
*/*                                                          @Y30LB12*/
*/*            CALL S08INIT TO INITIALIZE, S08SCAN TO        @YD00113*/
*/*            EXTRACT KEYWORDS AND PARAMETERS FROM CONTROL  @Y30LB12*/
*/*            STATEMENT.  IF NO TERMINATING ERROR, CALL     @Y30LB12*/
*/*            S08ANAL TO CHECK FOR MISSING AND CONFLICTING  @Y30LB12*/
*/*            VALUES.  IF STILL NO ERROR, CALL S08BUILD     @Y30LB12*/
*/*            TO MOVE VALUES TO CREATE IN COMTAB.           @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0040
*   CALL S08INIT;                   /*                       @Y30LB12*/
         BAL   @14,S08INIT                                         0040
*   CALL S08SCAN;                   /*                       @Y30LB12*/
         BAL   @14,S08SCAN                                         0041
*   IF STOPSCAN^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    STOPSCAN,B'00100000'                                0042
         BO    @RF00042                                            0042
*     CALL S08ANAL;                 /*                       @Y30LB12*/
         BAL   @14,S08ANAL                                         0043
*   ELSE                                                           0044
*     ;                             /*                       @Y30LB12*/
@RF00042 DS    0H                                                  0045
*   IF STOPSCAN^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    STOPSCAN,B'00100000'                                0045
         BO    @RF00045                                            0045
*     CALL S08BUILD;                /*                       @Y30LB12*/
         BAL   @14,S08BUILD                                        0046
*   ELSE                                                           0047
*     ;                             /*                       @Y30LB12*/
@RF00045 DS    0H                                                  0048
*   RETURN;                         /* RETURN TO ICGDSSCN    @Y30LB12*/
@EL00001 L     @13,4(,@13)                                         0048
@EF00001 L     @00,@SIZDATD                                        0048
         LR    @01,@11                                             0048
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0048
         BR    @14                                                 0048
*                                                                  0049
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - S08INIT                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - INITIALIZE LOCAL WORK AREA                    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0049
*S08INIT:                                                          0049
*   PROCEDURE;                      /*                       @Y30LB12*/
S08INIT  STM   @14,@12,12(@13)                                     0049
*   CRTMSGID='00'X;                 /* CONTROL FLAGS         @YD00113*/
         MVI   CRTMSGID,X'00'                                      0050
*   WORKBITS='00'X;                 /* 'HAVE' FLAGS          @YD00113*/
         MVI   WORKBITS,X'00'                                      0051
*   TABCLOCK='00'X;                 /* REQUIRED KEYWORD      @Y30LB12*/
         MVI   TABCLOCK,X'00'                                      0052
*   WKVOLSER='      ';              /* INITIALIZE BLANK      @Y30LB12*/
*                                                                  0053
         MVC   WKVOLSER(6),@CC00394                                0053
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* INITIALIZE AS DEFAULT TABLE PAGES 1 TO 4              @YD00113*/
*   /* TO REAL PAGES 25 TO 28.                               @X50AC40*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*   DO I=1 TO 4;                    /* DEFAULT VALUES        @Y30LB12*/
         LA    I,1                                                 0054
@DL00054 DS    0H                                                  0055
*     WKPAGES(I)=I+24;              /* REAL PAGES 25-28      @X50AC40*/
         LA    @10,24                                              0055
         ALR   @10,I                                               0055
         STC   @10,WKPAGES-1(I)                                    0055
*   END;                            /*                       @Y30LB12*/
         AH    I,@CH00042                                          0056
         CH    I,@CH00068                                          0056
         BNH   @DL00054                                            0056
*   END S08INIT;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00002 DS    0H                                                  0057
@EF00002 DS    0H                                                  0057
@ER00002 LM    @14,@12,12(@13)                                     0057
         BR    @14                                                 0057
*                                                                  0058
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08SCAN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT KEYWORDS AND PARAMETERS FROM THE      @Y30LB12*/
*/*            CREATE CONTROL STATEMENT.  WHEN ALL           @Y30LB12*/
*/*            HAVE BEEN PROCESS, CHECK FOR MISSING          @Y30LB12*/
*/*            VALUES.  FOR MATCHED KEYWORDS, SET 'KNOWN'    @YD00113*/
*/*            FLAG ON AND CALL APPROPRIATE SUBROUTINE TO    @YD00113*/
*/*            EXTRACT THE PARAMETERS.  IF AN ERROR OCCURS   @YD00113*/
*/*            IN OBTAINING EITHER THE KEYWORD OR THE PARM,  @YD00113*/
*/*            ISSUE THE APPROPRIATE ERROR MESSAGE.          @YD00113*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0058
*S08SCAN:                                                          0058
*   PROCEDURE;                      /*                       @Y30LB12*/
S08SCAN  STM   @14,@12,@SA00003                                    0058
*   DO WHILE(LASTPARM='0'B);        /* TILL NO MORE DATA     @Y30LB12*/
         B     @DE00059                                            0059
@DL00059 DS    0H                                                  0060
*     KNOWN='0'B;                   /*                       @Y30LB12*/
         NI    KNOWN,B'01111111'                                   0060
*     IF TABBTFLD='0'B THEN         /* IF NEXT KEYWORD SCAN  @OZ28368
*                                      INDICATOR             @OZ28368*/
         TM    TABBTFLD,B'00000010'                                0061
         BNZ   @RF00061                                            0061
*       CALL READS99;               /* IS OFF, CALL SCAN     @OZ28368
*                                      ROUTINE, ELSE         @OZ28368*/
         BAL   @14,READS99                                         0062
*     ELSE                                                         0063
*       TABBTFLD='0'B;              /* SET OFF               @OZ28368*/
         B     @RC00061                                            0063
@RF00061 NI    TABBTFLD,B'11111101'                                0063
*     IF LASTPARM='1'B              /* SET BY ICGDSS99       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
@RC00061 TM    LASTPARM(R4),B'00001000'                            0064
         BO    @RT00064                                            0064
*       RETURN;                     /* RET. TO MAINLINE      @Y30LB12*/
*     ELSE                                                         0066
*       ;                           /*                       @Y30LB12*/
*                                                                  0066
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED VALUE WAS KEYWORD 'PAGES'                @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0067
*     IF SCANDATA(1:LENGTH(KEYPAGES))=KEYPAGES/*             @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0067
         CLC   SCANDATA(6,@10),@CC00358                            0067
         BNE   @RF00067                                            0067
         TM    KNOWN,B'10000000'                                   0067
         BNZ   @RF00067                                            0067
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0069
*         CALL S08PAGES;            /* TO GET PARAMETERS     @Y30LB12*/
         BAL   @14,S08PAGES                                        0070
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0072
*       ;                           /*                       @Y30LB12*/
*                                                                  0072
@RF00067 DS    0H                                                  0073
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED VALUE WAS KEYWORD 'VOLID'                @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0073
*     IF SCANDATA(1:LENGTH(KEYVOLID))=KEYVOLID/*             @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0073
         CLC   SCANDATA(6,@10),@CC00360                            0073
         BNE   @RF00073                                            0073
         TM    KNOWN,B'10000000'                                   0073
         BNZ   @RF00073                                            0073
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0075
*         CALL S08VOLID;            /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S08VOLID                                        0076
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0078
*       ;                           /*                       @Y30LB12*/
*                                                                  0078
@RF00073 DS    0H                                                  0079
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED DATA WAS KEYWORD 'LRUCLOCK'              @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0079
*     IF SCANDATA(1:LENGTH(KEYCLOCK))=KEYCLOCK/*             @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0079
         CLC   SCANDATA(9,@10),@CC00362                            0079
         BNE   @RF00079                                            0079
         TM    KNOWN,B'10000000'                                   0079
         BNZ   @RF00079                                            0079
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0081
*         CALL S08CLOCK;            /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S08CLOCK                                        0082
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0084
*       ;                           /*                       @Y30LB12*/
*                                                                  0084
@RF00079 DS    0H                                                  0085
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @G24LB42*/
*     /* IF SCANNED DATA WAS KEYWORD 'CYLFAULT'              @G24LB42*/
*     /* ***********************************************     @G24LB42*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0085
*     IF SCANDATA(1:LENGTH(KEYCYLFL))=KEYCYLFL/*             @G24LB42*/
*         &KNOWN='0'B               /*                       @G24LB42*/
*       THEN                        /*                       @G24LB42*/
         L     @10,STARTCOL(,R4)                                   0085
         CLC   SCANDATA(9,@10),@CC00365                            0085
         BNE   @RF00085                                            0085
         TM    KNOWN,B'10000000'                                   0085
         BNZ   @RF00085                                            0085
*       DO;                         /*                       @G24LB42*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @G24LB42*/
         OI    KNOWN,B'10000000'                                   0087
*         CALL S08CYLFL;            /* TO GET PARAMETER      @G24LB42*/
         BAL   @14,S08CYLFL                                        0088
*       END;                        /*                       @G24LB42*/
*     ELSE                                                         0090
*       ;                           /*                       @G24LB42*/
*                                                                  0090
@RF00085 DS    0H                                                  0091
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED VALUE IS PARAMETER 'NEW'                 @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0091
*     IF SCANDATA(1:LENGTH(PARMNEW))=PARMNEW/*               @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0091
         CLC   SCANDATA(3,@10),@CC00370                            0091
         BNE   @RF00091                                            0091
         TM    KNOWN,B'10000000'                                   0091
         BNZ   @RF00091                                            0091
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED PARM       @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0093
*         CALL S08NEW;              /* TO HANDLE PARM        @Y30LB12*/
         BAL   @14,S08NEW                                          0094
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0096
*       ;                           /*                       @Y30LB12*/
*                                                                  0096
@RF00091 DS    0H                                                  0097
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED VALUE IS PARAMETER 'UPDATE'              @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0097
*     IF SCANDATA(1:LENGTH(PARMUPDT))=PARMUPDT/*             @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0097
         CLC   SCANDATA(6,@10),@CC00372                            0097
         BNE   @RF00097                                            0097
         TM    KNOWN,B'10000000'                                   0097
         BNZ   @RF00097                                            0097
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED PARM       @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0099
*         CALL S08UPDAT;            /* TO HANDLE PARM        @Y30LB12*/
         BAL   @14,S08UPDAT                                        0100
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0102
*       ;                           /*                       @Y30LB12*/
*                                                                  0102
@RF00097 DS    0H                                                  0103
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF SCANNED VALUE IS PARAMETER 'PRNTONLY'            @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0103
*     IF SCANDATA(1:LENGTH(PARMPRNT))=PARMPRNT/*             @YD00113*/
*         &KNOWN='0'B               /*                       @YM32167*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0103
         CLC   SCANDATA(8,@10),@CC00374                            0103
         BNE   @RF00103                                            0103
         TM    KNOWN,B'10000000'                                   0103
         BNZ   @RF00103                                            0103
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED PARM       @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0105
*         CALL S08PONLY;            /* TO HANDLE PARM        @Y30LB12*/
         BAL   @14,S08PONLY                                        0106
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0108
*       ;                           /*                       @Y30LB12*/
*                                                                  0108
@RF00103 DS    0H                                                  0109
*     /***************************************************************/
*     /*                                                             */
*     /* IF SCANNED VALUE IS PARAMETER 'TABPTH'              @OZ28368*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0109
*     IF SCANDATA(1:LENGTH(TABLEPTH))/* CHECK THE SCAN       @OZ28368*/
*         =TABLEPTH&KNOWN='0'B THEN /* ELEMENT, IS THIS      @OZ28368
*                                      KEYWORD 'TABPTH='?    @OZ28368
*                                      IF IT IS THEN SET..   @OZ28368*/
         L     @10,STARTCOL(,R4)                                   0109
         CLC   SCANDATA(7,@10),@CC00368                            0109
         BNE   @RF00109                                            0109
         TM    KNOWN,B'10000000'                                   0109
         BNZ   @RF00109                                            0109
*       DO;                         /*                       @OZ28368*/
*         KNOWN='1'B;               /* KNOWN KEYWORD FLAG    @OZ28368
*                                      ON,                   @OZ28368*/
         OI    KNOWN,B'10000000'                                   0111
*         CALL S08TBPTH;            /* CALL THE TABLE PATH   @OZ28368
*                                      PROC.                 @OZ28368*/
         BAL   @14,S08TBPTH                                        0112
*       END;                        /*                       @OZ28368*/
*     ELSE                                                         0114
*       ;                           /*                       @OZ28368*/
*                                                                  0114
@RF00109 DS    0H                                                  0115
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @YD00113*/
*     /* IF VALUE WAS NONE OF THE ABOVE                      @Y30LB12*/
*     /* ***********************************************     @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0115
*     IF KNOWN='0'B                 /* NO RECOGNITION        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN,B'10000000'                                   0115
         BNZ   @RF00115                                            0115
*       DO;                         /*                       @Y30LB12*/
*         IF KEYBIT='1'B            /* IF KEYWORD            @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         TM    KEYBIT(R4),B'01000000'                              0117
         BNO   @RF00117                                            0117
*           DO;                     /*                       @Y30LB12*/
*                                                                  0118
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @YD00113*/
*             /* ICG210I UNDEFINED KEYWORD FOUND             @Y30LB12*/
*             /* ***********************************         @YD00113*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0119
*             MSGNO=ICG210I;        /* ID FOR ICGDS210       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG210I                                 0119
*             CALL PUTIT2;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0120
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0122
*           ;                       /*                       @Y30LB12*/
@RF00117 DS    0H                                                  0123
*         IF PARMBIT='1'B           /* IF PARAMETER BIT      @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         TM    PARMBIT(R4),B'00100000'                             0123
         BNO   @RF00123                                            0123
*           DO;                     /*                       @Y30LB12*/
*                                                                  0124
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @YD00113*/
*             /* ICG212I UNDEFINED PARAMETER                 @Y30LB12*/
*             /* FOUND                                       @Y30LB12*/
*             /* ***********************************         @YD00113*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0125
*             MSGNO=ICG212I;        /* ID FOR ICGDS212       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG212I                                 0125
*             CALL PUTIT2;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0126
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0128
*           ;                       /*                       @Y30LB12*/
@RF00123 DS    0H                                                  0129
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0130
*       ;                           /*                       @Y30LB12*/
@RF00115 DS    0H                                                  0131
*   END;                            /* LASTPARM = 1          @Y30LB12*/
@DE00059 TM    LASTPARM(R4),B'00001000'                            0131
         BZ    @DL00059                                            0131
*   END S08SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00003 DS    0H                                                  0132
@EF00003 DS    0H                                                  0132
@ER00003 LM    @14,@12,@SA00003                                    0132
         BR    @14                                                 0132
*                                                                  0133
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08NEW                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SET BIT INDICATING FIRST CREATION OF TABLES   @Y30LB12*/
*/*            IN LOCAL WORK AREA IF NO ERROR.  IF ERROR,    @Y30LB12*/
*/*            WRITE MESSAGE ICGDS214.                       @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0133
*S08NEW:                                                           0133
*   PROCEDURE;                      /*                       @Y30LB12*/
S08NEW   STM   @14,@12,@SA00004                                    0133
*   IF SCANLEN=LENGTH(PARMNEW)      /* SET BY ICGDSS99       @YD00113*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00048                              0134
         BNE   @RF00134                                            0134
*     NEWBIT='1'B;                  /* IN LOCAL WORKAREA     @Y30LB12*/
         OI    NEWBIT,B'10000000'                                  0135
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0136
         B     @RC00134                                            0136
@RF00134 DS    0H                                                  0137
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG214I PROBABLE MISSPELLED                       @Y30LB12*/
*       /* PARAMETER NEW                                     @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0137
*       OUTBUF2(1:39)=ICGDS214;     /*                       @Y30LB12*/
         MVC   OUTBUF2(39,R4),ICGDS214                             0137
*       OUTBUF2(40:40+LENGTH(PARMNEW))=PARMNEW;/*            @YD00113*/
         MVI   OUTBUF2+42(R4),C' '                                 0138
         MVC   OUTBUF2+39(3,R4),@CC00370                           0138
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0139
*     END;                          /*                       @Y30LB12*/
*   END S08NEW;                     /* RET. TO S08SCAN       @Y30LB12*/
@EL00004 DS    0H                                                  0141
@EF00004 DS    0H                                                  0141
@ER00004 LM    @14,@12,@SA00004                                    0141
         BR    @14                                                 0141
*                                                                  0142
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08UPDAT                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SET BIT IN LOCAL WORK AREA INDICATING THAT    @Y30LB12*/
*/*            THE TABLES ARE TO BE REBUILT IF NO ERROR.  IF @Y30LB12*/
*/*            ERROR, WRITE MESSAGE ICGDS214.                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0142
*S08UPDAT:                                                         0142
*   PROCEDURE;                      /*                       @Y30LB12*/
S08UPDAT STM   @14,@12,@SA00005                                    0142
*   IF SCANLEN=LENGTH(PARMUPDT)     /* SET BY ICGDSS99       @YD00113*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00227                              0143
         BNE   @RF00143                                            0143
*     UPDBIT='1'B;                  /* IN LOCAL WORKAREA     @Y30LB12*/
         OI    UPDBIT,B'01000000'                                  0144
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0145
         B     @RC00143                                            0145
@RF00143 DS    0H                                                  0146
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG214I PROBABLE MISSPELLED                       @Y30LB12*/
*       /* PARAMETER UPDATE                                  @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0146
*       OUTBUF2(1:39)=ICGDS214;     /*                       @Y30LB12*/
         MVC   OUTBUF2(39,R4),ICGDS214                             0146
*       OUTBUF2(40:40+LENGTH(PARMUPDT))=PARMUPDT;/*          @YD00113*/
         MVI   OUTBUF2+45(R4),C' '                                 0147
         MVC   OUTBUF2+39(6,R4),@CC00372                           0147
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0148
*     END;                          /*                       @Y30LB12*/
*   END S08UPDAT;                   /* RETURN TO S08SCAN     @Y30LB12*/
@EL00005 DS    0H                                                  0150
@EF00005 DS    0H                                                  0150
@ER00005 LM    @14,@12,@SA00005                                    0150
         BR    @14                                                 0150
*                                                                  0151
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08PONLY                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SET A BIT INDICATING THAT TABLES ARE NOT TO   @Y30LB12*/
*/*            BE WRITTEN TO DASD.  ALL PRINTED REPORTS      @Y30LB12*/
*/*            AND PUNCHED OUTPUT WILL STILL BE PRODUCED.    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0151
*S08PONLY:                                                         0151
*   PROCEDURE;                      /*                       @Y30LB12*/
S08PONLY STM   @14,@12,@SA00006                                    0151
*   IF SCANLEN=LENGTH(PARMPRNT)     /* SET BY ICGDSS99       @YD00113*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00040                              0152
         BNE   @RF00152                                            0152
*     PRNTBIT='1'B;                 /* IN LOCAL WORKAREA     @Y30LB12*/
         OI    PRNTBIT,B'00100000'                                 0153
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0154
         B     @RC00152                                            0154
@RF00152 DS    0H                                                  0155
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG214I PROBABLE MISSPELLED                       @Y30LB12*/
*       /* PARAMETER PRNTONLY                                @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0155
*       OUTBUF2(1:39)=ICGDS214;     /*                       @Y30LB12*/
         MVC   OUTBUF2(39,R4),ICGDS214                             0155
*       OUTBUF2(40:40+LENGTH(PARMPRNT))=PARMPRNT;/*          @YD00113*/
         MVI   OUTBUF2+47(R4),C' '                                 0156
         MVC   OUTBUF2+39(8,R4),@CC00374                           0156
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0157
*     END;                          /*                       @Y30LB12*/
*   END S08PONLY;                   /* RETURN TO S08SCAN     @Y30LB12*/
@EL00006 DS    0H                                                  0159
@EF00006 DS    0H                                                  0159
@ER00006 LM    @14,@12,@SA00006                                    0159
         BR    @14                                                 0159
*                                                                  0160
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08PAGES                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - PRINT MESSAGE EXPLAINING THAT THE PARAMETER   @X50AC40*/
*/*            PAGES IS NO LONGER SUPPORTED AND WILL         @X50AC40*/
*/*            CAUSE A TERMINATION.                          @X50AC40*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0160
*S08PAGES:                                                         0160
*   PROCEDURE;                      /*                       @Y30LB12*/
*                                                                  0160
S08PAGES STM   @14,@12,@SA00007                                    0160
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT NO LONGER SUPPORTED MESSAGE AND RETURN.         @X50AC40*/
*   /* ICG222I NO LONGER SUPPORT KEYWORD PAGES.              @X50AC40*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0161
*   OUTBUF2(1:35)=ICGDS222;         /*                       @X50AC40*/
         MVC   OUTBUF2(35,R4),ICGDS222                             0161
*   OUTBUF2(36:36+LENGTH(MSGPAGES))=MSGPAGES;/*              @X50AC40*/
         MVI   OUTBUF2+40(R4),C' '                                 0162
         MVC   OUTBUF2+35(5,R4),@CC00376                           0162
*   CALL PUTIT1;                    /* TO MESSAGE WRITER     @X50AC40*/
         BAL   @14,PUTIT1                                          0163
*   END S08PAGES;                   /* RETURN TO S08SCAN     @X50AC40*/
@EL00007 DS    0H                                                  0164
@EF00007 DS    0H                                                  0164
@ER00007 LM    @14,@12,@SA00007                                    0164
         BR    @14                                                 0164
*                                                                  0165
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08VOLID                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT THE VOLUME SERIAL NUMBER OF THE       @Y30LB12*/
*/*            PACK ON WHICH THE NEW MSC TABLES ARE TO       @YD00113*/
*/*            RESIDE.   THE VOLUME SERIAL NUMBER OF THE     @YD00113*/
*/*            TABLES PACK IS USED TO CONTROL THE VOLUME     @Y30LB12*/
*/*            SERIAL NUMBER OF ALL STAGING PACKS USED WITH  @Y30LB12*/
*/*            THIS COPY OF THE TABLES PACK.  ALL STAGING    @Y30LB12*/
*/*            VOLSERS MUST MATCH THE FIRST FOUR CHARACTERS  @Y30LB12*/
*/*            OF THE TABLES PACK VOLSER, AND THE FINAL TWO  @Y30LB12*/
*/*            CHARACTERS MUST BE THE CHARACTER              @Y30LB12*/
*/*            REPRESENTATION OF THE TWO LOW-ORDER HEX       @Y30LB12*/
*/*            DIGITS OF SSID (SUB-SYSTEM IDENTIFICATION).   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0165
*S08VOLID:                                                         0165
*   PROCEDURE;                      /*                       @Y30LB12*/
*                                                                  0165
S08VOLID STM   @14,@12,@SA00008                                    0165
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* CALL 'READS99' TO GET VOLID. THEN TEST FOR            @YD00113*/
*   /* DUPLICATION OF KEYWORD 'VOLID'. IF 'VOLID' HAS        @YD00113*/
*   /* BEEN PREVIOUSLY USED, SET FLAG 'HAVVOLID'.            @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0166
*   CALL READS99;                   /*                       @Y30LB12*/
         BAL   @14,READS99                                         0166
*   IF HAVVOLID^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVVOLID,B'00000100'                                0167
         BO    @RF00167                                            0167
*     HAVVOLID='1'B;                /*                       @Y30LB12*/
         OI    HAVVOLID,B'00000100'                                0168
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0169
         B     @RC00167                                            0169
@RF00167 DS    0H                                                  0170
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG219I DUPLICATE KEYWORD VOLID                   @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0170
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0170
*       OUTBUF2(28:28+LENGTH(MSGVOLID))=MSGVOLID;/*          @YD00113*/
         MVI   OUTBUF2+32(R4),C' '                                 0171
         MVC   OUTBUF2+27(5,R4),@CC00378                           0171
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0172
*       RETURN;                     /* RETURN TO S08SCAN     @Y30LB12*/
@EL00008 DS    0H                                                  0173
@EF00008 DS    0H                                                  0173
@ER00008 LM    @14,@12,@SA00008                                    0173
         BR    @14                                                 0173
*     END;                          /*                       @Y30LB12*/
*                                                                  0174
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YM31099*/
*   /* ICG211I EXPECTED, BUT DID NOT FIND,                   @YM31099*/
*   /* PARAMETER                                             @YM31099*/
*   /* ***********************************************       @YM31099*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   IF PARMBIT^='1'B                /*                       @YM31099*/
*     THEN                          /*                       @YM31099*/
@RC00167 TM    PARMBIT(R4),B'00100000'                             0175
         BO    @RF00175                                            0175
*     DO;                           /*                       @YM31099*/
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @YM31099*/
         MVC   MSGNO(2,R4),ICG211I                                 0177
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @YM31099*/
         BAL   @14,PUTIT2                                          0178
*       RETURN;                     /* RETURN TO S08SCAN     @YM31099*/
         B     @EL00008                                            0179
*     END;                          /*                       @YM31099*/
*   ELSE                                                           0181
*     ;                             /*                       @YM31099*/
*                                                                  0181
@RF00175 DS    0H                                                  0182
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* TEST LENGTH OF VOLID RETURNED. ISSUE MESSAGE          @YD00113*/
*   /* IF LENGTH IS INCORRECT                                @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0182
*   IF SCANLEN^=LENGTH(KEYVOLID)    /* SET BY ICGDSS99       @YD00113*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00227                              0182
         BE    @RF00182                                            0182
*     DO;                           /*                       @Y30LB12*/
*                                                                  0183
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/
*       /* KEYWORD IS VOLID                                  @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0184
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0184
*       OUTBUF2(47:47+LENGTH(MSGVOLID))=MSGVOLID;/*          @YD00113*/
         MVI   OUTBUF2+51(R4),C' '                                 0185
         MVC   OUTBUF2+46(5,R4),@CC00378                           0185
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0186
*       RETURN;                     /* RETURN TO S08SCAN     @Y30LB12*/
         B     @EL00008                                            0187
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0189
*     ;                             /*                       @Y30LB12*/
*                                                                  0189
@RF00182 DS    0H                                                  0190
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* TEST LAST 2 BYTES OF VOLID FOR 'F0F0'X. IF NOT        @YD00113*/
*   /* ISSUE ERROR MESSAGE ICG223I.                          @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0190
*   IF SCANDATA(5:6)^='F0F0'X       /* MUST BE '00'          @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0190
         CLC   SCANDATA+4(2,@10),@CB00430                          0190
         BE    @RF00190                                            0190
*     DO;                           /*                       @Y30LB12*/
*                                                                  0191
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG223I VALUE ERROR FOR VOLID                     @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0192
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0192
*       OUTBUF2(26:26+LENGTH(MSGVOLID))=MSGVOLID;/*          @YD00113*/
         MVI   OUTBUF2+30(R4),C' '                                 0193
         MVC   OUTBUF2+25(5,R4),@CC00378                           0193
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0194
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     WKVOLSER=SCANDATA(1:6);       /* SAVE VOLID            @Y30LB12*/
         B     @RC00190                                            0196
@RF00190 L     @10,STARTCOL(,R4)                                   0196
         MVC   WKVOLSER(6),SCANDATA(@10)                           0196
*   END S08VOLID;                   /* RETURN TO S08SCAN     @Y30LB12*/
         B     @EL00008                                            0197
*                                                                  0198
*/********************************************************** @OZ28368*/
*/*                                                          @OZ28368*/
*/* PROCEDURE NAME - S08TBPTH                                @OZ28368*/
*/*                                                          @OZ28368*/
*/* FUNCTION - CALLS 'READS99' TO GET TABLE PATH PARAMETER,  @OZ28368*/
*/*            CHECKS TABLE PATH PARAMETER AND SETS CREATE   @OZ28368*/
*/*            FIELD IN COMTAB TO INDICATE THAT USER         @OZ28368*/
*/*            SPECIFICATION OF B, B OR C, OR B, C, AND D    @OZ28368*/
*/*            CHANNEL INTERFACE. SPECIFICATION IN THE UPPER @OZ28368*/
*/*            CON STATEMENT WILL BE REQUIRED FOR REAL       @OZ28368*/
*/*            DEVICE ADDRESSES 0, 1, 8, AND 9 IF I/O DEVICE @OZ28368*/
*/*            CARDS ARE TO BE GENERATED FOR THESE DEVICES   @OZ28368*/
*/*            FOR TABLE ACCESS.                             @OZ28368*/
*/*                                                          @OZ28368*/
*/*            ERROR MESSAGE FOR BD OR CD SPECIFICATION.     @OZ28368*/
*/*                                                          @OZ28368*/
*/*            ERROR MESSAGE FOR DUPLICATE KEYWORDS.         @OZ28368*/
*/*                                                          @OZ28368*/
*/********************************************************** @OZ28368*/
*                                                                  0198
*S08TBPTH:                                                         0198
*   PROCEDURE;                      /*                       @OZ28368*/
S08TBPTH STM   @14,@12,@SA00009                                    0198
*/********************************************************** @OZ28368*/
*/* CHECK FOR PREVIOUS SPECIFICATION OF TABLE PATH KEYWORD,  @OZ28368*/
*/* IF PREVIOUS SPECIFICATION, SET UP PRINT BUFFER AND CALL  @OZ28368*/
*/* ERROR MESSAGE SETUP ROUTINE FOR TERMINATION.             @OZ28368*/
*/* IF NO PREVIOUS SPECIFICATION, THEN CONTINUE PROCESSING.  @OZ28368*/
*/********************************************************** @OZ28368*/
*                                                                  0199
*   IF BINT='1'BCINT='1'BDINT='1'B THEN                          0199
         TM    BINT,B'00011100'                                    0199
         BZ    @RF00199                                            0199
*     DO;                           /* CHECK FOR PREVIOUS    @OZ28368
*                                      SPECIFICATION         @OZ28368*/
*                                                                  0200
*       /*************************************************************/
*       /*                                                           */
*       /* MULTIPLE TABPTH KEYWORD SPECIFICATION..TERM.      @OZ28368*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0201
*       OUTBUF2(1:27)=ICGDS219;     /* DUP KEYWORD TABPTH    @OZ28368*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0201
*       OUTBUF2(28:28+LENGTH(MSGTABLE))=MSGTABLE;/*          @OZ28368*/
         MVI   OUTBUF2+33(R4),C' '                                 0202
         MVC   OUTBUF2+27(6,R4),@CC00384                           0202
*       CALL PUTIT1;                /* CALL ERROR MESSAGE    @OZ28368
*                                      ROUTINE               @OZ28368*/
         BAL   @14,PUTIT1                                          0203
*     END;                          /*                       @OZ28368*/
*   ELSE                            /*                       @OZ28368*/
*     DO;                           /*                       @OZ28368*/
         B     @RC00199                                            0205
@RF00199 DS    0H                                                  0206
*       CALL READS99;               /* SCAN...LOOK FOR FIRST @OZ28368
*                                      OPERAND..             @OZ28368*/
         BAL   @14,READS99                                         0206
*       IF SCANLEN^=1 THEN          /* IS THE LENGTH CORRECT @OZ28368*/
         CLC   SCANLEN(2,R4),@CH00042                              0207
         BE    @RF00207                                            0207
*         DO;                       /* FOR TABLE PATH        @OZ28368
*                                      OPERAND?              @OZ28368*/
*                                                                  0208
*           /*********************************************************/
*           /*                                                       */
*           /* TABPTH SPECIFIED, BUT NO OPERANDS..TERMINATE  @OZ28368*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0209
*           OUTBUF2(1:39)=ICGDS214; /* SPECIFICATION ERROR   @OZ28368*/
         MVC   OUTBUF2(39,R4),ICGDS214                             0209
*           OUTBUF2(40:40+LENGTH(MSGTABLE))=MSGTABLE;/* MSG KEYWORD
*                                                            @OZ28368*/
         MVI   OUTBUF2+45(R4),C' '                                 0210
         MVC   OUTBUF2+39(6,R4),@CC00384                           0210
*           CALL PUTIT1;            /* IS TABPTH. CALL ERROR @OZ28368
*                                      ROUTINE               @OZ28368*/
         BAL   @14,PUTIT1                                          0211
*         END;                      /*                       @OZ28368*/
*       ELSE                        /*                       @OZ28368*/
*         DO;                       /*                       @OZ28368*/
         B     @RC00207                                            0213
@RF00207 DS    0H                                                  0214
*           TABBTFLD='1'B;          /*                       @OZ28368*/
         OI    TABBTFLD,B'00000010'                                0214
*           CALL OPCHK;             /* CALL INTERNAL         @OZ28368
*                                      OPERAND CHECK         @OZ28368*/
         BAL   @14,OPCHK                                           0215
*           CALL READS99;           /* CALL SCAN ROUTINE     @OZ28368
*                                      FOR NEXT OP.          @OZ28368*/
         BAL   @14,READS99                                         0216
*           IF SCANLEN^=1 THEN      /* IS THIS TABLE PATH    @OZ28368
*                                      KEYWORD VALID LENGTH? @OZ28368*/
         CLC   SCANLEN(2,R4),@CH00042                              0217
         BE    @RF00217                                            0217
*             DO;                   /*                       @OZ28368*/
*               IF CINT='1'BDINT='1'B THEN/* IS THE C OR D INTER  0219
*                                                            @OZ28368*/
         TM    CINT,B'00001100'                                    0219
         BZ    @RF00219                                            0219
*                 DO;               /* FACE INDICATOR ON?    @OZ28368*/
*                                                                  0220
*                   /*************************************************/
*                   /*                                               */
*                   /* NOT ENOUGH OPERANDS FOR VALID BC OR BCD SPEC  */
*                   /*                                       @OZ28368*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0221
*                   MSGNO=ICG211I;  /* IF IT IS THEN USER    @OZ28368*/
         MVC   MSGNO(2,R4),ICG211I                                 0221
*                   CALL PUTIT2;    /* INCORRECTLY SPECIFIED @OZ28368
*                                      OPERAND STRING, WRITE @OZ28368
*                                      ERROR MSG AND         @OZ28368
*                                      TERMINATE             @OZ28368*/
         BAL   @14,PUTIT2                                          0222
*                 END;              /*                       @OZ28368*/
*               ELSE                                               0224
*                 ;                 /* NO ERROR, NEW KEYWORD @OZ28368*/
@RF00219 DS    0H                                                  0225
*             END;                  /*                       @OZ28368*/
*           ELSE                    /*                       @OZ28368*/
*             DO;                   /*                       @OZ28368*/
         B     @RC00217                                            0226
@RF00217 DS    0H                                                  0227
*               TABBTFLD='1'B;      /*                       @OZ28368*/
         OI    TABBTFLD,B'00000010'                                0227
*               CALL OPCHK;         /* CALL INTERNAL OPERAND @OZ28368
*                                      CHECK                 @OZ28368*/
         BAL   @14,OPCHK                                           0228
*               CALL READS99;       /* CALL SCAN ROUTINE FOR @OZ28368
*                                      NEXT OP.              @OZ28368*/
         BAL   @14,READS99                                         0229
*               IF SCANLEN^=1 THEN  /*                       @OZ28368*/
         CLC   SCANLEN(2,R4),@CH00042                              0230
         BE    @RF00230                                            0230
*                 DO;               /*                       @OZ28368*/
*                   IF DINT='1'B THEN/* IS THE D INTERFACE   @OZ28368
*                                      INDICATOR ON?         @OZ28368*/
         TM    DINT,B'00000100'                                    0232
         BNO   @RF00232                                            0232
*                     DO;           /*                       @OZ28368*/
*                                                                  0233
*                       /*********************************************/
*                       /*                                           */
*                       /* NOT ENOUGH OPERANDS SPECIFIED FOR VALID   */
*                       /* BCD SPEC.                         @OZ28368*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0234
*                       MSGNO=ICG211I;/* IF IT IS THEN USER  @OZ28368*/
         MVC   MSGNO(2,R4),ICG211I                                 0234
*                       CALL PUTIT2;/* INCORRECTLY SPECIFIED @OZ28368
*                                      OPERAND STRING, WRITE @OZ28368
*                                      ERROR MSG AND         @OZ28368
*                                      TERMINATE             @OZ28368*/
         BAL   @14,PUTIT2                                          0235
*                     END;          /*                       @OZ28368*/
*                   ELSE                                           0237
*                     ;             /* NO ERROR, NEW KEYWORD @OZ28368*/
@RF00232 DS    0H                                                  0238
*                 END;              /*                       @OZ28368*/
*               ELSE                /*                       @OZ28368*/
*                 DO;               /*                       @OZ28368*/
         B     @RC00230                                            0239
@RF00230 DS    0H                                                  0240
*                   TABBTFLD='1'B;  /*                       @OZ28368*/
         OI    TABBTFLD,B'00000010'                                0240
*                   CALL OPCHK;     /* CALL INTERNAL OPERAND @OZ28368*/
         BAL   @14,OPCHK                                           0241
*                   CALL READS99;   /* SCAN FOR NEXT KEYWORD @OZ28368
*                                      CHECK                 @OZ28368*/
         BAL   @14,READS99                                         0242
*                 END;              /*                       @OZ28368*/
*             END;                  /*                       @OZ28368*/
*         END;                      /*                       @OZ28368*/
*     END;                          /*                       @OZ28368*/
*   END S08TBPTH;                   /* END OF TABLE PATH     @OZ28368
*                                      KEYWORD/OPERAND SCAN  @OZ28368
*                                      ROUTINE               @OZ28368*/
@EL00009 DS    0H                                                  0247
@EF00009 DS    0H                                                  0247
@ER00009 LM    @14,@12,@SA00009                                    0247
         BR    @14                                                 0247
*                                                                  0248
*/********************************************************** @OZ28368*/
*/*                                                          @OZ28368*/
*/* PROCEDURE NAME - OPCHK                                   @OZ28368*/
*/*                                                          @OZ28368*/
*/* FUNCTION - CHECKS TABLE PATH OPERAND SPECIFICATION FOR   @OZ28368*/
*/*            B, BC, OR BCD PATHS, SETS CREATE FIELD OF     @OZ28368*/
*/*            COMTAB FOR LATER BUILD FUNCTION OF TABLE      @OZ28368*/
*/*            CREATE.                                       @OZ28368*/
*/*                                                          @OZ28368*/
*/********************************************************** @OZ28368*/
*                                                                  0248
*OPCHK:                                                            0248
*   PROCEDURE;                      /*                       @OZ28368*/
OPCHK    STM   @14,@12,@SA00010                                    0248
*   IF SCANDATA(1:1)='B' THEN       /* IS THE OPERAND VALUE  @OZ28368
*                                      A 'B'?                @OZ28368*/
         L     @10,STARTCOL(,R4)                                   0249
         CLI   SCANDATA(@10),C'B'                                  0249
         BNE   @RF00249                                            0249
*     DO;                           /*                       @OZ28368*/
*       IF BINT='1'B THEN           /* IF A 'B' THEN IS THE  @OZ28368*/
         TM    BINT,B'00010000'                                    0251
         BNO   @RF00251                                            0251
*         DO;                       /* WORK BIT 'ON'?        @OZ28368*/
*                                                                  0252
*           /*********************************************************/
*           /*                                                       */
*           /* SET 'B' INTERFACE INDICATOR TWICE..TERMINATE. @OZ28368*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0253
*           OUTBUF2(1:25)=ICGDS223; /* VALUE ERROR FOR PATH  @OZ28368
*                                      OPERAND               @OZ28368*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0253
*           OUTBUF2(26:26+LENGTH(MSGTABLE))=MSGTABLE;/* TABLE      0254
*                                                            @OZ28368
*                                      PATH KEY              @OZ28368*/
         MVI   OUTBUF2+31(R4),C' '                                 0254
         MVC   OUTBUF2+25(6,R4),@CC00384                           0254
*           CALL PUTIT1;            /* CALL ERROR ROUTINE..  @OZ28368
*                                      TERMINATE             @OZ28368*/
         BAL   @14,PUTIT1                                          0255
*         END;                      /*                       @OZ28368*/
*       ELSE                                                       0257
*         BINT='1'B;                /* ELSE SET B INTERFACE  @OZ28368
*                                      INDICATOR             @OZ28368*/
         B     @RC00251                                            0257
@RF00251 OI    BINT,B'00010000'                                    0257
*     END;                          /*                       @OZ28368*/
*   ELSE                                                           0259
*     DO;                           /* NOT THE B INDICATOR   @OZ28368*/
         B     @RC00249                                            0259
@RF00249 DS    0H                                                  0260
*       IF SCANDATA(1:1)='C' THEN   /* IS THIS OPERAND THE   @OZ28368
*                                      'C' INDICATOR?        @OZ28368*/
         L     @10,STARTCOL(,R4)                                   0260
         CLI   SCANDATA(@10),C'C'                                  0260
         BNE   @RF00260                                            0260
*         DO;                       /*                       @OZ28368*/
*                                                                  0261
*           /*********************************************************/
*           /*                                                       */
*           /* IS THE OPERAND SPECIFIED A 'C'?               @OZ28368*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0262
*           IF CINT='1'B THEN       /* IF INT. FLG ON..      @OZ28368*/
         TM    CINT,B'00001000'                                    0262
         BNO   @RF00262                                            0262
*             DO;                   /* THEN ERROR..          @OZ28368*/
*                                                                  0263
*               /*****************************************************/
*               /*                                                   */
*               /* MULTIPLE 'C' INTERFACE SPECIFICATION..TERMINATE   */
*               /*                                           @OZ28368*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0264
*               OUTBUF2(1:25)=ICGDS223;/* YES, SO WRITE SPEC @OZ28368*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0264
*               OUTBUF2(26:26+LENGTH(MSGTABLE))=MSGTABLE;/*  @OZ28368*/
         MVI   OUTBUF2+31(R4),C' '                                 0265
         MVC   OUTBUF2+25(6,R4),@CC00384                           0265
*               CALL PUTIT1;        /* WRITE ERROR MESSAGE.. @OZ28368
*                                      TERMINATE             @OZ28368*/
         BAL   @14,PUTIT1                                          0266
*             END;                  /*                       @OZ28368*/
*           ELSE                                                   0268
*             CINT='1'B;            /* SET C INTERFACE       @OZ28368
*                                      INDICATOR 'ON'        @OZ28368*/
         B     @RC00262                                            0268
@RF00262 OI    CINT,B'00001000'                                    0268
*         END;                      /*                       @OZ28368*/
*       ELSE                                                       0270
*         DO;                       /*                       @OZ28368*/
*                                                                  0270
         B     @RC00260                                            0270
@RF00260 DS    0H                                                  0271
*           /*********************************************************/
*           /*                                                       */
*           /* IS THE OPERAND SPECIFIED...                   @OZ28368*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0271
*           IF SCANDATA(1:1)='D' THEN/* IS THIS OPERAND THE  @OZ28368*/
         L     @10,STARTCOL(,R4)                                   0271
         CLI   SCANDATA(@10),C'D'                                  0271
         BNE   @RF00271                                            0271
*             DO;                   /* 'D' INDICATOR         @OZ28368*/
*                                                                  0272
*               /*****************************************************/
*               /*                                                   */
*               /* A 'D'?                                    @OZ28368*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0273
*               IF DINT='1'B THEN   /* IS THE D INTERFACE    @OZ28368*/
         TM    DINT,B'00000100'                                    0273
         BNO   @RF00273                                            0273
*                 DO;               /* WORK BIT 'ON'?        @OZ28368*/
*                                                                  0274
*                   /*************************************************/
*                   /*                                               */
*                   /* SET 'D' INTERFACE INDICATOR TWICE..TERMINATE. */
*                   /*                                       @OZ28368*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0275
*                   OUTBUF2(1:25)=ICGDS223;/* SET SPEC ERROR MSG   0275
*                                                            @OZ28368*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0275
*                   OUTBUF2(26:26+LENGTH(MSGTABLE))=MSGTABLE;/*    0276
*                                                            @OZ28368*/
         MVI   OUTBUF2+31(R4),C' '                                 0276
         MVC   OUTBUF2+25(6,R4),@CC00384                           0276
*                   CALL PUTIT1;    /* WRITE ERROR MESSAGE   @OZ28368
*                                      ...TERMINATE          @OZ28368*/
         BAL   @14,PUTIT1                                          0277
*                 END;              /*                       @OZ28368*/
*               ELSE                                               0279
*                 DINT='1'B;        /* SET D INTERFACE       @OZ28368
*                                      INDICATOR 'ON'        @OZ28368*/
         B     @RC00273                                            0279
@RF00273 OI    DINT,B'00000100'                                    0279
*             END;                  /*                       @OZ28368*/
*           ELSE                                                   0281
*             DO;                   /*                       @OZ28368*/
*                                                                  0281
         B     @RC00271                                            0281
@RF00271 DS    0H                                                  0282
*               /*****************************************************/
*               /*                                                   */
*               /* ELSE INVALID CHARACTER                    @OZ28368*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0282
*               OUTBUF2(1:25)=ICGDS223;/*                    @OZ28368*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0282
*               OUTBUF2(26:26+LENGTH(MSGTABLE))=MSGTABLE;/*  @OZ28368*/
         MVI   OUTBUF2+31(R4),C' '                                 0283
         MVC   OUTBUF2+25(6,R4),@CC00384                           0283
*               CALL PUTIT1;        /*                       @OZ28368*/
         BAL   @14,PUTIT1                                          0284
*             END;                  /*                       @OZ28368*/
*         END;                      /*                       @OZ28368*/
*     END;                          /*                       @OZ28368*/
*   END OPCHK;                      /*                       @OZ28368*/
@EL00010 DS    0H                                                  0288
@EF00010 DS    0H                                                  0288
@ER00010 LM    @14,@12,@SA00010                                    0288
         BR    @14                                                 0288
*                                                                  0289
*/********************************************************** @YD00113*/
*/*                                                          #Y30LB12*/
*/* PROCEDURE NAME - S08CLOCK                                #Y30LB12*/
*/*                                                          #Y30LB12*/
*/* FUNCTION - EXTRACT LRUCLOCK PARAMETER VIA READS99        @YD00113*/
*/*            CHECK FOR DUPLICATE KEYWORD LRUCLOCK.         @YD00113*/
*/*            CHECK FOR 1 OF 8 PREDETERMINED DECIMAL        @Y30LB12*/
*/*            VALUES THAT WILL SET THE PROPER BINARY        @Y30LB12*/
*/*            BIT IN THE LRUCLOCK INCREMENTOR.              @Y30LB12*/
*/*                    128 = '80'X                           @Y30LB12*/
*/*                    256 = '40'X                           @Y30LB12*/
*/*                    512 = '20'X                           @Y30LB12*/
*/*                   1024 = '10'X                           @Y30LB12*/
*/*                   2048 = '08'X                           @Y30LB12*/
*/*                   4096 = '04'X                           @Y30LB12*/
*/*                   8192 = '02'X                           @Y30LB12*/
*/*                  16384 = '01'X                           @Y30LB12*/
*/*            IF NONE OF THE ABOVE WRITE ERROR MESSAGE      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0289
*S08CLOCK:                                                         0289
*   PROCEDURE;                      /*                       @Y30LB12*/
S08CLOCK STM   @14,@12,@SA00011                                    0289
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0290
*   IF HAVCLOCK^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVCLOCK,B'00001000'                                0291
         BO    @RF00291                                            0291
*     HAVCLOCK='1'B;                /*                       @Y30LB12*/
         OI    HAVCLOCK,B'00001000'                                0292
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0293
         B     @RC00291                                            0293
@RF00291 DS    0H                                                  0294
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* 'ICG219I DUPLICATE KEYWORD LRUCLOCK'              @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0294
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0294
*       OUTBUF2(28:28+LENGTH(MSGCLOCK))=MSGCLOCK;/*          @YD00113*/
         MVI   OUTBUF2+35(R4),C' '                                 0295
         MVC   OUTBUF2+27(8,R4),@CC00380                           0295
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0296
*       RETURN;                     /* RETURN TO S08SCAN     @Y30LB12*/
@EL00011 DS    0H                                                  0297
@EF00011 DS    0H                                                  0297
@ER00011 LM    @14,@12,@SA00011                                    0297
         BR    @14                                                 0297
*     END;                          /*                       @Y30LB12*/
*                                                                  0298
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* ICG211I EXPECTED, BUT DID NOT FIND,                   @Y30LB12*/
*   /* PARAMETER                                             @Y30LB12*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0299
*   IF PARMBIT^='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00291 TM    PARMBIT(R4),B'00100000'                             0299
         BO    @RF00299                                            0299
*     DO;                           /*                       @Y30LB12*/
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0301
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0302
*       RETURN;                     /* RETURN TO S08SCAN     @Y30LB12*/
         B     @EL00011                                            0303
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0305
*     ;                             /*                       @Y30LB12*/
@RF00299 DS    0H                                                  0306
*   IF SCANLEN=3                    /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00048                              0306
         BNE   @RF00306                                            0306
*     IF SCANDATA(1:3)='128'        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0307
         CLC   SCANDATA(3,@10),@CC00445                            0307
         BNE   @RF00307                                            0307
*       TABCLOCK='80'X;             /*                       @Y30LB12*/
         MVI   TABCLOCK,X'80'                                      0308
*     ELSE                          /*                       @Y30LB12*/
*       IF SCANDATA(1:3)='256'      /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00307                                            0309
@RF00307 L     @10,STARTCOL(,R4)                                   0309
         CLC   SCANDATA(3,@10),@CC00447                            0309
         BNE   @RF00309                                            0309
*         TABCLOCK='40'X;           /*                       @Y30LB12*/
         MVI   TABCLOCK,X'40'                                      0310
*       ELSE                        /*                       @Y30LB12*/
*         IF SCANDATA(1:3)='512'    /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         B     @RC00309                                            0311
@RF00309 L     @10,STARTCOL(,R4)                                   0311
         CLC   SCANDATA(3,@10),@CC00449                            0311
         BNE   @RF00311                                            0311
*           TABCLOCK='20'X;         /*                       @Y30LB12*/
         MVI   TABCLOCK,X'20'                                      0312
*         ELSE                                                     0313
*           ;                       /*                       @Y30LB12*/
@RF00311 DS    0H                                                  0314
*   ELSE                                                           0314
*     ;                             /*                       @Y30LB12*/
@RF00306 DS    0H                                                  0315
*   IF SCANLEN=4                    /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00306 CLC   SCANLEN(2,R4),@CH00068                              0315
         BNE   @RF00315                                            0315
*     IF SCANDATA(1:4)='1024'       /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0316
         CLC   SCANDATA(4,@10),@CC00451                            0316
         BNE   @RF00316                                            0316
*       TABCLOCK='10'X;             /*                       @Y30LB12*/
         MVI   TABCLOCK,X'10'                                      0317
*     ELSE                          /*                       @Y30LB12*/
*       IF SCANDATA(1:4)='2048'     /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00316                                            0318
@RF00316 L     @10,STARTCOL(,R4)                                   0318
         CLC   SCANDATA(4,@10),@CC00453                            0318
         BNE   @RF00318                                            0318
*         TABCLOCK='08'X;           /*                       @Y30LB12*/
         MVI   TABCLOCK,X'08'                                      0319
*       ELSE                        /*                       @Y30LB12*/
*         IF SCANDATA(1:4)='4096'   /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         B     @RC00318                                            0320
@RF00318 L     @10,STARTCOL(,R4)                                   0320
         CLC   SCANDATA(4,@10),@CC00455                            0320
         BNE   @RF00320                                            0320
*           TABCLOCK='04'X;         /*                       @Y30LB12*/
         MVI   TABCLOCK,X'04'                                      0321
*         ELSE                      /*                       @Y30LB12*/
*           IF SCANDATA(1:4)='8192' /*                       @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         B     @RC00320                                            0322
@RF00320 L     @10,STARTCOL(,R4)                                   0322
         CLC   SCANDATA(4,@10),@CC00457                            0322
         BNE   @RF00322                                            0322
*             TABCLOCK='02'X;       /*                       @Y30LB12*/
         MVI   TABCLOCK,X'02'                                      0323
*           ELSE                                                   0324
*             ;                     /*                       @Y30LB12*/
@RF00322 DS    0H                                                  0325
*   ELSE                                                           0325
*     ;                             /*                       @Y30LB12*/
@RF00315 DS    0H                                                  0326
*   IF SCANLEN=5                    /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00315 CLC   SCANLEN(2,R4),@CH00119                              0326
         BNE   @RF00326                                            0326
*     IF SCANDATA(1:5)='16384'      /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0327
         CLC   SCANDATA(5,@10),@CC00459                            0327
         BNE   @RF00327                                            0327
*       TABCLOCK='01'X;             /*                       @Y30LB12*/
         MVI   TABCLOCK,X'01'                                      0328
*     ELSE                                                         0329
*       ;                           /*                       @Y30LB12*/
@RF00327 DS    0H                                                  0330
*   ELSE                                                           0330
*     ;                             /*                       @Y30LB12*/
@RF00326 DS    0H                                                  0331
*   IF TABCLOCK='00'X               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLI   TABCLOCK,X'00'                                      0331
         BNE   @RF00331                                            0331
*     DO;                           /*                       @Y30LB12*/
*                                                                  0332
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* 'ICG223I VALUE ERROR FOR LRUCLOCK'                @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0333
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0333
*       OUTBUF2(26:26+LENGTH(MSGCLOCK))=MSGCLOCK;/*          @YD00113*/
         MVI   OUTBUF2+33(R4),C' '                                 0334
         MVC   OUTBUF2+25(8,R4),@CC00380                           0334
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0335
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0337
*     ;                             /*                       @Y30LB12*/
@RF00331 DS    0H                                                  0338
*   END S08CLOCK;                   /* RETURN TO S08SCAN     @Y30LB12*/
         B     @EL00011                                            0338
*                                                                  0339
*/********************************************************** @G24LB42*/
*/*                                                          @G24LB42*/
*/* PROCEDURE NAME - S08CYLFL                                @G24LB42*/
*/*                                                          @G24LB42*/
*/* FUNCTION - DETERMINE IF CYLINDER FAULT - ATTENTION       @G24LB42*/
*/*            INTERRUPT OPTION WAS REQUESTED. FLAG IS SET   @G24LB42*/
*/*            ON IF OPTION PARAMETER IS 'YES'.              @G24LB42*/
*/*                                                          @G24LB42*/
*/********************************************************** @G24LB42*/
*                                                                  0339
*S08CYLFL:                                                         0339
*   PROCEDURE;                      /*                       @G24LB42*/
S08CYLFL STM   @14,@12,@SA00012                                    0339
*   CALL READS99;                   /* EXTRACT PARAMETER     @G24LB42*/
         BAL   @14,READS99                                         0340
*   IF HAVCYLFL^='1'B               /*                       @G24LB42*/
*     THEN                          /*                       @G24LB42*/
         LA    @10,1                                               0341
         C     @10,HAVCYLFL                                        0341
         BE    @RF00341                                            0341
*     HAVCYLFL='1'B;                /* FIRST USE OF KEY      @G24LB42*/
         ST    @10,HAVCYLFL                                        0342
*   ELSE                            /*                       @G24LB42*/
*     DO;                           /*                       @G24LB42*/
*                                                                  0343
         B     @RC00341                                            0343
@RF00341 DS    0H                                                  0344
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @G24LB42*/
*       /* 'ICG219I DUPLICATE KEYWORD CYLFAULT'              @G24LB42*/
*       /* *****************************************         @G24LB42*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0344
*       OUTBUF2(1:27)=ICGDS219;     /*                       @G24LB42*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0344
*       OUTBUF2(28:28+LENGTH(MSGCYLFL))=MSGCYLFL;/*          @G24LB42*/
         MVI   OUTBUF2+35(R4),C' '                                 0345
         MVC   OUTBUF2+27(8,R4),@CC00382                           0345
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @G24LB42*/
         BAL   @14,PUTIT1                                          0346
*       RETURN;                     /* RETURN TO S08SCAN     @G24LB42*/
@EL00012 DS    0H                                                  0347
@EF00012 DS    0H                                                  0347
@ER00012 LM    @14,@12,@SA00012                                    0347
         BR    @14                                                 0347
*     END;                          /*                       @G24LB42*/
*                                                                  0348
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @G24LB42*/
*   /* ICG211I EXPECTED, BUT DID NOT FIND,                   @G24LB42*/
*   /* PARAMETER                                             @G24LB42*/
*   /* ***********************************************       @G24LB42*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   IF PARMBIT^='1'B                /*                       @G24LB42*/
*     THEN                          /*                       @G24LB42*/
@RC00341 TM    PARMBIT(R4),B'00100000'                             0349
         BO    @RF00349                                            0349
*     DO;                           /*                       @G24LB42*/
*       MSGNO=ICG211I;              /* ID FOR ICG211I        @G24LB42*/
         MVC   MSGNO(2,R4),ICG211I                                 0351
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @G24LB42*/
         BAL   @14,PUTIT2                                          0352
*       RETURN;                     /* RETURN TO S08SCAN     @G24LB42*/
         B     @EL00012                                            0353
*     END;                          /*                       @G24LB42*/
*   ELSE                            /*                       @G24LB42*/
*     IF SCANDATA(1:3)='YES' THEN   /*                       @G24LB42*/
@RF00349 L     @10,STARTCOL(,R4)                                   0355
         CLC   SCANDATA(3,@10),@CC00465                            0355
         BNE   @RF00355                                            0355
*       CYLFLON='1'B;               /* ATTENTION INTERRUPT   @G24LB42*/
         OI    CYLFLON,B'00000001'                                 0356
*     ELSE                          /*                       @G24LB42*/
*       CYLFLON='0'B;               /*                       @G24LB42*/
         B     @RC00355                                            0357
@RF00355 NI    CYLFLON,B'11111110'                                 0357
*   END S08CYLFL;                   /* RETURN TO S08SCAN     @G24LB42*/
         B     @EL00012                                            0358
*                                                                  0359
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08ANAL                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - TEST FOR MISSING REQUIRED KEYWORD, 'LRUCLOCK' @YD00113*/
*/*            TEST EXCLUSIVE CREATE PARAMETERS FOR CONFLICT @YD00113*/
*/*            THEN DETERMINE IF REQUIRED 'CREATE' PARM      @YD00113*/
*/*            IS MISSING.  FOR ANY FAILURE, ISSUE APPROP-   @YD00113*/
*/*            RIATE ERROR MESSAGE.  LASTLY, TEST FOR PAGE   @YD00113*/
*/*            NUMBER VALUE ERRORS                           @YD00113*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0359
*S08ANAL:                                                          0359
*   PROCEDURE;                      /*                       @Y30LB12*/
S08ANAL  STM   @14,@12,@SA00013                                    0359
*   IF HAVCLOCK^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVCLOCK,B'00001000'                                0360
         BO    @RF00360                                            0360
*     DO;                           /*                       @Y30LB12*/
*                                                                  0361
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG221I MISSING REQUIRED KEYWORD                  @Y30LB12*/
*       /* LRUCLOCK                                          @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0362
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0362
*       OUTBUF2(35:35+LENGTH(MSGCLOCK))=MSGCLOCK;/*          @YD00113*/
         MVI   OUTBUF2+42(R4),C' '                                 0363
         MVC   OUTBUF2+34(8,R4),@CC00380                           0363
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0364
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0366
*     ;                             /*                       @Y30LB12*/
@RF00360 DS    0H                                                  0367
*   IF HAVVOLID^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVVOLID,B'00000100'                                0367
         BO    @RF00367                                            0367
*     DO;                           /*                       @Y30LB12*/
*                                                                  0368
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* ICG221I MISSING REQUIRED KEYWORD                  @Y30LB12*/
*       /* VOLID                                             @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0369
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0369
*       OUTBUF2(35:35+LENGTH(MSGVOLID))=MSGVOLID;/*          @YD00113*/
         MVI   OUTBUF2+39(R4),C' '                                 0370
         MVC   OUTBUF2+34(5,R4),@CC00378                           0370
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0371
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0373
*     ;                             /*                       @Y30LB12*/
@RF00367 DS    0H                                                  0374
*   IF NEWBIT='1'B                  /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    NEWBIT,B'10000000'                                  0374
         BNO   @RF00374                                            0374
*     IF UPDBIT='1'B                /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    UPDBIT,B'01000000'                                  0375
         BNO   @RF00375                                            0375
*       DO;                         /*                       @Y30LB12*/
*                                                                  0376
*         /***********************************************************/
*         /*                                                         */
*         /* *************************************           @YD00113*/
*         /* ICG215I CREATE STATEMENT EXCLUSIVE              @Y30LB12*/
*         /* PARAMETERS CONFLICT                             @Y30LB12*/
*         /* *************************************           @YD00113*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0377
*         MSGNO=ICG215I;            /* IDENT FOR ICG215I     @Y30LB12*/
         MVC   MSGNO(2,R4),ICG215I                                 0377
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0378
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0380
*       ;                           /*                       @Y30LB12*/
@RF00375 DS    0H                                                  0381
*   ELSE                            /*                       @Y30LB12*/
*     IF UPDBIT='0'B                /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00374                                            0381
@RF00374 TM    UPDBIT,B'01000000'                                  0381
         BNZ   @RF00381                                            0381
*       DO;                         /*                       @Y30LB12*/
*                                                                  0382
*         /***********************************************************/
*         /*                                                         */
*         /* *************************************           @YD00113*/
*         /* ICG216I REQUIRED CREATE PARAMETER               @Y30LB12*/
*         /* MISSING                                         @Y30LB12*/
*         /* *************************************           @YD00113*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0383
*         MSGNO=ICG216I;            /* IDENT FOR ICG216I     @Y30LB12*/
         MVC   MSGNO(2,R4),ICG216I                                 0383
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0384
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0386
*       ;                           /*                       @Y30LB12*/
@RF00381 DS    0H                                                  0387
*   IF CMDCREAT^='1'B               /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00374 TM    CMDCREAT(R4),B'10000000'                            0387
         BO    @RF00387                                            0387
*     CMDCREAT='1'B;                /*                       @Y30LB12*/
         OI    CMDCREAT(R4),B'10000000'                            0388
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0389
         B     @RC00387                                            0389
@RF00387 DS    0H                                                  0390
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* MESSAGE ICG205I DUPLICATE COMMAND WORD            @Y30LB12*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       MSGNO=ICG205I;              /* ID FOR ICGDS205       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG205I                                 0390
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0391
*     END;                          /*                       @Y30LB12*/
*   END S08ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00013 DS    0H                                                  0393
@EF00013 DS    0H                                                  0393
@ER00013 LM    @14,@12,@SA00013                                    0393
         BR    @14                                                 0393
*                                                                  0394
*/********************************************************** @YD00113*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S08BUILD                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - MOVE INDICATION OF PARAMETERS SCANNED FROM    @Y30LB12*/
*/*            THIS CONTROL STATEMENT TO THE STRUCTURE       @Y30LB12*/
*/*            'CREATE' IN COMTAB                            @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0394
*S08BUILD:                                                         0394
*   PROCEDURE;                      /*                       @Y30LB12*/
S08BUILD STM   @14,@12,12(@13)                                     0394
*   IF NEWBIT='1'B                  /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    NEWBIT,B'10000000'                                  0395
         BNO   @RF00395                                            0395
*     NEWCREAT='1'B;                /*                       @Y30LB12*/
         OI    NEWCREAT(R4),B'01000000'                            0396
*   ELSE                                                           0397
*     ;                             /*                       @Y30LB12*/
@RF00395 DS    0H                                                  0398
*   IF UPDBIT='1'B                  /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    UPDBIT,B'01000000'                                  0398
         BNO   @RF00398                                            0398
*     UPDCREAT='1'B;                /*                       @Y30LB12*/
         OI    UPDCREAT(R4),B'00100000'                            0399
*   ELSE                                                           0400
*     ;                             /*                       @Y30LB12*/
@RF00398 DS    0H                                                  0401
*   IF PRNTBIT='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    PRNTBIT,B'00100000'                                 0401
         BNO   @RF00401                                            0401
*     PRNTONLY='1'B;                /*                       @Y30LB12*/
         OI    PRNTONLY(R4),B'00010000'                            0402
*   ELSE                                                           0403
*     ;                             /*                       @Y30LB12*/
@RF00401 DS    0H                                                  0404
*   LRUCLOCK=TABCLOCK;              /*                       @Y30LB12*/
         MVC   LRUCLOCK(1,R4),TABCLOCK                             0404
*   VOLSER=WKVOLSER;                /*                       @Y30LB12*/
         MVC   VOLSER(6,R4),WKVOLSER                               0405
*   IF CYLFLON='1'B THEN            /*                       @G24LB42*/
         TM    CYLFLON,B'00000001'                                 0406
         BNO   @RF00406                                            0406
*     CYLFAULT='1'B;                /*                       @G24LB42*/
         OI    CYLFAULT(R4),B'00001000'                            0407
*   DO I=1 TO 4;                    /*                       @Y30LB12*/
@RF00406 LA    I,1                                                 0408
@DL00408 DS    0H                                                  0409
*     VPAGES(I)=WKPAGES(I);         /*                       @Y30LB12*/
         SLR   @10,@10                                             0409
         IC    @10,WKPAGES-1(I)                                    0409
         STC   @10,VPAGES-1(I,R4)                                  0409
*   END;                            /*                       @Y30LB12*/
         AH    I,@CH00042                                          0410
         CH    I,@CH00068                                          0410
         BNH   @DL00408                                            0410
*   IF BINT='1'B THEN                                              0411
         TM    BINT,B'00010000'                                    0411
         BNO   @RF00411                                            0411
*     BINTIND='1'B;                 /* IF ANY TABPTH         @OZ28368*/
         OI    BINTIND(R4),B'00000100'                             0412
*   ELSE                                                           0413
*     ;                             /* KEYWORD OPERAND       @OZ28368*/
@RF00411 DS    0H                                                  0414
*   IF CINT='1'B THEN                                              0414
         TM    CINT,B'00001000'                                    0414
         BNO   @RF00414                                            0414
*     CINTIND='1'B;                 /* SPECS WERE MADE,      @OZ28368*/
         OI    CINTIND(R4),B'00000010'                             0415
*   ELSE                                                           0416
*     ;                             /* SET COMTAB FIELDS     @OZ28368*/
@RF00414 DS    0H                                                  0417
*   IF DINT='1'B THEN                                              0417
         TM    DINT,B'00000100'                                    0417
         BNO   @RF00417                                            0417
*     DINTIND='1'B;                 /* FROM WORK BITS        @OZ28368*/
         OI    DINTIND(R4),B'00000001'                             0418
*   ELSE                                                           0419
*     ;                             /*                       @OZ28368*/
@RF00417 DS    0H                                                  0420
*   END S08BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/
@EL00014 DS    0H                                                  0420
@EF00014 DS    0H                                                  0420
@ER00014 LM    @14,@12,12(@13)                                     0420
         BR    @14                                                 0420
*                                                                  0421
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0421
*READS99:                                                          0421
*   PROCEDURE;                      /*                       @Y30LB12*/
READS99  STM   @14,@12,@SA00015                                    0421
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */
*                                                                  0422
         LINK EP=ICGDSS99
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************@Y30LB12 IF   */
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/
*   /* KEYWORD.                                              @Y30LB12*/
*   /* ************************************************@Y30LB12      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    ENDSCAN(R4),B'00010000'                             0423
         BNO   @RF00423                                            0423
*     LASTPARM='1'B;                /*                       @Y30LB12*/
         OI    LASTPARM(R4),B'00001000'                            0424
*   ELSE                                                           0425
*     ;                             /*                       @Y30LB12*/
@RF00423 DS    0H                                                  0426
*   END READS99;                    /*                       @Y30LB12*/
@EL00015 DS    0H                                                  0426
@EF00015 DS    0H                                                  0426
@ER00015 LM    @14,@12,@SA00015                                    0426
         BR    @14                                                 0426
*                                                                  0427
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0427
*PUTIT1:                                                           0427
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT1   STM   @14,@12,@SA00016                                    0427
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'00100000'                                0428
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            0429
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0430
         AH    @10,TERMINAT(,R4)                                   0430
         STH   @10,TERMINAT(,R4)                                   0430
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            0432
*   END PUTIT1;                     /*                       @Y30LB12*/
@EL00016 DS    0H                                                  0433
@EF00016 DS    0H                                                  0433
@ER00016 LM    @14,@12,@SA00016                                    0433
         BR    @14                                                 0433
*                                                                  0434
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0434
*PUTIT2:                                                           0434
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT2   STM   @14,@12,@SA00017                                    0434
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'00100000'                                0435
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0436
         AH    @10,TERMINAT(,R4)                                   0436
         STH   @10,TERMINAT(,R4)                                   0436
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   END PUTIT2;                     /*                       @Y30LB12*/
@EL00017 DS    0H                                                  0438
@EF00017 DS    0H                                                  0438
@ER00017 LM    @14,@12,@SA00017                                    0438
         BR    @14                                                 0438
*                                                                  0439
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT3                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT WARNING MESSAGE FOR WHICH MESSAGE TEXT    @Y30LB12*/
*/*            IS NOT IN ICGDSMSG, BUT WHICH IS BUILT AND    @Y30LB12*/
*/*            PASSED IN 'OUTBUF2'.                          @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0439
*PUTIT3:                                                           0439
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT3   STM   @14,@12,@SA00018                                    0439
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            0440
*   WARNING=WARNING+1;              /*                       @Y30LB12*/
         LA    @10,1                                               0441
         AH    @10,WARNING(,R4)                                    0441
         STH   @10,WARNING(,R4)                                    0441
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            0443
*   END PUTIT3;                     /*                       @Y30LB12*/
@EL00018 DS    0H                                                  0444
@EF00018 DS    0H                                                  0444
@ER00018 LM    @14,@12,@SA00018                                    0444
         BR    @14                                                 0444
*                                                                  0445
*/********************************************************** @YD00113*/
*/*                  P A T C H    A R E A                    @Y30LB12*/
*/********************************************************** @YD00113*/
*                                                                  0445
*   GENERATE;                                                      0445
*                                                         /*@Y30LB12*/
PATCHS08 DS    32D                                        /*@Y30LB12*/
*   END ICGDSS08                    /*                       @Y30LB12*/
*                                                                  0446
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA4)                                       */
*                                                                  0446
*       ;                                                          0446
         B     @EL00001                                            0446
@DATA    DS    0H
@CH00042 DC    H'1'
@CH00048 DC    H'3'
@CH00068 DC    H'4'
@CH00119 DC    H'5'
@CH00227 DC    H'6'
@CH00040 DC    H'8'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@SA00013 DS    15F
@SA00015 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00011 DS    15F
@SA00012 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00009 DS    15F
@SA00017 DS    15F
@SA00016 DS    15F
@SA00010 DS    15F
@SA00018 DS    15F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSS08 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
HAVCYLFL DS    F
J        DS    H
         DS    CL2
CREATEWK DS    CL23
         ORG   CREATEWK
PACKWORK DS    CL8
WORKPAGE DS    CL2
         ORG   WORKPAGE
HIGHPAGE DS    BL1
@NM00019 EQU   WORKPAGE+0
LOWPAGE  DS    BL1
@NM00020 EQU   WORKPAGE+1
         ORG   CREATEWK+10
CRTMSGID DS    CL1
         ORG   CRTMSGID
KNOWN    DS    BL1
S08LAST  EQU   CRTMSGID+0
STOPSCAN EQU   CRTMSGID+0
BINT     EQU   CRTMSGID+0
CINT     EQU   CRTMSGID+0
DINT     EQU   CRTMSGID+0
TABBTFLD EQU   CRTMSGID+0
@NM00021 EQU   CRTMSGID+0
         ORG   CREATEWK+11
WORKBITS DS    CL1
         ORG   WORKBITS
NEWBIT   DS    BL1
UPDBIT   EQU   WORKBITS+0
PRNTBIT  EQU   WORKBITS+0
@NM00022 EQU   WORKBITS+0
HAVCLOCK EQU   WORKBITS+0
HAVVOLID EQU   WORKBITS+0
ERROR    EQU   WORKBITS+0
CYLFLON  EQU   WORKBITS+0
         ORG   CREATEWK+12
TABCLOCK DS    CL1
WKVOLSER DS    CL6
WKPAGES  DS    4AL1
         ORG   CREATEWK+23
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSS08 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ICG205I  DC    H'205'
ICG210I  DC    H'210'
ICG211I  DC    H'211'
ICG212I  DC    H'212'
ICG215I  DC    H'215'
ICG216I  DC    H'216'
@CC00362 DC    C'LRUCLOCK='
@CC00365 DC    C'CYLFAULT='
@CC00374 DC    C'PRNTONLY'
@CC00380 EQU   @CC00362
@CC00382 EQU   @CC00365
@CC00368 DC    C'TABPTH='
@CC00358 DC    C'PAGES='
@CC00360 DC    C'VOLID='
@CC00372 DC    C'UPDATE'
@CC00384 EQU   @CC00368
@CC00394 DC    C'      '
@CC00376 EQU   @CC00358
@CC00378 EQU   @CC00360
@CC00459 DC    C'16384'
@CC00451 DC    C'1024'
@CC00453 DC    C'2048'
@CC00455 DC    C'4096'
@CC00457 DC    C'8192'
@CC00370 DC    C'NEW'
@CC00445 DC    C'128'
@CC00447 DC    C'256'
@CC00449 DC    C'512'
@CC00465 DC    C'YES'
@CB00430 DC    X'F0F0'
ICGDS214 DC    CL39' ICG214I PROBABLE MISSPELLED PARAMETER '
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '
ICGDS223 DC    CL25' ICG223I VALUE ERROR FOR '
ICGDS222 DC    CL35' ICG222I NO LONGER SUPPORT KEYWORD '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I        EQU   @02
R4       EQU   @04
R6       EQU   @06
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
KEYBIT   EQU   READFLAG
PARMBIT  EQU   READFLAG
ENDSCAN  EQU   READFLAG
LASTPARM EQU   READFLAG
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
SCANLEN  EQU   READER+204
PRINTER  EQU   COMTAB+464
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
MSGNO    EQU   MESSAGES+2
WARNING  EQU   MESSAGES+4
TERMINAT EQU   MESSAGES+6
SPECLMSG EQU   MESSAGES+18
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
CMDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
UPDCREAT EQU   @NM00017
PRNTONLY EQU   @NM00017
CYLFAULT EQU   @NM00017
BINTIND  EQU   @NM00017
CINTIND  EQU   @NM00017
DINTIND  EQU   @NM00017
VPAGES   EQU   CREATE+1
VOLSER   EQU   CREATE+5
LRUCLOCK EQU   CREATE+11
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
ALTPATH1 EQU   CONFGDEV+2
ALTPATH2 EQU   CONFGDEV+5
ALTPATH3 EQU   CONFGDEV+8
SCANDATA EQU   0
SCANBUF  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTCH3   EQU   ALTPATH3+2
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCH2   EQU   ALTPATH2+2
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCH1   EQU   ALTPATH1+2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
INDEXRSG EQU   CONFGDEV+1
ICEBERG  EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
USECONVR EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEV     EQU   USEFLAGS
USESPEC  EQU   USEFLAGS
RSGCUA   EQU   RSGUCB+8
RSGCHAN  EQU   RSGUCB+7
CPUREFNO EQU   RSGUCB+6
RSGCPUID EQU   RSGUCB+1
@NM00018 EQU   RSGFLAGS
CISPEC   EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
LOWLIB   EQU   LOWDSS+1
@NM00016 EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWSPEC  EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
MERLICEB EQU   PHYSFLGS
PHYSDS2  EQU   DSPAIRS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBDSMID EQU   LIB+2
LIBSIZE  EQU   LIB+1
@NM00009 EQU   LIBBITS
LIBSPEC  EQU   LIBBITS
TODS2    EQU   RSGTODS+1
TODS1    EQU   RSGTODS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
RETCODE  EQU   MESSAGES
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
SAVENCOL EQU   READER+192
SAVESCOL EQU   READER+188
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00064 EQU   @EL00003
@RC00134 EQU   @EL00004
@RC00143 EQU   @EL00005
@RC00152 EQU   @EL00006
@RC00190 EQU   @EL00008
@RC00199 EQU   @EL00009
@RC00207 EQU   @EL00009
@RC00217 EQU   @EL00009
@RC00230 EQU   @EL00009
@RC00249 EQU   @EL00010
@RC00260 EQU   @EL00010
@RC00271 EQU   @EL00010
@RC00309 EQU   @RC00306
@RC00307 EQU   @RC00306
@RC00320 EQU   @RC00315
@RC00318 EQU   @RC00315
@RC00316 EQU   @RC00315
@RC00355 EQU   @EL00012
@RC00387 EQU   @EL00013
@RC00251 EQU   @RC00249
@RC00262 EQU   @RC00260
@RC00273 EQU   @RC00271
@ENDDATA EQU   *
         END   ICGDSS08

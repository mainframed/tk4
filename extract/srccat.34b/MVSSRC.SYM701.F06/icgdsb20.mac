         TITLE 'ICGDSB20 MSC TABLE CREATE REPORTS                      *
                        '
ICGDSB20 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSB20  77.362'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @11,4095(,@10)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@11                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                                                  0056
*/***********************************************************#Y30LB14*/
*/*                                                          @XD00153*/
*/*      ICGDSB20 (MAINLINE)                                 @XD00153*/
*/*                                                          @XD00153*/
*/* INITIALIZE SWITCHES, AND WORK AREA TO ZERO.  ALSO INIT-  @Y30LB14*/
*/* IALIZE CONSTANT AREAS OF THE MESSAGES.                   @Y30LB14*/
*/* NOTE: IN THIS MODULE I, J, K ARE USED AS INDEXES INTO    @Y30LB14*/
*/* THE STAGING ADAPTER, CONTROLLER AND DEVICE RESPECTIVELY. @Y30LB14*/
*/***********************************************************@Y30LB14*/
*                                                                  0056
*   WORK=0;                         /*                       @Y30LB14*/
         MVI   WORK,X'00'                                          0056
*   SWITCH=0;                       /*                       @Y30LB14*/
         SLR   SWITCH,SWITCH                                       0057
*   SWITCH1=0;                      /*                       @Y30LB14*/
         SLR   SWITCH1,SWITCH1                                     0058
*   MSG1='0HOST CONNECTIONS REPORT';/*                       @Y30LB14*/
         MVC   MSG1(24),@CC00391                                   0059
*   MSG2(1:17)='0DASD CONTROLLER '; /*                       @Y30LB14*/
         MVC   MSG2(17),@CC00393                                   0060
*   MSG3='                            ******* STAGING ADAPTER    ******
*     ******* STAGING ADAPTER    *******';/*                 @Y30LB14*/
         MVC   MSG3(101),@CC00395                                  0061
*   MSG4='0    DEVICE  DEVICE   SSID     CPUID       CPUID       CPUID
*        CPUID       CPUID       CPUID';/*                   @Y30LB14*/
         MVC   MSG4(99),@CC00402                                   0062
*   MSG5='';                        /*                       @Y30LB14*/
         MVI   MSG5,C' '                                           0063
         MVC   MSG5+1(100),MSG5                                    0063
*   MSG5(1:18)='      PLUG    TYPE';/*                       @Y30LB14*/
         MVC   MSG5(18),@CC00411                                   0064
*   MSG6='';                        /*                       @Y30LB14*/
         MVI   MSG6,C' '                                           0065
         MVC   MSG6+1(98),MSG6                                     0065
*   MSG7=                                                          0066
*       '                            ******* STAGING ADAPTER    *******
*       ;                                                          0066
         MVC   MSG7(62),@CC00413                                   0066
*   MSG8='0    DEVICE  DEVICE   SSID     CPUID       CPUID       CPUID'
*       ;                                                          0067
         MVC   MSG8(60),@CC00418                                   0067
*   MSG9(1:30)='0CONNECTIONS FOR SA   SSID 8 0';/*           @YD00152*/
         MVC   MSG9(30),@CC00423                                   0068
*   MSG10='0CONNECTIONS REPORT';    /*                       @YD00152*/
         MVC   MSG10(19),@CC00426                                  0069
*   MSG11=                                                         0070
*'   INTERFACE   TO CPU           , CHANNEL  , CONTROL UNIT ADDRESS   '
*       ;                           /*                       @Y30LB14*/
         MVC   MSG11(68),@CC00428                                  0070
*   MSG12='0     DASD  (CTL-I)';    /*                       @Y30LB14*/
         MVC   MSG12(19),@CC00433                                  0071
*   MSG14='            CONTROLLER 00           CONTROLLER 01       0072
*ONTROLLER 10           CONTROLLER 11';/*                    @Y30LB14*/
         MVC   MSG14(97),@CC00435                                  0072
*   MSG15='0           PLUG   TYPE    SSID     PLUG   TYPE    SSID 0073
*LUG   TYPE    SSID     PLUG   TYPE    SSID';/*              @Y30LB14*/
         MVC   MSG15(103),@CC00442                                 0073
*   MSG17='0     DRC/DRD (CTL-I/ADT)';/*                     @Y30LB14*/
         MVC   MSG17(25),@CC00449                                  0074
*   MSG18='           DRD CONTROLLER ADDRESS ';/*            @ZM01131*/
         MVI   MSG18+34,C' '                                       0075
         MVC   MSG18+35(19),MSG18+34                               0075
         MVC   MSG18(34),@CC00452                                  0075
*   MSG19='                 DRC      SSID 4';/*              @Y30LB14*/
         MVI   MSG19+32,C' '                                       0076
         MVI   MSG19+33,C' '                                       0076
         MVC   MSG19(32),@CC00455                                  0076
*   MSG20='                 DRD      SSID 2';/*              @Y30LB14*/
         MVI   MSG20+32,C' '                                       0077
         MVI   MSG20+33,C' '                                       0077
         MVC   MSG20(32),@CC00458                                  0077
*   MSG21='   INTERFACE   IS NOT USED';/*                    @Y30LB14*/
         MVC   MSG21(26),@CC00461                                  0078
*   MSG22='0   INTERFACE A TO MSC, PORT  , CONTROL UNIT ADDRESS    ';
         MVI   MSG22+56,C' '                                       0079
         MVI   MSG22+57,C' '                                       0079
         MVC   MSG22(56),@CC00464                                  0079
*                                   /*                       @OZ09549*/
*   MSG23='0CONNECTION FOR CARTRIDGE STORE  MSF , SSID 1 0, MSFID =  ';
         MVI   MSG23+58,C' '                                       0080
         MVC   MSG23(58),@CC00468                                  0080
*                                   /*                       @OZ09549*/
*   MSG24='0MSC TABLE ACCESS VALID ON INTERFACE(S)      ';/* @OZ28368*/
         MVC   MSG24(45),@CC00473                                  0081
*                                                                  0082
*/***********************************************************#Y30LB14*/
*/* START OF FIRST PART OF REPORT                            #Y30LB14*/
*/* A NEW PAGE IS FORCED FOR THE START OF THE HOST CONNEC-   #Y30LB14*/
*/* TIONS REPORT.  AFTER THE REPORT IS STARTED, IF MORE THAN #Y30LB14*/
*/* 43 LINES ARE ON A PAGE, THEN A NEW PAGES IS FORCED BE-   #Y30LB14*/
*/* FORE THE SECTION FOR THE NEXT DASD CONTROLLER IS PRINTED.#Y30LB14*/
*/* A CHECK IS MADE TO SEE IF THERE IS A MERLIN OR ICEBERG   #Y30LB14*/
*/* FOR THE CONTROLLER.  IF NONE IS FOUND, THEN THE BLOCK    #Y30LB14*/
*/* FOR THAT CONTROLLER IS NOT PRINTED.  CALLS ARE MADE TO   #Y30LB14*/
*/* CHECKDS2 AND MAINBODY TO GENERATE THE DATA THAT GOES IN  #Y30LB14*/
*/* THE DASD CONTROLLER PORTION OF THE REPORT.               #Y30LB14*/
*/***********************************************************#Y30LB14*/
*                                                                  0082
*   LINECTR=LINECT;                 /*                       #Y30LB14*/
         MVC   LINECTR(2,R4),LINECT(R4)                            0082
*   OUTBUF2(1:24)=MSG1;             /*                       #Y30LB14*/
         MVC   OUTBUF2(24,R4),MSG1                                 0083
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0084
*   LINECTR=LINECTR+1;              /*                       @Y30LB14*/
         LA    @06,1                                               0085
         LH    @05,LINECTR(,R4)                                    0085
         ALR   @05,@06                                             0085
         STH   @05,LINECTR(,R4)                                    0085
*   DO I=1 TO 16;                   /*                       @Y30LB14*/
         LR    I,@06                                               0086
@DL00086 DS    0H                                                  0087
*     DO J=1 TO 4;                  /*                       @Y30LB14*/
         LA    J,1                                                 0087
@DL00087 DS    0H                                                  0088
*       BIGBLOCK='0'B;              /*                       @Y30LB14*/
         NI    BIGBLOCK,B'01111111'                                0088
*       DO K=1 TO 8;                /*                       @Y30LB14*/
         LA    K,1                                                 0089
@DL00089 DS    0H                                                  0090
*         IF MERLICEB(I,J,K)^=PHYSFNUL/*                     @X50RSPC*/
*           THEN                                                   0090
         LR    @15,I                                               0090
         SLA   @15,2                                               0090
         ALR   @15,J                                               0090
         SLA   @15,3                                               0090
         ALR   @15,K                                               0090
         ALR   @15,@15                                             0090
         ALR   @15,R4                                              0090
         TM    MERLICEB-82(@15),B'11000000'                        0090
         BZ    @RF00090                                            0090
*           BIGBLOCK='1'B;          /*                       @Y30LB14*/
         OI    BIGBLOCK,B'10000000'                                0091
*       END;                        /*                       @Y30LB14*/
@RF00090 AH    K,@CH00044                                          0092
         CH    K,@CH00042                                          0092
         BNH   @DL00089                                            0092
*       IF BIGBLOCK='1'B THEN                                      0093
         TM    BIGBLOCK,B'10000000'                                0093
         BNO   @RF00093                                            0093
*         DO;                       /*                       @Y30LB14*/
*           IF LINECTR>43           /*                       @YD00152*/
*             THEN                  /*                       @YD00152*/
         LH    @06,LINECTR(,R4)                                    0095
         CH    @06,@CH00480                                        0095
         BNH   @RF00095                                            0095
*             DO;                   /*                       @YD00152*/
*                                                                  0096
*               /*****************************************************/
*               /*                                                   */
*               /* *********************************         @YD00152*/
*               /* PRINT THE SECONDARY HEADING               @YD00152*/
*               /* ('HOST CONNECTIONS REPORT') ON            @YD00152*/
*               /* EACH NEW PAGE.                            @YD00152*/
*               /* *********************************         @YD00152*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0097
*               LINECTR=LINECT;     /*                       @YD00152*/
         MVC   LINECTR(2,R4),LINECT(R4)                            0097
*               OUTBUF2(1:24)=MSG1; /*                       @YD00152*/
         MVC   OUTBUF2(24,R4),MSG1                                 0098
*               CALL PRINT1;        /*                       @YD00152*/
         BAL   @14,PRINT1                                          0099
*               LINECTR=LINECTR+1;  /*                       @YD00152*/
         LA    @06,1                                               0100
         AH    @06,LINECTR(,R4)                                    0100
         STH   @06,LINECTR(,R4)                                    0100
*             END;                  /*                       @YD00152*/
*           CALL CHECKDS2;          /* CHECK FOR SECOND DS   @Y30LB14*/
@RF00095 BAL   @14,CHECKDS2                                        0102
*           CALL PRINT1;            /* BLANK LINE            @Y30LB14*/
         BAL   @14,PRINT1                                          0103
*           CALL MAINBODY;          /* MAIN BODY OF 1ST REPORT     0104
*                                                            @Y30LB14*/
         BAL   @14,MAINBODY                                        0104
*         END;                      /*                       @Y30LB14*/
*     END;                          /*                       @Y30LB14*/
@RF00093 AH    J,@CH00044                                          0106
         CH    J,@CH00070                                          0106
         BNH   @DL00087                                            0106
*   END;                            /*                       @Y30LB14*/
         AH    I,@CH00044                                          0107
         CH    I,@CH00164                                          0107
         BNH   @DL00086                                            0107
*                                                                  0108
*/***********************************************************@Y30LB14*/
*/* THIS STARTS THE SECOND PART OF THE REPORT.               @Y30LB14*/
*/* A CHECK IS MADE TO SEE OF THE STAGING ADAPTER IS DEFINED @Y30LB14*/
*/* AND IF IT IS, THEN A NEW PAGE IS FORCED.  THEN THE CON-  @Y30LB14*/
*/* NECTIONS FOR SA AND INTERFACE A TO MSC SSID LINES ARE    @Y30LB14*/
*/* PRINTED.  A CALL IS THEN MADE TO CPUIDCUA TO DETERMINE   @Y30LB14*/
*/* THE CPU ID AND CHANNEL UNIT ADDRESS FOR THE INTERFACE B, @Y30LB14*/
*/* C,D LINES.  MSG12 IS PRINTED NEXT AND THEN A CALL IS     @Y30LB14*/
*/* MADE TO SHAREDSA TO DETERMINE THE SHARED STAGING ADAPT-  @Y30LB14*/
*/* ERS FOR THIS SA.  MSG14 AND MSG15 ARE THEN PRINTED AND   @Y30LB14*/
*/* A CALL IS MADE TO ZEROMSG TO ZERO OUT THE CONTENTS OF    @Y30LB14*/
*/* MSG16.  A CALL IS MADE TO MAINBOD2 TO PRODUCE THE DATA   @Y30LB14*/
*/* THAT IS IN THE MAIN BODY OF THIS SECTION AND THEN A CALL @Y30LB14*/
*/* IS MADE TO PRNTBOD2 TO PRINT OUT THE CONTENTS OF MSG16.  @Y30LB14*/
*/* MSG16 CONTAINS ALL THE DATA IN THE 8 LINES OF THE MAIN   @Y30LB14*/
*/* PART OF THIS SECTION OF THE REPORT.  THE DRC/DRD LINE IS @Y30LB14*/
*/* PRINTED AS WILL AS A BLANK LINE AND THEN A CHECK IS MADE @Y30LB14*/
*/* TO DETERMINE IF THE CONTROL UNIT ADDRESS IS USED.  IF IT @Y30LB14*/
*/* IS NOT, THEN A MESSAGE STATING THIS FACT IS PRINTED,     @Y30LB14*/
*/* OTHERWISE, CALLS ARE MADE TO SETMSG18, LIBSIZE1,         @Y30LB14*/
*/* LIBSIZE2 AND LIBSIZE3 TO BUILD THE DRD LINES.  THE       @Y30LB14*/
*/* PROGRAM NOW RETURN TO THE BUILD MODULE.                  @Y30LB14*/
*/***********************************************************@Y30LB14*/
*                                                                  0108
*   DO I=1 TO 16;                   /*                       @Y30LB14*/
*                                                                  0108
         LA    I,1                                                 0108
@DL00108 DS    0H                                                  0109
*     /***************************************************************/
*     /*                                                             */
*     /* *********************************************       @YD00143*/
*     /* WRITE THE CONNECTIONS REPORT WHETHER BOTH           @YD00143*/
*     /* THE CPUS AND THE MSF CONNECT TO THE STAGING         @YD00143*/
*     /* CONNECT TO THE STAGING ADAPTER OR ONLY              @YD00143*/
*     /* ONLY ONE CONNECTS. IN ANY CASE THERE WILL           @YD00143*/
*     /* BE DASD CONNECTIONS.                                @YD00143*/
*     /* *********************************************       @YD00143*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0109
*     IF CISPEC(I*3-2)='1'B         /*                       @YD00143*/
*         ×CISPEC(I*3-1)='1'B       /*                       @YD00143*/
*         ×CISPEC(I*3)='1'B         /*                       @YD00143*/
*         ×LOWSPEC(I,1)='1'B        /*                       @YD00143*/
*         ×LOWSPEC(I,2)='1'B        /*                       @YD00143*/
*         ×LOWSPEC(I,3)='1'B        /*                       @YD00143*/
*         ×LOWSPEC(I,4)='1'B        /*                       @YD00143*/
*       THEN                                                       0109
         LR    @06,I                                               0109
         MH    @06,@CH00312                                        0109
         L     @02,COMPTR2(,R4)                                    0109
         ST    @06,@TF00001                                        0109
         ALR   @06,@02                                             0109
         TM    CISPEC-27(@06),B'10000000'                          0109
         BO    @RT00109                                            0109
         LR    @06,@02                                             0109
         AL    @06,@TF00001                                        0109
         TM    CISPEC-18(@06),B'10000000'                          0109
         BO    @RT00109                                            0109
         AL    @02,@TF00001                                        0109
         TM    CISPEC-9(@02),B'10000000'                           0109
         BO    @RT00109                                            0109
         LR    @06,I                                               0109
         SLA   @06,3                                               0109
         ST    @06,@TF00001                                        0109
         ALR   @06,R4                                              0109
         TM    LOWSPEC-8(@06),B'10000000'                          0109
         BO    @RT00109                                            0109
         LR    @06,R4                                              0109
         AL    @06,@TF00001                                        0109
         TM    LOWSPEC-6(@06),B'10000000'                          0109
         BO    @RT00109                                            0109
         LR    @06,R4                                              0109
         AL    @06,@TF00001                                        0109
         TM    LOWSPEC-4(@06),B'10000000'                          0109
         BO    @RT00109                                            0109
         LR    @06,R4                                              0109
         AL    @06,@TF00001                                        0109
         TM    LOWSPEC-2(@06),B'10000000'                          0109
         BNO   @RF00109                                            0109
@RT00109 DS    0H                                                  0110
*       DO;                         /*                       @Y30LB14*/
*                                                                  0110
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @YD00152*/
*         /* PRINT THE SECONDARY HEADING (CONNECTIONS        @YD00152*/
*         /* REPORT) ON EACH NEW PAGE. START A NEW           @YD00152*/
*         /* PAGE WHEN A NEW STAGING ADAPTER IS FOUND        @YD00152*/
*         /* *****************************************       @YD00152*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0111
*         LINECTR=LINECT;           /* FORCE NEW PAGE        @Y30LB14*/
         MVC   LINECTR(2,R4),LINECT(R4)                            0111
*         OUTBUF2(1:19)=MSG10;      /*                       @YD00152*/
         MVC   OUTBUF2(19,R4),MSG10                                0112
*         CALL PRINT1;              /*                       @YD00152*/
         BAL   @14,PRINT1                                          0113
*         OUTBUF2(1)='0';           /* SPACE TWO LINES       @OZ09549*/
         MVI   OUTBUF2(R4),C'0'                                    0114
*         DO K=1 TO 4;              /* POSS. SUPPORT OF MORE THAN TWO
*                                      MSFS                  @OZ09549*/
         LA    K,1                                                 0115
@DL00115 DS    0H                                                  0116
*           IF LIBSPEC(K)='0'B      /* CHECK FOR NONSPECIFIED MSF  0116
*                                                            @OZ09549*/
*             THEN                                                 0116
         LR    @02,K                                               0116
         MH    @02,@CH00130                                        0116
         ALR   @02,R4                                              0116
         TM    LIBSPEC-12(@02),B'10000000'                         0116
         BNZ   @RF00116                                            0116
*             K=4;                  /* LEAVE THE LOOP        @OZ09549*/
         LA    K,4                                                 0117
*           ELSE                                                   0118
*             DO;                                                  0118
         B     @RC00116                                            0118
@RF00116 DS    0H                                                  0119
*               MSG23(37)=TABLE(K); /* MSF NUMBER            @OZ09549*/
         LA    @02,TABLE-1(K)                                      0119
         MVC   MSG23+36(1),0(@02)                                  0119
*               MSG23(46)=TABLE(K); /* MSF SSID              @OZ09549*/
         LA    @02,TABLE-1(K)                                      0120
         MVC   MSG23+45(1),0(@02)                                  0120
*               DO J=1 TO 15;       /* CONVERT MSFID FROM BINARY   0121
*                                                            @OZ09549*/
*                                                                  0121
         LA    J,1                                                 0121
@DL00121 DS    0H                                                  0122
*                 /***************************************************/
*                 /*                                                 */
*                 /* TO CHARACTER FIELD FOR PRINT            @OZ09549*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0122
*                 IF LIBDSMID(K)=J  /* POSS. 1 - F           @OZ09549*/
*                   THEN                                           0122
         LR    @15,K                                               0122
         MH    @15,@CH00130                                        0122
         ALR   @15,R4                                              0122
         MVC   @ZT00003+3(1),LIBDSMID-12(@15)                      0122
         C     J,@ZT00003                                          0122
         BNE   @RF00122                                            0122
*                   DO;                                            0123
*                     MSG23(58)=TABLE(J+1);/* CHARACTER MSFID      0124
*                                                            @OZ09549*/
         LA    @01,TABLE(J)                                        0124
         MVC   MSG23+57(1),0(@01)                                  0124
*                     J=16;         /* LEAVE LOOP TO PRINT   @OZ09549*/
         LA    J,16                                                0125
*                   END;                                           0126
*               END;                /* END J LOOP            @OZ09549*/
@RF00122 AH    J,@CH00044                                          0127
         CH    J,@CH00065                                          0127
         BNH   @DL00121                                            0127
*               OUTBUF2(1:60)=MSG23;/*                       @OZ09549*/
         MVI   OUTBUF2+59(R4),C' '                                 0128
         MVC   OUTBUF2(59,R4),MSG23                                0128
*               CALL PRINT1;        /*                       @OZ09549*/
         BAL   @14,PRINT1                                          0129
*             END;                                                 0130
*         END;                      /* END K LOOP            @OZ09549*/
*                                                                  0131
@RC00116 AH    K,@CH00044                                          0131
         CH    K,@CH00070                                          0131
         BNH   @DL00115                                            0131
*         /***********************************************************/
*         /*                                                         */
*         /* TABLE ACCESS VALID ON INTERFACE (X) PRINT.      @OZ28368*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0132
*         OUTBUF2(1:LENGTH(MSG24))=MSG24;/* WRT PTH INT. IND.      0132
*                                                            @OZ28368*/
         MVC   OUTBUF2(45,R4),MSG24                                0132
*         IF DINTIND='1'B THEN                                     0133
         TM    DINTIND(R4),B'00000001'                             0133
         BNO   @RF00133                                            0133
*           OUTBUF2(41:45)=TABLE5(3);/*                      @OZ28368*/
         MVC   OUTBUF2+40(5,R4),TABLE5+10                          0134
*         ELSE                                                     0135
*           IF CINTIND='1'B THEN                                   0135
         B     @RC00133                                            0135
@RF00133 TM    CINTIND(R4),B'00000010'                             0135
         BNO   @RF00135                                            0135
*             OUTBUF2(41:45)=TABLE5(2);/*                    @OZ28368*/
         MVC   OUTBUF2+40(5,R4),TABLE5+5                           0136
*           ELSE                                                   0137
*             OUTBUF2(41:45)=TABLE5(1);/*                    @OZ28368*/
         B     @RC00135                                            0137
@RF00135 MVC   OUTBUF2+40(5,R4),TABLE5                             0137
*         CALL PRINT1;              /*                       @OZ28368*/
@RC00135 DS    0H                                                  0138
@RC00133 BAL   @14,PRINT1                                          0138
*         MSG9(21)=TABLE(I);        /*                       #Y30LB14*/
         LA    @06,TABLE-1(I)                                      0139
         MVC   MSG9+20(1),0(@06)                                   0139
*         MSG9(29)=TABLE(I);        /*                       @YD00152*/
         LA    @06,TABLE-1(I)                                      0140
         MVC   MSG9+28(1),0(@06)                                   0140
*         OUTBUF2(1:30)=MSG9;       /*                       @YD00152*/
         MVC   OUTBUF2(30,R4),MSG9                                 0141
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0142
*         CALL CPUIDCUA;            /* CPU ID & CHAN/UNIT ADDR     0143
*                                                            #Y30LB14*/
         BAL   @14,CPUIDCUA                                        0143
*         OUTBUF2(1:19)=MSG12;      /*                       #Y30LB14*/
         MVC   OUTBUF2(19,R4),MSG12                                0144
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0145
*         MSG13='';                 /*                       #Y30LB14*/
         MVI   MSG13,C' '                                          0146
         MVC   MSG13+1(96),MSG13                                   0146
*         CALL SHAREDSA;            /* SHARED STAGING ADAPTERS     0147
*                                                            @YD00113*/
         BAL   @14,SHAREDSA                                        0147
*         OUTBUF2(1:97)=MSG13;      /*                       #Y30LB14*/
         MVC   OUTBUF2(97,R4),MSG13                                0148
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0149
*         OUTBUF2(1:97)=MSG14;      /*                       #Y30LB14*/
         MVC   OUTBUF2(97,R4),MSG14                                0150
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0151
*         OUTBUF2(1:103)=MSG15;     /*                       #Y30LB14*/
         MVC   OUTBUF2(103,R4),MSG15                               0152
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0153
*         CALL ZEROMSG;             /* ZERO OUT MESSAGE      #Y30LB14*/
         BAL   @14,ZEROMSG                                         0154
*         CALL MAINBOD2;            /* MAIN BODY OF 2ND REPORT     0155
*                                                            #Y30LB14*/
         BAL   @14,MAINBOD2                                        0155
*         CALL PRNTBOD2;            /* PRINT 2ND PART OF REPORT    0156
*                                                            #Y30LB14*/
         BAL   @14,PRNTBOD2                                        0156
*         OUTBUF2(1:25)=MSG17;      /*                       #Y30LB14*/
         MVC   OUTBUF2(25,R4),MSG17                                0157
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0158
*         CALL PRINT1;              /* PUT OUT BLANK LINE    #Y30LB14*/
         BAL   @14,PRINT1                                          0159
*         DO J=1 TO 4;              /*                       #Y30LB14*/
         LA    J,1                                                 0160
@DL00160 DS    0H                                                  0161
*           MSG18(34:54)='';        /*                       #Y30LB14*/
         MVI   MSG18+33,C' '                                       0161
         MVC   MSG18+34(20),MSG18+33                               0161
*           IF LOWSPEC(I,J)='0'B THEN                              0162
         LR    @06,I                                               0162
         SLA   @06,2                                               0162
         ALR   @06,J                                               0162
         ALR   @06,@06                                             0162
         ALR   @06,R4                                              0162
         TM    LOWSPEC-10(@06),B'10000000'                         0162
         BNZ   @RF00162                                            0162
*             DO;                   /*                       #Y30LB14*/
*               MSG18(35:36)=CNTRTABL(J);/*                  #Y30LB14*/
         LR    @06,J                                               0164
         ALR   @06,@06                                             0164
         LA    @01,CNTRTABL-2(@06)                                 0164
         MVC   MSG18+34(2),0(@01)                                  0164
*               MSG18(38:46)='IS UNUSED';/*                  #Y30LB14*/
         MVC   MSG18+37(9),@CC00498                                0165
*               OUTBUF2(1:46)=MSG18;/*                       #Y30LB14*/
         MVC   OUTBUF2(46,R4),MSG18                                0166
*               CALL PRINT1;        /* PRINT A LINE          #Y30LB14*/
         BAL   @14,PRINT1                                          0167
*             END;                  /*                       #Y30LB14*/
*           ELSE                                                   0169
*             DO;                   /*                       #Y30LB14*/
         B     @RC00162                                            0169
@RF00162 DS    0H                                                  0170
*               CALL SETMSG18;      /* SET UP MESSAGE 18     #Y30LB14*/
         BAL   @14,SETMSG18                                        0170
*               CALL LIBSIZE1;      /* USED IF LIB SIZE=1    #Y30LB14*/
         BAL   @14,LIBSIZE1                                        0171
*               CALL LIBSIZE2;      /* USED IF LIB SIZE=2    #Y30LB14*/
         BAL   @14,LIBSIZE2                                        0172
*               CALL LIBSIZE3;      /* USED IF LIB SIZE=3    #Y30LB14*/
         BAL   @14,LIBSIZE3                                        0173
*             END;                  /*                       #Y30LB14*/
*         END;                      /*                       #Y30LB14*/
@RC00162 AH    J,@CH00044                                          0175
         CH    J,@CH00070                                          0175
         BNH   @DL00160                                            0175
*       END;                        /*                       #Y30LB14*/
*   END;                            /*                       #Y30LB14*/
*                                                                  0177
@RF00109 AH    I,@CH00044                                          0177
         CH    I,@CH00164                                          0177
         BNH   @DL00108                                            0177
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00152*/
*   /* SET TO SKIP TO NEW PAGE WHEN REPORTS ARE              @YD00152*/
*   /* COMPLETE                                              @YD00152*/
*   /* ***********************************************       @YD00152*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*   LINECTR=LINECT;                 /*                       @YD00152*/
         MVC   LINECTR(2,R4),LINECT(R4)                            0178
*   RETURN;                         /* RETURN TO BUILD       #Y30LB14*/
@EL00001 L     @13,4(,@13)                                         0179
@EF00001 L     @00,@SIZDATD                                        0179
         LR    @01,@12                                             0179
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0179
         BR    @14                                                 0179
*                                                                  0180
*/***********************************************************#Y30LB14*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - ZEROMSG                                 @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE SETS MSG16 TO BLANKS ('40'X)     @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************#Y30LB14*/
*                                                                  0180
*ZEROMSG:                                                          0180
*   PROCEDURE;                      /*                       #Y30LB14*/
ZEROMSG  STM   @14,@12,12(@13)                                     0180
*   DO L=0 TO 7;                    /*                       #Y30LB14*/
         SLR   L,L                                                 0181
@DL00181 DS    0H                                                  0182
*     MSG16(103*L+1:103*L+103)='';  /*                       #Y30LB14*/
         LR    @05,L                                               0182
         MH    @05,@CH00329                                        0182
         LA    @02,MSG16(@05)                                      0182
         MVI   0(@02),C' '                                         0182
         MVC   1(102,@02),0(@02)                                   0182
*   END;                            /*                       #Y30LB14*/
         AH    L,@CH00044                                          0183
         CH    L,@CH00135                                          0183
         BNH   @DL00181                                            0183
*   END ZEROMSG;                    /*                       #Y30LB14*/
@EL00002 DS    0H                                                  0184
@EF00002 DS    0H                                                  0184
@ER00002 LM    @14,@12,12(@13)                                     0184
         BR    @14                                                 0184
*                                                                  0185
*/***********************************************************#Y30LB14*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - CPUIDCUA                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE DETERMINES THE CPU ID AND        @XD00153*/
*/*            CHANNEL UNIT ADDRESS FOR THE SECOND PART OF   @XD00153*/
*/*            THE REPORT.  IF THE INTERFACE IS NOT USED,    @XD00153*/
*/*            A MESSAGE TO THAT EFFECT IS PRINTED.          @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************#Y30LB14*/
*                                                                  0185
*CPUIDCUA:                                                         0185
*   PROCEDURE;                      /*                       #Y30LB14*/
*                                                                  0185
CPUIDCUA STM   @14,@12,@SA00003                                    0185
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00152*/
*   /* SPACE TWO BEFORE PRINTING 'A' INTERFACE.              @OZ09549*/
*   /* ***********************************************       @YD00152*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0186
*   OUTBUF2(1)='0';                 /*                       @YD00152*/
*                                                                  0186
         MVI   OUTBUF2(R4),C'0'                                    0186
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00152*/
*   /* PRINT 'A','B','C' AND 'D' CHANNEL INTERFACES.         @OZ09549*/
*   /* ***********************************************       @YD00152*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0187
*   IF I<8                          /* PLUG ADDR. = 2ND CHAR. OF SSID
*                                                            @OZ09549*/
*     THEN                                                         0187
         CH    I,@CH00042                                          0187
         BNL   @RF00187                                            0187
*     DO;                                                          0188
*       MSG22(30)=TABLE(1);         /* PORT 0                @OZ09549*/
         MVC   MSG22+29(1),TABLE                                   0189
*       MSG22(54:56)=TABLE4(I);     /*                       @OZ09549*/
         LR    @15,I                                               0190
         MH    @15,@CH00050                                        0190
         LA    @14,TABLE4-3(@15)                                   0190
         MVC   MSG22+53(3),0(@14)                                  0190
*       OUTBUF2(1:56)=MSG22;        /*                       @OZ09549*/
         MVC   OUTBUF2(56,R4),MSG22                                0191
*       CALL PRINT1;                /*                       @OZ09549*/
         BAL   @14,PRINT1                                          0192
*     END;                                                         0193
*   ELSE                                                           0194
*     DO;                                                          0194
         B     @RC00187                                            0194
@RF00187 DS    0H                                                  0195
*       MSG22(30)=TABLE(2);         /* PORT 1                @OZ09549*/
         MVC   MSG22+29(1),TABLE+1                                 0195
*       MSG22(54:56)=TABLE4(I);     /*                       @OZ09549*/
         LR    @15,I                                               0196
         MH    @15,@CH00050                                        0196
         LA    @14,TABLE4-3(@15)                                   0196
         MVC   MSG22+53(3),0(@14)                                  0196
*       OUTBUF2(1:56)=MSG22;        /*                       @OZ09549*/
         MVC   OUTBUF2(56,R4),MSG22                                0197
*       CALL PRINT1;                /* PRINT INT. A LINE     @OZ09549*/
         BAL   @14,PRINT1                                          0198
*     END;                                                         0199
*   DO L=1 TO 3;                    /*                       #Y30LB14*/
@RC00187 LA    L,1                                                 0200
@DL00200 DS    0H                                                  0201
*     IF CISPEC((I-1)*3+L)='1'B THEN                               0201
         LR    @02,I                                               0201
         BCTR  @02,0                                               0201
         MH    @02,@CH00050                                        0201
         ALR   @02,L                                               0201
         MH    @02,@CH00114                                        0201
         L     @15,COMPTR2(,R4)                                    0201
         ST    @02,@TF00001                                        0201
         ALR   @02,@15                                             0201
         TM    CISPEC-9(@02),B'10000000'                           0201
         BNO   @RF00201                                            0201
*       DO;                         /*                       #Y30LB14*/
*         MSG11(14)=TABLE(11+L);    /*                       #Y30LB14*/
         LA    @02,TABLE+10(L)                                     0203
         MVC   MSG11+13(1),0(@02)                                  0203
*         PACKED(1:6)=RSGCPUID((I-1)*3+L);/*                 #Y30LB14*/
         MVI   PACKED+5,C' '                                       0204
         AL    @15,@TF00001                                        0204
         MVC   PACKED(5),RSGCPUID-9(@15)                           0204
*         PACKED(6)='0F'X;          /*                       #Y30LB14*/
         MVI   PACKED+5,X'0F'                                      0205
*         GEN(UNPK UNPACKED(11),PACKED(6));/*                #Y30LB14*/
         UNPK UNPACKED(11),PACKED(6)
*         MSG11(23:32)=UNPACKED(1:10);/*                     #Y30LB14*/
         MVC   MSG11+22(10),UNPACKED                               0207
*         MSG11(43)=TABLE(RSGCHAN((I-1)*3+L)+1);                   0208
         LR    @02,I                                               0208
         BCTR  @02,0                                               0208
         MH    @02,@CH00050                                        0208
         ALR   @02,L                                               0208
         MH    @02,@CH00114                                        0208
         L     @15,COMPTR2(,R4)                                    0208
         SLR   @14,@14                                             0208
         IC    @14,RSGCHAN-9(@02,@15)                              0208
         LA    @01,TABLE(@14)                                      0208
         MVC   MSG11+42(1),0(@01)                                  0208
*         MSG11(67)=TABLE((RSGCUA((I-1)*3+L)/2)//2+1);             0209
         SLR   @14,@14                                             0209
         IC    @14,RSGCUA-9(@02,@15)                               0209
         LR    @02,@14                                             0209
         SRL   @02,1                                               0209
         LR    @00,@02                                             0209
         SRDA  @00,32                                              0209
         D     @00,@CF00052                                        0209
         LR    @02,@00                                             0209
         LA    @01,TABLE(@02)                                      0209
         MVC   MSG11+66(1),0(@01)                                  0209
*         MSG11(68)=TABLE(RSGCUA((I-1)*3+L)//2+1);                 0210
         SRDA  @14,32                                              0210
         D     @14,@CF00052                                        0210
         LA    @02,TABLE(@14)                                      0210
         MVC   MSG11+67(1),0(@02)                                  0210
*         OUTBUF2(2:69)=MSG11;      /*                       #XM01739*/
         MVC   OUTBUF2+1(68,R4),MSG11                              0211
*       END;                        /*                       #Y30LB14*/
*     ELSE                                                         0213
*       DO;                         /*                       #Y30LB14*/
         B     @RC00201                                            0213
@RF00201 DS    0H                                                  0214
*         MSG21(14)=TABLE(11+L);    /*                       #Y30LB14*/
         LA    @02,TABLE+10(L)                                     0214
         MVC   MSG21+13(1),0(@02)                                  0214
*         OUTBUF2(2:27)=MSG21;      /*                       #XM01739*/
         MVC   OUTBUF2+1(26,R4),MSG21                              0215
*       END;                        /*                       #Y30LB14*/
*     CALL PRINT1;                  /* PRINT A LINE          #Y30LB14*/
@RC00201 BAL   @14,PRINT1                                          0217
*   END;                            /*                       #Y30LB14*/
         AH    L,@CH00044                                          0218
         CH    L,@CH00050                                          0218
         BNH   @DL00200                                            0218
*   END CPUIDCUA;                   /*                       #Y30LB14*/
@EL00003 DS    0H                                                  0219
@EF00003 DS    0H                                                  0219
@ER00003 LM    @14,@12,@SA00003                                    0219
         BR    @14                                                 0219
*                                                                  0220
*/***********************************************************#Y30LB14*/
*/* THIS ROUTINE DETERMINES THE SHARED SA'S                  #Y30LB14*/
*/* IF THE SHARED STAGING ADAPTER IS DEFINED, THEN 'SHARED   #Y30LB14*/
*/* SA @' IS PUT IN THE PROPER COLUMN OF MSG13.              #Y30LB14*/
*/***********************************************************#Y30LB14*/
*                                                                  0220
*SHAREDSA:                                                         0220
*   PROCEDURE;                      /*                       #Y30LB14*/
SHAREDSA STM   @14,@12,12(@13)                                     0220
*   DO J=1 TO 4;                    /*                       #Y30LB14*/
         LA    J,1                                                 0221
@DL00221 DS    0H                                                  0222
*     IF PHYSDS2(I,J)^='FF'X THEN                                  0222
         LR    @03,I                                               0222
         SLA   @03,2                                               0222
         ALR   @03,J                                               0222
         ST    @03,@TF00001                                        0222
         ALR   @03,R4                                              0222
         CLI   PHYSDS2-5(@03),X'FF'                                0222
         BE    @RF00222                                            0222
*       DO;                         /*                       #Y30LB14*/
*         MSG13(J*24-11:J*24+1)='(SHARED SA  )';                   0224
         LR    @03,J                                               0224
         MH    @03,@CH00269                                        0224
         LA    @01,MSG13-12(@03)                                   0224
         MVC   0(13,@01),@CC00521                                  0224
*         MSG13(J*24)=TABLE(PHYSDS2(I,J)+1);/*               #Y30LB14*/
         LA    @01,MSG13-1(@03)                                    0225
         L     @03,@TF00001                                        0225
         SLR   @15,@15                                             0225
         IC    @15,PHYSDS2-5(@03,R4)                               0225
         LA    @03,TABLE(@15)                                      0225
         MVC   0(1,@01),0(@03)                                     0225
*       END;                        /*                       #Y30LB14*/
*   END;                            /*                       #Y30LB14*/
@RF00222 AH    J,@CH00044                                          0227
         CH    J,@CH00070                                          0227
         BNH   @DL00221                                            0227
*   END SHAREDSA;                   /*                       #Y30LB14*/
@EL00004 DS    0H                                                  0228
@EF00004 DS    0H                                                  0228
@ER00004 LM    @14,@12,12(@13)                                     0228
         BR    @14                                                 0228
*                                                                  0229
*/***********************************************************#Y30LB14*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - MAINBOD2                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS IS THE ROUTINE FOR THE MAIN BODY OF THE  @XD00153*/
*/*            REPORT.  ZEROMSG IS CALLED TO ZERO OUT MSG16. @XD00153*/
*/*            THE PLUG NUMBER IS INSERTED AND THEN A CHECK  @XD00153*/
*/*            IS MADE TO SEE IF THE UNIT IS A MERLIN.  IF   @XD00153*/
*/*            IT IS, 3330-1 IS PLACED IN THE TYPE COLUMN.   @XD00153*/
*/*            IF THE UNIT IS AN ICEBERG, 3330-11 IS PLACED  @XD00153*/
*/*            IN THE TYPE COLUMN. IF IT IS NEITHER OF THOSE @XD00153*/
*/*            2 DEVICES, THEN ***** IS PLACED IN THE TYPE   @XD00153*/
*/*            COLUMN.  IF ALL 8 LINES CONTAIN *****, THEN   @XD00153*/
*/*            THESE ARE REPLACED WITH BLANKS.  THE SSID IS  @XD00153*/
*/*            THEN DETERMINED AND PLACED IN THE SSID        @XD00153*/
*/*            POSITIONS.  IF THERE IS NO SSID, THEN *** IS  @XD00153*/
*/*            INSERTED.  IF ALL 8 LINES ARE ***, THEY ARE   @XD00153*/
*/*            REPLACED WITH BLANKS.                         @XD00153*/
*/*            NOTE:  MSG16 CONTAINS THE INFORMATION FOR ALL @XD00153*/
*/*            8 LINES WHEN THIS ROUTINE RETURNS.            @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0229
*MAINBOD2:                                                         0229
*   PROCEDURE;                      /*                       @XD00153*/
MAINBOD2 STM   @14,@02,@SA00005                                    0229
         STM   @04,@06,@SA00005+20                                 0229
         STM   @08,@12,@SA00005+32                                 0229
*   CALL ZEROMSG;                   /* ZERO OUT MESSAGE      @XD00153*/
         BAL   @14,ZEROMSG                                         0230
*   DO J=1 TO 4;                    /*                       @XD00153*/
         LA    J,1                                                 0231
@DL00231 DS    0H                                                  0232
*     DO K=1 TO 8;                  /*                       @XD00153*/
         LA    K,1                                                 0232
@DL00232 DS    0H                                                  0233
*       MSG16(103*K+24*J-112)=TABLE(K);/*                    @XD00153*/
         LR    @15,K                                               0233
         MH    @15,@CH00329                                        0233
         LR    @14,J                                               0233
         MH    @14,@CH00269                                        0233
         ALR   @15,@14                                             0233
         LA    @14,MSG16-113(@15)                                  0233
         LA    @01,TABLE-1(K)                                      0233
         MVC   0(1,@14),0(@01)                                     0233
*       IF MERLICEB(I,J,K)=PHYSFMER /*                       #X50RSPC*/
*         THEN                                                     0234
         LR    @14,I                                               0234
         SLA   @14,2                                               0234
         ALR   @14,J                                               0234
         SLA   @14,3                                               0234
         ALR   @14,K                                               0234
         ALR   @14,@14                                             0234
         ALR   @14,R4                                              0234
         TM    MERLICEB-82(@14),B'10000000'                        0234
         BNO   @RF00234                                            0234
         TM    MERLICEB-82(@14),B'01000000'                        0234
         BNZ   @RF00234                                            0234
*         DO;                       /*                       @XD00153*/
*           MSG16(103*K+24*J-108:103*K+24*J-103)='3330-1';/* @XD00153*/
         LA    @14,MSG16-109(@15)                                  0236
         MVC   0(6,@14),@CC00528                                   0236
*         END;                      /*                       @XD00153*/
*       IF MERLICEB(I,J,K)=PHYSFICE /*                       #X50RSPC*/
*         THEN                                                     0238
@RF00234 LR    @15,I                                               0238
         SLA   @15,2                                               0238
         ALR   @15,J                                               0238
         SLA   @15,3                                               0238
         ALR   @15,K                                               0238
         ALR   @15,@15                                             0238
         ALR   @15,R4                                              0238
         TM    MERLICEB-82(@15),B'01000000'                        0238
         BNO   @RF00238                                            0238
         TM    MERLICEB-82(@15),B'10000000'                        0238
         BNZ   @RF00238                                            0238
*         DO;                       /*                       @XD00153*/
*           MSG16(103*K+24*J-108:103*K+24*J-102)='3330-11';/*      0240
*                                                            @XD00153*/
         LR    @15,K                                               0240
         MH    @15,@CH00329                                        0240
         LR    @14,J                                               0240
         MH    @14,@CH00269                                        0240
         ALR   @15,@14                                             0240
         LA    @14,MSG16-109(@15)                                  0240
         MVC   0(7,@14),@CC00530                                   0240
*         END;                      /*                       @XD00153*/
*       IF MERLICEB(I,J,K)=PHYSFMAD /*                       #X50RSPC*/
*         THEN                      /*                       #X50RSPC*/
@RF00238 LR    @15,I                                               0242
         SLA   @15,2                                               0242
         ALR   @15,J                                               0242
         SLA   @15,3                                               0242
         ALR   @15,K                                               0242
         ALR   @15,@15                                             0242
         ALR   @15,R4                                              0242
         TM    MERLICEB-82(@15),B'11000000'                        0242
         BNO   @RF00242                                            0242
*         DO;                       /*                       #X50RSPC*/
*           MSG16(103*K+24*J-108:103*K+24*J-105)='3350';/*   #X50RSPC*/
         LR    @15,K                                               0244
         MH    @15,@CH00329                                        0244
         LR    @14,J                                               0244
         MH    @14,@CH00269                                        0244
         ALR   @15,@14                                             0244
         LA    @14,MSG16-109(@15)                                  0244
         MVC   0(4,@14),@CC00532                                   0244
*         END;                      /*                       #X50RSPC*/
*       IF MSG16(103*K+24*J-108)=' '/*                       @XD00153*/
*         THEN                                                     0246
@RF00242 LR    @15,K                                               0246
         MH    @15,@CH00329                                        0246
         LR    @14,J                                               0246
         MH    @14,@CH00269                                        0246
         ALR   @15,@14                                             0246
         LA    @14,MSG16-109(@15)                                  0246
         CLI   0(@14),C' '                                         0246
         BNE   @RF00246                                            0246
*         DO;                       /*                       @XD00153*/
*           MSG16(103*K+24*J-108:103*K+24*J-103)='*****';/*  @XD00153*/
         LA    @14,MSG16-109(@15)                                  0248
         MVI   5(@14),C' '                                         0248
         MVC   0(5,@14),@CC00534                                   0248
*           SWITCH1=SWITCH1+1;      /*                       @XD00153*/
         LA    SWITCH1,1(,SWITCH1)                                 0249
*         END;                      /*                       @XD00153*/
*       IF PHYSSSID(I,J,K)='1'B THEN                               0251
@RF00246 LR    @15,I                                               0251
         SLA   @15,2                                               0251
         ALR   @15,J                                               0251
         SLA   @15,3                                               0251
         ALR   @15,K                                               0251
         ALR   @15,@15                                             0251
         ST    @15,@TF00001                                        0251
         ALR   @15,R4                                              0251
         TM    PHYSSSID-82(@15),B'00010000'                        0251
         BNO   @RF00251                                            0251
*         DO;                       /*                       @XD00153*/
*           MSG16(103*K+24*J-98)='0';/*                      @XD00153*/
         LR    @15,K                                               0253
         MH    @15,@CH00329                                        0253
         LR    @14,J                                               0253
         MH    @14,@CH00269                                        0253
         ALR   @15,@14                                             0253
         LA    @14,MSG16-99(@15)                                   0253
         MVI   0(@14),C'0'                                         0253
*           MSG16(103*K+24*J-97)=TABLE((SPNRSGNO(I,J,K)/2)//16+1);/*
*                                                            @XD00153*/
         LA    @14,MSG16-98(@15)                                   0254
         L     @01,@TF00001                                        0254
         SLR   @09,@09                                             0254
         IC    @09,SPNRSGNO-82(@01,R4)                             0254
         LR    @08,@09                                             0254
         SRL   @08,1                                               0254
         ST    @09,@TF00002                                        0254
         SRDA  @08,32                                              0254
         D     @08,@CF00164                                        0254
         LA    @09,TABLE(@08)                                      0254
         MVC   0(1,@14),0(@09)                                     0254
*           MSG16(103*K+24*J-96)=TABLE((SPNRSGNO(I,J,K)//2)*8+PHYSFLGS(
*               I,J,K)//8+1);       /*                       @XD00153*/
         LA    @14,MSG16-97(@15)                                   0255
         L     @00,@TF00002                                        0255
         SRDA  @00,32                                              0255
         D     @00,@CF00052                                        0255
         SLA   @00,3                                               0255
         L     @01,@TF00001                                        0255
         SLR   @08,@08                                             0255
         IC    @08,PHYSFLGS-82(@01,R4)                             0255
         SRDA  @08,32                                              0255
         D     @08,@CF00042                                        0255
         ALR   @00,@08                                             0255
         LR    @15,@00                                             0255
         LA    @01,TABLE(@15)                                      0255
         MVC   0(1,@14),0(@01)                                     0255
*         END;                      /*                       @XD00153*/
*       ELSE                                                       0257
*         DO;                       /*                       @XD00153*/
         B     @RC00251                                            0257
@RF00251 DS    0H                                                  0258
*           MSG16(103*K+24*J-98:103*K+24*J-96)='***';              0258
         LR    @15,K                                               0258
         MH    @15,@CH00329                                        0258
         LR    @14,J                                               0258
         MH    @14,@CH00269                                        0258
         ALR   @15,@14                                             0258
         LA    @14,MSG16-99(@15)                                   0258
         MVC   0(3,@14),@CC00536                                   0258
*           SWITCH=SWITCH+1;        /*                       @XD00153*/
         LA    SWITCH,1(,SWITCH)                                   0259
*         END;                      /*                       @XD00153*/
*     END;                          /*                       @XD00153*/
@RC00251 AH    K,@CH00044                                          0261
         CH    K,@CH00042                                          0261
         BNH   @DL00232                                            0261
*     IF SWITCH=8 THEN                                             0262
         CH    SWITCH,@CH00042                                     0262
         BNE   @RF00262                                            0262
*       DO K=1 TO 8;                /*                       @XD00153*/
         LA    K,1                                                 0263
@DL00263 DS    0H                                                  0264
*         MSG16(103*K+24*J-98:103*K+24*J-96)='';                   0264
         LR    @03,K                                               0264
         MH    @03,@CH00329                                        0264
         LR    @15,J                                               0264
         MH    @15,@CH00269                                        0264
         ALR   @03,@15                                             0264
         LA    @01,MSG16-99(@03)                                   0264
         MVI   0(@01),C' '                                         0264
         MVC   1(2,@01),0(@01)                                     0264
*       END;                        /*                       @XD00153*/
         AH    K,@CH00044                                          0265
         CH    K,@CH00042                                          0265
         BNH   @DL00263                                            0265
*     IF SWITCH1=8 THEN                                            0266
@RF00262 CH    SWITCH1,@CH00042                                    0266
         BNE   @RF00266                                            0266
*       DO K=1 TO 8;                /*                       @XD00153*/
         LA    K,1                                                 0267
@DL00267 DS    0H                                                  0268
*         MSG16(103*K+24*J-108:103*K+24*J-103)='';                 0268
         LR    @07,K                                               0268
         MH    @07,@CH00329                                        0268
         LR    @03,J                                               0268
         MH    @03,@CH00269                                        0268
         ALR   @07,@03                                             0268
         LA    @03,MSG16-109(@07)                                  0268
         MVI   0(@03),C' '                                         0268
         MVC   1(5,@03),0(@03)                                     0268
*       END;                        /*                       @XD00153*/
         AH    K,@CH00044                                          0269
         CH    K,@CH00042                                          0269
         BNH   @DL00267                                            0269
*     SWITCH=0;                     /*                       @XD00153*/
@RF00266 SLR   SWITCH,SWITCH                                       0270
*     SWITCH1=0;                    /*                       @XD00153*/
         SLR   SWITCH1,SWITCH1                                     0271
*   END;                            /*                       @XD00153*/
         AH    J,@CH00044                                          0272
         CH    J,@CH00070                                          0272
         BNH   @DL00231                                            0272
*   END MAINBOD2;                   /*                       @XD00153*/
@EL00005 DS    0H                                                  0273
@EF00005 DS    0H                                                  0273
@ER00005 LM    @14,@02,@SA00005                                    0273
         LM    @04,@06,@SA00005+20                                 0273
         LM    @08,@12,@SA00005+32                                 0273
         BR    @14                                                 0273
*                                                                  0274
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - PRNTBOD2                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE PRINTS THE MAIN BODY OF THE      @XD00153*/
*/*            SECOND PART OF THE REPORT.  MSG16 IS BROKEN   @XD00153*/
*/*            INTO 8 SEGMENTS AND PRINTED BY A CALL TO      @XD00153*/
*/*            PRINT1.                                       @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0274
*PRNTBOD2:                                                         0274
*   PROCEDURE;                      /*                       @XD00153*/
PRNTBOD2 STM   @14,@12,@SA00006                                    0274
*   DO L=0 TO 7;                    /*                       @XD00153*/
         SLR   L,L                                                 0275
@DL00275 DS    0H                                                  0276
*     OUTBUF2(1:103)=MSG16(103*L+1:103*L+103);/*             @XD00153*/
         LR    @05,L                                               0276
         MH    @05,@CH00329                                        0276
         LA    @02,MSG16(@05)                                      0276
         MVC   OUTBUF2(103,R4),0(@02)                              0276
*     CALL PRINT1;                  /* PRINT A LINE          @XD00153*/
         BAL   @14,PRINT1                                          0277
*   END;                            /*                       @XD00153*/
         AH    L,@CH00044                                          0278
         CH    L,@CH00135                                          0278
         BNH   @DL00275                                            0278
*   END PRNTBOD2;                   /*                       @XD00153*/
@EL00006 DS    0H                                                  0279
@EF00006 DS    0H                                                  0279
@ER00006 LM    @14,@12,@SA00006                                    0279
         BR    @14                                                 0279
*                                                                  0280
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - CHECKDS2                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE CHECKS TO SEE IF THE SECOND DATA @XD00153*/
*/*            STAGER IS THERE. IF IT IS NOT, THEN THE SHORT @XD00153*/
*/*            FORM OF THE HEADERS ARE USED FOR THE REPORT.  @XD00153*/
*/*            MSG3 & MSG4 ARE USED FOR THE LONG FORM, OR    @XD00153*/
*/*            MSG7 & MSG8 ARE USED FOR THE SHORT FORM.      @XD00153*/
*/*            CALLS ARE MADE TO 'GETCPUID' TO UNPACK THE    @XD00153*/
*/*            CPU ID AND PLACE IT IN THE APPROPRIATE        @XD00153*/
*/*            MESSAGE AND IN THE APPROPRIATE PLACE.         @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0280
*CHECKDS2:                                                         0280
*   PROCEDURE;                      /*                       @XD00153*/
CHECKDS2 STM   @14,@12,@SA00007                                    0280
*   CONTRLR=CNTRTABL(J);            /* SET CONTROLLER VALUE  @XD00153*/
         LR    @03,J                                               0281
         ALR   @03,@03                                             0281
         LA    @01,CNTRTABL-2(@03)                                 0281
         MVC   CONTRLR(2),0(@01)                                   0281
*   OUTBUF2(1:19)=MSG2;             /*                       @Y30LB14*/
         MVC   OUTBUF2(19,R4),MSG2                                 0282
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0283
*   LINECTR=LINECTR+1;              /* ACCOUNT FOR BLANK LINE      0284
*                                                            @Y30LB14*/
         LA    @03,1                                               0284
         AH    @03,LINECTR(,R4)                                    0284
         STH   @03,LINECTR(,R4)                                    0284
*   MSG3(53)=TABLE(I);              /* SET 1ST DATA STAGER NUMBER  0285
*                                                            @Y30LB14*/
         LA    @03,TABLE-1(I)                                      0285
         MVC   MSG3+52(1),0(@03)                                   0285
*   MSG7(53)=TABLE(I);              /*                       @Y30LB14*/
         LA    @03,TABLE-1(I)                                      0286
         MVC   MSG7+52(1),0(@03)                                   0286
*   IF PHYSDS2(I,J)='FF'X THEN                                     0287
         LR    @03,I                                               0287
         SLA   @03,2                                               0287
         ALR   @03,J                                               0287
         ALR   @03,R4                                              0287
         CLI   PHYSDS2-5(@03),X'FF'                                0287
         BNE   @RF00287                                            0287
*     DO;                           /*                       @Y30LB14*/
*       OUTBUF2(1:62)=MSG7;         /*                       @Y30LB14*/
         MVC   OUTBUF2(62,R4),MSG7                                 0289
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0290
*       OUTBUF2(1:60)=MSG8;         /*                       @Y30LB14*/
         MVC   OUTBUF2(60,R4),MSG8                                 0291
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0292
*       N=17;                       /* OFFSET IN OUTPUT LINE @Y30LB14*/
         LA    N,17                                                0293
*       M=I;                        /* INDEX FOR RSGCPUID    @Y30LB14*/
         LR    M,I                                                 0294
*     END;                          /*                       @Y30LB14*/
*   ELSE                            /* 2ND DS AVAIL, LONG FORMAT USED
*                                                            @Y30LB14*/
*     DO;                           /*                       @Y30LB14*/
         B     @RC00287                                            0296
@RF00287 DS    0H                                                  0297
*       MSG3(92)=TABLE(PHYSDS2(I,J)+1);/*                    @Y30LB14*/
         LR    @03,I                                               0297
         SLA   @03,2                                               0297
         ALR   @03,J                                               0297
         SLR   @01,@01                                             0297
         IC    @01,PHYSDS2-5(@03,R4)                               0297
         LA    @03,TABLE(@01)                                      0297
         MVC   MSG3+91(1),0(@03)                                   0297
*       OUTBUF2(1:101)=MSG3;        /*                       @Y30LB14*/
         MVC   OUTBUF2(101,R4),MSG3                                0298
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0299
*       OUTBUF2(1:99)=MSG4;         /*                       @Y30LB14*/
         MVC   OUTBUF2(99,R4),MSG4                                 0300
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0301
*       LINECTR=LINECTR+1;          /* ACCNT FOR BLNK LN     @Y30LB14*/
         LA    @09,1                                               0302
         AH    @09,LINECTR(,R4)                                    0302
         STH   @09,LINECTR(,R4)                                    0302
*       N=17;                       /* OFFSET IN OUTPUT LINE @Y30LB14*/
         LA    N,17                                                0303
*       M=I;                        /* INDEX FOR RSGCPUID    @Y30LB14*/
         LR    M,I                                                 0304
*       CALL GETCPUID;              /* GET CPU ID            @Y30LB14*/
         BAL   @14,GETCPUID                                        0305
*       N=56;                       /* OFFSET FOR 2ND SET CPUIDS   0306
*                                                            @Y30LB14*/
         LA    N,56                                                0306
*       M=PHYSDS2(I,J)+1;           /*                       @Y30LB14*/
         LR    @09,I                                               0307
         SLA   @09,2                                               0307
         ALR   @09,J                                               0307
         LA    M,1                                                 0307
         ALR   @09,R4                                              0307
         MVC   @ZT00003+3(1),PHYSDS2-5(@09)                        0307
         AL    M,@ZT00003                                          0307
*     END;                          /*                       @Y30LB14*/
*   CALL GETCPUID;                  /* GET CPU ID            @Y30LB14*/
@RC00287 BAL   @14,GETCPUID                                        0309
*   OUTBUF2(1:101)=MSG5;            /* CPUID LINE            @Y30LB14*/
         MVC   OUTBUF2(101,R4),MSG5                                0310
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/
         BAL   @14,PRINT1                                          0311
*   CPUIDS='';                      /* BLANK OUT CPUIDS IN MSG5    0312
*                                                            @Y30LB14*/
*                                                                  0312
         MVI   CPUIDS,C' '                                         0312
         MVC   CPUIDS+1(73),CPUIDS                                 0312
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CALL PROCEDURE PRTOPSYS TO DETERMINE WHICH            @ZD02028*/
*   /* OPERATING SYSTEM IS TO USE THIS CPU.                  @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*   CALL PRTOPSYS;                  /*                       @ZD02028*/
         BAL   @14,PRTOPSYS                                        0313
*   END CHECKDS2;                   /*                       @Y30LB14*/
@EL00007 DS    0H                                                  0314
@EF00007 DS    0H                                                  0314
@ER00007 LM    @14,@12,@SA00007                                    0314
         BR    @14                                                 0314
*                                                                  0315
*/********************************************************** @ZD02028*/
*/*                                                          @ZD02028*/
*/* PROCEDURE NAME - PRTOPSYS                                @ZD02028*/
*/*                                                          @ZD02028*/
*/* FUNCTION - DETERMINE WHICH OPERATING SYSTEM WAS          @ZD02028*/
*/*            SPECIFIED FOR THIS CPU, AND PRINT THE         @ZD02028*/
*/*            DESIGNATION UNDER THE CPUID.                  @ZD02028*/
*/*                                                          @ZD02028*/
*/********************************************************** @ZD02028*/
*                                                                  0315
*PRTOPSYS:                                                         0315
*   PROCEDURE;                      /*                       @ZD02028*/
PRTOPSYS STM   @14,@12,@SA00008                                    0315
*   M=(I-1)*3;                      /*                       @ZD02028*/
*                                                                  0316
         LR    M,I                                                 0316
         BCTR  M,0                                                 0316
         MH    M,@CH00050                                          0316
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'B' FOR FIRST STAGING               @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0317
*   IF CISPEC(M+1)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
         LR    @06,M                                               0317
         MH    @06,@CH00114                                        0317
         L     @03,COMPTR2(,R4)                                    0317
         ST    @06,@TF00001                                        0317
         ALR   @06,@03                                             0317
         TM    CISPEC(@06),B'10000000'                             0317
         BNO   @RF00317                                            0317
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0319
         SLR   @15,@15                                             0319
         IC    @15,CPUREFNO(@06,@03)                               0319
         SLA   @15,3                                               0319
         ALR   @15,R4                                              0319
         TM    OPVS1(@15),B'00010000'                              0319
         BNO   @RF00319                                            0319
*         OUTBUF2(31:36)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+30(6,R4),@CC00550                           0320
*       IF OPVS2(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00319 LR    @06,M                                               0321
         MH    @06,@CH00114                                        0321
         L     @03,COMPTR2(,R4)                                    0321
         SLR   @15,@15                                             0321
         IC    @15,CPUREFNO(@06,@03)                               0321
         SLA   @15,3                                               0321
         ALR   @15,R4                                              0321
         TM    OPVS2(@15),B'00001000'                              0321
         BNO   @RF00321                                            0321
*         OUTBUF2(31:36)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+30(6,R4),@CC00551                           0322
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0324
*     ;                             /*                       @ZD02028*/
*                                                                  0324
@RF00317 DS    0H                                                  0325
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'C' FOR FIRST STAGING               @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IF CISPEC(M+2)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
@RC00317 LR    @06,M                                               0325
         MH    @06,@CH00114                                        0325
         L     @03,COMPTR2(,R4)                                    0325
         ST    @06,@TF00001                                        0325
         ALR   @06,@03                                             0325
         TM    CISPEC+9(@06),B'10000000'                           0325
         BNO   @RF00325                                            0325
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0327
         SLR   @15,@15                                             0327
         IC    @15,CPUREFNO+9(@06,@03)                             0327
         SLA   @15,3                                               0327
         ALR   @15,R4                                              0327
         TM    OPVS1(@15),B'00010000'                              0327
         BNO   @RF00327                                            0327
*         OUTBUF2(43:48)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+42(6,R4),@CC00550                           0328
*       IF OPVS2(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00327 LR    @06,M                                               0329
         MH    @06,@CH00114                                        0329
         L     @03,COMPTR2(,R4)                                    0329
         SLR   @15,@15                                             0329
         IC    @15,CPUREFNO+9(@06,@03)                             0329
         SLA   @15,3                                               0329
         ALR   @15,R4                                              0329
         TM    OPVS2(@15),B'00001000'                              0329
         BNO   @RF00329                                            0329
*         OUTBUF2(43:48)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+42(6,R4),@CC00551                           0330
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0332
*     ;                             /*                       @ZD02028*/
*                                                                  0332
@RF00325 DS    0H                                                  0333
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'D' FOR FIRST STAGING               @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0333
*   IF CISPEC(M+3)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
@RC00325 LR    @06,M                                               0333
         MH    @06,@CH00114                                        0333
         L     @03,COMPTR2(,R4)                                    0333
         ST    @06,@TF00001                                        0333
         ALR   @06,@03                                             0333
         TM    CISPEC+18(@06),B'10000000'                          0333
         BNO   @RF00333                                            0333
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0335
         SLR   @15,@15                                             0335
         IC    @15,CPUREFNO+18(@06,@03)                            0335
         SLA   @15,3                                               0335
         ALR   @15,R4                                              0335
         TM    OPVS1(@15),B'00010000'                              0335
         BNO   @RF00335                                            0335
*         OUTBUF2(55:60)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+54(6,R4),@CC00550                           0336
*       IF OPVS2(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00335 LR    @06,M                                               0337
         MH    @06,@CH00114                                        0337
         L     @03,COMPTR2(,R4)                                    0337
         SLR   @15,@15                                             0337
         IC    @15,CPUREFNO+18(@06,@03)                            0337
         SLA   @15,3                                               0337
         ALR   @15,R4                                              0337
         TM    OPVS2(@15),B'00001000'                              0337
         BNO   @RF00337                                            0337
*         OUTBUF2(55:60)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+54(6,R4),@CC00551                           0338
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0340
*     ;                             /*                       @ZD02028*/
*                                                                  0340
@RF00333 DS    0H                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHECK FOR SECOND STAGING ADAPTER. IF NO               @ZD02028*/
*   /* SECOND STAGING ADAPTER, PRINT LINE AND RETURN.        @ZD02028*/
*   /* OTHERWISE, PICK UP OPERATING SYSTEM FOR CPUS          @ZD02028*/
*   /* ON SECOND STAGING ADAPTER.                            @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   IF PHYSDS2(I,J)='FF'X           /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
@RC00333 LR    @03,I                                               0341
         SLA   @03,2                                               0341
         ALR   @03,J                                               0341
         ALR   @03,R4                                              0341
         CLI   PHYSDS2-5(@03),X'FF'                                0341
         BNE   @RF00341                                            0341
*     DO;                           /*                       @ZD02028*/
*       CALL PRINT1;                /*                       @ZD02028*/
         BAL   @14,PRINT1                                          0343
*       RETURN;                     /*                       @ZD02028*/
@EL00008 DS    0H                                                  0344
@EF00008 DS    0H                                                  0344
@ER00008 LM    @14,@12,@SA00008                                    0344
         BR    @14                                                 0344
*     END;                          /*                       @ZD02028*/
*   ELSE                            /*                       @ZD02028*/
*     DO;                           /*                       @ZD02028*/
@RF00341 DS    0H                                                  0347
*       M=PHYSDS2(I,J)+1;           /*                       @ZD02028*/
         LR    @03,I                                               0347
         SLA   @03,2                                               0347
         ALR   @03,J                                               0347
         LA    M,1                                                 0347
         ALR   @03,R4                                              0347
         MVC   @ZT00003+3(1),PHYSDS2-5(@03)                        0347
         AL    M,@ZT00003                                          0347
*       M=(M-1)*3;                  /*                       @ZD02028*/
         LR    @06,M                                               0348
         BCTR  @06,0                                               0348
         MH    @06,@CH00050                                        0348
         LR    M,@06                                               0348
*     END;                          /*                       @ZD02028*/
*                                                                  0349
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'B' FOR SECOND STAGING              @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*   IF CISPEC(M+1)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
         LR    @06,M                                               0350
         MH    @06,@CH00114                                        0350
         L     @03,COMPTR2(,R4)                                    0350
         ST    @06,@TF00001                                        0350
         ALR   @06,@03                                             0350
         TM    CISPEC(@06),B'10000000'                             0350
         BNO   @RF00350                                            0350
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0352
         SLR   @15,@15                                             0352
         IC    @15,CPUREFNO(@06,@03)                               0352
         SLA   @15,3                                               0352
         ALR   @15,R4                                              0352
         TM    OPVS1(@15),B'00010000'                              0352
         BNO   @RF00352                                            0352
*         OUTBUF2(70:75)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+69(6,R4),@CC00550                           0353
*       IF OPVS2(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00352 LR    @06,M                                               0354
         MH    @06,@CH00114                                        0354
         L     @03,COMPTR2(,R4)                                    0354
         SLR   @15,@15                                             0354
         IC    @15,CPUREFNO(@06,@03)                               0354
         SLA   @15,3                                               0354
         ALR   @15,R4                                              0354
         TM    OPVS2(@15),B'00001000'                              0354
         BNO   @RF00354                                            0354
*         OUTBUF2(70:75)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+69(6,R4),@CC00551                           0355
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0357
*     ;                             /*                       @ZD02028*/
*                                                                  0357
@RF00350 DS    0H                                                  0358
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'C' FOR SECOND STAGING              @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0358
*   IF CISPEC(M+2)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
@RC00350 LR    @06,M                                               0358
         MH    @06,@CH00114                                        0358
         L     @03,COMPTR2(,R4)                                    0358
         ST    @06,@TF00001                                        0358
         ALR   @06,@03                                             0358
         TM    CISPEC+9(@06),B'10000000'                           0358
         BNO   @RF00358                                            0358
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0360
         SLR   @15,@15                                             0360
         IC    @15,CPUREFNO+9(@06,@03)                             0360
         SLA   @15,3                                               0360
         ALR   @15,R4                                              0360
         TM    OPVS1(@15),B'00010000'                              0360
         BNO   @RF00360                                            0360
*         OUTBUF2(82:87)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+81(6,R4),@CC00550                           0361
*       IF OPVS2(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00360 LR    @06,M                                               0362
         MH    @06,@CH00114                                        0362
         L     @03,COMPTR2(,R4)                                    0362
         SLR   @15,@15                                             0362
         IC    @15,CPUREFNO+9(@06,@03)                             0362
         SLA   @15,3                                               0362
         ALR   @15,R4                                              0362
         TM    OPVS2(@15),B'00001000'                              0362
         BNO   @RF00362                                            0362
*         OUTBUF2(82:87)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+81(6,R4),@CC00551                           0363
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0365
*     ;                             /*                       @ZD02028*/
*                                                                  0365
@RF00358 DS    0H                                                  0366
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @ZD02028*/
*   /* CHANNEL INTERFACE 'D' FOR SECOND STAGING              @ZD02028*/
*   /* ADAPTER.                                              @ZD02028*/
*   /* ***********************************************       @ZD02028*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*   IF CISPEC(M+3)='1'B             /*                       @ZD02028*/
*     THEN                          /*                       @ZD02028*/
@RC00358 LR    @06,M                                               0366
         MH    @06,@CH00114                                        0366
         L     @03,COMPTR2(,R4)                                    0366
         ST    @06,@TF00001                                        0366
         ALR   @06,@03                                             0366
         TM    CISPEC+18(@06),B'10000000'                          0366
         BNO   @RF00366                                            0366
*     DO;                           /*                       @ZD02028*/
*       IF OPVS1(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
         L     @06,@TF00001                                        0368
         SLR   @15,@15                                             0368
         IC    @15,CPUREFNO+18(@06,@03)                            0368
         SLA   @15,3                                               0368
         ALR   @15,R4                                              0368
         TM    OPVS1(@15),B'00010000'                              0368
         BNO   @RF00368                                            0368
*         OUTBUF2(94:99)='OS/VS1';  /*                       @ZD02028*/
         MVC   OUTBUF2+93(6,R4),@CC00550                           0369
*       IF OPVS2(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/
*         THEN                      /*                       @ZD02028*/
@RF00368 LR    @06,M                                               0370
         MH    @06,@CH00114                                        0370
         L     @03,COMPTR2(,R4)                                    0370
         SLR   @15,@15                                             0370
         IC    @15,CPUREFNO+18(@06,@03)                            0370
         SLA   @15,3                                               0370
         ALR   @15,R4                                              0370
         TM    OPVS2(@15),B'00001000'                              0370
         BNO   @RF00370                                            0370
*         OUTBUF2(94:99)='OS/VS2';  /*                       @ZD02028*/
         MVC   OUTBUF2+93(6,R4),@CC00551                           0371
*     END;                          /*                       @ZD02028*/
*   ELSE                                                           0373
*     ;                             /*                       @ZD02028*/
@RF00366 DS    0H                                                  0374
*   CALL PRINT1;                    /*                       @ZD02028*/
@RC00366 BAL   @14,PRINT1                                          0374
*   END PRTOPSYS;                   /*                       @ZD02028*/
         B     @EL00008                                            0375
*                                                                  0376
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - MAINBODY                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE PRODUCES THE MAIN BODY OF THE    @XD00153*/
*/*            FIRST SECTION OF THE REPORT.  IF THE DEVICE   @XD00153*/
*/*            IS A MERLIN OR ICEBERG, THEN A LINE IS PRO-   @XD00153*/
*/*            DUCED.  THE DEVICE PLUG NUMBER IS INSERTED    @XD00153*/
*/*            AND '3330-1' IS INSERTED IF THE DEVICE IS A   @XD00153*/
*/*            MERLIN OR '3330-11' IF THE DEVICE IS IN ICE-  @XD00153*/
*/*            BERG.  THE SSID IS THEN DETERMINED IF IT      @XD00153*/
*/*            EXISTS AND INSERTED IN THE SSID COLUMN.  IF   @XD00153*/
*/*            IT DOESN'T EXIST, THEN '***' IS PUT IN THE    @XD00153*/
*/*            COLUMN.  A CALL IS MADE TO 'CUDADDR' TO PRO-  @XD00153*/
*/*            DUCE CHANNEL UNIT ADDRESS FOR THE STAGING     @XD00153*/
*/*            ADAPTER LISTED IN THE LEFT COLUMN.  A CHECK   @XD00153*/
*/*            IS MADE TO DETERMINE IF THE SECOND STAGING    @XD00153*/
*/*            ADAPTER EXISTS, AND IF IT DOES, THEN A CALL   @XD00153*/
*/*            IS MADE TO 'CUDADDR' AGAIN TO DETERMINE THE   @XD00153*/
*/*            CHANNEL UNIT ADDRESS FOR THIS ADAPTER.  THE   @XD00153*/
*/*            LINE IS THEN PRINTED AND MSG6 IS BLANKED OUT  @XD00153*/
*/*            BEFORE INFORMATION FOR THE NEXT DEVICE PLUG   @XD00153*/
*/*            IS INSERTED.                                  @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0376
*MAINBODY:                                                         0376
*   PROCEDURE;                      /*                       @XD00153*/
MAINBODY STM   @14,@12,@SA00009                                    0376
*   DO K=1 TO 8;                    /*                       @XD00153*/
         LA    K,1                                                 0377
@DL00377 DS    0H                                                  0378
*     IF MERLICEB(I,J,K)^=PHYSFNUL  /*                       @X50RSPC*/
*       THEN                                                       0378
         LR    @07,I                                               0378
         SLA   @07,2                                               0378
         ALR   @07,J                                               0378
         SLA   @07,3                                               0378
         ALR   @07,K                                               0378
         ALR   @07,@07                                             0378
         ST    @07,@TF00001                                        0378
         ALR   @07,R4                                              0378
         TM    MERLICEB-82(@07),B'11000000'                        0378
         BZ    @RF00378                                            0378
*       DO;                         /*                       @XD00153*/
*         MSG6(8)=TABLE(K);         /* DEVICE PLUG NUMBER    @XD00153*/
         LA    @07,TABLE-1(K)                                      0380
         MVC   MSG6+7(1),0(@07)                                    0380
*         IF MERLICEB(I,J,K)=PHYSFMER/*                      @X50RSPC*/
*           THEN                                                   0381
         LR    @07,R4                                              0381
         AL    @07,@TF00001                                        0381
         TM    MERLICEB-82(@07),B'10000000'                        0381
         BNO   @RF00381                                            0381
         TM    MERLICEB-82(@07),B'01000000'                        0381
         BNZ   @RF00381                                            0381
*           MSG6(14:19)='3330-1';   /*                       @XD00153*/
         MVC   MSG6+13(6),@CC00528                                 0382
*         ELSE                                                     0383
*           IF MERLICEB(I,J,K)=PHYSFICE/*                    @X50RSPC*/
*             THEN                  /*                       @X50RSPC*/
         B     @RC00381                                            0383
@RF00381 LR    @07,I                                               0383
         SLA   @07,2                                               0383
         ALR   @07,J                                               0383
         SLA   @07,3                                               0383
         ALR   @07,K                                               0383
         ALR   @07,@07                                             0383
         ALR   @07,R4                                              0383
         TM    MERLICEB-82(@07),B'01000000'                        0383
         BNO   @RF00383                                            0383
         TM    MERLICEB-82(@07),B'10000000'                        0383
         BNZ   @RF00383                                            0383
*             MSG6(14:20)='3330-11';/*                       @X50RSPC*/
         MVC   MSG6+13(7),@CC00530                                 0384
*           ELSE                    /*                       @X50RSPC*/
*             MSG6(14:17)='3350';   /*                       @X50RSPC*/
         B     @RC00383                                            0385
@RF00383 MVC   MSG6+13(4),@CC00532                                 0385
*         IF PHYSSSID(I,J,K)='1'B THEN                             0386
@RC00383 DS    0H                                                  0386
@RC00381 LR    @07,I                                               0386
         SLA   @07,2                                               0386
         ALR   @07,J                                               0386
         SLA   @07,3                                               0386
         ALR   @07,K                                               0386
         ALR   @07,@07                                             0386
         ST    @07,@TF00001                                        0386
         ALR   @07,R4                                              0386
         TM    PHYSSSID-82(@07),B'00010000'                        0386
         BNO   @RF00386                                            0386
*           DO;                     /*                       @XD00153*/
*             MSG6(24)='0';         /*                       @XD00153*/
         MVI   MSG6+23,C'0'                                        0388
*             MSG6(25)=TABLE((SPNRSGNO(I,J,K)/2)//16+1);           0389
         L     @07,@TF00001                                        0389
         SLR   @03,@03                                             0389
         IC    @03,SPNRSGNO-82(@07,R4)                             0389
         LR    @07,@03                                             0389
         SRL   @07,1                                               0389
         LR    @00,@07                                             0389
         SRDA  @00,32                                              0389
         D     @00,@CF00164                                        0389
         LR    @07,@00                                             0389
         LA    @01,TABLE(@07)                                      0389
         MVC   MSG6+24(1),0(@01)                                   0389
*             MSG6(26)=TABLE((SPNRSGNO(I,J,K)//2)*8+PHYSFLGS(I,J,K)//8+
*                 1);               /*                       @XD00153*/
         LR    @00,@03                                             0390
         SRDA  @00,32                                              0390
         D     @00,@CF00052                                        0390
         SLA   @00,3                                               0390
         L     @07,@TF00001                                        0390
         SLR   @08,@08                                             0390
         IC    @08,PHYSFLGS-82(@07,R4)                             0390
         SRDA  @08,32                                              0390
         D     @08,@CF00042                                        0390
         ALR   @00,@08                                             0390
         LR    @07,@00                                             0390
         LA    @03,TABLE(@07)                                      0390
         MVC   MSG6+25(1),0(@03)                                   0390
*           END;                    /*                       @XD00153*/
*         ELSE                                                     0392
*           MSG6(24:26)='***';      /*                       @XD00153*/
         B     @RC00386                                            0392
@RF00386 MVC   MSG6+23(3),@CC00536                                 0392
*         N=20;                     /*                       @XD00153*/
@RC00386 LA    N,20                                                0393
*         M=I-1;                    /*                       @XD00153*/
         LR    M,I                                                 0394
         BCTR  M,0                                                 0394
*         CALL CUDADDR;             /* CHANNEL UNIT DEVICE ADDR    0395
*                                                            @XD00153*/
         BAL   @14,CUDADDR                                         0395
*         IF PHYSDS2(I,J)^='FF'X THEN                              0396
         LR    @07,I                                               0396
         SLA   @07,2                                               0396
         ALR   @07,J                                               0396
         ST    @07,@TF00001                                        0396
         ALR   @07,R4                                              0396
         CLI   PHYSDS2-5(@07),X'FF'                                0396
         BE    @RF00396                                            0396
*           DO;                     /*                       @XD00153*/
*             N=59;                 /*                       @XD00153*/
         LA    N,59                                                0398
*             M=PHYSDS2(I,J);       /*                       @XD00153*/
         L     @09,@TF00001                                        0399
         SLR   M,M                                                 0399
         IC    M,PHYSDS2-5(@09,R4)                                 0399
*             CALL CUDADDR;         /* CHAN UNIT DEV ADDR    @XD00153*/
         BAL   @14,CUDADDR                                         0400
*           END;                    /*                       @XD00153*/
*         OUTBUF2(1:99)=MSG6;       /*                       @XD00153*/
@RF00396 MVC   OUTBUF2(99,R4),MSG6                                 0402
*         CALL PRINT1;              /* PRINT A LINE          @XD00153*/
         BAL   @14,PRINT1                                          0403
*         MSG6='';                  /*                       @XD00153*/
         MVI   MSG6,C' '                                           0404
         MVC   MSG6+1(98),MSG6                                     0404
*       END;                        /*                       @XD00153*/
*   END;                            /*                       @XD00153*/
@RF00378 AH    K,@CH00044                                          0406
         CH    K,@CH00042                                          0406
         BNH   @DL00377                                            0406
*   END MAINBODY;                   /*                       @XD00153*/
@EL00009 DS    0H                                                  0407
@EF00009 DS    0H                                                  0407
@ER00009 LM    @14,@12,@SA00009                                    0407
         BR    @14                                                 0407
*                                                                  0408
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME CUDADDR                                   @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE DETERMINES THE CHANNEL-UNIT      @XD00153*/
*/*            ADDRESS FOR THE B,C,D INTERFACES FOR THE      @XD00153*/
*/*            STAGING ADAPTERS.                             @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0408
*CUDADDR:                                                          0408
*   PROCEDURE;                      /*                       @XD00153*/
CUDADDR  STM   @14,@12,12(@13)                                     0408
*   DO L=1 TO 3;                    /*                       @XD00153*/
         LA    L,1                                                 0409
@DL00409 DS    0H                                                  0410
*     MSG6(N+12*L)=TABLE(RSGCHAN(M*3+L)+1);/*                @XD00153*/
         LR    @09,L                                               0410
         MH    @09,@CH00130                                        0410
         LR    @05,N                                               0410
         ALR   @05,@09                                             0410
         LA    @01,MSG6-1(@05)                                     0410
         LR    @15,M                                               0410
         MH    @15,@CH00050                                        0410
         ALR   @15,L                                               0410
         LR    @14,@15                                             0410
         MH    @14,@CH00114                                        0410
         L     @00,COMPTR2(,R4)                                    0410
         ST    @09,@TF00001                                        0410
         LR    @09,@00                                             0410
         SLR   @00,@00                                             0410
         IC    @00,RSGCHAN-9(@14,@09)                              0410
         LR    @09,@00                                             0410
         ST    @05,@TF00002                                        0410
         LA    @05,TABLE(@09)                                      0410
         MVC   0(1,@01),0(@05)                                     0410
*     WORK=RSGCUA(M*3+L)*64;        /*                       @XD00153*/
         L     @09,COMPTR2(,R4)                                    0411
         SLR   @05,@05                                             0411
         IC    @05,RSGCUA-9(@14,@09)                               0411
         SLA   @05,6                                               0411
         STC   @05,WORK                                            0411
*     WORK=WORK+(J-1)*8;            /* ADD IN CONTROLER      @XD00153*/
         LR    @14,J                                               0412
         BCTR  @14,0                                               0412
         SLA   @14,3                                               0412
         ALR   @05,@14                                             0412
         STC   @05,WORK                                            0412
*     WORK=WORK+K-1;                /* ADD IN DEVICE         @XD00153*/
         ALR   @05,K                                               0413
         BCTR  @05,0                                               0413
         STC   @05,WORK                                            0413
*     MSG6(N+1+12*L)=TABLE((WORK/16)//16+1);/*               @XD00153*/
         LA    @01,1                                               0414
         ALR   @01,N                                               0414
         AL    @01,@TF00001                                        0414
         LA    @09,MSG6-1(@01)                                     0414
         LR    @01,@05                                             0414
         SRL   @01,4                                               0414
         ST    @14,@TF00003                                        0414
         LR    @14,@01                                             0414
         ST    @15,@TF00004                                        0414
         SRDA  @14,32                                              0414
         D     @14,@CF00164                                        0414
         LA    @15,TABLE(@14)                                      0414
         MVC   0(1,@09),0(@15)                                     0414
*     MSG6(N+2+12*L)=TABLE(WORK//16+1);/*                    @XD00153*/
         LA    @09,2                                               0415
         ALR   @09,N                                               0415
         AL    @09,@TF00001                                        0415
         LA    @01,MSG6-1(@09)                                     0415
         LR    @14,@05                                             0415
         SRDA  @14,32                                              0415
         D     @14,@CF00164                                        0415
         LA    @09,TABLE(@14)                                      0415
         MVC   0(1,@01),0(@09)                                     0415
*     IF USEV(M*3+L,(J-1)*8+K)='1'B×USEVS(M*3+L,(J-1)*8+K)='1'B THEN
         L     @09,@TF00004                                        0416
         SLA   @09,6                                               0416
         LR    @05,K                                               0416
         AL    @05,@TF00003                                        0416
         ALR   @09,@05                                             0416
         MH    @09,@CH00033                                        0416
         L     @05,COMPTR2(,R4)                                    0416
         ALR   @05,@09                                             0416
         AL    @05,@CF00626                                        0416
         TM    USEV-464(@05),B'01100000'                           0416
         BZ    @RF00416                                            0416
*       MSG6(N+12*L+3:N+12*L+4)='-V';/*                      @XD00153*/
         L     @09,@TF00002                                        0417
         LA    @05,MSG6+2(@09)                                     0417
         MVC   0(2,@05),@CC00566                                   0417
*     IF USEREAL(M*3+L,(J-1)*8+K)='1'B THEN                        0418
@RF00416 LR    @09,M                                               0418
         MH    @09,@CH00050                                        0418
         ALR   @09,L                                               0418
         SLA   @09,6                                               0418
         LR    @05,J                                               0418
         BCTR  @05,0                                               0418
         SLA   @05,3                                               0418
         ALR   @05,K                                               0418
         ALR   @09,@05                                             0418
         MH    @09,@CH00033                                        0418
         L     @05,COMPTR2(,R4)                                    0418
         ALR   @05,@09                                             0418
         AL    @05,@CF00626                                        0418
         TM    USEREAL-464(@05),B'00010000'                        0418
         BNO   @RF00418                                            0418
*       MSG6(N+12*L+3:N+12*L+4)='-R';/*                      @XD00153*/
         LR    @09,L                                               0419
         MH    @09,@CH00130                                        0419
         ALR   @09,N                                               0419
         LA    @05,MSG6+2(@09)                                     0419
         MVC   0(2,@05),@CC00567                                   0419
*     IF USECONVR(M*3+L,(J-1)*8+K)='1'B THEN                       0420
@RF00418 LR    @09,M                                               0420
         MH    @09,@CH00050                                        0420
         ALR   @09,L                                               0420
         SLA   @09,6                                               0420
         LR    @05,J                                               0420
         BCTR  @05,0                                               0420
         SLA   @05,3                                               0420
         ALR   @05,K                                               0420
         ALR   @09,@05                                             0420
         MH    @09,@CH00033                                        0420
         L     @05,COMPTR2(,R4)                                    0420
         ALR   @05,@09                                             0420
         AL    @05,@CF00626                                        0420
         TM    USECONVR-464(@05),B'00000100'                       0420
         BNO   @RF00420                                            0420
*       MSG6(N+12*L+3:N+12*L+4)='-C';/*                      @XD00153*/
         LR    @09,L                                               0421
         MH    @09,@CH00130                                        0421
         ALR   @09,N                                               0421
         LA    @05,MSG6+2(@09)                                     0421
         MVC   0(2,@05),@CC00568                                   0421
*     IF ITISALTP(M*3+L,(J-1)*8+K)='1'B THEN                       0422
@RF00420 LR    @09,M                                               0422
         MH    @09,@CH00050                                        0422
         ALR   @09,L                                               0422
         SLA   @09,6                                               0422
         LR    @05,J                                               0422
         BCTR  @05,0                                               0422
         SLA   @05,3                                               0422
         ALR   @05,K                                               0422
         ALR   @09,@05                                             0422
         MH    @09,@CH00033                                        0422
         L     @05,COMPTR2(,R4)                                    0422
         ALR   @05,@09                                             0422
         AL    @05,@CF00626                                        0422
         TM    ITISALTP-464(@05),B'00000010'                       0422
         BNO   @RF00422                                            0422
*       MSG6(N+12*L+3:N+12*L+4)='-A';/*                      @XD00153*/
         LR    @09,L                                               0423
         MH    @09,@CH00130                                        0423
         ALR   @09,N                                               0423
         LA    @05,MSG6+2(@09)                                     0423
         MVC   0(2,@05),@CC00569                                   0423
*     IF MSG6(N+12*L+3:N+12*L+4)='  ' THEN                         0424
@RF00422 LR    @09,L                                               0424
         MH    @09,@CH00130                                        0424
         ALR   @09,N                                               0424
         LA    @05,MSG6+2(@09)                                     0424
         CLC   0(2,@05),@CC00570                                   0424
         BNE   @RF00424                                            0424
*       MSG6(N+12*L:N+12*L+4)='*****';/*                     @XD00153*/
         LA    @05,MSG6-1(@09)                                     0425
         MVC   0(5,@05),@CC00534                                   0425
*   END;                            /*                       @XD00153*/
@RF00424 AH    L,@CH00044                                          0426
         CH    L,@CH00050                                          0426
         BNH   @DL00409                                            0426
*   END CUDADDR;                    /*                       @XD00153*/
@EL00010 DS    0H                                                  0427
@EF00010 DS    0H                                                  0427
@ER00010 LM    @14,@12,12(@13)                                     0427
         BR    @14                                                 0427
*                                                                  0428
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - GETCPUID                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE EXTRACTS THE PROPER CPUID FROM   @XD00153*/
*/*            RSGCPUID IN CONFGCON, UNPACKS THE ID, AND     @XD00153*/
*/*            PLACES IT IN ITS PROPER LOCATION IN THE CPUID @XD00153*/
*/*            LINE IN MSG5.                                 @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0428
*GETCPUID:                                                         0428
*   PROCEDURE;                      /*                       @XD00153*/
GETCPUID STM   @14,@12,@SA00011                                    0428
*   DO L=1 TO 3;                    /*                       @XD00153*/
         LA    L,1                                                 0429
@DL00429 DS    0H                                                  0430
*     PACKED(1:5)=RSGCPUID((M-1)*3+L);/*                     @XD00153*/
         LR    @09,M                                               0430
         BCTR  @09,0                                               0430
         MH    @09,@CH00050                                        0430
         ALR   @09,L                                               0430
         MH    @09,@CH00114                                        0430
         L     @06,COMPTR2(,R4)                                    0430
         ALR   @06,@09                                             0430
         MVC   PACKED(5),RSGCPUID-9(@06)                           0430
*     PACKED(6)='0F'X;              /*                       @XD00153*/
         MVI   PACKED+5,X'0F'                                      0431
*     GEN(UNPK UNPACKED(11),PACKED(6));/*                    @XD00153*/
         UNPK UNPACKED(11),PACKED(6)
*     MSG5(N+12*L:N+9+12*L)=UNPACKED(1:10);/*                @XD00153*/
         LR    @09,L                                               0433
         MH    @09,@CH00130                                        0433
         LR    @06,N                                               0433
         ALR   @06,@09                                             0433
         LA    @05,MSG5-1(@06)                                     0433
         LA    @02,9                                               0433
         ALR   @02,N                                               0433
         ALR   @02,@09                                             0433
         SLR   @02,@06                                             0433
         EX    @02,@SM00627                                        0433
*     IF MSG5(N+12*L:N+9+12*L)='0000000000' THEN                   0434
         LA    @09,MSG5-1(@06)                                     0434
         EX    @02,@SC00629                                        0434
         BNE   @RF00434                                            0434
*       MSG5(N+12*L:N+9+12*L)='   *****  ';/*                @XD00153*/
         LA    @09,MSG5-1(@06)                                     0435
         EX    @02,@SM00631                                        0435
*   END;                            /*                       @XD00153*/
@RF00434 AH    L,@CH00044                                          0436
         CH    L,@CH00050                                          0436
         BNH   @DL00429                                            0436
*   END GETCPUID;                   /*                       @XD00153*/
@EL00011 DS    0H                                                  0437
@EF00011 DS    0H                                                  0437
@ER00011 LM    @14,@12,@SA00011                                    0437
         BR    @14                                                 0437
*                                                                  0438
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - SETMSG18                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE SETS UP THE CONTENTS OF MSG18.   @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0438
*SETMSG18:                                                         0438
*   PROCEDURE;                      /*                       @XD00153*/
SETMSG18 STM   @14,@12,@SA00012                                    0438
*   MSG18(35:36)=CNTRTABL(J);       /*                       @XD00153*/
         LR    @03,J                                               0439
         ALR   @03,@03                                             0439
         LA    @01,CNTRTABL-2(@03)                                 0439
         MVC   MSG18+34(2),0(@01)                                  0439
*   MSG18(38:53)='TO MSF  , DRC  ,';/*                       @XD00153*/
         MVC   MSG18+37(16),@CC00581                               0440
*   MSG18(45)=LOWLIB(I,J);          /*                       @XD00153*/
         LR    @03,I                                               0441
         SLA   @03,2                                               0441
         ALR   @03,J                                               0441
         ALR   @03,@03                                             0441
         ST    @03,@TF00001                                        0441
         ALR   @03,R4                                              0441
         MVC   MSG18+44(1),LOWLIB-10(@03)                          0441
*   IF LOWRW01(I,J)='1'B THEN                                      0442
         LR    @03,R4                                              0442
         AL    @03,@TF00001                                        0442
         TM    LOWRW01-10(@03),B'01000000'                         0442
         BNO   @RF00442                                            0442
*     MSG18(52)='0';                /*                       @XD00153*/
         MVI   MSG18+51,C'0'                                       0443
*   IF LOWRW23(I,J)='1'B THEN                                      0444
@RF00442 LR    @03,I                                               0444
         SLA   @03,2                                               0444
         ALR   @03,J                                               0444
         ALR   @03,@03                                             0444
         ALR   @03,R4                                              0444
         TM    LOWRW23-10(@03),B'00100000'                         0444
         BNO   @RF00444                                            0444
*     MSG18(52)='1';                /*                       @XD00153*/
         MVI   MSG18+51,C'1'                                       0445
*   IF LOWRW45(I,J)='1'B THEN                                      0446
@RF00444 LR    @03,I                                               0446
         SLA   @03,2                                               0446
         ALR   @03,J                                               0446
         ALR   @03,@03                                             0446
         ALR   @03,R4                                              0446
         TM    LOWRW45-10(@03),B'00010000'                         0446
         BNO   @RF00446                                            0446
*     MSG18(52)='2';                /*                       @XD00153*/
         MVI   MSG18+51,C'2'                                       0447
*   IF LOWRW67(I,J)='1'B THEN                                      0448
@RF00446 LR    @03,I                                               0448
         SLA   @03,2                                               0448
         ALR   @03,J                                               0448
         ALR   @03,@03                                             0448
         ALR   @03,R4                                              0448
         TM    LOWRW67-10(@03),B'00001000'                         0448
         BNO   @RF00448                                            0448
*     MSG18(52)='3';                /*                       @XD00153*/
         MVI   MSG18+51,C'3'                                       0449
*   IF LOWLEFT(I,J)='1'B THEN                                      0450
@RF00448 LR    @03,I                                               0450
         SLA   @03,2                                               0450
         ALR   @03,J                                               0450
         ALR   @03,@03                                             0450
         ALR   @03,R4                                              0450
         TM    LOWLEFT-10(@03),B'00000100'                         0450
         BNO   @RF00450                                            0450
*     MSG18(54)='A';                /*                       @XD00153*/
         MVI   MSG18+53,C'A'                                       0451
*   IF LOWRGHT(I,J)='1'B THEN                                      0452
@RF00450 LR    @03,I                                               0452
         SLA   @03,2                                               0452
         ALR   @03,J                                               0452
         ALR   @03,@03                                             0452
         ALR   @03,R4                                              0452
         TM    LOWRGHT-10(@03),B'00000010'                         0452
         BNO   @RF00452                                            0452
*     MSG18(54)='B';                /*                       @XD00153*/
         MVI   MSG18+53,C'B'                                       0453
*   OUTBUF2(1:54)=MSG18;            /*                       @XD00153*/
@RF00452 MVC   OUTBUF2(54,R4),MSG18                                0454
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/
         BAL   @14,PRINT1                                          0455
*   MSG19(22)=MSG18(52);            /*                       @XD00153*/
         MVC   MSG19+21(1),MSG18+51                                0456
*   MSG19(33)=MSG18(45);            /*                       @XD00153*/
         MVC   MSG19+32(1),MSG18+44                                0457
*   MSG19(34)=MSG18(52);            /*                       @XD00153*/
         MVC   MSG19+33(1),MSG18+51                                0458
*   OUTBUF2(1:34)=MSG19;            /*                       @XD00153*/
         MVC   OUTBUF2(34,R4),MSG19                                0459
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/
         BAL   @14,PRINT1                                          0460
*   END SETMSG18;                   /*                       @XD00153*/
@EL00012 DS    0H                                                  0461
@EF00012 DS    0H                                                  0461
@ER00012 LM    @14,@12,@SA00012                                    0461
         BR    @14                                                 0461
*                                                                  0462
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME LIBSIZE1                                  @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS 1 @XD00153*/
*/*            THE MSF NUMBER IN MSG18 IS PLACED IN THE      @XD00153*/
*/*            SECOND DIGIT IN THE SSID NUMBER.  THE NUMBER  @XD00153*/
*/*            1 IS THE ENDING DIGIT FOR THE FIRST LINE, AND @XD00153*/
*/*            THE NUMBER 2 IS THE ENDING DIGIT FOR THE      @XD00153*/
*/*            SECOND DRD LINE.  THERE ARE ONLY 2 DRD LINES  @XD00153*/
*/*            A CALL IS MADE TO PRINTDRD TO TRANSFER THE    @XD00153*/
*/*            MESSAGE TO THE PRINT BUFFER AND PRINT THE     @XD00153*/
*/*            LINE.                                         @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0462
*LIBSIZE1:                                                         0462
*   PROCEDURE;                      /*                       @XD00153*/
LIBSIZE1 STM   @14,@12,@SA00013                                    0462
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='1' THEN                         0463
         LR    @03,I                                               0463
         SLA   @03,2                                               0463
         ALR   @03,J                                               0463
         ALR   @03,@03                                             0463
         SLR   @00,@00                                             0463
         IC    @00,LOWLIB-10(@03,R4)                               0463
         SRDA  @00,32                                              0463
         D     @00,@CF00164                                        0463
         MH    @00,@CH00130                                        0463
         LR    @03,@00                                             0463
         ALR   @03,R4                                              0463
         CLI   LIBSIZE(@03),C'1'                                   0463
         BNE   @RF00463                                            0463
*     DO;                           /*                       @XD00153*/
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/
         MVC   MSG20+32(1),MSG18+44                                0465
*       DO L=1 TO 2;                /*                       @XD00153*/
         LA    L,1                                                 0466
@DL00466 DS    0H                                                  0467
*         MSG20(22:23)=CNTRTABL(L); /*                       @XD00153*/
         LR    @15,L                                               0467
         ALR   @15,@15                                             0467
         LA    @14,CNTRTABL-2(@15)                                 0467
         MVC   MSG20+21(2),0(@14)                                  0467
*         MSG20(34)=TABLE(L);       /*                       @XD00153*/
         LA    @01,TABLE-1(L)                                      0468
         MVC   MSG20+33(1),0(@01)                                  0468
*         CALL PRINTDRD;            /* PRINT DRD LINE        @XD00153*/
         BAL   @14,PRINTDRD                                        0469
*       END;                        /*                       @XD00153*/
         AH    L,@CH00044                                          0470
         CH    L,@CH00052                                          0470
         BNH   @DL00466                                            0470
*     END;                          /*                       @XD00153*/
*   END LIBSIZE1;                   /*                       @XD00153*/
@EL00013 DS    0H                                                  0472
@EF00013 DS    0H                                                  0472
@ER00013 LM    @14,@12,@SA00013                                    0472
         BR    @14                                                 0472
*                                                                  0473
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - LIBSIZE2                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS   @XD00153*/
*/*            2 OR 4.  THE MSF NUMBER IN MSG18 IS USED AS   @XD00153*/
*/*            THE SECOND DIGIT OF THE SSID AND THE LAST     @XD00153*/
*/*            DIGIT OF THE SSID IS GENERATED.  THIS LAST    @XD00153*/
*/*            DIGIT IS A FUNCTION OF THE DRC WHICH IS       @XD00153*/
*/*            PICKED UP FROM THE 52ND POSITION MF MSG18     @XD00153*/
*/*            AND CONVERTED TO BINARY.                      @XD00153*/
*/*            THE LAST DIGIT IS AS FOLLOWS:                 @XD00153*/
*/*                                 DRC = 0  1  2  3         @XD00153*/
*/*                DRD = 00, LAST DIGIT = 0  2  4  6         @XD00153*/
*/*                DRD = 01, LAST DIGIT = 1  3  5  7         @XD00153*/
*/*                DRD = 10, LAST DIGIT = 2  0  6  4         @XD00153*/
*/*                DRD = 11, LAST DIGIT = 3  1  7  5         @XD00153*/
*/*            CAUTION: IF ANY OF THESE ENDING DIGITS SHOULD @XD00153*/
*/*            CHANGE, THEN THIS ROUTINE WILL NOT WORK AND   @XD00153*/
*/*            IT MUST BE RE-WRITTEN.                        @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0473
*LIBSIZE2:                                                         0473
*   PROCEDURE;                      /*                       @XD00153*/
LIBSIZE2 STM   @14,@12,@SA00014                                    0473
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='2'×LIBSIZE(LOWLIB(I,J)//16+1)='4'
*     THEN                                                         0474
         LR    @03,I                                               0474
         SLA   @03,2                                               0474
         ALR   @03,J                                               0474
         ALR   @03,@03                                             0474
         SLR   @00,@00                                             0474
         IC    @00,LOWLIB-10(@03,R4)                               0474
         SRDA  @00,32                                              0474
         D     @00,@CF00164                                        0474
         MH    @00,@CH00130                                        0474
         LR    @03,@00                                             0474
         ALR   @03,R4                                              0474
         CLI   LIBSIZE(@03),C'2'                                   0474
         BE    @RT00474                                            0474
         LR    @03,@00                                             0474
         ALR   @03,R4                                              0474
         CLI   LIBSIZE(@03),C'4'                                   0474
         BNE   @RF00474                                            0474
@RT00474 DS    0H                                                  0475
*     DO;                           /*                       @XD00153*/
*       WORK=MSG18(52)//16;         /*                       @XD00153*/
         SLR   @03,@03                                             0476
         IC    @03,MSG18+51                                        0476
         N     @03,@CF00065                                        0476
         STC   @03,WORK                                            0476
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/
         MVC   MSG20+32(1),MSG18+44                                0477
*       DO L=0 TO 3;                /*                       @XD00153*/
         SLR   L,L                                                 0478
@DL00478 DS    0H                                                  0479
*         MSG20(34)=TABLE(L+(WORK//2)*(2*(1+(-2)*(L/2)))+4*(WORK/2)+1);
         SLR   @15,@15                                             0479
         IC    @15,WORK                                            0479
         LR    @00,@15                                             0479
         SRDA  @00,32                                              0479
         D     @00,@CF00052                                        0479
         LR    @06,L                                               0479
         SRDA  @06,32                                              0479
         D     @06,@CF00052                                        0479
         MH    @07,@CH00599                                        0479
         AH    @07,@CH00044                                        0479
         ALR   @07,@07                                             0479
         LR    @09,@00                                             0479
         MR    @08,@07                                             0479
         ALR   @09,L                                               0479
         SRL   @15,1                                               0479
         SLA   @15,2                                               0479
         ALR   @09,@15                                             0479
         LA    @08,TABLE(@09)                                      0479
         MVC   MSG20+33(1),0(@08)                                  0479
*                                   /*                       @XD00153*/
*         MSG20(22:23)=CNTRTABL(L+1);/*                      @XD00153*/
         LR    @15,L                                               0480
         ALR   @15,@15                                             0480
         LA    @14,CNTRTABL(@15)                                   0480
         MVC   MSG20+21(2),0(@14)                                  0480
*         CALL PRINTDRD;            /* PRINT DRD LINE        @XD00153*/
         BAL   @14,PRINTDRD                                        0481
*       END;                        /*                       @XD00153*/
         AH    L,@CH00044                                          0482
         CH    L,@CH00050                                          0482
         BNH   @DL00478                                            0482
*     END;                          /*                       @XD00153*/
*   END LIBSIZE2;                   /*                       @XD00153*/
@EL00014 DS    0H                                                  0484
@EF00014 DS    0H                                                  0484
@ER00014 LM    @14,@12,@SA00014                                    0484
         BR    @14                                                 0484
*                                                                  0485
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - LIBSIZE3                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS 3 @XD00153*/
*/*            IT IS THE SAME AS IF LIBSIZE WERE 2 OR 4,     @XD00153*/
*/*            EXCEPT THE ENDING DIGIT IS GENERATED WITH THE @XD00153*/
*/*            FOLLOWING RELATIONSHIP TO THE DRC:            @XD00153*/
*/*                                 DRC = 0  1  2            @XD00153*/
*/*                DRD = 00, LAST DIGIT = 0  2  4            @XD00153*/
*/*                DRD = 01, LAST DIGIT = 1  3  5            @XD00153*/
*/*                DRD = 10, LAST DIGIT = 4  0  2            @XD00153*/
*/*                DRD = 11, LAST DIGIT = 5  1  3            @XD00153*/
*/*            CAUTION: IF ANY OF THESE ENDING DIGITS SHOULD @XD00153*/
*/*            CHANGE, THEN THIS ROUTINE WILL NOT WORK AND   @XD00153*/
*/*            MUST BE RE-WRITTEN.                           @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0485
*LIBSIZE3:                                                         0485
*   PROCEDURE;                      /*                       @XD00153*/
LIBSIZE3 STM   @14,@12,@SA00015                                    0485
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='3' THEN                         0486
         LR    @03,I                                               0486
         SLA   @03,2                                               0486
         ALR   @03,J                                               0486
         ALR   @03,@03                                             0486
         SLR   @00,@00                                             0486
         IC    @00,LOWLIB-10(@03,R4)                               0486
         SRDA  @00,32                                              0486
         D     @00,@CF00164                                        0486
         MH    @00,@CH00130                                        0486
         LR    @03,@00                                             0486
         ALR   @03,R4                                              0486
         CLI   LIBSIZE(@03),C'3'                                   0486
         BNE   @RF00486                                            0486
*     DO;                           /*                       @XD00153*/
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/
         MVC   MSG20+32(1),MSG18+44                                0488
*       IF MSG18(52)='F0'X THEN                                    0489
         CLI   MSG18+51,X'F0'                                      0489
         BNE   @RF00489                                            0489
*         DO L=1 TO 4;              /*                       @YM01097*/
         LA    L,1                                                 0490
@DL00490 DS    0H                                                  0491
*           MSG20(34)=TABLE1(L);    /*                       @YM01097*/
         LA    @01,TABLE1-1(L)                                     0491
         MVC   MSG20+33(1),0(@01)                                  0491
*           MSG20(22:23)=CNTRTABL(L);/*                      @YM01097*/
         LR    @15,L                                               0492
         ALR   @15,@15                                             0492
         LA    @14,CNTRTABL-2(@15)                                 0492
         MVC   MSG20+21(2),0(@14)                                  0492
*           CALL PRINTDRD;          /* PRINT DRD LINE        @XD00153*/
         BAL   @14,PRINTDRD                                        0493
*         END;                      /*                       @XD00153*/
         AH    L,@CH00044                                          0494
         CH    L,@CH00070                                          0494
         BNH   @DL00490                                            0494
*       ELSE                        /*                       @YM01097*/
*         IF MSG18(52)='F1'X THEN                                  0495
         B     @RC00489                                            0495
@RF00489 CLI   MSG18+51,X'F1'                                      0495
         BNE   @RF00495                                            0495
*           DO L=1 TO 4;            /*                       @YM01097*/
         LA    L,1                                                 0496
@DL00496 DS    0H                                                  0497
*             MSG20(34)=TABLE2(L);  /*                       @YM01097*/
         LA    @01,TABLE2-1(L)                                     0497
         MVC   MSG20+33(1),0(@01)                                  0497
*             MSG20(22:23)=CNTRTABL(L);/*                    @YM01097*/
         LR    @15,L                                               0498
         ALR   @15,@15                                             0498
         LA    @14,CNTRTABL-2(@15)                                 0498
         MVC   MSG20+21(2),0(@14)                                  0498
*             CALL PRINTDRD;        /* PRINT DRD LINE        @XD00153*/
         BAL   @14,PRINTDRD                                        0499
*           END;                    /*                       @XD00153*/
         AH    L,@CH00044                                          0500
         CH    L,@CH00070                                          0500
         BNH   @DL00496                                            0500
*         ELSE                                                     0501
*           DO L=1 TO 4;            /*                       @YM01097*/
         B     @RC00495                                            0501
@RF00495 LA    L,1                                                 0501
@DL00501 DS    0H                                                  0502
*             MSG20(34)=TABLE3(L);  /*                       @YM01097*/
         LA    @01,TABLE3-1(L)                                     0502
         MVC   MSG20+33(1),0(@01)                                  0502
*             MSG20(22:23)=CNTRTABL(L);/*                    @YM01097*/
         LR    @15,L                                               0503
         ALR   @15,@15                                             0503
         LA    @14,CNTRTABL-2(@15)                                 0503
         MVC   MSG20+21(2),0(@14)                                  0503
*             CALL PRINTDRD;        /* PRINT DRD LINE        @XD00153*/
         BAL   @14,PRINTDRD                                        0504
*           END;                    /*                       @XD00153*/
         AH    L,@CH00044                                          0505
         CH    L,@CH00070                                          0505
         BNH   @DL00501                                            0505
*     END;                          /*                       @XD00153*/
*   END LIBSIZE3;                   /*                       @XD00153*/
@EL00015 DS    0H                                                  0507
@EF00015 DS    0H                                                  0507
@ER00015 LM    @14,@12,@SA00015                                    0507
         BR    @14                                                 0507
*                                                                  0508
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - PRINT1                                  @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE LINKS TO ICGDSMSG TO PRINT A     @XD00153*/
*/*            LINE.                                         @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0508
*PRINT1:                                                           0508
*   PROCEDURE;                      /*                       @XD00153*/
PRINT1   STM   @14,@12,@SA00016                                    0508
*   PRNTBUF2='1'B;                  /*                       @XD00153*/
         OI    PRNTBUF2(R4),B'00000001'                            0509
*   GEN(LINK EP=ICGDSMSG);          /*                       @XD00153*/
         LINK EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @XD00153*/
         NI    PRNTBUF2(R4),B'11111110'                            0511
*   END PRINT1;                     /*                       @XD00153*/
@EL00016 DS    0H                                                  0512
@EF00016 DS    0H                                                  0512
@ER00016 LM    @14,@12,@SA00016                                    0512
         BR    @14                                                 0512
*                                                                  0513
*/***********************************************************@XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - PRINTDRD                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE IS USED TO PRINT MSG20 (DRD      @XD00153*/
*/*            LINES).                                       @XD00153*/
*/*                                                          @XD00153*/
*/***********************************************************@XD00153*/
*                                                                  0513
*PRINTDRD:                                                         0513
*   PROCEDURE;                      /*                       @XD00153*/
PRINTDRD STM   @14,@12,@SA00017                                    0513
*   OUTBUF2(1:34)=MSG20;            /*                       @XD00153*/
         MVC   OUTBUF2(34,R4),MSG20                                0514
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/
         BAL   @14,PRINT1                                          0515
*   END PRINTDRD;                   /*                       @XD00153*/
@EL00017 DS    0H                                                  0516
@EF00017 DS    0H                                                  0516
@ER00017 LM    @14,@12,@SA00017                                    0516
         BR    @14                                                 0516
*                                                                  0517
*/********************************************************** @YD00113*/
*/*                  P A T C H   A R E A                     @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0517
*   GENERATE;                                                      0517
*                                                         /*@YD00113*/
PATCHB20 DC    32C'PATCHB20'                              /*@YD00113*/
*   END ICGDSB20                    /*                       @Y30LB14*/
*                                                                  0518
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*                                                                  0518
*       ;                                                          0518
         B     @EL00001                                            0518
@DATA    DS    0H
@CH00044 DC    H'1'
@CH00050 DC    H'3'
@CH00070 DC    H'4'
@CH00135 DC    H'7'
@CH00114 DC    H'9'
@CH00033 DC    H'11'
@CH00130 DC    H'12'
@CH00269 DC    H'24'
@CH00312 DC    H'27'
@CH00480 DC    H'43'
@CH00329 DC    H'103'
@CH00599 DC    H'-2'
@SM00627 MVC   0(0,@05),UNPACKED
@SC00629 CLC   0(0,@09),@CC00574
@SM00631 MVC   0(0,@09),@CC00576
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00016 DS    15F
@SA00007 DS    15F
@SA00009 DS    15F
@SA00003 DS    15F
@SA00005 DS    13F
@SA00006 DS    15F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00015 DS    15F
@SA00011 DS    15F
@SA00008 DS    15F
@SA00017 DS    15F
@TF00001 DS    F
@TF00002 DS    F
@TF00003 DS    F
@TF00004 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSB20 CSECT
         DS    0F
@CF00052 DC    F'2'
@CH00052 EQU   @CF00052+2
@CF00042 DC    F'8'
@CH00042 EQU   @CF00042+2
@CF00065 DC    F'15'
@CH00065 EQU   @CF00065+2
@CF00164 DC    F'16'
@CH00164 EQU   @CF00164+2
@CF00626 DC    F'-251'
@DATD    DSECT
         DS    0D
WORK     DS    FL1
         ORG   WORK
@NM00019 DS    BL1
TEMP     EQU   WORK+0
         ORG   WORK+1
FLAGS    DS    FL1
         ORG   FLAGS
BIGBLOCK DS    BL1
@NM00020 EQU   FLAGS+0
         ORG   FLAGS+1
UNPACKED DS    CL11
PACKED   DS    CL6
MSG1     DS    CL24
MSG2     DS    CL19
         ORG   MSG2
@NM00021 DS    CL17
CONTRLR  DS    CL2
         ORG   MSG2+19
MSG3     DS    CL101
MSG4     DS    CL99
MSG5     DS    CL101
         ORG   MSG5
@NM00022 DS    CL27
CPUIDS   DS    CL74
         ORG   MSG5+101
MSG6     DS    CL99
MSG7     DS    CL62
MSG8     DS    CL60
MSG9     DS    CL30
MSG10    DS    CL19
MSG11    DS    CL68
MSG12    DS    CL19
MSG13    DS    CL97
MSG14    DS    CL97
MSG15    DS    CL103
MSG16    DS    CL824
MSG17    DS    CL25
MSG18    DS    CL54
MSG19    DS    CL34
MSG20    DS    CL34
MSG21    DS    CL26
MSG22    DS    CL58
MSG23    DS    CL59
MSG24    DS    CL45
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSB20 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00442 DC    C'0           PLUG   TYPE    SSID     PLUG   TYPE    SSIC
               D     PLUG   TYPE    SSID     PLUG   TYPE    SSID'
@CC00395 DC    C'                            ******* STAGING ADAPTER   C
                *******     ******* STAGING ADAPTER    *******'
@CC00402 DC    C'0    DEVICE  DEVICE   SSID     CPUID       CPUID      C
                CPUID          CPUID       CPUID       CPUID'
@CC00435 DC    C'            CONTROLLER 00           CONTROLLER 01     C
                     CONTROLLER 10           CONTROLLER 11'
@CC00428 DC    C'   INTERFACE   TO CPU           , CHANNEL  , CONTROL UC
               NIT ADDRESS   '
@CC00413 EQU   @CC00395
@CC00418 EQU   @CC00402
@CC00468 DC    C'0CONNECTION FOR CARTRIDGE STORE  MSF , SSID 1 0, MSFIDC
                =  '
@CC00464 DC    C'0   INTERFACE A TO MSC, PORT  , CONTROL UNIT ADDRESS  C
                 '
@CC00473 DC    C'0MSC TABLE ACCESS VALID ON INTERFACE(S)      '
@CC00452 DC    C'           DRD CONTROLLER ADDRESS '
@CC00455 DC    C'                 DRC      SSID 4'
@CC00458 DC    C'                 DRD      SSID 2'
@CC00423 DC    C'0CONNECTIONS FOR SA   SSID 8 0'
@CC00461 DC    C'   INTERFACE   IS NOT USED'
@CC00449 DC    C'0     DRC/DRD (CTL-I/ADT)'
@CC00391 DC    C'0HOST CONNECTIONS REPORT'
@CC00426 DC    C'0CONNECTIONS REPORT'
@CC00433 DC    C'0     DASD  (CTL-I)'
@CC00411 DC    C'      PLUG    TYPE'
@CC00393 DC    C'0DASD CONTROLLER '
@CC00581 DC    C'TO MSF  , DRC  ,'
@CC00521 DC    C'(SHARED SA  )'
@CC00574 DC    C'0000000000'
@CC00576 DC    C'   *****  '
@CC00498 DC    C'IS UNUSED'
@CC00530 DC    C'3330-11'
@CC00528 EQU   @CC00530
@CC00550 DC    C'OS/VS1'
@CC00551 DC    C'OS/VS2'
@CC00534 DC    C'*****'
@CC00532 DC    C'3350'
@CC00536 EQU   @CC00534
@CC00566 DC    C'-V'
@CC00567 DC    C'-R'
@CC00568 DC    C'-C'
@CC00569 DC    C'-A'
@CC00570 EQU   @CC00395
CNTRTABL DC    X'F0F0'
         DC    X'F0F1'
         DC    X'F1F0'
         DC    X'F1F1'
TABLE    DC    X'F0'
         DC    X'F1'
         DC    X'F2'
         DC    X'F3'
         DC    X'F4'
         DC    X'F5'
         DC    X'F6'
         DC    X'F7'
         DC    X'F8'
         DC    X'F9'
         DC    X'C1'
         DC    X'C2'
         DC    X'C3'
         DC    X'C4'
         DC    X'C5'
         DC    X'C6'
TABLE1   DC    X'F0'
         DC    X'F1'
         DC    X'F4'
         DC    X'F5'
TABLE2   DC    X'F2'
         DC    X'F3'
         DC    X'F0'
         DC    X'F1'
TABLE3   DC    X'F4'
         DC    X'F5'
         DC    X'F2'
         DC    X'F3'
TABLE4   DC    X'F0F0F0'
         DC    X'F0F0F1'
         DC    X'F0F1F0'
         DC    X'F0F1F1'
         DC    X'F1F0F0'
         DC    X'F1F0F1'
         DC    X'F1F1F0'
         DC    X'F1F1F1'
         DC    X'F0F0F0'
         DC    X'F0F0F1'
         DC    X'F0F1F0'
         DC    X'F0F1F1'
         DC    X'F1F0F0'
         DC    X'F1F0F1'
         DC    X'F1F1F0'
         DC    X'F1F1F1'
TABLE5   DC    X'C240404040'
         DC    X'C26BC34040'
         DC    X'C26BC36BC4'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SWITCH1  EQU   @07
SWITCH   EQU   @03
N        EQU   @08
M        EQU   @07
L        EQU   @03
K        EQU   @06
J        EQU   @02
I        EQU   @05
R4       EQU   @04
R10      EQU   @10
R11      EQU   @11
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
PRINTER  EQU   COMTAB+464
LINECTR  EQU   PRINTER+100
LINECT   EQU   PRINTER+102
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
SPECLMSG EQU   MESSAGES+18
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
LIBSPEC  EQU   LIBBITS
LIBSIZE  EQU   LIB+1
LIBDSMID EQU   LIB+2
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSDS2  EQU   DSPAIRS
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
MERLICEB EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
SPNRSGNO EQU   PHYSTYPE+1
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
OPVS1    EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LOWSPEC  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLIB   EQU   LOWDSS+1
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
CINTIND  EQU   @NM00017
DINTIND  EQU   @NM00017
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CISPEC   EQU   RSGFLAGS
RSGCPUID EQU   RSGUCB+1
CPUREFNO EQU   RSGUCB+6
RSGCHAN  EQU   RSGUCB+7
RSGCUA   EQU   RSGUCB+8
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
USEV     EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
USECONVR EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
ALTPATH1 EQU   CONFGDEV+2
ALTPATH2 EQU   CONFGDEV+5
ALTPATH3 EQU   CONFGDEV+8
SCANBUF  EQU   0
SCANDATA EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTCH3   EQU   ALTPATH3+2
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCH2   EQU   ALTPATH2+2
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCH1   EQU   ALTPATH1+2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
INDEXRSG EQU   CONFGDEV+1
ICEBERG  EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USESPEC  EQU   USEFLAGS
@NM00018 EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
BINTIND  EQU   @NM00017
CYLFAULT EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
@NM00016 EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
@NM00009 EQU   LIBBITS
TODS2    EQU   RSGTODS+1
TODS1    EQU   RSGTODS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
TERMINAT EQU   MESSAGES+6
WARNING  EQU   MESSAGES+4
MSGNO    EQU   MESSAGES+2
RETCODE  EQU   MESSAGES
OUTBUF   EQU   PRINTER+104
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SCANLEN  EQU   READER+204
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
SAVENCOL EQU   READER+192
SAVESCOL EQU   READER+188
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
LASTPARM EQU   READFLAG
ENDSCAN  EQU   READFLAG
PARMBIT  EQU   READFLAG
KEYBIT   EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00321 EQU   @RC00317
@RF00329 EQU   @RC00325
@RF00337 EQU   @RC00333
@RF00354 EQU   @RC00350
@RF00362 EQU   @RC00358
@RF00370 EQU   @RC00366
@RF00463 EQU   @EL00013
@RF00474 EQU   @EL00014
@RF00486 EQU   @EL00015
@RC00495 EQU   @EL00015
@RC00489 EQU   @EL00015
@ENDDATA EQU   *
         END   ICGDSB20,(C'PLS1609',0701,77362)

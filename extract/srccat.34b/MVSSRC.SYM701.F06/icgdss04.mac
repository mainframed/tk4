         TITLE 'ICGDSS04 MSC TABLE CREATE, SCAN UPPERCON STATEMENT     *
                        '
ICGDSS04 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSS04  78.023'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @10,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                                                  0044
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - ICGDSS04 (MAINLINE)                     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL FOUR MAJOR PROCEDURED OF ICGDSS04.       @Y30LB12*/
*/*            DO NOT CALL S04BUILD IF TERMINATING ERRORS    @Y30LB12*/
*/*            ARE ENCOUNTERED.  RETURN TO CALLER (ICGDSSCN) @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0044
*   CALL S04INIT;                   /* INITIALIZE WORKA      @Y30LB12*/
         BAL   @14,S04INIT                                         0044
*   CALL S04SCAN;                   /* GET KEYS, PARMS       @Y30LB12*/
         BAL   @14,S04SCAN                                         0045
*   CALL S04ANAL;                   /* CROSS-CHECK           @Y30LB12*/
         BAL   @14,S04ANAL                                         0046
*   IF STOPSCAN^='1'B               /* IF NO TERM. ERROR     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    STOPSCAN,B'00001000'                                0047
         BO    @RF00047                                            0047
*     CALL S04BUILD;                /* UPDATE TABLES         @Y30LB12*/
         BAL   @14,S04BUILD                                        0048
*   ELSE                                                           0049
*     ;                             /*                       @Y30LB12*/
@RF00047 DS    0H                                                  0050
*   RETURN;                         /* TO ICGDSSCN           @Y30LB12*/
@EL00001 L     @13,4(,@13)                                         0050
@EF00001 L     @00,@SIZDATD                                        0050
         LR    @01,@12                                             0050
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0050
         BR    @14                                                 0050
*                                                                  0051
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04INIT                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - INITIALIZE FLAG BYTES FOR PREVIOUSLY          @Y30LB12*/
*/*            USED KEYWORDS (HAVES) TO ZEROS SINCE EACH     @Y30LB12*/
*/*            UPPERCON STATEMENT IS INDEPENDENT OF ALL      @Y30LB12*/
*/*            OTHERS.  INITIALIZE FLAG BYTE FOR RECOGNIZED  @Y30LB12*/
*/*            KEYWORD SINCE NO KEYWORDS ARE YET RECOGNIZED. @Y30LB12*/
*/*            INITIALIZE TWO SAVE AREAS FOR ADDRESSES       @Y30LB12*/
*/*            DEFINED IN THIS UPPERCON CONTROL STATEMENT    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0051
*S04INIT:                                                          0051
*   PROCEDURE;                      /*                       @Y30LB12*/
S04INIT  STM   @14,@12,12(@13)                                     0051
*   UPCMSGID='00'X;                 /*                       @Y30LB12*/
         MVI   UPCMSGID,X'00'                                      0052
*   HAVES='00'X;                    /*                       @Y30LB12*/
         MVI   HAVES,X'00'                                         0053
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0054
         B     @DE00054                                            0054
@DL00054 DS    0H                                                  0055
*     WK1ADDR(I)=INITDEV;           /* INIT TO BINARY 0      @Y30LB12*/
         LR    @07,I                                               0055
         MH    @07,@CH00257                                        0055
         LA    @05,WK1ADDR-11(@07)                                 0055
         MVC   0(11,@05),INITDEV                                   0055
*     WK2ADDR(I)=INITDEV;           /* INIT TO BINARY 0      @Y30LB12*/
         LA    @05,WK2ADDR-11(@07)                                 0056
         MVC   0(11,@05),INITDEV                                   0056
*   END;                            /* END OF DO I           @Y30LB12*/
         AH    I,@CH00044                                          0057
@DE00054 CH    I,MAXDEV                                            0057
         BNH   @DL00054                                            0057
*   END S04INIT;                    /* TO S04 MAINLINE       @Y30LB12*/
@EL00002 DS    0H                                                  0058
@EF00002 DS    0H                                                  0058
@ER00002 LM    @14,@12,12(@13)                                     0058
         BR    @14                                                 0058
*                                                                  0059
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04SCAN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SCAN MAJOR KEYWORDS AND CALL PROPER ROUTINE   @Y30LB12*/
*/*            TO HANDLE PARAMETER.  IF KEYWORD HAS RELATED  @Y30LB12*/
*/*            SUB-KEYWORDS AND/OR SUB-PARAMETERS, THEY WILL @Y30LB12*/
*/*            IN TURN BE HANDLED BY THE CALLED PROCEDURE.   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0059
*S04SCAN:                                                          0059
*   PROCEDURE;                      /*                       @Y30LB12*/
S04SCAN  STM   @14,@12,@SA00003                                    0059
*   DO WHILE(LASTPARM^='1'B);       /* TILL NO MORE DATA     @Y30LB12*/
         B     @DE00060                                            0060
@DL00060 DS    0H                                                  0061
*     HAVEADDR='0'B;                /* RESET ADDR FLAG       @Y30LB12*/
         NI    HAVEADDR,B'11111110'                                0061
*     KNOWN='0'B;                   /*                       @Y30LB12*/
         NI    KNOWN,B'01111111'                                   0062
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/
         BAL   @14,READS99                                         0063
*     IF LASTPARM='1'B              /* IF NO DATA LEFT       @Y30LB12*/
*       THEN                        /* TO PROCESS, RET.      @Y30LB12*/
         TM    LASTPARM(R4),B'00001000'                            0064
         BO    @RT00064                                            0064
*       RETURN;                     /* TO S04 MAINLINE       @Y30LB12*/
*     ELSE                                                         0066
*       ;                           /* WAS SOMETHING         @Y30LB12*/
*                                                                  0066
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* WE EXPECT THE 'SOMETHING' THAT WE EXTRACTED         @Y30LB12*/
*     /* FROM THE INPUT BUFFER TO BE A KEYWORD (A FIELD      @Y30LB12*/
*     /* TERMINATED BY AN EQUAL SIGN. IF THE DATA IS         @Y30LB12*/
*     /* NOT A KEYWORD, WE ARE LOST. WRITE ERROR             @Y30LB12*/
*     /* MESSAGE 'ICG209I EXPECTED, BUT DID NOT FIND,        @Y30LB12*/
*     /* KEYWORD', AND DISCONTINUE SCAN OF THIS              @Y30LB12*/
*     /* CONTROL STATEMENT.                                  @Y30LB12*/
*     /* KEYBIT IS SET IN THE MODULE ICGDSS99.               @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0067
*     IF KEYBIT^='1'B               /* IF NOT KEYWORD,       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KEYBIT(R4),B'01000000'                              0067
         BO    @RF00067                                            0067
*       DO;                         /*                       @Y30LB12*/
*         MSGNO=ICG209I;            /* ID FOR ICGDS209       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG209I                                 0069
*         CALL PUTIT2;              /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT2                                          0070
*         RETURN;                   /* TO S04 MAINLINE       @Y30LB12*/
@EL00003 DS    0H                                                  0071
@EF00003 DS    0H                                                  0071
@ER00003 LM    @14,@12,@SA00003                                    0071
         BR    @14                                                 0071
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0073
*       ;                           /*                       @Y30LB12*/
*                                                                  0073
@RF00067 DS    0H                                                  0074
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'SA'      @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0074
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0074
         CLC   SCANDATA(3,@07),@CC00554                            0074
         BNE   @RF00074                                            0074
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0076
*         CALL S04DS;               /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04DS                                           0077
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0079
*       ;                           /*                       @Y30LB12*/
*                                                                  0079
@RF00074 DS    0H                                                  0080
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'CI'      @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0080
*     IF SCANDATA(1:3)='CI='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0080
         CLC   SCANDATA(3,@07),@CC00556                            0080
         BNE   @RF00080                                            0080
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0082
*         CALL S04CI;               /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04CI                                           0083
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0085
*       ;                           /*                       @Y30LB12*/
*                                                                  0085
@RF00080 DS    0H                                                  0086
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'CH'      @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0086
*     IF SCANDATA(1:3)='CH='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0086
         CLC   SCANDATA(3,@07),@CC00558                            0086
         BNE   @RF00086                                            0086
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0088
*         CALL S04CH;               /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04CH                                           0089
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0091
*       ;                           /*                       @Y30LB12*/
*                                                                  0091
@RF00086 DS    0H                                                  0092
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD @Y30LB12X 'CUID'  */
*     /*                                                     @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0092
*     IF SCANDATA(1:5)='CUID='      /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0092
         CLC   SCANDATA(5,@07),@CC00560                            0092
         BNE   @RF00092                                            0092
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0094
*         CALL S04CUID;             /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04CUID                                         0095
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0097
*       ;                           /*                       @Y30LB12*/
*                                                                  0097
@RF00092 DS    0H                                                  0098
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/
*     /* 'CPUID'                                             @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0098
*     IF SCANDATA(1:6)='CPUID='     /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0098
         CLC   SCANDATA(6,@07),@CC00562                            0098
         BNE   @RF00098                                            0098
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0100
*         CALL S04CPUID;            /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04CPUID                                        0101
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0103
*       ;                           /*                       @Y30LB12*/
*                                                                  0103
@RF00098 DS    0H                                                  0104
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'V',      @Y30LB12*/
*     /* THERE IS POSSIBILITY THAT ALTERNATE PATHS ARE       @Y30LB12*/
*     /* SPECIFIED, SO INITIALIZE ALTERNATE PATH AREAS.      @Y30LB12*/
*     /* SET UP VARIABLE NAME IN PLUGIN IN CASE ANY          @Y30LB12*/
*     /* MESSAGES ARE NEEDED IN ANY CALLED PROCEDURES.       @Y30LB12*/
*     /* WHEN ALL THE SUB-KEYWORDS AND SUB-PARAMETERS        @Y30LB12*/
*     /* ASSOCIATED WITH THE KEYWORD 'V' HAVE BEEN           @Y30LB12*/
*     /* SCANNED AND STORED IN THE PROPER WORK AREAS,        @Y30LB12*/
*     /* SET THE FLAG BIT 'USEV' FOR ALL ADDRESSES           @Y30LB12*/
*     /* SPECIFIED, MOVE ALTERNATE PATH INFORMATION          @Y30LB12*/
*     /* INTO EACH SPECIFIED ADDRESS ENTRY, AND UPDATE       @Y30LB12*/
*     /* THE SECOND ADDRESS WORK AREA FROM DATA SAVED        @Y30LB12*/
*     /* IN THE FIRST ADDRESS WORK AREA.                     @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0104
*     IF SCANDATA(1:2)='V='&KNOWN='0'B/*                     @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0104
         CLC   SCANDATA(2,@07),@CC00564                            0104
         BNE   @RF00104                                            0104
         TM    KNOWN,B'10000000'                                   0104
         BNZ   @RF00104                                            0104
*       DO;                         /*                       @Y30LB12*/
*         ALTCOUNT=0;               /*                       @Y30LB12*/
         SLR   @07,@07                                             0106
         STH   @07,ALTCOUNT                                        0106
*         ALTPATHS='000000000000000000000000'X;/*            @Y30LB12*/
         MVC   ALTPATHS(12),@CB00566                               0107
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0108
*         PLUGIN='V, ADDR ';        /* FOR MESSAGE TEXT      @YM31098*/
         MVC   PLUGIN(8),@CC00568                                  0109
*         CALL S04VVS;              /* GET SUB-KEYWORDS      @Y30LB12*/
         BAL   @14,S04VVS                                          0110
*         DO I=1 TO MAXDEV;         /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0111
         B     @DE00111                                            0111
@DL00111 DS    0H                                                  0112
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0112
         MH    @07,@CH00257                                        0112
         LA    @05,ADR1SPEC-11(@07)                                0112
         TM    0(@05),B'10000000'                                  0112
         BNO   @RF00112                                            0112
*             ADR1V(I)='1'B;        /* SET USE TO VIRT.      @Y30LB12*/
         LA    @05,ADR1V-11(@07)                                   0113
         OI    0(@05),B'01000000'                                  0113
*           ELSE                                                   0114
*             ;                     /* ELSE DO NOTHING       @Y30LB12*/
@RF00112 DS    0H                                                  0115
*         END;                      /* EXAMINED ALL 64       @Y30LB12*/
         AH    I,@CH00044                                          0115
@DE00111 CH    I,MAXDEV                                            0115
         BNH   @DL00111                                            0115
*         CALL RSGALTP;             /* MOVE IN ALT PATH      @Y30LB12*/
         BAL   @14,RSGALTP                                         0116
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/
         BAL   @14,WK1TOWK2                                        0117
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0119
*       ;                           /*                       @Y30LB12*/
*                                                                  0119
@RF00104 DS    0H                                                  0120
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/
*     /* 'VS', PROCESSING IS THE SAME AS FOR KEYWORD         @Y30LB12*/
*     /* 'V' EXCEPT THAT THE FLAG 'USEVS' IS SET             @Y30LB12*/
*     /* INSTEAD OF THE FLAG 'USEV'.                         @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0120
*     IF SCANDATA(1:3)='VS='&KNOWN='0'B/*                    @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0120
         CLC   SCANDATA(3,@07),@CC00572                            0120
         BNE   @RF00120                                            0120
         TM    KNOWN,B'10000000'                                   0120
         BNZ   @RF00120                                            0120
*       DO;                         /*                       @Y30LB12*/
*         ALTCOUNT=0;               /* ALT. PATH COUNTER     @Y30LB12*/
         SLR   @07,@07                                             0122
         STH   @07,ALTCOUNT                                        0122
*         ALTPATHS='000000000000000000000000'X;/*            @Y30LB12*/
         MVC   ALTPATHS(12),@CB00566                               0123
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0124
*         PLUGIN='VS, ADDR';        /* FOR MESSAGE TEXT      @YM31098*/
         MVC   PLUGIN(8),@CC00573                                  0125
*         CALL S04VVS;              /* GET SUB-KEYWORDS      @Y30LB12*/
         BAL   @14,S04VVS                                          0126
*         DO I=1 TO MAXDEV;         /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0127
         B     @DE00127                                            0127
@DL00127 DS    0H                                                  0128
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0128
         MH    @07,@CH00257                                        0128
         LA    @05,ADR1SPEC-11(@07)                                0128
         TM    0(@05),B'10000000'                                  0128
         BNO   @RF00128                                            0128
*             ADR1VS(I)='1'B;       /* SET SHARED VIRT       @Y30LB12*/
         LA    @05,ADR1VS-11(@07)                                  0129
         OI    0(@05),B'00100000'                                  0129
*           ELSE                                                   0130
*             ;                     /* ELSE DO NOTHING       @Y30LB12*/
@RF00128 DS    0H                                                  0131
*         END;                      /* EXAMINED ALL 64       @Y30LB12*/
         AH    I,@CH00044                                          0131
@DE00127 CH    I,MAXDEV                                            0131
         BNH   @DL00127                                            0131
*         CALL RSGALTP;             /* MOVE IN ALT PATH      @Y30LB12*/
         BAL   @14,RSGALTP                                         0132
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/
         BAL   @14,WK1TOWK2                                        0133
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0135
*       ;                           /*                       @Y30LB12*/
*                                                                  0135
@RF00120 DS    0H                                                  0136
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/
*     /* 'REAL', ONLY THE FIRST 32 ADDRESSES                 @Y30LB12*/
*     /* (00-1F) ARE VALID.                                  @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0136
*     IF SCANDATA(1:5)='REAL='&KNOWN='0'B/*                  @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0136
         CLC   SCANDATA(5,@07),@CC00574                            0136
         BNE   @RF00136                                            0136
         TM    KNOWN,B'10000000'                                   0136
         BNZ   @RF00136                                            0136
*       DO;                         /*                       @Y30LB12*/
*         ALTCOUNT=0;               /*                       @OZ09548*/
         SLR   @07,@07                                             0138
         STH   @07,ALTCOUNT                                        0138
*         ALTPATHS='000000000000000000000000'X;/*            @OZ09548*/
         MVC   ALTPATHS(12),@CB00566                               0139
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0140
*         PLUGIN='REAL    ';        /* FOR MESSAGE TEXT      @Y30LB12*/
         MVC   PLUGIN(8),@CC00575                                  0141
*         CALL S04ADDR;             /* TO GET ADDRESSES      @Y30LB12*/
         BAL   @14,S04ADDR                                         0142
*         DO I=1 TO MAXREAL;        /* FIRST 32 VALID        @Y30LB12*/
         LA    I,1                                                 0143
         B     @DE00143                                            0143
@DL00143 DS    0H                                                  0144
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0144
         MH    @07,@CH00257                                        0144
         LA    @05,ADR1SPEC-11(@07)                                0144
         TM    0(@05),B'10000000'                                  0144
         BNO   @RF00144                                            0144
*             ADR1REAL(I)='1'B;     /* USE IS REAL           @Y30LB12*/
         LA    @05,ADR1REAL-11(@07)                                0145
         OI    0(@05),B'00010000'                                  0145
*           ELSE                                                   0146
*             ;                     /*                       @Y30LB12*/
@RF00144 DS    0H                                                  0147
*         END;                      /* CHECKED 1ST 32        @Y30LB12*/
         AH    I,@CH00044                                          0147
@DE00143 CH    I,MAXREAL                                           0147
         BNH   @DL00143                                            0147
*         DO I=MAXREAL+1 TO MAXDEV; /* 2ND 32 ERROR          @Y30LB12*/
         LA    I,1                                                 0148
         AH    I,MAXREAL                                           0148
         B     @DE00148                                            0148
@DL00148 DS    0H                                                  0149
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0149
         MH    @07,@CH00257                                        0149
         LA    @05,ADR1SPEC-11(@07)                                0149
         TM    0(@05),B'10000000'                                  0149
         BNO   @RF00149                                            0149
*             DO;                   /*                       @Y30LB12*/
*                                                                  0150
*               /*****************************************************/
*               /*                                                   */
*               /* *********************************         @Y30LB12*/
*               /* ICG238I ADDRESS XX INVALID                @Y30LB12*/
*               /* FOR REAL                                  @Y30LB12*/
*               /* *********************************         @Y30LB12*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0151
*               OUTBUF2(1:32)=ICGDS238;/*                    @Y30LB12*/
         MVC   OUTBUF2(32,R4),ICGDS238                             0151
*               OUTBUF2(33:36)='REAL';/*                     @Y30LB12*/
         MVC   OUTBUF2+32(4,R4),@CC00579                           0152
*               OUTBUF2(18:19)=PATTERN(I);/*                 @Y30LB12*/
         LR    @07,I                                               0153
         ALR   @07,@07                                             0153
         LA    @05,PATTERN-2(@07)                                  0153
         MVC   OUTBUF2+17(2,R4),0(@05)                             0153
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0154
*             END;                  /*                       @Y30LB12*/
*           ELSE                                                   0156
*             ;                     /*                       @Y30LB12*/
@RF00149 DS    0H                                                  0157
*         END;                      /* CHECKED 2ND 32        @Y30LB12*/
         AH    I,@CH00044                                          0157
@DE00148 CH    I,MAXDEV                                            0157
         BNH   @DL00148                                            0157
*         CALL REALALTP;            /* CHECK FOR ALTPATH     @OZ09548*/
         BAL   @14,REALALTP                                        0158
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/
         BAL   @14,WK1TOWK2                                        0159
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0161
*       ;                           /*                       @Y30LB12*/
*                                                                  0161
@RF00136 DS    0H                                                  0162
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/
*     /* 'CONVREAL', PROCESSING IS THE SAME AS FOR           @Y30LB12*/
*     /* REAL EXCEPT THAT THE USE FLAG SET                   @Y30LB12*/
*     /* IS 'USECONVR'                                       @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0162
*     IF SCANDATA(1:9)='CONVREAL='&KNOWN='0'B/*              @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0162
         CLC   SCANDATA(9,@07),@CC00584                            0162
         BNE   @RF00162                                            0162
         TM    KNOWN,B'10000000'                                   0162
         BNZ   @RF00162                                            0162
*       DO;                         /*                       @Y30LB12*/
*         ALTCOUNT=0;               /* ALT. PATH COUNTER     @OZ09548*/
         SLR   @07,@07                                             0164
         STH   @07,ALTCOUNT                                        0164
*         ALTPATHS='000000000000000000000000'X;/*            @OZ09548*/
         MVC   ALTPATHS(12),@CB00566                               0165
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'10000000'                                   0166
*         PLUGIN='CONVREAL';        /* FOR MESSAGE TEXT      @Y30LB12*/
         MVC   PLUGIN(8),@CC00586                                  0167
*         CALL S04ADDR;             /* TO GET ADDRESSES      @Y30LB12*/
         BAL   @14,S04ADDR                                         0168
*         DO I=1 TO MAXREAL;        /* FIRST 32 VALID        @Y30LB12*/
         LA    I,1                                                 0169
         B     @DE00169                                            0169
@DL00169 DS    0H                                                  0170
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0170
         MH    @07,@CH00257                                        0170
         LA    @05,ADR1SPEC-11(@07)                                0170
         TM    0(@05),B'10000000'                                  0170
         BNO   @RF00170                                            0170
*             ADR1CONV(I)='1'B;     /* USE CONVERTIBLE       @Y30LB12*/
         LA    @05,ADR1CONV-11(@07)                                0171
         OI    0(@05),B'00000100'                                  0171
*           ELSE                                                   0172
*             ;                     /*                       @Y30LB12*/
@RF00170 DS    0H                                                  0173
*         END;                      /* CHECKED FIRST 32      @Y30LB12*/
         AH    I,@CH00044                                          0173
@DE00169 CH    I,MAXREAL                                           0173
         BNH   @DL00169                                            0173
*         DO I=MAXREAL+1 TO MAXDEV; /* 32 INVALID            @Y30LB12*/
         LA    I,1                                                 0174
         AH    I,MAXREAL                                           0174
         B     @DE00174                                            0174
@DL00174 DS    0H                                                  0175
*           IF ADR1SPEC(I)='1'B     /*                       @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LR    @07,I                                               0175
         MH    @07,@CH00257                                        0175
         LA    @05,ADR1SPEC-11(@07)                                0175
         TM    0(@05),B'10000000'                                  0175
         BNO   @RF00175                                            0175
*             DO;                   /*                       @Y30LB12*/
*                                                                  0176
*               /*****************************************************/
*               /*                                                   */
*               /* *********************************         @Y30LB12*/
*               /* ICG238I ADDRESS XX INVALID                @Y30LB12*/
*               /* FOR CONVREAL                              @Y30LB12*/
*               /* *********************************         @Y30LB12*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0177
*               OUTBUF2(1:32)=ICGDS238;/*                    @Y30LB12*/
         MVC   OUTBUF2(32,R4),ICGDS238                             0177
*               OUTBUF2(33:40)='CONVREAL';/*                 @Y30LB12*/
         MVC   OUTBUF2+32(8,R4),@CC00586                           0178
*               OUTBUF2(18:19)=PATTERN(I);/*                 @Y30LB12*/
         LR    @07,I                                               0179
         ALR   @07,@07                                             0179
         LA    @05,PATTERN-2(@07)                                  0179
         MVC   OUTBUF2+17(2,R4),0(@05)                             0179
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0180
*             END;                  /*                       @Y30LB12*/
*           ELSE                                                   0182
*             ;                     /*                       @Y30LB12*/
@RF00175 DS    0H                                                  0183
*         END;                      /* CHECKED 2ND 32        @Y30LB12*/
         AH    I,@CH00044                                          0183
@DE00174 CH    I,MAXDEV                                            0183
         BNH   @DL00174                                            0183
*         CALL REALALTP;            /* CHECK FOR ALTPATH     @OZ09548*/
         BAL   @14,REALALTP                                        0184
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/
         BAL   @14,WK1TOWK2                                        0185
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0187
*       ;                           /*                       @Y30LB12*/
*                                                                  0187
@RF00162 DS    0H                                                  0188
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* THE KEYWORD WAS NOT RECOGNIZED AS ANY OF THE        @Y30LB12*/
*     /* ABOVE...                                            @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0188
*     IF KNOWN='0'B                 /* REC. KEYWORD FLAG     @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN,B'10000000'                                   0188
         BNZ   @RF00188                                            0188
*       CALL UNKNOWN;               /* TO WRITE MSG, ETC     @Y30LB12*/
         BAL   @14,UNKNOWN                                         0189
*     ELSE                                                         0190
*       ;                           /*                       @Y30LB12*/
@RF00188 DS    0H                                                  0191
*   END;                            /* END OF DO WHILE       @Y30LB12*/
@DE00060 TM    LASTPARM(R4),B'00001000'                            0191
         BNO   @DL00060                                            0191
*   END S04SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/
         B     @EL00003                                            0192
*                                                                  0193
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - RSGALTP                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - FOR VIRTUAL AND SHARED VIRTUAL ADDRESSES,     @Y30LB12*/
*/*            MOVE ALTERNATE PATH INFORMATION AND RSG       @Y30LB12*/
*/*            INFORMATION INTO APPROPRIATE SLOTS IN         @Y30LB12*/
*/*            WK1ADDRS.                                     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0193
*RSGALTP:                                                          0193
*   PROCEDURE;                      /*                       @Y30LB12*/
RSGALTP  STM   @14,@12,12(@13)                                     0193
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0194
         B     @DE00194                                            0194
@DL00194 DS    0H                                                  0195
*     IF ADR1SPEC(I)='1'B           /* IF ADDR SPECIFIED     @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @07,I                                               0195
         MH    @07,@CH00257                                        0195
         LA    @05,ADR1SPEC-11(@07)                                0195
         TM    0(@05),B'10000000'                                  0195
         BNO   @RF00195                                            0195
*       DO;                         /*                       @Y30LB12*/
*         WK1RSG(I)=WORKRSG(2);     /* ALL V AND VS          @Y30LB12*/
         LA    @05,WK1RSG-11(@07)                                  0197
         MVC   0(1,@05),WORKRSG+1                                  0197
*         WK1ADS1(I)=WORKADS(1);    /* 1ST ALT PATH          @Y30LB12*/
         LA    @05,WK1ADS1-11(@07)                                 0198
         MVC   0(1,@05),WORKADS                                    0198
*         WK1ACI1(I)=WORKACI(1);    /* 1ST ALT PATH          @Y30LB12*/
         LA    @05,WK1ACI1-11(@07)                                 0199
         MVC   0(1,@05),WORKACI                                    0199
*         WK1ACH1(I)=WORKACH(1);    /* 1ST ALT PATH          @Y30LB12*/
         LA    @05,WK1ACH1-11(@07)                                 0200
         MVC   0(1,@05),WORKACH                                    0200
*         WK1ADS2(I)=WORKADS(2);    /* 2ND ALT PATH          @Y30LB12*/
         LA    @05,WK1ADS2-11(@07)                                 0201
         MVC   0(1,@05),WORKADS+4                                  0201
*         WK1ACI2(I)=WORKACI(2);    /* 2ND ALT PATH          @Y30LB12*/
         LA    @05,WK1ACI2-11(@07)                                 0202
         MVC   0(1,@05),WORKACI+4                                  0202
*         WK1ACH2(I)=WORKACH(2);    /* 2ND ALT PATH          @Y30LB12*/
         LA    @05,WK1ACH2-11(@07)                                 0203
         MVC   0(1,@05),WORKACH+4                                  0203
*         WK1ADS3(I)=WORKADS(3);    /* 3RD ALT PATH          @Y30LB12*/
         LA    @05,WK1ADS3-11(@07)                                 0204
         MVC   0(1,@05),WORKADS+8                                  0204
*         WK1ACI3(I)=WORKACI(3);    /* 3RD ALT PATH          @Y30LB12*/
         LA    @05,WK1ACI3-11(@07)                                 0205
         MVC   0(1,@05),WORKACI+8                                  0205
*         WK1ACH3(I)=WORKACH(3);    /* 3RD ALT PATH          @Y30LB12*/
         LA    @05,WK1ACH3-11(@07)                                 0206
         MVC   0(1,@05),WORKACH+8                                  0206
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0208
*       ;                           /*                       @Y30LB12*/
@RF00195 DS    0H                                                  0209
*   END;                            /* CHECKED ALL 64        @Y30LB12*/
         AH    I,@CH00044                                          0209
@DE00194 CH    I,MAXDEV                                            0209
         BNH   @DL00194                                            0209
*   END RSGALTP;                    /* RET. TO S04SCAN       @Y30LB12*/
@EL00004 DS    0H                                                  0210
@EF00004 DS    0H                                                  0210
@ER00004 LM    @14,@12,12(@13)                                     0210
         BR    @14                                                 0210
*                                                                  0211
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - WK1TOWK2                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - IF ADDRESS SPECIFIED FOR THIS SUB-GROUP (V,   @Y30LB12*/
*/*            VS, REAL, OR CONVREAL), AND NOT               @Y30LB12*/
*/*            SPECIFIED PREVIOUSLY IN THIS CONTROL          @Y30LB12*/
*/*            STATEMENT, MOVE INFORMATION ABOUT EACH        @Y30LB12*/
*/*            ADDRESS SPECIFIED FOR SUB-GROUP WORKAREA      @Y30LB12*/
*/*            (WK1ADDRS) TO CONTROL STATEMENT WORKAREA      @Y30LB12*/
*/*            (WK2ADDRS).                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0211
*WK1TOWK2:                                                         0211
*   PROCEDURE;                      /*                       @Y30LB12*/
WK1TOWK2 STM   @14,@12,@SA00005                                    0211
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0212
         B     @DE00212                                            0212
@DL00212 DS    0H                                                  0213
*     IF ADR1SPEC(I)='1'B           /* SPEC IN WORK1         @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @07,I                                               0213
         MH    @07,@CH00257                                        0213
         LA    @05,ADR1SPEC-11(@07)                                0213
         TM    0(@05),B'10000000'                                  0213
         BNO   @RF00213                                            0213
*       IF ADR2SPEC(I)='0'B         /* NOT SPEC IN WORK2     @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LA    @05,ADR2SPEC-11(@07)                                0214
         TM    0(@05),B'10000000'                                  0214
         BNZ   @RF00214                                            0214
*         WK2ADDR(I)=WK1ADDR(I);    /* MOVE DATA             @Y30LB12*/
         LA    @05,WK2ADDR-11(@07)                                 0215
         LA    @03,WK1ADDR-11(@07)                                 0215
         MVC   0(11,@05),0(@03)                                    0215
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  0216
         B     @RC00214                                            0216
@RF00214 DS    0H                                                  0217
*           /*********************************************************/
*           /*                                                       */
*           /* ***********************************           @Y30LB12*/
*           /* ICG226I DUPLICATE SPECIFICATION               @Y30LB12*/
*           /* FOR DEVICE XX                                 @Y30LB12*/
*           /* ***********************************           @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0217
*           OUTBUF2(1:44)=ICGDS226; /*                       @Y30LB12*/
         MVC   OUTBUF2(44,R4),ICGDS226                             0217
*           OUTBUF2(45:46)=PATTERN(I);/*                     @Y30LB12*/
         LR    @07,I                                               0218
         ALR   @07,@07                                             0218
         LA    @05,PATTERN-2(@07)                                  0218
         MVC   OUTBUF2+44(2,R4),0(@05)                             0218
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0219
*         END;                      /*                       @Y30LB12*/
*     WK1ADDR(I)='0000000000000000000000'X;/* CLEAR          @Y30LB12*/
@RC00214 DS    0H                                                  0221
@RF00213 LR    @07,I                                               0221
         MH    @07,@CH00257                                        0221
         LA    @05,WK1ADDR-11(@07)                                 0221
         MVC   0(11,@05),@CB00531                                  0221
*   END;                            /* HANDLED ALL 64        @Y30LB12*/
         AH    I,@CH00044                                          0222
@DE00212 CH    I,MAXDEV                                            0222
         BNH   @DL00212                                            0222
*   END WK1TOWK2;                   /* RETURN TO CALLER      @Y30LB12*/
@EL00005 DS    0H                                                  0223
@EF00005 DS    0H                                                  0223
@ER00005 LM    @14,@12,@SA00005                                    0223
         BR    @14                                                 0223
*                                                                  0224
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04DS                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - HANDLE THE DS PARAMETER FOR THE DATA STAGER   @Y30LB12*/
*/*            THAT THIS CPU/CHANNEL/CONTROL UNIT DESCRIBES  @Y30LB12*/
*/*            (DS FOR ALTERNATE PATH IS HANDLED IN THE      @Y30LB12*/
*/*            PROCEDURE S04ADS.)  ONLY ONE DS KEYWORD IS    @Y30LB12*/
*/*            ALLOWED PER CONTROL STATEMENT, THE PARAMETER  @Y30LB12*/
*/*            MUST BE ONE CHARACTER IN LENGTH, AND THE      @Y30LB12*/
*/*            CHARACTER MUST BE THE REPRESENTATION OF A     @Y30LB12*/
*/*            HEXADECIMAL DIGIT IN THE RANGE 0-F.  THE      @Y30LB12*/
*/*            VALUE SCANNED IS USED IN CONJUNCTION WITH     @Y30LB12*/
*/*            THE VALUE SCANNED FOR CHANNEL INTERFACE       @Y30LB12*/
*/*            TO INDEX TO THE PROPER ENTRY IN THE CONFGCON  @Y30LB12*/
*/*            AND CONFGUCB (FIRST INDEX).                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0224
*S04DS:                                                            0224
*   PROCEDURE;                      /*                       @Y30LB12*/
S04DS    STM   @14,@12,@SA00006                                    0224
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0225
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVEDS,B'10000000'                                  0226
         BO    @RF00226                                            0226
*     HAVEDS='1'B;                  /*                       @Y30LB12*/
         OI    HAVEDS,B'10000000'                                  0227
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0228
         B     @RC00226                                            0228
@RF00226 DS    0H                                                  0229
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD SA'                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0229
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0229
*       OUTBUF2(28:29)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+27(2,R4),@CC00600                           0230
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0231
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/
@EL00006 DS    0H                                                  0232
@EF00006 DS    0H                                                  0232
@ER00006 LM    @14,@12,@SA00006                                    0232
         BR    @14                                                 0232
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00226 TM    PARMBIT(R4),B'00100000'                             0234
         BO    @RF00234                                            0234
*     DO;                           /*                       @Y30LB12*/
*                                                                  0235
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0236
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0236
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0237
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/
         B     @EL00006                                            0238
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0240
*     ;                             /*                       @Y30LB12*/
@RF00234 DS    0H                                                  0241
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0241
         BE    @RF00241                                            0241
*     DO;                           /*                       @Y30LB12*/
*                                                                  0242
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS SA'                                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0243
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0243
*       OUTBUF2(47:48)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+46(2,R4),@CC00600                           0244
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0245
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/
         B     @EL00006                                            0246
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0248
*     ;                             /*                       @Y30LB12*/
@RF00241 DS    0H                                                  0249
*   HEXCHAR=SCANDATA(1);            /* CHAR TO CONVHEX       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0249
         MVC   HEXCHAR(1),SCANDATA(@07)                            0249
*   PLUGIN2='SA      ';             /* FOR POSSIBLE MSG      @YM31098*/
         MVC   PLUGIN2(8),@CC00601                                 0250
*   CALL CONVHEX;                   /* TO CONVERT TO HEX     @Y30LB12*/
         BAL   @14,CONVHEX                                         0251
*   DSINDEX=HEXINDEX;               /* = BIN HEXCHAR+1       @Y30LB12*/
         MVC   DSINDEX(2),HEXINDEX                                 0252
*   END S04DS;                      /* RET TO S04SCAN        @Y30LB12*/
         B     @EL00006                                            0253
*                                                                  0254
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04CI                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - HANDLE THE CHANNEL INTERFACE DESIGNATION FOR  @Y30LB12*/
*/*            THE PRIMARY CHANNEL SPECIFIED IN THIS CONTROL @Y30LB12*/
*/*            STATEMENT (CI FOR ALTPATH IS HANDLED BY THE   @Y30LB12*/
*/*            PROCEDURE S04ACI).  ONLY ONE CI KEYWORD IS    @Y30LB12*/
*/*            ALLOWED.  THE PARAMETER MUST BE THE SINGLE    @Y30LB12*/
*/*            CHARACTER 'B', 'C', OR 'D'.  THE VALUE IS     @Y30LB12*/
*/*            SAVED AS BINARY '1', '2', OR '3', AND IS USED @Y30LB12*/
*/*            IN CONJUNCTION WITH THE VALUE SCANNED FOR     @Y30LB12*/
*/*            DATA STAGER TO LOCATE THE PROPER ENTRY IN     @Y30LB12*/
*/*            CONFGCON AND CONFGUCB(FIRST INDEX).           @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0254
*S04CI:                                                            0254
*   PROCEDURE;                      /*                       @Y30LB12*/
S04CI    STM   @14,@12,@SA00007                                    0254
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0255
*   IF HAVECI^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECI,B'01000000'                                  0256
         BO    @RF00256                                            0256
*     HAVECI='1'B;                  /*                       @Y30LB12*/
         OI    HAVECI,B'01000000'                                  0257
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0258
         B     @RC00256                                            0258
@RF00256 DS    0H                                                  0259
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD CI'                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0259
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0259
*       OUTBUF2(28:29)='CI';        /*                       @Y30LB12*/
         MVC   OUTBUF2+27(2,R4),@CC00606                           0260
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0261
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
@EL00007 DS    0H                                                  0262
@EF00007 DS    0H                                                  0262
@ER00007 LM    @14,@12,@SA00007                                    0262
         BR    @14                                                 0262
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00256 TM    PARMBIT(R4),B'00100000'                             0264
         BO    @RF00264                                            0264
*     DO;                           /*                       @Y30LB12*/
*                                                                  0265
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0266
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0266
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0267
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00007                                            0268
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0270
*     ;                             /*                       @Y30LB12*/
@RF00264 DS    0H                                                  0271
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0271
         BE    @RF00271                                            0271
*     DO;                           /*                       @Y30LB12*/
*                                                                  0272
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS CI                                     @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0273
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0273
*       OUTBUF2(47:48)='CI';        /*                       @Y30LB12*/
         MVC   OUTBUF2+46(2,R4),@CC00606                           0274
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0275
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00007                                            0276
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0278
*     ;                             /*                       @Y30LB12*/
@RF00271 DS    0H                                                  0279
*   WORKCI='00'X;                   /* ZERO WORKA FOR CI     @Y30LB12*/
         MVI   WORKCI,X'00'                                        0279
*   IF SCANDATA(1)='B'              /* IF PARAMETER 'B'      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0280
         CLI   SCANDATA(@07),C'B'                                  0280
         BNE   @RF00280                                            0280
*     WORKCI='01'X;                 /* CHANNEL INT IS 1      @Y30LB12*/
         MVI   WORKCI,X'01'                                        0281
*   ELSE                                                           0282
*     ;                             /*                       @Y30LB12*/
@RF00280 DS    0H                                                  0283
*   IF SCANDATA(1)='C'              /* IF PARAMETER 'C'      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0283
         CLI   SCANDATA(@07),C'C'                                  0283
         BNE   @RF00283                                            0283
*     WORKCI='02'X;                 /* CHANNEL INT IS 2      @Y30LB12*/
         MVI   WORKCI,X'02'                                        0284
*   ELSE                                                           0285
*     ;                             /*                       @Y30LB12*/
@RF00283 DS    0H                                                  0286
*   IF SCANDATA(1)='D'              /* IF PARAMETER 'D'      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0286
         CLI   SCANDATA(@07),C'D'                                  0286
         BNE   @RF00286                                            0286
*     WORKCI='03'X;                 /* CHANNEL INT IS 3      @Y30LB12*/
         MVI   WORKCI,X'03'                                        0287
*   ELSE                                                           0288
*     ;                             /*                       @Y30LB12*/
@RF00286 DS    0H                                                  0289
*   IF WORKCI='00'X                 /* IF NO MATCH           @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLI   WORKCI,X'00'                                        0289
         BNE   @RF00289                                            0289
*     DO;                           /*                       @Y30LB12*/
*                                                                  0290
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG223I VALUE ERROR FOR CI'                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0291
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0291
*       OUTBUF2(26:27)='CI';        /*                       @Y30LB12*/
         MVC   OUTBUF2+25(2,R4),@CC00606                           0292
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0293
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0295
*     ;                             /*                       @Y30LB12*/
@RF00289 DS    0H                                                  0296
*   END S04CI;                      /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00007                                            0296
*                                                                  0297
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04CH                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT THE CHANNEL PARAMETER FROM THE INPUT  @Y30LB12*/
*/*            BUFFER.  ONLY ONE CHANNEL IS ALLOWED PER      @Y30LB12*/
*/*            DATA STAGER/CHANNEL INTERFACE, SO CHECK FOR   @Y30LB12*/
*/*            DUPLICATE SPECIFICATION.  CHANNEL PARAMETER   @Y30LB12*/
*/*            IS ONE BYTE IN LENGTH.  CALL CONVHEX TO       @Y30LB12*/
*/*            OBTAIN THE BINARY EQUIVALENT OF THE           @Y30LB12*/
*/*            CHARACTER REPRESENTATION OF CHANNEL.  STORE   @Y30LB12*/
*/*            RESULT IN 'WORKCH'.                           @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*            NOTE - FLAG 'HAVECH' IS CHECKED IN PROCEDURE  @Y30LB12*/
*/*            'MISSREQ' IN 'S04ANAL' TO BE SURE THAT A      @Y30LB12*/
*/*            CHANNEL WAS SPECIFIED.  'WORKCH' IS MOVED TO  @Y30LB12*/
*/*            'RSGCHAN' IN THE STRUCTURE 'CONFGCON' IN      @Y30LB12*/
*/*            COMTAB2 IN THE PROCEDURE 'S04BUILD'.          @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0297
*S04CH:                                                            0297
*   PROCEDURE;                      /*                       @Y30LB12*/
S04CH    STM   @14,@12,@SA00008                                    0297
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0298
*   IF HAVECH^='1'B                 /* IF KEYWORD WAS        @Y30LB12*/
*     THEN                          /* NOT USED EARLIER      @Y30LB12*/
         TM    HAVECH,B'00100000'                                  0299
         BO    @RF00299                                            0299
*     HAVECH='1'B;                  /* SET ITS USED FLAG     @Y30LB12*/
         OI    HAVECH,B'00100000'                                  0300
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0301
         B     @RC00299                                            0301
@RF00299 DS    0H                                                  0302
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD CH'                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0302
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0302
*       OUTBUF2(28:29)='CH';        /*                       @Y30LB12*/
         MVC   OUTBUF2+27(2,R4),@CC00617                           0303
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT1                                          0304
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/
@EL00008 DS    0H                                                  0305
@EF00008 DS    0H                                                  0305
@ER00008 LM    @14,@12,@SA00008                                    0305
         BR    @14                                                 0305
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET IN ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00299 TM    PARMBIT(R4),B'00100000'                             0307
         BO    @RF00307                                            0307
*     DO;                           /*                       @Y30LB12*/
*                                                                  0308
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0309
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0309
*       CALL PUTIT2;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT2                                          0310
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/
         B     @EL00008                                            0311
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0313
*     ;                             /*                       @Y30LB12*/
@RF00307 DS    0H                                                  0314
*   IF SCANLEN^=1                   /* SET IN ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0314
         BE    @RF00314                                            0314
*     DO;                           /*                       @Y30LB12*/
*                                                                  0315
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS CH'                                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0316
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0316
*       OUTBUF2(47:48)='CH';        /*                       @Y30LB12*/
         MVC   OUTBUF2+46(2,R4),@CC00617                           0317
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT1                                          0318
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/
         B     @EL00008                                            0319
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0321
*     ;                             /*                       @Y30LB12*/
@RF00314 DS    0H                                                  0322
*   HEXCHAR=SCANDATA(1);            /* SCANNED VALUE         @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0322
         MVC   HEXCHAR(1),SCANDATA(@07)                            0322
*   PLUGIN2='CH      ';             /* FOR MESSAGE TEXT      @YM31098*/
         MVC   PLUGIN2(8),@CC00618                                 0323
*   CALL CONVHEX;                   /* CONVERT TO HEX        @Y30LB12*/
         BAL   @14,CONVHEX                                         0324
*   IF HEXCHAR^=0                   /* IF NOT CHANNEL 0      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLI   HEXCHAR,0                                           0325
         BE    @RF00325                                            0325
*     WORKCH=HEXCHAR;               /* CONVERTED VALUE       @Y30LB12*/
         MVC   WORKCH(1),HEXCHAR                                   0326
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0327
         B     @RC00325                                            0327
@RF00325 DS    0H                                                  0328
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG223I VALUE ERROR FOR CH                        @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0328
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0328
*       OUTBUF2(26:27)='CH';        /*                       @Y30LB12*/
         MVC   OUTBUF2+25(2,R4),@CC00617                           0329
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0330
*     END;                          /*                       @Y30LB12*/
*   END S04CH;                      /* RETURN TO S04SCAN     @Y30LB12*/
         B     @EL00008                                            0332
*                                                                  0333
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVHEX                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE EBCDIC   @Y30LB12*/
*/*            REPRESENTATION OF ONE HEXADECIMAL CHARACTER   @Y30LB12*/
*/*            IN 'HEXCHAR'.  IF THE CHARACTER REPRESENTS A  @Y30LB12*/
*/*            VALID HEXADECIMAL CHARACTER, IT IS CONVERTED  @Y30LB12*/
*/*            TO BINARY IN 'HEXCHAR' AND 'HEXINDEX' IS SET  @Y30LB12*/
*/*            TO INDICATE A HALFWORD EQUAL TO HEXCHAR+1.    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*            THIS ROUTINE IS CALLED BY  PROCEDURES S04DS,  @Y30LB12*/
*/*            S04CH, S04ADS, AND S04ACH.  S04DS AND S04ADS  @Y30LB12*/
*/*            TAKE THE RETURNED VALUE FROM HEXINDEX.  S04CH @Y30LB12*/
*/*            AND S04ACH TAKE THE RETURNED VALUE FROM       @Y30LB12*/
*/*            HEXCHAR.                                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0333
*CONVHEX:                                                          0333
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVHEX  STM   @14,@12,@SA00009                                    0333
*   HEXINDEX=0;                     /* INITIALIZE            @Y30LB12*/
         SLR   @07,@07                                             0334
         STH   @07,HEXINDEX                                        0334
*   IF HIGHHEX=ALPHA                /* PASSED CHARACTER      @Y30LB12*/
*     THEN                          /* HIGH-ORDER BITS       @Y30LB12*/
         TM    HIGHHEX,B'11000000'                                 0335
         BNO   @RF00335                                            0335
         TM    HIGHHEX,B'00110000'                                 0335
         BNZ   @RF00335                                            0335
*     DO;                           /* OF CHARACTER A-I,     @Y30LB12*/
*       HIGHHEX=ZEROBITS;           /* ZERO BITS AND ADD     @Y30LB12*/
         NI    HIGHHEX,B'00001111'                                 0337
*       HEXCHAR=HEXCHAR+9;          /* BINARY 9 FOR BIN      @Y30LB12*/
         IC    @07,HEXCHAR                                         0338
         LA    @07,9(,@07)                                         0338
         STC   @07,HEXCHAR                                         0338
*     END;                          /* EQUIVALENT.           @Y30LB12*/
*   ELSE                            /* NOT CHAR A-I          @Y30LB12*/
*     IF HIGHHEX=NUMERIC            /* CHECK CHAR 0-9        @Y30LB12*/
*       THEN                        /* IF SIGN IS OKAY,      @Y30LB12*/
         B     @RC00335                                            0340
@RF00335 TM    HIGHHEX,B'11110000'                                 0340
         BNO   @RF00340                                            0340
*       HIGHHEX=ZEROBITS;           /* ZERO SIGN BITS        @Y30LB12*/
         NI    HIGHHEX,B'00001111'                                 0341
*     ELSE                                                         0342
*       ;                           /*                       @Y30LB12*/
*                                                                  0342
@RF00340 DS    0H                                                  0343
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************@Y30LB12 IF   */
*   /* CHARACTER NOT 0-9 OR A-F, THE HIGH-ORDER              @Y30LB12*/
*   /* BITS ARE NOT ZERO. NOTE THAT 'G', 'H', AND 'I'        @Y30LB12*/
*   /* WHICH COULD BE ACCEPTED ABOVE FORCE A CARRY           @Y30LB12*/
*   /* INTO HIGHHEX WHEN 9 IS ADDED TO THE DIGIT.            @Y30LB12*/
*   /* ************************************************@Y30LB12      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0343
*   IF HIGHHEX^=ZEROBITS            /* IF ZONE NOT ZERO      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00335 TM    HIGHHEX,B'11110000'                                 0343
         BZ    @RF00343                                            0343
*     DO;                           /*                       @Y30LB12*/
*                                                                  0344
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG227I PARAMETER MUST BE HEXADECIMAL.            @Y30LB12*/
*       /* KEYWORD IS (SA/SA (ALT)/CH/CH (ALT))              @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0345
*       OUTBUF2(1:51)=ICGDS227;     /*                       @Y30LB12*/
         MVC   OUTBUF2(51,R4),ICGDS227                             0345
*       OUTBUF2(52:59)=PLUGIN2;     /*                       @YM31098*/
         MVC   OUTBUF2+51(8,R4),PLUGIN2                            0346
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0347
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     HEXINDEX=HEXCHAR+1;           /* SAVE PARAMETER        @Y30LB12*/
         B     @RC00343                                            0349
@RF00343 SLR   @07,@07                                             0349
         IC    @07,HEXCHAR                                         0349
         LA    @07,1(,@07)                                         0349
         STH   @07,HEXINDEX                                        0349
*   END CONVHEX;                    /* RETURN TO CALLER      @Y30LB12*/
@EL00009 DS    0H                                                  0350
@EF00009 DS    0H                                                  0350
@ER00009 LM    @14,@12,@SA00009                                    0350
         BR    @14                                                 0350
*                                                                  0351
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04CUID                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - HANDLE THE PARAMETER FOR THE CONTROL UNIT     @Y30LB12*/
*/*            IDENTIFICATION WIRED INTO THE CHANNEL         @Y30LB12*/
*/*            INTERFACE.  THE ENTIRE DEVICE ADDRESS IS 12   @Y30LB12*/
*/*            BITS IN LENGTH, AND CONSISTS OF CHANNEL (4    @Y30LB12*/
*/*            BITS), CONTROL UNIT (2 BITS), DEVICE (6 BITS) @Y30LB12*/
*/*            ONLY ONE CONTROL UNIT ADDRESS SPECIFICATION   @Y30LB12*/
*/*            IS ALLOWED PER CONTROL STATEMENT.  THE        @Y30LB12*/
*/*            PARAMETER IS TWO CHARACTERS IN LENGTH, AND IT @Y30LB12*/
*/*            MUST BE ONE OF THE VALUES '00', '01', '10',   @Y30LB12*/
*/*            OR '11'.                                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0351
*S04CUID:                                                          0351
*   PROCEDURE;                      /*                       @Y30LB12*/
S04CUID  STM   @14,@12,@SA00010                                    0351
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0352
*   IF HAVECU^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECU,B'00010000'                                  0353
         BO    @RF00353                                            0353
*     HAVECU='1'B;                  /*                       @Y30LB12*/
         OI    HAVECU,B'00010000'                                  0354
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0355
         B     @RC00353                                            0355
@RF00353 DS    0H                                                  0356
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD CUID'                  @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0356
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0356
*       OUTBUF2(28:31)='CUID';      /*                       @Y30LB12*/
         MVC   OUTBUF2+27(4,R4),@CC00627                           0357
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0358
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
@EL00010 DS    0H                                                  0359
@EF00010 DS    0H                                                  0359
@ER00010 LM    @14,@12,@SA00010                                    0359
         BR    @14                                                 0359
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00353 TM    PARMBIT(R4),B'00100000'                             0361
         BO    @RF00361                                            0361
*     DO;                           /*                       @Y30LB12*/
*                                                                  0362
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0363
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0363
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0364
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00010                                            0365
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0367
*     ;                             /*                       @Y30LB12*/
@RF00361 DS    0H                                                  0368
*   IF SCANLEN^=2                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00052                              0368
         BE    @RF00368                                            0368
*     DO;                           /*                       @Y30LB12*/
*                                                                  0369
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/
*       /* KEYWORD IS CUID                                   @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0370
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0370
*       OUTBUF2(47:50)='CUID';      /*                       @Y30LB12*/
         MVC   OUTBUF2+46(4,R4),@CC00627                           0371
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0372
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00010                                            0373
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0375
*     ;                             /*                       @Y30LB12*/
@RF00368 DS    0H                                                  0376
*   BINCHAR(1:2)=SCANDATA(1:2);     /* PASS PARAMETER        @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0376
         MVC   BINCHAR(2),SCANDATA(@07)                            0376
*   CALL CONVBIN;                   /* TO CONVERT PARM       @Y30LB12*/
         BAL   @14,CONVBIN                                         0377
*   IF BININDEX^=0                  /* PARM CONVERTED OK     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,BININDEX                                        0378
         LTR   @07,@07                                             0378
         BZ    @RF00378                                            0378
*     WORKCU=BININDEX-1;            /* SAVE CONV. PARM       @Y30LB12*/
         BCTR  @07,0                                               0379
         STC   @07,WORKCU                                          0379
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0380
         B     @RC00378                                            0380
@RF00378 DS    0H                                                  0381
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG223I VALUE ERROR FOR CUID                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0381
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0381
*       OUTBUF2(26:29)='CUID';      /*                       @Y30LB12*/
         MVC   OUTBUF2+25(4,R4),@CC00627                           0382
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0383
*     END;                          /*                       @Y30LB12*/
*   END S04CUID;                    /* RET. TO S04SCAN       @Y30LB12*/
         B     @EL00010                                            0385
*                                                                  0386
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVBIN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/
*/*            CHARACTER REPRESENTATION OF TWO BINARY BITS   @Y30LB12*/
*/*            IN 'BINCHAR'.  IF THE CHARACTER REPRESENTS    @Y30LB12*/
*/*            A VALID BINARY NUMBER, 'BININDEX' IS SET TO   @Y30LB12*/
*/*            THE BINARY VALUE OF THE CHARACTER PLUS ONE.   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0386
*CONVBIN:                                                          0386
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVBIN  STM   @14,@12,12(@13)                                     0386
*   BININDEX=0;                     /* INIT RETURN FIELD     @Y30LB12*/
         SLR   @07,@07                                             0387
         STH   @07,BININDEX                                        0387
*   IF BINCHAR='00'                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   BINCHAR(2),@CC00383                                 0388
         BNE   @RF00388                                            0388
*     BININDEX=1;                   /*                       @Y30LB12*/
         MVC   BININDEX(2),@CH00044                                0389
*   ELSE                                                           0390
*     ;                             /*                       @Y30LB12*/
@RF00388 DS    0H                                                  0391
*   IF BINCHAR='01'                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   BINCHAR(2),@CC00384                                 0391
         BNE   @RF00391                                            0391
*     BININDEX=2;                   /*                       @Y30LB12*/
         MVC   BININDEX(2),@CH00052                                0392
*   ELSE                                                           0393
*     ;                             /*                       @Y30LB12*/
@RF00391 DS    0H                                                  0394
*   IF BINCHAR='10'                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   BINCHAR(2),@CC00399                                 0394
         BNE   @RF00394                                            0394
*     BININDEX=3;                   /*                       @Y30LB12*/
         MVC   BININDEX(2),@CH00050                                0395
*   ELSE                                                           0396
*     ;                             /*                       @Y30LB12*/
@RF00394 DS    0H                                                  0397
*   IF BINCHAR='11'                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   BINCHAR(2),@CC00400                                 0397
         BNE   @RF00397                                            0397
*     BININDEX=4;                   /*                       @Y30LB12*/
         MVC   BININDEX(2),@CH00070                                0398
*   ELSE                                                           0399
*     ;                             /*                       @Y30LB12*/
@RF00397 DS    0H                                                  0400
*   END CONVBIN;                    /* RET. TO S04CUID       @Y30LB12*/
@EL00011 DS    0H                                                  0400
@EF00011 DS    0H                                                  0400
@ER00011 LM    @14,@12,12(@13)                                     0400
         BR    @14                                                 0400
*                                                                  0401
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04CPUID                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - WHEN THE KEYWORD IS 'CPUID', READ THE         @Y30LB12*/
*/*            PARAMETER, CHECK FOR DUPLICATE KEYWORD,       @Y30LB12*/
*/*            CALL PROCEDURE CPUCONV TO FORMAT AS PACKED,   @Y30LB12*/
*/*            AND RETURN TO S04SCAN.                        @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0401
*S04CPUID:                                                         0401
*   PROCEDURE;                      /*                       @Y30LB12*/
S04CPUID STM   @14,@12,@SA00012                                    0401
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0402
*   IF HAVECPU^='1'B                /* IF KEYWORD WAS        @Y30LB12*/
*     THEN                          /* NOT USED EARLIER      @Y30LB12*/
         TM    HAVECPU,B'00001000'                                 0403
         BO    @RF00403                                            0403
*     HAVECPU='1'B;                 /* SET FLAG FOR USED     @Y30LB12*/
         OI    HAVECPU,B'00001000'                                 0404
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0405
         B     @RC00403                                            0405
@RF00403 DS    0H                                                  0406
*       /*************************************************************/
*       /*                                                           */
*       /* ******************************************        @Y30LB12*/
*       /* ICG219I DUPLICATE KEYWORD CPUID                   @Y30LB12*/
*       /* ******************************************        @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0406
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0406
*       OUTBUF2(28:32)='CPUID';     /*                       @Y30LB12*/
         MVC   OUTBUF2+27(5,R4),@CC00636                           0407
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT1                                          0408
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/
@EL00012 DS    0H                                                  0409
@EF00012 DS    0H                                                  0409
@ER00012 LM    @14,@12,@SA00012                                    0409
         BR    @14                                                 0409
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00403 TM    PARMBIT(R4),B'00100000'                             0411
         BO    @RF00411                                            0411
*     DO;                           /*                       @Y30LB12*/
*                                                                  0412
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0413
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0413
*       CALL PUTIT2;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT2                                          0414
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/
         B     @EL00012                                            0415
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0417
*     ;                             /*                       @Y30LB12*/
@RF00411 DS    0H                                                  0418
*   ERROR='0'B;                     /* SET OFF ERROR FLG     @Y30LB12*/
         NI    ERROR,B'11101111'                                   0418
*   CALL CPUCONV;                   /* TO PACK CPUID         @Y30LB12*/
         BAL   @14,CPUCONV                                         0419
*   IF ERROR='0'B                   /* CHECK ERROR FLAG      @Y30LB12*/
*     THEN                          /* IF NO ERROR           @Y30LB12*/
         TM    ERROR,B'00010000'                                   0420
         BNZ   @RF00420                                            0420
*     WORKCPU=PACKED(1:5);          /* CPUID TO LCL WORK     @Y30LB12*/
         MVC   WORKCPU(5),PACKED                                   0421
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0422
         B     @RC00420                                            0422
@RF00420 DS    0H                                                  0423
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG220I INVALID PARAMETER LENGTH.                 @Y30LB12*/
*       /* KEYWORD IS CPUID                                  @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0423
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0423
*       OUTBUF2(47:51)='CPUID';     /*                       @Y30LB12*/
         MVC   OUTBUF2+46(5,R4),@CC00636                           0424
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/
         BAL   @14,PUTIT1                                          0425
*     END;                          /*                       @Y30LB12*/
*   END S04CPUID;                   /* TO S04SCAN            @Y30LB12*/
         B     @EL00012                                            0427
*                                                                  0428
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CPUCONV                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CONVERT MANUFACTURER'S IDENTIFICATION FROM    @Y30LB12*/
*/*            CHARACTER REPRESENTATION TO PACKED.  IF WRONG @Y30LB12*/
*/*            LENGTH, SET INDICATOR THAT ERROR MESSAGE IS   @Y30LB12*/
*/*            NEEDED.                                       @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0428
*CPUCONV:                                                          0428
*   PROCEDURE;                      /*                       @Y30LB12*/
CPUCONV  STM   @14,@12,@SA00013                                    0428
*   IF SCANLEN=10                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00448                              0429
         BNE   @RF00429                                            0429
*     DO;                           /*                       @Y30LB12*/
*       UNPACKED(1:10)=SCANDATA(1:10);/*                     @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0431
         MVC   UNPACKED(10),SCANDATA(@07)                          0431
*       UNPACKED(11)='F0'X;         /*                       @Y30LB12*/
         MVI   UNPACKED+10,X'F0'                                   0432
*       GEN(PACK  PACKED(6),UNPACKED(11));/*                 @Y30LB12*/
         PACK  PACKED(6),UNPACKED(11)
*       CALL CPUCHECK;              /* CHECK FOR NUMERICS    @Y30LB12*/
         BAL   @14,CPUCHECK                                        0434
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     ERROR='1'B;                   /* TESTED IN S04CPUID    @Y30LB12*/
         B     @RC00429                                            0436
@RF00429 OI    ERROR,B'00010000'                                   0436
*   END CPUCONV;                    /* RETURN TO S04CPUID    @Y30LB12*/
@EL00013 DS    0H                                                  0437
@EF00013 DS    0H                                                  0437
@ER00013 LM    @14,@12,@SA00013                                    0437
         BR    @14                                                 0437
*                                                                  0438
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CPUCHECK                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK EACH CHARACTER OF CPUID FOR A NUMERIC   @Y30LB12*/
*/*            DIGIT IN THE RANGE 0-9                        @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0438
*CPUCHECK:                                                         0438
*   PROCEDURE;                      /*                       @Y30LB12*/
CPUCHECK STM   @14,@12,@SA00014                                    0438
*   DO I=1 TO 10;                   /* INDEX TO SCANDATA     @Y30LB12*/
         LA    I,1                                                 0439
@DL00439 DS    0H                                                  0440
*     HAVENUM='0'B;                 /* FOUND NUMBER FLAG     @Y30LB12*/
         NI    HAVENUM,B'11111101'                                 0440
*     DO J=1 TO 10;                 /* INDEX TO NUMBERS      @Y30LB12*/
         LA    J,1                                                 0441
@DL00441 DS    0H                                                  0442
*       IF SCANDATA(I)=PATTERN2(J)  /* IF MATCH              @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0442
         ALR   @07,I                                               0442
         BCTR  @07,0                                               0442
         LA    @05,PATTERN2-1(J)                                   0442
         CLC   SCANDATA(1,@07),0(@05)                              0442
         BNE   @RF00442                                            0442
*         HAVENUM='1'B;             /* SET FOUND MATCH       @Y30LB12*/
         OI    HAVENUM,B'00000010'                                 0443
*       ELSE                                                       0444
*         ;                         /*                       @Y30LB12*/
@RF00442 DS    0H                                                  0445
*     END;                          /* ALL VALID NUMBERS     @Y30LB12*/
         AH    J,@CH00044                                          0445
         CH    J,@CH00448                                          0445
         BNH   @DL00441                                            0445
*     IF HAVENUM^='1'B              /* NO MATCH FOUND        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    HAVENUM,B'00000010'                                 0446
         BO    @RF00446                                            0446
*       DO;                         /*                       @Y30LB12*/
*                                                                  0447
*         /***********************************************************/
*         /*                                                         */
*         /* ******************************************@Y30LB12      */
*         /* ICG223I VALUE ERROR FOR CPUID                   @Y30LB12*/
*         /* ******************************************@Y30LB12      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0448
*         OUTBUF2(1:25)=ICGDS223;   /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0448
*         OUTBUF2(26:30)='CPUID';   /*                       @Y30LB12*/
         MVC   OUTBUF2+25(5,R4),@CC00636                           0449
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0450
*         RETURN;                   /* STOP CHECKING         @Y30LB12*/
@EL00014 DS    0H                                                  0451
@EF00014 DS    0H                                                  0451
@ER00014 LM    @14,@12,@SA00014                                    0451
         BR    @14                                                 0451
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0453
*       ;                           /*                       @Y30LB12*/
@RF00446 DS    0H                                                  0454
*   END;                            /* CHECKED ALL CHARS     @Y30LB12*/
         AH    I,@CH00044                                          0454
         CH    I,@CH00448                                          0454
         BNH   @DL00439                                            0454
*   END CPUCHECK;                   /* RETURN TO CPUCONV     @Y30LB12*/
         B     @EL00014                                            0455
*                                                                  0456
*/********************************************************** @OZ09548*/
*/*                                                          @OZ09548*/
*/* PROCEDURE NAME - REALALTP                                @OZ09548*/
*/*                                                          @OZ09548*/
*/* FUNCTION - CHECK THE FIRST KEYWORD FOLLOWING 'REAL' OR   @OZ09548*/
*/*            'CONVREAL' FOR THE VALUE 'ALTPATH='.  IF THE  @OZ09548*/
*/*            VALUE IS FOUND, CALL THE ROUTINE 'S04ALTP'    @OZ09548*/
*/*            TO PROCESS THE ALTERNATE PATH INFORMATION,    @OZ09548*/
*/*            AND THEN CALL 'RSGALTP' TO MOVE THE           @OZ09548*/
*/*            ALTERNATE PATH INFORMATION INTO EACH BLOCK.   @OZ09548*/
*/*            IF THE KEYWORD SCANNED IS NOT 'ALTPATH=',     @OZ09548*/
*/*            RESET THE POINTERS 'STARTCCOL' AND 'NEXTCOL'  @OZ09548*/
*/*            TO RESCAN THE KEYWORD IN THE MAIN SCAN        @OZ09548*/
*/*            ROUTINE, 'S04SCAN'.                           @OZ09548*/
*/*                                                          @OZ09548*/
*/********************************************************** @OZ09548*/
*                                                                  0456
*REALALTP:                                                         0456
*   PROCEDURE;                      /*                       @OZ09548*/
REALALTP STM   @14,@12,@SA00015                                    0456
*   ALTPDUN='0'B;                   /* INIT. OUT FLAG        @ZA28470*/
         NI    ALTPDUN,B'11111011'                                 0457
*   DO WHILE LASTPARM='0'B&         /* CHECK ALL PARMS       @ZA28470*/
*         ALTPDUN='0'B;             /* CHECK OUT FLAG,ON EXIT@ZA28470*/
         B     @DE00458                                            0458
@DL00458 DS    0H                                                  0459
*     SAVESCOL=STARTCOL;            /* SAVE FOR RESTART      @OZ09548*/
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0459
*     SAVENCOL=NEXTCOL;             /* SAVE FOR RESTART      @OZ09548*/
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0460
*     CALL READS99;                 /* READ NEXT KEYWORD     @OZ09548*/
         BAL   @14,READS99                                         0461
*     IF SCANDATA(1:8)='ALTPATH='   /*                       @OZ09548*/
*       THEN                        /*                       @OZ09548*/
         L     @07,STARTCOL(,R4)                                   0462
         CLC   SCANDATA(8,@07),@CC00649                            0462
         BNE   @RF00462                                            0462
*       DO;                         /*                       @OZ09548*/
*         CALL S04ALTP;             /* GET PARAMETERS        @OZ09548*/
         BAL   @14,S04ALTP                                         0464
*         CALL RSGALTP;             /* MOVE TO WORK AREA     @OZ09548*/
         BAL   @14,RSGALTP                                         0465
*       END;                        /*                       @OZ09548*/
*     ELSE                          /*                       @OZ09548*/
*       DO;                         /*                       @OZ09548*/
         B     @RC00462                                            0467
@RF00462 DS    0H                                                  0468
*         ALTPDUN='1'B;             /* SET OUT FLAG 'ON'     @ZA28470*/
         OI    ALTPDUN,B'00000100'                                 0468
*         STARTCOL=SAVESCOL;        /* RESTORE TO RESTART    @OZ09548*/
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0469
*         NEXTCOL=SAVENCOL;         /* RESTORE TO RESTART    @OZ09548*/
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0470
*       END;                        /*                       @OZ09548*/
*   END;                            /*                       @ZA28470*/
@RC00462 DS    0H                                                  0472
@DE00458 TM    LASTPARM(R4),B'00001000'                            0472
         BNZ   @DC00458                                            0472
         TM    ALTPDUN,B'00000100'                                 0472
         BZ    @DL00458                                            0472
@DC00458 DS    0H                                                  0473
*   END REALALTP;                   /*                       @OZ09548*/
@EL00015 DS    0H                                                  0473
@EF00015 DS    0H                                                  0473
@ER00015 LM    @14,@12,@SA00015                                    0473
         BR    @14                                                 0473
*                                                                  0474
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04VVS                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SCAN FOR SECONDARY KEYWORDS 'RSG', 'ADDR', &  @Y30LB12*/
*/*            'ALTPATH' AND CALL THE APPROPRIATE SUBROUTINE @Y30LB12*/
*/*            TO HANDLE EACH PARAMETER OR PARAMETERS THAT   @Y30LB12*/
*/*            FOLLOW.  IF THE KEYWORD IS NONE OF THE THREE  @Y30LB12*/
*/*            KEYWORDS LISTED ABOVE, LOGICALLY REPOSITION   @Y30LB12*/
*/*            TO THE START OF THE KEYWORD AND RETURN TO     @Y30LB12*/
*/*            S04SCAN TO REPROCESS.                         @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0474
*S04VVS:                                                           0474
*   PROCEDURE;                      /*                       @Y30LB12*/
S04VVS   STM   @14,@12,@SA00016                                    0474
*   HAVERSG='0'B;                   /* ALLOW 1 PER GROUP     @Y30LB12*/
         NI    HAVERSG,B'11111011'                                 0475
*   KNOWN2='1'B;                    /* LOOP CONTROL FLAG     @Y30LB12*/
         OI    KNOWN2,B'01000000'                                  0476
*   DO WHILE(KNOWN2='1'B            /*                       @YM32178*/
*         &LASTPARM='0'B);          /*                       @YM32178*/
         B     @DE00477                                            0477
@DL00477 DS    0H                                                  0478
*     KNOWN2='0'B;                  /* RESET FLAG            @Y30LB12*/
         NI    KNOWN2,B'10111111'                                  0478
*     SAVESCOL=STARTCOL;            /* SAVE FOR RESTART      @Y30LB12*/
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0479
*     SAVENCOL=NEXTCOL;             /* SAVE FOR RESTART      @Y30LB12*/
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0480
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/
*                                                                  0481
         BAL   @14,READS99                                         0481
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED IS SDG                       @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0482
*     IF SCANDATA(1:4)='SDG='&KNOWN2='0'B/*                  @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0482
         CLC   SCANDATA(4,@07),@CC00654                            0482
         BNE   @RF00482                                            0482
         TM    KNOWN2,B'01000000'                                  0482
         BNZ   @RF00482                                            0482
*       DO;                         /*                       @Y30LB12*/
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN2,B'01000000'                                  0484
*         CALL S04RSG;              /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04RSG                                          0485
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0487
*       ;                           /*                       @Y30LB12*/
*                                                                  0487
@RF00482 DS    0H                                                  0488
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED IS ADDR                      @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0488
*     IF SCANDATA(1:5)='ADDR='&KNOWN2='0'B/*                 @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0488
         CLC   SCANDATA(5,@07),@CC00656                            0488
         BNE   @RF00488                                            0488
         TM    KNOWN2,B'01000000'                                  0488
         BNZ   @RF00488                                            0488
*       DO;                         /*                       @Y30LB12*/
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN2,B'01000000'                                  0490
*         CALL S04ADDR;             /* TO GET PARAMETERS     @Y30LB12*/
         BAL   @14,S04ADDR                                         0491
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0493
*       ;                           /*                       @Y30LB12*/
*                                                                  0493
@RF00488 DS    0H                                                  0494
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED IS ALTPATH                   @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0494
*     IF SCANDATA(1:8)='ALTPATH='&KNOWN2='0'B/*              @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0494
         CLC   SCANDATA(8,@07),@CC00649                            0494
         BNE   @RF00494                                            0494
         TM    KNOWN2,B'01000000'                                  0494
         BNZ   @RF00494                                            0494
*       DO;                         /*                       @Y30LB12*/
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN2,B'01000000'                                  0496
*         CALL S04ALTP;             /* TO GET PARAMETERS     @Y30LB12*/
         BAL   @14,S04ALTP                                         0497
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0499
*       ;                           /*                       @Y30LB12*/
*                                                                  0499
@RF00494 DS    0H                                                  0500
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF KEYWORD WAS NONE OF THE THREE TESTED ABOVE,      @Y30LB12*/
*     /* RESTORE THE STARTING COLUMN AND NEXT COLUNM         @Y30LB12*/
*     /* SO THAT THE KEYWORD CAN BE RESCANNED IN THE         @Y30LB12*/
*     /* PROCEDURE S04SCAN, AND CHECK TO BE SURE THAT        @Y30LB12*/
*     /* THE KEYWORD AND PARAMETER FOR RSG AND ADDR          @YM31098*/
*     /* WERE SUPPLIED.                                      @YM31098*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0500
*     IF KNOWN2='0'B                /* NO RECOGNITION        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN2,B'01000000'                                  0500
         BNZ   @RF00500                                            0500
*       DO;                         /*                       @Y30LB12*/
*         STARTCOL=SAVESCOL;        /* RESTORE TO RESTRT     @Y30LB12*/
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0502
*         NEXTCOL=SAVENCOL;         /* RESTORE TO RESTRT     @Y30LB12*/
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0503
*         IF HAVERSG='0'B           /* NO RSG SPECIFIED      @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         TM    HAVERSG,B'00000100'                                 0504
         BNZ   @RF00504                                            0504
*           DO;                     /*                       @Y30LB12*/
*                                                                  0505
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @Y30LB12*/
*             /* ICG221I MISSING REQUIRED                    @Y30LB12*/
*             /* KEYWORD SDG                                 @Y30LB12*/
*             /* ***********************************         @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0506
*             OUTBUF2(1:34)=ICGDS221;/*                      @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0506
*             OUTBUF2(35:37)='SDG'; /*                       @Y30LB12*/
         MVC   OUTBUF2+34(3,R4),@CC00659                           0507
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0508
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0510
*           ;                       /*                       @Y30LB12*/
@RF00504 DS    0H                                                  0511
*         IF HAVEADDR='0'B          /* NO ADDR SPECIFIED     @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         TM    HAVEADDR,B'00000001'                                0511
         BNZ   @RF00511                                            0511
*           DO;                     /*                       @Y30LB12*/
*                                                                  0512
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @Y30LB12*/
*             /* ICG221I MISSING REQUIRED                    @Y30LB12*/
*             /* KEYWORD ADDR                                @Y30LB12*/
*             /* ***********************************         @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0513
*             OUTBUF2(1:34)=ICGDS221;/*                      @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0513
*             OUTBUF2(35:38)='ADDR';/*                       @Y30LB12*/
         MVC   OUTBUF2+34(4,R4),@CC00661                           0514
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0515
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0517
*           ;                       /*                       @Y30LB12*/
@RF00511 DS    0H                                                  0518
*         RETURN;                   /* RETURN TO S04SCAN     @Y30LB12*/
@EL00016 DS    0H                                                  0518
@EF00016 DS    0H                                                  0518
@ER00016 LM    @14,@12,@SA00016                                    0518
         BR    @14                                                 0518
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0520
*       ;                           /*                       @Y30LB12*/
@RF00500 DS    0H                                                  0521
*   END;                            /* OF DO WHILE LOOP      @Y30LB12*/
@DE00477 TM    KNOWN2,B'01000000'                                  0521
         BNO   @DC00477                                            0521
         TM    LASTPARM(R4),B'00001000'                            0521
         BZ    @DL00477                                            0521
@DC00477 DS    0H                                                  0522
*   END S04VVS;                     /* RETURN TO S04SCAN     @Y30LB12*/
         B     @EL00016                                            0522
*                                                                  0523
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04RSG                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK TO BE SURE THERE IS ONLY ONE RSG GIVEN  @Y30LB12*/
*/*            FOR THIS 'V' OR 'VS' GROUP.  CALL CONVRSG TO  @Y30LB12*/
*/*            DEVELOP RSG NUMBER.  SAVE IN GETRSG UNTIL ALL @Y30LB12*/
*/*            SUBKEYWORDS AND SUBPARAMETERS FOR THIS        @Y30LB12*/
*/*            SUBGROUP HAVE BEEN READ.                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0523
*S04RSG:                                                           0523
*   PROCEDURE;                      /*                       @Y30LB12*/
S04RSG   STM   @14,@12,@SA00017                                    0523
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0524
*   IF HAVERSG^='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVERSG,B'00000100'                                 0525
         BO    @RF00525                                            0525
*     HAVERSG='1'B;                 /*                       @Y30LB12*/
         OI    HAVERSG,B'00000100'                                 0526
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0527
         B     @RC00525                                            0527
@RF00525 DS    0H                                                  0528
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD SDG'                   @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0528
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0528
*       OUTBUF2(28:30)='SDG';       /*                       @Y30LB12*/
         MVC   OUTBUF2+27(3,R4),@CC00659                           0529
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0530
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/
@EL00017 DS    0H                                                  0531
@EF00017 DS    0H                                                  0531
@ER00017 LM    @14,@12,@SA00017                                    0531
         BR    @14                                                 0531
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00525 TM    PARMBIT(R4),B'00100000'                             0533
         BO    @RF00533                                            0533
*     DO;                           /*                       @Y30LB12*/
*                                                                  0534
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0535
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0535
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0536
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/
         B     @EL00017                                            0537
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0539
*     ;                             /*                       @Y30LB12*/
@RF00533 DS    0H                                                  0540
*   WORKRSG='0000'X;                /* INITIALIZE TO 0       @Y30LB12*/
         MVC   WORKRSG(2),@CB00665                                 0540
*   IF SCANLEN=1                    /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0541
         BNE   @RF00541                                            0541
*     DO;                           /*                       @Y30LB12*/
*       WORKRSG(1)='F0'X;           /*                       @Y30LB12*/
         MVI   WORKRSG,X'F0'                                       0543
*       WORKRSG(2)=SCANDATA(1);     /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0544
         MVC   WORKRSG+1(1),SCANDATA(@07)                          0544
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     IF SCANLEN=2                  /* SET BY ICGDSS99       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00541                                            0546
@RF00541 CLC   SCANLEN(2,R4),@CH00052                              0546
         BNE   @RF00546                                            0546
*       WORKRSG(1:2)=SCANDATA(1:2); /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0547
         MVC   WORKRSG(2),SCANDATA(@07)                            0547
*     ELSE                                                         0548
*       ;                           /*                       @Y30LB12*/
@RF00546 DS    0H                                                  0549
*   IF WORKRSG='0000'X              /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00541 CLC   WORKRSG(2),@CB00665                                 0549
         BNE   @RF00549                                            0549
*     DO;                           /*                       @Y30LB12*/
*                                                                  0550
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/
*       /* KEYWORD IS SDG                                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0551
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0551
*       OUTBUF2(47:49)='SDG';       /*                       @Y30LB12*/
         MVC   OUTBUF2+46(3,R4),@CC00659                           0552
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0553
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
         B     @RC00549                                            0555
@RF00549 DS    0H                                                  0556
*       CALL CONVDEC;               /* TO CONVERT PARM       @Y30LB12*/
         BAL   @14,CONVDEC                                         0556
*       IF WORKRSG>MAXRSG           /* MAXIMUM VALUE         @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         MVC   @ZT00002+2(2),WORKRSG                               0557
         L     @07,@ZT00002                                        0557
         CH    @07,MAXRSG                                          0557
         BNH   @RF00557                                            0557
*         DO;                       /*                       @Y30LB12*/
*                                                                  0558
*           /*********************************************************/
*           /*                                                       */
*           /* ***********************************           @Y30LB12*/
*           /* ICG223I VALUE ERROR FOR SDG                   @Y30LB12*/
*           /* ***********************************           @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0559
*           OUTBUF2(1:25)=ICGDS223; /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0559
*           OUTBUF2(26:28)='SDG';   /*                       @Y30LB12*/
         MVC   OUTBUF2+25(3,R4),@CC00659                           0560
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0561
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0563
*         ;                         /*                       @Y30LB12*/
@RF00557 DS    0H                                                  0564
*     END;                          /*                       @Y30LB12*/
*   END S04RSG;                     /* RETURN TO S04VVS      @Y30LB12*/
         B     @EL00017                                            0565
*                                                                  0566
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVDEC                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CONVERT DECIMAL NUMBER TO BINARY              @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0566
*CONVDEC:                                                          0566
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVDEC  STM   @14,@12,@SA00018                                    0566
*   IF HIGHRSG^='1111'BLOWRSG^='1111'B/*                    @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HIGHRSG,B'11110000'                                 0567
         BNO   @RT00567                                            0567
         TM    LOWRSG,B'11110000'                                  0567
         BO    @RF00567                                            0567
@RT00567 DS    0H                                                  0568
*     DO;                           /*                       @Y30LB12*/
*                                                                  0568
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG228I PARAMETER MUST BE NUMERIC,                @Y30LB12*/
*       /* KEYWORD IS SDG                                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0569
*       OUTBUF2(1:47)=ICGDS228;     /*                       @Y30LB12*/
         MVC   OUTBUF2(47,R4),ICGDS228                             0569
*       OUTBUF2(48:50)='SDG';       /*                       @Y30LB12*/
         MVC   OUTBUF2+47(3,R4),@CC00659                           0570
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0571
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
         B     @RC00567                                            0573
@RF00567 DS    0H                                                  0574
*       PACKWORK='0000000000000000'X;/*                      @Y30LB12*/
         MVC   PACKWORK(8),@CB00671                                0574
*       GEN(PACK  PACKWORK+6(2),WORKRSG);/*                  @Y30LB12*/
         PACK  PACKWORK+6(2),WORKRSG
*       GEN(CVB   R6,PACKWORK);     /*                       @Y30LB12*/
         CVB   R6,PACKWORK
*       GEN(STH   R6,WORKRSG);      /*                       @Y30LB12*/
         STH   R6,WORKRSG
*     END;                          /*                       @Y30LB12*/
*   END CONVDEC;                    /* RETURN TO CALLER      @Y30LB12*/
@EL00018 DS    0H                                                  0579
@EF00018 DS    0H                                                  0579
@ER00018 LM    @14,@12,@SA00018                                    0579
         BR    @14                                                 0579
*                                                                  0580
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVHEX2                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CONVERT TWO HEX CHARACTERS TO BINARY          @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0580
*CONVHEX2:                                                         0580
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVHEX2 STM   @14,@12,12(@13)                                     0580
*   DO I=1 TO MAXDEV;               /* INDEX THRU TABLE      @Y30LB12*/
         LA    I,1                                                 0581
         B     @DE00581                                            0581
@DL00581 DS    0H                                                  0582
*     IF PATTERN(I)=WORKHEX2        /* IF CHAR MATCH         @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @07,I                                               0582
         ALR   @07,@07                                             0582
         LA    @05,PATTERN-2(@07)                                  0582
         CLC   0(2,@05),WORKHEX2                                   0582
         BNE   @RF00582                                            0582
*       DO;                         /*                       @Y30LB12*/
*         WORKHEX2=I;               /* I IS BINARY EQUIV.    @YD00113*/
         STH   I,WORKHEX2                                          0584
*         RETURN;                   /* RETURN TO CALLER      @Y30LB12*/
@EL00019 DS    0H                                                  0585
@EF00019 DS    0H                                                  0585
@ER00019 LM    @14,@12,12(@13)                                     0585
         BR    @14                                                 0585
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0587
*       ;                           /*                       @Y30LB12*/
@RF00582 DS    0H                                                  0588
*   END;                            /* NO MATCH IN 64        @Y30LB12*/
         AH    I,@CH00044                                          0588
@DE00581 CH    I,MAXDEV                                            0588
         BNH   @DL00581                                            0588
*   END CONVHEX2;                   /* RETURN TO CALLER      @Y30LB12*/
         B     @EL00019                                            0589
*                                                                  0590
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ADDR                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SCAN FROM 1 TO 64 UNIT ADDRESSES IN THE RANGE @Y30LB12*/
*/*            00-3F.  AT END OF ADDRESSES WHEN LASTPARM=1   @Y30LB12*/
*/*            OR WHEN ANOTHER KEYWORD IS READ.  SAVE IN     @Y30LB12*/
*/*            TEMPORARY AREA WK1ADDR  UNTIL ALL SUBKEYWORDS @Y30LB12*/
*/*            AND SUBPARAMETERS FOR THIS SUBGROUP HAVE      @Y30LB12*/
*/*            BEEN READ.                                    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0590
*S04ADDR:                                                          0590
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ADDR  STM   @14,@12,@SA00020                                    0590
*   KNOWN3='1'B;                    /* LOOP CONTROL FLAG     @Y30LB12*/
         OI    KNOWN3,B'00100000'                                  0591
*   HAVEADDR='0'B;                  /* RESET ADDR FLAG       @Y30LB12*/
         NI    HAVEADDR,B'11111110'                                0592
*   DO WHILE(KNOWN3='1'B);          /* FOR REC. KEYWORD      @Y30LB12*/
         B     @DE00593                                            0593
@DL00593 DS    0H                                                  0594
*     SAVESCOL=STARTCOL;            /* TO RESCAN IF KEY      @Y30LB12*/
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0594
*     SAVENCOL=NEXTCOL;             /* TO RESCAN IF KEY      @Y30LB12*/
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0595
*     CALL READS99;                 /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0596
*     IF PARMBIT='1'B               /* SET BY ICGDSS99       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    PARMBIT(R4),B'00100000'                             0597
         BNO   @RF00597                                            0597
*       IF SCANLEN=2                /* SET BY ICGDSS99       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00052                              0598
         BNE   @RF00598                                            0598
*         DO;                       /*                       @Y30LB12*/
*           HAVEADDR='1'B;          /* ADDRESS SPECIFIED     @Y30LB12*/
         OI    HAVEADDR,B'00000001'                                0600
*           WORKHEX2=SCANDATA(1:2); /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0601
         MVC   WORKHEX2(2),SCANDATA(@07)                           0601
*           CALL CONVHEX2;          /* FOR BINARY EQUIV.     @Y30LB12*/
         BAL   @14,CONVHEX2                                        0602
*           WORKNUM=WORKHEX2;       /* SAVE VALUE RET'D      @Y30LB12*/
         MVC   @ZT00002+2(2),WORKHEX2                              0603
         L     @07,@ZT00002                                        0603
         STH   @07,WORKNUM                                         0603
*           IF WORKNUM>0&WORKNUM<MAXDEV+1/*                  @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LTR   @07,@07                                             0604
         BNP   @RF00604                                            0604
         LA    @05,1                                               0604
         AH    @05,MAXDEV                                          0604
         CR    @07,@05                                             0604
         BNL   @RF00604                                            0604
*             IF ADR1SPEC(WORKNUM)^='1'B/*                   @YM31098*/
*               THEN                /*                       @YM31098*/
         MH    @07,@CH00257                                        0605
         LA    @05,ADR1SPEC-11(@07)                                0605
         TM    0(@05),B'10000000'                                  0605
         BO    @RF00605                                            0605
*               ADR1SPEC(WORKNUM)='1'B;/*                    @YM31098*/
         LA    @05,ADR1SPEC-11(@07)                                0606
         OI    0(@05),B'10000000'                                  0606
*             ELSE                  /*                       @YM31098*/
*               DO;                 /*                       @YM31098*/
*                                                                  0607
         B     @RC00605                                            0607
@RF00605 DS    0H                                                  0608
*                 /***************************************************/
*                 /*                                                 */
*                 /* ***************************             @YM31098*/
*                 /* ICG226I DUPLICATE                       @YM31098*/
*                 /* SPECIFICATION FOR DEVICE                @YM31098*/
*                 /* XX                                      @YM31098*/
*                 /* ***************************             @YM31098*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0608
*                 OUTBUF2(1:44)=ICGDS226;/*                  @YM31098*/
         MVC   OUTBUF2(44,R4),ICGDS226                             0608
*                 OUTBUF2(45:46)=PATTERN(WORKNUM);                 0609
         LH    @07,WORKNUM                                         0609
         ALR   @07,@07                                             0609
         LA    @05,PATTERN-2(@07)                                  0609
         MVC   OUTBUF2+44(2,R4),0(@05)                             0609
*                 CALL PUTIT1;      /*                       @YM31098*/
         BAL   @14,PUTIT1                                          0610
*               END;                /*                       @YM31098*/
*           ELSE                    /*                       @Y30LB12*/
*             DO;                   /*                       @Y30LB12*/
*                                                                  0612
         B     @RC00604                                            0612
@RF00604 DS    0H                                                  0613
*               /*****************************************************/
*               /*                                                   */
*               /* *******************************           @Y30LB12*/
*               /* ICG223I VALUE ERROR FOR                   @Y30LB12*/
*               /* (REAL/CONVREAL/                           @Y30LB12*/
*               /* V, ADDR/VS, ADDR)                         @YM31098*/
*               /* *******************************           @Y30LB12*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0613
*               OUTBUF2(1:25)=ICGDS223;/*                    @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0613
*               OUTBUF2(26:33)=PLUGIN;/*                     @Y30LB12*/
         MVC   OUTBUF2+25(8,R4),PLUGIN                             0614
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0615
*             END;                  /*                       @Y30LB12*/
*         END;                      /*                       @Y30LB12*/
*                                                                  0617
*     /***************************************************************/
*     /*                                                             */
*     /* *********************************************       @OZ09548*/
*     /* CHECK FOR THE SPECIFICATION OF A RANGE OF           @OZ09548*/
*     /* ADDRESSES (XX-YY)                                   @OZ09548*/
*     /* *********************************************       @OZ09548*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0618
*       ELSE                        /*                       @OZ09548*/
*         IF SCANLEN=5              /*                       @OZ09548*/
*           THEN                    /*                       @OZ09548*/
         B     @RC00598                                            0618
@RF00598 CLC   SCANLEN(2,R4),@CH00121                              0618
         BNE   @RF00618                                            0618
*           DO;                     /*                       @OZ09548*/
*             HAVEADDR='1'B;        /* ADDRESS SPECIFIED     @OZ09548*/
         OI    HAVEADDR,B'00000001'                                0620
*             WORKHEX2=SCANDATA(1:2);/* LOW VALUE            @OZ09548*/
         L     @07,STARTCOL(,R4)                                   0621
         MVC   WORKHEX2(2),SCANDATA(@07)                           0621
*             CALL CONVHEX2;        /* CONVERT TO BINARY     @OZ09548*/
         BAL   @14,CONVHEX2                                        0622
*             WORKA=WORKHEX2;       /* SAVE LOW VALUE        @OZ09548*/
         MVC   WORKA(2),WORKHEX2                                   0623
*             WORKHEX2=SCANDATA(4:5);/* HIGH VALUE           @OZ09548*/
         L     @07,STARTCOL(,R4)                                   0624
         MVC   WORKHEX2(2),SCANDATA+3(@07)                         0624
*             CALL CONVHEX2;        /*                       @OZ09548*/
         BAL   @14,CONVHEX2                                        0625
*             WORKB=WORKHEX2;       /* SAVE HIGH VALUE       @OZ09548*/
*                                                                  0626
         MVC   WORKB(2),WORKHEX2                                   0626
*             /*******************************************************/
*             /*                                                     */
*             /* *************************************       @OZ09548*/
*             /* TEST THE VALIDITY OF THE RANGE              @OZ09548*/
*             /* SPECIFIED. VALIDITY TESTS ARE -             @OZ09548*/
*             /* - LOW VALUE (WORKA) NOT NEGATIVE            @OZ09548*/
*             /* - HIGH VALUE LESS THAN 65 (DEC.)            @OZ09548*/
*             /* - LOW VALUE LESS THAN HIGH VALUE            @OZ09548*/
*             /* - TWO VALUES SEPARATED BY DASH (-)          @OZ09548*/
*             /* *************************************       @OZ09548*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0627
*             IF WORKA>0            /*                       @OZ09548*/
*                 &WORKB<MAXDEV+1   /*                       @OZ09548*/
*                 &WORKA<WORKB      /*                       @OZ09548*/
*                 &SCANDATA(3)='-'  /*                       @OZ09548*/
*               THEN                /*                       @OZ09548*/
*                                                                  0627
         MVC   @ZT00002+2(2),WORKA                                 0627
         L     @07,@ZT00002                                        0627
         LTR   @07,@07                                             0627
         BNP   @RF00627                                            0627
         LA    @05,1                                               0627
         AH    @05,MAXDEV                                          0627
         MVC   @ZT00002+2(2),WORKB                                 0627
         C     @05,@ZT00002                                        0627
         BNH   @RF00627                                            0627
         CLC   WORKA(2),WORKB                                      0627
         BNL   @RF00627                                            0627
         L     @05,STARTCOL(,R4)                                   0627
         CLI   SCANDATA+2(@05),C'-'                                0627
         BNE   @RF00627                                            0627
*               /*****************************************************/
*               /*                                                   */
*               /* *********************************         @OZ09548*/
*               /* CHECK ALL VALUES WITHIN THE               @OZ09548*/
*               /* RANGE FOR PREVIOUS USE. IF                @OZ09548*/
*               /* NOT PREVIOUSLY USED, MARK AS              @OZ09548*/
*               /* USED HERE                                 @OZ09548*/
*               /* *********************************         @OZ09548*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0628
*               DO I=WORKA TO WORKB;/*                       @OZ09548*/
         LR    I,@07                                               0628
         B     @DE00628                                            0628
@DL00628 DS    0H                                                  0629
*                 IF ADR1SPEC(I)^='1'B/*                     @OZ09548*/
*                   THEN            /*                       @OZ09548*/
         LR    @07,I                                               0629
         MH    @07,@CH00257                                        0629
         LA    @05,ADR1SPEC-11(@07)                                0629
         TM    0(@05),B'10000000'                                  0629
         BO    @RF00629                                            0629
*                   ADR1SPEC(I)='1'B;/*                      @OZ09548*/
         LA    @05,ADR1SPEC-11(@07)                                0630
         OI    0(@05),B'10000000'                                  0630
*                 ELSE              /*                       @OZ09548*/
*                   DO;             /*                       @OZ09548*/
*                                                                  0631
         B     @RC00629                                            0631
@RF00629 DS    0H                                                  0632
*                     /***********************************************/
*                     /*                                             */
*                     /* ***************************         @OZ09548*/
*                     /* ICG226I DUPLICATE                   @OZ09548*/
*                     /* SPECIFICATION FOR DEVICE            @OZ09548*/
*                     /* XX                                  @OZ09548*/
*                     /* ***************************         @OZ09548*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0632
*                     OUTBUF2(1:44)=ICGDS226;/*              @OZ09548*/
         MVC   OUTBUF2(44,R4),ICGDS226                             0632
*                     OUTBUF2(45:46)=PATTERN(I);/*           @OZ09548*/
         LR    @07,I                                               0633
         ALR   @07,@07                                             0633
         LA    @05,PATTERN-2(@07)                                  0633
         MVC   OUTBUF2+44(2,R4),0(@05)                             0633
*                     CALL PUTIT1;  /*                       @OZ09548*/
         BAL   @14,PUTIT1                                          0634
*                   END;            /* END OF DO LOOP        @OZ09548*/
*               END;                /*                       @OZ09548*/
@RC00629 AH    I,@CH00044                                          0636
@DE00628 MVC   @ZT00002+2(2),WORKB                                 0636
         C     I,@ZT00002                                          0636
         BNH   @DL00628                                            0636
*             ELSE                  /* BAD VALUE RETURNED    @OZ09548*/
*               DO;                 /*                       @OZ09548*/
*                                                                  0637
         B     @RC00627                                            0637
@RF00627 DS    0H                                                  0638
*                 /***************************************************/
*                 /*                                                 */
*                 /* *******************************         @OZ09548*/
*                 /* ICG223I VALUE ERROR FOR                 @OZ09548*/
*                 /* (REAL/CONVREAL/                         @OZ09548*/
*                 /* V, ADDR/VS, ADDR)                       @OZ09548*/
*                 /* *******************************         @OZ09548*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0638
*                 OUTBUF2(1:25)=ICGDS223;/*                  @OZ09548*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0638
*                 OUTBUF2(26:33)=PLUGIN;/*                   @OZ09548*/
         MVC   OUTBUF2+25(8,R4),PLUGIN                             0639
*                 CALL PUTIT1;      /*                       @OZ09548*/
         BAL   @14,PUTIT1                                          0640
*               END;                /*                       @OZ09548*/
*           END;                    /*                       @OZ09548*/
*         ELSE                      /*                       @OZ09548*/
*           DO;                     /* SCANLEN NOT 2,5       @OZ09548*/
         B     @RC00618                                            0643
@RF00618 DS    0H                                                  0644
*             HAVEADDR='1'B;        /* ADDRESS SPECIFIED     @OZ09548*/
*                                                                  0644
         OI    HAVEADDR,B'00000001'                                0644
*             /*******************************************************/
*             /*                                                     */
*             /* *************************************       @Y30LB12*/
*             /* ICG220I INVALID PARAMETER LENGTH            @Y30LB12*/
*             /* KEYWORD IS (REAL/CONVREAL/                  @Y30LB12*/
*             /* V, ADDR/VS, ADDR)                           @YM31098*/
*             /* *************************************       @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0645
*             OUTBUF2(1:46)=ICGDS220;/*                      @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0645
*             OUTBUF2(47:54)=PLUGIN;/*                       @Y30LB12*/
         MVC   OUTBUF2+46(8,R4),PLUGIN                             0646
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0647
*           END;                    /*                       @Y30LB12*/
*     ELSE                          /* IF NOT PARAMETER      @Y30LB12*/
*       DO;                         /*                       @Y30LB12*/
         B     @RC00597                                            0649
@RF00597 DS    0H                                                  0650
*         STARTCOL=SAVESCOL;        /* RESTORE RESCAN        @Y30LB12*/
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0650
*         NEXTCOL=SAVENCOL;         /* RESTORE RESCAN        @Y30LB12*/
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0651
*         KNOWN3='0'B;              /* END CONTROL LOOP      @Y30LB12*/
         NI    KNOWN3,B'11011111'                                  0652
*         IF HAVEADDR='0'B          /* IF NO ADDR FOUND      @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         TM    HAVEADDR,B'00000001'                                0653
         BNZ   @RF00653                                            0653
*           DO;                     /*                       @Y30LB12*/
*                                                                  0654
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @Y30LB12*/
*             /* ICG211I EXPECTED, BUT DID NOT FIND          @YM31090*/
*             /* PARAMETER                                   @YM31090*/
*             /* ***********************************         @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0655
*             MSGNO=ICG211I;        /*                       @YM31090*/
         MVC   MSGNO(2,R4),ICG211I                                 0655
*             CALL PUTIT2;          /* TO MESSAGE WRITER     @YM31090*/
         BAL   @14,PUTIT2                                          0656
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0658
*           ;                       /*                       @Y30LB12*/
@RF00653 DS    0H                                                  0659
*         RETURN;                   /* RETURN TO CALLER      @Y30LB12*/
@EL00020 DS    0H                                                  0659
@EF00020 DS    0H                                                  0659
@ER00020 LM    @14,@12,@SA00020                                    0659
         BR    @14                                                 0659
*       END;                        /*                       @Y30LB12*/
*   END;                            /* OF DO WHILE LOOP      @Y30LB12*/
@RC00597 DS    0H                                                  0661
@DE00593 TM    KNOWN3,B'00100000'                                  0661
         BO    @DL00593                                            0661
*   END S04ADDR;                    /* RETURN TO CALLER      @Y30LB12*/
         B     @EL00020                                            0662
*                                                                  0663
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ALTP                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT THE THREE REQUIRED SUBKEYWORDS THAT   @Y30LB12*/
*/*           FOLLOW EACH ALTPATH KEYWORD AND CALL THE       @Y30LB12*/
*/*           PROCEDURES THAT EXTRACT THE  PARAMETERS.       @Y30LB12*/
*/*           UP TO THREE ALTERNATE PATHS CAN BE SPECIFIED   @Y30LB12*/
*/*           IN VS1 OR ONE ALTERNATE PATH IN VS2            @Y30LB12*/
*/*           TO EACH VIRTUAL AND SHARED VIRTUAL DEVICE      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0663
*S04ALTP:                                                          0663
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ALTP  STM   @14,@12,@SA00021                                    0663
*   KNOWN3='0'B;                    /* CONTROL FLAG          @Y30LB12*/
         NI    KNOWN3,B'11011111'                                  0664
*   ALTCOUNT=ALTCOUNT+1;            /* FOR THIS SUBGROUP     @Y30LB12*/
         LA    @07,1                                               0665
         AH    @07,ALTCOUNT                                        0665
         STH   @07,ALTCOUNT                                        0665
*   IF ALTCOUNT>MAXALT              /* MAXIMUM PATHS VS2     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CH    @07,MAXALT                                          0666
         BNH   @RF00666                                            0666
*     DO;                           /*                       @Y30LB12*/
*                                                                  0667
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG249I EXCEEDED SUPPORTED NUMBER OF              @Y30LB12*/
*       /* OF ALTERNATE PATHS                                @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0668
*       MSGNO=ICG249I;              /* IDENT FOR ICG249I     @Y30LB12*/
         MVC   MSGNO(2,R4),ICG249I                                 0668
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0669
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/
@EL00021 DS    0H                                                  0670
@EF00021 DS    0H                                                  0670
@ER00021 LM    @14,@12,@SA00021                                    0670
         BR    @14                                                 0670
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     KNOWN3='1'B;                  /* SET FOR CONTROL       @Y30LB12*/
@RF00666 OI    KNOWN3,B'00100000'                                  0672
*   DO I=1 TO 3;                    /*                       @Y30LB12*/
         LA    I,1                                                 0673
@DL00673 DS    0H                                                  0674
*     KNOWN3='0'B;                  /* CONTROL SWITCH        @Y30LB12*/
         NI    KNOWN3,B'11011111'                                  0674
*     SAVESCOL=STARTCOL;            /* START THIS SCAN       @Y30LB12*/
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0675
*     SAVENCOL=NEXTCOL;             /* START NEXT SCAN       @Y30LB12*/
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0676
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/
*                                                                  0677
         BAL   @14,READS99                                         0677
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS SA...                    @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0678
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0678
         CLC   SCANDATA(3,@07),@CC00554                            0678
         BNE   @RF00678                                            0678
*       DO;                         /*                       @Y30LB12*/
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN3,B'00100000'                                  0680
*         CALL S04ADS;              /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04ADS                                          0681
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0683
*       ;                           /*                       @Y30LB12*/
*                                                                  0683
@RF00678 DS    0H                                                  0684
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS CH...                    @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0684
*     IF SCANDATA(1:3)='CH='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0684
         CLC   SCANDATA(3,@07),@CC00558                            0684
         BNE   @RF00684                                            0684
*       DO;                         /*                       @Y30LB12*/
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN3,B'00100000'                                  0686
*         CALL S04ACH;              /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04ACH                                          0687
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0689
*       ;                           /*                       @Y30LB12*/
*                                                                  0689
@RF00684 DS    0H                                                  0690
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS CI...                    @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0690
*     IF SCANDATA(1:3)='CI='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0690
         CLC   SCANDATA(3,@07),@CC00556                            0690
         BNE   @RF00690                                            0690
*       DO;                         /*                       @Y30LB12*/
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN3,B'00100000'                                  0692
*         CALL S04ACI;              /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S04ACI                                          0693
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0695
*       ;                           /*                       @Y30LB12*/
@RF00690 DS    0H                                                  0696
*     IF KNOWN3='0'B                /* DIFFERENT KEYWORD     @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN3,B'00100000'                                  0696
         BNZ   @RF00696                                            0696
*       DO;                         /*                       @Y30LB12*/
*         CALL CHKALTP;             /* MISSING KEYWORDS      @Y30LB12*/
         BAL   @14,CHKALTP                                         0698
*         STARTCOL=SAVESCOL;        /* START THIS SCAN       @Y30LB12*/
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0699
*         NEXTCOL=SAVENCOL;         /* START NEXT SCAN       @Y30LB12*/
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0700
*         RETURN;                   /*                       @Y30LB12*/
         B     @EL00021                                            0701
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0703
*       ;                           /*                       @Y30LB12*/
@RF00696 DS    0H                                                  0704
*     IF LASTPARM='1'B              /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    LASTPARM(R4),B'00001000'                            0704
         BO    @RT00704                                            0704
*       RETURN;                     /*                       @Y30LB12*/
*     ELSE                                                         0706
*       ;                           /*                       @Y30LB12*/
*   END;                            /* END OF DO             @Y30LB12*/
         AH    I,@CH00044                                          0707
         CH    I,@CH00050                                          0707
         BNH   @DL00673                                            0707
*   END S04ALTP;                    /* RETURN TO S04VVS      @Y30LB12*/
         B     @EL00021                                            0708
*                                                                  0709
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ADS                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT THE DATA STAGER THROUGH WHICH THE     @Y30LB12*/
*/*            ALTERNATE CHANNEL FOR THIS GROUP OF VIRTUAL   @Y30LB12*/
*/*            OR SHARED VIRTUAL ADDRESSES INTERFACES.       @Y30LB12*/
*/*            THE ALTERNATE DATA STAGER MUST ATTACH TO THE  @Y30LB12*/
*/*            SAME REAL SPINDLE GROUP AS THE PRIMARY DATA   @Y30LB12*/
*/*            STAGER.  THE ALTERNATE DATA STAGER CAN BE THE @Y30LB12*/
*/*            SAME DATA STAGER AS THE PRIMARY.              @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0709
*S04ADS:                                                           0709
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ADS   STM   @14,@12,@SA00022                                    0709
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0710
*   IF HAVEADS(ALTCOUNT)^='1'B      /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,ALTCOUNT                                        0711
         SLA   @07,2                                               0711
         LA    @05,HAVEADS-4(@07)                                  0711
         TM    0(@05),B'00100000'                                  0711
         BO    @RF00711                                            0711
*     HAVEADS(ALTCOUNT)='1'B;       /*                       @Y30LB12*/
         LA    @05,HAVEADS-4(@07)                                  0712
         OI    0(@05),B'00100000'                                  0712
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0713
         B     @RC00711                                            0713
@RF00711 DS    0H                                                  0714
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD SA (ALTPATH)           @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0714
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0714
*       OUTBUF2(28:39)='SA (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+27(12,R4),@CC00693                          0715
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0716
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
@EL00022 DS    0H                                                  0717
@EF00022 DS    0H                                                  0717
@ER00022 LM    @14,@12,@SA00022                                    0717
         BR    @14                                                 0717
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00711 TM    PARMBIT(R4),B'00100000'                             0719
         BO    @RF00719                                            0719
*     DO;                           /*                       @Y30LB12*/
*                                                                  0720
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0721
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0721
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0722
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00022                                            0723
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0725
*     ;                             /*                       @Y30LB12*/
@RF00719 DS    0H                                                  0726
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0726
         BE    @RF00726                                            0726
*     DO;                           /*                       @Y30LB12*/
*                                                                  0727
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS SA (ALTPATH)'                          @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0728
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0728
*       OUTBUF2(47:58)='SA (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+46(12,R4),@CC00693                          0729
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0730
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00022                                            0731
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0733
*     ;                             /*                       @Y30LB12*/
@RF00726 DS    0H                                                  0734
*   HEXCHAR=SCANDATA(1);            /* PASS CHARACTER        @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0734
         MVC   HEXCHAR(1),SCANDATA(@07)                            0734
*   PLUGIN2='SA (ALT)';             /* FOR MESSAGE TEXT      @YM31098*/
         MVC   PLUGIN2(8),@CC00696                                 0735
*   CALL CONVHEX;                   /* TO CONVERT CHAR       @Y30LB12*/
         BAL   @14,CONVHEX                                         0736
*   IF HEXINDEX^=0                  /* IF SUCCESSFUL         @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,HEXINDEX                                        0737
         LTR   @07,@07                                             0737
         BZ    @RF00737                                            0737
*     DO;                           /*                       @Y30LB12*/
*       HEXINDEX=HEXINDEX-1;        /*                       @Y30LB12*/
         BCTR  @07,0                                               0739
         STH   @07,HEXINDEX                                        0739
*       WORKADS(ALTCOUNT)=HEXINDEX; /* STORE CHAR            @Y30LB12*/
         LH    @05,ALTCOUNT                                        0740
         SLA   @05,2                                               0740
         STC   @07,WORKADS-4(@05)                                  0740
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0742
*     ;                             /*                       @Y30LB12*/
@RF00737 DS    0H                                                  0743
*   END S04ADS;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00022                                            0743
*                                                                  0744
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ACH                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT CHANNEL NUMBER OF ALTERNATE CHANNEL   @Y30LB12*/
*/*            FOR THIS GROUP OF VIRTUAL OR VIRTUAL SHARED   @Y30LB12*/
*/*            ADDRESSES.   CHANNEL IS THE CHARACTER         @Y30LB12*/
*/*            REPRESENTATION OF A SINGLE HEXADECIMAL DIGIT. @Y30LB12*/
*/*            UP TO THREE ALTERNATE PATHS CAN BE SPECIFIED  @Y30LB12*/
*/*            IN VS1.  ONLY ONE ALTERNATE PATH CAN BE       @Y30LB12*/
*/*            SPECIFIED IN VS2.  THE NUMBER OF THE          @Y30LB12*/
*/*            ALTERNATE CHANNEL MUST BE HIGHER THAN THAT OF @Y30LB12*/
*/*            THE PRIMARY CHANNEL.  (TEST FOR THIS IS MADE  @Y30LB12*/
*/*            IN ICGDSA05.)                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0744
*S04ACH:                                                           0744
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ACH   STM   @14,@12,@SA00023                                    0744
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0745
*   IF HAVEACH(ALTCOUNT)^='1'B      /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,ALTCOUNT                                        0746
         SLA   @07,2                                               0746
         LA    @05,HAVEACH-4(@07)                                  0746
         TM    0(@05),B'10000000'                                  0746
         BO    @RF00746                                            0746
*     HAVEACH(ALTCOUNT)='1'B;       /*                       @Y30LB12*/
         LA    @05,HAVEACH-4(@07)                                  0747
         OI    0(@05),B'10000000'                                  0747
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0748
         B     @RC00746                                            0748
@RF00746 DS    0H                                                  0749
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD CH (ALTPATH)'          @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0749
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0749
*       OUTBUF2(28:39)='CH (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+27(12,R4),@CC00700                          0750
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0751
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
@EL00023 DS    0H                                                  0752
@EF00023 DS    0H                                                  0752
@ER00023 LM    @14,@12,@SA00023                                    0752
         BR    @14                                                 0752
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00746 TM    PARMBIT(R4),B'00100000'                             0754
         BO    @RF00754                                            0754
*     DO;                           /*                       @Y30LB12*/
*                                                                  0755
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0756
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0756
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0757
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00023                                            0758
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0760
*     ;                             /*                       @Y30LB12*/
@RF00754 DS    0H                                                  0761
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0761
         BE    @RF00761                                            0761
*     DO;                           /*                       @Y30LB12*/
*                                                                  0762
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS CH (ALTPATH)'                          @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0763
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0763
*       OUTBUF2(47:58)='CH (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+46(12,R4),@CC00700                          0764
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0765
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00023                                            0766
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0768
*     ;                             /*                       @Y30LB12*/
@RF00761 DS    0H                                                  0769
*   HEXCHAR=SCANDATA(1);            /* CHAR TO BE PASSED     @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0769
         MVC   HEXCHAR(1),SCANDATA(@07)                            0769
*   PLUGIN2='CH (ALT)';             /* FOR MESSAGE TEXT      @YM31098*/
         MVC   PLUGIN2(8),@CC00702                                 0770
*   CALL CONVHEX;                   /* TO CONVERT CHAR       @Y30LB12*/
         BAL   @14,CONVHEX                                         0771
*   IF HEXCHAR^=0                   /* IF SUCCESSFUL         @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLI   HEXCHAR,0                                           0772
         BE    @RF00772                                            0772
*     WORKACH(ALTCOUNT)=HEXCHAR;    /* STORE CHANNEL         @Y30LB12*/
         LH    @07,ALTCOUNT                                        0773
         SLA   @07,2                                               0773
         LA    @05,WORKACH-4(@07)                                  0773
         MVC   @TS00001(1),HEXCHAR                                 0773
         MVC   0(1,@05),@TS00001                                   0773
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0774
         B     @RC00772                                            0774
@RF00772 DS    0H                                                  0775
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG223I VALUE ERROR FOR CH (ALTPATH)              @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0775
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0775
*       OUTBUF2(26:37)='CH (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+25(12,R4),@CC00700                          0776
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0777
*     END;                          /*                       @Y30LB12*/
*   END S04ACH;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00023                                            0779
*                                                                  0780
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ACI                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - HANDLE THE CHANNEL INTERFACE DESIGNATION FOR  @Y30LB12*/
*/*            THE ALTERNATE CHANNEL.  THE CONTROL UNIT      @Y30LB12*/
*/*            ADDRESS OF THIS CHANNEL INTERFACE MUST BE     @Y30LB12*/
*/*            IDENTICAL TO THAT OF THE PRIMARY CONTROL UNIT @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0780
*S04ACI:                                                           0780
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ACI   STM   @14,@12,@SA00024                                    0780
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0781
*   IF HAVEACI(ALTCOUNT)^='1'B      /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,ALTCOUNT                                        0782
         SLA   @07,2                                               0782
         LA    @05,HAVEACI-4(@07)                                  0782
         TM    0(@05),B'01000000'                                  0782
         BO    @RF00782                                            0782
*     HAVEACI(ALTCOUNT)='1'B;       /*                       @Y30LB12*/
         LA    @05,HAVEACI-4(@07)                                  0783
         OI    0(@05),B'01000000'                                  0783
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0784
         B     @RC00782                                            0784
@RF00782 DS    0H                                                  0785
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG219I DUPLICATE KEYWORD CI (ALTPATH)            @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0785
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0785
*       OUTBUF2(28:39)='CI (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+27(12,R4),@CC00706                          0786
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0787
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
@EL00024 DS    0H                                                  0788
@EF00024 DS    0H                                                  0788
@ER00024 LM    @14,@12,@SA00024                                    0788
         BR    @14                                                 0788
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00782 TM    PARMBIT(R4),B'00100000'                             0790
         BO    @RF00790                                            0790
*     DO;                           /*                       @Y30LB12*/
*                                                                  0791
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0792
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0792
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0793
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00024                                            0794
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0796
*     ;                             /*                       @Y30LB12*/
@RF00790 DS    0H                                                  0797
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00044                              0797
         BE    @RF00797                                            0797
*     DO;                           /*                       @Y30LB12*/
*                                                                  0798
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS CI (ALTPATH)                           @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0799
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0799
*       OUTBUF2(47:58)='CI (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+46(12,R4),@CC00706                          0800
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0801
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00024                                            0802
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0804
*     ;                             /*                       @Y30LB12*/
@RF00797 DS    0H                                                  0805
*   WKCIALT='00'X;                  /* CLEAR CI WORKAREA     @Y30LB12*/
         MVI   WKCIALT,X'00'                                       0805
*   IF SCANDATA(1)='B'              /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0806
         CLI   SCANDATA(@07),C'B'                                  0806
         BNE   @RF00806                                            0806
*     WKCIALT='01'X;                /*                       @Y30LB12*/
         MVI   WKCIALT,X'01'                                       0807
*   ELSE                                                           0808
*     ;                             /*                       @Y30LB12*/
@RF00806 DS    0H                                                  0809
*   IF SCANDATA(1)='C'              /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0809
         CLI   SCANDATA(@07),C'C'                                  0809
         BNE   @RF00809                                            0809
*     WKCIALT='02'X;                /*                       @Y30LB12*/
         MVI   WKCIALT,X'02'                                       0810
*   ELSE                                                           0811
*     ;                             /*                       @Y30LB12*/
@RF00809 DS    0H                                                  0812
*   IF SCANDATA(1)='D'              /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         L     @07,STARTCOL(,R4)                                   0812
         CLI   SCANDATA(@07),C'D'                                  0812
         BNE   @RF00812                                            0812
*     WKCIALT='03'X;                /*                       @Y30LB12*/
         MVI   WKCIALT,X'03'                                       0813
*   ELSE                                                           0814
*     ;                             /*                       @Y30LB12*/
@RF00812 DS    0H                                                  0815
*   IF WKCIALT='00'X                /* NO MATCH              @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLI   WKCIALT,X'00'                                       0815
         BNE   @RF00815                                            0815
*     DO;                           /*                       @Y30LB12*/
*                                                                  0816
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG223I VALUE ERROR FOR CI (ALTPATH)'            @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0817
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0817
*       OUTBUF2(26:37)='CI (ALTPATH)';/*                     @Y30LB12*/
         MVC   OUTBUF2+25(12,R4),@CC00706                          0818
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0819
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     WORKACI(ALTCOUNT)=WKCIALT;    /* SAVE ALT. CI          @Y30LB12*/
         B     @RC00815                                            0821
@RF00815 LH    @07,ALTCOUNT                                        0821
         SLA   @07,2                                               0821
         LA    @05,WORKACI-4(@07)                                  0821
         MVC   0(1,@05),WKCIALT                                    0821
*   END S04ACI;                     /* RETURN TO S04ALTP     @Y30LB12*/
         B     @EL00024                                            0822
*                                                                  0823
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CHKALTP                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK TO BE SURE THAT THE THREE REQUIRED      @Y30LB12*/
*/*            KEYWORDS 'DS=', 'CH=', AND 'CI=' WERE         @Y30LB12*/
*/*            SPECIFIED FOR THIS ALTERNATE PATH             @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0823
*CHKALTP:                                                          0823
*   PROCEDURE;                      /*                       @Y30LB12*/
CHKALTP  STM   @14,@12,@SA00025                                    0823
*   I=ALTCOUNT;                     /*                       @Y30LB12*/
         LH    I,ALTCOUNT                                          0824
*   IF ALTHAVES(I)^='E0'X&ALTHAVES(I)^='00'X/*               @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LR    @07,I                                               0825
         SLA   @07,2                                               0825
         LA    @05,ALTHAVES-4(@07)                                 0825
         CLI   0(@05),X'E0'                                        0825
         BE    @RF00825                                            0825
         LA    @05,ALTHAVES-4(@07)                                 0825
         CLI   0(@05),X'00'                                        0825
         BE    @RF00825                                            0825
*     DO;                           /*                       @Y30LB12*/
*       IF HAVEADS(I)^='1'B         /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LA    @05,HAVEADS-4(@07)                                  0827
         TM    0(@05),B'00100000'                                  0827
         BO    @RF00827                                            0827
*         DO;                       /*                       @Y30LB12*/
*                                                                  0828
*           /*********************************************************/
*           /*                                                       */
*           /* *****************************************     @Y30LB12*/
*           /* ICG221I MISSING REQUIRED KEYWORD SA           @Y30LB12*/
*           /* FOR ALTPATH                                   @Y30LB12*/
*           /* *****************************************     @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0829
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0829
*           OUTBUF2(35:48)='SA FOR ALTPATH';/*               @Y30LB12*/
         MVC   OUTBUF2+34(14,R4),@CC00712                          0830
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0831
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0833
*         ;                         /*                       @Y30LB12*/
@RF00827 DS    0H                                                  0834
*       IF HAVEACH(I)^='1'B         /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LR    @07,I                                               0834
         SLA   @07,2                                               0834
         LA    @05,HAVEACH-4(@07)                                  0834
         TM    0(@05),B'10000000'                                  0834
         BO    @RF00834                                            0834
*         DO;                       /*                       @Y30LB12*/
*                                                                  0835
*           /*********************************************************/
*           /*                                                       */
*           /* *****************************************     @Y30LB12*/
*           /* ICG221I MISSING REQUIRED KEYWORD CH           @Y30LB12*/
*           /* FOR ALTPATH                                   @Y30LB12*/
*           /* *****************************************     @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0836
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0836
*           OUTBUF2(35:48)='CH FOR ALTPATH';/*               @Y30LB12*/
         MVC   OUTBUF2+34(14,R4),@CC00714                          0837
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0838
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0840
*         ;                         /*                       @Y30LB12*/
@RF00834 DS    0H                                                  0841
*       IF HAVEACI(I)^='1'B         /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LR    @07,I                                               0841
         SLA   @07,2                                               0841
         LA    @05,HAVEACI-4(@07)                                  0841
         TM    0(@05),B'01000000'                                  0841
         BO    @RF00841                                            0841
*         DO;                       /*                       @Y30LB12*/
*                                                                  0842
*           /*********************************************************/
*           /*                                                       */
*           /* *****************************************     @Y30LB12*/
*           /* ICG221I MISSING REQUIRED KEYWORD CI           @Y30LB12*/
*           /* FOR ALTPATH                                   @Y30LB12*/
*           /* *****************************************     @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0843
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0843
*           OUTBUF2(35:48)='CI FOR ALTPATH';/*               @Y30LB12*/
         MVC   OUTBUF2+34(14,R4),@CC00716                          0844
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0845
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0847
*         ;                         /*                       @Y30LB12*/
@RF00841 DS    0H                                                  0848
*     END;                          /* END OF DO             @Y30LB12*/
*   END CHKALTP;                    /* RETURN TO S04ALTP     @Y30LB12*/
@EL00025 DS    0H                                                  0849
@EF00025 DS    0H                                                  0849
@ER00025 LM    @14,@12,@SA00025                                    0849
         BR    @14                                                 0849
*                                                                  0850
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - UNKNOWN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - IF THE KEYWORD IS NOT RECOGNIZED, WRITE ERROR @Y30LB12*/
*/*            MESSAGE 'ICG210I UNDEFINED KEYWORD FOUND'     @Y30LB12*/
*/*            AND DO DUMMY READ OF PARAMETER TO  POSITION   @Y30LB12*/
*/*            TO NEXT KEYWORD.                              @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0850
*UNKNOWN:                                                          0850
*   PROCEDURE;                      /*                       @Y30LB12*/
UNKNOWN  STM   @14,@12,@SA00026                                    0850
*   MSGNO=ICG210I;                  /* ICGDS210              @Y30LB12*/
         MVC   MSGNO(2,R4),ICG210I                                 0851
*   CALL PUTIT2;                    /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0852
*   CALL READS99;                   /* DO DUMMY READ         @Y30LB12*/
         BAL   @14,READS99                                         0853
*   END UNKNOWN;                    /* RETURN TO S04SCAN     @Y30LB12*/
@EL00026 DS    0H                                                  0854
@EF00026 DS    0H                                                  0854
@ER00026 LM    @14,@12,@SA00026                                    0854
         BR    @14                                                 0854
*                                                                  0855
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04ANAL                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ANALYZE PROCEDURES MISSREQ AND CHECKRSG  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0855
*S04ANAL:                                                          0855
*   PROCEDURE;                      /*                       @Y30LB12*/
S04ANAL  STM   @14,@12,@SA00027                                    0855
*   CALL MISSREQ;                   /*                       @Y30LB12*/
         BAL   @14,MISSREQ                                         0856
*   IF STOPSCAN^='1'B               /* NO TERM ERROR         @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    STOPSCAN,B'00001000'                                0857
         BO    @RF00857                                            0857
*     DO;                           /*                       @Y30LB12*/
*       CALL CHECKRSG;              /* PRIMARY PATH SDG      @Y30LB12*/
         BAL   @14,CHECKRSG                                        0859
*       CALL CKALTRSG;              /* ALTERNATE PATH SDG    @Y30LB12*/
         BAL   @14,CKALTRSG                                        0860
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0862
*     ;                             /*                       @Y30LB12*/
@RF00857 DS    0H                                                  0863
*   END S04ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00027 DS    0H                                                  0863
@EF00027 DS    0H                                                  0863
@ER00027 LM    @14,@12,@SA00027                                    0863
         BR    @14                                                 0863
*                                                                  0864
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - MISSREQ                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK FOR REQUIRED KEYWORDS SA, CH, CI CUID,  @Y30LB12*/
*/*            AND CPUID MISSING FROM THE CONTROL STATEMENT  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0864
*MISSREQ:                                                          0864
*   PROCEDURE;                      /*                       @Y30LB12*/
MISSREQ  STM   @14,@12,@SA00028                                    0864
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVEDS,B'10000000'                                  0865
         BO    @RF00865                                            0865
*     DO;                           /*                       @Y30LB12*/
*                                                                  0866
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD SA               @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0867
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0867
*       OUTBUF2(35:36)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+34(2,R4),@CC00600                           0868
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0869
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0871
*     ;                             /*                       @Y30LB12*/
@RF00865 DS    0H                                                  0872
*   IF HAVECI^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECI,B'01000000'                                  0872
         BO    @RF00872                                            0872
*     DO;                           /*                       @Y30LB12*/
*                                                                  0873
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD CI               @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0874
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0874
*       OUTBUF2(35:36)='CI';        /*                       @Y30LB12*/
         MVC   OUTBUF2+34(2,R4),@CC00606                           0875
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0876
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0878
*     ;                             /*                       @Y30LB12*/
@RF00872 DS    0H                                                  0879
*   IF HAVECH^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECH,B'00100000'                                  0879
         BO    @RF00879                                            0879
*     DO;                           /*                       @Y30LB12*/
*                                                                  0880
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD CH               @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0881
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0881
*       OUTBUF2(35:36)='CH';        /*                       @Y30LB12*/
         MVC   OUTBUF2+34(2,R4),@CC00617                           0882
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0883
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0885
*     ;                             /*                       @Y30LB12*/
@RF00879 DS    0H                                                  0886
*   IF HAVECPU^='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECPU,B'00001000'                                 0886
         BO    @RF00886                                            0886
*     DO;                           /*                       @Y30LB12*/
*                                                                  0887
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD CPUID            @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0888
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0888
*       OUTBUF2(35:39)='CPUID';     /*                       @Y30LB12*/
         MVC   OUTBUF2+34(5,R4),@CC00636                           0889
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0890
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0892
*     ;                             /*                       @Y30LB12*/
@RF00886 DS    0H                                                  0893
*   IF HAVECU^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVECU,B'00010000'                                  0893
         BO    @RF00893                                            0893
*     DO;                           /*                       @Y30LB12*/
*                                                                  0894
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD CUID             @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0895
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0895
*       OUTBUF2(35:38)='CUID';      /*                       @Y30LB12*/
         MVC   OUTBUF2+34(4,R4),@CC00627                           0896
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0897
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0899
*     ;                             /*                       @Y30LB12*/
@RF00893 DS    0H                                                  0900
*   END MISSREQ;                    /* RET. TO S04ANAL       @Y30LB12*/
@EL00028 DS    0H                                                  0900
@EF00028 DS    0H                                                  0900
@ER00028 LM    @14,@12,@SA00028                                    0900
         BR    @14                                                 0900
*                                                                  0901
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CHECKRSG                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - FOR EACH DATA STAGER (ALL THREE CHANNEL       @Y30LB12*/
*/*            INTERFACES), A MAXIMUM OF TWO REAL SPINDLE    @Y30LB12*/
*/*            GROUPS ARE SUPPORTED.  THIS PROCEDURE CHECKS  @Y30LB12*/
*/*            EVERY VIRTUAL AND VIRTUAL SHARED ADDRESS      @Y30LB12*/
*/*            SPECIFICATION TO MAKE SURE THAT THE TOTAL     @Y30LB12*/
*/*            NUMBER OF UNIQUE RSGS FOR THE DATA STAGER     @Y30LB12*/
*/*            DOES NOT EXCEED 2.  CHECKING OF RSGS IN THE   @Y30LB12*/
*/*            SPINDLES STATEMENT AGAINST RSGS IN THE        @Y30LB12*/
*/*            UPPERCON STATEMENT IS DONE IN THE ANALYZE     @Y30LB12*/
*/*            PROCEDURES.                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0901
*CHECKRSG:                                                         0901
*   PROCEDURE;                      /*                       @Y30LB12*/
CHECKRSG STM   @14,@12,@SA00029                                    0901
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0902
         B     @DE00902                                            0902
@DL00902 DS    0H                                                  0903
*     IF ADR2SPEC(I)='1'B&ADR2V(I)='1'B/*                    @Y30LB12*/
*         ADR2SPEC(I)='1'B&ADR2VS(I)='1'B/*                 @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @07,I                                               0903
         MH    @07,@CH00257                                        0903
         LA    @05,ADR2SPEC-11(@07)                                0903
         TM    0(@05),B'11000000'                                  0903
         BO    @RT00903                                            0903
         LA    @05,ADR2SPEC-11(@07)                                0903
         TM    0(@05),B'10100000'                                  0903
         BNO   @RF00903                                            0903
@RT00903 DS    0H                                                  0904
*       DO;                         /*                       @Y30LB12*/
*         IF TORSG1(DSINDEX)='FF'X  /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         LH    @07,DSINDEX                                         0905
         ALR   @07,@07                                             0905
         L     @05,COMPTR2(,R4)                                    0905
         ST    @07,@TF00001                                        0905
         ALR   @07,@05                                             0905
         BCTR  @07,0                                               0905
         BCTR  @07,0                                               0905
         CLI   TORSG1(@07),X'FF'                                   0905
         BNE   @RF00905                                            0905
*           TORSG1(DSINDEX)=WK2RSG(I);/*                     @Y30LB12*/
         AL    @05,@TF00001                                        0906
         BCTR  @05,0                                               0906
         BCTR  @05,0                                               0906
         LR    @07,I                                               0906
         MH    @07,@CH00257                                        0906
         LA    @03,WK2RSG-11(@07)                                  0906
         MVC   TORSG1(1,@05),0(@03)                                0906
*         ELSE                      /*                       @Y30LB12*/
*           IF TORSG1(DSINDEX)^=WK2RSG(I)/*                  @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         B     @RC00905                                            0907
@RF00905 LH    @07,DSINDEX                                         0907
         ALR   @07,@07                                             0907
         L     @05,COMPTR2(,R4)                                    0907
         LR    @03,I                                               0907
         MH    @03,@CH00257                                        0907
         ST    @07,@TF00001                                        0907
         ALR   @07,@05                                             0907
         BCTR  @07,0                                               0907
         BCTR  @07,0                                               0907
         LA    @01,WK2RSG-11(@03)                                  0907
         CLC   TORSG1(1,@07),0(@01)                                0907
         BE    @RF00907                                            0907
*             IF TORSG2(DSINDEX)='FF'X/*                     @Y30LB12*/
*               THEN                /*                       @Y30LB12*/
         LR    @07,@05                                             0908
         AL    @07,@TF00001                                        0908
         BCTR  @07,0                                               0908
         CLI   TORSG2-1(@07),X'FF'                                 0908
         BNE   @RF00908                                            0908
*               TORSG2(DSINDEX)=WK2RSG(I);/*                 @Y30LB12*/
         AL    @05,@TF00001                                        0909
         BCTR  @05,0                                               0909
         LA    @07,WK2RSG-11(@03)                                  0909
         MVC   TORSG2-1(1,@05),0(@07)                              0909
*             ELSE                  /*                       @Y30LB12*/
*               IF TORSG2(DSINDEX)^=WK2RSG(I) THEN/*         @Y30LB12*/
         B     @RC00908                                            0910
@RF00908 LH    @07,DSINDEX                                         0910
         ALR   @07,@07                                             0910
         L     @05,COMPTR2(,R4)                                    0910
         LR    @03,I                                               0910
         MH    @03,@CH00257                                        0910
         ALR   @05,@07                                             0910
         BCTR  @05,0                                               0910
         LA    @07,WK2RSG-11(@03)                                  0910
         CLC   TORSG2-1(1,@05),0(@07)                              0910
         BE    @RF00910                                            0910
*                 DO;               /*                       @Y30LB12
*                                      ********************* @Y30LB12
*                                      ICG232I SA            @Y30LB12
*                                      INTERFACES TO         @Y30LB12
*                                      MORE THAN TWO         @Y30LB12
*                                      SDGS                  @Y30LB12
*                                      ********************* @Y30LB12*/
*                   OUTBUF2(1:44)=ICGDS232;                        0912
         MVC   OUTBUF2(44,R4),ICGDS232                             0912
*                   CALL PUTIT1;    /*                       @Y30LB12*/
         BAL   @14,PUTIT1                                          0913
*                   RETURN;         /* WRITE ONCE            @Y30LB12*/
@EL00029 DS    0H                                                  0914
@EF00029 DS    0H                                                  0914
@ER00029 LM    @14,@12,@SA00029                                    0914
         BR    @14                                                 0914
*                 END;              /*                       @Y30LB12*/
*               ELSE                                               0916
*                 ;                 /*                       @Y30LB12*/
@RF00910 DS    0H                                                  0917
*           ELSE                                                   0917
*             ;                     /*                       @Y30LB12*/
@RF00907 DS    0H                                                  0918
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0919
*       ;                           /*                       @Y30LB12*/
@RF00903 DS    0H                                                  0920
*   END;                            /* CHECKED 64 ADDRS      @Y30LB12*/
@RC00903 AH    I,@CH00044                                          0920
@DE00902 CH    I,MAXDEV                                            0920
         BNH   @DL00902                                            0920
*   END CHECKRSG;                   /* RET. TO S04ANAL       @Y30LB12*/
         B     @EL00029                                            0921
*                                                                  0922
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CKALTRSG                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK EACH DEVICE SPECIFICATION FOR ALTERNATE @Y30LB12*/
*/*            PATH SPECIFICATION.  IF ALTERNATE PATH IS     @Y30LB12*/
*/*            SPECIFIED AND IF THE DATA STAGER FOR THE      @Y30LB12*/
*/*            ALTERNATE PATH IS DIFFERENT FROM THAT OF THE  @Y30LB12*/
*/*            PRIMARY PATH, PASS THE RSG USED BY THE        @Y30LB12*/
*/*            PRIMARY PATH AND THE INDEX VALUE (DS+1) OF    @Y30LB12*/
*/*            THE ALTERNATE DS TO THE PROCEDURE PUTALT.     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0922
*CKALTRSG:                                                         0922
*   PROCEDURE;                      /*                       @Y30LB12*/
CKALTRSG STM   @14,@12,@SA00030                                    0922
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
         LA    I,1                                                 0923
         B     @DE00923                                            0923
@DL00923 DS    0H                                                  0924
*     IF ADR2SPEC(I)='1'B           /* IF ADDRESS USED       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @07,I                                               0924
         MH    @07,@CH00257                                        0924
         LA    @05,ADR2SPEC-11(@07)                                0924
         TM    0(@05),B'10000000'                                  0924
         BNO   @RF00924                                            0924
*       IF ADR2V(I)='1'BADR2VS(I)='1'B/*                    @OZ09548*/
*         THEN                      /*                       @OZ09548*/
         LA    @05,ADR2V-11(@07)                                   0925
         TM    0(@05),B'01100000'                                  0925
         BZ    @RF00925                                            0925
*         DO;                       /*                       @Y30LB12*/
*           IF WK2ACI1(I)^='00'X    /* IF ALTPATH AND        @Y30LB12*/
*               &WK2ADS1(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         LA    @05,WK2ACI1-11(@07)                                 0927
         CLI   0(@05),X'00'                                        0927
         BE    @RF00927                                            0927
         SLR   @05,@05                                             0927
         IC    @05,WK2ADS1-11(@07)                                 0927
         LH    @03,DSINDEX                                         0927
         BCTR  @03,0                                               0927
         CR    @05,@03                                             0927
         BE    @RF00927                                            0927
*             DO;                   /*                       @Y30LB12*/
*               ALTRSG=WK2RSG(I);   /* PASS ALT SDG          @Y30LB12*/
         LA    @03,WK2RSG-11(@07)                                  0929
         MVC   ALTRSG(1),0(@03)                                    0929
*               ALTINDEX=WK2ADS1(I)+1;/* PASS SA             @Y30LB12*/
         LA    @05,1(,@05)                                         0930
         STH   @05,ALTINDEX                                        0930
*               CALL PUTALT;        /* SDG 1ST ALTPATH       @Y30LB12*/
         BAL   @14,PUTALT                                          0931
*             END;                  /*                       @Y30LB12*/
*           ELSE                    /*                       @Y30LB12*/
*             IF WK2ACI1(I)=WORKCI  /*                       @Y30LB12*/
*                 &WORKCI^='00'X    /*                       @Y30LB12*/
*               THEN                /*                       @Y30LB12*/
         B     @RC00927                                            0933
@RF00927 LR    @07,I                                               0933
         MH    @07,@CH00257                                        0933
         LA    @05,WK2ACI1-11(@07)                                 0933
         CLC   0(1,@05),WORKCI                                     0933
         BNE   @RF00933                                            0933
         CLI   WORKCI,X'00'                                        0933
         BE    @RF00933                                            0933
*               DO;                 /*                       @Y30LB12*/
*                                                                  0934
*                 /***************************************************/
*                 /*                                                 */
*                 /* *******************************         @Y30LB12*/
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/
*                 /* ALTPATH1                                @Y30LB12*/
*                 /* *******************************         @Y30LB12*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0935
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0935
*                 OUTBUF2(26:33)='ALTPATH1';/*               @Y30LB12*/
         MVC   OUTBUF2+25(8,R4),@CC00738                           0936
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0937
*               END;                /*                       @Y30LB12*/
*             ELSE                                                 0939
*               ;                                                  0939
@RF00933 DS    0H                                                  0940
*           IF WK2ACI2(I)^='00'X    /* 2ND ALTPATH USED      @Y30LB12*/
*               &WK2ADS2(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
@RC00927 LR    @07,I                                               0940
         MH    @07,@CH00257                                        0940
         LA    @05,WK2ACI2-11(@07)                                 0940
         CLI   0(@05),X'00'                                        0940
         BE    @RF00940                                            0940
         SLR   @05,@05                                             0940
         IC    @05,WK2ADS2-11(@07)                                 0940
         LH    @03,DSINDEX                                         0940
         BCTR  @03,0                                               0940
         CR    @05,@03                                             0940
         BE    @RF00940                                            0940
*             DO;                   /*                       @Y30LB12*/
*               ALTRSG=WK2RSG(I);   /* SDG 2ND ALTPATH       @Y30LB12*/
         LA    @03,WK2RSG-11(@07)                                  0942
         MVC   ALTRSG(1),0(@03)                                    0942
*               ALTINDEX=WK2ADS2(I)+1;/* 2ND SA              @Y30LB12*/
         LA    @05,1(,@05)                                         0943
         STH   @05,ALTINDEX                                        0943
*               CALL PUTALT;        /* CHECK 2ND ALTPATH     @Y30LB12*/
         BAL   @14,PUTALT                                          0944
*             END;                  /*                       @Y30LB12*/
*           ELSE                    /*                       @Y30LB12*/
*             IF WK2ACI2(I)=WORKCI  /*                       @Y30LB12*/
*                 &WORKCI^='00'X    /*                       @Y30LB12*/
*               THEN                /*                       @Y30LB12*/
         B     @RC00940                                            0946
@RF00940 LR    @07,I                                               0946
         MH    @07,@CH00257                                        0946
         LA    @05,WK2ACI2-11(@07)                                 0946
         CLC   0(1,@05),WORKCI                                     0946
         BNE   @RF00946                                            0946
         CLI   WORKCI,X'00'                                        0946
         BE    @RF00946                                            0946
*               DO;                 /*                       @Y30LB12*/
*                                                                  0947
*                 /***************************************************/
*                 /*                                                 */
*                 /* *******************************         @Y30LB12*/
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/
*                 /* ALTPATH2                                @Y30LB12*/
*                 /* *******************************         @Y30LB12*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0948
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0948
*                 OUTBUF2(26:33)='ALTPATH2';/*               @Y30LB12*/
         MVC   OUTBUF2+25(8,R4),@CC00739                           0949
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0950
*               END;                /*                       @Y30LB12*/
*           IF WK2ACI3(I)^='00'X    /* 3RD ALTPATH USED      @Y30LB12*/
*               &WK2ADS3(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
@RF00946 DS    0H                                                  0952
@RC00940 LR    @07,I                                               0952
         MH    @07,@CH00257                                        0952
         LA    @05,WK2ACI3-11(@07)                                 0952
         CLI   0(@05),X'00'                                        0952
         BE    @RF00952                                            0952
         SLR   @05,@05                                             0952
         IC    @05,WK2ADS3-11(@07)                                 0952
         LH    @03,DSINDEX                                         0952
         BCTR  @03,0                                               0952
         CR    @05,@03                                             0952
         BE    @RF00952                                            0952
*             DO;                   /*                       @Y30LB12*/
*               ALTRSG=WK2RSG(I);   /* SDG 3RD ALTPATH       @Y30LB12*/
         LA    @03,WK2RSG-11(@07)                                  0954
         MVC   ALTRSG(1),0(@03)                                    0954
*               ALTINDEX=WK2ADS3(I)+1;/* 3RD SA              @Y30LB12*/
         LA    @05,1(,@05)                                         0955
         STH   @05,ALTINDEX                                        0955
*               CALL PUTALT;        /* CHECK 3RD ALTPATH     @Y30LB12*/
         BAL   @14,PUTALT                                          0956
*             END;                  /*                       @Y30LB12*/
*           ELSE                    /*                       @Y30LB12*/
*             IF WK2ACI3(I)=WORKCI  /*                       @Y30LB12*/
*                 &WORKCI^='00'X    /*                       @Y30LB12*/
*               THEN                /*                       @Y30LB12*/
         B     @RC00952                                            0958
@RF00952 LR    @07,I                                               0958
         MH    @07,@CH00257                                        0958
         LA    @05,WK2ACI3-11(@07)                                 0958
         CLC   0(1,@05),WORKCI                                     0958
         BNE   @RF00958                                            0958
         CLI   WORKCI,X'00'                                        0958
         BE    @RF00958                                            0958
*               DO;                 /*                       @Y30LB12*/
*                                                                  0959
*                 /***************************************************/
*                 /*                                                 */
*                 /* *******************************         @Y30LB12*/
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/
*                 /* ALTPATH3                                @Y30LB12*/
*                 /* *******************************         @Y30LB12*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0960
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/
         MVC   OUTBUF2(25,R4),ICGDS223                             0960
*                 OUTBUF2(26:33)='ALTPATH3';/*               @Y30LB12*/
         MVC   OUTBUF2+25(8,R4),@CC00740                           0961
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0962
*               END;                /*                       @Y30LB12*/
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0965
*         ;                         /*                       @Y30LB12*/
@RF00925 DS    0H                                                  0966
*   END;                            /*                       @Y30LB12*/
@RC00925 DS    0H                                                  0966
@RF00924 AH    I,@CH00044                                          0966
@DE00923 CH    I,MAXDEV                                            0966
         BNH   @DL00923                                            0966
*   END CKALTRSG;                   /* RETURN TO S04ANAL     @Y30LB12*/
@EL00030 DS    0H                                                  0967
@EF00030 DS    0H                                                  0967
@ER00030 LM    @14,@12,@SA00030                                    0967
         BR    @14                                                 0967
*                                                                  0968
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTALT                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - AN ALTERNATE PATH THROUGH A DIFFERENT DS      @Y30LB12*/
*/*            THAN THE PRIMARY PATH DEDICATES ONE OF THE    @Y30LB12*/
*/*            POSSIBLE RSGS THAT CAN BE USED THROUGH THE    @Y30LB12*/
*/*            ALTERNATE DS TO THE SAME RSG AS USED FOR THE  @Y30LB12*/
*/*            DS.  A MAXIMUM OF TWO RSGS CAN BE SPECIFIED   @Y30LB12*/
*/*            THROUGH ANY DATA STAGER.                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0968
*PUTALT:                                                           0968
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTALT   STM   @14,@12,@SA00031                                    0968
*   IF TORSG1(ALTINDEX)='FF'X       /* NO PREVIOUS SDG       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @07,ALTINDEX                                        0969
         ALR   @07,@07                                             0969
         L     @05,COMPTR2(,R4)                                    0969
         ST    @07,@TF00001                                        0969
         ALR   @07,@05                                             0969
         BCTR  @07,0                                               0969
         BCTR  @07,0                                               0969
         CLI   TORSG1(@07),X'FF'                                   0969
         BNE   @RF00969                                            0969
*     TORSG1(ALTINDEX)=ALTRSG;      /* TO 1ST SDG ENTRY      @Y30LB12*/
         AL    @05,@TF00001                                        0970
         BCTR  @05,0                                               0970
         BCTR  @05,0                                               0970
         MVC   TORSG1(1,@05),ALTRSG                                0970
*   ELSE                            /*                       @Y30LB12*/
*     IF TORSG1(ALTINDEX)^=ALTRSG   /* NO MATCH              @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00969                                            0971
@RF00969 LH    @07,ALTINDEX                                        0971
         ALR   @07,@07                                             0971
         L     @05,COMPTR2(,R4)                                    0971
         ST    @07,@TF00001                                        0971
         ALR   @07,@05                                             0971
         BCTR  @07,0                                               0971
         BCTR  @07,0                                               0971
         CLC   TORSG1(1,@07),ALTRSG                                0971
         BE    @RF00971                                            0971
*       IF TORSG2(ALTINDEX)='FF'X   /* 2ND UNUSED            @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LR    @07,@05                                             0972
         AL    @07,@TF00001                                        0972
         BCTR  @07,0                                               0972
         CLI   TORSG2-1(@07),X'FF'                                 0972
         BNE   @RF00972                                            0972
*         TORSG2(ALTINDEX)=ALTRSG;  /* TO 2ND                @Y30LB12*/
         AL    @05,@TF00001                                        0973
         BCTR  @05,0                                               0973
         MVC   TORSG2-1(1,@05),ALTRSG                              0973
*       ELSE                        /*                       @Y30LB12*/
*         IF TORSG2(ALTINDEX)^=ALTRSG/*                      @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         B     @RC00972                                            0974
@RF00972 LH    @07,ALTINDEX                                        0974
         ALR   @07,@07                                             0974
         L     @05,COMPTR2(,R4)                                    0974
         ALR   @05,@07                                             0974
         BCTR  @05,0                                               0974
         CLC   TORSG2-1(1,@05),ALTRSG                              0974
         BE    @RF00974                                            0974
*           DO;                     /*                       @Y30LB12*/
*                                                                  0975
*             /*******************************************************/
*             /*                                                     */
*             /* *****************************               @Y30LB12*/
*             /* ICGDS232 SA INTERFACES TO                   @Y30LB12*/
*             /* MORE THAN TWO SDGS (ALTPATH                 @Y30LB12*/
*             /* SA)                                         @Y30LB12*/
*             /* *****************************               @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0976
*             OUTBUF2(1:44)=ICGDS232;/*                      @Y30LB12*/
         MVC   OUTBUF2(44,R4),ICGDS232                             0976
*             OUTBUF2(46:57)='(ALTPATH SA)';                       0977
         MVC   OUTBUF2+45(12,R4),@CC00745                          0977
*             CALL PUTIT1;          /* TO MSG WRITER         @Y30LB12*/
         BAL   @14,PUTIT1                                          0978
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0980
*           ;                       /*                       @Y30LB12*/
@RF00974 DS    0H                                                  0981
*   END PUTALT;                     /* RET. TO CKALTRSG      @Y30LB12*/
@EL00031 DS    0H                                                  0981
@EF00031 DS    0H                                                  0981
@ER00031 LM    @14,@12,@SA00031                                    0981
         BR    @14                                                 0981
*                                                                  0982
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S04BUILD                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK TO BE SURE THAT THIS DATA STAGER/       @Y30LB12*/
*/*            CHANNEL INTERFACE HAS NOT BEEN SPECIFIED IN A @Y30LB12*/
*/*            PREVIOUS UPPERCON CONTROL STATEMENT.  IF NOT  @Y30LB12*/
*/*            PREVIOUSLY SPECIFIED, ENTER CPUID, CHANNEL    @Y30LB12*/
*/*            NUMBER, AND CONTROL UNIT IDENTIFICATION INTO  @Y30LB12*/
*/*            THE PROPER ENTRY AND MARK THAT INTERFACE AS   @Y30LB12*/
*/*            USED.                                         @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*            CHECK EACH ADDRESS SPECIFIED IN THIS CONTROL  @Y30LB12*/
*/*            STATEMENT TO BE SURE IT WAS NOT PREVIOUSLY    @Y30LB12*/
*/*            SPECIFIED AND MOVE DATA STORED IN WK2ADDRS    @Y30LB12*/
*/*            TO APPROPRIATE ENTRY IN CONFGUCB.             @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0982
*S04BUILD:                                                         0982
*   PROCEDURE;                      /*                       @Y30LB12*/
*                                                                  0982
S04BUILD STM   @14,@12,@SA00032                                    0982
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @Y30LB12*/
*   /* DEVELOP FIRST INDEX INTO CONFGUCB AND ONLY            @Y30LB12*/
*   /* INTO CONFGCON. I IS A VALUE IN THE RANGE 1            @Y30LB12*/
*   /* TO 48. FOR EACH DATA STAGER (0-F) THERE ARE           @Y30LB12*/
*   /* THREE CHANNEL INTERFACES WHICH ARE STORED             @Y30LB12*/
*   /* INTERNALLY AS 1, 2, AND 3.                            @Y30LB12*/
*   /* ***********************************************       @Y30LB12*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*   I=DSINDEX-1;                    /* ZERO FOR DS 0         @Y30LB12*/
         LH    I,DSINDEX                                           0983
         BCTR  I,0                                                 0983
*   I=I*3;                          /* MULTIPLY BY 3         @Y30LB12*/
         LR    @07,I                                               0984
         MH    @07,@CH00050                                        0984
         LR    I,@07                                               0984
*   I=WORKCI+I;                     /* ADD CHANNEL INT.      @Y30LB12*/
         MVC   @ZT00003+3(1),WORKCI                                0985
         AL    I,@ZT00003                                          0985
*   IF CISPEC(I)^='1'B              /* CHECK INT. USED       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LR    @07,I                                               0986
         MH    @07,@CH00114                                        0986
         L     @05,COMPTR2(,R4)                                    0986
         ST    @07,@TF00001                                        0986
         ALR   @07,@05                                             0986
         TM    CISPEC-9(@07),B'10000000'                           0986
         BO    @RF00986                                            0986
*     DO;                           /*                       @Y30LB12*/
*       CISPEC(I)='1'B;             /* MARK INT. USED        @Y30LB12*/
         LR    @07,@05                                             0988
         AL    @07,@TF00001                                        0988
         OI    CISPEC-9(@07),B'10000000'                           0988
*       RSGCPUID(I)=WORKCPU;        /* MOVE MANUFACTURER     @Y30LB12*/
         LR    @07,@05                                             0989
         AL    @07,@TF00001                                        0989
         MVC   RSGCPUID-9(5,@07),WORKCPU                           0989
*       RSGCHAN(I)=WORKCH;          /* MOVE CHANNEL          @Y30LB12*/
         LR    @07,@05                                             0990
         AL    @07,@TF00001                                        0990
         MVC   RSGCHAN-9(1,@07),WORKCH                             0990
*       RSGCUA(I)=WORKCU;           /* MOVE CONTROL UNIT     @Y30LB12*/
         SLR   @07,@07                                             0991
         IC    @07,WORKCU                                          0991
         L     @03,@TF00001                                        0991
         STC   @07,RSGCUA-9(@03,@05)                               0991
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
         B     @RC00986                                            0993
@RF00986 DS    0H                                                  0994
*       IF RSGCPUID(I)^=WORKCPU     /* NONMATCH              @Y30LB12*/
*           RSGCHAN(I)^=WORKCH     /* OR NONMATCH           @Y30LB12*/
*           RSGCUA(I)^=WORKCU      /* OR NONMATCH           @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LR    @07,I                                               0994
         MH    @07,@CH00114                                        0994
         L     @05,COMPTR2(,R4)                                    0994
         ST    @07,@TF00001                                        0994
         ALR   @07,@05                                             0994
         CLC   RSGCPUID-9(5,@07),WORKCPU                           0994
         BNE   @RT00994                                            0994
         LR    @07,@05                                             0994
         AL    @07,@TF00001                                        0994
         CLC   RSGCHAN-9(1,@07),WORKCH                             0994
         BNE   @RT00994                                            0994
         L     @07,@TF00001                                        0994
         SLR   @03,@03                                             0994
         IC    @03,RSGCUA-9(@07,@05)                               0994
         MVC   @ZT00003+3(1),WORKCU                                0994
         C     @03,@ZT00003                                        0994
         BE    @RF00994                                            0994
@RT00994 DS    0H                                                  0995
*         DO;                       /*                       @Y30LB12*/
*                                                                  0995
*           /*********************************************************/
*           /*                                                       */
*           /* ***********************************           @Y30LB12*/
*           /* ICG230I SA/CI PREVIOUSLY                      @Y30LB12*/
*           /* SPECIFIED                                     @Y30LB12*/
*           /* ***********************************           @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0996
*           MSGNO=ICG230I;          /* IDENT FOR ICG230I     @Y30LB12*/
         MVC   MSGNO(2,R4),ICG230I                                 0996
*           CALL PUTIT2;            /* TO MESSAGE WRITER     @YD00113*/
         BAL   @14,PUTIT2                                          0997
*           RETURN;                 /* RET. TO MAINLINE      @Y30LB12*/
@EL00032 DS    0H                                                  0998
@EF00032 DS    0H                                                  0998
@ER00032 LM    @14,@12,@SA00032                                    0998
         BR    @14                                                 0998
*         END;                      /*                       @Y30LB12*/
*     END;                          /*                       @Y30LB12*/
@RF00994 DS    0H                                                  1001
*   DO J=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/
@RC00986 LA    J,1                                                 1001
         B     @DE01001                                            1001
@DL01001 DS    0H                                                  1002
*     IF ADR2SPEC(J)='1'B           /* ADDR USED HERE        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LA    @07,11                                              1002
         LR    @01,J                                               1002
         MR    @00,@07                                             1002
         LA    @05,ADR2SPEC-11(@01)                                1002
         TM    0(@05),B'10000000'                                  1002
         BNO   @RF01002                                            1002
*       IF USESPEC(I,J)='0'B        /* NOT USED BEFORE       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LR    @09,I                                               1003
         SLA   @09,6                                               1003
         ALR   @09,J                                               1003
         MR    @08,@07                                             1003
         L     @07,COMPTR2(,R4)                                    1003
         ST    @09,@TF00001                                        1003
         ALR   @09,@07                                             1003
         AL    @09,@CF00781                                        1003
         TM    USESPEC-464(@09),B'10000000'                        1003
         BNZ   @RF01003                                            1003
*         CONFGDEV(I,J)=WK2ADDR(J); /* MOVE IT               @Y30LB12*/
         AL    @07,@TF00001                                        1004
         AL    @07,@CF00781                                        1004
         LA    @05,WK2ADDR-11(@01)                                 1004
         MVC   CONFGDEV-464(11,@07),0(@05)                         1004
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  1005
         B     @RC01003                                            1005
@RF01003 DS    0H                                                  1006
*           /*********************************************************/
*           /*                                                       */
*           /* ***********************************           @Y30LB12*/
*           /* ICG237I ADDRESS XX PREVIOUSLY                 @Y30LB12*/
*           /* SPECIFIED                                     @Y30LB12*/
*           /* ***********************************           @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1006
*           OUTBUF2(1:40)=ICGDS237; /*                       @Y30LB12*/
         MVC   OUTBUF2(40,R4),ICGDS237                             1006
*           OUTBUF2(18:19)=PATTERN(J);/*                     @Y30LB12*/
         LR    @07,J                                               1007
         ALR   @07,@07                                             1007
         LA    @05,PATTERN-2(@07)                                  1007
         MVC   OUTBUF2+17(2,R4),0(@05)                             1007
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          1008
*         END;                      /*                       @Y30LB12*/
*     ELSE                                                         1010
*       ;                           /*                       @Y30LB12*/
@RF01002 DS    0H                                                  1011
*   END;                            /* DID ALL 64 ADDRS      @Y30LB12*/
@RC01002 AH    J,@CH00044                                          1011
@DE01001 CH    J,MAXDEV                                            1011
         BNH   @DL01001                                            1011
*   END S04BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/
         B     @EL00032                                            1012
*                                                                  1013
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  1013
*READS99:                                                          1013
*   PROCEDURE;                      /*                       @Y30LB12*/
READS99  STM   @14,@12,@SA00033                                    1013
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */
*                                                                  1014
         LINK EP=ICGDSS99
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************@Y30LB12 IF   */
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/
*   /* KEYWORD.                                              @Y30LB12*/
*   /* ************************************************@Y30LB12      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1015
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    ENDSCAN(R4),B'00010000'                             1015
         BNO   @RF01015                                            1015
*     LASTPARM='1'B;                /*                       @Y30LB12*/
         OI    LASTPARM(R4),B'00001000'                            1016
*   ELSE                                                           1017
*     ;                             /*                       @Y30LB12*/
@RF01015 DS    0H                                                  1018
*   END READS99;                    /*                       @Y30LB12*/
@EL00033 DS    0H                                                  1018
@EF00033 DS    0H                                                  1018
@ER00033 LM    @14,@12,@SA00033                                    1018
         BR    @14                                                 1018
*                                                                  1019
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  1019
*PUTIT1:                                                           1019
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT1   STM   @14,@12,@SA00034                                    1019
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'00001000'                                1020
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            1021
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @07,1                                               1022
         AH    @07,TERMINAT(,R4)                                   1022
         STH   @07,TERMINAT(,R4)                                   1022
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            1024
*   END PUTIT1;                     /*                       @Y30LB12*/
@EL00034 DS    0H                                                  1025
@EF00034 DS    0H                                                  1025
@ER00034 LM    @14,@12,@SA00034                                    1025
         BR    @14                                                 1025
*                                                                  1026
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  1026
*PUTIT2:                                                           1026
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT2   STM   @14,@12,@SA00035                                    1026
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'00001000'                                1027
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @07,1                                               1028
         AH    @07,TERMINAT(,R4)                                   1028
         STH   @07,TERMINAT(,R4)                                   1028
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   END PUTIT2;                     /*                       @Y30LB12*/
@EL00035 DS    0H                                                  1030
@EF00035 DS    0H                                                  1030
@ER00035 LM    @14,@12,@SA00035                                    1030
         BR    @14                                                 1030
*                                                                  1031
*/********************************************************** @Y30LB12*/
*/*                 P A T C H   A R E A                      @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  1031
*   GENERATE;                                                      1031
*                                                         /*@Y30LB12*/
PATCHS04 DC    32C'PATCHS04'                              /*@Y30LB12*/
*   END ICGDSS04                    /*                       @Y30LB12*/
*                                                                  1032
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */
*                                                                  1032
*       ;                                                          1032
         B     @EL00001                                            1032
@DATA    DS    0H
@CH00044 DC    H'1'
@CH00052 DC    H'2'
@CH00050 DC    H'3'
@CH00070 DC    H'4'
@CH00121 DC    H'5'
@CH00114 DC    H'9'
@CH00448 DC    H'10'
@CH00257 DC    H'11'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@SA00027 DS    15F
@SA00032 DS    15F
@SA00033 DS    15F
@SA00035 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00010 DS    15F
@SA00012 DS    15F
@SA00016 DS    15F
@SA00005 DS    15F
@SA00020 DS    15F
@SA00034 DS    15F
@SA00015 DS    15F
@SA00026 DS    15F
@SA00009 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00021 DS    15F
@SA00017 DS    15F
@SA00018 DS    15F
@SA00022 DS    15F
@SA00023 DS    15F
@SA00024 DS    15F
@SA00025 DS    15F
@SA00028 DS    15F
@SA00029 DS    15F
@SA00030 DS    15F
@SA00031 DS    15F
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSS04 CSECT
         DS    0F
@CF00781 DC    F'-251'
@DATD    DSECT
         DS    0D
@TS00001 DS    CL1
         DS    CL7
UPCWORKA DS    CL1479
         ORG   UPCWORKA
PACKWORK DS    CL8
BININDEX DS    FL2
HEXINDEX DS    FL2
DSINDEX  DS    FL2
WORKNUM  DS    FL2
ALTCOUNT DS    FL2
ALTINDEX DS    FL2
WORKHEX2 DS    CL2
WORKA    DS    CL2
WORKB    DS    CL2
WORKRSG  DS    CL2
         ORG   WORKRSG
HIGHRSG  DS    BL1
@NM00019 EQU   WORKRSG+0
LOWRSG   DS    BL1
@NM00020 EQU   WORKRSG+1
         ORG   UPCWORKA+28
ALTRSG   DS    CL1
WORKCI   DS    CL1
WKCIALT  DS    CL1
WORKCU   DS    FL1
WORKCH   DS    CL1
WORKCPU  DS    CL5
ALTPATHS DS    CL12
         ORG   ALTPATHS
ALTPATH  DS    CL4
         ORG   ALTPATH+0
ALTHAVES DS    BL1
         ORG   ALTHAVES+0
HAVEACH  DS    BL1
HAVEACI  EQU   ALTHAVES+0
HAVEADS  EQU   ALTHAVES+0
@NM00021 EQU   ALTHAVES+0
         ORG   ALTPATH+1
WORKADS  DS    CL1
WORKACI  DS    CL1
WORKACH  DS    CL1
         ORG   UPCWORKA+50
HEXCHAR  DS    CL1
         ORG   HEXCHAR
HIGHHEX  DS    BL1
@NM00022 EQU   HEXCHAR+0
         ORG   UPCWORKA+51
BINCHAR  DS    CL2
PLUGIN   DS    CL8
PLUGIN2  DS    CL8
WK1ADDRS DS    CL11
         ORG   WK1ADDRS+0
WK1ADDR  DS    CL11
         ORG   WK1ADDR+0
WK1FLAGS DS    BL1
         ORG   WK1FLAGS+0
ADR1SPEC DS    BL1
ADR1V    EQU   WK1FLAGS+0
ADR1VS   EQU   WK1FLAGS+0
ADR1REAL EQU   WK1FLAGS+0
@NM00023 EQU   WK1FLAGS+0
ADR1CONV EQU   WK1FLAGS+0
@NM00024 EQU   WK1FLAGS+0
         ORG   WK1ADDR+1
WK1RSG   DS    BL1
WK1ADS1  DS    BL1
WK1ACI1  DS    BL1
WK1ACH1  DS    BL1
WK1ADS2  DS    BL1
WK1ACI2  DS    BL1
WK1ACH2  DS    BL1
WK1ADS3  DS    BL1
WK1ACI3  DS    BL1
WK1ACH3  DS    BL1
         ORG   UPCWORKA+773
WK2ADDRS DS    CL11
         ORG   WK2ADDRS+0
WK2ADDR  DS    CL11
         ORG   WK2ADDR+0
WK2FLAGS DS    BL1
         ORG   WK2FLAGS+0
ADR2SPEC DS    BL1
ADR2V    EQU   WK2FLAGS+0
ADR2VS   EQU   WK2FLAGS+0
ADR2REAL EQU   WK2FLAGS+0
@NM00025 EQU   WK2FLAGS+0
ADR2CONV EQU   WK2FLAGS+0
@NM00026 EQU   WK2FLAGS+0
         ORG   WK2ADDR+1
WK2RSG   DS    BL1
WK2ADS1  DS    BL1
WK2ACI1  DS    BL1
WK2ACH1  DS    BL1
WK2ADS2  DS    BL1
WK2ACI2  DS    BL1
WK2ACH2  DS    BL1
WK2ADS3  DS    BL1
WK2ACI3  DS    BL1
WK2ACH3  DS    BL1
         ORG   UPCWORKA+1477
HAVES    DS    CL1
         ORG   HAVES
HAVEDS   DS    BL1
HAVECI   EQU   HAVES+0
HAVECH   EQU   HAVES+0
HAVECU   EQU   HAVES+0
HAVECPU  EQU   HAVES+0
HAVERSG  EQU   HAVES+0
HAVEALTP EQU   HAVES+0
HAVEADDR EQU   HAVES+0
         ORG   UPCWORKA+1478
UPCMSGID DS    CL1
         ORG   UPCMSGID
KNOWN    DS    BL1
KNOWN2   EQU   UPCMSGID+0
KNOWN3   EQU   UPCMSGID+0
ERROR    EQU   UPCMSGID+0
STOPSCAN EQU   UPCMSGID+0
ALTPDUN  EQU   UPCMSGID+0
HAVENUM  EQU   UPCMSGID+0
         ORG   UPCWORKA+1479
PACKED   DS    CL6
UNPACKED DS    CL11
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSS04 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ICG209I  DC    H'209'
ICG210I  DC    H'210'
ICG211I  DC    H'211'
ICG230I  DC    H'230'
ICG249I  DC    H'249'
MAXALT   DC    H'3'
MAXDEV   DC    H'64'
MAXREAL  DC    H'32'
MAXRSG   DC    H'27'
@CC00712 DC    C'SA FOR ALTPATH'
@CC00714 DC    C'CH FOR ALTPATH'
@CC00716 DC    C'CI FOR ALTPATH'
@CC00693 DC    C'SA (ALTPATH)'
@CC00700 DC    C'CH (ALTPATH)'
@CC00706 DC    C'CI (ALTPATH)'
@CC00745 DC    C'(ALTPATH SA)'
@CC00584 DC    C'CONVREAL='
@CC00568 DC    C'V, ADDR '
@CC00573 DC    C'VS, ADDR'
@CC00575 DC    C'REAL    '
@CC00586 EQU   @CC00584
@CC00601 DC    C'SA      '
@CC00618 DC    C'CH      '
@CC00649 DC    C'ALTPATH='
@CC00696 DC    C'SA (ALT)'
@CC00702 DC    C'CH (ALT)'
@CC00738 DC    C'ALTPATH1'
@CC00739 DC    C'ALTPATH2'
@CC00740 DC    C'ALTPATH3'
@CC00562 DC    C'CPUID='
@CC00560 DC    C'CUID='
@CC00574 DC    C'REAL='
@CC00636 EQU   @CC00562
@CC00656 DC    C'ADDR='
@CC00579 EQU   @CC00575
@CC00627 EQU   @CC00560
@CC00654 DC    C'SDG='
@CC00661 EQU   @CC00656
@CC00554 DC    C'SA='
@CC00556 DC    C'CI='
@CC00558 DC    C'CH='
@CC00572 DC    C'VS='
@CC00659 EQU   @CC00654
@CC00383 DC    C'00'
@CC00384 DC    C'01'
@CC00399 DC    C'10'
@CC00400 DC    C'11'
@CC00564 DC    C'V='
@CC00600 EQU   @CC00712
@CC00606 EQU   @CC00716
@CC00617 EQU   @CC00714
@CB00566 DC    X'000000000000000000000000'
@CB00531 EQU   @CB00566
@CB00671 EQU   @CB00566
@CB00665 EQU   @CB00566
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '
ICGDS223 DC    CL25' ICG223I VALUE ERROR FOR '
ICGDS226 DC    CL44' ICG226I DUPLICATE SPECIFICATION FOR DEVICE '
ICGDS227 DC    CL51' ICG227I PARAMETER MUST BE HEXADECIMAL. KEYWORD IS C
               '
ICGDS228 DC    CL47' ICG228I PARAMETER MUST BE NUMERIC. KEYWORD IS '
ICGDS232 DC    CL44' ICG232I SA INTERFACES TO MORE THAN TWO SDGS'
ICGDS237 DC    CL40' ICG237I ADDRESS XX PREVIOUSLY SPECIFIED'
ICGDS238 DC    CL32' ICG238I ADDRESS XX INVALID FOR '
INITDEV  DC    X'0000000000000000000000'
PATTERN  DC    CL2'00'
         DC    CL2'01'
         DC    CL2'02'
         DC    CL2'03'
         DC    CL2'04'
         DC    CL2'05'
         DC    CL2'06'
         DC    CL2'07'
         DC    CL2'08'
         DC    CL2'09'
         DC    CL2'0A'
         DC    CL2'0B'
         DC    CL2'0C'
         DC    CL2'0D'
         DC    CL2'0E'
         DC    CL2'0F'
         DC    CL2'10'
         DC    CL2'11'
         DC    CL2'12'
         DC    CL2'13'
         DC    CL2'14'
         DC    CL2'15'
         DC    CL2'16'
         DC    CL2'17'
         DC    CL2'18'
         DC    CL2'19'
         DC    CL2'1A'
         DC    CL2'1B'
         DC    CL2'1C'
         DC    CL2'1D'
         DC    CL2'1E'
         DC    CL2'1F'
         DC    CL2'20'
         DC    CL2'21'
         DC    CL2'22'
         DC    CL2'23'
         DC    CL2'24'
         DC    CL2'25'
         DC    CL2'26'
         DC    CL2'27'
         DC    CL2'28'
         DC    CL2'29'
         DC    CL2'2A'
         DC    CL2'2B'
         DC    CL2'2C'
         DC    CL2'2D'
         DC    CL2'2E'
         DC    CL2'2F'
         DC    CL2'30'
         DC    CL2'31'
         DC    CL2'32'
         DC    CL2'33'
         DC    CL2'34'
         DC    CL2'35'
         DC    CL2'36'
         DC    CL2'37'
         DC    CL2'38'
         DC    CL2'39'
         DC    CL2'3A'
         DC    CL2'3B'
         DC    CL2'3C'
         DC    CL2'3D'
         DC    CL2'3E'
         DC    CL2'3F'
PATTERN2 DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
J        EQU   @03
I        EQU   @02
R11      EQU   @11
R10      EQU   @10
R4       EQU   @04
R6       EQU   @06
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
KEYBIT   EQU   READFLAG
PARMBIT  EQU   READFLAG
ENDSCAN  EQU   READFLAG
LASTPARM EQU   READFLAG
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
SAVESCOL EQU   READER+188
SAVENCOL EQU   READER+192
SCANLEN  EQU   READER+204
PRINTER  EQU   COMTAB+464
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
MSGNO    EQU   MESSAGES+2
TERMINAT EQU   MESSAGES+6
SPECLMSG EQU   MESSAGES+18
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
TORSG1   EQU   DSENTRY
TORSG2   EQU   DSENTRY+1
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CISPEC   EQU   RSGFLAGS
RSGCPUID EQU   RSGUCB+1
RSGCHAN  EQU   RSGUCB+7
RSGCUA   EQU   RSGUCB+8
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
USESPEC  EQU   USEFLAGS
ALTPATH1 EQU   CONFGDEV+2
ALTPATH2 EQU   CONFGDEV+5
ALTPATH3 EQU   CONFGDEV+8
SCANDATA EQU   0
SCANBUF  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTCH3   EQU   ALTPATH3+2
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCH2   EQU   ALTPATH2+2
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCH1   EQU   ALTPATH1+2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
INDEXRSG EQU   CONFGDEV+1
ICEBERG  EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
USECONVR EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEV     EQU   USEFLAGS
CPUREFNO EQU   RSGUCB+6
@NM00018 EQU   RSGFLAGS
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
DINTIND  EQU   @NM00017
CINTIND  EQU   @NM00017
BINTIND  EQU   @NM00017
CYLFAULT EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
LOWLIB   EQU   LOWDSS+1
@NM00016 EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWSPEC  EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
MERLICEB EQU   PHYSFLGS
PHYSDS2  EQU   DSPAIRS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBDSMID EQU   LIB+2
LIBSIZE  EQU   LIB+1
@NM00009 EQU   LIBBITS
LIBSPEC  EQU   LIBBITS
TODS2    EQU   RSGTODS+1
TODS1    EQU   RSGTODS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
WARNING  EQU   MESSAGES+4
RETCODE  EQU   MESSAGES
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00064 EQU   @EL00003
@RC00325 EQU   @EL00008
@RC00343 EQU   @EL00009
@RC00378 EQU   @EL00010
@RC00420 EQU   @EL00012
@RC00429 EQU   @EL00013
@RC00549 EQU   @EL00017
@RC00567 EQU   @EL00018
@RC00618 EQU   @RC00597
@RC00598 EQU   @RC00597
@RT00704 EQU   @EL00021
@RC00772 EQU   @EL00023
@RC00815 EQU   @EL00024
@RF00825 EQU   @EL00025
@RC00907 EQU   @RC00903
@RC00905 EQU   @RC00903
@RF00958 EQU   @RC00925
@RC00952 EQU   @RC00925
@RC00972 EQU   @EL00031
@RF00971 EQU   @EL00031
@RC00969 EQU   @EL00031
@RC01003 EQU   @RC01002
@RC00604 EQU   @RC00598
@RC00627 EQU   @RC00618
@RC00908 EQU   @RC00907
@RC00605 EQU   @RC00604
@ENDDATA EQU   *
         END   ICGDSS04,(C'PLS1203',0701,78023)

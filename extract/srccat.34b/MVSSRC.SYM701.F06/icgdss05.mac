         TITLE 'ICGDSS05 MSC TABLE CREATE, SCAN LOWERCON STATEMENT     *
                        '
ICGDSS05 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSS05  76.337'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                                                  0025
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*            ICGDSS05 (MAINLINE)                           @YD00113*/
*/*                                                          @Y30LB12*/
*/*            CALL S05INIT, S05SCAN, S05ANAL.  IF NO        @YD00113*/
*/*            TERMINATING ERRORS, CALL S05BUILD             @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0025
*   CALL S05INIT;                   /* INITIALIZE            @Y30LB12*/
         BAL   @14,S05INIT                                         0025
*   CALL S05SCAN;                   /* GET KEYWDS, PARMS     @Y30LB12*/
         BAL   @14,S05SCAN                                         0026
*   CALL S05ANAL;                   /* CROSS-CHECK PARMS     @Y30LB12*/
         BAL   @14,S05ANAL                                         0027
*   IF STOPSCAN^='1'B               /* IF NO TERM. ERROR     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    STOPSCAN,B'10000000'                                0028
         BO    @RF00028                                            0028
*     CALL S05BUILD;                /* UPDATE LIB,LIBCTL     @Y30LB12*/
         BAL   @14,S05BUILD                                        0029
*   ELSE                                                           0030
*     ;                             /*                       @Y30LB12*/
@RF00028 DS    0H                                                  0031
*   RETURN;                         /* RET. TO ICGDSSCN      @Y30LB12*/
@EL00001 L     @13,4(,@13)                                         0031
@EF00001 L     @00,@SIZDATD                                        0031
         LR    @01,@11                                             0031
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0031
         BR    @14                                                 0031
*                                                                  0032
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05INIT                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION -  INITIALIZE LOCAL WORK AREA                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0032
*S05INIT:                                                          0032
*   PROCEDURE;                      /*                       @Y30LB12*/
S05INIT  STM   @14,@12,12(@13)                                     0032
*   DSINDEX=0;                      /* DS PTR INTO TABLE     @Y30LB12*/
         SLR   @10,@10                                             0033
         STH   @10,DSINDEX                                         0033
*   CUINDEX=0;                      /* CU PTR INTO TABLE     @Y30LB12*/
         STH   @10,CUINDEX                                         0034
*   DO I=1 TO 4;                    /* 4 CUIDS PER DS        @Y30LB12*/
         LA    @10,1                                               0035
         STH   @10,I                                               0035
@DL00035 DS    0H                                                  0036
*     CUIDS(I)='0000'X;             /* INIT TO ZEROS         @YM31085*/
         LR    @05,@10                                             0036
         ALR   @05,@05                                             0036
         LA    @01,CUIDS-2(@05)                                    0036
         MVC   0(2,@01),@CB00394                                   0036
*     HAVEFLAG(I)='00'X;            /* CONTROL UNIT FLGS     @YM31085*/
         LA    @05,HAVEFLAG-1(@10)                                 0037
         MVI   0(@05),X'00'                                        0037
*   END;                            /* END OF DO I           @Y30LB12*/
         AH    @10,@CH00042                                        0038
         STH   @10,I                                               0038
         CH    @10,@CH00068                                        0038
         BNH   @DL00035                                            0038
*   HAVES='00'X;                    /* 'FOUND IT' FLAGS      @Y30LB12*/
         MVI   HAVES,X'00'                                         0039
*   LOWMSGID='00'X;                 /* FLAG BYTE             @Y30LB12*/
         MVI   LOWMSGID,X'00'                                      0040
*   END S05INIT;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00002 DS    0H                                                  0041
@EF00002 DS    0H                                                  0041
@ER00002 LM    @14,@12,12(@13)                                     0041
         BR    @14                                                 0041
*                                                                  0042
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05SCAN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT A KEYWORD FROM THE CONTROL STATEMENT  @Y30LB12*/
*/*            AND DETERMINE THE ROUTINE TO BE CALLED TO     @Y30LB12*/
*/*            HANDLE THE PARAMETER.                         @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0042
*S05SCAN:                                                          0042
*   PROCEDURE;                      /*                       @Y30LB12*/
S05SCAN  STM   @14,@12,@SA00003                                    0042
*   DO WHILE(LASTPARM^='1'B);       /* TILL NO MORE DATA     @Y30LB12*/
         B     @DE00043                                            0043
@DL00043 DS    0H                                                  0044
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/
         BAL   @14,READS99                                         0044
*     KNOWN='0'B;                   /* REC. KEYWORD FLAG     @Y30LB12*/
*                                                                  0045
         NI    KNOWN,B'10111111'                                   0045
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* LASTPARM IS SET BY ICGDSS99 WHEN NO MORE            @Y30LB12*/
*     /* KEYWORDS OR PARAMETERS TO BE SCANNED FROM           @Y30LB12*/
*     /* THIS STATEMENT.                                     @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0046
*     IF LASTPARM='1'B              /* IF END OF DATA        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    LASTPARM(R4),B'00001000'                            0046
         BO    @RT00046                                            0046
*       RETURN;                     /* TO MAINLINE S05       @Y30LB12*/
*     ELSE                                                         0048
*       ;                           /*                       @Y30LB12*/
*     IF KEYBIT^='1'B               /* SET IN ICGDSS99       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KEYBIT(R4),B'01000000'                              0049
         BO    @RF00049                                            0049
*       DO;                         /*                       @Y30LB12*/
*                                                                  0050
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @Y30LB12*/
*         /* ICG209I EXPECTED, BUT DID NOT FIND,             @Y30LB12*/
*         /* KEYWORD                                         @Y30LB12*/
*         /* *****************************************       @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0051
*         MSGNO=ICG209I;            /* ID FOR ICGDS209       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG209I                                 0051
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0052
*         RETURN;                   /* RET. TO MAINLINE      @Y30LB12*/
@EL00003 DS    0H                                                  0053
@EF00003 DS    0H                                                  0053
@ER00003 LM    @14,@12,@SA00003                                    0053
         BR    @14                                                 0053
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0055
*       ;                           /*                       @Y30LB12*/
*                                                                  0055
@RF00049 DS    0H                                                  0056
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS 'SA', SET FLAG           @YD00113*/
*     /* 'KNOWN' TO '1', AND CALL 'S05DS' TO GET THE         @YD00113*/
*     /* PARAMETER                                           @YD00113*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0056
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0056
         CLC   SCANDATA(3,@10),@CC00402                            0056
         BNE   @RF00056                                            0056
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'01000000'                                   0058
*         CALL S05DS;               /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S05DS                                           0059
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0061
*       ;                           /*                       @Y30LB12*/
*                                                                  0061
@RF00056 DS    0H                                                  0062
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS 'CUXX', SET FLAG         @YD00113*/
*     /* 'KNOWN' TO '1', AND CALL 'S05DS' TO GET THE         @YD00113*/
*     /* PARAMETER                                           @YD00113*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0062
*     IF SCANDATA(1:2)='CU'         /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0062
         CLC   SCANDATA(2,@10),@CC00404                            0062
         BNE   @RF00062                                            0062
*       DO;                         /*                       @Y30LB12*/
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/
         OI    KNOWN,B'01000000'                                   0064
*         CALL S05CUID;             /* TO GET PARAMETER      @Y30LB12*/
         BAL   @14,S05CUID                                         0065
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0067
*       ;                           /*                       @Y30LB12*/
*                                                                  0067
@RF00062 DS    0H                                                  0068
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF THE KEYWORD SCANNED WAS NOT RECOGNIZED,          @YD00113*/
*     /* CALL PROC 'UNKNOWN' TO PRINT MESSAGE AND            @YD00113*/
*     /* POSITION TO NEXT KEYWORD.                           @YD00113*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0068
*     IF KNOWN^='1'B                /* REC. KEYWORD FLAG     @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN,B'01000000'                                   0068
         BO    @RF00068                                            0068
*       CALL UNKNOWN;               /* MSG AND POSITION      @Y30LB12*/
         BAL   @14,UNKNOWN                                         0069
*     ELSE                                                         0070
*       ;                           /*                       @Y30LB12*/
@RF00068 DS    0H                                                  0071
*   END;                            /* END OF DO WHILE       @Y30LB12*/
@DE00043 TM    LASTPARM(R4),B'00001000'                            0071
         BNO   @DL00043                                            0071
*   END S05SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/
         B     @EL00003                                            0072
*                                                                  0073
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05DS                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - READ THE SA PARAMETER.  CHECK FOR DUPLICATE   @YM31085*/
*/*            KEYWORD AND INCORRECT LENGTH.  IF NEITHER     @YD00113*/
*/*            ERROR, CALL CONVHEX TO CONVERT THE            @Y30LB12*/
*/*            CHARACTER REPRESENTATION OF THE HEXADECIMAL   @Y30LB12*/
*/*            NUMBER TO ITS EQUIVALENT IN BINARY.           @YD00113*/
*/*            SAVE THE VALUE IN DSINDEX.                    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0073
*S05DS:                                                            0073
*   PROCEDURE;                      /*                       @Y30LB12*/
S05DS    STM   @14,@12,@SA00004                                    0073
*   ERROR='0'B;                     /* RESET ERROR FLAG      @Y30LB12*/
         NI    ERROR,B'11101111'                                   0074
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/
         BAL   @14,READS99                                         0075
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVEDS,B'10000000'                                  0076
         BO    @RF00076                                            0076
*     HAVEDS='1'B;                  /*                       @Y30LB12*/
         OI    HAVEDS,B'10000000'                                  0077
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0078
         B     @RC00076                                            0078
@RF00076 DS    0H                                                  0079
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG219I DUPLICATE KEYWORD SA'                    @YM31085*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0079
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0079
*       OUTBUF2(28:29)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+27(2,R4),@CC00412                           0080
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0081
*       RETURN;                     /* RET. TO S05SCAN       @Y30LB12*/
@EL00004 DS    0H                                                  0082
@EF00004 DS    0H                                                  0082
@ER00004 LM    @14,@12,@SA00004                                    0082
         BR    @14                                                 0082
*     END;                          /*                       @Y30LB12*/
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00076 TM    PARMBIT(R4),B'00100000'                             0084
         BO    @RF00084                                            0084
*     DO;                           /*                       @Y30LB12*/
*                                                                  0085
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/
*       /* PARAMETER                                         @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0086
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG211I                                 0086
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0087
*       RETURN;                     /* RET. TO S05SCAN       @Y30LB12*/
         B     @EL00004                                            0088
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0090
*     ;                             /*                       @Y30LB12*/
@RF00084 DS    0H                                                  0091
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00042                              0091
         BE    @RF00091                                            0091
*     DO;                           /*                       @Y30LB12*/
*                                                                  0092
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/
*       /* KEYWORD IS SA'                                    @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0093
*       ERROR='1'B;                 /* ERROR FLAG ON         @Y30LB12*/
         OI    ERROR,B'00010000'                                   0093
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0094
*       OUTBUF2(47:48)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+46(2,R4),@CC00412                           0095
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0096
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0098
*     ;                             /*                       @Y30LB12*/
@RF00091 DS    0H                                                  0099
*   IF ERROR^='1'B                  /* IF NO ERROR           @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    ERROR,B'00010000'                                   0099
         BO    @RF00099                                            0099
*     DO;                           /*                       @Y30LB12*/
*       HEXCHAR=SCANDATA(1);        /* PASS VALUE            @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0101
         MVC   HEXCHAR(1),SCANDATA(@10)                            0101
*       PLUGIN='SA      ';          /* FOR POSSIBLE MSG      @Y30LB12*/
         MVC   PLUGIN(8),@CC00415                                  0102
*       CALL CONVHEX;               /* TRANSLATE VALUE       @Y30LB12*/
         BAL   @14,CONVHEX                                         0103
*       DSINDEX=HEXINDEX;           /* HEXINDEX=HEXCHAR+1    @Y30LB12*/
         MVC   DSINDEX(2),HEXINDEX                                 0104
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0106
*     ;                             /*                       @Y30LB12*/
@RF00099 DS    0H                                                  0107
*   END S05DS;                      /* RET. TO S05SCAN       @Y30LB12*/
         B     @EL00004                                            0107
*                                                                  0108
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05CUID                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - EXTRACT CONTROL UNIT IDENTIFIER FROM SUFFIX   @Y30LB12*/
*/*            OF KEYWORD AND CHECK FOR VALIDITY.  IF VALID, @Y30LB12*/
*/*            CALL S05CUPRM TO EXTRACT REQUIRED PARAMETERS  @Y30LB12*/
*/*            THAT FOLLOW THIS KEYWORD.  IF INVALID, RETURN @Y30LB12*/
*/*            TO S05SCAN.                                   @Y30LB12*/
*/*            IF SUBPARAMETERS NOT PROCESSED, ERROR MESSAGE @Y30LB12*/
*/*            'ICGDS209 EXPECTED, BUT DID NOT FIND,         @Y30LB12*/
*/*            KEYWORD' WILL BE PRODUCED BY S05SCAN.         @YM31085*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0108
*S05CUID:                                                          0108
*   PROCEDURE;                      /*                       @Y30LB12*/
S05CUID  STM   @14,@12,@SA00005                                    0108
*   SAVECUID=SCANDATA(3:4);         /* EXTRACT SUFFIX        @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0109
         MVC   SAVECUID(2),SCANDATA+2(@10)                         0109
*   BINCHAR(1:2)=SCANDATA(3:4);     /* AGAIN TO PASS IT      @Y30LB12*/
         MVC   BINCHAR(2),SCANDATA+2(@10)                          0110
*   CALL CONVBIN;                   /* GET INDEX POINTER     @Y30LB12*/
*                                                                  0111
         BAL   @14,CONVBIN                                         0111
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YM31085*/
*   /* CHECK THAT THE XX PORTION OF CUXX IS VALID            @YM31085*/
*   /* BY VERIFYING THAT THE VALUE WAS CONVERTED AND         @YM31085*/
*   /* THAT THE LENGTH OF THE PARAMETER IS CORRECT           @YM31085*/
*   /* (EQUAL SIGN APPEARS IN PROPER POSITION)               @YM31085*/
*   /* ***********************************************       @YM31085*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0112
*   IF BININDEX^=0&SCANDATA(5)='='  /* GOOD DATA             @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LH    @10,BININDEX                                        0112
         LTR   @10,@10                                             0112
         BZ    @RF00112                                            0112
         L     @05,STARTCOL(,R4)                                   0112
         CLI   SCANDATA+4(@05),C'='                                0112
         BNE   @RF00112                                            0112
*     IF HAVECUID(BININDEX)^='1'B   /* NOT YET USED          @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @05,@10                                             0113
         ALR   @05,@05                                             0113
         LA    @01,HAVECUID-2(@05)                                 0113
         TM    0(@01),B'10000000'                                  0113
         BO    @RF00113                                            0113
*       DO;                         /*                       @Y30LB12*/
*         HAVECUID(BININDEX)='1'B;  /* SET USED              @Y30LB12*/
         LA    @01,HAVECUID-2(@05)                                 0115
         OI    0(@01),B'10000000'                                  0115
*         KNOWN2='1'B;              /* FOR CALLED PROC       @Y30LB12*/
         OI    KNOWN2,B'00100000'                                  0116
*         CUINDEX=BININDEX;         /* PTR TO ENTRY          @Y30LB12*/
         STH   @10,CUINDEX                                         0117
*         CALL S05CUPRM;            /* TO GET PARMS          @Y30LB12*/
         BAL   @14,S05CUPRM                                        0118
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       DO;                         /*                       @Y30LB12*/
*                                                                  0120
         B     @RC00113                                            0120
@RF00113 DS    0H                                                  0121
*         /***********************************************************/
*         /*                                                         */
*         /* *************************************           @Y30LB12*/
*         /* 'ICG219I DUPLICATE KEYWORD CUXX'                @Y30LB12*/
*         /* *************************************           @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0121
*         OUTBUF2(1:27)=ICGDS219;   /*                       @Y30LB12*/
         MVC   OUTBUF2(27,R4),ICGDS219                             0121
*         OUTBUF2(28:31)=SCANDATA(1:4);/*                    @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0122
         MVC   OUTBUF2+27(4,R4),SCANDATA(@10)                      0122
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0123
*       END;                        /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     DO;                           /*                       @Y30LB12*/
*                                                                  0125
         B     @RC00112                                            0125
@RF00112 DS    0H                                                  0126
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* 'ICG235I RANGE ERROR IN SUFFIX OF                 @Y30LB12*/
*       /* KEYWORD CU'                                       @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0126
*       OUTBUF2(1:42)=ICGDS235;     /*                       @Y30LB12*/
         MVC   OUTBUF2(42,R4),ICGDS235                             0126
*       OUTBUF2(43:44)='CU';        /*                       @Y30LB12*/
         MVC   OUTBUF2+42(2,R4),@CC00404                           0127
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0128
*     END;                          /*                       @Y30LB12*/
*   END S05CUID;                    /* RET. TO S05SCAN       @Y30LB12*/
@EL00005 DS    0H                                                  0130
@EF00005 DS    0H                                                  0130
@ER00005 LM    @14,@12,@SA00005                                    0130
         BR    @14                                                 0130
*                                                                  0131
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05CUPRM                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - SAVE THE STARTING READ VALUES BEFORE READING  @Y30LB12*/
*/*            THE NEXT PARAMETER.  IF THE PARAMETER IS      @Y30LB12*/
*/*            'MSFX' OR 'DRCX', CALL THE PROPER             @Y30LB12*/
*/*            PROCEDURE TO HANDLE.  OTHERWISE, BACK OUT     @Y30LB12*/
*/*            READ AND RETURN TO S05CUID.                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0131
*S05CUPRM:                                                         0131
*   PROCEDURE;                      /*                       @Y30LB12*/
S05CUPRM STM   @14,@12,@SA00006                                    0131
*   DO WHILE(KNOWN2='1'B);          /* WHILE REC. PARM       @Y30LB12*/
         B     @DE00132                                            0132
@DL00132 DS    0H                                                  0133
*     KNOWN2='0'B;                  /* RESET REC. FLAG       @Y30LB12*/
         NI    KNOWN2,B'11011111'                                  0133
*     SAVENCOL=NEXTCOL;             /* SAVE STARTING COL     @Y30LB12*/
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0134
*     SAVESCOL=STARTCOL;            /* SAVE START NEXT       @Y30LB12*/
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0135
*     CALL READS99;                 /* EXTRACT PARAMETER     @Y30LB12*/
*                                                                  0136
         BAL   @14,READS99                                         0136
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF FIRST THREE CHARACTERS OF PARAMETER ARE          @Y30LB12*/
*     /* 'MSF', SET 'KNOWN2' FLAG AND CALL 'S05LIB' TO       @YD00113*/
*     /* EXAMINE THE PARAMETER.                              @YD00113*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0137
*     IF SCANDATA(1:3)='MSF'        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0137
         CLC   SCANDATA(3,@10),@CC00428                            0137
         BNE   @RF00137                                            0137
*       DO;                         /*                       @Y30LB12*/
*         KNOWN2='1'B;              /* RECOGNIZED PARM       @Y30LB12*/
         OI    KNOWN2,B'00100000'                                  0139
*         CALL S05LIB;              /* TO EXAMINE PARM       @Y30LB12*/
         BAL   @14,S05LIB                                          0140
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0142
*       ;                           /*                       @Y30LB12*/
*                                                                  0142
@RF00137 DS    0H                                                  0143
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* IF FIRST THREE CHARACTERS OF PARAMETER ARE          @Y30LB12*/
*     /* 'DRC', SET 'KNOWN2' FLAG AND CALL 'S05RDWRT'        @YD00113*/
*     /* TO EXAMINE THE PARAMETER.                           @YD00113*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0143
*     IF SCANDATA(1:3)='DRC'        /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0143
         CLC   SCANDATA(3,@10),@CC00430                            0143
         BNE   @RF00143                                            0143
*       DO;                         /*                       @Y30LB12*/
*         KNOWN2='1'B;              /* RECOGNIZED PARM       @Y30LB12*/
         OI    KNOWN2,B'00100000'                                  0145
*         CALL S05RDWRT;            /* TO EXTRACT PARM       @Y30LB12*/
         BAL   @14,S05RDWRT                                        0146
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0148
*       ;                           /*                       @Y30LB12*/
@RF00143 DS    0H                                                  0149
*     IF KNOWN2='0'B                /* IF PARM NOT REC.,     @Y30LB12*/
*         &KEYBIT='1'B              /* KEYWORD SCANNED       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         TM    KNOWN2,B'00100000'                                  0149
         BNZ   @RF00149                                            0149
         TM    KEYBIT(R4),B'01000000'                              0149
         BNO   @RF00149                                            0149
*       DO;                         /*                       @Y30LB12*/
*         NEXTCOL=SAVENCOL;         /* ORIGINAL START COL    @Y30LB12*/
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0151
*         STARTCOL=SAVESCOL;        /* ORIGINAL NEXT COL     @Y30LB12*/
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0152
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       IF KNOWN2='0'B              /* IF PARM NOT REC.      @Y30LB12*/
*           &PARMBIT='1'B           /* PARAMETER SCANNED     @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00149                                            0154
@RF00149 TM    KNOWN2,B'00100000'                                  0154
         BNZ   @RF00154                                            0154
         TM    PARMBIT(R4),B'00100000'                             0154
         BNO   @RF00154                                            0154
*         DO;                       /*                       @Y30LB12*/
*                                                                  0155
*           /*********************************************************/
*           /*                                                       */
*           /* *************************************         @Y30LB12*/
*           /* ICG212I UNDEFINED PARAMETER FOUND             @Y30LB12*/
*           /* *************************************         @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0156
*           MSGNO=ICG212I;          /* ID FOR ICG212I        @Y30LB12*/
         MVC   MSGNO(2,R4),ICG212I                                 0156
*           CALL PUTIT2;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0157
*         END;                      /*                       @Y30LB12*/
*   END;                            /* END OF 'DO WHILE'     @Y30LB12*/
@RF00154 DS    0H                                                  0159
@RC00149 DS    0H                                                  0159
@DE00132 TM    KNOWN2,B'00100000'                                  0159
         BO    @DL00132                                            0159
*   END S05CUPRM;                   /* RET. TO S05CUID       @Y30LB12*/
@EL00006 DS    0H                                                  0160
@EF00006 DS    0H                                                  0160
@ER00006 LM    @14,@12,@SA00006                                    0160
         BR    @14                                                 0160
*                                                                  0161
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05LIB                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK THE LENGTH OF THE PARAMETER AND WRITE   @Y30LB12*/
*/*            MESSAGE IF THE LENGTH IS INCORRECT.           @YD00113*/
*/*            OTHERWISE MOVE LIBRARY ID INTO PROPER SLOT    @Y30LB12*/
*/*            FOR THIS CONTROL UNIT.                        @Y30LB12*/
*/*            (VALIDITY OF LIBRARY ID WILL BE CHECKED IN    @Y30LB12*/
*/*            S05ANAL.)                                     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0161
*S05LIB:                                                           0161
*   PROCEDURE;                      /*                       @Y30LB12*/
S05LIB   STM   @14,@12,@SA00007                                    0161
*   HAVEMSF(CUINDEX)='1'B;          /* HAVE MSF FOR CU       @YM31085*/
         LH    @10,CUINDEX                                         0162
         LA    @05,HAVEMSF-1(@10)                                  0162
         OI    0(@05),B'10000000'                                  0162
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00068                              0163
         BE    @RF00163                                            0163
*     DO;                           /*                       @Y30LB12*/
*                                                                  0164
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/
*       /* KEYWORD IS MSFX.                                  @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0165
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0165
*       OUTBUF2(47:50)=SCANDATA(1:4);/*                      @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0166
         MVC   OUTBUF2+46(4,R4),SCANDATA(@10)                      0166
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0167
*     END;                          /*                       @Y30LB12*/
*                                                                  0168
*   /*****************************************************************/
*   /*                                                               */
*   /* *********************************************         @YM31085*/
*   /* IF NO MSFX PARAMETER HAS BEEN ENCOUNTERED             @YM31085*/
*   /* IN THIS STATEMENT FOR THIS CONTROL UNIT,              @YM31085*/
*   /* SAVE THE LOGICAL MSF ID IN CHARACTER FORM.            @YM31085*/
*   /* *********************************************         @YM31085*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0169
*   ELSE                            /*                       @Y30LB12*/
*     IF WORKLIB(CUINDEX)='00'X     /* IF UNUSED             @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00163                                            0169
@RF00163 LH    @10,CUINDEX                                         0169
         ALR   @10,@10                                             0169
         LA    @05,WORKLIB-2(@10)                                  0169
         CLI   0(@05),X'00'                                        0169
         BNE   @RF00169                                            0169
*       WORKLIB(CUINDEX)=SCANDATA(4);/* USE IT               @Y30LB12*/
         LA    @05,WORKLIB-2(@10)                                  0170
         L     @10,STARTCOL(,R4)                                   0170
         MVC   0(1,@05),SCANDATA+3(@10)                            0170
*     ELSE                          /*                       @Y30LB12*/
*       DO;                         /*                       @Y30LB12*/
*                                                                  0171
         B     @RC00169                                            0171
@RF00169 DS    0H                                                  0172
*         /***********************************************************/
*         /*                                                         */
*         /* *************************************           @Y30LB12*/
*         /* ICG234I 2 MSF SPECIFICATIONS FOR                @Y30LB12*/
*         /* CUXX.                                           @Y30LB12*/
*         /* *************************************           @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0172
*         OUTBUF2(1:36)=ICGDS234;   /*                       @Y30LB12*/
         MVC   OUTBUF2(36,R4),ICGDS234                             0172
*         OUTBUF2(12:14)='MSF';     /*                       @Y30LB12*/
         MVC   OUTBUF2+11(3,R4),@CC00428                           0173
*         OUTBUF2(37:38)=SAVECUID;  /*                       @Y30LB12*/
         MVC   OUTBUF2+36(2,R4),SAVECUID                           0174
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0175
*       END;                        /*                       @Y30LB12*/
*   END S05LIB;                     /* RET. TO S05CUPRM      @Y30LB12*/
@EL00007 DS    0H                                                  0177
@EF00007 DS    0H                                                  0177
@ER00007 LM    @14,@12,@SA00007                                    0177
         BR    @14                                                 0177
*                                                                  0178
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05RDWRT                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK THE LENGTH OF THE PARAMETER AND WRITE   @Y30LB12*/
*/*            ERROR MESSAGE IF THE LENGTH IS INCORRECT.     @Y30LB12*/
*/*            CHECK THE LAST CHARACTER FOR EXPECTED DATA    @Y30LB12*/
*/*            RECORDING CONTROL UNIT ID AND SET THE         @Y30LB12*/
*/*            PROPER BIT FOR THIS LIBRARY CONTROL UNIT.     @Y30LB12*/
*/*            (IF NO BIT IS SET, IT WILL BE CAUGHT IN       @Y30LB12*/
*/*            S05ANAL.)                                     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0178
*S05RDWRT:                                                         0178
*   PROCEDURE;                      /*                       @Y30LB12*/
S05RDWRT STM   @14,@12,@SA00008                                    0178
*   HAVEDRC(CUINDEX)='1'B;          /* HAVE DRC FOR CU       @YM31085*/
         LH    @10,CUINDEX                                         0179
         LA    @05,HAVEDRC-1(@10)                                  0179
         OI    0(@05),B'01000000'                                  0179
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         CLC   SCANLEN(2,R4),@CH00068                              0180
         BE    @RF00180                                            0180
*     DO;                           /*                       @Y30LB12*/
*                                                                  0181
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/
*       /* KEYWORD IS DRCX                                   @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0182
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS220                             0182
*       OUTBUF2(47:50)=SCANDATA(1:4);/*                      @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0183
         MVC   OUTBUF2+46(4,R4),SCANDATA(@10)                      0183
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0184
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     IF RDWRS(CUINDEX)='0000'B     /* IF ENTRY FREE         @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00180                                            0186
@RF00180 LH    @10,CUINDEX                                         0186
         ALR   @10,@10                                             0186
         LA    @05,RDWRS-2(@10)                                    0186
         TM    0(@05),B'01111000'                                  0186
         BNZ   @RF00186                                            0186
*       DO;                         /*                       @Y30LB12*/
*         IF SCANDATA(4)='0'        /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         L     @05,STARTCOL(,R4)                                   0188
         CLI   SCANDATA+3(@05),C'0'                                0188
         BNE   @RF00188                                            0188
*           RDWR01(CUINDEX)='1'B;   /*                       @Y30LB12*/
         LA    @05,RDWR01-2(@10)                                   0189
         OI    0(@05),B'01000000'                                  0189
*         ELSE                                                     0190
*           ;                       /*                       @Y30LB12*/
@RF00188 DS    0H                                                  0191
*         IF SCANDATA(4)='1'        /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0191
         CLI   SCANDATA+3(@10),C'1'                                0191
         BNE   @RF00191                                            0191
*           RDWR23(CUINDEX)='1'B;   /*                       @Y30LB12*/
         LH    @10,CUINDEX                                         0192
         ALR   @10,@10                                             0192
         LA    @05,RDWR23-2(@10)                                   0192
         OI    0(@05),B'00100000'                                  0192
*         ELSE                                                     0193
*           ;                       /*                       @Y30LB12*/
@RF00191 DS    0H                                                  0194
*         IF SCANDATA(4)='2'        /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0194
         CLI   SCANDATA+3(@10),C'2'                                0194
         BNE   @RF00194                                            0194
*           RDWR45(CUINDEX)='1'B;   /*                       @Y30LB12*/
         LH    @10,CUINDEX                                         0195
         ALR   @10,@10                                             0195
         LA    @05,RDWR45-2(@10)                                   0195
         OI    0(@05),B'00010000'                                  0195
*         ELSE                                                     0196
*           ;                       /*                       @Y30LB12*/
@RF00194 DS    0H                                                  0197
*         IF SCANDATA(4)='3'        /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         L     @10,STARTCOL(,R4)                                   0197
         CLI   SCANDATA+3(@10),C'3'                                0197
         BNE   @RF00197                                            0197
*           RDWR67(CUINDEX)='1'B;   /*                       @Y30LB12*/
         LH    @10,CUINDEX                                         0198
         ALR   @10,@10                                             0198
         LA    @05,RDWR67-2(@10)                                   0198
         OI    0(@05),B'00001000'                                  0198
*         ELSE                                                     0199
*           ;                       /*                       @Y30LB12*/
@RF00197 DS    0H                                                  0200
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       DO;                         /*                       @Y30LB12*/
*                                                                  0201
         B     @RC00186                                            0201
@RF00186 DS    0H                                                  0202
*         /***********************************************************/
*         /*                                                         */
*         /* *************************************           @Y30LB12*/
*         /* ICG234I 2 DRC SPECIFICATIONS FOR                @Y30LB12*/
*         /* CUXX.                                           @Y30LB12*/
*         /* *************************************           @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0202
*         OUTBUF2(1:36)=ICGDS234;   /*                       @Y30LB12*/
         MVC   OUTBUF2(36,R4),ICGDS234                             0202
*         OUTBUF2(12:14)='DRC';     /*                       @Y30LB12*/
         MVC   OUTBUF2+11(3,R4),@CC00430                           0203
*         OUTBUF2(37:38)=SAVECUID;  /*                       @Y30LB12*/
         MVC   OUTBUF2+36(2,R4),SAVECUID                           0204
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0205
*       END;                        /*                       @Y30LB12*/
*   END S05RDWRT;                   /* RET. TO S05CUPRM      @Y30LB12*/
@EL00008 DS    0H                                                  0207
@EF00008 DS    0H                                                  0207
@ER00008 LM    @14,@12,@SA00008                                    0207
         BR    @14                                                 0207
*                                                                  0208
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - UNKNOWN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - IF THE KEYWORD IS NOT 'SA' OR 'CUXX', WRITE   @YM31085*/
*/*            ERROR MESSAGE 'ICG210I  UNDEFINED KEYWORD     @Y30LB12*/
*/*            FOUND' AND DO DUMMY READ OF PARAMETER TO      @Y30LB12*/
*/*            POSITION TO NEXT KEYWORD.                     @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0208
*UNKNOWN:                                                          0208
*   PROCEDURE;                      /*                       @Y30LB12*/
UNKNOWN  STM   @14,@12,@SA00009                                    0208
*   MSGNO=ICG210I;                  /* ID FOR ICGDS210       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG210I                                 0209
*   CALL PUTIT2;                    /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0210
*   CALL READS99;                   /* DO DUMMY READ         @Y30LB12*/
         BAL   @14,READS99                                         0211
*   END UNKNOWN;                    /* RET. TO S05SCAN       @Y30LB12*/
@EL00009 DS    0H                                                  0212
@EF00009 DS    0H                                                  0212
@ER00009 LM    @14,@12,@SA00009                                    0212
         BR    @14                                                 0212
*                                                                  0213
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05ANAL                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - VERIFY THAT THE PROPER VALUES HAVE BEEN       @Y30LB12*/
*/*            SPECIFIED IN THE SUFFIX OF THE 'DRCX' AND     @Y30LB12*/
*/*            'MSFX' PARAMETERS, AND VERIFY THAT A DATA     @Y30LB12*/
*/*             STAGER HAS BEEN SPECIFIED                    @Y30LB12*/
*/*                                                          @YD00113*/
*/*            IF ANY OF THE TESTS FAIL, ISSUE APPROPRIATE   @YD00113*/
*/*            ERROR MESSAGE.                                @YD00113*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0213
*S05ANAL:                                                          0213
*   PROCEDURE;                      /*                       @Y30LB12*/
*                                                                  0213
S05ANAL  STM   @14,@12,@SA00010                                    0213
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YM31085*/
*   /* UP TO FOUR CONTROL UNIT ADDRESSES FROM THE            @YM31085*/
*   /* STAGING ADAPTER CAN BE SPECIFIED FROM A               @YM31085*/
*   /* LOWERCON STATEMENT. CHECK ALL 4 POSSIBLE.             @YM31085*/
*   /* ***********************************************       @YM31085*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*   DO I=1 TO MAXCU;                /* FOR EACH CU ID        @YM31085*/
         LA    @10,1                                               0214
         STH   @10,I                                               0214
@DL00214 DS    0H                                                  0215
*     IF HAVECUID(I)='1'B           /*                       @YM31062*/
*       THEN                        /*                       @YM31062*/
         ALR   @10,@10                                             0215
         LA    @05,HAVECUID-2(@10)                                 0215
         TM    0(@05),B'10000000'                                  0215
         BNO   @RF00215                                            0215
*       CUSPEC='1'B;                /*                       @YM31062*/
         OI    CUSPEC,B'01000000'                                  0216
*     ELSE                                                         0217
*       ;                           /*                       @YM31062*/
@RF00215 DS    0H                                                  0218
*     IF RDWRS(I)='0000'B           /*                       @YM32176*/
*         &HAVECUID(I)='1'B         /*                       @YM31085*/
*         &HAVEDRC(I)='1'B          /*                       @YM31085*/
*       THEN                        /*                       @Y30LB12*/
         LH    @10,I                                               0218
         LR    @05,@10                                             0218
         ALR   @05,@05                                             0218
         LA    @01,RDWRS-2(@05)                                    0218
         TM    0(@01),B'01111000'                                  0218
         BNZ   @RF00218                                            0218
         LA    @01,HAVECUID-2(@05)                                 0218
         TM    0(@01),B'10000000'                                  0218
         BNO   @RF00218                                            0218
         LA    @01,HAVEDRC-1(@10)                                  0218
         TM    0(@01),B'01000000'                                  0218
         BNO   @RF00218                                            0218
*       DO;                         /*                       @Y30LB12*/
*                                                                  0219
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @Y30LB12*/
*         /* ICG236I FORMAT ERROR IN PARAMETER               @Y30LB12*/
*         /* DRCX FOR CUXX                                   @Y30LB12*/
*         /* *****************************************       @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0220
*         OUTBUF2(1:35)=ICGDS236;   /*                       @Y30LB12*/
         MVC   OUTBUF2(35,R4),ICGDS236                             0220
*         OUTBUF2(36:39)='DRCX';    /*                       @Y30LB12*/
         MVC   OUTBUF2+35(4,R4),@CC00454                           0221
*         OUTBUF2(40:46)=MSGADDON;  /*                       @YM31085*/
         MVC   OUTBUF2+39(7,R4),MSGADDON                           0222
*         OUTBUF2(47:48)=CULOOKUP(I);/*                      @YM31085*/
         LA    @10,CULOOKUP-2(@05)                                 0223
         MVC   OUTBUF2+46(2,R4),0(@10)                             0223
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0224
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0226
*       ;                           /*                       @Y30LB12*/
@RF00218 DS    0H                                                  0227
*     IF HAVECUID(I)='1'B           /* IF POSITION SPEC      @Y30LB12*/
*         &HAVEMSF(I)='1'B          /* MSF SPECIFIED         @YM31085*/
*       THEN                        /*                       @Y30LB12*/
         LH    @10,I                                               0227
         LR    @05,@10                                             0227
         ALR   @05,@05                                             0227
         LA    @01,HAVECUID-2(@05)                                 0227
         TM    0(@01),B'10000000'                                  0227
         BNO   @RF00227                                            0227
         LA    @01,HAVEMSF-1(@10)                                  0227
         TM    0(@01),B'10000000'                                  0227
         BNO   @RF00227                                            0227
*       IF ONEBITS(I)^='1111'B      /* NOT NUMERIC ZONE      @Y30LB12*/
*           ZEROBITS(I)^='000'B    /* OR DIGIT > 1          @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         LA    @10,ONEBITS-2(@05)                                  0228
         TM    0(@10),B'11110000'                                  0228
         BNO   @RT00228                                            0228
         LA    @10,ZEROBITS-2(@05)                                 0228
         TM    0(@10),B'00001110'                                  0228
         BZ    @RF00228                                            0228
@RT00228 DS    0H                                                  0229
*         DO;                       /*                       @Y30LB12*/
*                                                                  0229
*           /*********************************************************/
*           /*                                                       */
*           /* *************************************         @Y30LB12*/
*           /* ICG236I FORMAT ERROR IN PARAMETER             @Y30LB12*/
*           /* MSFX FOR CUXX                                 @YM31085*/
*           /* *************************************         @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0230
*           OUTBUF2(1:35)=ICGDS236; /*                       @Y30LB12*/
         MVC   OUTBUF2(35,R4),ICGDS236                             0230
*           OUTBUF2(36:39)='MSFX';  /*                       @Y30LB12*/
         MVC   OUTBUF2+35(4,R4),@CC00458                           0231
*           OUTBUF2(40:46)=MSGADDON;/*                       @YM31085*/
         MVC   OUTBUF2+39(7,R4),MSGADDON                           0232
*           OUTBUF2(47:48)=CULOOKUP(I);/*                    @YM31085*/
         LH    @10,I                                               0233
         ALR   @10,@10                                             0233
         LA    @05,CULOOKUP-2(@10)                                 0233
         MVC   OUTBUF2+46(2,R4),0(@05)                             0233
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0234
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0236
*         ;                         /*                       @Y30LB12*/
@RF00228 DS    0H                                                  0237
*     ELSE                                                         0237
*       ;                           /*                       @Y30LB12*/
@RF00227 DS    0H                                                  0238
*     IF HAVECUID(I)='1'B           /*                       @YM31085*/
*         &HAVEMSF(I)='0'B          /*                       @YM31085*/
*       THEN                        /*                       @YM31085*/
         LH    @10,I                                               0238
         LR    @05,@10                                             0238
         ALR   @05,@05                                             0238
         LA    @01,HAVECUID-2(@05)                                 0238
         TM    0(@01),B'10000000'                                  0238
         BNO   @RF00238                                            0238
         LA    @01,HAVEMSF-1(@10)                                  0238
         TM    0(@01),B'10000000'                                  0238
         BNZ   @RF00238                                            0238
*       DO;                         /*                       @YM31085*/
*                                                                  0239
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @YM31085*/
*         /* ICG241I MISSING REQUIRED PARAMETER MSFX         @YM31085*/
*         /* FOR CUXX                                        @YM31085*/
*         /* *****************************************       @YM31085*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0240
*         OUTBUF2(1:36)=ICGDS241;   /*                       @YM31085*/
         MVC   OUTBUF2(36,R4),ICGDS241                             0240
*         OUTBUF2(37:40)='MSFX';    /*                       @YM31085*/
         MVC   OUTBUF2+36(4,R4),@CC00458                           0241
*         OUTBUF2(41:47)=MSGADDON;  /*                       @YM31085*/
         MVC   OUTBUF2+40(7,R4),MSGADDON                           0242
*         OUTBUF2(48:49)=CULOOKUP(I);/*                      @YM31085*/
         LA    @10,CULOOKUP-2(@05)                                 0243
         MVC   OUTBUF2+47(2,R4),0(@10)                             0243
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @YM31085*/
         BAL   @14,PUTIT1                                          0244
*       END;                        /*                       @YM31085*/
*     ELSE                                                         0246
*       ;                           /*                       @YM31085*/
@RF00238 DS    0H                                                  0247
*     IF HAVECUID(I)='1'B           /*                       @YM31085*/
*         &HAVEDRC(I)='0'B          /*                       @YM31085*/
*       THEN                        /*                       @YM31085*/
         LH    @10,I                                               0247
         LR    @05,@10                                             0247
         ALR   @05,@05                                             0247
         LA    @01,HAVECUID-2(@05)                                 0247
         TM    0(@01),B'10000000'                                  0247
         BNO   @RF00247                                            0247
         LA    @01,HAVEDRC-1(@10)                                  0247
         TM    0(@01),B'01000000'                                  0247
         BNZ   @RF00247                                            0247
*       DO;                         /*                       @YM31085*/
*                                                                  0248
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @YM31085*/
*         /* ICG241I MISSING REQUIRED PARAMETER DRCX         @YM31085*/
*         /* FOR CUXX                                        @YM31085*/
*         /* *****************************************       @YM31085*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0249
*         OUTBUF2(1:36)=ICGDS241;   /*                       @YM31085*/
         MVC   OUTBUF2(36,R4),ICGDS241                             0249
*         OUTBUF2(37:40)='DRCX';    /*                       @YM31085*/
         MVC   OUTBUF2+36(4,R4),@CC00454                           0250
*         OUTBUF2(41:47)=MSGADDON;  /*                       @YM31085*/
         MVC   OUTBUF2+40(7,R4),MSGADDON                           0251
*         OUTBUF2(48:49)=CULOOKUP(I);/*                      @YM31085*/
         LA    @10,CULOOKUP-2(@05)                                 0252
         MVC   OUTBUF2+47(2,R4),0(@10)                             0252
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @YM31085*/
         BAL   @14,PUTIT1                                          0253
*       END;                        /*                       @YM31085*/
*     ELSE                                                         0255
*       ;                           /*                       @YM31085*/
@RF00247 DS    0H                                                  0256
*   END;                            /* DID ALL 4             @Y30LB12*/
         LA    @10,1                                               0256
         AH    @10,I                                               0256
         STH   @10,I                                               0256
         CH    @10,@CH00068                                        0256
         BNH   @DL00214                                            0256
*   IF HAVEDS^='1'B                 /* NO DS KEYWORD         @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HAVEDS,B'10000000'                                  0257
         BO    @RF00257                                            0257
*     DO;                           /*                       @Y30LB12*/
*                                                                  0258
*       /*************************************************************/
*       /*                                                           */
*       /* ***************************************           @Y30LB12*/
*       /* ICG221I MISSING REQUIRED KEYWORD SA               @Y30LB12*/
*       /* ***************************************           @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0259
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0259
*       OUTBUF2(35:36)='SA';        /*                       @Y30LB12*/
         MVC   OUTBUF2+34(2,R4),@CC00412                           0260
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0261
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0263
*     ;                             /*                       @Y30LB12*/
@RF00257 DS    0H                                                  0264
*   IF CUSPEC^='1'B                 /* NO CUXX KEYWORD       @YM31062*/
*     THEN                          /*                       @YM31062*/
         TM    CUSPEC,B'01000000'                                  0264
         BO    @RF00264                                            0264
*     DO;                           /*                       @YM31062*/
*                                                                  0265
*       /*************************************************************/
*       /*                                                           */
*       /* ***************************************           @YM31062*/
*       /* ICG221I MISSING REQUIRED KEYWORD CUXX             @YM31062*/
*       /* ***************************************           @YM31062*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0266
*       OUTBUF2(1:34)=ICGDS221;     /*                       @YM31062*/
         MVC   OUTBUF2(34,R4),ICGDS221                             0266
*       OUTBUF2(35:38)='CUXX';      /*                       @YM31062*/
         MVC   OUTBUF2+34(4,R4),@CC00461                           0267
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @YM31062*/
         BAL   @14,PUTIT1                                          0268
*     END;                          /*                       @YM31062*/
*   ELSE                                                           0270
*     ;                             /*                       @YM31062*/
@RF00264 DS    0H                                                  0271
*   END S05ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/
@EL00010 DS    0H                                                  0271
@EF00010 DS    0H                                                  0271
@ER00010 LM    @14,@12,@SA00010                                    0271
         BR    @14                                                 0271
*                                                                  0272
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - S05BUILD                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK TO BE SURE THAT THE CONTROL UNIT        @Y30LB12*/
*/*            IDENTIFICATION FROM THE DATA STAGER HAS NOT   @Y30LB12*/
*/*            BEEN USED PREVIOUSLY.  IF PREVIOUSLY USED,    @Y30LB12*/
*/*            WRITE MESSAGE ICG233I.  IF NOT USED YET, SET  @YM31085*/
*/*            USED FLAG AND CALL FINDSLOT TO CHECK TO SEE   @Y30LB12*/
*/*            THAT THERE IS A MATCHING FREE CONTROL UNIT    @Y30LB12*/
*/*            POSITION IN THE LIBRARY.                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0272
*S05BUILD:                                                         0272
*   PROCEDURE;                      /*                       @Y30LB12*/
S05BUILD STM   @14,@12,@SA00011                                    0272
*   DO I=1 TO MAXCU;                /* EACH POSITION         @YM31085*/
         LA    @10,1                                               0273
         STH   @10,I                                               0273
@DL00273 DS    0H                                                  0274
*     IF HAVECUID(I)='1'B           /* SPECIFIED HERE        @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @05,@10                                             0274
         ALR   @05,@05                                             0274
         LA    @01,HAVECUID-2(@05)                                 0274
         TM    0(@01),B'10000000'                                  0274
         BNO   @RF00274                                            0274
*       DO;                         /*                       @Y30LB12*/
*         IF LOWSPEC(DSINDEX,I)='1'B/* SPEC BEFORE           @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         LH    @15,DSINDEX                                         0276
         SLA   @15,2                                               0276
         ALR   @15,@10                                             0276
         ALR   @15,@15                                             0276
         ALR   @15,R4                                              0276
         TM    LOWSPEC-10(@15),B'10000000'                         0276
         BNO   @RF00276                                            0276
*           DO;                     /*                       @Y30LB12*/
*                                                                  0277
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @Y30LB12*/
*             /* ICG233I CONTROL UNIT XX                     @Y30LB12*/
*             /* PREVIOUSLY SPECIFIED                        @Y30LB12*/
*             /* ***********************************         @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0278
*             OUTBUF2(1:46)=ICGDS233;/*                      @Y30LB12*/
         MVC   OUTBUF2(46,R4),ICGDS233                             0278
*             OUTBUF2(23:24)=CULOOKUP(I);/*                  @YM31085*/
         LA    @10,CULOOKUP-2(@05)                                 0279
         MVC   OUTBUF2+22(2,R4),0(@10)                             0279
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0280
*           END;                    /*                       @Y30LB12*/
*         ELSE                      /*                       @Y30LB12*/
*           DO;                     /*                       @Y30LB12*/
         B     @RC00276                                            0282
@RF00276 DS    0H                                                  0283
*             CALL FINDSLOT;        /* TO LOCATE LIB CU      @Y30LB12*/
         BAL   @14,FINDSLOT                                        0283
*             IF STOPSCAN^='1'B     /* IF NO ERROR           @Y30LB12*/
*               THEN                /*                       @Y30LB12*/
         TM    STOPSCAN,B'10000000'                                0284
         BO    @RF00284                                            0284
*               DO;                 /*                       @YM32160*/
*                 IF HAVECUID(I)='1'B/*                      @YM32160*/
*                   THEN            /*                       @YM32160*/
         LH    @10,I                                               0286
         LR    @05,@10                                             0286
         ALR   @05,@05                                             0286
         LA    @01,HAVECUID-2(@05)                                 0286
         TM    0(@01),B'10000000'                                  0286
         BNO   @RF00286                                            0286
*                   LOWSPEC(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0287
         SLA   @05,2                                               0287
         ALR   @05,@10                                             0287
         ALR   @05,@05                                             0287
         ALR   @05,R4                                              0287
         OI    LOWSPEC-10(@05),B'10000000'                         0287
*                 IF RDWR01(I)='1'B /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00286 LH    @10,I                                               0288
         LR    @05,@10                                             0288
         ALR   @05,@05                                             0288
         LA    @01,RDWR01-2(@05)                                   0288
         TM    0(@01),B'01000000'                                  0288
         BNO   @RF00288                                            0288
*                   LOWRW01(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0289
         SLA   @05,2                                               0289
         ALR   @05,@10                                             0289
         ALR   @05,@05                                             0289
         ALR   @05,R4                                              0289
         OI    LOWRW01-10(@05),B'01000000'                         0289
*                 IF RDWR23(I)='1'B /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00288 LH    @10,I                                               0290
         LR    @05,@10                                             0290
         ALR   @05,@05                                             0290
         LA    @01,RDWR23-2(@05)                                   0290
         TM    0(@01),B'00100000'                                  0290
         BNO   @RF00290                                            0290
*                   LOWRW23(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0291
         SLA   @05,2                                               0291
         ALR   @05,@10                                             0291
         ALR   @05,@05                                             0291
         ALR   @05,R4                                              0291
         OI    LOWRW23-10(@05),B'00100000'                         0291
*                 IF RDWR45(I)='1'B /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00290 LH    @10,I                                               0292
         LR    @05,@10                                             0292
         ALR   @05,@05                                             0292
         LA    @01,RDWR45-2(@05)                                   0292
         TM    0(@01),B'00010000'                                  0292
         BNO   @RF00292                                            0292
*                   LOWRW45(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0293
         SLA   @05,2                                               0293
         ALR   @05,@10                                             0293
         ALR   @05,@05                                             0293
         ALR   @05,R4                                              0293
         OI    LOWRW45-10(@05),B'00010000'                         0293
*                 IF RDWR67(I)='1'B /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00292 LH    @10,I                                               0294
         LR    @05,@10                                             0294
         ALR   @05,@05                                             0294
         LA    @01,RDWR67-2(@05)                                   0294
         TM    0(@01),B'00001000'                                  0294
         BNO   @RF00294                                            0294
*                   LOWRW67(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0295
         SLA   @05,2                                               0295
         ALR   @05,@10                                             0295
         ALR   @05,@05                                             0295
         ALR   @05,R4                                              0295
         OI    LOWRW67-10(@05),B'00001000'                         0295
*                 IF LEFT(I)='1'B   /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00294 LH    @10,I                                               0296
         LR    @05,@10                                             0296
         ALR   @05,@05                                             0296
         LA    @01,LEFT-2(@05)                                     0296
         TM    0(@01),B'00000100'                                  0296
         BNO   @RF00296                                            0296
*                   LOWLEFT(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0297
         SLA   @05,2                                               0297
         ALR   @05,@10                                             0297
         ALR   @05,@05                                             0297
         ALR   @05,R4                                              0297
         OI    LOWLEFT-10(@05),B'00000100'                         0297
*                 IF RIGHT(I)='1'B  /*                       @YM32160*/
*                   THEN            /*                       @YM32160*/
@RF00296 LH    @10,I                                               0298
         LR    @05,@10                                             0298
         ALR   @05,@05                                             0298
         LA    @01,RIGHT-2(@05)                                    0298
         TM    0(@01),B'00000010'                                  0298
         BNO   @RF00298                                            0298
*                   LOWRGHT(DSINDEX,I)='1'B;/*               @YM32160*/
         LH    @05,DSINDEX                                         0299
         SLA   @05,2                                               0299
         ALR   @05,@10                                             0299
         ALR   @05,@05                                             0299
         ALR   @05,R4                                              0299
         OI    LOWRGHT-10(@05),B'00000010'                         0299
*                 LOWLIB(DSINDEX,I)=WORKLIB(I);/*            @YM32160*/
@RF00298 LH    @10,I                                               0300
         LH    @05,DSINDEX                                         0300
         SLA   @05,2                                               0300
         ALR   @05,@10                                             0300
         ALR   @05,@05                                             0300
         ALR   @05,R4                                              0300
         ALR   @10,@10                                             0300
         LA    @01,WORKLIB-2(@10)                                  0300
         MVC   LOWLIB-10(1,@05),0(@01)                             0300
*               END;                /*                       @YM32160*/
*             ELSE                                                 0302
*               ;                   /*                       @Y30LB12*/
@RF00284 DS    0H                                                  0303
*           END;                    /*                       @Y30LB12*/
*       END;                        /*                       @Y30LB12*/
*     ELSE                                                         0305
*       ;                           /*                       @Y30LB12*/
@RF00274 DS    0H                                                  0306
*   END;                            /* END OF DO I           @Y30LB12*/
@RC00274 LA    @10,1                                               0306
         AH    @10,I                                               0306
         STH   @10,I                                               0306
         CH    @10,@CH00068                                        0306
         BNH   @DL00273                                            0306
*   END S05BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/
@EL00011 DS    0H                                                  0307
@EF00011 DS    0H                                                  0307
@ER00011 LM    @14,@12,@SA00011                                    0307
         BR    @14                                                 0307
*                                                                  0308
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - FINDSLOT                                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CHECK THE READ/WRITE CONTROLLER POSITION TO   @Y30LB12*/
*/*            ASSIGN TO THIS DATA STAGER CONTROL UNIT       @Y30LB12*/
*/*            INTERFACE.  IF LEFT-HAND INTERFACE FREE, USE  @Y30LB12*/
*/*            IT.  IF LEFT INTERFACE NOT FREE, USE RIGHT-   @Y30LB12*/
*/*            HAND INTERFACE, IF IT IS FREE.  IF BOTH       @Y30LB12*/
*/*            INTERFACES ALREADY IN USE, WRITE MESSAGE      @Y30LB12*/
*/*            ICG231I.                                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0308
*FINDSLOT:                                                         0308
*   PROCEDURE;                      /*                       @Y30LB12*/
FINDSLOT STM   @14,@12,@SA00012                                    0308
*   HEXCHAR=WORKLIB(I);             /*                       @Y30LB12*/
         LH    @10,I                                               0309
         ALR   @10,@10                                             0309
         LA    @05,WORKLIB-2(@10)                                  0309
         MVC   HEXCHAR(1),0(@05)                                   0309
*   HIGHHEX='0000'B;                /*                       @Y30LB12*/
         NI    HIGHHEX,B'00001111'                                 0310
*   HEXINDEX=HEXCHAR+1;             /*                       @Y30LB12*/
         LA    @05,1                                               0311
         MVC   @ZT00003+3(1),HEXCHAR                               0311
         AL    @05,@ZT00003                                        0311
         STH   @05,HEXINDEX                                        0311
*   IF RDWR01(I)='1'B               /* FOR READ/WRITE 01     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         LA    @01,RDWR01-2(@10)                                   0312
         TM    0(@01),B'01000000'                                  0312
         BNO   @RF00312                                            0312
*     IF RW01LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         ALR   @05,R4                                              0313
         TM    RW01LEFT-1(@05),B'10000000'                         0313
         BO    @RF00313                                            0313
*       DO;                         /*                       @Y30LB12*/
*         RW01LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/
         LH    @05,HEXINDEX                                        0315
         ALR   @05,R4                                              0315
         OI    RW01LEFT-1(@05),B'10000000'                         0315
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/
         LA    @05,LEFT-2(@10)                                     0316
         OI    0(@05),B'00000100'                                  0316
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       IF RW01RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00313                                            0318
@RF00313 LH    @10,HEXINDEX                                        0318
         ALR   @10,R4                                              0318
         TM    RW01RGHT-1(@10),B'01000000'                         0318
         BO    @RF00318                                            0318
*         DO;                       /*                       @Y30LB12*/
*           RW01RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/
         LH    @10,HEXINDEX                                        0320
         ALR   @10,R4                                              0320
         OI    RW01RGHT-1(@10),B'01000000'                         0320
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/
         LH    @10,I                                               0321
         ALR   @10,@10                                             0321
         LA    @05,RIGHT-2(@10)                                    0321
         OI    0(@05),B'00000010'                                  0321
*         END;                      /*                       @Y30LB12*/
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  0323
         B     @RC00318                                            0323
@RF00318 DS    0H                                                  0324
*           /*********************************************************/
*           /*                                                       */
*           /* ***********************************           @Y30LB12*/
*           /* ICG231I BOTH DRC0 CONTROLLER                  @Y30LB12*/
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/
*           /* ***********************************           @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0324
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/
         MVC   OUTBUF2(55,R4),ICGDS231                             0324
*           OUTBUF2(15:18)='DRC0';  /*                       @Y30LB12*/
         MVC   OUTBUF2+14(4,R4),@CC00471                           0325
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0326
*         END;                      /*                       @Y30LB12*/
*   IF RDWR23(I)='1'B               /* FOR READ/WRITE 23     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00318 DS    0H                                                  0328
@RC00313 DS    0H                                                  0328
@RF00312 LH    @10,I                                               0328
         ALR   @10,@10                                             0328
         LA    @05,RDWR23-2(@10)                                   0328
         TM    0(@05),B'00100000'                                  0328
         BNO   @RF00328                                            0328
*     IF RW23LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LH    @05,HEXINDEX                                        0329
         ALR   @05,R4                                              0329
         TM    RW23LEFT-1(@05),B'00100000'                         0329
         BO    @RF00329                                            0329
*       DO;                         /*                       @Y30LB12*/
*         RW23LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/
         LH    @05,HEXINDEX                                        0331
         ALR   @05,R4                                              0331
         OI    RW23LEFT-1(@05),B'00100000'                         0331
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/
         LA    @05,LEFT-2(@10)                                     0332
         OI    0(@05),B'00000100'                                  0332
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       IF RW23RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00329                                            0334
@RF00329 LH    @10,HEXINDEX                                        0334
         ALR   @10,R4                                              0334
         TM    RW23RGHT-1(@10),B'00010000'                         0334
         BO    @RF00334                                            0334
*         DO;                       /*                       @Y30LB12*/
*           RW23RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/
         LH    @10,HEXINDEX                                        0336
         ALR   @10,R4                                              0336
         OI    RW23RGHT-1(@10),B'00010000'                         0336
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/
         LH    @10,I                                               0337
         ALR   @10,@10                                             0337
         LA    @05,RIGHT-2(@10)                                    0337
         OI    0(@05),B'00000010'                                  0337
*         END;                      /*                       @Y30LB12*/
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  0339
         B     @RC00334                                            0339
@RF00334 DS    0H                                                  0340
*           /*********************************************************/
*           /*                                                       */
*           /* *********************************             @Y30LB12*/
*           /* ICG231I BOTH DRC1 CONTROLLER                  @Y30LB12*/
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/
*           /* *********************************             @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0340
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/
         MVC   OUTBUF2(55,R4),ICGDS231                             0340
*           OUTBUF2(15:18)='DRC1';  /*                       @Y30LB12*/
         MVC   OUTBUF2+14(4,R4),@CC00472                           0341
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0342
*         END;                      /*                       @Y30LB12*/
*   IF RDWR45(I)='1'B               /* FOR READ/WRITE 45     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00334 DS    0H                                                  0344
@RC00329 DS    0H                                                  0344
@RF00328 LH    @10,I                                               0344
         ALR   @10,@10                                             0344
         LA    @05,RDWR45-2(@10)                                   0344
         TM    0(@05),B'00010000'                                  0344
         BNO   @RF00344                                            0344
*     IF RW45LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LH    @05,HEXINDEX                                        0345
         ALR   @05,R4                                              0345
         TM    RW45LEFT-1(@05),B'00001000'                         0345
         BO    @RF00345                                            0345
*       DO;                         /*                       @Y30LB12*/
*         RW45LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/
         LH    @05,HEXINDEX                                        0347
         ALR   @05,R4                                              0347
         OI    RW45LEFT-1(@05),B'00001000'                         0347
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/
         LA    @05,LEFT-2(@10)                                     0348
         OI    0(@05),B'00000100'                                  0348
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       IF RW45RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00345                                            0350
@RF00345 LH    @10,HEXINDEX                                        0350
         ALR   @10,R4                                              0350
         TM    RW45RGHT-1(@10),B'00000100'                         0350
         BO    @RF00350                                            0350
*         DO;                       /*                       @Y30LB12*/
*           RW45RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/
         LH    @10,HEXINDEX                                        0352
         ALR   @10,R4                                              0352
         OI    RW45RGHT-1(@10),B'00000100'                         0352
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/
         LH    @10,I                                               0353
         ALR   @10,@10                                             0353
         LA    @05,RIGHT-2(@10)                                    0353
         OI    0(@05),B'00000010'                                  0353
*         END;                      /*                       @Y30LB12*/
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  0355
         B     @RC00350                                            0355
@RF00350 DS    0H                                                  0356
*           /*********************************************************/
*           /*                                                       */
*           /* *********************************             @Y30LB12*/
*           /* ICG231I BOTH DRC2 CONTROLLER                  @Y30LB12*/
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/
*           /* *********************************             @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0356
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/
         MVC   OUTBUF2(55,R4),ICGDS231                             0356
*           OUTBUF2(15:18)='DRC2';  /*                       @Y30LB12*/
         MVC   OUTBUF2+14(4,R4),@CC00473                           0357
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0358
*         END;                      /*                       @Y30LB12*/
*   IF RDWR67(I)='1'B               /* FOR READ/WRITE 67     @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00350 DS    0H                                                  0360
@RC00345 DS    0H                                                  0360
@RF00344 LH    @10,I                                               0360
         ALR   @10,@10                                             0360
         LA    @05,RDWR67-2(@10)                                   0360
         TM    0(@05),B'00001000'                                  0360
         BNO   @RF00360                                            0360
*     IF RW67LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LH    @05,HEXINDEX                                        0361
         ALR   @05,R4                                              0361
         TM    RW67LEFT-1(@05),B'00000010'                         0361
         BO    @RF00361                                            0361
*       DO;                         /*                       @Y30LB12*/
*         RW67LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/
         LH    @05,HEXINDEX                                        0363
         ALR   @05,R4                                              0363
         OI    RW67LEFT-1(@05),B'00000010'                         0363
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/
         LA    @05,LEFT-2(@10)                                     0364
         OI    0(@05),B'00000100'                                  0364
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /*                       @Y30LB12*/
*       IF RW67RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00361                                            0366
@RF00361 LH    @10,HEXINDEX                                        0366
         ALR   @10,R4                                              0366
         TM    RW67RGHT-1(@10),B'00000001'                         0366
         BO    @RF00366                                            0366
*         DO;                       /*                       @Y30LB12*/
*           RW67RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/
         LH    @10,HEXINDEX                                        0368
         ALR   @10,R4                                              0368
         OI    RW67RGHT-1(@10),B'00000001'                         0368
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/
         LH    @10,I                                               0369
         ALR   @10,@10                                             0369
         LA    @05,RIGHT-2(@10)                                    0369
         OI    0(@05),B'00000010'                                  0369
*         END;                      /*                       @Y30LB12*/
*       ELSE                        /*                       @Y30LB12*/
*         DO;                       /*                       @Y30LB12*/
*                                                                  0371
         B     @RC00366                                            0371
@RF00366 DS    0H                                                  0372
*           /*********************************************************/
*           /*                                                       */
*           /* *********************************             @Y30LB12*/
*           /* IDG231I BOTH DRC3 CONTROLLER                  @Y30LB12*/
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/
*           /* *********************************             @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0372
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/
         MVC   OUTBUF2(55,R4),ICGDS231                             0372
*           OUTBUF2(15:18)='DRC3';  /*                       @Y30LB12*/
         MVC   OUTBUF2+14(4,R4),@CC00474                           0373
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0374
*         END;                      /*                       @Y30LB12*/
*   END FINDSLOT;                   /* RET. TO S05BUILD      @Y30LB12*/
@EL00012 DS    0H                                                  0376
@EF00012 DS    0H                                                  0376
@ER00012 LM    @14,@12,@SA00012                                    0376
         BR    @14                                                 0376
*                                                                  0377
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVHEX                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/
*/*            CHARACTER REPRESENTATION OF A SINGLE HEX      @Y30LB12*/
*/*            CHARACTER IN 'HEXCHAR'.  IF THE DATA          @Y30LB12*/
*/*            REPRESENTS A VALID HEXADECIMAL CHARACTER,     @Y30LB12*/
*/*            IT IS CONVERTED TO BINARY IN 'HEXCHAR' AND    @Y30LB12*/
*/*            'HEXINDEX' IS SET TO THE VALUE OF HEXCHAR+1   @Y30LB12*/
*/*            IF THE CHARACTER IN 'HEXCHAR' IS NOT A VALUE  @YD00113*/
*/*            BETWEEN 0 THRU 9 OR 'A' THRU 'F', ISSUE ERROR @YD00113*/
*/*            MESSAGE ICG227I.                              @YD00113*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0377
*CONVHEX:                                                          0377
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVHEX  STM   @14,@12,@SA00013                                    0377
*   HEXINDEX=0;                     /* INIT HEXINDEX         @Y30LB12*/
         SLR   @10,@10                                             0378
         STH   @10,HEXINDEX                                        0378
*   IF HIGHHEX='1100'B              /* IF CHAR A-F           @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    HIGHHEX,B'11000000'                                 0379
         BNO   @RF00379                                            0379
         TM    HIGHHEX,B'00110000'                                 0379
         BNZ   @RF00379                                            0379
*     DO;                           /*                       @Y30LB12*/
*       HIGHHEX='0000'B;                                           0381
         NI    HIGHHEX,B'00001111'                                 0381
*       ;                           /* ZERO ZONE PART        @Y30LB12*/
*       HEXCHAR=HEXCHAR+9;          /* ADD 9 TO DIGIT        @Y30LB12*/
         LA    @10,9                                               0383
         MVC   @ZT00003+3(1),HEXCHAR                               0383
         AL    @10,@ZT00003                                        0383
         STC   @10,HEXCHAR                                         0383
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     IF HIGHHEX='1111'B            /* IF CHAR 0-9           @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         B     @RC00379                                            0385
@RF00379 TM    HIGHHEX,B'11110000'                                 0385
         BNO   @RF00385                                            0385
*       HIGHHEX='0000'B;            /* ZERO ZONE PART        @YD00113*/
         NI    HIGHHEX,B'00001111'                                 0386
*     ELSE                                                         0387
*       ;                           /*                       @Y30LB12*/
@RF00385 DS    0H                                                  0388
*   IF HIGHHEX^='0000'B             /* IF ZONE NOT ZERO      @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
@RC00379 TM    HIGHHEX,B'11110000'                                 0388
         BZ    @RF00388                                            0388
*     DO;                           /*                       @Y30LB12*/
*                                                                  0389
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG227I PARAMETER MUST BE HEXADECIMAL,            @Y30LB12*/
*       /* KEYWORD IS (SA)                                   @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       OUTBUF2(1:51)=ICGDS227;     /*                       @Y30LB12*/
         MVC   OUTBUF2(51,R4),ICGDS227                             0390
*       OUTBUF2(52:59)=PLUGIN;      /*                       @Y30LB12*/
         MVC   OUTBUF2+51(8,R4),PLUGIN                             0391
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0392
*     END;                          /*                       @Y30LB12*/
*   ELSE                            /*                       @Y30LB12*/
*     HEXINDEX=HEXCHAR+1;           /* RETURN VALUE          @Y30LB12*/
         B     @RC00388                                            0394
@RF00388 LA    @10,1                                               0394
         MVC   @ZT00003+3(1),HEXCHAR                               0394
         AL    @10,@ZT00003                                        0394
         STH   @10,HEXINDEX                                        0394
*   END CONVHEX;                                                   0395
@EL00013 DS    0H                                                  0395
@EF00013 DS    0H                                                  0395
@ER00013 LM    @14,@12,@SA00013                                    0395
         BR    @14                                                 0395
*                                                                  0396
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - CONVBIN                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/
*/*            CHARACTER REPRESENTATION OF TWO BINARY BITS   @Y30LB12*/
*/*            IN 'BINCHAR'.  IF THE CHARACTERS REPRESENT    @Y30LB12*/
*/*            TWO VALID BINARY BITS, 'BININDEX' IS SET TO   @Y30LB12*/
*/*            A HALFWORD EQUAL TO THE VALUE OF BINCHAR+1.   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0396
*CONVBIN:                                                          0396
*   PROCEDURE;                      /*                       @Y30LB12*/
CONVBIN  STM   @14,@12,12(@13)                                     0396
*   BININDEX=0;                     /* INIT BININDEX         @Y30LB12*/
*                                                                  0397
         SLR   @10,@10                                             0397
         STH   @10,BININDEX                                        0397
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YM31085*/
*   /* OBTAIN IN BININDEX THE BINARY EQUIVALENT + 1          @YM31085*/
*   /* OF THE CHARACTER REPRESENTATION OF TWO BINARY         @YM31085*/
*   /* BITS.                                                 @YM31085*/
*   /* ***********************************************       @YM31085*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*   DO I=1 TO MAXCU;                /* 4 POSSIBILITIES       @YM31085*/
         LA    @10,1                                               0398
         STH   @10,I                                               0398
@DL00398 DS    0H                                                  0399
*     IF BINCHAR=CULOOKUP(I)        /* IF MATCH              @YM31085*/
*       THEN                        /*                       @YM31085*/
         LR    @05,@10                                             0399
         ALR   @05,@05                                             0399
         LA    @01,CULOOKUP-2(@05)                                 0399
         CLC   BINCHAR(2),0(@01)                                   0399
         BNE   @RF00399                                            0399
*       BININDEX=I;                 /* I = 1, 2, 3, OR 4     @YM31085*/
         STH   @10,BININDEX                                        0400
*     ELSE                                                         0401
*       ;                           /*                       @YM31085*/
@RF00399 DS    0H                                                  0402
*   END;                            /*                       @YM31085*/
         LA    @10,1                                               0402
         AH    @10,I                                               0402
         STH   @10,I                                               0402
         CH    @10,@CH00068                                        0402
         BNH   @DL00398                                            0402
*   END CONVBIN;                    /* RET. TO S05CUID       @Y30LB12*/
@EL00014 DS    0H                                                  0403
@EF00014 DS    0H                                                  0403
@ER00014 LM    @14,@12,12(@13)                                     0403
         BR    @14                                                 0403
*                                                                  0404
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0404
*READS99:                                                          0404
*   PROCEDURE;                      /*                       @Y30LB12*/
READS99  STM   @14,@12,@SA00015                                    0404
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */
*                                                                  0405
         LINK EP=ICGDSS99
*   /*****************************************************************/
*   /*                                                               */
*   /* ************************************************@Y30LB12 IF   */
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/
*   /* KEYWORD.                                              @Y30LB12*/
*   /* ************************************************@Y30LB12      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0406
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    ENDSCAN(R4),B'00010000'                             0406
         BNO   @RF00406                                            0406
*     LASTPARM='1'B;                /*                       @Y30LB12*/
         OI    LASTPARM(R4),B'00001000'                            0407
*   ELSE                                                           0408
*     ;                             /*                       @Y30LB12*/
@RF00406 DS    0H                                                  0409
*   END READS99;                    /*                       @Y30LB12*/
@EL00015 DS    0H                                                  0409
@EF00015 DS    0H                                                  0409
@ER00015 LM    @14,@12,@SA00015                                    0409
         BR    @14                                                 0409
*                                                                  0410
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0410
*PUTIT1:                                                           0410
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT1   STM   @14,@12,@SA00016                                    0410
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'10000000'                                0411
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            0412
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0413
         AH    @10,TERMINAT(,R4)                                   0413
         STH   @10,TERMINAT(,R4)                                   0413
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            0415
*   END PUTIT1;                     /*                       @Y30LB12*/
@EL00016 DS    0H                                                  0416
@EF00016 DS    0H                                                  0416
@ER00016 LM    @14,@12,@SA00016                                    0416
         BR    @14                                                 0416
*                                                                  0417
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0417
*PUTIT2:                                                           0417
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT2   STM   @14,@12,@SA00017                                    0417
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'10000000'                                0418
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0419
         AH    @10,TERMINAT(,R4)                                   0419
         STH   @10,TERMINAT(,R4)                                   0419
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   END PUTIT2;                     /*                       @Y30LB12*/
@EL00017 DS    0H                                                  0421
@EF00017 DS    0H                                                  0421
@ER00017 LM    @14,@12,@SA00017                                    0421
         BR    @14                                                 0421
*                                                                  0422
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*                    P A T C H   A R E A                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0422
*   GENERATE;                                                      0422
*                                                         /*@Y30LB12*/
PATCHS05 DC    32C'PATCHS05'                              /*@Y30LB12*/
*   END ICGDSS05                    /*                       @Y30LB12*/
*                                                                  0423
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */
*                                                                  0423
*       ;                                                          0423
         B     @EL00001                                            0423
@DATA    DS    0H
@CH00042 DC    H'1'
@CH00068 DC    H'4'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00003 DS    15F
@SA00010 DS    15F
@SA00011 DS    15F
@SA00015 DS    15F
@SA00017 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00009 DS    15F
@SA00016 DS    15F
@SA00013 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00012 DS    15F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSS05 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
LOWWORKA DS    CL37
         ORG   LOWWORKA
I        DS    FL2
BININDEX DS    FL2
HEXINDEX DS    FL2
DSINDEX  DS    FL2
CUINDEX  DS    FL2
CUIDS    DS    CL2
         ORG   CUIDS+0
CUID     DS    CL2
         ORG   CUID+0
FLAGS    DS    BL1
         ORG   FLAGS+0
HAVECUID DS    BL1
RDWRS    EQU   FLAGS+0
         ORG   RDWRS+0
RDWR01   EQU   RDWRS+0
RDWR23   EQU   RDWRS+0
RDWR45   EQU   RDWRS+0
RDWR67   EQU   RDWRS+0
         ORG   FLAGS+0
LEFT     EQU   FLAGS+0
RIGHT    EQU   FLAGS+0
@NM00020 EQU   FLAGS+0
         ORG   CUID+1
WORKLIB  DS    CL1
         ORG   WORKLIB+0
ONEBITS  DS    BL1
ZEROBITS EQU   WORKLIB+0
DONTCARE EQU   WORKLIB+0
         ORG   LOWWORKA+18
HAVEFLAG DS    BL1
         ORG   HAVEFLAG+0
HAVEMSF  DS    BL1
HAVEDRC  EQU   HAVEFLAG+0
@NM00021 EQU   HAVEFLAG+0
         ORG   LOWWORKA+22
HEXCHAR  DS    CL1
         ORG   HEXCHAR
HIGHHEX  DS    BL1
@NM00022 EQU   HEXCHAR+0
         ORG   LOWWORKA+23
BINCHAR  DS    CL2
SAVECUID DS    CL2
PLUGIN   DS    CL8
HAVES    DS    CL1
         ORG   HAVES
HAVEDS   DS    BL1
CUSPEC   EQU   HAVES+0
@NM00023 EQU   HAVES+0
         ORG   LOWWORKA+36
LOWMSGID DS    CL1
         ORG   LOWMSGID
STOPSCAN DS    BL1
KNOWN    EQU   LOWMSGID+0
KNOWN2   EQU   LOWMSGID+0
ERROR    EQU   LOWMSGID+0
@NM00024 EQU   LOWMSGID+0
         ORG   LOWWORKA+37
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSS05 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ICG209I  DC    H'209'
ICG210I  DC    H'210'
ICG211I  DC    H'211'
ICG212I  DC    H'212'
@CC00415 DC    C'SA      '
@CC00454 DC    C'DRCX'
@CC00458 DC    C'MSFX'
@CC00461 DC    C'CUXX'
@CC00471 DC    C'DRC0'
@CC00472 DC    C'DRC1'
@CC00473 DC    C'DRC2'
@CC00474 DC    C'DRC3'
@CC00402 DC    C'SA='
@CC00428 EQU   @CC00458
@CC00430 EQU   @CC00454
@CC00404 EQU   @CC00461
@CC00412 EQU   @CC00415
@CB00394 DC    X'0000'
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '
ICGDS227 DC    CL51' ICG227I PARAMETER MUST BE HEXADECIMAL. KEYWORD IS C
               '
ICGDS231 DC    CL55' ICG231I BOTH DRCX CONTROLLER INTERFACES ALREADY INC
                USE'
ICGDS233 DC    CL46' ICG233I CONTROL UNIT XX PREVIOUSLY SPECIFIED'
ICGDS234 DC    CL36' ICG234I 2 XXX SPECIFICATIONS FOR CU'
ICGDS235 DC    CL42' ICG235I RANGE ERROR IN SUFFIX OF KEYWORD '
ICGDS236 DC    CL35' ICG236I FORMAT ERROR IN PARAMETER '
ICGDS241 DC    CL36' ICG241I MISSING REQUIRED PARAMETER '
MSGADDON DC    CL7' FOR CU'
CULOOKUP DC    CL2'00'
         DC    CL2'01'
         DC    CL2'10'
         DC    CL2'11'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R4       EQU   @04
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
KEYBIT   EQU   READFLAG
PARMBIT  EQU   READFLAG
ENDSCAN  EQU   READFLAG
LASTPARM EQU   READFLAG
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
SAVESCOL EQU   READER+188
SAVENCOL EQU   READER+192
SCANLEN  EQU   READER+204
PRINTER  EQU   COMTAB+464
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
MSGNO    EQU   MESSAGES+2
TERMINAT EQU   MESSAGES+6
SPECLMSG EQU   MESSAGES+18
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
MERLICEB EQU   PHYSFLGS
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LOWSPEC  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLIB   EQU   LOWDSS+1
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
RW01LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW67RGHT EQU   LIBCTLS
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
ALTPATH1 EQU   CONFGDEV+2
ALTPATH2 EQU   CONFGDEV+5
ALTPATH3 EQU   CONFGDEV+8
SCANDATA EQU   0
SCANBUF  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTCH3   EQU   ALTPATH3+2
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCH2   EQU   ALTPATH2+2
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCH1   EQU   ALTPATH1+2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
INDEXRSG EQU   CONFGDEV+1
ICEBERG  EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
USECONVR EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEV     EQU   USEFLAGS
USESPEC  EQU   USEFLAGS
RSGCUA   EQU   RSGUCB+8
RSGCHAN  EQU   RSGUCB+7
CPUREFNO EQU   RSGUCB+6
RSGCPUID EQU   RSGUCB+1
@NM00019 EQU   RSGFLAGS
CISPEC   EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
@NM00018 EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
@NM00016 EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
PHYSICEB EQU   MERLICEB
PHYSMERL EQU   MERLICEB
PHYSDS2  EQU   DSPAIRS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBDSMID EQU   LIB+2
LIBSIZE  EQU   LIB+1
@NM00009 EQU   LIBBITS
LIBSPEC  EQU   LIBBITS
TODS2    EQU   RSGTODS+1
TODS1    EQU   RSGTODS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
WARNING  EQU   MESSAGES+4
RETCODE  EQU   MESSAGES
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00046 EQU   @EL00003
@RC00112 EQU   @EL00005
@RC00169 EQU   @EL00007
@RC00163 EQU   @EL00007
@RC00186 EQU   @EL00008
@RC00180 EQU   @EL00008
@RC00276 EQU   @RC00274
@RC00366 EQU   @EL00012
@RC00361 EQU   @EL00012
@RF00360 EQU   @EL00012
@RC00388 EQU   @EL00013
@RC00113 EQU   @RC00112
@ENDDATA EQU   *
         END   ICGDSS05,(C'PLS2115',0603,76337)

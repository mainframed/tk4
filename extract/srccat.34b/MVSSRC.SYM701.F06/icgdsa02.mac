         TITLE 'ICGDSA02 MSC TABLE CREATE, ANALYZE MSFX/LOWERCON       *
                        '
ICGDSA02 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSA02  76.335'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                                                  0013
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/*            DEVELOP LOGICAL LIBRARY AS PRINTABLE FOR      @YD00113*/
*/*            POSSIBLE MESSAGE.  CHECK FOR LIBRARY          @Y30LB12*/
*/*            CONTROLLER POSITIONS THAT ARE NOT AVAILABLE   @Y30LB12*/
*/*            FOR THE SIZE LIBRARY SPECIFIED.  IF NO ERROR, @Y30LB12*/
*/*            CHECK FOR CONTROLLER POSITIONS AVAILABLE IN   @Y30LB12*/
*/*            THE LIBRARY BUT NOT USED.  CHECK FOR          @Y30LB12*/
*/*            CONTROLLER POSITIONS SPECIFIED TO A LIBRARY   @Y30LB12*/
*/*            NOT INCLUDED IN THE CONFIGURATION.  CHECK     @Y30LB12*/
*/*            FOR MSF 0 NOT SPECIFIED.                      @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0013
*   DO INDEX=1 TO 4;                /* 4 POSSIBLE LIBIDS     @Y30LB12*/
*                                                                  0013
         LA    INDEX,1                                             0013
@DL00013 DS    0H                                                  0014
*     /***************************************************************/
*     /*                                                             */
*     /* ***********************************************     @Y30LB12*/
*     /* GET LOGICAL LIBRARY NUMBER AS PRINTABLE FOR         @Y30LB12*/
*     /* POSSIBLE ERROR MESSAGES                             @Y30LB12*/
*     /* ***********************************************     @Y30LB12*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0014
*     IF INDEX=1                    /*                       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         CH    INDEX,@CH00042                                      0014
         BNE   @RF00014                                            0014
*       SAVELIB='0';                /*                       @Y30LB12*/
         MVI   SAVELIB,C'0'                                        0015
*     ELSE                          /*                       @Y30LB12*/
*       IF INDEX=2                  /*                       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00014                                            0016
@RF00014 CH    INDEX,@CH00050                                      0016
         BNE   @RF00016                                            0016
*         SAVELIB='1';              /*                       @Y30LB12*/
         MVI   SAVELIB,C'1'                                        0017
*       ELSE                        /*                       @Y30LB12*/
*         IF INDEX=3                /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         B     @RC00016                                            0018
@RF00016 CH    INDEX,@CH00048                                      0018
         BNE   @RF00018                                            0018
*           SAVELIB='2';            /*                       @Y30LB12*/
         MVI   SAVELIB,C'2'                                        0019
*         ELSE                      /*                       @Y30LB12*/
*           IF INDEX=4              /*                       @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         B     @RC00018                                            0020
@RF00018 CH    INDEX,@CH00068                                      0020
         BNE   @RF00020                                            0020
*             SAVELIB='3';          /*                       @Y30LB12*/
         MVI   SAVELIB,C'3'                                        0021
*           ELSE                                                   0022
*             ;                     /*                       @Y30LB12*/
@RF00020 DS    0H                                                  0023
*     ERROR='0'B;                   /* FLAG FOR ICGDS307     @Y30LB12*/
*                                                                  0023
@RC00018 DS    0H                                                  0023
@RC00016 DS    0H                                                  0023
@RC00014 NI    ERROR,B'01111111'                                   0023
*     /***************************************************************/
*     /*                                                             */
*     /* ******************************************          @YD00113*/
*     /* IF LIBRARY IS SPECIFIED, TEST FOR NUMBER OF         @YD00113*/
*     /* OF FRAMES IN THE LIBRARY. IF CONTROLLER DOES        @YD00113*/
*     /* NOT MATCH EXPECTED LIBRARY SIZE, CALL 'MATCH'       @YD00113*/
*     /* SUBROUTINE TO DETERMINE WHICH INTERFACE IS          @YD00113*/
*     /* NOT BEING USED.                                     @YD00113*/
*     /* ******************************************          @YD00113*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0024
*     IF LIBSPEC(INDEX)='1'B        /* IF LIBRARY SPEC       @Y30LB12*/
*       THEN                        /*                       @Y30LB12*/
         LR    @10,INDEX                                           0024
         MH    @10,@CH00128                                        0024
         ST    @10,@TF00001                                        0024
         ALR   @10,R4                                              0024
         TM    LIBSPEC-12(@10),B'10000000'                         0024
         BNO   @RF00024                                            0024
*       DO;                         /*                       @Y30LB12*/
*         WORKCTL=LIBCTLS(INDEX);   /* CONTROLLERS           @Y30LB12*/
         LR    @10,R4                                              0026
         ALR   @10,INDEX                                           0026
         MVC   WORKCTL(1),LIBCTLS-1(@10)                           0026
*         WORKSIZE=LIBSIZE(INDEX);  /* FRAMES IN LIB         @Y30LB12*/
         LR    @10,R4                                              0027
         AL    @10,@TF00001                                        0027
         MVC   WORKSIZE(1),LIBSIZE-12(@10)                         0027
*         IF WORKSIZE='4'           /* 4 FRAMES              @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         CLI   WORKSIZE,C'4'                                       0028
         BNE   @RF00028                                            0028
*           IF WORKCTL(1:8)^='11111111'B/*                   @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         CLI   WORKCTL,B'11111111'                                 0029
         BE    @RF00029                                            0029
*             DO;                   /*                       @Y30LB12*/
*               WANTS='11111111'B;  /*                       @Y30LB12*/
         MVI   WANTS,B'11111111'                                   0031
*               CALL MATCH;         /* SEE WHICH NOT USED    @Y30LB12*/
         BAL   @14,MATCH                                           0032
*             END;                  /*                       @Y30LB12*/
*           ELSE                                                   0034
*             ;                     /*                       @Y30LB12*/
@RF00029 DS    0H                                                  0035
*         ELSE                                                     0035
*           ;                       /*                       @Y30LB12*/
@RF00028 DS    0H                                                  0036
*         IF WORKSIZE='3'           /* 3 FRAMES              @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
         CLI   WORKSIZE,C'3'                                       0036
         BNE   @RF00036                                            0036
*           IF WORKCTL(7:8)^='00'B  /* CAN'T USE             @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         TM    WORKCTL,B'00000011'                                 0037
         BZ    @RF00037                                            0037
*             ERROR='1'B;           /*                       @Y30LB12*/
         OI    ERROR,B'10000000'                                   0038
*           ELSE                    /*                       @Y30LB12*/
*             DO;                   /*                       @Y30LB12*/
         B     @RC00037                                            0039
@RF00037 DS    0H                                                  0040
*               WANTS='11111100'B;  /*                       @Y30LB12*/
         MVI   WANTS,B'11111100'                                   0040
*               CALL MATCH;         /* SEE WHICH NOT USED    @Y30LB12*/
         BAL   @14,MATCH                                           0041
*             END;                  /*                       @Y30LB12*/
*         ELSE                                                     0043
*           ;                       /*                       @Y30LB12*/
@RF00036 DS    0H                                                  0044
*         IF WORKSIZE='2'           /* 2 FRAMES              @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
@RC00036 CLI   WORKSIZE,C'2'                                       0044
         BNE   @RF00044                                            0044
*           IF WORKCTL(5:8)^='0000'B/* CAN'T USE             @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         TM    WORKCTL,B'00001111'                                 0045
         BZ    @RF00045                                            0045
*             ERROR='1'B;           /* FOR MSG ICGDS307      @Y30LB12*/
         OI    ERROR,B'10000000'                                   0046
*           ELSE                    /*                       @Y30LB12*/
*             DO;                   /*                       @Y30LB12*/
         B     @RC00045                                            0047
@RF00045 DS    0H                                                  0048
*               WANTS='11110000'B;  /*                       @Y30LB12*/
         MVI   WANTS,B'11110000'                                   0048
*               CALL MATCH;         /* SEE WHICH NOT USED    @Y30LB12*/
         BAL   @14,MATCH                                           0049
*             END;                  /*                       @Y30LB12*/
*         ELSE                                                     0051
*           ;                       /*                       @Y30LB12*/
@RF00044 DS    0H                                                  0052
*         IF WORKSIZE='1'           /* 1 FRAME               @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
@RC00044 CLI   WORKSIZE,C'1'                                       0052
         BNE   @RF00052                                            0052
*           IF WORKCTL(3:8)^='000000'B/*                     @Y30LB12*/
*             THEN                  /*                       @Y30LB12*/
         TM    WORKCTL,B'00111111'                                 0053
         BZ    @RF00053                                            0053
*             ERROR='1'B;           /* FOR MSG ICGDS307      @Y30LB12*/
         OI    ERROR,B'10000000'                                   0054
*           ELSE                    /*                       @Y30LB12*/
*             DO;                   /*                       @Y30LB12*/
         B     @RC00053                                            0055
@RF00053 DS    0H                                                  0056
*               WANTS='11000000'B;  /*                       @Y30LB12*/
         MVI   WANTS,B'11000000'                                   0056
*               CALL MATCH;         /* SEE WHICH NOT USED    @Y30LB12*/
         BAL   @14,MATCH                                           0057
*             END;                  /*                       @Y30LB12*/
*         ELSE                                                     0059
*           ;                       /*                       @Y30LB12*/
*                                                                  0059
@RF00052 DS    0H                                                  0060
*         /***********************************************************/
*         /*                                                         */
*         /* *****************************************       @Y30LB12*/
*         /* ERROR FLAG SET IF LIBRARY CONTROLLER BIT        @Y30LB12*/
*         /* IS ON FOR A CONTROLLER THAT CANNOT BE IN        @Y30LB12*/
*         /* THE LIBRARY BECAUSE THE FRAME IS NOT IN         @Y30LB12*/
*         /* THE LIBRARY.                                    @Y30LB12*/
*         /* *****************************************       @Y30LB12*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0060
*         IF ERROR='1'B             /*                       @Y30LB12*/
*           THEN                    /*                       @Y30LB12*/
@RC00052 TM    ERROR,B'10000000'                                   0060
         BNO   @RF00060                                            0060
*           DO;                     /*                       @Y30LB12*/
*                                                                  0061
*             /*******************************************************/
*             /*                                                     */
*             /* ***********************************         @Y30LB12*/
*             /* ICG307I SIZE FOR MSFX TOO SMALL             @Y30LB12*/
*             /* FOR SPECIFIED MSF CONTROLLERS               @Y30LB12*/
*             /* ***********************************         @Y30LB12*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0062
*             OUTBUF2(1:62)=ICGDS307;/*                      @Y30LB12*/
         MVC   OUTBUF2(62,R4),ICGDS307                             0062
*             OUTBUF2(22)=SAVELIB;  /*                       @Y30LB12*/
         MVC   OUTBUF2+21(1,R4),SAVELIB                            0063
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0064
*           END;                    /*                       @Y30LB12*/
*         ELSE                                                     0066
*           ;                       /*                       @Y30LB12*/
@RF00060 DS    0H                                                  0067
*       END;                        /*                       @Y30LB12*/
*     ELSE                          /* LIB NOT SPEC'ED       @Y30LB12*/
*       IF LIBCTLS(INDEX)^='00'X    /* BUT CONTROLLERS       @Y30LB12*/
*         THEN                      /*                       @Y30LB12*/
         B     @RC00024                                            0068
@RF00024 LR    @10,R4                                              0068
         ALR   @10,INDEX                                           0068
         CLI   LIBCTLS-1(@10),X'00'                                0068
         BE    @RF00068                                            0068
*         DO;                       /*                       @Y30LB12*/
*                                                                  0069
*           /*********************************************************/
*           /*                                                       */
*           /* *************************************         @Y30LB12*/
*           /* ICG310I MSF X NOT SPECIFIED.                  @Y30LB12*/
*           /* DRC ATTACHMENT INVALID                        @Y30LB12*/
*           /* *************************************         @Y30LB12*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0070
*           OUTBUF2(1:52)=ICGDS310; /*                       @Y30LB12*/
         MVC   OUTBUF2(52,R4),ICGDS310                             0070
*           OUTBUF2(14)=SAVELIB;    /*                       @Y30LB12*/
         MVC   OUTBUF2+13(1,R4),SAVELIB                            0071
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT1                                          0072
*         END;                      /*                       @Y30LB12*/
*       ELSE                                                       0074
*         ;                         /*                       @Y30LB12*/
@RF00068 DS    0H                                                  0075
*   END;                            /* END OF I = 1 TO 4     @Y30LB12*/
@RC00024 AH    INDEX,@CH00042                                      0075
         CH    INDEX,@CH00068                                      0075
         BNH   @DL00013                                            0075
*   IF LIBSPEC(1)^='1'B             /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    LIBSPEC(R4),B'10000000'                             0076
         BO    @RF00076                                            0076
*     DO;                           /*                       @Y30LB12*/
*                                                                  0077
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG335I MSF 0 MUST BE SPECIFIED                   @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0078
*       MSGNO=ICG335I;              /*                       @Y30LB12*/
         MVC   MSGNO(2,R4),ICG335I                                 0078
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/
         BAL   @14,PUTIT2                                          0079
*     END;                                                         0080
*   ELSE                                                           0081
*     ;                                                            0081
@RF00076 DS    0H                                                  0082
*   RETURN;                         /* RET. TO ICGDSANL      @Y30LB12*/
@EL00001 L     @13,4(,@13)                                         0082
@EF00001 L     @00,@SIZDATD                                        0082
         LR    @01,@11                                             0082
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0082
         BR    @14                                                 0082
*                                                                  0083
*/********************************************************** @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - MATCH                                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - THIS PROCEDURE IS CALLED IF THE SIZE OF       @Y30LB12*/
*/*            THE LIBRARY IS COMPATIBLE WITH THE NUMBER     @Y30LB12*/
*/*            OF READ/WRITE CONTROLLERS SPECIFIED TO        @Y30LB12*/
*/*            CHECK TO SEE WHETHER ALL AVAILABLE            @Y30LB12*/
*/*            LIBRARY CONTROLLER INTERFACES HAVE BEEN       @Y30LB12*/
*/*            SPECIFIED.  IF A POSITION IS AVAILABLE BUT    @Y30LB12*/
*/*            NOT SPECIFIED, WARNING MESSAGE 'ICG309I       @YD00113*/
*/*            (1ST/2ND) INTERFACE TO MSF X DRC X IS NOT     @Y30LB12*/
*/*            USED' IS WRITTEN.                             @Y30LB12*/
*/*                                                          @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0083
*MATCH:                                                            0083
*   PROCEDURE;                      /*                       @Y30LB12*/
MATCH    STM   @14,@12,@SA00002                                    0083
*   GEN(XC    WANTS(1),WORKCTL);    /* SET WANTS FLAGS       @Y30LB12*/
         XC    WANTS(1),WORKCTL
*   IF WANTS(1)='1'B                /* TEST FIRST FLAG       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'10000000'                                   0085
         BNO   @RF00085                                            0085
*     DO;                           /*                       @Y30LB12*/
*                                                                  0086
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 1ST INTERFACE TO MSF X DRC 0              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0087
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0087
*       OUTBUF2(10:12)='1ST';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00329                            0088
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0089
*       OUTBUF2(37)='0';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'0'                                 0090
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0091
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0093
*     ;                             /*                       @Y30LB12*/
@RF00085 DS    0H                                                  0094
*   IF WANTS(2)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'01000000'                                   0094
         BNO   @RF00094                                            0094
*     DO;                           /*                       @Y30LB12*/
*                                                                  0095
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 2ND INTERFACE TO MSF X DRC 0              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0096
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0096
*       OUTBUF2(10:12)='2ND';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00332                            0097
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0098
*       OUTBUF2(37)='0';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'0'                                 0099
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0100
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0102
*     ;                             /*                       @Y30LB12*/
@RF00094 DS    0H                                                  0103
*   IF WANTS(3)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00100000'                                   0103
         BNO   @RF00103                                            0103
*     DO;                           /*                       @Y30LB12*/
*                                                                  0104
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I IST INTERFACE TO MSF X DRC 1              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0105
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0105
*       OUTBUF2(10:12)='1ST';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00329                            0106
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0107
*       OUTBUF2(37)='1';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'1'                                 0108
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0109
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0111
*     ;                             /*                       @Y30LB12*/
@RF00103 DS    0H                                                  0112
*   IF WANTS(4)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00010000'                                   0112
         BNO   @RF00112                                            0112
*     DO;                           /*                       @Y30LB12*/
*                                                                  0113
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 2ND INTERFACE TO MSF X DRC 1              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0114
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0114
*       OUTBUF2(10:12)='2ND';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00332                            0115
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0116
*       OUTBUF2(37)='1';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'1'                                 0117
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0118
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0120
*     ;                             /*                       @Y30LB12*/
@RF00112 DS    0H                                                  0121
*   IF WANTS(5)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00001000'                                   0121
         BNO   @RF00121                                            0121
*     DO;                           /*                       @Y30LB12*/
*                                                                  0122
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 1ST INTERFACE TO MSF X DRC 2              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0123
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0123
*       OUTBUF2(10:12)='1ST';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00329                            0124
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0125
*       OUTBUF2(37)='2';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'2'                                 0126
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0127
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0129
*     ;                             /*                       @Y30LB12*/
@RF00121 DS    0H                                                  0130
*   IF WANTS(6)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00000100'                                   0130
         BNO   @RF00130                                            0130
*     DO;                           /*                       @Y30LB12*/
*                                                                  0131
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 2ND INTERFACE TO MSF X DRC 2              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0132
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0132
*       OUTBUF2(10:12)='2ND';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00332                            0133
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0134
*       OUTBUF2(37)='2';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'2'                                 0135
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0136
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0138
*     ;                             /*                       @Y30LB12*/
@RF00130 DS    0H                                                  0139
*   IF WANTS(7)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00000010'                                   0139
         BNO   @RF00139                                            0139
*     DO;                           /*                       @Y30LB12*/
*                                                                  0140
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 1ST INTERFACE TO MSF X DRC 3              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0141
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0141
*       OUTBUF2(10:12)='1ST';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00329                            0142
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0143
*       OUTBUF2(37)='3';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'3'                                 0144
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0145
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0147
*     ;                             /*                       @Y30LB12*/
@RF00139 DS    0H                                                  0148
*   IF WANTS(8)='1'B                /*                       @Y30LB12*/
*     THEN                          /*                       @Y30LB12*/
         TM    WANTS,B'00000001'                                   0148
         BNO   @RF00148                                            0148
*     DO;                           /*                       @Y30LB12*/
*                                                                  0149
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @Y30LB12*/
*       /* ICG309I 2ND INTERFACE TO MSF X DRC 3              @Y30LB12*/
*       /* IS NOT USED.                                      @Y30LB12*/
*       /* *****************************************         @Y30LB12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0150
*       OUTBUF2(1:49)=ICGDS309;     /*                       @Y30LB12*/
         MVC   OUTBUF2(49,R4),ICGDS309                             0150
*       OUTBUF2(10:12)='2ND';       /*                       @Y30LB12*/
         MVC   OUTBUF2+9(3,R4),@CC00332                            0151
*       OUTBUF2(31)=SAVELIB;        /*                       @Y30LB12*/
         MVC   OUTBUF2+30(1,R4),SAVELIB                            0152
*       OUTBUF2(37)='3';            /*                       @Y30LB12*/
         MVI   OUTBUF2+36(R4),C'3'                                 0153
*       CALL PUTIT3;                /*                       @Y30LB12*/
         BAL   @14,PUTIT3                                          0154
*     END;                          /*                       @Y30LB12*/
*   ELSE                                                           0156
*     ;                             /*                       @Y30LB12*/
@RF00148 DS    0H                                                  0157
*   END MATCH;                      /* RET. TO MAINLINE      @Y30LB12*/
@EL00002 DS    0H                                                  0157
@EF00002 DS    0H                                                  0157
@ER00002 LM    @14,@12,@SA00002                                    0157
         BR    @14                                                 0157
*                                                                  0158
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0158
*PUTIT1:                                                           0158
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT1   STM   @14,@12,@SA00003                                    0158
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'01000000'                                0159
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            0160
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0161
         AH    @10,TERMINAT(,R4)                                   0161
         STH   @10,TERMINAT(,R4)                                   0161
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            0163
*   END PUTIT1;                     /*                       @Y30LB12*/
@EL00003 DS    0H                                                  0164
@EF00003 DS    0H                                                  0164
@ER00003 LM    @14,@12,@SA00003                                    0164
         BR    @14                                                 0164
*                                                                  0165
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0165
*PUTIT2:                                                           0165
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT2   STM   @14,@12,@SA00004                                    0165
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/
         OI    STOPSCAN,B'01000000'                                0166
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/
         LA    @10,1                                               0167
         AH    @10,TERMINAT(,R4)                                   0167
         STH   @10,TERMINAT(,R4)                                   0167
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   END PUTIT2;                     /*                       @Y30LB12*/
@EL00004 DS    0H                                                  0169
@EF00004 DS    0H                                                  0169
@ER00004 LM    @14,@12,@SA00004                                    0169
         BR    @14                                                 0169
*                                                                  0170
*/***********************************************************@Y30LB12*/
*/*                                                          @Y30LB12*/
*/* PROCEDURE NAME - PUTIT3                                  @Y30LB12*/
*/*                                                          @Y30LB12*/
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/
*/*            PUT WARNING MESSAGE FOR WHICH MESSAGE TEXT    @Y30LB12*/
*/*            IS NOT IN ICGDSMSG, BUT WHICH IS BUILT AND    @Y30LB12*/
*/*            PASSED IN 'OUTBUF2'.                          @Y30LB12*/
*/*                                                          @Y30LB12*/
*/***********************************************************@Y30LB12*/
*                                                                  0170
*PUTIT3:                                                           0170
*   PROCEDURE;                      /*                       @Y30LB12*/
PUTIT3   STM   @14,@12,@SA00005                                    0170
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/
         OI    PRNTBUF2(R4),B'00000001'                            0171
*   WARNING=WARNING+1;              /*                       @Y30LB12*/
         LA    @10,1                                               0172
         AH    @10,WARNING(,R4)                                    0172
         STH   @10,WARNING(,R4)                                    0172
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/
         LINK  EP=ICGDSMSG
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/
         NI    PRNTBUF2(R4),B'11111110'                            0174
*   END PUTIT3;                     /*                       @Y30LB12*/
@EL00005 DS    0H                                                  0175
@EF00005 DS    0H                                                  0175
@ER00005 LM    @14,@12,@SA00005                                    0175
         BR    @14                                                 0175
*                                                                  0176
*/********************************************************** @Y30LB12*/
*/*                 P A T C H   A R E A                      @Y30LB12*/
*/********************************************************** @Y30LB12*/
*                                                                  0176
*   GENERATE;                                                      0176
*                                                         /*@Y30LB12*/
PATCHA02 DC    32C'PATCHA02'                              /*@Y30LB12*/
*   END ICGDSA02                    /*                       @Y30LB12*/
*                                                                  0177
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA4)                                       */
*                                                                  0177
*       ;                                                          0177
         B     @EL00001                                            0177
@DATA    DS    0H
@CH00042 DC    H'1'
@CH00050 DC    H'2'
@CH00048 DC    H'3'
@CH00068 DC    H'4'
@CH00128 DC    H'12'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSA02 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
WORKA02  DS    CL5
         ORG   WORKA02
WORKSIZE DS    CL1
WANTS    DS    BL1
SAVELIB  DS    CL1
WORKCTL  DS    BL1
A02FLAGS DS    BL1
         ORG   A02FLAGS
ERROR    DS    BL1
STOPSCAN EQU   A02FLAGS+0
@NM00020 EQU   A02FLAGS+0
         ORG   WORKA02+5
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSA02 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ICG335I  DC    H'335'
@CC00329 DC    C'1ST'
@CC00332 DC    C'2ND'
ICGDS307 DC    CL62' ICG307I SIZE FOR MSFX TOO SMALL FOR SPECIFIED MSF C
               CONTROLLERS'
ICGDS309 DC    CL49' ICG309I XXX INTERFACE TO MSF X DRC X IS NOT USED'
ICGDS310 DC    CL52' ICG310I MSF X NOT SPECIFIED. DRC ATTACHMENT INVALIC
               D'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
INDEX    EQU   @02
R4       EQU   @04
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
PRINTER  EQU   COMTAB+464
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
MSGNO    EQU   MESSAGES+2
WARNING  EQU   MESSAGES+4
TERMINAT EQU   MESSAGES+6
SPECLMSG EQU   MESSAGES+18
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
LIBSPEC  EQU   LIBBITS
LIBSIZE  EQU   LIB+1
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
MERLICEB EQU   PHYSFLGS
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
ALTPATH1 EQU   CONFGDEV+2
ALTPATH2 EQU   CONFGDEV+5
ALTPATH3 EQU   CONFGDEV+8
SCANBUF  EQU   0
SCANDATA EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
ALTCH3   EQU   ALTPATH3+2
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCH2   EQU   ALTPATH2+2
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCH1   EQU   ALTPATH1+2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
INDEXRSG EQU   CONFGDEV+1
ICEBERG  EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
USECONVR EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEV     EQU   USEFLAGS
USESPEC  EQU   USEFLAGS
RSGCUA   EQU   RSGUCB+8
RSGCHAN  EQU   RSGUCB+7
CPUREFNO EQU   RSGUCB+6
RSGCPUID EQU   RSGUCB+1
@NM00019 EQU   RSGFLAGS
CISPEC   EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
@NM00018 EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
LOWLIB   EQU   LOWDSS+1
@NM00016 EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWSPEC  EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
PHYSICEB EQU   MERLICEB
PHYSMERL EQU   MERLICEB
PHYSDS2  EQU   DSPAIRS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBDSMID EQU   LIB+2
@NM00009 EQU   LIBBITS
TODS2    EQU   RSGTODS+1
TODS1    EQU   RSGTODS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
RETCODE  EQU   MESSAGES
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SCANLEN  EQU   READER+204
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
SAVENCOL EQU   READER+192
SAVESCOL EQU   READER+188
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
LASTPARM EQU   READFLAG
ENDSCAN  EQU   READFLAG
PARMBIT  EQU   READFLAG
KEYBIT   EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00037 EQU   @RC00036
@RC00045 EQU   @RC00044
@RC00053 EQU   @RC00052
@ENDDATA EQU   *
         END   ICGDSA02,(C'PLS1950',0603,76335)

         TITLE 'ICGDSB19 MSC TABLE CREATE, PUNCH SYSGEN                *
                        '
ICGDSB19 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSB19  77.362'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                      PROCESSING FOR JES3   @G18MB73*/
*                                                                  0063
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @Y30LB14*/
*   /* INITIALIZATION                                        @Y30LB14*/
*   /* ***********************************************       @Y30LB14*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0063
*   OLDJ=0;                         /*                       @Y30LB14*/
         SLR   @15,@15                                             0063
         ST    @15,OLDJ                                            0063
*   OLDI=0;                         /*                       @OZ05131*/
         STH   @15,OLDI                                            0064
*   CNT=0;                          /*                       @Y30LB14*/
         ST    @15,CNT                                             0065
*   N=0;                            /*                       @Y30LB14*/
         SLR   N,N                                                 0066
*   SWIOD=0;                        /*                       @OZ09548*/
         MVI   SWIOD,X'00'                                         0067
*   UNITIOD=0;                      /*                       @OZ09534*/
         MVI   UNITIOD,X'00'                                       0068
*   BYT=0;                          /*                       @Y30LB14*/
         SLR   BYT,BYT                                             0069
*   SEQNUM=0;                       /*                       @Y30LB14*/
         STH   @15,SEQNUM                                          0070
*   FLAG=0;                         /*                       @Y30LB14*/
         MVI   FLAG,X'00'                                          0071
*   INBUF='';                       /*                       @Y30LB14*/
         MVI   INBUF(R4),C' '                                      0072
         MVC   INBUF+1(79,R4),INBUF(R4)                            0072
*   CALL SCANOPEN;                  /* OPEN SYSPUNCH         @Y30LB14*/
         BAL   @14,SCANOPEN                                        0073
*                                                                  0074
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @Y30LB14*/
*   /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-         @Y30LB14*/
*   /* TING OUT THE IODEVICE CARD. THE CARD IS PRO-          @Y30LB14*/
*   /* DUCED ONLY IF THE DEVICE HAS BEEN SPECIFIED.          @Y30LB14*/
*   /* THE SEQUENCE NUMBER IS INCREMENTED FOR EVERY          @Y30LB14*/
*   /* CARD THAT IS PRODUCED. 'N' POINTS TO THE NEXT         @Y30LB14*/
*   /* CARD COLUMN TO BE FILLED. ENTRIES FOR THE             @Z40LB65*/
*   /* MSC TABLES DRIVES MUST BE MODIFIED SO AS TO           @Z40LB65*/
*   /* GENERATE REAL IODEVICE CARDS. THIS IS DONE FOR        @Z40LB65*/
*   /* SA0 AND SA1 (IF THAT INTERFACE EXISTS).               @Z40LB65*/
*   /* IF THE TABPTH KEYWORD WAS SPECIFIED, CARDS ARE        @OZ28368*/
*   /* PRODUCED ONLY IF THE DEVICE HAS BEEN SPECIFIED.@OZ28368       */
*   /* ***********************************************       @Y30LB14*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0074
*   IF BINTIND='0'B THEN                                           0074
         TM    BINTIND(R4),B'00000100'                             0074
         BNZ   @RF00074                                            0074
*     DO;                           /* TABPTH SPEC           @OZ28368*/
*       DO I=1 BY 3 TO 4;           /*                       @Z40LB65*/
         LA    I,1                                                 0076
@DL00076 DS    0H                                                  0077
*         K=1;                      /*                       @Z40LB65*/
         LA    @15,1                                               0077
         ST    @15,K                                               0077
*         IF CISPEC(I)='1'B         /*                       @OZ05144*/
*           THEN                    /*                       @OZ05144*/
         LR    @03,I                                               0078
         MH    @03,@CH00115                                        0078
         L     @01,COMPTR2(,R4)                                    0078
         ALR   @01,@03                                             0078
         TM    CISPEC-9(@01),B'10000000'                           0078
         BNO   @RF00078                                            0078
*           DO J=1 BY 8 TO 9;       /*                       @Z40LB65*/
         LR    J,@15                                               0079
@DL00079 DS    0H                                                  0080
*             USESPEC(I,J)='1'B;    /*                       @Z40LB65*/
*             USEREAL(I,J)='1'B;    /*                       @Z40LB65*/
         LR    @15,I                                               0081
         SLA   @15,6                                               0081
         ALR   @15,J                                               0081
         MH    @15,@CH00034                                        0081
         L     @01,COMPTR2(,R4)                                    0081
         ST    @15,@TF00001                                        0081
         ALR   @15,@01                                             0081
         AL    @15,@CF00829                                        0081
         OI    USESPEC-464(@15),B'10010000'                        0081
*             IF PABIBERG(1,K)='1'B THEN                           0082
         L     @15,K                                               0082
         MH    @15,@CH00051                                        0082
         ALR   @15,R4                                              0082
         TM    PABIBERG-3(@15),B'00010000'                         0082
         BNO   @RF00082                                            0082
*               ICEBERG(I,J)='1'B;  /*                       @Z40LB65*/
         AL    @01,@TF00001                                        0083
         AL    @01,@CF00829                                        0083
         OI    ICEBERG-464(@01),B'00000001'                        0083
*             USESPEC(I,J+1)='1'B;  /*                       @Z40LB65*/
@RF00082 DS    0H                                                  0085
*             USEREAL(I,J+1)='1'B;  /*                       @Z40LB65*/
         LR    @15,I                                               0085
         SLA   @15,6                                               0085
         ALR   @15,J                                               0085
         MH    @15,@CH00034                                        0085
         L     @01,COMPTR2(,R4)                                    0085
         ST    @15,@TF00001                                        0085
         ALR   @15,@01                                             0085
         AL    @15,@CF00831                                        0085
         OI    USESPEC-464(@15),B'10010000'                        0085
*             IF PABIBERG(1,K+2)='1'B THEN                         0086
         L     @15,K                                               0086
         MH    @15,@CH00051                                        0086
         ALR   @15,R4                                              0086
         TM    PABIBERG+3(@15),B'00010000'                         0086
         BNO   @RF00086                                            0086
*               ICEBERG(I,J+1)='1'B;/*                       @Z40LB65*/
         AL    @01,@TF00001                                        0087
         AL    @01,@CF00831                                        0087
         OI    ICEBERG-464(@01),B'00000001'                        0087
*             K=5;                  /*                       @Z40LB65*/
@RF00086 MVC   K(4),@CF00122                                       0088
*           END;                    /*                       @Z40LB65*/
*                                                                  0089
         AH    J,@CH00043                                          0089
         CH    J,@CH00115                                          0089
         BNH   @DL00079                                            0089
*         /***********************************************************/
*         /*                                                         */
*         /* ********************************************    @Z40LB65*/
*         /* TEST FOR SA1 INTB AND BYPASS MODIFICATIONS      @Z40LB65*/
*         /* IF THE INTERFACE DOES NOT EXIST                 @Z40LB65*/
*         /* ********************************************    @Z40LB65*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0090
*         IF TODS1(1)^='01'X&TODS2(1)^='01'X/*               @OZ05094*/
*             ×CISPEC(4)='0'B       /*                       @OZ05094*/
*           THEN                    /*                       @OZ05094*/
@RF00078 CLI   TODS1(R4),X'01'                                     0090
         BE    @GL00001                                            0090
         CLI   TODS2(R4),X'01'                                     0090
         BNE   @RT00090                                            0090
@GL00001 L     @01,COMPTR2(,R4)                                    0090
         TM    CISPEC+27(@01),B'10000000'                          0090
         BNZ   @RF00090                                            0090
@RT00090 DS    0H                                                  0091
*           I=5;                    /*                       @Z40LB65*/
         LA    I,5                                                 0091
*       END;                        /*                       @Z40LB65*/
@RF00090 AH    I,@CH00051                                          0092
         CH    I,@CH00071                                          0092
         BNH   @DL00076                                            0092
*     END;                          /*                       @OZ28368*/
*   IODSW='0'B;                     /* FORCE CARD WHEN SA/CI CHANGES
*                                                            @OZ09548*/
@RF00074 NI    IODSW,B'01111111'                                   0094
*   DO I=1 TO MAXSACI;              /*                       @YD00113*/
         LA    I,1                                                 0095
@DL00095 DS    0H                                                  0096
*     DO J=1 TO MAXDEV;             /*                       @YD00113*/
*                                                                  0096
         LA    J,1                                                 0096
@DL00096 DS    0H                                                  0097
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************       @YD00113*/
*       /* IODEVICE STATEMENTS ARE PRODUCED FOR              @YD00113*/
*       /* ADDRESSES SPECIFIED AS VIRTUAL, SHARED            @YD00113*/
*       /* VIRTUAL, REAL, OR CONVERTIBLE UNLESS              @YD00113*/
*       /* THE 'SUPPUNCH' FLAG IS SET BECAUSE THE            @YD00113*/
*       /* THE ADDRESS IS SYMMETRIC IN A MULTI-              @YD00113*/
*       /* HOST ENVIRONMENT.                                 @OZ09548*/
*       /* *******************************************       @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0097
*       IF USESPEC(I,J)='1'B&ITISALTP(I,J)='0'B&SUPPUNCH(I,J)='0'B THEN
         LR    @15,I                                               0097
         SLA   @15,6                                               0097
         ALR   @15,J                                               0097
         MH    @15,@CH00034                                        0097
         L     @01,COMPTR2(,R4)                                    0097
         ALR   @01,@15                                             0097
         AL    @01,@CF00829                                        0097
         TM    USESPEC-464(@01),B'10000000'                        0097
         BNO   @RF00097                                            0097
         TM    ITISALTP-464(@01),B'00001010'                       0097
         BNZ   @RF00097                                            0097
*         IF IODSW='0'B THEN        /* FIRST TIME IMAGE BUILD      0098
*                                                            @OZ09548*/
         TM    IODSW,B'10000000'                                   0098
         BNZ   @RF00098                                            0098
*           DO;                     /*                       @OZ09548*/
*             CALL IODSTRT;         /* IMAGE BUILD ROUTINE   @OZ09548*/
         BAL   @14,IODSTRT                                         0100
*           END;                    /*                       @OZ09548*/
*         ELSE                      /*                       @OZ09548*/
*           IF OLDJ+1^=J×OLDI^=I    /* CHK ADDR SKIP         @OZ09548*/
*             THEN                  /*                       @OZ09548*/
         B     @RC00098                                            0102
@RF00098 LA    @15,1                                               0102
         AL    @15,OLDJ                                            0102
         CR    @15,J                                               0102
         BNE   @RT00102                                            0102
         CH    I,OLDI                                              0102
         BE    @RF00102                                            0102
@RT00102 DS    0H                                                  0103
*             DO;                   /*                       @OZ09548*/
*               CALL PUTOUTCD;      /* OUTPUT ROUTINE        @OZ09548*/
         BAL   @14,PUTOUTCD                                        0104
*               CALL IODSTRT;       /* SETUP NEW CARD        @OZ09548*/
         BAL   @14,IODSTRT                                         0105
*             END;                  /*                       @OZ09548*/
*           ELSE                    /*                       @OZ09548*/
*             IF USEV(I,J)='1'B THEN/* IS NEW CARD USEV      @OZ09548*/
         B     @RC00102                                            0107
@RF00102 LA    @15,11                                              0107
         LR    @01,I                                               0107
         SLA   @01,6                                               0107
         LR    @07,J                                               0107
         ALR   @07,@01                                             0107
         MR    @06,@15                                             0107
         L     @06,COMPTR2(,R4)                                    0107
         ALR   @07,@06                                             0107
         AL    @07,@CF00829                                        0107
         TM    USEV-464(@07),B'01000000'                           0107
         BNO   @RF00107                                            0107
*               IF USEV(I,OLDJ)='1'B/* IS OLD USEV           @OZ09548*/
*                 THEN              /*                       @OZ09548*/
         LR    @09,@01                                             0108
         AL    @09,OLDJ                                            0108
         MR    @08,@15                                             0108
         ALR   @06,@09                                             0108
         AL    @06,@CF00829                                        0108
         TM    USEV-464(@06),B'01000000'                           0108
         BNO   @RF00108                                            0108
*                 CALL COMCHAN;     /* COMPARE ALT. PATHS    @OZ09548*/
         BAL   @14,COMCHAN                                         0109
*               ELSE                /*                       @OZ09548*/
*                 DO;               /*                       @OZ09548*/
         B     @RC00108                                            0110
@RF00108 DS    0H                                                  0111
*                   CALL PUTOUTCD;  /* OUTPUT ROUTINE        @OZ09548*/
         BAL   @14,PUTOUTCD                                        0111
*                   CALL IODSTRT;   /* SETUP NEW CARD        @OZ09548*/
         BAL   @14,IODSTRT                                         0112
*                 END;              /*                       @OZ09548*/
*             ELSE                  /*                       @OZ09548*/
*               IF USEVS(I,J)='1'B THEN/* IS NEW CARD USEVS  @OZ09548*/
         B     @RC00107                                            0114
@RF00107 LR    @15,I                                               0114
         SLA   @15,6                                               0114
         ALR   @15,J                                               0114
         MH    @15,@CH00034                                        0114
         L     @01,COMPTR2(,R4)                                    0114
         ALR   @01,@15                                             0114
         AL    @01,@CF00829                                        0114
         TM    USEVS-464(@01),B'00100000'                          0114
         BNO   @RF00114                                            0114
*                 IF FS='1'B        /* IS OLD USEVS          @OZ09548*/
*                   THEN            /*                       @OZ09548*/
         TM    FS,B'01000000'                                      0115
         BNO   @RF00115                                            0115
*                   CALL COMCHAN;   /* COMPARE ALT. PATHS    @OZ09548*/
         BAL   @14,COMCHAN                                         0116
*                 ELSE              /*                       @OZ09548*/
*                   DO;             /*                       @OZ09548*/
         B     @RC00115                                            0117
@RF00115 DS    0H                                                  0118
*                     CALL PUTOUTCD;/* OUTPUT ROUTINE        @OZ09548*/
         BAL   @14,PUTOUTCD                                        0118
*                     CALL IODSTRT; /* SETUP NEW CARD        @OZ09548*/
         BAL   @14,IODSTRT                                         0119
*                   END;            /*                       @OZ09548*/
*               ELSE                /*                       @OZ09548*/
*                 IF USEREAL(I,J)='1'B×USECONVR(I,J)='1'B/*  @OZ09548*/
*                   THEN            /* IS NEW CARD REAL OR         0121
*                                      CONVERTIBLE           @OZ09548*/
         B     @RC00114                                            0121
@RF00114 LA    @15,11                                              0121
         LR    @01,I                                               0121
         SLA   @01,6                                               0121
         LR    @07,J                                               0121
         ALR   @07,@01                                             0121
         MR    @06,@15                                             0121
         L     @06,COMPTR2(,R4)                                    0121
         ST    @07,@TF00001                                        0121
         ALR   @07,@06                                             0121
         AL    @07,@CF00829                                        0121
         TM    USEREAL-464(@07),B'00010100'                        0121
         BZ    @RF00121                                            0121
*                   IF USEREAL(I,OLDJ)='1'B/*                @OZ09548*/
*                       ×USECONVR(I,OLDJ)='1'B/*             @OZ09548*/
*                     THEN          /*                       @OZ09548*/
         LR    @09,@01                                             0122
         AL    @09,OLDJ                                            0122
         MR    @08,@15                                             0122
         ST    @09,@TF00002                                        0122
         ALR   @09,@06                                             0122
         AL    @09,@CF00829                                        0122
         TM    USEREAL-464(@09),B'00010100'                        0122
         BZ    @RF00122                                            0122
*                     IF ICEBERG(I,J)='1'B&ICEBERG(I,OLDJ)='1'B/*  0123
*                                                            @OZ09548*/
*                       THEN        /*                       @S60RS73*/
         LR    @15,@06                                             0123
         AL    @15,@TF00001                                        0123
         AL    @15,@CF00829                                        0123
         TM    ICEBERG-464(@15),B'00000001'                        0123
         BNO   @RF00123                                            0123
         AL    @06,@TF00002                                        0123
         AL    @06,@CF00829                                        0123
         TM    ICEBERG-464(@06),B'00000001'                        0123
         BNO   @RF00123                                            0123
*                       CALL COMCHAN;/*                      @OZ09548*/
*                                                                  0124
         BAL   @14,COMCHAN                                         0124
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @X60RS12*/
*       /* THE DEVICE TYPE IS NOT 3330 MODEL 11.             @X60RS12*/
*       /* THE DEVICE TYPE MAY BE 3330 MODEL 1               @X60RS12*/
*       /* (EITHER REAL OR CONVERTIBLE) OR IT                @X60RS12*/
*       /* MAY BE 3350 (REAL ONLY). IF IT IS THE             @X60RS12*/
*       /* SAME AS THE PREVIOUS TYPE, CALL THE               @X60RS12*/
*       /* PROCEDURE COMCHAN TO CHECK ALTERNATE              @X60RS12*/
*       /* PATH INFORMATION. OTHERWISE PRINT AND             @X60RS12*/
*       /* PUNCH THIS RECORD, AND START ANOTHER.             @X60RS12*/
*       /* *****************************************         @X60RS12*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0125
*                     ELSE          /*                       @S60RS73*/
*                                                                  0125
*                       /*********************************************/
*                       /*                                           */
*                       /* ********************************* @S60RS73*/
*                       /* MAY BE 3350                       @S60RS73*/
*                       /* ********************************* @S60RS73*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0125
*                       DO;         /*                       @S60RS73*/
         B     @RC00123                                            0125
@RF00123 DS    0H                                                  0126
*                         I1=(I+2)/3;/* INDEX BY 16          @S60RS73*/
         LA    @08,2                                               0126
         ALR   @08,I                                               0126
         SRDA  @08,32                                              0126
         D     @08,@CF00051                                        0126
         ST    @09,I1                                              0126
*                         I2=(J+7)/8;/* DASD CTL 1 TO 4      @S60RS73*/
         LA    @15,7                                               0127
         ALR   @15,J                                               0127
         LR    I2,@15                                              0127
         SRDA  I2,32                                               0127
         D     I2,@CF00043                                         0127
         LR    I2,@07                                              0127
*                         I3=(J+7)//8+1;/* DEVICE 1 TO 8     @S60RS73*/
*                                                                  0128
         LR    @08,@15                                             0128
         SRDA  @08,32                                              0128
         D     @08,@CF00043                                        0128
         AH    @08,@CH00045                                        0128
         ST    @08,I3                                              0128
*                         /*******************************************/
*                         /*                                         */
*                         /* IF CURRENT DEVICE TYPE IS 3350  @X60RS12*/
*                         /*                                         */
*                         /*******************************************/
*                                                                  0129
*                         IF MERLICEB(I1,I2,I3)=PHYSFMAD/*   @X60RS12*/
*                           THEN    /* IF LAST WAS 3350      @X60RS12*/
         L     @15,I1                                              0129
         SLA   @15,2                                               0129
         ALR   @15,I2                                              0129
         SLA   @15,3                                               0129
         ALR   @15,@08                                             0129
         ALR   @15,@15                                             0129
         ALR   @15,R4                                              0129
         TM    MERLICEB-82(@15),B'11000000'                        0129
         BNO   @RF00129                                            0129
*                           IF INBUF(43)='5'/*               @X60RS12*/
*                             THEN  /* YES, LAST 3350        @X60RS12*/
         CLI   INBUF+42(R4),C'5'                                   0130
         BNE   @RF00130                                            0130
*                             CALL COMCHAN;/*                @X60RS12*/
         BAL   @14,COMCHAN                                         0131
*                           ELSE    /* LAST NOT 3350         @X60RS12*/
*                             DO;   /*                       @X60RS12*/
         B     @RC00130                                            0132
@RF00130 DS    0H                                                  0133
*                               CALL PUTOUTCD;/* OUTPUT OLD  @X60RS12*/
         BAL   @14,PUTOUTCD                                        0133
*                               CALL IODSTRT;/* SETUP NEW    @X60RS12*/
         BAL   @14,IODSTRT                                         0134
*                             END;  /*                       @X60RS12*/
*                         ELSE      /* THIS IS 3330          @X60RS12*/
*                           IF INBUF(43)='3'/*               @X60RS12*/
*                               &ICEBERG(I,OLDJ)='0'B/*      @X60RS12*/
*                               &ICEBERG(I,J)='0'B/*         @ZZZZZZZ*/
*                             THEN  /* YES, LAST 3330        @X60RS12*/
         B     @RC00129                                            0136
@RF00129 CLI   INBUF+42(R4),C'3'                                   0136
         BNE   @RF00136                                            0136
         LA    @15,11                                              0136
         LR    @01,I                                               0136
         SLA   @01,6                                               0136
         LR    @07,@01                                             0136
         AL    @07,OLDJ                                            0136
         MR    @06,@15                                             0136
         L     @06,COMPTR2(,R4)                                    0136
         ALR   @07,@06                                             0136
         AL    @07,@CF00829                                        0136
         TM    ICEBERG-464(@07),B'00000001'                        0136
         BNZ   @RF00136                                            0136
         LR    @09,@01                                             0136
         ALR   @09,J                                               0136
         MR    @08,@15                                             0136
         ALR   @06,@09                                             0136
         AL    @06,@CF00829                                        0136
         TM    ICEBERG-464(@06),B'00000001'                        0136
         BNZ   @RF00136                                            0136
*                             CALL COMCHAN;/*                @X60RS12*/
         BAL   @14,COMCHAN                                         0137
*                           ELSE    /* LAST NOT 3330         @X60RS12*/
*                             DO;   /*                       @X60RS12*/
         B     @RC00136                                            0138
@RF00136 DS    0H                                                  0139
*                               CALL PUTOUTCD;/* OUTPUT OLD  @X60RS12*/
         BAL   @14,PUTOUTCD                                        0139
*                               CALL IODSTRT;/* SETUP NEW    @X60RS12*/
         BAL   @14,IODSTRT                                         0140
*                             END;  /*                       @X60RS12*/
*                       END;        /* END MADRID            @S60RS73*/
*                   ELSE            /* NEW CARD              @S60RS73*/
*                     DO;           /*                       @S60RS73*/
         B     @RC00122                                            0143
@RF00122 DS    0H                                                  0144
*                       CALL PUTOUTCD;/* OUTPUT ROUTINE      @S60RS73*/
         BAL   @14,PUTOUTCD                                        0144
*                       CALL IODSTRT;/* SETUP NEW CARD       @S60RS73*/
         BAL   @14,IODSTRT                                         0145
*                     END;          /* END ICEBERG           @OZ09548*/
*                 ELSE                                             0147
*                   ;               /* NO MATCH ON ANY USEAGE TYPE 0147
*                                                            @OZ09548*/
@RF00121 DS    0H                                                  0148
*/* *********************************************************@OZ09548*/
*/*  FALSE SITUATION ARISES IF NON-MATCH ON ANY OF THE ABOVE @OZ09548*/
*/*  DASD USEAGE TYPES. SINCE THIS SHOULD NEVER HAPPEN       @OZ09548*/
*/*  THIS PASS THROUGH THE CODE IS IGNORED                   @OZ09548*/
*/* *********************************************************@OZ09548*/
*                                                                  0148
*     END;                          /* END DO J LOOP         @Y30LB14*/
@RC00121 DS    0H                                                  0148
@RC00114 DS    0H                                                  0148
@RC00107 DS    0H                                                  0148
@RC00102 DS    0H                                                  0148
@RC00098 DS    0H                                                  0148
@RF00097 AH    J,@CH00045                                          0148
         CH    J,@CH00256                                          0148
         BNH   @DL00096                                            0148
*   END;                            /* END DO I LOOP         @Y30LB14*/
         AH    I,@CH00045                                          0149
         CH    I,@CH00246                                          0149
         BNH   @DL00095                                            0149
*   CALL PUTOUTCD;                  /* PUNCH LAST CARD       @OZ09548*/
         BAL   @14,PUTOUTCD                                        0150
*                                                                  0151
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @Y30LB14*/
*   /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-         @Y30LB14*/
*   /* TING OUT THE UNITNAME CARD. AS MUCH DATA AS           @Y30LB14*/
*   /* POSSIBLE IS PUT ON ONE CARD IF THE DATA BE-           @Y30LB14*/
*   /* LONGS TO THE SAME RSG. ENTRIES FOR THE MSC            @Z40LB65*/
*   /* TABLES DRIVES MUST AGAIN BE MODIFIED SO AS TO         @Z40LB65*/
*   /* AVOID GENERATING UNITNAME CARDS UNLESS THE            @OZ28368*/
*   /* TABPTH KEYWORD IN CREATE WAS CORRECTLY                @OZ28368*/
*   /* SPECIFIED. THIS IS DONE FOR THE SAME ENTIRES          @OZ28368*/
*   /* AS MODIFIED FOR IODEVICE CARDS.                       @OZ28368*/
*   /* ***********************************************       @Z40LB65*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0151
*   IF BINTIND='0'B THEN            /* IF TABPTH KEYWORD NOT @OZ28368*/
*                                                                  0151
         TM    BINTIND(R4),B'00000100'                             0151
         BNZ   @RF00151                                            0151
*     /***************************************************************/
*     /*                                                             */
*     /* SPECIFIED THEN DEFLT PRC                            @OZ28368*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0152
*     DO;                           /*                       @OZ28368*/
*       DO I=1 BY 3 TO 4;           /*                       @Z40LB65*/
         LA    I,1                                                 0153
@DL00153 DS    0H                                                  0154
*         DO J=1 BY 8 TO 9;         /*                       @Z40LB65*/
         LA    J,1                                                 0154
@DL00154 DS    0H                                                  0155
*           USESPEC(I,J)='0'B;      /*                       @Z40LB65*/
*           USEREAL(I,J)='0'B;      /*                       @Z40LB65*/
         LR    @15,I                                               0156
         SLA   @15,6                                               0156
         ALR   @15,J                                               0156
         MH    @15,@CH00034                                        0156
         L     @01,COMPTR2(,R4)                                    0156
         ST    @15,@TF00001                                        0156
         ALR   @15,@01                                             0156
         AL    @15,@CF00829                                        0156
         NI    USESPEC-464(@15),B'01101111'                        0156
*           USESPEC(I,J+1)='0'B;    /*                       @Z40LB65*/
*           USEREAL(I,J+1)='0'B;    /*                       @Z40LB65*/
         AL    @01,@TF00001                                        0158
         AL    @01,@CF00831                                        0158
         NI    USESPEC-464(@01),B'01101111'                        0158
*         END;                      /*                       @Z40LB65*/
*                                                                  0159
         AL    J,@CF00043                                          0159
         CH    J,@CH00115                                          0159
         BNH   @DL00154                                            0159
*         /***********************************************************/
*         /*                                                         */
*         /* ********************************************    @Z40LB65*/
*         /* TEST FOR SA1 INTB AND BYPASS MODIFICATIONS      @Z40LB65*/
*         /* IF THE INTERFACE DOES NOT EXIST                 @Z40LB65*/
*         /* ********************************************    @Z40LB65*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0160
*         IF TODS1(1)^='01'X&TODS2(1)^='01'X THEN                  0160
         CLI   TODS1(R4),X'01'                                     0160
         BE    @RF00160                                            0160
         CLI   TODS2(R4),X'01'                                     0160
         BE    @RF00160                                            0160
*           I=5;                    /*                       @Z40LB65*/
         LA    I,5                                                 0161
*       END;                        /*                       @Z40LB65*/
@RF00160 AL    I,@CF00051                                          0162
         CH    I,@CH00071                                          0162
         BNH   @DL00153                                            0162
*     END;                          /*                       @OZ28368*/
*   ELSE                                                           0164
*     ;                             /*                       @OZ28368*/
@RF00151 DS    0H                                                  0165
*   SW=1;                           /* FIRST TIME SWITCH     @YD00113*/
         MVI   SW,X'01'                                            0165
*   SORTSEQ='1'B;                   /* ALLOWS PATH THRU SEQUENCE CODE
*                                                            @OZ09534*/
*   RESET='1'B;                     /* RESET SEQUENCE NUMBER @OZ09534*/
*                                                                  0167
         OI    SORTSEQ,B'11000000'                                 0167
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR SORT COLMN INFORMATION.                           @OZ09534*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0168
*   SWJ='0'B;                       /* INIT J PROCESSING     @G18MB73*/
         NI    SWJ,B'00001111'                                     0168
*   DO I=1 TO MAXSACI;              /*                       @YD00113*/
         LA    I,1                                                 0169
@DL00169 DS    0H                                                  0170
*     IF OPJES3(CPUREFNO(I)+1)='1'B THEN/*                   @G18MB73*/
         LR    @15,I                                               0170
         MH    @15,@CH00115                                        0170
         L     @01,COMPTR2(,R4)                                    0170
         SLR   @03,@03                                             0170
         IC    @03,CPUREFNO-9(@15,@01)                             0170
         SLA   @03,3                                               0170
         ALR   @03,R4                                              0170
         TM    OPJES3(@03),B'00000100'                             0170
         BNO   @RF00170                                            0170
*       LOCALJES='1'B;              /* FOR J PROCESSING      @G18MB73*/
         OI    LOCALJES,B'00100000'                                0171
*     DO J=1 TO MAXDEV;             /*                       @YD00113*/
*                                                                  0172
@RF00170 LA    J,1                                                 0172
@DL00172 DS    0H                                                  0173
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************       @YD00113*/
*       /* PRODUCE A 'UNITNAME' STATEMENT ONLY IF            @YD00113*/
*       /* THE ADDRESS WAS SPECIFIED AS VIRTUAL OR           @YD00113*/
*       /* SHARED VIRTUAL AND THE DEVICE ADDRESS WAS         @YD00113*/
*       /* NOT DUPLICATED ON ANOTHER INTERFACE IN A          @YD00113*/
*       /* MULTIPROCESSING CONFIGURATION.                    @YD00113*/
*       /* *******************************************       @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0173
*       IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B/*               @YM31086*/
*           ×USEVS(I,J)='1'B&SUPPUNCH(I,J)='0'B THEN               0173
*                                                                  0173
         LR    @15,I                                               0173
         SLA   @15,6                                               0173
         ALR   @15,J                                               0173
         MH    @15,@CH00034                                        0173
         L     @01,COMPTR2(,R4)                                    0173
         ALR   @01,@15                                             0173
         AL    @01,@CF00829                                        0173
         TM    USEV-464(@01),B'01000000'                           0173
         BNO   @GL00008                                            0173
         TM    SUPPUNCH-464(@01),B'00001000'                       0173
         BZ    @RT00173                                            0173
@GL00008 LR    @15,I                                               0173
         SLA   @15,6                                               0173
         ALR   @15,J                                               0173
         MH    @15,@CH00034                                        0173
         L     @01,COMPTR2(,R4)                                    0173
         ALR   @01,@15                                             0173
         AL    @01,@CF00829                                        0173
         TM    USEVS-464(@01),B'00100000'                          0173
         BNO   @RF00173                                            0173
         TM    SUPPUNCH-464(@01),B'00001000'                       0173
         BNZ   @RF00173                                            0173
@RT00173 DS    0H                                                  0174
*         /***********************************************************/
*         /*                                                         */
*         /* *********************************************** @G18MB73*/
*         /* BUILD INBUF AND PERFORM CHECKS                  @G18MB73*/
*         /* *********************************************** @G18MB73*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0174
*         CALL BUILDIT;             /* BUILD INBUF           @G18MB73*/
         BAL   @14,BUILDIT                                         0174
*     END;                          /* J LOOP                @G18MB73*/
@RF00173 AH    J,@CH00045                                          0175
         CH    J,@CH00256                                          0175
         BNH   @DL00172                                            0175
*   END;                            /* I LOOP                @G18MB73*/
*                                                                  0176
         AH    I,@CH00045                                          0176
         CH    I,@CH00246                                          0176
         BNH   @DL00169                                            0176
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @G18MB73*/
*   /* END THE FINAL GROUP, PRINT AND PUNCH IT, AND          @G18MB73*/
*   /* PROCESS J-UNITNAME STATEMENTS IF REQUIRED.            @G18MB73*/
*   /* ***********************************************       @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0177
*   CALL ENDGRP;                    /* END A GROUP ON CARD IMAGE   0177
*                                                            @G18MB73*/
         BAL   @14,ENDGRP                                          0177
*   CALL PUTOUTCD;                  /* PRINT AND PUNCH A CARD      0178
*                                                            @G18MB73*/
         BAL   @14,PUTOUTCD                                        0178
*   IF LOCALJES^='1'B THEN          /* REQUIRES NO J CARDS   @G18MB73*/
         TM    LOCALJES,B'00100000'                                0179
         BO    @RF00179                                            0179
*     DO;                           /*                       @G18MB73*/
*       CALL ENDDATA;               /* CLOSE SYSPUNCH        @G18MB73*/
         BAL   @14,ENDDATA                                         0181
*       RETURN;                     /* RETURN TO ICGDSBLD    @G18MB73*/
@EL00001 L     @13,4(,@13)                                         0182
@EF00001 L     @00,@SIZDATD                                        0182
         LR    @01,@11                                             0182
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0182
         BR    @14                                                 0182
*     END;                          /*                       @G18MB73*/
*   ELSE                            /*                       @G18MB73*/
*     DO;                           /*                       @G18MB73*/
@RF00179 DS    0H                                                  0185
*       UCOMP='1'B;                 /* UNITNAME PROCESSING IS      0185
*                                      COMPLETE              @G18MB73*/
         OI    UCOMP,B'01000000'                                   0185
*       RESET='1'B;                 /* RESET SEQUENCE NUMBER @G18MB73*/
*                                                                  0186
         OI    RESET,B'01000000'                                   0186
*       /*************************************************************/
*       /*                                                           */
*       /* **********************************************    @G18MB73*/
*       /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-     @G18MB73*/
*       /* TING OUT THE J-UNITNAME CARD. AS MUCH DATA AS     @G18MB73*/
*       /* POSSIBLE IS PUT ON ONE CARD IF THE DATA BE-       @G18MB73*/
*       /* LONGS TO THE SAME RSG.                            @G18MB73*/
*       /* ***********************************************   @G18MB73*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0187
*       SW1='1'B;                   /* FIRST TIME SWITCH     @G18MB73*/
         OI    SW1,B'00010000'                                     0187
*     END;                          /*                       @G18MB73*/
*   DO I=1 TO MAXSACI;              /*                       @G18MB73*/
         LA    I,1                                                 0189
@DL00189 DS    0H                                                  0190
*     IF OPJES3(CPUREFNO(I)+1)='1'B THEN/* OPSYS=JES3        @G18MB73*/
         LR    @15,I                                               0190
         MH    @15,@CH00115                                        0190
         L     @01,COMPTR2(,R4)                                    0190
         SLR   @03,@03                                             0190
         IC    @03,CPUREFNO-9(@15,@01)                             0190
         SLA   @03,3                                               0190
         ALR   @03,R4                                              0190
         TM    OPJES3(@03),B'00000100'                             0190
         BNO   @RF00190                                            0190
*       DO J=1 TO MAXDEV;           /*                       @G18MB73*/
         LA    J,1                                                 0191
@DL00191 DS    0H                                                  0192
*         MATCH='0'B;               /* INITIALIZE MATCH      @G18MB73*/
*                                                                  0192
         NI    MATCH,B'01111111'                                   0192
*         /***********************************************************/
*         /*                                                         */
*         /* *******************************************     @G18MB73*/
*         /* PRODUCE A 'J-UNITNAME' STATEMENT ONLY IF        @G18MB73*/
*         /* THE ADDRESS WAS SPECIFIED AS SHARED             @G18MB73*/
*         /* VIRTUAL OR VIRTUAL.                             @G18MB73*/
*         /* *******************************************     @G18MB73*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0193
*         IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B THEN/*        @G18MB73*/
         LR    @15,I                                               0193
         SLA   @15,6                                               0193
         ALR   @15,J                                               0193
         MH    @15,@CH00034                                        0193
         L     @01,COMPTR2(,R4)                                    0193
         ST    @15,@TF00001                                        0193
         ALR   @15,@01                                             0193
         AL    @15,@CF00829                                        0193
         TM    USEV-464(@15),B'01000000'                           0193
         BNO   @RF00193                                            0193
         TM    SUPPUNCH-464(@15),B'00001000'                       0193
         BNZ   @RF00193                                            0193
*/***********************************************************@G18MB73*/
*/* IF USEV THEN CHECK THE INTERFACE OF THE CURRENT ENTRY    @G18MB73*/
*/* AGAINST ALL OTHER (FIVE) ENTRIES THAT MIGHT SHARE        @G18MB73*/
*/* THE STAGING DRIVE GROUP. IF A DIFFERENT CPU USES ONE     @G18MB73*/
*/* OF THE INTERFACES, CHECK TO INSURE THAT THE OTHER        @G18MB73*/
*/* CPU DOES NOT USE THE SAME SDG.                           @G18MB73*/
*/***********************************************************@G18MB73*/
*                                                                  0194
*           DO;                     /*                       @G18MB73*/
*             SAVE1=TODS1(INDEXRSG(I,J)+1);/* 1ST SA VALUE   @G18MB73*/
         L     @15,@TF00001                                        0195
         AL    @01,@CF00837                                        0195
         SLR   @09,@09                                             0195
         IC    @09,INDEXRSG-465(@15,@01)                           0195
         MH    @09,@CH00115                                        0195
         ALR   @09,R4                                              0195
         MVC   SAVE1(1),TODS1(@09)                                 0195
*/***********************************************************@G18MB73*/
*/**********************************************             @G18MB73*/
*/* RANGE OF VALUES RETURNED TO SAVE1 OR SAVE2               @G18MB73*/
*/* IS EITHER 0-F OR FF IF UNUSED                            @G18MB73*/
*/**********************************************             @G18MB73*/
*/***********************************************************@G18MB73*/
*                                                                  0196
*             DO K=1 TO 3;          /* B,C & D INT.          @G18MB73*/
         LA    @15,1                                               0196
         ST    @15,K                                               0196
@DL00196 DS    0H                                                  0197
*               IF CPUREFNO((SAVE1*3)+K)^=CPUREFNO(I)/*      @G18MB73*/
*                   &CISPEC((SAVE1*3)+K)='1'B/*              @G18MB73*/
*                 THEN              /* SDGCPU ^= CURRENT CPU &     0197
*                                                            @G18MB73*/
*                                                                  0197
         LA    @01,9                                               0197
         SLR   @07,@07                                             0197
         IC    @07,SAVE1                                           0197
         MH    @07,@CH00051                                        0197
         ALR   @07,@15                                             0197
         MR    @06,@01                                             0197
         L     @15,COMPTR2(,R4)                                    0197
         LR    @09,@01                                             0197
         MR    @08,I                                               0197
         ST    @07,@TF00001                                        0197
         ALR   @07,@15                                             0197
         ALR   @09,@15                                             0197
         CLC   CPUREFNO-9(1,@07),CPUREFNO-9(@09)                   0197
         BE    @RF00197                                            0197
         AL    @15,@TF00001                                        0197
         TM    CISPEC-9(@15),B'10000000'                           0197
         BNO   @RF00197                                            0197
*                 /***************************************************/
*                 /*                                                 */
*                 /* INTERFACE IN USE                        @G18MB73*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0198
*                 DO L=1 TO MAXDEV; /* CHECK DEVICES AGAINST RSG   0198
*                                                            @G18MB73*/
         LA    L,1                                                 0198
@DL00198 DS    0H                                                  0199
*                   IF USEV((SAVE1*3)+K,L)='1'B×/*           @G18MB73*/
*                       USEVS((SAVE1*3)+K,L)='1'B/*          @G18MB73*/
*                     THEN          /*                       @G18MB73*/
         LA    @15,11                                              0199
         SLR   @09,@09                                             0199
         IC    @09,SAVE1                                           0199
         MH    @09,@CH00051                                        0199
         AL    @09,K                                               0199
         SLA   @09,6                                               0199
         ALR   @09,L                                               0199
         MR    @08,@15                                             0199
         L     @07,COMPTR2(,R4)                                    0199
         ST    @09,@TF00001                                        0199
         ALR   @09,@07                                             0199
         AL    @09,@CF00829                                        0199
         TM    USEV-464(@09),B'01100000'                           0199
         BZ    @RF00199                                            0199
*/***********************************************************@G18MB73*/
*/* CHECK THE SDG OF THE CURRENT ADDRESS BEING EXAMINED      @G18MB73*/
*/* AGAINST THE SDGS SPECIFIED ON THE OTHER INTS.            @G18MB73*/
*/* THAT HAVE A PATH TO THIS SDG. IF THE ADDRESS             @G18MB73*/
*/* ON THE OTHER INTERFACE IS USEV OR USEVS, IF              @G18MB73*/
*/* A DIFFERENT CPU IS ON THAT INTERFACE, AND IF             @G18MB73*/
*/* THAT OTHER CPU USES THE SAME SDG, A J-STATEMENT          @G18MB73*/
*/* FOR THE CURRENT DEVICE WILL NOT BE PUNCHED               @G18MB73*/
*/***********************************************************@G18MB73*/
*                                                                  0200
*                     IF INDEXRSG(I,J)=INDEXRSG((SAVE1*3)+K,L)/*   0200
*                                                            @G18MB73*/
*                       THEN        /*                       @G18MB73*/
         LR    @09,I                                               0200
         SLA   @09,6                                               0200
         ALR   @09,J                                               0200
         MR    @08,@15                                             0200
         ALR   @09,@07                                             0200
         AL    @09,@CF00837                                        0200
         AL    @07,@TF00001                                        0200
         AL    @07,@CF00837                                        0200
         CLC   INDEXRSG-465(1,@09),INDEXRSG-465(@07)               0200
         BNE   @RF00200                                            0200
*/***********************************************************@G18MB73*/
*/*IS CURRENT SDG (DEVICE) ADDRESS  ACCESSIBLE   THROUGH     @G18MB73*/
*/*OTHER INTERFACES WHICH MAY HAVE ANOTHER CPU ATTACHED      @G18MB73*/
*/***********************************************************@G18MB73*/
*                                                                  0201
*                       DO;         /*                       @G18MB73*/
*                         MATCH='1'B;/* MULTI- HOST PATH TO SDG    0202
*                                                            @G18MB73*/
         OI    MATCH,B'10000000'                                   0202
*                         L=MAXDEV; /* DROP FROM LOOP        @G18MB73*/
         LA    L,64                                                0203
*                       END;        /*                       @G18MB73*/
*                 END;              /* END DO L LOOP         @G18MB73*/
@RF00200 DS    0H                                                  0205
@RF00199 AH    L,@CH00045                                          0205
         CH    L,@CH00256                                          0205
         BNH   @DL00198                                            0205
*             END;                  /* END DO K LOOP         @G18MB73*/
@RF00197 LA    @15,1                                               0206
         AL    @15,K                                               0206
         ST    @15,K                                               0206
         CH    @15,@CH00051                                        0206
         BNH   @DL00196                                            0206
*             IF TODS2(INDEXRSG(I,J)+1)^='FF'X&/*            @G18MB73*/
*                 MATCH='0'B        /*                       @G18MB73*/
*               THEN                /* 2ND SA IS USED AND    @G18MB73*/
*                                                                  0207
         LR    @15,I                                               0207
         SLA   @15,6                                               0207
         ALR   @15,J                                               0207
         MH    @15,@CH00034                                        0207
         L     @01,COMPTR2(,R4)                                    0207
         AL    @01,@CF00837                                        0207
         SLR   @09,@09                                             0207
         IC    @09,INDEXRSG-465(@15,@01)                           0207
         MH    @09,@CH00115                                        0207
         ST    @09,@TF00001                                        0207
         ALR   @09,R4                                              0207
         CLI   TODS2(@09),X'FF'                                    0207
         BE    @RF00207                                            0207
         TM    MATCH,B'10000000'                                   0207
         BNZ   @RF00207                                            0207
*               /*****************************************************/
*               /*                                                   */
*               /* SINGLE HOST PATH TO SDG ON FIRST SA       @G18MB73*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0208
*               SAVE2=TODS2(INDEXRSG(I,J)+1);/* OPT. 2ND SA VALUE  0208
*                                                            @G18MB73*/
         LR    @15,R4                                              0208
         AL    @15,@TF00001                                        0208
         MVC   SAVE2(1),TODS2(@15)                                 0208
*             DO K=1 TO 3;          /*                       @G18MB73*/
@RF00207 LA    @15,1                                               0209
         ST    @15,K                                               0209
@DL00209 DS    0H                                                  0210
*               IF CISPEC((SAVE2*3)+K)='1'B/*                @G18MB73*/
*                   &CPUREFNO((SAVE2*3)+K)^=CPUREFNO(I)/*    @G18MB73*/
*                 THEN              /* SDGCPU ^= CURRENT CPU &     0210
*                                                            @G18MB73*/
*                                                                  0210
         LA    @01,9                                               0210
         SLR   @07,@07                                             0210
         IC    @07,SAVE2                                           0210
         MH    @07,@CH00051                                        0210
         ALR   @07,@15                                             0210
         MR    @06,@01                                             0210
         L     @15,COMPTR2(,R4)                                    0210
         ST    @07,@TF00001                                        0210
         ALR   @07,@15                                             0210
         TM    CISPEC-9(@07),B'10000000'                           0210
         BNO   @RF00210                                            0210
         LR    @07,@01                                             0210
         MR    @06,I                                               0210
         LR    @01,@15                                             0210
         AL    @01,@TF00001                                        0210
         ALR   @15,@07                                             0210
         CLC   CPUREFNO-9(1,@01),CPUREFNO-9(@15)                   0210
         BE    @RF00210                                            0210
*                 /***************************************************/
*                 /*                                                 */
*                 /* INTERFACE IN USE                        @G18MB73*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0211
*                 DO L=1 TO MAXDEV; /*                       @G18MB73*/
         LA    L,1                                                 0211
@DL00211 DS    0H                                                  0212
*                   IF USEV((SAVE2*3)+K,L)='1'B×/*           @G18MB73*/
*                       USEVS((SAVE2*3)+K,L)='1'B/*          @G18MB73*/
*                     THEN          /*                       @G18MB73*/
         LA    @15,11                                              0212
         SLR   @09,@09                                             0212
         IC    @09,SAVE2                                           0212
         MH    @09,@CH00051                                        0212
         AL    @09,K                                               0212
         SLA   @09,6                                               0212
         ALR   @09,L                                               0212
         MR    @08,@15                                             0212
         L     @07,COMPTR2(,R4)                                    0212
         ST    @09,@TF00001                                        0212
         ALR   @09,@07                                             0212
         AL    @09,@CF00829                                        0212
         TM    USEV-464(@09),B'01100000'                           0212
         BZ    @RF00212                                            0212
*                     IF INDEXRSG(I,J)=INDEXRSG((SAVE2*3)+K,L)/*   0213
*                                                            @G18MB73*/
*                       THEN        /*                       @G18MB73*/
         LR    @09,I                                               0213
         SLA   @09,6                                               0213
         ALR   @09,J                                               0213
         MR    @08,@15                                             0213
         ALR   @09,@07                                             0213
         AL    @09,@CF00837                                        0213
         AL    @07,@TF00001                                        0213
         AL    @07,@CF00837                                        0213
         CLC   INDEXRSG-465(1,@09),INDEXRSG-465(@07)               0213
         BNE   @RF00213                                            0213
*                       DO;         /*                       @G18MB73*/
*                         MATCH='1'B;/* MULTI- HOST PATH TO SDG    0215
*                                                            @G18MB73*/
         OI    MATCH,B'10000000'                                   0215
*                         L=MAXDEV; /* DROP FROM LOOP        @G18MB73*/
         LA    L,64                                                0216
*                       END;        /*                       @G18MB73*/
*                 END;              /* END DO L LOOP         @G18MB73*/
@RF00213 DS    0H                                                  0218
@RF00212 AH    L,@CH00045                                          0218
         CH    L,@CH00256                                          0218
         BNH   @DL00211                                            0218
*             END;                  /* END DO K LOOP         @G18MB73*/
@RF00210 LA    @15,1                                               0219
         AL    @15,K                                               0219
         ST    @15,K                                               0219
         CH    @15,@CH00051                                        0219
         BNH   @DL00209                                            0219
*           END;                    /* NOT USEV              @G18MB73*/
*         IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B&MATCH='0'B/*  @G18MB73*/
*             ×USEVS(I,J)='1'B&SUPPUNCH(I,J)='0'B/* SINGLE CPU PATH
*                                      TO SDG AND PROPER USE O.K.THEN
*                                      SETUP FOR J-CARD OUTPUT     0221
*                                                            @G18MB73*/
*           THEN                    /*                       @G18MB73*/
@RF00193 LR    @15,I                                               0221
         SLA   @15,6                                               0221
         ALR   @15,J                                               0221
         MH    @15,@CH00034                                        0221
         L     @01,COMPTR2(,R4)                                    0221
         ALR   @01,@15                                             0221
         AL    @01,@CF00829                                        0221
         TM    USEV-464(@01),B'01000000'                           0221
         BNO   @GL00012                                            0221
         TM    SUPPUNCH-464(@01),B'00001000'                       0221
         BNZ   @GL00012                                            0221
         TM    MATCH,B'10000000'                                   0221
         BZ    @RT00221                                            0221
@GL00012 LR    @15,I                                               0221
         SLA   @15,6                                               0221
         ALR   @15,J                                               0221
         MH    @15,@CH00034                                        0221
         L     @01,COMPTR2(,R4)                                    0221
         ALR   @01,@15                                             0221
         AL    @01,@CF00829                                        0221
         TM    USEVS-464(@01),B'00100000'                          0221
         BNO   @RF00221                                            0221
         TM    SUPPUNCH-464(@01),B'00001000'                       0221
         BNZ   @RF00221                                            0221
@RT00221 DS    0H                                                  0222
*           CALL BUILDIT;           /* BUILD INBUF IMAGE     @G18MB73*/
         BAL   @14,BUILDIT                                         0222
*       END;                        /* J LOOP                @G18MB73*/
@RF00221 AH    J,@CH00045                                          0223
         CH    J,@CH00256                                          0223
         BNH   @DL00191                                            0223
*   END;                            /* I LOOP                @G18MB73*/
*                                                                  0224
@RF00190 AH    I,@CH00045                                          0224
         CH    I,@CH00246                                          0224
         BNH   @DL00189                                            0224
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @G18MB73*/
*   /* END THE FINAL GROUP, PRINT AND PUNCH IT, AND          @G18MB73*/
*   /* CLOSE SYSPUNCH. RETURN TO ICGDSBLD.                   @G18MB73*/
*   /* ***********************************************       @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0225
*   CALL ENDGRP;                    /* END A GROUP ON CARD IMAGE   0225
*                                                            @G18MB73*/
         BAL   @14,ENDGRP                                          0225
*   CALL PUTOUTCD;                  /* PUNCH A CARD          @G18MB73*/
         BAL   @14,PUTOUTCD                                        0226
*   CALL ENDDATA;                   /* CLOSE SYSPUNCH        @G18MB73*/
         BAL   @14,ENDDATA                                         0227
*   RETURN;                         /* RETURN TO CALLER - MAINLINE -
*                                                            @G18MB73*/
         B     @EL00001                                            0228
*                                                                  0229
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - CPUIDP                                  @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - UNPACK THE FIELD CONTAINING MANUFCATURER'S    @YD00113*/
*/*            INDETIFICATION (6 DIGITS OF MACHINE SERIAL    @YD00113*/
*/*            NUMBER AND 4 DIGITS OF MACHINE MODEL NUMBER)  @YD00113*/
*/*            SO THAT DIGITS 2-6 OF SERIAL NUMBER CAN BE    @YD00113*/
*/*            PLACED IN THE LABEL FIELD.                    @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0229
*CPUIDP:                                                           0229
*   PROCEDURE;                      /*                       @Y30LB14*/
CPUIDP   STM   @14,@12,@SA00002                                    0229
*   PACKED(1:5)=RSGCPUID(I);        /*                       @Y30LB14*/
         LR    @15,I                                               0230
         MH    @15,@CH00115                                        0230
         L     @01,COMPTR2(,R4)                                    0230
         ALR   @01,@15                                             0230
         MVC   PACKED(5),RSGCPUID-9(@01)                           0230
*   PACKED(6)='0F'X;                /*                       @Y30LB14*/
         MVI   PACKED+5,X'0F'                                      0231
*   GEN(UNPK UNPACKED(11),PACKED(6));/*                      @Y30LB14*/
         UNPK UNPACKED(11),PACKED(6)
*   RETURN;                         /*                       @Y30LB14*/
@EL00002 DS    0H                                                  0233
@EF00002 DS    0H                                                  0233
@ER00002 LM    @14,@12,@SA00002                                    0233
         BR    @14                                                 0233
*   END CPUIDP;                     /*                       @Y30LB14*/
*                                                                  0235
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - SEQUENCE                                @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - CONVERT THE INTERNALLY DEVELOPED BINARY       @YD00113*/
*/*            SEQUENCE NUMBER TO TWO PRINATBLE DECIMAL      @YD00113*/
*/*            DIGITS AND PLACE IN POSITIONS 7 AND 8 OF      @YD00113*/
*/*            LABEL FIELD ON IODEVICE RECORDS ONLY.         @YD00113*/
*/*            DETERMINATION IS MADE TO PROPERLY FORMAT      @OZ09534*/
*/*            OUTPUT BUFFER ACCORDING TO CURRENT ACTIVE     @OZ09534*/
*/*            ROUTINE AND OVERFLOW CONDITIONS.              @OZ09534*/
*/*                                                          @OZ09534*/
*/********************************************************** @YD00113*/
*                                                                  0235
*SEQUENCE:                                                         0235
*   PROCEDURE;                      /*                       @Y30LB14*/
SEQUENCE STM   @14,@12,12(@13)                                     0235
*   IF SETSEQ='0'B&SORTSEQ='0'B THEN/*                       @OZ09534*/
         TM    SETSEQ,B'00001000'                                  0236
         BNZ   @RF00236                                            0236
         TM    SORTSEQ,B'10000000'                                 0236
         BNZ   @RF00236                                            0236
*     DO;                           /*                       @OZ09534*/
*                                                                  0237
*       /*************************************************************/
*       /*                                                           */
*       /* REQUIRE SEQUENCE IN ID FIELD DESPITE              @OZ09534*/
*       /* POSS. OVERFLOW CONDITIONS                         @OZ09534*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0238
*       UD=SEQNUM//10;              /*                       @Y30LB14*/
         MVC   @ZT00002+2(2),SEQNUM                                0238
         L     @15,@ZT00002                                        0238
         LA    @01,10                                              0238
         LR    @02,@15                                             0238
         SRDA  @02,32                                              0238
         DR    @02,@01                                             0238
         LR    UD,@02                                              0238
*       INBUF(8)=TABLE(UD+1);       /*                       @Y30LB14*/
         LA    @09,TABLE(UD)                                       0239
         MVC   INBUF+7(1,R4),0(@09)                                0239
*       UD=(SEQNUM/10)//10;         /*                       @Y30LB14*/
         LR    @03,@15                                             0240
         SLR   @02,@02                                             0240
         DR    @02,@01                                             0240
         LR    @06,@03                                             0240
         SRDA  @06,32                                              0240
         DR    @06,@01                                             0240
         LR    UD,@06                                              0240
*       INBUF(7)=TABLE(UD+1);       /*                       @Y30LB14*/
         LA    @01,TABLE(UD)                                       0241
         MVC   INBUF+6(1,R4),0(@01)                                0241
*       INBUF(73:77)=INBUF(2:6);    /*                       @OZ09534*/
         MVC   INBUF+72(5,R4),INBUF+1(R4)                          0242
*       UD=(SEQNUM/100)//100;       /* HIGH-ORDER DIGIT      @OZ09534*/
         LA    @01,100                                             0243
         LR    @03,@15                                             0243
         SLR   @02,@02                                             0243
         DR    @02,@01                                             0243
         LR    @06,@03                                             0243
         SRDA  @06,32                                              0243
         DR    @06,@01                                             0243
         LR    UD,@06                                              0243
*       INBUF(78)=TABLE(UD+1);      /* HIGH-ORDER DIGIT      @OZ09534*/
         LA    @15,TABLE(UD)                                       0244
         MVC   INBUF+77(1,R4),0(@15)                               0244
*       INBUF(79)=INBUF(7);         /*                       @OZ09534*/
         MVC   INBUF+78(1,R4),INBUF+6(R4)                          0245
*       INBUF(80)=INBUF(8);         /*                       @OZ09534*/
         MVC   INBUF+79(1,R4),INBUF+7(R4)                          0246
*       RETURN;                     /*                       @Y30LB14*/
@EL00003 DS    0H                                                  0247
@EF00003 DS    0H                                                  0247
@ER00003 LM    @14,@12,12(@13)                                     0247
         BR    @14                                                 0247
*     END;                          /*                       @OZ09534*/
*                                                                  0248
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTINUATION SORT SEQUENCE NUMBER                     @OZ09534*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0249
*   ELSE                                                           0249
*     DO;                           /* UNITNAME SORT INFO OR OVRFLW
*                                      COND.                 @OZ09534*/
@RF00236 DS    0H                                                  0250
*       IF SETSEQ='0'B THEN         /* IN UNITNAME           @OZ09534*/
         TM    SETSEQ,B'00001000'                                  0250
         BNZ   @RF00250                                            0250
*         INBUF(73:77)=INBUF(2:6);  /*                       @OZ09534*/
         MVC   INBUF+72(5,R4),INBUF+1(R4)                          0251
*       UD=(SEQNUM/100)//100;       /* HIGH-ORDER DIGIT      @OZ09534*/
@RF00250 LA    @15,100                                             0252
         MVC   @ZT00002+2(2),SEQNUM                                0252
         L     @01,@ZT00002                                        0252
         LR    @03,@01                                             0252
         SLR   @02,@02                                             0252
         DR    @02,@15                                             0252
         LR    @06,@03                                             0252
         SRDA  @06,32                                              0252
         DR    @06,@15                                             0252
         LR    UD,@06                                              0252
*       INBUF(78)=TABLE(UD+1);      /* HIGH-ORDER DIGIT      @OZ09534*/
         LA    @15,TABLE(UD)                                       0253
         MVC   INBUF+77(1,R4),0(@15)                               0253
*       UD=SEQNUM//10;              /*                       @OZ09534*/
         LA    @15,10                                              0254
         LR    @02,@01                                             0254
         SRDA  @02,32                                              0254
         DR    @02,@15                                             0254
         LR    UD,@02                                              0254
*       INBUF(80)=TABLE(UD+1);      /*                       @OZ09534*/
         LA    @09,TABLE(UD)                                       0255
         MVC   INBUF+79(1,R4),0(@09)                               0255
*       UD=(SEQNUM/10)//10;         /*                       @OZ09534*/
         LR    @03,@01                                             0256
         SLR   @02,@02                                             0256
         DR    @02,@15                                             0256
         LR    @06,@03                                             0256
         SRDA  @06,32                                              0256
         DR    @06,@15                                             0256
         LR    UD,@06                                              0256
*       INBUF(79)=TABLE(UD+1);      /*                       @OZ09534*/
         LA    @15,TABLE(UD)                                       0257
         MVC   INBUF+78(1,R4),0(@15)                               0257
*       RETURN;                     /*                       @OZ09534*/
         B     @EL00003                                            0258
*     END;                          /*                       @OZ09534*/
*   END SEQUENCE;                   /*                       @Y30LB14*/
*                                                                  0261
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - CUDADDR                                 @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - DEVELOP THE PRINTABLE CHANNEL/CONTROL UNIT/   @YD00113*/
*/*            DEVICE ADDRESS OF THE UCB AND PLACE IT IN     @YD00113*/
*/*            STRUCTURE 'CUD'.                              @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0261
*CUDADDR:                                                          0261
*   PROCEDURE;                      /*                       @Y30LB14*/
*                                                                  0261
CUDADDR  STM   @14,@12,12(@13)                                     0261
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* CHANNEL IS CONVERTED DIRECTLY FORM THE BINARY         @YD00113*/
*   /* NUMBER STORED IN RSGCHAN BY ICGDSS04. 1 IS            @YD00113*/
*   /* ADDED BECAUSE THE FIRST ENTRY IN THE 'TABLE'          @YD00113*/
*   /* STRUCTURE IS THE CHARACTER 0.                         @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*   CHANNEL=TABLE(RSGCHAN(I)+1);    /*                       @Y30LB14*/
*                                                                  0262
         LR    @15,I                                               0262
         MH    @15,@CH00115                                        0262
         L     @07,COMPTR2(,R4)                                    0262
         SLR   @01,@01                                             0262
         IC    @01,RSGCHAN-9(@15,@07)                              0262
         LA    @09,TABLE(@01)                                      0262
         MVC   CHANNEL(1),0(@09)                                   0262
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* CONTROL UNIT ADDRESS CONSISTS OF TWO BITS OF          @YD00113*/
*   /* CONTROL UNIT (SPECIFIED IN 'CUID' PARAMETER           @YD00113*/
*   /* IN THE UPPERCON STATEMENT) PLUS THE HIGH-ORDER        @YD00113*/
*   /* TWO BITS OF DEVICE (SPECIFIED IN 'ADDR' OR            @YD00113*/
*   /* 'REAL' OR 'CONVREAL' IN THE UPPERCON                  @YD00113*/
*   /* STATEMENT).                                           @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*   UD=RSGCUA(I)*64+J-1;            /*                       @Y30LB14*/
         SLR   UD,UD                                               0263
         IC    UD,RSGCUA-9(@15,@07)                                0263
         SLA   UD,6                                                0263
         ALR   UD,J                                                0263
         BCTR  UD,0                                                0263
*   BYT=UD/16;                      /*                       @Y30LB14*/
         LR    BYT,UD                                              0264
         SRL   BYT,4                                               0264
*   UNIT=TABLE(BYT+1);              /*                       @Y30LB14*/
         LA    @15,TABLE(BYT)                                      0265
         MVC   UNIT(1),0(@15)                                      0265
*   BYT=UD//16;                     /*                       @Y30LB14*/
*                                                                  0266
         LR    BYT,UD                                              0266
         N     BYT,@CF00066                                        0266
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* 'DEVICE' IS THE CHARACTER REPRESENTATION OF           @YD00113*/
*   /* THE FOUR LOW-ORDER BITS SPECIFIED IN 'ADDR'           @YD00113*/
*   /* OR 'REAL' OR 'CONVREAL' IN THE UPPERCON               @YD00113*/
*   /* STATEMENT.                                            @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0267
*   DEVICE=TABLE(BYT+1);            /*                       @Y30LB14*/
         LA    @15,TABLE(BYT)                                      0267
         MVC   DEVICE(1),0(@15)                                    0267
*   RETURN;                         /* RETURN TO CALLER      @Y30LB14*/
@EL00004 DS    0H                                                  0268
@EF00004 DS    0H                                                  0268
@ER00004 LM    @14,@12,12(@13)                                     0268
         BR    @14                                                 0268
*   END CUDADDR;                    /*                       @Y30LB14*/
*                                                                  0270
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - OPTCHAN                                 @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE DETERMINES IF ANY INFORMATION IS @YD00113*/
*/*            PRESENT IN THE ALTERNATE PATHS.  IF THERE IS, @YD00113*/
*/*            THEN THE BINARY FORM OF THE NUMBER FOUND      @YD00113*/
*/*            IS SORTED AND PLACED IN THE OPTCHAN PORTION   @YD00113*/
*/*            OF THE IODEVICE CARD.  IF ONLY TWO ENTRIES    @YD00113*/
*/*            ARE FOUND THEN SORT2 IS CALLED.  IF THREE     @YD00113*/
*/*            ENRTIES  ARE FOUND, THE SORT3 IS CALLED.      @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0270
*OPTCHAN:                                                          0270
*   PROCEDURE;                      /*                       @Y30LB14*/
*                                                                  0270
OPTCHAN  STM   @14,@04,@SA00005                                    0270
         STM   @06,@12,@SA00005+28                                 0270
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @OZ09548*/
*   /*                                                       @OZ09548*/
*   /* ZERO OUT WORK AREA FOR NEW BUILD                      @OZ09548*/
*   /*                                                       @OZ09548*/
*   /* ***********************************************       @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   WRKCH(1)=0;                     /*                       @OZ09548*/
         SLR   @15,@15                                             0271
         ST    @15,WRKCH                                           0271
*   WRKCH(2)=0;                     /*                       @OZ09548*/
         ST    @15,WRKCH+4                                         0272
*   WRKCH(3)=0;                     /*                       @OZ09548*/
*                                                                  0273
         ST    @15,WRKCH+8                                         0273
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* ALTERNATE PATH FIELDS ARE CREATED IN SEQUENCE.        @YD00113*/
*   /* THEREFORE, IF ALTPATH1 CONTAINS ZEROS, BOTH           @YD00113*/
*   /* ALTPATH2 AND ALTPATH3 ALSO CONTAIN ZEROS. IF          @YD00113*/
*   /* ALTPATH2 CONTAINS ZEROS, ALTPATH3 ALSO                @YD00113*/
*   /* CONTAINS ZEROS.                                       @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*   IF ALTPATH1(I,J)^=0 THEN                                       0274
         LR    @15,I                                               0274
         SLA   @15,6                                               0274
         ALR   @15,J                                               0274
         MH    @15,@CH00034                                        0274
         L     @01,COMPTR2(,R4)                                    0274
         ALR   @01,@15                                             0274
         AL    @01,@CF00839                                        0274
         MVC   @ZT00001+1(3),ALTPATH1-466(@01)                     0274
         L     @15,@ZT00001                                        0274
         LTR   @15,@15                                             0274
         BZ    @RF00274                                            0274
*     DO;                           /*                       @Y30LB14*/
*       IF FS='1'B THEN             /*                       @OZ09534*/
         TM    FS,B'01000000'                                      0276
         BNO   @RF00276                                            0276
*/* FEATURE SHARED & OPTCHAN WILL CREATE OVERFLOW CONDITION  @OZ09534*/
*                                                                  0277
*         OVRFLW='1'B;              /*                       @OZ09534*/
         OI    OVRFLW,B'00010000'                                  0277
*       ELSE                                                       0278
*         ;                         /*                       @OZ09534*/
*                                                                  0278
@RF00276 DS    0H                                                  0279
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************       @YD00113*/
*       /* SET UP FOR THE BASIC OPTCHAN FIELD AND            @YD00113*/
*       /* ASSUME THAT ONLY ONE ALTERNATE PATH IS            @YD00113*/
*       /* SPECIFIED.                                        @YD00113*/
*       /* *******************************************       @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0279
*       INBUF(N:N+9)=',OPTCHAN=(';  /*                       @Y30LB14*/
         LR    @15,R4                                              0279
         ALR   @15,N                                               0279
         MVC   INBUF-1(10,@15),@CC00729                            0279
*       N=N+10;                     /*                       @Y30LB14*/
         AH    N,@CH00033                                          0280
*       CH(1)=ALTCH1(I,J);          /*                       @Y30LB14*/
*                                                                  0281
         LR    @15,I                                               0281
         SLA   @15,6                                               0281
         ALR   @15,J                                               0281
         MH    @15,@CH00034                                        0281
         L     @01,COMPTR2(,R4)                                    0281
         LA    @09,0(@15,@01)                                      0281
         AL    @09,@CF00840                                        0281
         SLR   @08,@08                                             0281
         IC    @08,ALTCH1-468(,@09)                                0281
         ST    @08,CH                                              0281
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************       @YD00113*/
*       /* IF SECOND ALTERNATE PATH IS SPECIFIED,            @YD00113*/
*       /* SAVE SECOND ALTERNATE CHANNEL AND CHECK           @YD00113*/
*       /* TO SEE IF THIRD ALTERNATE PATH IS PRESENT         @YD00113*/
*       /* *******************************************       @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0282
*       IF ALTPATH2(I,J)^=0         /*                       @OZ09548*/
*         THEN                                                     0282
         ST    @15,@TF00001                                        0282
         ALR   @15,@01                                             0282
         AL    @15,@CF00841                                        0282
         MVC   @ZT00001+1(3),ALTPATH2-469(@15)                     0282
         L     @15,@ZT00001                                        0282
         LTR   @15,@15                                             0282
         BZ    @RF00282                                            0282
*         DO;                       /*                       @Y30LB14*/
*           CH(2)=ALTCH2(I,J);      /*                       @Y30LB14*/
*                                                                  0284
         L     @15,@TF00001                                        0284
         AL    @15,@CF00842                                        0284
         SLR   @09,@09                                             0284
         IC    @09,ALTCH2-471(@15,@01)                             0284
         ST    @09,CH+4                                            0284
*           /*********************************************************/
*           /*                                                       */
*           /* ***************************************       @YD00113*/
*           /* IF THIRD ALTERNATE PATH IS PRESENT,           @YD00113*/
*           /* SORT THE THREE ALTERNATE CHANNELS TO          @YD00113*/
*           /* ASCENDING SEQUENCE, PLACE THE                 @YD00113*/
*           /* CHARACTER REPRESENTATIONS IN THE              @YD00113*/
*           /* OPTCHAN FIELDS, BUMP THE NEXT COLUMN          @YD00113*/
*           /* POINTER BY 6, AND RETURN TO THE               @YD00113*/
*           /* IODSTRT ROUTINE FOR IODEVICE.                 @OZ09548*/
*           /* ***************************************       @YD00113*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0285
*           IF ALTPATH3(I,J)^=0     /*                       @OZ09548*/
*             THEN                                                 0285
         LR    @15,@01                                             0285
         AL    @15,@TF00001                                        0285
         AL    @15,@CF00843                                        0285
         MVC   @ZT00001+1(3),ALTPATH3-472(@15)                     0285
         L     @15,@ZT00001                                        0285
         LTR   @15,@15                                             0285
         BZ    @RF00285                                            0285
*             DO;                   /*                       @Y30LB14*/
*               CH(3)=ALTCH3(I,J);  /*                       @Y30LB14*/
         L     @15,@TF00001                                        0287
         AL    @01,@CF00844                                        0287
         SLR   @09,@09                                             0287
         IC    @09,ALTCH3-474(@15,@01)                             0287
         ST    @09,CH+8                                            0287
*               CALL SORT3;         /* SORT THREE NUMBERS    @Y30LB14*/
         BAL   @14,SORT3                                           0288
*               DO K=1 TO 3;        /* MOVE CHANNEL FIELDS TO SAVE 0289
*                                                            @OZ09548*/
         LA    @15,1                                               0289
         ST    @15,K                                               0289
@DL00289 DS    0H                                                  0290
*                 WRKCH(K)=CH(K);   /*                       @OZ09548*/
         LR    @01,@15                                             0290
         SLA   @01,2                                               0290
         L     @09,CH-4(@01)                                       0290
         ST    @09,WRKCH-4(@01)                                    0290
*               END;                /*                       @OZ09548*/
         AH    @15,@CH00045                                        0291
         ST    @15,K                                               0291
         CH    @15,@CH00051                                        0291
         BNH   @DL00289                                            0291
*               INBUF(N+1:N+5)=', , )';/*                    @Y30LB14*/
         LR    @15,R4                                              0292
         ALR   @15,N                                               0292
         MVC   INBUF(5,@15),@CC00732                               0292
*               INBUF(N)=TABLE(CH(1)+1);/*                   @Y30LB14*/
         LR    @15,R4                                              0293
         ALR   @15,N                                               0293
         L     @01,CH                                              0293
         LA    @09,TABLE(@01)                                      0293
         MVC   INBUF-1(1,@15),0(@09)                               0293
*               INBUF(N+2)=TABLE(CH(2)+1);/*                 @Y30LB14*/
         LR    @15,R4                                              0294
         ALR   @15,N                                               0294
         L     @01,CH+4                                            0294
         LA    @09,TABLE(@01)                                      0294
         MVC   INBUF+1(1,@15),0(@09)                               0294
*               INBUF(N+4)=TABLE(CH(3)+1);/*                 @Y30LB14*/
         LR    @15,R4                                              0295
         ALR   @15,N                                               0295
         L     @01,CH+8                                            0295
         LA    @09,TABLE(@01)                                      0295
         MVC   INBUF+3(1,@15),0(@09)                               0295
*               N=N+6;              /*                       @Y30LB14*/
         AH    N,@CH00229                                          0296
*               RETURN;             /*                       @Y30LB14*/
@EL00005 DS    0H                                                  0297
@EF00005 DS    0H                                                  0297
@ER00005 LM    @14,@04,@SA00005                                    0297
         LM    @06,@12,@SA00005+28                                 0297
         BR    @14                                                 0297
*             END;                  /*                       @Y30LB14*/
*                                                                  0298
*           /*********************************************************/
*           /*                                                       */
*           /* ***************************************       @YD00113*/
*           /* IF ONLY TWO ALTERNATE PATHS ARE               @YD00113*/
*           /* PRESENT, SORT THE TWO TO ASCENDING            @YD00113*/
*           /* SEQUENCE, PLACE THE CHARACTER                 @YD00113*/
*           /* REPRESENTATIONS IN THE OPTCHAN FIELDS,        @YD00113*/
*           /* BUMP THE NEXT COLUMN POINTER BY 4,            @YD00113*/
*           /* AND RETURN TO THE IODSTRT ROUTINE FOR         @OZ09548*/
*           /* IODEVICE.                                     @YD00113*/
*           /* ***************************************       @YD00113*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0299
*           K=1;                    /*                       @Y30LB14*/
@RF00285 MVC   K(4),@CF00045                                       0299
*           CALL SORT2;             /* SORT TWO NUMBERS      @Y30LB14*/
         BAL   @14,SORT2                                           0300
*           DO K=1 TO 3;            /* MOVE CHANNEL FIELDS TO SAVE 0301
*                                                            @OZ09548*/
         LA    @15,1                                               0301
         ST    @15,K                                               0301
@DL00301 DS    0H                                                  0302
*             WRKCH(K)=CH(K);       /*                       @OZ09548*/
         LR    @01,@15                                             0302
         SLA   @01,2                                               0302
         L     @09,CH-4(@01)                                       0302
         ST    @09,WRKCH-4(@01)                                    0302
*           END;                    /*                       @OZ09548*/
         AL    @15,@CF00045                                        0303
         ST    @15,K                                               0303
         CH    @15,@CH00051                                        0303
         BNH   @DL00301                                            0303
*           INBUF(N+1:N+3)=', )';   /*                       @Y30LB14*/
         LR    @15,R4                                              0304
         ALR   @15,N                                               0304
         MVC   INBUF(3,@15),@CC00734                               0304
*           INBUF(N)=TABLE(CH(1)+1);/*                       @Y30LB14*/
         LR    @15,R4                                              0305
         ALR   @15,N                                               0305
         L     @01,CH                                              0305
         LA    @09,TABLE(@01)                                      0305
         MVC   INBUF-1(1,@15),0(@09)                               0305
*           INBUF(N+2)=TABLE(CH(2)+1);/*                     @Y30LB14*/
         LR    @15,R4                                              0306
         ALR   @15,N                                               0306
         L     @01,CH+4                                            0306
         LA    @09,TABLE(@01)                                      0306
         MVC   INBUF+1(1,@15),0(@09)                               0306
*           N=N+4;                  /*                       @Y30LB14*/
         AH    N,@CH00071                                          0307
*           RETURN;                 /*                       @Y30LB14*/
         B     @EL00005                                            0308
*         END;                      /*                       @Y30LB14*/
*                                                                  0309
*       /*************************************************************/
*       /*                                                           */
*       /* *******************************************       @YD00113*/
*       /* IF ONLY ONE ALTERNATE PATH IS PRESENT,            @YD00113*/
*       /* PLACE THE CHARACTER REPRESENTATION OF THE         @YD00113*/
*       /* CHANNEL IN THE OPTCHAN FIELD AND RETURN           @YD00113*/
*       /* TO THE IODSTRT ROUTINE FOR IODEVICE               @OZ09548*/
*       /* *******************************************       @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0310
*       INBUF(N-1)=TABLE(CH(1)+1);  /*                       @Y30LB14*/
@RF00282 LR    @15,R4                                              0310
         ALR   @15,N                                               0310
         L     @01,CH                                              0310
         LA    @09,TABLE(@01)                                      0310
         MVC   INBUF-2(1,@15),0(@09)                               0310
*       WRKCH(1)=CH(1);             /*                       @OZ09548*/
         ST    @01,WRKCH                                           0311
*       RETURN;                     /*                       @OZ09548*/
         B     @EL00005                                            0312
*     END;                          /*                       @Y30LB14*/
*                                                                  0313
*   /*****************************************************************/
*   /*                                                               */
*   /* *******************************************           @OZ09548*/
*   /* IF NO OPTIONAL CHANNELS WERE SPECIFIED THEN           @OZ09548*/
*   /* RETURN TO IODSTRT AFTER SETTING VARIABLE              @OZ09548*/
*   /* 'NOPTCHAN'.                                           @OZ09548*/
*   /* *******************************************           @OZ09548*/
*   /* ***********************************************       @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*   ELSE                                                           0314
*     DO;                           /*                       @OZ09548*/
@RF00274 DS    0H                                                  0315
*       NOPTCHAN='1'B;              /*                       @OZ09548*/
         OI    NOPTCHAN,B'00100000'                                0315
*       RETURN;                     /*                       @OZ09548*/
         B     @EL00005                                            0316
*     END;                          /*                       @OZ09548*/
*   END OPTCHAN;                    /*                       @OZ09548*/
*                                                                  0319
*/********************************************************** @OZ09548*/
*/*                                                          @OZ09548*/
*/* PROCEDURE NAME - COMCHAN                                 @OZ09548*/
*/*                                                          @OZ09548*/
*/* FUNCTION - THIS ROUTINE COMPARES ANY INFORMATION IN      @OZ09548*/
*/*            THE INBUF OPTCHAN FIELDS AGAINST ALTERNATE    @OZ09548*/
*/*            PATHS PRESENT IN THE CURRENT CARD. THE        @OZ09548*/
*/*            BINARY FORM OF THE NUMBER FOUND IS PLACED     @OZ09548*/
*/*            IN THE VARIABLE 'WRKCHAN' IN THE OPTCHAN      @OZ09548*/
*/*            PROCEDURE PRIOR TO BEING SORTED FOR FIRST     @OZ09548*/
*/*            BUILD. SUBSEQUENT COMPARISONS ARE MADE HERE.  @OZ09548*/
*/*                                                          @OZ09548*/
*/********************************************************** @OZ09548*/
*                                                                  0319
*COMCHAN:                                                          0319
*   PROCEDURE;                      /*                       @OZ09548*/
COMCHAN  STM   @14,@04,@SA00006                                    0319
         STM   @06,@12,@SA00006+28                                 0319
*   CH(1)=0;                        /*                       @OZ09548*/
         SLR   @15,@15                                             0320
         ST    @15,CH                                              0320
*   CH(2)=0;                        /*                       @OZ09548*/
         ST    @15,CH+4                                            0321
*   CH(3)=0;                        /*                       @OZ09548*/
         ST    @15,CH+8                                            0322
*   IF ALTPATH1(I,J)^=0             /*                       @OZ09548*/
*     THEN                          /*                       @OZ09548*/
         LR    @15,I                                               0323
         SLA   @15,6                                               0323
         ALR   @15,J                                               0323
         MH    @15,@CH00034                                        0323
         L     @01,COMPTR2(,R4)                                    0323
         ST    @15,@TF00001                                        0323
         ALR   @15,@01                                             0323
         AL    @15,@CF00839                                        0323
         MVC   @ZT00001+1(3),ALTPATH1-466(@15)                     0323
         L     @15,@ZT00001                                        0323
         LTR   @15,@15                                             0323
         BZ    @RF00323                                            0323
*     DO;                           /*                       @OZ09548*/
*       CH(1)=ALTCH1(I,J);          /*                       @OZ09548*/
         L     @15,@TF00001                                        0325
         AL    @15,@CF00840                                        0325
         SLR   @09,@09                                             0325
         IC    @09,ALTCH1-468(@15,@01)                             0325
         ST    @09,CH                                              0325
*       IF ALTPATH2(I,J)^=0         /*                       @OZ09548*/
*         THEN                      /*                       @OZ09548*/
         LR    @15,@01                                             0326
         AL    @15,@TF00001                                        0326
         AL    @15,@CF00841                                        0326
         MVC   @ZT00001+1(3),ALTPATH2-469(@15)                     0326
         L     @15,@ZT00001                                        0326
         LTR   @15,@15                                             0326
         BZ    @RF00326                                            0326
*         DO;                       /*                       @OZ09548*/
*           CH(2)=ALTCH2(I,J);      /*                       @OZ09548*/
         L     @15,@TF00001                                        0328
         AL    @15,@CF00842                                        0328
         SLR   @09,@09                                             0328
         IC    @09,ALTCH2-471(@15,@01)                             0328
         ST    @09,CH+4                                            0328
*           IF ALTPATH3(I,J)^=0     /*                       @OZ09548*/
*             THEN                  /*                       @OZ09548*/
         LR    @15,@01                                             0329
         AL    @15,@TF00001                                        0329
         AL    @15,@CF00843                                        0329
         MVC   @ZT00001+1(3),ALTPATH3-472(@15)                     0329
         L     @15,@ZT00001                                        0329
         LTR   @15,@15                                             0329
         BZ    @RF00329                                            0329
*             DO;                   /*                       @OZ09548*/
*               CH(3)=ALTCH3(I,J);  /*                       @OZ09548*/
         L     @15,@TF00001                                        0331
         AL    @01,@CF00844                                        0331
         SLR   @09,@09                                             0331
         IC    @09,ALTCH3-474(@15,@01)                             0331
         ST    @09,CH+8                                            0331
*               CALL SORT3;         /*                       @OZ09548*/
         BAL   @14,SORT3                                           0332
*             END;                  /*                       @OZ09548*/
*           CALL SORT2;             /*                       @OZ09548*/
@RF00329 BAL   @14,SORT2                                           0334
*         END;                      /*                       @OZ09548*/
*     END;                          /*                       @OZ09548*/
@RF00326 DS    0H                                                  0337
*   IF CH(1)^=WRKCH(1)              /*                       @OZ09548*/
*       ×CH(2)^=WRKCH(2)            /*                       @OZ09548*/
*       ×CH(3)^=WRKCH(3)            /*                       @OZ09548*/
*     THEN                          /*                       @OZ09548*/
@RF00323 CLC   CH(4),WRKCH                                         0337
         BNE   @RT00337                                            0337
         CLC   CH+4(4),WRKCH+4                                     0337
         BNE   @RT00337                                            0337
         CLC   CH+8(4),WRKCH+8                                     0337
         BE    @RF00337                                            0337
@RT00337 DS    0H                                                  0338
*     DO;                           /*                       @OZ09548*/
*       CALL PUTOUTCD;              /*                       @OZ09548*/
         BAL   @14,PUTOUTCD                                        0339
*       CALL IODSTRT;               /* SETUP NEW CARD        @OZ09548*/
         BAL   @14,IODSTRT                                         0340
*     END;                          /*                       @OZ09548*/
*   ELSE                            /*                       @OZ09548*/
*     DO;                           /*                       @OZ09548*/
         B     @RC00337                                            0342
@RF00337 DS    0H                                                  0343
*       CNT=CNT+1;                  /*                       @OZ09548*/
         LA    @15,1                                               0343
         AL    @15,CNT                                             0343
         ST    @15,CNT                                             0343
*       OLDJ=J;                     /*                       @OZ09548*/
         ST    J,OLDJ                                              0344
*     END;                          /*                       @OZ09548*/
*   END COMCHAN;                    /*                       @OZ09548*/
@EL00006 DS    0H                                                  0346
@EF00006 DS    0H                                                  0346
@ER00006 LM    @14,@04,@SA00006                                    0346
         LM    @06,@12,@SA00006+28                                 0346
         BR    @14                                                 0346
*                                                                  0347
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - SORT3                                   @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - SORT THREE CHANNEL NUMBERIS INTO ASCENDING    @YD00113*/
*/*            SEQUENCE BY CALLING THE SORT2 ROUTINE 4 TIMES @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0347
*SORT3:                                                            0347
*   PROCEDURE;                      /*                       @Y30LB14*/
SORT3    STM   @14,@12,@SA00007                                    0347
*   DO L=1 TO 2;                    /*                       @Y30LB14*/
         LA    L,1                                                 0348
@DL00348 DS    0H                                                  0349
*     DO K=1 TO 2;                  /*                       @Y30LB14*/
         LA    @15,1                                               0349
         ST    @15,K                                               0349
@DL00349 DS    0H                                                  0350
*       CALL SORT2;                 /* SORT TWO NUMBERS      @Y30LB14*/
         BAL   @14,SORT2                                           0350
*     END;                          /* END DO K LOOP         @Y30LB14*/
         LA    @15,1                                               0351
         AL    @15,K                                               0351
         ST    @15,K                                               0351
         CH    @15,@CH00053                                        0351
         BNH   @DL00349                                            0351
*   END;                            /* END DO L LOOP         @Y30LB14*/
         AL    L,@CF00045                                          0352
         CH    L,@CH00053                                          0352
         BNH   @DL00348                                            0352
*   RETURN;                         /*                       @Y30LB14*/
@EL00007 DS    0H                                                  0353
@EF00007 DS    0H                                                  0353
@ER00007 LM    @14,@12,@SA00007                                    0353
         BR    @14                                                 0353
*   END SORT3;                      /*                       @Y30LB14*/
*                                                                  0355
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - SORT2                                   @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - SORT TWO NUMBERS INTO ASCENDING SEQUENCE BY   @YD00113*/
*/*            USING THE TECHNIQUE OF EXCHANGE.              @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0355
*SORT2:                                                            0355
*   PROCEDURE;                      /*                       @Y30LB14*/
SORT2    STM   @14,@12,12(@13)                                     0355
*   IF CH(K)>CH(K+1) THEN                                          0356
         L     @15,K                                               0356
         SLA   @15,2                                               0356
         L     @05,CH-4(@15)                                       0356
         L     @01,CH(@15)                                         0356
         CR    @05,@01                                             0356
         BNH   @RF00356                                            0356
*     DO;                           /*                       @Y30LB14*/
*       SAV=CH(K+1);                /*                       @Y30LB14*/
         LR    SAV,@01                                             0358
*       CH(K+1)=CH(K);              /*                       @Y30LB14*/
         ST    @05,CH(@15)                                         0359
*       CH(K)=SAV;                  /*                       @Y30LB14*/
         ST    SAV,CH-4(@15)                                       0360
*     END;                          /*                       @Y30LB14*/
*   RETURN;                         /*                       @Y30LB14*/
@EL00008 DS    0H                                                  0362
@EF00008 DS    0H                                                  0362
@ER00008 LM    @14,@12,12(@13)                                     0362
         BR    @14                                                 0362
*   END SORT2;                      /*                       @Y30LB14*/
         B     @EL00008                                            0363
*                                                                  0364
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - ENDGRP                                  @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE CONVERTS THE COUNT OF THE NUMBER @YD00113*/
*/*            OF ENTRIES IN ONE GROUP TO CHARACTER FORM AND @YD00113*/
*/*            INSERTS IT IN THE CARD IMAGE.  THE POINTER    @YD00113*/
*/*            'N' POINTS TO THE SECOND ')' WHICH IS WRITTEN @YD00113*/
*/*            OVER IF THE CARD CAN BE CONTINUED.  IF NOT,   @YD00113*/
*/*            THE END OF THE CARD IS CORRECT.               @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0364
*ENDGRP:                                                           0364
*   PROCEDURE;                      /*                       @Y30LB14*/
ENDGRP   STM   @14,@04,12(@13)                                     0364
         STM   @06,@12,44(@13)                                     0364
*   OLDI=I;                         /* REFLECT ANY CHANGE IN CHAN. OR
*                                      CUA                   @OZ05131*/
*                                                                  0365
         STH   I,OLDI                                              0365
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* IN THE UNIT FIELD OF THE UNITNAME CONTROL             @YD00113*/
*   /* STATEMENT, FROM 1 TO 64 DEVICES CAN BE                @YD00113*/
*   /* INDICATED BY A SUB-GROUP. THE NUMBER IN THE           @YD00113*/
*   /* SUB-GROUP IS ALWAYS EXPLICITLY EXPRESSED, EVEN        @YD00113*/
*   /* IF THE NUMBER IS ONE.                                 @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*   INBUF(N)=',';                   /*                       @Y30LB14*/
         LR    @15,R4                                              0366
         ALR   @15,N                                               0366
         MVI   INBUF-1(@15),C','                                   0366
*   N=N+1;                          /*                       @Y30LB14*/
*                                                                  0367
         LA    @15,1                                               0367
         ALR   N,@15                                               0367
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YM31086*/
*   /* IF THE COUNT OF SEQUENTIAL ADDRESSES IS EQUAL         @YM31086*/
*   /* TO OR GREATER THAT 10, COMPUTE THE CHARACTER          @YM31086*/
*   /* REPRESENTATION OF THE HIGH-ORDER DIGIT AND            @YM31086*/
*   /* PUT THAT CHARACTER IN THE RECORD. BUMP THE            @YM31086*/
*   /* NEXT COLUMN POINTER BY ONE.                           @YM31086*/
*   /* ***********************************************       @YM31086*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   IF CNT>=10                      /*                       @YM31086*/
*     THEN                                                         0368
         L     @03,CNT                                             0368
         LA    @01,10                                              0368
         CR    @03,@01                                             0368
         BL    @RF00368                                            0368
*     DO;                           /*                       @Y30LB14*/
*       INBUF(N)=TABLE(CNT/10+1);   /*                       @Y30LB14*/
         LR    @09,R4                                              0370
         ALR   @09,N                                               0370
         LR    @06,@03                                             0370
         SRDA  @06,32                                              0370
         DR    @06,@01                                             0370
         LA    @03,TABLE(@07)                                      0370
         MVC   INBUF-1(1,@09),0(@03)                               0370
*       N=N+1;                      /*                       @Y30LB14*/
         ALR   N,@15                                               0371
*     END;                          /*                       @Y30LB14*/
*                                                                  0372
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* COMPUTE THE LOW-ORDER OR ONLY DIGIT OF THE            @YD00113*/
*   /* NUMBER OF RECORDS IN THE GROUP.                       @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0373
*   INBUF(N)=TABLE(CNT//10+1);      /*                       @Y30LB14*/
@RF00368 LR    @15,R4                                              0373
         ALR   @15,N                                               0373
         L     @06,CNT                                             0373
         SRDA  @06,32                                              0373
         D     @06,@CF00033                                        0373
         LA    @03,TABLE(@06)                                      0373
         MVC   INBUF-1(1,@15),0(@03)                               0373
*   N=N+1;                          /*                       @Y30LB14*/
*                                                                  0374
         LA    @15,1                                               0374
         ALR   N,@15                                               0374
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* COMPLETE THE SUBGROUP WITH TWO RIGHT                  @YD00113*/
*   /* PARENTHESES. IF ANOTHER SUBGROUP CAN BE               @YD00113*/
*   /* IN THE SAME RECORD, THE LAST PARENTHESIS WILL         @YD00113*/
*   /* BE OVERWRITTEN BY A COMMA.                            @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0375
*   INBUF(N:N+1)='))';              /*                       @Y30LB14*/
         LR    @03,R4                                              0375
         ALR   @03,N                                               0375
         MVC   INBUF-1(2,@03),@CC00748                             0375
*   N=N+1;                          /* N NOW POINTS TO LAST )      0376
*                                                            @Y30LB14*/
         ALR   N,@15                                               0376
*   RETURN;                         /*                       @Y30LB14*/
@EL00009 DS    0H                                                  0377
@EF00009 DS    0H                                                  0377
@ER00009 LM    @14,@04,12(@13)                                     0377
         LM    @06,@12,44(@13)                                     0377
         BR    @14                                                 0377
*   END ENDGRP;                     /*                       @Y30LB14*/
*                                                                  0379
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - STARTCRD                                @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A UNITNAME  @YD00113*/
*/*            CARD IMAGE IS STARTED.  THE CUD AND SDG       @YD00113*/
*/*            NUMBER ARE INSERTED IN THEIR APPROPRIATE      @YD00113*/
*/*            PLACES IN THE CARD IMAGE                      @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0379
*STARTCRD:                                                         0379
*   PROCEDURE;                      /*                       @Y30LB14*/
STARTCRD STM   @14,@04,12(@13)                                     0379
         STM   @06,@12,44(@13)                                     0379
*   INBUF='';                       /* CLEAR INBUF PRIOR TO BUILD  0380
*                                                            @OZ09534*/
         MVI   INBUF(R4),C' '                                      0380
         MVC   INBUF+1(79,R4),INBUF(R4)                            0380
*   IF RESET='1'B THEN              /* RESET SEQUENCE NUMBER @OZ09534*/
         TM    RESET,B'01000000'                                   0381
         BNO   @RF00381                                            0381
*     DO;                           /*                       @OZ09534*/
*       SEQNUM=0;                   /*                       @OZ09534*/
         SLR   @15,@15                                             0383
         STH   @15,SEQNUM                                          0383
*       RESET='0'B;                 /*                       @OZ09534*/
*                                                                  0384
         NI    RESET,B'10111111'                                   0384
*       /*************************************************************/
*       /*                                                           */
*       /* SEQUENCE NUMBERS STARTING AT 1                    @OZ09534*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0385
*     END;                          /*                       @OZ09534*/
*                                                                  0385
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* PLACE CONSTANT INFORMATION IN CARD IMAGE              @YD00113*/
*   /* BUFFER AND SET 'SW' OR 'SW1' TO INDICATE NOT          @G18MB73*/
*   /* FIRST TIME.                                           @G18MB73*/
*   /* ***********************************************       @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0386
*   IF LOCALJES='1'B&UCOMP='1'B     /* TEST LOCALJES SW ON   @G18MB73*/
*     THEN                          /*                       @G18MB73*/
@RF00381 TM    LOCALJES,B'01100000'                                0386
         BNO   @RF00386                                            0386
*     DO;                           /*                       @G18MB73*/
*       INBUF(1:26)='J        UNITNAME NAME=SDG';/*          @G18MB73*/
         MVC   INBUF(26,R4),@CC00754                               0388
*       SW1='0'B;                   /*                       @G18MB73*/
         NI    SW1,B'11101111'                                     0389
*     END;                          /*                       @G18MB73*/
*   ELSE                            /*                       @G18MB73*/
*     DO;                           /*                       @G18MB73*/
         B     @RC00386                                            0391
@RF00386 DS    0H                                                  0392
*       INBUF(1:26)='U        UNITNAME NAME=SDG';/*          @G18MB73*/
         MVC   INBUF(26,R4),@CC00757                               0392
*       SW=0;                       /*                       @G18MB73*/
         MVI   SW,X'00'                                            0393
*     END;                          /*                       @G18MB73*/
*                                                                  0394
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* MOVE CHARACTER REPRESENTATION OF SDG TO BOTH          @YD00113*/
*   /* LABEL FIELD AND THE NAME FIELD AND THE MACHINE        @YD00113*/
*   /* SERIAL NUMBER TO THE LABEL FIELD.                     @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*   INBUF(7:8)=CURRSG;              /*                       @Y30LB14*/
@RC00386 MVC   INBUF+6(2,R4),CURRSG                                0395
*   INBUF(2:6)=UNPACKED(2:6);       /*                       @Y30LB14*/
         MVC   INBUF+1(5,R4),UNPACKED+1                            0396
*   INBUF(27:28)=INBUF(7:8);        /*                       @Y30LB14*/
*                                                                  0397
         MVC   INBUF+26(2,R4),INBUF+6(R4)                          0397
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* MOVE UNIT FIELD CONSTANT INFORMATION TO CARD          @YD00113*/
*   /* IMAGE BUFFER                                          @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0398
*   N=29;                           /*                       @Y30LB14*/
         LA    N,29                                                0398
*   INBUF(N:N+7)=',UNIT=((';        /*                       @Y30LB14*/
         LR    @15,R4                                              0399
         ALR   @15,N                                               0399
         MVC   INBUF-1(8,@15),@CC00763                             0399
*   N=N+8;                          /*                       @Y30LB14*/
*                                                                  0400
         AL    N,@CF00043                                          0400
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* MOVE UCB ADDRESS TO CARD IMAGE BUFFER                 @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   INBUF(N:N+2)=CUD;               /*                       @Y30LB14*/
         LR    @15,R4                                              0401
         ALR   @15,N                                               0401
         MVC   INBUF-1(3,@15),CUD                                  0401
*   N=N+3;                          /*                       @Y30LB14*/
*                                                                  0402
         AL    N,@CF00051                                          0402
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* SAVE INDEX INDICATING SEQUENTIAL ADDRESS AND          @YD00113*/
*   /* SET SEQUENTIAL ADDRESS COUNT TO 1                     @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   OLDJ=J;                         /* CONSECUTIVE DEVICE ADDRESSING
*                                                            @Y30LB14*/
         ST    J,OLDJ                                              0403
*   OLDI=I;                         /* SET FOR CHAN / CUA CHK      0404
*                                                            @OZ05131*/
         STH   I,OLDI                                              0404
*   CNT=1;                          /*                       @Y30LB14*/
         MVC   CNT(4),@CF00045                                     0405
*   RETURN;                         /*                       @Y30LB14*/
@EL00010 DS    0H                                                  0406
@EF00010 DS    0H                                                  0406
@ER00010 LM    @14,@04,12(@13)                                     0406
         LM    @06,@12,44(@13)                                     0406
         BR    @14                                                 0406
*   END STARTCRD;                   /*                       @Y30LB14*/
*/********************************************************** @G18MB73*/
*/*                                                          @G18MB73*/
*/* PROCEDURE NAME - BUILDIT                                 @G18MB73*/
*/*                                                          @G18MB73*/
*/* FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A UNITNAME  @G18MB73*/
*/*            OR J-NAME CARD IMAGE IS STARTED. THE CUD AND  @G18MB73*/
*/*            SDG NUMBER ARE INSERTED IN THEIR APPROPRIATE  @G18MB73*/
*/*            PLACES IN THE CARD IMAGE.                     @G18MB73*/
*/*                                                          @G18MB73*/
*/********************************************************** @G18MB73*/
*                                                                  0408
*BUILDIT:                                                          0408
*   PROCEDURE;                      /*                       @G18MB73*/
*                                                                  0408
BUILDIT  STM   @14,@04,@SA00011                                    0408
         STM   @06,@12,@SA00011+28                                 0408
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @G18MB73*/
*   /* PLACE CONSTANT INFORMATION IN CARD IMAGE              @G18MB73*/
*   /* ***********************************************       @G18MB73*/
*   /* ***************************************               @G18MB73*/
*   /* UNPACK CPUID SO THAT CHARACTERS 2-6                   @G18MB73*/
*   /* WILL BE AVAILABLE TO PLACE IN THE                     @G18MB73*/
*   /* LABEL FIELD OF THE UNITNAME STATEMENT                 @G18MB73*/
*   /* ***************************************               @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   CALL CPUIDP;                    /* UNPACK CPU ID         @G18MB73*/
*                                                                  0409
         BAL   @14,CPUIDP                                          0409
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @G18MB73*/
*   /* DEVELOP THE CHANNEL/CONTROL UNIT/                     @G18MB73*/
*   /* DEVICE ADDRESS OF THE FIRST ENTRY IN                  @G18MB73*/
*   /* THIS GROUP.                                           @G18MB73*/
*   /* ***************************************               @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   CALL CUDADDR;                   /* CHANNEL, UNIT DEVICE  @G18MB73*/
*                                                                  0410
         BAL   @14,CUDADDR                                         0410
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @G18MB73*/
*   /* DEVELOP THE SDG NUMBER FOR THIS                       @G18MB73*/
*   /* ENTRY AS TWO PRINTABLE CHARACTERS                     @G18MB73*/
*   /* ***************************************               @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   CALL CURNTRSG;                  /* CURRENT RSG           @G18MB73*/
*                                                                  0411
         BAL   @14,CURNTRSG                                        0411
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @G18MB73*/
*   /* 'SW&SW1' ARE FIRST TIME SWITCHES AND                  @G18MB73*/
*   /* FORCE THE FIRST BUILD OF THE BASE                     @G18MB73*/
*   /* UNITNAME RECORD TYPE IN THE BUFFER.                   @G18MB73*/
*   /* BASE RECORD WILL BE REBUILT AFTER                     @G18MB73*/
*   /* EACH RECORD IS PUNCHED AND PRINTED.                   @G18MB73*/
*   /* ***************************************               @G18MB73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   IF SW1='1'B×SW=1                /*                       @G18MB73*/
*     THEN                          /*                       @G18MB73*/
         TM    SW1,B'00010000'                                     0412
         BO    @RT00412                                            0412
         CLI   SW,1                                                0412
         BNE   @RF00412                                            0412
@RT00412 DS    0H                                                  0413
*     CALL STARTCRD;                /* START A CARD          @G18MB73*/
         BAL   @14,STARTCRD                                        0413
*   ELSE                            /*                       @G18MB73*/
*                                                                  0414
*     /***************************************************************/
*     /*                                                             */
*     /* **************************************              @G18MB73*/
*     /* IF THIS IS NOT THE VERY FIRST TIME                  @G18MB73*/
*     /* THROUGH THIS CODE (SW1=0), COMPARE                  @G18MB73*/
*     /* CHARACTERS 2-6 OF THE CURRENT CPU                   @G18MB73*/
*     /* AGAINST CHACATERS 2-6 OF THE RECORD                 @G18MB73*/
*     /* CURRENTLY BEING BUILT, AND COMPARE                  @G18MB73*/
*     /* THE SDG OF THE CURRENT ENTRY AGAINST                @G18MB73*/
*     /* CHARACTERS 7-8 (SDG) OF THE RECORD                  @G18MB73*/
*     /* CURRENTLY BEING BUILT. IF THERE IS                  @G18MB73*/
*     /* A NON-MATCH ON EITHER OF THESE ITEMS,               @G18MB73*/
*     /* PERFORM THE STEPS TO END THIS RECORD,               @G18MB73*/
*     /* PUNCH AND PRINT THE RECORD, AND BUILD               @G18MB73*/
*     /* THE BASE INFORMATION FOR THE NEXT                   @G18MB73*/
*     /* RECORD IN THE OUTPUT BUFFER.                        @G18MB73*/
*     /* **************************************              @G18MB73*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0414
*     DO;                           /*                       @G18MB73*/
         B     @RC00412                                            0414
@RF00412 DS    0H                                                  0415
*       IF CURRSG^=INBUF(7:8)×      /*                       @G18MB73*/
*           UNPACKED(2:6)^=INBUF(2:6)/*                      @G18MB73*/
*         THEN                      /*                       @G18MB73*/
         CLC   CURRSG(2),INBUF+6(R4)                               0415
         BNE   @RT00415                                            0415
         CLC   UNPACKED+1(5),INBUF+1(R4)                           0415
         BE    @RF00415                                            0415
@RT00415 DS    0H                                                  0416
*         DO;                       /*                       @G18MB73*/
*           CALL ENDGRP;            /* END GROUP ON CD       @G18MB73*/
         BAL   @14,ENDGRP                                          0417
*           CALL PUTOUTCD;          /* PUNCH A CARD          @G18MB73*/
         BAL   @14,PUTOUTCD                                        0418
*           CALL STARTCRD;          /* START A CARD          @G18MB73*/
         BAL   @14,STARTCRD                                        0419
*         END;                      /*                       @G18MB73*/
*                                                                  0420
*       /*************************************************************/
*       /*                                                           */
*       /* **********************************                @G18MB73*/
*       /* PERFORM THIS LOGIC IF THE SAME                    @G18MB73*/
*       /* CPU AND SDG IN CURRENT ENTRY AS                   @G18MB73*/
*       /* IN RECORD BEING BUILT.                            @G18MB73*/
*       /* **********************************                @G18MB73*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0421
*       ELSE                        /*                       @G18MB73*/
*         DO;                       /*                       @G18MB73*/
*                                                                  0421
         B     @RC00415                                            0421
@RF00415 DS    0H                                                  0422
*           /*********************************************************/
*           /*                                                       */
*           /* *******************************               @G18MB73*/
*           /* IF THERE WAS A SKIP (UNUSED                   @G18MB73*/
*           /* ADDRESS OR ADDRESS USED FOR                   @G18MB73*/
*           /* SOMETHING OTHER THAN VIRTUAL                  @G18MB73*/
*           /* OR VIRTUAL SHARED), START A                   @G18MB73*/
*           /* NEW ADDRESSING GROUP ON THE                   @G18MB73*/
*           /* SAME RECORD.                                  @G18MB73*/
*           /* *******************************               @G18MB73*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0422
*           IF OLDJ+1^=J×OLDI^=I    /*                       @G18MB73*/
*             THEN                  /*                       @G18MB73*/
         LA    @15,1                                               0422
         AL    @15,OLDJ                                            0422
         CR    @15,J                                               0422
         BNE   @RT00422                                            0422
         CH    I,OLDI                                              0422
         BE    @RF00422                                            0422
@RT00422 DS    0H                                                  0423
*             DO;                   /*                       @G18MB73*/
*               CALL ENDGRP;        /* END GROUP             @G18MB73*/
*                                                                  0424
         BAL   @14,ENDGRP                                          0424
*               /*****************************************************/
*               /*                                                   */
*               /* ***************************               @G18MB73*/
*               /* IF THERE IS ENOUGH SPACE                  @G18MB73*/
*               /* LEFT, SET UP CONSTANTS                    @G18MB73*/
*               /* AND STARTING DEVICE ADDR                  @G18MB73*/
*               /* FOR THE NEXT GROUP ON THE                 @G18MB73*/
*               /* SAME STATEMENT.                           @G18MB73*/
*               /* ***************************               @G18MB73*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0425
*               IF N<=62            /*                       @G18MB73*/
*                 THEN              /*                       @G18MB73*/
         CH    N,@CH00768                                          0425
         BH    @RF00425                                            0425
*                 DO;               /*                       @G18MB73*/
*                   INBUF(N:N+1)=',(';/*                     @G18MB73*/
         LR    @15,R4                                              0427
         ALR   @15,N                                               0427
         MVC   INBUF-1(2,@15),@CC00769                             0427
*                   N=N+2;          /*                       @G18MB73*/
         AH    N,@CH00053                                          0428
*                   INBUF(N:N+2)=CUD;/*                      @G18MB73*/
         LR    @15,R4                                              0429
         ALR   @15,N                                               0429
         MVC   INBUF-1(3,@15),CUD                                  0429
*                   N=N+3;          /*                       @G18MB73*/
         AL    N,@CF00051                                          0430
*                   CNT=1;          /*                       @G18MB73*/
         MVC   CNT(4),@CF00045                                     0431
*                   OLDJ=J;         /*                       @G18MB73*/
         ST    J,OLDJ                                              0432
*                 END;              /*                       @G18MB73*/
*                                                                  0433
*               /*****************************************************/
*               /*                                                   */
*               /* *************************                 @G18MB73*/
*               /* OTHERWISE PRINT AND                       @G18MB73*/
*               /* THIS STATEMENT AND SET                    @G18MB73*/
*               /* BASE INFORMATION FOR                      @G18MB73*/
*               /* THE NEXT STATEMENT.                       @G18MB73*/
*               /* *************************                 @G18MB73*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0434
*               ELSE                /*                       @G18MB73*/
*                 DO;               /*                       @G18MB73*/
         B     @RC00425                                            0434
@RF00425 DS    0H                                                  0435
*                   CALL PUTOUTCD;  /*                       @G18MB73
*                                      PUNCH A CARD          @G18MB73*/
         BAL   @14,PUTOUTCD                                        0435
*                   CALL STARTCRD;  /*                       @G18MB73
*                                      START A CARD          @G18MB73*/
         BAL   @14,STARTCRD                                        0436
*                 END;              /*                       @G18MB73*/
*             END;                  /*                       @G18MB73*/
*                                                                  0438
*           /*********************************************************/
*           /*                                                       */
*           /* *****************************                 @G18MB73*/
*           /* IF NO SKIP IN THE ADDRESS                     @G18MB73*/
*           /* SEQUENCE, ADD ONE TO THE                      @G18MB73*/
*           /* COUNT OF SEQUENTIAL ADDRS                     @G18MB73*/
*           /* THAT MAKE UP THIS GROUP.                      @G18MB73*/
*           /* *****************************                 @G18MB73*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0439
*           ELSE                    /*                       @G18MB73*/
*             DO;                   /*                       @G18MB73*/
         B     @RC00422                                            0439
@RF00422 DS    0H                                                  0440
*               CNT=CNT+1;          /*                       @G18MB73*/
         LA    @15,1                                               0440
         AL    @15,CNT                                             0440
         ST    @15,CNT                                             0440
*               OLDJ=J;             /*                       @G18MB73*/
         ST    J,OLDJ                                              0441
*             END;                  /*                       @G18MB73*/
*         END;                      /*                       @G18MB73*/
*     END;                          /*                       @G18MB73*/
*   RETURN;                         /* TO MAINLINE           @G18MB73*/
@EL00011 DS    0H                                                  0445
@EF00011 DS    0H                                                  0445
@ER00011 LM    @14,@04,@SA00011                                    0445
         LM    @06,@12,@SA00011+28                                 0445
         BR    @14                                                 0445
*   END BUILDIT;                    /*                       @G18MB73*/
         B     @EL00011                                            0446
*                                                                  0447
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - CURNTRSG                                @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE SETS UP THE SDG NUMBER IN        @YD00113*/
*/*            CHARACTER FORM IN THE CURRSG STRUCTURE.       @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0447
*CURNTRSG:                                                         0447
*   PROCEDURE;                      /*                       @Y30LB14*/
CURNTRSG STM   @14,@12,12(@13)                                     0447
*   UD=INDEXRSG(I,J)//10;           /*                       @Y30LB14*/
         LA    @15,10                                              0448
         LR    @01,I                                               0448
         SLA   @01,6                                               0448
         ALR   @01,J                                               0448
         MH    @01,@CH00034                                        0448
         L     @09,COMPTR2(,R4)                                    0448
         AL    @09,@CF00837                                        0448
         SLR   @08,@08                                             0448
         IC    @08,INDEXRSG-465(@01,@09)                           0448
         LR    @06,@08                                             0448
         SRDA  @06,32                                              0448
         DR    @06,@15                                             0448
         LR    UD,@06                                              0448
*   LCURRSG=TABLE(UD+1);            /*                       @Y30LB14*/
         LA    @01,TABLE(UD)                                       0449
         MVC   LCURRSG(1),0(@01)                                   0449
*   UD=(INDEXRSG(I,J)/10)//10;      /*                       @Y30LB14*/
         LR    @07,@08                                             0450
         SLR   @06,@06                                             0450
         DR    @06,@15                                             0450
         LR    @08,@07                                             0450
         SRDA  @08,32                                              0450
         DR    @08,@15                                             0450
         LR    UD,@08                                              0450
*   HCURRSG=TABLE(UD+1);            /*                       @Y30LB14*/
         LA    @15,TABLE(UD)                                       0451
         MVC   HCURRSG(1),0(@15)                                   0451
*   RETURN;                         /*                       @Y30LB14*/
@EL00012 DS    0H                                                  0452
@EF00012 DS    0H                                                  0452
@ER00012 LM    @14,@12,12(@13)                                     0452
         BR    @14                                                 0452
*   END CURNTRSG;                   /*                       @Y30LB14*/
*                                                                  0454
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - SCANOPEN                                @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE COPIES THE MODEL DCB FOR         @YD00113*/
*/*            SYSPUNCH INTO THE AREA PREVIOUSLY USED FOR    @YD00113*/
*/*            SYSIN DCB IN COMTAB, ESTABLISHES AND          @YD00113*/
*/*            ACTIVATES THE DCB OPEN EXIT (USED TO CHECK    @YD00113*/
*/*            BLOCKSIZE), CHECKS FOR A SUBSTITUTE SYSPUNCH  @YD00113*/
*/*            DDNAME AND USES IT IF PRESENT, AND OPENS      @YD00113*/
*/*            SYSPUNCH.  IF OPEN IS NOT SUCCESSFUL,         @YD00113*/
*/*            MESSAGE ICG402I (WARNING ONLY) IS WRITTEN.    @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0454
*SCANOPEN:                                                         0454
*   PROCEDURE;                      /*                       @Y30LB14*/
*                                                                  0454
SCANOPEN STM   @14,@12,@SA00013                                    0454
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* COPY MODEL DCB TO GETMAIN'ED STORAGE AND              @YD00113*/
*   /* ESTABLISH ADDRESSABITILY OF FIELDS BY NAMES           @YD00113*/
*   /* IN DCBD MAPPING MACRO.                                @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0455
*   READDCB=MYDCB2A;                /* COPY SYSPUNCH DCB     @Y30LB14*/
         LA    @15,MYDCB2                                          0455
         MVC   READDCB(96,R4),MYDCB2A(@15)                         0455
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/
*                                                                  0456
         LA    @15,READDCB(,R4)                                    0456
         ST    @15,DCBPTR(,R4)                                     0456
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* SET UP FOR DCB OPEN EXIT                              @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0457
*   DCBEXLST=ADDR(EXLST);           /* PTR TO EXIT LIST      @Y30LB14*/
         LA    @05,EXLST(,R4)                                      0457
         ST    @05,DCBEXLST+28(,@15)                               0457
*   EXLST=ADDR(DCBROUT2);           /* PTR TO EXIT ROUT      @Y30LB14*/
         LA    @15,DCBROUT2                                        0458
         ST    @15,EXLST(,R4)                                      0458
*   EXLST(1)='85'X;                 /* ACTIVATE EXIT         @Y30LB14*/
*                                                                  0459
         MVI   EXLST(R4),X'85'                                     0459
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* CHECK FOR SUBSTITUTE SYSPUNCH DDNAME PASSED           @YD00113*/
*   /* INVOCATION FROM A PROBLE PROGRAM                      @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0460
*   IF SVSYSPCH^='0000000000000000'X/* IF ALTERNATE          @Y30LB14*/
*     THEN                          /*                       @YD00113*/
         CLC   SVSYSPCH(8,R4),@CB00778                             0460
         BE    @RF00460                                            0460
*     READDCB(41:48)=SVSYSPCH;      /* USE ALTERNATE         @YD00113*/
         MVC   READDCB+40(8,R4),SVSYSPCH(R4)                       0461
*   ELSE                                                           0462
*     ;                             /*                       @YD00113*/
*                                                                  0462
@RF00460 DS    0H                                                  0463
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @YD00113*/
*   /* SET UP FOR THE EXECUTE FORM OF OPEN                   @YD00113*/
*   /* ***********************************************       @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*   OPENLIST=ADDR(READDCB);         /* ADDR OF SYSPCH DCB@Y30LB14    */
         LA    @15,READDCB(,R4)                                    0463
         ST    @15,OPENLIST(,R4)                                   0463
*   OPENLIST(1)='8F'X;              /* SET END-OF-LIST       @Y30LB12*/
         MVI   OPENLIST(R4),X'8F'                                  0464
*   R1=ADDR(OPENLIST);              /* ADDR OF DCB TO R1     @Y30LB14*/
         LA    R1,OPENLIST(,R4)                                    0465
*   GEN(OPEN  MF=(E,(1)));          /* OPEN SYSPUNCH         @Y30LB14*/
*                                                                  0466
         OPEN  MF=(E,(1))
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @Y30LB14*/
*   /* CHK TO SEE IF OPEN OF SYSPUNCH WAS SUCCESSFUL         @Y30LB14*/
*   /* ***********************************************       @Y30LB14*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/
         LA    @15,READDCB(,R4)                                    0467
         ST    @15,DCBPTR(,R4)                                     0467
*   IF DCBOFOPN^='1'B               /* SYSPUNCH NOT OPEN     @Y30LB14*/
*     THEN                          /*                       @Y30LB14*/
         TM    DCBOFOPN+40(@15),B'00010000'                        0468
         BO    @RF00468                                            0468
*     DO;                           /*                       @Y30LB14*/
*                                                                  0469
*       /*************************************************************/
*       /*                                                           */
*       /* *****************************************         @YD00113*/
*       /* SET 'FLAG' TO INDICATE SYSPUNCH NOT OPEN          @YD00113*/
*       /* AND WRITE WARNING MESSAGE 'ICG402I                @YD00113*/
*       /* UNABLE TO OPEN SYSPUNCH. OUTPUT LISTED            @YD00113*/
*       /* IN MESSAGE DATA SET.'                             @YD00113*/
*       /* *****************************************         @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       FLAG=1;                     /*                       @Y30LB14*/
         MVI   FLAG,X'01'                                          0470
*       MSGNO=ICG402I;              /* ID FOR ICG402I        @YM31086*/
         MVC   MSGNO(2,R4),ICG402I                                 0471
*       WARNING=WARNING+1;          /* BUMP WARNING CNT      @YM31086*/
         LA    @15,1                                               0472
         AH    @15,WARNING(,R4)                                    0472
         STH   @15,WARNING(,R4)                                    0472
*       GEN(LINK  EP=ICGDSMSG);     /* TO MSG WRITER         @YM31086*/
         LINK  EP=ICGDSMSG
*     END;                          /*                       @Y30LB14*/
*   ELSE                                                           0475
*     ;                             /* SYSPUNCH OPEN OK      @Y30LB14*/
@RF00468 DS    0H                                                  0476
*   RETURN;                         /*                       @Y30LB14*/
@EL00013 DS    0H                                                  0476
@EF00013 DS    0H                                                  0476
@ER00013 LM    @14,@12,@SA00013                                    0476
         BR    @14                                                 0476
*   END SCANOPEN;                   /*                       @Y30LB14*/
*                                                                  0478
*/********************************************************** @YD00113*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - PUTOUTCD                                @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE PUNCHES (IF SYSPUNCH IS OPEN)    @YD00113*/
*/*            AND PRINTS THE RECORD BUILT IN INBUF AND      @YD00113*/
*/*            CLEARS INBUF.                                 @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0478
*PUTOUTCD:                                                         0478
*   PROCEDURE;                      /*                       @Y30LB14*/
PUTOUTCD STM   @14,@04,@SA00014                                    0478
         STM   @06,@12,@SA00014+28                                 0478
*   IF IODSW='1'B THEN              /* IN IODEVICE ROUTINE   @OZ09548*/
         TM    IODSW,B'10000000'                                   0479
         BNO   @RF00479                                            0479
*     DO;                           /*                       @OZ09548*/
*                                                                  0480
*       /*************************************************************/
*       /*                                                           */
*       /* ***************************************           @OZ09548*/
*       /* CALL ROUTINE TO CONVERT BINARY                    @OZ09548*/
*       /* SEQUENCE NUMBER INTO TWO PRINTABLE                @OZ09548*/
*       /* CHARACTERS WHICH ARE PLACED IN BYTES              @OZ09548*/
*       /* 7 AND 8 OF THE LABEL FIELD.                       @OZ09548*/
*       /* ***************************************           @OZ09548*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0481
*       SEQNUM=SEQNUM+1;            /* INCREMENT CARD COUNT  @OZ09548*/
         MVC   @ZT00002+2(2),SEQNUM                                0481
         L     @01,@ZT00002                                        0481
         LA    @01,1(,@01)                                         0481
         STH   @01,SEQNUM                                          0481
*       CALL SEQUENCE;              /*                       @OZ09548*/
         BAL   @14,SEQUENCE                                        0482
*       IF CNT>=10 THEN             /*                       @OZ09548*/
         L     @15,CNT                                             0483
         LA    @01,10                                              0483
         CR    @15,@01                                             0483
         BL    @RF00483                                            0483
*         DO;                       /*                       @OZ09548*/
*           INBUF(32)=TABLE(CNT/10+1);/*                     @OZ09548*/
         LR    @02,@15                                             0485
         SRDA  @02,32                                              0485
         DR    @02,@01                                             0485
         LA    @02,TABLE(@03)                                      0485
         MVC   INBUF+31(1,R4),0(@02)                               0485
*           INBUF(33)=TABLE(CNT//10+1);/*                    @OZ09548*/
         LR    @02,@15                                             0486
         SRDA  @02,32                                              0486
         DR    @02,@01                                             0486
         LA    @15,TABLE(@02)                                      0486
         MVC   INBUF+32(1,R4),0(@15)                               0486
*         END;                      /*                       @OZ09548*/
*                                                                  0487
*       /*************************************************************/
*       /*                                                           */
*       /* ***********************************************   @OZ09548*/
*       /* COMPUTE THE LOW-ORDER OR ONLY DIGIT OF THE        @OZ09548*/
*       /* NUMBER OF RECORDS IN THE GROUP.                   @OZ09548*/
*       /* ***********************************************   @OZ09548*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0488
*       ELSE                        /*                       @OZ09548*/
*         DO;                       /*                       @OZ09548*/
         B     @RC00483                                            0488
@RF00483 DS    0H                                                  0489
*           INBUF(32)=TABLE(CNT//10+1);/*                    @OZ09548*/
         L     @02,CNT                                             0489
         SRDA  @02,32                                              0489
         D     @02,@CF00033                                        0489
         LA    @15,TABLE(@02)                                      0489
         MVC   INBUF+31(1,R4),0(@15)                               0489
*           INBUF(33:71)=INBUF(34:72);/* SHIFT CNT FLD       @OZ09534*/
         MVC   @TS00001(39),INBUF+33(R4)                           0490
         MVC   INBUF+32(39,R4),@TS00001                            0490
*           N=N-1;                  /* RESET NEXT COLUMN PTR @OZ09534*/
         BCTR  N,0                                                 0491
*         END;                      /*                       @OZ09548*/
*                                                                  0492
*       /*************************************************************/
*       /*                                                           */
*       /* ***********************************************   @YD00113*/
*       /* VERIFY OVERFLOW OR UNITNAME CONDITIONS AND,       @OZ09534*/
*       /* IF SYSPUNCH HAS BEEN OPENED, PUNCH CARD.          @OZ09534*/
*       /* ***********************************************   @YD00113*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0493
*       IF OVRFLW='1'B THEN         /*                       @OZ09534*/
@RC00483 TM    OVRFLW,B'00010000'                                  0493
         BNO   @RF00493                                            0493
*         DO;                       /*                       @OZ09534*/
*           INBUF(N)=',';           /* PREPARE SYSGEN FORMAT @OZ09534*/
         LR    @15,R4                                              0495
         ALR   @15,N                                               0495
         MVI   INBUF-1(@15),C','                                   0495
*           INBUF(72)='*';          /*                       @OZ09534*/
         MVI   INBUF+71(R4),C'*'                                   0496
*           IF FLAG=0 THEN          /*                       @OZ09534*/
         CLI   FLAG,0                                              0497
         BNE   @RF00497                                            0497
*             DO;                   /*                       @OZ09534*/
*               R1=ADDR(READDCB);   /* ADDR OF DCB           @OZ09534*/
         LA    R1,READDCB(,R4)                                     0499
*               R0=ADDR(INBUF);     /* ADDR OF I/O AREA      @OZ09534*/
         LA    R0,INBUF(,R4)                                       0500
*               GEN(PUT   (1),(0)); /* GET REG NOTATION      @OZ09534*/
         PUT   (1),(0)
*             END;                  /*                       @OZ09534*/
*           PRNTCARD='1'B;          /* PRINT CARD ON         @OZ09534*/
@RF00497 OI    PRNTCARD(R4),B'00010000'                            0503
*           GEN(LINK  EP=ICGDSMSG); /* CALL MSG WRITER       @OZ09534*/
         LINK  EP=ICGDSMSG
*           LASTPARM='0'B;          /* RESET END-OF-CARD     @OZ09534*/
         NI    LASTPARM(R4),B'11110111'                            0505
*           INBUF(1:72)='';         /*                       @OZ09534*/
         MVI   INBUF(R4),C' '                                      0506
         MVC   INBUF+1(71,R4),INBUF(R4)                            0506
*           INBUF(16:31)='FEATURE=(SHARED)';/* CONTINUATION  @OZ09534
*                                      CARD                  @OZ09534*/
         MVC   INBUF+15(16,R4),@CC00790                            0507
*           SEQNUM=SEQNUM+1;        /*                       @OZ09534*/
         MVC   @ZT00002+2(2),SEQNUM                                0508
         L     @01,@ZT00002                                        0508
         LA    @01,1(,@01)                                         0508
         STH   @01,SEQNUM                                          0508
*           SETSEQ='1'B;            /*                       @OZ09534*/
         OI    SETSEQ,B'00001000'                                  0509
*           CALL SEQUENCE;          /*                       @OZ09534*/
         BAL   @14,SEQUENCE                                        0510
*           IF FLAG=0 THEN          /*                       @OZ09534*/
         CLI   FLAG,0                                              0511
         BNE   @RF00511                                            0511
*             DO;                   /*                       @OZ09534*/
*               R1=ADDR(READDCB);   /* ADDR OF DCB           @OZ09534*/
         LA    R1,READDCB(,R4)                                     0513
*               R0=ADDR(INBUF);     /* ADDR OF I/O AREA      @OZ09534*/
         LA    R0,INBUF(,R4)                                       0514
*               GEN(PUT   (1),(0)); /* GET REG NOTATION      @OZ09534*/
         PUT   (1),(0)
*             END;                  /* FLAG = OFF            @OZ09534*/
*           PRNTCARD='1'B;          /* PRINT CARD ON         @OZ09534*/
@RF00511 OI    PRNTCARD(R4),B'00010000'                            0517
*           GEN(LINK  EP=ICGDSMSG); /* CALL MSG WRITER       @OZ09534*/
         LINK  EP=ICGDSMSG
*           LASTPARM='0'B;          /* RESET END-OF-CARD     @OZ09534*/
         NI    LASTPARM(R4),B'11110111'                            0519
*           SWIOD=0;                /* RESET SWITCHES FOR NEW CARD 0520
*                                                            @OZ09534*/
         MVI   SWIOD,X'00'                                         0520
*           INBUF='';               /* CLEAR INBUF           @OZ09534*/
         MVI   INBUF(R4),C' '                                      0521
         MVC   INBUF+1(79,R4),INBUF(R4)                            0521
*           RETURN;                 /*                       @OZ09534*/
@EL00014 DS    0H                                                  0522
@EF00014 DS    0H                                                  0522
@ER00014 LM    @14,@04,@SA00014                                    0522
         LM    @06,@12,@SA00014+28                                 0522
         BR    @14                                                 0522
*         END;                      /* NO OVERFLOW           @OZ09534*/
*       IF FLAG=0 THEN              /*                       @OZ09534*/
@RF00493 CLI   FLAG,0                                              0524
         BNE   @RF00524                                            0524
*         DO;                       /*                       @OZ09534*/
*           R1=ADDR(READDCB);       /* ADDR OF DCB           @OZ09534*/
         LA    R1,READDCB(,R4)                                     0526
*           R0=ADDR(INBUF);         /* ADDR OF I/O AREA      @OZ09534*/
         LA    R0,INBUF(,R4)                                       0527
*           GEN(PUT   (1),(0));     /* GET REG NOTATION      @OZ09534*/
         PUT   (1),(0)
*         END;                      /*                       @OZ09534*/
*       PRNTCARD='1'B;              /* PRINT CARD ON         @OZ09534*/
@RF00524 OI    PRNTCARD(R4),B'00010000'                            0530
*       GEN(LINK  EP=ICGDSMSG);     /* CALL MSG WRITER       @OZ09534*/
         LINK  EP=ICGDSMSG
*       LASTPARM='0'B;              /* RESET END-OF-CARD     @OZ09534*/
         NI    LASTPARM(R4),B'11110111'                            0532
*       SWIOD=0;                    /* RESET SWITCHES FOR NEW CARD 0533
*                                                            @OZ09534*/
         MVI   SWIOD,X'00'                                         0533
*       INBUF='';                   /* CLEAR INBUF           @OZ09534*/
         MVI   INBUF(R4),C' '                                      0534
         MVC   INBUF+1(79,R4),INBUF(R4)                            0534
*       RETURN;                     /*                       @OZ09534*/
         B     @EL00014                                            0535
*     END;                          /* IODSW = OFF           @Z40LB73*/
*                                                                  0536
*   /*****************************************************************/
*   /*                                                               */
*   /* IN UNITNAME ROUTINE                                   @OZ09534*/
*   /* TRANSPOSED CPU TO SORT COLUMN                         @OZ09534*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*   SEQNUM=SEQNUM+1;                /*                       @OZ09534*/
@RF00479 MVC   @ZT00002+2(2),SEQNUM                                0537
         L     @01,@ZT00002                                        0537
         LA    @01,1(,@01)                                         0537
         STH   @01,SEQNUM                                          0537
*   CALL SEQUENCE;                  /*                       @OZ09534*/
         BAL   @14,SEQUENCE                                        0538
*   IF FLAG=0                       /*                       @OZ09548*/
*     THEN                                                         0539
         CLI   FLAG,0                                              0539
         BNE   @RF00539                                            0539
*     DO;                           /*                       @Y30LB14*/
*       R1=ADDR(READDCB);           /* ADDR OF DCB           @Y30LB14*/
         LA    R1,READDCB(,R4)                                     0541
*       R0=ADDR(INBUF);             /* ADDR OF I/O AREA      @Y30LB14*/
         LA    R0,INBUF(,R4)                                       0542
*       GEN(PUT   (1),(0));         /* GET REG NOTATION      @Y30LB14*/
         PUT   (1),(0)
*     END;                          /*                       @Y30LB14*/
*   PRNTCARD='1'B;                  /* PRINT CARD ON         @Y30LB14*/
@RF00539 OI    PRNTCARD(R4),B'00010000'                            0545
*   GEN(LINK  EP=ICGDSMSG);         /* CALL MSG WRITER       @Y30LB14*/
         LINK  EP=ICGDSMSG
*   LASTPARM='0'B;                  /* RESET END-OF-CARD     @Y30LB14*/
         NI    LASTPARM(R4),B'11110111'                            0547
*   INBUF='';                       /*                       @Y30LB14*/
         MVI   INBUF(R4),C' '                                      0548
         MVC   INBUF+1(79,R4),INBUF(R4)                            0548
*   RETURN;                         /*                       @Y30LB14*/
*                                                                  0549
         B     @EL00014                                            0549
*   /*****************************************************************/
*   /*                                                               */
*   /* UNITNAME END PROCESSING                               @OZ09534*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   END PUTOUTCD;                   /*                       @Y30LB14*/
*                                                                  0551
*/********************************************************************/
*/*                                                          @OZ09548*/
*/*  PROCEDURE NAME - IODSTRT                                @OZ09548*/
*/*                                                          @OZ09548*/
*/*  FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A          @OZ09548*/
*/*             IODEVICE IMAGE IS STARTED. THE CUD AND       @OZ09548*/
*/*             CPU ID IS INSERTED IN THEIR APPROPRIATE      @OZ09548*/
*/*             PLACES IN THE CARD IMAGE.                    @OZ09548*/
*/********************************************************** @OZ09548*/
*                                                                  0551
*IODSTRT:                                                          0551
*   PROCEDURE;                      /*                       @OZ09548*/
IODSTRT  STM   @14,@04,@SA00015                                    0551
         STM   @06,@12,@SA00015+28                                 0551
*   IODSW='1'B;                     /* FIRST TIME IMAGE BUILD      0552
*                                                            @OZ09548*/
         OI    IODSW,B'10000000'                                   0552
*   INBUF(1:44)=                    /*                       @OZ09548*/
*       'I        IODEVICE ADDRESS=(   ,  ),UNIT=3330';            0553
*                                                                  0553
         MVC   INBUF(44,R4),@CC00796                               0553
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @S60RSPC*/
*   /* MAY BE 3350                                           @S60RSPC*/
*   /* ***************************************               @S60RSPC*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0554
*   I1=(I+2)/3;                     /* INDEX BY 16           @S60RSPC*/
         LA    @08,2                                               0554
         ALR   @08,I                                               0554
         SRDA  @08,32                                              0554
         D     @08,@CF00051                                        0554
         ST    @09,I1                                              0554
*   I2=(J+7)/8;                     /* DASD CTL 1 TO 4       @S60RSPC*/
         LA    @15,7                                               0555
         ALR   @15,J                                               0555
         LR    I2,@15                                              0555
         SRDA  I2,32                                               0555
         D     I2,@CF00043                                         0555
         LR    I2,@07                                              0555
*   I3=(J+7)//8+1;                  /* DEVICE 1 TO 8         @S60RSPC*/
*                                                                  0556
         LR    @08,@15                                             0556
         SRDA  @08,32                                              0556
         D     @08,@CF00043                                        0556
         AL    @08,@CF00045                                        0556
         ST    @08,I3                                              0556
*   /*****************************************************************/
*   /*                                                               */
*   /* IF 3350                                               @S60RS73*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   IF MERLICEB(I1,I2,I3)=PHYSFMAD  /*                       @S60RSPC*/
*     THEN                          /*                       @S60RSPC*/
         L     @15,I1                                              0557
         SLA   @15,2                                               0557
         ALR   @15,I2                                              0557
         SLA   @15,3                                               0557
         ALR   @15,@08                                             0557
         ALR   @15,@15                                             0557
         ALR   @15,R4                                              0557
         TM    MERLICEB-82(@15),B'11000000'                        0557
         BNO   @RF00557                                            0557
*     INBUF(43)='5';                /* 3350                  @S60RS73*/
         MVI   INBUF+42(R4),C'5'                                   0558
*   ELSE                                                           0559
*     ;                             /*                       @S60RSPC*/
*                                                                  0559
@RF00557 DS    0H                                                  0560
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @OZ09548*/
*   /* CALL CPUIDP TO UNPACK CPUID. UPON                     @OZ09548*/
*   /* RETURN, PLACE CHARACTERS 2-6 OF CPUID                 @OZ09548*/
*   /* (MACHINE SERIAL 5 LOW ORDER DIGITS)                   @OZ09548*/
*   /* INTO BYTES 2-6 OF LABEL FIELD.                        @OZ09548*/
*   /* ***************************************               @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0560
*   CALL CPUIDP;                    /* UNPACK CPU ID         @OZ09548*/
         BAL   @14,CPUIDP                                          0560
*   INBUF(2:6)=UNPACKED(2:6);       /*                       @OZ09548*/
*                                                                  0561
         MVC   INBUF+1(5,R4),UNPACKED+1                            0561
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @OZ09548*/
*   /* CALL CUDADDR TO DEVELOP THE UCB                       @OZ09548*/
*   /* ADDRESS (CHANNEL/CONTROL UNIT/DEVICE)                 @OZ09548*/
*   /* AS PRINTABLE CHARACTERS AND PLACE IN                  @OZ09548*/
*   /* SPACE RESERVED FOR UCB ADDRESS                        @OZ09548*/
*   /* ***************************************               @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   CALL CUDADDR;                   /* CHANNEL, UNIT, DEVICE @OZ09548*/
         BAL   @14,CUDADDR                                         0562
*   INBUF(28:30)=CUD;               /*                       @OZ09548*/
*                                                                  0563
         MVC   INBUF+27(3,R4),CUD                                  0563
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @OZ09548*/
*   /* INITIALIZE POINTER TO START OF                        @OZ09548*/
*   /* OPTIONAL FIELDS                                       @OZ09548*/
*   /* ***************************************               @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*   N=45;                           /*                       @OZ09548*/
*                                                                  0564
         LA    N,45                                                0564
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @OZ09548*/
*   /* COMPLETE TYPE & VARIABLE                              @OZ09548*/
*   /* FIELDS IN IODEVICE IMAGE. IF DEVICE                   @OZ09548*/
*   /* USAGE IS VIRTUAL OR VIRTUAL SHARED,                   @OZ09548*/
*   /* MODIFY UNIT FIELD FROM 3330 TO                        @OZ09548*/
*   /* 3330V, CHECK FOR POSSIBLE ALT. PATH                   @OZ09548*/
*   /* INFORMATION. IF THE DEVICE IS SHARED                  @OZ09548*/
*   /* VIRTUAL, ADD 'FEATURE=(SHARED)' TO                    @OZ09548*/
*   /* RECORD.                                               @OZ09548*/
*   /* ***************************************               @OZ09548*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*   IF USEV(I,J)='1'B THEN                                         0565
         LR    @15,I                                               0565
         SLA   @15,6                                               0565
         ALR   @15,J                                               0565
         MH    @15,@CH00034                                        0565
         L     @01,COMPTR2(,R4)                                    0565
         ALR   @01,@15                                             0565
         AL    @01,@CF00829                                        0565
         TM    USEV-464(@01),B'01000000'                           0565
         BNO   @RF00565                                            0565
*     DO;                           /*                       @Y30LB14*/
*       INBUF(N)='V';               /*                       @Y30LB14*/
         LR    @15,R4                                              0567
         ALR   @15,N                                               0567
         MVI   INBUF-1(@15),C'V'                                   0567
*       N=N+1;                      /*                       @Y30LB14*/
         LA    @15,1                                               0568
         ALR   N,@15                                               0568
*       OLDJ=J;                     /* SET UP ADDRESS CHECK  @OZ09548*/
         ST    J,OLDJ                                              0569
*       OLDI=I;                     /* SET UP CHAN/CUA CHK   @OZ09548*/
         STH   I,OLDI                                              0570
*       CNT=1;                      /* SET UP CNT            @OZ09548*/
         ST    @15,CNT                                             0571
*       CALL OPTCHAN;               /* ANALYZE ALT. PATHS    @OZ09548*/
         BAL   @14,OPTCHAN                                         0572
*       RETURN;                                                    0573
@EL00015 DS    0H                                                  0573
@EF00015 DS    0H                                                  0573
@ER00015 LM    @14,@04,@SA00015                                    0573
         LM    @06,@12,@SA00015+28                                 0573
         BR    @14                                                 0573
*     END;                                                         0574
*   ELSE                                                           0575
*     IF USEVS(I,J)='1'B            /* USED FEAT. SHARED     @OZ09548*/
*       THEN                                                       0575
@RF00565 LR    @15,I                                               0575
         SLA   @15,6                                               0575
         ALR   @15,J                                               0575
         MH    @15,@CH00034                                        0575
         L     @01,COMPTR2(,R4)                                    0575
         ALR   @01,@15                                             0575
         AL    @01,@CF00829                                        0575
         TM    USEVS-464(@01),B'00100000'                          0575
         BNO   @RF00575                                            0575
*       DO;                         /*                       @OZ09548*/
*         INBUF(N)='V';             /*                       @Y30LB14*/
         LR    @15,R4                                              0577
         ALR   @15,N                                               0577
         MVI   INBUF-1(@15),C'V'                                   0577
*         N=N+1;                    /*                       @Y30LB14*/
         LA    @15,1                                               0578
         ALR   N,@15                                               0578
*         OLDJ=J;                   /* SET UP ADDRESS CHECK  @OZ09548*/
         ST    J,OLDJ                                              0579
*         OLDI=I;                   /* SET UP CHAN/CUA CHK   @OZ09548*/
         STH   I,OLDI                                              0580
*         CNT=1;                    /* SET UP CNT            @OZ09548*/
         ST    @15,CNT                                             0581
*         FS='1'B;                  /* SET FEAT. SHARED SW   @OZ09548*/
         OI    FS,B'01000000'                                      0582
*         CALL OPTCHAN;             /* ANALYZE ALT. PATHS    @OZ09534*/
*                                                                  0583
         BAL   @14,OPTCHAN                                         0583
*         /***********************************************************/
*         /*                                                         */
*         /* OVERFLOW CONDITION PRINTS CONTINUATION CHAR. IN CC72    */
*         /*                                                 @OZ09534*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0584
*         IF OVRFLW^='1'B THEN      /*                       @OZ09534*/
         TM    OVRFLW,B'00010000'                                  0584
         BO    @RF00584                                            0584
*           INBUF(N:N+16)=',FEATURE=(SHARED)';/*             @OZ09534*/
         LR    @15,R4                                              0585
         ALR   @15,N                                               0585
         MVC   INBUF-1(17,@15),@CC00802                            0585
*         RETURN;                   /*                       @OZ09534*/
         B     @EL00015                                            0586
*       END;                                                       0587
*                                                                  0587
*   /*****************************************************************/
*   /*                                                               */
*   /* ***************************************               @YD00113*/
*   /* IF THE DEVICE USAGE IS REAL OR                        @YD00113*/
*   /* CONVERTIBLE AND THE DEVICE WAS                        @YD00113*/
*   /* SPECIFIED AS '3330-11' IN THE DASD                    @YD00113*/
*   /* STATEMENT, ADD 'MODEL=11' TO THE                      @YD00113*/
*   /* STATEMENT. (INFORMATION FOR 3330-11                   @YD00113*/
*   /* MOVED INTO CONFGUCB STRUCTURE BY                      @YD00113*/
*   /* MODULE ICGDSA07.)                                     @YD00113*/
*   /* ***************************************               @YD00113*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0588
*     ELSE                          /* NOT USEV OR VIRT. SHRD      0588
*                                                            @OZ09548*/
*       IF USEREAL(I,J)='1'B×       /*                       @OZ09548*/
*           USECONVR(I,J)='1'B THEN /*                       @OZ09548*/
@RF00575 LR    @15,I                                               0588
         SLA   @15,6                                               0588
         ALR   @15,J                                               0588
         MH    @15,@CH00034                                        0588
         L     @01,COMPTR2(,R4)                                    0588
         ALR   @01,@15                                             0588
         AL    @01,@CF00829                                        0588
         TM    USEREAL-464(@01),B'00010100'                        0588
         BZ    @RF00588                                            0588
*         DO;                       /*                       @Y30LB14*/
*           OLDJ=J;                 /* SETUP ADDRESS CHK     @OZ09548*/
         ST    J,OLDJ                                              0590
*           OLDI=I;                 /* CHK FOR CHANGE IN CHAN/CUA  0591
*                                                            @OZ09548*/
         STH   I,OLDI                                              0591
*           CNT=1;                  /* SET UP CNT            @OZ09548*/
         MVC   CNT(4),@CF00045                                     0592
*           CALL OPTCHAN;           /*                       @OZ09548*/
         BAL   @14,OPTCHAN                                         0593
*           IF ICEBERG(I,J)='1'B    /*                       @OZ09548*/
*             THEN                  /*                       @OZ09548*/
         LR    @15,I                                               0594
         SLA   @15,6                                               0594
         ALR   @15,J                                               0594
         MH    @15,@CH00034                                        0594
         L     @01,COMPTR2(,R4)                                    0594
         ALR   @01,@15                                             0594
         AL    @01,@CF00829                                        0594
         TM    ICEBERG-464(@01),B'00000001'                        0594
         BNO   @RF00594                                            0594
*             INBUF(N:N+8)=',MODEL=11';/*                    @OZ09548*/
         LR    @15,R4                                              0595
         ALR   @15,N                                               0595
         MVC   INBUF-1(9,@15),@CC00804                             0595
*         END;                      /*                       @OZ09548*/
*   END IODSTRT;                                                   0597
         B     @EL00015                                            0597
*                                                                  0598
*/********************************************************** @Y30LB14*/
*/*                                                          @Y30LB14*/
*/* PROCEDURE NAME - ICGDSB19, MAINLINE (ENDDATA)            @Y30LB14*/
*/*                                                          @Y30LB14*/
*/* FUNCTION - CLOSE SYSPUNCH                                @Y30LB14*/
*/*                                                          @Y30LB14*/
*/********************************************************** @Y30LB14*/
*                                                                  0598
*ENDDATA:                                                          0598
*   PROCEDURE;                      /*                       @Y30LB14*/
ENDDATA  STM   @14,@12,@SA00016                                    0598
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/
         LA    @15,READDCB(,R4)                                    0599
         ST    @15,DCBPTR(,R4)                                     0599
*   IF DCBOFOPN='1'B                /* IF SYSPCH IS OPEN     @YD00113*/
*     THEN                          /*                       @Y30LB14*/
         TM    DCBOFOPN+40(@15),B'00010000'                        0600
         BNO   @RF00600                                            0600
*     DO;                           /*                       @Y30LB14*/
*       OPENLIST=ADDR(READDCB);     /* POINTER TO DCB        @Y30LB14*/
         ST    @15,OPENLIST(,R4)                                   0602
*       OPENLIST(1)='8F'X;          /* END-OF LIST IND.      @Y30LB12*/
         MVI   OPENLIST(R4),X'8F'                                  0603
*       R1=ADDR(OPENLIST);          /* POINT AT LIST         @Y30LB14*/
         LA    R1,OPENLIST(,R4)                                    0604
*       GEN(CLOSE MF=(E,(1)));      /* EXECUTE CLOSE         @Y30LB14*/
         CLOSE MF=(E,(1))
*     END;                          /*                       @Y30LB14*/
*   ELSE                                                           0607
*     ;                             /* IF NEVER OPENED,      @Y30LB14*/
@RF00600 DS    0H                                                  0608
*   RETURN;                         /* TO CALLER             @Y30LB14*/
@EL00016 DS    0H                                                  0608
@EF00016 DS    0H                                                  0608
@ER00016 LM    @14,@12,@SA00016                                    0608
         BR    @14                                                 0608
*   END ENDDATA;                    /*                       @Y30LB14*/
*                                                                  0610
*/********************************************************** @Y30LB14*/
*/*                                                          @Y30LB14*/
*/* PROCEDURE NAME - DCBROUT2 (MAINLINE - OPEN EXIT          @Y30LB14*/
*/*                                                          @Y30LB14*/
*/* FUNCTION - DCB OPEN EXIT FOR SYSPUNCH.  THIS EXIT        @Y30LB14*/
*/*            ESTABLISHES THE BLKSIZE/LRECL OF SYSPUNCH     @OZ05099*/
*/*            AS 81 IF NOT SUPPLIED ON DD STATEMENT. ALSO   @OZ05099*/
*/*            SETS RECFM TO FIXED-BLOCKED.  IF BLOCKSIZE    @Y30LB14*/
*/*            NOT A MULTIPLE OF LRECL, BLOCKSIZE IS SET TO  @OZ05099*/
*/*            LRECL.                                        @OZ05099*/
*/*                                                          @Y30LB14*/
*/********************************************************** @Y30LB14*/
*                                                                  0610
*DCBROUT2:                                                         0610
*   SAVE14=R14;                     /* SAVE OPEN'S REG14     @Y30LB14*/
DCBROUT2 ST    R14,SAVE14(,R4)                                     0610
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/
         LA    @15,READDCB(,R4)                                    0611
         ST    @15,DCBPTR(,R4)                                     0611
*   IF DCBLRECL^=81                 /* IF LRECL NOT SPECIFIED OR   0612
*                                                            @OZ05099*/
*                                                                  0612
*   /*****************************************************************/
*   /*                                                               */
*   /* NOT 81 SET TO 80                                      @OZ05099*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0612
*     THEN                                                         0612
         AH    @15,@CH00282                                        0612
         CLC   DCBLRECL(2,@15),@CH00810                            0612
         BE    @RF00612                                            0612
*     DCBLRECL=80;                  /*                       @OZ05099*/
         MVC   DCBLRECL(2,@15),@CH00057                            0613
*   IF DCBBLKSI=0                   /* IF NO BLOCKSIZE,      @OZ05099*/
*     THEN                          /*                       @Y30LB14*/
@RF00612 L     @15,DCBPTR(,R4)                                     0614
         LA    @05,52                                              0614
         ALR   @05,@15                                             0614
         LH    @01,DCBBLKSI(,@05)                                  0614
         LTR   @01,@01                                             0614
         BNZ   @RF00614                                            0614
*     DCBBLKSI=DCBLRECL;            /* DEFAULT TO LRECL      @OZ05099*/
         MVC   DCBBLKSI(2,@05),DCBLRECL+72(@15)                    0615
*   ELSE                                                           0616
*     ;                             /*                       @Y30LB14*/
@RF00614 DS    0H                                                  0617
*   LEFTOVER=DCBBLKSI//DCBLRECL;    /* IF BLKSIZE NOT        @Y30LB14*/
         L     @15,DCBPTR(,R4)                                     0617
         LA    @05,52                                              0617
         ALR   @05,@15                                             0617
         LH    @15,DCBLRECL+72(,@15)                               0617
         LH    LEFTOVER,DCBBLKSI(,@05)                             0617
         SRDA  LEFTOVER,32                                         0617
         DR    LEFTOVER,@15                                        0617
*   IF LEFTOVER^=0                  /* MULTIPLE OF LRECL     @Y30LB14*/
*     THEN                          /*                       @Y30LB14*/
         LTR   LEFTOVER,LEFTOVER                                   0618
         BZ    @RF00618                                            0618
*     DCBBLKSI=DCBLRECL;            /* SET BLKSIZE TO LRECL  @OZ05099*/
         STH   @15,DCBBLKSI(,@05)                                  0619
*   ELSE                                                           0620
*     ;                             /*                       @Y30LB14*/
@RF00618 DS    0H                                                  0621
*   DCBRECFM='90'X;                 /* SET RECFM TO FB       @Y30LB14*/
         L     @01,DCBPTR(,R4)                                     0621
         MVI   DCBRECFM+28(@01),X'90'                              0621
*   R14=SAVE14;                     /* RESTORE REG 14        @Y30LB14*/
         L     R14,SAVE14(,R4)                                     0622
*   GEN(BR    14);                  /* RETURN TO OPEN        @Y30LB14*/
         BR    14
*                                                                  0624
*/********************************************************** @Y30LB14*/
*/*                                                          @YD00113*/
*/* PROCEDURE NAME - MAINLINE (PUNCHERR)                     @YD00113*/
*/*                                                          @YD00113*/
*/* FUNCTION - THIS ROUTINE IS CALLED BY IOS IF A PERMANENT  @YD00113*/
*/*            ERROR IS DETECTED WHILE PUNCHING THE SYSGEN   @YD00113*/
*/*            STATEMENTS.  A STANDARD SYNAD MESSAGE IS      @YD00113*/
*/*            PRINTED AND RETURN IS MADE TO IOS.            @YD00113*/
*/*                                                          @YD00113*/
*/********************************************************** @Y30LB14*/
*                                                                  0624
*PUNCHERR:                                                         0624
*   ;                               /*                       @Y30LB14*/
PUNCHERR DS    0H                                                  0625
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @Y30LB14*/
         SYNADAF ACSMETH=QSAM
*   GEN(MVC   OUTBUF2+30(79,R4),49(1));/*                    @YM32166*/
         MVC   OUTBUF2+30(79,R4),49(1)
*   OUTBUF2(1:30)=ICGDS403;         /*                       @YM32166*/
         MVC   OUTBUF2(30,R4),ICGDS403                             0627
*   PRNTBUF2='1'B;                  /*                       @Y30LB14*/
         OI    PRNTBUF2(R4),B'00000001'                            0628
*   GEN(LINK  EP=ICGDSMSG);         /* PRINT SYNAD MSG       @Y30LB14*/
         LINK  EP=ICGDSMSG
*   GEN(SYNADRLS);                  /*                       @Y30LB14*/
         SYNADRLS
*   RETCODE=16;                     /* RETURN CODE TO 16     @Y30LB14*/
         MVC   RETCODE(2,R4),@CH00164                              0631
*   TERMINAT=TERMINAT+1;            /* BUMP TERM COUNT       @Y30LB14*/
         LA    @15,1                                               0632
         AH    @15,TERMINAT(,R4)                                   0632
         STH   @15,TERMINAT(,R4)                                   0632
*   GEN(BR    R14);                 /* RETURN TO IOS         @Y30LB14*/
         BR    R14
*                                                                  0634
*/********************************************************** @YD00113*/
*/* GENERATED STATEMENTS DESCRIBING THE ASSEMBLER PATCH AREA @YD00113*/
*/* AND THE MODEL DCB FOR SYSPUNCH.                          @YD00113*/
*/********************************************************** @YD00113*/
*                                                                  0634
*   GENERATE;                                                      0634
*                                                         /*@Y30LB14*/
PATCHB19 DC    32C'PATCHB19'                              /*@Y30LB14*/
MYDCB2   DCB   DDNAME=SYSPUNCH,DSORG=PS,MACRF=PM,                     **
               EXLST=DCBROUT2,EROPT=ACC,SYNAD=PUNCHERR
*   END ICGDSB19                    /*                       @Y30LB14*/
*                                                                  0635
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0635
*       ;                                                          0635
         B     @EL00001                                            0635
@DATA    DS    0H
@CH00053 DC    H'2'
@CH00071 DC    H'4'
@CH00229 DC    H'6'
@CH00115 DC    H'9'
@CH00034 DC    H'11'
@CH00164 DC    H'16'
@CH00246 DC    H'48'
@CH00768 DC    H'62'
@CH00256 DC    H'64'
@CH00282 DC    H'72'
@CH00057 DC    H'80'
@CH00810 DC    H'81'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00013 DS    15F
@SA00015 DS    14F
@SA00014 DS    14F
@SA00006 DS    14F
@SA00011 DS    14F
@SA00016 DS    15F
@SA00002 DS    15F
@SA00005 DS    14F
@SA00007 DS    15F
@TF00001 DS    F
@TF00002 DS    F
@ZTEMPS  DS    0F
@ZT00001 DC    F'0'
@ZT00002 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSB19 CSECT
         DS    0F
@CF00045 DC    F'1'
@CH00045 EQU   @CF00045+2
@CF00051 DC    F'3'
@CH00051 EQU   @CF00051+2
@CF00122 DC    F'5'
@CF00043 DC    F'8'
@CH00043 EQU   @CF00043+2
@CF00033 DC    F'10'
@CH00033 EQU   @CF00033+2
@CF00066 DC    F'15'
@CF00829 DC    F'-251'
@CF00837 DC    F'-250'
@CF00839 DC    F'-249'
@CF00840 DC    F'-247'
@CF00841 DC    F'-246'
@CF00842 DC    F'-244'
@CF00843 DC    F'-243'
@CF00844 DC    F'-241'
@CF00831 DC    F'-240'
@DATD    DSECT
         DS    0D
I1       DS    F
I3       DS    F
K        DS    F
CNT      DS    F
OLDJ     DS    F
OLDI     DS    H
SEQNUM   DS    H
SWIOD    DS    FL1
         ORG   SWIOD
IODSW    DS    BL1
FS       EQU   SWIOD+0
NOPTCHAN EQU   SWIOD+0
OVRFLW   EQU   SWIOD+0
SETSEQ   EQU   SWIOD+0
@NM00050 EQU   SWIOD+0
         ORG   SWIOD+1
FLAG     DS    FL1
@TS00001 DS    CL39
UNPACKED DS    CL11
PACKED   DS    CL6
UNITIOD  DS    BL1
         ORG   UNITIOD
SORTSEQ  DS    BL1
RESET    EQU   UNITIOD+0
@NM00049 EQU   UNITIOD+0
         ORG   UNITIOD+1
SW       DS    BL1
SWJ      DS    BL1
         ORG   SWJ
MATCH    DS    BL1
UCOMP    EQU   SWJ+0
LOCALJES EQU   SWJ+0
SW1      EQU   SWJ+0
         ORG   SWJ+1
CURRSG   DS    CL2
         ORG   CURRSG
HCURRSG  DS    CL1
LCURRSG  DS    CL1
         ORG   CURRSG+2
CUD      DS    CL3
         ORG   CUD
CHANNEL  DS    CL1
UNIT     DS    CL1
DEVICE   DS    CL1
         ORG   CUD+3
SAVE1    DS    BL1
SAVE2    DS    BL1
CH       DS    3F
WRKCH    DS    3F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSB19 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
ICG402I  DC    H'402'
@CC00796 DC    C'I        IODEVICE ADDRESS=(   ,  ),UNIT=3330'
@CC00754 DC    C'J        UNITNAME NAME=SDG'
@CC00757 DC    C'U        UNITNAME NAME=SDG'
@CC00802 DC    C',FEATURE=(SHARED)'
@CC00790 DC    C'FEATURE=(SHARED)'
@CC00729 DC    C',OPTCHAN=('
@CC00804 DC    C',MODEL=11'
@CC00763 DC    C',UNIT=(('
@CC00732 DC    C', , )'
@CC00734 DC    C', )'
@CC00748 DC    C'))'
@CC00769 DC    C',('
@CB00778 DC    X'0000000000000000'
ICGDS403 DC    CL30' ICG403I I/O ERROR ON SYSPUNCH'
TABLE    DC    X'F0'
         DC    X'F1'
         DC    X'F2'
         DC    X'F3'
         DC    X'F4'
         DC    X'F5'
         DC    X'F6'
         DC    X'F7'
         DC    X'F8'
         DC    X'F9'
         DC    X'C1'
         DC    X'C2'
         DC    X'C3'
         DC    X'C4'
         DC    X'C5'
         DC    X'C6'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
UD       EQU   @05
BYT      EQU   @06
LEFTOVER EQU   @02
N        EQU   @05
SAV      EQU   @02
L        EQU   @06
J        EQU   @03
I        EQU   @02
I2       EQU   @06
R4       EQU   @04
R0       EQU   @00
R14      EQU   @14
R1       EQU   @01
COMTAB   EQU   0
READER   EQU   COMTAB+256
READDCB  EQU   READER
READFLAG EQU   READER+96
LASTPARM EQU   READFLAG
PCHBF    EQU   READER+99
INBUF    EQU   READER+100
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
PRINTER  EQU   COMTAB+464
OUTBUF2  EQU   PRINTER+225
MESSAGES EQU   COMTAB+810
RETCODE  EQU   MESSAGES
MSGNO    EQU   MESSAGES+2
WARNING  EQU   MESSAGES+4
TERMINAT EQU   MESSAGES+6
SPECLMSG EQU   MESSAGES+18
PRNTCARD EQU   SPECLMSG
PRNTBUF2 EQU   SPECLMSG
GENIO    EQU   COMTAB+832
OPENLIST EQU   GENIO
DCBPTR   EQU   GENIO+4
EXLST    EQU   GENIO+8
SAVE14   EQU   GENIO+12
COMPTR2  EQU   GENIO+16
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
SVSYSPCH EQU   SAVEDDS+8
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGTODS  EQU   RSG+7
TODS1    EQU   RSGTODS
TODS2    EQU   RSGTODS+1
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABIBERG EQU   PABFLAGS
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
MERLICEB EQU   PHYSFLGS
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
BINTIND  EQU   @NM00017
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CISPEC   EQU   RSGFLAGS
RSGCPUID EQU   RSGUCB+1
CPUREFNO EQU   RSGUCB+6
RSGCHAN  EQU   RSGUCB+7
RSGCUA   EQU   RSGUCB+8
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
USESPEC  EQU   USEFLAGS
USEV     EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USECONVR EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
ICEBERG  EQU   USEFLAGS
INDEXRSG EQU   CONFGDEV+1
ALTPATH1 EQU   CONFGDEV+2
ALTCH1   EQU   ALTPATH1+2
ALTPATH2 EQU   CONFGDEV+5
ALTCH2   EQU   ALTPATH2+2
ALTPATH3 EQU   CONFGDEV+8
ALTCH3   EQU   ALTPATH3+2
IHADCB   EQU   0
IHADCS05 EQU   0
DCBMODE  EQU   IHADCS05
DCBSTACK EQU   DCBMODE
DCBFUNC  EQU   IHADCS05+3
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   0
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBLRECL EQU   IHADCS38+10
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00045 EQU   IHADCS40+12
DCBEROPT EQU   @NM00045
MYDCB2A  EQU   0
SCANBUF  EQU   0
SCANDATA EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00048 EQU   IHADCS40+16
@NM00047 EQU   @NM00045+1
@NM00046 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00044 EQU   IHADCS40+10
@NM00043 EQU   IHADCS40+9
@NM00042 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00041 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
@NM00040 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00039 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00038 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00037 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00036 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00035 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00034 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
DCBOPTJ  EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00033 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00032 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00031 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00030 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00029 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00028 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00027 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00026 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00025 EQU   DCBDSRG1
@NM00024 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
@NM00023 EQU   DCBFUNC
DCBFNCBT EQU   DCBFUNC
DCBFNCBX EQU   DCBFUNC
DCBFNCBD EQU   DCBFUNC
DCBFNCBW EQU   DCBFUNC
DCBFNCBP EQU   DCBFUNC
DCBFNCBR EQU   DCBFUNC
DCBFNCBI EQU   DCBFUNC
@NM00022 EQU   IHADCS05+2
@NM00021 EQU   IHADCS05+1
DCBSTCK1 EQU   DCBSTACK
DCBSTCK2 EQU   DCBSTACK
@NM00020 EQU   DCBSTACK
DCBMODER EQU   DCBSTACK
DCBMODEO EQU   DCBSTACK
DCBMODEE EQU   DCBSTACK
DCBMODEC EQU   DCBSTACK
@NM00019 EQU   IHADCB
ALTCI3   EQU   ALTPATH3+1
ALTDS3   EQU   ALTPATH3
ALTCI2   EQU   ALTPATH2+1
ALTDS2   EQU   ALTPATH2
ALTCI1   EQU   ALTPATH1+1
ALTDS1   EQU   ALTPATH1
@NM00018 EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
DINTIND  EQU   @NM00017
CINTIND  EQU   @NM00017
CYLFAULT EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
LOWLIB   EQU   LOWDSS+1
@NM00016 EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
LOWSPEC  EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
PHYSDS2  EQU   DSPAIRS
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBDSMID EQU   LIB+2
LIBSIZE  EQU   LIB+1
@NM00009 EQU   LIBBITS
LIBSPEC  EQU   LIBBITS
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
BUILDPTR EQU   GENIO+20
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
@NM00006 EQU   MESSAGES+19
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SCANLEN  EQU   READER+204
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
SAVENCOL EQU   READER+192
SAVESCOL EQU   READER+188
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
ENDSCAN  EQU   READFLAG
PARMBIT  EQU   READFLAG
KEYBIT   EQU   READFLAG
READTERM EQU   READFLAG
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00108 EQU   @RC00107
@RC00115 EQU   @RC00114
@RC00122 EQU   @RC00121
@RC00337 EQU   @EL00006
@RF00356 EQU   @EL00008
@RC00412 EQU   @EL00011
@RC00415 EQU   @EL00011
@RC00422 EQU   @EL00011
@RF00584 EQU   @EL00015
@RF00588 EQU   @EL00015
@RF00594 EQU   @EL00015
@RC00123 EQU   @RC00122
@RC00136 EQU   @RC00122
@RC00129 EQU   @RC00122
@RC00425 EQU   @RC00422
@RC00130 EQU   @RC00129
@ENDDATA EQU   *
         END   ICGDSB19,(C'PLS1608',0701,77362)

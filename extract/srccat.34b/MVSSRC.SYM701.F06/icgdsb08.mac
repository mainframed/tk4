         TITLE 'ICGDSB08 MSC TABLE CREATE BUILD CONFIGURATION TABLE    *
                        '
ICGDSB08 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ICGDSB08  76.339'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*                                                            @XD00153*/
*                                                                  0024
*/********************************************************** @XD00153*/
*/*                                                          @XD00153*/
*/*      ICGDSB08 (MAINLINE)                                 @XD00153*/
*/*                                                          @XD00153*/
*/*      INITIALIZE AREAS, THEN CALL PROCEDURES TO SET UP    @XD00153*/
*/*      THE 1ST, 5TH, 9TH, AND SA BLOCKS AND CALL PROC      @XD00153*/
*/*      'WRITETRK' TO PUT PREFIX INFO IN THE BLOCKS.        @XD00153*/
*/*                                                          @XD00153*/
*/********************************************************** @XD00153*/
*                                                                  0024
*   OUTCYL(1)=UT2VCYL;              /* STARTING CYLINDER NUMBER    0024
*                                                            @Y30LB14*/
         L     @10,BUILDPTR(,R4)                                   0024
         LH    @05,@CH00469                                        0024
         ALR   @05,@10                                             0024
         MVC   OUTCYL(1,@05),UT2VCYL(@10)                          0024
*   OUTHEAD(1)=UT2VHEAD;            /* STARTING HEAD NUMBER  @Y30LB14*/
         MVC   OUTHEAD(1,@05),UT2VHEAD(@10)                        0025
*   OUTREC(1)=UT2VREC;              /* STARTING RECORD NUMBER      0026
*                                                            @Y30LB14*/
         MVC   OUTREC(1,@05),UT2VREC(@10)                          0026
*   B06DCBPT=ADDR(UT2DCB);          /*                       @Y30LB14*/
         LA    @05,UT2DCB(,@10)                                    0027
         ST    @05,B06DCBPT(,@10)                                  0027
*   B06BUFPT=ADDR(UT2BUFER);        /* ADDRESS OF WRITE      @Y30LB14
*                                      BUFFER                @Y30LB14*/
         LR    @05,@10                                             0028
         AL    @05,@CF00469                                        0028
         ST    @05,B06BUFPT(,@10)                                  0028
*   ZEROS=''B;                      /* SET BLOCK TO 0'S      @Y30LB14*/
         XC    ZEROS(256),ZEROS                                    0029
*   TWO4=0;                         /*                       @Y30LB14*/
         SLR   @10,@10                                             0030
         LR    TWO4,@10                                            0030
*   RSGBYTE=0;                      /*                       @Y30LB14*/
         LR    RSGBYTE,@10                                         0031
*   CALL RSVDBLOC;                  /* ZERO CERTAIN BLOCKS   @Y30LB14*/
         BAL   @14,RSVDBLOC                                        0032
*   CALL FIRSTBLK;                  /* SET UP 1ST BLOCK      @Y30LB14*/
         BAL   @14,FIRSTBLK                                        0033
*   CALL FIFTHBLK;                  /* SET UP FIFTH BLOCK    @Y30LB14*/
         BAL   @14,FIFTHBLK                                        0034
*   CALL NINTHBLK;                  /* SET UP NINTH BLOCK    @Y30LB14*/
         BAL   @14,NINTHBLK                                        0035
*   CALL DSBLOCKS;                  /* SET UP THE DS BLOCKS  @Y30LB14*/
         BAL   @14,DSBLOCKS                                        0036
*   CALL WRITETRK;                  /* PUT IN PREFIX INFO IN BLOCKS
*                                                            @Y30LB14*/
         BAL   @14,WRITETRK                                        0037
*   TWO4=24;                        /*                       @Y30LB14*/
         LA    TWO4,24                                             0038
*   CALL RSVDBLOC;                  /* ZERO CERTAIN BLOCKS   @Y30LB14*/
         BAL   @14,RSVDBLOC                                        0039
*   CALL DSBLOCKS;                  /* SET UP THE DS BLOCKS  @Y30LB14*/
         BAL   @14,DSBLOCKS                                        0040
*   CALL WRITETRK;                  /* PUT IN PREFIX INFO IN BLOCKS
*                                                            @Y30LB14*/
         BAL   @14,WRITETRK                                        0041
*   RETURN;                         /* RETURN TO CALLER - ICGDSBLD 0042
*                                                            @Y30LB14*/
@EL00001 L     @13,4(,@13)                                         0042
@EF00001 L     @00,@SIZDATD                                        0042
         LR    @01,@11                                             0042
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0042
         BR    @14                                                 0042
*                                                                  0043
*/*********************************************************  @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - FIRSTBLK                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE BUILDS THE FIRST BLOCK OF THE    @XD00153*/
*/*            CONFIGURATION TABLE.                          @XD00153*/
*/*                                                          @XD00153*/
*/*********************************************************  @XD00153*/
*                                                                  0043
*FIRSTBLK:                                                         0043
*   PROCEDURE;                      /*                       @Y30LB14*/
FIRSTBLK STM   @14,@12,12(@13)                                     0043
*   ZEROS=''B;                      /* ZERO THE BLOCK IMAGE  @Y30LB14*/
*                                                                  0044
         XC    ZEROS(256),ZEROS                                    0044
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* IF A CHANNEL INTERFACE IS SPECIFIED, THEN THE         @XD00153*/
*   /* CPU REFERENCE NUMBER IS PLACED IN ITS PROPER          @Y30LB14*/
*   /* BYTE LOCATION. THE BYTE LOCATION SEQUENCE IS          @Y30LB14*/
*   /* 3,5,7,11,13,15,19,21,23,27,29,31, - - -,127.          @Y30LB14*/
*   /* ALSO, THE TWO LOW ORDER BITS OF THE CHANNEL           @Y30LB14*/
*   /* UNIT ADDRESS ARE SHIFTED TO THE TWO HIGH ORDER        @Y30LB14*/
*   /* POSITIONS AND THE CHANNEL NUMBER OCCUPIES THE         @Y30LB14*/
*   /* 6 LOW ORDER POSITIONS OF THE BYTE WHICH IS            @Y30LB14*/
*   /* PLACED IN THE BYTE LOCATION BY THE FOLLOWING          @Y30LB14*/
*   /* SEQUENCE. 4,6,8,12,14,16,20,22,24, - - ,128.          @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0045
*   DO I=1 TO 48;                   /*                       @Y30LB14*/
         LA    I,1                                                 0045
@DL00045 DS    0H                                                  0046
*     IF CISPEC(I)='1'B THEN                                       0046
         LR    @10,I                                               0046
         MH    @10,@CH00112                                        0046
         L     @05,COMPTR2(,R4)                                    0046
         ST    @10,@TF00001                                        0046
         ALR   @10,@05                                             0046
         TM    CISPEC-9(@10),B'10000000'                           0046
         BNO   @RF00046                                            0046
*       DO;                         /*                       @Y30LB14*/
*         BYTES(3*I-(I-1)/3-(I-1)//3)=CPUREFNO(I);/*         @Y30LB14*/
         LA    @10,3                                               0048
         LR    @01,I                                               0048
         MR    @00,@10                                             0048
         LR    @03,I                                               0048
         BCTR  @03,0                                               0048
         LR    @06,@03                                             0048
         SRDA  @06,32                                              0048
         DR    @06,@10                                             0048
         LCR   @07,@07                                             0048
         ALR   @07,@01                                             0048
         LR    @08,@03                                             0048
         SRDA  @08,32                                              0048
         DR    @08,@10                                             0048
         SLR   @07,@08                                             0048
         L     @06,@TF00001                                        0048
         SLR   @00,@00                                             0048
         IC    @00,CPUREFNO-9(@06,@05)                             0048
         STC   @00,BYTES-1(@07)                                    0048
*         BYTES(3*I+1-(I-1)/3-(I-1)//3)=RSGCHAN(I)+RSGCUA(I)*64;/* 0049
*                                                            @Y30LB14*/
         AH    @01,@CH00042                                        0049
         LR    @06,@03                                             0049
         SRDA  @06,32                                              0049
         DR    @06,@10                                             0049
         SLR   @01,@07                                             0049
         LR    @06,@03                                             0049
         SRDA  @06,32                                              0049
         DR    @06,@10                                             0049
         SLR   @01,@06                                             0049
         L     @10,@TF00001                                        0049
         SLR   @03,@03                                             0049
         IC    @03,RSGCUA-9(@10,@05)                               0049
         SLA   @03,6                                               0049
         AL    @05,@TF00001                                        0049
         MVC   @ZT00003+3(1),RSGCHAN-9(@05)                        0049
         AL    @03,@ZT00003                                        0049
         STC   @03,BYTES-1(@01)                                    0049
*       END;                        /*                       @Y30LB14*/
*   END;                            /*                       @Y30LB14*/
*                                                                  0051
@RF00046 AH    I,@CH00042                                          0051
         CH    I,@CH00235                                          0051
         BNH   @DL00045                                            0051
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* SET THE 4 LOW ORDER BITS OF THE FLAG BYTE OF          @Y30LB14*/
*   /* CONFIGURATION INDEX. BYTE LOCATION SEQUENCE           @Y30LB14*/
*   /* IS 1,9,17,25,33, - - - ,121.                          @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0052
*   DO I=1 TO 16;                   /*                       @Y30LB14*/
         LA    I,1                                                 0052
@DL00052 DS    0H                                                  0053
*     FLAGS=0;                      /*                       @Y30LB14*/
         MVI   FLAGS,X'00'                                         0053
*     DO J=1 TO 4;                  /*                       @Y30LB14*/
         LA    J,1                                                 0054
@DL00054 DS    0H                                                  0055
*       IF LOWSPEC(I,J)='1'B THEN                                  0055
         LR    @10,I                                               0055
         SLA   @10,2                                               0055
         ALR   @10,J                                               0055
         ALR   @10,@10                                             0055
         ST    @10,@TF00001                                        0055
         ALR   @10,R4                                              0055
         TM    LOWSPEC-10(@10),B'10000000'                         0055
         BNO   @RF00055                                            0055
*         DO;                       /*                       @Y30LB14*/
*           IF LOWLIB(I,J)='F0'X THEN                              0057
         LR    @10,R4                                              0057
         AL    @10,@TF00001                                        0057
         CLI   LOWLIB-10(@10),X'F0'                                0057
         BNE   @RF00057                                            0057
*             BIT4='1'B;            /*                       @Y30LB14*/
         OI    BIT4,B'00001000'                                    0058
*           IF LOWLIB(I,J)='F1'X THEN                              0059
@RF00057 LR    @10,I                                               0059
         SLA   @10,2                                               0059
         ALR   @10,J                                               0059
         ALR   @10,@10                                             0059
         ALR   @10,R4                                              0059
         CLI   LOWLIB-10(@10),X'F1'                                0059
         BNE   @RF00059                                            0059
*             BIT5='1'B;            /*                       @Y30LB14*/
         OI    BIT5,B'00000100'                                    0060
*           IF LOWLIB(I,J)='F2'X THEN                              0061
@RF00059 LR    @10,I                                               0061
         SLA   @10,2                                               0061
         ALR   @10,J                                               0061
         ALR   @10,@10                                             0061
         ALR   @10,R4                                              0061
         CLI   LOWLIB-10(@10),X'F2'                                0061
         BNE   @RF00061                                            0061
*             BIT6='1'B;            /*                       @Y30LB14*/
         OI    BIT6,B'00000010'                                    0062
*           IF LOWLIB(I,J)='F3'X THEN                              0063
@RF00061 LR    @10,I                                               0063
         SLA   @10,2                                               0063
         ALR   @10,J                                               0063
         ALR   @10,@10                                             0063
         ALR   @10,R4                                              0063
         CLI   LOWLIB-10(@10),X'F3'                                0063
         BNE   @RF00063                                            0063
*             BIT7='1'B;            /*                       @Y30LB14*/
         OI    BIT7,B'00000001'                                    0064
*         END;                      /*                       @Y30LB14*/
@RF00063 DS    0H                                                  0066
*     END;                          /*                       @Y30LB14*/
@RF00055 AH    J,@CH00042                                          0066
         CH    J,@CH00068                                          0066
         BNH   @DL00054                                            0066
*     BYTES(I*8-7)=FLAGS;           /*                       @Y30LB14*/
         LR    @10,I                                               0067
         SLA   @10,3                                               0067
         SLR   @05,@05                                             0067
         IC    @05,FLAGS                                           0067
         STC   @05,BYTES-8(@10)                                    0067
*   END;                            /*                       @Y30LB14*/
*                                                                  0068
         AH    I,@CH00042                                          0068
         CH    I,@CH00162                                          0068
         BNH   @DL00052                                            0068
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* SET HIGH ORDER BIT OF FLAGS                           @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0069
*   DO I=1 TO 4;                    /*                       @Y30LB14*/
         LA    I,1                                                 0069
@DL00069 DS    0H                                                  0070
*     IF LIBSPEC(I)='1'B THEN                                      0070
         LR    @10,I                                               0070
         MH    @10,@CH00128                                        0070
         ST    @10,@TF00001                                        0070
         ALR   @10,R4                                              0070
         TM    LIBSPEC-12(@10),B'10000000'                         0070
         BNO   @RF00070                                            0070
*       BYTES(LIBDSMID(I)*8+1)=BYTES(LIBDSMID(I)*8+1)+128;/* @Y30LB14*/
         L     @10,@TF00001                                        0071
         SLR   @05,@05                                             0071
         IC    @05,LIBDSMID-12(@10,R4)                             0071
         SLA   @05,3                                               0071
         LA    @10,128                                             0071
         LA    @03,BYTES(@05)                                      0071
         MVC   @ZT00003+3(1),0(@03)                                0071
         AL    @10,@ZT00003                                        0071
         STC   @10,BYTES(@05)                                      0071
*   END;                            /*                       @Y30LB14*/
*                                                                  0072
@RF00070 AH    I,@CH00042                                          0072
         CH    I,@CH00068                                          0072
         BNH   @DL00069                                            0072
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* MOVE ASSOCIATION TABLE TO LAST HALF OF THE            @Y30LB14*/
*   /* BLOCK IMAGE.                                          @Y30LB14*/
*   /* CLEAR OUT OPSYS BITS FROM TABLE.                      @ZD02028*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0073
*   DO I=1 TO 16;                   /*                       @Y30LB14*/
         LA    I,1                                                 0073
@DL00073 DS    0H                                                  0074
*     CPUASSN(16+I)=CPU(I);         /*                       @Y30LB14*/
         LR    @10,I                                               0074
         SLA   @10,3                                               0074
         LA    @05,CPUASSN+120(@10)                                0074
         ST    @10,@TF00001                                        0074
         ALR   @10,R4                                              0074
         MVC   0(8,@05),CPU-8(@10)                                 0074
*     VS1(16+I)='0'B;               /*                       @ZD02028*/
*     VS2(16+I)='0'B;               /*                       @ZD02028*/
*     JES(16+I)='0'B;               /*                       @Z40LB73*/
         L     @10,@TF00001                                        0077
         LA    @05,JES+120(@10)                                    0077
         NI    0(@05),B'11100011'                                  0077
*   END;                            /*                       @Y30LB14*/
*                                                                  0078
         AH    I,@CH00042                                          0078
         CH    I,@CH00162                                          0078
         BNH   @DL00073                                            0078
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* PUT FIRST BLOCK IN THE TRACK IMAGE AND                @Y30LB14*/
*   /* RETURN TO CALLER.                                     @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0079
*   OBLOCK(1)=BLOCK;                /*                       @Y30LB14*/
         L     @10,BUILDPTR(,R4)                                   0079
         AL    @10,@CF00469                                        0079
         MVC   OBLOCK(256,@10),BLOCK                               0079
*   RETURN;                         /*                       @Y30LB14*/
@EL00002 DS    0H                                                  0080
@EF00002 DS    0H                                                  0080
@ER00002 LM    @14,@12,12(@13)                                     0080
         BR    @14                                                 0080
*   END FIRSTBLK;                   /*                       @Y30LB14*/
*                                                                  0082
*/*********************************************************  @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - NINTHBLK                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE BUILDS THE NINTH BLOCK OF THE    @XD00153*/
*/*            CONFIGURATION TABLE.                          @XD00153*/
*/*                                                          @XD00153*/
*/*********************************************************  @XD00153*/
*                                                                  0082
*NINTHBLK:                                                         0082
*   PROCEDURE;                      /*                       @Y30LB14*/
NINTHBLK STM   @14,@12,12(@13)                                     0082
*   ZEROS=''B;                      /* ZERO THE BLOCK IMAGE  @Y30LB14*/
*                                                                  0083
         XC    ZEROS(256),ZEROS                                    0083
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* PLACE THE 'PHYSDS2' DATA IN THE BLOCK IN THE          @Y30LB14*/
*   /* FOLLOWING BYTE SEQUENCE.                              @Y30LB14*/
*   /* 1,2,3,4,17,18,19,20,33,34,35,36, - - - -              @Y30LB14*/
*   /* ,241,242,243,244.                                     @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0084
*   DO I=1 TO 16;                   /*                       @Y30LB14*/
         LA    I,1                                                 0084
@DL00084 DS    0H                                                  0085
*     DO J=1 TO 4;                  /*                       @Y30LB14*/
         LA    J,1                                                 0085
@DL00085 DS    0H                                                  0086
*       BYTES((I-1)*16+J)=PHYSDS2(I,J);/*                    @Y30LB14*/
         LR    @10,I                                               0086
         BCTR  @10,0                                               0086
         SLA   @10,4                                               0086
         ALR   @10,J                                               0086
         LR    @03,I                                               0086
         SLA   @03,2                                               0086
         ALR   @03,J                                               0086
         SLR   @15,@15                                             0086
         IC    @15,PHYSDS2-5(@03,R4)                               0086
         STC   @15,BYTES-1(@10)                                    0086
*     END;                          /*                       @Y30LB14*/
         AH    J,@CH00042                                          0087
         CH    J,@CH00068                                          0087
         BNH   @DL00085                                            0087
*   END;                            /*                       @Y30LB14*/
*                                                                  0088
         AH    I,@CH00042                                          0088
         CH    I,@CH00162                                          0088
         BNH   @DL00084                                            0088
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* SET UP REAL SPINDLES BIT PATTERN IN A BIT             @Y30LB14*/
*   /* STRING 32 BITS LONG. THEN PLACE THE 32 BIT            @Y30LB14*/
*   /* LONG STRING IN 4 BYTE BLOCKS WITH THE STARTING        @Y30LB14*/
*   /* BLOCKS HAVING THE FOLLOWING SEQUENCE.                 @Y30LB14*/
*   /* 5,9,13,21,25,29,37,41,45,- - - - ,253.                @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0089
*   DO I=1 TO 48;                   /*                       @Y30LB14*/
         LA    I,1                                                 0089
@DL00089 DS    0H                                                  0090
*     BITPOSN=1073741824;           /*                       @Y30LB14*/
         L     BITPOSN,@CF00431                                    0090
*     BITPATRN=BLOCK(((4*I)+((I-1)/3)*4+1):((4*I)+((I-1)/3)*4+4));/*
*                                                            @OZ09548*/
         LR    @10,I                                               0091
         SLA   @10,2                                               0091
         LA    @07,3                                               0091
         LR    @00,I                                               0091
         BCTR  @00,0                                               0091
         SRDA  @00,32                                              0091
         DR    @00,@07                                             0091
         SLA   @01,2                                               0091
         ALR   @10,@01                                             0091
         LA    @05,BLOCK(@10)                                      0091
         MVC   BITPATRN(4),0(@05)                                  0091
*     IF USEREAL(I,1)='1'B THEN     /* SET HIGH ORDER BIT OF @Y30LB14*/
         LR    @10,I                                               0092
         MH    @10,@CH00472                                        0092
         L     @05,COMPTR2(,R4)                                    0092
         ST    @10,@TF00001                                        0092
         ALR   @10,@05                                             0092
         AL    @10,@CF00485                                        0092
         TM    USEREAL-464(@10),B'00010000'                        0092
         BNO   @RF00092                                            0092
*       DO;                         /*                       @OZ09548*/
*         FIRST8=FIRST8×'80'X;      /* 32 BIT LONG STRING    @OZ09548*/
         OI    FIRST8,X'80'                                        0094
*         IF ALTCI1(I,1)^='00'X     /*                       @OZ09548*/
*           THEN                    /*                       @OZ09548*/
         LR    @10,@05                                             0095
         AL    @10,@TF00001                                        0095
         AL    @10,@CF00486                                        0095
         CLI   ALTCI1-467(@10),X'00'                               0095
         BE    @RF00095                                            0095
*           DO;                     /*                       @OZ09548*/
*             M=(((ALTDS1(I,1))*3)+(ALTCI1(I,1)));                 0097
         L     @10,@TF00001                                        0097
         AL    @10,@CF00487                                        0097
         SLR   @01,@01                                             0097
         IC    @01,ALTDS1-466(@10,@05)                             0097
         MR    @00,@07                                             0097
         AL    @05,@TF00001                                        0097
         AL    @05,@CF00486                                        0097
         MVC   @ZT00003+3(1),ALTCI1-467(@05)                       0097
         AL    @01,@ZT00003                                        0097
         LR    M,@01                                               0097
*             ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4
*                 ));               /*                       @OZ09548*/
         LR    @10,M                                               0098
         SLA   @10,2                                               0098
         LR    @00,M                                               0098
         BCTR  @00,0                                               0098
         SRDA  @00,32                                              0098
         DR    @00,@07                                             0098
         SLA   @01,2                                               0098
         ALR   @10,@01                                             0098
         LA    @07,BLOCK(@10)                                      0098
         MVC   ALTPATRN(4),0(@07)                                  0098
*             ALT8=ALT8×'80'X;      /*                       @OZ09548*/
         OI    ALT8,X'80'                                          0099
*             BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=  0100
*                 ALTPATRN;                                        0100
         LA    @07,BLOCK(@10)                                      0100
         MVC   0(4,@07),ALTPATRN                                   0100
*           END;                    /*                       @OZ09548*/
*         IF ALTCI2(I,1)^='00'X     /*                       @OZ09548*/
*           THEN                    /*                       @OZ09548*/
@RF00095 LR    @10,I                                               0102
         MH    @10,@CH00472                                        0102
         L     @07,COMPTR2(,R4)                                    0102
         ST    @10,@TF00001                                        0102
         ALR   @10,@07                                             0102
         AL    @10,@CF00488                                        0102
         CLI   ALTCI2-470(@10),X'00'                               0102
         BE    @RF00102                                            0102
*           DO;                     /*                       @OZ09548*/
*             M=(((ALTDS2(I,1))*3)+(ALTCI2(I,1)));                 0104
         LA    @10,3                                               0104
         L     @05,@TF00001                                        0104
         AL    @05,@CF00489                                        0104
         SLR   @01,@01                                             0104
         IC    @01,ALTDS2-469(@05,@07)                             0104
         MR    @00,@10                                             0104
         AL    @07,@TF00001                                        0104
         AL    @07,@CF00488                                        0104
         MVC   @ZT00003+3(1),ALTCI2-470(@07)                       0104
         AL    @01,@ZT00003                                        0104
         LR    M,@01                                               0104
*             ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4
*                 ));               /*                       @OZ09548*/
         LR    @07,M                                               0105
         SLA   @07,2                                               0105
         LR    @00,M                                               0105
         BCTR  @00,0                                               0105
         SRDA  @00,32                                              0105
         DR    @00,@10                                             0105
         SLA   @01,2                                               0105
         ALR   @07,@01                                             0105
         LA    @10,BLOCK(@07)                                      0105
         MVC   ALTPATRN(4),0(@10)                                  0105
*             ALT8=ALT8×'80'X;      /*                       @OZ09548*/
         OI    ALT8,X'80'                                          0106
*             BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=  0107
*                 ALTPATRN;                                        0107
         LA    @10,BLOCK(@07)                                      0107
         MVC   0(4,@10),ALTPATRN                                   0107
*           END;                    /*                       @OZ09548*/
*         IF ALTCI3(I,1)^='00'X     /*                       @OZ09548*/
*           THEN                    /*                       @OZ09548*/
@RF00102 LR    @10,I                                               0109
         MH    @10,@CH00472                                        0109
         L     @07,COMPTR2(,R4)                                    0109
         ST    @10,@TF00001                                        0109
         ALR   @10,@07                                             0109
         AL    @10,@CF00490                                        0109
         CLI   ALTCI3-473(@10),X'00'                               0109
         BE    @RF00109                                            0109
*           DO;                     /*                       @OZ09548*/
*             M=(((ALTDS3(I,1))*3)+(ALTCI3(I,1)));                 0111
         LA    @10,3                                               0111
         L     @05,@TF00001                                        0111
         AL    @05,@CF00491                                        0111
         SLR   @01,@01                                             0111
         IC    @01,ALTDS3-472(@05,@07)                             0111
         MR    @00,@10                                             0111
         AL    @07,@TF00001                                        0111
         AL    @07,@CF00490                                        0111
         MVC   @ZT00003+3(1),ALTCI3-473(@07)                       0111
         AL    @01,@ZT00003                                        0111
         LR    M,@01                                               0111
*             ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4
*                 ));               /*                       @OZ09548*/
         LR    @07,M                                               0112
         SLA   @07,2                                               0112
         LR    @00,M                                               0112
         BCTR  @00,0                                               0112
         SRDA  @00,32                                              0112
         DR    @00,@10                                             0112
         SLA   @01,2                                               0112
         ALR   @07,@01                                             0112
         LA    @10,BLOCK(@07)                                      0112
         MVC   ALTPATRN(4),0(@10)                                  0112
*             ALT8=ALT8×'80'X;      /*                       @OZ09548*/
         OI    ALT8,X'80'                                          0113
*             BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=  0114
*                 ALTPATRN;                                        0114
         LA    @10,BLOCK(@07)                                      0114
         MVC   0(4,@10),ALTPATRN                                   0114
*           END;                    /*                       @OZ09548*/
*       END;                        /*                       @OZ09548*/
@RF00109 DS    0H                                                  0117
*     DO J=2 TO 32;                 /* SET BITS 2 THRU 32    @Y30LB14*/
@RF00092 LA    J,2                                                 0117
@DL00117 DS    0H                                                  0118
*       IF USEREAL(I,J)='1'B THEN                                  0118
         LR    @10,I                                               0118
         SLA   @10,6                                               0118
         ALR   @10,J                                               0118
         MH    @10,@CH00246                                        0118
         L     @07,COMPTR2(,R4)                                    0118
         ST    @10,@TF00001                                        0118
         ALR   @10,@07                                             0118
         AL    @10,@CF00492                                        0118
         TM    USEREAL-464(@10),B'00010000'                        0118
         BNO   @RF00118                                            0118
*         DO;                       /*                       @OZ09548*/
*           BITPAT=BITPAT×BITPOSN;  /*                       @Y30LB14*/
         L     @10,BITPAT                                          0120
         OR    @10,BITPOSN                                         0120
         ST    @10,BITPAT                                          0120
*           IF ALTCI1(I,J)^='00'X   /*                       @OZ09548*/
*             THEN                  /*                       @OZ09548*/
         LR    @10,@07                                             0121
         AL    @10,@TF00001                                        0121
         AL    @10,@CF00493                                        0121
         CLI   ALTCI1-467(@10),X'00'                               0121
         BE    @RF00121                                            0121
*             DO;                   /*                       @OZ09548*/
*               M=(((ALTDS1(I,J))*3)+(ALTCI1(I,J)));               0123
         LA    @10,3                                               0123
         L     @01,@TF00001                                        0123
         AL    @01,@CF00494                                        0123
         SLR   @09,@09                                             0123
         IC    @09,ALTDS1-466(@01,@07)                             0123
         MR    @08,@10                                             0123
         AL    @07,@TF00001                                        0123
         AL    @07,@CF00493                                        0123
         MVC   @ZT00003+3(1),ALTCI1-467(@07)                       0123
         AL    @09,@ZT00003                                        0123
         LR    M,@09                                               0123
*               ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4
*                   +4));           /*                       @OZ09548*/
         LR    @07,M                                               0124
         SLA   @07,2                                               0124
         LR    @00,M                                               0124
         BCTR  @00,0                                               0124
         SRDA  @00,32                                              0124
         DR    @00,@10                                             0124
         SLA   @01,2                                               0124
         ALR   @07,@01                                             0124
         LA    @10,BLOCK(@07)                                      0124
         MVC   ALTPATRN(4),0(@10)                                  0124
*               ALTPAT=ALTPAT×BITPOSN;/*                     @OZ09548*/
         L     @10,ALTPAT                                          0125
         OR    @10,BITPOSN                                         0125
         ST    @10,ALTPAT                                          0125
*               BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=
*                   ALTPATRN;                                      0126
         LA    @10,BLOCK(@07)                                      0126
         MVC   0(4,@10),ALTPATRN                                   0126
*             END;                  /*                       @OZ09548*/
*           IF ALTCI2(I,J)^='00'X   /*                       @OZ09548*/
*             THEN                  /*                       @OZ09548*/
@RF00121 LR    @10,I                                               0128
         SLA   @10,6                                               0128
         ALR   @10,J                                               0128
         MH    @10,@CH00246                                        0128
         L     @07,COMPTR2(,R4)                                    0128
         ST    @10,@TF00001                                        0128
         ALR   @10,@07                                             0128
         AL    @10,@CF00495                                        0128
         CLI   ALTCI2-470(@10),X'00'                               0128
         BE    @RF00128                                            0128
*             DO;                   /*                       @OZ09548*/
*               M=(((ALTDS2(I,J))*3)+(ALTCI2(I,J)));               0130
         LA    @10,3                                               0130
         L     @01,@TF00001                                        0130
         AL    @01,@CF00496                                        0130
         SLR   @09,@09                                             0130
         IC    @09,ALTDS2-469(@01,@07)                             0130
         MR    @08,@10                                             0130
         AL    @07,@TF00001                                        0130
         AL    @07,@CF00495                                        0130
         MVC   @ZT00003+3(1),ALTCI2-470(@07)                       0130
         AL    @09,@ZT00003                                        0130
         LR    M,@09                                               0130
*               ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4
*                   +4));           /*                       @OZ09548*/
         LR    @07,M                                               0131
         SLA   @07,2                                               0131
         LR    @00,M                                               0131
         BCTR  @00,0                                               0131
         SRDA  @00,32                                              0131
         DR    @00,@10                                             0131
         SLA   @01,2                                               0131
         ALR   @07,@01                                             0131
         LA    @10,BLOCK(@07)                                      0131
         MVC   ALTPATRN(4),0(@10)                                  0131
*               ALTPAT=ALTPAT×BITPOSN;/*                     @OZ09548*/
         L     @10,ALTPAT                                          0132
         OR    @10,BITPOSN                                         0132
         ST    @10,ALTPAT                                          0132
*               BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=
*                   ALTPATRN;                                      0133
         LA    @10,BLOCK(@07)                                      0133
         MVC   0(4,@10),ALTPATRN                                   0133
*             END;                  /*                       @OZ09548*/
*           IF ALTCI3(I,J)^='00'X   /*                       @OZ09548*/
*             THEN                  /*                       @OZ09548*/
@RF00128 LR    @10,I                                               0135
         SLA   @10,6                                               0135
         ALR   @10,J                                               0135
         MH    @10,@CH00246                                        0135
         L     @07,COMPTR2(,R4)                                    0135
         ST    @10,@TF00001                                        0135
         ALR   @10,@07                                             0135
         AL    @10,@CF00497                                        0135
         CLI   ALTCI3-473(@10),X'00'                               0135
         BE    @RF00135                                            0135
*             DO;                   /*                       @OZ09548*/
*               M=(((ALTDS3(I,J))*3)+(ALTCI3(I,J)));               0137
         LA    @10,3                                               0137
         L     @01,@TF00001                                        0137
         AL    @01,@CF00498                                        0137
         SLR   @09,@09                                             0137
         IC    @09,ALTDS3-472(@01,@07)                             0137
         MR    @08,@10                                             0137
         AL    @07,@TF00001                                        0137
         AL    @07,@CF00497                                        0137
         MVC   @ZT00003+3(1),ALTCI3-473(@07)                       0137
         AL    @09,@ZT00003                                        0137
         LR    M,@09                                               0137
*               ALTPATRN=BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4
*                   +4));           /*                       @OZ09548*/
         LR    @07,M                                               0138
         SLA   @07,2                                               0138
         LR    @00,M                                               0138
         BCTR  @00,0                                               0138
         SRDA  @00,32                                              0138
         DR    @00,@10                                             0138
         SLA   @01,2                                               0138
         ALR   @07,@01                                             0138
         LA    @10,BLOCK(@07)                                      0138
         MVC   ALTPATRN(4),0(@10)                                  0138
*               ALTPAT=ALTPAT×BITPOSN;/*                     @OZ09548*/
         L     @10,ALTPAT                                          0139
         OR    @10,BITPOSN                                         0139
         ST    @10,ALTPAT                                          0139
*               BLOCK(((4*M)+((M-1)/3)*4+1):((4*M)+((M-1)/3)*4+4))=
*                   ALTPATRN;                                      0140
         LA    @10,BLOCK(@07)                                      0140
         MVC   0(4,@10),ALTPATRN                                   0140
*             END;                  /*                       @OZ09548*/
*         END;                      /*                       @OZ09548*/
@RF00135 DS    0H                                                  0143
*       BITPOSN=BITPOSN/2;          /*                       @Y30LB14*/
@RF00118 SRL   BITPOSN,1                                           0143
*     END;                          /*                       @Y30LB14*/
         AH    J,@CH00042                                          0144
         CH    J,@CH00309                                          0144
         BNH   @DL00117                                            0144
*     BLOCK(((4*I)+((I-1)/3)*4+1):((4*I)+((I-1)/3)*4+4))=BITPATRN;/*
*                                                            @Y30LB14*/
         LR    @10,I                                               0145
         SLA   @10,2                                               0145
         LR    @00,I                                               0145
         BCTR  @00,0                                               0145
         SRDA  @00,32                                              0145
         D     @00,@CF00048                                        0145
         SLA   @01,2                                               0145
         ALR   @10,@01                                             0145
         LA    @05,BLOCK(@10)                                      0145
         MVC   0(4,@05),BITPATRN                                   0145
*   END;                            /*                       @Y30LB14*/
*                                                                  0146
         AH    I,@CH00042                                          0146
         CH    I,@CH00235                                          0146
         BNH   @DL00089                                            0146
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* PLACE BLOCK IMAGE IN 9TH BLOCK POSITION IN            @Y30LB14*/
*   /* THE TRACK IMAGE AND RETURN TO CALLER.                 @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0147
*   OBLOCK(9)=BLOCK;                /*                       @Y30LB14*/
         L     @10,BUILDPTR(,R4)                                   0147
         AL    @10,@CF00499                                        0147
         MVC   OBLOCK(256,@10),BLOCK                               0147
*   RETURN;                         /*                       @Y30LB14*/
@EL00003 DS    0H                                                  0148
@EF00003 DS    0H                                                  0148
@ER00003 LM    @14,@12,12(@13)                                     0148
         BR    @14                                                 0148
*   END NINTHBLK;                   /*                       @Y30LB14*/
*                                                                  0150
*/*********************************************************  @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - FIFTHBLK                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE BUILDS THE FIFTH BLOCK (VIRGIN   @XD00153*/
*/*            CARTRIDGE IMAGE) OF THE CONFIGURATION TABLE   @XD00153*/
*/*                                                          @XD00153*/
*/*********************************************************  @XD00153*/
*                                                                  0150
*FIFTHBLK:                                                         0150
*   PROCEDURE;                      /*                       @Y30LB14*/
FIFTHBLK STM   @14,@12,12(@13)                                     0150
*   ZEROS=''B;                      /* ZERO BLOCK IMAGE      @Y30LB14*/
         XC    ZEROS(256),ZEROS                                    0151
*   BLOCK(1:4)='VOL1';              /* 'VOL1' IN BYTES 1-4   @Y30LB14*/
*                                                                  0152
         MVC   BLOCK(4),@CC00437                                   0152
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* PUT BLANKS ('40'X) IN BYTES 5 THROUGH 79              @OZ13047*/
*   /* ENTER STRING CONSTANTS IN BYTES 80 THRU 86,           @OZ13047*/
*   /* AND 93 THRU 96.                                       @XD00153*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0153
*   DO I=5 TO 79;                   /*                       @OZ13047*/
         LA    I,5                                                 0153
@DL00153 DS    0H                                                  0154
*     BLK(I)=' ';                   /*                       @Y30LB14*/
         LA    @10,BLK-1(I)                                        0154
         MVI   0(@10),C' '                                         0154
*   END;                            /*                       @Y30LB14*/
         AH    I,@CH00042                                          0155
         CH    I,@CH00438                                          0155
         BNH   @DL00153                                            0155
*   BLOCK(80:86)='E30194001332E6'X; /* CONSTANT              @OZ13047*/
         MVC   BLOCK+79(7),@CB00441                                0156
*   BLOCK(93:96)='080000F1'X;       /* CONSTANT              @Y30LB14*/
*                                                                  0157
         MVC   BLOCK+92(4),@CB00444                                0157
*   /*****************************************************************/
*   /*                                                               */
*   /* ***********************************************       @XD00153*/
*   /* PUT BLOCK IMAGE IN 5TH BLOCK POSITION IN THE          @Y30LB14*/
*   /* TRACK AND RETURN.                                     @Y30LB14*/
*   /* ***********************************************       @XD00153*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0158
*   OBLOCK(5)=BLOCK;                /*                       @Y30LB14*/
         L     @10,BUILDPTR(,R4)                                   0158
         AL    @10,@CF00500                                        0158
         MVC   OBLOCK(256,@10),BLOCK                               0158
*   RETURN;                         /*                       @Y30LB14*/
@EL00004 DS    0H                                                  0159
@EF00004 DS    0H                                                  0159
@ER00004 LM    @14,@12,12(@13)                                     0159
         BR    @14                                                 0159
*   END FIFTHBLK;                   /*                       @Y30LB14*/
*                                                                  0161
*/*********************************************************  @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - RSVDBLOC                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE ZEROS BLOCKS 1,5,9,13,17,21,25,  @XD00153*/
*/*            AND 29 OF THE TRACK IMAGE.                    @XD00153*/
*/*                                                          @XD00153*/
*/*********************************************************  @XD00153*/
*                                                                  0161
*RSVDBLOC:                                                         0161
*   PROCEDURE;                      /*                       @Y30LB14*/
RSVDBLOC STM   @14,@12,12(@13)                                     0161
*   ZEROS=''B;                      /*                       @Y30LB14*/
         XC    ZEROS(256),ZEROS                                    0162
*   DO I=0 TO 7;                    /*                       @Y30LB14*/
         SLR   I,I                                                 0163
@DL00163 DS    0H                                                  0164
*     OBLOCK(4*I+1)=BLOCK;          /*                       @Y30LB14*/
         LR    @10,I                                               0164
         MH    @10,@CH00476                                        0164
         L     @05,BUILDPTR(,R4)                                   0164
         ALR   @05,@10                                             0164
         AL    @05,@CF00469                                        0164
         MVC   OBLOCK(256,@05),BLOCK                               0164
*   END;                            /*                       @Y30LB14*/
         AH    I,@CH00042                                          0165
         CH    I,@CH00133                                          0165
         BNH   @DL00163                                            0165
*   RETURN;                         /*                       @Y30LB14*/
@EL00005 DS    0H                                                  0166
@EF00005 DS    0H                                                  0166
@ER00005 LM    @14,@12,12(@13)                                     0166
         BR    @14                                                 0166
*   END RSVDBLOC;                   /*                       @Y30LB14*/
*                                                                  0168
*/*********************************************************  @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - DSBLOCKS                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE SETS UP THE 'DSBLOCKS'           @XD00153*/
*/*            THESE BLOCKS ARE THE 2,3,4, 6,7,8, 10,11,12,  @XD00153*/
*/*            - - - 30,31,32 BLOCKS.                        @XD00153*/
*/*                                                          @XD00153*/
*/*********************************************************  @XD00153*/
*                                                                  0168
*DSBLOCKS:                                                         0168
*   PROCEDURE;                      /*                       @Y30LB14*/
DSBLOCKS STM   @14,@12,@SA00006                                    0168
*   DO I=1 TO 24;                   /*                       @Y30LB14*/
         LA    I,1                                                 0169
@DL00169 DS    0H                                                  0170
*     K=TWO4+I;                     /*                       @Y30LB14*/
         LR    K,TWO4                                              0170
         ALR   K,I                                                 0170
*     DO J=1 TO 64;                 /*                       @Y30LB14*/
         LA    J,1                                                 0171
@DL00171 DS    0H                                                  0172
*       IF USEV(K,J)='1'B×USEVS(K,J)='1'B THEN                     0172
         LR    @10,K                                               0172
         SLA   @10,6                                               0172
         ALR   @10,J                                               0172
         MH    @10,@CH00246                                        0172
         L     @06,COMPTR2(,R4)                                    0172
         ST    @10,@TF00001                                        0172
         ALR   @10,@06                                             0172
         AL    @10,@CF00492                                        0172
         TM    USEV-464(@10),B'01100000'                           0172
         BZ    @RF00172                                            0172
*         DO;                       /*                       @Y30LB14*/
*           RSGBYTE=INDEXRSG(K,J);  /*                       @Y30LB14*/
         L     @10,COMPTR2(,R4)                                    0174
         L     @01,@TF00001                                        0174
         AL    @10,@CF00501                                        0174
         SLR   RSGBYTE,RSGBYTE                                     0174
         IC    RSGBYTE,INDEXRSG-465(@01,@10)                       0174
*           IF RSGABOX1(RSGBYTE+1)='1'B THEN                       0175
         LR    @10,RSGBYTE                                         0175
         MH    @10,@CH00112                                        0175
         ALR   @10,R4                                              0175
         TM    RSGABOX1(@10),B'00100000'                           0175
         BNO   @RF00175                                            0175
*             RSGBYTE=RSGBYTE+32;   /*                       @Y30LB14*/
         AH    RSGBYTE,@CH00309                                    0176
*           IF USEV(K,J)='1'B THEN                                 0177
@RF00175 LR    @10,K                                               0177
         SLA   @10,6                                               0177
         ALR   @10,J                                               0177
         MH    @10,@CH00246                                        0177
         L     @01,COMPTR2(,R4)                                    0177
         ALR   @01,@10                                             0177
         AL    @01,@CF00492                                        0177
         TM    USEV-464(@01),B'01000000'                           0177
         BNO   @RF00177                                            0177
*             RSGBYTE=RSGBYTE+128;  /*                       @Y30LB14*/
         AH    RSGBYTE,@CH00426                                    0178
*           BYTES(4*J-3)=RSGBYTE;   /*                       @Y30LB14*/
@RF00177 LR    @10,J                                               0179
         SLA   @10,2                                               0179
         STC   RSGBYTE,BYTES-4(@10)                                0179
*           ALTPATHS='00'X;         /*                       @OZ11012*/
         MVI   ALTPATHS,X'00'                                      0180
*           CALL DOPATHS;           /*                       @OZ11012*/
         BAL   @14,DOPATHS                                         0181
*           BYTES(4*J-2)=ALTPATHS;  /*                       @OZ11012*/
         LR    @10,J                                               0182
         SLA   @10,2                                               0182
         SLR   @06,@06                                             0182
         IC    @06,ALTPATHS                                        0182
         STC   @06,BYTES-3(@10)                                    0182
*           BYTES(4*J-1)='00'X;     /*                       @OZ11012*/
         SLR   @06,@06                                             0183
         STC   @06,BYTES-2(@10)                                    0183
*           BYTES(4*J)='00'X;       /*                       @OZ11012*/
         STC   @06,BYTES-1(@10)                                    0184
*         END;                      /*                       @Y30LB14*/
*       ELSE                                                       0186
*         DO;                       /*                       @Y30LB14*/
         B     @RC00172                                            0186
@RF00172 DS    0H                                                  0187
*           BYTES(4*J-3)='FF'X;     /*                       @Y30LB14*/
         LR    @10,J                                               0187
         SLA   @10,2                                               0187
         LA    @06,255                                             0187
         STC   @06,BYTES-4(@10)                                    0187
*           DO L=-2 TO 0;           /*                       @Y30LB14*/
         LH    L,@CH00453                                          0188
@DL00188 DS    0H                                                  0189
*             BYTES(4*J+L)='00'X;   /*                       @Y30LB14*/
         LR    @10,J                                               0189
         SLA   @10,2                                               0189
         ALR   @10,L                                               0189
         SLR   @15,@15                                             0189
         STC   @15,BYTES-1(@10)                                    0189
*           END;                    /*                       @Y30LB14*/
         AH    L,@CH00042                                          0190
         LTR   L,L                                                 0190
         BNP   @DL00188                                            0190
*         END;                      /*                       @Y30LB14*/
*     END;                          /* END OF DO J LOOP      @Y30LB14*/
@RC00172 AH    J,@CH00042                                          0192
         CH    J,@CH00245                                          0192
         BNH   @DL00171                                            0192
*     OBLOCK(I+1+(I-1)/3)=BLOCK;    /*                       @Y30LB14*/
         LA    @10,1                                               0193
         ALR   @10,I                                               0193
         LR    @00,I                                               0193
         BCTR  @00,0                                               0193
         SRDA  @00,32                                              0193
         D     @00,@CF00048                                        0193
         ALR   @10,@01                                             0193
         MH    @10,@CH00477                                        0193
         L     @06,BUILDPTR(,R4)                                   0193
         ALR   @06,@10                                             0193
         AL    @06,@CF00502                                        0193
         MVC   OBLOCK(256,@06),BLOCK                               0193
*   END;                            /* END OF DO I LOOP      @Y30LB14*/
         AH    I,@CH00042                                          0194
         CH    I,@CH00259                                          0194
         BNH   @DL00169                                            0194
*   RETURN;                                                        0195
@EL00006 DS    0H                                                  0195
@EF00006 DS    0H                                                  0195
@ER00006 LM    @14,@12,@SA00006                                    0195
         BR    @14                                                 0195
*   END DSBLOCKS;                   /*                       @Y30LB14*/
*                                                                  0197
*/********************************************************** @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - WRITETRK                                @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE PUTS THE PREFIX INFORMATION FOR  @XD00153*/
*/*            A TRACK (32 BLOCKS WORTH) AND CALLS 'WRITE'   @XD00153*/
*/*            TO WRITE THE TRACK.                           @XD00153*/
*/*                                                          @XD00153*/
*/********************************************************** @XD00153*/
*                                                                  0197
*WRITETRK:                                                         0197
*   PROCEDURE;                      /*                       @Y30LB14*/
WRITETRK STM   @14,@12,@SA00007                                    0197
*   DO K=1 TO 32;                   /*                       @Y30LB14*/
         LA    K,1                                                 0198
@DL00198 DS    0H                                                  0199
*     OUTREC(K)=K;                  /* SET PREFIX RECORD NUM @XD00153*/
         LR    @10,K                                               0199
         MH    @10,@CH00477                                        0199
         LH    @05,@CH00469                                        0199
         AL    @05,BUILDPTR(,R4)                                   0199
         LA    @02,0(@10,@05)                                      0199
         AL    @02,@CF00503                                        0199
         STC   K,OUTREC-11(,@02)                                   0199
*     OUTHEAD(K)=OUTHEAD(1);        /* SET THE HEAD NUMBER   @Y30LB14*/
         SLR   @02,@02                                             0200
         IC    @02,OUTHEAD(,@05)                                   0200
         LA    @01,0(@10,@05)                                      0200
         AL    @01,@CF00504                                        0200
         STC   @02,OUTHEAD-10(,@01)                                0200
*     OUTCYL(K)=OUTCYL(1);          /* SET THE CYL NUMBER    @Y30LB14*/
         SLR   @02,@02                                             0201
         IC    @02,OUTCYL(,@05)                                    0201
         LA    @01,0(@10,@05)                                      0201
         AL    @01,@CF00505                                        0201
         STC   @02,OUTCYL-9(,@01)                                  0201
*     OUTABLID(K)='70'X;            /* TABLE ID IN PREFIX    @Y30LB14*/
         ST    @10,@TF00001                                        0202
         ALR   @10,@05                                             0202
         AL    @10,@CF00506                                        0202
         MVI   OUTABLID-8(@10),X'70'                               0202
*     OUTFLR(K)=''B;                /* SET FILLER TO ZERO    @Y30LB14*/
         AL    @05,@TF00001                                        0203
         AL    @05,@CF00507                                        0203
         XC    OUTFLR-12(4,@05),OUTFLR-12(@05)                     0203
*   END;                            /*                       @Y30LB14*/
         AH    K,@CH00042                                          0204
         CH    K,@CH00309                                          0204
         BNH   @DL00198                                            0204
*   CALL WRITE;                     /* WRITE OUT THE TRACK   @Y30LB14
*                                                            @Y30LB14*/
         BAL   @14,WRITE                                           0205
*   RETURN;                         /* RETURN TO CALLER      @Y30LB14
*                                                            @Y30LB14*/
@EL00007 DS    0H                                                  0206
@EF00007 DS    0H                                                  0206
@ER00007 LM    @14,@12,@SA00007                                    0206
         BR    @14                                                 0206
*   END WRITETRK;                   /*                       @Y30LB14*/
*                                                                  0208
*/********************************************************** @XD00153*/
*/*                                                          @XD00153*/
*/* PROCEDURE NAME - WRITE                                   @XD00153*/
*/*                                                          @XD00153*/
*/* FUNCTION - THIS ROUTINE WRITES THE TRACK VIA ICGDSB06    @XD00153*/
*/*            THEN SETS THE CYLINDER, TRACK AND RECORD      @XD00153*/
*/*            (CCHHR) TO THE NEXT SEQUENTIAL LOCATION.      @XD00153*/
*/*                                                          @XD00153*/
*/********************************************************** @XD00153*/
*                                                                  0208
*WRITE:                                                            0208
*   PROCEDURE;                      /*                       @Y30LB14*/
WRITE    STM   @14,@12,@SA00008                                    0208
*   B06ADDR=OUTADDR;                /* OUTPUT ADDR FOR B06   @XD00153*/
         L     @10,BUILDPTR(,R4)                                   0209
         MVC   B06ADDR(3,@10),OUTADDR(@10)                         0209
*   GEN(LINK EP=ICGDSB06);          /* WRITE OUT TRACK       @Y30LB14*/
         LINK EP=ICGDSB06
*   UT2VHEAD=UT2VHEAD+1;            /* INCR TO NEXT TRACK    @Y30LB14*/
         L     @10,BUILDPTR(,R4)                                   0211
         LA    @05,1                                               0211
         SLR   @15,@15                                             0211
         IC    @15,UT2VHEAD(,@10)                                  0211
         ALR   @15,@05                                             0211
         STC   @15,UT2VHEAD(,@10)                                  0211
*   IF UT2VHEAD>18                  /*                       @Y30LB14*/
*     THEN                          /*                       @Y30LB14*/
         CLI   UT2VHEAD(@10),18                                    0212
         BNH   @RF00212                                            0212
*     DO;                           /*                       @Y30LB14*/
*       UT2VHEAD=0;                 /* SET TRACK TO ZERO     @Y30LB14*/
         MVI   UT2VHEAD(@10),X'00'                                 0214
*       UT2VCYL=UT2VCYL+1;          /* INCR TO NEXT CYL      @Y30LB14*/
         MVC   @ZT00003+3(1),UT2VCYL(@10)                          0215
         AL    @05,@ZT00003                                        0215
         STC   @05,UT2VCYL(,@10)                                   0215
*     END;                          /*                       @Y30LB14*/
*   OUTCYL(1)=UT2VCYL;              /* SET NEXT AVAIL CYL    @XD00153*/
@RF00212 L     @10,BUILDPTR(,R4)                                   0217
         LH    @05,@CH00469                                        0217
         ALR   @05,@10                                             0217
         MVC   OUTCYL(1,@05),UT2VCYL(@10)                          0217
*   OUTHEAD(1)=UT2VHEAD;            /* SET NEXT AVAIL HEAD   @XD00153*/
         MVC   OUTHEAD(1,@05),UT2VHEAD(@10)                        0218
*   RETURN;                         /* RETURN TO CALLER      @Y30LB14*/
@EL00008 DS    0H                                                  0219
@EF00008 DS    0H                                                  0219
@ER00008 LM    @14,@12,@SA00008                                    0219
         BR    @14                                                 0219
*   END WRITE;                      /*                       @Y30LB14*/
*                                                                  0221
*/********************************************************** @OZ11012*/
*/*                                                          @OZ11012*/
*/* PROCEDURE NAME - DOPATHS                                 @OZ11012*/
*/*                                                          @OZ11012*/
*/* FUNCTION - THIS PROCEDURE SETS UP ALTERNATE PATH BITS    @OZ11012*/
*/*            FOR THE CONFIGURATION DATA BLOCK.  BITS 1     @OZ11012*/
*/*            AND 5 ARE UNUSED.  BITS 2, 3, AND 4 ARE FOR   @OZ11012*/
*/*            INTERFACES B, C, AND D OF SA1 RESPECTIVELY.   @OZ11012*/
*/*            BITS 6, 7, AND 8 ARE FOR INTERFACES B, C,     @OZ11012*/
*/*            AND D OF SA2 RESPECTIVELY.  SA1 IS THE FIRST  @OZ11012*/
*/*            (AND LOWER) STAGING ADAPTER INDICATED IN THE  @OZ11012*/
*/*            PAB OF THE SDG TABLE.  SA2 IS THE SECOND AND  @OZ11012*/
*/*            HIGHER STAGING ADAPTER IN THE PAB FOR THIS    @OZ11012*/
*/*            STAGING DRIVE GROUP.                          @OZ11012*/
*/*                                                          @OZ11012*/
*/********************************************************** @OZ11012*/
*                                                                  0221
*DOPATHS:                                                          0221
*   PROCEDURE;                      /*                       @OZ11012*/
DOPATHS  STM   @14,@12,12(@13)                                     0221
*   IF ALTCI1(K,J)^='00'X           /* PATH DEFINED          @OZ11012*/
*     THEN                          /*                       @OZ11012*/
         LR    @10,K                                               0222
         SLA   @10,6                                               0222
         ALR   @10,J                                               0222
         MH    @10,@CH00246                                        0222
         L     @02,COMPTR2(,R4)                                    0222
         ST    @10,@TF00001                                        0222
         ALR   @10,@02                                             0222
         AL    @10,@CF00493                                        0222
         CLI   ALTCI1-467(@10),X'00'                               0222
         BE    @RF00222                                            0222
*     DO;                           /*                       @OZ11012*/
*       IF ALTDS1(K,J)=TODS1(INDEXRSG(K,J)+1)/*              @B200009*/
*         THEN                      /*                       @OZ11012*/
         L     @10,@TF00001                                        0224
         AL    @10,@CF00501                                        0224
         SLR   @15,@15                                             0224
         IC    @15,INDEXRSG-465(@10,@02)                           0224
         MH    @15,@CH00112                                        0224
         LR    @10,@02                                             0224
         AL    @10,@TF00001                                        0224
         AL    @10,@CF00494                                        0224
         ALR   @15,R4                                              0224
         CLC   ALTDS1-466(1,@10),TODS1(@15)                        0224
         BNE   @RF00224                                            0224
*         DO;                       /*                       @OZ11012*/
*           IF ALTCI1(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         AL    @02,@TF00001                                        0226
         AL    @02,@CF00493                                        0226
         CLI   ALTCI1-467(@02),X'01'                               0226
         BNE   @RF00226                                            0226
*             ALTPATHS(2)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'01000000'                                0227
*           IF ALTCI1(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00226 LR    @10,K                                               0228
         SLA   @10,6                                               0228
         ALR   @10,J                                               0228
         MH    @10,@CH00246                                        0228
         L     @02,COMPTR2(,R4)                                    0228
         ALR   @02,@10                                             0228
         AL    @02,@CF00493                                        0228
         CLI   ALTCI1-467(@02),X'02'                               0228
         BNE   @RF00228                                            0228
*             ALTPATHS(3)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00100000'                                0229
*           IF ALTCI1(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00228 LR    @10,K                                               0230
         SLA   @10,6                                               0230
         ALR   @10,J                                               0230
         MH    @10,@CH00246                                        0230
         L     @02,COMPTR2(,R4)                                    0230
         ALR   @02,@10                                             0230
         AL    @02,@CF00493                                        0230
         CLI   ALTCI1-467(@02),X'03'                               0230
         BNE   @RF00230                                            0230
*             ALTPATHS(4)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00010000'                                0231
*         END;                      /*                       @OZ11012*/
*       ELSE                        /*                       @OZ11012*/
*         DO;                       /*                       @OZ11012*/
         B     @RC00224                                            0233
@RF00224 DS    0H                                                  0234
*           IF ALTCI1(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         LR    @10,K                                               0234
         SLA   @10,6                                               0234
         ALR   @10,J                                               0234
         MH    @10,@CH00246                                        0234
         L     @02,COMPTR2(,R4)                                    0234
         ALR   @02,@10                                             0234
         AL    @02,@CF00493                                        0234
         CLI   ALTCI1-467(@02),X'01'                               0234
         BNE   @RF00234                                            0234
*             ALTPATHS(6)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000100'                                0235
*           IF ALTCI1(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00234 LR    @10,K                                               0236
         SLA   @10,6                                               0236
         ALR   @10,J                                               0236
         MH    @10,@CH00246                                        0236
         L     @02,COMPTR2(,R4)                                    0236
         ALR   @02,@10                                             0236
         AL    @02,@CF00493                                        0236
         CLI   ALTCI1-467(@02),X'02'                               0236
         BNE   @RF00236                                            0236
*             ALTPATHS(7)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000010'                                0237
*           IF ALTCI1(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00236 LR    @10,K                                               0238
         SLA   @10,6                                               0238
         ALR   @10,J                                               0238
         MH    @10,@CH00246                                        0238
         L     @02,COMPTR2(,R4)                                    0238
         ALR   @02,@10                                             0238
         AL    @02,@CF00493                                        0238
         CLI   ALTCI1-467(@02),X'03'                               0238
         BNE   @RF00238                                            0238
*             ALTPATHS(8)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000001'                                0239
*         END;                      /*                       @OZ11012*/
*     END;                          /*                       @OZ11012*/
*   ELSE                            /*                       @OZ11012*/
*     RETURN;                       /* NO ALTERNATE PATHS    @OZ11012*/
*   IF ALTCI2(K,J)^='00'X           /* PATH DEFINED          @OZ11012*/
*     THEN                          /*                       @OZ11012*/
@RC00222 LR    @10,K                                               0243
         SLA   @10,6                                               0243
         ALR   @10,J                                               0243
         MH    @10,@CH00246                                        0243
         L     @02,COMPTR2(,R4)                                    0243
         ST    @10,@TF00001                                        0243
         ALR   @10,@02                                             0243
         AL    @10,@CF00495                                        0243
         CLI   ALTCI2-470(@10),X'00'                               0243
         BE    @RF00243                                            0243
*     DO;                           /*                       @OZ11012*/
*       IF ALTDS2(K,J)=TODS1(INDEXRSG(K,J)+1)/*              @B200009*/
*         THEN                      /*                       @OZ11012*/
         L     @10,@TF00001                                        0245
         AL    @10,@CF00501                                        0245
         SLR   @15,@15                                             0245
         IC    @15,INDEXRSG-465(@10,@02)                           0245
         MH    @15,@CH00112                                        0245
         LR    @10,@02                                             0245
         AL    @10,@TF00001                                        0245
         AL    @10,@CF00496                                        0245
         ALR   @15,R4                                              0245
         CLC   ALTDS2-469(1,@10),TODS1(@15)                        0245
         BNE   @RF00245                                            0245
*         DO;                       /*                       @OZ11012*/
*           IF ALTCI2(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         AL    @02,@TF00001                                        0247
         AL    @02,@CF00495                                        0247
         CLI   ALTCI2-470(@02),X'01'                               0247
         BNE   @RF00247                                            0247
*             ALTPATHS(2)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'01000000'                                0248
*           IF ALTCI2(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00247 LR    @10,K                                               0249
         SLA   @10,6                                               0249
         ALR   @10,J                                               0249
         MH    @10,@CH00246                                        0249
         L     @02,COMPTR2(,R4)                                    0249
         ALR   @02,@10                                             0249
         AL    @02,@CF00495                                        0249
         CLI   ALTCI2-470(@02),X'02'                               0249
         BNE   @RF00249                                            0249
*             ALTPATHS(3)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00100000'                                0250
*           IF ALTCI2(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00249 LR    @10,K                                               0251
         SLA   @10,6                                               0251
         ALR   @10,J                                               0251
         MH    @10,@CH00246                                        0251
         L     @02,COMPTR2(,R4)                                    0251
         ALR   @02,@10                                             0251
         AL    @02,@CF00495                                        0251
         CLI   ALTCI2-470(@02),X'03'                               0251
         BNE   @RF00251                                            0251
*             ALTPATHS(4)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00010000'                                0252
*         END;                      /*                       @OZ11012*/
*       ELSE                        /*                       @OZ11012*/
*         DO;                       /*                       @OZ11012*/
         B     @RC00245                                            0254
@RF00245 DS    0H                                                  0255
*           IF ALTCI2(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         LR    @10,K                                               0255
         SLA   @10,6                                               0255
         ALR   @10,J                                               0255
         MH    @10,@CH00246                                        0255
         L     @02,COMPTR2(,R4)                                    0255
         ALR   @02,@10                                             0255
         AL    @02,@CF00495                                        0255
         CLI   ALTCI2-470(@02),X'01'                               0255
         BNE   @RF00255                                            0255
*             ALTPATHS(6)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000100'                                0256
*           IF ALTCI2(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00255 LR    @10,K                                               0257
         SLA   @10,6                                               0257
         ALR   @10,J                                               0257
         MH    @10,@CH00246                                        0257
         L     @02,COMPTR2(,R4)                                    0257
         ALR   @02,@10                                             0257
         AL    @02,@CF00495                                        0257
         CLI   ALTCI2-470(@02),X'02'                               0257
         BNE   @RF00257                                            0257
*             ALTPATHS(7)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000010'                                0258
*           IF ALTCI2(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00257 LR    @10,K                                               0259
         SLA   @10,6                                               0259
         ALR   @10,J                                               0259
         MH    @10,@CH00246                                        0259
         L     @02,COMPTR2(,R4)                                    0259
         ALR   @02,@10                                             0259
         AL    @02,@CF00495                                        0259
         CLI   ALTCI2-470(@02),X'03'                               0259
         BNE   @RF00259                                            0259
*             ALTPATHS(8)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000001'                                0260
*         END;                      /*                       @OZ11012*/
*     END;                          /*                       @OZ11012*/
*   ELSE                            /*                       @OZ11012*/
*     RETURN;                       /* NO SECOND ALT PATH    @OZ11012*/
*   IF ALTCI3(K,J)^='00'X           /* PATH DEFINED          @OZ11012*/
*     THEN                          /*                       @OZ11012*/
@RC00243 LR    @10,K                                               0264
         SLA   @10,6                                               0264
         ALR   @10,J                                               0264
         MH    @10,@CH00246                                        0264
         L     @02,COMPTR2(,R4)                                    0264
         ST    @10,@TF00001                                        0264
         ALR   @10,@02                                             0264
         AL    @10,@CF00497                                        0264
         CLI   ALTCI3-473(@10),X'00'                               0264
         BE    @RF00264                                            0264
*     DO;                           /*                       @OZ11012*/
*       IF ALTDS3(K,J)=TODS1(INDEXRSG(K,J)+1)/*              @B200009*/
*         THEN                      /*                       @OZ11012*/
         L     @10,@TF00001                                        0266
         AL    @10,@CF00501                                        0266
         SLR   @15,@15                                             0266
         IC    @15,INDEXRSG-465(@10,@02)                           0266
         MH    @15,@CH00112                                        0266
         LR    @10,@02                                             0266
         AL    @10,@TF00001                                        0266
         AL    @10,@CF00498                                        0266
         ALR   @15,R4                                              0266
         CLC   ALTDS3-472(1,@10),TODS1(@15)                        0266
         BNE   @RF00266                                            0266
*         DO;                       /*                       @OZ11012*/
*           IF ALTCI3(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         AL    @02,@TF00001                                        0268
         AL    @02,@CF00497                                        0268
         CLI   ALTCI3-473(@02),X'01'                               0268
         BNE   @RF00268                                            0268
*             ALTPATHS(2)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'01000000'                                0269
*           IF ALTCI3(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00268 LR    @10,K                                               0270
         SLA   @10,6                                               0270
         ALR   @10,J                                               0270
         MH    @10,@CH00246                                        0270
         L     @02,COMPTR2(,R4)                                    0270
         ALR   @02,@10                                             0270
         AL    @02,@CF00497                                        0270
         CLI   ALTCI3-473(@02),X'02'                               0270
         BNE   @RF00270                                            0270
*             ALTPATHS(3)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00100000'                                0271
*           IF ALTCI3(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00270 LR    @10,K                                               0272
         SLA   @10,6                                               0272
         ALR   @10,J                                               0272
         MH    @10,@CH00246                                        0272
         L     @02,COMPTR2(,R4)                                    0272
         ALR   @02,@10                                             0272
         AL    @02,@CF00497                                        0272
         CLI   ALTCI3-473(@02),X'03'                               0272
         BNE   @RF00272                                            0272
*             ALTPATHS(4)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00010000'                                0273
*         END;                      /*                       @OZ11012*/
*       ELSE                        /*                       @OZ11012*/
*         DO;                       /*                       @OZ11012*/
         B     @RC00266                                            0275
@RF00266 DS    0H                                                  0276
*           IF ALTCI3(K,J)='01'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
         LR    @10,K                                               0276
         SLA   @10,6                                               0276
         ALR   @10,J                                               0276
         MH    @10,@CH00246                                        0276
         L     @02,COMPTR2(,R4)                                    0276
         ALR   @02,@10                                             0276
         AL    @02,@CF00497                                        0276
         CLI   ALTCI3-473(@02),X'01'                               0276
         BNE   @RF00276                                            0276
*             ALTPATHS(6)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000100'                                0277
*           IF ALTCI3(K,J)='02'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00276 LR    @10,K                                               0278
         SLA   @10,6                                               0278
         ALR   @10,J                                               0278
         MH    @10,@CH00246                                        0278
         L     @02,COMPTR2(,R4)                                    0278
         ALR   @02,@10                                             0278
         AL    @02,@CF00497                                        0278
         CLI   ALTCI3-473(@02),X'02'                               0278
         BNE   @RF00278                                            0278
*             ALTPATHS(7)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000010'                                0279
*           IF ALTCI3(K,J)='03'X    /*                       @OZ11012*/
*             THEN                  /*                       @OZ11012*/
@RF00278 LR    @10,K                                               0280
         SLA   @10,6                                               0280
         ALR   @10,J                                               0280
         MH    @10,@CH00246                                        0280
         L     @02,COMPTR2(,R4)                                    0280
         ALR   @02,@10                                             0280
         AL    @02,@CF00497                                        0280
         CLI   ALTCI3-473(@02),X'03'                               0280
         BNE   @RF00280                                            0280
*             ALTPATHS(8)='1'B;     /*                       @OZ11012*/
         OI    ALTPATHS,B'00000001'                                0281
*         END;                      /*                       @OZ11012*/
*     END;                          /*                       @OZ11012*/
*   END DOPATHS;                    /*                       @OZ11012*/
@EL00009 DS    0H                                                  0284
@EF00009 DS    0H                                                  0284
@ER00009 LM    @14,@12,12(@13)                                     0284
         BR    @14                                                 0284
*                                                                  0285
*/********************************************************** @XD00153*/
*/*                  P A T C H   A R E A                     @XD00153*/
*/********************************************************** @XD00153*/
*                                                                  0285
*   GENERATE;                                                      0285
*                                                         /*@XD00153*/
PATCHB08 DC    32C'PATCHB08'                              /*@XD00153*/
*   END ICGDSB08                    /*                       @Y30LB14*/
*                                                                  0286
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */
*/*%INCLUDE SYSLIB  (ICGDSMA5)                                       */
*                                                                  0286
*       ;                                                          0286
         B     @EL00001                                            0286
@DATA    DS    0H
@CH00042 DC    H'1'
@CH00068 DC    H'4'
@CH00133 DC    H'7'
@CH00112 DC    H'9'
@CH00246 DC    H'11'
@CH00128 DC    H'12'
@CH00162 DC    H'16'
@CH00259 DC    H'24'
@CH00309 DC    H'32'
@CH00235 DC    H'48'
@CH00245 DC    H'64'
@CH00438 DC    H'79'
@CH00426 DC    H'128'
@CH00477 DC    H'272'
@CH00472 DC    H'704'
@CH00476 DC    H'1088'
@CH00453 DC    H'-2'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00008 DS    15F
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
ICGDSB08 CSECT
         DS    0F
@CF00048 DC    F'3'
@CF00502 DC    F'13260'
@CF00469 DC    F'13532'
@CH00469 EQU   @CF00469+2
@CF00500 DC    F'14620'
@CF00499 DC    F'15708'
@CF00431 DC    F'1073741824'
@CF00506 DC    F'-264'
@CF00505 DC    F'-263'
@CF00504 DC    F'-262'
@CF00503 DC    F'-261'
@CF00507 DC    F'-260'
@CF00492 DC    F'-251'
@CF00501 DC    F'-250'
@CF00494 DC    F'-249'
@CF00493 DC    F'-248'
@CF00496 DC    F'-246'
@CF00495 DC    F'-245'
@CF00498 DC    F'-243'
@CF00497 DC    F'-242'
@CF00485 DC    F'-240'
@CF00487 DC    F'-238'
@CF00486 DC    F'-237'
@CF00489 DC    F'-235'
@CF00488 DC    F'-234'
@CF00491 DC    F'-232'
@CF00490 DC    F'-231'
@DATD    DSECT
         DS    0D
FLAGS    DS    FL1
         ORG   FLAGS
BIT0     DS    BL1
@NM00029 EQU   FLAGS+0
BIT4     EQU   FLAGS+0
BIT5     EQU   FLAGS+0
BIT6     EQU   FLAGS+0
BIT7     EQU   FLAGS+0
         ORG   FLAGS+1
BLOCK    DS    CL256
         ORG   BLOCK
ZEROS    DS    BL256
         ORG   BLOCK+256
         DS    CL7
BITPATRN DS    CL4
         ORG   BITPATRN
BITPAT   DS    FL4
         ORG   BITPAT
FIRST8   DS    BL1
@NM00030 DS    BL3
         ORG   BITPATRN+4
         DS    CL4
ALTPATRN DS    CL4
         ORG   ALTPATRN
ALTPAT   DS    FL4
         ORG   ALTPAT
ALT8     DS    BL1
@NM00031 DS    BL3
         ORG   ALTPATRN+4
ALTPATHS DS    BL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ICGDSB08 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00437 DC    C'VOL1'
@CB00441 DC    X'E30194001332E6'
@CB00444 DC    X'080000F1'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
BITPOSN  EQU   @06
RSGBYTE  EQU   @06
TWO4     EQU   @07
M        EQU   @03
L        EQU   @06
K        EQU   @03
J        EQU   @05
I        EQU   @02
R4       EQU   @04
COMTAB   EQU   0
READER   EQU   COMTAB+256
READFLAG EQU   READER+96
PCHBF    EQU   READER+99
STARTCOL EQU   READER+180
NEXTCOL  EQU   READER+184
PRINTER  EQU   COMTAB+464
MESSAGES EQU   COMTAB+810
SPECLMSG EQU   MESSAGES+18
GENIO    EQU   COMTAB+832
DCBPTR   EQU   GENIO+4
COMPTR2  EQU   GENIO+16
BUILDPTR EQU   GENIO+20
INVOKED  EQU   COMTAB+856
SAVEDDS  EQU   INVOKED+4
BUILDRSG EQU   COMTAB+900
RSGS     EQU   BUILDRSG
RSG      EQU   RSGS
RSGABOX  EQU   RSG
RSGABOX1 EQU   RSGABOX
RSGTODS  EQU   RSG+7
TODS1    EQU   RSGTODS
LIBRARY  EQU   COMTAB+1170
LIBS     EQU   LIBRARY
LIB      EQU   LIBS
LIBBITS  EQU   LIB
LIBSPEC  EQU   LIBBITS
LIBDSMID EQU   LIB+2
PABTABLE EQU   COMTAB+1218
PABDEV   EQU   PABTABLE
PABFLAGS EQU   PABDEV
PABREAL  EQU   PABDEV+1
PABAADDD EQU   PABDEV+2
DSPAIRS  EQU   COMTAB+1938
PHYSDS2  EQU   DSPAIRS
PHYSTYPE EQU   COMTAB+2002
PHYSFLGS EQU   PHYSTYPE
MERLICEB EQU   PHYSFLGS
CPUASSOC EQU   COMTAB+3026
CPUS     EQU   CPUASSOC+2
CPU      EQU   CPUS
CPUFLAG1 EQU   CPU+6
OPSYSTYP EQU   CPUFLAG1
CPUFLAG2 EQU   CPU+7
LOWERCON EQU   COMTAB+3156
LOWDSS   EQU   LOWERCON
LOWFLGS  EQU   LOWDSS
LOWSPEC  EQU   LOWFLGS
LOWLIB   EQU   LOWDSS+1
LIBCTL   EQU   COMTAB+3284
LIBCTLS  EQU   LIBCTL
CREATE   EQU   COMTAB+3288
@NM00017 EQU   CREATE
COMTAB2  EQU   0
DSTORSG  EQU   COMTAB2
DSENTRY  EQU   DSTORSG
CONFGCON EQU   COMTAB2+32
RSGUCB   EQU   CONFGCON
RSGFLAGS EQU   RSGUCB
CISPEC   EQU   RSGFLAGS
CPUREFNO EQU   RSGUCB+6
RSGCHAN  EQU   RSGUCB+7
RSGCUA   EQU   RSGUCB+8
CONFGUCB EQU   COMTAB2+464
CONFGDEV EQU   CONFGUCB
USEFLAGS EQU   CONFGDEV
USEV     EQU   USEFLAGS
USEVS    EQU   USEFLAGS
USEREAL  EQU   USEFLAGS
INDEXRSG EQU   CONFGDEV+1
ALTPATH1 EQU   CONFGDEV+2
ALTDS1   EQU   ALTPATH1
ALTCI1   EQU   ALTPATH1+1
ALTPATH2 EQU   CONFGDEV+5
ALTDS2   EQU   ALTPATH2
ALTCI2   EQU   ALTPATH2+1
ALTPATH3 EQU   CONFGDEV+8
ALTDS3   EQU   ALTPATH3
ALTCI3   EQU   ALTPATH3+1
BUILDTAB EQU   0
COMB06   EQU   BUILDTAB
B06DCBPT EQU   COMB06
B06BUFPT EQU   COMB06+4
B06ADDR  EQU   COMB06+9
COMB05   EQU   BUILDTAB+12
B05ADDR  EQU   COMB05+9
BUILDGEN EQU   BUILDTAB+24
UT2VCHR  EQU   BUILDGEN+8
OUTADDR  EQU   UT2VCHR+1
UT2VCYL  EQU   OUTADDR
UT2VHEAD EQU   OUTADDR+1
UT2VREC  EQU   OUTADDR+2
UT1VCHR  EQU   BUILDGEN+12
INADDR   EQU   UT1VCHR+1
UT1STUFF EQU   BUILDTAB+40
UT1FLAG  EQU   UT1STUFF+96
UT2STUFF EQU   BUILDTAB+664
UT2DCB   EQU   UT2STUFF
UT2FLAG  EQU   UT2STUFF+96
UT3STUFF EQU   BUILDTAB+1288
UT3FLAG  EQU   UT3STUFF+96
UT2BUFER EQU   BUILDTAB+13532
OUTBUFFR EQU   0
OUTBLOCK EQU   OUTBUFFR
OBLKPRFX EQU   OUTBLOCK+8
OUTABLID EQU   OBLKPRFX
OUTCYL   EQU   OBLKPRFX+1
OUTHEAD  EQU   OBLKPRFX+2
OUTREC   EQU   OBLKPRFX+3
OUTFLR   EQU   OBLKPRFX+4
OBLOCK   EQU   OUTBLOCK+16
SCANBUF  EQU   0
SCANDATA EQU   0
BLK      EQU   BLOCK
BYTES    EQU   BLK
CPUASSN  EQU   BLOCK
FLAG1    EQU   CPUASSN+6
OPSYSBIT EQU   FLAG1
VS1      EQU   OPSYSBIT
VS2      EQU   OPSYSBIT
JES      EQU   OPSYSBIT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00028 EQU   CPUASSN+7
@NM00027 EQU   FLAG1
@NM00026 EQU   FLAG1
@NM00025 EQU   CPUASSN
@NM00024 EQU   OUTBLOCK
TEMPEND  EQU   BUILDTAB+22396
LTRTRANI EQU   BUILDTAB+22316
LTRTRANO EQU   BUILDTAB+22236
UT1BUFER EQU   BUILDTAB+5084
NVERIFY  EQU   BUILDTAB+3500
CVERIFY  EQU   BUILDTAB+1916
@NM00023 EQU   UT3STUFF+624
UT3DDN   EQU   UT3STUFF+616
UT3CCWS  EQU   UT3STUFF+320
UT3IOB   EQU   UT3STUFF+280
UT3ECB   EQU   UT3STUFF+276
UT3JFCB  EQU   UT3STUFF+100
@NM00022 EQU   UT3FLAG
UT3VWERR EQU   UT3FLAG
UT3VOERR EQU   UT3FLAG
UT3VUPDT EQU   UT3FLAG
UT3DCB   EQU   UT3STUFF
UT2DDN   EQU   UT2STUFF+616
UT2CCWS  EQU   UT2STUFF+320
UT2IOB   EQU   UT2STUFF+280
UT2ECB   EQU   UT2STUFF+276
UT2JFCB  EQU   UT2STUFF+100
@NM00021 EQU   UT2FLAG
UT2VCERR EQU   UT2FLAG
UT2VWERR EQU   UT2FLAG
UT2VOERR EQU   UT2FLAG
UT2VUPDT EQU   UT2FLAG
UT1DDN   EQU   UT1STUFF+616
UT1CCWS  EQU   UT1STUFF+320
UT1IOB   EQU   UT1STUFF+280
UT1ECB   EQU   UT1STUFF+276
UT1JFCB  EQU   UT1STUFF+100
@NM00020 EQU   UT1FLAG
UT1VWERR EQU   UT1FLAG
UT1VOERR EQU   UT1FLAG
UT1VUPDT EQU   UT1FLAG
UT1DCB   EQU   UT1STUFF
UT1VREC  EQU   INADDR+2
UT1VHEAD EQU   INADDR+1
UT1VCYL  EQU   INADDR
UT1TABID EQU   UT1VCHR
UT2TABID EQU   UT2VCHR
ADDRBUF2 EQU   BUILDGEN+4
ADDRBUF1 EQU   BUILDGEN
B05REC   EQU   B05ADDR+2
B05HEAD  EQU   B05ADDR+1
B05CYL   EQU   B05ADDR
B05TBLID EQU   COMB05+8
B05BUFPT EQU   COMB05+4
B05DCBPT EQU   COMB05
B06REC   EQU   B06ADDR+2
B06HEAD  EQU   B06ADDR+1
B06CYL   EQU   B06ADDR
B06TBLID EQU   COMB06+8
ALTCH3   EQU   ALTPATH3+2
ALTCH2   EQU   ALTPATH2+2
ALTCH1   EQU   ALTPATH1+2
ICEBERG  EQU   USEFLAGS
ITISALTP EQU   USEFLAGS
USECONVR EQU   USEFLAGS
SUPPUNCH EQU   USEFLAGS
USESPEC  EQU   USEFLAGS
RSGCPUID EQU   RSGUCB+1
@NM00019 EQU   RSGFLAGS
TORSG2   EQU   DSENTRY+1
TORSG1   EQU   DSENTRY
COM2BASE EQU   COMTAB+3304
LRUCLOCK EQU   CREATE+11
VOLSER   EQU   CREATE+5
VPAGES   EQU   CREATE+1
@NM00018 EQU   @NM00017
PRNTONLY EQU   @NM00017
UPDCREAT EQU   @NM00017
NEWCREAT EQU   @NM00017
CMDCREAT EQU   @NM00017
RW67RGHT EQU   LIBCTLS
RW67LEFT EQU   LIBCTLS
RW45RGHT EQU   LIBCTLS
RW45LEFT EQU   LIBCTLS
RW23RGHT EQU   LIBCTLS
RW23LEFT EQU   LIBCTLS
RW01RGHT EQU   LIBCTLS
RW01LEFT EQU   LIBCTLS
@NM00016 EQU   LOWFLGS
LOWRGHT  EQU   LOWFLGS
LOWLEFT  EQU   LOWFLGS
LOWRW67  EQU   LOWFLGS
LOWRW45  EQU   LOWFLGS
LOWRW23  EQU   LOWFLGS
LOWRW01  EQU   LOWFLGS
ALTMSCIN EQU   CPUFLAG2
@NM00015 EQU   CPUFLAG2
ALTMSGBF EQU   CPUFLAG2
@NM00014 EQU   CPUFLAG2
CPUSPEC  EQU   CPUFLAG2
CPUMSCIN EQU   CPUFLAG1
OPJES3   EQU   OPSYSTYP
OPVS2    EQU   OPSYSTYP
OPVS1    EQU   OPSYSTYP
CPUALTFL EQU   CPUFLAG1
CPUTIGHT EQU   CPUFLAG1
@NM00013 EQU   CPUFLAG1
TOMPCPU  EQU   CPU+5
CPUID    EQU   CPU
CPUNUM   EQU   CPUASSOC
SPNRSGNO EQU   PHYSTYPE+1
LGDEVICE EQU   PHYSFLGS
LOGABOX1 EQU   PHYSFLGS
PHYSSSID EQU   PHYSFLGS
PHYSREAL EQU   PHYSFLGS
PHYSICEB EQU   MERLICEB
PHYSMERL EQU   MERLICEB
PABDDD   EQU   PABAADDD
PABAA    EQU   PABAADDD
PABZEROS EQU   PABAADDD
PAB2D    EQU   PABREAL
PAB2C    EQU   PABREAL
PAB2B    EQU   PABREAL
@NM00012 EQU   PABREAL
PAB1D    EQU   PABREAL
PAB1C    EQU   PABREAL
PAB1B    EQU   PABREAL
PABIMPLR EQU   PABREAL
PABBERG2 EQU   PABFLAGS
@NM00011 EQU   PABFLAGS
PABDSMTL EQU   PABFLAGS
PABIBERG EQU   PABFLAGS
@NM00010 EQU   PABFLAGS
PABVOVIR EQU   PABFLAGS
PABEXIST EQU   PABFLAGS
MAPEXIT  EQU   LIB+4
LIBMAP   EQU   LIB+3
LIBSIZE  EQU   LIB+1
@NM00009 EQU   LIBBITS
TODS2    EQU   RSGTODS+1
RSGSLICE EQU   RSG+3
RSGUDEL  EQU   RSG+2
RSGLDEL  EQU   RSG+1
@NM00008 EQU   RSG
RSGABOX0 EQU   RSGABOX
RSGSPEC  EQU   RSG
SVSYSUT3 EQU   SAVEDDS+32
SVSYSUT2 EQU   SAVEDDS+24
SVSYSUT1 EQU   SAVEDDS+16
SVSYSPCH EQU   SAVEDDS+8
SVSYSIN  EQU   SAVEDDS
PARMPTR  EQU   INVOKED
SAVE14   EQU   GENIO+12
EXLST    EQU   GENIO+8
@NM00007 EQU   DCBPTR+1
DCBFLAG  EQU   DCBPTR
OPENLIST EQU   GENIO
@NM00006 EQU   MESSAGES+19
PRNTBUF2 EQU   SPECLMSG
NEEDEOJ  EQU   SPECLMSG
ENDPHASE EQU   SPECLMSG
@NM00005 EQU   SPECLMSG
PRNTCARD EQU   SPECLMSG
@NM00004 EQU   SPECLMSG
NEED102  EQU   SPECLMSG
NEED101  EQU   SPECLMSG
PRINTRC  EQU   MESSAGES+16
TERM     EQU   MESSAGES+12
WARN     EQU   MESSAGES+8
TERMINAT EQU   MESSAGES+6
WARNING  EQU   MESSAGES+4
MSGNO    EQU   MESSAGES+2
RETCODE  EQU   MESSAGES
OUTBUF2  EQU   PRINTER+225
OUTBUF   EQU   PRINTER+104
LINECT   EQU   PRINTER+102
LINECTR  EQU   PRINTER+100
PAGENO   EQU   PRINTER+96
DCBPRINT EQU   PRINTER
@NM00003 EQU   READER+206
SCANLEN  EQU   READER+204
SVEODAD  EQU   READER+200
SVSYNAD2 EQU   READER+196
SAVENCOL EQU   READER+192
SAVESCOL EQU   READER+188
INBUF    EQU   READER+100
SSELECT  EQU   PCHBF
@NM00002 EQU   READER+97
@NM00001 EQU   READFLAG
LASTPARM EQU   READFLAG
ENDSCAN  EQU   READFLAG
PARMBIT  EQU   READFLAG
KEYBIT   EQU   READFLAG
READTERM EQU   READFLAG
READDCB  EQU   READER
PATCH    EQU   COMTAB
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00224 EQU   @RC00222
@RF00238 EQU   @RC00222
@RF00222 EQU   @EL00009
@RC00245 EQU   @RC00243
@RF00259 EQU   @RC00243
@RF00243 EQU   @EL00009
@RF00264 EQU   @EL00009
@RC00266 EQU   @EL00009
@RF00280 EQU   @EL00009
@RF00230 EQU   @RC00224
@RF00251 EQU   @RC00245
@RF00272 EQU   @RC00266
@ENDDATA EQU   *
         END   ICGDSB08,(C'PLS0822',0603,76339)

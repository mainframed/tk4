         TITLE '**************** IDCLM01: LISTMSF FSR **************** *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCLM01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCLM01   76.301'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @08,0                                               0002
@PSTART  LA    @09,4095(,@08)                                      0002
         LA    @10,4095(,@09)                                      0002
         LA    @12,4095(,@10)                                      0002
         USING @PSTART,@08                                         0002
         USING @PSTART+4095,@09                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0331
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE FOR THE LISTMSF FSR ROUTINE. IT OPENS*/
*   /* THE OUTPUT DATA SET IF REQUESTED, AND CALLS SUBPROCEDURES THAT*/
*   /* PRODUCE THE REPORTS AND SUMMARIES. OPENWORK OPENS THE WORK    */
*   /* DATA SET. MSFLOOK COPIES THE MSC TABLES AND MAKES SURE THAT   */
*   /* THE REQUESTED MSF EXISTS. RPTSEL PRINTS THE REPORTS. THIS     */
*   /* ROUTINE CLOSES THE OUTPUT DATA SET AND WORK DATA SET AND      */
*   /* PRINTS THE FINAL COMPLETION MESSAGE BEFORE RETURNING TO THE   */
*   /* AMS EXECUTIVE                                         @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   IF GDTDBG=NULLPTR THEN                                         0331
         L     @04,@PC00001                                        0331
         L     @04,GDTDBG(,@04)                                    0331
         LTR   @04,@04                                             0331
         BZ    @RT00331                                            0331
*     ;                                                            0332
*   ELSE                                                           0333
*     CALL IDCDB010(GDTTBL,'LMAA'); /*                       @Y30LB38*/
         L     @04,@PC00001                                        0333
         ST    @04,@AL00001                                        0333
         LA    @15,@CC01496                                        0333
         ST    @15,@AL00001+4                                      0333
         MVI   @AL00001+4,X'80'                                    0333
         L     @15,GDTDBG(,@04)                                    0333
         LA    @01,@AL00001                                        0333
         BALR  @14,@15                                             0333
*   OLDERID2=NEWERID2;                                             0334
@RT00331 L     @02,@PC00001                                        0334
         L     @15,GDTTR2(,@02)                                    0334
         MVC   @TS00001(95),NEWERID2(@15)                          0334
         MVC   OLDERID2(95,@15),@TS00001                           0334
*   NEWID2='LMAA';                  /*                       @Y30LB38*/
*                                                                  0335
         MVC   NEWID2(4,@15),@CC01496                              0335
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PARAMETER LIST AND POINTERS                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*   RESPECIFY                                                      0336
*     CKAGL BASED(CKPTR);           /*                       @Y30LB38*/
*   DDSTRU=ADDR(PRINTAB);           /*                       @Y30LB38*/
         LA    @15,PRINTAB                                         0337
         ST    @15,DDSTRU                                          0337
*   BUFFCNTR=''B;                   /*                       @Y30LB38*/
         SLR   @15,@15                                             0338
         LR    BUFFCNTR,@15                                        0338
*   ENTCNTR=''B;                    /*                       @Y30LB38*/
         ST    @15,ENTCNTR                                         0339
*   LINCNTR=''B;                    /*                       @Y30LB38*/
         ST    @15,LINCNTR                                         0340
*   FLAGS=''B;                      /*                       @Y30LB38*/
         MVI   FLAGS,X'00'                                         0341
*   PRINTAB=''B;                    /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0342
*   INTTBL=''B;                     /*                       @Y30LB38*/
         XC    INTTBL(159),INTTBL                                  0343
*   OPNPTR=ADDR(OPENLIST);          /*                       @Y30LB38*/
         LA    OPNPTR,OPENLIST                                     0344
*   OPNAGL=''B;                     /*                       @Y30LB38*/
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0345
*   PRINTME=''B;                    /*                       @Y30LB38*/
         ST    @15,PRINTME                                         0346
*   IOCSPTR=''B;                    /*                       @Y30LB38*/
         ST    @15,IOCSPTR                                         0347
*   WORKPTR=''B;                    /*                       @Y30LB38*/
         ST    @15,WORKPTR                                         0348
*   EXOPTR=ADDR(EXOLIST);           /*                       @Y30LB38*/
         LA    EXOPTR,EXOLIST                                      0349
*   RESPECIFY                                                      0350
*     EXOARG BASED(EXOPTR);         /*                       @Y30LB38*/
*   EXOARG=''B;                     /*                       @Y30LB38*/
         XC    EXOARG(34,EXOPTR),EXOARG(EXOPTR)                    0351
*   ALLOCPTR=ADDR(ALOCLIST);        /*                       @Y30LB38*/
         LA    @15,ALOCLIST                                        0352
         ST    @15,ALLOCPTR                                        0352
*   RESPECIFY                                                      0353
*     ALLAGL BASED(ALLOCPTR);       /*                       @Y30LB38*/
*   ALLAGL=''B;                     /*                       @Y30LB38*/
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0354
*   CKPTR=ADDR(UCBLIST);            /*                       @Y30LB38*/
         LA    @15,UCBLIST                                         0355
         ST    @15,CKPTR                                           0355
*   CKAGL=''B;                      /*                       @Y30LB38*/
         XC    CKAGL(29,@15),CKAGL(@15)                            0356
*   ACQPTR=ADDR(ACQLISTT);          /*                       @Y30LB38*/
         LA    @15,ACQLISTT                                        0357
         ST    @15,ACQPTR                                          0357
*   ACQLIST=''B;                    /*                       @Y30LB38*/
         XC    ACQLIST(96,@15),ACQLIST(@15)                        0358
*   COTPTR=ADDR(COTLISTT);          /*                       @Y30LB38*/
         LA    @15,COTLISTT                                        0359
         ST    @15,COTPTR                                          0359
*   COTBLIST=''B;                   /*                       @Y30LB38*/
         XC    COTBLIST(24,@15),COTBLIST(@15)                      0360
*   RESPECIFY                                                      0361
*     EXGARG BASED(EXGPTR);         /*                       @Y30LB38*/
*   EXGPTR=ADDR(EXGARG1);           /*                       @Y30LB38*/
         LA    @15,EXGARG1                                         0362
         ST    @15,EXGPTR                                          0362
*   EXGARG=''B;                     /*                       @Y30LB38*/
*                                                                  0363
         XC    EXGARG(32,@15),EXGARG(@15)                          0363
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UGSPACE TO GET 16K OF CORE TO BE USED AS    @Y30LB38*/
*   /* WORK AREAS. 3800 WILL BE USED FOR SORTBLK, 3800 BYTES WILL BE */
*   /* USED FOR PRINTBUF AND THE REMAINDER WILL BE USED FOR TRKBUFF. */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   CORESIZE=LENGTH(SORTBLK)+PRINTLEN+LENGTH(TRKBUFF);/*     @ZM00727*/
         MVC   CORESIZE(4),@CF01820                                0364
*   CALL IDCSAGS0(GDTTBL,CORESIZE,RTNAREA);/*                @Y30LB38*/
         ST    @02,@AL00001                                        0365
         LA    @15,CORESIZE                                        0365
         ST    @15,@AL00001+4                                      0365
         LA    @15,RTNAREA                                         0365
         ST    @15,@AL00001+8                                      0365
         MVI   @AL00001+8,X'80'                                    0365
         L     @15,GDTGSP(,@02)                                    0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*   RESPECIFY                                                      0366
*     RTNREG RSTD;                                                 0366
*   TESTRC=RTNREG;                                                 0367
         LR    TESTRC,RTNREG                                       0367
*   RESPECIFY                                                      0368
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*   IF TESTRC^=0 THEN                                              0369
         LTR   TESTRC,TESTRC                                       0369
         BZ    @RF00369                                            0369
*     LASTCOND=LASTCC12;            /*                       @ZM00717*/
*                                                                  0370
         L     @15,@PC00001+8                                      0370
         MVC   LASTCOND(2,@15),@CH00567                            0370
*   /*****************************************************************/
*   /*                                                               */
*   /* IF STORAGE WAS NOT OBTAINED SUCCESSFULLY, SET         @ZM00717*/
*   /* LASTCOND TO 12 - IF SUCCESSFUL, SET POINTERS TO THE   @ZM00717*/
*   /* STORAGE AREAS.                                        @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0371
*   ELSE                                                           0371
*     DO;                           /*                       @ZM00717*/
         B     @RC00369                                            0371
@RF00369 DS    0H                                                  0372
*       GOTCORE=ON;                 /*                       @Y30LB38*/
         OI    GOTCORE,B'01000000'                                 0372
*       SORTPTR=RTNAREA;            /*                       @Y30LB38*/
         L     @15,RTNAREA                                         0373
         ST    @15,SORTPTR                                         0373
*       PRINTPTR=RTNAREA+LENGTH(SORTBLK);/*                  @ZM00717*/
         LA    PRINTPTR,3800                                       0374
         ALR   PRINTPTR,@15                                        0374
*       TRKPTR=RTNAREA+LENGTH(SORTBLK)+PRINTLEN;/*           @ZM00717*/
         AL    @15,@CF01818                                        0375
         ST    @15,TRKPTR                                          0375
*     END;                          /*                       @Y30LB38*/
*                                                                  0377
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE USER SPECIFIED A DDNAME OR DSNAME TO      @Y30LB38*/
*   /* BE USED AS THE OUTPUT DATA SET. IF YES, ISSUE THE UOPEN MACRO.*/
*   /* IF NO, USE SYSPRINT AS DEFAULT                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   IF LASTCOND=LASTCC00&(ADDR(OFILE)^=NULLPTR×ADDR(ODS)^=NULLPTR) THEN
@RC00369 SLR   @15,@15                                             0377
         L     @14,@PC00001+8                                      0377
         CH    @15,LASTCOND(,@14)                                  0377
         BNE   @RF00377                                            0377
         L     @14,@PC00001+4                                      0377
         C     @15,FDTPTR+32(,@14)                                 0377
         BNE   @RT00377                                            0377
         C     @15,FDTPTR+36(,@14)                                 0377
         BE    @RF00377                                            0377
@RT00377 DS    0H                                                  0378
*     DO;                           /*                       @Y30LB38*/
*       IF ADDR(ODS)^=NULLPTR THEN                                 0379
         L     @15,@PC00001+4                                      0379
         L     @15,FDTPTR+36(,@15)                                 0379
         LTR   @15,@15                                             0379
         BZ    @RF00379                                            0379
*         OPNDSN=ADDR(ODSVAL);      /*                       @Y30LB38*/
         LA    @15,ODSVAL(,@15)                                    0380
         ST    @15,OPNDSN(,OPNPTR)                                 0380
*       ELSE                                                       0381
*         OPNDDN=ADDR(OFILEVAL);    /*                       @Y30LB38*/
         B     @RC00379                                            0381
@RF00379 L     @15,@PC00001+4                                      0381
         L     @01,FDTPTR+32(,@15)                                 0381
         LA    @15,OFILEVAL(,@01)                                  0381
         ST    @15,OPNDDN(,OPNPTR)                                 0381
*       OPNOPTOT=ON;                /*                       @Y30LB38*/
@RC00379 OI    OPNOPTOT(OPNPTR),B'01000000'                        0382
*       OPNMODAC=ON;                /*                       @Y30LB38*/
         OI    OPNMODAC(OPNPTR),B'01000000'                        0383
*       OPNIOC=ADDR(IOCSPTR);       /*                       @Y30LB38*/
         LA    @02,IOCSPTR                                         0384
         ST    @02,OPNIOC(,OPNPTR)                                 0384
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/*                      @Y30LB38*/
         L     @02,@PC00001                                        0385
         ST    @02,@AL00001                                        0385
         ST    OPNPTR,@AL00001+4                                   0385
         MVI   @AL00001+4,X'80'                                    0385
         L     @15,GDTOPN(,@02)                                    0385
         LA    @01,@AL00001                                        0385
         BALR  @14,@15                                             0385
*       RESPECIFY                                                  0386
*         RTNREG RSTD;                                             0386
*       TESTRC=RTNREG;                                             0387
         LR    TESTRC,RTNREG                                       0387
*       RESPECIFY                                                  0388
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC=0 THEN                                           0389
         LTR   TESTRC,TESTRC                                       0389
         BNZ   @RF00389                                            0389
*         PRINTME=IOCSPTR;          /*                       @Y30LB38*/
         L     @06,IOCSPTR                                         0390
         ST    @06,PRINTME                                         0390
*       ELSE                                                       0391
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/
         B     @RC00389                                            0391
@RF00389 L     @06,@PC00001+8                                      0391
         MVC   LASTCOND(2,@06),@CH00567                            0391
*     END;                          /*                       @Y30LB38*/
@RC00389 DS    0H                                                  0393
*                                                                  0393
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LASTCOND = 0 CALL OPENWORK TO OPEN THE WORK        @Y30LB38*/
*   /* DATA SET                                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*   IF LASTCOND=LASTCC00 THEN                                      0393
@RF00377 L     @06,@PC00001+8                                      0393
         LH    @06,LASTCOND(,@06)                                  0393
         LTR   @06,@06                                             0393
         BNZ   @RF00393                                            0393
*     DO;                           /*                       @Y30LB38*/
*       CALL OPENWORK;              /*                       @Y30LB38*/
         BAL   @14,OPENWORK                                        0395
*       RESPECIFY                                                  0396
*         RTNREG RSTD;                                             0396
*       TESTRC=RTNREG;                                             0397
         LR    TESTRC,RTNREG                                       0397
*       RESPECIFY                                                  0398
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC=LASTCC12 THEN                                    0399
         LA    @02,12                                              0399
         CR    TESTRC,@02                                          0399
         BNE   @RF00399                                            0399
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/
         L     @03,@PC00001+8                                      0400
         STH   @02,LASTCOND(,@03)                                  0400
*     END;                          /*                       @Y30LB38*/
@RF00399 DS    0H                                                  0402
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SUCCESSFUL, CALL MSFLOOK TO COPY THE MSC TABLES    @ZM00717*/
*   /* AND CHECK THE REQUESTED MSF.                          @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   IF LASTCOND=LASTCC00 THEN                                      0402
@RF00393 L     @15,@PC00001+8                                      0402
         LH    @15,LASTCOND(,@15)                                  0402
         LTR   @15,@15                                             0402
         BNZ   @RF00402                                            0402
*     DO;                           /*                       @Y30LB38*/
*       CALL MSFLOOK;               /*                       @Y30LB38*/
         BAL   @14,MSFLOOK                                         0404
*       RESPECIFY                                                  0405
*         RTNREG RSTD;                                             0405
*       TESTRC=RTNREG;                                             0406
         LR    TESTRC,RTNREG                                       0406
*       RESPECIFY                                                  0407
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC=LASTCC12 THEN                                    0408
         LA    @02,12                                              0408
         CR    TESTRC,@02                                          0408
         BNE   @RF00408                                            0408
*         LASTCOND=LASTCC12;        /*                       @Y30LB38*/
         L     @03,@PC00001+8                                      0409
         STH   @02,LASTCOND(,@03)                                  0409
*     END;                          /*                       @Y30LB38*/
@RF00408 DS    0H                                                  0411
*                                                                  0411
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SUCCESSFUL, CALL RPTSEL TO PRODUCE THE REPORTS     @ZM00717*/
*   /* AND SUMARIES.                                         @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*   IF LASTCOND=LASTCC00 THEN                                      0411
@RF00402 L     @15,@PC00001+8                                      0411
         LH    @15,LASTCOND(,@15)                                  0411
         LTR   @15,@15                                             0411
         BNZ   @RF00411                                            0411
*     DO;                           /*                       @Y30LB38*/
*       CALL RPTSEL;                /*                       @Y30LB38*/
         BAL   @14,RPTSEL                                          0413
*       RESPECIFY                                                  0414
*         RTNREG RSTD;                                             0414
*       TESTRC=RTNREG;                                             0415
         LR    TESTRC,RTNREG                                       0415
*       RESPECIFY                                                  0416
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       LASTCOND=TESTRC;            /*                       @Y30LB38*/
         L     @02,@PC00001+8                                      0417
         STH   TESTRC,LASTCOND(,@02)                               0417
*     END;                          /*                       @Y30LB38*/
*                                                                  0419
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ACQSW = ON ISSUE THE USSC MACRO WITH THE           @ZA14727*/
*   /* RELINQ OPTION TO RELINQUISH THE DATA SET SPACE SPECIFY THE    */
*   /* UNBIND OPTION.                                        @ZA14727*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*   IF ACQSW=ON THEN                                               0419
@RF00411 TM    ACQSW,B'00010000'                                   0419
         BNO   @RF00419                                            0419
*     DO;                           /*                       @ZA14727*/
*       ACQLIST=ACQLIST&&ACQLIST;   /*                       @ZA14727*/
         L     @02,ACQPTR                                          0421
         XC    ACQLIST(96,@02),ACQLIST(@02)                        0421
*       ARLL=LENGTH(ACQLIST);       /*                       @ZA14727*/
         MVC   ARLL(4,@02),@CF01822                                0422
*       AROP=RELOPCOD;              /*                       @ZA14727*/
         MVI   AROP(@02),X'04'                                     0423
*       ARBDUBD=ON;                 /*                       @ZA14727*/
         OI    ARBDUBD(@02),B'10000000'                            0424
*       ARNMEXT=ONE;                /*                       @ZA14727*/
         MVI   ARNMEXT(@02),X'01'                                  0425
*       ARVOL=VOLAREA(ONE);         /*                       @ZA14727*/
         MVC   ARVOL(6,@02),VOLAREA                                0426
*       AREXT(1,1:2)=SCYL;          /*                       @ZA14727*/
         MVC   AREXT(2,@02),SCYL                                   0427
*       AREXT(1,3:4)=ECYL;          /*                       @ZA14727*/
         MVC   AREXT+2(2,@02),ECYL                                 0428
*       CALL IDCSASS0(GDTTBL,RELINQ,ACQPTR,REASONCD);/*      @ZA14727*/
         L     @02,@PC00001                                        0429
         ST    @02,@AL00001                                        0429
         LA    @15,RELINQ                                          0429
         ST    @15,@AL00001+4                                      0429
         LA    @15,ACQPTR                                          0429
         ST    @15,@AL00001+8                                      0429
         LA    @15,REASONCD                                        0429
         ST    @15,@AL00001+12                                     0429
         MVI   @AL00001+12,X'80'                                   0429
         L     @15,GDTSSC(,@02)                                    0429
         LA    @01,@AL00001                                        0429
         BALR  @14,@15                                             0429
*       RESPECIFY                                                  0430
*         RTNREG RSTD;                                             0430
*       TESTRC=RTNREG;                                             0431
         LR    TESTRC,RTNREG                                       0431
*       RESPECIFY                                                  0432
*         RTNREG UNRSTD;            /*                       @ZA14727*/
*       IF TESTRC^=0 THEN                                          0433
         LTR   TESTRC,TESTRC                                       0433
         BZ    @RF00433                                            0433
*         DO;                       /*                       @ZA14727*/
*                                                                  0434
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @ZA14727*/
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */
*           /*                                               @ZA14727*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0435
*           CALL SSCMSG(REASONCD);  /*                       @ZA14727*/
         LA    @15,REASONCD                                        0435
         ST    @15,@AL00001                                        0435
         LA    @01,@AL00001                                        0435
         BAL   @14,SSCMSG                                          0435
*           LASTCOND=LASTCC04;      /*                       @ZA14727*/
         L     @15,@PC00001+8                                      0436
         MVC   LASTCOND(2,@15),@CH00043                            0436
*         END;                      /*                       @ZA14727*/
*       ELSE                        /*                       @ZA14727*/
*         ACQSW=OFF;                /*                       @ZA14727*/
         B     @RC00433                                            0438
@RF00433 NI    ACQSW,B'11101111'                                   0438
*     END;                          /*                       @ZA14727*/
*                                                                  0439
@RC00433 DS    0H                                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WORKPTR IS ^= 0 THEN THE WORK DATA SET WAS OPENED  #Y30LB38*/
*   /* AND MUST BE CLOSED VIA UEXCP.                         @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0440
*   IF WORKPTR^=NULLPTR THEN                                       0440
@RF00419 L     @15,WORKPTR                                         0440
         LTR   @15,@15                                             0440
         BZ    @RF00440                                            0440
*     DO;                           /*                       @Y30LB38*/
*       CALL IDCIO050(GDTTBL,CLOSE,WORKPTR);/*               @Y30LB38*/
         L     @02,@PC00001                                        0442
         ST    @02,@AL00001                                        0442
         LA    @15,CLOSE                                           0442
         ST    @15,@AL00001+4                                      0442
         LA    @15,WORKPTR                                         0442
         ST    @15,@AL00001+8                                      0442
         MVI   @AL00001+8,X'80'                                    0442
         L     @15,GDTEXP(,@02)                                    0442
         LA    @01,@AL00001                                        0442
         BALR  @14,@15                                             0442
*       RESPECIFY                                                  0443
*         RTNREG RSTD;                                             0443
*       TESTRC=RTNREG;                                             0444
         LR    TESTRC,RTNREG                                       0444
*       RESPECIFY                                                  0445
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0446
         LTR   TESTRC,TESTRC                                       0446
         BZ    @RF00446                                            0446
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB38*/
         L     @15,@PC00001+8                                      0447
         LH    @14,LASTCOND(,@15)                                  0447
         LA    @07,4                                               0447
         CR    @14,@07                                             0447
         BNL   *+6
         LR    @14,@07                                             0447
         STH   @14,LASTCOND(,@15)                                  0447
*     END;                          /*                       @Y30LB38*/
@RF00446 DS    0H                                                  0449
*                                                                  0449
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE WDS PARAMETER WAS SPECIFIED AND A DDNAME       @ZM00717*/
*   /* IS PRESENT FROM THE UALLOC MACRO THEN THE UDEALLOC MACRO WILL */
*   /* BE ISSUED TO DE-ALLOCATE THE DATA SET.                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0449
*   IF ADDR(WDS)^=NULLPTR&ALLDDN^=LMZERO THEN                      0449
@RF00440 L     @15,@PC00001+4                                      0449
         L     @15,FDTPTR+4(,@15)                                  0449
         LTR   @15,@15                                             0449
         BZ    @RF00449                                            0449
         L     @15,ALLOCPTR                                        0449
         CLC   ALLDDN(8,@15),LMZERO                                0449
         BE    @RF00449                                            0449
*     DO;                           /*                       @Y30LB38*/
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Y30LB38*/
         L     @02,@PC00001                                        0451
         ST    @02,@AL00001                                        0451
         ST    @15,@AL00001+4                                      0451
         MVI   @AL00001+4,X'80'                                    0451
         L     @15,GDTDLC(,@02)                                    0451
         LA    @01,@AL00001                                        0451
         BALR  @14,@15                                             0451
*       RESPECIFY                                                  0452
*         RTNREG RSTD;                                             0452
*       TESTRC=RTNREG;                                             0453
         LR    TESTRC,RTNREG                                       0453
*       RESPECIFY                                                  0454
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0455
         LTR   TESTRC,TESTRC                                       0455
         BZ    @RF00455                                            0455
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB38*/
         L     @15,@PC00001+8                                      0456
         LH    @14,LASTCOND(,@15)                                  0456
         LA    @07,4                                               0456
         CR    @14,@07                                             0456
         BNL   *+6
         LR    @14,@07                                             0456
         STH   @14,LASTCOND(,@15)                                  0456
*     END;                          /*                       @Y30LB38*/
*                                                                  0457
@RF00455 DS    0H                                                  0458
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST GOTCORE SWITCH AND IF ON, INDICATING WORK CORE   @Y30LB38*/
*   /* WAS OBTAINED, FREE THE 16K OF CORE. THE ADDRESS OF THE START  */
*   /* OF THE WORK CORE WILL BE IN SORTPTR.                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0458
*   IF GOTCORE=ON THEN                                             0458
@RF00449 TM    GOTCORE,B'01000000'                                 0458
         BNO   @RF00458                                            0458
*     DO;                           /*                       @ZM00717*/
*       CALL IDCSAFS0(GDTTBL,SORTPTR);/*                     @Y30LB38*/
         L     @15,@PC00001                                        0460
         ST    @15,@AL00001                                        0460
         LA    @14,SORTPTR                                         0460
         ST    @14,@AL00001+4                                      0460
         L     @15,GDTFSP(,@15)                                    0460
         LA    @01,@AL00001                                        0460
         BALR  @14,@15                                             0460
*                                                                  0461
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD PARAMETER LIST FOR UPRINT MACRO. IF THE     @Y30LB38*/
*       /* CONDITION CODE IS = 12 THEN MESSAGE IDC3003I IS PRINTED.  */
*       /* OTHERWISE, MESSAGE IDC0001I IS PRINTED.           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0461
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0461
*       DARGSMOD=UNIVMSG;           /*                       @Y30LB38*/
         L     @15,DDSTRU                                          0462
         MVC   DARGSMOD(3,@15),@CC01481                            0462
*       DARGDBP=ADDR(LASTCOND);     /*                       @Y30LB38*/
         L     @14,@PC00001+8                                      0463
         ST    @14,DARGDBP(,@15)                                   0463
*       DARGILP=LENGTH(LASTCOND);   /*                       @Y30LB38*/
         MVC   DARGILP(2,@15),@CH00154                             0464
*       IF LASTCOND=LASTCC12 THEN   /*                       @Y30LB38*/
         CLC   LASTCOND(2,@14),@CH00567                            0465
         BNE   @RF00465                                            0465
*         DARGSENT=MSG3003I;        /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'03'                                 0466
*       ELSE                        /*                       @Y30LB38*/
*         DARGSENT=MSG0001I;        /*                       @Y30LB38*/
         B     @RC00465                                            0467
@RF00465 L     @01,DDSTRU                                          0467
         MVI   DARGSENT(@01),X'01'                                 0467
*     END;                          /*                       @ZM00717*/
*                                                                  0468
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GOTCORE SWITCH IS OFF, INDICATING FUNCTION ENDED   @ZM00717*/
*   /* BECAUSE OF INSUFFICIENT STORAGE, ISSUE MESSAGE        @ZM00717*/
*   /* IDC3004I WITHOUT ANY INSERTS                          @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   ELSE                                                           0469
*     DO;                           /*                       @ZM00717*/
         B     @RC00458                                            0469
@RF00458 DS    0H                                                  0470
*       PRINTAB=''B;                /*                       @ZM00717*/
         XC    PRINTAB(84),PRINTAB                                 0470
*       DARGSMOD=UNIVMSG;           /*                       @ZM00717*/
         L     @15,DDSTRU                                          0471
         MVC   DARGSMOD(3,@15),@CC01481                            0471
*       DARGSENT=MSG3004I;          /*                       @ZM00717*/
         MVI   DARGSENT(@15),X'04'                                 0472
*     END;                          /*                       @ZM00717*/
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/
@RC00458 L     @15,@PC00001                                        0474
         ST    @15,@AL00001                                        0474
         LA    @14,@CF00116                                        0474
         ST    @14,@AL00001+4                                      0474
         LA    @14,DDSTRU                                          0474
         ST    @14,@AL00001+8                                      0474
         MVI   @AL00001+8,X'80'                                    0474
         L     @15,GDTPRT(,@15)                                    0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*                                                                  0475
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PRINTME IS ^= 0 THEN THE OUTPUT DATA SET WAS       @ZM00727*/
*   /* OPENED AND MUST BE CLOSED.                            @ZM00727*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0475
*   IF PRINTME^=NULLPTR THEN                                       0475
         L     @15,PRINTME                                         0475
         LTR   @15,@15                                             0475
         BZ    @RF00475                                            0475
*     DO;                           /*                       @ZM00727*/
*       CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                     @ZM00727*/
         L     @02,@PC00001                                        0477
         ST    @02,@AL00001                                        0477
         LA    @15,IOCSPTR                                         0477
         ST    @15,@AL00001+4                                      0477
         MVI   @AL00001+4,X'80'                                    0477
         L     @15,GDTCLS(,@02)                                    0477
         LA    @01,@AL00001                                        0477
         BALR  @14,@15                                             0477
*       RESPECIFY                                                  0478
*         RTNREG RSTD;                                             0478
*       TESTRC=RTNREG;                                             0479
         LR    TESTRC,RTNREG                                       0479
*       RESPECIFY                                                  0480
*         RTNREG UNRSTD;            /*                       @ZM00727*/
*       IF TESTRC^=0 THEN                                          0481
         LTR   TESTRC,TESTRC                                       0481
         BZ    @RF00481                                            0481
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @ZM00727*/
         L     @15,@PC00001+8                                      0482
         LH    @14,LASTCOND(,@15)                                  0482
         LA    @07,4                                               0482
         CR    @14,@07                                             0482
         BNL   *+6
         LR    @14,@07                                             0482
         STH   @14,LASTCOND(,@15)                                  0482
*     END;                          /*                       @ZM00727*/
@RF00481 DS    0H                                                  0484
*                                                                  0484
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR A FULL REGION DUMP AND RETURN TO AMS       #Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   IF GDTDBG=NULLPTR THEN                                         0484
@RF00475 L     @15,@PC00001                                        0484
         L     @15,GDTDBG(,@15)                                    0484
         LTR   @15,@15                                             0484
         BZ    @RT00484                                            0484
*     ;                                                            0485
*   ELSE                                                           0486
*     CALL IDCDB010(GDTTBL,'LMAZ'); /*                       #Y30LB38*/
         L     @15,@PC00001                                        0486
         ST    @15,@AL00001                                        0486
         LA    @14,@CC01507                                        0486
         ST    @14,@AL00001+4                                      0486
         MVI   @AL00001+4,X'80'                                    0486
         L     @15,GDTDBG(,@15)                                    0486
         LA    @01,@AL00001                                        0486
         BALR  @14,@15                                             0486
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0487
*                                                                  0487
@RT00484 L     @15,@PC00001                                        0487
         ST    @15,@AL00001                                        0487
         LA    @14,MODID                                           0487
         ST    @14,@AL00001+4                                      0487
         L     @14,@PC00001+8                                      0487
         ST    @14,@AL00001+8                                      0487
         MVI   @AL00001+8,X'80'                                    0487
         L     @15,GDTEPL(,@15)                                    0487
         LA    @01,@AL00001                                        0487
         BALR  @14,@15                                             0487
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*                                                                  0488
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - OPENWORK                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE OPENS THE WORK DATA SET      @Y30LB38*/
*/*                AND BINDS ITS SPACE AFTER MAKING SURE     @Y30LB38*/
*/*                THAT IT IS A VIRTUAL VOLUME.              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - FUNCTION DEFINITION TABLE                    @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - INTTBL INITIALIZED WITH THE WORK VOLUME     @Y30LB38*/
*/*                SERIAL NUMBER AND WITH THE START AND      @Y30LB38*/
*/*                END CYLINDER ADDRESSES AND A RETURN CODE  @Y30LB38*/
*/*                0 = SUCCESSFUL COMPLETION                 @Y30LB38*/
*/*                12 = UNSUCCESSFUL COMPLETION              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0488
*OPENWORK:                                                         0488
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0488
@EL00001 L     @13,4(,@13)                                         0488
@EF00001 L     @00,@SIZDATD                                        0488
         LR    @01,@11                                             0488
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0488
         BR    @14                                                 0488
OPENWORK DS    0H                                                  0489
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0489
*   DCL                                                            0489
*     OPENCODE FIXED(15);           /* OPENWORK RET CODE     @Y30LB38*/
*   DCL                                                            0490
*     IOINFO CHAR(LENGTH(IOINFOPT));/* UIOINFO FLAGS         @Y30LB38*/
*   DCL                                                            0491
*     VOLSRPTR PTR(31);             /* PTR TO VOLSER'S       @Y30LB38
*                                      FROM UIONFO MACRO     @Y30LB38*/
*                                                                  0491
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE WORK AREA STRUCTURE FOR RETURN OF VOLUME      @Y30LB38*/
*   /* SERIAL NUMBERS FROM UIOINFO MACRO                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*   DCL                                                            0492
*     1 INFOAREA BDY(WORD),                                        0492
*      2 WORKLEN FIXED(15),         /* WORK AREA LENGTH      @ZM00727*/
*      2 RETNLEN FIXED(15),         /* DATA RETURNED LEN     @ZM00727*/
*      2 TYPE FIXED(15),            /* DATA TYPE             @Y30LB38*/
*      2 DATALEN FIXED(15),         /* DATA LENGTH           @Y30LB38*/
*      2 VOLAREA(5) CHAR(6);        /* VOLUME SER NUMBERS    @Y30LB38*/
*                                                                  0492
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE UNIT LIST FOR UALLOC MACRO                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*   DCL                                                            0493
*     1 UNITLIST,                   /*                       @Y30LB38*/
*       3 COUNT FIXED(15),          /* COUNT FIELD           @Y30LB38*/
*       3 DEVLEN FIXED(15),         /*                       @Y30LB38*/
*       3 DEVTYPE CHAR(8);          /*                       @Y30LB38*/
*   DCL                                                            0494
*     UNITCON CHAR(5) CONSTANT('SDG00');/*                   @Y30LB38*/
*   DCL                                                            0495
*     ACQOPCOD FIXED(8) CONSTANT(2);/* ACQUIRE OP CODE       @ZM00717*/
*   DCL                                                            0496
*     DDNAME CHAR(8);               /* DDNAME WORK AREA      @Y30LB38*/
*   DCL                                                            0497
*     UCBPTR PTR(31);               /* UCB PTR               @Y30LB38*/
*                                                                  0498
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0498
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR1                                      0498
*   OLDERID2=NEWERID2;                                             0499
         L     @15,@PC00001                                        0499
         L     @14,GDTTR2(,@15)                                    0499
         MVC   @TS00001(95),NEWERID2(@14)                          0499
         MVC   OLDERID2(95,@14),@TS00001                           0499
*   NEWID2='LMBA';                  /*                       @Y30LB38*/
*                                                                  0500
         MVC   NEWID2(4,@14),@CC01528                              0500
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE POINTERS TO ARGUMENT LISTS AND AREAS       @ZM00717*/
*   /* TO ZERO.                                              @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   OPENCODE=''B;                   /*                       @Y30LB38*/
         SLR   @14,@14                                             0501
         LR    OPENCODE,@14                                        0501
*   VOLSRPTR=ADDR(INFOAREA);        /*                       @Y30LB38*/
         LA    @03,INFOAREA                                        0502
         ST    @03,VOLSRPTR                                        0502
*   WORKLEN=LENGTH(INFOAREA);       /*                       @Y30LB38*/
         MVC   WORKLEN(2),@CH01823                                 0503
*   UCBPTR=''B;                     /*                       @Y30LB38*/
         ST    @14,UCBPTR                                          0504
*   RESPECIFY                                                      0505
*     IOINFOPT BASED(ADDR(IOINFO)); /*                       @Y30LB38*/
*   IOINFOPT=''B;                   /*                       @Y30LB38*/
*                                                                  0506
         LA    @14,IOINFO                                          0506
         MVI   IOINFOPT(@14),X'00'                                 0506
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO SEE IF THE WDS PARAMETER IS SPECIFIED.       @Y30LB38*/
*   /* THIS PARM INDICATES THAT A DSN WAS GIVEN AND THE UALLOC MACRO */
*   /* IS ISSUED TO OBTAIN A DDNAME FOR THE DSNAME. IF NOT SPECIFIED,*/
*   /* USE THE DDNAME FROM THE WFILE PARM.                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0507
*   IF ADDR(WDS)^=NULLPTR THEN                                     0507
         L     @14,@PC00001+4                                      0507
         L     @14,FDTPTR+4(,@14)                                  0507
         LTR   @14,@14                                             0507
         BZ    @RF00507                                            0507
*     DO;                           /*                       @Y30LB38*/
*       ALLDSN=ADDR(WDSVAL);        /*                       @Y30LB38*/
         L     @02,ALLOCPTR                                        0509
         LA    @14,WDSVAL(,@14)                                    0509
         ST    @14,ALLDSN(,@02)                                    0509
*       ALLSTSOD=ON;                /*                       @Y30LB38*/
         OI    ALLSTSOD(@02),B'00000001'                           0510
*       ALLDSPKP=ON;                /*                       @Y30LB38*/
         OI    ALLDSPKP(@02),B'00001000'                           0511
*       ALLOPTDS=ON;                /*                       @Y30LB38*/
*                                                                  0512
         OI    ALLOPTDS(@02),B'01000000'                           0512
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP THE UNIT LIST TO ALLOCATE THE DATA SET     @ZM00717*/
*       /* ON A UNIT IN STAGING DRIVE GROUP ZERO             @ZM00717*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0513
*       ALLULP=ADDR(UNITLIST);      /*                       @Y30LB38*/
         LA    @14,UNITLIST                                        0513
         ST    @14,ALLULP(,@02)                                    0513
*       COUNT=ONE;                  /*                       @Y30LB38*/
         MVC   COUNT(2),@CH00220                                   0514
*       DEVLEN=LENGTH(UNITCON);     /*                       @Y30LB38*/
         MVC   DEVLEN(2),@CH00287                                  0515
*       DEVTYPE=UNITCON;            /*                       @Y30LB38*/
         MVI   DEVTYPE+5,C' '                                      0516
         MVC   DEVTYPE+6(2),DEVTYPE+5                              0516
         MVC   DEVTYPE(5),@CC01524                                 0516
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/*                      @Y30LB38*/
         ST    @15,@AL00001                                        0517
         ST    @02,@AL00001+4                                      0517
         MVI   @AL00001+4,X'80'                                    0517
         L     @15,GDTALC(,@15)                                    0517
         LA    @01,@AL00001                                        0517
         BALR  @14,@15                                             0517
*       RESPECIFY                                                  0518
*         RTNREG RSTD;                                             0518
*       TESTRC=RTNREG;                                             0519
         LR    TESTRC,RTNREG                                       0519
*       RESPECIFY                                                  0520
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0521
         LTR   TESTRC,TESTRC                                       0521
         BZ    @RF00521                                            0521
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/
         LA    OPENCODE,12                                         0522
*       ELSE                                                       0523
*         DDNAME=ALLDDN;            /*                       @Y30LB38*/
         B     @RC00521                                            0523
@RF00521 L     @01,ALLOCPTR                                        0523
         MVC   DDNAME(8),ALLDDN(@01)                               0523
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           0525
*     DDNAME=WFILEVAL;              /*                       @Y30LB38*/
         B     @RC00507                                            0525
@RF00507 L     @15,@PC00001+4                                      0525
         L     @01,FDTPTR(,@15)                                    0525
         MVC   DDNAME(8),WFILEVAL(@01)                             0525
*                                                                  0526
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UIOINFO MACRO TO       @Y30LB38*/
*   /* RETREIVE THE VOLSER FROM THE JFCB. USE THE DDNAME PLACED IN   */
*   /* THE DDNAME FIELD.                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0526
*   IF OPENCODE=LASTCC00 THEN                                      0526
@RC00507 LTR   OPENCODE,OPENCODE                                   0526
         BNZ   @RF00526                                            0526
*     DO;                           /*                       @Y30LB38*/
*       WORKLEN=LENGTH(INFOAREA);   /*                       @ZM00717*/
         MVC   WORKLEN(2),@CH01823                                 0528
*       IOINFVOL=ON;                /*                       @Y30LB38*/
         LA    @02,IOINFO                                          0529
         OI    IOINFVOL(@02),B'01000000'                           0529
*       CALL IDCIOSI0(GDTTBL,IOINFO,VOLSRPTR,DDNAME);/*      @Y30LB38*/
         L     @02,@PC00001                                        0530
         ST    @02,@AL00001                                        0530
         LA    @15,IOINFO                                          0530
         ST    @15,@AL00001+4                                      0530
         LA    @15,VOLSRPTR                                        0530
         ST    @15,@AL00001+8                                      0530
         LA    @15,DDNAME                                          0530
         ST    @15,@AL00001+12                                     0530
         MVI   @AL00001+12,X'80'                                   0530
         L     @15,GDTIFO(,@02)                                    0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*       RESPECIFY                                                  0531
*         RTNREG RSTD;                                             0531
*       TESTRC=RTNREG;                                             0532
         LR    TESTRC,RTNREG                                       0532
*       RESPECIFY                                                  0533
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0534
         LTR   TESTRC,TESTRC                                       0534
         BZ    @RF00534                                            0534
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/
         LA    OPENCODE,12                                         0535
*       ELSE                                                       0536
*         WRKVOL=VOLAREA(1);        /*                       @Y30LB38*/
         B     @RC00534                                            0536
@RF00534 MVC   WRKVOL(6),VOLAREA                                   0536
*     END;                          /*                       @Y30LB38*/
@RC00534 DS    0H                                                  0538
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE UMSSUNIT MACRO TO CHECK    @Y30LB38*/
*   /* THE WORK DATA SET FOR BEING ON A VIRTUAL VOLUME. PRIOR TO     */
*   /* ISSUING THE MACRO TEST IF THE DATA SET WAS ALLOCATED          */
*   /* DYNAMICALLY. IF YES, PLACE THE VOLSER IN THE CKAGL PARM LIST  */
*   /* SO THAT IF AN ERROR OCCURS THE VOLSER WILL BE USED INSTEAD OF */
*   /* THE DDNAME                                            @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   IF OPENCODE=LASTCC00 THEN                                      0538
@RF00526 SLR   @15,@15                                             0538
         CR    OPENCODE,@15                                        0538
         BNE   @RF00538                                            0538
*     DO;                           /*                       @Y30LB38*/
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB38*/
         L     @14,CKPTR                                           0540
         LA    @03,UCBPTR                                          0540
         ST    @03,CKUCBPTR(,@14)                                  0540
*       CKDDNAME=DDNAME;            /*                       @Y30LB38*/
         MVC   CKDDNAME(8,@14),DDNAME                              0541
*       CKTESTVT=ON;                /*                       @Y30LB38*/
         OI    CKTESTVT(@14),B'10000000'                           0542
*       IF ADDR(WDS)^=NULLPTR THEN  /*                       @Y30LB38*/
         L     @03,@PC00001+4                                      0543
         C     @15,FDTPTR+4(,@03)                                  0543
         BE    @RF00543                                            0543
*         CKLABELP=ADDR(VOLAREA(1));/*                       @ZA08852*/
         LA    @15,VOLAREA                                         0544
         ST    @15,CKLABELP(,@14)                                  0544
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB38*/
@RF00543 L     @02,@PC00001                                        0545
         ST    @02,@AL00001                                        0545
         LA    @15,CHECK                                           0545
         ST    @15,@AL00001+4                                      0545
         L     @01,CKPTR                                           0545
         ST    @01,@AL00001+8                                      0545
         MVI   @AL00001+8,X'80'                                    0545
         L     @15,GDTUNT(,@02)                                    0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*       RESPECIFY                                                  0546
*         RTNREG RSTD;                                             0546
*       TESTRC=RTNREG;                                             0547
         LR    TESTRC,RTNREG                                       0547
*       RESPECIFY                                                  0548
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0549
         LTR   TESTRC,TESTRC                                       0549
         BZ    @RF00549                                            0549
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/
         LA    OPENCODE,12                                         0550
*     END;                          /*                       @Y30LB38*/
@RF00549 DS    0H                                                  0552
*                                                                  0552
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 THEN ISSUE THE UEXCP MACRO TO OPEN    @Y30LB38*/
*   /* THE WORK DATA SET. UPON RETURN FROM SUCCESSFUL OPEN OF THE    */
*   /* DATA SET THE BEGINING AND ENDING ADDRESS MUST BE ON A CYLINDER*/
*   /* BOUNDARY. IF NOT, THE BEG CYLINDER ADDR IS ROUNDED UP AND THE */
*   /* END CYL IS ROUNDED DOWN.                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0552
*   IF OPENCODE=LASTCC00 THEN                                      0552
@RF00538 LTR   OPENCODE,OPENCODE                                   0552
         BNZ   @RF00552                                            0552
*     DO;                           /*                       @Y30LB38*/
*       EXODDN=ADDR(DDNAME);        /*                       @Y30LB38*/
         LA    @02,DDNAME                                          0554
         ST    @02,EXODDN(,EXOPTR)                                 0554
*       EXOEXT=ADDR(EXTADR);        /*                       @Y30LB38*/
         LA    @02,EXTADR                                          0555
         ST    @02,EXOEXT(,EXOPTR)                                 0555
*       EXOCTLBK=ADDR(WORKPTR);     /*                       @Y30LB38*/
         LA    @02,WORKPTR                                         0556
         ST    @02,EXOCTLBK(,EXOPTR)                               0556
*       EXOTAB=ON;                  /*                       @Y30LB38*/
         OI    EXOTAB(EXOPTR),B'10000000'                          0557
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                 @Y30LB38*/
         L     @02,@PC00001                                        0558
         ST    @02,@AL00001                                        0558
         LA    @15,OPEN                                            0558
         ST    @15,@AL00001+4                                      0558
         ST    EXOPTR,@AL00001+8                                   0558
         MVI   @AL00001+8,X'80'                                    0558
         L     @15,GDTEXP(,@02)                                    0558
         LA    @01,@AL00001                                        0558
         BALR  @14,@15                                             0558
*       RESPECIFY                                                  0559
*         RTNREG RSTD;                                             0559
*       TESTRC=RTNREG;                                             0560
         LR    TESTRC,RTNREG                                       0560
*       RESPECIFY                                                  0561
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC=0 THEN                                           0562
         LTR   TESTRC,TESTRC                                       0562
         BNZ   @RF00562                                            0562
*         DO;                       /*                       @Y30LB38*/
*           IF STRK^=CHARZERO(1:2) THEN                            0564
         CLC   STRK(2),CHARZERO                                    0564
         BE    @RF00564                                            0564
*             SCYL=SCYL+ONE;        /*                       @Y30LB38*/
         LA    @07,1                                               0565
         SLR   @15,@15                                             0565
         ICM   @15,3,SCYL                                          0565
         ALR   @07,@15                                             0565
         STCM  @07,3,SCYL                                          0565
*           IF ETRK^=CHARZERO(1:2) THEN                            0566
@RF00564 CLC   ETRK(2),CHARZERO                                    0566
         BE    @RF00566                                            0566
*             ECYL=ECYL-ONE;        /*                       @Y30LB38*/
         LH    @07,ECYL                                            0567
         N     @07,@CF01843                                        0567
         BCTR  @07,0                                               0567
         STH   @07,ECYL                                            0567
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0569
*         OPENCODE=LASTCC12;        /*                       @Y30LB38*/
         B     @RC00562                                            0569
@RF00562 LA    OPENCODE,12                                         0569
*     END;                          /*                       @Y30LB38*/
@RC00562 DS    0H                                                  0571
*                                                                  0571
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPENCODE = 0 ISSUE THE USSC MACRO WITH THE         @ZA14727*/
*   /* ACQUIRE OPTION TO ACQUIRE THE DATA SET SPACE AND ALSO SPECIFY */
*   /* THE BIND OPTION.                                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0571
*   IF OPENCODE=LASTCC00 THEN                                      0571
@RF00552 SLR   @07,@07                                             0571
         CR    OPENCODE,@07                                        0571
         BNE   @RF00571                                            0571
*     DO;                           /*                       @Y30LB38*/
*       ARLL=LENGTH(ACQLIST);       /*                       @Y30LB38*/
         L     @15,ACQPTR                                          0573
         MVC   ARLL(4,@15),@CF01822                                0573
*       AROP=ACQOPCOD;              /*                       @ZM00717*/
         MVI   AROP(@15),X'02'                                     0574
*       ARBDUBD=ON;                 /*                       @Y30LB38*/
*       ARINH=ON;                   /*                       @Y30LB38*/
         OI    ARBDUBD(@15),B'10100000'                            0576
*       ARNMEXT=ONE;                /*                       @Y30LB38*/
         MVI   ARNMEXT(@15),X'01'                                  0577
*       ARVOL=VOLAREA(ONE);         /*                       @Y30LB38*/
         MVC   ARVOL(6,@15),VOLAREA                                0578
*       AREXT(1,1:2)=SCYL;          /*                       @Y30LB38*/
         MVC   AREXT(2,@15),SCYL                                   0579
*       AREXT(1,3:4)=ECYL;          /*                       @Y30LB38*/
*                                                                  0580
         MVC   AREXT+2(2,@15),ECYL                                 0580
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF    @Y30LB38*/
*       /* USSC PARM LIST                                    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0581
*       IF GDTDBG=NULLPTR THEN                                     0581
         L     @15,@PC00001                                        0581
         C     @07,GDTDBG(,@15)                                    0581
         BE    @RT00581                                            0581
*         ;                                                        0582
*       ELSE                                                       0583
*         DO;                                                      0583
*           DMPINDEX=ADDR(DMPSTG);  /*                       @Y30LB38*/
         LA    DMPINDEX,DMPSTG                                     0584
*           DMPITMNM='ACQLIST';                                    0585
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0585
         MVC   DMPITMNM(7,DMPINDEX),@CC01531                       0585
*           DMPITMPT=ADDR(ACQLIST);                                0586
         L     @07,ACQPTR                                          0586
         ST    @07,DMPITMPT(,DMPINDEX)                             0586
*           DMPITMLN=LENGTH(ACQLIST);                              0587
         MVC   DMPITMLN(2,DMPINDEX),@CH01822                       0587
*           DMPITMTP='H';                                          0588
         MVI   DMPITMTP(DMPINDEX),C'H'                             0588
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0589
         AL    DMPINDEX,@CF00475                                   0589
*           DMPTRM=DMPTRMVL;                                       0590
         MVI   DMPTRM(DMPINDEX),X'FF'                              0590
*         END;                      /*                       @Y30LB38*/
*       IF GDTDBG=NULLPTR THEN                                     0592
@RT00581 L     @07,@PC00001                                        0592
         L     @07,GDTDBG(,@07)                                    0592
         LTR   @07,@07                                             0592
         BZ    @RT00592                                            0592
*         ;                                                        0593
*       ELSE                                                       0594
*         CALL IDCDB010(GDTTBL,'LMBF',ADDR(DMPSTG));/*       @Y30LB38*/
         L     @07,@PC00001                                        0594
         ST    @07,@AL00001                                        0594
         LA    @15,@CC01533                                        0594
         ST    @15,@AL00001+4                                      0594
         LA    @15,DMPSTG                                          0594
         ST    @15,@AFTEMPS                                        0594
         LA    @15,@AFTEMPS                                        0594
         ST    @15,@AL00001+8                                      0594
         MVI   @AL00001+8,X'80'                                    0594
         L     @15,GDTDBG(,@07)                                    0594
         LA    @01,@AL00001                                        0594
         BALR  @14,@15                                             0594
*       CALL IDCSASS0(GDTTBL,ACQUIRE,ACQPTR,REASONCD);/*     @Y30LB38*/
@RT00592 L     @07,@PC00001                                        0595
         ST    @07,@AL00001                                        0595
         LA    @02,ACQUIRE                                         0595
         ST    @02,@AL00001+4                                      0595
         LA    @02,ACQPTR                                          0595
         ST    @02,@AL00001+8                                      0595
         LA    @02,REASONCD                                        0595
         ST    @02,@AL00001+12                                     0595
         MVI   @AL00001+12,X'80'                                   0595
         L     @15,GDTSSC(,@07)                                    0595
         LA    @01,@AL00001                                        0595
         BALR  @14,@15                                             0595
*       RESPECIFY                                                  0596
*         RTNREG RSTD;                                             0596
*       TESTRC=RTNREG;                                             0597
         LR    TESTRC,RTNREG                                       0597
*       RESPECIFY                                                  0598
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          0599
         LTR   TESTRC,TESTRC                                       0599
         BZ    @RF00599                                            0599
*         DO;                       /*                       @ZA14727*/
*                                                                  0600
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE     @Y30LB38*/
*           /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.       */
*           /*                                               @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0601
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB38*/
         LA    @15,REASONCD                                        0601
         ST    @15,@AL00001                                        0601
         LA    @01,@AL00001                                        0601
         BAL   @14,SSCMSG                                          0601
*           OPENCODE=LASTCC12;      /*                       @Y30LB38*/
         LA    OPENCODE,12                                         0602
*         END;                      /*                       @Y30LB38*/
*       ELSE                        /*                       @ZA14727*/
*         ACQSW=ON;                 /*                       @ZA14727*/
         B     @RC00599                                            0604
@RF00599 OI    ACQSW,B'00010000'                                   0604
*     END;                          /*                       @Y30LB38*/
*                                                                  0605
@RC00599 DS    0H                                                  0606
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RF00571 L     REG14,RETADDR1                                      0606
*   RETURN CODE(OPENCODE);          /*                       @Y30LB38*/
         LR    @15,OPENCODE                                        0607
@EL00002 DS    0H                                                  0607
@EF00002 DS    0H                                                  0607
@ER00002 BR    @14                                                 0607
*   END OPENWORK;                   /*                       @Y30LB38*/
*                                                                  0609
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - RPTSEL                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE INVESTIGATES THE FDTTBL FOR  @Y30LB38*/
*/*                THE REPORTS REQUESTED, UPDATES FIELDS IN  @Y30LB38*/
*/*                THE INTTBL TO INDICATE THE REPORT PARMS   @Y30LB38*/
*/*                AND CALLS THE REPORT PROCESSOR AND/OR     @Y30LB38*/
*/*                SUMMARIZER TO PRODUCE EACH REPORT         @Y30LB38*/
*/*                OR TO COUNT THE NUMBER OF EACH TYPE OF    @Y30LB38*/
*/*                ENTRY IF SUMARY IS SPECIFIED.  THE        @Y30LB38*/
*/*                SUMARIZER IS CALLED TO PRINT THE SUMARY   @Y30LB38*/
*/*                REPORT.  THE                              @Y30LB38*/
*/*                CONDITION CODE AREA IS SET TO HEX 7FFF    @ZM00717*/
*/*                AT ENTRY TO INDICATE THAT NO REPORT HAS   @Y30LB38*/
*/*                BEEN PRODUCED OR ATTEMPTED.  IF A REPORT  @Y30LB38*/
*/*                FAILS, ITS SUMMARY COUNTER IS SET TO HEX  @Y30LB38*/
*/*                7FFFFFFF SO THAT THE SUMARY ROUTINE WILL  @ZM00717*/
*/*                KNOW OF THE FAILURE.                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - FUNCTION DEFINITION TABLE AND WORK AREA      @Y30LB38*/
*/*            CALLED SORTBLK.                               @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - SORTBLK, UPDATED INTTBL AND RETURN CODE     @Y30LB38*/
*/*              0 = NO ERRORS                               @Y30LB38*/
*/*              8 = AT LEAST ONE REPORT RAN, BUT AT LEAST   @Y30LB38*/
*/*                  ONE FAILED                              @Y30LB38*/
*/*              12 = NO REPORTS RAN                         @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0609
*RPTSEL:                                                           0609
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0609
RPTSEL   DS    0H                                                  0610
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0610
*   DCL                                                            0610
*     RPTCODE FIXED(15);            /* RPTSEL RETURN CODE    @Y30LB38*/
*   DCL                                                            0611
*     NOREPT FIXED(15) INIT('7FFF'X)/* NO REPTS PRINTED      @ZM00717*/
*         STATIC;                   /*                       @ZM00717*/
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR TRAN VOLUME    @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0612
*   DCL                                                            0612
*     TRBLKITM FIXED(31) CONSTANT(84);/* ENTRIES PER BLOCK   @Y30LB38*/
*   DCL                                                            0613
*     TRITMLEN FIXED(8) CONSTANT(24);/* ENTRY LENGTH         @Y30LB38*/
*   DCL                                                            0614
*     TRSRTLEN FIXED(8) CONSTANT(6);/* SORT KEY LENGTH       @Y30LB38*/
*   DCL                                                            0615
*     TRENTLIM FIXED(8) CONSTANT(2);/* ENTRIES PER LINE      @Y30LB38*/
*   DCL                                                            0616
*     TRBUFLIM FIXED(8) CONSTANT(108);/* ENTRIES PER BUFFER  @Y30LB38*/
*                                                                  0616
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR VOL INVENTORY  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0617
*   DCL                                                            0617
*     VIBLKITM FIXED(31) CONSTANT(166);/* ENTRIES PER BLOCK  @Y30LB38*/
*   DCL                                                            0618
*     VIITMLEN FIXED(8) CONSTANT(12);/* ENTRY LENGTH         @Y30LB38*/
*   DCL                                                            0619
*     VISRTLEN FIXED(8) CONSTANT(6);/* SORT KEY LENGTH       @Y30LB38*/
*   DCL                                                            0620
*     VIENTLIM FIXED(8) CONSTANT(3);/* ENTRIES PER LINE      @Y30LB38*/
*   DCL                                                            0621
*     VIBUFLIM FIXED(8) CONSTANT(162);/* ENTRIES PER BUFFER  @Y30LB38*/
*                                                                  0621
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE VALUES TO BE PUT IN INTTBL FOR SCRATCH CART   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0622
*   DCL                                                            0622
*     SCBLKITM FIXED(31) CONSTANT(142);/* ENTRIES PER BLOCK  @Y30LB38*/
*   DCL                                                            0623
*     SCITMLEN FIXED(8) CONSTANT(14);/* ENTRY LENGTH         @Y30LB38*/
*   DCL                                                            0624
*     SCSRTLEN FIXED(8) CONSTANT(12);/* SORT KEY LENGTH      @Y30LB38*/
*   DCL                                                            0625
*     SCENTLIM FIXED(8) CONSTANT(4);/* ENTRIES PER LINE      @Y30LB38*/
*   DCL                                                            0626
*     SCBUFLIM FIXED(8) CONSTANT(216);/* ENTRIES PER BUFFER  @Y30LB38*/
*                                                                  0627
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR1                                      0627
*   OLDERID2=NEWERID2;                                             0628
         L     @15,@PC00001                                        0628
         L     @15,GDTTR2(,@15)                                    0628
         MVC   @TS00001(95),NEWERID2(@15)                          0628
         MVC   OLDERID2(95,@15),@TS00001                           0628
*   NEWID2='LMCA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01561                              0629
*   SORTENT=''B;                    /*                       @Y30LB38*/
         SLR   @15,@15                                             0630
         L     @14,SORTPTR                                         0630
         ST    @15,SORTENT(,@14)                                   0630
*   SORTCNT=''B;                    /*                       @Y30LB38*/
*                                                                  0631
         STH   @15,SORTCNT(,@14)                                   0631
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CONDITION CODE FOR THIS ROUTINE IS INITIALIZED    @Y30LB38*/
*   /* TO '7FFF'X TO INDICATE THAT NO REPORTS HAVE BEEN PRODUCED OR  */
*   /* ATTEMPTED YET.                                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0632
*   RPTCODE=NOREPT;                 /*                       @Y30LB38*/
         LH    @15,NOREPT                                          0632
         STH   @15,RPTCODE                                         0632
*                                                                  0633
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NMNT, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE FDTTBL,*/
*   /* INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT PROCESSOR FOR*/
*   /* TRANSIENT VOLUME REPORT.                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0633
*   IF ADDR(NMNT)^=NULLPTR×ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR THEN
         SLR   @15,@15                                             0633
         L     @14,@PC00001+4                                      0633
         C     @15,FDTPTR+12(,@14)                                 0633
         BNE   @RT00633                                            0633
         C     @15,FDTPTR+20(,@14)                                 0633
         BNE   @RT00633                                            0633
         C     @15,FDTPTR+24(,@14)                                 0633
         BE    @RF00633                                            0633
@RT00633 DS    0H                                                  0634
*     DO;                           /*                       @Y30LB38*/
*       TBLID=TRANID;               /*                       @Y30LB38*/
         MVI   TBLID,X'02'                                         0635
*       BLKITEMS=TRBLKITM;          /*                       @Y30LB38*/
         MVC   BLKITEMS(4),@CF01541                                0636
*       ITEMLEN=TRITMLEN;           /*                       @Y30LB38*/
         MVI   ITEMLEN,X'18'                                       0637
*       KEYLEN=TRSRTLEN;            /*                       @ZA08859*/
         MVI   KEYLEN,X'06'                                        0638
*       ENTYLIM=TRENTLIM;           /*                       @Y30LB38*/
         MVI   ENTYLIM,X'02'                                       0639
*       BUFFLIM=TRBUFLIM;           /*                       @Y30LB38*/
         MVI   BUFFLIM,X'6C'                                       0640
*       CALL RPTPROC;               /*                       @Y30LB38*/
         BAL   @14,RPTPROC                                         0641
*       RESPECIFY                                                  0642
*         RTNREG RSTD;                                             0642
*       TESTRC=RTNREG;                                             0643
         LR    TESTRC,RTNREG                                       0643
*       RESPECIFY                                                  0644
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       RPTCODE=TESTRC;             /*                       @Y30LB38*/
*                                                                  0645
         STH   TESTRC,RPTCODE                                      0645
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND NMNT OR ALL ARE    @ZM00717*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0646
*       IF TESTRC=LASTCC12&(ADDR(NMNT)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN
         C     TESTRC,@CF00567                                     0646
         BNE   @RF00646                                            0646
         SLR   @02,@02                                             0646
         L     @15,@PC00001+4                                      0646
         C     @02,FDTPTR+12(,@15)                                 0646
         BNE   @RT00646                                            0646
         C     @02,FDTPTR+24(,@15)                                 0646
         BE    @RF00646                                            0646
@RT00646 DS    0H                                                  0647
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0648
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @02,DDSTRU                                          0649
         MVC   DARGSMOD(3,@02),@CC01483                            0649
*           DARGSENT=MS2821I4;      /*                       @Y30LB38*/
         MVI   DARGSENT(@02),X'04'                                 0650
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @02,@PC00001                                        0651
         ST    @02,@AL00001                                        0651
         LA    @15,@CF00116                                        0651
         ST    @15,@AL00001+4                                      0651
         LA    @15,DDSTRU                                          0651
         ST    @15,@AL00001+8                                      0651
         MVI   @AL00001+8,X'80'                                    0651
         L     @15,GDTPRT(,@02)                                    0651
         LA    @01,@AL00001                                        0651
         BALR  @14,@15                                             0651
*         END;                      /*                       @Y30LB38*/
*                                                                  0652
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL IS      @ZM00717*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */
*       /* CALCULATED.                                       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0653
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR)
*         THEN                                                     0653
@RF00646 C     TESTRC,@CF00567                                     0653
         BNE   @RF00653                                            0653
         SLR   @02,@02                                             0653
         L     @15,@PC00001+4                                      0653
         C     @02,FDTPTR+20(,@15)                                 0653
         BNE   @RT00653                                            0653
         C     @02,FDTPTR+24(,@15)                                 0653
         BE    @RF00653                                            0653
@RT00653 DS    0H                                                  0654
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0655
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          0656
         MVC   DARGSMOD(3,@15),@CC01483                            0656
*           DARGSENT=M2823I24;      /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'18'                                 0657
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @15,@PC00001                                        0658
         ST    @15,@AL00001                                        0658
         LA    @14,@CF00116                                        0658
         ST    @14,@AL00001+4                                      0658
         LA    @14,DDSTRU                                          0658
         ST    @14,@AL00001+8                                      0658
         MVI   @AL00001+8,X'80'                                    0658
         L     @15,GDTPRT(,@15)                                    0658
         LA    @01,@AL00001                                        0658
         BALR  @14,@15                                             0658
*           TVCNTR=CNTRVAL;         /*                       @Y30LB38*/
         L     @15,CNTRVAL                                         0659
         ST    @15,TVCNTR                                          0659
*         END;                      /*                       @Y30LB38*/
*                                                                  0660
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */
*       /*                                                   @Y30LB38*/
*       /* UESTA.                                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0661
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/
@RF00653 L     @15,@PC00001                                        0661
         ST    @15,@AL00001                                        0661
         LA    @14,PRINTME                                         0661
         ST    @14,@AL00001+4                                      0661
         MVI   @AL00001+4,X'80'                                    0661
         L     @15,GDTRES(,@15)                                    0661
         LA    @01,@AL00001                                        0661
         BALR  @14,@15                                             0661
*     END;                          /*                       @Y30LB38*/
*                                                                  0663
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MNT, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE @Y30LB38*/
*   /* FDTTBL, INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT      */
*   /* PROCESSOR FOR VOLUME INVENTORY REPORT.                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0663
*   IF ADDR(MNT)^=NULLPTR×ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR THEN
@RF00633 SLR   @15,@15                                             0663
         L     @14,@PC00001+4                                      0663
         C     @15,FDTPTR+8(,@14)                                  0663
         BNE   @RT00663                                            0663
         C     @15,FDTPTR+20(,@14)                                 0663
         BNE   @RT00663                                            0663
         C     @15,FDTPTR+24(,@14)                                 0663
         BE    @RF00663                                            0663
@RT00663 DS    0H                                                  0664
*     DO;                           /*                       @Y30LB38*/
*       TBLID=VOLINVID;             /*                       @Y30LB38*/
         MVI   TBLID,X'03'                                         0665
*       BLKITEMS=VIBLKITM;          /*                       @Y30LB38*/
         MVC   BLKITEMS(4),@CF01548                                0666
*       ITEMLEN=VIITMLEN;           /*                       @Y30LB38*/
         MVI   ITEMLEN,X'0C'                                       0667
*       KEYLEN=VISRTLEN;            /*                       @ZA08859*/
         MVI   KEYLEN,X'06'                                        0668
*       ENTYLIM=VIENTLIM;           /*                       @Y30LB38*/
         MVI   ENTYLIM,X'03'                                       0669
*       BUFFLIM=VIBUFLIM;           /*                       @Y30LB38*/
         MVI   BUFFLIM,X'A2'                                       0670
*       LASTRK=''B;                 /*                       @Y30LB38*/
         XC    LASTRK(5),LASTRK                                    0671
*       CALL RPTPROC;               /*                       @Y30LB38*/
         BAL   @14,RPTPROC                                         0672
*       RESPECIFY                                                  0673
*         RTNREG RSTD;                                             0673
*       TESTRC=RTNREG;                                             0674
         LR    TESTRC,RTNREG                                       0674
*       RESPECIFY                                                  0675
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       RPTCODE=TESTRC;             /*                       @Y30LB38*/
*                                                                  0676
         STH   TESTRC,RPTCODE                                      0676
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */
*       /*                                                   @Y30LB38*/
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0677
*       IF RPTCODE=NOREPT THEN                                     0677
         LH    @02,RPTCODE                                         0677
         CH    @02,NOREPT                                          0677
         BNE   @RF00677                                            0677
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/
         STH   TESTRC,RPTCODE                                      0678
*       ELSE                                                       0679
*         IF RPTCODE^=TESTRC THEN                                  0679
         B     @RC00677                                            0679
@RF00677 CH    TESTRC,RPTCODE                                      0679
         BE    @RF00679                                            0679
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/
*                                                                  0680
         MVC   RPTCODE(2),@CH00180                                 0680
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND MNT OR ALL IS      @ZM00717*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0681
*       IF TESTRC=LASTCC12&(ADDR(MNT)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN
@RF00679 DS    0H                                                  0681
@RC00677 C     TESTRC,@CF00567                                     0681
         BNE   @RF00681                                            0681
         SLR   @02,@02                                             0681
         L     @15,@PC00001+4                                      0681
         C     @02,FDTPTR+8(,@15)                                  0681
         BNE   @RT00681                                            0681
         C     @02,FDTPTR+24(,@15)                                 0681
         BE    @RF00681                                            0681
@RT00681 DS    0H                                                  0682
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0683
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @02,DDSTRU                                          0684
         MVC   DARGSMOD(3,@02),@CC01483                            0684
*           DARGSENT=MS2821I3;      /*                       @Y30LB38*/
         MVI   DARGSENT(@02),X'03'                                 0685
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @02,@PC00001                                        0686
         ST    @02,@AL00001                                        0686
         LA    @15,@CF00116                                        0686
         ST    @15,@AL00001+4                                      0686
         LA    @15,DDSTRU                                          0686
         ST    @15,@AL00001+8                                      0686
         MVI   @AL00001+8,X'80'                                    0686
         L     @15,GDTPRT(,@02)                                    0686
         LA    @01,@AL00001                                        0686
         BALR  @14,@15                                             0686
*         END;                      /*                       @Y30LB38*/
*                                                                  0687
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL ARE     @Y30LB38*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */
*       /* CALCULATED.                                       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0688
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR)
*         THEN                                                     0688
@RF00681 C     TESTRC,@CF00567                                     0688
         BNE   @RF00688                                            0688
         SLR   @02,@02                                             0688
         L     @15,@PC00001+4                                      0688
         C     @02,FDTPTR+20(,@15)                                 0688
         BNE   @RT00688                                            0688
         C     @02,FDTPTR+24(,@15)                                 0688
         BE    @RF00688                                            0688
@RT00688 DS    0H                                                  0689
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0690
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          0691
         MVC   DARGSMOD(3,@15),@CC01483                            0691
*           DARGSENT=M2823I23;      /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'17'                                 0692
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @15,@PC00001                                        0693
         ST    @15,@AL00001                                        0693
         LA    @14,@CF00116                                        0693
         ST    @14,@AL00001+4                                      0693
         LA    @14,DDSTRU                                          0693
         ST    @14,@AL00001+8                                      0693
         MVI   @AL00001+8,X'80'                                    0693
         L     @15,GDTPRT(,@15)                                    0693
         LA    @01,@AL00001                                        0693
         BALR  @14,@15                                             0693
*           VICNTR=CNTRVAL;         /*                       @Y30LB38*/
         L     @15,CNTRVAL                                         0694
         ST    @15,VICNTR                                          0694
*         END;                      /*                       @Y30LB38*/
*                                                                  0695
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */
*       /*                                                   @Y30LB38*/
*       /* UESTA.                                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0696
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/
@RF00688 L     @15,@PC00001                                        0696
         ST    @15,@AL00001                                        0696
         LA    @14,PRINTME                                         0696
         ST    @14,@AL00001+4                                      0696
         MVI   @AL00001+4,X'80'                                    0696
         L     @15,GDTRES(,@15)                                    0696
         LA    @01,@AL00001                                        0696
         BALR  @14,@15                                             0696
*     END;                          /*                       @Y30LB38*/
*                                                                  0698
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CART, SUM OR ALL KEYWORDS WERE SPECIFIED IN THE FDTTBL,*/
*   /* INITIALIZE THE INTTBL FIELDS AND CALL THE REPORT PROCESSOR FOR*/
*   /* SCRATCH CARTRIDGE REPORT.                             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   IF ADDR(CART)^=NULLPTR×ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR THEN
@RF00663 SLR   @15,@15                                             0698
         L     @14,@PC00001+4                                      0698
         C     @15,FDTPTR+16(,@14)                                 0698
         BNE   @RT00698                                            0698
         C     @15,FDTPTR+20(,@14)                                 0698
         BNE   @RT00698                                            0698
         C     @15,FDTPTR+24(,@14)                                 0698
         BE    @RF00698                                            0698
@RT00698 DS    0H                                                  0699
*     DO;                           /*                       @Y30LB38*/
*       TBLID=CARTID;               /*                       @Y30LB38*/
         MVI   TBLID,X'04'                                         0700
*       BLKITEMS=SCBLKITM;          /*                       @Y30LB38*/
         MVC   BLKITEMS(4),@CF01555                                0701
*       ITEMLEN=SCITMLEN;           /*                       @Y30LB38*/
         MVI   ITEMLEN,X'0E'                                       0702
*       KEYLEN=SCSRTLEN;            /*                       @ZA08859*/
         MVI   KEYLEN,X'0C'                                        0703
*       ENTYLIM=SCENTLIM;           /*                       @Y30LB38*/
         MVI   ENTYLIM,X'04'                                       0704
*       BUFFLIM=SCBUFLIM;           /*                       @Y30LB38*/
         MVI   BUFFLIM,X'D8'                                       0705
*       LASTRK=''B;                 /*                       @Y30LB38*/
         XC    LASTRK(5),LASTRK                                    0706
*       CALL RPTPROC;               /*                       @Y30LB38*/
         BAL   @14,RPTPROC                                         0707
*       RESPECIFY                                                  0708
*         RTNREG RSTD;                                             0708
*       TESTRC=RTNREG;                                             0709
         LR    TESTRC,RTNREG                                       0709
*       RESPECIFY                                                  0710
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*                                                                  0710
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */
*       /*                                                   @Y30LB38*/
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0711
*       IF RPTCODE=NOREPT THEN                                     0711
         CLC   RPTCODE(2),NOREPT                                   0711
         BNE   @RF00711                                            0711
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/
         STH   TESTRC,RPTCODE                                      0712
*       ELSE                                                       0713
*         IF RPTCODE^=TESTRC THEN                                  0713
         B     @RC00711                                            0713
@RF00711 CH    TESTRC,RPTCODE                                      0713
         BE    @RF00713                                            0713
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/
*                                                                  0714
         MVC   RPTCODE(2),@CH00180                                 0714
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND CART AND ALL ARE   @Y30LB38*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2821I TO INDICATE REPORT NOT PRODUCED.         @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0715
*       IF TESTRC=LASTCC12&(ADDR(CART)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN
@RF00713 DS    0H                                                  0715
@RC00711 C     TESTRC,@CF00567                                     0715
         BNE   @RF00715                                            0715
         SLR   @02,@02                                             0715
         L     @15,@PC00001+4                                      0715
         C     @02,FDTPTR+16(,@15)                                 0715
         BNE   @RT00715                                            0715
         C     @02,FDTPTR+24(,@15)                                 0715
         BE    @RF00715                                            0715
@RT00715 DS    0H                                                  0716
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0717
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @02,DDSTRU                                          0718
         MVC   DARGSMOD(3,@02),@CC01483                            0718
*           DARGSENT=MS2821I2;      /*                       @Y30LB38*/
         MVI   DARGSENT(@02),X'02'                                 0719
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @02,@PC00001                                        0720
         ST    @02,@AL00001                                        0720
         LA    @15,@CF00116                                        0720
         ST    @15,@AL00001+4                                      0720
         LA    @15,DDSTRU                                          0720
         ST    @15,@AL00001+8                                      0720
         MVI   @AL00001+8,X'80'                                    0720
         L     @15,GDTPRT(,@02)                                    0720
         LA    @01,@AL00001                                        0720
         BALR  @14,@15                                             0720
*         END;                      /*                       @Y30LB38*/
*                                                                  0721
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE = 12 AND SUM OR ALL ARE     @Y30LB38*/
*       /* SPECIFIED, ISSUE THE UPRINT MACRO AND ISSUE MESSAGE       */
*       /* IDC2823I TO INDICATE THE SUMMARY COUNT COULD NOT BE       */
*       /* CALCULATED.                                       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0722
*       IF TESTRC=LASTCC12&(ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR)
*         THEN                                                     0722
@RF00715 C     TESTRC,@CF00567                                     0722
         BNE   @RF00722                                            0722
         SLR   @02,@02                                             0722
         L     @15,@PC00001+4                                      0722
         C     @02,FDTPTR+20(,@15)                                 0722
         BNE   @RT00722                                            0722
         C     @02,FDTPTR+24(,@15)                                 0722
         BE    @RF00722                                            0722
@RT00722 DS    0H                                                  0723
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0724
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          0725
         MVC   DARGSMOD(3,@15),@CC01483                            0725
*           DARGSENT=M2823I22;      /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'16'                                 0726
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @15,@PC00001                                        0727
         ST    @15,@AL00001                                        0727
         LA    @14,@CF00116                                        0727
         ST    @14,@AL00001+4                                      0727
         LA    @14,DDSTRU                                          0727
         ST    @14,@AL00001+8                                      0727
         MVI   @AL00001+8,X'80'                                    0727
         L     @15,GDTPRT(,@15)                                    0727
         LA    @01,@AL00001                                        0727
         BALR  @14,@15                                             0727
*           SCCNTR=CNTRVAL;         /*                       @Y30LB38*/
         L     @15,CNTRVAL                                         0728
         ST    @15,SCCNTR                                          0728
*         END;                      /*                       @Y30LB38*/
*                                                                  0729
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE URESET MACRO TO CLEAR DATA FROM PREVIOUS        */
*       /*                                                   @Y30LB38*/
*       /* UESTA.                                            @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0730
*       CALL AMSTP044(GDTTBL,PRINTME);/*                     @Y30LB38*/
@RF00722 L     @15,@PC00001                                        0730
         ST    @15,@AL00001                                        0730
         LA    @14,PRINTME                                         0730
         ST    @14,@AL00001+4                                      0730
         MVI   @AL00001+4,X'80'                                    0730
         L     @15,GDTRES(,@15)                                    0730
         LA    @01,@AL00001                                        0730
         BALR  @14,@15                                             0730
*     END;                          /*                       @Y30LB38*/
*                                                                  0731
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF SUM OR ALL KEYWORDS WERE SPECIFIED IN THE     @Y30LB38*/
*   /* FDTTBL. IF YES, INITIALIZE INTTBL FIELD AND CALL THE SUMARY   */
*   /* ROUTINE TO COUNT THE EMPTY CELLS IN THE MSF.          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0732
*   IF ADDR(SUMRY)^=NULLPTR×ADDR(AL)^=NULLPTR THEN                 0732
@RF00698 SLR   @15,@15                                             0732
         L     @14,@PC00001+4                                      0732
         C     @15,FDTPTR+20(,@14)                                 0732
         BNE   @RT00732                                            0732
         C     @15,FDTPTR+24(,@14)                                 0732
         BE    @RF00732                                            0732
@RT00732 DS    0H                                                  0733
*     DO;                           /*                       @Y30LB38*/
*       TBLID=CELLID;               /*                       @Y30LB38*/
         MVI   TBLID,X'01'                                         0734
*       LASTRK=''B;                 /*                       @Y30LB38*/
         XC    LASTRK(5),LASTRK                                    0735
*       CALL SUMARY;                /*                       @Y30LB38*/
         BAL   @14,SUMARY                                          0736
*       RESPECIFY                                                  0737
*         RTNREG RSTD;                                             0737
*       TESTRC=RTNREG;                                             0738
         LR    TESTRC,RTNREG                                       0738
*       RESPECIFY                                                  0739
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*                                                                  0739
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CONDITION CODE IS SET TO THE INITIAL VALUE,        */
*       /*                                                   @Y30LB38*/
*       /* INDICATING THAT NO REPORTS HAVE BEEN ATTEMPTED, SET       */
*       /* CONDITION CODE TO THE RETURN CODE. IF NOT EQUAL TO THE    */
*       /* INITIAL VALUE, AND THE CONDITION CODE IS NOT EQUAL TO THE */
*       /* RETURN CODE, INDICATING THAT ONE OF THE REPORTS RAN, SET  */
*       /* THE CONDITION CODE TO 8.                          @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0740
*       IF RPTCODE=NOREPT THEN                                     0740
         CLC   RPTCODE(2),NOREPT                                   0740
         BNE   @RF00740                                            0740
*         RPTCODE=TESTRC;           /*                       @Y30LB38*/
         STH   TESTRC,RPTCODE                                      0741
*       ELSE                                                       0742
*         IF RPTCODE^=TESTRC THEN                                  0742
         B     @RC00740                                            0742
@RF00740 CH    TESTRC,RPTCODE                                      0742
         BE    @RF00742                                            0742
*           RPTCODE=LASTCC08;       /*                       @Y30LB38*/
         MVC   RPTCODE(2),@CH00180                                 0743
*     END;                          /*                       @Y30LB38*/
*                                                                  0744
@RF00742 DS    0H                                                  0744
@RC00740 DS    0H                                                  0745
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RF00732 L     REG14,RETADDR1                                      0745
*   RETURN CODE(RPTCODE);           /*                       @Y30LB38*/
         LH    @15,RPTCODE                                         0746
@EL00003 DS    0H                                                  0746
@EF00003 DS    0H                                                  0746
@ER00003 BR    @14                                                 0746
*   END RPTSEL;                     /*                       @Y30LB38*/
*                                                                  0748
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - RPTPROC                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE PROCESSES  TRACKS OF A TABLE @Y30LB38*/
*/*                AND PRINTS A REPORT.  IT CALLS THE        @Y30LB38*/
*/*                READING ROUTINE TO READ A TRACK AND THEN  @Y30LB38*/
*/*                CALLS THE BLOCK PROCESSOR TO PROCESS THE  @Y30LB38*/
*/*                BLOCKS ON THE TRACK.  WHEN THE TABLE IS   @Y30LB38*/
*/*                PROCESSED, IT CALLS THE REPORT PRINTER    @Y30LB38*/
*/*                TO PRINT THE REPORT.                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED SORTBLK                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - SORTBLK AND RETURN CODE                     @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0748
*RPTPROC:                                                          0748
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0748
RPTPROC  DS    0H                                                  0749
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0749
*   DCL                                                            0749
*     RPTCCODE FIXED(15);           /* RPTPROC RETURN CODE   @Y30LB38*/
*                                                                  0750
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0750
*   RETADDR2=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR2                                      0750
*   OLDERID2=NEWERID2;                                             0751
         L     @07,@PC00001                                        0751
         L     @07,GDTTR2(,@07)                                    0751
         MVC   @TS00001(95),NEWERID2(@07)                          0751
         MVC   OLDERID2(95,@07),@TS00001                           0751
*   NEWID2='LMDA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@07),@CC01568                              0752
*   RPTCCODE=''B;                   /*                       @Y30LB38*/
*                                                                  0753
         SLR   RPTCCODE,RPTCCODE                                   0753
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP A DO WHILE LOOP TO CALL THE TRACK READER AND   @Y30LB38*/
*   /* THE BLOCK PROCESSOR. CONTINUE IN THE LOOP UNTIL NON-ZERO      */
*   /* RETURN CODE IS RETURNED BY ONE OF THE ROUTINES INDICATING AN  */
*   /* ERROR OR THE END OF THE DATA                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0754
*   DO WHILE RPTCCODE=LASTCC00;     /*                       @Y30LB38*/
         B     @DE00754                                            0754
@DL00754 DS    0H                                                  0755
*     CALL TRKRDR;                  /*                       @Y30LB38*/
         BAL   @14,TRKRDR                                          0755
*     RESPECIFY                                                    0756
*       RTNREG RSTD;                                               0756
*     TESTRC=RTNREG;                                               0757
         LR    TESTRC,RTNREG                                       0757
*     RESPECIFY                                                    0758
*       RTNREG UNRSTD;              /*                       @Y30LB38*/
*     RPTCCODE=TESTRC;              /*                       @Y30LB38*/
         LR    RPTCCODE,TESTRC                                     0759
*     IF RPTCCODE^=LASTCC12 THEN                                   0760
         C     RPTCCODE,@CF00567                                   0760
         BE    @RF00760                                            0760
*       DO;                         /*                       @Y30LB38*/
*                                                                  0761
*         /***********************************************************/
*         /*                                                         */
*         /* CALL BLKPROC TO PROCESS THE ENTRIES IN A BLOCK  @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0762
*         CALL BLKPROC;             /*                       @Y30LB38*/
         BAL   @14,BLKPROC                                         0762
*         RESPECIFY                                                0763
*           RTNREG RSTD;                                           0763
*         TESTRC=RTNREG;                                           0764
         LR    TESTRC,RTNREG                                       0764
*         RESPECIFY                                                0765
*           RTNREG UNRSTD;          /*                       @Y30LB38*/
*         RPTCCODE=TESTRC;          /*                       @Y30LB38*/
         LR    RPTCCODE,TESTRC                                     0766
*       END;                        /*                       @Y30LB38*/
*   END;                            /*                       @Y30LB38*/
*                                                                  0768
@RF00760 DS    0H                                                  0768
@DE00754 SLR   @07,@07                                             0768
         CR    RPTCCODE,@07                                        0768
         BE    @DL00754                                            0768
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE IS NOT 12 AND THE BEGINNING     @Y30LB38*/
*   /* OF SORTBLK IS NOT 0, THE SORTING PROCESS IS NOT FINISHED. CALL*/
*   /* MRGDATA TO FINISH.                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0769
*   IF RPTCCODE^=LASTCC12&SORTENT^=ZERO THEN                       0769
         C     RPTCCODE,@CF00567                                   0769
         BE    @RF00769                                            0769
         L     @01,SORTPTR                                         0769
         C     @07,SORTENT(,@01)                                   0769
         BE    @RF00769                                            0769
*     DO;                           /*                       @Y30LB38*/
*       CALL MRGDATA;               /*                       @Y30LB38*/
         BAL   @14,MRGDATA                                         0771
*       RESPECIFY                                                  0772
*         RTNREG RSTD;                                             0772
*       TESTRC=RTNREG;                                             0773
         LR    TESTRC,RTNREG                                       0773
*       RESPECIFY                                                  0774
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       RPTCCODE=TESTRC;            /*                       @Y30LB38*/
         LR    RPTCCODE,TESTRC                                     0775
*     END;                          /*                       @Y30LB38*/
*                                                                  0776
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE IS NOT 12, CALL HEADSET         @Y30LB38*/
*   /* TO ESTABLISH REPORT SUBTITLE LINES.                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0777
*   IF RPTCCODE^=LASTCC12 THEN                                     0777
@RF00769 C     RPTCCODE,@CF00567                                   0777
         BE    @RF00777                                            0777
*     DO;                           /*                       @Y30LB38*/
*                                                                  0778
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLUME INVENTORY, TRANSIENT VOLUME, SCRATCH    @Y30LB38*/
*       /* CARTRIDGE OR ALL ARE SPECIFIED, CALL HEADSET TO PRINT OUT */
*       /* THE SUBTITLE LINES.                               @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0779
*       IF ADDR(AL)^=NULLPTR×ADDR(MNT)^=NULLPTR×ADDR(NMNT)^=NULLPTR×
*           ADDR(CART)^=NULLPTR THEN                               0779
         SLR   @07,@07                                             0779
         L     @15,@PC00001+4                                      0779
         C     @07,FDTPTR+24(,@15)                                 0779
         BNE   @RT00779                                            0779
         C     @07,FDTPTR+8(,@15)                                  0779
         BNE   @RT00779                                            0779
         C     @07,FDTPTR+12(,@15)                                 0779
         BNE   @RT00779                                            0779
         C     @07,FDTPTR+16(,@15)                                 0779
         BE    @RF00779                                            0779
@RT00779 DS    0H                                                  0780
*         CALL HEADSET;             /*                       @Y30LB38*/
*                                                                  0780
         BAL   @14,HEADSET                                         0780
*       /*************************************************************/
*       /*                                                           */
*       /* CALL RPTPRNTR TO PRINT THE REPORT                 @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0781
*       CALL RPTPRNTR;              /*                       @Y30LB38*/
@RF00779 BAL   @14,RPTPRNTR                                        0781
*       LASTRK=CHARZERO;            /*                       @Y30LB38*/
         MVC   LASTRK(5),CHARZERO                                  0782
*     END;                          /*                       @Y30LB38*/
*                                                                  0783
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR HAS NOT OCCURED, SET RETURN CODE TO 0     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0784
*   IF RPTCCODE^=LASTCC12 THEN                                     0784
@RF00777 C     RPTCCODE,@CF00567                                   0784
         BE    @RF00784                                            0784
*     RPTCCODE=LASTCC00;            /*                       @Y30LB38*/
         SLR   RPTCCODE,RPTCCODE                                   0785
*   REG14=RETADDR2;                 /*                       @Y30LB38*/
@RF00784 L     REG14,RETADDR2                                      0786
*   RETURN CODE(RPTCCODE);          /*                       @Y30LB38*/
         LR    @15,RPTCCODE                                        0787
@EL00004 DS    0H                                                  0787
@EF00004 DS    0H                                                  0787
@ER00004 BR    @14                                                 0787
*   END RPTPROC;                    /*                       @Y30LB38*/
*                                                                  0789
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - MSFLOOK                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE COPIES THE MSC TABLES TO     @Y30LB38*/
*/*                THE WORK DATA SET AND INSPECTS THE        @Y30LB38*/
*/*                CONFIGURATION TABLE TO SEE IF THE         @Y30LB38*/
*/*                REQUESTED MSF EXISTS                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - FDTTBL AND WORK AREA CALLED INTTBL           @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0789
*MSFLOOK:                                                          0789
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0789
MSFLOOK  DS    0H                                                  0790
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0790
*   DCL                                                            0790
*     MSFCODE FIXED(15);            /* MSFLOOK RETURN CODE   @Y30LB38*/
*   DCL                                                            0791
*     ECB CHAR(1);                  /* ECB CODE FROM USSC    @Y30LB38*/
*   DCL                                                            0792
*     CARTWORK FIXED(8);            /* COMPUTED TRACK ADDR   @Y30LB38*/
*   DCL                                                            0793
*     CYLWORK FIXED(15);            /* COMPUTED CYL          @Y30LB38*/
*   DCL                                                            0794
*     ECBLEN FIXED(31) CONSTANT(4); /* LENGTH OF ECB         @Y30LB38*/
*   DCL                                                            0795
*     CONFIGNM FIXED(15) CONSTANT(16);/* NUMBER OF 8 BYTE    @Y30LB38
*                                      ENTRIES IN CONFIG     @Y30LB38
*                                      RECORD                @Y30LB38*/
*                                                                  0795
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE INDEXES FOR THE TABLE ENTRIES IN THE          @Y30LB38*/
*   /* MESSAGE RETURNED FROM USSC.                           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0796
*   DCL                                                            0796
*     CELINDEX FIXED(8) CONSTANT(9);/* CELL MAP INDEX        @Y30LB38*/
*   DCL                                                            0797
*     TRNINDEX FIXED(8) CONSTANT(5);/* TRAN VOL INDEX        @Y30LB38*/
*   DCL                                                            0798
*     VOLINDEX FIXED(8) CONSTANT(4);/* VOL INV INDEX         @Y30LB38*/
*   DCL                                                            0799
*     SCTINDEX FIXED(8) CONSTANT(3);/* SCRATCH CART INDEX    @Y30LB38*/
*   DCL                                                            0800
*     CONINDEX FIXED(8) CONSTANT(7);/* CONFIG MAP INDEX      @Y30LB38*/
*                                                                  0801
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0801
*   RETADDR1=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR1                                      0801
*   OLDERID2=NEWERID2;                                             0802
         L     @07,@PC00001                                        0802
         L     @15,GDTTR2(,@07)                                    0802
         MVC   @TS00001(95),NEWERID2(@15)                          0802
         MVC   OLDERID2(95,@15),@TS00001                           0802
*   NEWID2='LMEA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01588                              0803
*   MSFCODE=''B;                    /*                       @Y30LB38*/
*                                                                  0804
         SLR   MSFCODE,MSFCODE                                     0804
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE COPY TABLE PARM LIST FOR THE COPY      @Y30LB38*/
*   /* TABLE FUNCTION OF THE USSC MACRO.                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0805
*   COTBTID='80'X;                  /*                       @Y30LB38*/
         L     @15,COTPTR                                          0805
         NI    COTBTID(@15),B'10001111'                            0805
         OI    COTBTID(@15),B'10000000'                            0805
*   COTBEXTS(1:2)=SCYL;             /*                       @Y30LB38*/
         MVC   COTBEXTS(2,@15),SCYL                                0806
*   COTBEXTS(3:4)=ECYL;             /*                       @Y30LB38*/
         MVC   COTBEXTS+2(2,@15),ECYL                              0807
*   COTBVOL=WRKVOL;                 /*                       @Y30LB38*/
*                                                                  0808
         MVC   COTBVOL(6,@15),WRKVOL                               0808
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UDUMP MACRO TO TAKE SYMBOLIC DUMP OF        @Y30LB38*/
*   /* USSC PARM LIST                                        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0809
*   IF GDTDBG=NULLPTR THEN                                         0809
         L     @07,GDTDBG(,@07)                                    0809
         LTR   @07,@07                                             0809
         BZ    @RT00809                                            0809
*     ;                                                            0810
*   ELSE                                                           0811
*     DO;                                                          0811
*       DMPINDEX=ADDR(DMPSTG);      /*                       @Y30LB38*/
         LA    DMPINDEX,DMPSTG                                     0812
*       DMPITMNM='COTBLIST';                                       0813
         MVC   DMPITMNM(8,DMPINDEX),@CC01590                       0813
*       DMPITMPT=ADDR(COTBLIST);                                   0814
         L     @07,COTPTR                                          0814
         ST    @07,DMPITMPT(,DMPINDEX)                             0814
*       DMPITMLN=LENGTH(COTBLIST);                                 0815
         MVC   DMPITMLN(2,DMPINDEX),@CH00311                       0815
*       DMPITMTP='H';                                              0816
         MVI   DMPITMTP(DMPINDEX),C'H'                             0816
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0817
         AL    DMPINDEX,@CF00475                                   0817
*       DMPTRM=DMPTRMVL;                                           0818
         MVI   DMPTRM(DMPINDEX),X'FF'                              0818
*     END;                          /*                       @Y30LB38*/
*   IF GDTDBG=NULLPTR THEN                                         0820
@RT00809 L     @07,@PC00001                                        0820
         L     @07,GDTDBG(,@07)                                    0820
         LTR   @07,@07                                             0820
         BZ    @RT00820                                            0820
*     ;                                                            0821
*   ELSE                                                           0822
*     CALL IDCDB010(GDTTBL,'LMEB',ADDR(DMPSTG));/*           @Y30LB38*/
*                                                                  0822
         L     @07,@PC00001                                        0822
         ST    @07,@AL00001                                        0822
         LA    @15,@CC01591                                        0822
         ST    @15,@AL00001+4                                      0822
         LA    @15,DMPSTG                                          0822
         ST    @15,@AFTEMPS+4                                      0822
         LA    @15,@AFTEMPS+4                                      0822
         ST    @15,@AL00001+8                                      0822
         MVI   @AL00001+8,X'80'                                    0822
         L     @15,GDTDBG(,@07)                                    0822
         LA    @01,@AL00001                                        0822
         BALR  @14,@15                                             0822
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE COPY TABLE OPTION OF THE USSC MACRO TO      @Y30LB38*/
*   /* COPY THE DSM TABLES TO THE WORK DATA SET FOR GENERATING THE   */
*   /* REPORT(S) REQUIRED.                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0823
*   CALL IDCSASS0(GDTTBL,COPYTABL,COTPTR,REASONCD,ECB,CTMSGPTR);/* 0823
*                                                            @Y30LB38*/
@RT00820 L     @07,@PC00001                                        0823
         ST    @07,@AL00001                                        0823
         LA    @02,COPYTABL                                        0823
         ST    @02,@AL00001+4                                      0823
         LA    @02,COTPTR                                          0823
         ST    @02,@AL00001+8                                      0823
         LA    @02,REASONCD                                        0823
         ST    @02,@AL00001+12                                     0823
         LA    @02,ECB                                             0823
         ST    @02,@AL00001+16                                     0823
         LA    @02,CTMSGPTR                                        0823
         ST    @02,@AL00001+20                                     0823
         MVI   @AL00001+20,X'80'                                   0823
         L     @15,GDTSSC(,@07)                                    0823
         LA    @01,@AL00001                                        0823
         BALR  @14,@15                                             0823
*   RESPECIFY                                                      0824
*     RTNREG RSTD;                                                 0824
*   TESTRC=RTNREG;                                                 0825
         LR    TESTRC,RTNREG                                       0825
*   RESPECIFY                                                      0826
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*                                                                  0826
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST THE RETURN CODE FROM USSC. IF THE RETURN         @Y30LB38*/
*   /* CODE IS 04 CALL SSCMSG TO PRINT OUT MESSAGE TO EXPLAIN THE    */
*   /* ERROR. IF THE RETURN CODE IS 04 OR 08 ISSUE THE UPRINT MACRO  */
*   /* TO PRINT MESSAGE IDC3820I INDICATING THE TABLES COULD NOT BE  */
*   /* COPIED.                                               @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*   IF TESTRC=4 THEN                                               0827
         C     TESTRC,@CF00043                                     0827
         BNE   @RF00827                                            0827
*     CALL SSCMSG(REASONCD,ECB);    /*                       @ZM01071*/
         LA    @07,REASONCD                                        0828
         ST    @07,@AL00001                                        0828
         LA    @07,ECB                                             0828
         ST    @07,@AL00001+4                                      0828
         LA    @01,@AL00001                                        0828
         BAL   @14,SSCMSG                                          0828
*   IF TESTRC=4×TESTRC=8 THEN                                      0829
@RF00827 C     TESTRC,@CF00043                                     0829
         BE    @RT00829                                            0829
         C     TESTRC,@CF00180                                     0829
         BNE   @RF00829                                            0829
@RT00829 DS    0H                                                  0830
*     DO;                           /*                       @Y30LB38*/
*       MSFCODE=LASTCC12;           /*                       @Y30LB38*/
         LA    MSFCODE,12                                          0831
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0832
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         L     @07,DDSTRU                                          0833
         MVC   DARGSMOD(3,@07),@CC01483                            0833
*       DARGSENT=MSG3820I;          /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'01'                                 0834
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/
         L     @07,@PC00001                                        0835
         ST    @07,@AL00001                                        0835
         LA    @15,@CF00116                                        0835
         ST    @15,@AL00001+4                                      0835
         LA    @15,DDSTRU                                          0835
         ST    @15,@AL00001+8                                      0835
         MVI   @AL00001+8,X'80'                                    0835
         L     @15,GDTPRT(,@07)                                    0835
         LA    @01,@AL00001                                        0835
         BALR  @14,@15                                             0835
*     END;                          /*                       @Y30LB38*/
*                                                                  0836
*   /*****************************************************************/
*   /*                                                               */
*   /* THE RETURN CODE FROM USSC IS 0. RETREIVE THE          @Y30LB38*/
*   /* TRACK ADDRESS FROM THE MESSAGE AREA AND PLACE THEM IN THE     */
*   /* INTTBL WORK AREA.                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*   ELSE                                                           0837
*     DO;                           /*                       @Y30LB38*/
         B     @RC00829                                            0837
@RF00829 DS    0H                                                  0838
*       CTMSGPTR=CTMSGPTR+ECBLEN;   /*                       @Y30LB38*/
*                                                                  0838
         LA    @07,4                                               0838
         AL    @07,CTMSGPTR                                        0838
         ST    @07,CTMSGPTR                                        0838
*       /*************************************************************/
*       /*                                                           */
*       /* RETREIVE THE TRACK ADDRESS FOR THE CELL MAP       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0839
*       MAPCC=CTTBLCC(CELINDEX);    /*                       @Y30LB38*/
         MVC   MAPCC(1),CTTBLCC+32(@07)                            0839
*       MAPHH=CTTBLHH(CELINDEX);    /*                       @Y30LB38*/
         MVC   MAPHH(1),CTTBLHH+32(@07)                            0840
*       MAPRR=CTTBLRR(CELINDEX);    /*                       @Y30LB38*/
*                                                                  0841
         MVC   MAPRR(1),CTTBLRR+32(@07)                            0841
*       /*************************************************************/
*       /*                                                           */
*       /* RETREIVE THE TRACK ADDRESS FOR THE TRANSIENT      @Y30LB38*/
*       /* VOLUME RECORD                                     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0842
*       TRANCC=CTTBLCC(TRNINDEX);   /*                       @Y30LB38*/
         MVC   TRANCC(1),CTTBLCC+16(@07)                           0842
*       TRANHH=CTTBLHH(TRNINDEX);   /*                       @Y30LB38*/
         MVC   TRANHH(1),CTTBLHH+16(@07)                           0843
*       TRANRR=CTTBLRR(TRNINDEX);   /*                       @Y30LB38*/
*                                                                  0844
         MVC   TRANRR(1),CTTBLRR+16(@07)                           0844
*       /*************************************************************/
*       /*                                                           */
*       /* RETREIVE THE TRACK ADDRESS FOR THE VOLUME         @Y30LB38*/
*       /* INVENTORY RECORD                                  @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0845
*       VOLCC=CTTBLCC(VOLINDEX);    /*                       @Y30LB38*/
         MVC   VOLCC(1),CTTBLCC+12(@07)                            0845
*       VOLHH=CTTBLHH(VOLINDEX);    /*                       @Y30LB38*/
         MVC   VOLHH(1),CTTBLHH+12(@07)                            0846
*       VOLRR=CTTBLRR(VOLINDEX);    /*                       @Y30LB38*/
*                                                                  0847
         MVC   VOLRR(1),CTTBLRR+12(@07)                            0847
*       /*************************************************************/
*       /*                                                           */
*       /* RETREIVE THE TRACK ADDRESS FOR THE SCRATCH        @Y30LB38*/
*       /* CARTRIDGE RECORD                                  @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0848
*       CARTCC=CTTBLCC(SCTINDEX);   /*                       @Y30LB38*/
*                                                                  0848
         SLR   @03,@03                                             0848
         IC    @03,CTTBLCC+8(,@07)                                 0848
         STC   @03,CARTCC                                          0848
*       /*************************************************************/
*       /*                                                           */
*       /* THE SCRATCH CARTRIDGE TRACK ADDRESS MUST BE       @Y30LB38*/
*       /* INCREASED BY THE MSF NUMBER (MSFVAL). IF THIS INCREASES   */
*       /* THE TRACK NUMBER ABOVE 19 THE CYLINDER NUMBER MUST BE     */
*       /* INCREASED.                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0849
*       CARTWORK=CTTBLHH(SCTINDEX)+MSFVAL;/*                 @Y30LB38*/
         L     @15,@PC00001+4                                      0849
         L     @01,FDTPTR+28(,@15)                                 0849
         SLR   CARTWORK,CARTWORK                                   0849
         IC    CARTWORK,CTTBLHH+8(,@07)                            0849
         AL    CARTWORK,MSFVAL(,@01)                               0849
*       IF CARTWORK>CYLEND THEN                                    0850
         LA    @07,18                                              0850
         CR    CARTWORK,@07                                        0850
         BNH   @RF00850                                            0850
*         DO;                       /*                       @Y30LB38*/
*           CARTCC=CTTBLCC(SCTINDEX)+ONE;/*                  @Y30LB38*/
         AL    @03,@CF00220                                        0852
         STC   @03,CARTCC                                          0852
*           CARTWORK=CARTWORK-CYLEND;/*                      @Y30LB38*/
         SLR   CARTWORK,@07                                        0853
*         END;                      /*                       @Y30LB38*/
*       CARTHH=CARTWORK;            /*                       @Y30LB38*/
@RF00850 STC   CARTWORK,CARTHH                                     0855
*       CARTRR=CTTBLRR(SCTINDEX);   /*                       @Y30LB38*/
*                                                                  0856
         L     @07,CTMSGPTR                                        0856
         MVC   CARTRR(1),CTTBLRR+8(@07)                            0856
*       /*************************************************************/
*       /*                                                           */
*       /* RETREIVE THE TRACK ADDRESS FOR THE CONFIGURATION  @Y30LB38*/
*       /* MAP RECORD                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0857
*       CONCC=CTTBLCC(CONINDEX);    /*                       @Y30LB38*/
         MVC   CONCC(1),CTTBLCC+24(@07)                            0857
*       CONHH=CTTBLHH(CONINDEX);    /*                       @Y30LB38*/
         MVC   CONHH(1),CTTBLHH+24(@07)                            0858
*       CONRR=CTTBLRR(CONINDEX);    /*                       @Y30LB38*/
*                                                                  0859
         MVC   CONRR(1),CTTBLRR+24(@07)                            0859
*       /*************************************************************/
*       /*                                                           */
*       /* COMPUTE THE CYLINDER DIFFERENCE (ADDRDIF) FROM THE        */
*       /*                                                   @Y30LB38*/
*       /* ORIGINAL VOLUME TO THE WORK DATA SET VOLUME. THIS IS DONE */
*       /* BY SUBTRACTING THE FIRST CYLINDER VALUE OF THE FIRST ENTRY*/
*       /* FROM THE FEILD CTREALCC.                          @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0860
*       CYLWORK=CTREALCC-CTTBLCC(ONE);/*                     @Y30LB38*/
         SLR   CYLWORK,CYLWORK                                     0860
         ICM   CYLWORK,3,CTREALCC(@07)                             0860
         SLR   @03,@03                                             0860
         IC    @03,CTTBLCC(,@07)                                   0860
         SLR   CYLWORK,@03                                         0860
*       ADDRDIF=CYLWORK;            /*                       @Y30LB38*/
*                                                                  0861
         STH   CYLWORK,ADDRDIF                                     0861
*       /*************************************************************/
*       /*                                                           */
*       /* RESET THE MESSAGE POINTER TO POINT TO THE ECB AND @Y30LB38*/
*       /* ISSUE THE UFSPACE MACRO TO FREE UP THE MESSAGE AREA.      */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0862
*       CTMSGPTR=CTMSGPTR-ECBLEN;   /*                       @Y30LB38*/
         SL    @07,@CF00043                                        0862
         ST    @07,CTMSGPTR                                        0862
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/*                    @Y30LB38*/
         L     @07,@PC00001                                        0863
         ST    @07,@AL00001                                        0863
         LA    @15,CTMSGPTR                                        0863
         ST    @15,@AL00001+4                                      0863
         L     @15,GDTFSP(,@07)                                    0863
         LA    @01,@AL00001                                        0863
         BALR  @14,@15                                             0863
*       LASTRK=''B;                 /*                       @Y30LB38*/
         XC    LASTRK(5),LASTRK                                    0864
*     END;                          /*                       @Y30LB38*/
*                                                                  0865
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION IS NOT 12 AND THE USER SPECIFIED     @Y30LB38*/
*   /* A MSF NUMBER OTHER THAN ZERO, SET THE TBLID FIELD IN INTTBL   */
*   /* AND CALL TRKRDR TO READ THE CONFIGURATION TABLE.      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0866
*   IF MSFCODE^=LASTCC12&MSFVAL^=ZERO THEN                         0866
@RC00829 C     MSFCODE,@CF00567                                    0866
         BE    @RF00866                                            0866
         L     @07,@PC00001+4                                      0866
         L     @07,FDTPTR+28(,@07)                                 0866
         L     @07,MSFVAL(,@07)                                    0866
         LTR   @07,@07                                             0866
         BZ    @RF00866                                            0866
*     DO;                           /*                       @Y30LB38*/
*       TBLID=CONFIGID;             /*                       @Y30LB38*/
         MVI   TBLID,X'05'                                         0868
*       CALL TRKRDR;                /*                       @Y30LB38*/
         BAL   @14,TRKRDR                                          0869
*       RESPECIFY                                                  0870
*         RTNREG RSTD;                                             0870
*       TESTRC=RTNREG;                                             0871
         LR    TESTRC,RTNREG                                       0871
*       RESPECIFY                                                  0872
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC=LASTCC12 THEN                                    0873
         LA    @07,12                                              0873
         CR    TESTRC,@07                                          0873
         BNE   @RF00873                                            0873
*         MSFCODE=LASTCC12;         /*                       @Y30LB38*/
         LR    MSFCODE,@07                                         0874
*       LASTRK=''B;                 /*                       @Y30LB38*/
@RF00873 XC    LASTRK(5),LASTRK                                    0875
*     END;                          /*                       @Y30LB38*/
*                                                                  0876
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE IS NOT = 12, CHECK THE          @Y30LB38*/
*   /* CONFIGURATION TABLE ENTRIES TO VERIFY THAT THE SPECIFIED MSF  */
*   /* IS PRESENT.                                           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0877
*   BADMSF=ON;                      /*                       @Y30LB38*/
@RF00866 OI    BADMSF,B'10000000'                                  0877
*   IF MSFCODE^=LASTCC12&MSFVAL^=ZERO THEN                         0878
         C     MSFCODE,@CF00567                                    0878
         BE    @RF00878                                            0878
         L     @07,@PC00001+4                                      0878
         L     @07,FDTPTR+28(,@07)                                 0878
         L     @07,MSFVAL(,@07)                                    0878
         LTR   @07,@07                                             0878
         BZ    @RF00878                                            0878
*     DO;                           /*                       @Y30LB38*/
*       CONFPTR=TRKPTR;             /*                       @Y30LB38*/
         L     CONFPTR,TRKPTR                                      0880
*       DO I=1 BY 1 TO CONFIGNM WHILE BADMSF=ON;/*           @Y30LB38*/
         LA    I,1                                                 0881
@DL00881 TM    BADMSF,B'10000000'                                  0881
         BNO   @DC00881                                            0881
*         IF DATASTGR(I)=OFF THEN                                  0882
         LR    @03,I                                               0882
         SLA   @03,3                                               0882
         ST    @03,@TF00001                                        0882
         ALR   @03,CONFPTR                                         0882
         TM    DATASTGR-8(@03),B'10000000'                         0882
         BNZ   @RF00882                                            0882
*           DO;                     /*                       @Y30LB38*/
*             IF MSF1(I)=ON THEN                                   0884
         LR    @03,CONFPTR                                         0884
         AL    @03,@TF00001                                        0884
         TM    MSF1-8(@03),B'00000100'                             0884
         BNO   @RF00884                                            0884
*               IF MSFVAL=ONE THEN                                 0885
         L     @03,@PC00001+4                                      0885
         L     @03,FDTPTR+28(,@03)                                 0885
         CLC   MSFVAL(4,@03),@CF00220                              0885
         BNE   @RF00885                                            0885
*                 BADMSF=OFF;       /*                       @Y30LB38*/
         NI    BADMSF,B'01111111'                                  0886
*           END;                    /*                       @Y30LB38*/
@RF00885 DS    0H                                                  0887
@RF00884 DS    0H                                                  0888
*       END;                        /*                       @Y30LB38*/
*                                                                  0888
@RF00882 AL    I,@CF00220                                          0888
         C     I,@CF00475                                          0888
         BNH   @DL00881                                            0888
@DC00881 DS    0H                                                  0889
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE SPECIFIED MSF WAS NOT FOUND, WORKFLG1 WILL @Y30LB38*/
*       /* BE ON. IF SO, ISSUE UPRINT AND PRINT MESSAGE IDC3822I     */
*       /* INDICATING THE MSF IS NOT IN THE SYSTEM AND SET THE RETURN*/
*       /* CODE = 12.                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0889
*       IF BADMSF=ON THEN                                          0889
         TM    BADMSF,B'10000000'                                  0889
         BNO   @RF00889                                            0889
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 0891
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          0892
         MVC   DARGSMOD(3,@07),@CC01483                            0892
*           DARGSENT=MSG3822I;      /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'06'                                 0893
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        0894
         ST    @07,@AL00001                                        0894
         LA    @15,@CF00116                                        0894
         ST    @15,@AL00001+4                                      0894
         LA    @15,DDSTRU                                          0894
         ST    @15,@AL00001+8                                      0894
         MVI   @AL00001+8,X'80'                                    0894
         L     @15,GDTPRT(,@07)                                    0894
         LA    @01,@AL00001                                        0894
         BALR  @14,@15                                             0894
*           MSFCODE=LASTCC12;       /*                       @Y30LB38*/
         LA    MSFCODE,12                                          0895
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  0897
@RF00889 DS    0H                                                  0898
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN CODE AND RETURN TO CALLER              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0898
*   REG14=RETADDR1;                 /*                       @Y30LB38*/
@RF00878 L     REG14,RETADDR1                                      0898
*   RETURN CODE(MSFCODE);           /*                       @Y30LB38*/
         LR    @15,MSFCODE                                         0899
@EL00005 DS    0H                                                  0899
@EF00005 DS    0H                                                  0899
@ER00005 BR    @14                                                 0899
*   END MSFLOOK;                    /*                       @Y30LB38*/
*                                                                  0901
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - TRKRDR                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE READS A TRACK FROM THE       @Y30LB38*/
*/*                WORK DATA SET INTO THE TRACK BUFFER       @Y30LB38*/
*/*                AREA TRKBUFF                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREAS CALLED INTTBL AND TRKBUFF         @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - INTTBL, TRKBUFF AND RETURN CODE             @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = UNSUCCESSFUL COMPLETION                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0901
*TRKRDR:                                                           0901
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0901
TRKRDR   DS    0H                                                  0902
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0902
*   DCL                                                            0902
*     TRKCODE FIXED(15);            /* MSFLOOK RETURN CODE   @Y30LB38*/
*                                                                  0902
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE STRUCTURE FOR SEEK ADDRESS                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0903
*   DCL                                                            0903
*     1 CCHHR,                                                     0903
*      2 CC FIXED(15),                                             0903
*      2 HH FIXED(15),                                             0903
*      2 RR FIXED(8);               /*                       @Y30LB38*/
*   DCL                                                            0904
*     TRKADDR(5) CHAR(5) BASED(ADDR(INTTRKS));/*             @ZM00717*/
*                                                                  0905
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0905
*   RETADDR3=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR3                                      0905
*   OLDERID2=NEWERID2;                                             0906
         L     @15,@PC00001                                        0906
         L     @15,GDTTR2(,@15)                                    0906
         MVC   @TS00001(95),NEWERID2(@15)                          0906
         MVC   OLDERID2(95,@15),@TS00001                           0906
*   NEWID2='LMFA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01601                              0907
*   TRKCODE=''B;                    /*                       @Y30LB38*/
*                                                                  0908
         SLR   TRKCODE,TRKCODE                                     0908
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE LASTRK FIELD IN INTTBL = 0. IF YES,       @Y30LB38*/
*   /* THIS INDICATES A NEW REPORT IS BEING STARTED SO PICK UP THE   */
*   /* BEGINNING ADDRESS OF THE TABLE FROM THE ADDRESSES RETURNED BY */
*   /* COPY TABLE.                                           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0909
*   IF LASTRK=CHARZERO THEN                                        0909
         CLC   LASTRK(5),CHARZERO                                  0909
         BNE   @RF00909                                            0909
*     DO;                           /*                       @Y30LB38*/
*       LASTRK=TRKADDR(TBLID);      /*                       @Y30LB38*/
         SLR   @15,@15                                             0911
         IC    @15,TBLID                                           0911
         MH    @15,@CH00287                                        0911
         LA    @14,INTTRKS                                         0911
         ALR   @14,@15                                             0911
         AL    @14,@CF01847                                        0911
         MVC   LASTRK(5),TRKADDR(@14)                              0911
*     END;                          /*                       @Y30LB38*/
*                                                                  0912
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE NEXT-TRACK POINTER IN THE FIRST BLOCK     @Y30LB38*/
*   /* IN TRKBUFF = 0. IF YES, THIS INDICATES A VOLUME INVENTORY HASH*/
*   /* AREA AND THE LASTRK FIELD IS INCREASED BY ONE AND THE CYL     */
*   /* ADDRESS IS INCREASED IF NECESSARY. IF NOT THE HASH AREA, PICK */
*   /* UP THE NEXT TRACK POINTER IN THE FIRST BLOCK IN THE TRACK.    */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0913
*   ELSE                                                           0913
*     DO;                           /*                       @Y30LB38*/
         B     @RC00909                                            0913
@RF00909 DS    0H                                                  0914
*       BLOCKPTR=TRKPTR;            /*                       @Y30LB38*/
         L     @15,TRKPTR                                          0914
         ST    @15,BLOCKPTR                                        0914
*       IF TRACKPTR=CHARZERO(1:4) THEN                             0915
         CLC   TRACKPTR(4,@15),CHARZERO                            0915
         BNE   @RF00915                                            0915
*         DO;                       /*                       @Y30LB38*/
*           WORK2=H;                /*                       @Y30LB38*/
         SLR   WORK2,WORK2                                         0917
         ICM   WORK2,3,H                                           0917
*           WORK2=WORK2+ONE;        /*                       @Y30LB38*/
         LA    @03,1                                               0918
         ALR   WORK2,@03                                           0918
*           IF WORK2>CYLEND THEN                                   0919
         C     WORK2,@CF01463                                      0919
         BNH   @RF00919                                            0919
*             DO;                   /*                       @Y30LB38*/
*               WORK1=C;            /*                       @Y30LB38*/
         SLR   @02,@02                                             0921
         ICM   @02,3,C                                             0921
         ST    @02,WORK1                                           0921
*               C=WORK1+ONE;        /*                       @Y30LB38*/
         ALR   @02,@03                                             0922
         STCM  @02,3,C                                             0922
*               H=CHARZERO;         /*                       @ZM00981*/
         MVC   H(2),CHARZERO                                       0923
*             END;                  /*                       @Y30LB38*/
*           ELSE                                                   0925
*             H=WORK2;              /*                       @Y30LB38*/
         B     @RC00919                                            0925
@RF00919 STCM  WORK2,3,H                                           0925
*         END;                      /*                       @Y30LB38*/
*       ELSE                                                       0927
*         DO;                       /*                       @Y30LB38*/
         B     @RC00915                                            0927
@RF00915 DS    0H                                                  0928
*           LASTRK=''B;             /*                       @Y30LB38*/
         XC    LASTRK(5),LASTRK                                    0928
*           C=CYL;                  /*                       @Y30LB38*/
         L     @15,BLOCKPTR                                        0929
         SLR   @14,@14                                             0929
         IC    @14,CYL(,@15)                                       0929
         STCM  @14,3,C                                             0929
*           H=HEAD;                 /*                       @Y30LB38*/
         SLR   @14,@14                                             0930
         IC    @14,HEAD(,@15)                                      0930
         STCM  @14,3,H                                             0930
*           R=ONE;                  /*                       @Y30LB38*/
         MVI   R,X'01'                                             0931
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  0933
@RC00915 DS    0H                                                  0934
*   /*****************************************************************/
*   /*                                                               */
*   /* PREPARE THE UEXCP ARGUMENT LIST (EXGARG) AND          @Y30LB38*/
*   /* ISSUE THE UEXCP MACRO TO READ IN ONE TRACK OF DATA. FOR THE   */
*   /* CONFIGURATION MAP THIS WILL BE ONLY ONE RECORD AND FOR THE    */
*   /* CELL MAP IT WILL BE 10 RECORDS. FOR ALL THE REST, IT WILL BE  */
*   /* 32 RECORDS.                                           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0934
*   EXGCTLBK=WORKPTR;               /*                       @Y30LB38*/
@RC00909 L     @15,EXGPTR                                          0934
         L     @14,WORKPTR                                         0934
         ST    @14,EXGCTLBK(,@15)                                  0934
*   CCHHR=LASTRK;                   /*                       @Y30LB38*/
         MVC   CCHHR(5),LASTRK                                     0935
*   CC=C+ADDRDIF;                   /*                       @Y30LB38*/
         SLR   @14,@14                                             0936
         ICM   @14,3,C                                             0936
         LH    @03,ADDRDIF                                         0936
         N     @03,@CF01843                                        0936
         ALR   @14,@03                                             0936
         STH   @14,CC                                              0936
*   EXGCCHH1=ADDR(CCHHR);           /*                       @Y30LB38*/
         LA    @14,CCHHR                                           0937
         ST    @14,EXGCCHH1(,@15)                                  0937
*   EXGCCHH2=ADDR(LASTRK);          /*                       @Y30LB38*/
         LA    @14,LASTRK                                          0938
         ST    @14,EXGCCHH2(,@15)                                  0938
*   IF TBLID^=CELLID×TBLID^=CONFIGID THEN                          0939
         CLI   TBLID,1                                             0939
         BNE   @RT00939                                            0939
         CLI   TBLID,5                                             0939
         BE    @RF00939                                            0939
@RT00939 DS    0H                                                  0940
*     EXGRECNO=32;                  /*                       @Y30LB38*/
         L     @01,EXGPTR                                          0940
         MVC   EXGRECNO(4,@01),@CF00222                            0940
*   ELSE                                                           0941
*     DO;                           /*                       @Y30LB38*/
         B     @RC00939                                            0941
@RF00939 DS    0H                                                  0942
*       IF TBLID=CELLID THEN                                       0942
         CLI   TBLID,1                                             0942
         BNE   @RF00942                                            0942
*         EXGRECNO=TEN;             /*                       @Y30LB38*/
         L     @01,EXGPTR                                          0943
         MVC   EXGRECNO(4,@01),@CF00445                            0943
*       ELSE                                                       0944
*         EXGRECNO=ONE;             /*                       @Y30LB38*/
         B     @RC00942                                            0944
@RF00942 L     @01,EXGPTR                                          0944
         MVC   EXGRECNO(4,@01),@CF00220                            0944
*     END;                          /*                       @Y30LB38*/
@RC00942 DS    0H                                                  0946
*   EXGDATAP=ADDR(TRKBUFF);         /*                       @Y30LB38*/
@RC00939 L     @02,EXGPTR                                          0946
         L     @15,TRKPTR                                          0946
         ST    @15,EXGDATAP(,@02)                                  0946
*   EXGDATAL=RECSIZE;               /*                       @Y30LB38*/
*                                                                  0947
         MVC   EXGDATAL(2,@02),@CH01464                            0947
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UEXCP MACRO TO READ IN A TRACK OF DATA      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0948
*   CALL IDCIO050(GDTTBL,GET,EXGARG);/*                      @Y30LB38*/
         L     @15,@PC00001                                        0948
         ST    @15,@AL00001                                        0948
         LA    @14,GET                                             0948
         ST    @14,@AL00001+4                                      0948
         ST    @02,@AL00001+8                                      0948
         MVI   @AL00001+8,X'80'                                    0948
         L     @15,GDTEXP(,@15)                                    0948
         LA    @01,@AL00001                                        0948
         BALR  @14,@15                                             0948
*   RESPECIFY                                                      0949
*     RTNREG RSTD;                                                 0949
*   TESTRC=RTNREG;                                                 0950
         LR    TESTRC,RTNREG                                       0950
*   RESPECIFY                                                      0951
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*   IF TESTRC^=0 THEN                                              0952
         LTR   TESTRC,TESTRC                                       0952
         BZ    @RF00952                                            0952
*     TRKCODE=LASTCC12;             /*                       @Y30LB38*/
*                                                                  0953
         LA    TRKCODE,12                                          0953
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   REG14=RETADDR3;                 /*                       @Y30LB38*/
@RF00952 L     REG14,RETADDR3                                      0954
*   RETURN CODE(TRKCODE);           /*                       @Y30LB38*/
         LR    @15,TRKCODE                                         0955
@EL00006 DS    0H                                                  0955
@EF00006 DS    0H                                                  0955
@ER00006 BR    @14                                                 0955
*   END TRKRDR;                     /*                       @Y30LB38*/
*                                                                  0957
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - BLKPROC                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE SELECTS BLOCKS FROM TRACKS   @Y30LB38*/
*/*                AND PASSES THEM TO SUBORDINATE ROUTINES   @Y30LB38*/
*/*                TO PROCESS THE BLOCKS.  IT MAKES SURE     @Y30LB38*/
*/*                THAT THE BLOCKS ARE ACTIVE.   IT ALSO     @Y30LB38*/
*/*                TESTS FOR THE END-OF-TABLE CONDITIONS     @Y30LB38*/
*/*                AND SETS THE CONDITION CODE ACCORDINGLY.  @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED TRKBUFF AND THE INTTBL      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - SORTBLK AND RETURN CODE                     @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              8 = END OF TABLE FOUND                      @Y30LB38*/
*/*              12 = NO CORE FOR ENTRY SORTING              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  0957
*BLKPROC:                                                          0957
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  0957
BLKPROC  DS    0H                                                  0958
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0958
*   DCL                                                            0958
*     BLKCODE FIXED(15);            /* BLKPROC RETURN CODE@Y30LB38   */
*   DCL                                                            0959
*     BLKLENTH FIXED(31) CONSTANT(264);/* LEN OF REC BLK     @Y30LB38*/
*   DCL                                                            0960
*     RECNUM FIXED(15) CONSTANT(32);/* NUM RECS PER TRK      @Y30LB38*/
*                                                                  0961
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0961
*   RETADDR3=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR3                                      0961
*   OLDERID2=NEWERID2;                                             0962
         L     @15,@PC00001                                        0962
         L     @15,GDTTR2(,@15)                                    0962
         MVC   @TS00001(95),NEWERID2(@15)                          0962
         MVC   OLDERID2(95,@15),@TS00001                           0962
*   NEWID2='LMGA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01608                              0963
*   BLKCODE=''B;                    /*                       @Y30LB38*/
         SLR   @15,@15                                             0964
         LR    BLKCODE,@15                                         0964
*   I=''B;                          /*                       @Y30LB38*/
         LR    I,@15                                               0965
*   BLOCKPTR=TRKPTR;                /*                       @Y30LB38*/
*                                                                  0966
         L     @07,TRKPTR                                          0966
         ST    @07,BLOCKPTR                                        0966
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP DO LOOP TO LOOP THROUGH ALL 32 BLOCKS ON       @Y30LB38*/
*   /* A TRACK OR UNTIL THE CONDITION IS NON-ZERO INDICATING A SHORT */
*   /* TRACK OF END OF TABLE.                                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0967
*   DO I=1 BY 1 TO RECNUM WHILE BLKCODE=ZERO;/*              @Y30LB38*/
*                                                                  0967
         LA    I,1                                                 0967
@DL00967 LTR   BLKCODE,BLKCODE                                     0967
         BNZ   @DC00967                                            0967
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE NUMENT FIELD IS NON-ZERO INDICATING THAT     @Y30LB38*/
*     /* THERE ARE ACTIVE ENTRIES IN THE RECORD, CALL ITMEPROC TO    */
*     /* PROCESS THE RECORD BLOCK.                           @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0968
*     IF NUMENT^=ZERO THEN                                         0968
         L     @01,BLOCKPTR                                        0968
         CLI   NUMENT(@01),0                                       0968
         BE    @RF00968                                            0968
*       DO;                         /*                       @Y30LB38*/
*         CALL ITEMPROC;            /*                       @Y30LB38*/
         BAL   @14,ITEMPROC                                        0970
*         RESPECIFY                                                0971
*           RTNREG RSTD;                                           0971
*         TESTRC=RTNREG;                                           0972
         LR    TESTRC,RTNREG                                       0972
*         RESPECIFY                                                0973
*           RTNREG UNRSTD;          /*                       @Y30LB38*/
*         BLKCODE=TESTRC;           /*                       @Y30LB38*/
         LR    BLKCODE,TESTRC                                      0974
*       END;                        /*                       @Y30LB38*/
*                                                                  0975
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE RETURN CODE FROM ITEMPROC = 0 CONTINUE       @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0976
*     IF BLKCODE=LASTCC00 THEN                                     0976
@RF00968 LTR   BLKCODE,BLKCODE                                     0976
         BNZ   @RF00976                                            0976
*       DO;                         /*                       @Y30LB38*/
*                                                                  0977
*         /***********************************************************/
*         /*                                                         */
*         /* TEST THE CONTROL FLAGS TO DETERMINE IF END OF TRACK     */
*         /*                                                 @Y30LB38*/
*         /* OR END OF TABLE. IF END OF TRACK SET BLKCODE = 4. IF END*/
*         /* OF TABLE, WET BLOCK CODE = 8. FOR THE VOLUME INVENTORY  */
*         /* TABLE, THE OVERFLOW BIT WILL BE ON FOR THE END OF TRACK */
*         /* OR THE END OF THE TABLE. THE FOLLOWING TESTS DETERMINE  */
*         /* WHICH CONDITION IS TRUE.                        @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0978
*         IF TBLID=VOLINVID&OVERFLOW=ON THEN                       0978
         CLI   TBLID,3                                             0978
         BNE   @RF00978                                            0978
         L     @15,BLOCKPTR                                        0978
         TM    OVERFLOW(@15),B'00000001'                           0978
         BNO   @RF00978                                            0978
*           DO;                     /*                       @Y30LB38*/
*             IF BLKUSED=OFF THEN                                  0980
         TM    BLKUSED(@15),B'00001000'                            0980
         BNZ   @RF00980                                            0980
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/
         LA    BLKCODE,8                                           0981
*             IF LASTABLK=ON THEN                                  0982
@RF00980 L     @01,BLOCKPTR                                        0982
         TM    LASTABLK(@01),B'01000000'                           0982
         BNO   @RF00982                                            0982
*               BLKCODE=LASTCC04;   /*                       @Y30LB38*/
         LA    BLKCODE,4                                           0983
*             IF LASTABLK=ON&LASTTRK=ON THEN                       0984
@RF00982 L     @01,BLOCKPTR                                        0984
         TM    LASTABLK(@01),B'01010000'                           0984
         BNO   @RF00984                                            0984
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/
         LA    BLKCODE,8                                           0985
*           END;                    /*                       @Y30LB38*/
*                                                                  0986
@RF00984 DS    0H                                                  0987
*         /***********************************************************/
*         /*                                                         */
*         /* THE TABLE BEING PROCESSED IS NOT THE VOLUME INVENTORY SO*/
*         /* TEST FOR THE END OF TRACK OR THE END OF THE TABLE AND   */
*         /* SET THE BLKCODE ACCORDINGLY.                    @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0987
*         IF TBLID^=VOLINVID&(NUMENT=ZERO×LASTABLK=ON) THEN        0987
@RF00978 CLI   TBLID,3                                             0987
         BE    @RF00987                                            0987
         L     @15,BLOCKPTR                                        0987
         CLI   NUMENT(@15),0                                       0987
         BE    @RT00987                                            0987
         TM    LASTABLK(@15),B'01000000'                           0987
         BNO   @RF00987                                            0987
@RT00987 DS    0H                                                  0988
*           DO;                     /*                       @Y30LB38*/
*             BLKCODE=LASTCC04;     /*                       @Y30LB38*/
         LA    BLKCODE,4                                           0989
*             IF LASTTRK=ON THEN                                   0990
         L     @01,BLOCKPTR                                        0990
         TM    LASTTRK(@01),B'00010000'                            0990
         BNO   @RF00990                                            0990
*               BLKCODE=LASTCC08;   /*                       @Y30LB38*/
         LA    BLKCODE,8                                           0991
*           END;                    /*                       @Y30LB38*/
@RF00990 DS    0H                                                  0993
*         BLOCKPTR=BLOCKPTR+BLKLENTH;/*                      @Y30LB38*/
@RF00987 LA    @15,264                                             0993
         AL    @15,BLOCKPTR                                        0993
         ST    @15,BLOCKPTR                                        0993
*       END;                        /*                       @Y30LB38*/
*   END;                            /*                       @Y30LB38*/
*                                                                  0995
@RF00976 AL    I,@CF00220                                          0995
         C     I,@CF00222                                          0995
         BNH   @DL00967                                            0995
@DC00967 DS    0H                                                  0996
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RETURN CODE AND RESTORE RETURN ADDRESS AND        @Y30LB38*/
*   /* AND RETURN TO CALLER WITH ZERO RETURN CODE OR END OF TABLE    */
*   /* RETURN CODE OR AN ERROR RETURN CODE.                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0996
*   IF BLKCODE=LASTCC04 THEN                                       0996
         C     BLKCODE,@CF00043                                    0996
         BNE   @RF00996                                            0996
*     BLKCODE=LASTCC00;             /*                       @Y30LB38*/
         SLR   BLKCODE,BLKCODE                                     0997
*   REG14=RETADDR3;                 /*                       @Y30LB38*/
@RF00996 L     REG14,RETADDR3                                      0998
*   RETURN CODE(BLKCODE);           /*                       @Y30LB38*/
         LR    @15,BLKCODE                                         0999
@EL00007 DS    0H                                                  0999
@EF00007 DS    0H                                                  0999
@ER00007 BR    @14                                                 0999
*   END BLKPROC;                    /*                       @Y30LB38*/
*                                                                  1001
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - ITEMPROC                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE PASSES THE ENTRIES FROM A    @Y30LB38*/
*/*                BLOCK TO ROUTINES THAT PLACE THE ENTRIES  @Y30LB38*/
*/*                IN SORTED SEQUENCE.  THE INPUT IS A       @Y30LB38*/
*/*                POINTER TO THE BEGINNING OF THE BLOCK TO  @Y30LB38*/
*/*                BE PROCESSED.                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREAS CALLED TRKBUFF, INTTBL AND THE    @Y30LB38*/
*/*             FDTTBL                                       @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - INTTBL AND RETURN CODE                      @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = NO CORE FOR MERGE                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1001
*ITEMPROC:                                                         1001
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1001
ITEMPROC DS    0H                                                  1002
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1002
*   DCL                                                            1002
*     ITEMCODE FIXED(15);           /* ITEMPROC RETN CODE    @Y30LB38*/
*                                                                  1003
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1003
*   RETADDR4=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR4                                      1003
*   OLDERID2=NEWERID2;                                             1004
         L     @15,@PC00001                                        1004
         L     @15,GDTTR2(,@15)                                    1004
         MVC   @TS00001(95),NEWERID2(@15)                          1004
         MVC   OLDERID2(95,@15),@TS00001                           1004
*   NEWID2='LMHA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01614                              1005
*   ITEMCODE=''B;                   /*                       @Y30LB38*/
*                                                                  1006
         SLR   ITEMCODE,ITEMCODE                                   1006
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESS TO FIRST ENTRY IN BLOCK. SET UP A         @Y30LB38*/
*   /* DO LOOP TO PROCESS THE CORRECT NUMBER OF ENTRIES (NUMENT) PER */
*   /* BLOCK. INCREASE THE ENTRY POINTER BY THE ENTRY LENGTH(ENTLEN).*/
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1007
*   ENTPTR=ADDR(ENTRYY);            /*                       @Y30LB38*/
         L     @01,BLOCKPTR                                        1007
         LA    @15,ENTRYY(,@01)                                    1007
         ST    @15,ENTPTR                                          1007
*   DO I6=1 BY 1 TO NUMENT;         /*                       @Y30LB38*/
*                                                                  1008
         LA    @15,1                                               1008
         STH   @15,I6                                              1008
         B     @DE01008                                            1008
@DL01008 DS    0H                                                  1009
*     /***************************************************************/
*     /*                                                             */
*     /* TEST IF THIS IS A VOLUME INVENTORY ENTRY. IF YES,   @Y30LB38*/
*     /* TEST IF THE MSF NUMBER IN THE FDTTBL IS THE SAME AS THE MSF */
*     /* NUMBER IN THE ENTRY. IF YES, INCREASE VICNTR COUNTER IN THE */
*     /* INTTBL PARM LIST. IF MNT OR ALL ARE SPECIFIED IN THE FDTTBL */
*     /* CALL THE ITEMFMTR ROUTINE.                          @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1009
*     IF TBLID=VOLINVID THEN                                       1009
         CLI   TBLID,3                                             1009
         BNE   @RF01009                                            1009
*       DO;                         /*                       @Y30LB38*/
*                                                                  1010
*         /***********************************************************/
*         /*                                                         */
*         /* THE MSF NUMBER IN RECORD IS A 2 BIT FIELD. TEST @Y30LB38*/
*         /* EACH BIT TO SEE IF THE MSF NUMBER = 0 OR 1.     @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1011
*         IF(V1L2=ON&MSFVAL=ONE)×(V1L2=OFF&MSFVAL=ZERO) THEN       1011
         L     @01,ENTPTR                                          1011
         TM    V1L2(@01),B'01000000'                               1011
         BNO   @GL00034                                            1011
         L     @15,@PC00001+4                                      1011
         L     @01,FDTPTR+28(,@15)                                 1011
         CLC   MSFVAL(4,@01),@CF00220                              1011
         BE    @RT01011                                            1011
@GL00034 L     @01,ENTPTR                                          1011
         TM    V1L2(@01),B'01000000'                               1011
         BNZ   @RF01011                                            1011
         L     @15,@PC00001+4                                      1011
         L     @01,FDTPTR+28(,@15)                                 1011
         L     @15,MSFVAL(,@01)                                    1011
         LTR   @15,@15                                             1011
         BNZ   @RF01011                                            1011
@RT01011 DS    0H                                                  1012
*           DO;                     /*                       @Y30LB38*/
*             VICNTR=VICNTR+ONE;    /*                       @Y30LB38*/
*                                                                  1013
         LA    @15,1                                               1013
         AL    @15,VICNTR                                          1013
         ST    @15,VICNTR                                          1013
*             /*******************************************************/
*             /*                                                     */
*             /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF   */
*             /*                                             @Y30LB38*/
*             /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE,   */
*             /* CALL ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO   */
*             /* THE FIELD IN INTTBL CALLED NEWENT.          @Y30LB38*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1014
*             IF ADDR(MNT)^=NULLPTR×ADDR(AL)^=NULLPTR THEN         1014
         SLR   @15,@15                                             1014
         L     @14,@PC00001+4                                      1014
         C     @15,FDTPTR+8(,@14)                                  1014
         BNE   @RT01014                                            1014
         C     @15,FDTPTR+24(,@14)                                 1014
         BE    @RF01014                                            1014
@RT01014 DS    0H                                                  1015
*               DO;                 /*                       @Y30LB38*/
*                 CALL ITEMFMTR;    /*                       @Y30LB38*/
         BAL   @14,ITEMFMTR                                        1016
*                 RESPECIFY                                        1017
*                   RTNREG RSTD;                                   1017
*                 TESTRC=RTNREG;                                   1018
         LR    TESTRC,RTNREG                                       1018
*                 RESPECIFY                                        1019
*                   RTNREG UNRSTD;  /*                       @Y30LB38*/
*                 ITEMCODE=TESTRC;  /*                       @Y30LB38*/
         LR    ITEMCODE,TESTRC                                     1020
*               END;                /*                       @Y30LB38*/
*           END;                    /*                       @Y30LB38*/
@RF01014 DS    0H                                                  1023
*       END;                        /*                       @Y30LB38*/
*                                                                  1023
@RF01011 DS    0H                                                  1024
*     /***************************************************************/
*     /*                                                             */
*     /* TEST IF THIS IS A TRANSIENT VOLUME ENTRY. IF YES,   @Y30LB38*/
*     /* TEST IF THE MSF NUMBER IN THE FDTTBL IS THE SAME AS THE MSF */
*     /* NUMBER IN THE ENTRY. IF YES, INCREASE TVCNTR COUNTER IN THE */
*     /* INTTBL PARM LIST. IF NMNT OR ALL ARE SPECIFIED IN THE FDTTBL*/
*     /* CALL THE ITEMFMTR ROUTINE.                          @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1024
*     IF TBLID=TRANID THEN                                         1024
@RF01009 CLI   TBLID,2                                             1024
         BNE   @RF01024                                            1024
*       DO;                         /*                       @Y30LB38*/
*                                                                  1025
*         /***********************************************************/
*         /*                                                         */
*         /* THE MSF NUMBER IN RECORD IS A 2 BIT FIELD. TEST @Y30LB38*/
*         /* EACH BIT TO SEE IF THE MSF NUMBER = 0 OR 1.     @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1026
*         IF(T1L2=ON&MSFVAL=ONE)×(T1L2=OFF&MSFVAL=ZERO) THEN       1026
         L     @01,ENTPTR                                          1026
         TM    T1L2(@01),B'01000000'                               1026
         BNO   @GL00038                                            1026
         L     @15,@PC00001+4                                      1026
         L     @01,FDTPTR+28(,@15)                                 1026
         CLC   MSFVAL(4,@01),@CF00220                              1026
         BE    @RT01026                                            1026
@GL00038 L     @01,ENTPTR                                          1026
         TM    T1L2(@01),B'01000000'                               1026
         BNZ   @RF01026                                            1026
         L     @15,@PC00001+4                                      1026
         L     @01,FDTPTR+28(,@15)                                 1026
         L     @15,MSFVAL(,@01)                                    1026
         LTR   @15,@15                                             1026
         BNZ   @RF01026                                            1026
@RT01026 DS    0H                                                  1027
*           DO;                     /*                       @Y30LB38*/
*             TVCNTR=TVCNTR+ONE;    /*                       @Y30LB38*/
*                                                                  1028
         LA    @15,1                                               1028
         AL    @15,TVCNTR                                          1028
         ST    @15,TVCNTR                                          1028
*             /*******************************************************/
*             /*                                                     */
*             /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF   */
*             /*                                             @Y30LB38*/
*             /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE,   */
*             /* CALL ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO   */
*             /* THE FIELD IN INTTBL CALLED NEWENT.          @Y30LB38*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1029
*             IF ADDR(NMNT)^=NULLPTR×ADDR(AL)^=NULLPTR THEN        1029
         SLR   @15,@15                                             1029
         L     @14,@PC00001+4                                      1029
         C     @15,FDTPTR+12(,@14)                                 1029
         BNE   @RT01029                                            1029
         C     @15,FDTPTR+24(,@14)                                 1029
         BE    @RF01029                                            1029
@RT01029 DS    0H                                                  1030
*               DO;                 /*                       @Y30LB38*/
*                 CALL ITEMFMTR;    /*                       @Y30LB38*/
         BAL   @14,ITEMFMTR                                        1031
*                 RESPECIFY                                        1032
*                   RTNREG RSTD;                                   1032
*                 TESTRC=RTNREG;                                   1033
         LR    TESTRC,RTNREG                                       1033
*                 RESPECIFY                                        1034
*                   RTNREG UNRSTD;  /*                       @Y30LB38*/
*                 ITEMCODE=TESTRC;  /*                       @Y30LB38*/
         LR    ITEMCODE,TESTRC                                     1035
*               END;                /*                       @Y30LB38*/
*           END;                    /*                       @Y30LB38*/
@RF01029 DS    0H                                                  1038
*       END;                        /*                       @Y30LB38*/
*                                                                  1038
@RF01026 DS    0H                                                  1039
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE ENTRY IS A SCRATCH CARTRIDGE LIST ADD 1 TO   @Y30LB38*/
*     /* THE SCCNTR COUNTER IN THE INTTBL PARM LIST. IF CART OR ALL  */
*     /* ARE SPECIFIED IN THE FDTTBL, CALL THE ITEMFMTR ROUTINE.     */
*     /*                                                     @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1039
*     IF TBLID=CARTID THEN                                         1039
@RF01024 CLI   TBLID,4                                             1039
         BNE   @RF01039                                            1039
*       DO;                         /*                       @Y30LB38*/
*         SCCNTR=SCCNTR+ONE;        /*                       @Y30LB38*/
*                                                                  1041
         LA    @15,1                                               1041
         AL    @15,SCCNTR                                          1041
         ST    @15,SCCNTR                                          1041
*         /***********************************************************/
*         /*                                                         */
*         /* THIS TEST IS TO ELIMINATE THE CALL TO ITEMFMTR IF       */
*         /*                                                 @Y30LB38*/
*         /* THE SUMMARY ONLY KEYWORD IS SPECIFIED. OTHERWISE, CALL  */
*         /* ITEMFMTR TO PLACE THE DATA FROM TRKBUFF INTO THE FIELD  */
*         /* IN INTTBL CALLED NEWENT.                        @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1042
*         IF ADDR(CART)^=NULLPTR×ADDR(AL)^=NULLPTR THEN            1042
         SLR   @15,@15                                             1042
         L     @14,@PC00001+4                                      1042
         C     @15,FDTPTR+16(,@14)                                 1042
         BNE   @RT01042                                            1042
         C     @15,FDTPTR+24(,@14)                                 1042
         BE    @RF01042                                            1042
@RT01042 DS    0H                                                  1043
*           DO;                     /*                       @Y30LB38*/
*             CALL ITEMFMTR;        /*                       @Y30LB38*/
         BAL   @14,ITEMFMTR                                        1044
*             RESPECIFY                                            1045
*               RTNREG RSTD;                                       1045
*             TESTRC=RTNREG;                                       1046
         LR    TESTRC,RTNREG                                       1046
*             RESPECIFY                                            1047
*               RTNREG UNRSTD;      /*                       @Y30LB38*/
*             ITEMCODE=TESTRC;      /*                       @Y30LB38*/
         LR    ITEMCODE,TESTRC                                     1048
*           END;                    /*                       @Y30LB38*/
*       END;                        /*                       @Y30LB38*/
@RF01042 DS    0H                                                  1051
*     ENTPTR=ENTPTR+ENTLEN;         /*                       @Y30LB38*/
@RF01039 L     @01,BLOCKPTR                                        1051
         SLR   @00,@00                                             1051
         IC    @00,ENTLEN(,@01)                                    1051
         AL    @00,ENTPTR                                          1051
         ST    @00,ENTPTR                                          1051
*   END;                            /*                       @Y30LB38*/
*                                                                  1052
         LA    @15,1                                               1052
         AH    @15,I6                                              1052
         STH   @15,I6                                              1052
@DE01008 L     @14,BLOCKPTR                                        1052
         SLR   @03,@03                                             1052
         IC    @03,NUMENT(,@14)                                    1052
         CR    @15,@03                                             1052
         BNH   @DL01008                                            1052
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1053
*   REG14=RETADDR4;                 /*                       @Y30LB38*/
         L     REG14,RETADDR4                                      1053
*   RETURN CODE(ITEMCODE);          /*                       @Y30LB38*/
         LR    @15,ITEMCODE                                        1054
@EL00008 DS    0H                                                  1054
@EF00008 DS    0H                                                  1054
@ER00008 BR    @14                                                 1054
*   END ITEMPROC;                   /*                       @Y30LB38*/
*                                                                  1056
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - ITEMFMTR                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE REFORMATS A BLOCK ENTRY      @Y30LB38*/
*/*                AND CALLS ON SUBPROCEDURES TO SORT IT     @Y30LB38*/
*/*                INTO THE CORE BLOCKS.                     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED TRKBUFF AND THE INTTBL      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - REFORMATED ENTRY PLACED IN NEWENT AND       @Y30LB38*/
*/*              RETURN CODE                                 @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1056
*ITEMFMTR:                                                         1056
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1056
ITEMFMTR DS    0H                                                  1057
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1057
*   DCL                                                            1057
*     FMTRCODE FIXED(15);           /* ITEMFMTR RETN CODE    @Y30LB38*/
*                                                                  1057
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE DSECT FOR MAPPING THE TRANSIENT VOLUME        @Y30LB38*/
*   /* DATA IN THE FIELD NEWENT.                             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1058
*   DCL                                                            1058
*     1 TVNEWENT DEF(NEWENT),       /*                       @Y30LB38*/
*       3 TVVOLSN CHAR(6),          /* VOL SER NUMBER        @Y30LB38*/
*       3 TVCARTSN CHAR(12),        /* CART SER NUMBER       @Y30LB38*/
*       3 TVCART1 CHAR(2),          /* CART 1 LOCATION       @Y30LB38*/
*       3 TVCART2 CHAR(2),          /* CART 2 LOCATION       @Y30LB38*/
*       3 TVFLAGS CHAR(1),          /* ATTRIBUTE FLAGS       @Y30LB38*/
*       3 * CHAR(1);                /*                       @Y30LB38*/
*                                                                  1058
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE DSECT FOR MAPPING THE SCRATCH CARTRIDGE       @Y30LB38*/
*   /* DATA IN THE FIELD NEWENT.                             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1059
*   DCL                                                            1059
*     1 SCNEWENT DEF(NEWENT),       /*                       @Y30LB38*/
*       3 SCCARTSN CHAR(12),        /* CART SER NUMBER       @Y30LB38*/
*       3 SCCART1 CHAR(2),          /* CART LOCATION         @Y30LB38*/
*       3 * CHAR(10);               /*                       @Y30LB38*/
*                                                                  1060
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1060
*   RETADDR5=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR5                                      1060
*   OLDERID2=NEWERID2;                                             1061
         L     @15,@PC00001                                        1061
         L     @15,GDTTR2(,@15)                                    1061
         MVC   @TS00001(95),NEWERID2(@15)                          1061
         MVC   OLDERID2(95,@15),@TS00001                           1061
*   NEWID2='LMIA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@15),@CC01631                              1062
*   FMTRCODE=''B;                   /*                       @Y30LB38*/
*                                                                  1063
         SLR   FMTRCODE,FMTRCODE                                   1063
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID FIELD INDICATES A VOLUME INVENTORY       @Y30LB38*/
*   /* ENTRY, MOVE THE ENTIRE ENTRY INTO THE NEWENT FIELD IN INTTBL  */
*   /* PARM LIST.                                            @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1064
*   IF TBLID=VOLINVID THEN                                         1064
         CLI   TBLID,3                                             1064
         BNE   @RF01064                                            1064
*     NEWENT=INVENTRY;              /*                       @Y30LB38*/
*                                                                  1065
         MVI   NEWENT+12,C' '                                      1065
         MVC   NEWENT+13(11),NEWENT+12                             1065
         L     @06,ENTPTR                                          1065
         MVC   NEWENT(12),INVENTRY(@06)                            1065
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID FIELD INDICATES A TRANSIENT VOLUME       @Y30LB38*/
*   /* ENTRY, MOVE THE VOLID, THE CARTRIDGE SERIAL NUMBER THE CELL   */
*   /* LOCATIONS AND THE ATTRIBUTE FLAGS INTO THE NEWENT FIELD IN    */
*   /* INTTBL PARM LIST.                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1066
*   IF TBLID=TRANID THEN                                           1066
@RF01064 CLI   TBLID,2                                             1066
         BNE   @RF01066                                            1066
*     DO;                           /*                       @Y30LB38*/
*       TVVOLSN=TVOLSER;            /*                       @Y30LB38*/
         L     @06,ENTPTR                                          1068
         MVC   TVVOLSN(6),TVOLSER(@06)                             1068
*       TVCARTSN=TCARSNUM;          /*                       @Y30LB38*/
         MVC   TVCARTSN(12),TCARSNUM(@06)                          1069
*       TVCART1=TCARTONE;           /*                       @Y30LB38*/
         MVC   TVCART1(2),TCARTONE(@06)                            1070
*       TVCART2=TCARTTWO;           /*                       @Y30LB38*/
         MVC   TVCART2(2),TCARTTWO(@06)                            1071
*       TVFLAGS=TVOLFLGS;           /*                       @Y30LB38*/
         MVC   TVFLAGS(1),TVOLFLGS(@06)                            1072
*     END;                          /*                       @Y30LB38*/
*                                                                  1073
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID FIELD INDICATES A SCRATCH CARTRIDGE      @Y30LB38*/
*   /* LIST ENTRY, MOVE THE CARTRIDGE SERIAL NUMBER AND THE CELL     */
*   /* LOCATION INTO THE NEWENT FIELD IN INTTBL PARM LIST.   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1074
*   IF TBLID=CARTID THEN                                           1074
@RF01066 CLI   TBLID,4                                             1074
         BNE   @RF01074                                            1074
*     DO;                           /*                       @Y30LB38*/
*       SCCARTSN=SCARTNUM;          /*                       @Y30LB38*/
         L     @06,ENTPTR                                          1076
         MVC   SCCARTSN(12),SCARTNUM(@06)                          1076
*       SCCART1=SCARTONE;           /*                       @Y30LB38*/
         MVC   SCCART1(2),SCARTONE(@06)                            1077
*     END;                          /*                       @Y30LB38*/
*                                                                  1078
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL SORTDATA TO SORT THE ENTRIES IN THE SORTBLK      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1079
*   CALL SORTDATA;                  /*                       @Y30LB38*/
@RF01074 BAL   @14,SORTDATA                                        1079
*   RESPECIFY                                                      1080
*     RTNREG RSTD;                                                 1080
*   TESTRC=RTNREG;                                                 1081
         LR    TESTRC,RTNREG                                       1081
*   RESPECIFY                                                      1082
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*   FMTRCODE=TESTRC;                /*                       @Y30LB38*/
*                                                                  1083
         LR    FMTRCODE,TESTRC                                     1083
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1084
*   REG14=RETADDR5;                 /*                       @Y30LB38*/
         L     REG14,RETADDR5                                      1084
*   RETURN CODE(FMTRCODE);          /*                       @Y30LB38*/
         LR    @15,FMTRCODE                                        1085
@EL00009 DS    0H                                                  1085
@EF00009 DS    0H                                                  1085
@ER00009 BR    @14                                                 1085
*   END ITEMFMTR;                   /*                       @Y30LB38*/
*                                                                  1087
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - SORTDATA                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE PLACES AN ENTRY FROM         @Y30LB38*/
*/*                NEWENT IN INTTBL INTO SORTBLK.  IF THE    @Y30LB38*/
*/*                CORE CHAIN IS FULL, IT CALLS THE DATA     @Y30LB38*/
*/*                MERGER TO MERGE THE BLOCKS WITH THE MERGE @Y30LB38*/
*/*                BLOCKS ALREADY CREATED.                   @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED SORTBLK AND INTTBL          @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - SORTED ENTRIES IN SORTBLK AND RETURN CODE   @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1087
*SORTDATA:                                                         1087
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1087
SORTDATA DS    0H                                                  1088
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1088
*   DCL                                                            1088
*     SORTCODE FIXED(15);           /* SORTDATA RETURN CODE@Y30LB38  */
*   DCL                                                            1089
*     NEWFPTR PTR(31);              /* PTR TO NEXT ENTRY     @Y30LB38*/
*   DCL                                                            1090
*     NEWBPTR PTR(31);              /* PTR TO PREVIOUS ENT@Y30LB38   */
*   DCL                                                            1091
*     NEWPTR PTR(31);               /* PTR TO NEW ENTRY      @Y30LB38*/
*                                                                  1092
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1092
*   RETADDR6=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR6                                      1092
*   OLDERID2=NEWERID2;                                             1093
         L     @02,@PC00001                                        1093
         L     @02,GDTTR2(,@02)                                    1093
         MVC   @TS00001(95),NEWERID2(@02)                          1093
         MVC   OLDERID2(95,@02),@TS00001                           1093
*   NEWID2='LMJA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@02),@CC01640                              1094
*   SORTCODE=''B;                   /*                       @Y30LB38*/
*                                                                  1095
         SLR   @02,@02                                             1095
         STH   @02,SORTCODE                                        1095
*   /*****************************************************************/
*   /*                                                               */
*   /* GET POINTER TO LOWEST ENTRY IN THE SORTBLK AND THE    @Y30LB38*/
*   /* LENGTH OF AN ENTRY                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1096
*   CURPTR=SORTENT;                 /*                       @Y30LB38*/
         L     @15,SORTPTR                                         1096
         L     CURPTR,SORTENT(,@15)                                1096
*   NEWPTR=ADDR(SORTUNIT)+SORTCNT*(ITEMLEN+LENGTH(SORTPTRS));      1097
*                                                                  1097
         LA    NEWPTR,SORTUNIT(,@15)                               1097
         LH    @02,SORTCNT(,@15)                                   1097
         LA    @14,8                                               1097
         SLR   @01,@01                                             1097
         IC    @01,ITEMLEN                                         1097
         ALR   @14,@01                                             1097
         LR    @01,@14                                             1097
         MR    @00,@02                                             1097
         ALR   NEWPTR,@01                                          1097
*   /*****************************************************************/
*   /*                                                               */
*   /* BEFORE COMPARING THE NEW ENTRY WITH THE NEW ENTRIES   @Y30LB38*/
*   /* IN THE SORTBLK, CHECK IF THIS IS THE FIRST ENTRY      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1098
*   IF SORTCNT=ZERO THEN                                           1098
         SLR   @14,@14                                             1098
         CR    @02,@14                                             1098
         BNE   @RF01098                                            1098
*     DO;                           /*                       @Y30LB38*/
*                                                                  1099
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE NEW FORWARD AND BACKWARD POINTERS TO 0. SET       */
*       /*                                                   @Y30LB38*/
*       /* SORTENT TO THE ADDRESS OF THE NEW ENTRY           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1100
*       NEWFPTR=NULLPTR;            /*                       @Y30LB38*/
         ST    @14,NEWFPTR                                         1100
*       NEWBPTR=NULLPTR;            /*                       @Y30LB38*/
         LR    NEWBPTR,@14                                         1101
*       SORTENT=NEWPTR;             /*                       @Y30LB38*/
         ST    NEWPTR,SORTENT(,@15)                                1102
*     END;                          /*                       @Y30LB38*/
*   ELSE                                                           1104
*     DO;                           /*                       @Y30LB38*/
*                                                                  1104
         B     @RC01098                                            1104
@RF01098 DS    0H                                                  1105
*       /*************************************************************/
*       /*                                                           */
*       /* IF THIS WILL NOT BE THE FIRST ENTRY, COMPARE WITH @Y30LB38*/
*       /* EACH ENTRY IN THE SORTBLK WITH THE NEW ENTRY UNTIL ALL THE*/
*       /* ENTRIES HAVE BEEN COMPARED OR THE NEW ENTRY IS LOWER THAN */
*       /* THE SORTBLK ENTRY.                                @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1105
*       DO I8=ONE BY ONE TO SORTCNT WHILE SRTITEM(1:KEYLEN)<=NEWENT(1:
*             KEYLEN);              /*                       @ZA08859*/
         LA    I8,1                                                1105
         B     @DE01105                                            1105
@DL01105 SLR   @15,@15                                             1105
         IC    @15,KEYLEN                                          1105
         BCTR  @15,0                                               1105
         EX    @15,@SC01848                                        1105
         BH    @DC01105                                            1105
*         IF SRTFPTR>NULLPTR THEN                                  1106
*                                                                  1106
         L     @15,SRTFPTR(,CURPTR)                                1106
         LTR   @15,@15                                             1106
         BNP   @RF01106                                            1106
*           /*********************************************************/
*           /*                                                       */
*           /* SET CURRENT POINTER TO THE NEXT LOWEST ENTRY  @Y30LB38*/
*           /* UNLESS LAST ENTRY ALREADY.                    @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1107
*           CURPTR=SRTFPTR;         /*                       @Y30LB38*/
         LR    CURPTR,@15                                          1107
*       END;                        /*                       @Y30LB38*/
*                                                                  1108
@RF01106 AL    I8,@CF00220                                         1108
@DE01105 L     @01,SORTPTR                                         1108
         CH    I8,SORTCNT(,@01)                                    1108
         BNH   @DL01105                                            1108
@DC01105 DS    0H                                                  1109
*       /*************************************************************/
*       /*                                                           */
*       /* IF ALL THE ENTRIES IN SORTBLK HAVE BEEN PROCESSED,        */
*       /*                                                   @Y30LB38*/
*       /* NEW ENTRY IS GREATER THAN ALL THE ENTRIES IN THE BLOCK AND*/
*       /* MUST BE PLACED AT THE END.                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1109
*       IF I8>SORTCNT THEN                                         1109
         L     @01,SORTPTR                                         1109
         CH    I8,SORTCNT(,@01)                                    1109
         BNH   @RF01109                                            1109
*         DO;                       /*                       @Y30LB38*/
*                                                                  1110
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE NEW FORWARD POINTER TO 0 AND THE BACKWARD     */
*           /*                                               @Y30LB38*/
*           /* POINTER TO THE LAST ENTRY LOOKED AT IN SORTBLK.       */
*           /*                                               @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1111
*           NEWFPTR=NULLPTR;        /*                       @Y30LB38*/
         SLR   @15,@15                                             1111
         ST    @15,NEWFPTR                                         1111
*           NEWBPTR=CURPTR;         /*                       @Y30LB38*/
         LR    NEWBPTR,CURPTR                                      1112
*           SRTFPTR=NEWPTR;         /*                       @Y30LB38*/
         ST    NEWPTR,SRTFPTR(,CURPTR)                             1113
*         END;                      /*                       @Y30LB38*/
*                                                                  1114
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE NEW ENTRY WILL BE THE LOWEST ONE IN SORTBLK        */
*       /*                                                   @Y30LB38*/
*       /* CURRENT PTR POINTS TO THE NEXT HIGHER ENTRY.      @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1115
*       ELSE                                                       1115
*         DO;                       /*                       @Y30LB38*/
         B     @RC01109                                            1115
@RF01109 DS    0H                                                  1116
*           NEWFPTR=CURPTR;         /*                       @Y30LB38*/
         ST    CURPTR,NEWFPTR                                      1116
*           NEWBPTR=SRTBPTR;        /*                       @Y30LB38*/
*                                                                  1117
         L     NEWBPTR,SRTBPTR(,CURPTR)                            1117
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE NEW ENTRY IS THE LOWEST ENTRY IN THE SORTBLK,  */
*           /*                                               @Y30LB38*/
*           /* THE POINTER IN THE SORTBLK POINTS AT THE NEW ENTRY    */
*           /*                                               @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1118
*           IF NEWBPTR=NULLPTR THEN                                1118
         LTR   NEWBPTR,NEWBPTR                                     1118
         BNZ   @RF01118                                            1118
*             SORTENT=NEWPTR;       /*                       @Y30LB38*/
         L     @01,SORTPTR                                         1119
         ST    NEWPTR,SORTENT(,@01)                                1119
*           ELSE                                                   1120
*             SRTBPTR->SRTFPTR=NEWPTR;/*                     @Y30LB38*/
         B     @RC01118                                            1120
@RF01118 L     @01,SRTBPTR(,CURPTR)                                1120
         ST    NEWPTR,SRTFPTR(,@01)                                1120
*           SRTBPTR=NEWPTR;         /*                       @Y30LB38*/
@RC01118 ST    NEWPTR,SRTBPTR(,CURPTR)                             1121
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1123
@RC01109 DS    0H                                                  1124
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE NEW ENTRY INTO THE SORTBLK                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1124
*   CURPTR=NEWPTR;                  /*                       @Y30LB38*/
@RC01098 LR    CURPTR,NEWPTR                                       1124
*   SRTFPTR=NEWFPTR;                /*                       @Y30LB38*/
         L     @06,NEWFPTR                                         1125
         ST    @06,SRTFPTR(,CURPTR)                                1125
*   SRTBPTR=NEWBPTR;                /*                       @Y30LB38*/
         ST    NEWBPTR,SRTBPTR(,CURPTR)                            1126
*   SRTITEM(1:ITEMLEN)=NEWENT;      /*                       @Y30LB38*/
*                                                                  1127
         SLR   @06,@06                                             1127
         IC    @06,ITEMLEN                                         1127
         BCTR  @06,0                                               1127
         EX    @06,@SM01850                                        1127
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT THE SORT COUNT                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1128
*   SORTCNT=SORTCNT+ONE;            /*                       @Y30LB38*/
*                                                                  1128
         L     @06,SORTPTR                                         1128
         LA    @15,1                                               1128
         AH    @15,SORTCNT(,@06)                                   1128
         STH   @15,SORTCNT(,@06)                                   1128
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE SORTBLK IS FULL. THIS IS DONE BY          @Y30LB38*/
*   /* TESTING THE SORTCNT FIELD AND THE BLKITEMS FIELD. IF YES, CALL*/
*   /* MRGDATA TO MERGE THE BLOCKS.                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1129
*   IF SORTCNT=BLKITEMS THEN                                       1129
         C     @15,BLKITEMS                                        1129
         BNE   @RF01129                                            1129
*     DO;                           /*                       @Y30LB38*/
*       CALL MRGDATA;               /*                       @Y30LB38*/
         BAL   @14,MRGDATA                                         1131
*       RESPECIFY                                                  1132
*         RTNREG RSTD;                                             1132
*       TESTRC=RTNREG;                                             1133
         LR    TESTRC,RTNREG                                       1133
*       RESPECIFY                                                  1134
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       SORTCODE=TESTRC;            /*                       @Y30LB38*/
         STH   TESTRC,SORTCODE                                     1135
*     END;                          /*                       @Y30LB38*/
*                                                                  1136
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1137
*   REG14=RETADDR6;                 /*                       @Y30LB38*/
@RF01129 L     REG14,RETADDR6                                      1137
*   RETURN CODE(SORTCODE);          /*                       @Y30LB38*/
         LH    @15,SORTCODE                                        1138
@EL00010 DS    0H                                                  1138
@EF00010 DS    0H                                                  1138
@ER00010 BR    @14                                                 1138
*   END SORTDATA;                   /*                       @Y30LB38*/
*                                                                  1140
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - MRGDATA                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE ESTABLISHES POINTERS TO      @Y30LB38*/
*/*                MERGE BLOCKS THAT ARE TO BE USED AS THE   @Y30LB38*/
*/*                INPUT AND OUTPUT BLOCKS FOR THE MERGE     @Y30LB38*/
*/*                THAT IS PERFORMED IN MRGLOOP ROUTINE.  IT @Y30LB38*/
*/*                USES UGPOOL, UFPOOL AND UFSPACE TO GET    @Y30LB38*/
*/*                THE OUTPUT BLOCK AND FREE THE INPUT MERGE @Y30LB38*/
*/*                BLOCK.  THIS ROUTINE COVERS THE CONDITIONS@Y30LB38*/
*/*                WHERE THE SORTBLK IS THE ONLY INPUT TO    @Y30LB38*/
*/*                THE MERGE PROCESS AND WHERE THE SORTBLK   @Y30LB38*/
*/*                AND ANOTHER MERGE BLOCK ARE INPUT TO THE  @Y30LB38*/
*/*                MERGE PROCESS.                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - ENTRY PLACED IN MRGBLK AND                  @Y30LB38*/
*/*              RETURN CODE                                 @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = NO CORE FOR ENTRY MERGE                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1140
*MRGDATA:                                                          1140
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1140
MRGDATA  DS    0H                                                  1141
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*   DCL                                                            1141
*     MRGCODE FIXED(15);            /* MRGDATA RETURN CODE   @Y30LB38*/
*   DCL                                                            1142
*     MRGADDR PTR(31);              /* MERGE BLK ADDRESS     @Y30LB38*/
*   DCL                                                            1143
*     MRGCNTR FIXED(31);            /* MERGE COUNT           @Y30LB38*/
*   DCL                                                            1144
*     MRGPOOL FIXED(31);            /* SIZE OF MRG POOL      @Y30LB38*/
*   DCL                                                            1145
*     BLKSIZE FIXED(31) CONSTANT(2048);/* SIZE OF MRGBLK     @Y30LB38*/
*                                                                  1146
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   RETADDR7=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR7                                      1146
*   OLDERID2=NEWERID2;                                             1147
         L     @06,@PC00001                                        1147
         L     @06,GDTTR2(,@06)                                    1147
         MVC   @TS00001(95),NEWERID2(@06)                          1147
         MVC   OLDERID2(95,@06),@TS00001                           1147
*   NEWID2='LMKA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@06),@CC01650                              1148
*   MRGCODE=''B;                    /*                       @Y30LB38*/
         SLR   @06,@06                                             1149
         STH   @06,MRGCODE                                         1149
*   MRGADDR=''B;                    /*                       @Y30LB38*/
         ST    @06,MRGADDR                                         1150
*   MRGCNTR=''B;                    /*                       @Y30LB38*/
*                                                                  1151
         ST    @06,MRGCNTR                                         1151
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH THE 7 MRGBLK ADDRESSES TO DETERMINE      @Y30LB38*/
*   /* IF THERE IS ONE THAT CONTAINS ZERO. IF YES, ISSUE THE UGPOOL  */
*   /* MACRO TO OBTAIN A 2K BLOCK OF CORE.                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1152
*   DO I7=1 BY 1 TO 7 WHILE MRGBLKS(I7)^=NULLPTR;/*          @Y30LB38*/
         LA    @06,1                                               1152
         STH   @06,I7                                              1152
@DL01152 LR    @15,@06                                             1152
         SLA   @15,2                                               1152
         L     @15,MRGBLKS-4(@15)                                  1152
         LTR   @15,@15                                             1152
         BZ    @DC01152                                            1152
*   END;                            /*                       @Y30LB38*/
         AL    @06,@CF00220                                        1153
         STH   @06,I7                                              1153
         C     @06,@CF00659                                        1153
         BNH   @DL01152                                            1153
@DC01152 DS    0H                                                  1154
*   IF MRGBLKS(I7)=NULLPTR THEN                                    1154
         LH    @06,I7                                              1154
         LR    @15,@06                                             1154
         SLA   @15,2                                               1154
         L     @15,MRGBLKS-4(@15)                                  1154
         LTR   @15,@15                                             1154
         BNZ   @RF01154                                            1154
*     DO;                           /*                       @Y30LB38*/
*       I9=I7;                      /*                       @ZM00717*/
         STH   @06,I9                                              1156
*       MRGPOOL=BLKSIZE;            /*                       @Y30LB38*/
         MVC   MRGPOOL(4),@CF01649                                 1157
*       CALL IDCSAGP0(GDTTBL,MRGPOOL,RTNAREA,'LM01');/*      @Y30LB38*/
         L     @06,@PC00001                                        1158
         ST    @06,@AL00001                                        1158
         LA    @02,MRGPOOL                                         1158
         ST    @02,@AL00001+4                                      1158
         LA    @02,RTNAREA                                         1158
         ST    @02,@AL00001+8                                      1158
         LA    @02,@CC01491                                        1158
         ST    @02,@AL00001+12                                     1158
         MVI   @AL00001+12,X'80'                                   1158
         L     @15,GDTGPL(,@06)                                    1158
         LA    @01,@AL00001                                        1158
         BALR  @14,@15                                             1158
*       RESPECIFY                                                  1159
*         RTNREG RSTD;                                             1159
*       TESTRC=RTNREG;                                             1160
         LR    TESTRC,RTNREG                                       1160
*       RESPECIFY                                                  1161
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*                                                                  1161
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE FROM UGPOOL IS ^= 0 SET THE    @Y30LB38*/
*       /* CONDITION CODE = 12.                              @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1162
*       IF TESTRC^=0 THEN                                          1162
         LTR   TESTRC,TESTRC                                       1162
         BZ    @RF01162                                            1162
*         MRGCODE=LASTCC12;         /*                       @Y30LB38*/
         MVC   MRGCODE(2),@CH00567                                 1163
*       ELSE                                                       1164
*         DO;                       /*                       @Y30LB38*/
         B     @RC01162                                            1164
@RF01162 DS    0H                                                  1165
*           MRGBLKS(I7)=RTNAREA;    /*                       @Y30LB38*/
         L     @06,RTNAREA                                         1165
         LH    @15,I7                                              1165
         SLA   @15,2                                               1165
         ST    @06,MRGBLKS-4(@15)                                  1165
*           MRGADDR=RTNAREA;        /*                       @Y30LB38*/
*                                                                  1166
         ST    @06,MRGADDR                                         1166
*           /*********************************************************/
*           /*                                                       */
*           /* SELECT A MERGE COUNT FIELD AND PLACE THE ADDRESS      */
*           /*                                               @Y30LB38*/
*           /* IN MRGCNTR. MRGADDR AND MRGCNTR ARE PASSED AS         */
*           /* PARAMETERS TO MRGLOOP. MRGLOOP TAKES THE ENTRIES FROM */
*           /* SORTBLK AND PLACES THEM IN THE MERGE BLOCK.   @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1167
*           CALL MRGLOOP(I7,MRGCNTR,MRGADDR);/*              @Y30LB38*/
         LA    @06,I7                                              1167
         ST    @06,@AL00001                                        1167
         LA    @06,MRGCNTR                                         1167
         ST    @06,@AL00001+4                                      1167
         LA    @06,MRGADDR                                         1167
         ST    @06,@AL00001+8                                      1167
         LA    @01,@AL00001                                        1167
         BAL   @14,MRGLOOP                                         1167
*           MRGCOUNT(I7)=MRGCNTR;   /*                       @Y30LB38*/
         LH    @06,I7                                              1168
         SLA   @06,2                                               1168
         L     @15,MRGCNTR                                         1168
         ST    @15,MRGCOUNT-4(@06)                                 1168
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1170
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL THE MRGBLK ENTRIES WERE USED. IF ALL BLOCKS       @ZM00717*/
*   /* ARE EQUALLY FILLED, USE THE FIRST BLOCK, OTHERWISE USE THE    */
*   /* NEXT MERGE BLOCK. THE SORTCNT FIELD IN SORTBLK IS ADDED TO THE*/
*   /* MRGCNT FIELD. THIS VALUE IS MULTIPLIED BY THE ITEMLEN FIELD TO*/
*   /* GET A LENGTH FOR THE NEW MERG BLOCK. THIS LENGTH IS PASSED TO */
*   /* THE UGPOOL MACRO TO OBTAIN THE CORE. THE ADDRESS OF THE CORE  */
*   /* RETURNED AND THE ADDRESS OF THE MRGCNT FIELD ARE PASSED TO    */
*   /* MRGLOOP WHICH REMOVES THE ENTRIES FROM SORTBLK AND PLACES THEM*/
*   /* IN THE NEW BLOCK.                                     @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1171
*   ELSE                                                           1171
*     DO;                           /*                       @Y30LB38*/
         B     @RC01154                                            1171
@RF01154 DS    0H                                                  1172
*       IF I9=7 THEN                                               1172
         CLC   I9(2),@CH00659                                      1172
         BNE   @RF01172                                            1172
*         I9=1;                     /*                       @ZM00717*/
         MVC   I9(2),@CH00220                                      1173
*       ELSE                                                       1174
*         I9=I9+1;                  /*                       @ZM00717*/
         B     @RC01172                                            1174
@RF01172 LA    @06,1                                               1174
         AH    @06,I9                                              1174
         STH   @06,I9                                              1174
*       MRGPOOL=(MRGCOUNT(I9)+SORTCNT)*ITEMLEN;/*            @ZM00717*/
@RC01172 LH    @06,I9                                              1175
         SLA   @06,2                                               1175
         L     @02,SORTPTR                                         1175
         LH    @01,SORTCNT(,@02)                                   1175
         AL    @01,MRGCOUNT-4(@06)                                 1175
         SLR   @06,@06                                             1175
         IC    @06,ITEMLEN                                         1175
         MR    @00,@06                                             1175
         ST    @01,MRGPOOL                                         1175
*       CALL IDCSAGP0(GDTTBL,MRGPOOL,RTNAREA,'LM01');/*      @Y30LB38*/
         L     @06,@PC00001                                        1176
         ST    @06,@AL00001                                        1176
         LA    @02,MRGPOOL                                         1176
         ST    @02,@AL00001+4                                      1176
         LA    @02,RTNAREA                                         1176
         ST    @02,@AL00001+8                                      1176
         LA    @02,@CC01491                                        1176
         ST    @02,@AL00001+12                                     1176
         MVI   @AL00001+12,X'80'                                   1176
         L     @15,GDTGPL(,@06)                                    1176
         LA    @01,@AL00001                                        1176
         BALR  @14,@15                                             1176
*       RESPECIFY                                                  1177
*         RTNREG RSTD;                                             1177
*       TESTRC=RTNREG;                                             1178
         LR    TESTRC,RTNREG                                       1178
*       RESPECIFY                                                  1179
*         RTNREG UNRSTD;            /*                       @Y30LB38*/
*       IF TESTRC^=0 THEN                                          1180
         LTR   TESTRC,TESTRC                                       1180
         BZ    @RF01180                                            1180
*         MRGCODE=LASTCC12;         /*                       @Y30LB38*/
         MVC   MRGCODE(2),@CH00567                                 1181
*       WORK1=RTNAREA;              /*                       @Y30LB38*/
@RF01180 L     @06,RTNAREA                                         1182
         ST    @06,WORK1                                           1182
*       MRGADDR=RTNAREA;            /*                       @Y30LB38*/
         ST    @06,MRGADDR                                         1183
*       IF MRGCODE^=LASTCC12 THEN                                  1184
         CLC   MRGCODE(2),@CH00567                                 1184
         BE    @RF01184                                            1184
*         CALL MRGLOOP(I9,MRGCNTR,MRGADDR);/*                @Y30LB38*/
*                                                                  1185
         LA    @06,I9                                              1185
         ST    @06,@AL00001                                        1185
         LA    @06,MRGCNTR                                         1185
         ST    @06,@AL00001+4                                      1185
         LA    @06,MRGADDR                                         1185
         ST    @06,@AL00001+8                                      1185
         LA    @01,@AL00001                                        1185
         BAL   @14,MRGLOOP                                         1185
*       /*************************************************************/
*       /*                                                           */
*       /* IF STORAGE WAS OBTAINED, PUT THE NEW MRGBLK       @ZM00727*/
*       /* ADDRESS OBTAINED ABOVE IN THE APPROPRIATE MRGBLK AND THE  */
*       /* NEW COUNT IN THE APPROPRIATE MRGCNT FIELD. ISSUE THE      */
*       /* UFSPACE MACRO TO FREE THE OLD MRGBLK THAT WAS REPLACED BY */
*       /* THE ABOVE.                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1186
*       IF MRGCODE^=LASTCC12 THEN                                  1186
@RF01184 CLC   MRGCODE(2),@CH00567                                 1186
         BE    @RF01186                                            1186
*         DO;                       /*                       @Y30LB38*/
*           RTNAREA=MRGBLKS(I9);    /*                       @Y30BL38*/
         LH    @06,I9                                              1188
         SLA   @06,2                                               1188
         L     @15,MRGBLKS-4(@06)                                  1188
         ST    @15,RTNAREA                                         1188
*           MRGBLKS(I9)=WORK1;      /*                       @Y30LB38*/
         L     @15,WORK1                                           1189
         ST    @15,MRGBLKS-4(@06)                                  1189
*           MRGCOUNT(I9)=MRGCNTR;   /*                       @Y30BL38*/
         L     @15,MRGCNTR                                         1190
         ST    @15,MRGCOUNT-4(@06)                                 1190
*           CALL IDCSAFS0(GDTTBL,RTNAREA);/*                 @Y30LB38*/
         L     @06,@PC00001                                        1191
         ST    @06,@AL00001                                        1191
         LA    @15,RTNAREA                                         1191
         ST    @15,@AL00001+4                                      1191
         L     @15,GDTFSP(,@06)                                    1191
         LA    @01,@AL00001                                        1191
         BALR  @14,@15                                             1191
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1193
@RF01186 DS    0H                                                  1194
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO STORAGE WAS OBTAINED, ISSUE THE UFPOOL MACRO    @ZM00717*/
*   /* TO FREE ALL THE CORE OBTAINED, ZERO THE MRGBLK AND    @ZM00717*/
*   /* MRGCNT FIELDS AND ISSUE THE UPRINT MACRO TO PRINT     @ZM00717*/
*   /* MESSAGE IDC2011I.                                     @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1194
*   IF MRGCODE=LASTCC12 THEN                                       1194
@RC01154 CLC   MRGCODE(2),@CH00567                                 1194
         BNE   @RF01194                                            1194
*     DO;                           /*                       @Y30LB38*/
*       CALL IDCSAFP0(GDTTBL,'LM01',ALL);/*                  @Y30LB38*/
         MVC   @AL00001+4(8),@AL01196                              1196
         L     @06,@PC00001                                        1196
         ST    @06,@AL00001                                        1196
         L     @15,GDTFPL(,@06)                                    1196
         LA    @01,@AL00001                                        1196
         BALR  @14,@15                                             1196
*       DO I7=ONE BY ONE TO SEVEN;  /*                       @Y30LB38*/
         LA    @06,1                                               1197
         STH   @06,I7                                              1197
@DL01197 DS    0H                                                  1198
*         MRGBLKS(I7)=''B;          /*                       @Y30LB38*/
         LR    @15,@06                                             1198
         SLA   @15,2                                               1198
         SLR   @14,@14                                             1198
         ST    @14,MRGBLKS-4(@15)                                  1198
*       END;                        /*                       @Y30LB38*/
         AL    @06,@CF00220                                        1199
         STH   @06,I7                                              1199
         C     @06,@CF00659                                        1199
         BNH   @DL01197                                            1199
*       DO I7=ONE BY ONE TO SEVEN;  /*                       @Y30LB38*/
         LA    @06,1                                               1200
         STH   @06,I7                                              1200
@DL01200 DS    0H                                                  1201
*         MRGCOUNT(I7)=''B;         /*                       @Y30LB38*/
         LR    @15,@06                                             1201
         SLA   @15,2                                               1201
         SLR   @14,@14                                             1201
         ST    @14,MRGCOUNT-4(@15)                                 1201
*       END;                        /*                       @Y30LB38*/
         AL    @06,@CF00220                                        1202
         STH   @06,I7                                              1202
         C     @06,@CF00659                                        1202
         BNH   @DL01200                                            1202
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1203
*       DARGSMOD=UNIVMSG;           /*                       @Y30LB38*/
         L     @06,DDSTRU                                          1204
         MVC   DARGSMOD(3,@06),@CC01481                            1204
*       DARGSENT=MSG2011I;          /*                       @Y30LB38*/
         MVI   DARGSENT(@06),X'0C'                                 1205
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/
         L     @06,@PC00001                                        1206
         ST    @06,@AL00001                                        1206
         LA    @15,@CF00116                                        1206
         ST    @15,@AL00001+4                                      1206
         LA    @15,DDSTRU                                          1206
         ST    @15,@AL00001+8                                      1206
         MVI   @AL00001+8,X'80'                                    1206
         L     @15,GDTPRT(,@06)                                    1206
         LA    @01,@AL00001                                        1206
         BALR  @14,@15                                             1206
*     END;                          /*                       @Y30LB38*/
*                                                                  1207
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1208
*   REG14=RETADDR7;                 /*                       @Y30LB38*/
@RF01194 L     REG14,RETADDR7                                      1208
*   RETURN CODE(MRGCODE);           /*                       @Y30LB38*/
         LH    @15,MRGCODE                                         1209
@EL00011 DS    0H                                                  1209
@EF00011 DS    0H                                                  1209
@ER00011 BR    @14                                                 1209
*   END MRGDATA;                    /*                       @Y30LB38*/
*                                                                  1211
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - HEADSET                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE ESTABLISHES THE SUBTITLE     @Y30LB38*/
*/*                LINES FOR THE REPORT AND PLACES THE       @Y30LB38*/
*/*                CONSTANTS USED FOR REPORTING IN A BUFFER  @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED INTTBL AND THE FDTTBL       @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - COMPLETED TITLE BUFFER AND A 0 RETURN CODE  @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1211
*HEADSET:                                                          1211
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1211
HEADSET  DS    0H                                                  1212
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1212
*   DCL                                                            1212
*     HEADCODE FIXED(15);           /* HEADSET RETURN CODE   @Y30LB38*/
*   DCL                                                            1213
*     LMO16 FIXED(8) CONSTANT(16);  /* LMO STID 16           @Y30LB38*/
*   DCL                                                            1214
*     LMO17 FIXED(8) CONSTANT(17);  /* LMO STID 17           @Y30LB38*/
*   DCL                                                            1215
*     LMO18 FIXED(8) CONSTANT(18);  /* LMO STID 18           @Y30LB38*/
*   DCL                                                            1216
*     LMO19 FIXED(8) CONSTANT(19);  /* LMO STID 19           @Y30LB38*/
*   DCL                                                            1217
*     LMO26 FIXED(8) CONSTANT(26);  /* LMO STID 26           @Y30LB38*/
*   DCL                                                            1218
*     LMO27 FIXED(8) CONSTANT(27);  /* LMO STID 27           @Y30LB38*/
*   DCL                                                            1219
*     LMO28 FIXED(8) CONSTANT(28);  /* LMO STID 28           @Y30LB38*/
*                                                                  1219
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE PCARG LIST FOR THE UESTA MACRO                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1220
*   DCL                                                            1220
*     1 PCARG,                                                     1220
*      2 PCMTLP PTR(31),            /* MAIN TITLE LINE PTR   @Y30LB38*/
*      2 PCSTLP PTR(31),            /* SUB-TITLE LINE PTR    @Y30LB38*/
*      2 PCFLP PTR(31),             /* FOOTING LINE PTR      @Y30LB38*/
*      2 PCPCP PTR(31),             /*                       @Y30LB38*/
*      2 PCPNL FIXED(15),           /* PAGE NO LOCATION      @Y30LB38*/
*      2 PCPTL FIXED(15),           /* TIME LOCATION         @Y30LB38*/
*      2 PCPDL FIXED(15),           /* DATE LOCATION         @Y30LB38*/
*      2 PCMTLC FIXED(15),          /* MAIN TITLE LINE CNT   @Y30LB38*/
*      2 PCSTLC FIXED(15),          /* SUB-TITLE LINE CNT    @Y30LB38*/
*      2 PCFLC FIXED(15),           /* FOOTING LINE CNT      @Y30LB38*/
*      2 PCLW FIXED(15),            /* LINE WIDTH            @Y30LB38*/
*      2 PCPD FIXED(15),            /* PAGE DEPTH            @Y30LB38*/
*      2 PCDSC PTR(8);              /* DEFAULT SPACE VAL     @Y30LB38*/
*                                                                  1221
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1221
*   RETADDR3=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR3                                      1221
*   OLDERID2=NEWERID2;                                             1222
         L     @07,@PC00001                                        1222
         L     @02,GDTTR2(,@07)                                    1222
         MVC   @TS00001(95),NEWERID2(@02)                          1222
         MVC   OLDERID2(95,@02),@TS00001                           1222
*   NEWID2='LMLA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@02),@CC01681                              1223
*   HEADCODE=''B;                   /*                       @Y30LB38*/
         SLR   HEADCODE,HEADCODE                                   1224
*   PCARG=''B;                      /*                       @Y30LB38*/
*                                                                  1225
         XC    PCARG(33),PCARG                                     1225
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THIS IS THE FIRST TIME THROUGH. IF YES,       @Y30LB38*/
*   /* ISSUE THE UPRINT MACRO TO READ IN THE CONSTANTS INTO THE      */
*   /* PRNTCONS WORK AREA.                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1226
*   IF FIRSTTIM=OFF THEN                                           1226
         TM    FIRSTTIM,B'00100000'                                1226
         BNZ   @RF01226                                            1226
*     DO;                           /*                       @Y30LB38*/
*       FIRSTTIM=ON;                /*                       @Y30LB38*/
         OI    FIRSTTIM,B'00100000'                                1228
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1229
*       DARGRETP=ADDR(PRNTCONS);    /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1230
         LA    @14,PRNTCONS                                        1230
         ST    @14,DARGRETP(,@15)                                  1230
*       DARGRETL=LENGTH(PRNTCONS);  /*                       @Y30LB38*/
         MVC   DARGRETL(2,@15),@CH00043                            1231
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@15),@CC01483                            1232
*       DARGSENT=LMO16;             /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'10'                                 1233
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/
         ST    @07,@AL00001                                        1234
         LA    @15,@CF00116                                        1234
         ST    @15,@AL00001+4                                      1234
         LA    @15,DDSTRU                                          1234
         ST    @15,@AL00001+8                                      1234
         MVI   @AL00001+8,X'80'                                    1234
         L     @15,GDTPRT(,@07)                                    1234
         LA    @01,@AL00001                                        1234
         BALR  @14,@15                                             1234
*     END;                          /*                       @Y30LB38*/
*                                                                  1235
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO READ FIRST SUBTITLE INTO    @Y30LB38*/
*   /* TITLBUFF. THE TABLID WILL DETERMINE WHICH SUBTITLE IS READ IN.*/
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1236
*   PRINTAB=''B;                    /*                       @Y30LB38*/
@RF01226 XC    PRINTAB(84),PRINTAB                                 1236
*   DARGRETP=ADDR(TITLBUFF);        /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1237
         LA    @15,TITLBUFF                                        1237
         ST    @15,DARGRETP(,@07)                                  1237
*   DARGRETL=LENGTH(TITLBUFF);      /*                       @Y30LB38*/
         MVC   DARGRETL(2,@07),@CH01410                            1238
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@07),@CC01483                            1239
*   DARGDBP=ADDR(MSFVAL);           /*                       @Y30LB38*/
         L     @15,@PC00001+4                                      1240
         L     @15,FDTPTR+28(,@15)                                 1240
         ST    @15,DARGDBP(,@07)                                   1240
*   DARGILP=LENGTH(MSFVAL);         /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH00043                             1241
*   IF TBLID=TRANID THEN            /*                       @Y30LB38*/
         CLI   TBLID,2                                             1242
         BNE   @RF01242                                            1242
*     DARGSENT=LMO18;               /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'12'                                 1243
*   IF TBLID=VOLINVID THEN          /*                       @Y30LB38*/
@RF01242 CLI   TBLID,3                                             1244
         BNE   @RF01244                                            1244
*     DARGSENT=LMO17;               /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1245
         MVI   DARGSENT(@07),X'11'                                 1245
*   IF TBLID=CARTID THEN            /*                       @Y30LB38*/
@RF01244 CLI   TBLID,4                                             1246
         BNE   @RF01246                                            1246
*     DARGSENT=LMO19;               /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1247
         MVI   DARGSENT(@07),X'13'                                 1247
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/
*                                                                  1248
@RF01246 L     @07,@PC00001                                        1248
         ST    @07,@AL00001                                        1248
         LA    @15,@CF00116                                        1248
         ST    @15,@AL00001+4                                      1248
         LA    @15,DDSTRU                                          1248
         ST    @15,@AL00001+8                                      1248
         MVI   @AL00001+8,X'80'                                    1248
         L     @15,GDTPRT(,@07)                                    1248
         LA    @01,@AL00001                                        1248
         BALR  @14,@15                                             1248
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO READ COLUMN TITLES INTO     @Y30LB38*/
*   /* TITLBUFF. THE TABLID WILL DETERMINE WHICH SUBTITLE IS READ IN.*/
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1249
*   PRINTAB=''B;                    /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1249
*   DARGRETP=ADDR(TITLBUFF)+121;    /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1250
         LA    @15,TITLBUFF                                        1250
         AL    @15,@CF01682                                        1250
         ST    @15,DARGRETP(,@07)                                  1250
*   DARGRETL=LENGTH(TITLBUFF)-121;  /*                       @Y30LB38*/
         MVC   DARGRETL(2,@07),@CH01824                            1251
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@07),@CC01483                            1252
*   IF TBLID=TRANID THEN            /*                       @Y30LB38*/
         CLI   TBLID,2                                             1253
         BNE   @RF01253                                            1253
*     DARGSENT=LMO27;               /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'1B'                                 1254
*   IF TBLID=VOLINVID THEN          /*                       @Y30LB38*/
@RF01253 CLI   TBLID,3                                             1255
         BNE   @RF01255                                            1255
*     DARGSENT=LMO26;               /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1256
         MVI   DARGSENT(@07),X'1A'                                 1256
*   IF TBLID=CARTID THEN            /*                       @Y30LB38*/
@RF01255 CLI   TBLID,4                                             1257
         BNE   @RF01257                                            1257
*     DARGSENT=LMO28;               /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1258
         MVI   DARGSENT(@07),X'1C'                                 1258
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB38*/
*                                                                  1259
@RF01257 L     @07,@PC00001                                        1259
         ST    @07,@AL00001                                        1259
         LA    @15,@CF00116                                        1259
         ST    @15,@AL00001+4                                      1259
         LA    @15,DDSTRU                                          1259
         ST    @15,@AL00001+8                                      1259
         MVI   @AL00001+8,X'80'                                    1259
         L     @15,GDTPRT(,@07)                                    1259
         LA    @01,@AL00001                                        1259
         BALR  @14,@15                                             1259
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE PARM LIST FOR UESTA MACRO                  #Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1260
*   PCSTLP=ADDR(TITLBUFF);          /*                       @Y30LB38*/
*                                                                  1260
         LA    @07,TITLBUFF                                        1260
         ST    @07,PCSTLP                                          1260
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TABLE IS A SCRATCH CARTRIDGE LIST, SET THE     @Y30LB38*/
*   /* LINE COUNT(PCSTLC) = 2. OTHERWISE, SET IT = 3.        @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1261
*   IF TBLID=CARTID THEN                                           1261
         CLI   TBLID,4                                             1261
         BNE   @RF01261                                            1261
*     PCSTLC=TWO;                   /*                       @Y30LB38*/
         MVC   PCSTLC(2),@CH00154                                  1262
*   ELSE                                                           1263
*     PCSTLC=THREE;                 /*                       @Y30LB38*/
*                                                                  1263
         B     @RC01261                                            1263
@RF01261 MVC   PCSTLC(2),@CH00163                                  1263
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UESTA MACRO TO ESTABLISH THE SUBTITLES      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1264
*   CALL AMSTP042(GDTTBL,PRINTME,PCARG);/*                   @Y30LB38*/
*                                                                  1264
@RC01261 L     @07,@PC00001                                        1264
         ST    @07,@AL00001                                        1264
         LA    @15,PRINTME                                         1264
         ST    @15,@AL00001+4                                      1264
         LA    @15,PCARG                                           1264
         ST    @15,@AL00001+8                                      1264
         L     @15,GDTESA(,@07)                                    1264
         LA    @01,@AL00001                                        1264
         BALR  @14,@15                                             1264
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1265
*   REG14=RETADDR3;                 /*                       @Y30LB38*/
         L     REG14,RETADDR3                                      1265
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             1266
@EL00012 DS    0H                                                  1266
@EF00012 DS    0H                                                  1266
@ER00012 BR    @14                                                 1266
*   END HEADSET;                    /*                       @Y30LB38*/
*                                                                  1268
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - RPTPRNTR                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE SELECTS, FROM ONE OF THE     @Y30LB38*/
*/*                SEVEN MERGE BLOCKS, THE LOWEST VALUE      @Y30LB38*/
*/*                ENTRY IN THE BLOCKS, ONE AT A TIME, AND   @Y30LB38*/
*/*                PASSES EACH ONE TO SUBROUTINES THAT       @Y30LB38*/
*/*                FORMAT PRINT BUFFERS FOR A COMPLETE PAGE, @Y30LB38*/
*/*                AND PRINT THE PAGE.  IN THE INTTBL,       @Y30LB38*/
*/*                KEYLEN IS USED FOR THE COMPARES AND       @ZA08859*/
*/*                ITEMLEN IS USED FOR THE ENTRY LENGTH.     @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - UPDATED INTTBL AND A 0 RETURN CODE          @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1268
*RPTPRNTR:                                                         1268
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1268
RPTPRNTR DS    0H                                                  1269
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1269
*   DCL                                                            1269
*     LMO09 FIXED(8) CONSTANT(09);  /* LMO STID 09           @Y30LB38*/
*   DCL                                                            1270
*     LMO10 FIXED(8) CONSTANT(10);  /* LMO STID 10           @Y30LB38*/
*   DCL                                                            1271
*     LMO11 FIXED(8) CONSTANT(11);  /* LMO STID 11           @Y30LB38*/
*                                                                  1272
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1272
*   RETADDR3=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR3                                      1272
*   OLDERID2=NEWERID2;                                             1273
         L     @07,@PC00001                                        1273
         L     @07,GDTTR2(,@07)                                    1273
         MVC   @TS00001(95),NEWERID2(@07)                          1273
         MVC   OLDERID2(95,@07),@TS00001                           1273
*   NEWID2='LMMA';                  /*                       @Y30LB38*/
*                                                                  1274
         MVC   NEWID2(4,@07),@CC01690                              1274
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP DO LOOPS TO PROCESS ALL THE MRGBLK ENTRIES.    @Y30LB38*/
*   /* THE FIELD NEWENT IS SET TO 12 FF'S AND IS USED AS A CONTROL   */
*   /* FOR SORTING. WHEN NEWENT IS LEFT SET TO ALL FF'S, THE REPORT  */
*   /* LOOP IS FINISHED AND UFPOOL IS ISSUED TO FREE ALL THE MRGBLKS.*/
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1275
*   DO WHILE NEWENT(1:12)^=STARTVAL;/*                       @Y30LB38*/
*                                                                  1275
         B     @DE01275                                            1275
@DL01275 DS    0H                                                  1276
*     /***************************************************************/
*     /*                                                             */
*     /* START WITH 12 FF'S                                  @ZM00717*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1276
*     NEWENT(1:12)=STARTVAL;        /*                       @Y30LB38*/
*                                                                  1276
         MVC   NEWENT(12),STARTVAL                                 1276
*     /***************************************************************/
*     /*                                                             */
*     /* SET UP A DO LOOP TO SEARCH THROUGH ALL THE MRGBLK   @Y30LB38*/
*     /* ENTRIES TO FIND THE LOWEST ONE. PLACE THIS VALUE IN THE     */
*     /* FIELD NEWENT AND CALL RTPFMTR TO PLACE THE VALUE IN THE     */
*     /* PRINT BUFFER.                                       @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1277
*     DO I=1 BY 1 TO 7;             /*                       @Y30LB38*/
         LA    I,1                                                 1277
@DL01277 DS    0H                                                  1278
*       MGENTPTR=MRGBLKS(I);        /*                       @Y30LB38*/
         LR    @15,I                                               1278
         SLA   @15,2                                               1278
         L     MGENTPTR,MRGBLKS-4(@15)                             1278
*       IF MRGCOUNT(I)^=ZERO&NEWENT(1:KEYLEN)=>MGENTPTR->BLKENT(1: 1279
*           KEYLEN) THEN            /*                       @ZA08859*/
         L     @02,MRGCOUNT-4(@15)                                 1279
         LTR   @02,@02                                             1279
         BZ    @RF01279                                            1279
         SLR   @02,@02                                             1279
         IC    @02,KEYLEN                                          1279
         BCTR  @02,0                                               1279
         EX    @02,@SC01853                                        1279
         BL    @RF01279                                            1279
*         DO;                       /*                       @Y30LB38*/
*           I2=I;                   /*                       @Y30LB38*/
         STH   I,I2                                                1281
*           NEWENT(1:ITEMLEN)=MGENTPTR->BLKENT(1:ITEMLEN);/* @Y30LB38*/
         SLR   @02,@02                                             1282
         IC    @02,ITEMLEN                                         1282
         BCTR  @02,0                                               1282
         EX    @02,@SM01855                                        1282
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1284
@RF01279 AL    I,@CF00220                                          1284
         C     I,@CF00659                                          1284
         BNH   @DL01277                                            1284
*     /***************************************************************/
*     /*                                                             */
*     /* THE NEW ENTRY HAS BEEN PLACED IN NEWENT. CALL       @Y30LB38*/
*     /* RPTFMTR TO PLACE THE ENTRY IN NEWENT IN THE PRINT BUFFERAND */
*     /* ISSUE THE UPRINT MACRO WHEN THE BUFFER IS FULL.     @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1285
*     CALL RPTFMTR;                 /*                       @Y30LB38*/
*                                                                  1285
         BAL   @14,RPTFMTR                                         1285
*     /***************************************************************/
*     /*                                                             */
*     /* IF NEWENT IS ALL FF'S THE REPORT IS DONE. ISSUE     @Y30LB38*/
*     /* THE UFPOOL MACRO TO FREE ALL THE MRGBLK'S AND ZERO THE      */
*     /* MRGBLK AND MRGCNT FIELDS IN INTTBL.                 @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1286
*     IF NEWENT(1:12)=STARTVAL THEN                                1286
         CLC   NEWENT(12),STARTVAL                                 1286
         BNE   @RF01286                                            1286
*       DO;                         /*                       @Y30LB38*/
*         CALL IDCSAFP0(GDTTBL,'LM01',ALL);/*                @Y30LB38*/
         MVC   @AL00001+4(8),@AL01288                              1288
         L     @07,@PC00001                                        1288
         ST    @07,@AL00001                                        1288
         L     @15,GDTFPL(,@07)                                    1288
         LA    @01,@AL00001                                        1288
         BALR  @14,@15                                             1288
*         DO I=ONE BY ONE TO SEVEN; /*                       @Y30LB38*/
         LA    I,1                                                 1289
@DL01289 DS    0H                                                  1290
*           MRGBLKS(I)=''B;         /*                       @Y30LB38*/
         LR    @15,I                                               1290
         SLA   @15,2                                               1290
         SLR   @14,@14                                             1290
         ST    @14,MRGBLKS-4(@15)                                  1290
*         END;                      /*                       @Y30LB38*/
         AL    I,@CF00220                                          1291
         C     I,@CF00659                                          1291
         BNH   @DL01289                                            1291
*         DO I=ONE BY ONE TO SEVEN; /*                       @Y30LB38*/
         LA    I,1                                                 1292
@DL01292 DS    0H                                                  1293
*           MRGCOUNT(I)=''B;        /*                       @Y30LB38*/
         LR    @15,I                                               1293
         SLA   @15,2                                               1293
         SLR   @14,@14                                             1293
         ST    @14,MRGCOUNT-4(@15)                                 1293
*         END;                      /*                       @Y30LB38*/
         AL    I,@CF00220                                          1294
         C     I,@CF00659                                          1294
         BNH   @DL01292                                            1294
*       END;                        /*                       @Y30LB38*/
*                                                                  1295
*     /***************************************************************/
*     /*                                                             */
*     /* THE REPORT IS NOT FINISHED SO, INCREMENT THE MRGBLK @Y30LB38*/
*     /* POINTER BY THE LENGTH IN ITEMLEN AND SUBTRACT ONE FROM THE  */
*     /* MRGCNT FIELD.                                       @Y30LB38*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1296
*     ELSE                                                         1296
*       DO;                         /*                       @Y30LB38*/
         B     @RC01286                                            1296
@RF01286 DS    0H                                                  1297
*         MRGBLKS(I2)=MRGBLKS(I2)+ITEMLEN;/*                 @Y30LB38*/
         LH    @07,I2                                              1297
         SLA   @07,2                                               1297
         SLR   @15,@15                                             1297
         IC    @15,ITEMLEN                                         1297
         AL    @15,MRGBLKS-4(@07)                                  1297
         ST    @15,MRGBLKS-4(@07)                                  1297
*         MRGCOUNT(I2)=MRGCOUNT(I2)-ONE;/*                   @Y30LB38*/
         L     @15,MRGCOUNT-4(@07)                                 1298
         BCTR  @15,0                                               1298
         ST    @15,MRGCOUNT-4(@07)                                 1298
*       END;                        /*                       @Y30LB38*/
*   END;                            /*                       @Y30LB38*/
*                                                                  1300
@RC01286 DS    0H                                                  1300
@DE01275 CLC   NEWENT(12),STARTVAL                                 1300
         BNE   @DL01275                                            1300
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO PRINT THE TOTAL LINES       @Y30LB38*/
*   /* AFTER EACH REPORT. IF THE TBLID IS VOLUME INVENTORY USE STID  */
*   /* LMO10, IF THE TBLID IS TRANSIENT VOLUME USE STID LMO09        */
*   /* OTHERWISE USE STID LMO11.                             @Y30LB38*/
*   /* THE TOTALS WILL NOT BE PRINTED IF THE SUMARY          @Y30LB38*/
*   /* KEYWORD ONLY IS SPECIFIED.                            @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*   PRINTAB=''B;                    /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1301
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1302
         MVC   DARGSMOD(3,@07),@CC01483                            1302
*   IF TBLID=VOLINVID&(ADDR(MNT)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN  1303
         CLI   TBLID,3                                             1303
         BNE   @RF01303                                            1303
         SLR   @07,@07                                             1303
         L     @15,@PC00001+4                                      1303
         C     @07,FDTPTR+8(,@15)                                  1303
         BNE   @RT01303                                            1303
         C     @07,FDTPTR+24(,@15)                                 1303
         BE    @RF01303                                            1303
@RT01303 DS    0H                                                  1304
*     DO;                           /*                       @Y30LB38*/
*       DARGDBP=ADDR(VICNTR);       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1305
         LA    @15,VICNTR                                          1305
         ST    @15,DARGDBP(,@07)                                   1305
*       DARGSENT=LMO10;             /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'0A'                                 1306
*       DARGILP=LENGTH(VICNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH00043                             1307
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @07,@PC00001                                        1308
         ST    @07,@AL00001                                        1308
         LA    @15,PRINTME                                         1308
         ST    @15,@AL00001+4                                      1308
         LA    @15,DDSTRU                                          1308
         ST    @15,@AL00001+8                                      1308
         MVI   @AL00001+8,X'80'                                    1308
         L     @15,GDTPRT(,@07)                                    1308
         LA    @01,@AL00001                                        1308
         BALR  @14,@15                                             1308
*     END;                          /*                       @Y30LB38*/
*   IF TBLID=TRANID&(ADDR(NMNT)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN   1310
@RF01303 CLI   TBLID,2                                             1310
         BNE   @RF01310                                            1310
         SLR   @07,@07                                             1310
         L     @15,@PC00001+4                                      1310
         C     @07,FDTPTR+12(,@15)                                 1310
         BNE   @RT01310                                            1310
         C     @07,FDTPTR+24(,@15)                                 1310
         BE    @RF01310                                            1310
@RT01310 DS    0H                                                  1311
*     DO;                           /*                       @Y30LB38*/
*       DARGDBP=ADDR(TVCNTR);       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1312
         LA    @15,TVCNTR                                          1312
         ST    @15,DARGDBP(,@07)                                   1312
*       DARGSENT=LMO09;             /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'09'                                 1313
*       DARGILP=LENGTH(TVCNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH00043                             1314
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @07,@PC00001                                        1315
         ST    @07,@AL00001                                        1315
         LA    @15,PRINTME                                         1315
         ST    @15,@AL00001+4                                      1315
         LA    @15,DDSTRU                                          1315
         ST    @15,@AL00001+8                                      1315
         MVI   @AL00001+8,X'80'                                    1315
         L     @15,GDTPRT(,@07)                                    1315
         LA    @01,@AL00001                                        1315
         BALR  @14,@15                                             1315
*     END;                          /*                       @Y30LB38*/
*   IF TBLID=CARTID&(ADDR(CART)^=NULLPTR×ADDR(AL)^=NULLPTR) THEN   1317
@RF01310 CLI   TBLID,4                                             1317
         BNE   @RF01317                                            1317
         SLR   @07,@07                                             1317
         L     @15,@PC00001+4                                      1317
         C     @07,FDTPTR+16(,@15)                                 1317
         BNE   @RT01317                                            1317
         C     @07,FDTPTR+24(,@15)                                 1317
         BE    @RF01317                                            1317
@RT01317 DS    0H                                                  1318
*     DO;                           /*                       @Y30LB38*/
*       DARGDBP=ADDR(SCCNTR);       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1319
         LA    @15,SCCNTR                                          1319
         ST    @15,DARGDBP(,@07)                                   1319
*       DARGSENT=LMO11;             /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'0B'                                 1320
*       DARGILP=LENGTH(SCCNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH00043                             1321
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @07,@PC00001                                        1322
         ST    @07,@AL00001                                        1322
         LA    @15,PRINTME                                         1322
         ST    @15,@AL00001+4                                      1322
         LA    @15,DDSTRU                                          1322
         ST    @15,@AL00001+8                                      1322
         MVI   @AL00001+8,X'80'                                    1322
         L     @15,GDTPRT(,@07)                                    1322
         LA    @01,@AL00001                                        1322
         BALR  @14,@15                                             1322
*     END;                          /*                       @Y30LB38*/
*   REG14=RETADDR3;                 /*                       @Y30LB38*/
@RF01317 L     REG14,RETADDR3                                      1324
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             1325
@EL00013 DS    0H                                                  1325
@EF00013 DS    0H                                                  1325
@ER00013 BR    @14                                                 1325
*   END RPTPRNTR;                   /*                       @Y30LB38*/
*                                                                  1327
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - RPTFMTR                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE PLACES AN ENTRY, PASSED IN   @Y30LB38*/
*/*                THE FIELD NEWENT, INTO THE PRINT BUFFER.  @Y30LB38*/
*/*                THE PRINT BUFFER IS LARGE ENOUGH TO       @Y30LB38*/
*/*                CONTAIN ENOUGH ENTRIES TO FILL THE        @Y30LB38*/
*/*                LARGEST REPORT PAGE.  THE ENTRY MUST BE   @Y30LB38*/
*/*                FORMATTED INTO AN ENTRY LOCATION IN THE   @Y30LB38*/
*/*                PRINT BUFFER ACCORDING TO THE TBLID.      @Y30LB38*/
*/*                WHEN THE PRINT BUFFER IS FULL, THE        @Y30LB38*/
*/*                ROUTINE ISSUES UPRINT TO PRINT A PAGE.    @Y30LB38*/
*/*                IF THE INPUT ENTRY IS FF'S, THE BUFFER    @Y30LB38*/
*/*                MUST BE FILLED WITH BLANKS TO COMPLETE    @Y30LB38*/
*/*                THE LAST LINE.                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED INTTBL                      @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - PRINTED REPORT AND A 0 RETURN CODE          @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1327
*RPTFMTR:                                                          1327
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1327
RPTFMTR  DS    0H                                                  1328
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1328
*   DCL                                                            1328
*     MRGEPTR PTR(31);              /* BASED ENTRY PTR       @Y30LB38*/
*   DCL                                                            1329
*     LMO13 FIXED(8) CONSTANT(13);  /* LMO STID 13           @Y30LB38*/
*   DCL                                                            1330
*     LMO14 FIXED(8) CONSTANT(14);  /* LMO STID 14           @Y30LB38*/
*   DCL                                                            1331
*     LMO15 FIXED(8) CONSTANT(15);  /* LMO STID 15           @Y30LB38*/
*                                                                  1331
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE DSECT TO MAP VOLUME INVENTORY ENTRY IN THE    @Y30LB38*/
*   /* MERGE BLOCK.                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1332
*   DCL                                                            1332
*     1 VIBLKENT CHAR(12) BASED(MRGEPTR),/*                  @Y30LB38*/
*       3 VIBLKSN CHAR(6),          /* VOL SER NUM           @Y30LB38*/
*       3 VIVLKFLG BIT(8),          /* ATTRIBUTE FLAGS       @Y30LB38*/
*         5 * BIT(2),                                              1332
*         5 VIBLKSV BIT(1),         /* SECURE VOLUME FLAG    @Y30LB38*/
*         5 VIBLKEV BIT(1),         /* EXCLUSIV VOLUME       @Y30LB38*/
*         5 * BIT(1),                                              1332
*         5 VIBLKBND BIT(1),        /* BOUND VOLUME          @Y30LB38*/
*         5 VIBLKWI BIT(1),         /* WRITE INHIBIT         @Y30LB38*/
*         5 * BIT(1),               /* UNUSED                @ZM00986*/
*       3 * CHAR(1),                /* UNUSED                @ZM00986*/
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/
*         5 VIBLKONE BIT(8),                                       1332
*           7 VIBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/
*           7 VIBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/
*           7 VIBLKY1 BIT(5),       /*                       @Y30LB38*/
*         5 VIBLKX1 BIT(8),         /*                       @Y30LB38*/
*       3 * BIT(16),                /* ADDR OF CART TWO      @Y30LB38*/
*         5 VIBLKTWO BIT(8),                                       1332
*           7 VIBLKMS2 BIT(2),      /* MSF NUMBER            @Y30LB38*/
*           7 VIBLKZ2 BIT(1),       /* CELL LOCATION         @Y30LB38*/
*           7 VIBLKY2 BIT(5),       /*                       @Y30LB38*/
*         5 VIBLKX2 BIT(8);         /*                       @Y30LB38*/
*                                                                  1332
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE DSECT TO MAP TRANSIENT VOLUME ENTRY IN THE    @Y30LB38*/
*   /* MERGE BLOCK.                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1333
*   DCL                                                            1333
*     1 TVBLKENT CHAR(23) BASED(MRGEPTR),/*                  @Y30LB38*/
*       3 TVBLKSN CHAR(6),          /* VOL SER NUM           @Y30LB38*/
*       3 TVBLKCS CHAR(12),         /* CARTRIDGE SER NUM     @Y30LB38*/
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/
*         5 TVBLKONE BIT(8),                                       1333
*           7 TVBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/
*           7 TVBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/
*           7 TVBLKY1 BIT(5),       /*                       @Y30LB38*/
*         5 TVBLKX1 BIT(8),         /*                       @Y30LB38*/
*       3 * BIT(16),                /* ADDR OF CART TWO      @Y30LB38*/
*         5 TVBLKTWO BIT(8),                                       1333
*           7 TVBLKMS2 BIT(2),      /* MSF NUMBER            @Y30LB38*/
*           7 TVBLKZ2 BIT(1),       /* CELL LOCATION         @Y30LB38*/
*           7 TVBLKY2 BIT(5),       /*                       @Y30LB38*/
*         5 TVBLKX2 BIT(8),         /*                       @Y30LB38*/
*       3 TVVLKFLG BIT(8),          /* ATTRIBUTE FLAGS       @Y30LB38*/
*         5 * BIT(2),                                              1333
*         5 TVBLKSV BIT(1),         /* SECURE VOLUME FLAG    @Y30LB38*/
*         5 TVBLKEV BIT(1),         /* EXCLUSIV VOLUME       @Y30LB38*/
*         5 * BIT(1),                                              1333
*         5 TVBLKBND BIT(1),        /* BOUND VOLUME          @Y30LB38*/
*         5 TVBLKWI BIT(1);         /* WRITE INHIBIT         @Y30LB38*/
*                                                                  1333
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARE DSECT TO MAP SCRATCH CARTRIDGE LIST ENTRY     @Y30LB38*/
*   /* IN THE MERGE BLOCK.                                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1334
*   DCL                                                            1334
*     1 SCBLKENT CHAR(14) BASED(MRGEPTR),                          1334
*       3 SCBLKCS CHAR(12),         /* CARTRIDGE SER NUM     @Y30LB38*/
*       3 * BIT(16),                /* ADDR OF CART ONE      @Y30LB38*/
*         5 SCBLKONE BIT(8),                                       1334
*           7 SCBLKMS1 BIT(2),      /* MSF NUMBER            @Y30LB38*/
*           7 SCBLKZ1 BIT(1),       /* CELL LOCATION         @Y30LB38*/
*           7 SCBLKY1 BIT(5),       /*                       @Y30LB38*/
*         5 SCBLKX1 BIT(8);         /*                       @Y30LB38*/
*                                                                  1335
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1335
*   RETADDR4=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR4                                      1335
*   OLDERID2=NEWERID2;                                             1336
         L     @07,@PC00001                                        1336
         L     @07,GDTTR2(,@07)                                    1336
         MVC   @TS00001(95),NEWERID2(@07)                          1336
         MVC   OLDERID2(95,@07),@TS00001                           1336
*   NEWID2='LMNA';                  /*                       @Y30LB38*/
*                                                                  1337
         MVC   NEWID2(4,@07),@CC01753                              1337
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/
*   /* TBLID = VOLUME INVENTORY,PLACE THE NEWENT FIELDS IN THE PRINT */
*   /* BUFFER. THE ATTRIBUTE FLAGS AND THE CELL LOCATION FIELDS MUST */
*   /* BE REFORMATED TO ONE BYTE FIELDS IN THE BUFFER.       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1338
*   IF NEWENT(1:12)^=STARTVAL&TBLID=VOLINVID THEN                  1338
         CLC   NEWENT(12),STARTVAL                                 1338
         BE    @RF01338                                            1338
         CLI   TBLID,3                                             1338
         BNE   @RF01338                                            1338
*     DO;                           /*                       @Y30LB38*/
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/
         LA    @07,1                                               1340
         ALR   BUFFCNTR,@07                                        1340
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/
         AL    @07,ENTCNTR                                         1341
         ST    @07,ENTCNTR                                         1341
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/
         LA    MRGEPTR,NEWENT                                      1342
*       VIPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/
*                                                                  1343
         LR    @07,BUFFCNTR                                        1343
         SLA   @07,4                                               1343
         ST    @07,@TF00001                                        1343
         ALR   @07,PRINTPTR                                        1343
         AL    @07,@CF01857                                        1343
         MVI   VIPRTBF+1(@07),C' '                                 1343
         MVC   VIPRTBF+2(14,@07),VIPRTBF+1(@07)                    1343
         MVI   VIPRTBF(@07),C' '                                   1343
*       /*************************************************************/
*       /*                                                           */
*       /* PUT VOLUME SERIAL NUMBER IN BUFFER                @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1344
*       VIPRTSN(BUFFCNTR)=VIBLKSN;  /*                       @Y30LB38*/
*                                                                  1344
         LR    @07,PRINTPTR                                        1344
         AL    @07,@TF00001                                        1344
         AL    @07,@CF01857                                        1344
         MVC   VIPRTSN(6,@07),VIBLKSN(MRGEPTR)                     1344
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE ATTRIBUTE FLAGS AND PUT VALUES      @Y30LB38*/
*       /* IN BUFFER.                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1345
*       IF VIBLKBND=ON THEN                                        1345
         TM    VIBLKBND(MRGEPTR),B'00000100'                       1345
         BNO   @RF01345                                            1345
*         VIPRTB(BUFFCNTR)=PRINTB;  /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1346
         AL    @07,@TF00001                                        1346
         AL    @07,@CF01858                                        1346
         MVC   VIPRTB-6(1,@07),PRINTB                              1346
*       IF VIBLKWI=ON THEN                                         1347
@RF01345 TM    VIBLKWI(MRGEPTR),B'00000010'                        1347
         BNO   @RF01347                                            1347
*         VIPRTR(BUFFCNTR)=PRINTR;  /*                       @Y30LB38*/
         LR    @07,BUFFCNTR                                        1348
         SLA   @07,4                                               1348
         ALR   @07,PRINTPTR                                        1348
         AL    @07,@CF01859                                        1348
         MVC   VIPRTR-7(1,@07),PRINTR                              1348
*       IF VIBLKSV=ON THEN                                         1349
@RF01347 TM    VIBLKSV(MRGEPTR),B'00100000'                        1349
         BNO   @RF01349                                            1349
*         VIPRTD(BUFFCNTR)=PRINTD;  /*                       @Y30LB38*/
         LR    @07,BUFFCNTR                                        1350
         SLA   @07,4                                               1350
         ALR   @07,PRINTPTR                                        1350
         AL    @07,@CF01860                                        1350
         MVC   VIPRTD-8(1,@07),PRINTD                              1350
*       IF VIBLKEV=ON THEN                                         1351
@RF01349 TM    VIBLKEV(MRGEPTR),B'00010000'                        1351
         BNO   @RF01351                                            1351
*         VIPRTE(BUFFCNTR)=PRINTE;  /*                       @Y30LB38*/
*                                                                  1352
         LR    @07,BUFFCNTR                                        1352
         SLA   @07,4                                               1352
         ALR   @07,PRINTPTR                                        1352
         AL    @07,@CF01861                                        1352
         MVC   VIPRTE-9(1,@07),PRINTE                              1352
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1353
*       VIPRTX1(BUFFCNTR)=VIBLKX1;  /*                       @Y30LB38*/
@RF01351 LR    @07,BUFFCNTR                                        1353
         SLA   @07,4                                               1353
         SLR   @03,@03                                             1353
         IC    @03,VIBLKX1(,MRGEPTR)                               1353
         LR    @01,PRINTPTR                                        1353
         AL    @01,@CF01862                                        1353
         STC   @03,VIPRTX1-10(@07,@01)                             1353
*       VIPRTY1(BUFFCNTR)=VIBLKONE; /*                       @Y30LB38*/
         SLR   @03,@03                                             1354
         IC    @03,VIBLKONE(,MRGEPTR)                              1354
         LR    @01,PRINTPTR                                        1354
         AL    @01,@CF01847                                        1354
         STC   @03,VIPRTY1-11(@07,@01)                             1354
*       VIBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*       VIBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
         ST    @07,@TF00001                                        1356
         ALR   @07,PRINTPTR                                        1356
         AL    @07,@CF01847                                        1356
         NI    VIBIT11-11(@07),B'00111111'                         1356
*       VIPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/
         SLR   @07,@07                                             1357
         L     @03,@TF00001                                        1357
         AL    @03,@CF01863                                        1357
         STC   @07,VIPRT1-12(@03,PRINTPTR)                         1357
*       IF VIBLKZ1=ON THEN                                         1358
         TM    VIBLKZ1(MRGEPTR),B'00100000'                        1358
         BNO   @RF01358                                            1358
*         VIPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1359
         AL    @07,@TF00001                                        1359
         AL    @07,@CF01863                                        1359
         OI    VIPRTZ1-12(@07),B'00000001'                         1359
*       VIBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*                                                                  1360
@RF01358 LR    @07,BUFFCNTR                                        1360
         SLA   @07,4                                               1360
         ST    @07,@TF00001                                        1360
         ALR   @07,PRINTPTR                                        1360
         AL    @07,@CF01847                                        1360
         NI    VIBIT13-11(@07),B'11011111'                         1360
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE CELL LOCATION FOR THE SECOND CART   @Y30LB38*/
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1361
*       VIPRTX2(BUFFCNTR)=VIBLKX2;  /*                       @Y30LB38*/
         SLR   @07,@07                                             1361
         IC    @07,VIBLKX2(,MRGEPTR)                               1361
         L     @03,@TF00001                                        1361
         AL    @03,@CF01865                                        1361
         STC   @07,VIPRTX2-13(@03,PRINTPTR)                        1361
*       VIPRTY2(BUFFCNTR)=VIBLKTWO; /*                       @Y30LB38*/
         SLR   @07,@07                                             1362
         IC    @07,VIBLKTWO(,MRGEPTR)                              1362
         L     @03,@TF00001                                        1362
         AL    @03,@CF01866                                        1362
         STC   @07,VIPRTY2-14(@03,PRINTPTR)                        1362
*       VIBIT21(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*       VIBIT22(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1364
         AL    @07,@TF00001                                        1364
         AL    @07,@CF01866                                        1364
         NI    VIBIT21-14(@07),B'00111111'                         1364
*       VIPRT2(BUFFCNTR)=''B;       /*                       @Y30LB38*/
         SLR   @07,@07                                             1365
         L     @03,@TF00001                                        1365
         AL    @03,@CF01867                                        1365
         STC   @07,VIPRT2-15(@03,PRINTPTR)                         1365
*       IF VIBLKZ2=ON THEN                                         1366
         TM    VIBLKZ2(MRGEPTR),B'00100000'                        1366
         BNO   @RF01366                                            1366
*         VIPRTZ2(BUFFCNTR)=ON;     /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1367
         AL    @07,@TF00001                                        1367
         AL    @07,@CF01867                                        1367
         OI    VIPRTZ2-15(@07),B'00000001'                         1367
*       VIBIT23(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
@RF01366 LR    @07,BUFFCNTR                                        1368
         SLA   @07,4                                               1368
         ALR   @07,PRINTPTR                                        1368
         AL    @07,@CF01866                                        1368
         NI    VIBIT23-14(@07),B'11011111'                         1368
*     END;                          /*                       @Y30LB38*/
*                                                                  1369
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/
*   /* TBLID = TRANSIENT VOLUME,PLACE THE NEWENT FIELDS IN THE PRINT */
*   /* BUFFER. THE ATTRIBUTE FLAGS AND THE CELL LOCATION FIELDS MUST */
*   /* BE REFORMATED TO ONE BYTE FIELDS IN THE BUFFER.       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1370
*   IF NEWENT(1:12)^=STARTVAL&TBLID=TRANID THEN                    1370
@RF01338 CLC   NEWENT(12),STARTVAL                                 1370
         BE    @RF01370                                            1370
         CLI   TBLID,2                                             1370
         BNE   @RF01370                                            1370
*     DO;                           /*                       @Y30LB38*/
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/
         LA    @07,1                                               1372
         ALR   BUFFCNTR,@07                                        1372
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/
         AL    @07,ENTCNTR                                         1373
         ST    @07,ENTCNTR                                         1373
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/
         LA    MRGEPTR,NEWENT                                      1374
*       TVPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/
*                                                                  1375
         LR    @07,BUFFCNTR                                        1375
         MH    @07,@CH01312                                        1375
         ST    @07,@TF00001                                        1375
         ALR   @07,PRINTPTR                                        1375
         AL    @07,@CF01868                                        1375
         MVI   TVPRTBF+1(@07),C' '                                 1375
         MVC   TVPRTBF+2(26,@07),TVPRTBF+1(@07)                    1375
         MVI   TVPRTBF(@07),C' '                                   1375
*       /*************************************************************/
*       /*                                                           */
*       /* PUT VOLUME SERIAL NUMBER IN BUFFER                @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1376
*       TVPRTSN(BUFFCNTR)=TVBLKSN;  /*                       @Y30LB38*/
*                                                                  1376
         LR    @07,PRINTPTR                                        1376
         AL    @07,@TF00001                                        1376
         AL    @07,@CF01868                                        1376
         MVC   TVPRTSN(6,@07),TVBLKSN(MRGEPTR)                     1376
*       /*************************************************************/
*       /*                                                           */
*       /* PUT THE CARTRIDGE SERIAL NUMBER IN THE BUFFER     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1377
*       TVPRTCS(BUFFCNTR)=TVBLKCS;  /*                       @Y30LB38*/
*                                                                  1377
         LR    @07,PRINTPTR                                        1377
         AL    @07,@TF00001                                        1377
         AL    @07,@CF01869                                        1377
         MVC   TVPRTCS-6(12,@07),TVBLKCS(MRGEPTR)                  1377
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE ATTRIBUTE FLAGS AND PUT VALUES      @Y30LB38*/
*       /* IN BUFFER.                                        @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1378
*       IF TVBLKBND=ON THEN                                        1378
         TM    TVBLKBND(MRGEPTR),B'00000100'                       1378
         BNO   @RF01378                                            1378
*         TVPRTB(BUFFCNTR)=PRINTB;  /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1379
         AL    @07,@TF00001                                        1379
         AL    @07,@CF01858                                        1379
         MVC   TVPRTB-18(1,@07),PRINTB                             1379
*       IF TVBLKWI=ON THEN                                         1380
@RF01378 TM    TVBLKWI(MRGEPTR),B'00000010'                        1380
         BNO   @RF01380                                            1380
*         TVPRTR(BUFFCNTR)=PRINTR;  /*                       @Y30LB38*/
         LR    @07,BUFFCNTR                                        1381
         MH    @07,@CH01312                                        1381
         ALR   @07,PRINTPTR                                        1381
         AL    @07,@CF01859                                        1381
         MVC   TVPRTR-19(1,@07),PRINTR                             1381
*       IF TVBLKSV=ON THEN                                         1382
@RF01380 TM    TVBLKSV(MRGEPTR),B'00100000'                        1382
         BNO   @RF01382                                            1382
*         TVPRTD(BUFFCNTR)=PRINTD;  /*                       @Y30LB38*/
         LR    @07,BUFFCNTR                                        1383
         MH    @07,@CH01312                                        1383
         ALR   @07,PRINTPTR                                        1383
         AL    @07,@CF01860                                        1383
         MVC   TVPRTD-20(1,@07),PRINTD                             1383
*       IF TVBLKEV=ON THEN                                         1384
@RF01382 TM    TVBLKEV(MRGEPTR),B'00010000'                        1384
         BNO   @RF01384                                            1384
*         TVPRTE(BUFFCNTR)=PRINTE;  /*                       @Y30LB38*/
*                                                                  1385
         LR    @07,BUFFCNTR                                        1385
         MH    @07,@CH01312                                        1385
         ALR   @07,PRINTPTR                                        1385
         AL    @07,@CF01861                                        1385
         MVC   TVPRTE-21(1,@07),PRINTE                             1385
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1386
*       TVPRTX1(BUFFCNTR)=TVBLKX1;  /*                       @Y30LB38*/
@RF01384 LR    @07,BUFFCNTR                                        1386
         MH    @07,@CH01312                                        1386
         ST    @07,@TF00001                                        1386
         ALR   @07,PRINTPTR                                        1386
         AL    @07,@CF01862                                        1386
         MVC   TVPRTX1-22(1,@07),TVBLKX1(MRGEPTR)                  1386
*       TVPRTY1(BUFFCNTR)=TVBLKONE; /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1387
         AL    @07,@TF00001                                        1387
         AL    @07,@CF01847                                        1387
         MVC   TVPRTY1-23(1,@07),TVBLKONE(MRGEPTR)                 1387
*       TVBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*       TVBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1389
         AL    @07,@TF00001                                        1389
         AL    @07,@CF01847                                        1389
         NI    TVBIT11-23(@07),B'00111111'                         1389
*       TVPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1390
         AL    @07,@TF00001                                        1390
         AL    @07,@CF01863                                        1390
         MVI   TVPRT1-24(@07),X'00'                                1390
*       IF TVBLKZ1=ON THEN                                         1391
         TM    TVBLKZ1(MRGEPTR),B'00100000'                        1391
         BNO   @RF01391                                            1391
*         TVPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1392
         AL    @07,@TF00001                                        1392
         AL    @07,@CF01863                                        1392
         OI    TVPRTZ1-24(@07),B'00000001'                         1392
*       TVBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*                                                                  1393
@RF01391 LR    @07,BUFFCNTR                                        1393
         MH    @07,@CH01312                                        1393
         ST    @07,@TF00001                                        1393
         ALR   @07,PRINTPTR                                        1393
         AL    @07,@CF01847                                        1393
         NI    TVBIT13-23(@07),B'11011111'                         1393
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE CELL LOCATION FOR THE SECOND CART   @Y30LB38*/
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1394
*       TVPRTX2(BUFFCNTR)=TVBLKX2;  /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1394
         AL    @07,@TF00001                                        1394
         AL    @07,@CF01865                                        1394
         MVC   TVPRTX2-25(1,@07),TVBLKX2(MRGEPTR)                  1394
*       TVPRTY2(BUFFCNTR)=TVBLKTWO; /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1395
         AL    @07,@TF00001                                        1395
         AL    @07,@CF01866                                        1395
         MVC   TVPRTY2-26(1,@07),TVBLKTWO(MRGEPTR)                 1395
*       TVBIT21(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*       TVBIT22(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1397
         AL    @07,@TF00001                                        1397
         AL    @07,@CF01866                                        1397
         NI    TVBIT21-26(@07),B'00111111'                         1397
*       TVPRT2(BUFFCNTR)=''B;       /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1398
         AL    @07,@TF00001                                        1398
         AL    @07,@CF01867                                        1398
         MVI   TVPRT2-27(@07),X'00'                                1398
*       IF TVBLKZ2=ON THEN                                         1399
         TM    TVBLKZ2(MRGEPTR),B'00100000'                        1399
         BNO   @RF01399                                            1399
*         TVPRTZ2(BUFFCNTR)=ON;     /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1400
         AL    @07,@TF00001                                        1400
         AL    @07,@CF01867                                        1400
         OI    TVPRTZ2-27(@07),B'00000001'                         1400
*       TVBIT23(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
@RF01399 LR    @07,BUFFCNTR                                        1401
         MH    @07,@CH01312                                        1401
         ALR   @07,PRINTPTR                                        1401
         AL    @07,@CF01866                                        1401
         NI    TVBIT23-26(@07),B'11011111'                         1401
*     END;                          /*                       @Y30LB38*/
*                                                                  1402
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NEWENT FIELD DOES NOT CONTAIN FF'S AND THE     @Y30LB38*/
*   /* TBLID = SCRATCH CARTRIDGE,PLACE THE NEWENT FIELDS IN THE PRINT*/
*   /* BUFFER. THE CELL LOCATION FIELDS MUST BE REFORMATED TO ONE    */
*   /* BYTE FIELDS IN THE BUFFER.                            @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1403
*   IF NEWENT(1:12)^=STARTVAL&TBLID=CARTID THEN                    1403
@RF01370 CLC   NEWENT(12),STARTVAL                                 1403
         BE    @RF01403                                            1403
         CLI   TBLID,4                                             1403
         BNE   @RF01403                                            1403
*     DO;                           /*                       @Y30LB38*/
*       BUFFCNTR=BUFFCNTR+ONE;      /*                       @Y30LB38*/
         LA    @07,1                                               1405
         ALR   BUFFCNTR,@07                                        1405
*       ENTCNTR=ENTCNTR+ONE;        /*                       @Y30LB38*/
         AL    @07,ENTCNTR                                         1406
         ST    @07,ENTCNTR                                         1406
*       MRGEPTR=ADDR(NEWENT);       /*                       @Y30LB38*/
         LA    MRGEPTR,NEWENT                                      1407
*       SCPRTBF(BUFFCNTR)=' ';      /*                       @Y30LB38*/
*                                                                  1408
         LR    @07,BUFFCNTR                                        1408
         MH    @07,@CH00229                                        1408
         ST    @07,@TF00001                                        1408
         ALR   @07,PRINTPTR                                        1408
         AL    @07,@CF01870                                        1408
         MVI   SCPRTBF+1(@07),C' '                                 1408
         MVC   SCPRTBF+2(13,@07),SCPRTBF+1(@07)                    1408
         MVI   SCPRTBF(@07),C' '                                   1408
*       /*************************************************************/
*       /*                                                           */
*       /* PUT THE CARTRIDGE SERIAL NUMBER IN THE BUFFER     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1409
*       SCPRTCS(BUFFCNTR)=SCBLKCS;  /*                       @Y30LB38*/
*                                                                  1409
         LR    @07,PRINTPTR                                        1409
         AL    @07,@TF00001                                        1409
         AL    @07,@CF01870                                        1409
         MVC   SCPRTCS(12,@07),SCBLKCS(MRGEPTR)                    1409
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSLATE THE CELL LOCATION FOR THE FIRST CART    @Y30LB38*/
*       /* INTO ONE BYTE FIELDS AND PUT IN THE BUFFER.       @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1410
*       SCPRTX1(BUFFCNTR)=SCBLKX1;  /*                       @Y30LB38*/
         SLR   @07,@07                                             1410
         IC    @07,SCBLKX1(,MRGEPTR)                               1410
         L     @03,@TF00001                                        1410
         AL    @03,@CF01865                                        1410
         STC   @07,SCPRTX1-12(@03,PRINTPTR)                        1410
*       SCPRTY1(BUFFCNTR)=SCBLKONE; /*                       @Y30LB38*/
         SLR   @07,@07                                             1411
         IC    @07,SCBLKONE(,MRGEPTR)                              1411
         L     @03,@TF00001                                        1411
         AL    @03,@CF01866                                        1411
         STC   @07,SCPRTY1-13(@03,PRINTPTR)                        1411
*       SCBIT11(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
*       SCBIT12(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1413
         AL    @07,@TF00001                                        1413
         AL    @07,@CF01866                                        1413
         NI    SCBIT11-13(@07),B'00111111'                         1413
*       SCPRT1(BUFFCNTR)=''B;       /*                       @Y30LB38*/
         SLR   @07,@07                                             1414
         L     @03,@TF00001                                        1414
         AL    @03,@CF01867                                        1414
         STC   @07,SCPRT1-14(@03,PRINTPTR)                         1414
*       IF SCBLKZ1=ON THEN                                         1415
         TM    SCBLKZ1(MRGEPTR),B'00100000'                        1415
         BNO   @RF01415                                            1415
*         SCPRTZ1(BUFFCNTR)=ON;     /*                       @Y30LB38*/
         LR    @07,PRINTPTR                                        1416
         AL    @07,@TF00001                                        1416
         AL    @07,@CF01867                                        1416
         OI    SCPRTZ1-14(@07),B'00000001'                         1416
*       SCBIT13(BUFFCNTR)=OFF;      /*                       @Y30LB38*/
@RF01415 LR    @07,BUFFCNTR                                        1417
         MH    @07,@CH00229                                        1417
         ALR   @07,PRINTPTR                                        1417
         AL    @07,@CF01866                                        1417
         NI    SCBIT13-13(@07),B'11011111'                         1417
*     END;                          /*                       @Y30LB38*/
*                                                                  1418
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NEWENT = FF'S, AND THE LINCNTR IS NOT EQUAL TO     @Y30LB38*/
*   /* ZERO AND ENTCNTR IS NOT EQUAL TO ZERO, THEN THE REPORT IS     */
*   /* FINISHED, BUT THE PRINT BUFFER IS NOT FULL. IF THE LINCNTR IS */
*   /* NOT ZERO, PUT IT INTO THE PRINT PARMAMETER LIST AND ISSUE THE */
*   /* UPRINT MACRO TO FINISH PRINTING THE PRINT BUFFER. IF THE      */
*   /* LINCNTR IS ZERO AND ENTCNTR IS NOT, CALL LASTLINR TO PRINT THE*/
*   /* LAST LINE                                             @YM02873*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1419
*   IF NEWENT(1:12)=STARTVAL&(LINCNTR^=ZERO×ENTCNTR>ZERO) THEN     1419
@RF01403 CLC   NEWENT(12),STARTVAL                                 1419
         BNE   @RF01419                                            1419
         SLR   @07,@07                                             1419
         C     @07,LINCNTR                                         1419
         BNE   @RT01419                                            1419
         C     @07,ENTCNTR                                         1419
         BNL   @RF01419                                            1419
@RT01419 DS    0H                                                  1420
*     DO;                           /*                       @YM02873*/
*       IF LINCNTR^=ZERO THEN                                      1421
         L     @07,LINCNTR                                         1421
         LTR   @07,@07                                             1421
         BZ    @RF01421                                            1421
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1423
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1424
         MVC   DARGSMOD(3,@15),@CC01483                            1424
*           DARGCNT=ONE;            /*                       @Y30LB38*/
         LA    @14,1                                               1425
         STH   @14,DARGCNT(,@15)                                   1425
*           DARGPCT(DARGCNT)=LINCNTR;/*                      @ZM00727*/
         LR    @03,@14                                             1426
         SLA   @03,3                                               1426
         STH   @07,DARGPCT-8(@03,@15)                              1426
*           DARGREP(DARGCNT)=ONE;   /*                       @ZM00727*/
         STH   @14,DARGREP-8(@03,@15)                              1427
*           IF TBLID=TRANID THEN                                   1428
         CLI   TBLID,2                                             1428
         BNE   @RF01428                                            1428
*             DO;                   /*                       @Y30LB38*/
*               DARGSENT=LMO14;     /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'0E'                                 1430
*               DARGDBP=ADDR(TVPRTBF(ONE));/*                @Y30LB38*/
         ST    PRINTPTR,DARGDBP(,@15)                              1431
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/
         MVC   DARGILP(2,@15),@CH01448                             1432
*             END;                  /*                       @Y30LB38*/
*           IF TBLID=VOLINVID THEN                                 1434
@RF01428 CLI   TBLID,3                                             1434
         BNE   @RF01434                                            1434
*             DO;                   /*                       @Y30LB38*/
*               DARGSENT=LMO13;     /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1436
         MVI   DARGSENT(@07),X'0D'                                 1436
*               DARGDBP=ADDR(VIPRTBF(ONE));/*                @Y30LB38*/
         ST    PRINTPTR,DARGDBP(,@07)                              1437
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH01448                             1438
*             END;                  /*                       @Y30LB38*/
*           IF TBLID=CARTID THEN                                   1440
@RF01434 CLI   TBLID,4                                             1440
         BNE   @RF01440                                            1440
*             DO;                   /*                       @Y30LB38*/
*               DARGSENT=LMO15;     /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1442
         MVI   DARGSENT(@07),X'0F'                                 1442
*               DARGDBP=ADDR(SCPRTBF(ONE));/*                @Y30LB38*/
         ST    PRINTPTR,DARGDBP(,@07)                              1443
*               DARGILP=PRINTLEN;   /*                       @Y30LB38*/
         MVC   DARGILP(2,@07),@CH01448                             1444
*             END;                  /*                       @Y30LB38*/
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
@RF01440 L     @07,@PC00001                                        1446
         ST    @07,@AL00001                                        1446
         LA    @15,PRINTME                                         1446
         ST    @15,@AL00001+4                                      1446
         LA    @15,DDSTRU                                          1446
         ST    @15,@AL00001+8                                      1446
         MVI   @AL00001+8,X'80'                                    1446
         L     @15,GDTPRT(,@07)                                    1446
         LA    @01,@AL00001                                        1446
         BALR  @14,@15                                             1446
*         END;                      /*                       @Y30LB38*/
*                                                                  1447
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ENTCNTR IS NOT ZERO THIS INDICATES THAT    @Y30LB38*/
*       /* A PARTIAL LINE STILL NEEDS TO BE PRINTED. CALL LASTLINR TO*/
*       /* PRINT THE PARTIAL LINE.                           @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1448
*       IF ENTCNTR^=ZERO THEN                                      1448
@RF01421 L     @07,ENTCNTR                                         1448
         LTR   @07,@07                                             1448
         BZ    @RF01448                                            1448
*         CALL LASTLINR;            /*                       @Y30LB38*/
*                                                                  1449
         BAL   @14,LASTLINR                                        1449
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE COUNTERS TO ZERO FOR THE NEXT REPORT.     @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1450
*       LINCNTR=ZERO;               /*                       @Y30LB38*/
@RF01448 SLR   @07,@07                                             1450
         ST    @07,LINCNTR                                         1450
*       BUFFCNTR=ZERO;              /*                       @Y30LB38*/
         LR    BUFFCNTR,@07                                        1451
*       ENTCNTR=ZERO;               /*                       @Y30LB38*/
         ST    @07,ENTCNTR                                         1452
*     END;                          /*                       @Y30LB38*/
*                                                                  1453
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NEWENT IS NOT FF'S CHECK IF ENTCNTR = ENTYLIM,     @YM01344*/
*   /* THE LINE IS FULL, SO SET ENTCNTR TO 0 AND INCREMENT LINCNTR.  */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1454
*   ELSE                                                           1454
*     DO;                           /*                       @Y30LB38*/
         B     @RC01419                                            1454
@RF01419 DS    0H                                                  1455
*       IF NEWENT(1:12)^=STARTVAL THEN                             1455
         CLC   NEWENT(12),STARTVAL                                 1455
         BE    @RF01455                                            1455
*         DO;                       /*                       @Y30LB38*/
*           IF ENTCNTR=ENTYLIM THEN                                1457
         L     @07,ENTCNTR                                         1457
         SLR   @15,@15                                             1457
         IC    @15,ENTYLIM                                         1457
         CR    @07,@15                                             1457
         BNE   @RF01457                                            1457
*             DO;                   /*                       @Y30LB38*/
*               ENTCNTR=ZERO;       /*                       @Y30LB38*/
         SLR   @07,@07                                             1459
         ST    @07,ENTCNTR                                         1459
*               LINCNTR=LINCNTR+ONE;/*                       @Y30LB38*/
         LA    @07,1                                               1460
         AL    @07,LINCNTR                                         1460
         ST    @07,LINCNTR                                         1460
*             END;                  /*                       @Y30LB38*/
*                                                                  1461
*           /*********************************************************/
*           /*                                                       */
*           /* IF BUFFCNTR = BUFFLIM THEN THE BUFFER IS FULL.        */
*           /*                                               @Y30LB38*/
*           /* SET ENTCNTR, LINCNTR AND BUFFCNTR = 0 AND ISSUE UPRINT*/
*           /* TO PRINT THE BUFFER.                          @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1462
*           IF BUFFCNTR=BUFFLIM THEN                               1462
@RF01457 SLR   @07,@07                                             1462
         IC    @07,BUFFLIM                                         1462
         CR    BUFFCNTR,@07                                        1462
         BNE   @RF01462                                            1462
*             DO;                   /*                       @Y30LB38*/
*               LINCNTR=ZERO;       /*                       @Y30LB38*/
         SLR   @15,@15                                             1464
         ST    @15,LINCNTR                                         1464
*               ENTCNTR=ZERO;       /*                       @Y30LB38*/
         ST    @15,ENTCNTR                                         1465
*               BUFFCNTR=ZERO;      /*                       @Y30LB38*/
         LR    BUFFCNTR,@15                                        1466
*               PRINTAB=''B;        /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1467
*               DARGSMOD=LMOVMSG;   /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1468
         MVC   DARGSMOD(3,@15),@CC01483                            1468
*               DARGCNT=ONE;        /*                       @Y30LB38*/
         LA    @14,1                                               1469
         STH   @14,DARGCNT(,@15)                                   1469
*               DARGREP(DARGCNT)=ONE;/*                      @ZM00727*/
         LR    @03,@14                                             1470
         SLA   @03,3                                               1470
         STH   @14,DARGREP-8(@03,@15)                              1470
*               DARGPCT(DARGCNT)=BUFFLIM/ENTYLIM;/*          @ZM00727*/
         LR    @01,@07                                             1471
         SLR   @00,@00                                             1471
         SLR   @07,@07                                             1471
         IC    @07,ENTYLIM                                         1471
         DR    @00,@07                                             1471
         STH   @01,DARGPCT-8(@03,@15)                              1471
*               IF TBLID=TRANID THEN                               1472
         CLI   TBLID,2                                             1472
         BNE   @RF01472                                            1472
*                 DO;               /*                       @Y30LB38*/
*                   DARGDBP=ADDR(TVPRTBF(ONE));/*            @Y30LB38*/
         ST    PRINTPTR,DARGDBP(,@15)                              1474
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/
         MVC   DARGILP(2,@15),@CH01448                             1475
*                   DARGSENT=LMO14; /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'0E'                                 1476
*                 END;              /*                       @Y30LB38*/
*               IF TBLID=VOLINVID THEN                             1478
@RF01472 CLI   TBLID,3                                             1478
         BNE   @RF01478                                            1478
*                 DO;               /*                       @Y30LB38*/
*                   DARGDBP=ADDR(VIPRTBF(ONE));/*            @Y30LB38*/
         L     @07,DDSTRU                                          1480
         ST    PRINTPTR,DARGDBP(,@07)                              1480
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/
         MVC   DARGILP(2,@07),@CH01448                             1481
*                   DARGSENT=LMO13; /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'0D'                                 1482
*                 END;              /*                       @Y30LB38*/
*               IF TBLID=CARTID THEN                               1484
@RF01478 CLI   TBLID,4                                             1484
         BNE   @RF01484                                            1484
*                 DO;               /*                       @Y30LB38*/
*                   DARGDBP=ADDR(SCPRTBF(ONE));/*            @Y30LB38*/
         L     @07,DDSTRU                                          1486
         ST    PRINTPTR,DARGDBP(,@07)                              1486
*                   DARGILP=PRINTLEN;/*                      @Y30LB38*/
         MVC   DARGILP(2,@07),@CH01448                             1487
*                   DARGSENT=LMO15; /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'0F'                                 1488
*                 END;              /*                       @Y30LB38*/
*               CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*      @Y30LB38*/
@RF01484 L     @07,@PC00001                                        1490
         ST    @07,@AL00001                                        1490
         LA    @15,PRINTME                                         1490
         ST    @15,@AL00001+4                                      1490
         LA    @15,DDSTRU                                          1490
         ST    @15,@AL00001+8                                      1490
         MVI   @AL00001+8,X'80'                                    1490
         L     @15,GDTPRT(,@07)                                    1490
         LA    @01,@AL00001                                        1490
         BALR  @14,@15                                             1490
*             END;                  /*                       @Y30LB38*/
*         END;                      /*                       @Y30LB38*/
@RF01462 DS    0H                                                  1493
*     END;                          /*                       @Y30LB38*/
*                                                                  1493
@RF01455 DS    0H                                                  1494
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1494
*   REG14=RETADDR4;                 /*                       @Y30LB38*/
@RC01419 L     REG14,RETADDR4                                      1494
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             1495
@EL00014 DS    0H                                                  1495
@EF00014 DS    0H                                                  1495
@ER00014 BR    @14                                                 1495
*   END RPTFMTR;                    /*                       @Y30LB38*/
*                                                                  1497
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - SUMARY                              @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE COUNTS THE EMPTY CELLS IN A  @Y30LB38*/
*/*                MSF AND PRINTS THE SUMMARY INFORMATION    @ZM00717*/
*/*                CONTAINED IN THE INTTBL                   @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED TRKBUFF, INTTBL  AND THE    @Y30LB38*/
*/*             FDTTBL                                       @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - PRINTED REPORT AND A RETURN CODE            @Y30LB38*/
*/*              0 = SUCCESSFUL COMPLETION                   @Y30LB38*/
*/*              12 = CELL MAP COULD NOT BE RETREIVED        @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1497
*SUMARY:                                                           1497
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1497
SUMARY   DS    0H                                                  1498
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1498
*   DCL                                                            1498
*     TRKWORD CHAR(256) BASED(TRKPTR);/* DATA FROM TRKBUFF   @Y30LB38*/
*   DCL                                                            1499
*     1 TESTBYTE BIT(8),            /* BYTE FOR BIT SCAN     @Y30LB38*/
*       3 BIT1 BIT(1),              /*                       @Y30LB38*/
*       3 BIT2 BIT(1),              /*                       @Y30LB38*/
*       3 BIT3 BIT(1),              /*                       @Y30LB38*/
*       3 BIT4 BIT(1),              /*                       @Y30LB38*/
*       3 BIT5 BIT(1),              /*                       @Y30LB38*/
*       3 BIT6 BIT(1),              /*                       @Y30LB38*/
*       3 BIT7 BIT(1),              /*                       @Y30LB38*/
*       3 BIT8 BIT(1);              /*                       @Y30LB38*/
*   DCL                                                            1500
*     SUMRCODE FIXED(15);           /* SUMARY RETURN CODE    @Y30LB38*/
*   DCL                                                            1501
*     LMO08 FIXED(8) CONSTANT(08);  /*                       @Y30LB38*/
*   DCL                                                            1502
*     LMO12 FIXED(8) CONSTANT(12);  /*                       @Y30LB38*/
*   DCL                                                            1503
*     CELLREC FIXED(15) CONSTANT(256);/* NUMBER OF BYTES     @Y30LB38
*                                      PER CELL MAP REC      @Y30LB38*/
*                                                                  1504
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1504
*   RETADDR4=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR4                                      1504
*   OLDERID2=NEWERID2;                                             1505
         L     @05,@PC00001                                        1505
         L     @05,GDTTR2(,@05)                                    1505
         MVC   @TS00001(95),NEWERID2(@05)                          1505
         MVC   OLDERID2(95,@05),@TS00001                           1505
*   NEWID2='LMOA';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@05),@CC01773                              1506
*   SUMRCODE=''B;                   /*                       @Y30LB38*/
*                                                                  1507
         SLR   SUMRCODE,SUMRCODE                                   1507
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL TRKRDR TO READ IN THE CELL MAP TRACK. IF THE     @Y30LB38*/
*   /* RETURN CODE IS 12, ISSUE THE UPRINT MACRO AND PRINT MESSAGE   */
*   /* IDC2823I TO INDICATE THE SUMARY REPORT COULD NOT BE PRODUCED  */
*   /* AND SET THE CONDITION CODE = 12.                      @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1508
*   CALL TRKRDR;                    /*                       @Y30LB38*/
         BAL   @14,TRKRDR                                          1508
*   RESPECIFY                                                      1509
*     RTNREG RSTD;                                                 1509
*   TESTRC=RTNREG;                                                 1510
         LR    TESTRC,RTNREG                                       1510
*   RESPECIFY                                                      1511
*     RTNREG UNRSTD;                /*                       @Y30LB38*/
*   SUMRCODE=TESTRC;                /*                       @Y30LB38*/
         LR    SUMRCODE,TESTRC                                     1512
*   IF SUMRCODE=LASTCC12 THEN                                      1513
         C     SUMRCODE,@CF00567                                   1513
         BNE   @RF01513                                            1513
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1515
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1516
         MVC   DARGSMOD(3,@05),@CC01483                            1516
*       DARGSENT=M2823I25;          /*                       @Y30LB38*/
         MVI   DARGSENT(@05),X'19'                                 1517
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB38*/
         L     @05,@PC00001                                        1518
         ST    @05,@AL00001                                        1518
         LA    @15,@CF00116                                        1518
         ST    @15,@AL00001+4                                      1518
         LA    @15,DDSTRU                                          1518
         ST    @15,@AL00001+8                                      1518
         MVI   @AL00001+8,X'80'                                    1518
         L     @15,GDTPRT(,@05)                                    1518
         LA    @01,@AL00001                                        1518
         BALR  @14,@15                                             1518
*     END;                          /*                       @Y30LB38*/
*                                                                  1519
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE IS NOT 12, SET UP THE TRACK     @Y30LB38*/
*   /* POINTER TO POINT TO THE BEGINNING BLOCK IN THE CELL MAP.      */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1520
*   IF SUMRCODE^=LASTCC12 THEN      /*                       @Y30LB38*/
@RF01513 C     SUMRCODE,@CF00567                                   1520
         BE    @RF01520                                            1520
*     DO;                           /*                       @Y30LB38*/
*                                                                  1521
*       /*************************************************************/
*       /*                                                           */
*       /* THE FIRST FIVE RECORDS IN THE TRACK DESCRIBE MSF 0.       */
*       /*                                                   @Y30LB38*/
*       /* THE NEXT FIVE DESCRIBE MSF 1. THE FIRST RECORD OF THE FIVE*/
*       /* IS IRRELEVANT TO THE EMPTY CELL COUNT AND THEREFORE IS NOT*/
*       /* SCANNED. IF THE MSF = 0, INCREMENT PAST THE FIRST RECORD. */
*       /* IF THE MSF = 1, INCREMENT PAST THE FIRST 6 RECORDS.       */
*       /*                                                   @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1522
*       WORK3=TRKPTR;               /*                       @Y30LB38*/
         L     @05,TRKPTR                                          1522
         ST    @05,WORK3                                           1522
*       IF MSFVAL=ZERO THEN                                        1523
         L     @15,@PC00001+4                                      1523
         L     @01,FDTPTR+28(,@15)                                 1523
         L     @15,MSFVAL(,@01)                                    1523
         LTR   @15,@15                                             1523
         BNZ   @RF01523                                            1523
*         TRKPTR=TRKPTR+RECSIZE;    /*                       @Y30LB38*/
         AL    @05,@CF01464                                        1524
         ST    @05,TRKPTR                                          1524
*       ELSE                                                       1525
*         TRKPTR=TRKPTR+(SIX*RECSIZE);/*                     @Y30LB38*/
*                                                                  1525
         B     @RC01523                                            1525
@RF01523 LA    @05,1584                                            1525
         AL    @05,TRKPTR                                          1525
         ST    @05,TRKPTR                                          1525
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP 2 DO LOOPS TO SCAN ALL THE BITS IN THE FOUR        */
*       /*                                                   @Y30LB38*/
*       /* CELL MAP RECORDS. THE FIRST LOOP IS FOR A RECORD AND THE  */
*       /* INNER LOOP SCANS ALL THE BITS WITHIN THAT RECORD. @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1526
*       DO I3=1 BY 1 TO 4;          /*                       @Y30LB38*/
@RC01523 LA    I3,1                                                1526
@DL01526 DS    0H                                                  1527
*         TRKPTR=TRKPTR+LENGTH(PREFIX);/*                    @Y30LB38*/
         LA    @05,8                                               1527
         AL    @05,TRKPTR                                          1527
         ST    @05,TRKPTR                                          1527
*         DO I4=1 BY 1 TO CELLREC;  /*                       @Y30LB38*/
         LA    I4,1                                                1528
@DL01528 DS    0H                                                  1529
*           TESTBYTE=TRKWORD(I4);   /*                       @Y30LB38*/
         L     @05,TRKPTR                                          1529
         ALR   @05,I4                                              1529
         AL    @05,@CF01867                                        1529
         MVC   TESTBYTE(1),TRKWORD(@05)                            1529
*           IF BIT1=ON THEN                                        1530
         TM    BIT1,B'10000000'                                    1530
         BNO   @RF01530                                            1530
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1531
         AL    @05,ECCNTR                                          1531
         ST    @05,ECCNTR                                          1531
*           IF BIT2=ON THEN                                        1532
@RF01530 TM    BIT2,B'01000000'                                    1532
         BNO   @RF01532                                            1532
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1533
         AL    @05,ECCNTR                                          1533
         ST    @05,ECCNTR                                          1533
*           IF BIT3=ON THEN                                        1534
@RF01532 TM    BIT3,B'00100000'                                    1534
         BNO   @RF01534                                            1534
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1535
         AL    @05,ECCNTR                                          1535
         ST    @05,ECCNTR                                          1535
*           IF BIT4=ON THEN                                        1536
@RF01534 TM    BIT4,B'00010000'                                    1536
         BNO   @RF01536                                            1536
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1537
         AL    @05,ECCNTR                                          1537
         ST    @05,ECCNTR                                          1537
*           IF BIT5=ON THEN                                        1538
@RF01536 TM    BIT5,B'00001000'                                    1538
         BNO   @RF01538                                            1538
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1539
         AL    @05,ECCNTR                                          1539
         ST    @05,ECCNTR                                          1539
*           IF BIT6=ON THEN                                        1540
@RF01538 TM    BIT6,B'00000100'                                    1540
         BNO   @RF01540                                            1540
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1541
         AL    @05,ECCNTR                                          1541
         ST    @05,ECCNTR                                          1541
*           IF BIT7=ON THEN                                        1542
@RF01540 TM    BIT7,B'00000010'                                    1542
         BNO   @RF01542                                            1542
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1543
         AL    @05,ECCNTR                                          1543
         ST    @05,ECCNTR                                          1543
*           IF BIT8=ON THEN                                        1544
@RF01542 TM    BIT8,B'00000001'                                    1544
         BNO   @RF01544                                            1544
*             ECCNTR=ECCNTR+ONE;    /*                       @Y30LB38*/
         LA    @05,1                                               1545
         AL    @05,ECCNTR                                          1545
         ST    @05,ECCNTR                                          1545
*         END;                      /*                       @Y30LB38*/
@RF01544 AL    I4,@CF00220                                         1546
         C     I4,@CF01285                                         1546
         BNH   @DL01528                                            1546
*         TRKPTR=TRKPTR+CELLREC;    /*                       @Y30LB38*/
         LA    @05,256                                             1547
         AL    @05,TRKPTR                                          1547
         ST    @05,TRKPTR                                          1547
*       END;                        /*                       @Y30LB38*/
         AL    I3,@CF00220                                         1548
         C     I3,@CF00043                                         1548
         BNH   @DL01526                                            1548
*     END;                          /*                       @Y30LB38*/
*                                                                  1549
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE TRKPTR TO POINT TO START OF TRKBUFF           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1550
*   TRKPTR=WORK3;                   /*                       @Y30LB38*/
*                                                                  1550
@RF01520 L     @05,WORK3                                           1550
         ST    @05,TRKPTR                                          1550
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE UPRINT MACRO TO PRINT THE SUMMARY TITLE     @Y30LB38*/
*   /* AND GO TO THE NEXT PAGE.                              @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1551
*   PRINTAB=''B;                    /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1551
*   DARGSMOD=LMOVMSG;               /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1552
         MVC   DARGSMOD(3,@05),@CC01483                            1552
*   DARGSENT=LMO08;                 /*                       @Y30LB38*/
         MVI   DARGSENT(@05),X'08'                                 1553
*   DARGDBP=ADDR(MSFVAL);           /*                       @YM02897*/
         L     @15,@PC00001+4                                      1554
         L     @15,FDTPTR+28(,@15)                                 1554
         ST    @15,DARGDBP(,@05)                                   1554
*   DARGILP=LENGTH(MSFVAL);         /*                       @YM02897*/
         MVC   DARGILP(2,@05),@CH00043                             1555
*   CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*                  @Y30LB38*/
*                                                                  1556
         L     @05,@PC00001                                        1556
         ST    @05,@AL00001                                        1556
         LA    @15,PRINTME                                         1556
         ST    @15,@AL00001+4                                      1556
         LA    @15,DDSTRU                                          1556
         ST    @15,@AL00001+8                                      1556
         MVI   @AL00001+8,X'80'                                    1556
         L     @15,GDTPRT(,@05)                                    1556
         LA    @01,@AL00001                                        1556
         BALR  @14,@15                                             1556
*   /*****************************************************************/
*   /*                                                               */
*   /* IF TVCNTR IS NOT FF'S PRINT TRANSIENT VOLUME TOTALS.  @Y30LB38*/
*   /* IF VICNTR IS NOT FF'S PRINT VOLUME INVENTORY TOTALS. IF SCCNTR*/
*   /* IS NOT FF'S PRINT SCRATCH CARTRIDGE TOTALS.           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1557
*   IF TVCNTR^=CNTRVAL THEN                                        1557
         CLC   TVCNTR(4),CNTRVAL                                   1557
         BE    @RF01557                                            1557
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1559
*       DARGSENT=LMO09;             /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1560
         MVI   DARGSENT(@05),X'09'                                 1560
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@05),@CC01483                            1561
*       DARGDBP=ADDR(TVCNTR);       /*                       @Y30LB38*/
         LA    @15,TVCNTR                                          1562
         ST    @15,DARGDBP(,@05)                                   1562
*       DARGILP=LENGTH(TVCNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@05),@CH00043                             1563
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @05,@PC00001                                        1564
         ST    @05,@AL00001                                        1564
         LA    @15,PRINTME                                         1564
         ST    @15,@AL00001+4                                      1564
         LA    @15,DDSTRU                                          1564
         ST    @15,@AL00001+8                                      1564
         MVI   @AL00001+8,X'80'                                    1564
         L     @15,GDTPRT(,@05)                                    1564
         LA    @01,@AL00001                                        1564
         BALR  @14,@15                                             1564
*     END;                          /*                       @Y30LB38*/
*   IF VICNTR^=CNTRVAL THEN                                        1566
@RF01557 CLC   VICNTR(4),CNTRVAL                                   1566
         BE    @RF01566                                            1566
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1568
*       DARGSENT=LMO10;             /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1569
         MVI   DARGSENT(@05),X'0A'                                 1569
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@05),@CC01483                            1570
*       DARGDBP=ADDR(VICNTR);       /*                       @Y30LB38*/
         LA    @15,VICNTR                                          1571
         ST    @15,DARGDBP(,@05)                                   1571
*       DARGILP=LENGTH(VICNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@05),@CH00043                             1572
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @05,@PC00001                                        1573
         ST    @05,@AL00001                                        1573
         LA    @15,PRINTME                                         1573
         ST    @15,@AL00001+4                                      1573
         LA    @15,DDSTRU                                          1573
         ST    @15,@AL00001+8                                      1573
         MVI   @AL00001+8,X'80'                                    1573
         L     @15,GDTPRT(,@05)                                    1573
         LA    @01,@AL00001                                        1573
         BALR  @14,@15                                             1573
*     END;                          /*                       @Y30LB38*/
*   IF SCCNTR^=CNTRVAL THEN                                        1575
@RF01566 CLC   SCCNTR(4),CNTRVAL                                   1575
         BE    @RF01575                                            1575
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1577
*       DARGSENT=LMO11;             /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1578
         MVI   DARGSENT(@05),X'0B'                                 1578
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@05),@CC01483                            1579
*       DARGDBP=ADDR(SCCNTR);       /*                       @Y30LB38*/
         LA    @15,SCCNTR                                          1580
         ST    @15,DARGDBP(,@05)                                   1580
*       DARGILP=LENGTH(SCCNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@05),@CH00043                             1581
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @05,@PC00001                                        1582
         ST    @05,@AL00001                                        1582
         LA    @15,PRINTME                                         1582
         ST    @15,@AL00001+4                                      1582
         LA    @15,DDSTRU                                          1582
         ST    @15,@AL00001+8                                      1582
         MVI   @AL00001+8,X'80'                                    1582
         L     @15,GDTPRT(,@05)                                    1582
         LA    @01,@AL00001                                        1582
         BALR  @14,@15                                             1582
*     END;                          /*                       @Y30LB38*/
*                                                                  1583
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE IS NOT 12 PRINT THE EMPTY       @Y30LB38*/
*   /* CELL TOTALS.                                          @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1584
*   IF SUMRCODE^=LASTCC12 THEN                                     1584
@RF01575 C     SUMRCODE,@CF00567                                   1584
         BE    @RF01584                                            1584
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1586
*       DARGSENT=LMO12;             /*                       @Y30LB38*/
         L     @05,DDSTRU                                          1587
         MVI   DARGSENT(@05),X'0C'                                 1587
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         MVC   DARGSMOD(3,@05),@CC01483                            1588
*       DARGDBP=ADDR(ECCNTR);       /*                       @Y30LB38*/
         LA    @15,ECCNTR                                          1589
         ST    @15,DARGDBP(,@05)                                   1589
*       DARGILP=LENGTH(ECCNTR);     /*                       @Y30LB38*/
         MVC   DARGILP(2,@05),@CH00043                             1590
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         L     @05,@PC00001                                        1591
         ST    @05,@AL00001                                        1591
         LA    @15,PRINTME                                         1591
         ST    @15,@AL00001+4                                      1591
         LA    @15,DDSTRU                                          1591
         ST    @15,@AL00001+8                                      1591
         MVI   @AL00001+8,X'80'                                    1591
         L     @15,GDTPRT(,@05)                                    1591
         LA    @01,@AL00001                                        1591
         BALR  @14,@15                                             1591
*     END;                          /*                       @Y30LB38*/
*                                                                  1592
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1593
*   REG14=RETADDR4;                 /*                       @Y30LB38*/
@RF01584 L     REG14,RETADDR4                                      1593
*   RETURN CODE(SUMRCODE);          /*                       @Y30LB38*/
         LR    @15,SUMRCODE                                        1594
@EL00015 DS    0H                                                  1594
@EF00015 DS    0H                                                  1594
@ER00015 BR    @14                                                 1594
*   END SUMARY;                     /*                       @Y30LB38*/
*                                                                  1596
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - MRGLOOP                             @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE MERGES AN INPUT MERGE        @Y30LB38*/
*/*                BLOCK(SOMETIMES EMPTY) WITH THE SORTBLK,  @Y30LB38*/
*/*                INTO AN OUTPUT MERGE BLOCK.               @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - SORTBLK, INTTBL AND THE FOLLOWING PARAMETERS:@Y30LB38*/
*/*              ARG1 = INDEX NUMBER FROM 1 TO 7 TO LOCATE   @Y30LB38*/
*/*                     THE INPUT MERGEBLK AND MRGCNT        @Y30LB38*/
*/*              ARG2 = COUNTER FOR OUTPUT MERGE BLOCK       @Y30LB38*/
*/*              ARG3 = ADDRESS OF OUTPUT MERGE BLOCK        @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - OUTPUT MERGE BLOCK, NUMBER OF ENTRIES       @Y30LB38*/
*/*              PLACED IN THE OUTPUT MERGE BLOCK AND A ZERO @Y30LB38*/
*/*              RETURN CODE                                 @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1596
*MRGLOOP:                                                          1596
*   PROCEDURE(BLKINDEX,MRGCNTRR,MRGBLKAD) OPTIONS(NOSAVE,NOSAVEAREA);
MRGLOOP  MVC   @PC00016(12),0(@01)                                 1596
*                                   /*                       @Y30LB38*/
*                                                                  1597
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1597
*   DCL                                                            1597
*     BLKINDEX FIXED(15);           /* BLOCK INDEX           @Y30LB38*/
*   DCL                                                            1598
*     MRGCNTRR PTR(31);             /* MRGBLK CNTR           @Y30LB38*/
*   DCL                                                            1599
*     MRGBLKAD PTR(31);             /* ADDR OF MRG BLK       @Y30LB38*/
*   DCL                                                            1600
*     SORTENTP PTR(31);             /*                       @Y30LB38*/
*   DCL                                                            1601
*     MRGLCODE FIXED(15);           /* MRGLOOP RETURN CODE@Y30LB38   */
*                                                                  1602
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1602
*   RETADDR8=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR8                                      1602
*   OLDERID2=NEWERID2;                                             1603
         L     @02,@PC00001                                        1603
         L     @02,GDTTR2(,@02)                                    1603
         MVC   @TS00001(95),NEWERID2(@02)                          1603
         MVC   OLDERID2(95,@02),@TS00001                           1603
*   NEWID2='LMLP';                  /*                       @Y30LB38*/
         MVC   NEWID2(4,@02),@CC01785                              1604
*   MRGLCODE=''B;                   /*                       @Y30LB38*/
*                                                                  1605
         SLR   MRGLCODE,MRGLCODE                                   1605
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE A POINTER TO THE LOWEST VALUED ENTRY       @ZM00717*/
*   /* IN THE SORT BLOCK                                     @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1606
*   SORTENTP=SORTENT;               /*                       @Y30LB38*/
         L     @02,SORTPTR                                         1606
         L     SORTENTP,SORTENT(,@02)                              1606
*   RESPECIFY                                                      1607
*     SRTENTRY BASED(SORTENTP);     /*                       @Y30LB38*/
*                                                                  1607
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE A POINTER TO THE FIRST ENTRY IN THE        @ZM00717*/
*   /* INPUT MERGE BLOCK                                     @ZM00717*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1608
*   MGENTPTR=MRGBLKS(BLKINDEX);     /*                       @Y30LB38*/
*                                                                  1608
         L     @15,@PC00016                                        1608
         LH    @15,BLKINDEX(,@15)                                  1608
         SLA   @15,2                                               1608
         L     MGENTPTR,MRGBLKS-4(@15)                             1608
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE HANDLES THREE CONDITIONS OF MERGING.     @Y30LB38*/
*   /* IF BOTH THE INPUT MERGE BLOCK AND THE SORTBLK HAVE ENTRIES,   */
*   /* THEN THE LOWEST ENTRY FROM ONE OF THE BLOCKS IS PLACED IN THE */
*   /* OUTPUT MERGE BLOCK. WHEN ONE OF THE BLOCKS NO LONGER HAVE ANY */
*   /* ENTRIES TO PROCESS THEN ANY REMAINING ENTRIES FROM THE OTHER  */
*   /* BLOCK ARE PLACED IN THE OUTPUT MERGE BLOCK BY ONE OF THE LOOPS*/
*   /* BELOW WHICH HANDLE A NULL SORTBLK AND NON-NULL INPUT MERGE    */
*   /* BLOCK OR A NULL INPUT MERGE BLOCK AND A NON-NULL SORTBLK.     */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1609
*   IF SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)^=ZERO THEN                 1609
         SLR   @14,@14                                             1609
         CH    @14,SORTCNT(,@02)                                   1609
         BE    @RF01609                                            1609
         C     @14,MRGCOUNT-4(@15)                                 1609
         BE    @RF01609                                            1609
*     DO;                           /*                       @Y30LB38*/
*       DO WHILE SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)^=ZERO;/*   @Y30LB38*/
*                                                                  1611
         B     @DE01611                                            1611
@DL01611 DS    0H                                                  1612
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE ENTRY FROM THE SORTBLK IS LOWER, PLACE   @Y30LB38*/
*         /* IT IN THE OUTPUT MERGE BLOCK.                   @Y30LB38*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1612
*         IF SRTITEM(1:KEYLEN)<MGENTPTR->BLKENT(1:KEYLEN) THEN     1612
         SLR   @02,@02                                             1612
         IC    @02,KEYLEN                                          1612
         BCTR  @02,0                                               1612
         EX    @02,@SC01871                                        1612
         BNL   @RF01612                                            1612
*           DO;                     /*                       @ZA08859*/
*             MRGBLKAD->BLKENT(1:ITEMLEN)=SRTITEM(1:ITEMLEN);/*    1614
*                                                            @Y30LB38*/
*                                                                  1614
         L     @02,@PC00016+8                                      1614
         L     @15,MRGBLKAD(,@02)                                  1614
         SLR   @14,@14                                             1614
         IC    @14,ITEMLEN                                         1614
         LR    @01,@14                                             1614
         BCTR  @01,0                                               1614
         EX    @01,@SM01873                                        1614
*             /*******************************************************/
*             /*                                                     */
*             /* SUBTRACT ONE FROM THE COUNT OF ENTRIES      @ZM00717*/
*             /* REMAINING IN THE INPUT SORT BLOCK           @ZM00717*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1615
*             SORTCNT=SORTCNT-ONE;  /*                       @Y30LB38*/
*                                                                  1615
         L     @01,SORTPTR                                         1615
         LH    @00,SORTCNT(,@01)                                   1615
         BCTR  @00,0                                               1615
         STH   @00,SORTCNT(,@01)                                   1615
*             /*******************************************************/
*             /*                                                     */
*             /* ADD TO COUNT OF ENTRIES IN THE OUTPUT MERGE @ZM00717*/
*             /* BLOCK                                       @ZM00717*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1616
*             MRGCNTRR=MRGCNTRR+ONE;/*                       @Y30LB38*/
         L     @01,@PC00016+4                                      1616
         LA    @00,1                                               1616
         AL    @00,MRGCNTRR(,@01)                                  1616
         ST    @00,MRGCNTRR(,@01)                                  1616
*             SORTENTP=SRTFPTR;     /*                       @Y30LB38*/
         L     SORTENTP,SRTFPTR(,SORTENTP)                         1617
*             MRGBLKAD=MRGBLKAD+ITEMLEN;/*                   @Y30LB38*/
         ALR   @15,@14                                             1618
         ST    @15,MRGBLKAD(,@02)                                  1618
*           END;                    /*                       @Y30LB38*/
*         ELSE                                                     1620
*                                                                  1620
*           /*********************************************************/
*           /*                                                       */
*           /* THE ENTRY FROM THE INPUT MRGBLK IS LOWER, SO  @Y30LB38*/
*           /* PLACE IT IN THE OUTPUT MRGBLK.                @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1620
*           DO;                     /*                       @Y30LB38*/
         B     @RC01612                                            1620
@RF01612 DS    0H                                                  1621
*             MRGBLKAD->BLKENT(1:ITEMLEN)=MGENTPTR->BLKENT(1:ITEMLEN);
         L     @02,@PC00016+8                                      1621
         L     @15,MRGBLKAD(,@02)                                  1621
         SLR   @14,@14                                             1621
         IC    @14,ITEMLEN                                         1621
         LR    @01,@14                                             1621
         BCTR  @01,0                                               1621
         EX    @01,@SM01875                                        1621
*             MRGCOUNT(BLKINDEX)=MRGCOUNT(BLKINDEX)-ONE;/*   @Y30LB38*/
         L     @01,@PC00016                                        1622
         LH    @01,BLKINDEX(,@01)                                  1622
         SLA   @01,2                                               1622
         L     @00,MRGCOUNT-4(@01)                                 1622
         BCTR  @00,0                                               1622
         ST    @00,MRGCOUNT-4(@01)                                 1622
*             MRGCNTRR=MRGCNTRR+ONE;/*                       @Y30LB38*/
         L     @01,@PC00016+4                                      1623
         LA    @00,1                                               1623
         AL    @00,MRGCNTRR(,@01)                                  1623
         ST    @00,MRGCNTRR(,@01)                                  1623
*             MRGBLKAD=MRGBLKAD+ITEMLEN;/*                   @Y30LB38*/
         ALR   @15,@14                                             1624
         ST    @15,MRGBLKAD(,@02)                                  1624
*             MGENTPTR=MGENTPTR+ITEMLEN;/*                   @Y30LB38*/
         ALR   MGENTPTR,@14                                        1625
*           END;                    /*                       @Y30LB38*/
*       END;                        /*                       @Y30LB38*/
@RC01612 DS    0H                                                  1627
@DE01611 SLR   @02,@02                                             1627
         L     @01,SORTPTR                                         1627
         CH    @02,SORTCNT(,@01)                                   1627
         BE    @DC01611                                            1627
         L     @15,@PC00016                                        1627
         LH    @15,BLKINDEX(,@15)                                  1627
         SLA   @15,2                                               1627
         C     @02,MRGCOUNT-4(@15)                                 1627
         BNE   @DL01611                                            1627
@DC01611 DS    0H                                                  1628
*     END;                          /*                       @Y30LB38*/
*                                                                  1628
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT TEST IF THE SORTBLK ENTRY COUNT IS NON-ZERO      @Y30LB38*/
*   /* AND THE INPUT MRGBLK IS ZERO. IF SO MOVE ONLY THE ENTRIES FROM*/
*   /* THE SORTBLK INTO THE OUTPUT MRGBLK.                   @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1629
*   IF SORTCNT^=ZERO&MRGCOUNT(BLKINDEX)=ZERO THEN                  1629
@RF01609 SLR   @02,@02                                             1629
         L     @01,SORTPTR                                         1629
         CH    @02,SORTCNT(,@01)                                   1629
         BE    @RF01629                                            1629
         L     @15,@PC00016                                        1629
         LH    @15,BLKINDEX(,@15)                                  1629
         SLA   @15,2                                               1629
         C     @02,MRGCOUNT-4(@15)                                 1629
         BNE   @RF01629                                            1629
*     DO;                           /*                       @Y30LB38*/
*       DO WHILE SORTCNT^=ZERO;     /*                       @Y30LB38*/
         B     @DE01631                                            1631
@DL01631 DS    0H                                                  1632
*         MRGBLKAD->BLKENT(1:ITEMLEN)=SRTITEM(1:ITEMLEN);/*  @Y30LB38*/
         L     @02,@PC00016+8                                      1632
         L     @15,MRGBLKAD(,@02)                                  1632
         SLR   @14,@14                                             1632
         IC    @14,ITEMLEN                                         1632
         LR    @01,@14                                             1632
         BCTR  @01,0                                               1632
         EX    @01,@SM01873                                        1632
*         SORTCNT=SORTCNT-ONE;      /*                       @Y30LB38*/
         L     @01,SORTPTR                                         1633
         LH    @00,SORTCNT(,@01)                                   1633
         BCTR  @00,0                                               1633
         STH   @00,SORTCNT(,@01)                                   1633
*         MRGCNTRR=MRGCNTRR+ONE;    /*                       @Y30LB38*/
         L     @01,@PC00016+4                                      1634
         LA    @00,1                                               1634
         AL    @00,MRGCNTRR(,@01)                                  1634
         ST    @00,MRGCNTRR(,@01)                                  1634
*         MRGBLKAD=MRGBLKAD+ITEMLEN;/*                       @Y30LB38*/
         ALR   @15,@14                                             1635
         ST    @15,MRGBLKAD(,@02)                                  1635
*         SORTENTP=SRTFPTR;         /*                       @Y30LB38*/
         L     SORTENTP,SRTFPTR(,SORTENTP)                         1636
*       END;                        /*                       @Y30LB38*/
@DE01631 L     @02,SORTPTR                                         1637
         LH    @02,SORTCNT(,@02)                                   1637
         LTR   @02,@02                                             1637
         BNZ   @DL01631                                            1637
*     END;                          /*                       @Y30LB38*/
*                                                                  1638
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF THE SORTBLK COUNT = ZERO AND THE INPUT        @Y30LB38*/
*   /* MRGBLK IS NON-ZERO. IF YES, MOVE ONLY THE MRGBLK ENTRIES TO   */
*   /* THE OUTPUT MRGBLK.                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1639
*   IF SORTCNT=ZERO&MRGCOUNT(BLKINDEX)^=ZERO THEN                  1639
@RF01629 SLR   @06,@06                                             1639
         L     @02,SORTPTR                                         1639
         CH    @06,SORTCNT(,@02)                                   1639
         BNE   @RF01639                                            1639
         L     @02,@PC00016                                        1639
         LH    @02,BLKINDEX(,@02)                                  1639
         SLA   @02,2                                               1639
         C     @06,MRGCOUNT-4(@02)                                 1639
         BE    @RF01639                                            1639
*     DO;                           /*                       @Y30LB38*/
*       DO WHILE MRGCOUNT(BLKINDEX)^=ZERO;/*                 @Y30LB38*/
         B     @DE01641                                            1641
@DL01641 DS    0H                                                  1642
*         MRGBLKAD->BLKENT(1:ITEMLEN)=MGENTPTR->BLKENT1(1:ITEMLEN);/*
*                                                            @Y30LB38*/
         L     @06,@PC00016+8                                      1642
         L     @02,MRGBLKAD(,@06)                                  1642
         SLR   @15,@15                                             1642
         IC    @15,ITEMLEN                                         1642
         LR    @14,@15                                             1642
         BCTR  @14,0                                               1642
         EX    @14,@SM01877                                        1642
*         MRGCNTRR=MRGCNTRR+ONE;    /*                       @Y30LB38*/
         L     @14,@PC00016+4                                      1643
         LA    @01,1                                               1643
         AL    @01,MRGCNTRR(,@14)                                  1643
         ST    @01,MRGCNTRR(,@14)                                  1643
*         MRGCOUNT(BLKINDEX)=MRGCOUNT(BLKINDEX)-ONE;/*       @Y30LB38*/
         L     @14,@PC00016                                        1644
         LH    @14,BLKINDEX(,@14)                                  1644
         SLA   @14,2                                               1644
         L     @01,MRGCOUNT-4(@14)                                 1644
         BCTR  @01,0                                               1644
         ST    @01,MRGCOUNT-4(@14)                                 1644
*         MRGBLKAD=MRGBLKAD+ITEMLEN;/*                       @Y30LB38*/
         ALR   @02,@15                                             1645
         ST    @02,MRGBLKAD(,@06)                                  1645
*         MGENTPTR=MGENTPTR+ITEMLEN;/*                       @Y30LB38*/
         ALR   MGENTPTR,@15                                        1646
*       END;                        /*                       @Y30LB38*/
@DE01641 L     @06,@PC00016                                        1647
         LH    @06,BLKINDEX(,@06)                                  1647
         SLA   @06,2                                               1647
         L     @06,MRGCOUNT-4(@06)                                 1647
         LTR   @06,@06                                             1647
         BNZ   @DL01641                                            1647
*     END;                          /*                       @Y30LB38*/
*   RESPECIFY                                                      1649
*     SRTENTRY BASED(CURPTR);       /*                       @Y30LB38*/
*                                                                  1649
@RF01639 DS    0H                                                  1650
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1650
*   REG14=RETADDR8;                 /*                       @Y30LB38*/
         L     REG14,RETADDR8                                      1650
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             1651
@EL00016 DS    0H                                                  1651
@EF00016 DS    0H                                                  1651
@ER00016 BR    @14                                                 1651
*   END MRGLOOP;                    /*                       @Y30LB38*/
*                                                                  1653
*/********************************************************************/
*/*                                                          @Y30LB38*/
*/*     PROCEDURE NAME - LASTLINR                            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     FUNCTION - THIS ROUTINE IS CALLED BY RPTFMTR TO      @Y30LB38*/
*/*                PRINT THE LAST LINE OF THE REPORT WHEN    @Y30LB38*/
*/*                THAT LINE IS NOT COMPLETELY FULL.  IF THE @Y30LB38*/
*/*                VOLUME INVENTORY IS BEING PROCESSED, YOU  @Y30LB38*/
*/*                HAVE TO PRINT A LINE CONTAINING AT LEAST  @Y30LB38*/
*/*                ONE ENTRY, BUT IT MAY CONTAIN TWO, BUT    @Y30LB38*/
*/*                NEVER THREE.  IF THE SCRATCH CARTRIDGE    @Y30LB38*/
*/*                REPORT IS BEING PRODUCED, YOU HAVE TO     @Y30LB38*/
*/*                PRINT AT LEAST ONE ENTRY, MAYBE TWO OR    @Y30LB38*/
*/*                THREE, BUT NEVER FOUR.  IF THE TRANSIENT  @Y30LB38*/
*/*                VOLUME TABLE IS BEING PRODUCED, YOU HAVE  @Y30LB38*/
*/*                TO PRINT ALWAYS ONE ENTRY.                @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     INPUT - WORK AREA CALLED INTTBL, BUFFCNTR  WITH THE  @Y30LB38*/
*/*             NUMBER OF ENTRIES IN THE PRINT BUFFER        @Y30LB38*/
*/*             AND ENTCNTR WITH THE NUMBER OF ENTRIES PER   @Y30LB38*/
*/*             LINE                                         @Y30LB38*/
*/*                                                          @Y30LB38*/
*/*     OUTPUT - REPORT LINE AND ZERO RETURN CODE            @Y30LB38*/
*/*                                                          @Y30LB38*/
*/********************************************************************/
*                                                                  1653
*LASTLINR:                                                         1653
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB38*/
*                                                                  1653
LASTLINR DS    0H                                                  1654
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCAL DECLARATIONS                                    @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1654
*   DCL                                                            1654
*     LMO05 FIXED(8) CONSTANT(5);   /* LMO STID 05           @Y30LB38*/
*   DCL                                                            1655
*     LMO20 FIXED(8) CONSTANT(20);  /* LMO STID 20           @Y30LB38*/
*   DCL                                                            1656
*     LMO21 FIXED(8) CONSTANT(21);  /* LMO STID 21           @Y30LB38*/
*                                                                  1657
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS AND DO INITIALIZATION             @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*   RETADDR5=REG14;                 /*                       @Y30LB38*/
         ST    REG14,RETADDR5                                      1657
*   OLDERID2=NEWERID2;                                             1658
         L     @07,@PC00001                                        1658
         L     @15,GDTTR2(,@07)                                    1658
         MVC   @TS00001(95),NEWERID2(@15)                          1658
         MVC   OLDERID2(95,@15),@TS00001                           1658
*   NEWID2='LMPA';                  /*                       @Y30LB38*/
*                                                                  1659
         MVC   NEWID2(4,@15),@CC01795                              1659
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID INDICATES A TRANSIENT VOLUME ENTRY,      @Y30LB38*/
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */
*   /*                                                       @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1660
*   IF TBLID=TRANID THEN                                           1660
         CLI   TBLID,2                                             1660
         BNE   @RF01660                                            1660
*     DO;                           /*                       @Y30LB38*/
*       PRINTAB=''B;                /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1662
*       DARGSMOD=LMOVMSG;           /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1663
         MVC   DARGSMOD(3,@15),@CC01483                            1663
*       DARGSENT=LMO05;             /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'05'                                 1664
*       DARGDBP=ADDR(TVPRTBF(BUFFCNTR));/*                   @Y30LB38*/
         LA    @14,28                                              1665
         LR    @01,BUFFCNTR                                        1665
         MR    @00,@14                                             1665
         AL    @01,@CF01868                                        1665
         LA    @03,TVPRTBF(@01,PRINTPTR)                           1665
         ST    @03,DARGDBP(,@15)                                   1665
*       DARGILP=LENGTH(TVPRTBF(BUFFCNTR));/*                 @Y30LB38*/
         STH   @14,DARGILP(,@15)                                   1666
*       CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*              @Y30LB38*/
         ST    @07,@AL00001                                        1667
         LA    @15,PRINTME                                         1667
         ST    @15,@AL00001+4                                      1667
         LA    @15,DDSTRU                                          1667
         ST    @15,@AL00001+8                                      1667
         MVI   @AL00001+8,X'80'                                    1667
         L     @15,GDTPRT(,@07)                                    1667
         LA    @01,@AL00001                                        1667
         BALR  @14,@15                                             1667
*     END;                          /*                       @Y30LB38*/
*                                                                  1668
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID INDICATES A VOLUME INVENTORY ENTRY,      @Y30LB38*/
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */
*   /* THE INDEX INTO THE PRINT BUFFER IS A FIELD CALLED BUFFCNTR    */
*   /* USED AS A SUBSCRIPT.                                  @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1669
*   IF TBLID=VOLINVID THEN                                         1669
@RF01660 CLI   TBLID,3                                             1669
         BNE   @RF01669                                            1669
*     DO;                           /*                       @Y30LB38*/
*                                                                  1670
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE NUMBER OF ENTRIES = 1, SET THE POINTER TO THE      */
*       /*                                                   @Y30LB38*/
*       /* LAST ENTRY IN THE BUFFER AND ISSUE THE UPRINT MACRO TO    */
*       /* PRINT THE LAST LINE OF THE REPORT. IF THE NUMBER OF       */
*       /* ENTRIES = 2 SET THE DATA BLOCK POINTER TO THE NEXT TO THE */
*       /* LAST ENTRY AND SET UP THE PARAMETER LIST UP FOR 8 INSERTS.*/
*       /* EACH INSERT WILL BE A FIELD IN THE LAST ENTRY.    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1671
*       IF ENTCNTR=ONE THEN                                        1671
         CLC   ENTCNTR(4),@CF00220                                 1671
         BNE   @RF01671                                            1671
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1673
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1674
         MVC   DARGSMOD(3,@07),@CC01483                            1674
*           DARGSENT=LMO20;         /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'14'                                 1675
*           DARGDBP=ADDR(VIPRTBF(BUFFCNTR));/*               @Y30LB38*/
         LR    @15,BUFFCNTR                                        1676
         SLA   @15,4                                               1676
         AL    @15,@CF01857                                        1676
         LA    @15,VIPRTBF(@15,PRINTPTR)                           1676
         ST    @15,DARGDBP(,@07)                                   1676
*           DARGILP=LENGTH(VIPRTBF(BUFFCNTR));/*             @Y30LB38*/
         MVC   DARGILP(2,@07),@CH00475                             1677
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        1678
         ST    @07,@AL00001                                        1678
         LA    @15,PRINTME                                         1678
         ST    @15,@AL00001+4                                      1678
         LA    @15,DDSTRU                                          1678
         ST    @15,@AL00001+8                                      1678
         MVI   @AL00001+8,X'80'                                    1678
         L     @15,GDTPRT(,@07)                                    1678
         LA    @01,@AL00001                                        1678
         BALR  @14,@15                                             1678
*         END;                      /*                       @Y30LB38*/
*       IF ENTCNTR=TWO THEN                                        1680
@RF01671 LA    @07,2                                               1680
         C     @07,ENTCNTR                                         1680
         BNE   @RF01680                                            1680
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1682
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1683
         MVC   DARGSMOD(3,@15),@CC01483                            1683
*           DARGSENT=LMO20;         /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'14'                                 1684
*           DARGDBP=ADDR(VIPRTBF(BUFFCNTR-ONE));/*           @Y30LB38*/
         LR    @14,BUFFCNTR                                        1685
         SLA   @14,4                                               1685
         LR    @01,PRINTPTR                                        1685
         AL    @01,@CF01879                                        1685
         LA    @03,VIPRTBF(@14,@01)                                1685
         ST    @03,DARGDBP(,@15)                                   1685
*           DARGILP=LENGTH(VIPRTBF(ONE));/*                  @Y30LB38*/
         MVC   DARGILP(2,@15),@CH00475                             1686
*           DARGCNT=EIGHT;          /*                       @Y30LB38*/
*                                                                  1687
         LA    @03,8                                               1687
         STH   @03,DARGCNT(,@15)                                   1687
*           /*********************************************************/
*           /*                                                       */
*           /* SETUP THE MESSAGE FOR 8 INSERTS. THE FIRST WILL       */
*           /*                                               @Y30LB38*/
*           /* BE THE VOLUME SERIAL NUMBER. NEXT WILL BE THE         */
*           /* ATTRIBUTES AND LAST WILL BE 3 BYTES OF CELL LOCATION. */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1688
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/
         LA    @02,1                                               1688
         STH   @02,DARGINS(,@15)                                   1688
*           DARGINL(1)=LENGTH(VIPRTSN(BUFFCNTR));/*          @Y30LB38*/
         LA    @01,6                                               1689
         STH   @01,DARGINL(,@15)                                   1689
*           DARGDTM(1)=ADDR(VIPRTSN(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1690
         AL    @07,@CF01857                                        1690
         LA    @07,VIPRTSN(@14,@07)                                1690
         ST    @07,DARGDTM(,@15)                                   1690
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/
         LA    @07,2                                               1691
         STH   @07,DARGINS+8(,@15)                                 1691
*           DARGDTM(2)=ADDR(VIPRTATR(BUFFCNTR));/*           @Y30LB38*/
         LR    @07,PRINTPTR                                        1692
         AL    @07,@CF01858                                        1692
         LA    @07,VIPRTATR-6(@14,@07)                             1692
         ST    @07,DARGDTM+8(,@15)                                 1692
*           DARGINL(2)=LENGTH(VIPRTATR(BUFFCNTR));/*         @Y30LB38*/
*                                                                  1693
         LA    @07,4                                               1693
         STH   @07,DARGINL+8(,@15)                                 1693
*           /*********************************************************/
*           /*                                                       */
*           /* PUT CELL LOCATIONS IN MESSAGE                 @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1694
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/
         MVC   DARGINS+16(2,@15),@CH00163                          1694
*           DARGINL(3)=LENGTH(VIPRTX1(BUFFCNTR));/*          @Y30LB38*/
         STH   @02,DARGINL+16(,@15)                                1695
*           DARGDTM(3)=ADDR(VIPRTX1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1696
         AL    @07,@CF01862                                        1696
         LA    @07,VIPRTX1-10(@14,@07)                             1696
         ST    @07,DARGDTM+16(,@15)                                1696
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/
         LA    @07,4                                               1697
         STH   @07,DARGINS+24(,@15)                                1697
*           DARGINL(4)=LENGTH(VIPRTY1(BUFFCNTR));/*          @Y30LB38*/
         STH   @02,DARGINL+24(,@15)                                1698
*           DARGDTM(4)=ADDR(VIPRTY1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1699
         AL    @07,@CF01847                                        1699
         LA    @07,VIPRTY1-11(@14,@07)                             1699
         ST    @07,DARGDTM+24(,@15)                                1699
*           DARGINS(5)=FIVE;        /*                       @Y30LB38*/
         MVC   DARGINS+32(2,@15),@CH00287                          1700
*           DARGINL(5)=LENGTH(VIPRT1(BUFFCNTR));/*           @Y30LB38*/
         STH   @02,DARGINL+32(,@15)                                1701
*           DARGDTM(5)=ADDR(VIPRTZ1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1702
         AL    @07,@CF01863                                        1702
         LA    @07,VIPRTZ1-12(@14,@07)                             1702
         ST    @07,DARGDTM+32(,@15)                                1702
*           DARGINS(6)=SIX;         /*                       @Y30LB38*/
         STH   @01,DARGINS+40(,@15)                                1703
*           DARGINL(6)=LENGTH(VIPRTX2(BUFFCNTR));/*          @Y30LB38*/
         STH   @02,DARGINL+40(,@15)                                1704
*           DARGDTM(6)=ADDR(VIPRTX2(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1705
         AL    @07,@CF01865                                        1705
         LA    @07,VIPRTX2-13(@14,@07)                             1705
         ST    @07,DARGDTM+40(,@15)                                1705
*           DARGINS(7)=SEVEN;       /*                       @Y30LB38*/
         MVC   DARGINS+48(2,@15),@CH00659                          1706
*           DARGINL(7)=LENGTH(VIPRTY2(BUFFCNTR));/*          @Y30LB38*/
         STH   @02,DARGINL+48(,@15)                                1707
*           DARGDTM(7)=ADDR(VIPRTY2(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1708
         AL    @07,@CF01866                                        1708
         LA    @07,VIPRTY2-14(@14,@07)                             1708
         ST    @07,DARGDTM+48(,@15)                                1708
*           DARGINS(8)=EIGHT;       /*                       @Y30LB38*/
         STH   @03,DARGINS+56(,@15)                                1709
*           DARGINL(8)=LENGTH(VIPRT2(BUFFCNTR));/*           @Y30LB38*/
         STH   @02,DARGINL+56(,@15)                                1710
*           DARGDTM(8)=ADDR(VIPRTZ2(BUFFCNTR));/*            @Y30LB38*/
         AL    @14,@CF01867                                        1711
         LA    @07,VIPRTZ2-15(@14,PRINTPTR)                        1711
         ST    @07,DARGDTM+56(,@15)                                1711
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        1712
         ST    @07,@AL00001                                        1712
         LA    @15,PRINTME                                         1712
         ST    @15,@AL00001+4                                      1712
         LA    @15,DDSTRU                                          1712
         ST    @15,@AL00001+8                                      1712
         MVI   @AL00001+8,X'80'                                    1712
         L     @15,GDTPRT(,@07)                                    1712
         LA    @01,@AL00001                                        1712
         BALR  @14,@15                                             1712
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1714
@RF01680 DS    0H                                                  1715
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE TBLID INDICATES A SCRATCH CARTRIDGE ENTRY,     @Y30LB38*/
*   /* ISSUE THE UPRINT MACRO TO PRINT THE LAST LINE OF THE REPORT.  */
*   /* THE INDEX INTO THE PRINT BUFFER IS A FIELD CALLED BUFFCNTR    */
*   /* USED AS A SUBSCRIPT. THE LENGTH OF A SCRATCH CARTRIDGE ENTRY  */
*   /* IS 15.                                                @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1715
*   IF TBLID=CARTID THEN                                           1715
@RF01669 CLI   TBLID,4                                             1715
         BNE   @RF01715                                            1715
*     DO;                           /*                       @Y30LB38*/
*                                                                  1716
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE NUMBER OF ENTRIES = 1, SET THE POINTER TO THE      */
*       /*                                                   @Y30LB38*/
*       /* LAST ENTRY IN THE BUFFER AND ISSUE THE UPRINT MACRO TO    */
*       /* PRINT THE LAST LINE OF THE REPORT. IF THE NUMBER OF       */
*       /* ENTRIES = 2 SET THE DATA BLOCK POINTER TO THE NEXT TO THE */
*       /* LAST ENTRY AND SET UP THE PARAMETER LIST UP FOR 4 INSERTS.*/
*       /* EACH INSERT WILL BE A FIELD IN THE LAST ENTRY.    @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1717
*       IF ENTCNTR=ONE THEN                                        1717
         CLC   ENTCNTR(4),@CF00220                                 1717
         BNE   @RF01717                                            1717
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1719
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @07,DDSTRU                                          1720
         MVC   DARGSMOD(3,@07),@CC01483                            1720
*           DARGSENT=LMO21;         /*                       @Y30LB38*/
         MVI   DARGSENT(@07),X'15'                                 1721
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR));/*               @Y30LB38*/
         LA    @15,15                                              1722
         LR    @01,BUFFCNTR                                        1722
         MR    @00,@15                                             1722
         AL    @01,@CF01870                                        1722
         LA    @14,SCPRTBF(@01,PRINTPTR)                           1722
         ST    @14,DARGDBP(,@07)                                   1722
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR));/*             @Y30LB38*/
         STH   @15,DARGILP(,@07)                                   1723
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        1724
         ST    @07,@AL00001                                        1724
         LA    @15,PRINTME                                         1724
         ST    @15,@AL00001+4                                      1724
         LA    @15,DDSTRU                                          1724
         ST    @15,@AL00001+8                                      1724
         MVI   @AL00001+8,X'80'                                    1724
         L     @15,GDTPRT(,@07)                                    1724
         LA    @01,@AL00001                                        1724
         BALR  @14,@15                                             1724
*         END;                      /*                       @Y30LB38*/
*       IF ENTCNTR=TWO THEN                                        1726
@RF01717 LA    @07,2                                               1726
         C     @07,ENTCNTR                                         1726
         BNE   @RF01726                                            1726
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1728
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1729
         MVC   DARGSMOD(3,@15),@CC01483                            1729
*           DARGSENT=LMO21;         /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'15'                                 1730
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR-ONE));/*           @Y30LB38*/
         LA    @14,15                                              1731
         LR    @01,BUFFCNTR                                        1731
         MR    @00,@14                                             1731
         LR    @03,PRINTPTR                                        1731
         AL    @03,@CF01880                                        1731
         LA    @00,SCPRTBF(@01,@03)                                1731
         ST    @00,DARGDBP(,@15)                                   1731
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR-ONE));/*         @Y30LB38*/
         STH   @14,DARGILP(,@15)                                   1732
*           DARGCNT=FOUR;           /*                       @Y30LB38*/
         LA    @14,4                                               1733
         STH   @14,DARGCNT(,@15)                                   1733
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/
         LA    @03,1                                               1734
         STH   @03,DARGINS(,@15)                                   1734
*           DARGINL(1)=LENGTH(SCPRTCS(BUFFCNTR));/*          @Y30LB38*/
         MVC   DARGINL(2,@15),@CH00567                             1735
*           DARGDTM(1)=ADDR(SCPRTCS(BUFFCNTR));/*            @Y30LB38*/
         LR    @02,PRINTPTR                                        1736
         AL    @02,@CF01870                                        1736
         LA    @00,SCPRTCS(@01,@02)                                1736
         ST    @00,DARGDTM(,@15)                                   1736
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/
         STH   @07,DARGINS+8(,@15)                                 1737
*           DARGINL(2)=LENGTH(SCPRTX1(BUFFCNTR));/*          @Y30LB38*/
         STH   @03,DARGINL+8(,@15)                                 1738
*           DARGDTM(2)=ADDR(SCPRTX1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1739
         AL    @07,@CF01865                                        1739
         LA    @07,SCPRTX1-12(@01,@07)                             1739
         ST    @07,DARGDTM+8(,@15)                                 1739
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/
         MVC   DARGINS+16(2,@15),@CH00163                          1740
*           DARGINL(3)=LENGTH(SCPRTY1(BUFFCNTR));/*          @Y30LB38*/
         STH   @03,DARGINL+16(,@15)                                1741
*           DARGDTM(3)=ADDR(SCPRTY1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1742
         AL    @07,@CF01866                                        1742
         LA    @07,SCPRTY1-13(@01,@07)                             1742
         ST    @07,DARGDTM+16(,@15)                                1742
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/
         STH   @14,DARGINS+24(,@15)                                1743
*           DARGINL(4)=LENGTH(SCPRT1(BUFFCNTR));/*           @Y30LB38*/
         STH   @03,DARGINL+24(,@15)                                1744
*           DARGDTM(4)=ADDR(SCPRTZ1(BUFFCNTR));/*            @Y30LB38*/
         AL    @01,@CF01867                                        1745
         LA    @07,SCPRTZ1-14(@01,PRINTPTR)                        1745
         ST    @07,DARGDTM+24(,@15)                                1745
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        1746
         ST    @07,@AL00001                                        1746
         LA    @15,PRINTME                                         1746
         ST    @15,@AL00001+4                                      1746
         LA    @15,DDSTRU                                          1746
         ST    @15,@AL00001+8                                      1746
         MVI   @AL00001+8,X'80'                                    1746
         L     @15,GDTPRT(,@07)                                    1746
         LA    @01,@AL00001                                        1746
         BALR  @14,@15                                             1746
*         END;                      /*                       @Y30LB38*/
*                                                                  1747
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE NUMBER OF ENTRIES = 3, SET THE DATA BLOCK  @Y30LB38*/
*       /* POINTER TO THE FIRST OF THE THREE ENTRIES IN THE PRINT    */
*       /* BUFFER. SET UP FOR 8 INSERTS WITH FOUR FIELDS BEING IN THE*/
*       /* NEXT TO LAST ENTRY AND FOUR FROM THE LAST ENTRY.  @Y30LB38*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1748
*       IF ENTCNTR=THREE THEN                                      1748
@RF01726 LA    @07,3                                               1748
         C     @07,ENTCNTR                                         1748
         BNE   @RF01748                                            1748
*         DO;                       /*                       @Y30LB38*/
*           PRINTAB=''B;            /*                       @Y30LB38*/
         XC    PRINTAB(84),PRINTAB                                 1750
*           DARGSMOD=LMOVMSG;       /*                       @Y30LB38*/
         L     @15,DDSTRU                                          1751
         MVC   DARGSMOD(3,@15),@CC01483                            1751
*           DARGSENT=LMO21;         /*                       @Y30LB38*/
         MVI   DARGSENT(@15),X'15'                                 1752
*           DARGDBP=ADDR(SCPRTBF(BUFFCNTR-TWO));/*           @Y30LB38*/
         LA    @14,15                                              1753
         LR    @01,BUFFCNTR                                        1753
         MR    @00,@14                                             1753
         LR    @03,PRINTPTR                                        1753
         AL    @03,@CF01881                                        1753
         LA    @00,SCPRTBF(@01,@03)                                1753
         ST    @00,DARGDBP(,@15)                                   1753
*           DARGILP=LENGTH(SCPRTBF(BUFFCNTR-TWO));/*         @Y30LB38*/
         STH   @14,DARGILP(,@15)                                   1754
*           DARGCNT=EIGHT;          /*                       @Y30LB38*/
*                                                                  1755
         LA    @14,8                                               1755
         STH   @14,DARGCNT(,@15)                                   1755
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP THE MESSAGE FOR 3 INSERTS. USE THE LAST        */
*           /*                                               @Y30LB38*/
*           /* 3 FIELDS OF THE LAST ENTRY IN THE PRINT BUFFER.       */
*           /*                                               @Y30LB38*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1756
*           DARGINS(1)=ONE;         /*                       @Y30LB38*/
         LA    @03,1                                               1756
         STH   @03,DARGINS(,@15)                                   1756
*           DARGINL(1)=LENGTH(SCPRTCS(BUFFCNTR-ONE));/*      @Y30LB38*/
         LA    @02,12                                              1757
         STH   @02,DARGINL(,@15)                                   1757
*           DARGDTM(1)=ADDR(SCPRTCS(BUFFCNTR-ONE));/*        @Y30LB38*/
         LR    @07,PRINTPTR                                        1758
         AL    @07,@CF01880                                        1758
         LA    @07,SCPRTCS(@01,@07)                                1758
         ST    @07,DARGDTM(,@15)                                   1758
*           DARGINS(2)=TWO;         /*                       @Y30LB38*/
         MVC   DARGINS+8(2,@15),@CH00154                           1759
*           DARGINL(2)=LENGTH(SCPRTX1(BUFFCNTR-ONE));/*      @Y30LB38*/
         STH   @03,DARGINL+8(,@15)                                 1760
*           DARGDTM(2)=ADDR(SCPRTX1(BUFFCNTR-ONE));/*        @Y30LB38*/
         LR    @07,PRINTPTR                                        1761
         AL    @07,@CF01882                                        1761
         LA    @07,SCPRTX1-12(@01,@07)                             1761
         ST    @07,DARGDTM+8(,@15)                                 1761
*           DARGINS(3)=THREE;       /*                       @Y30LB38*/
         LA    @07,3                                               1762
         STH   @07,DARGINS+16(,@15)                                1762
*           DARGINL(3)=LENGTH(SCPRTY1(BUFFCNTR-ONE));/*      @Y30LB38*/
         STH   @03,DARGINL+16(,@15)                                1763
*           DARGDTM(3)=ADDR(SCPRTY1(BUFFCNTR-ONE));/*        @Y30LB38*/
         LR    @07,PRINTPTR                                        1764
         AL    @07,@CF01883                                        1764
         LA    @07,SCPRTY1-13(@01,@07)                             1764
         ST    @07,DARGDTM+16(,@15)                                1764
*           DARGINS(4)=FOUR;        /*                       @Y30LB38*/
         MVC   DARGINS+24(2,@15),@CH00043                          1765
*           DARGINL(4)=LENGTH(SCPRT1(BUFFCNTR-ONE));/*       @Y30LB38*/
         STH   @03,DARGINL+24(,@15)                                1766
*           DARGDTM(4)=ADDR(SCPRTZ1(BUFFCNTR-ONE));/*        @Y30LB38*/
         LR    @07,PRINTPTR                                        1767
         AL    @07,@CF01857                                        1767
         LA    @07,SCPRTZ1-14(@01,@07)                             1767
         ST    @07,DARGDTM+24(,@15)                                1767
*           DARGINS(5)=FIVE;        /*                       @Y30LB38*/
         MVC   DARGINS+32(2,@15),@CH00287                          1768
*           DARGINL(5)=LENGTH(SCPRTCS(BUFFCNTR));/*          @Y30LB38*/
         STH   @02,DARGINL+32(,@15)                                1769
*           DARGDTM(5)=ADDR(SCPRTCS(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1770
         AL    @07,@CF01870                                        1770
         LA    @07,SCPRTCS(@01,@07)                                1770
         ST    @07,DARGDTM+32(,@15)                                1770
*           DARGINS(6)=SIX;         /*                       @Y30LB38*/
         MVC   DARGINS+40(2,@15),@CH00157                          1771
*           DARGINL(6)=LENGTH(SCPRTX1(BUFFCNTR));/*          @Y30LB38*/
         STH   @03,DARGINL+40(,@15)                                1772
*           DARGDTM(6)=ADDR(SCPRTX1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1773
         AL    @07,@CF01865                                        1773
         LA    @07,SCPRTX1-12(@01,@07)                             1773
         ST    @07,DARGDTM+40(,@15)                                1773
*           DARGINS(7)=SEVEN;       /*                       @Y30LB38*/
         MVC   DARGINS+48(2,@15),@CH00659                          1774
*           DARGINL(7)=LENGTH(SCPRTY1(BUFFCNTR));/*          @Y30LB38*/
         STH   @03,DARGINL+48(,@15)                                1775
*           DARGDTM(7)=ADDR(SCPRTY1(BUFFCNTR));/*            @Y30LB38*/
         LR    @07,PRINTPTR                                        1776
         AL    @07,@CF01866                                        1776
         LA    @07,SCPRTY1-13(@01,@07)                             1776
         ST    @07,DARGDTM+48(,@15)                                1776
*           DARGINS(8)=EIGHT;       /*                       @Y30LB38*/
         STH   @14,DARGINS+56(,@15)                                1777
*           DARGINL(8)=LENGTH(SCPRT1(BUFFCNTR));/*           @Y30LB38*/
         STH   @03,DARGINL+56(,@15)                                1778
*           DARGDTM(8)=ADDR(SCPRTZ1(BUFFCNTR));/*            @Y30LB38*/
         AL    @01,@CF01867                                        1779
         LA    @07,SCPRTZ1-14(@01,PRINTPTR)                        1779
         ST    @07,DARGDTM+56(,@15)                                1779
*           CALL AMSTP011(GDTTBL,PRINTME,DDSTRU);/*          @Y30LB38*/
         L     @07,@PC00001                                        1780
         ST    @07,@AL00001                                        1780
         LA    @04,PRINTME                                         1780
         ST    @04,@AL00001+4                                      1780
         LA    @04,DDSTRU                                          1780
         ST    @04,@AL00001+8                                      1780
         MVI   @AL00001+8,X'80'                                    1780
         L     @15,GDTPRT(,@07)                                    1780
         LA    @01,@AL00001                                        1780
         BALR  @14,@15                                             1780
*         END;                      /*                       @Y30LB38*/
*     END;                          /*                       @Y30LB38*/
*                                                                  1782
@RF01748 DS    0H                                                  1783
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1783
*   REG14=RETADDR5;                 /*                       @Y30LB38*/
@RF01715 L     REG14,RETADDR5                                      1783
*   RETURN CODE(LASTCC00);          /*                       @Y30LB38*/
         SLR   @15,@15                                             1784
@EL00017 DS    0H                                                  1784
@EF00017 DS    0H                                                  1784
@ER00017 BR    @14                                                 1784
*   END LASTLINR;                   /*                       @Y30LB38*/
*                                                                  1786
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1786
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1786
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00018                                    1786
         MVC   @PC00018(8),0(@01)                                  1786
*                                   /*                       @Y30LB39*/
*                                                                  1787
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1787
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1787
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1787
*                                   /*                       @Y30LB39*/
*   DCL                                                            1787
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1788
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1788
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1789
*                                   /*                       @Y30LB39*/
*   DCL                                                            1789
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1790
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1790
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1791
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1791
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1791
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1792
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1792
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1792
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1793
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1793
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1793
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1794
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1794
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1794
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1795
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1795
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1796
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1796
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1796
         L     @15,@PC00001                                        1796
         L     @14,GDTTR2(,@15)                                    1796
         MVC   @TS00001(95),NEWERID2(@14)                          1796
         MVC   OLDERID2(95,@14),@TS00001                           1796
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1797
         MVC   NEWID2(4,@14),@CC01817                              1797
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1798
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1798
         LA    @14,SSDRGLT                                         1798
         ST    @14,SSDLPTR                                         1798
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1799
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1799
         L     @07,@PC00018                                        1799
         L     @07,SSRCODE(,@07)                                   1799
         LTR   @07,@07                                             1799
         BNP   @RF01799                                            1799
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1800
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1801
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1801
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1802
         ST    @03,DARGRETP(,@14)                                  1802
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            1803
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 1804
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1805
         MVC   DARGRETL(2,@14),@CH01830                            1805
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1806
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1806
         ST    @15,@AL00001                                        1806
         LA    @03,@CF00116                                        1806
         ST    @03,@AL00001+4                                      1806
         LA    @03,SSDLPTR                                         1806
         ST    @03,@AL00001+8                                      1806
         MVI   @AL00001+8,X'80'                                    1806
         L     @15,GDTPRT(,@15)                                    1806
         LA    @01,@AL00001                                        1806
         BALR  @14,@15                                             1806
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1807
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1807
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   1808
@DL01808 DS    0H                                                  1809
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00220                                   1809
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1810
@DE01808 L     @03,@PC00018                                        1810
         LR    @15,ENTRYNUM                                        1810
         ALR   @15,@15                                             1810
         LH    @15,SSARRAY-2(@15)                                  1810
         CH    @15,SSRHALF(,@03)                                   1810
         BE    @DC01808                                            1810
         SLR   @14,@14                                             1810
         CR    @15,@14                                             1810
         BNE   @DL01808                                            1810
@DC01808 DS    0H                                                  1811
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1811
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1811
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @07,SSDLPTR                                         1812
         MVC   DARGSMOD(3,@07),SSMODSS0                            1812
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@07)                             1813
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             1814
         BNE   @RF01814                                            1814
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@07)                                   1816
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@07),@CH00043                             1817
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1820
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1820
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01799                                            1820
@RF01799 DS    0H                                                  1821
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1821
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         1822
         MVC   DARGSMOD(3,@15),SSMODCM0                            1822
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            1823
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00018+4                                      1824
         ST    @14,DARGDBP(,@15)                                   1824
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00220                             1825
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1826
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1827
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1827
@RC01799 L     @15,@PC00001                                        1827
         ST    @15,@AL00001                                        1827
         LA    @14,@CF00116                                        1827
         ST    @14,@AL00001+4                                      1827
         LA    @14,SSDLPTR                                         1827
         ST    @14,@AL00001+8                                      1827
         MVI   @AL00001+8,X'80'                                    1827
         L     @15,GDTPRT(,@15)                                    1827
         LA    @01,@AL00001                                        1827
         BALR  @14,@15                                             1827
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1828
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1828
         L     @14,@SA00018                                        1828
         LM    @00,@12,@SA00018+8                                  1828
         BR    @14                                                 1828
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCLM01                     /*                       @Y30LB38*/
*                                                                  1830
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSLM )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1830
*       ;                                                          1830
@DATA    DS    0H
@CH00154 DC    H'2'
@CH00163 DC    H'3'
@CH00287 DC    H'5'
@CH00157 DC    H'6'
@CH00229 DC    H'15'
@CH00311 DC    H'24'
@CH01312 DC    H'28'
@CH01823 DC    H'38'
@CH01830 DC    H'120'
@CH01824 DC    H'242'
@CH01410 DC    H'363'
@CH01448 DC    H'3800'
@SC01848 CLC   SRTITEM(0,CURPTR),NEWENT
@SM01850 MVC   SRTITEM(0,CURPTR),NEWENT
@SC01853 CLC   NEWENT(0),BLKENT(MGENTPTR)
@SM01855 MVC   NEWENT(0),BLKENT(MGENTPTR)
@SC01871 CLC   SRTITEM(0,SORTENTP),BLKENT(MGENTPTR)
@SM01873 MVC   BLKENT(0,@15),SRTITEM(SORTENTP)
@SM01875 MVC   BLKENT(0,@15),BLKENT(MGENTPTR)
@SM01877 MVC   BLKENT(0,@02),BLKENT1(MGENTPTR)
         DS    0F
@AL01196 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL01288 DC    A(@CC01491)             LIST WITH   2 ARGUMENT(S)
         DC    AL1(X'80')
         DC    AL3(ALL)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00018 DS    15F
@PC00018 DS    2F
@PC00016 DS    3F
@AL00001 DS    6A
@TF00001 DS    F
@AFTEMPS DS    2F
IDCLM01  CSECT
         DS    0F
@CF00116 DC    F'0'
@CF00220 DC    F'1'
@CH00220 EQU   @CF00220+2
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00659 DC    F'7'
@CH00659 EQU   @CF00659+2
@CF00180 DC    F'8'
@CH00180 EQU   @CF00180+2
@CF00445 DC    F'10'
@CF00567 DC    F'12'
@CH00567 EQU   @CF00567+2
@CF00475 DC    F'16'
@CH00475 EQU   @CF00475+2
@CF01463 DC    F'18'
@CF00222 DC    F'32'
@CF01541 DC    F'84'
@CF01822 DC    F'96'
@CH01822 EQU   @CF01822+2
@CF01682 DC    F'121'
@CF01555 DC    F'142'
@CF01548 DC    F'166'
@CF01285 DC    F'256'
@CF01464 DC    F'264'
@CH01464 EQU   @CF01464+2
@CF01649 DC    F'2048'
@CF01818 DC    F'7600'
@CF01820 DC    F'16048'
@CF01881 DC    F'-45'
@CF01879 DC    F'-32'
@CF01880 DC    F'-30'
@CF01868 DC    F'-28'
@CF01869 DC    F'-22'
@CF01882 DC    F'-18'
@CF01883 DC    F'-17'
@CF01857 DC    F'-16'
@CF01870 DC    F'-15'
@CF01858 DC    F'-10'
@CF01859 DC    F'-9'
@CF01860 DC    F'-8'
@CF01861 DC    F'-7'
@CF01862 DC    F'-6'
@CF01847 DC    F'-5'
@CF01863 DC    F'-4'
@CF01865 DC    F'-3'
@CF01866 DC    F'-2'
@CF01867 DC    F'-1'
@CF01843 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
COTPTR   DS    A
ACQPTR   DS    A
RETADDR1 DS    A
RETADDR2 DS    A
RETADDR3 DS    A
RETADDR4 DS    A
RETADDR5 DS    A
RETADDR6 DS    A
RETADDR7 DS    A
RETADDR8 DS    A
PRINTME  DS    A
TRKPTR   DS    A
CKPTR    DS    A
WORKPTR  DS    A
ALLOCPTR DS    A
BLOCKPTR DS    A
ENTPTR   DS    A
SORTPTR  DS    A
EXGPTR   DS    A
REASONCD DS    F
WORK1    DS    F
WORK3    DS    F
ENTCNTR  DS    F
LINCNTR  DS    F
CORESIZE DS    F
RTNAREA  DS    A
VOLSRPTR DS    A
UCBPTR   DS    A
NEWFPTR  DS    A
MRGADDR  DS    A
MRGCNTR  DS    F
MRGPOOL  DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
I2       DS    H
I6       DS    H
I7       DS    H
I9       DS    H
RPTCODE  DS    H
SORTCODE DS    H
MRGCODE  DS    H
SETRC    DS    H
LISTLN   DS    FL1
@TS00001 DS    CL95
PRINTAB  DS    CL84
FLAGS    DS    BL1
         ORG   FLAGS
BADMSF   DS    BL1
GOTCORE  EQU   FLAGS+0
FIRSTTIM EQU   FLAGS+0
ACQSW    EQU   FLAGS+0
@NM00098 EQU   FLAGS+0
         ORG   FLAGS+1
         DS    CL3
INTTBL   DS    CL159
         ORG   INTTBL
TBLNAME  DS    CL6
TBLID    DS    FL1
EXTADR   DS    CL10
         ORG   EXTADR
SBDY     DS    CL5
         ORG   SBDY
SCYL     DS    CL2
STRK     DS    CL2
SREC     DS    CL1
         ORG   EXTADR+5
EBDY     DS    CL5
         ORG   EBDY
ECYL     DS    CL2
ETRK     DS    CL2
EREC     DS    CL1
         ORG   INTTBL+17
WRKVOL   DS    CL6
LASTRK   DS    CL5
         ORG   LASTRK
C        DS    CL2
H        DS    CL2
R        DS    CL1
         ORG   INTTBL+28
MRGBLKS  DS    7A
MRGCOUNT DS    7A
SCCNTR   DS    FL4
VICNTR   DS    FL4
TVCNTR   DS    FL4
ECCNTR   DS    FL4
BLKITEMS DS    FL4
KEYLEN   DS    FL1
ITEMLEN  DS    FL1
ADDRDIF  DS    CL2
ENTYLIM  DS    FL1
BUFFLIM  DS    FL1
INTTRKS  DS    CL25
         ORG   INTTRKS
MAPADDR  DS    CL5
         ORG   MAPADDR
@NM00124 DS    CL1
MAPCC    DS    FL1
@NM00125 DS    CL1
MAPHH    DS    FL1
MAPRR    DS    FL1
         ORG   INTTRKS+5
TRANADDR DS    CL5
         ORG   TRANADDR
@NM00126 DS    CL1
TRANCC   DS    FL1
@NM00127 DS    CL1
TRANHH   DS    FL1
TRANRR   DS    FL1
         ORG   INTTRKS+10
VOLIADDR DS    CL5
         ORG   VOLIADDR
@NM00128 DS    CL1
VOLCC    DS    FL1
@NM00129 DS    CL1
VOLHH    DS    FL1
VOLRR    DS    FL1
         ORG   INTTRKS+15
CARTADDR DS    CL5
         ORG   CARTADDR
@NM00130 DS    CL1
CARTCC   DS    FL1
@NM00131 DS    CL1
CARTHH   DS    FL1
CARTRR   DS    FL1
         ORG   INTTRKS+20
CONFADDR DS    CL5
         ORG   CONFADDR
@NM00132 DS    CL1
CONCC    DS    FL1
@NM00133 DS    CL1
CONHH    DS    FL1
CONRR    DS    FL1
         ORG   INTTBL+135
NEWENT   DS    CL24
         ORG   INTTBL+159
TITLBUFF DS    CL363
OPENLIST DS    CL384
UCBLIST  DS    CL29
EXOLIST  DS    CL34
ALOCLIST DS    CL31
ACQLISTT DS    CL96
COTLISTT DS    CL24
EXGARG1  DS    CL32
DMPSTG   DS    CL17
PRNTCONS DS    CL4
         ORG   PRNTCONS
PRINTB   DS    CL1
PRINTR   DS    CL1
PRINTD   DS    CL1
PRINTE   DS    CL1
         ORG   PRNTCONS+4
IOINFO   DS    CL1
         DS    CL2
INFOAREA DS    CL38
         ORG   INFOAREA
WORKLEN  DS    FL2
RETNLEN  DS    FL2
TYPE     DS    FL2
DATALEN  DS    FL2
VOLAREA  DS    5CL6
         ORG   INFOAREA+38
UNITLIST DS    CL12
         ORG   UNITLIST
COUNT    DS    FL2
DEVLEN   DS    FL2
DEVTYPE  DS    CL8
         ORG   UNITLIST+12
DDNAME   DS    CL8
ECB      DS    CL1
         DS    CL1
CCHHR    DS    CL5
         ORG   CCHHR
CC       DS    FL2
HH       DS    FL2
RR       DS    FL1
         ORG   CCHHR+5
         DS    CL3
PCARG    DS    CL33
         ORG   PCARG
PCMTLP   DS    AL4
PCSTLP   DS    AL4
PCFLP    DS    AL4
PCPCP    DS    AL4
PCPNL    DS    FL2
PCPTL    DS    FL2
PCPDL    DS    FL2
PCMTLC   DS    FL2
PCSTLC   DS    FL2
PCFLC    DS    FL2
PCLW     DS    FL2
PCPD     DS    FL2
PCDSC    DS    AL1
         ORG   PCARG+33
TESTBYTE DS    BL1
         ORG   TESTBYTE
BIT1     DS    BL1
BIT2     EQU   TESTBYTE+0
BIT3     EQU   TESTBYTE+0
BIT4     EQU   TESTBYTE+0
BIT5     EQU   TESTBYTE+0
BIT6     EQU   TESTBYTE+0
BIT7     EQU   TESTBYTE+0
BIT8     EQU   TESTBYTE+0
         ORG   TESTBYTE+1
SSDRGLT  DS    CL20
         DS    CL2
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCLM01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
CNTRVAL  DC    XL4'7FFFFFFF'
NOREPT   DC    XL2'7FFF'
SSMSGNUM DC    AL1(56)
@CC01590 DC    C'COTBLIST'
@CC01531 DC    C'ACQLIST'
@CC01524 DC    C'SDG00'
@CC01491 DC    C'LM01'
@CC01496 DC    C'LMAA'
@CC01507 DC    C'LMAZ'
@CC01528 DC    C'LMBA'
@CC01533 DC    C'LMBF'
@CC01561 DC    C'LMCA'
@CC01568 DC    C'LMDA'
@CC01588 DC    C'LMEA'
@CC01591 DC    C'LMEB'
@CC01601 DC    C'LMFA'
@CC01608 DC    C'LMGA'
@CC01614 DC    C'LMHA'
@CC01631 DC    C'LMIA'
@CC01640 DC    C'LMJA'
@CC01650 DC    C'LMKA'
@CC01681 DC    C'LMLA'
@CC01690 DC    C'LMMA'
@CC01753 DC    C'LMNA'
@CC01773 DC    C'LMOA'
@CC01785 DC    C'LMLP'
@CC01795 DC    C'LMPA'
@CC01817 DC    C'SSAA'
@CC01481 DC    C'UV0'
@CC01483 EQU   @CC01491
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
CHARZERO DC    X'0000000000'
LMZERO   DC    CL8'00000000'
STARTVAL DC    X'FFFFFFFFFFFFFFFFFFFFFFFF'
MODID    DC    CL4'LM01'
FIXAREA  DS    CL650
         ORG   FIXAREA
@NM00134 DC    650X'00'
         ORG   FIXAREA+650
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
MRGLCODE EQU   @03
SORTENTP EQU   @06
SUMRCODE EQU   @04
MRGEPTR  EQU   @02
HEADCODE EQU   @03
NEWPTR   EQU   @06
NEWBPTR  EQU   @02
FMTRCODE EQU   @06
ITEMCODE EQU   @06
BLKCODE  EQU   @06
TRKCODE  EQU   @07
CYLWORK  EQU   @02
CARTWORK EQU   @02
MSFCODE  EQU   @06
RPTCCODE EQU   @06
OPENCODE EQU   @06
MGENTPTR EQU   @03
BUFFCNTR EQU   @04
WORK2    EQU   @02
I8       EQU   @02
I4       EQU   @02
I3       EQU   @03
I        EQU   @07
CURPTR   EQU   @03
PRINTPTR EQU   @05
CONFPTR  EQU   @02
EXOPTR   EQU   @07
DMPINDEX EQU   @02
OPNPTR   EQU   @06
TESTRC   EQU   @03
REG8     EQU   @08
REG9     EQU   @09
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG14    EQU   @14
ARR1     EQU   @01
COTBR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
IDCSAEP0 EQU   0
IDCSAGS0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAFP0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDSN   EQU   ALLAGL
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLSTS   EQU   ALLAGL+24
ALLSTSOD EQU   ALLSTS
ALLDSP   EQU   ALLAGL+25
ALLDSPKP EQU   ALLDSP
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTDS EQU   ALLOPT
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOOP0 EQU   0
IDCIOCL0 EQU   0
IDCIOSI0 EQU   0
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNOPTOT EQU   OPNOPT
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNMODAC EQU   OPNMOD
OPNIOC   EQU   OPNAGL+4
OPNDDN   EQU   OPNAGL+8
OPNDSN   EQU   OPNAGL+16
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
IOINFVOL EQU   IOINFOPT
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
AMSTP042 EQU   0
AMSTP044 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGREP  EQU   DARGINS
DARGINL  EQU   DARGARY+2
DARGPCT  EQU   DARGINL
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTREALCC EQU   CTMSG+1
CTARRAY  EQU   CTMSG+4
CTTBLCC  EQU   CTARRAY+1
CTTBLHH  EQU   CTARRAY+2
CTTBLRR  EQU   CTARRAY+3
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKLABELP EQU   CKAGL+24
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXODDN   EQU   EXOARG+8
EXOEXT   EQU   EXOARG+24
EXOCTLBK EQU   EXOARG+28
EXOPT    EQU   EXOARG+32
EXOTAB   EQU   EXOPT
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXGCTLBK EQU   EXGARG+8
EXGCCHH1 EQU   EXGARG+12
EXGCCHH2 EQU   EXGARG+16
EXGRECNO EQU   EXGARG+20
EXGDATAP EQU   EXGARG+24
EXGDATAL EQU   EXGARG+30
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
WFILE    EQU   0
WFILEVAL EQU   WFILE+1
WDS      EQU   0
WDSFLG   EQU   WDS+10
WDSVAL   EQU   WDS+21
MNT      EQU   0
NMNT     EQU   0
CART     EQU   0
SUMRY    EQU   0
AL       EQU   0
MSF      EQU   0
MSFVAL   EQU   MSF
OFILE    EQU   0
OFILEVAL EQU   OFILE+1
ODS      EQU   0
ODSFLG   EQU   ODS+10
ODSVAL   EQU   ODS+21
COTBLIST EQU   0
COTBFLG  EQU   COTBLIST+6
COTBTID  EQU   COTBFLG
COTBEXTS EQU   COTBLIST+8
COTBVOL  EQU   COTBLIST+12
ACQLIST  EQU   0
ARLL     EQU   ACQLIST
AROP     EQU   ACQLIST+4
ARFLG    EQU   ACQLIST+6
ARBDUBD  EQU   ARFLG
ARINH    EQU   ARFLG
ARNMEXT  EQU   ACQLIST+7
ARVOL    EQU   ACQLIST+8
AREXT    EQU   ACQLIST+28
BLKENT   EQU   0
BLKENT1  EQU   0
BLKTBL   EQU   0
PREFIX   EQU   BLKTBL
VOLCNTL  EQU   BLKTBL+8
@NM00099 EQU   VOLCNTL
LASTABLK EQU   @NM00099
LASTTRK  EQU   @NM00099
BLKUSED  EQU   @NM00099
OVERFLOW EQU   @NM00099
ENTLEN   EQU   VOLCNTL+1
NUMENT   EQU   VOLCNTL+3
TRACKPTR EQU   VOLCNTL+4
CYL      EQU   TRACKPTR+1
HEAD     EQU   TRACKPTR+2
ENTRYY   EQU   BLKTBL+16
INVENTRY EQU   0
VVOLFLGS EQU   INVENTRY+6
VCARTONE EQU   INVENTRY+8
V1L2     EQU   VCARTONE
VCARTTWO EQU   INVENTRY+10
TRKBUFF  EQU   0
TRANENT  EQU   0
TCARTONE EQU   TRANENT
T1L2     EQU   TCARTONE
TCARTTWO EQU   TRANENT+2
TCARSNUM EQU   TRANENT+4
TVOLSER  EQU   TRANENT+16
TVOLFLGS EQU   TRANENT+22
SCRENT   EQU   0
SCARTNUM EQU   SCRENT+4
SCARTONE EQU   SCRENT+16
CONMAP   EQU   0
CONENT   EQU   CONMAP+8
CNTLBYTE EQU   CONENT
DATASTGR EQU   CNTLBYTE
MSF1     EQU   CNTLBYTE
VIPRTBF  EQU   0
VIPRTSN  EQU   VIPRTBF
VIPRTATR EQU   VIPRTBF+6
VIPRTB   EQU   VIPRTATR
VIPRTR   EQU   VIPRTATR+1
VIPRTD   EQU   VIPRTATR+2
VIPRTE   EQU   VIPRTATR+3
VIPRTX1  EQU   VIPRTBF+10
VIPRTY1  EQU   VIPRTBF+11
VIBIT11  EQU   VIPRTY1
VIBIT12  EQU   VIPRTY1
VIBIT13  EQU   VIPRTY1
VIPRT1   EQU   VIPRTBF+12
VIPRTZ1  EQU   VIPRT1
VIPRTX2  EQU   VIPRTBF+13
VIPRTY2  EQU   VIPRTBF+14
VIBIT21  EQU   VIPRTY2
VIBIT22  EQU   VIPRTY2
VIBIT23  EQU   VIPRTY2
VIPRT2   EQU   VIPRTBF+15
VIPRTZ2  EQU   VIPRT2
TVPRTBF  EQU   0
TVPRTSN  EQU   TVPRTBF
TVPRTCS  EQU   TVPRTBF+6
TVPRTB   EQU   TVPRTBF+18
TVPRTR   EQU   TVPRTBF+19
TVPRTD   EQU   TVPRTBF+20
TVPRTE   EQU   TVPRTBF+21
TVPRTX1  EQU   TVPRTBF+22
TVPRTY1  EQU   TVPRTBF+23
TVBIT11  EQU   TVPRTY1
TVBIT12  EQU   TVPRTY1
TVBIT13  EQU   TVPRTY1
TVPRT1   EQU   TVPRTBF+24
TVPRTZ1  EQU   TVPRT1
TVPRTX2  EQU   TVPRTBF+25
TVPRTY2  EQU   TVPRTBF+26
TVBIT21  EQU   TVPRTY2
TVBIT22  EQU   TVPRTY2
TVBIT23  EQU   TVPRTY2
TVPRT2   EQU   TVPRTBF+27
TVPRTZ2  EQU   TVPRT2
SCPRTBF  EQU   0
SCPRTCS  EQU   SCPRTBF
SCPRTX1  EQU   SCPRTBF+12
SCPRTY1  EQU   SCPRTBF+13
SCBIT11  EQU   SCPRTY1
SCBIT12  EQU   SCPRTY1
SCBIT13  EQU   SCPRTY1
SCPRT1   EQU   SCPRTBF+14
SCPRTZ1  EQU   SCPRT1
SORTBLK  EQU   0
SORTENT  EQU   SORTBLK
SORTCNT  EQU   SORTBLK+4
SORTUNIT EQU   SORTBLK+6
SRTENTRY EQU   0
SORTPTRS EQU   SRTENTRY
SRTFPTR  EQU   SORTPTRS
SRTBPTR  EQU   SORTPTRS+4
SRTITEM  EQU   SRTENTRY+8
TRKADDR  EQU   0
VIBLKENT EQU   0
VIBLKSN  EQU   VIBLKENT
VIVLKFLG EQU   VIBLKENT+6
VIBLKSV  EQU   VIVLKFLG
VIBLKEV  EQU   VIVLKFLG
VIBLKBND EQU   VIVLKFLG
VIBLKWI  EQU   VIVLKFLG
@NM00141 EQU   VIBLKENT+8
VIBLKONE EQU   @NM00141
VIBLKZ1  EQU   VIBLKONE
VIBLKX1  EQU   @NM00141+1
@NM00142 EQU   VIBLKENT+10
VIBLKTWO EQU   @NM00142
VIBLKZ2  EQU   VIBLKTWO
VIBLKX2  EQU   @NM00142+1
TVBLKENT EQU   0
TVBLKSN  EQU   TVBLKENT
TVBLKCS  EQU   TVBLKENT+6
@NM00143 EQU   TVBLKENT+18
TVBLKONE EQU   @NM00143
TVBLKZ1  EQU   TVBLKONE
TVBLKX1  EQU   @NM00143+1
@NM00144 EQU   TVBLKENT+20
TVBLKTWO EQU   @NM00144
TVBLKZ2  EQU   TVBLKTWO
TVBLKX2  EQU   @NM00144+1
TVVLKFLG EQU   TVBLKENT+22
TVBLKSV  EQU   TVVLKFLG
TVBLKEV  EQU   TVVLKFLG
TVBLKBND EQU   TVVLKFLG
TVBLKWI  EQU   TVVLKFLG
SCBLKENT EQU   0
SCBLKCS  EQU   SCBLKENT
@NM00147 EQU   SCBLKENT+12
SCBLKONE EQU   @NM00147
SCBLKZ1  EQU   SCBLKONE
SCBLKX1  EQU   @NM00147+1
TRKWORD  EQU   0
AMSTP041 EQU   0
AMSTP043 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
BLKINDEX EQU   0
MRGCNTRR EQU   0
MRGBLKAD EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
TVNEWENT EQU   NEWENT
TVVOLSN  EQU   TVNEWENT
TVCARTSN EQU   TVNEWENT+6
TVCART1  EQU   TVNEWENT+18
TVCART2  EQU   TVNEWENT+20
TVFLAGS  EQU   TVNEWENT+22
SCNEWENT EQU   NEWENT
SCCARTSN EQU   SCNEWENT
SCCART1  EQU   SCNEWENT+12
*                                      START UNREFERENCED COMPONENTS
@NM00136 EQU   SCNEWENT+14
@NM00135 EQU   TVNEWENT+23
@NM00148 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
SCBLKY1  EQU   SCBLKONE
SCBLKMS1 EQU   SCBLKONE
@NM00146 EQU   TVVLKFLG
@NM00145 EQU   TVVLKFLG
TVBLKY2  EQU   TVBLKTWO
TVBLKMS2 EQU   TVBLKTWO
TVBLKY1  EQU   TVBLKONE
TVBLKMS1 EQU   TVBLKONE
VIBLKY2  EQU   VIBLKTWO
VIBLKMS2 EQU   VIBLKTWO
VIBLKY1  EQU   VIBLKONE
VIBLKMS1 EQU   VIBLKONE
@NM00140 EQU   VIBLKENT+7
@NM00139 EQU   VIVLKFLG
@NM00138 EQU   VIVLKFLG
@NM00137 EQU   VIVLKFLG
@NM00123 EQU   SCPRT1
@NM00122 EQU   SCPRTY1
@NM00121 EQU   TVPRT2
@NM00120 EQU   TVPRTY2
@NM00119 EQU   TVPRT1
@NM00118 EQU   TVPRTY1
@NM00117 EQU   VIPRT2
@NM00116 EQU   VIPRTY2
@NM00115 EQU   VIPRT1
@NM00114 EQU   VIPRTY1
@NM00113 EQU   CONMAP+136
@NM00112 EQU   CONENT+1
MSF3     EQU   CNTLBYTE
MSF2     EQU   CNTLBYTE
MSF0     EQU   CNTLBYTE
@NM00111 EQU   CNTLBYTE
CPREFIX  EQU   CONMAP
@NM00110 EQU   SCRENT+18
S1X      EQU   SCARTONE+1
S1Y      EQU   SCARTONE
S1Z      EQU   SCARTONE
S1L2     EQU   SCARTONE
S1L1     EQU   SCARTONE
@NM00109 EQU   SCRENT
@NM00108 EQU   TRANENT+23
@NM00107 EQU   TVOLFLGS
TWRITINH EQU   TVOLFLGS
TBNDVOL  EQU   TVOLFLGS
@NM00106 EQU   TVOLFLGS
TEXCVOL  EQU   TVOLFLGS
TSECRVOL EQU   TVOLFLGS
@NM00105 EQU   TVOLFLGS
T2X      EQU   TCARTTWO+1
T2Y      EQU   TCARTTWO
T2Z      EQU   TCARTTWO
T2L2     EQU   TCARTTWO
T2L1     EQU   TCARTTWO
T1X      EQU   TCARTONE+1
T1Y      EQU   TCARTONE
T1Z      EQU   TCARTONE
T1L1     EQU   TCARTONE
V2X      EQU   VCARTTWO+1
V2Y      EQU   VCARTTWO
V2Z      EQU   VCARTTWO
V2L2     EQU   VCARTTWO
V2L1     EQU   VCARTTWO
V1X      EQU   VCARTONE+1
V1Y      EQU   VCARTONE
V1Z      EQU   VCARTONE
V1L1     EQU   VCARTONE
@NM00104 EQU   INVENTRY+7
@NM00103 EQU   VVOLFLGS
VWRITINH EQU   VVOLFLGS
VBNDVOL  EQU   VVOLFLGS
@NM00102 EQU   VVOLFLGS
VEXCVOL  EQU   VVOLFLGS
VSECRVOL EQU   VVOLFLGS
@NM00101 EQU   VVOLFLGS
VOLID    EQU   INVENTRY
REC      EQU   TRACKPTR+3
@NM00100 EQU   TRACKPTR
MAXENT   EQU   VOLCNTL+2
HASHARA2 EQU   @NM00099
HASHARA1 EQU   @NM00099
TRKEND   EQU   @NM00099
LASTBLK  EQU   @NM00099
ARNEDB   EQU   ACQLIST+92
@NM00097 EQU   AREXT
ARCOMPC  EQU   ACQLIST+26
@NM00096 EQU   ACQLIST+25
ARHOST   EQU   ACQLIST+20
ARECB    EQU   ACQLIST+16
ARASID   EQU   ACQLIST+14
@NM00095 EQU   ARFLG
ARDRES   EQU   ARFLG
@NM00094 EQU   ACQLIST+5
COTBECB  EQU   COTBLIST+20
COTBASID EQU   COTBLIST+18
@NM00093 EQU   COTBFLG+1
COTBTRI  EQU   COTBFLG+1
COTBTRA  EQU   COTBFLG+1
COTBTRY  EQU   COTBFLG+1
COTBTRX  EQU   COTBFLG+1
@NM00092 EQU   COTBFLG
@NM00091 EQU   COTBLIST+5
COTBOP   EQU   COTBLIST+4
COTBLL   EQU   COTBLIST
ODSLEN   EQU   ODS+20
ODSMEM   EQU   ODS+12
ODSMLN   EQU   ODS+11
ODSFUQ   EQU   ODSFLG
ODSPOS   EQU   ODS+9
ODSPAS   EQU   ODS+1
ODSPLN   EQU   ODS
OFILELEN EQU   OFILE
WDSLEN   EQU   WDS+20
WDSMEM   EQU   WDS+12
WDSMLN   EQU   WDS+11
WDSFUQ   EQU   WDSFLG
WDSPOS   EQU   WDS+9
WDSPAS   EQU   WDS+1
WDSPLN   EQU   WDS
WFILELEN EQU   WFILE
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00058 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNPWA   EQU   OPNAGL+12
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RC00465 EQU   @RC00458
@RC00521 EQU   @RC00507
@RF00566 EQU   @RC00562
@RC00919 EQU   @RC00915
@RC01162 EQU   @RC01154
@RF01814 EQU   @RC01799
@PB00018 EQU   @EL00001
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCLM01,(C'PLS2102',0603,76301)

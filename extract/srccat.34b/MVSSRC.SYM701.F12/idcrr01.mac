         TITLE '********** IDCRR01: REMOVEVR FUNCTION SUPPORT ROUTINE **
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRR01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRR01   75.225'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @10,4095(,@12)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0229
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN CONTROL ROUTING SECTION OF REMOVEVR. @Y30LB11*/
*   /* MESSAGES ISSUED IN THIS ROUTINE ARE IDC0001I, AND     @Y30LB11*/
*   /* IDC3003I. THE EXIT POINT FROM THE REMOVEVR FSR IS     @Y30LB11*/
*   /* CONTAINED IN THIS PROCEDURE.                          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0229
*                                                                  0229
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO REMOVEVR                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0229
*   OLDERID2=NEWERID2;                                             0229
         L     @05,@PC00001                                        0229
         L     @15,GDTTR2(,@05)                                    0229
         MVC   @TS00001(95),NEWERID2(@15)                          0229
         MVC   OLDERID2(95,@15),@TS00001                           0229
*   NEWID2='RRRM';                  /* TRACE MACRO           @Y30LB11*/
*                                                                  0230
         MVC   NEWID2(4,@15),@CC01145                              0230
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE PROCESSING REMOVE VOLUME RECORD       */
*   /* REQUEST.                                              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0231
*   IF GDTDBG=NULLPTR THEN                                         0231
         L     @05,GDTDBG(,@05)                                    0231
         LTR   @05,@05                                             0231
         BZ    @RT00231                                            0231
*     ;                                                            0232
*   ELSE                                                           0233
*     CALL IDCDB010(GDTTBL,'RRRR'); /* DUMP MACRO            @Y30LB11*/
*                                                                  0233
         L     @05,@PC00001                                        0233
         ST    @05,@AL00001                                        0233
         LA    @15,@CC01146                                        0233
         ST    @15,@AL00001+4                                      0233
         MVI   @AL00001+4,X'80'                                    0233
         L     @15,GDTDBG(,@05)                                    0233
         LA    @01,@AL00001                                        0233
         BALR  @14,@15                                             0233
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESSABILITY TO DATA AREAS USED IN MODULE       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   BASEVPTR=ADDR(BASEAREA);        /*                       @Y30LB11*/
@RT00231 LA    BASEVPTR,BASEAREA                                   0234
*   COPYVPTR=ADDR(COPYAREA);        /*                       @Y30LB11*/
         LA    COPYVPTR,COPYAREA                                   0235
*   DEFLPTR=ADDR(DEFAREA);          /*                       @Y30LB11*/
         LA    @07,DEFAREA                                         0236
         ST    @07,DEFLPTR                                         0236
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB11*/
         LA    @15,DARGAREA                                        0237
         ST    @15,DDSTRU                                          0237
*   RVRPTR=ADDR(RVRAREA);           /*                       @Y30LB11*/
         LA    @15,RVRAREA                                         0238
         ST    @15,RVRPTR                                          0238
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB11*/
*                                                                  0239
         LA    @14,RVVIAREA                                        0239
         ST    @14,RVVIPTR                                         0239
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   BASEV=''B;                      /*                       @Y30LB11*/
         XC    BASEV(224,BASEVPTR),BASEV(BASEVPTR)                 0240
*   COPYV=''B;                      /*                       @Y30LB11*/
         XC    COPYV(164,COPYVPTR),COPYV(COPYVPTR)                 0241
*   DEFLIST=''B;                    /*                       @Y30LB11*/
         XC    DEFLIST(132,@07),DEFLIST(@07)                       0242
*   RVR=''B;                        /*                       @Y30LB11*/
         XC    RVR(24,@15),RVR(@15)                                0243
*   RVVI=''B;                       /*                       @Y30LB11*/
         XC    RVVI(68,@14),RVVI(@14)                              0244
*   RMVDFLG=OFF;                    /*                       @Y30LB11*/
         NI    RMVDFLG,B'01111111'                                 0245
*   WARNFLG=OFF;                    /*                       @Y30LB11*/
*                                                                  0246
         NI    WARNFLG,B'01111111'                                 0246
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DEFLIST, RVVI AND RVR PARAMETER LISTS      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   DEFVRNTR=ON;                    /*                       @Y30LB11*/
         OI    DEFVRNTR(@07),B'00000100'                           0247
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB11*/
         L     @09,@PC00001+4                                      0248
         L     @08,FDTPTR(,@09)                                    0248
         MVC   DEFVOLD(6,@07),VOLVAL(@08)                          0248
*   DEFVNVOL=VOLVAL;                /*                       @Y30LB11*/
         MVC   DEFVNVOL(6,@07),VOLVAL(@08)                         0249
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB11*/
         LH    @07,RVVLEN                                          0250
         ST    @07,RVVLNGTH(,@14)                                  0250
*   RVVCODE=RVVOP;                  /*                       @Y30LB11*/
         MVI   RVVCODE(@14),X'87'                                  0251
*   RVVOLUME=VOLVAL;                /*                       @Y30LB11*/
         MVC   RVVOLUME(6,@14),VOLVAL(@08)                         0252
*   RVVSVOL=ON;                     /*                       @Y30LB11*/
         OI    RVVSVOL(@14),B'00000001'                            0253
*   RVRLNGTH=RVRLEN;                /*                       @Y30LB11*/
         LH    @07,RVRLEN                                          0254
         ST    @07,RVRLNGTH(,@15)                                  0254
*   RVRCODE=RVROP;                  /*                       @Y30LB11*/
         XC    RVRCODE+1(3,@15),RVRCODE+1(@15)                     0255
         MVI   RVRCODE(@15),X'81'                                  0255
*   RVRVOLID=VOLVAL;                /*                       @Y30LB11*/
         MVC   RVRVOLID(6,@15),VOLVAL(@08)                         0256
*                                                                  0257
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYDATE WAS SPECIFIED THEN CALL COPYPROC TO SCRATCH THE   */
*   /* SPECIFIED COPY RECORD.                                @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0257
*   IF ADDR(CDATE)^=NULLPTR THEN    /*                       @Y30LB11*/
         L     @07,FDTPTR+8(,@09)                                  0257
         LTR   @07,@07                                             0257
         BZ    @RF00257                                            0257
*     DO;                           /*                       @Y30LB11*/
*       CALL COPYPROC;              /*                       @Y30LB11*/
         BAL   @14,COPYPROC                                        0259
*       RESPECIFY                                                  0260
*         RTNREG RSTD;                                             0260
*       TESTRC=RTNREG;                                             0261
         LR    TESTRC,RTNREG                                       0261
*       RESPECIFY                                                  0262
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0262
*       /*************************************************************/
*       /*                                                           */
*       /* IF COPYPROC WAS UNSUCCESSFUL, THEN SET RETURN CODE TO     */
*       /* INDICATE FAILURE.                                 @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0263
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         LA    @05,4                                               0263
         CR    TESTRC,@05                                          0263
         BNE   @RF00263                                            0263
*         SETRC=4;                  /*                       @Y30LB11*/
         LR    SETRC,@05                                           0264
*     END;                          /*                       @Y30LB11*/
*                                                                  0265
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COPYDATE WAS NOT SPECIFIED, REMOVE THE BASE VOLUME RECORD. */
*   /*                                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0266
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
*                                                                  0266
         B     @RC00257                                            0266
@RF00257 DS    0H                                                  0267
*       /*************************************************************/
*       /*                                                           */
*       /* CALL BASEALL TO REMOVE ALL THE COPY RECORDS AND/OR THE    */
*       /* BASE RECORD.                                      @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0267
*       CALL BASEALL;               /*                       @Y30LB11*/
         BAL   @14,BASEALL                                         0267
*       RESPECIFY                                                  0268
*         RTNREG RSTD;                                             0268
*       TESTRC=RTNREG;                                             0269
         LR    TESTRC,RTNREG                                       0269
*       RESPECIFY                                                  0270
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0270
*       /*************************************************************/
*       /*                                                           */
*       /* IF BASEALL WAS UNSUCCESSFUL, THEN SET RETURN CODE @Y30LB11*/
*       /* TO INDICATE FAILURE.                              @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0271
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/
         LA    @05,4                                               0271
         CR    TESTRC,@05                                          0271
         BNE   @RF00271                                            0271
*         SETRC=4;                  /*                       @Y30LB11*/
         LR    SETRC,@05                                           0272
*     END;                          /*                       @Y30LB11*/
@RF00271 DS    0H                                                  0274
*                                                                  0274
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A WARNING ERROR OCCURRED, THE FINAL CONDITION CODE IS SET  */
*   /* TO 4. THEN IF A SEVERE ERROR OCCURRED, THE FINAL CONDITION    */
*   /* CODE IS SET TO 8 IF AT LEAST 1 RECORD WAS REMOVED, OTHERWISE  */
*   /* IT IS SET TO 12.                                      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*   IF WARNFLG=ON THEN                                             0274
@RC00257 TM    WARNFLG,B'10000000'                                 0274
         BNO   @RF00274                                            0274
*     LASTCOND=LASTCC04;            /*                       @Y30LB11*/
         L     @05,@PC00001+8                                      0275
         MVC   LASTCOND(2,@05),@CH00041                            0275
*   IF SETRC=4 THEN                 /*                       @Y30LB11*/
@RF00274 C     SETRC,@CF00041                                      0276
         BNE   @RF00276                                            0276
*     IF RMVDFLG=ON THEN            /*                       @Y30LB11*/
         TM    RMVDFLG,B'10000000'                                 0277
         BNO   @RF00277                                            0277
*       LASTCOND=LASTCC08;          /*                       @Y30LB11*/
         L     @15,@PC00001+8                                      0278
         MVC   LASTCOND(2,@15),@CH00173                            0278
*     ELSE                          /*                       @Y30LB11*/
*       LASTCOND=LASTCC12;          /*                       @Y30LB11*/
*                                                                  0279
         B     @RC00277                                            0279
@RF00277 L     @15,@PC00001+8                                      0279
         MVC   LASTCOND(2,@15),@CH00035                            0279
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE FINAL COMPLETION MESSAGE                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   DARGAREA=''B;                   /*                       @Y30LB11*/
@RC00277 DS    0H                                                  0280
@RF00276 XC    DARGAREA(36),DARGAREA                               0280
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0281
         MVC   DARGSMOD(3,@15),@CC01139                            0281
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB11*/
         L     @14,@PC00001+8                                      0282
         ST    @14,DARGDBP(,@15)                                   0282
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB11*/
*                                                                  0283
         MVC   DARGILP(2,@15),@CH00147                             0283
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL RETURN CODE IS 12 THEN THE MESSAGE: FUNCTION     */
*   /* TERMINATED, CONDITION CODE IS (NN), IS WRITTEN.       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0284
*   IF LASTCOND=LASTCC12 THEN       /*                       @Y30LB11*/
         CLC   LASTCOND(2,@14),@CH00035                            0284
         BNE   @RF00284                                            0284
*     DARGSENT=MSG3003I;            /*                       @Y30LB11*/
*                                                                  0285
         MVI   DARGSENT(@15),X'03'                                 0285
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE, THE MESSAGE: FUNCTION COMPLETED, HIGHEST CONDITION */
*   /* CODE WAS (NN), IS WRITTEN.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0286
*   ELSE                            /*                       @Y30LB11*/
*     DARGSENT=MSG0001I;            /*                       @Y30LB11*/
         B     @RC00284                                            0286
@RF00284 L     @01,DDSTRU                                          0286
         MVI   DARGSENT(@01),X'01'                                 0286
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/
@RC00284 L     @15,@PC00001                                        0287
         ST    @15,@AL00001                                        0287
         LA    @14,@CF00111                                        0287
         ST    @14,@AL00001+4                                      0287
         LA    @14,DDSTRU                                          0287
         ST    @14,@AL00001+8                                      0287
         MVI   @AL00001+8,X'80'                                    0287
         L     @15,GDTPRT(,@15)                                    0287
         LA    @01,@AL00001                                        0287
         BALR  @14,@15                                             0287
*                                                                  0288
*   /*****************************************************************/
*   /*                                                               */
*   /* FULL REGION DUMP BEFORE EXITING REMOVEVR              @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   IF GDTDBG=NULLPTR THEN                                         0288
         L     @15,@PC00001                                        0288
         L     @15,GDTDBG(,@15)                                    0288
         LTR   @15,@15                                             0288
         BZ    @RT00288                                            0288
*     ;                                                            0289
*   ELSE                                                           0290
*     CALL IDCDB010(GDTTBL,'RRRC'); /*                       @Y30LB11*/
*                                                                  0290
         L     @15,@PC00001                                        0290
         ST    @15,@AL00001                                        0290
         LA    @14,@CC01151                                        0290
         ST    @14,@AL00001+4                                      0290
         MVI   @AL00001+4,X'80'                                    0290
         L     @15,GDTDBG(,@15)                                    0290
         LA    @01,@AL00001                                        0290
         BALR  @14,@15                                             0290
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0291
*                                                                  0291
@RT00288 L     @15,@PC00001                                        0291
         ST    @15,@AL00001                                        0291
         LA    @14,MODID                                           0291
         ST    @14,@AL00001+4                                      0291
         L     @14,@PC00001+8                                      0291
         ST    @14,@AL00001+8                                      0291
         MVI   @AL00001+8,X'80'                                    0291
         L     @15,GDTEPL(,@15)                                    0291
         LA    @01,@AL00001                                        0291
         BALR  @14,@15                                             0291
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0292
*                                                                  0292
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - ALLPROC                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/
*/*            ALL COPIES OF THE VOLUME RECORD.  ONE OF THE  @Y30LB11*/
*/*            FOLLOWING MESSAGES IS ISSUED:                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0760I RECORD FOR COPY YYDDD REMOVED.       @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC3761I ** RECORD FOR COPY YYDDD NOT REMOVED @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2078I ** COPY RECORD FOR VOL (VOLSER)      @Y30LB11*/
*/*            CANNOT BE RETRIEVED.                          @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/
*/*         AND USED AS INPUT TO READ THE COPYV RECORDS  TO  @Y30LB11*/
*/*         BE SCRATCHED. THE DEFLIST AND RVR MAPPING MACROS @Y30LB11*/
*/*         ARE PARTIALLY INITIALIZED FOR CALLING THE        @Y30LB11*/
*/*         REMOVRCD ROUTINE.                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/
*/*          RMVDFLG IS SET ON IF REMOVRCD IS SUCCESSFUL.    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - ONE OR MORE RECORDS COULD NOT BE REMOVED    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0292
*ALLPROC:                           /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
@EL00001 L     @13,4(,@13)                                         0292
@EF00001 L     @00,@SIZDATD                                        0292
         LR    @01,@11                                             0292
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0292
         BR    @14                                                 0292
ALLPROC  STM   @14,@12,@SA00002                                    0292
*   DCL                                                            0293
*     ALLCOND FIXED(15);            /* ALLCOND RETURN CODE   @Y30LB11*/
*                                                                  0294
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO ALLPROC PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   OLDERID2=NEWERID2;                                             0294
         L     @15,@PC00001                                        0294
         L     @14,GDTTR2(,@15)                                    0294
         MVC   @TS00001(95),NEWERID2(@14)                          0294
         MVC   OLDERID2(95,@14),@TS00001                           0294
*   NEWID2='RRAP';                  /*                       @Y30LB11*/
*                                                                  0295
         MVC   NEWID2(4,@14),@CC01157                              0295
*   /*****************************************************************/
*   /*                                                               */
*   /* ALLPROC RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*   ALLCOND=0;                      /*                       @Y30LB11*/
*                                                                  0296
         SLR   @14,@14                                             0296
         LR    ALLCOND,@14                                         0296
*   /*****************************************************************/
*   /*                                                               */
*   /* REASONCD IS ZEROED PRIOR TO ISSUING THE FIRST READ MACRO.     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*   REASONCD=0;                     /*                       @Y30LB11*/
*                                                                  0297
         ST    @14,REASONCD                                        0297
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI VARIABLES FOR READING ALL COPIES      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0298
*   RVVRDR=OFF;                     /*                       @Y30LB11*/
         L     @09,RVVIPTR                                         0298
         NI    RVVRDR(@09),B'01111111'                             0298
*   RVVBVRCD=OFF;                   /*                       @Y30LB11*/
         NI    RVVBVRCD(@09),B'01111111'                           0299
*   RVVCPYID=0;                     /*                       @Y30LB11*/
         MVI   RVVCPYID(@09),X'00'                                 0300
*   RVVSCPY=ON;                     /*                       @Y30LB11*/
         OI    RVVSCPY(@09),B'00000100'                            0301
*   RVVRDNR=ON;                     /*                       @Y30LB11*/
         OI    RVVRDNR(@09),B'01000000'                            0302
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/
         OI    RVVCPYRC(@09),B'00100000'                           0303
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/
         MVC   RVVBUFLN(2,@09),@CH01211                            0304
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/
*                                                                  0305
         ST    COPYVPTR,RVVRTBUF(,@09)                             0305
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0306
*   IF GDTDBG=NULLPTR THEN                                         0306
         C     @14,GDTDBG(,@15)                                    0306
         BE    @RT00306                                            0306
*     ;                                                            0307
*   ELSE                                                           0308
*     DO;                                                          0308
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0309
*       DMPITMNM='RVVI';                                           0310
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0310
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0310
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0310
*       DMPITMPT=ADDR(RVVI);                                       0311
         L     @03,RVVIPTR                                         0311
         ST    @03,DMPITMPT(,DMPINDEX)                             0311
*       DMPITMLN=LENGTH(RVVI);                                     0312
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0312
*       DMPITMTP='H';                                              0313
         MVI   DMPITMTP(DMPINDEX),C'H'                             0313
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0314
*                                                                  0314
         AL    DMPINDEX,@CF00464                                   0314
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0315
*       DMPTRM=DMPTRMVL;                                           0315
         MVI   DMPTRM(DMPINDEX),X'FF'                              0315
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0317
@RT00306 L     @15,@PC00001                                        0317
         L     @15,GDTDBG(,@15)                                    0317
         LTR   @15,@15                                             0317
         BZ    @RT00317                                            0317
*     ;                                                            0318
*   ELSE                                                           0319
*     CALL IDCDB010(GDTTBL,'RRRA',ADDR(DUMPAREA));/*         @Y30LB11*/
         L     @15,@PC00001                                        0319
         ST    @15,@AL00001                                        0319
         LA    @14,@CC01160                                        0319
         ST    @14,@AL00001+4                                      0319
         LA    @14,DUMPAREA                                        0319
         ST    @14,@AFTEMPS                                        0319
         LA    @14,@AFTEMPS                                        0319
         ST    @14,@AL00001+8                                      0319
         MVI   @AL00001+8,X'80'                                    0319
         L     @15,GDTDBG(,@15)                                    0319
         LA    @01,@AL00001                                        0319
         BALR  @14,@15                                             0319
*                                                                  0320
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CODE IS EXECUTED REPEATEDLY UNTIL EITHER THE RETURN CODE */
*   /* IS SET TO 4 OR UNTIL END OF FILE IS REACHED.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*   DO WHILE ALLCOND^=4&REASONCD^=EOFILE;/*                  @Y30LB11*/
*                                                                  0320
@RT00317 B     @DE00320                                            0320
@DL00320 DS    0H                                                  0321
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE THE USSC MACRO TO READ THE NEXT COPY RECORD.  @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0321
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*         @Y30LB11*/
         L     @02,@PC00001                                        0321
         ST    @02,@AL00001                                        0321
         LA    @15,VVIC                                            0321
         ST    @15,@AL00001+4                                      0321
         LA    @15,RVVIPTR                                         0321
         ST    @15,@AL00001+8                                      0321
         LA    @15,REASONCD                                        0321
         ST    @15,@AL00001+12                                     0321
         MVI   @AL00001+12,X'80'                                   0321
         L     @15,GDTSSC(,@02)                                    0321
         LA    @01,@AL00001                                        0321
         BALR  @14,@15                                             0321
*     RESPECIFY                                                    0322
*       RTNREG RSTD;                                               0322
*     TESTRC=RTNREG;                                               0323
         LR    TESTRC,RTNREG                                       0323
*     RESPECIFY                                                    0324
*       RTNREG UNRSTD;              /*                       @Y30LB11*/
*                                                                  0324
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE COPY RECORD WAS READ SUCCESSFULLY, THE REMOVRCD      */
*     /* PROCEDURE IS CALLED TO REMOVE THE COPY RECORD.      @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0325
*     IF TESTRC=0 THEN              /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0325
         BNZ   @RF00325                                            0325
*       DO;                         /*                       @Y30LB11*/
*                                                                  0326
*         /***********************************************************/
*         /*                                                         */
*         /* THE DEFLIST AND RVR PARAMETER LIST ARE INITIALIZED      */
*         /* BEFORE CALLING REMOVRCD.                        @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0327
*         DEFVCSN1=COPCSN1;         /*                       @Y30LB11*/
         L     @01,DEFLPTR                                         0327
         MVC   DEFVCSN1(12,@01),COPCSN1(COPYVPTR)                  0327
*         RVRCOPYV=ON;              /*                       @Y30LB11*/
         L     @15,RVRPTR                                          0328
         OI    RVRCOPYV(@15),B'01000000'                           0328
*         RVRCPYID=COPNO;           /*                       @Y30LB11*/
         MVC   RVRCPYID(1,@15),COPNO(COPYVPTR)                     0329
*         CALL REMOVRCD;            /*                       @Y30LB11*/
         BAL   @14,REMOVRCD                                        0330
*         RESPECIFY                                                0331
*           RTNREG RSTD;                                           0331
*         TESTRC=RTNREG;                                           0332
         LR    TESTRC,RTNREG                                       0332
*         RESPECIFY                                                0333
*           RTNREG UNRSTD;          /*                       @Y30LB11*/
*                                                                  0333
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REMOVRCD PROC EXECUTED SUCCESSFULLY THE RMVDFLG  */
*         /* IS SET ON INDICATING THAT AT LEAST ONE COPY RECORD WAS  */
*         /* REMOVED.                                        @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0334
*         IF TESTRC=0 THEN          /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0334
         BNZ   @RF00334                                            0334
*           DO;                     /*                       @Y30LB11*/
*             RMVDFLG=ON;           /*                       @Y30LB11*/
*                                                                  0336
         OI    RMVDFLG,B'10000000'                                 0336
*             /*******************************************************/
*             /*                                                     */
*             /* SINCE REMOVRCD WAS SUCCESSFUL, THE MESSAGE: **      */
*             /* RECORD FOR COPY YYYDDD REMOVED, IS WRITTEN. @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0337
*             DARGAREA=''B;         /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0337
*             DARGSMOD=REMOVRMG;    /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0338
         MVC   DARGSMOD(3,@15),@CC01134                            0338
*             DARGSENT=MSG0760I;    /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'01'                                 0339
*             DARGDBP=ADDR(COPDATE);/*                       @Y30LB11*/
         LA    @14,COPDATE(,COPYVPTR)                              0340
         ST    @14,DARGDBP(,@15)                                   0340
*             DARGILP=LENGTH(COPDATE);/*                     @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00041                             0341
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/
         L     @15,@PC00001                                        0342
         ST    @15,@AL00001                                        0342
         LA    @14,@CF00111                                        0342
         ST    @14,@AL00001+4                                      0342
         LA    @14,DDSTRU                                          0342
         ST    @14,@AL00001+8                                      0342
         MVI   @AL00001+8,X'80'                                    0342
         L     @15,GDTPRT(,@15)                                    0342
         LA    @01,@AL00001                                        0342
         BALR  @14,@15                                             0342
*           END;                    /*                       @Y30LB11*/
*                                                                  0343
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE REMOVE FAILED, THE CONDITION CODE IS SET TO 8 TO */
*         /* INDICATE THAT THE REST OF THE COPIES CAN STILL BE       */
*         /* SCRATCHED. OTHERWISE, STORAGE IS NOT AVAILABLE TO ISSUE */
*         /* FURTHER MSC MACROS, SO SET THE CONDITION CODE TO 4 TO   */
*         /* TERMINATE THE LOOP OF SCRATCHING COPIES.        @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0344
*         ELSE                      /*                       @Y30LB11*/
*           DO;                     /*                       @Y30LB11*/
         B     @RC00334                                            0344
@RF00334 DS    0H                                                  0345
*             IF TESTRC=4 THEN      /*                       @Y30LB11*/
         C     TESTRC,@CF00041                                     0345
         BNE   @RF00345                                            0345
*               ALLCOND=8;          /*                       @Y30LB11*/
         LA    ALLCOND,8                                           0346
*             ELSE                  /*                       @Y30LB11*/
*               ALLCOND=4;          /*                       @Y30LB11*/
*                                                                  0347
         B     @RC00345                                            0347
@RF00345 LA    ALLCOND,4                                           0347
*             /*******************************************************/
*             /*                                                     */
*             /* SINCE REMOVRCD WAS UNSUCCESSFUL, THE MESSAGE: **    */
*             /* RECORD FOR COPY YYYDDD NOT REMOVED, IS WRITTEN.     */
*             /*                                             @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0348
*             DARGAREA=''B;         /*                       @Y30LB11*/
@RC00345 XC    DARGAREA(36),DARGAREA                               0348
*             DARGSMOD=REMOVRMG;    /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0349
         MVC   DARGSMOD(3,@15),@CC01134                            0349
*             DARGSENT=MSG3761I;    /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'02'                                 0350
*             DARGDBP=ADDR(COPDATE);/*                       @Y30LB11*/
         LA    @14,COPDATE(,COPYVPTR)                              0351
         ST    @14,DARGDBP(,@15)                                   0351
*             DARGILP=LENGTH(COPDATE);/*                     @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00041                             0352
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/
         L     @15,@PC00001                                        0353
         ST    @15,@AL00001                                        0353
         LA    @14,@CF00111                                        0353
         ST    @14,@AL00001+4                                      0353
         LA    @14,DDSTRU                                          0353
         ST    @14,@AL00001+8                                      0353
         MVI   @AL00001+8,X'80'                                    0353
         L     @15,GDTPRT(,@15)                                    0353
         LA    @01,@AL00001                                        0353
         BALR  @14,@15                                             0353
*           END;                    /*                       @Y30LB11*/
*                                                                  0354
*         /***********************************************************/
*         /*                                                         */
*         /* THE NEXT COPY ID IS SET FOR THE NEXT READ MACRO @Y30LB11*/
*         /* EXECUTION.                                      @Y30LB11*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0355
*         RVVCPYID=COPNO;           /*                       @Y30LB11*/
@RC00334 L     @01,RVVIPTR                                         0355
         MVC   RVVCPYID(1,@01),COPNO(COPYVPTR)                     0355
*       END;                        /*                       @Y30LB11*/
*                                                                  0356
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE COPY RECORD WAS NOT READ, TEST FOR THE END OF FILE.  */
*     /* IF END OF FILE IS NOT REACHED, THE SSCMSG PROCEDURE IS      */
*     /* CALLED TO ISSUE AN ERROR MSG CORRESPONDING TO THE REASON    */
*     /* CODE. THEN THE MESSAGE: ** COPY RECORD FOR VOLUME (VOLSER)  */
*     /* CANNOT BE RETRIEVED, IS WRITTEN.                    @Y30LB11*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0357
*     ELSE                          /*                       @Y30LB11*/
*       IF REASONCD^=EOFILE THEN    /*                       @Y30LB11*/
         B     @RC00325                                            0357
@RF00325 CLC   REASONCD(4),@CF01115                                0357
         BE    @RF00357                                            0357
*         DO;                       /*                       @Y30LB11*/
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/
         LA    @04,REASONCD                                        0359
         ST    @04,@AL00001                                        0359
         LA    @01,@AL00001                                        0359
         BAL   @14,SSCMSG                                          0359
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0360
*           DARGSMOD=COMMSG;        /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0361
         MVC   DARGSMOD(3,@15),@CC01113                            0361
*           DARGSENT=MSG2078I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'1C'                                 0362
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB11*/
         L     @14,@PC00001+4                                      0363
         L     @01,FDTPTR(,@14)                                    0363
         LA    @14,VOLVAL(,@01)                                    0363
         ST    @14,DARGDBP(,@15)                                   0363
*           DARGILP=LENGTH(VOLVAL); /*                       @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00150                             0364
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
*                                                                  0365
         L     @15,@PC00001                                        0365
         ST    @15,@AL00001                                        0365
         LA    @14,@CF00111                                        0365
         ST    @14,@AL00001+4                                      0365
         LA    @14,DDSTRU                                          0365
         ST    @14,@AL00001+8                                      0365
         MVI   @AL00001+8,X'80'                                    0365
         L     @15,GDTPRT(,@15)                                    0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE CONDITION CODE TO RCFAIL TO TERMINATE THE LOOP*/
*           /* OF SCRATCHING COPIES.                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0366
*           ALLCOND=4;              /*                       @Y30LB11*/
         LA    ALLCOND,4                                           0366
*         END;                      /*                       @Y30LB11*/
*   END;                            /*                       @Y30LB11*/
@RF00357 DS    0H                                                  0368
@RC00325 DS    0H                                                  0368
@DE00320 C     ALLCOND,@CF00041                                    0368
         BE    @DC00320                                            0368
         CLC   REASONCD(4),@CF01115                                0368
         BNE   @DL00320                                            0368
@DC00320 DS    0H                                                  0369
*                                                                  0369
*   /*****************************************************************/
*   /*                                                               */
*   /* FINALLY, IF THE RETURN CODE IS NOT 0 THEN THE FINAL RETURN    */
*   /* CODE IS SET TO 4.                                     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0369
*   IF ALLCOND^=0 THEN              /*                       @Y30LB11*/
         LTR   ALLCOND,ALLCOND                                     0369
         BZ    @RF00369                                            0369
*     ALLCOND=4;                    /*                       @Y30LB11*/
*                                                                  0370
         LA    ALLCOND,4                                           0370
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN IS MADE TO BASEALL.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0371
*   RETURN CODE(ALLCOND);           /*                       @Y30LB11*/
@RF00369 LR    @15,ALLCOND                                         0371
         L     @14,@SA00002                                        0371
         LM    @00,@12,@SA00002+8                                  0371
         BR    @14                                                 0371
*   END ALLPROC;                    /*                       @Y30LB11*/
*                                                                  0373
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - BASEALL                                 @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO PROCESS    @Y30LB11*/
*/*            FUNCTIONS REQUIRED TO SATISFY REQUEST FOR     @Y30LB11*/
*/*            REMOVAL OF ALL RECORDS OR BASE RECORD.  THE   @Y30LB11*/
*/*            FOLLOWING MESSAGES CAN BE ISSUED:             @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC3080I ** RECORD FOR VOL (VOLSER) CANNOT    @Y30LB11*/
*/*            BE RETRIEVED FROM INVENTORY.                  @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC2765I RECORD FOR VOLUME (VOLSER) NOT       @Y30LB11*/
*/*            REMOVED.  RECORD FOR COPY EXISTS.             @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/
*/*         AND USED AS INPUT TO READ THE BASEV AND/OR COPYV @Y30LB11*/
*/*         RECORDS TO BE SCRATCHED.                         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - BASEALL WAS UNSUCCESSFUL: BASE RECORD COULD @Y30LB11*/
*/*              NOT BE READ, OR COPY OR BASE RECORD WAS NOT @Y30LB11*/
*/*              REMOVED.                                    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0373
*BASEALL:                           /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
BASEALL  STM   @14,@12,@SA00003                                    0373
*   DCL                                                            0374
*     BASECOND FIXED(15);           /* BASEALL RETURN CODE   @Y30LB11*/
*                                                                  0375
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO BASEALL PROCEDURE                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0375
*   OLDERID2=NEWERID2;                                             0375
         L     @07,@PC00001                                        0375
         L     @15,GDTTR2(,@07)                                    0375
         MVC   @TS00001(95),NEWERID2(@15)                          0375
         MVC   OLDERID2(95,@15),@TS00001                           0375
*   NEWID2='RRBA';                  /*                       @Y30LB11*/
*                                                                  0376
         MVC   NEWID2(4,@15),@CC01167                              0376
*   /*****************************************************************/
*   /*                                                               */
*   /* BASEALL RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*   BASECOND=0;                     /*                       @Y30LB11*/
*                                                                  0377
         SLR   @15,@15                                             0377
         LR    BASECOND,@15                                        0377
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI VARIABLES FOR READING THE BASE RECORD @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0378
*   RVVRDR=ON;                      /*                       @Y30LB11*/
         L     @14,RVVIPTR                                         0378
         OI    RVVRDR(@14),B'10000000'                             0378
*   RVVBVRCD=ON;                    /*                       @Y30LB11*/
         OI    RVVBVRCD(@14),B'10000000'                           0379
*   RVVRTBUF=BASEVPTR;              /*                       @Y30LB11*/
         ST    BASEVPTR,RVVRTBUF(,@14)                             0380
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Y30LB11*/
*                                                                  0381
         MVC   RVVBUFLN(2,@14),@CH01213                            0381
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0382
*   IF GDTDBG=NULLPTR THEN                                         0382
         C     @15,GDTDBG(,@07)                                    0382
         BE    @RT00382                                            0382
*     ;                                                            0383
*   ELSE                                                           0384
*     DO;                                                          0384
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0385
*       DMPITMNM='RVVI';                                           0386
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0386
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0386
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0386
*       DMPITMPT=ADDR(RVVI);                                       0387
         L     @07,RVVIPTR                                         0387
         ST    @07,DMPITMPT(,DMPINDEX)                             0387
*       DMPITMLN=LENGTH(RVVI);                                     0388
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0388
*       DMPITMTP='H';                                              0389
         MVI   DMPITMTP(DMPINDEX),C'H'                             0389
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0390
*                                                                  0390
         AL    DMPINDEX,@CF00464                                   0390
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0391
*       DMPTRM=DMPTRMVL;                                           0391
         MVI   DMPTRM(DMPINDEX),X'FF'                              0391
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0393
@RT00382 L     @07,@PC00001                                        0393
         L     @07,GDTDBG(,@07)                                    0393
         LTR   @07,@07                                             0393
         BZ    @RT00393                                            0393
*     ;                                                            0394
*   ELSE                                                           0395
*     CALL IDCDB010(GDTTBL,'RRRB',ADDR(DUMPAREA));/*         @Y30LB11*/
*                                                                  0395
         L     @07,@PC00001                                        0395
         ST    @07,@AL00001                                        0395
         LA    @15,@CC01168                                        0395
         ST    @15,@AL00001+4                                      0395
         LA    @15,DUMPAREA                                        0395
         ST    @15,@AFTEMPS+4                                      0395
         LA    @15,@AFTEMPS+4                                      0395
         ST    @15,@AL00001+8                                      0395
         MVI   @AL00001+8,X'80'                                    0395
         L     @15,GDTDBG(,@07)                                    0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC MACRO TO READ THE BASE VOLUME RECORD.  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0396
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/
@RT00393 L     @07,@PC00001                                        0396
         ST    @07,@AL00001                                        0396
         LA    @02,VVIC                                            0396
         ST    @02,@AL00001+4                                      0396
         LA    @02,RVVIPTR                                         0396
         ST    @02,@AL00001+8                                      0396
         LA    @02,REASONCD                                        0396
         ST    @02,@AL00001+12                                     0396
         MVI   @AL00001+12,X'80'                                   0396
         L     @15,GDTSSC(,@07)                                    0396
         LA    @01,@AL00001                                        0396
         BALR  @14,@15                                             0396
*   RESPECIFY                                                      0397
*     RTNREG RSTD;                                                 0397
*   TESTRC=RTNREG;                                                 0398
         LR    TESTRC,RTNREG                                       0398
*   RESPECIFY                                                      0399
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE BASE RECORD WAS READ SUCCESSFULLY, THE 'ALL' PARAMETER */
*   /* IS CHECKED TO DETERMINE WHETHER THE ALLPROC ROUTINE SHOULD BE */
*   /* CALLED TO REMOVE ALL COPY RECORDS BEFORE REMOVING THE BASE    */
*   /* VOLUME RECORD.                                        @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/
         SLR   @07,@07                                             0400
         CR    TESTRC,@07                                          0400
         BNE   @RF00400                                            0400
*     DO;                           /*                       @Y30LB11*/
*       IF ADDR(ALLC)^=NULLPTR THEN /*                       @Y30LB11*/
         L     @02,@PC00001+4                                      0402
         C     @07,FDTPTR+4(,@02)                                  0402
         BE    @RF00402                                            0402
*         DO;                       /*                       @Y30LB11*/
*           CALL ALLPROC;           /*                       @Y30LB11*/
         BAL   @14,ALLPROC                                         0404
*           RESPECIFY                                              0405
*             RTNREG RSTD;                                         0405
*           TESTRC=RTNREG;                                         0406
         LR    TESTRC,RTNREG                                       0406
*           RESPECIFY                                              0407
*             RTNREG UNRSTD;        /*                       @Y30LB11*/
*         END;                      /*                       @Y30LB11*/
*                                                                  0408
*       /*************************************************************/
*       /*                                                           */
*       /* IF ALLPROC WAS SUCCESSFUL OR NOT CALLED, INVOKE BASEPROC  */
*       /* TO REMOVE THE BASE RECORD.                        @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0409
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/
@RF00402 LTR   TESTRC,TESTRC                                       0409
         BNZ   @RF00409                                            0409
*         DO;                       /*                       @Y30LB11*/
*           CALL BASEPROC;          /*                       @Y30LB11*/
         BAL   @14,BASEPROC                                        0411
*           RESPECIFY                                              0412
*             RTNREG RSTD;                                         0412
*           TESTRC=RTNREG;                                         0413
         LR    TESTRC,RTNREG                                       0413
*           RESPECIFY                                              0414
*             RTNREG UNRSTD;        /*                       @Y30LB11*/
*                                                                  0414
*           /*********************************************************/
*           /*                                                       */
*           /* IF BASEPROC WAS UNSUCCESSFUL, THE RETURN CODE IS SET  */
*           /* TO 4.                                         @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0415
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/
         LA    @05,4                                               0415
         CR    TESTRC,@05                                          0415
         BNE   @RF00415                                            0415
*             BASECOND=4;           /*                       @Y30LB11*/
         LR    BASECOND,@05                                        0416
*         END;                      /*                       @Y30LB11*/
*                                                                  0417
*       /*************************************************************/
*       /*                                                           */
*       /* IF ALLPROC WAS UNSUCCESSFUL, THE RETURN CODE IS SET TO 4  */
*       /* AND THE MESSAGE: RECORD FOR VOLUME (VOLSER) NOT REMOVED.  */
*       /* RECORD FOR COPY EXISTS, IS WRITTEN                @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0418
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
         B     @RC00409                                            0418
@RF00409 DS    0H                                                  0419
*           BASECOND=4;             /*                       @Y30LB11*/
         LA    BASECOND,4                                          0419
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0420
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0421
         MVC   DARGSMOD(3,@05),@CC01134                            0421
*           DARGSENT=MSG2765I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'06'                                 0422
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0423
         L     @01,FDTPTR(,@15)                                    0423
         LA    @15,VOLVAL(,@01)                                    0423
         ST    @15,DARGDBP(,@05)                                   0423
*           DARGILP=LENGTH(VOLVAL); /*                       @Y30LB11*/
         MVC   DARGILP(2,@05),@CH00150                             0424
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/
         L     @05,@PC00001                                        0425
         ST    @05,@AL00001                                        0425
         LA    @15,@CF00111                                        0425
         ST    @15,@AL00001+4                                      0425
         LA    @15,DDSTRU                                          0425
         ST    @15,@AL00001+8                                      0425
         MVI   @AL00001+8,X'80'                                    0425
         L     @15,GDTPRT(,@05)                                    0425
         LA    @01,@AL00001                                        0425
         BALR  @14,@15                                             0425
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0427
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE MSVC READ WAS UNSUCCESSFUL, THE RETURN CODE IS SET TO  */
*   /* 4, AND THE MESSAGE: ** RECORD FOR VOL (VOLSER) CANNOT BE      */
*   /* RETRIEVED FROM INVENTORY, IS WRITTEN.                 @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0428
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00400                                            0428
@RF00400 DS    0H                                                  0429
*       BASECOND=4;                 /*                       @Y30LB11*/
*                                                                  0429
         LA    BASECOND,4                                          0429
*       /*************************************************************/
*       /*                                                           */
*       /* FIRST, SSCMSG IS CALLED TO PRINT A MESSAGE CORRESPONDING  */
*       /* TO THE REASON CODE.                               @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0430
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/
         LA    @05,REASONCD                                        0430
         ST    @05,@AL00001                                        0430
         LA    @01,@AL00001                                        0430
         BAL   @14,SSCMSG                                          0430
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0431
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0432
         MVC   DARGSMOD(3,@05),@CC01113                            0432
*       DARGSENT=MSG3080I;          /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'1A'                                 0433
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/
         L     @15,@PC00001+4                                      0434
         L     @01,FDTPTR(,@15)                                    0434
         LA    @15,VOLVAL(,@01)                                    0434
         ST    @15,DARGDBP(,@05)                                   0434
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/
         MVC   DARGILP(2,@05),@CH00150                             0435
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/
         L     @05,@PC00001                                        0436
         ST    @05,@AL00001                                        0436
         LA    @15,@CF00111                                        0436
         ST    @15,@AL00001+4                                      0436
         LA    @15,DDSTRU                                          0436
         ST    @15,@AL00001+8                                      0436
         MVI   @AL00001+8,X'80'                                    0436
         L     @15,GDTPRT(,@05)                                    0436
         LA    @01,@AL00001                                        0436
         BALR  @14,@15                                             0436
*     END;                          /*                       @Y30LB11*/
*                                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN IS MADE TO IDCRR01.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0438
*   RETURN CODE(BASECOND);          /*                       @Y30LB11*/
@RC00400 LR    @15,BASECOND                                        0438
         L     @14,@SA00003                                        0438
         LM    @00,@12,@SA00003+8                                  0438
         BR    @14                                                 0438
*   END BASEALL;                    /*                       @Y30LB11*/
*                                                                  0440
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - BASEPROC                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/
*/*            THE BASE VOLUME RECORD FROM THE INVENTORY.    @Y30LB11*/
*/*            ONE OF THE FOLLOWING MESSAGES IS ISSUED:      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC3762I ** RECORD FOR VOL (VOLSER) NOT       @Y30LB11*/
*/*            REMOVED.                                      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*            IDC0763I RECORD FOR VOLUME (VOLSER) REMOVED.  @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE BASE VOLUME RECORD MUST HAVE BEEN READ       @Y30LB11*/
*/*         BEFORE BASEPROC IS CALLED.  THE DEFLIST IS       @Y30LB11*/
*/*         PARTIALLY INITIALIZED.                           @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - FUNCTION WAS UNSUCCESSFUL: VOLUME STILL IN  @Y30LB11*/
*/*              MSF OR MSC FAILURE OCCURRED.                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0440
*BASEPROC:                          /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
BASEPROC STM   @14,@12,@SA00004                                    0440
*   DCL                                                            0441
*     BPROCOND FIXED(15);           /* BASEPROC RETURN CODE  @Y30LB11*/
*                                                                  0442
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO BASEPROC PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0442
*   OLDERID2=NEWERID2;                                             0442
         L     @07,@PC00001                                        0442
         L     @05,GDTTR2(,@07)                                    0442
         MVC   @TS00001(95),NEWERID2(@05)                          0442
         MVC   OLDERID2(95,@05),@TS00001                           0442
*   NEWID2='RRBP';                  /*                       @Y30LB11*/
*                                                                  0443
         MVC   NEWID2(4,@05),@CC01174                              0443
*   /*****************************************************************/
*   /*                                                               */
*   /* BASEPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0444
*   BPROCOND=0;                     /*                       @Y30LB11*/
*                                                                  0444
         SLR   @15,@15                                             0444
         LR    BPROCOND,@15                                        0444
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVR PARAMETER LIST TO REMOVE A BASE VOLUME RECORD. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*   RVRCOPYV=OFF;                   /*                       @Y30LB11*/
*   RVRBASEV=ON;                    /*                       @Y30LB11*/
         L     @05,RVRPTR                                          0446
         OI    RVRBASEV(@05),B'10000000'                           0446
         NI    RVRCOPYV(@05),B'10111111'                           0446
*                                                                  0447
*   /*****************************************************************/
*   /*                                                               */
*   /* A CHECK IS MADE TO DETERMINE WHETHER THE CARTRIDGES HAVE BEEN */
*   /* REASSIGNED TO ANOTHER VOLUME. IF THEY HAVE, THE USSC UMACRO IS*/
*   /* ISSUED TO INVOKE THE ICBVVIC MACRO TO REMOVE THE BASE VOLUME  */
*   /* RECORD. THE CHECK IN REMOVRCD PROCEDURE TO TEST WHETHER THE   */
*   /* CARTRIDGES ARE IN THE MSF IS BYPASSED.                @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   IF BASREASS=ON THEN             /*                       @Y30LB11*/
         TM    BASREASS(BASEVPTR),B'00100000'                      0447
         BNO   @RF00447                                            0447
*     DO;                           /*                       @Y30LB11*/
*                                                                  0448
*       /*************************************************************/
*       /*                                                           */
*       /* DUMP OF INITIALIZED PARM LIST FOR MSVC REMOVE MACRO       */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0449
*       IF GDTDBG=NULLPTR THEN                                     0449
         C     @15,GDTDBG(,@07)                                    0449
         BE    @RT00449                                            0449
*         ;                                                        0450
*       ELSE                                                       0451
*         DO;                                                      0451
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0452
*           DMPITMNM='RVVI';                                       0453
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0453
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0453
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0453
*           DMPITMPT=ADDR(RVVI);                                   0454
         L     @05,RVVIPTR                                         0454
         ST    @05,DMPITMPT(,DMPINDEX)                             0454
*           DMPITMLN=LENGTH(RVVI);                                 0455
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0455
*           DMPITMTP='H';                                          0456
         MVI   DMPITMTP(DMPINDEX),C'H'                             0456
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0457
*                                                                  0457
         AL    DMPINDEX,@CF00464                                   0457
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0458
*           DMPTRM=DMPTRMVL;                                       0458
         MVI   DMPTRM(DMPINDEX),X'FF'                              0458
*         END;                      /*                       @Y30LB11*/
*       IF GDTDBG=NULLPTR THEN                                     0460
@RT00449 L     @05,@PC00001                                        0460
         L     @05,GDTDBG(,@05)                                    0460
         LTR   @05,@05                                             0460
         BZ    @RT00460                                            0460
*         ;                                                        0461
*       ELSE                                                       0462
*         CALL IDCDB010(GDTTBL,'RRRV',ADDR(DUMPAREA));/*     @Y30LB11*/
*                                                                  0462
         L     @05,@PC00001                                        0462
         ST    @05,@AL00001                                        0462
         LA    @15,@CC01175                                        0462
         ST    @15,@AL00001+4                                      0462
         LA    @15,DUMPAREA                                        0462
         ST    @15,@AFTEMPS+8                                      0462
         LA    @15,@AFTEMPS+8                                      0462
         ST    @15,@AL00001+8                                      0462
         MVI   @AL00001+8,X'80'                                    0462
         L     @15,GDTDBG(,@05)                                    0462
         LA    @01,@AL00001                                        0462
         BALR  @14,@15                                             0462
*       /*************************************************************/
*       /*                                                           */
*       /* THE USSC UMACRO IS EXECUTED TO REMOVE THE BASE VOLUME     */
*       /* RECORD FROM THE INVENTORY. IF THE UMACRO WAS UNSUCCESSFUL */
*       /* THE REASON CODE IS PASSED TO SSCMSG TO PRINT A MESSAGE    */
*       /* CORRESPONDING TO THAT REASON CODE.                @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0463
*       CALL IDCSASS0(GDTTBL,VVIC,RVRPTR,REASONCD);/*        @Y30LB11*/
@RT00460 L     @05,@PC00001                                        0463
         ST    @05,@AL00001                                        0463
         LA    @02,VVIC                                            0463
         ST    @02,@AL00001+4                                      0463
         LA    @02,RVRPTR                                          0463
         ST    @02,@AL00001+8                                      0463
         LA    @02,REASONCD                                        0463
         ST    @02,@AL00001+12                                     0463
         MVI   @AL00001+12,X'80'                                   0463
         L     @15,GDTSSC(,@05)                                    0463
         LA    @01,@AL00001                                        0463
         BALR  @14,@15                                             0463
*       RESPECIFY                                                  0464
*         RTNREG RSTD;                                             0464
*       TESTRC=RTNREG;                                             0465
         LR    TESTRC,RTNREG                                       0465
*       RESPECIFY                                                  0466
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0466
*       /*************************************************************/
*       /*                                                           */
*       /* THE DARGLIST IS INITIALIZED FOR BASEPROC          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0467
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0467
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0468
         MVC   DARGSMOD(3,@05),@CC01134                            0468
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/
         L     @02,@PC00001+4                                      0469
         L     @02,FDTPTR(,@02)                                    0469
         LA    @02,VOLVAL(,@02)                                    0469
         ST    @02,DARGDBP(,@05)                                   0469
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/
*                                                                  0470
         MVC   DARGILP(2,@05),@CH00150                             0470
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN I/0 ERROR OCCURRED WHILE UPDATING THE INVENTORY, SET*/
*       /* THE WARNING FLAG ON.                              @ZA00670*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0471
*       IF TESTRC=12 THEN                                          0471
         C     TESTRC,@CF00035                                     0471
         BNE   @RF00471                                            0471
*         WARNFLG=ON;               /*                       @ZA00670*/
*                                                                  0472
         OI    WARNFLG,B'10000000'                                 0472
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE MACRO WAS EXECUTED SUCCESSFULLY, THE MESSAGE:      */
*       /* RECORD FOR VOLUME (VOLSER) REMOVED, IS PRINTED.   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0473
*       IF TESTRC=0TESTRC=12 THEN                                 0473
@RF00471 LTR   TESTRC,TESTRC                                       0473
         BZ    @RT00473                                            0473
         C     TESTRC,@CF00035                                     0473
         BNE   @RF00473                                            0473
@RT00473 DS    0H                                                  0474
*         DARGSENT=MSG0763I;        /*                       @Y30LB11*/
*                                                                  0474
         L     @05,DDSTRU                                          0474
         MVI   DARGSENT(@05),X'04'                                 0474
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE MACRO WAS NOT SUCCESSFUL, SSCMSG IS CALLED TO ISSUE*/
*       /* THE MESSAGE: ** RECORD FOR VOLUME (VOLSER) REMOVED, AND   */
*       /* THE RETURN CODE IS SET TO 4.                      @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0475
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
         B     @RC00473                                            0475
@RF00473 DS    0H                                                  0476
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/
         LA    @15,REASONCD                                        0476
         ST    @15,@AL00001                                        0476
         LA    @01,@AL00001                                        0476
         BAL   @14,SSCMSG                                          0476
*           DARGSENT=MSG3762I;      /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0477
         MVI   DARGSENT(@05),X'03'                                 0477
*           BPROCOND=4;             /*                       @Y30LB11*/
         LA    BPROCOND,4                                          0478
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO CARTRIDGES WERE REASSIGNED TO ANOTHER VOLUME, THE       */
*   /* DEFLIST IS INITIALIZED AND A CALL TO REMOVRCD IS MADE TO CHECK*/
*   /* THAT THE CARTRIDGES ARE NOT IN THE LIBRARY AND REMOVE A VOLUME*/
*   /* RECORD.                                               @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00447                                            0481
@RF00447 DS    0H                                                  0482
*       DEFVCSN1=BASCSN1;           /*                       @Y30LB11*/
         L     @07,DEFLPTR                                         0482
         MVC   DEFVCSN1(12,@07),BASCSN1(BASEVPTR)                  0482
*       CALL REMOVRCD;              /*                       @Y30LB11*/
         BAL   @14,REMOVRCD                                        0483
*       RESPECIFY                                                  0484
*         RTNREG RSTD;                                             0484
*       TESTRC=RTNREG;                                             0485
         LR    TESTRC,RTNREG                                       0485
*       RESPECIFY                                                  0486
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0486
*       /*************************************************************/
*       /*                                                           */
*       /* THE DARGLIST IS INITIALIZED FOR BASEPROC          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0487
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0487
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0488
         MVC   DARGSMOD(3,@05),@CC01134                            0488
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/
         L     @02,@PC00001+4                                      0489
         L     @02,FDTPTR(,@02)                                    0489
         LA    @02,VOLVAL(,@02)                                    0489
         ST    @02,DARGDBP(,@05)                                   0489
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/
*                                                                  0490
         MVC   DARGILP(2,@05),@CH00150                             0490
*       /*************************************************************/
*       /*                                                           */
*       /* IF REMOVRCD WAS SUCCESSFUL, THE MESSAGE: RECORD FOR VOLUME*/
*       /* (VOLSER) REMOVED, IS PRINTED.                     @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0491
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0491
         BNZ   @RF00491                                            0491
*         DARGSENT=MSG0763I;        /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'04'                                 0492
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
*                                                                  0493
         B     @RC00491                                            0493
@RF00491 DS    0H                                                  0494
*           /*********************************************************/
*           /*                                                       */
*           /* IF REMOVRCD FAILS, THE MESSAGE: RECORD FOR VOLUME     */
*           /* (VOLSER) NOT REMOVED, IS WRITTEN AND THE RETURN CODE  */
*           /* IS SET TO 4.                                  @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0494
*           DARGSENT=MSG3762I;      /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0494
         MVI   DARGSENT(@05),X'03'                                 0494
*           BPROCOND=4;             /*                       @Y30LB11*/
         LA    BPROCOND,4                                          0495
*         END;                      /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0497
@RC00491 DS    0H                                                  0498
*   /*****************************************************************/
*   /*                                                               */
*   /* THE UPRINT UMACRO IS ISSUED TO PRINT THE QUEUED MESSAGE.      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0498
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/
*                                                                  0498
@RC00447 L     @05,@PC00001                                        0498
         ST    @05,@AL00001                                        0498
         LA    @15,@CF00111                                        0498
         ST    @15,@AL00001+4                                      0498
         LA    @15,DDSTRU                                          0498
         ST    @15,@AL00001+8                                      0498
         MVI   @AL00001+8,X'80'                                    0498
         L     @15,GDTPRT(,@05)                                    0498
         LA    @01,@AL00001                                        0498
         BALR  @14,@15                                             0498
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN IS MADE TO BASEALL.                            @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   RETURN CODE(BPROCOND);          /*                       @Y30LB11*/
         LR    @15,BPROCOND                                        0499
         L     @14,@SA00004                                        0499
         LM    @00,@12,@SA00004+8                                  0499
         BR    @14                                                 0499
*   END BASEPROC;                   /*                       @Y30LB11*/
*                                                                  0501
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - COPYPROC                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/
*/*            A SPECIFIC COPY RECORD.  ONE OF THE FOLLOWING @Y30LB11*/
*/*            MESSAGES IS ISSUED:                           @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*           IDC0760I RECORD FOR COPY YYDDD REMOVED.        @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*           IDC3761I RECORD FOR COPY YYDDD NOT REMOVED.    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/
*/*         AND USED AS INPUT TO READ THE COPYV RECORDS TO   @Y30LB11*/
*/*         BE SCRATCHED.                                    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - COPYPROC WAS UNSUCCESSFUL: COPY RECORD      @Y30LB11*/
*/*              COULD NOT BE READ, OR COPY RECORD WAS NOT   @Y30LB11*/
*/*              REMOVED.                                    @Y30LB11*/
*/*                                                          @Y30LB11*/
*/********************************************************************/
*                                                                  0501
*COPYPROC:                          /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
COPYPROC STM   @14,@12,@SA00005                                    0501
*   DCL                                                            0502
*     COPYCOND FIXED(15);           /* COPYPROC RETURN CODE  @Y30LB11*/
*                                                                  0503
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO COPYPROC PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0503
*   OLDERID2=NEWERID2;                                             0503
         L     @15,@PC00001                                        0503
         L     @15,GDTTR2(,@15)                                    0503
         MVC   @TS00001(95),NEWERID2(@15)                          0503
         MVC   OLDERID2(95,@15),@TS00001                           0503
*   NEWID2='RRCP';                  /*                       @Y30LB11*/
*                                                                  0504
         MVC   NEWID2(4,@15),@CC01180                              0504
*   /*****************************************************************/
*   /*                                                               */
*   /* COPYPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0505
*   COPYCOND=0;                     /*                       @Y30LB11*/
*                                                                  0505
         SLR   @15,@15                                             0505
         LR    COPYCOND,@15                                        0505
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RVVI VARIABLES FOR READING A SPECIFIC COPY @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0506
*   CVD(DATEVAL,RVVCDATE);          /*                       @Y30LB11*/
         L     @14,@PC00001+4                                      0506
         L     @01,FDTPTR+12(,@14)                                 0506
         L     @09,DATEVAL(,@01)                                   0506
         L     @08,RVVIPTR                                         0506
         CVD   @09,@TS00001                                        0506
         MVC   RVVCDATE(4,@08),@TS00001+4                          0506
*   RVVRDR=ON;                      /*                       @Y30LB11*/
         OI    RVVRDR(@08),B'10000000'                             0507
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/
         OI    RVVCPYRC(@08),B'00100000'                           0508
*   RVVSDTE=ON;                     /*                       @Y30LB11*/
         OI    RVVSDTE(@08),B'00100000'                            0509
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/
         ST    COPYVPTR,RVVRTBUF(,@08)                             0510
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/
         MVC   RVVBUFLN(2,@08),@CH01211                            0511
*   RVVSSEQ=ON;                     /*                       @Y30LB11*/
*                                                                  0512
         OI    RVVSSEQ(@08),B'00010000'                            0512
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A COPY NUMBER IS SPECIFIED, THE SEQUENCE NUMBER IS SET TO  */
*   /* IT, OTHERWISE IT IS DEFAULTED TO 1.                   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0513
*   IF ADDR(SEQ)^=NULLPTR THEN      /*                       @Y30LB11*/
         L     @14,FDTPTR+16(,@14)                                 0513
         CR    @14,@15                                             0513
         BE    @RF00513                                            0513
*     RVVRDSEQ=SEQVAL;              /*                       @Y30LB11*/
         MVC   RVVRDSEQ(1,@08),SEQVAL+3(@14)                       0514
*   ELSE                            /*                       @Y30LB11*/
*     RVVRDSEQ=SEQDEFLT;            /*                       @Y30LB11*/
*                                                                  0515
         B     @RC00513                                            0515
@RF00513 L     @01,RVVIPTR                                         0515
         MVI   RVVRDSEQ(@01),X'01'                                 0515
*   /*****************************************************************/
*   /*                                                               */
*   /* ADDITIONALLY SET THE SEQUENCE NUMBER FOR MESSAGE IDC3081I.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   SEQNUM=RVVRDSEQ;                /*                       @Y30LB11*/
*                                                                  0516
@RC00513 L     @01,RVVIPTR                                         0516
         SLR   @00,@00                                             0516
         IC    @00,RVVRDSEQ(,@01)                                  0516
         ST    @00,SEQNUM                                          0516
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*   IF GDTDBG=NULLPTR THEN                                         0517
         L     @15,@PC00001                                        0517
         L     @15,GDTDBG(,@15)                                    0517
         LTR   @15,@15                                             0517
         BZ    @RT00517                                            0517
*     ;                                                            0518
*   ELSE                                                           0519
*     DO;                                                          0519
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0520
*       DMPITMNM='RVVI';                                           0521
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0521
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0521
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0521
*       DMPITMPT=ADDR(RVVI);                                       0522
         L     @03,RVVIPTR                                         0522
         ST    @03,DMPITMPT(,DMPINDEX)                             0522
*       DMPITMLN=LENGTH(RVVI);                                     0523
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0523
*       DMPITMTP='H';                                              0524
         MVI   DMPITMTP(DMPINDEX),C'H'                             0524
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0525
*                                                                  0525
         AL    DMPINDEX,@CF00464                                   0525
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0526
*       DMPTRM=DMPTRMVL;                                           0526
         MVI   DMPTRM(DMPINDEX),X'FF'                              0526
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0528
@RT00517 L     @15,@PC00001                                        0528
         L     @15,GDTDBG(,@15)                                    0528
         LTR   @15,@15                                             0528
         BZ    @RT00528                                            0528
*     ;                                                            0529
*   ELSE                                                           0530
*     CALL IDCDB010(GDTTBL,'RRCR',ADDR(DUMPAREA));/*         @Y30LB11*/
         L     @15,@PC00001                                        0530
         ST    @15,@AL00001                                        0530
         LA    @14,@CC01182                                        0530
         ST    @14,@AL00001+4                                      0530
         LA    @14,DUMPAREA                                        0530
         ST    @14,@AFTEMPS+12                                     0530
         LA    @14,@AFTEMPS+12                                     0530
         ST    @14,@AL00001+8                                      0530
         MVI   @AL00001+8,X'80'                                    0530
         L     @15,GDTDBG(,@15)                                    0530
         LA    @01,@AL00001                                        0530
         BALR  @14,@15                                             0530
*                                                                  0531
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC UMACRO TO READ THE COPY RECORD.        @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/
@RT00528 L     @02,@PC00001                                        0531
         ST    @02,@AL00001                                        0531
         LA    @15,VVIC                                            0531
         ST    @15,@AL00001+4                                      0531
         LA    @15,RVVIPTR                                         0531
         ST    @15,@AL00001+8                                      0531
         LA    @15,REASONCD                                        0531
         ST    @15,@AL00001+12                                     0531
         MVI   @AL00001+12,X'80'                                   0531
         L     @15,GDTSSC(,@02)                                    0531
         LA    @01,@AL00001                                        0531
         BALR  @14,@15                                             0531
*   RESPECIFY                                                      0532
*     RTNREG RSTD;                                                 0532
*   TESTRC=RTNREG;                                                 0533
         LR    TESTRC,RTNREG                                       0533
*   RESPECIFY                                                      0534
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0534
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD WAS READ SUCCESSFULLY, CALL REMOVRCD TO @Y30LB11*/
*   /* REMOVE THE RECORD.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0535
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0535
         BNZ   @RF00535                                            0535
*     DO;                           /*                       @Y30LB11*/
*       DEFVCSN1=COPCSN1;           /*                       @Y30LB11*/
         L     @01,DEFLPTR                                         0537
         MVC   DEFVCSN1(12,@01),COPCSN1(COPYVPTR)                  0537
*       RVRCOPYV=ON;                /*                       @Y30LB11*/
         L     @15,RVRPTR                                          0538
         OI    RVRCOPYV(@15),B'01000000'                           0538
*       RVRCPYID=COPNO;             /*                       @Y30LB11*/
         MVC   RVRCPYID(1,@15),COPNO(COPYVPTR)                     0539
*       CALL REMOVRCD;              /*                       @Y30LB11*/
         BAL   @14,REMOVRCD                                        0540
*       RESPECIFY                                                  0541
*         RTNREG RSTD;                                             0541
*       TESTRC=RTNREG;                                             0542
         LR    TESTRC,RTNREG                                       0542
*       RESPECIFY                                                  0543
*         RTNREG UNRSTD;            /*                       @Y30LB11*/
*                                                                  0543
*       /*************************************************************/
*       /*                                                           */
*       /* IF REMOVRCD WAS SUCCESSFUL, THE MESSAGE: ** RECORD FOR    */
*       /* COPY YYYDDD REMOVED, IS WRITTEN.                  @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0544
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0544
         BNZ   @RF00544                                            0544
*         DO;                       /*                       @Y30LB11*/
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0546
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0547
         MVC   DARGSMOD(3,@15),@CC01134                            0547
*           DARGSENT=MSG0760I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'01'                                 0548
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB11*/
         LA    @14,COPDATE(,COPYVPTR)                              0549
         ST    @14,DARGDBP(,@15)                                   0549
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB11*/
         MVC   DARGILP(2,@15),@CH00041                             0550
*         END;                      /*                       @Y30LB11*/
*                                                                  0551
*       /*************************************************************/
*       /*                                                           */
*       /* IF REMOVRCD WAS UNSUCCESSFUL, THE MESSAGE: ** RECORD FOR  */
*       /* COPY YYYDDD NOT REMOVED, IS WRITTEN.              @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0552
*       ELSE                        /*                       @Y30LB11*/
*         DO;                       /*                       @Y30LB11*/
         B     @RC00544                                            0552
@RF00544 DS    0H                                                  0553
*           DARGAREA=''B;           /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0553
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/
         L     @15,DDSTRU                                          0554
         MVC   DARGSMOD(3,@15),@CC01134                            0554
*           DARGSENT=MSG3761I;      /*                       @Y30LB11*/
         MVI   DARGSENT(@15),X'02'                                 0555
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB11*/
         LA    @14,COPDATE(,COPYVPTR)                              0556
         ST    @14,DARGDBP(,@15)                                   0556
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB11*/
*                                                                  0557
         LA    @05,4                                               0557
         STH   @05,DARGILP(,@15)                                   0557
*           /*********************************************************/
*           /*                                                       */
*           /* THE RETURN CODE IS SET TO 4.                  @Y30LB11*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0558
*           COPYCOND=4;             /*                       @Y30LB11*/
         LR    COPYCOND,@05                                        0558
*         END;                      /*                       @Y30LB11*/
*                                                                  0559
*       /*************************************************************/
*       /*                                                           */
*       /* THE UPRINT UMACRO IS ISSUED TO PRINT THE MESSAGE  @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0560
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/
@RC00544 L     @05,@PC00001                                        0560
         ST    @05,@AL00001                                        0560
         LA    @15,@CF00111                                        0560
         ST    @15,@AL00001+4                                      0560
         LA    @15,DDSTRU                                          0560
         ST    @15,@AL00001+8                                      0560
         MVI   @AL00001+8,X'80'                                    0560
         L     @15,GDTPRT(,@05)                                    0560
         LA    @01,@AL00001                                        0560
         BALR  @14,@15                                             0560
*     END;                          /*                       @Y30LB11*/
*                                                                  0561
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE READ FAILED, SSCMSG IS CALLED TO PRINT A MESSAGE       */
*   /* CORRESPONDING TO THE REASON CODE. THE MESSAGE: ** COPY NOT    */
*   /* RETRIEVED FROM INVENTORY FOR RECORD YYDDD, NO.XXX, IS WRITTEN,*/
*   /* AND THE RETURN CODE IS SET TO 4.                      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00535                                            0562
@RF00535 DS    0H                                                  0563
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/
         LA    @15,REASONCD                                        0563
         ST    @15,@AL00001                                        0563
         LA    @01,@AL00001                                        0563
         BAL   @14,SSCMSG                                          0563
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0564
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0565
         MVC   DARGSMOD(3,@05),@CC01113                            0565
*       DARGSENT=MSG3081I;          /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'19'                                 0566
*       DARGDBP=ADDR(RVVCDATE);     /*                       @Y30LB11*/
         L     @01,RVVIPTR                                         0567
         LA    @15,RVVCDATE(,@01)                                  0567
         ST    @15,DARGDBP(,@05)                                   0567
*       DARGILP=LENGTH(RVVCDATE);   /*                       @Y30LB11*/
         LA    @15,4                                               0568
         STH   @15,DARGILP(,@05)                                   0568
*       DARGCNT=1;                  /*                       @Y30LB11*/
         LA    @14,1                                               0569
         STH   @14,DARGCNT(,@05)                                   0569
*       DARGINS(1)=SEQ#;            /*                       @Y30LB11*/
         STH   @14,DARGINS(,@05)                                   0570
*       DARGINL(1)=LENGTH(SEQNUM);  /*                       @Y30LB11*/
         STH   @15,DARGINL(,@05)                                   0571
*       DARGDTM(1)=ADDR(SEQNUM);    /*                       @Y30LB11*/
         LA    @15,SEQNUM                                          0572
         ST    @15,DARGDTM(,@05)                                   0572
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/
         L     @05,@PC00001                                        0573
         ST    @05,@AL00001                                        0573
         LA    @15,@CF00111                                        0573
         ST    @15,@AL00001+4                                      0573
         LA    @15,DDSTRU                                          0573
         ST    @15,@AL00001+8                                      0573
         MVI   @AL00001+8,X'80'                                    0573
         L     @15,GDTPRT(,@05)                                    0573
         LA    @01,@AL00001                                        0573
         BALR  @14,@15                                             0573
*       COPYCOND=4;                 /*                       @Y30LB11*/
         LA    COPYCOND,4                                          0574
*     END;                          /*                       @Y30LB11*/
*                                                                  0575
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO IDCRR01.                                    @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0576
*   RETURN CODE(COPYCOND);          /*                       @Y30LB11*/
@RC00535 LR    @15,COPYCOND                                        0576
         L     @14,@SA00005                                        0576
         LM    @00,@12,@SA00005+8                                  0576
         BR    @14                                                 0576
*   END COPYPROC;                   /*                       @Y30LB11*/
*                                                                  0578
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  0578
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           0578
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00006                                    0578
         MVC   @PC00006(8),0(@01)                                  0578
*                                   /*                       @Y30LB39*/
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*                                   /*                       @Y30LB39*/
*   DCL                                                            0579
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            0580
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0580
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*                                   /*                       @Y30LB39*/
*   DCL                                                            0581
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            0582
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0582
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0583
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0583
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0583
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0584
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0584
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0584
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0585
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0586
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0586
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0587
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        0587
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0588
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0588
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             0588
         L     @15,@PC00001                                        0588
         L     @14,GDTTR2(,@15)                                    0588
         MVC   @TS00001(95),NEWERID2(@14)                          0588
         MVC   OLDERID2(95,@14),@TS00001                           0588
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0589
         MVC   NEWID2(4,@14),@CC01203                              0589
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0590
         LA    @14,SSDRGLT                                         0590
         ST    @14,SSDLPTR                                         0590
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0591
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              0591
         L     @09,@PC00006                                        0591
         L     @09,SSRCODE(,@09)                                   0591
         LTR   @09,@09                                             0591
         BNP   @RF00591                                            0591
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0592
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0593
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0593
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        0594
         ST    @03,DARGRETP(,@14)                                  0594
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            0595
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 0596
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0597
         MVC   DARGRETL(2,@14),@CH01214                            0597
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0598
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0598
         ST    @15,@AL00001                                        0598
         LA    @03,@CF00111                                        0598
         ST    @03,@AL00001+4                                      0598
         LA    @03,SSDLPTR                                         0598
         ST    @03,@AL00001+8                                      0598
         MVI   @AL00001+8,X'80'                                    0598
         L     @15,GDTPRT(,@15)                                    0598
         LA    @01,@AL00001                                        0598
         BALR  @14,@15                                             0598
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0599
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          0599
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)SSARRAY(ENTRYNUM)=0);   0600
@DL00600 DS    0H                                                  0601
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00213                                   0601
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0602
@DE00600 L     @03,@PC00006                                        0602
         LR    @15,ENTRYNUM                                        0602
         ALR   @15,@15                                             0602
         LH    @15,SSARRAY-2(@15)                                  0602
         CH    @15,SSRHALF(,@03)                                   0602
         BE    @DC00600                                            0602
         SLR   @14,@14                                             0602
         CR    @15,@14                                             0602
         BNE   @DL00600                                            0602
@DC00600 DS    0H                                                  0603
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0603
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0603
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @09,SSDLPTR                                         0604
         MVC   DARGSMOD(3,@09),SSMODSS0                            0604
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             0605
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             0606
         BNE   @RF00606                                            0606
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   0608
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             0609
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  0612
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0612
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC00591                                            0612
@RF00591 DS    0H                                                  0613
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 0613
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         0614
         MVC   DARGSMOD(3,@15),SSMODCM0                            0614
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            0615
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00006+4                                      0616
         ST    @14,DARGDBP(,@15)                                   0616
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00213                             0617
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0618
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0619
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  0619
@RC00591 L     @15,@PC00001                                        0619
         ST    @15,@AL00001                                        0619
         LA    @14,@CF00111                                        0619
         ST    @14,@AL00001+4                                      0619
         LA    @14,SSDLPTR                                         0619
         ST    @14,@AL00001+8                                      0619
         MVI   @AL00001+8,X'80'                                    0619
         L     @15,GDTPRT(,@15)                                    0619
         LA    @01,@AL00001                                        0619
         BALR  @14,@15                                             0619
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0620
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             0620
         L     @14,@SA00006                                        0620
         LM    @00,@12,@SA00006+8                                  0620
         BR    @14                                                 0620
*   END SSCMSG;                     /*                       @Y30LB39*/
*                                                                  0622
*/********************************************************************/
*/*                                                          @Y30LB11*/
*/* PROCEDURE NAME - REMOVRCD                                @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/
*/*            IF THE CARTRIDGES ARE STILL IN THE MSF AND    @Y30LB11*/
*/*            REMOVE THE BASE OR COPY RECORD IF THE         @Y30LB11*/
*/*            CARTRIDGES ARE NOT IN THE MSF.  THE FOLLOWING @Y30LB11*/
*/*            MESSAGE MAY BE ISSUED:                        @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*           IDC2764I CARTRIDGES STILL IN MASS STORAGE      @Y30LB11*/
*/*           FACILITY.                                      @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* INPUT - THE DEFLIST MAPPING MACRO IS COMPLETELY          @Y30LB11*/
*/*         INITIALIZED AND IS USED AS INPUT TO TEST WHETHER @Y30LB11*/
*/*         THE CARTRIDGES ARE STILL IN THE MSF.  THE RVR    @Y30LB11*/
*/*         ARGUMENT LIST IS COMPLETELY INITIALIZED AND IS   @Y30LB11*/
*/*         USED AS INPUT TO REMOVE THE RECORD.              @Y30LB11*/
*/*                                                          @Y30LB11*/
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          4 - FUNCTION WAS UNSUCCESSFUL: VOLUME STILL     @Y30LB11*/
*/*              IN MSF, OR MSC FAILURE OCCURRED.            @Y30LB11*/
*/*                                                          @Y30LB11*/
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE FOR    @Y30LB11*/
*/*              ECB/MESSAGE AREA.                           @Y30LB11*/
*/********************************************************************/
*                                                                  0622
*REMOVRCD:                          /*                       @Y30LB11*/
*   PROC;                           /*                       @Y30LB11*/
REMOVRCD STM   @14,@12,@SA00007                                    0622
*   DCL                                                            0623
*     RMVRCOND FIXED(15);           /* REMOVRCD RETURN CODE  @Y30LB11*/
*                                                                  0624
*   /*****************************************************************/
*   /*                                                               */
*   /* TRACE AT ENTRY TO REMOVRCD PROCEDURE                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0624
*   OLDERID2=NEWERID2;                                             0624
         L     @05,@PC00001                                        0624
         L     @15,GDTTR2(,@05)                                    0624
         MVC   @TS00001(95),NEWERID2(@15)                          0624
         MVC   OLDERID2(95,@15),@TS00001                           0624
*   NEWID2='RRDV';                  /*                       @Y30LB11*/
*                                                                  0625
         MVC   NEWID2(4,@15),@CC01208                              0625
*   /*****************************************************************/
*   /*                                                               */
*   /* REMOVRCD RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*   RMVRCOND=0;                     /*                       @Y30LB11*/
*                                                                  0626
         SLR   @15,@15                                             0626
         LR    RMVRCOND,@15                                        0626
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC DEFINE MACRO   @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*   IF GDTDBG=NULLPTR THEN                                         0627
         C     @15,GDTDBG(,@05)                                    0627
         BE    @RT00627                                            0627
*     ;                                                            0628
*   ELSE                                                           0629
*     DO;                                                          0629
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0630
*       DMPITMNM='RVVI';                                           0631
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0631
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0631
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0631
*       DMPITMPT=ADDR(RVVI);                                       0632
         L     @05,RVVIPTR                                         0632
         ST    @05,DMPITMPT(,DMPINDEX)                             0632
*       DMPITMLN=LENGTH(RVVI);                                     0633
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0633
*       DMPITMTP='H';                                              0634
         MVI   DMPITMTP(DMPINDEX),C'H'                             0634
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0635
*                                                                  0635
         AL    DMPINDEX,@CF00464                                   0635
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0636
*       DMPTRM=DMPTRMVL;                                           0636
         MVI   DMPTRM(DMPINDEX),X'FF'                              0636
*     END;                          /*                       @Y30LB11*/
*   IF GDTDBG=NULLPTR THEN                                         0638
@RT00627 L     @05,@PC00001                                        0638
         L     @05,GDTDBG(,@05)                                    0638
         LTR   @05,@05                                             0638
         BZ    @RT00638                                            0638
*     ;                                                            0639
*   ELSE                                                           0640
*     CALL IDCDB010(GDTTBL,'RRDL',ADDR(DUMPAREA));/*         @Y30LB11*/
         L     @05,@PC00001                                        0640
         ST    @05,@AL00001                                        0640
         LA    @15,@CC01209                                        0640
         ST    @15,@AL00001+4                                      0640
         LA    @15,DUMPAREA                                        0640
         ST    @15,@AFTEMPS+16                                     0640
         LA    @15,@AFTEMPS+16                                     0640
         ST    @15,@AL00001+8                                      0640
         MVI   @AL00001+8,X'80'                                    0640
         L     @15,GDTDBG(,@05)                                    0640
         LA    @01,@AL00001                                        0640
         BALR  @14,@15                                             0640
*                                                                  0641
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE USSC MACRO TO INVOKE THE ICBDEFV (DEFINE) MACRO TO  */
*   /* PERFORM A RENAME OF THE VOLUME OR COPY TO ITSELF TO TEST      */
*   /* WHETHER THE CARTRIDGES ARE IN THE LIBRARY. THE DEFLIST WAS    */
*   /* SETUP PRIOR TO THE CALL TO REMOVRCD.                  @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0641
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLPTR,REASONCD,ECBCODE);/* @Y30LB11*/
@RT00638 L     @05,@PC00001                                        0641
         ST    @05,@AL00001                                        0641
         LA    @02,DEFINE                                          0641
         ST    @02,@AL00001+4                                      0641
         LA    @02,DEFLPTR                                         0641
         ST    @02,@AL00001+8                                      0641
         LA    @02,REASONCD                                        0641
         ST    @02,@AL00001+12                                     0641
         LA    @02,ECBCODE                                         0641
         ST    @02,@AL00001+16                                     0641
         MVI   @AL00001+16,X'80'                                   0641
         L     @15,GDTSSC(,@05)                                    0641
         LA    @01,@AL00001                                        0641
         BALR  @14,@15                                             0641
*   RESPECIFY                                                      0642
*     RTNREG RSTD;                                                 0642
*   TESTRC=RTNREG;                                                 0643
         LR    TESTRC,RTNREG                                       0643
*   RESPECIFY                                                      0644
*     RTNREG UNRSTD;                /*                       @Y30LB11*/
*                                                                  0644
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ANY CARTRIDGES WERE FOUND, THE MESSAGE: CARTRIDGES STILL IN*/
*   /* MASS STORAGE FACILITY, IS WRITTEN, AND THE RETURN CODE IS SET */
*   /* TO 4.                                                 @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0645
*   IF TESTRC=0(TESTRC=4&REASONCD=NOCSN1)/*                @Y30LB11*/
*       (TESTRC=4&REASONCD=NOCSN2) THEN/*                    @Y30LB11*/
         LTR   TESTRC,TESTRC                                       0645
         BZ    @RT00645                                            0645
         C     TESTRC,@CF00041                                     0645
         BNE   @GL00004                                            0645
         CLC   REASONCD(4),@CF01117                                0645
         BE    @RT00645                                            0645
@GL00004 C     TESTRC,@CF00041                                     0645
         BNE   @RF00645                                            0645
         CLC   REASONCD(4),@CF01119                                0645
         BNE   @RF00645                                            0645
@RT00645 DS    0H                                                  0646
*     DO;                           /*                       @Y30LB11*/
*       DARGAREA=''B;               /*                       @Y30LB11*/
         XC    DARGAREA(36),DARGAREA                               0647
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/
         L     @05,DDSTRU                                          0648
         MVC   DARGSMOD(3,@05),@CC01134                            0648
*       DARGSENT=MSG2764I;          /*                       @Y30LB11*/
         MVI   DARGSENT(@05),X'05'                                 0649
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/
         L     @05,@PC00001                                        0650
         ST    @05,@AL00001                                        0650
         LA    @15,@CF00111                                        0650
         ST    @15,@AL00001+4                                      0650
         LA    @15,DDSTRU                                          0650
         ST    @15,@AL00001+8                                      0650
         MVI   @AL00001+8,X'80'                                    0650
         L     @15,GDTPRT(,@05)                                    0650
         LA    @01,@AL00001                                        0650
         BALR  @14,@15                                             0650
*       RMVRCOND=4;                 /*                       @Y30LB11*/
         LA    RMVRCOND,4                                          0651
*     END;                          /*                       @Y30LB11*/
*                                                                  0652
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DEFINE FAILED BECAUSE OF INSUFFICIENT STORAGE, THE         */
*   /* CONDITION CODE IS SET TO 8.                           @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   ELSE                            /*                       @Y30LB11*/
*     DO;                           /*                       @Y30LB11*/
         B     @RC00645                                            0653
@RF00645 DS    0H                                                  0654
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/
         LA    @05,8                                               0654
         CR    TESTRC,@05                                          0654
         BNE   @RF00654                                            0654
*         RMVRCOND=8;               /*                       @Y30LB11*/
*                                                                  0655
         LR    RMVRCOND,@05                                        0655
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE DEFINE FAILED BECAUSE NEITHER CSN WAS FOUND, THE   */
*       /* USSC UMACRO IS ISSUED TO INVOKE THE ICBVVIC MACRO TO      */
*       /* REMOVE THE RECORD.                                @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0656
*       ELSE                        /*                       @Y30LB11*/
*         IF REASONCD=NOCSNS THEN   /*                       @Y30LB11*/
         B     @RC00654                                            0656
@RF00654 CLC   REASONCD(4),@CF01121                                0656
         BNE   @RF00656                                            0656
*           DO;                     /*                       @Y30LB11*/
*                                                                  0657
*             /*******************************************************/
*             /*                                                     */
*             /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO   */
*             /*                                             @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0658
*             IF GDTDBG=NULLPTR THEN                               0658
         L     @05,@PC00001                                        0658
         L     @05,GDTDBG(,@05)                                    0658
         LTR   @05,@05                                             0658
         BZ    @RT00658                                            0658
*               ;                                                  0659
*             ELSE                                                 0660
*               DO;                                                0660
*                 DMPINDEX=ADDR(DUMPAREA);/*                 @Y30LB11*/
         LA    DMPINDEX,DUMPAREA                                   0661
*                 DMPITMNM='RVVI';                                 0662
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0662
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0662
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0662
*                 DMPITMPT=ADDR(RVVI);                             0663
         L     @05,RVVIPTR                                         0663
         ST    @05,DMPITMPT(,DMPINDEX)                             0663
*                 DMPITMLN=LENGTH(RVVI);                           0664
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0664
*                 DMPITMTP='H';                                    0665
         MVI   DMPITMTP(DMPINDEX),C'H'                             0665
*                 DMPINDEX=DMPINDEX+DMPELEMT;                      0666
*                                                                  0666
         AL    DMPINDEX,@CF00464                                   0666
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @Y30LB11*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0667
*                 DMPTRM=DMPTRMVL;                                 0667
         MVI   DMPTRM(DMPINDEX),X'FF'                              0667
*               END;                /*                       @Y30LB11*/
*             IF GDTDBG=NULLPTR THEN                               0669
@RT00658 L     @05,@PC00001                                        0669
         L     @05,GDTDBG(,@05)                                    0669
         LTR   @05,@05                                             0669
         BZ    @RT00669                                            0669
*               ;                                                  0670
*             ELSE                                                 0671
*               CALL IDCDB010(GDTTBL,'RRRE',ADDR(DUMPAREA));/*     0671
*                                                            @Y30LB11*/
         L     @05,@PC00001                                        0671
         ST    @05,@AL00001                                        0671
         LA    @15,@CC01210                                        0671
         ST    @15,@AL00001+4                                      0671
         LA    @15,DUMPAREA                                        0671
         ST    @15,@AFTEMPS+16                                     0671
         LA    @15,@AFTEMPS+16                                     0671
         ST    @15,@AL00001+8                                      0671
         MVI   @AL00001+8,X'80'                                    0671
         L     @15,GDTDBG(,@05)                                    0671
         LA    @01,@AL00001                                        0671
         BALR  @14,@15                                             0671
*                                                                  0672
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE THE USSC UMACRO IS ISSUED TO INVOKE THE       */
*             /* ICBVVIC MACRO TO REMOVE THE RECORD.         @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0672
*             CALL IDCSASS0(GDTTBL,VVIC,RVRPTR,REASONCD);/*  @Y30LB11*/
@RT00669 L     @05,@PC00001                                        0672
         ST    @05,@AL00001                                        0672
         LA    @02,VVIC                                            0672
         ST    @02,@AL00001+4                                      0672
         LA    @02,RVRPTR                                          0672
         ST    @02,@AL00001+8                                      0672
         LA    @02,REASONCD                                        0672
         ST    @02,@AL00001+12                                     0672
         MVI   @AL00001+12,X'80'                                   0672
         L     @15,GDTSSC(,@05)                                    0672
         LA    @01,@AL00001                                        0672
         BALR  @14,@15                                             0672
*             RESPECIFY                                            0673
*               RTNREG RSTD;                                       0673
*             TESTRC=RTNREG;                                       0674
         LR    TESTRC,RTNREG                                       0674
*             RESPECIFY                                            0675
*               RTNREG UNRSTD;      /*                       @Y30LB11*/
*                                                                  0675
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE REMOVAL WAS UNSUCCESSFUL, SSCMSG IS INVOKED  */
*             /* EXPLAINING THE REASON FOR THE FAILURE AND THE RETURN*/
*             /* CODE IS SET TO 4.                           @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0676
*             IF TESTRC=4 THEN                                     0676
         C     TESTRC,@CF00041                                     0676
         BNE   @RF00676                                            0676
*               DO;                 /*                       @Y30LB11*/
*                 CALL SSCMSG(REASONCD);/*                   @Y30LB11*/
         LA    @02,REASONCD                                        0678
         ST    @02,@AL00001                                        0678
         LA    @01,@AL00001                                        0678
         BAL   @14,SSCMSG                                          0678
*                 RMVRCOND=4;       /*                       @Y30LB11*/
         LA    RMVRCOND,4                                          0679
*               END;                /*                       @Y30LB11*/
*                                                                  0680
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE REMOVAL WAS SUCCESSFUL BUT THERE WAS AN I/O  */
*             /* ERROR UPDATING A RECORD IN THE INVENTORY, SET THE   */
*             /* WARNING FLAG ON.                            @Y30LB11*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0681
*             IF TESTRC=12 THEN                                    0681
@RF00676 C     TESTRC,@CF00035                                     0681
         BNE   @RF00681                                            0681
*               WARNFLG=ON;         /*                       @Y30LB11*/
         OI    WARNFLG,B'10000000'                                 0682
*           END;                    /*                       @Y30LB11*/
*                                                                  0683
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEFINE FAILED BECAUSE OF AN UNEXPECTED ERROR, SSCMSG IS*/
*       /* INVOKED TO WRITE A MESSAGE EXPLAINING THE REASON FOR THE  */
*       /* FAILURE AND THE RETURN CODE IS SET TO 4.          @Y30LB11*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0684
*         ELSE                                                     0684
*           DO;                     /*                       @Y30LB11*/
         B     @RC00656                                            0684
@RF00656 DS    0H                                                  0685
*             CALL SSCMSG(REASONCD);/*                       @Y30LB11*/
         LA    @15,REASONCD                                        0685
         ST    @15,@AL00001                                        0685
         LA    @01,@AL00001                                        0685
         BAL   @14,SSCMSG                                          0685
*             RMVRCOND=4;           /*                       @Y30LB11*/
         LA    RMVRCOND,4                                          0686
*           END;                    /*                       @Y30LB11*/
*     END;                          /*                       @Y30LB11*/
*                                                                  0688
@RC00656 DS    0H                                                  0688
@RC00654 DS    0H                                                  0689
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Y30LB11*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0689
*   RETURN CODE(RMVRCOND);          /*                       @Y30LB11*/
@RC00645 LR    @15,RMVRCOND                                        0689
         L     @14,@SA00007                                        0689
         LM    @00,@12,@SA00007+8                                  0689
         BR    @14                                                 0689
*   END REMOVRCD;                   /*                       @Y30LB11*/
*   END IDCRR01                     /*                       @Y30LB11*/
*                                                                  0691
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSRR )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZRVR  )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  0691
*       ;                                                          0691
@DATA    DS    0H
@CH00147 DC    H'2'
@CH00150 DC    H'6'
@CH00173 DC    H'8'
@CH01212 DC    H'68'
@CH01214 DC    H'120'
@CH01211 DC    H'164'
@CH01213 DC    H'224'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00005 DS    15F
@SA00003 DS    15F
@SA00002 DS    15F
@SA00007 DS    15F
@SA00006 DS    15F
@PC00006 DS    2F
@SA00004 DS    15F
@AL00001 DS    5A
@AFTEMPS DS    5F
IDCRR01  CSECT
         DS    0F
@CF00111 DC    F'0'
@CF00213 DC    F'1'
@CH00213 EQU   @CF00213+2
@CF00041 DC    F'4'
@CH00041 EQU   @CF00041+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00464 DC    F'16'
@CF01115 DC    XL4'0208'
@CF01117 DC    XL4'26'
@CF01119 DC    XL4'2A'
@CF01121 DC    XL4'23'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
RVVIPTR  DS    A
RVRPTR   DS    A
DEFLPTR  DS    A
REASONCD DS    F
SEQNUM   DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
ECBCODE  DS    FL1
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
BASEAREA DS    CL224
COPYAREA DS    CL164
DARGAREA DS    CL36
DEFAREA  DS    CL132
DUMPAREA DS    CL17
RMVDFLG  DS    BL1
RVRAREA  DS    CL24
RVVIAREA DS    CL68
WARNFLG  DS    BL1
SSDRGLT  DS    CL20
         DS    CL2
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRR01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
RVRLEN   DC    AL2(24)
SSMSGNUM DC    AL1(56)
@CC01145 DC    C'RRRM'
@CC01146 DC    C'RRRR'
@CC01151 DC    C'RRRC'
@CC01157 DC    C'RRAP'
@CC01158 DC    C'RVVI'
@CC01160 DC    C'RRRA'
@CC01167 DC    C'RRBA'
@CC01168 DC    C'RRRB'
@CC01174 DC    C'RRBP'
@CC01175 DC    C'RRRV'
@CC01180 DC    C'RRCP'
@CC01182 DC    C'RRCR'
@CC01203 DC    C'SSAA'
@CC01208 DC    C'RRDV'
@CC01209 DC    C'RRDL'
@CC01210 DC    C'RRRE'
@CC01113 DC    C'CM0'
@CC01134 DC    C'RR0'
@CC01139 DC    C'UV0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
MODID    DC    CL4'RR01'
FIXAREA  DS    CL250
         ORG   FIXAREA
@NM00085 DC    250X'00'
         ORG   FIXAREA+250
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RMVRCOND EQU   @04
ENTRYNUM EQU   @02
COPYCOND EQU   @04
BPROCOND EQU   @04
BASECOND EQU   @04
ALLCOND  EQU   @04
COPYVPTR EQU   @05
BASEVPTR EQU   @06
DMPINDEX EQU   @02
TESTRC   EQU   @03
SETRC    EQU   @04
RTNREG   EQU   @15
DEFVR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSAEP0 EQU   0
IDCSASS0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
VOL      EQU   0
VOLVAL   EQU   VOL+1
ALLC     EQU   0
CDATE    EQU   0
DATE     EQU   0
DATEVAL  EQU   DATE
SEQ      EQU   0
SEQVAL   EQU   SEQ
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00057 EQU   SV82LIST+4
SV82DCBP EQU   @NM00057
@NM00058 EQU   SV82LIST+12
SV82WRKP EQU   @NM00058
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASREASS EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASMISCF EQU   BASRCVYF+2
BASCSN1  EQU   BASEV+24
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
COPYV    EQU   0
COPNAME  EQU   COPYV
COPID    EQU   COPNAME+11
COPNO    EQU   COPID+1
COPFLAGA EQU   COPYV+14
COPTYPE  EQU   COPFLAGA
COPRCVYF EQU   COPYV+20
COPSATIA EQU   COPRCVYF
COPMISCF EQU   COPRCVYF+2
COPCSN1  EQU   COPYV+24
COPLIB1  EQU   COPYV+36
COPLID1  EQU   COPLIB1
COPLIB2  EQU   COPYV+49
COPLID2  EQU   COPLIB2
COPDATE  EQU   COPYV+50
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVCDATE EQU   RVVI+38
RVVRDSEQ EQU   RVVI+43
RVVCPYID EQU   RVVI+56
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSDTE  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
RVR      EQU   0
RVRLNGTH EQU   RVR
RVRCODE  EQU   RVR+4
RVRVOLID EQU   RVR+8
RVRCPYID EQU   RVR+15
RVRFLAGA EQU   RVR+16
RVRBASEV EQU   RVRFLAGA
RVRCOPYV EQU   RVRFLAGA
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVRNTR EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVNVOL EQU   DEFLIST+16
DEFVCSN1 EQU   DEFLIST+24
DEFVDATA EQU   DEFLIST+56
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACA0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00086 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
DEFVVEXT EQU   DEFLIST+128
DEFTLAB  EQU   DEFVDATA+71
DEFR60   EQU   DEFVDATA+43
DEFOWNID EQU   DEFVDATA+29
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00084 EQU   DEFLIST+48
DEFVCSN2 EQU   DEFLIST+36
@NM00083 EQU   DEFLIST+22
@NM00082 EQU   DEFLIST+15
@NM00081 EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
@NM00080 EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVSEC  EQU   DEFVVFLG
@NM00079 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00078 EQU   DEFVLIB
DEFVDACT EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVRNM  EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
DEFVCR   EQU   DEFVFLG
@NM00077 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00076 EQU   RVR+20
@NM00075 EQU   RVRFLAGA
RVRBLNK1 EQU   RVR+14
@NM00074 EQU   RVRCODE+1
RVROPCD  EQU   RVRCODE
@NM00073 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00072 EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
@NM00071 EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
@NM00070 EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00069 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00068 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVRDCSN EQU   RVVI+44
RVVBLNK1 EQU   RVVI+42
RVVEXPIR EQU   RVVI+36
@NM00067 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00066 EQU   RVVOPCOD+1
@NM00065 EQU   COPYV+136
COPFREXT EQU   COPYV+132
COPLEXT  EQU   COPYV+130
COPFRESP EQU   COPYV+128
COPOWNER EQU   COPYV+118
COPDEST  EQU   COPYV+88
COPDESCR EQU   COPYV+58
COPDTREM EQU   COPYV+54
COP2BIT2 EQU   COPLID2
COP2BIT1 EQU   COPLID2
COPRES5  EQU   COPLIB2
COPCSN2  EQU   COPYV+37
COP1BIT2 EQU   COPLID1
COP1BIT1 EQU   COPLID1
COPRES4  EQU   COPLIB1
@NM00064 EQU   COPMISCF
COPHOLD  EQU   COPMISCF
COPRES3  EQU   COPSATIA
COPVSMIS EQU   COPSATIA
COPIVCPY EQU   COPSATIA
COPIVCRE EQU   COPSATIA
@NM00063 EQU   COPYV+18
@NM00062 EQU   COPFLAGA+3
COPDLSPF EQU   COPFLAGA+3
COPRONLY EQU   COPFLAGA+3
COPDAERA EQU   COPFLAGA+2
COPEXCL  EQU   COPFLAGA+2
COPBIND  EQU   COPFLAGA+2
COPBKUP  EQU   COPFLAGA+2
COPRSTD  EQU   COPFLAGA+2
COPGENUS EQU   COPFLAGA+2
COPVSAM  EQU   COPFLAGA+2
COPGROUP EQU   COPFLAGA+2
COPRES2  EQU   COPTYPE
COPCOPYV EQU   COPTYPE
COPRES1  EQU   COPTYPE
COPRES6  EQU   COPYV+13
COPBLANK EQU   COPID
COPSERNO EQU   COPNAME+5
COPV     EQU   COPNAME
@NM00061 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00060 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASIVCRE EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00059 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
@NM00056 EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00055 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00054 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00053 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00052 EQU   RCTAGL+10
@NM00051 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00050 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00049 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00048 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00047 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00046 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00045 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00044 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00043 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00042 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00041 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00040 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00039 EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00038 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00037 EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00036 EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00035 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00034 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00033 EQU   CMMSG+7
@NM00032 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00031 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00030 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
VOLLEN   EQU   VOL
@NM00029 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00028 EQU   DMPITM+15
@NM00027 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00026 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00025 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00024 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00023 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00022 EQU   OPNAGL+43
@NM00021 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
OPNOPTNF EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00020 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00019 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00018 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00017 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00016 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00015 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACNF EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00263 EQU   @RC00257
@RC00409 EQU   @RC00400
@RC00473 EQU   @RC00447
@RF00606 EQU   @RC00591
@RF00681 EQU   @RC00656
@PB00007 EQU   @EL00001
@RF00415 EQU   @RC00409
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRR01,(C'PLS1351',0603,75225)

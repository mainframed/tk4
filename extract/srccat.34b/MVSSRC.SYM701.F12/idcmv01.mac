         TITLE '******** IDCMV01: MODIFYV FSR ********                 *
                        '
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCMV01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCMV01   76.349'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @08,0                                               0002
@PSTART  LA    @09,4095(,@08)                                      0002
         LA    @10,4095(,@09)                                      0002
         LA    @12,4095(,@10)                                      0002
         USING @PSTART,@08                                         0002
         USING @PSTART+4095,@09                                    0002
         USING @PSTART+8190,@10                                    0002
         USING @PSTART+12285,@12                                   0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0313
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE MAIN ROUTINE. IT ENQUEUES ON THE          @Y30LB33*/
*   /* VOLUME AND CALLS THE INPUT CHECKING                   @Y30LB33*/
*   /* FUNCTION. IF THE CHECKING FUNCTION FINDS NO           @Y30LB33*/
*   /* ERRORS, IT CALLS THE MODIFICATION ROUTINE             @Y30LB33*/
*   /* THAT UPDATES THE VOLUME. IT THEN DEQUEUES             @Y30LB33*/
*   /* ON THE VOLUME, PRINTS THE FINAL COMPLETION            @Y30LB33*/
*   /* MESSAGE ACCORDING TO THE VALUE OF LASTCOND            @Y30LB33*/
*   /* AND RETURNS WITH A RETURN CODE IN LASTCOND            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*   OLDERID2=NEWERID2;                                             0313
         L     @15,@PC00001                                        0313
         L     @14,GDTTR2(,@15)                                    0313
         MVC   @TS00001(95),NEWERID2(@14)                          0313
         MVC   OLDERID2(95,@14),@TS00001                           0313
*   NEWID2='MVAA';                  /*                       @Y30LB33*/
         MVC   NEWID2(4,@14),@CC01637                              0314
*   IF GDTDBG=NULLPTR THEN                                         0315
         L     @15,GDTDBG(,@15)                                    0315
         LTR   @15,@15                                             0315
         BZ    @RT00315                                            0315
*     ;                                                            0316
*   ELSE                                                           0317
*     CALL IDCDB010(GDTTBL,'MVAA'); /*                       @Y30LB33*/
*                                                                  0317
         L     @15,@PC00001                                        0317
         ST    @15,@AL00001                                        0317
         LA    @14,@CC01637                                        0317
         ST    @14,@AL00001+4                                      0317
         MVI   @AL00001+4,X'80'                                    0317
         L     @15,GDTDBG(,@15)                                    0317
         LA    @01,@AL00001                                        0317
         BALR  @14,@15                                             0317
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRST, INITIALIZE POINTERS                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0318
*   DUMPADDR=ADDR(DUMPAREA);        /*                       @Y30LB33*/
@RT00315 LA    @07,DUMPAREA                                        0318
         ST    @07,DUMPADDR                                        0318
*   DDSTRU=ADDR(MVDRGLST);          /*                       @Y30LB33*/
         LA    @07,MVDRGLST                                        0319
         ST    @07,DDSTRU                                          0319
*   BASEVPTR=ADDR(VOLRCDBF);        /*                       @Y30LB33*/
         LA    BASEVPTR,VOLRCDBF                                   0320
*   GROUPPTR=ADDR(GRPRCDBF);        /*                       @Y30LB33*/
         LA    GROUPPTR,GRPRCDBF                                   0321
*   RVVIPTR=ADDR(MVRVVI);           /*                       @Y30LB33*/
         LA    @07,MVRVVI                                          0322
         ST    @07,RVVIPTR                                         0322
*   DEFVEPTR=ADDR(MVDEFVE);         /*                       @Y30LB33*/
         LA    DEFVEPTR,MVDEFVE                                    0323
*   OPNPTR=ADDR(MVOPNAGL);          /*                       @Y30LB33*/
         LA    OPNPTR,MVOPNAGL                                     0324
*   DEFVPTR=ADDR(MVDEFLST);         /*                       @Y30LB33*/
         LA    @07,MVDEFLST                                        0325
         ST    @07,DEFVPTR                                         0325
*   MVRPTR=ADDR(MVMVRLST);          /*                       @Y30LB33*/
         LA    @07,MVMVRLST                                        0326
         ST    @07,MVRPTR                                          0326
*   MVUCBPTR=NULLPTR;               /*                       @Y30LB33*/
         SLR   @07,@07                                             0327
         ST    @07,MVUCBPTR                                        0327
*   IOCTLBKP=NULLPTR;               /*                       @ZDR2057*/
*                                                                  0328
         ST    @07,IOCTLBKP                                        0328
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR THE BIT SWITCHES AND FLAG HOLDER                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*   SWCHBITS=SWCHBITS&&SWCHBITS;    /*                       @Y30LB33*/
         XC    SWCHBITS(2),SWCHBITS                                0329
*   MYVVFLG=MYVVFLG&&MYVVFLG;       /*                       @Y30LB33*/
*                                                                  0330
         XC    MYVVFLG(1),MYVVFLG                                  0330
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE ENQUEUE ARGUMENT LIST                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   MVMAJNAM=MVMAJCON;              /*                       @Y30LB33*/
         MVC   MVMAJNAM(8),@CC01584                                0331
*   MINAMLN=LENGTH(MVMINNAM)-1;     /*                       @Y30LB33*/
         MVI   MINAMLN,X'16'                                       0332
*   MINAMQL=MINQLE;                 /*                       @Y30LB33*/
         MVC   MINAMQL(16),@CC01586                                0333
*   MINAMVOL=VOLVAL;                /*                       @Y30LB33*/
*                                                                  0334
         L     @15,@PC00001+4                                      0334
         L     @01,FDTPTR(,@15)                                    0334
         MVC   MINAMVOL(6),VOLVAL(@01)                             0334
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FILE PARAMETER IS PRESENT, PUT THE             @Y30LB33*/
*   /* DDNAME GIVEN INTO THE HOLD AREA                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   IF ADDR(FYLE)>0 THEN                                           0335
         L     @15,FDTPTR+88(,@15)                                 0335
         CR    @15,@07                                             0335
         BNH   @RF00335                                            0335
*     MVDDNAME=FYLEVAL;             /*                       @Y30LB33*/
*                                                                  0336
         MVC   MVDDNAME(8),FYLEVAL(@15)                            0336
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE NEWSERIAL IS GIVEN, PUT ITS VALUE              @Y30LB33*/
*   /* INTO THE VOLUME SERIAL HOLD AREA. OTHERWISE           @Y30LB33*/
*   /* PUT IN THE VOLUME PARAMETER VALUE                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0337
*   IF ADDR(NEWSR)>0 THEN                                          0337
@RF00335 L     @07,@PC00001+4                                      0337
         L     @07,FDTPTR+4(,@07)                                  0337
         LTR   @07,@07                                             0337
         BNP   @RF00337                                            0337
*     MVVOLUME=NEWSRVAL;            /*                       @Y30LB33*/
         MVC   MVVOLUME(6),NEWSRVAL(@07)                           0338
*   ELSE                                                           0339
*     MVVOLUME=VOLVAL;              /*                       @Y30LB33*/
         B     @RC00337                                            0339
@RF00337 L     @07,@PC00001+4                                      0339
         L     @07,FDTPTR(,@07)                                    0339
         MVC   MVVOLUME(6),VOLVAL(@07)                             0339
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* ENQUEUE ON THE VOLUME SERIAL                          @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MVMAJNAM,MVMINNAM);/*     @Y30LB33*/
*                                                                  0340
@RC00337 L     @07,@PC00001                                        0340
         ST    @07,@AL00001                                        0340
         LA    @15,EXCL                                            0340
         ST    @15,@AL00001+4                                      0340
         LA    @15,WAIT                                            0340
         ST    @15,@AL00001+8                                      0340
         LA    @15,MVMAJNAM                                        0340
         ST    @15,@AL00001+12                                     0340
         LA    @15,MVMINNAM                                        0340
         ST    @15,@AL00001+16                                     0340
         MVI   @AL00001+16,X'80'                                   0340
         L     @15,GDTENQ(,@07)                                    0340
         LA    @01,@AL00001                                        0340
         BALR  @14,@15                                             0340
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL THE CHECKOUT ROUTINE TO ESTABLISH                @Y30LB33*/
*   /* THE VALIDITY OF THE MODIFYV COMMAND                   @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   CALL CHECKOUT;                  /*                       @Y30LB33*/
*                                                                  0341
         BAL   @14,CHECKOUT                                        0341
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LASTCOND IS NOT 12, CALL THE DOIT OR               @ZDR2057*/
*   /* RBLABEL TO PERFORM THE VOLUME MODIFICATION            @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0342
*   IF LASTCOND^=TERMCODE THEN      /*                       @ZDR2057*/
         L     @07,@PC00001+8                                      0342
         CLC   LASTCOND(2,@07),@CH00038                            0342
         BE    @RF00342                                            0342
*     IF ADDR(RLBL)^=NULLPTR THEN                                  0343
         L     @07,@PC00001+4                                      0343
         L     @07,FDTPTR+100(,@07)                                0343
         LTR   @07,@07                                             0343
         BZ    @RF00343                                            0343
*       CALL RBLABEL;               /*                       @ZDR2057*/
         BAL   @14,RBLABEL                                         0344
*     ELSE                                                         0345
*       CALL DOIT;                  /*                       @ZDR2057*/
*                                                                  0345
         B     @RC00343                                            0345
@RF00343 BAL   @14,DOIT                                            0345
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE A DEQUEUE AGAINST THE VOLUME MODIFIED           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0346
*   MINAMLN=LENGTH(MVMINNAM)-1;     /*                       @Y30LB33*/
@RC00343 DS    0H                                                  0346
@RF00342 MVI   MINAMLN,X'16'                                       0346
*   MINAMVOL=VOLVAL;                /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      0347
         L     @01,FDTPTR(,@15)                                    0347
         MVC   MINAMVOL(6),VOLVAL(@01)                             0347
*   MINAMQL=MINQLE;                 /*                       @Y30LB33*/
         MVC   MINAMQL(16),@CC01586                                0348
*   CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*               @Y30LB33*/
         L     @15,@PC00001                                        0349
         ST    @15,@AL00001                                        0349
         LA    @14,MVMAJNAM                                        0349
         ST    @14,@AL00001+4                                      0349
         LA    @14,MVMINNAM                                        0349
         ST    @14,@AL00001+8                                      0349
         MVI   @AL00001+8,X'80'                                    0349
         L     @15,GDTDEQ(,@15)                                    0349
         LA    @01,@AL00001                                        0349
         BALR  @14,@15                                             0349
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE PRINT FOR MESSAGES IDC0001I OR IDC3003I         @Y30LB33*/
*   /* TO INDICATE THE FINAL COMPLETION STATUS AND           @Y30LB33*/
*   /* RETURN TO THE EXECUTIVE                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/
         L     @15,DDSTRU                                          0350
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0350
*   DARGSMOD=MODUNIV;               /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODUNIV                             0351
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB33*/
         L     @14,@PC00001+8                                      0352
         ST    @14,DARGDBP(,@15)                                   0352
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00156                             0353
*   IF LASTCOND<LASTCC12 THEN                                      0354
         LH    @14,LASTCOND(,@14)                                  0354
         C     @14,@CF00038                                        0354
         BNL   @RF00354                                            0354
*     DARGSENT=MSG0001I;            /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'01'                                 0355
*   ELSE                                                           0356
*     DARGSENT=MSG3003I;            /*                       @Y30LB33*/
         B     @RC00354                                            0356
@RF00354 L     @01,DDSTRU                                          0356
         MVI   DARGSENT(@01),X'03'                                 0356
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/
@RC00354 L     @15,@PC00001                                        0357
         ST    @15,@AL00001                                        0357
         LA    @14,@CF00117                                        0357
         ST    @14,@AL00001+4                                      0357
         LA    @14,DDSTRU                                          0357
         ST    @14,@AL00001+8                                      0357
         MVI   @AL00001+8,X'80'                                    0357
         L     @15,GDTPRT(,@15)                                    0357
         LA    @01,@AL00001                                        0357
         BALR  @14,@15                                             0357
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0358
*                                                                  0358
         L     @15,@PC00001                                        0358
         ST    @15,@AL00001                                        0358
         LA    @14,MODID                                           0358
         ST    @14,@AL00001+4                                      0358
         L     @14,@PC00001+8                                      0358
         ST    @14,@AL00001+8                                      0358
         MVI   @AL00001+8,X'80'                                    0358
         L     @15,GDTEPL(,@15)                                    0358
         LA    @01,@AL00001                                        0358
         BALR  @14,@15                                             0358
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*                                                                  0359
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - CHECKOUT                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - CALLS OTHER ROUTINES TO ESTABLISH THE         @Y30LB33*/
*/*      VALIDITY OF THE MODIFYV REQUEST. IT ENSURES THAT    @Y30LB33*/
*/*      THE VOLUME IS AVAILABLE FOR MODIFICATION AND THAT   @Y30LB33*/
*/*      THE MODIFICATIONS ARE NOT CONFLICTING EITHER WITH   @Y30LB33*/
*/*      THEMSELVES OR WITH EXISTING CHARACTERISTICS OF THE  @Y30LB33*/
*/*      VOLUME. IT ISSUES MESSAGE IDC3090I IF THE VOLUME    @Y30LB33*/
*/*      CHANGES CAN NOT BE MADE BECAUSE THE VOLUME HAS      @Y30LB33*/
*/*      THE READONLY ATTRIBUTE.                             @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MSG3090I IS ISSUED WHEN READONLY ATTRIBUTE DOES NOT @Y30LB33*/
*/*      ALLOW UPDATING OF THE VOLUME LABEL AS REQUESTED     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MSG3692I IS ISSUED WHEN A VTOC HEAD ADDRESS         @ZDR2057*/
*/*      GREATER THAN HEX 12 IS SPECIFIED FOR REBUILD        @ZDR2057*/
*/*      A VOLUME LABEL.                                     @ZDR2057*/
*/*                                                          @ZDR2057*/
*/*      THIS ROUTINE CALLS THE PROCEDURES                   @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*            VOLCK                                         @Y30LB33*/
*/*            GRPPROC                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL CONTAINING THE INPUT PARAMETERS FROM  @Y30LB33*/
*/*      THE USER, AND THE SWCHBITS AREA                     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS SET TO 12 TO INDICATE THAT          @Y30LB33*/
*/*      THE VOLUME LABEL WAS REQUESTED TO BE CHANGED AND    @Y30LB33*/
*/*      THAT THAT OPERATION CAN NOT BE PERFORMED BECAUSE    @Y30LB33*/
*/*      EITHER THE VOLUME HAS THE READONLY ATTRIBUTE        @Y30LB33*/
*/*      OR THE VOLUME IS NOT ALLOCATED WITH EXCLUSIVE       @Y30LB33*/
*/*      CONTROL OR IS NOT A VIRTUAL VOLUME                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      SWCHBITS ARE SET TO INDICATE THE CONDITIONS FOR     @Y30LB33*/
*/*      WHICH THEY ARE DEFINED. THOSE THAT ARE SET INCLUDE  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*            RENAMSW                                       @Y30LB33*/
*/*            ATTRSW                                        @Y30LB33*/
*/*            MSVCSW                                        @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0359
*CHECKOUT:                                                         0359
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
@EL00001 L     @13,4(,@13)                                         0359
@EF00001 L     @00,@SIZDATD                                        0359
         LR    @01,@11                                             0359
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0359
         BR    @14                                                 0359
CHECKOUT DS    0H                                                  0360
*   DCL                                                            0360
*     CKOUTSV PTR(31);              /* SAVE AREA FOR REG 14  @Y30LB33*/
*   CKOUTSV=REG14;                  /* SAVE RETURN ADDRESS   @Y30LB33*/
         ST    REG14,CKOUTSV                                       0361
*   OLDERID2=NEWERID2;                                             0362
         L     @07,@PC00001                                        0362
         L     @07,GDTTR2(,@07)                                    0362
         MVC   @TS00001(95),NEWERID2(@07)                          0362
         MVC   OLDERID2(95,@07),@TS00001                           0362
*   NEWID2='MVBA';                  /*                       @Y30LB33*/
*                                                                  0363
         MVC   NEWID2(4,@07),@CC01645                              0363
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE CHANGING THE SERIAL OR THE OWNER,           @Y30LB33*/
*   /* TURN ON THE RENAME SWITCH TO INDICATE RELABELING      @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   IF ADDR(NEWSR)>0×ADDR(OWNER)>0× /*                       @Y30LB33*/
*       ADDR(NOWN)>0 THEN           /*                       @Y30LB33*/
         SLR   @07,@07                                             0364
         L     @15,@PC00001+4                                      0364
         C     @07,FDTPTR+4(,@15)                                  0364
         BL    @RT00364                                            0364
         C     @07,FDTPTR+8(,@15)                                  0364
         BL    @RT00364                                            0364
         C     @07,FDTPTR+72(,@15)                                 0364
         BNL   @RF00364                                            0364
@RT00364 DS    0H                                                  0365
*     RENAMSW=ON;                   /*                       @Y30LB33*/
*                                                                  0365
         OI    RENAMSW,B'01000000'                                 0365
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ANY ATTRIBUTES ARE BEING SET OR NULLIFIED,         @Y30LB33*/
*   /* BY USER REQUEST, TURN ON THE ATTRIBUTE SWITCH         @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*   IF ADDR(BIND)>0×ADDR(NBIND)>0×  /*                       @Y30LB33*/
*       ADDR(EXECL)>0×ADDR(SHRD)>0× /*                       @Y30LB33*/
*       ADDR(RONLY)>0×ADDR(RW)>0×   /*                       @Y30LB33*/
*       ADDR(DERAS)>0×ADDR(NDERS)>0 /*                       @Y30LB33*/
*     THEN                                                         0366
@RF00364 SLR   @07,@07                                             0366
         L     @15,@PC00001+4                                      0366
         C     @07,FDTPTR+24(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+28(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+32(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+36(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+40(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+44(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+48(,@15)                                 0366
         BL    @RT00366                                            0366
         C     @07,FDTPTR+52(,@15)                                 0366
         BNL   @RF00366                                            0366
@RT00366 DS    0H                                                  0367
*     ATTRSW=ON;                    /*                       @Y30LB33*/
*                                                                  0367
         OI    ATTRSW,B'00100000'                                  0367
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CHANGES ARE TO BE MADE TO THE MSVC RECORD          @Y30LB33*/
*   /* BY USER REQUEST, TURN ON THE APPROPRIATE SWITCH       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0368
*   IF ADDR(GRP)>0×ADDR(GNRL)>0×    /*                       @Y30LB33*/
*       ADDR(RSTR)>0×ADDR(DESCR)>0× /*                       @Y30LB33*/
*       ADDR(BKUP)>0×ADDR(NGRP)>0×  /*                       @Y30LB33*/
*       ADDR(NRET)>0×ADDR(NDESC)>0× /*                       @Y30LB33*/
*       ADDR(TO)>0×ADDR(FORE)>0     /*                       @Y30LB33*/
*     THEN                                                         0368
@RF00366 SLR   @07,@07                                             0368
         L     @15,@PC00001+4                                      0368
         C     @07,FDTPTR+12(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+16(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+20(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+56(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+64(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+76(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+84(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+80(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+60(,@15)                                 0368
         BL    @RT00368                                            0368
         C     @07,FDTPTR+96(,@15)                                 0368
         BNL   @RF00368                                            0368
@RT00368 DS    0H                                                  0369
*     MSVCSW=ON;                    /*                       @Y30LB33*/
*                                                                  0369
         OI    MSVCSW,B'00010000'                                  0369
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR A VALID VTOC HEAD ADDRESS                   @ZDR2057*/
*   /* FOR A REBUILD LABEL REQUEST.                          @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0370
*   IF ADDR(RLBL)^=NULLPTR THEN                                    0370
@RF00368 L     @07,@PC00001+4                                      0370
         L     @15,FDTPTR+100(,@07)                                0370
         LTR   @15,@15                                             0370
         BZ    @RF00370                                            0370
*     DO;                           /*                       @ZDR2057*/
*       VTOCCCHH=VADDRVAL;          /*                       @ZDR2057*/
         L     @07,FDTPTR+104(,@07)                                0372
         MVC   VTOCCCHH(4),VADDRVAL(@07)                           0372
*       VTOCR=VTOCRR;               /* RECORD TO 1           @ZDR2057*/
         MVC   VTOCR(1),VTOCRR                                     0373
*       IF VTOCHH>MAXHH THEN                                       0374
         CLC   VTOCHH(2),MAXHH                                     0374
         BNH   @RF00374                                            0374
*         DO;                       /*                       @ZDR2057*/
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @ZDR2057*/
         L     @07,DDSTRU                                          0376
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0376
*           DARGSMOD=MODMV0;        /*                       @ZDR2057*/
         MVC   DARGSMOD(3,@07),MODMV0                              0377
*           DARGSENT=MSG3692I;      /*                       @ZDR2057*/
         MVI   DARGSENT(@07),X'03'                                 0378
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @ZDR2057*/
         L     @07,@PC00001                                        0379
         ST    @07,@AL00001                                        0379
         LA    @15,@CF00117                                        0379
         ST    @15,@AL00001+4                                      0379
         LA    @15,DDSTRU                                          0379
         ST    @15,@AL00001+8                                      0379
         MVI   @AL00001+8,X'80'                                    0379
         L     @15,GDTPRT(,@07)                                    0379
         LA    @01,@AL00001                                        0379
         BALR  @14,@15                                             0379
*           LASTCOND=TERMCODE;      /*                       @ZDR2057*/
         L     @07,@PC00001+8                                      0380
         MVC   LASTCOND(2,@07),@CH00038                            0380
*         END;                      /*                       @ZDR2057*/
*     END;                          /*                       @ZDR2057*/
@RF00374 DS    0H                                                  0383
*   IF LASTCOND^=TERMCODE THEN                                     0383
@RF00370 L     @07,@PC00001+8                                      0383
         CLC   LASTCOND(2,@07),@CH00038                            0383
         BE    @RF00383                                            0383
*     DO;                           /*                       @ZDR2057*/
*                                                                  0384
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE VOLUME CHECKER TO READ THE BASE VOLUME   @Y30LB33*/
*       /* RECORD AND MAKE SURE THAT THE REQUESTED CHANGES   @Y30LB33*/
*       /* CAN BE MADE                                       @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0385
*       CALL VOLCK;                 /*                       @Y30LB33*/
*                                                                  0385
         BAL   @14,VOLCK                                           0385
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME RECORD WAS READ, AND THIS IS        @ZDR2057*/
*       /* NOT A REBUILD LABEL REQUEST CALL THE GROUP        @ZDR2057*/
*       /* CHECKER TO READ ANY GROUP RECORDS INVOLVED IN     @Y30LB33*/
*       /* THE CHANGE AND CHECK FOR CONFLICTS                @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0386
*       IF VOLRCD=ON&ADDR(RLBL)=NULLPTR THEN                       0386
         TM    VOLRCD,B'00001000'                                  0386
         BNO   @RF00386                                            0386
         L     @07,@PC00001+4                                      0386
         L     @07,FDTPTR+100(,@07)                                0386
         LTR   @07,@07                                             0386
         BNZ   @RF00386                                            0386
*         CALL GRPPROC;             /*                       @ZDR2057*/
         BAL   @14,GRPPROC                                         0387
*                                                                  0388
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FILE PARAMETER IS SPECIFIED, AND           @Y30LB33*/
*       /* THE VOLUME ATTRIBUTES ARE CHANGING OR THE         @Y30LB33*/
*       /* VOLUME LABEL WILL BE CHANGED, CHECK THE UNIT      @Y30LB33*/
*       /* CHARACTERISTICS FOR VIRTUAL AND OBTAIN            @YD00175*/
*       /* THE UNIT FOR EXCLUSIVE CONTROL                    @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0388
*       IF ADDR(FYLE)>NULLPTR&      /*                       @Y30LB33*/
*           (ATTRSW=ON×COPYATTR=ON× /*                       @Y30LB33*/
*           ONLYONLY=ON×RENAMSW=ON×ADDR(RLBL)^=NULLPTR) THEN       0388
@RF00386 SLR   @07,@07                                             0388
         L     @15,@PC00001+4                                      0388
         C     @07,FDTPTR+88(,@15)                                 0388
         BNL   @RF00388                                            0388
         TM    ATTRSW,B'00100010'                                  0388
         BNZ   @RT00388                                            0388
         TM    ONLYONLY,B'10000000'                                0388
         BO    @RT00388                                            0388
         TM    RENAMSW,B'01000000'                                 0388
         BO    @RT00388                                            0388
         C     @07,FDTPTR+100(,@15)                                0388
         BE    @RF00388                                            0388
@RT00388 DS    0H                                                  0389
*         DO;                       /*                       @ZDR2057*/
*                                                                  0389
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD THE CHANGEX ARGUMENT LIST.              @YD00175*/
*           /* IF THE VOLUME LABEL IS NOT BEING CHANGED,     @YD00175*/
*           /* REQUEST THAT THE ALLOCATION BE CHANGED TO     @YD00175*/
*           /* EXCLUSIVE ONLY IF THE VOLUME IS MOUNTED       @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0390
*           EXCLAGL=EXCLAGL&&EXCLAGL;/*                      @YD00175*/
         LA    @07,MVEXAGL                                         0390
         XC    EXCLAGL(23,@07),EXCLAGL(@07)                        0390
*           EXCLUCBP=ADDR(MVUCBPTR);/*                       @YD00175*/
         LA    @15,MVUCBPTR                                        0391
         ST    @15,EXCLUCBP(,@07)                                  0391
*           EXCLDDP=ADDR(FYLEVAL);  /*                       @YD00175*/
         L     @15,@PC00001+4                                      0392
         L     @01,FDTPTR+88(,@15)                                 0392
         LA    @14,FYLEVAL(,@01)                                   0392
         ST    @14,EXCLDDP(,@07)                                   0392
*           EXCLVOL=VOLVAL;         /*                       @ZA05119*/
         L     @01,FDTPTR(,@15)                                    0393
         MVC   EXCLVOL(6,@07),VOLVAL(@01)                          0393
*           IF RENAMSW=OFF THEN                                    0394
         TM    RENAMSW,B'01000000'                                 0394
         BNZ   @RF00394                                            0394
*             EXCLMNT=ON;           /*                       @YD00175*/
*                                                                  0395
         OI    EXCLMNT(@07),B'10000000'                            0395
*           /*********************************************************/
*           /*                                                       */
*           /* DUMP THE EXCLUSIVE ARGUMENT LIST              @ZA09560*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0396
*           IF GDTDBG=NULLPTR THEN                                 0396
@RF00394 L     @07,@PC00001                                        0396
         L     @07,GDTDBG(,@07)                                    0396
         LTR   @07,@07                                             0396
         BZ    @RT00396                                            0396
*             ;                                                    0397
*           ELSE                                                   0398
*             DO;                                                  0398
*               DMPINDEX=ADDR(DUMPAREA);/*                   @ZA09560*/
         LA    DMPINDEX,DUMPAREA                                   0399
*               DMPITMNM='EXCLAGL';                                0400
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0400
         MVC   DMPITMNM(7,DMPINDEX),@CC01648                       0400
*               DMPITMPT=ADDR(EXCLAGL);                            0401
         LA    @07,MVEXAGL                                         0401
         ST    @07,DMPITMPT(,DMPINDEX)                             0401
*               DMPITMLN=LENGTH(EXCLAGL);                          0402
         MVC   DMPITMLN(2,DMPINDEX),@CH01468                       0402
*               DMPITMTP='H';                                      0403
         MVI   DMPITMTP(DMPINDEX),C'H'                             0403
*               DMPINDEX=DMPINDEX+DMPELEMT;/*                @ZA09560*/
         AL    DMPINDEX,@CF00507                                   0404
*               DMPTRM=DMPTRMVL;                                   0405
         MVI   DMPTRM(DMPINDEX),X'FF'                              0405
*             END;                  /*                       @ZA09560*/
*           IF GDTDBG=NULLPTR THEN                                 0407
@RT00396 L     @07,@PC00001                                        0407
         L     @07,GDTDBG(,@07)                                    0407
         LTR   @07,@07                                             0407
         BZ    @RT00407                                            0407
*             ;                                                    0408
*           ELSE                                                   0409
*             CALL IDCDB010(GDTTBL,'MVBB',DUMPADDR);/*       @ZA09560*/
*                                                                  0409
         L     @07,@PC00001                                        0409
         ST    @07,@AL00001                                        0409
         LA    @15,@CC01650                                        0409
         ST    @15,@AL00001+4                                      0409
         LA    @15,DUMPADDR                                        0409
         ST    @15,@AL00001+8                                      0409
         MVI   @AL00001+8,X'80'                                    0409
         L     @15,GDTDBG(,@07)                                    0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE THE CHANGEX REQUEST TO CHANGE THE       @YD00175*/
*           /* ALLOCATION TO EXCLUSIVE                       @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0410
*           CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*         @YD00175*/
@RT00407 L     @07,@PC00001                                        0410
         ST    @07,@AL00001                                        0410
         LA    @02,CHANGEX                                         0410
         ST    @02,@AL00001+4                                      0410
         LA    @02,MVEXAGL                                         0410
         ST    @02,@AL00001+8                                      0410
         MVI   @AL00001+8,X'80'                                    0410
         L     @15,GDTUNT(,@07)                                    0410
         LA    @01,@AL00001                                        0410
         BALR  @14,@15                                             0410
*           RESPECIFY                                              0411
*             RTNREG RSTD;                                         0411
*           TESTRC=RTNREG;                                         0412
         LR    TESTRC,RTNREG                                       0412
*           RESPECIFY                                              0413
*             RTNREG UNRSTD;        /*                       @Y30LB33*/
*                                                                  0413
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE IS NOT ZERO,               @Y30LB33*/
*           /* SET LASTCOND TO 12 TO TERMINATE               @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0414
*           IF TESTRC^=0 THEN                                      0414
         LTR   TESTRC,TESTRC                                       0414
         BZ    @RF00414                                            0414
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/
*                                                                  0415
         L     @07,@PC00001+8                                      0415
         MVC   LASTCOND(2,@07),@CH00038                            0415
*           /*********************************************************/
*           /*                                                       */
*           /* IF WE ARE NOT TERMINATING, CHECK THE          @YD00175*/
*           /* VOLUME TO MAKE SURE IT IS VIRTUAL             @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0416
*           IF LASTCOND<TERMCODE THEN                              0416
@RF00414 L     @07,@PC00001+8                                      0416
         LH    @07,LASTCOND(,@07)                                  0416
         C     @07,@CF00038                                        0416
         BNL   @RF00416                                            0416
*             DO;                   /*                       @YD00175*/
*               CKAGL=CKAGL&&CKAGL; /*                       @YD00175*/
         LA    @07,MVCKAGL                                         0418
         XC    CKAGL(29,@07),CKAGL(@07)                            0418
*               CKDDNAME=FYLEVAL;   /*                       @YD00175*/
         L     @02,@PC00001+4                                      0419
         L     @02,FDTPTR+88(,@02)                                 0419
         MVC   CKDDNAME(8,@07),FYLEVAL(@02)                        0419
*               CKTESTVT=ON;        /*                       @YD00175*/
         OI    CKTESTVT(@07),B'10000000'                           0420
*               CKUCBPTR=ADDR(MVUCBPTR);/*                   @YD00175*/
*                                                                  0421
         LA    @02,MVUCBPTR                                        0421
         ST    @02,CKUCBPTR(,@07)                                  0421
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE THE CHECK UMSSUNIT                  @YD00175*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0422
*               CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*         @YD00175*/
         L     @02,@PC00001                                        0422
         ST    @02,@AL00001                                        0422
         LA    @15,CHECK                                           0422
         ST    @15,@AL00001+4                                      0422
         ST    @07,@AL00001+8                                      0422
         MVI   @AL00001+8,X'80'                                    0422
         L     @15,GDTUNT(,@02)                                    0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*               RESPECIFY                                          0423
*                 RTNREG RSTD;                                     0423
*               TESTRC=RTNREG;                                     0424
         LR    TESTRC,RTNREG                                       0424
*               RESPECIFY                                          0425
*                 RTNREG UNRSTD;    /*                       @YD00175*/
*                                                                  0425
*               /*****************************************************/
*               /*                                                   */
*               /* IF WE HAVE AN ERROR, TERMINATE            @YD00175*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0426
*               IF TESTRC>0 THEN    /*                       @YD00175*/
         LTR   TESTRC,TESTRC                                       0426
         BNP   @RF00426                                            0426
*                 LASTCOND=TERMCODE;/*                       @YD00175*/
         L     @07,@PC00001+8                                      0427
         MVC   LASTCOND(2,@07),@CH00038                            0427
*             END;                  /*                       @YD00175*/
@RF00426 DS    0H                                                  0429
*         END;                      /*                       @Y30LB33*/
@RF00416 DS    0H                                                  0430
*                                                                  0430
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE GROUP RECORD WAS TO BE READ AND            @YD00175*/
*       /* IT WAS NOT, THE FOLLOWING TESTS CAN NOT           @Y30LB33*/
*       /* BE MADE                                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0430
*       IF NEWGENSW=ON&GRPRCD=OFF THEN                             0430
@RF00388 TM    NEWGENSW,B'00000100'                                0430
         BNO   @RF00430                                            0430
         TM    GRPRCD,B'00001000'                                  0430
         BZ    @RT00430                                            0430
*         ;                         /*                       @YD00175*/
*                                                                  0431
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE USER SPECIFIED AN OWNER OR                 @YD00175*/
*       /* VOLUME SERIAL CHANGE                              @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0432
*       ELSE                        /*                       @YD00175*/
*         IF VOLRCD=ON&RENAMSW=ON&  /*                       @Y30LB33*/
*                                                                  0432
*         /***********************************************************/
*         /*                                                         */
*         /* AND THE VOLUME RECORD HAS THE READONLY          @Y30LB33*/
*         /* ATTRIBUTE SET ON                                @Y30LB33*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*             BASRONLY=ON&          /*                       @Y30LB33*/
*                                                                  0432
*         /***********************************************************/
*         /*                                                         */
*         /* AND THE USER DID NOT ASK FOR THE READONLY       @Y30LB33*/
*         /* ATTRIBUTE TO BE TURNED OFF                      @Y30LB33*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*             ADDR(RW)=NULLPTR&     /*                       @Y30LB33*/
*                                                                  0432
*         /***********************************************************/
*         /*                                                         */
*         /* AND THE VOLUME IS NOT BEING PLACED IN A         @Y30LB33*/
*         /* GROUP THAT WILL AUTOMATICALLY TURN OFF THE      @Y30LB33*/
*         /* VOLUME'S READONLY ATTRIBUTE                     @Y30LB33*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*             COPYRW=OFF×           /*                       @ZDR2057*/
*                                                                  0432
*         /***********************************************************/
*         /*                                                         */
*         /* OR THE USER REQUESTED THE VOLUME LABEL TO BE    @ZDR2057*/
*         /* REBUILT FOR A READONLY VOLUME,                  @ZDR2057*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0432
*             (BASRONLY=ON&ADDR(RLBL)^=NULLPTR) THEN               0432
*                                                                  0432
@RF00430 TM    VOLRCD,B'00001000'                                  0432
         BNO   @GL00025                                            0432
         TM    RENAMSW,B'01000000'                                 0432
         BNO   @GL00025                                            0432
         TM    BASRONLY(BASEVPTR),B'01000000'                      0432
         BNO   @GL00025                                            0432
         L     @07,@PC00001+4                                      0432
         L     @07,FDTPTR+44(,@07)                                 0432
         LTR   @07,@07                                             0432
         BNZ   @GL00025                                            0432
         TM    COPYRW,B'00010000'                                  0432
         BZ    @RT00432                                            0432
@GL00025 TM    BASRONLY(BASEVPTR),B'01000000'                      0432
         BNO   @RF00432                                            0432
         L     @07,@PC00001+4                                      0432
         L     @07,FDTPTR+100(,@07)                                0432
         LTR   @07,@07                                             0432
         BZ    @RF00432                                            0432
@RT00432 DS    0H                                                  0433
*           /*********************************************************/
*           /*                                                       */
*           /* THEN PRINT IDC3090I AND SET LASTCOND TO 12    #Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0433
*           DO;                     /*                       #Y30LB33*/
*             DARGLIST=DARGLIST&&DARGLIST;/*                 @Y30LB33*/
         L     @07,DDSTRU                                          0434
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0434
*             DARGSMOD=MODCMN;      /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@07),MODCMN                              0435
*             DARGSENT=MSG3090I;    /*                       @Y30LB33*/
         MVI   DARGSENT(@07),X'10'                                 0436
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      0437
         L     @01,FDTPTR(,@15)                                    0437
         LA    @15,VOLVAL(,@01)                                    0437
         ST    @15,DARGDBP(,@07)                                   0437
*             DARGILP=LENGTH(VOLVAL);/*                      @Y30LB33*/
         MVC   DARGILP(2,@07),@CH00159                             0438
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB33*/
         L     @07,@PC00001                                        0439
         ST    @07,@AL00001                                        0439
         LA    @15,@CF00117                                        0439
         ST    @15,@AL00001+4                                      0439
         LA    @15,DDSTRU                                          0439
         ST    @15,@AL00001+8                                      0439
         MVI   @AL00001+8,X'80'                                    0439
         L     @15,GDTPRT(,@07)                                    0439
         LA    @01,@AL00001                                        0439
         BALR  @14,@15                                             0439
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/
         L     @07,@PC00001+8                                      0440
         MVC   LASTCOND(2,@07),@CH00038                            0440
*           END;                    /*                       @Y30LB33*/
*     END;                          /*                       @ZDR2057*/
*                                                                  0442
@RF00432 DS    0H                                                  0442
@RT00430 DS    0H                                                  0443
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0443
*   REG14=CKOUTSV;                  /*                       @Y30LB33*/
@RF00383 L     REG14,CKOUTSV                                       0443
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0444
@EL00002 DS    0H                                                  0444
@EF00002 DS    0H                                                  0444
@ER00002 BR    @14                                                 0444
*   END CHECKOUT;                   /*                       @Y30LB33*/
*                                                                  0446
*/********************************************************   @ZDR2057*/
*/* PROCEDURE NAME - RBLABEL                                 @ZDR2057*/
*/*                                                          @ZDR2057*/
*/* FUNCTION - THIS PROCEDURE WILL REWRITE A VOLUME          @ZDR2057*/
*/*      LABEL THAT COULD BE UNREADABLE.  IT CALLS           @ZDR2057*/
*/*      MNTVOL TO HAVE THE VOLUME MOUNTED, AND CALLS        @ZDR2057*/
*/*      NEWLABL TO HAVE THE LABEL REWRITTEN.  IF NO         @ZDR2057*/
*/*      ERROR HAS OCCURED, THE THE RESERVE DONE BY          @ZDR2057*/
*/*      VOLUME SERVICES IS DEQUED, THE DCB OPENED BY        @ZDR2057*/
*/*      VOLUME SERVICES IS CLOSED, AND THE VOLUME           @ZDR2057*/
*/*      IS DEMOUNTED.                                       @ZDR2057*/
*/*                                                          @ZDR2057*/
*/* INPUT - FDTTBL                                           @ZDR2057*/
*/*                                                          @ZDR2057*/
*/* OUTPUT - LASTCOND IS SET TO 12 TO INDICATE THAT          @ZDR2057*/
*/*      THE VOLUME LABEL COULD NOT BE WRITTEN AND           @ZDR2057*/
*/*      MESSAGE IDC3691I IS ISSUED.                         @ZDR2057*/
*/********************************************************   @ZDR2057*/
*                                                                  0446
*RBLABEL:                                                          0446
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZDR2057*/
RBLABEL  ST    @14,@SA00003                                        0446
*   OLDERID2=NEWERID2;              /*                       @ZDR2057*/
         L     @05,@PC00001                                        0447
         L     @05,GDTTR2(,@05)                                    0447
         MVC   @TS00001(95),NEWERID2(@05)                          0447
         MVC   OLDERID2(95,@05),@TS00001                           0447
*   NEWID2='MVRL';                  /*                       @ZDR2057*/
*                                                                  0448
         MVC   NEWID2(4,@05),@CC01654                              0448
*   /*****************************************************************/
*   /*                                                               */
*   /* MOUNT THE VOLUME AS AN UNINITIALIZED VOLUME.          @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0449
*   CALL MNTVOL;                    /*                       @ZDR2057*/
*                                                                  0449
         BAL   @14,MNTVOL                                          0449
*   /*****************************************************************/
*   /*                                                               */
*   /* REWRITE THE VOLUME LABEL.                             @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   CALL NEWLABL;                   /*                       @ZDR2057*/
         BAL   @14,NEWLABL                                         0450
*   IF LASTCOND^=TERMCODE THEN                                     0451
         L     @15,@PC00001+8                                      0451
         CLC   LASTCOND(2,@15),@CH00038                            0451
         BE    @RF00451                                            0451
*     DO;                           /*                       @ZDR2057*/
*                                                                  0452
*       /*************************************************************/
*       /*                                                           */
*       /* DEQUE THE RESERVE DONE BY VOLUME SERVICES IN NEWLABL      */
*       /*                                                   @ZDR2057*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0453
*       MINAMVOL=MVVOLUME;          /*                       @ZDR2057*/
         MVC   MINAMVOL(6),MVVOLUME                                0453
*       MINAMQL=MINQLR;             /*                       @ZDR2057*/
*                                                                  0454
         MVC   MINAMQL(16),@CC01589                                0454
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEQUEUE ON THE RESERVE                  @ZDR2057*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0455
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @ZDR2057*/
*                                                                  0455
         L     @15,@PC00001                                        0455
         ST    @15,@AL00001                                        0455
         LA    @14,MVMAJNAM                                        0455
         ST    @14,@AL00001+4                                      0455
         LA    @14,MVMINNAM                                        0455
         ST    @14,@AL00001+8                                      0455
         MVI   @AL00001+8,X'80'                                    0455
         L     @15,GDTDEQ(,@15)                                    0455
         LA    @01,@AL00001                                        0455
         BALR  @14,@15                                             0455
*       /*************************************************************/
*       /*                                                           */
*       /* CLOSE THE DCB                                     @ZDR2057*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0456
*       CALL IDCIO050(GDTTBL,CLOSE,IOCTLBKP);/*              @ZDR2057*/
*                                                                  0456
         L     @15,@PC00001                                        0456
         ST    @15,@AL00001                                        0456
         LA    @14,CLOSE                                           0456
         ST    @14,@AL00001+4                                      0456
         LA    @14,IOCTLBKP                                        0456
         ST    @14,@AL00001+8                                      0456
         MVI   @AL00001+8,X'80'                                    0456
         L     @15,GDTEXP(,@15)                                    0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP THE DEMOUNT LIST                           @ZDR2057*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0457
*       MDAGL=MDAGL&&MDAGL;         /*                       @ZDR2057*/
         LA    @15,MVMDAGL                                         0457
         XC    MDAGL(37,@15),MDAGL(@15)                            0457
*       MDDDNAME=MVDDNAME;          /*                       @ZDR2057*/
         MVC   MDDDNAME(8,@15),MVDDNAME                            0458
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @ZDR2057*/
         LA    @14,MVUCBPTR                                        0459
         ST    @14,MDUCBPTR(,@15)                                  0459
*       MDLABEL=MVVOLUME;           /*                       @ZDR2057*/
         MVC   MDLABEL(6,@15),MVVOLUME                             0460
*       MDWAIT=ON;                  /*                       @ZDR2057*/
*                                                                  0461
         OI    MDWAIT(@15),B'00010000'                             0461
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEMOUNT                                 @ZDR2057*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0462
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @ZDR2057*/
         L     @14,@PC00001                                        0462
         ST    @14,@AL00001                                        0462
         LA    @07,DEMOUNT                                         0462
         ST    @07,@AL00001+4                                      0462
         ST    @15,@AL00001+8                                      0462
         MVI   @AL00001+8,X'80'                                    0462
         L     @15,GDTUNT(,@14)                                    0462
         LA    @01,@AL00001                                        0462
         BALR  @14,@15                                             0462
*     END;                          /*                       @ZDR2057*/
*   ELSE                                                           0464
*                                                                  0464
*     /***************************************************************/
*     /*                                                             */
*     /* PRINT MESSAGE IDC3691I VOLUME XXXXXX LABEL          @ZDR2057*/
*     /* NOT REBUILT                                         @ZDR2057*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0464
*     DO;                           /*                       @ZDR2057*/
         B     @RC00451                                            0464
@RF00451 DS    0H                                                  0465
*       MVDRGLST=''B;               /*                       @ZDR2057*/
         XC    MVDRGLST(36),MVDRGLST                               0465
*       DARGSMOD=MODMV0;            /*                       @ZDR2057*/
         L     @15,DDSTRU                                          0466
         MVC   DARGSMOD(3,@15),MODMV0                              0466
*       DARGSENT=MSG3691I;          /*                       @ZDR2057*/
         MVI   DARGSENT(@15),X'02'                                 0467
*       DARGCNT=1;                  /*                       @ZDR2057*/
         LA    @14,1                                               0468
         STH   @14,DARGCNT(,@15)                                   0468
*       DARGINS(1)=1;               /*                       @ZDR2057*/
         STH   @14,DARGINS(,@15)                                   0469
*       DARGINL(1)=6;               /*                       @ZDR2057*/
         MVC   DARGINL(2,@15),@CH00159                             0470
*       DARGDTM(1)=ADDR(MVVOLUME);  /*                       @ZDR2057*/
         LA    @14,MVVOLUME                                        0471
         ST    @14,DARGDTM(,@15)                                   0471
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @ZDR2057*/
         L     @15,@PC00001                                        0472
         ST    @15,@AL00001                                        0472
         LA    @14,@CF00117                                        0472
         ST    @14,@AL00001+4                                      0472
         LA    @14,DDSTRU                                          0472
         ST    @14,@AL00001+8                                      0472
         MVI   @AL00001+8,X'80'                                    0472
         L     @15,GDTPRT(,@15)                                    0472
         LA    @01,@AL00001                                        0472
         BALR  @14,@15                                             0472
*     END;                          /*                       @ZDR2057*/
*   RETURN CODE(0);                 /*                       @ZDR2057*/
@RC00451 SLR   @15,@15                                             0474
@EL00003 DS    0H                                                  0474
@EF00003 DS    0H                                                  0474
@ER00003 L     @14,@SA00003                                        0474
         BR    @14                                                 0474
*   END RBLABEL;                    /*                       @ZDR2057*/
*                                                                  0476
*/********************************************************   #Y30LB33*/
*/* PROCEDURE NAME - VOLCK                                   #Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - READS IN THE VOLUME INVENTORY RECORD THAT     @Y30LB33*/
*/*      IS TO BE CHANGED AND CALLS BVOLCK                   @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF THE VOLUME RECORD IS NOT READ, THIS ROUTINE      @Y30LB33*/
*/*      ISSUES MESSAGE IDC2080I TO INDICATE THE ERROR       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL CONTAINING THE VOLUME SERIAL          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - THE FOLLOWING BITS IN SWCHBITS ARE SET          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*            VOLRCD                                        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      LASTCOND IS SET TO 12 IF THE VOLUME INVENTORY       @Y30LB33*/
*/*      RECORD IS NOT READ                                  @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0476
*VOLCK:                                                            0476
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0476
VOLCK    DS    0H                                                  0477
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTER 14 SAVE AREA                                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0477
*   DCL                                                            0477
*     VOLCKSV PTR(31);              /*                       @Y30LB33*/
*   VOLCKSV=REG14;                  /* SAVE RETURN ADDRESS   @Y30LB33*/
         LR    VOLCKSV,REG14                                       0478
*   OLDERID2=NEWERID2;                                             0479
         L     @15,@PC00001                                        0479
         L     @14,GDTTR2(,@15)                                    0479
         MVC   @TS00001(95),NEWERID2(@14)                          0479
         MVC   OLDERID2(95,@14),@TS00001                           0479
*   NEWID2='MVDA';                  /*                       @Y30LB33*/
*                                                                  0480
         MVC   NEWID2(4,@14),@CC01662                              0480
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE READ ARGUMENT LIST                          @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*   RVVI=RVVI&&RVVI;                /*                       @Y30LB33*/
         L     @14,RVVIPTR                                         0481
         XC    RVVI(68,@14),RVVI(@14)                              0481
*   RVVOLUME=VOLVAL;                /*                       @Y30LB33*/
         L     @03,@PC00001+4                                      0482
         L     @01,FDTPTR(,@03)                                    0482
         MVC   RVVOLUME(6,@14),VOLVAL(@01)                         0482
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB33*/
         LH    @03,RVVLEN                                          0483
         ST    @03,RVVLNGTH(,@14)                                  0483
*   RVVCODE=RVVOP;                  /*                       @Y30LB33*/
         MVI   RVVCODE(@14),X'87'                                  0484
*   RVVRTBUF=ADDR(VOLRCDBF);        /*                       @Y30LB33*/
         LA    @03,VOLRCDBF                                        0485
         ST    @03,RVVRTBUF(,@14)                                  0485
*   RVVRDR=ON;                      /*                       @Y30LB33*/
         OI    RVVRDR(@14),B'10000000'                             0486
*   RVVBVRCD=ON;                    /*                       @Y30LB33*/
         OI    RVVBVRCD(@14),B'10000000'                           0487
*   RVVSVOL=ON;                     /*                       @Y30LB33*/
         OI    RVVSVOL(@14),B'00000001'                            0488
*   RVVBUFLN=LENGTH(VOLRCDBF);      /*                       @Y30LB33*/
*                                                                  0489
         MVC   RVVBUFLN(2,@14),@CH01832                            0489
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP THE READ ARGUMENT LIST                           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0490
*   IF GDTDBG=NULLPTR THEN                                         0490
         L     @15,GDTDBG(,@15)                                    0490
         LTR   @15,@15                                             0490
         BZ    @RT00490                                            0490
*     ;                                                            0491
*   ELSE                                                           0492
*     DO;                                                          0492
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   0493
*       DMPITMNM='RVVI';                                           0494
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0494
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0494
         MVC   DMPITMNM(4,DMPINDEX),@CC01663                       0494
*       DMPITMPT=ADDR(RVVI);                                       0495
         L     @03,RVVIPTR                                         0495
         ST    @03,DMPITMPT(,DMPINDEX)                             0495
*       DMPITMLN=LENGTH(RVVI);                                     0496
         MVC   DMPITMLN(2,DMPINDEX),@CH01833                       0496
*       DMPITMTP='H';                                              0497
         MVI   DMPITMTP(DMPINDEX),C'H'                             0497
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/
         AL    DMPINDEX,@CF00507                                   0498
*       DMPTRM=DMPTRMVL;                                           0499
         MVI   DMPTRM(DMPINDEX),X'FF'                              0499
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         0501
@RT00490 L     @15,@PC00001                                        0501
         L     @15,GDTDBG(,@15)                                    0501
         LTR   @15,@15                                             0501
         BZ    @RT00501                                            0501
*     ;                                                            0502
*   ELSE                                                           0503
*     CALL IDCDB010(GDTTBL,'MVDB',DUMPADDR);/*               @Y30LB33*/
         L     @15,@PC00001                                        0503
         ST    @15,@AL00001                                        0503
         LA    @14,@CC01664                                        0503
         ST    @14,@AL00001+4                                      0503
         LA    @14,DUMPADDR                                        0503
         ST    @14,@AL00001+8                                      0503
         MVI   @AL00001+8,X'80'                                    0503
         L     @15,GDTDBG(,@15)                                    0503
         LA    @01,@AL00001                                        0503
         BALR  @14,@15                                             0503
*                                                                  0504
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO READ THE VOLUME RECORD                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,RCAREA);/*             @Y30LB33*/
@RT00501 L     @02,@PC00001                                        0504
         ST    @02,@AL00001                                        0504
         LA    @15,VVIC                                            0504
         ST    @15,@AL00001+4                                      0504
         LA    @15,RVVIPTR                                         0504
         ST    @15,@AL00001+8                                      0504
         LA    @15,RCAREA                                          0504
         ST    @15,@AL00001+12                                     0504
         MVI   @AL00001+12,X'80'                                   0504
         L     @15,GDTSSC(,@02)                                    0504
         LA    @01,@AL00001                                        0504
         BALR  @14,@15                                             0504
*   RESPECIFY                                                      0505
*     RTNREG RSTD;                                                 0505
*   TESTRC=RTNREG;                                                 0506
         LR    TESTRC,RTNREG                                       0506
*   RESPECIFY                                                      0507
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*                                                                  0507
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS 4, CALL SSCMSG TO PRINT         @Y30LB33*/
*   /* THE REASON FOR THE ERROR. ALSO, PRINT IDC2080I        @Y30LB33*/
*   /* AND SET THE LASTCOND TO 12 TO INDICATE A              @Y30LB33*/
*   /* TERMINATING ERROR                                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   IF TESTRC=4 THEN                                               0508
         C     TESTRC,@CF00043                                     0508
         BNE   @RF00508                                            0508
*     DO;                           /*                       @Y30LB33*/
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/
         LA    @15,RCAREA                                          0510
         ST    @15,@AL00001                                        0510
         LA    @01,@AL00001                                        0510
         BAL   @14,SSCMSG                                          0510
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @15,DDSTRU                                          0511
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0511
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0512
*       DARGSENT=MSG2080I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'1A'                                 0513
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00159                             0514
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @14,@PC00001+4                                      0515
         L     @01,FDTPTR(,@14)                                    0515
         LA    @14,VOLVAL(,@01)                                    0515
         ST    @14,DARGDBP(,@15)                                   0515
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @15,@PC00001                                        0516
         ST    @15,@AL00001                                        0516
         LA    @14,@CF00117                                        0516
         ST    @14,@AL00001+4                                      0516
         LA    @14,DDSTRU                                          0516
         ST    @14,@AL00001+8                                      0516
         MVI   @AL00001+8,X'80'                                    0516
         L     @15,GDTPRT(,@15)                                    0516
         LA    @01,@AL00001                                        0516
         BALR  @14,@15                                             0516
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @15,@PC00001+8                                      0517
         MVC   LASTCOND(2,@15),@CH00038                            0517
*     END;                          /*                       @Y30LB33*/
*                                                                  0519
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE HAD NO ERRORS READING,                          @Y30LB33*/
*   /* TURN ON THE SWITCH TO INDICATE THAT THE               @Y30LB33*/
*   /* VOLUME RECORD WAS READ                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0519
*   ELSE                                                           0519
*     DO;                           /*                       @Y30LB33*/
         B     @RC00508                                            0519
@RF00508 DS    0H                                                  0520
*       VOLRCD=ON;                  /*                       @Y30LB33*/
*                                                                  0520
         OI    VOLRCD,B'00001000'                                  0520
*       /*************************************************************/
*       /*                                                           */
*       /* SINCE THE RECORD WAS READ, CALL BVOLCK TO CHECK   @Y30LB33*/
*       /* OUT THE BASE VOLUME AGAINST THE REQUESTED         @Y30LB33*/
*       /* CHANGES                                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0521
*       CALL BVOLCK;                /*                       @Y30LB33*/
         BAL   @14,BVOLCK                                          0521
*     END;                          /*                       @Y30LB33*/
*                                                                  0522
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0523
*   REG14=VOLCKSV;                  /*                       @Y30LB33*/
@RC00508 LR    REG14,VOLCKSV                                       0523
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0524
@EL00004 DS    0H                                                  0524
@EF00004 DS    0H                                                  0524
@ER00004 BR    @14                                                 0524
*   END VOLCK;                      /*                       @Y30LB33*/
*                                                                  0526
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - BVOLCK                                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO CHECK THE VOLUME RECORD AGAINST            @Y30LB33*/
*/*      THE REQUESTED CHANGES TO MAKE SURE THAT             @Y30LB33*/
*/*      THE CHANGES CAN BE MADE                             @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3074I IS ISSUED IF THE VOLUME IS         @Y30LB33*/
*/*      INACTIVE                                            @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3097I IS ISSUED IF THE VOLUME WAS        @Y30LB33*/
*/*      INCOMPLETELY CREATED                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3096I IS ISSUED IF THE VOLUME WAS        @Y30LB33*/
*/*      INCOMPLETELY COPIED                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3095I IS ISSUED IF THE VOLUME HAS        @Y30LB33*/
*/*      A LABEL MISMATCH AND THE USER HAS NOT SPECIFIED     @Y30LB33*/
*/*      A NEWSERIAL PARAMETER                               @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3092I IS ISSUED IF THE VOLUME HAS        @Y30LB33*/
*/*      A LABEL MISMATCH AND THE FILE PARAMETER WAS         @Y30LB33*/
*/*      NOT PROVIDED BY THE USER                            @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3861I IS ISSUED IF THE USER SPECIFIED    @Y30LB33*/
*/*      GROUP CHARACTERISTICS FOR A NON-GROUPED VOLUME      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE INPUT PARAMETERS IN THE FDTTBL AND THE       @Y30LB33*/
*/*      VOLUME RECORD                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND OF 12 TO TERMINATE PROCESSING IF ANY   @Y30LB33*/
*/*      ERRORS CITED IN THE ABOVE FUNCTION DESCRIPTION      @Y30LB33*/
*/*      ARE ENCOUNTERED                                     @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0526
*BVOLCK:                                                           0526
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0526
BVOLCK   DS    0H                                                  0527
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0527
*   DCL                                                            0527
*     BVOLSV PTR(31);               /*                       @Y30LB33*/
*   BVOLSV=REG14;                   /*                       @Y30LB33*/
         LR    BVOLSV,REG14                                        0528
*   OLDERID2=NEWERID2;                                             0529
         L     @02,@PC00001                                        0529
         L     @15,GDTTR2(,@02)                                    0529
         MVC   @TS00001(95),NEWERID2(@15)                          0529
         MVC   OLDERID2(95,@15),@TS00001                           0529
*   NEWID2='MVEA';                  /*                       @Y30LB33*/
*                                                                  0530
         MVC   NEWID2(4,@15),@CC01671                              0530
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME IS INACTIVE, PRINT IDC3074I             @Y30LB33*/
*   /* AND SET LASTCOND TO 12                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0531
*   IF BASINAC=ON THEN                                             0531
         TM    BASINAC(BASEVPTR),B'00000100'                       0531
         BNO   @RF00531                                            0531
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @15,DDSTRU                                          0533
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0533
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0534
*       DARGSENT=MSG3074I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'20'                                 0535
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00159                             0536
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @14,@PC00001+4                                      0537
         L     @01,FDTPTR(,@14)                                    0537
         LA    @14,VOLVAL(,@01)                                    0537
         ST    @14,DARGDBP(,@15)                                   0537
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         ST    @02,@AL00001                                        0538
         LA    @15,@CF00117                                        0538
         ST    @15,@AL00001+4                                      0538
         LA    @15,DDSTRU                                          0538
         ST    @15,@AL00001+8                                      0538
         MVI   @AL00001+8,X'80'                                    0538
         L     @15,GDTPRT(,@02)                                    0538
         LA    @01,@AL00001                                        0538
         BALR  @14,@15                                             0538
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0539
         MVC   LASTCOND(2,@02),@CH00038                            0539
*     END;                          /*                       @Y30LB33*/
*                                                                  0540
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME WAS INCOMPLETELY CREATED,               @Y30LB33*/
*   /* PRINT IDC2097I AND SET LASTCOND TO 12                 @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*   IF BASIVCRE=ON THEN                                            0541
@RF00531 TM    BASIVCRE(BASEVPTR),B'10000000'                      0541
         BNO   @RF00541                                            0541
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @02,DDSTRU                                          0543
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0543
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@02),MODCMN                              0544
*       DARGSENT=MSG2097I;          /*                       @YD00175*/
         MVI   DARGSENT(@02),X'03'                                 0545
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@02),@CH00159                             0546
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      0547
         L     @01,FDTPTR(,@15)                                    0547
         LA    @15,VOLVAL(,@01)                                    0547
         ST    @15,DARGDBP(,@02)                                   0547
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @02,@PC00001                                        0548
         ST    @02,@AL00001                                        0548
         LA    @15,@CF00117                                        0548
         ST    @15,@AL00001+4                                      0548
         LA    @15,DDSTRU                                          0548
         ST    @15,@AL00001+8                                      0548
         MVI   @AL00001+8,X'80'                                    0548
         L     @15,GDTPRT(,@02)                                    0548
         LA    @01,@AL00001                                        0548
         BALR  @14,@15                                             0548
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0549
         MVC   LASTCOND(2,@02),@CH00038                            0549
*     END;                          /*                       @Y30LB33*/
*                                                                  0550
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME WAS INCOMPLETELY COPIED, PRINT          @Y30LB33*/
*   /* IDC2096I AND SET LASTCOND TO 12                       @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0551
*   IF BASIVCPY=ON THEN                                            0551
@RF00541 TM    BASIVCPY(BASEVPTR),B'01000000'                      0551
         BNO   @RF00551                                            0551
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @02,DDSTRU                                          0553
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0553
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@02),MODCMN                              0554
*       DARGSENT=MSG2096I;          /*                       @YD00175*/
         MVI   DARGSENT(@02),X'06'                                 0555
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@02),@CH00159                             0556
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      0557
         L     @01,FDTPTR(,@15)                                    0557
         LA    @15,VOLVAL(,@01)                                    0557
         ST    @15,DARGDBP(,@02)                                   0557
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @02,@PC00001                                        0558
         ST    @02,@AL00001                                        0558
         LA    @15,@CF00117                                        0558
         ST    @15,@AL00001+4                                      0558
         LA    @15,DDSTRU                                          0558
         ST    @15,@AL00001+8                                      0558
         MVI   @AL00001+8,X'80'                                    0558
         L     @15,GDTPRT(,@02)                                    0558
         LA    @01,@AL00001                                        0558
         BALR  @14,@15                                             0558
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0559
         MVC   LASTCOND(2,@02),@CH00038                            0559
*     END;                          /*                       @Y30LB33*/
*                                                                  0560
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LABEL MISMATCH FLAG IS ON AND A NEW            @Y30LB33*/
*   /* SERIAL IS NOT SPECIFIED BY THE USER,                  @Y30LB33*/
*   /* PRINT IDC2095I AND SET LASTCOND TO 12                 @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*   IF BASVSMIS=ON&                 /*                       @Y30LB33*/
*       ADDR(NEWSR)=NULLPTR THEN                                   0561
@RF00551 TM    BASVSMIS(BASEVPTR),B'00100000'                      0561
         BNO   @RF00561                                            0561
         L     @02,@PC00001+4                                      0561
         L     @15,FDTPTR+4(,@02)                                  0561
         LTR   @15,@15                                             0561
         BNZ   @RF00561                                            0561
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @15,DDSTRU                                          0563
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0563
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0564
*       DARGSENT=MSG2095I;          /*                       @YD00175*/
         MVI   DARGSENT(@15),X'09'                                 0565
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00159                             0566
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @02,FDTPTR(,@02)                                    0567
         LA    @02,VOLVAL(,@02)                                    0567
         ST    @02,DARGDBP(,@15)                                   0567
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @02,@PC00001                                        0568
         ST    @02,@AL00001                                        0568
         LA    @15,@CF00117                                        0568
         ST    @15,@AL00001+4                                      0568
         LA    @15,DDSTRU                                          0568
         ST    @15,@AL00001+8                                      0568
         MVI   @AL00001+8,X'80'                                    0568
         L     @15,GDTPRT(,@02)                                    0568
         LA    @01,@AL00001                                        0568
         BALR  @14,@15                                             0568
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0569
         MVC   LASTCOND(2,@02),@CH00038                            0569
*     END;                          /*                       @Y30LB33*/
*                                                                  0570
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LABEL MISMATCH FLAG IS ON BUT NO FILE          @Y30LB33*/
*   /* PARAMETER IS SPECIFIED, PRINT IDC3092I AND SET        @Y30LB33*/
*   /* LASTCOND TO 12                                        @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0571
*   IF BASVSMIS=ON&                 /*                       @Y30LB33*/
*       ADDR(FYLE)=NULLPTR THEN                                    0571
@RF00561 TM    BASVSMIS(BASEVPTR),B'00100000'                      0571
         BNO   @RF00571                                            0571
         L     @02,@PC00001+4                                      0571
         L     @15,FDTPTR+88(,@02)                                 0571
         LTR   @15,@15                                             0571
         BNZ   @RF00571                                            0571
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @15,DDSTRU                                          0573
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0573
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0574
*       DARGSENT=MSG3092I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'0E'                                 0575
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB33*/
         L     @02,FDTPTR(,@02)                                    0576
         LA    @02,VOLVAL(,@02)                                    0576
         ST    @02,DARGDBP(,@15)                                   0576
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00159                             0577
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @02,@PC00001                                        0578
         ST    @02,@AL00001                                        0578
         LA    @15,@CF00117                                        0578
         ST    @15,@AL00001+4                                      0578
         LA    @15,DDSTRU                                          0578
         ST    @15,@AL00001+8                                      0578
         MVI   @AL00001+8,X'80'                                    0578
         L     @15,GDTPRT(,@02)                                    0578
         LA    @01,@AL00001                                        0578
         BALR  @14,@15                                             0578
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0579
         MVC   LASTCOND(2,@02),@CH00038                            0579
*     END;                          /*                       @Y30LB33*/
*                                                                  0580
*   /*****************************************************************/
*   /*                                                               */
*   /* IF GROUP ATTRIBUTES ARE SPECIFIED FOR A               @Y30LB33*/
*   /* NON-GROUPED VOLUME, PRINT IDC3860I                    @Y30LB33*/
*   /* AND SET LASTCOND TO 12                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   IF(ADDR(NGRP)>NULLPTR×          /*                       @Y30LB33*/
*       (BASGRPV=OFF&ADDR(GRP)=NULLPTR))/*                   @Y30LB33*/
*       &(ADDR(FORE)>0×ADDR(TO)>0×  /*                       @Y30LB33*/
*       ADDR(GNRL)>0×ADDR(RSTR)>0) THEN                            0581
@RF00571 SLR   @02,@02                                             0581
         L     @15,@PC00001+4                                      0581
         C     @02,FDTPTR+76(,@15)                                 0581
         BL    @GL00033                                            0581
         TM    BASGRPV(BASEVPTR),B'00100000'                       0581
         BNZ   @RF00581                                            0581
         C     @02,FDTPTR+12(,@15)                                 0581
         BNE   @RF00581                                            0581
@GL00033 SLR   @02,@02                                             0581
         L     @15,@PC00001+4                                      0581
         C     @02,FDTPTR+96(,@15)                                 0581
         BL    @RT00581                                            0581
         C     @02,FDTPTR+60(,@15)                                 0581
         BL    @RT00581                                            0581
         C     @02,FDTPTR+16(,@15)                                 0581
         BL    @RT00581                                            0581
         C     @02,FDTPTR+20(,@15)                                 0581
         BNL   @RF00581                                            0581
@RT00581 DS    0H                                                  0582
*     DO;                           /*                       @Y30LB33*/
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @02,DDSTRU                                          0583
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0583
*       DARGSMOD=MODMV0;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@02),MODMV0                              0584
*       DARGSENT=MSG3860I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@02),X'01'                                 0585
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @02,@PC00001                                        0586
         ST    @02,@AL00001                                        0586
         LA    @15,@CF00117                                        0586
         ST    @15,@AL00001+4                                      0586
         LA    @15,DDSTRU                                          0586
         ST    @15,@AL00001+8                                      0586
         MVI   @AL00001+8,X'80'                                    0586
         L     @15,GDTPRT(,@02)                                    0586
         LA    @01,@AL00001                                        0586
         BALR  @14,@15                                             0586
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0587
         MVC   LASTCOND(2,@02),@CH00038                            0587
*     END;                          /*                       @Y30LB33*/
*                                                                  0588
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0589
*   REG14=BVOLSV;                   /*                       @Y30LB33*/
@RF00581 LR    REG14,BVOLSV                                        0589
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0590
@EL00005 DS    0H                                                  0590
@EF00005 DS    0H                                                  0590
@ER00005 BR    @14                                                 0590
*   END BVOLCK;                     /*                       @Y30LB33*/
*                                                                  0592
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - GRPPROC                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO DETERMINE, FROM THE VOLUME INVENTORY       @Y30LB33*/
*/*      RECORD AND THE USER'S PARAMETERS, IF THE VOLUME     @Y30LB33*/
*/*      IS GOING TO BE A GROUPED-GENERAL VOLUME AFTER       @Y30LB33*/
*/*      MODIFICATION AND IF THE GROUP'S ATTRIBUTES WILL     @Y30LB33*/
*/*      HAVE TO BE IMPOSED ON THE VOLUME                    @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE SWCHBITS SET IN THIS ROUTINE ARE                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*            NEWGENSW                                      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF THE VOLUME'S GROUP MUST BE INSPECTED FOR         @Y30LB33*/
*/*      ATTRIBUTE CHANGES, THE GRPCHK ROUTINE IS            @Y30LB33*/
*/*      CALLED                                              @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE USER'S PARAMETERS IN THE FDTTBL AND THE      @Y30LB33*/
*/*      VOLUME RECORD                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - THE NEWGENSW IS SET IF THE VOLUME IS BECOMING   @Y30LB33*/
*/*      GENERAL, OR IF THE VOLUME'S ATTRIBUTES ARE CHANGING @Y30LB33*/
*/*      TO AGREE WITH THE GROUP                             @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0592
*GRPPROC:                                                          0592
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0592
GRPPROC  DS    0H                                                  0593
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0593
*   DCL                                                            0593
*     GRPROCSV PTR(31);             /*                       @Y30LB33*/
*   GRPROCSV=REG14;                 /*                       @Y30LB33*/
         ST    REG14,GRPROCSV                                      0594
*   OLDERID2=NEWERID2;                                             0595
         L     @07,@PC00001                                        0595
         L     @07,GDTTR2(,@07)                                    0595
         MVC   @TS00001(95),NEWERID2(@07)                          0595
         MVC   OLDERID2(95,@07),@TS00001                           0595
*   NEWID2='MVGB';                  /*                       @ZA09560*/
*                                                                  0596
         MVC   NEWID2(4,@07),@CC01676                              0596
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN ON THE NEW-GENERAL SWITCH IF THE VOLUME          @Y30LB33*/
*   /* WILL BECOME A GENERAL VOLUME IN A NEW GROUP           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*   IF                              /*                       @Y30LB33*/
*       (ADDR(GRP)>0&BASGENUS=ON&   /*                       @Y30LB33*/
*       ADDR(RSTR)=0)×              /*                       @Y30LB33*/
*                                                                  0597
*   /*****************************************************************/
*   /*                                                               */
*   /* IF IT IS GROUPED AND RESTRICTED                       @Y30LB33*/
*   /* NOW BUT WILL BE GENERAL                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*       (BASRSTD=ON&ADDR(GNRL)>0)×  /*                       @Y30LB33*/
*                                                                  0597
*   /*****************************************************************/
*   /*                                                               */
*   /* OR, IF IT IS NOT GROUPED NOW AND                      @Y30LB33*/
*   /* WILL BECOME GROUPED AND GENERAL                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*       (BASGRPV=OFF&ADDR(GRP)>0&   /*                       @Y30LB33*/
*       ADDR(GNRL)>0)×              /*                       @Y30LB33*/
*                                                                  0597
*   /*****************************************************************/
*   /*                                                               */
*   /* OR, IF IT IS NOT GROUPED NOW AND                      @Y30LB33*/
*   /* IT WILL BECOME GROUPED BUT RESTRICTED                 @Y30LB33*/
*   /* IS NOT SPECIFIED                                      @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*       (BASGRPV=OFF&ADDR(RSTR)=0&  /*                       @Y30LB33*/
*       ADDR(GRP)>0)                /*                       @G24LB23*/
*     THEN                                                         0597
         SLR   @07,@07                                             0597
         L     @15,@PC00001+4                                      0597
         C     @07,FDTPTR+12(,@15)                                 0597
         BNL   @GL00041                                            0597
         TM    BASGENUS(BASEVPTR),B'00010000'                      0597
         BNO   @GL00041                                            0597
         C     @07,FDTPTR+20(,@15)                                 0597
         BE    @RT00597                                            0597
@GL00041 TM    BASRSTD(BASEVPTR),B'00001000'                       0597
         BNO   @GL00040                                            0597
         L     @07,@PC00001+4                                      0597
         L     @07,FDTPTR+16(,@07)                                 0597
         LTR   @07,@07                                             0597
         BP    @RT00597                                            0597
@GL00040 TM    BASGRPV(BASEVPTR),B'00100000'                       0597
         BNZ   @GL00039                                            0597
         SLR   @07,@07                                             0597
         L     @15,@PC00001+4                                      0597
         C     @07,FDTPTR+12(,@15)                                 0597
         BNL   @GL00039                                            0597
         C     @07,FDTPTR+16(,@15)                                 0597
         BL    @RT00597                                            0597
@GL00039 TM    BASGRPV(BASEVPTR),B'00100000'                       0597
         BNZ   @RF00597                                            0597
         SLR   @07,@07                                             0597
         L     @15,@PC00001+4                                      0597
         C     @07,FDTPTR+20(,@15)                                 0597
         BNE   @RF00597                                            0597
         C     @07,FDTPTR+12(,@15)                                 0597
         BNL   @RF00597                                            0597
@RT00597 DS    0H                                                  0598
*     DO;                           /*                       @G24LB23*/
*       NEWGENSW=ON;                /*                       @G24LB23*/
*                                                                  0599
         OI    NEWGENSW,B'00000100'                                0599
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE ROUTINE THAT CHECKS FOR A DOWN LEVEL     @G24LB23*/
*       /* SPACE PROBLEM WITH A GROUPED GENERAL-USE          @G24LB23*/
*       /* VOLUME                                            @G24LB23*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0600
*       CALL DLSPCHK;               /*                       @G24LB23*/
         BAL   @14,DLSPCHK                                         0600
*     END;                          /*                       @G24LB23*/
*                                                                  0601
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN ON THE NEW GENERAL SWITCH IF THE VOLUME          @G24LB23*/
*   /* IS NOW GROUP-GENERAL AND THE                          @G24LB23*/
*   /* ONLY CHANGE IS THAT NEW ATTRIBUTES                    #Y30LB33*/
*   /* WILL BE ASSIGNED                                      #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   ELSE                                                           0602
*     IF(BASGENUS=ON&               /*                       @G24LB23*/
*         ADDR(GRP)=0&ADDR(NGRP)=0& /*                       #Y30LB33*/
*         ADDR(RSTR)=0&ATTRSW=ON)   /*                       #Y30LB33*/
*       THEN                                                       0602
         B     @RC00597                                            0602
@RF00597 TM    BASGENUS(BASEVPTR),B'00010000'                      0602
         BNO   @RF00602                                            0602
         SLR   @07,@07                                             0602
         L     @15,@PC00001+4                                      0602
         C     @07,FDTPTR+12(,@15)                                 0602
         BNE   @RF00602                                            0602
         C     @07,FDTPTR+76(,@15)                                 0602
         BNE   @RF00602                                            0602
         C     @07,FDTPTR+20(,@15)                                 0602
         BNE   @RF00602                                            0602
         TM    ATTRSW,B'00100000'                                  0602
         BNO   @RF00602                                            0602
*       NEWGENSW=ON;                /*                       @G24LB23*/
         OI    NEWGENSW,B'00000100'                                0603
*   IF NEWGENSW=ON&LASTCOND^=TERMCODE THEN                         0604
*                                                                  0604
@RF00602 DS    0H                                                  0604
@RC00597 TM    NEWGENSW,B'00000100'                                0604
         BNO   @RF00604                                            0604
         L     @07,@PC00001+8                                      0604
         CLC   LASTCOND(2,@07),@CH00038                            0604
         BE    @RF00604                                            0604
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE NEW GENERAL SWITCH IS ON                     @G24LB23*/
*     /* THEN CALL THE ROUTINE THAT CHECKS THE               #Y30LB33*/
*     /* GROUP RECORD AGAINST THE PROPOSED                   #Y30LB33*/
*     /* VOLUME ATTRIBUTES                                   #Y30LB33*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0605
*     CALL GRPCHK;                  /*                       #Y30LB33*/
*                                                                  0605
         BAL   @14,GRPCHK                                          0605
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*   REG14=GRPROCSV;                 /*                       #Y30LB33*/
@RF00604 L     REG14,GRPROCSV                                      0606
*   RETURN CODE(0);                 /*                       #Y30LB33*/
         SLR   @15,@15                                             0607
@EL00006 DS    0H                                                  0607
@EF00006 DS    0H                                                  0607
@ER00006 BR    @14                                                 0607
*   END GRPPROC;                    /*                       #Y30LB33*/
*                                                                  0609
*/********************************************************** @G24LB23*/
*/* PROCEDURE NAME - DLSPCHK                                 @G24LB23*/
*/*                                                          @G24LB23*/
*/* FUNCTION - FOR A VOLUME THAT IS TO BE GENERAL-USE IN     @G24LB23*/
*/*            A GROUP OTHER THAN SYSGROUP, TO MAKE SURE     @G24LB23*/
*/*            THAT IF THE VOLUME'S DOWN LEVEL SPACE FLAG    @G24LB23*/
*/*            IS ON THAT THE VOLUME IS MOUNTED OR GETS      @G24LB23*/
*/*            MOUNTED SO THAT SPACE WILL BE UPDATED AT      @G24LB23*/
*/*            DEMOUNT TIME.                                 @G24LB23*/
*/*                                                          @G24LB23*/
*/* INPUT - THE FDTTBL, AND THE BASE VOLUME RECORD           @G24LB23*/
*/*                                                          @G24LB23*/
*/* OUTPUT - THE LASTCOND IS SET TO 12 AND MESSAGE IDC3114I  @G24LB23*/
*/* IS PRINTED IF THE VOLUME'S DOWN LEVEL SPACE FLAG IS ON,  @G24LB23*/
*/* THE VOLUME IS NOT MOUNTED, AND THE ATTEMPT BY THIS       @G24LB23*/
*/* ROUTINE TO MOUNT THE VOLUME FAILS.                       @G24LB23*/
*/*                                                          @G24LB23*/
*/********************************************************** @G24LB23*/
*                                                                  0609
*DLSPCHK:                                                          0609
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @G24LB23*/
*                                                                  0609
DLSPCHK  DS    0H                                                  0610
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @G24LB23*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0610
*   DCL                                                            0610
*     DLSPCHSV PTR(31);             /*                       @G24LB23*/
*   DCL                                                            0611
*     DLSDDN CHAR(8);               /* DDNAME RETURN AREA    @G24LB23*/
*   DCL                                                            0612
*     DLSUCB PTR(31);               /* UCB ADDR RETURN AREA          */
*   DLSPCHSV=REG14;                 /*                       @G24LB23*/
         LR    DLSPCHSV,REG14                                      0613
*   OLDERID2=NEWERID2;                                             0614
         L     @15,@PC00001                                        0614
         L     @15,GDTTR2(,@15)                                    0614
         MVC   @TS00001(95),NEWERID2(@15)                          0614
         MVC   OLDERID2(95,@15),@TS00001                           0614
*   NEWID2='MVDL';                  /*                       @G24LB23*/
*                                                                  0615
         MVC   NEWID2(4,@15),@CC01685                              0615
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE GROUP IN WHICH THE VOLUME WILL BE              @G24LB23*/
*   /* GENERAL-USE IS NOT SYSGROUP, THE VOLUME'S DOWN        @G24LB23*/
*   /* LEVEL SPACE FLAG IS ON, AND THE VOLUME IS NOT         @G24LB23*/
*   /* ALREADY GOING TO BE MOUNTED FOR A RENAME              @G24LB23*/
*   /* OPERATION, THEN THIS ROUTINE MUST MAKE SURE           @G24LB23*/
*   /* THAT THE VOLUME IS MOUNTED OR GETS MOUNTED            @G24LB23*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0616
*   IF((ADDR(GRP)>0&GRPVAL^=SYSGROUP)×(ADDR(GRP)=0&BASGROUP^=SYSGROUP))
*       &BASDLSF=ON&RENAMSW=OFF&BASVSMIS=OFF THEN                  0616
         L     @15,@PC00001+4                                      0616
         L     @15,FDTPTR+12(,@15)                                 0616
         LTR   @15,@15                                             0616
         BNP   @GL00057                                            0616
         CLC   GRPVAL(8,@15),@CC01573                              0616
         BNE   @GL00056                                            0616
@GL00057 L     @15,@PC00001+4                                      0616
         L     @15,FDTPTR+12(,@15)                                 0616
         LTR   @15,@15                                             0616
         BNZ   @RF00616                                            0616
         CLC   BASGROUP(8,BASEVPTR),@CC01573                       0616
         BE    @RF00616                                            0616
@GL00056 TM    BASDLSF(BASEVPTR),B'10000000'                       0616
         BNO   @RF00616                                            0616
         TM    RENAMSW,B'01000000'                                 0616
         BNZ   @RF00616                                            0616
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0616
         BNZ   @RF00616                                            0616
*     DO;                           /*                       @G24LB23*/
*                                                                  0617
*       /*************************************************************/
*       /*                                                           */
*       /* FILE DD SPECIFIED?                                @G24LB23*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0618
*       IF ADDR(FYLE)>0 THEN                                       0618
         L     @15,@PC00001+4                                      0618
         L     @14,FDTPTR+88(,@15)                                 0618
         LTR   @14,@14                                             0618
         BNP   @RF00618                                            0618
*         DO;                       /*                       @G24LB23*/
*                                                                  0619
*           /*********************************************************/
*           /*                                                       */
*           /* FILE DD SPECIFIED                             @G24LB23*/
*           /* CHECK TO MAKE CERTAIN VOLUME IS MOUNTED       @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0620
*           SELAGL=SELAGL&&SELAGL;  /*                       @G24LB23*/
         LA    @02,MVSELAGL                                        0620
         XC    SELAGL(23,@02),SELAGL(@02)                          0620
*           SELVOL=VOLVAL;          /*                       @G24LB23*/
         L     @01,FDTPTR(,@15)                                    0621
         MVC   SELVOL(6,@02),VOLVAL(@01)                           0621
*           SELDDNP=ADDR(DLSDDN);   /*                       @G24LB23*/
         LA    @15,DLSDDN                                          0622
         ST    @15,SELDDNP(,@02)                                   0622
*           SELUCBP=ADDR(DLSUCB);   /*                       @G24LB23*/
         LA    @15,DLSUCB                                          0623
         ST    @15,SELUCBP(,@02)                                   0623
*           CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*         @G24LB23*/
         L     @15,@PC00001                                        0624
         ST    @15,@AL00001                                        0624
         LA    @14,SELECTDD                                        0624
         ST    @14,@AL00001+4                                      0624
         ST    @02,@AL00001+8                                      0624
         MVI   @AL00001+8,X'80'                                    0624
         L     @15,GDTUNT(,@15)                                    0624
         LA    @01,@AL00001                                        0624
         BALR  @14,@15                                             0624
*           RESPECIFY                                              0625
*             RTNREG RSTD;                                         0625
*           TESTRC=RTNREG;                                         0626
         LR    TESTRC,RTNREG                                       0626
*           RESPECIFY                                              0627
*             RTNREG UNRSTD;        /*                       @G24LB23*/
*                                                                  0627
*           /*********************************************************/
*           /*                                                       */
*           /* VOLUME MOUNTED?                               @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0628
*           IF TESTRC^=0 THEN                                      0628
         LTR   TESTRC,TESTRC                                       0628
         BZ    @RF00628                                            0628
*             DO;                   /*                       @G24LB23*/
*                                                                  0629
*               /*****************************************************/
*               /*                                                   */
*               /* VOLUME IS NOT MOUNTED, ERROR CONDITION    @G24LB23*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0630
*               DARGLIST=DARGLIST&&DARGLIST;/*               @G24LB23*/
         L     @15,DDSTRU                                          0630
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0630
*               DARGSMOD=MODCMN;    /*                       @G24LB23*/
         MVC   DARGSMOD(3,@15),MODCMN                              0631
*               DARGSENT=MSG3114I;  /*                       @G24LB23*/
         MVI   DARGSENT(@15),X'46'                                 0632
*               DARGDBP=ADDR(VOLVAL);/*                      @G24LB23*/
         L     @14,@PC00001+4                                      0633
         L     @01,FDTPTR(,@14)                                    0633
         LA    @14,VOLVAL(,@01)                                    0633
         ST    @14,DARGDBP(,@15)                                   0633
*               DARGILP=LENGTH(VOLVAL);/*                    @G24LB23*/
         MVC   DARGILP(2,@15),@CH00159                             0634
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/
         L     @15,@PC00001                                        0635
         ST    @15,@AL00001                                        0635
         LA    @14,@CF00117                                        0635
         ST    @14,@AL00001+4                                      0635
         LA    @14,DDSTRU                                          0635
         ST    @14,@AL00001+8                                      0635
         MVI   @AL00001+8,X'80'                                    0635
         L     @15,GDTPRT(,@15)                                    0635
         LA    @01,@AL00001                                        0635
         BALR  @14,@15                                             0635
*               LASTCOND=TERMCODE;  /*                       @G24LB23*/
         L     @15,@PC00001+8                                      0636
         MVC   LASTCOND(2,@15),@CH00038                            0636
*             END;                  /*                       @G24LB23*/
*         END;                      /*                       @G24LB23*/
*       ELSE                                                       0639
*         DO;                       /*                       @G24LB23*/
*                                                                  0639
         B     @RC00618                                            0639
@RF00618 DS    0H                                                  0640
*           /*********************************************************/
*           /*                                                       */
*           /* FILE DD NOT SPECIFIED, DYNAMICALLY ALLOCATE   @G24LB23*/
*           /* THE VOLUME                                    @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0640
*           ALLAGL=ALLAGL&&ALLAGL;  /*                       @G24LB23*/
         LA    @02,MVALLAGL                                        0640
         XC    ALLAGL(31,@02),ALLAGL(@02)                          0640
*           MVALLUNO=1;             /*                       @G24LB23*/
         LA    @02,1                                               0641
         STH   @02,MVALLUNO                                        0641
*           MVALLULN=LENGTH(MVUNIT);/*                       @G24LB23*/
         MVC   MVALLULN(2),@CH00297                                0642
*           MVALLUNT=MVUNIT;        /*                       @G24LB23*/
         MVI   MVALLUNT+5,C' '                                     0643
         MVC   MVALLUNT+6(2),MVALLUNT+5                            0643
         MVC   MVALLUNT(5),@CC01570                                0643
*           ALLULP=ADDR(MVALLUNO);  /*                       @G24LB23*/
         LA    @15,MVALLAGL                                        0644
         LA    @14,MVALLUNO                                        0644
         ST    @14,ALLULP(,@15)                                    0644
*           MVALLVNO=1;             /*                       @G24LB23*/
         STH   @02,MVALLVNO                                        0645
*           MVALLVLN=LENGTH(VOLVAL);/*                       @G24LB23*/
         MVC   MVALLVLN(2),@CH00159                                0646
*           MVALLVOL=VOLVAL;        /*                       @G24LB23*/
         L     @02,@PC00001+4                                      0647
         L     @02,FDTPTR(,@02)                                    0647
         MVC   MVALLVOL(6),VOLVAL(@02)                             0647
*           ALLVLP=ADDR(MVALLVNO);  /*                       @G24LB23*/
         LA    @02,MVALLVNO                                        0648
         ST    @02,ALLVLP(,@15)                                    0648
*           ALLOPTVL=ON;            /*                       @G24LB23*/
         OI    ALLOPTVL(@15),B'10000000'                           0649
*           ALLVLCNT=1;             /*                       @G24LB23*/
         MVI   ALLVLCNT(@15),X'01'                                 0650
*           ALLUNCNT=1;             /*                       @G24LB23*/
         MVI   ALLUNCNT(@15),X'01'                                 0651
*           ALLOPTPV=ON;            /*                       @G24LB23*/
*                                                                  0652
         OI    ALLOPTPV(@15),B'00100000'                           0652
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UALLOC TO MOUNT THE VOLUME              @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0653
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @G24LB23*/
         L     @02,@PC00001                                        0653
         ST    @02,@AL00001                                        0653
         ST    @15,@AL00001+4                                      0653
         MVI   @AL00001+4,X'80'                                    0653
         L     @15,GDTALC(,@02)                                    0653
         LA    @01,@AL00001                                        0653
         BALR  @14,@15                                             0653
*           RESPECIFY                                              0654
*             RTNREG RSTD;                                         0654
*           TESTRC=RTNREG;                                         0655
         LR    TESTRC,RTNREG                                       0655
*           RESPECIFY                                              0656
*             RTNREG UNRSTD;        /*                       @G24LB23*/
*                                                                  0656
*           /*********************************************************/
*           /*                                                       */
*           /* IF UALLOC FAILS, SET LASTCOND AND PRINT       @G24LB23*/
*           /* ERROR MESSAGE                                 @G24LB23*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0657
*           IF TESTRC^=0 THEN                                      0657
         LTR   TESTRC,TESTRC                                       0657
         BZ    @RF00657                                            0657
*             DO;                   /*                       @G24LB23*/
*               DARGLIST=DARGLIST&&DARGLIST;/*               @G24LB23*/
         L     @15,DDSTRU                                          0659
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0659
*               DARGSMOD=MODCMN;    /*                       @G24LB23*/
         MVC   DARGSMOD(3,@15),MODCMN                              0660
*               DARGSENT=MSG3114I;  /*                       @G24LB23*/
         MVI   DARGSENT(@15),X'46'                                 0661
*               DARGDBP=ADDR(VOLVAL);/*                      @G24LB23*/
         L     @14,@PC00001+4                                      0662
         L     @01,FDTPTR(,@14)                                    0662
         LA    @14,VOLVAL(,@01)                                    0662
         ST    @14,DARGDBP(,@15)                                   0662
*               DARGILP=LENGTH(VOLVAL);/*                    @G24LB23*/
         MVC   DARGILP(2,@15),@CH00159                             0663
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @G24LB23*/
         L     @15,@PC00001                                        0664
         ST    @15,@AL00001                                        0664
         LA    @14,@CF00117                                        0664
         ST    @14,@AL00001+4                                      0664
         LA    @14,DDSTRU                                          0664
         ST    @14,@AL00001+8                                      0664
         MVI   @AL00001+8,X'80'                                    0664
         L     @15,GDTPRT(,@15)                                    0664
         LA    @01,@AL00001                                        0664
         BALR  @14,@15                                             0664
*               LASTCOND=TERMCODE;  /*                       @G24LB23*/
         L     @15,@PC00001+8                                      0665
         MVC   LASTCOND(2,@15),@CH00038                            0665
*             END;                  /*                       @G24LB23*/
*           ELSE                                                   0667
*             DO;                   /*                       @G24LB23*/
*                                                                  0667
         B     @RC00657                                            0667
@RF00657 DS    0H                                                  0668
*               /*****************************************************/
*               /*                                                   */
*               /* DEMOUNT THE VOLUME                        @VS44255*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0668
*               MDAGL=MDAGL&&MDAGL; /*                       @VS44255*/
         LA    @02,MVMDAGL                                         0668
         XC    MDAGL(37,@02),MDAGL(@02)                            0668
*               MDDDNAME=ALLDDN;    /*                       @VS44255*/
         LA    @15,MVALLAGL                                        0669
         MVC   MDDDNAME(8,@02),ALLDDN(@15)                         0669
*               MDUCBPTR=ADDR(MVUCBPTR);/*                   @VS44255*/
         LA    @15,MVUCBPTR                                        0670
         ST    @15,MDUCBPTR(,@02)                                  0670
*               MDLABEL=VOLVAL;     /*                       @VS44255*/
         L     @15,@PC00001+4                                      0671
         L     @01,FDTPTR(,@15)                                    0671
         MVC   MDLABEL(6,@02),VOLVAL(@01)                          0671
*               MDWAIT=ON;          /*                       @VS44255*/
*                                                                  0672
         OI    MDWAIT(@02),B'00010000'                             0672
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE DEMOUNT COMMAND                     @VS44255*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0673
*               CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*       @VS44255*/
         L     @15,@PC00001                                        0673
         ST    @15,@AL00001                                        0673
         LA    @14,DEMOUNT                                         0673
         ST    @14,@AL00001+4                                      0673
         ST    @02,@AL00001+8                                      0673
         MVI   @AL00001+8,X'80'                                    0673
         L     @15,GDTUNT(,@15)                                    0673
         LA    @01,@AL00001                                        0673
         BALR  @14,@15                                             0673
*               RESPECIFY                                          0674
*                 RTNREG RSTD;                                     0674
*               TESTRC=RTNREG;                                     0675
         LR    TESTRC,RTNREG                                       0675
*               RESPECIFY                                          0676
*                 RTNREG UNRSTD;    /*                       @VS44255*/
*                                                                  0676
*               /*****************************************************/
*               /*                                                   */
*               /* IF DEMOUNT FAILED, SET LASTCOND TO 12     @VS44255*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0677
*               IF TESTRC^=0 THEN                                  0677
         LTR   TESTRC,TESTRC                                       0677
         BZ    @RF00677                                            0677
*                 LASTCOND=TERMCODE;/*                       @VS44255*/
         L     @15,@PC00001+8                                      0678
         MVC   LASTCOND(2,@15),@CH00038                            0678
*               ELSE                                               0679
*                 DO;               /*                       @VS44255*/
*                                                                  0679
         B     @RC00677                                            0679
@RF00677 DS    0H                                                  0680
*                   /*************************************************/
*                   /*                                               */
*                   /* ISSUE UDEALLOC                        @VS44255*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0680
*                   CALL IDCSADL0(GDTTBL,ALLAGL);/*          @G24LB23*/
         L     @02,@PC00001                                        0680
         ST    @02,@AL00001                                        0680
         LA    @15,MVALLAGL                                        0680
         ST    @15,@AL00001+4                                      0680
         MVI   @AL00001+4,X'80'                                    0680
         L     @15,GDTDLC(,@02)                                    0680
         LA    @01,@AL00001                                        0680
         BALR  @14,@15                                             0680
*                   RESPECIFY                                      0681
*                     RTNREG RSTD;                                 0681
*                   TESTRC=RTNREG;                                 0682
         LR    TESTRC,RTNREG                                       0682
*                   RESPECIFY                                      0683
*                     RTNREG UNRSTD;/*                       @G24LB23*/
*                                                                  0683
*                   /*************************************************/
*                   /*                                               */
*                   /* IF UDEALLOC FAILS, SET LASTCOND       @G24LB23*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0684
*                   IF TESTRC^=0 THEN                              0684
         LTR   TESTRC,TESTRC                                       0684
         BZ    @RF00684                                            0684
*                     LASTCOND=4;   /*                       @G24LB23*/
         L     @15,@PC00001+8                                      0685
         MVC   LASTCOND(2,@15),@CH00043                            0685
*                 END;              /*                       @VS44255*/
@RF00684 DS    0H                                                  0687
*             END;                  /*                       @G24LB23*/
@RC00677 DS    0H                                                  0688
*         END;                      /*                       @G24LB23*/
@RC00657 DS    0H                                                  0689
*     END;                          /*                       @G24LB23*/
*                                                                  0689
@RC00618 DS    0H                                                  0690
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @G24LB23*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0690
*   REG14=DLSPCHSV;                 /*                       @G24LB23*/
@RF00616 LR    REG14,DLSPCHSV                                      0690
*   RETURN CODE(0);                 /*                       @G24LB23*/
         SLR   @15,@15                                             0691
@EL00007 DS    0H                                                  0691
@EF00007 DS    0H                                                  0691
@ER00007 BR    @14                                                 0691
*   END DLSPCHK;                    /*                       @G24LB23*/
*                                                                  0693
*/********************************************************   #Y30LB33*/
*/* PROCEDURE NAME - GRPCHK                                  #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* FUNCTION - TO READ THE GROUP RECORD IN WHICH THE VOLUME  #Y30LB33*/
*/*      WILL BE GENERAL, AND CHECK THE ATTRIBUTES PROPOSED  #Y30LB33*/
*/*      BY THE USER AGAINST THE GROUP'S ATTRIBUTES AND      #Y30LB33*/
*/*      INDICATE IF SOME WILL BE COPIED FROM THE GROUP OR   #Y30LB33*/
*/*      IF THE USER SPECIFIED ANY ATTRIBUTES INCORRECTLY.   #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*      MESSAGE IDC2079I IS ISSUED IF THE GROUP RECORD      #Y30LB33*/
*/*      WAS NOT READ FROM THE INVENTORY                     #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND SWCHBITS      #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* OUTPUT - THE LASTCOND IS SET TO 12 IF MODIFICATION       #Y30LB33*/
*/*      OF THE VOLUME IS IMPOSSIBLE BECAUSE OF CONFLICTS    #Y30LB33*/
*/*      WITH THE ATTRIBUTES OF THE GROUP, OR IF THE         #Y30LB33*/
*/*      GROUP RECORD COULD NOT BE READ FROM THE             #Y30LB33*/
*/*      INVENTORY.                                          #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*      THE FOLLOWING BITS IN SWCHBITS ARE SET              #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*            GRPRCD                                        #Y30LB33*/
*/*            COPYATTR                                      #Y30LB33*/
*/*            COPYRW                                        #Y30LB33*/
*/*            ONLYONLY                                      #Y30LB33*/
*/********************************************************   #Y30LB33*/
*                                                                  0693
*GRPCHK:                                                           0693
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/
*                                                                  0693
GRPCHK   DS    0H                                                  0694
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*   DCL                                                            0694
*     GRPCHKSV PTR(31);             /*                       #Y30LB33*/
*   GRPCHKSV=REG14;                 /*                       #Y30LB33*/
         LR    GRPCHKSV,REG14                                      0695
*   OLDERID2=NEWERID2;                                             0696
         L     @15,@PC00001                                        0696
         L     @15,GDTTR2(,@15)                                    0696
         MVC   @TS00001(95),NEWERID2(@15)                          0696
         MVC   OLDERID2(95,@15),@TS00001                           0696
*   NEWID2='MVGC';                  /*                       #Y30LB33*/
*                                                                  0697
         MVC   NEWID2(4,@15),@CC01690                              0697
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE GROUP RECORD OF THE GROUP TO WHICH           #Y30LB33*/
*   /* THE VOLUME NOW BELONGS OR IN WHICH THE VOLUME         #Y30LB33*/
*   /* WILL BE PLACED                                        #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0698
*   RVVI=RVVI&&RVVI;                /*                       #Y30LB33*/
         L     @15,RVVIPTR                                         0698
         XC    RVVI(68,@15),RVVI(@15)                              0698
*   IF ADDR(GRP)>0 THEN                                            0699
         L     @15,@PC00001+4                                      0699
         L     @15,FDTPTR+12(,@15)                                 0699
         LTR   @15,@15                                             0699
         BNP   @RF00699                                            0699
*     RVVGROUP=GRPVAL;              /*                       #Y30LB33*/
         L     @14,RVVIPTR                                         0700
         MVC   RVVGROUP(8,@14),GRPVAL(@15)                         0700
*   ELSE                                                           0701
*     RVVGROUP=BASGROUP;            /*                       #Y30LB33*/
         B     @RC00699                                            0701
@RF00699 L     @01,RVVIPTR                                         0701
         MVC   RVVGROUP(8,@01),BASGROUP(BASEVPTR)                  0701
*   RVVLNGTH=RVVLEN;                /*                       #Y30LB33*/
@RC00699 L     @02,RVVIPTR                                         0702
         LH    @15,RVVLEN                                          0702
         ST    @15,RVVLNGTH(,@02)                                  0702
*   RVVCODE=RVVOP;                  /*                       #Y30LB33*/
         MVI   RVVCODE(@02),X'87'                                  0703
*   RVVRTBUF=ADDR(GRPRCDBF);        /*                       #Y30LB33*/
         LA    @15,GRPRCDBF                                        0704
         ST    @15,RVVRTBUF(,@02)                                  0704
*   RVVRDR=ON;                      /*                       #Y30LB33*/
         OI    RVVRDR(@02),B'10000000'                             0705
*   RVVGRPRC=ON;                    /*                       #Y30LB33*/
         OI    RVVGRPRC(@02),B'01000000'                           0706
*   RVVSGRP=ON;                     /*                       #Y30LB33*/
         OI    RVVSGRP(@02),B'10000000'                            0707
*   RVVBUFLN=LENGTH(GRPRCDBF);      /*                       #Y30LB33*/
*                                                                  0708
         MVC   RVVBUFLN(2,@02),@CH01834                            0708
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO READ GROUP                              #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0709
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,RCAREA);/*             #Y30LB33*/
         L     @02,@PC00001                                        0709
         ST    @02,@AL00001                                        0709
         LA    @15,VVIC                                            0709
         ST    @15,@AL00001+4                                      0709
         LA    @15,RVVIPTR                                         0709
         ST    @15,@AL00001+8                                      0709
         LA    @15,RCAREA                                          0709
         ST    @15,@AL00001+12                                     0709
         MVI   @AL00001+12,X'80'                                   0709
         L     @15,GDTSSC(,@02)                                    0709
         LA    @01,@AL00001                                        0709
         BALR  @14,@15                                             0709
*   RESPECIFY                                                      0710
*     RTNREG RSTD;                                                 0710
*   TESTRC=RTNREG;                                                 0711
         LR    TESTRC,RTNREG                                       0711
*   RESPECIFY                                                      0712
*     RTNREG UNRSTD;                /*                       #Y30LB33*/
*                                                                  0712
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD WAS NOT READ, CALL SSCMSG TO            #Y30LB33*/
*   /* PRINT THE MESSAGE CORRESPONDING TO THE                #Y30LB33*/
*   /* REASON CODE AND THEN PRINT THE ERROR MSG              #Y30LB33*/
*   /* IDC2079I AND SET LASTCOND TO 12                       #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0713
*   IF TESTRC=4 THEN                                               0713
         C     TESTRC,@CF00043                                     0713
         BNE   @RF00713                                            0713
*     DO;                           /*                       #Y30LB33*/
*       CALL SSCMSG(RCAREA);        /*                       #Y30LB33*/
         LA    @15,RCAREA                                          0715
         ST    @15,@AL00001                                        0715
         LA    @01,@AL00001                                        0715
         BAL   @14,SSCMSG                                          0715
*       DARGLIST=DARGLIST&&DARGLIST;/*                       #Y30LB33*/
         L     @15,DDSTRU                                          0716
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0716
*       DARGSMOD=MODCMN;            /*                       #Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0717
*       DARGSENT=MSG2079I;          /*                       #Y30LB33*/
         MVI   DARGSENT(@15),X'1B'                                 0718
*       DARGDBP=ADDR(RVVGROUP);     /*                       #Y30LB33*/
         L     @01,RVVIPTR                                         0719
         LA    @14,RVVGROUP(,@01)                                  0719
         ST    @14,DARGDBP(,@15)                                   0719
*       DARGILP=LENGTH(RVVGROUP);   /*                       #Y30LB33*/
         MVC   DARGILP(2,@15),@CH00035                             0720
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              #Y30LB33*/
         L     @15,@PC00001                                        0721
         ST    @15,@AL00001                                        0721
         LA    @14,@CF00117                                        0721
         ST    @14,@AL00001+4                                      0721
         LA    @14,DDSTRU                                          0721
         ST    @14,@AL00001+8                                      0721
         MVI   @AL00001+8,X'80'                                    0721
         L     @15,GDTPRT(,@15)                                    0721
         LA    @01,@AL00001                                        0721
         BALR  @14,@15                                             0721
*       LASTCOND=TERMCODE;          /*                       #Y30LB33*/
         L     @15,@PC00001+8                                      0722
         MVC   LASTCOND(2,@15),@CH00038                            0722
*     END;                          /*                       #Y30LB33*/
*                                                                  0724
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RECORD WAS READ, TURN ON THE SWITCH            #Y30LB33*/
*   /* TO INDICATE SO                                        #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*   ELSE                                                           0724
*     DO;                           /*                       #Y30LB33*/
         B     @RC00713                                            0724
@RF00713 DS    0H                                                  0725
*       GRPRCD=ON;                  /*                       #Y30LB33*/
*                                                                  0725
         OI    GRPRCD,B'00001000'                                  0725
*       /*************************************************************/
*       /*                                                           */
*       /* SEE IF SOME OF THE                                #Y30LB33*/
*       /* ATTRIBUTES ARE GOING TO BE COPIED FROM THE        #Y30LB33*/
*       /* GROUP RECORD, AND IF SO, TURN ON THE              #Y30LB33*/
*       /* SWITCH THAT INDICATES THAT SITUATION              #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*       IF                          /*                       #Y30LB33*/
*                                                                  0726
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE USER REQUESTED NEITHER BIND OR             #Y30LB33*/
*       /* NOBIND AND THE GROUP BIND ATTRIBUTE DOES          #Y30LB33*/
*       /* NOT AGREE WITH THAT OF THE VOLUME                 #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*           ((ADDR(BIND)=0&ADDR(NBIND)=0&/*                  #Y30LB33*/
*           ((GROBIND=ON&BASBIND=OFF)×/*                     #Y30LB33*/
*           (GROBIND=OFF&BASBIND=ON)))×/*                    #Y30LB33*/
*                                                                  0726
*       /*************************************************************/
*       /*                                                           */
*       /* OR THE USER REQUESTED NEITHER EXCLUSIVE           #Y30LB33*/
*       /* OR SHARED AND THE GROUP SHARED ATTRIBUTE          #Y30LB33*/
*       /* DOES NOT AGREE WITH THAT OF THE VOLUME            #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*           (ADDR(EXECL)=0&ADDR(SHRD)=0&/*                   #Y30LB33*/
*           ((GROEXCL=ON&BASEXCL=OFF)×/*                     #Y30LB33*/
*           (GROEXCL=OFF&BASEXCL=ON)))×/*                    #Y30LB33*/
*                                                                  0726
*       /*************************************************************/
*       /*                                                           */
*       /* OR THE USER REQUESTED NEITHER DASDERASE           #Y30LB33*/
*       /* OR NODASDERASE AND THE GROUP DASDERASE            #Y30LB33*/
*       /* ATTRIBUTE DOES NOT AGREE WITH THAT OF THE         #Y30LB33*/
*       /* VOLUME                                            #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*           (ADDR(DERAS)=0&ADDR(NDERS)=0&/*                  #Y30LB33*/
*           ((GRODAERA=ON&BASDAERA=OFF)×/*                   #Y30LB33*/
*           (GRODAERA=OFF&BASDAERA=ON))))/*                  #Y30LB33*/
*                                                                  0726
*       /*************************************************************/
*       /*                                                           */
*       /* THEN INDICATE THAT SOME ATTRIBUTES MUST BE        #Y30LB33*/
*       /* COPIED FROM THE GROUP RECORD                      #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0726
*         THEN                                                     0726
         SLR   @15,@15                                             0726
         L     @14,@PC00001+4                                      0726
         C     @15,FDTPTR+24(,@14)                                 0726
         BNE   @GL00061                                            0726
         C     @15,FDTPTR+28(,@14)                                 0726
         BNE   @GL00061                                            0726
         TM    GROBIND(GROUPPTR),B'10000000'                       0726
         BNO   @GL00064                                            0726
         TM    BASBIND(BASEVPTR),B'00000010'                       0726
         BZ    @RT00726                                            0726
@GL00064 TM    GROBIND(GROUPPTR),B'10000000'                       0726
         BNZ   @GL00061                                            0726
         TM    BASBIND(BASEVPTR),B'00000010'                       0726
         BO    @RT00726                                            0726
@GL00061 SLR   @15,@15                                             0726
         L     @14,@PC00001+4                                      0726
         C     @15,FDTPTR+32(,@14)                                 0726
         BNE   @GL00060                                            0726
         C     @15,FDTPTR+36(,@14)                                 0726
         BNE   @GL00060                                            0726
         TM    GROEXCL(GROUPPTR),B'01000000'                       0726
         BNO   @GL00069                                            0726
         TM    BASEXCL(BASEVPTR),B'00000001'                       0726
         BZ    @RT00726                                            0726
@GL00069 TM    GROEXCL(GROUPPTR),B'01000000'                       0726
         BNZ   @GL00060                                            0726
         TM    BASEXCL(BASEVPTR),B'00000001'                       0726
         BO    @RT00726                                            0726
@GL00060 SLR   @15,@15                                             0726
         L     @14,@PC00001+4                                      0726
         C     @15,FDTPTR+48(,@14)                                 0726
         BNE   @RF00726                                            0726
         C     @15,FDTPTR+52(,@14)                                 0726
         BNE   @RF00726                                            0726
         TM    GRODAERA(GROUPPTR),B'00100000'                      0726
         BNO   @GL00074                                            0726
         TM    BASDAERA(BASEVPTR),B'10000000'                      0726
         BZ    @RT00726                                            0726
@GL00074 TM    GRODAERA(GROUPPTR),B'00100000'                      0726
         BNZ   @RF00726                                            0726
         TM    BASDAERA(BASEVPTR),B'10000000'                      0726
         BNO   @RF00726                                            0726
@RT00726 DS    0H                                                  0727
*         COPYATTR=ON;              /*                       #Y30LB33*/
*                                                                  0727
         OI    COPYATTR,B'00000010'                                0727
*       /*************************************************************/
*       /*                                                           */
*       /* TEST THE READONLY ATTRIBUTE                       #Y30LB33*/
*       /* SEPARATELY. IF IT IS ON IN THE                    #Y30LB33*/
*       /* GROUP RECORD, NOT ON IN THE VOLUME                #Y30LB33*/
*       /* RECORD, AND NOT SPECIFIED BY THE                  #Y30LB33*/
*       /* USER, THEN IT IS TO BE COPIED                     #Y30LB33*/
*       /* FROM THE GROUP RECORD. A SEPARATE                 #Y30LB33*/
*       /* SWITCH MUST BE USED BECAUSE OF                    #Y30LB33*/
*       /* THE POSSIBILITY OF CHANGING THE                   #Y30LB33*/
*       /* OWNER OR VOLUME SERIAL                            #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0728
*       IF ADDR(RONLY)=0&ADDR(RW)=0&/*                       #Y30LB33*/
*           GRORONLY=ON&BASRONLY=OFF/*                       #Y30LB33*/
*           &COPYATTR=OFF THEN                                     0728
@RF00726 SLR   @15,@15                                             0728
         L     @14,@PC00001+4                                      0728
         C     @15,FDTPTR+40(,@14)                                 0728
         BNE   @RF00728                                            0728
         C     @15,FDTPTR+44(,@14)                                 0728
         BNE   @RF00728                                            0728
         TM    GRORONLY(GROUPPTR),B'00010000'                      0728
         BNO   @RF00728                                            0728
         TM    BASRONLY(BASEVPTR),B'01000000'                      0728
         BNZ   @RF00728                                            0728
         TM    COPYATTR,B'00000010'                                0728
         BNZ   @RF00728                                            0728
*         ONLYONLY=ON;              /*                       #Y30LB33*/
*                                                                  0729
         OI    ONLYONLY,B'10000000'                                0729
*       /*************************************************************/
*       /*                                                           */
*       /* TURN ON THE INDICATOR SWITCH IF                   #Y30LB33*/
*       /* READWRITE IS TO BE COPIED FROM                    #Y30LB33*/
*       /* THE GROUP RECORD                                  #Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0730
*       ELSE                                                       0730
*         IF GRORONLY=OFF&BASRONLY=ON&/*                     #Y30LB33*/
*             ADDR(RW)=0 THEN                                      0730
         B     @RC00728                                            0730
@RF00728 TM    GRORONLY(GROUPPTR),B'00010000'                      0730
         BNZ   @RF00730                                            0730
         TM    BASRONLY(BASEVPTR),B'01000000'                      0730
         BNO   @RF00730                                            0730
         L     @15,@PC00001+4                                      0730
         L     @15,FDTPTR+44(,@15)                                 0730
         LTR   @15,@15                                             0730
         BNZ   @RF00730                                            0730
*           DO;                     /*                       #Y30LB33*/
*             COPYRW=ON;            /*                       #Y30LB33*/
         OI    COPYRW,B'00010000'                                  0732
*             COPYATTR=ON;          /*                       #Y30LB33*/
         OI    COPYATTR,B'00000010'                                0733
*           END;                    /*                       #Y30LB33*/
*     END;                          /*                       #Y30LB33*/
*                                                                  0735
@RF00730 DS    0H                                                  0735
@RC00728 DS    0H                                                  0736
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0736
*   REG14=GRPCHKSV;                 /*                       #Y30LB33*/
@RC00713 LR    REG14,GRPCHKSV                                      0736
*   RETURN CODE(0);                 /*                       #Y30LB33*/
         SLR   @15,@15                                             0737
@EL00008 DS    0H                                                  0737
@EF00008 DS    0H                                                  0737
@ER00008 BR    @14                                                 0737
*   END GRPCHK;                     /*                       #Y30LB33*/
*                                                                  0739
*/********************************************************   #Y30LB33*/
*/* PROCEDURE NAME - DOIT                                    #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* FUNCTION - TO CALL PROCEDURES TO MAKE THE                #Y30LB33*/
*/*      REQUESTED CHANGES AND CORRECT ERRORS                #Y30LB33*/
*/*      WHEN ENCOUNTERED                                    #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*            CKAUTH                                        #Y30LB33*/
*/*            MODFYIT                                       #Y30LB33*/
*/*            LABELIT                                       #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* INPUT - THE FDTTBL, LASTCOND, AND SWCHBITS               #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE VOLUME          #Y30LB33*/
*/*      DID NOT DEALLOCATE PROPERLY                         #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*      THE ALLOCSW IN SWCHBITS IS TURNED OFF WHEN          #Y30LB33*/
*/*      DEALLOCATION IS TRIED                               #Y30LB33*/
*/********************************************************   #Y30LB33*/
*                                                                  0739
*DOIT:                                                             0739
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/
*                                                                  0739
DOIT     DS    0H                                                  0740
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0740
*   DCL                                                            0740
*     DOITSV PTR(31);               /*                       #Y30LB33*/
*   DOITSV=REG14;                   /*                       #Y30LB33*/
         ST    REG14,DOITSV                                        0741
*   OLDERID2=NEWERID2;                                             0742
         L     @07,@PC00001                                        0742
         L     @07,GDTTR2(,@07)                                    0742
         MVC   @TS00001(95),NEWERID2(@07)                          0742
         MVC   OLDERID2(95,@07),@TS00001                           0742
*   NEWID2='MVCA';                  /*                       #Y30LB33*/
*                                                                  0743
         MVC   NEWID2(4,@07),@CC01695                              0743
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE CHANGING THE VOLUME SERIAL, BUT NOT         #Y30LB33*/
*   /* BACKING OUT A PREVIOUS RELABELING FAILURE,            #Y30LB33*/
*   /* CALL CKAUTH TO CHECK THE VOLUME CONTENTS AND          #Y30LB33*/
*   /* PASSWORDS                                             #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0744
*   IF ADDR(NEWSR)=NULLPTR×         /*                       #Y30LB33*/
*       (BASVSMIS=ON&NEWSRVAL=BASRECOV) THEN                       0744
         L     @07,@PC00001+4                                      0744
         L     @07,FDTPTR+4(,@07)                                  0744
         LTR   @07,@07                                             0744
         BZ    @RT00744                                            0744
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0744
         BNO   @RF00744                                            0744
         CLC   NEWSRVAL(6,@07),BASRECOV(BASEVPTR)                  0744
         BE    @RT00744                                            0744
*     ;                             /*                       #Y30LB33*/
*   ELSE                                                           0746
*     CALL CKAUTH;                  /*                       #Y30LB33*/
*                                                                  0746
@RF00744 BAL   @14,CKAUTH                                          0746
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS, CALL MODFYIT TO CHANGE                  #Y30LB33*/
*   /* THE VOLUME                                            #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0747
*   IF LASTCOND^=TERMCODE THEN                                     0747
@RT00744 L     @07,@PC00001+8                                      0747
         CLC   LASTCOND(2,@07),@CH00038                            0747
         BE    @RF00747                                            0747
*     CALL MODFYIT;                 /*                       #Y30LB33*/
*                                                                  0748
         BAL   @14,MODFYIT                                         0748
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS FOUND YET, AND IF WE MUST WRITE          #Y30LB33*/
*   /* A NEW SOFTWARE LABEL, CALL LABELIT TO WRITE           #Y30LB33*/
*   /* THE LABEL                                             #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0749
*   IF LASTCOND^=TERMCODE&RENAMSW=ON/*                       #Y30LB33*/
*     THEN                                                         0749
@RF00747 L     @07,@PC00001+8                                      0749
         CLC   LASTCOND(2,@07),@CH00038                            0749
         BE    @RF00749                                            0749
         TM    RENAMSW,B'01000000'                                 0749
         BNO   @RF00749                                            0749
*     CALL LABELIT;                 /*                       #Y30LB33*/
         BAL   @14,LABELIT                                         0750
*                                                                  0751
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME IS ACTIVE, AND IT WAS                   @YD00175*/
*   /* DEMOUNTED DURING PROCESSING AND IS NOT                @YD00175*/
*   /* MOUNTED NOW, MOUNT THE VOLUME.                        @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0751
*   IF INACTSW=OFF&MNTSW=OFF&DMNTSW=ON/*                     @YD00175*/
*     THEN                                                         0751
@RF00749 TM    INACTSW,B'00000100'                                 0751
         BNZ   @RF00751                                            0751
         TM    MNTSW,B'00100000'                                   0751
         BNZ   @RF00751                                            0751
         TM    DMNTSW,B'10000000'                                  0751
         BNO   @RF00751                                            0751
*     DO;                           /*                       @YD00175*/
*       CALL MNTVOL;                /*                       @YD00175*/
         BAL   @14,MNTVOL                                          0753
*       IF MNTSW=OFF THEN           /*                       @YD00175*/
         TM    MNTSW,B'00100000'                                   0754
         BNZ   @RF00754                                            0754
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @YD00175*/
         L     @15,@PC00001+8                                      0755
         LH    @14,LASTCOND(,@15)                                  0755
         LA    @07,4                                               0755
         CR    @14,@07                                             0755
         BNL   *+6
         LR    @14,@07                                             0755
         STH   @14,LASTCOND(,@15)                                  0755
*     END;                          /*                       @YD00175*/
@RF00754 DS    0H                                                  0757
*                                                                  0757
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0757
*   REG14=DOITSV;                   /*                       #Y30LB33*/
@RF00751 L     REG14,DOITSV                                        0757
*   RETURN CODE(0);                 /*                       #Y30LB33*/
         SLR   @15,@15                                             0758
@EL00009 DS    0H                                                  0758
@EF00009 DS    0H                                                  0758
@ER00009 BR    @14                                                 0758
*   END DOIT;                       /*                       #Y30LB33*/
*                                                                  0760
*/********************************************************   #Y30LB33*/
*/* PROCEDURE NAME - CKAUTH                                  #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* FUNCTION - TO MAKE SURE THAT THE VOLUME, TO BE           #Y30LB33*/
*/*      RELABELED, DOES NOT CONTAIN A VSAM DATA SET         #Y30LB33*/
*/*      AND ALSO, TO CHECK FOR NON-VSAM PASSWORD-           #Y30LB33*/
*/*      PROTECTED DATA SETS                                 #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND SWCHBITS      #Y30LB33*/
*/*                                                          #Y30LB33*/
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE VTOC FAILS      #Y30LB33*/
*/*      TO CLOSE PROPERLY. IT IS SET TO 12 TO INDICATE THAT #Y30LB33*/
*/*      NO MODIFICATION WAS DONE                            #Y30LB33*/
*/*                                                          #Y30LB33*/
*/*      THE FOLLOWING SWCHBITS ARE SET                      #Y30LB33*/
*/*            CKSW                                          #Y30LB33*/
*/********************************************************   #Y30LB33*/
*                                                                  0760
*CKAUTH:                                                           0760
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  #Y30LB33*/
*                                                                  0760
CKAUTH   DS    0H                                                  0761
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0761
*   DCL                                                            0761
*     CKAUTHSV PTR(31);             /*                       #Y30LB33*/
*   CKAUTHSV=REG14;                 /*                       #Y30LB33*/
         ST    REG14,CKAUTHSV                                      0762
*   OLDERID2=NEWERID2;                                             0763
         L     @07,@PC00001                                        0763
         L     @07,GDTTR2(,@07)                                    0763
         MVC   @TS00001(95),NEWERID2(@07)                          0763
         MVC   OLDERID2(95,@07),@TS00001                           0763
*   NEWID2='MVFA';                  /*                       #Y30LB33*/
*                                                                  0764
         MVC   NEWID2(4,@07),@CC01703                              0764
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME HAS A LABEL MISMATCH                    #Y30LB33*/
*   /* MOUNT THE VOLUME FOR AUTHORIZATION CHECKING           #Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0765
*   IF BASVSMIS=ON THEN                                            0765
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0765
         BNO   @RF00765                                            0765
*     DO;                           /*                       #Y30LB33*/
*       CALL MNTVOL;                /*                       @YD00175*/
*                                                                  0767
         BAL   @14,MNTVOL                                          0767
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE MOUNT SWITCH IS OFF, THE MOUNT             @YD00175*/
*       /* FAILED, SO TERMINATE THE RUN                      @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0768
*       IF MNTSW=OFF THEN                                          0768
         TM    MNTSW,B'00100000'                                   0768
         BNZ   @RF00768                                            0768
*         LASTCOND=TERMCODE;        /*                       @YD00175*/
         L     @07,@PC00001+8                                      0769
         MVC   LASTCOND(2,@07),@CH00038                            0769
*     END;                          /*                       @Y30LB33*/
*   ELSE                            /*                       @Y30LB33*/
*                                                                  0771
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE FILE PARAMETER IS NOT SPECIFIED,             @Y30LB33*/
*     /* ALLOCATE AND MOUNT THE VOLUME. IF THE               @Y30LB33*/
*     /* ALLOCATE FAILS, SET LASTCOND TO 12                  @Y30LB33*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0771
*     IF ADDR(FYLE)=0 THEN                                         0771
         B     @RC00765                                            0771
@RF00765 L     @07,@PC00001+4                                      0771
         L     @15,FDTPTR+88(,@07)                                 0771
         LTR   @15,@15                                             0771
         BNZ   @RF00771                                            0771
*       CALL ALLOVOL(VOLVAL);       /*                       @Y30LB33*/
*                                                                  0772
         L     @07,FDTPTR(,@07)                                    0772
         LA    @07,VOLVAL(,@07)                                    0772
         ST    @07,@AL00001                                        0772
         LA    @01,@AL00001                                        0772
         BAL   @14,ALLOVOL                                         0772
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS WERE FOUND IN MOUNTING                   @Y30LB33*/
*   /* OR ALLOCATING, CALL ON VOLUME SERVICES                @Y30LB33*/
*   /* TO CHECK AUTHORIZATION                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0773
*   IF LASTCOND<TERMCODE THEN                                      0773
@RF00771 DS    0H                                                  0773
@RC00765 L     @07,@PC00001+8                                      0773
         LH    @07,LASTCOND(,@07)                                  0773
         C     @07,@CF00038                                        0773
         BNL   @RF00773                                            0773
*     DO;                           /*                       @Y30LB33*/
*       VS1AGL=VS1AGL&&VS1AGL;      /*                       @Y30LB33*/
         LA    @07,MVVS1AGL                                        0775
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0775
*       VSNOVSAM=ON;                /*                       @Y30LB33*/
*       VSWRITE=ON;                 /*                       @Y30LB33*/
         OI    VSNOVSAM(@07),B'10001000'                           0777
*       VSVOLP=ADDR(VOLVAL);        /*                       @Y30LB33*/
         L     @02,@PC00001+4                                      0778
         L     @01,FDTPTR(,@02)                                    0778
         LA    @15,VOLVAL(,@01)                                    0778
         ST    @15,VSVOLP(,@07)                                    0778
*       VSFILEP=ADDR(MVDDNAME);     /*                       @Y30LB33*/
         LA    @15,MVDDNAME                                        0779
         ST    @15,VSFILEP(,@07)                                   0779
*       VSRES=ON;                   /*                       @Y30LB33*/
         OI    VSRES(@07),B'10000000'                              0780
*       VSUCBP=ADDR(MVUCBPTR);      /*                       @Y30LB33*/
         LA    @15,MVUCBPTR                                        0781
         ST    @15,VSUCBP(,@07)                                    0781
*       VSPFILEP=ADDR(PSWD);        /*                       @Y30LB33*/
*                                                                  0782
         L     @02,FDTPTR+92(,@02)                                 0782
         ST    @02,VSPFILEP(,@07)                                  0782
*       /*************************************************************/
*       /*                                                           */
*       /* CALL VOLUME SERVICES. AND                         @YD00175*/
*       /* INDICATE VOLUME IS MOUNTED.                       @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0783
*       CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*  @Y30LB33*/
         L     @02,@PC00001                                        0783
         ST    @02,@AL00001                                        0783
         LA    @15,@CC01705                                        0783
         ST    @15,@AL00001+4                                      0783
         LA    @15,SECCHECK                                        0783
         ST    @15,@AL00001+8                                      0783
         ST    @07,@AL00001+12                                     0783
         MVI   @AL00001+12,X'80'                                   0783
         L     @15,GDTCAL(,@02)                                    0783
         LA    @01,@AL00001                                        0783
         BALR  @14,@15                                             0783
*       RESPECIFY                                                  0784
*         RTNREG RSTD;                                             0784
*       TESTRC=RTNREG;                                             0785
         LR    TESTRC,RTNREG                                       0785
*       RESPECIFY                                                  0786
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*       MNTSW=ON;                   /*                       @YD00175*/
         OI    MNTSW,B'00100000'                                   0787
*                                                                  0788
*       /*************************************************************/
*       /*                                                           */
*       /* TEST THE RETURN CODES FROM VOLUME                 @Y30LB33*/
*       /* SERVICES. A 4 IS A FAILURE, SO                    @Y30LB33*/
*       /* TERMINATE                                         @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0788
*       IF TESTRC=4 THEN                                           0788
         C     TESTRC,@CF00043                                     0788
         BNE   @RF00788                                            0788
*         DO;                       /*                       @Y30LB33*/
*           LASTCOND=TERMCODE;      /*                       @Y30LB33*/
*                                                                  0790
         L     @07,@PC00001+8                                      0790
         MVC   LASTCOND(2,@07),@CH00038                            0790
*           /*********************************************************/
*           /*                                                       */
*           /* ALSO DEQ ON THE RESERVE SINCE WE WILL NOT     @Y30LB33*/
*           /* GO ON TO DEMOUNT THE VOLUME BECAUSE OF        @Y30LB33*/
*           /* THE ERROR                                     @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0791
*           MINAMVOL=VOLVAL;        /*                       @ZA05119*/
         L     @07,@PC00001+4                                      0791
         L     @07,FDTPTR(,@07)                                    0791
         MVC   MINAMVOL(6),VOLVAL(@07)                             0791
*           MINAMLN=LENGTH(MVMINNAM)-1;/*                    @Y30LB33*/
         MVI   MINAMLN,X'16'                                       0792
*           MINAMQL=MINQLR;         /*                       @Y30LB33*/
         MVC   MINAMQL(16),@CC01589                                0793
*           CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*       @YM04300*/
         L     @07,@PC00001                                        0794
         ST    @07,@AL00001                                        0794
         LA    @02,MVMAJNAM                                        0794
         ST    @02,@AL00001+4                                      0794
         LA    @02,MVMINNAM                                        0794
         ST    @02,@AL00001+8                                      0794
         MVI   @AL00001+8,X'80'                                    0794
         L     @15,GDTDEQ(,@07)                                    0794
         LA    @01,@AL00001                                        0794
         BALR  @14,@15                                             0794
*         END;                      /*                       @Y30LB33*/
*                                                                  0795
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CODE IS 8, WE HAD TROUBLE                  @Y30LB33*/
*       /* CLOSING A DATA SET, SO SET LASTCOND               @Y30LB33*/
*       /* TO 4                                              @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0796
*       IF TESTRC=8 THEN            /*                       @YD00175*/
@RF00788 C     TESTRC,@CF00035                                     0796
         BNE   @RF00796                                            0796
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB33*/
*                                                                  0797
         L     @07,@PC00001+8                                      0797
         LH    @15,LASTCOND(,@07)                                  0797
         LA    @14,4                                               0797
         CR    @15,@14                                             0797
         BNL   *+6
         LR    @15,@14                                             0797
         STH   @15,LASTCOND(,@07)                                  0797
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE I/O POINTER FROM VOLUME                    @Y30LB33*/
*       /* SERVICES IS NOT ZERO, CLOSE VTOC                  @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0798
*       IF VSIOP^=0 THEN                                           0798
@RF00796 LA    @07,MVVS1AGL                                        0798
         L     @15,VSIOP(,@07)                                     0798
         LTR   @15,@15                                             0798
         BZ    @RF00798                                            0798
*         DO;                       /*                       @Y30LB33*/
*           CALL IDCIOCL0(GDTTBL,VSIOP);/*                   @Y30LB33*/
         L     @02,@PC00001                                        0800
         ST    @02,@AL00001                                        0800
         LA    @07,VSIOP(,@07)                                     0800
         ST    @07,@AL00001+4                                      0800
         MVI   @AL00001+4,X'80'                                    0800
         L     @15,GDTCLS(,@02)                                    0800
         LA    @01,@AL00001                                        0800
         BALR  @14,@15                                             0800
*           RESPECIFY                                              0801
*             RTNREG RSTD;                                         0801
*           TESTRC=RTNREG;                                         0802
         LR    TESTRC,RTNREG                                       0802
*           RESPECIFY                                              0803
*             RTNREG UNRSTD;        /*                       @Y30LB33*/
*                                                                  0803
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR A CLOSE ERROR                        @Y30LB33*/
*           /* AND SET LASTCOND TO 4 IF ONE                  @Y30LB33*/
*           /* OCCURRED                                      @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0804
*           IF TESTRC^=0 THEN                                      0804
         LTR   TESTRC,TESTRC                                       0804
         BZ    @RF00804                                            0804
*             LASTCOND=MAX(LASTCOND,LASTCC04);/*             @Y30LB33*/
         L     @07,@PC00001+8                                      0805
         LH    @15,LASTCOND(,@07)                                  0805
         LA    @14,4                                               0805
         CR    @15,@14                                             0805
         BNL   *+6
         LR    @15,@14                                             0805
         STH   @15,LASTCOND(,@07)                                  0805
*         END;                      /*                       @Y30LB33*/
@RF00804 DS    0H                                                  0807
*                                                                  0807
*       /*************************************************************/
*       /*                                                           */
*       /* TURN ON THE CHECK SWITCH TO INDICATE              @Y30LB33*/
*       /* THAT THE AUTHORIZATION CHECK WAS                  @Y30LB33*/
*       /* PERFORMED AND THAT A DEQUEUE IS                   @Y30LB33*/
*       /* IN ORDER. IT IS DONE IN CHNGMSC                   @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0807
*       CKSW=ON;                    /*                       @Y30LB33*/
@RF00798 OI    CKSW,B'01000000'                                    0807
*     END;                          /*                       @Y30LB33*/
*                                                                  0808
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0809
*   REG14=CKAUTHSV;                 /*                       @Y30LB33*/
@RF00773 L     REG14,CKAUTHSV                                      0809
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0810
@EL00010 DS    0H                                                  0810
@EF00010 DS    0H                                                  0810
@ER00010 BR    @14                                                 0810
*   END CKAUTH;                     /*                       @Y30LB33*/
*                                                                  0812
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - MODFYIT                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO MODIFY THE VOLUME RECORD AND THE           @Y30LB33*/
*/*      CARTRIDGE LABEL                                     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*            CHNGMSC                                       @Y30LB33*/
*/*            CHNGMSVC                                      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF THE MAXIMUM BACKUP NUMBER IS REDUCED BELOW THE   @Y30LB33*/
*/*      NUMBER OF BACK COPIES THAT EXIST FOR THE VOLUME     @Y30LB33*/
*/*      THEN THE MESSAGE IDC0068I IS PRINTED                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND THE           @Y30LB33*/
*/*      GROUP RECORD                                        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS SET BY THE CALLED ROUTINES          @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0812
*MODFYIT:                                                          0812
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0812
MODFYIT  DS    0H                                                  0813
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRES SAVE AREA                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0813
*   DCL                                                            0813
*     MODFYSV PTR(31);              /*                       @Y30LB33*/
*   MODFYSV=REG14;                  /*                       @Y30LB33*/
         ST    REG14,MODFYSV                                       0814
*   OLDERID2=NEWERID2;                                             0815
         L     @07,@PC00001                                        0815
         L     @07,GDTTR2(,@07)                                    0815
         MVC   @TS00001(95),NEWERID2(@07)                          0815
         MVC   OLDERID2(95,@07),@TS00001                           0815
*   NEWID2='MVGA';                  /*                       @YM02887*/
*                                                                  0816
         MVC   NEWID2(4,@07),@CC01710                              0816
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE CHANGING THE SOFTWARE LABEL OR THE          @Y30LB33*/
*   /* VOLUME ATTRIBUTES, CALL CHNGMSC TO                    @Y30LB33*/
*   /* MAKE THE MODIFICATION                                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0817
*   IF RENAMSW=ON×ATTRSW=ON×COPYATTR=ON×/*                   @Y30LB33*/
*       ONLYONLY=ON THEN                                           0817
         TM    RENAMSW,B'01100010'                                 0817
         BNZ   @RT00817                                            0817
         TM    ONLYONLY,B'10000000'                                0817
         BNO   @RF00817                                            0817
@RT00817 DS    0H                                                  0818
*     CALL CHNGMSC;                 /*                       @Y30LB33*/
*                                                                  0818
         BAL   @14,CHNGMSC                                         0818
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE, CALL CHNGMSVC TO CHANGE THE MSVC           @Y30LB33*/
*   /* RECORDS                                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0819
*   ELSE                                                           0819
*     CALL CHNGMSVC;                /*                       @Y30LB33*/
*                                                                  0819
         B     @RC00817                                            0819
@RF00817 BAL   @14,CHNGMSVC                                        0819
*   /*****************************************************************/
*   /*                                                               */
*   /* AND IF WE GET NO ERRORS, WE HAVE TO TELL              @Y30LB33*/
*   /* THE USER THAT HIS BACKUP MAXIMUM HAS BEEN             @Y30LB33*/
*   /* REDUCED BELOW THE NUMBER THAT EXIST, IF               @Y30LB33*/
*   /* THAT IS INDEED THE CASE                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0820
*   IF ADDR(BKUP)>0&LASTCOND^=TERMCODE/*                     @Y30LB33*/
*     THEN                                                         0820
@RC00817 L     @07,@PC00001+4                                      0820
         L     @07,FDTPTR+64(,@07)                                 0820
         LTR   @07,@07                                             0820
         BNP   @RF00820                                            0820
         L     @15,@PC00001+8                                      0820
         CLC   LASTCOND(2,@15),@CH00038                            0820
         BE    @RF00820                                            0820
*     DO;                           /*                       @Y30LB33*/
*       IF BKUPVAL<BASNBKUP THEN                                   0822
         L     @07,BKUPVAL(,@07)                                   0822
         SLR   @15,@15                                             0822
         IC    @15,BASNBKUP(,BASEVPTR)                             0822
         CR    @07,@15                                             0822
         BNL   @RF00822                                            0822
*         DO;                       /*                       @Y30LB33*/
*                                                                  0823
*           /*********************************************************/
*           /*                                                       */
*           /* CREATE THE NUMBER TO INSERT IN                @Y30LB33*/
*           /* THE MESSAGE                                   @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0824
*           MYBAKUP=BASNBKUP-BKUPVAL;/*                      @Y30LB33*/
*                                                                  0824
         SLR   @15,@07                                             0824
         STC   @15,MYBAKUP                                         0824
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP PRINT ARGUMENT LIST                    @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0825
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/
         L     @07,DDSTRU                                          0825
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0825
*           DARGSENT=MSG0068I;      /*                       @Y30LB33*/
         MVI   DARGSENT(@07),X'28'                                 0826
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@07),MODCMN                              0827
*           DARGILP=LENGTH(MYBAKUP);/*                       @Y30LB33*/
         MVC   DARGILP(2,@07),@CH00221                             0828
*           DARGDBP=ADDR(MYBAKUP);  /*                       @Y30LB33*/
*                                                                  0829
         LA    @15,MYBAKUP                                         0829
         ST    @15,DARGDBP(,@07)                                   0829
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE MESSAGE                             @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0830
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/
         L     @07,@PC00001                                        0830
         ST    @07,@AL00001                                        0830
         LA    @15,@CF00117                                        0830
         ST    @15,@AL00001+4                                      0830
         LA    @15,DDSTRU                                          0830
         ST    @15,@AL00001+8                                      0830
         MVI   @AL00001+8,X'80'                                    0830
         L     @15,GDTPRT(,@07)                                    0830
         LA    @01,@AL00001                                        0830
         BALR  @14,@15                                             0830
*         END;                      /*                       @Y30LB33*/
*     END;                          /*                       @Y30LB33*/
*                                                                  0832
@RF00822 DS    0H                                                  0833
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*   REG14=MODFYSV;                  /*                       @Y30LB33*/
@RF00820 L     REG14,MODFYSV                                       0833
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0834
@EL00011 DS    0H                                                  0834
@EF00011 DS    0H                                                  0834
@ER00011 BR    @14                                                 0834
*   END MODFYIT;                    /*                       @Y30LB33*/
*                                                                  0836
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - CHNGMSC                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO CHANGE THE VOLUME BY ISSUEING THE DEFINE   @Y30LB33*/
*/*      VOLUME COMMAND TO UPDATE THE MSC RECORDS AS WELL AS @Y30LB33*/
*/*      THE INVENTORY RECORD                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF MOUNTED, THE VOLUME IS DEMOUNTED.                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF NECESSARY, THE VOLUME IS CHECKED FOR EXCLUSIVE   @Y30LB33*/
*/*      USE                                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      USSC IS ISSUED TO CHANGE THE VOLUME, AND THE RETURN @Y30LB33*/
*/*      CODE IS TESTED                                      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC0064I IS ISSUED IF THE CHANGE IS         @Y30LB33*/
*/*      SUCCESSFUL.                                         @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      IF THE ATTRIBUTES WERE CHANGED TO AGREE WITH A      @Y30LB33*/
*/*      GROUP, MESSAGE IDC3073I IS ISSUED                   @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            BLDLIST                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, THE VOLUME RECORD AND THE GROUP      @Y30LB33*/
*/*      RECORD                                              @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - THE LASTCOND IS SET TO 4 IF THE CHANGE WAS      @Y30LB33*/
*/*      MADE BUT THE INVENTORY HAD AN I/O ERROR. IT IS      @Y30LB33*/
*/*      SET TO 12 IF THE CHANGE FAILED.                     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE INACTSW IN SWCHBITS IS TURNED ON IF THE         @Y30LB33*/
*/*      CHANGE MADE THE VOLUME INACTIVE                     @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0836
*CHNGMSC:                                                          0836
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0836
CHNGMSC  DS    0H                                                  0837
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*   DCL                                                            0837
*     CHNG1SV PTR(31);              /*                       @Y30LB33*/
*   CHNG1SV=REG14;                  /*                       @Y30LB33*/
         LR    CHNG1SV,REG14                                       0838
*   OLDERID2=NEWERID2;                                             0839
         L     @15,@PC00001                                        0839
         L     @14,GDTTR2(,@15)                                    0839
         MVC   @TS00001(95),NEWERID2(@14)                          0839
         MVC   OLDERID2(95,@14),@TS00001                           0839
*   NEWID2='MVHA';                  /*                       @YM02887*/
*                                                                  0840
         MVC   NEWID2(4,@14),@CC01717                              0840
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CHECK SWITCH IS ON, AN                         @ZA05125*/
*   /* AUTHORIZATION CHECK WAS MADE ON THE                   @ZA05125*/
*   /* VOLUME BY CKAUTH. SO WE MUST DEQUEUE                  @ZA05125*/
*   /* ON THE RESERVE THAT WAS DONE BY THE                   @ZA05125*/
*   /* VOLUME SERVICES ROUTINE                               @ZA05125*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*   IF CKSW=ON THEN                                                0841
         TM    CKSW,B'01000000'                                    0841
         BNO   @RF00841                                            0841
*     DO;                           /*                       @ZA05125*/
*       MINAMQL=MINQLR;             /*                       @ZA05125*/
         MVC   MINAMQL(16),@CC01589                                0843
*       MINAMVOL=VOLVAL;            /*                       @ZA05125*/
         L     @14,@PC00001+4                                      0844
         L     @01,FDTPTR(,@14)                                    0844
         MVC   MINAMVOL(6),VOLVAL(@01)                             0844
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @ZA05125*/
         ST    @15,@AL00001                                        0845
         LA    @14,MVMAJNAM                                        0845
         ST    @14,@AL00001+4                                      0845
         LA    @14,MVMINNAM                                        0845
         ST    @14,@AL00001+8                                      0845
         MVI   @AL00001+8,X'80'                                    0845
         L     @15,GDTDEQ(,@15)                                    0845
         LA    @01,@AL00001                                        0845
         BALR  @14,@15                                             0845
*     END;                          /*                       @ZA05125*/
*                                                                  0846
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FILE IS SPECIFIED OR THE VOLUME WAS            #Y30LB33*/
*   /* MOUNTED, THEN WE MUST DEMOUNT THE VOLUME BEFORE       @YD00175*/
*   /* WE ISSUE THE DEFINE VOLUME COMMAND                    @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0847
*   IF ADDR(FYLE)>NULLPTR×MNTSW=ON THEN                            0847
@RF00841 L     @15,@PC00001+4                                      0847
         L     @15,FDTPTR+88(,@15)                                 0847
         LTR   @15,@15                                             0847
         BP    @RT00847                                            0847
         TM    MNTSW,B'00100000'                                   0847
         BNO   @RF00847                                            0847
@RT00847 DS    0H                                                  0848
*     DO;                           /*                       @YD00175*/
*                                                                  0848
*       /*************************************************************/
*       /*                                                           */
*       /* FIRST MAKE UP THE ARGUMENT LIST FOR               @Y30LB33*/
*       /* DEMOUNTING                                        @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0849
*       MDAGL=MDAGL&&MDAGL;         /*                       @Y30LB33*/
         LA    @02,MVMDAGL                                         0849
         XC    MDAGL(37,@02),MDAGL(@02)                            0849
*       MDDDNAME=MVDDNAME;          /*                       @Y30LB33*/
         MVC   MDDDNAME(8,@02),MVDDNAME                            0850
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @Y30LB33*/
         LA    @15,MVUCBPTR                                        0851
         ST    @15,MDUCBPTR(,@02)                                  0851
*       MDLABEL=VOLVAL;             /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      0852
         L     @01,FDTPTR(,@15)                                    0852
         MVC   MDLABEL(6,@02),VOLVAL(@01)                          0852
*       MDWAIT=ON;                  /*                       @Y30LB33*/
*                                                                  0853
         OI    MDWAIT(@02),B'00010000'                             0853
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEMOUNT COMMAND                         @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0854
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB33*/
         L     @15,@PC00001                                        0854
         ST    @15,@AL00001                                        0854
         LA    @14,DEMOUNT                                         0854
         ST    @14,@AL00001+4                                      0854
         ST    @02,@AL00001+8                                      0854
         MVI   @AL00001+8,X'80'                                    0854
         L     @15,GDTUNT(,@15)                                    0854
         LA    @01,@AL00001                                        0854
         BALR  @14,@15                                             0854
*       RESPECIFY                                                  0855
*         RTNREG RSTD;                                             0855
*       TESTRC=RTNREG;                                             0856
         LR    TESTRC,RTNREG                                       0856
*       RESPECIFY                                                  0857
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*                                                                  0857
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEMOUNT FAILED, TERMINATE BY SETTING           @Y30LB33*/
*       /* TO 12                                             @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0858
*       IF TESTRC^=0 THEN           /*                       @Y30LB33*/
         LTR   TESTRC,TESTRC                                       0858
         BZ    @RF00858                                            0858
*         LASTCOND=TERMCODE;        /*                       @Y30LB33*/
*                                                                  0859
         L     @15,@PC00001+8                                      0859
         MVC   LASTCOND(2,@15),@CH00038                            0859
*       /*************************************************************/
*       /*                                                           */
*       /* OTHERWISE, INDICATE THE DEMOUNT IN THE            @YD00175*/
*       /* SWITCH SETTINGS                                   @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0860
*       ELSE                                                       0860
*         DO;                       /*                       @YD00175*/
         B     @RC00858                                            0860
@RF00858 DS    0H                                                  0861
*           MNTSW=OFF;              /*                       @YD00175*/
         NI    MNTSW,B'11011111'                                   0861
*           DMNTSW=ON;              /*                       @YD00175*/
         OI    DMNTSW,B'10000000'                                  0862
*         END;                      /*                       @YD00175*/
*     END;                          /*                       @Y30LB33*/
*                                                                  0864
@RC00858 DS    0H                                                  0865
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS OCCURRED SO FAR,                         @Y30LB33*/
*   /* CALL BLDLIST TO BUILD THE COMMAND                     @Y30LB33*/
*   /* ARGUMENT LIST AND BACKOUT LIST                        @Y30LB33*/
*   /* AND TAKE CARE OF ERRORS FROM THE                      @Y30LB33*/
*   /* COMMAND. IF IT GOES ALRIGHT, PRINT                    @Y30LB33*/
*   /* THE MESSAGE THAT INDICATES THAT ATTRIBUTES            @Y30LB33*/
*   /* WERE CHANGED IF THEY CHANGED TO AGREE                 @Y30LB33*/
*   /* WITH THE GROUP. IF WE GET ERRORS, JUST                @Y30LB33*/
*   /* TERMINATE THE RUN                                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0865
*   IF LASTCOND^=TERMCODE THEN                                     0865
@RF00847 L     @15,@PC00001+8                                      0865
         CLC   LASTCOND(2,@15),@CH00038                            0865
         BE    @RF00865                                            0865
*     DO;                           /*                       @Y30LB33*/
*       CALL BLDLIST;               /*                       @Y30LB33*/
*                                                                  0867
         BAL   @14,BLDLIST                                         0867
*       /*************************************************************/
*       /*                                                           */
*       /* AFTER BUILDING THE COMMAND                        @Y30LB33*/
*       /* ARGUMENT, ISSUE THE COMMAND                       @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0868
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     0868
*                                                            @Y30LB33*/
         L     @02,@PC00001                                        0868
         ST    @02,@AL00001                                        0868
         LA    @15,DEFINE                                          0868
         ST    @15,@AL00001+4                                      0868
         LA    @15,DEFVPTR                                         0868
         ST    @15,@AL00001+8                                      0868
         LA    @15,RCAREA                                          0868
         ST    @15,@AL00001+12                                     0868
         LA    @15,ECBBYTE                                         0868
         ST    @15,@AL00001+16                                     0868
         MVI   @AL00001+16,X'80'                                   0868
         L     @15,GDTSSC(,@02)                                    0868
         LA    @01,@AL00001                                        0868
         BALR  @14,@15                                             0868
*       RESPECIFY                                                  0869
*         RTNREG RSTD;                                             0869
*       TESTRC=RTNREG;                                             0870
         LR    TESTRC,RTNREG                                       0870
*       RESPECIFY                                                  0871
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*                                                                  0871
*       /*************************************************************/
*       /*                                                           */
*       /* NOW TEST THE RETURN CODES FROM THE                @Y30LB33*/
*       /* COMMAND. IF WE GET A 4, CALL SSCMSG               @Y30LB33*/
*       /* TO PRINT THE REASON MESSAGE AND SET               @Y30LB33*/
*       /* LASTCOND TO TERMINATE                             @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0872
*       IF TESTRC=4 THEN                                           0872
         C     TESTRC,@CF00043                                     0872
         BNE   @RF00872                                            0872
*         DO;                       /*                       @Y30LB33*/
*           CALL SSCMSG(RCAREA,ECBBYTE);/*                   @Y30LB33*/
         LA    @02,RCAREA                                          0874
         ST    @02,@AL00001                                        0874
         LA    @02,ECBBYTE                                         0874
         ST    @02,@AL00001+4                                      0874
         LA    @01,@AL00001                                        0874
         BAL   @14,SSCMSG                                          0874
*           LASTCOND=TERMCODE;      /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0875
         MVC   LASTCOND(2,@02),@CH00038                            0875
*         END;                      /*                       @Y30LB33*/
*                                                                  0876
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE GET AN 8, WE COULD NOT GET                  @Y30LB33*/
*       /* SPACE FOR THE COMMAND, AND IT FAILED              @Y30LB33*/
*       /* WITH A MESSAGE PRINTED                            @Y30LB33*/
*       /* SET LASTCOND TO 12                                @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0877
*       IF TESTRC=8 THEN                                           0877
@RF00872 C     TESTRC,@CF00035                                     0877
         BNE   @RF00877                                            0877
*         LASTCOND=TERMCODE;        /*                       @Y30LB33*/
         L     @02,@PC00001+8                                      0878
         MVC   LASTCOND(2,@02),@CH00038                            0878
*                                                                  0879
*       /*************************************************************/
*       /*                                                           */
*       /* SO THE COMMAND HAS BEEN EXECUTED                  @Y30LB33*/
*       /* SUCCESSFULLY AND WE MUST TELL THE                 @Y30LB33*/
*       /* USER. A RETURN CODE OF ZERO SAYS                  @Y30LB33*/
*       /* NOTHING WENT WRONG, AND A 12 INDICATES            @Y30LB33*/
*       /* THAT ONLY THE INVENTORY RECORD WAS                @Y30LB33*/
*       /* UPDATED                                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0879
*       IF TESTRC=0×TESTRC=12       /*                       @Y30LB33*/
*         THEN                                                     0879
@RF00877 LTR   TESTRC,TESTRC                                       0879
         BZ    @RT00879                                            0879
         C     TESTRC,@CF00038                                     0879
         BNE   @RF00879                                            0879
@RT00879 DS    0H                                                  0880
*         DO;                       /*                       @Y30LB33*/
*                                                                  0880
*           /*********************************************************/
*           /*                                                       */
*           /* IF PART OF THE LABEL UPDATE HAS NOW           @Y30LB33*/
*           /* BEEN DONE, ISSUE MESSAGE IDC0064I.            @Y30LB33*/
*           /* ISSUE ONE OF THE THREE VERSIONS BASED         @Y30LB33*/
*           /* ON WHAT PART OF THE LABEL WAS UPDATED         @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0881
*           IF RENAMSW=ON THEN                                     0881
         TM    RENAMSW,B'01000000'                                 0881
         BNO   @RF00881                                            0881
*             DO;                   /*                       @Y30LB33*/
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/
         L     @15,DDSTRU                                          0883
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0883
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/
*                                                                  0884
         MVC   DARGSMOD(3,@15),MODCMN                              0884
*               /*****************************************************/
*               /*                                                   */
*               /* SET TO PRINT OWNER-ONLY UPDATE            @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0885
*               DARGSENT=MSG0064B;  /*                       @Y30LB33*/
*                                                                  0885
         MVI   DARGSENT(@15),X'32'                                 0885
*               /*****************************************************/
*               /*                                                   */
*               /* IF NEW SERIAL, SET UP                     @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0886
*               IF ADDR(NEWSR)>NULLPTR THEN                        0886
         SLR   @15,@15                                             0886
         L     @14,@PC00001+4                                      0886
         C     @15,FDTPTR+4(,@14)                                  0886
         BNL   @RF00886                                            0886
*                 DO;               /*                       @Y30LB33*/
*                                                                  0887
*                   /*************************************************/
*                   /*                                               */
*                   /* IF OWNER ALSO, SET UP                 @Y30LB33*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0888
*                   IF ADDR(OWNER)>NULLPTR×ADDR(NOWN)>NULLPTR THEN 0888
         C     @15,FDTPTR+8(,@14)                                  0888
         BL    @RT00888                                            0888
         C     @15,FDTPTR+72(,@14)                                 0888
         BNL   @RF00888                                            0888
@RT00888 DS    0H                                                  0889
*                     DARGSENT=MSG0064C;/*                   @Y30LB33*/
         L     @01,DDSTRU                                          0889
         MVI   DARGSENT(@01),X'33'                                 0889
*                   ELSE                                           0890
*                     DARGSENT=MSG0064A;/*                   @Y30LB33*/
         B     @RC00888                                            0890
@RF00888 L     @01,DDSTRU                                          0890
         MVI   DARGSENT(@01),X'2E'                                 0890
*                 END;              /*                       @Y30LB33*/
*                                                                  0891
@RC00888 DS    0H                                                  0892
*               /*****************************************************/
*               /*                                                   */
*               /* PRINT CHANGE COMPLETION MESSAGE           @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0892
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/
@RF00886 L     @15,@PC00001                                        0892
         ST    @15,@AL00001                                        0892
         LA    @14,@CF00117                                        0892
         ST    @14,@AL00001+4                                      0892
         LA    @14,DDSTRU                                          0892
         ST    @14,@AL00001+8                                      0892
         MVI   @AL00001+8,X'80'                                    0892
         L     @15,GDTPRT(,@15)                                    0892
         LA    @01,@AL00001                                        0892
         BALR  @14,@15                                             0892
*                                                                  0893
*               /*****************************************************/
*               /*                                                   */
*               /* THE VOLUME HAS BEEN MADE INACTIVE,        @Y30LB33*/
*               /* SO TURN ON THE SWITCH THAT INDICATES      @Y30LB33*/
*               /* THAT CONDITION                            @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0893
*               INACTSW=ON;         /*                       @Y30LB33*/
         OI    INACTSW,B'00000100'                                 0893
*             END;                  /*                       @Y30LB33*/
*                                                                  0894
*           /*********************************************************/
*           /*                                                       */
*           /* ALSO, IF WE CHANGED THE ATTRIBUTES            @Y30LB33*/
*           /* WE MUST TELL THE USER THAT THEY WERE          @Y30LB33*/
*           /* CHANGED TO AGREE WITH THE GROUP,              @Y30LB33*/
*           /* SINCE HE DID NOT ASK FOR THEM TO              @Y30LB33*/
*           /* BE CHANGED WITH PARAMETERS                    @Y30LB33*/
*           /* GET THE GROUP NAME FROM THE GROUP             @Y30LB33*/
*           /* RECORD                                        @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0895
*           IF COPYATTR=ON×         /*                       @Y30LB33*/
*               (ONLYONLY=ON&RENAMSW=OFF)/*                  @Y30LB33*/
*             THEN                                                 0895
@RF00881 TM    COPYATTR,B'00000010'                                0895
         BO    @RT00895                                            0895
         TM    ONLYONLY,B'10000000'                                0895
         BNO   @RF00895                                            0895
         TM    RENAMSW,B'01000000'                                 0895
         BNZ   @RF00895                                            0895
@RT00895 DS    0H                                                  0896
*             DO;                   /*                       @Y30LB33*/
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/
         L     @15,DDSTRU                                          0897
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0897
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              0898
*               DARGSENT=MSG0073I;  /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'21'                                 0899
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00035                             0900
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/
         LA    @14,GROVVGRP(,GROUPPTR)                             0901
         ST    @14,DARGDBP(,@15)                                   0901
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/
         L     @15,@PC00001                                        0902
         ST    @15,@AL00001                                        0902
         LA    @14,@CF00117                                        0902
         ST    @14,@AL00001+4                                      0902
         LA    @14,DDSTRU                                          0902
         ST    @14,@AL00001+8                                      0902
         MVI   @AL00001+8,X'80'                                    0902
         L     @15,GDTPRT(,@15)                                    0902
         LA    @01,@AL00001                                        0902
         BALR  @14,@15                                             0902
*             END;                  /*                       @Y30LB33*/
*         END;                      /*                       @Y30LB33*/
@RF00895 DS    0H                                                  0905
*     END;                          /*                       @Y30LB33*/
*                                                                  0905
@RF00879 DS    0H                                                  0906
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0906
*   REG14=CHNG1SV;                  /*                       @Y30LB33*/
@RF00865 LR    REG14,CHNG1SV                                       0906
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0907
@EL00012 DS    0H                                                  0907
@EF00012 DS    0H                                                  0907
@ER00012 BR    @14                                                 0907
*   END CHNGMSC;                    /*                       @Y30LB33*/
*                                                                  0909
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - CHNGMSVC                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO UPDATE THE MSVC INVENTORY RECORD ONLY      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            BLDMVR                                        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND               @Y30LB33*/
*/*         THE GROUP RECORD                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS SET TO 4 TO INDICATE THAT AN        @Y30LB33*/
*/*      I/O ERROR OCCURRED IN THE INVENTORY. IT IS SET      @Y30LB33*/
*/*      TO 12 TO INDICATE THE FAILURE OF THE MODIFY VOLUME  @Y30LB33*/
*/*      RECORD COMMAND                                      @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0909
*CHNGMSVC:                                                         0909
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0909
CHNGMSVC DS    0H                                                  0910
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0910
*   DCL                                                            0910
*     CHNG2SV PTR(31);              /*                       @Y30LB33*/
*                                                                  0911
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE RETURN ADDRESS                                   @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0911
*   CHNG2SV=REG14;                  /*                       @Y30LB33*/
         LR    CHNG2SV,REG14                                       0911
*   OLDERID2=NEWERID2;                                             0912
         L     @15,@PC00001                                        0912
         L     @15,GDTTR2(,@15)                                    0912
         MVC   @TS00001(95),NEWERID2(@15)                          0912
         MVC   OLDERID2(95,@15),@TS00001                           0912
*   NEWID2='MVIA';                  /*                       @YM02887*/
*                                                                  0913
         MVC   NEWID2(4,@15),@CC01723                              0913
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE MODIFY VOLUME COMMAND LIST                  @Y30LB33*/
*   /* FOR AN MSVI UPDATE BY CALLING BLDMVR                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0914
*   CALL BLDMVR;                    /*                       @Y30LB33*/
*                                                                  0914
         BAL   @14,BLDMVR                                          0914
*   /*****************************************************************/
*   /*                                                               */
*   /* AND AFTER THE LIST IS BUILT, ISSUE                    @Y30LB33*/
*   /* THE COMMAND                                           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,RCAREA);/*              @Y30LB33*/
         L     @02,@PC00001                                        0915
         ST    @02,@AL00001                                        0915
         LA    @15,VVIC                                            0915
         ST    @15,@AL00001+4                                      0915
         LA    @15,MVRPTR                                          0915
         ST    @15,@AL00001+8                                      0915
         LA    @15,RCAREA                                          0915
         ST    @15,@AL00001+12                                     0915
         MVI   @AL00001+12,X'80'                                   0915
         L     @15,GDTSSC(,@02)                                    0915
         LA    @01,@AL00001                                        0915
         BALR  @14,@15                                             0915
*   RESPECIFY                                                      0916
*     RTNREG RSTD;                                                 0916
*   TESTRC=RTNREG;                                                 0917
         LR    TESTRC,RTNREG                                       0917
*   RESPECIFY                                                      0918
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*                                                                  0918
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR ERRORS FROM THE MODIFY                       @Y30LB33*/
*   /* COMMAND. IF WE GET A 4, CALL SSCMSG TO PRINT          @Y30LB33*/
*   /* THE REASON, AND SET LASTCOND TO 12                    @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0919
*   IF TESTRC=4 THEN                                               0919
         C     TESTRC,@CF00043                                     0919
         BNE   @RF00919                                            0919
*     DO;                           /*                       @Y30LB33*/
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/
         LA    @15,RCAREA                                          0921
         ST    @15,@AL00001                                        0921
         LA    @01,@AL00001                                        0921
         BAL   @14,SSCMSG                                          0921
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @15,@PC00001+8                                      0922
         MVC   LASTCOND(2,@15),@CH00038                            0922
*     END;                          /*                       @Y30LB33*/
*                                                                  0923
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE GET A 12 RETURN CODE, INDICATING                @Y30LB33*/
*   /* THAT IN I/O ERROR OCCURRED IN THE                     @Y30LB33*/
*   /* INVENTORY, THEN SET LASTCOND TO 4                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0924
*   ELSE                                                           0924
*     IF TESTRC=12 THEN             /*                       @Y30LB33*/
         B     @RC00919                                            0924
@RF00919 C     TESTRC,@CF00038                                     0924
         BNE   @RF00924                                            0924
*       LASTCOND=MAX(LASTCOND,LASTCC04);/*                   @Y30LB33*/
*                                                                  0925
         L     @15,@PC00001+8                                      0925
         LH    @14,LASTCOND(,@15)                                  0925
         LA    @03,4                                               0925
         CR    @14,@03                                             0925
         BNL   *+6
         LR    @14,@03                                             0925
         STH   @14,LASTCOND(,@15)                                  0925
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE RETURN ADDRESS                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0926
*   REG14=CHNG2SV;                  /*                       @Y30LB33*/
@RF00924 DS    0H                                                  0926
@RC00919 LR    REG14,CHNG2SV                                       0926
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0927
@EL00013 DS    0H                                                  0927
@EF00013 DS    0H                                                  0927
@ER00013 BR    @14                                                 0927
*   END CHNGMSVC;                   /*                       @Y30LB33*/
*                                                                  0929
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - LABELIT                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO CHANGE THE VOLUME SOFTWARE                 @Y30LB33*/
*/*         LABEL IF A NEW SERIAL IS REQUESTED               @Y30LB33*/
*/*         OR THE OWNER IS CHANGING. IF AN ERROR            @Y30LB33*/
*/*         OCCURS, THE CHANGE IS BACKED OUT                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            ACTVOL                                        @Y30LB33*/
*/*            ALLOVOL                                       @Y30LB33*/
*/*            BACKOUT                                       @Y30LB33*/
*/*            MNTVOL                                        @Y30LB33*/
*/*            NEWLABL                                       @Y30LB33*/
*/*            DMNTVOL                                       @Y30LB33*/
*/*            SETFLGS                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND               @Y30LB33*/
*/*         SWCHBITS                                         @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS SET TO 4 IF THE VOLUME              @Y30LB33*/
*/*          FAILED TO DEMOUNT, OR THE VTOC DID              @Y30LB33*/
*/*         NOT CLOSE PROPERLY, LASTCOND OF 8 IF             @Y30LB33*/
*/*         MODIFICATION WAS DONE BUT READ-ONLY              @Y30LB33*/
*/*         ATTRIBUTE WAS NOT SET BECAUSE OF AN ERROR        @Y30LB33*/
*/*         AND LASTCOND OF 12 IF THE MODIFICATION           @Y30LB33*/
*/*         FAILED COMPLETELY                                @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0929
*LABELIT:                                                          0929
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0929
LABELIT  DS    0H                                                  0930
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS STORE AREA                             @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*   DCL                                                            0930
*     LABELSV PTR(31);              /*                       @Y30LB33*/
*   LABELSV=REG14;                  /*                       @Y30LB33*/
         ST    REG14,LABELSV                                       0931
*   OLDERID2=NEWERID2;                                             0932
         L     @07,@PC00001                                        0932
         L     @07,GDTTR2(,@07)                                    0932
         MVC   @TS00001(95),NEWERID2(@07)                          0932
         MVC   OLDERID2(95,@07),@TS00001                           0932
*   NEWID2='MVJA';                  /*                       @ZA09560*/
*                                                                  0933
         MVC   NEWID2(4,@07),@CC01729                              0933
*   /*****************************************************************/
*   /*                                                               */
*   /* ACTIVATE THE VOLUME, SINCE IT WAS INACTIVE            @Y30LB33*/
*   /* AFTER THE PREVIOUS MODIFICATION REQUEST               @Y30LB33*/
*   /* DONE IN THE CHNGMSC ROUTINE                           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0934
*   CALL ACTVOL;                    /*                       @Y30LB33*/
*                                                                  0934
         BAL   @14,ACTVOL                                          0934
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS HAVE BEEN FOUND, AND THE USER HAS        @YD00175*/
*   /* NOT PROVIDED A FILE PARAMETER, AND THE SECURITY       @YD00175*/
*   /* CHECK WAS NOT PERFORMED, INDICATING THAT THE          @YD00175*/
*   /* UNIT HAS NOT YET BEEN ALLOCATED, CALL THE             @YD00175*/
*   /* ALLOVOL ROUTINE TO ALLOCATE A UNIT                    @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0935
*   IF LASTCOND<TERMCODE&CKSW=OFF&  /*                       @YD00175*/
*       ADDR(FYLE)=0 THEN                                          0935
         L     @07,@PC00001+8                                      0935
         LH    @07,LASTCOND(,@07)                                  0935
         C     @07,@CF00038                                        0935
         BNL   @RF00935                                            0935
         TM    CKSW,B'01000000'                                    0935
         BNZ   @RF00935                                            0935
         L     @07,@PC00001+4                                      0935
         L     @07,FDTPTR+88(,@07)                                 0935
         LTR   @07,@07                                             0935
         BNZ   @RF00935                                            0935
*     DO;                           /*                       @Y30LB33*/
*       CALL ALLOVOL(MVVOLUME);     /*                       @Y30LB33*/
*                                                                  0937
         LA    @07,MVVOLUME                                        0937
         ST    @07,@AL00001                                        0937
         LA    @01,@AL00001                                        0937
         BAL   @14,ALLOVOL                                         0937
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ALLOCATION FAILED, BACKOUT THE             @YD00175*/
*       /* PREVIOUS CHANGES BE CALLING THE                   @YD00175*/
*       /* BACKOUT ROUTINE                                   @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0938
*       IF LASTCOND=TERMCODE THEN                                  0938
         L     @07,@PC00001+8                                      0938
         CLC   LASTCOND(2,@07),@CH00038                            0938
         BNE   @RF00938                                            0938
*         CALL BACKOUT;             /*                       @Y30LB33*/
         BAL   @14,BACKOUT                                         0939
*     END;                          /*                       @Y30LB33*/
*                                                                  0940
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE THE UNIT IS ALREADY ALLOCATED AND           @Y30LB33*/
*   /* WE HAVE TO MOUNT THE VOLUME ON IT                     @Y30LB33*/
*   /* SO CALL THE MNTVOL ROUTINE                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0941
*   ELSE                                                           0941
*     IF LASTCOND<TERMCODE THEN                                    0941
         B     @RC00935                                            0941
@RF00935 L     @07,@PC00001+8                                      0941
         LH    @07,LASTCOND(,@07)                                  0941
         C     @07,@CF00038                                        0941
         BNL   @RF00941                                            0941
*       DO;                         /*                       @YD00175*/
*         CALL MNTVOL;              /*                       @YD00175*/
         BAL   @14,MNTVOL                                          0943
*         IF MNTSW=OFF THEN                                        0944
         TM    MNTSW,B'00100000'                                   0944
         BNZ   @RF00944                                            0944
*           DO;                     /*                       @YD00175*/
*             CALL BACKOUT;         /*                       @YD00175*/
         BAL   @14,BACKOUT                                         0946
*             LASTCOND=TERMCODE;    /*                       @YD00175*/
         L     @07,@PC00001+8                                      0947
         MVC   LASTCOND(2,@07),@CH00038                            0947
*           END;                    /*                       @YD00175*/
*       END;                        /*                       @YD00175*/
*                                                                  0949
@RF00944 DS    0H                                                  0950
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE HAVE SUCCESSFULLY ALLOCATED THE                 @Y30LB33*/
*   /* UNIT AND MOUNTED THE VOLUME, WE CAN                   @Y30LB33*/
*   /* CHANGE THE VOLUME LABEL                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0950
*   IF LASTCOND<TERMCODE THEN                                      0950
@RF00941 DS    0H                                                  0950
@RC00935 L     @07,@PC00001+8                                      0950
         LH    @07,LASTCOND(,@07)                                  0950
         C     @07,@CF00038                                        0950
         BNL   @RF00950                                            0950
*     CALL NEWLABL;                 /*                       @Y30LB33*/
*                                                                  0951
         BAL   @14,NEWLABL                                         0951
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS OCCURRED, CALL THE DMNTVOL ROUTINE       @Y30LB33*/
*   /* TO PRINT A MESSAGE, DEQUEUE ON THE                    @Y30LB33*/
*   /* RESERVE DONE BY VOLUME SERVICES, AND DEMOUNT          @Y30LB33*/
*   /* VOLUME. DEMOUNTING IS DONE ONLY IF                    @Y30LB33*/
*   /* WE MUST ISSUE ANOTHER COMMAND TO CHANGE               @Y30LB33*/
*   /* THE READONLY ATTRIBUTE AND THE MISMATCH               @Y30LB33*/
*   /* FLAG                                                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0952
*   IF LASTCOND<TERMCODE THEN                                      0952
@RF00950 L     @07,@PC00001+8                                      0952
         LH    @07,LASTCOND(,@07)                                  0952
         C     @07,@CF00038                                        0952
         BNL   @RF00952                                            0952
*     CALL DMNTVOL;                 /*                       @Y30LB33*/
*                                                                  0953
         BAL   @14,DMNTVOL                                         0953
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE DO NOT HAVE A TERMINATING                       @Y30LB33*/
*   /* ERROR AND THE MISMATCH FLAG HAS                       @Y30LB33*/
*   /* NOT BEEN CLEARED, AND WE HAVE                         @Y30LB33*/
*   /* CHANGED THE VOLUME SERIAL, THEN WE                    @Y30LB33*/
*   /* MUST TRY TO TURN OFF THE MISMATCH                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0954
*   IF LASTCOND<TERMCODE&           /*                       @Y30LB33*/
*       MISCLEAR=OFF&               /*                       @Y30LB33*/
*       ADDR(NEWSR)>0 THEN                                         0954
@RF00952 L     @15,@PC00001+8                                      0954
         LH    @15,LASTCOND(,@15)                                  0954
         C     @15,@CF00038                                        0954
         BNL   @RF00954                                            0954
         TM    MISCLEAR,B'00000001'                                0954
         BNZ   @RF00954                                            0954
         L     @15,@PC00001+4                                      0954
         L     @15,FDTPTR+4(,@15)                                  0954
         LTR   @15,@15                                             0954
         BNP   @RF00954                                            0954
*     CALL SETFLGS;                 /*                       @Y30LB33*/
*                                                                  0955
         BAL   @14,SETFLGS                                         0955
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0956
*   REG14=LABELSV;                  /*                       @Y30LB33*/
@RF00954 L     REG14,LABELSV                                       0956
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             0957
@EL00014 DS    0H                                                  0957
@EF00014 DS    0H                                                  0957
@ER00014 BR    @14                                                 0957
*   END LABELIT;                    /*                       @Y30LB33*/
*                                                                  0959
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - ACTVOL                                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO ACTIVATE THE VOLUME THAT IS TO BE          @Y30LB33*/
*/*      TO BE RELABELED. IF THE ACTIVATE FAILS, BACK OUT    @Y30LB33*/
*/*      THE CHANGES AND PRINT IDC2075I.                     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            BACKOUT                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC2075I IS ISSUED IF THE ACTIVATE FAILS    @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE VOLUME RECORD, THE FDTTBL, AND SWCHBITS      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS SET TO 4 IF THERE IS AN I/O         @Y30LB33*/
*/*      ERROR IN THE INVENTORY. LASTCOND IS SET TO 12       @Y30LB33*/
*/*      IF THE ACTIVATE FAILS                               @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      INACTSW IS SET OFF IF THE ACTIVATE RUNS             @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  0959
*ACTVOL:                                                           0959
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  0959
ACTVOL   DS    0H                                                  0960
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0960
*   DCL                                                            0960
*     ACTVOLSV PTR(31);             /*                       @Y30LB33*/
*   ACTVOLSV=REG14;                 /*                       @Y30LB33*/
         LR    ACTVOLSV,REG14                                      0961
*   OLDERID2=NEWERID2;                                             0962
         L     @15,@PC00001                                        0962
         L     @14,GDTTR2(,@15)                                    0962
         MVC   @TS00001(95),NEWERID2(@14)                          0962
         MVC   OLDERID2(95,@14),@TS00001                           0962
*   NEWID2='MVNA';                  /*                       @Y30LB33*/
*                                                                  0963
         MVC   NEWID2(4,@14),@CC01738                              0963
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE ACTIVATE COMMAND ARGUMENT LIST              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0964
*   DEFLIST=DEFLIST&&DEFLIST;       /*                       @Y30LB33*/
         L     @14,DEFVPTR                                         0964
         XC    DEFLIST(132,@14),DEFLIST(@14)                       0964
*   DEFVACT=ON;                     /*                       @Y30LB33*/
         OI    DEFVACT(@14),B'00000010'                            0965
*   DEFVCSN1=BASCSN1;               /*                       @Y30LB33*/
*                                                                  0966
         MVC   DEFVCSN1(12,@14),BASCSN1(BASEVPTR)                  0966
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP THE ACTIVATE ARGUMENT LIST                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0967
*   IF GDTDBG=NULLPTR THEN                                         0967
         L     @15,GDTDBG(,@15)                                    0967
         LTR   @15,@15                                             0967
         BZ    @RT00967                                            0967
*     ;                                                            0968
*   ELSE                                                           0969
*     DO;                                                          0969
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   0970
*       DMPITMNM='DEFLIST';                                        0971
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0971
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       0971
*       DMPITMPT=ADDR(DEFLIST);                                    0972
         L     @03,DEFVPTR                                         0972
         ST    @03,DMPITMPT(,DMPINDEX)                             0972
*       DMPITMLN=LENGTH(DEFLIST);                                  0973
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       0973
*       DMPITMTP='H';                                              0974
         MVI   DMPITMTP(DMPINDEX),C'H'                             0974
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0975
*                                                                  0975
         AL    DMPINDEX,@CF00507                                   0975
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0976
*       DMPTRM=DMPTRMVL;                                           0976
         MVI   DMPTRM(DMPINDEX),X'FF'                              0976
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         0978
@RT00967 L     @15,@PC00001                                        0978
         L     @15,GDTDBG(,@15)                                    0978
         LTR   @15,@15                                             0978
         BZ    @RT00978                                            0978
*     ;                                                            0979
*   ELSE                                                           0980
*     CALL IDCDB010(GDTTBL,'MVNB',DUMPADDR);/*               @Y30LB33*/
*                                                                  0980
         L     @15,@PC00001                                        0980
         ST    @15,@AL00001                                        0980
         LA    @14,@CC01740                                        0980
         ST    @14,@AL00001+4                                      0980
         LA    @14,DUMPADDR                                        0980
         ST    @14,@AL00001+8                                      0980
         MVI   @AL00001+8,X'80'                                    0980
         L     @15,GDTDBG(,@15)                                    0980
         LA    @01,@AL00001                                        0980
         BALR  @14,@15                                             0980
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO ACTIVATE                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0981
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*   @Y30LB33*/
@RT00978 L     @02,@PC00001                                        0981
         ST    @02,@AL00001                                        0981
         LA    @15,DEFINE                                          0981
         ST    @15,@AL00001+4                                      0981
         LA    @15,DEFVPTR                                         0981
         ST    @15,@AL00001+8                                      0981
         LA    @15,RCAREA                                          0981
         ST    @15,@AL00001+12                                     0981
         LA    @15,ECBBYTE                                         0981
         ST    @15,@AL00001+16                                     0981
         MVI   @AL00001+16,X'80'                                   0981
         L     @15,GDTSSC(,@02)                                    0981
         LA    @01,@AL00001                                        0981
         BALR  @14,@15                                             0981
*   RESPECIFY                                                      0982
*     RTNREG RSTD;                                                 0982
*   TESTRC=RTNREG;                                                 0983
         LR    TESTRC,RTNREG                                       0983
*   RESPECIFY                                                      0984
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*                                                                  0985
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE WAS AN I/O ERROR IN THE INVENTORY,           @Y30LB33*/
*   /* SET THE LASTCOND TO 4                                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0985
*   IF TESTRC=12 THEN               /*                       @Y30LB33*/
         C     TESTRC,@CF00038                                     0985
         BNE   @RF00985                                            0985
*     LASTCOND=MAX(LASTCOND,LASTCC04);/*                     @Y30LB33*/
*                                                                  0986
         L     @02,@PC00001+8                                      0986
         LH    @15,LASTCOND(,@02)                                  0986
         LA    @14,4                                               0986
         CR    @15,@14                                             0986
         BNL   *+6
         LR    @15,@14                                             0986
         STH   @15,LASTCOND(,@02)                                  0986
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE GOT AN ERROR, WE MUST ALSO TELL THE USER        @Y30LB33*/
*   /* THAT WE COULD NOT ACTIVATE THE VOLUME TO CHANGE       @Y30LB33*/
*   /* THE LABEL BY ISSUING IDC2075I                         @Y30LB33*/
*   /* THEN CALL BACKOUT TO RESTORE THE VOLUME               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0987
*   IF TESTRC=4×TESTRC=8 THEN                                      0987
@RF00985 C     TESTRC,@CF00043                                     0987
         BE    @RT00987                                            0987
         C     TESTRC,@CF00035                                     0987
         BNE   @RF00987                                            0987
@RT00987 DS    0H                                                  0988
*     DO;                           /*                       @Y30LB33*/
*       IF TESTRC=4 THEN            /*                       @Y30LB33*/
         C     TESTRC,@CF00043                                     0989
         BNE   @RF00989                                            0989
*         CALL SSCMSG(RCAREA,ECBBYTE);/*                     @Y30LB33*/
         LA    @02,RCAREA                                          0990
         ST    @02,@AL00001                                        0990
         LA    @02,ECBBYTE                                         0990
         ST    @02,@AL00001+4                                      0990
         LA    @01,@AL00001                                        0990
         BAL   @14,SSCMSG                                          0990
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
@RF00989 L     @02,DDSTRU                                          0991
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0991
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@02),MODCMN                              0992
*       DARGSENT=MSG2075I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@02),X'1F'                                 0993
*       DARGILP=LENGTH(MVVOLUME);   /*                       @Y30LB33*/
         MVC   DARGILP(2,@02),@CH00159                             0994
*       DARGDBP=ADDR(MVVOLUME);     /*                       @Y30LB33*/
         LA    @15,MVVOLUME                                        0995
         ST    @15,DARGDBP(,@02)                                   0995
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
*                                                                  0996
         L     @02,@PC00001                                        0996
         ST    @02,@AL00001                                        0996
         LA    @15,@CF00117                                        0996
         ST    @15,@AL00001+4                                      0996
         LA    @15,DDSTRU                                          0996
         ST    @15,@AL00001+8                                      0996
         MVI   @AL00001+8,X'80'                                    0996
         L     @15,GDTPRT(,@02)                                    0996
         LA    @01,@AL00001                                        0996
         BALR  @14,@15                                             0996
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE LASTCOND TO 12                            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0997
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
*                                                                  0997
         L     @02,@PC00001+8                                      0997
         MVC   LASTCOND(2,@02),@CH00038                            0997
*       /*************************************************************/
*       /*                                                           */
*       /* THEN RESTORE THE VOLUME                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0998
*       CALL BACKOUT;               /*                       @Y30LB33*/
         BAL   @14,BACKOUT                                         0998
*     END;                          /*                       @Y30LB33*/
*                                                                  0999
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERRORS OCCURRED, TURN OFF THE INACTIVE          @Y30LB33*/
*   /* SWITCH IN SWCHBITS                                    @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1000
*   ELSE                                                           1000
*     INACTSW=OFF;                  /*                       @Y30LB33*/
*                                                                  1000
         B     @RC00987                                            1000
@RF00987 NI    INACTSW,B'11111011'                                 1000
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1001
*   REG14=ACTVOLSV;                 /*                       @Y30LB33*/
@RC00987 LR    REG14,ACTVOLSV                                      1001
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1002
@EL00015 DS    0H                                                  1002
@EF00015 DS    0H                                                  1002
@ER00015 BR    @14                                                 1002
*   END ACTVOL;                     /*                       @Y30LB33*/
*                                                                  1004
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - ALLOVOL                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO ALLOCATE A UNIT AND MOUNT THE              @Y30LB33*/
*/*      VOLUME TO BE RELABELED, AND OBTAIN THE ALLOCATED    @YD00175*/
*/*      UNIT FOR EXCLUSIVE USE                              @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, THE VOLUME RECORD, AND SWCHBITS      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND OF 12 FOR AN ALLOCATION FAILURE        @Y30LB33*/
*/*      OR A NON-EXCLUSIVE VOLUME                           @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1004
*ALLOVOL:                                                          1004
*   PROCEDURE(VOLARG) OPTIONS(NOSAVE,NOSAVEAREA);/*          @Y30LB33*/
*                                                                  1004
ALLOVOL  MVC   @PC00016(4),0(@01)                                  1004
*   /*****************************************************************/
*   /*                                                               */
*   /* INPUT VOLUME SERIAL TO BE ALLOCATED                   @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1005
*   DCL                                                            1005
*     VOLARG CHAR(6);               /*                       @Y30LB33*/
*                                                                  1005
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1006
*   DCL                                                            1006
*     ALLOVSV PTR(31);              /*                       @Y30LB33*/
*   ALLOVSV=REG14;                  /*                       @Y30LB33*/
         LR    ALLOVSV,REG14                                       1007
*   OLDERID2=NEWERID2;                                             1008
         L     @02,@PC00001                                        1008
         L     @15,GDTTR2(,@02)                                    1008
         MVC   @TS00001(95),NEWERID2(@15)                          1008
         MVC   OLDERID2(95,@15),@TS00001                           1008
*   NEWID2='MVOA';                  /*                       @Y30LB33*/
*                                                                  1009
         MVC   NEWID2(4,@15),@CC01747                              1009
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT WITH SELECTX TO DETERMINE              @YD00175*/
*   /* IF THE VOLUME IS ALREADY AVAILABLE FOR                @YD00175*/
*   /* EXCLUSIVE USE                                         @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1010
*   EXCLAGL=EXCLAGL&&EXCLAGL;       /*                       @YD00175*/
         LA    @15,MVEXAGL                                         1010
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        1010
*   EXCLUCBP=ADDR(MVUCBPTR);        /*                       @YD00175*/
         LA    @14,MVUCBPTR                                        1011
         ST    @14,EXCLUCBP(,@15)                                  1011
*   EXCLDDP=ADDR(MVDDNAME);         /*                       @YD00175*/
         LA    @14,MVDDNAME                                        1012
         ST    @14,EXCLDDP(,@15)                                   1012
*   EXCLVOL=VOLARG;                 /*                       @YD00175*/
         L     @14,@PC00016                                        1013
         MVC   EXCLVOL(6,@15),VOLARG(@14)                          1013
*   CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*                 @YD00175*/
         ST    @02,@AL00001                                        1014
         LA    @14,SELECTX                                         1014
         ST    @14,@AL00001+4                                      1014
         ST    @15,@AL00001+8                                      1014
         MVI   @AL00001+8,X'80'                                    1014
         L     @15,GDTUNT(,@02)                                    1014
         LA    @01,@AL00001                                        1014
         BALR  @14,@15                                             1014
*   RESPECIFY                                                      1015
*     RTNREG RSTD;                                                 1015
*   TESTRC=RTNREG;                                                 1016
         LR    TESTRC,RTNREG                                       1016
*   RESPECIFY                                                      1017
*     RTNREG UNRSTD;                /*                       @YD00175*/
*                                                                  1017
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SELECTX FAILED, TERMINATE THE RUN              @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1018
*   IF TESTRC>0 THEN                                               1018
         LTR   TESTRC,TESTRC                                       1018
         BNP   @RF01018                                            1018
*     LASTCOND=TERMCODE;            /*                       @YD00175*/
         L     @02,@PC00001+8                                      1019
         MVC   LASTCOND(2,@02),@CH00038                            1019
*   ELSE                                                           1020
*     DO;                           /*                       @YD00175*/
*                                                                  1020
         B     @RC01018                                            1020
@RF01018 DS    0H                                                  1021
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE HAVE NO UCB POINTER, DYNAMICALLY            @YD00175*/
*       /* ALLOCATE THE UNIT AND VOLUME                      @YD00175*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1021
*       IF MVUCBPTR=0 THEN                                         1021
         L     @02,MVUCBPTR                                        1021
         LTR   @02,@02                                             1021
         BNZ   @RF01021                                            1021
*         DO;                       /*                       @YD00175*/
*                                                                  1022
*           /*********************************************************/
*           /*                                                       */
*           /* BUILD THE ALLOCATION ARGUMENT LIST            @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1023
*           ALLAGL=ALLAGL&&ALLAGL;  /*                       @Y30LB33*/
         LA    @02,MVALLAGL                                        1023
         XC    ALLAGL(31,@02),ALLAGL(@02)                          1023
*           MVALLUNO=1;             /*                       @Y30LB33*/
         LA    @02,1                                               1024
         STH   @02,MVALLUNO                                        1024
*           MVALLULN=LENGTH(MVUNIT);/*                       @Y30LB33*/
         MVC   MVALLULN(2),@CH00297                                1025
*           MVALLUNT=MVUNIT;        /*                       @Y30LB33*/
         MVI   MVALLUNT+5,C' '                                     1026
         MVC   MVALLUNT+6(2),MVALLUNT+5                            1026
         MVC   MVALLUNT(5),@CC01570                                1026
*           ALLULP=ADDR(MVALLUNO);  /*                       @Y30LB33*/
         LA    @15,MVALLAGL                                        1027
         LA    @14,MVALLUNO                                        1027
         ST    @14,ALLULP(,@15)                                    1027
*           MVALLVNO=1;             /*                       @Y30LB33*/
         STH   @02,MVALLVNO                                        1028
*           MVALLVLN=LENGTH(VOLARG);/*                       @Y30LB33*/
         MVC   MVALLVLN(2),@CH00159                                1029
*           MVALLVOL=VOLARG;        /*                       @Y30LB33*/
         L     @02,@PC00016                                        1030
         MVC   MVALLVOL(6),VOLARG(@02)                             1030
*           ALLVLP=ADDR(MVALLVNO);  /*                       @Y30LB33*/
         LA    @02,MVALLVNO                                        1031
         ST    @02,ALLVLP(,@15)                                    1031
*           ALLOPTVL=ON;            /*                       @Y30LB33*/
         OI    ALLOPTVL(@15),B'10000000'                           1032
*           ALLVLCNT=1;             /*                       @YD00175*/
         MVI   ALLVLCNT(@15),X'01'                                 1033
*           ALLUNCNT=1;             /*                       @Y30LB33*/
         MVI   ALLUNCNT(@15),X'01'                                 1034
*           ALLOPTPV=ON;            /*                       @Y30LB33*/
         OI    ALLOPTPV(@15),B'00100000'                           1035
*                                                                  1036
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UALLOC TO ALLOCATE AND MOUNT            @Y30LB33*/
*           /* THE VOLUME PRIOR TO RE-LABELLING              @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1036
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Y30LB33*/
         L     @02,@PC00001                                        1036
         ST    @02,@AL00001                                        1036
         ST    @15,@AL00001+4                                      1036
         MVI   @AL00001+4,X'80'                                    1036
         L     @15,GDTALC(,@02)                                    1036
         LA    @01,@AL00001                                        1036
         BALR  @14,@15                                             1036
*           RESPECIFY                                              1037
*             RTNREG RSTD;                                         1037
*           TESTRC=RTNREG;                                         1038
         LR    TESTRC,RTNREG                                       1038
*           RESPECIFY                                              1039
*             RTNREG UNRSTD;        /*                       @Y30LB33*/
*                                                                  1039
*           /*********************************************************/
*           /*                                                       */
*           /* IF ALLOCATE FAILS, SET THE LASTCOND TO        @Y30LB33*/
*           /* TERMINATE THE RUN                             @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1040
*           IF TESTRC=4 THEN                                       1040
         C     TESTRC,@CF00043                                     1040
         BNE   @RF01040                                            1040
*             LASTCOND=TERMCODE;    /*                       @Y30LB33*/
*                                                                  1041
         L     @02,@PC00001+8                                      1041
         MVC   LASTCOND(2,@02),@CH00038                            1041
*           /*********************************************************/
*           /*                                                       */
*           /* IF ALLOCATE RUNS OK, TURN ON THE              @Y30LB33*/
*           /* MOUNT SWITCH                                  @YD00175*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1042
*           ELSE                                                   1042
*             DO;                   /*                       @Y30LB33*/
         B     @RC01040                                            1042
@RF01040 DS    0H                                                  1043
*               MNTSW=ON;           /*                       @YD00175*/
         OI    MNTSW,B'00100000'                                   1043
*               MVDDNAME=ALLDDN;    /*                       @Y30LB33*/
*                                                                  1044
         LA    @02,MVALLAGL                                        1044
         MVC   MVDDNAME(8),ALLDDN(@02)                             1044
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP CHANGEX ARGUMENT LIST              @YD00175*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1045
*               EXCLAGL=EXCLAGL&&EXCLAGL;/*                  @YD00175*/
         LA    @02,MVEXAGL                                         1045
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        1045
*               EXCLUCBP=ADDR(MVUCBPTR);/*                   @YD00175*/
         LA    @15,MVUCBPTR                                        1046
         ST    @15,EXCLUCBP(,@02)                                  1046
*               EXCLDDP=ADDR(MVDDNAME);/*                    @YD00175*/
         LA    @15,MVDDNAME                                        1047
         ST    @15,EXCLDDP(,@02)                                   1047
*               EXCLVOL=VOLARG;     /*                       @YD00175*/
*                                                                  1048
         L     @15,@PC00016                                        1048
         MVC   EXCLVOL(6,@02),VOLARG(@15)                          1048
*               /*****************************************************/
*               /*                                                   */
*               /* ISSUE UMSSUNIT TO CHANGE THE UNIT         @YD00175*/
*               /* TO EXCLUSIVE CONTROL                      @YD00175*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1049
*               CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*     @YD00175*/
         L     @15,@PC00001                                        1049
         ST    @15,@AL00001                                        1049
         LA    @14,CHANGEX                                         1049
         ST    @14,@AL00001+4                                      1049
         ST    @02,@AL00001+8                                      1049
         MVI   @AL00001+8,X'80'                                    1049
         L     @15,GDTUNT(,@15)                                    1049
         LA    @01,@AL00001                                        1049
         BALR  @14,@15                                             1049
*               RESPECIFY                                          1050
*                 RTNREG RSTD;                                     1050
*               TESTRC=RTNREG;                                     1051
         LR    TESTRC,RTNREG                                       1051
*               RESPECIFY                                          1052
*                 RTNREG UNRSTD;    /*                       @Y30LB33*/
*                                                                  1052
*               /*****************************************************/
*               /*                                                   */
*               /* TEST THE RETURN CODE. IF AN               @YD00175*/
*               /* ERROR WAS FOUND, WE MUST BACKOUT          @Y30LB33*/
*               /* THE CHANGES MADE. SET THE CONDITION CODE  @Y30LB33*/
*               /* TO TERMINATE                              @YD00175*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1053
*               IF TESTRC>0 THEN    /*                       @YD00175*/
         LTR   TESTRC,TESTRC                                       1053
         BNP   @RF01053                                            1053
*                 LASTCOND=TERMCODE;/*                       @Y30LB33*/
         L     @02,@PC00001+8                                      1054
         MVC   LASTCOND(2,@02),@CH00038                            1054
*             END;                  /*                       @Y30LB33*/
@RF01053 DS    0H                                                  1056
*         END;                      /*                       @YD00175*/
@RC01040 DS    0H                                                  1057
*     END;                          /*                       @Y30LB33*/
*                                                                  1057
@RF01021 DS    0H                                                  1058
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1058
*   REG14=ALLOVSV;                  /*                       @Y30LB33*/
@RC01018 LR    REG14,ALLOVSV                                       1058
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1059
@EL00016 DS    0H                                                  1059
@EF00016 DS    0H                                                  1059
@ER00016 BR    @14                                                 1059
*   END ALLOVOL;                    /*                       @Y30LB33*/
*                                                                  1061
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - MNTVOL                                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO MOUNT THE VOLUME PRIOR TO BEING            @Y30LB33*/
*/*      RELABELED. IF MOUNT FAILS, BACK OUT THE CHANGES     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            BACKOUT                                       @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL AND THE VOLUME RECORD                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - MOUNT SWITCH ON IF MOUNT SUCCESSFUL             @YD00175*/
*/********************************************************   @Y30LB33*/
*                                                                  1061
*MNTVOL:                                                           1061
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1061
MNTVOL   DS    0H                                                  1062
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1062
*   DCL                                                            1062
*     MNTVOLSV PTR(31);             /*                       @Y30LB33*/
*   MNTVOLSV=REG14;                 /*                       @Y30LB33*/
         LR    MNTVOLSV,REG14                                      1063
*   OLDERID2=NEWERID2;                                             1064
         L     @15,@PC00001                                        1064
         L     @15,GDTTR2(,@15)                                    1064
         MVC   @TS00001(95),NEWERID2(@15)                          1064
         MVC   OLDERID2(95,@15),@TS00001                           1064
*   NEWID2='MVPA';                  /*                       @Y30LB33*/
*                                                                  1065
         MVC   NEWID2(4,@15),@CC01752                              1065
*   /*****************************************************************/
*   /*                                                               */
*   /* CREATE THE MOUNT ARGUMENT LIST                        @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1066
*   MDAGL=MDAGL&&MDAGL;             /*                       @Y30LB33*/
         LA    @15,MVMDAGL                                         1066
         XC    MDAGL(37,@15),MDAGL(@15)                            1066
*   MDDDNAME=MVDDNAME;              /*                       @Y30LB33*/
         MVC   MDDDNAME(8,@15),MVDDNAME                            1067
*   MDUCBPTR=ADDR(MVUCBPTR);        /*                       @Y30LB33*/
         LA    @14,MVUCBPTR                                        1068
         ST    @14,MDUCBPTR(,@15)                                  1068
*   MDLABEL=MVVOLUME;               /*                       @Y30LB33*/
*                                                                  1069
         MVC   MDLABEL(6,@15),MVVOLUME                             1069
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR REBUILD THE LABEL. IF SO, THE LABEL         @ZDR2057*/
*   /* CAN BE UNREADABLE. THEREFORE THE VTOC SHOULD          @ZDR2057*/
*   /* NOT BE READ AND IS SUPPLIED BY THE USER.              @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1070
*   IF ADDR(RLBL)^=NULLPTR THEN                                    1070
         L     @14,@PC00001+4                                      1070
         L     @14,FDTPTR+100(,@14)                                1070
         LTR   @14,@14                                             1070
         BZ    @RF01070                                            1070
*     DO;                           /*                       @ZDR2057*/
*       MDVTOCTR=ON;                /*                       @ZDR2057*/
*       MDNEWVOL=ON;                /*                       @ZDR2057*/
         OI    MDVTOCTR(@15),B'10000001'                           1073
*       MDVTOC=TEMPVAL;             /*                       @ZDR2057*/
         MVC   MDVTOC(5,@15),TEMPVAL                               1074
*     END;                          /*                       @ZDR2057*/
*                                                                  1075
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT TO MOUNT THE VOLUME PRIOR              #Y30LB33*/
*   /* TO RE-LABELLING                                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1076
*   CALL IDCSA060(GDTTBL,MOUNT,MDAGL);/*                     @Y30LB33*/
@RF01070 L     @02,@PC00001                                        1076
         ST    @02,@AL00001                                        1076
         LA    @15,MOUNT                                           1076
         ST    @15,@AL00001+4                                      1076
         LA    @15,MVMDAGL                                         1076
         ST    @15,@AL00001+8                                      1076
         MVI   @AL00001+8,X'80'                                    1076
         L     @15,GDTUNT(,@02)                                    1076
         LA    @01,@AL00001                                        1076
         BALR  @14,@15                                             1076
*   RESPECIFY                                                      1077
*     RTNREG RSTD;                                                 1077
*   TESTRC=RTNREG;                                                 1078
         LR    TESTRC,RTNREG                                       1078
*   RESPECIFY                                                      1079
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*                                                                  1080
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MOUNT GOOD, TURN ON MOUNT SWITCH                   @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1080
*   IF TESTRC=0 THEN                                               1080
         LTR   TESTRC,TESTRC                                       1080
         BNZ   @RF01080                                            1080
*     MNTSW=ON;                     /*                       @YD00175*/
*                                                                  1081
         OI    MNTSW,B'00100000'                                   1081
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1082
*   REG14=MNTVOLSV;                 /*                       @Y30LB33*/
@RF01080 LR    REG14,MNTVOLSV                                      1082
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1083
@EL00017 DS    0H                                                  1083
@EF00017 DS    0H                                                  1083
@ER00017 BR    @14                                                 1083
*   END MNTVOL;                     /*                       @Y30LB33*/
*                                                                  1085
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - NEWLABL                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO WRITE A NEW SOFTWARE LABEL ON THE  VOLUME  @Y30LB33*/
*/*      AND BACKOUT THE CHANGES IF IT FAILS                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      THE FOLLOWING ROUTINES ARE CALLED                   @Y30LB33*/
*/*            BACKOUT                                       @Y30LB33*/
*/*                                                  @Y30LB33        */
*/* INPUT - THE FDTTBL                               @Y30LB33        */
*/*                                                  @Y30LB33        */
*/* OUTPUT - LASTCOND IS SET TO 4 IF THE VTOC IS NOT         @Y30LB33*/
*/*      CLOSED PROPERLY. IT IS SET TO 8 IF DEMOUNTING FAILS @Y30LB33*/
*/*      AND SET TO 12 IF RELABELING FAILS                   @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1085
*NEWLABL:                                                          1085
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1085
NEWLABL  DS    0H                                                  1086
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1086
*   DCL                                                            1086
*     NEWLABSV PTR(31);             /*                       @Y30LB33*/
*   NEWLABSV=REG14;                 /*                       @Y30LB33*/
         ST    REG14,NEWLABSV                                      1087
*   OLDERID2=NEWERID2;                                             1088
         L     @07,@PC00001                                        1088
         L     @07,GDTTR2(,@07)                                    1088
         MVC   @TS00001(95),NEWERID2(@07)                          1088
         MVC   OLDERID2(95,@07),@TS00001                           1088
*   NEWID2='MVQA';                  /*                       @Y30LB33*/
*                                                                  1089
         MVC   NEWID2(4,@07),@CC01757                              1089
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD THE RELABELING ARGUMENT LIST                    @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1090
*   VS2AGL=VS2AGL&&VS2AGL;          /*                       @Y30LB33*/
         LA    @07,MVVS2AGL                                        1090
         XC    VS2AGL(52,@07),VS2AGL(@07)                          1090
*   VSDDNAME=MVDDNAME;              /*                       @Y30LB33*/
         MVC   VSDDNAME(8,@07),MVDDNAME                            1091
*   IF ADDR(NOWN)>0 THEN                                           1092
         L     @15,@PC00001+4                                      1092
         L     @15,FDTPTR+72(,@15)                                 1092
         LTR   @15,@15                                             1092
         BNP   @RF01092                                            1092
*     DO;                           /*                       @Y30LB33*/
*       VSOWNER=ON;                 /*                       @Y30LB33*/
         OI    VSOWNER(@07),B'10000000'                            1094
*       VSOWNPTR=ADDR(MVBLANKS);    /*                       @Y30LB33*/
         LA    @15,@CC01575                                        1095
         ST    @15,VSOWNPTR(,@07)                                  1095
*     END;                          /*                       @Y30LB33*/
*   IF ADDR(OWNER)>0 THEN                                          1097
@RF01092 L     @07,@PC00001+4                                      1097
         L     @07,FDTPTR+8(,@07)                                  1097
         LTR   @07,@07                                             1097
         BNP   @RF01097                                            1097
*     DO;                           /*                       @Y30LB33*/
*       VSOWNER=ON;                 /*                       @Y30LB33*/
         LA    @15,MVVS2AGL                                        1099
         OI    VSOWNER(@15),B'10000000'                            1099
*       VSOWNPTR=ADDR(OWNERVAL);    /*                       @Y30LB33*/
         LA    @07,OWNERVAL(,@07)                                  1100
         ST    @07,VSOWNPTR(,@15)                                  1100
*     END;                          /*                       @Y30LB33*/
*   IF ADDR(NEWSR)>0 THEN                                          1102
@RF01097 L     @07,@PC00001+4                                      1102
         L     @07,FDTPTR+4(,@07)                                  1102
         LTR   @07,@07                                             1102
         BNP   @RF01102                                            1102
*     DO;                           /*                       @Y30LB33*/
*       VSVOLSER=ON;                /*                       @Y30LB33*/
         LA    @15,MVVS2AGL                                        1104
         OI    VSVOLSER(@15),B'01000000'                           1104
*       VSVOLPTR=ADDR(NEWSRVAL);    /*                       @Y30LB33*/
         LA    @07,NEWSRVAL(,@07)                                  1105
         ST    @07,VSVOLPTR(,@15)                                  1105
*     END;                          /*                       @Y30LB33*/
*                                                                  1106
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR REBUILD OF A VOLUME LABEL                   @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1107
*   IF ADDR(VADDR)^=NULLPTR THEN                                   1107
@RF01102 L     @07,@PC00001+4                                      1107
         L     @15,FDTPTR+104(,@07)                                1107
         LTR   @15,@15                                             1107
         BZ    @RF01107                                            1107
*     DO;                           /*                       @ZDR2057*/
*       VSNOVTOC=ON;                /*                       @ZDR2057*/
         LA    @15,MVVS2AGL                                        1109
         OI    VSNOVTOC(@15),B'00100000'                           1109
*       VSVTOCPT=ADDR(TEMPVAL);     /*                       @ZDR2057*/
         LA    @14,TEMPVAL                                         1110
         ST    @14,VSVTOCPT(,@15)                                  1110
*       VSVOLPTR=ADDR(VOLVAL);      /*                       @ZDR2057*/
         L     @07,FDTPTR(,@07)                                    1111
         LA    @07,VOLVAL(,@07)                                    1111
         ST    @07,VSVOLPTR(,@15)                                  1111
*       VSOWNPTR=ADDR(BASOWNER);    /*                       @ZDR2057*/
         LA    @07,BASOWNER(,BASEVPTR)                             1112
         ST    @07,VSOWNPTR(,@15)                                  1112
*       VSIOBKPT=ADDR(IOCTLBKP);    /*                       @ZDR2057*/
         LA    @07,IOCTLBKP                                        1113
         ST    @07,VSIOBKPT(,@15)                                  1113
*     END;                          /*                       @ZDR2057*/
*   VSVOLUME=MVVOLUME;              /*                       @Y30LB33*/
@RF01107 LA    @07,MVVS2AGL                                        1115
         MVC   VSVOLUME(6,@07),MVVOLUME                            1115
*   VS2RES=ON;                      /*                       @Y30LB33*/
         OI    VS2RES(@07),B'10000000'                             1116
*   VSUCBPTR=ADDR(MVUCBPTR);        /*                       @Y30LB33*/
         LA    @15,MVUCBPTR                                        1117
         ST    @15,VSUCBPTR(,@07)                                  1117
*                                                                  1118
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VOLUME SERVICES TO REBUILD THE VOLUME LABEL      @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1118
*   IF ADDR(RLBL)^=NULLPTR THEN                                    1118
         L     @15,@PC00001+4                                      1118
         L     @15,FDTPTR+100(,@15)                                1118
         LTR   @15,@15                                             1118
         BZ    @RF01118                                            1118
*     CALL IDCSACL0(GDTTBL,'IDCVS02 ',INITVOL,VS2AGL);/*     @ZDR2057*/
         L     @15,@PC00001                                        1119
         ST    @15,@AL00001                                        1119
         LA    @14,@CC01758                                        1119
         ST    @14,@AL00001+4                                      1119
         LA    @14,INITVOL                                         1119
         ST    @14,@AL00001+8                                      1119
         ST    @07,@AL00001+12                                     1119
         MVI   @AL00001+12,X'80'                                   1119
         L     @15,GDTCAL(,@15)                                    1119
         LA    @01,@AL00001                                        1119
         BALR  @14,@15                                             1119
*   ELSE                                                           1120
*                                                                  1120
*     /***************************************************************/
*     /*                                                             */
*     /* CALL VOLUME SERVICES TO CHANGE THE                  @Y30LB33*/
*     /* VOLUME LABEL. INDICATE THE VOLUME                   @YD00175*/
*     /* IS MOUNTED.                                         @YD00175*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1120
*     CALL IDCSACL0(GDTTBL,'IDCVS02 ',PUTLABEL,VS2AGL);/*    @Y30LB33*/
         B     @RC01118                                            1120
@RF01118 L     @07,@PC00001                                        1120
         ST    @07,@AL00001                                        1120
         LA    @15,@CC01758                                        1120
         ST    @15,@AL00001+4                                      1120
         LA    @15,PUTLABEL                                        1120
         ST    @15,@AL00001+8                                      1120
         LA    @15,MVVS2AGL                                        1120
         ST    @15,@AL00001+12                                     1120
         MVI   @AL00001+12,X'80'                                   1120
         L     @15,GDTCAL(,@07)                                    1120
         LA    @01,@AL00001                                        1120
         BALR  @14,@15                                             1120
*   RESPECIFY                                                      1121
*     RTNREG RSTD;                                                 1121
@RC01118 DS    0H                                                  1122
*   TESTRC=RTNREG;                                                 1122
         LR    TESTRC,RTNREG                                       1122
*   RESPECIFY                                                      1123
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*   MNTSW=ON;                       /*                       @YD00175*/
         OI    MNTSW,B'00100000'                                   1124
*                                                                  1125
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LABELING FAILS, SET TERMINATING CODE,              @Y30LB33*/
*   /* DEQUEUE ON THE RESERVE DONE BY VOLUME                 @Y30LB33*/
*   /* SERVICES AND BACKOUT CHANGES                          @YD00175*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*   IF TESTRC=4 THEN                                               1125
         C     TESTRC,@CF00043                                     1125
         BNE   @RF01125                                            1125
*     DO;                           /*                       @Y30LB33*/
*       LASTCOND=TERMCODE;          /*                       @Y30LB33*/
         L     @07,@PC00001+8                                      1127
         MVC   LASTCOND(2,@07),@CH00038                            1127
*       MINAMLN=LENGTH(MVMINNAM)-1; /*                       @Y30LB33*/
         MVI   MINAMLN,X'16'                                       1128
*       MINAMVOL=MVVOLUME;          /*                       @Y30LB33*/
         MVC   MINAMVOL(6),MVVOLUME                                1129
*       MINAMQL=MINQLR;             /*                       @Y30LB33*/
*                                                                  1130
         MVC   MINAMQL(16),@CC01589                                1130
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEQUEUE ON THE RESERVE                  @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1131
*       CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*           @Y30LB33*/
         L     @07,@PC00001                                        1131
         ST    @07,@AL00001                                        1131
         LA    @02,MVMAJNAM                                        1131
         ST    @02,@AL00001+4                                      1131
         LA    @02,MVMINNAM                                        1131
         ST    @02,@AL00001+8                                      1131
         MVI   @AL00001+8,X'80'                                    1131
         L     @15,GDTDEQ(,@07)                                    1131
         LA    @01,@AL00001                                        1131
         BALR  @14,@15                                             1131
*       CALL BACKOUT;               /*                       @YD00175*/
         BAL   @14,BACKOUT                                         1132
*     END;                          /*                       @Y30LB33*/
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LABEL WAS CHANGED BUT THE VTOC FAILED              @Y30LB33*/
*   /* TO CLOSE, SET LASTCOND TO 4                           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1134
*   ELSE                                                           1134
*     DO;                           /*                       @Y30LB33*/
         B     @RC01125                                            1134
@RF01125 DS    0H                                                  1135
*       IF TESTRC=8 THEN            /*                       @Y30LB33*/
         C     TESTRC,@CF00035                                     1135
         BNE   @RF01135                                            1135
*         LASTCOND=MAX(LASTCOND,LASTCC04);/*                 @Y30LB33*/
         L     @07,@PC00001+8                                      1136
         LH    @04,LASTCOND(,@07)                                  1136
         LA    @15,4                                               1136
         CR    @04,@15                                             1136
         BNL   *+6
         LR    @04,@15                                             1136
         STH   @04,LASTCOND(,@07)                                  1136
*     END;                          /*                       @Y30LB33*/
*                                                                  1137
@RF01135 DS    0H                                                  1138
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1138
*   REG14=NEWLABSV;                 /*                       @Y30LB33*/
@RC01125 L     REG14,NEWLABSV                                      1138
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1139
@EL00018 DS    0H                                                  1139
@EF00018 DS    0H                                                  1139
@ER00018 BR    @14                                                 1139
*   END NEWLABL;                    /*                       @Y30LB33*/
*                                                                  1141
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - DMNTVOL                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO PRINT THE MESSAGE INDICATING THAT THE      @Y30LB33*/
*/*      VOLUME LABEL WAS CHANGED, TO DEQUEUE                @Y30LB33*/
*/*      ON THE RESERVE DONE IN NEWLABL BY VOLUME SERVICES,  @Y30LB33*/
*/*      AND TO SET THE READONLY FLAG ON IF REQUESTED AND    @Y30LB33*/
*/*      SET THE MISMATCH OFF AND DEMOUNT THE VOLUME WHEN    @Y30LB33*/
*/*      FLAGS MUST BE CHANGED.                              @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC0086I IS ISSUED WHEN THE VOLUME LABEL    @Y30LB33*/
*/*      WAS CHANGED                                         @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC2091I OR IDC2093I IS ISSUED WHEN THE     @Y30LB33*/
*/*      DEFINE VOLUME COMMAND FAILS TO SET READONLY OR      @Y30LB33*/
*/*      TURN OFF THE MISMATCH, OR IF THE VOLUME FAILS       @Y30LB33*/
*/*      TO DEMOUNT                                          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3073I IS ISSUED IF THE READONLY FLAG IS  @Y30LB33*/
*/*      CHANGED TO AGREE WITH THE GROUP                     @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, SWCHBITS                             @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND IS 4 IF AN I/O ERROR OCCURRED IN THE   @Y30LB33*/
*/*      INVENTORY AND 8 IF READONLY FAILED TO BE SET        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      TRYMIS SWITCH IS TURNED ON IF THE LABEL MISMATCH    @Y30LB33*/
*/*      FLAG FAILED TO BE TURNED OFF                        @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1141
*DMNTVOL:                                                          1141
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1141
DMNTVOL  DS    0H                                                  1142
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1142
*   DCL                                                            1142
*     DMNTVSV PTR(31);              /*                       @Y30LB33*/
*   DMNTVSV=REG14;                  /*                       @Y30LB33*/
         LR    DMNTVSV,REG14                                       1143
*   OLDERID2=NEWERID2;                                             1144
         L     @07,@PC00001                                        1144
         L     @07,GDTTR2(,@07)                                    1144
         MVC   @TS00001(95),NEWERID2(@07)                          1144
         MVC   OLDERID2(95,@07),@TS00001                           1144
*   NEWID2='MVRA';                  /*                       @YM02887*/
*                                                                  1145
         MVC   NEWID2(4,@07),@CC01763                              1145
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT MESSAGE IDC0086I, DEQUEUE ON THE                @Y30LB33*/
*   /* RESERVE DONE BY VOLUME SERVICES, AND DEMOUNT          @Y30LB33*/
*   /* VOLUME. DEMOUNTING IS DONE ONLY IF                    @Y30LB33*/
*   /* WE MUST ISSUE ANOTHER COMMAND TO CHANGE               @Y30LB33*/
*   /* THE READONLY ATTRIBUTE AND THE MISMATCH               @Y30LB33*/
*   /* FLAG                                                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   DARGLIST=DARGLIST&&DARGLIST;    /*                       @Y30LB33*/
         L     @07,DDSTRU                                          1146
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1146
*   DARGSMOD=MODCMN;                /*                       @Y30LB33*/
*                                                                  1147
         MVC   DARGSMOD(3,@07),MODCMN                              1147
*   /*****************************************************************/
*   /*                                                               */
*   /* TELL THE USER THAT THE LABEL WAS CHANGED              @Y30LB33*/
*   /* BY PRINTING IDC0086I. SET UP TO INDICATE THAT         @Y30LB33*/
*   /* ONLY THE OWNER WAS CHANGED                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1148
*   DARGSENT=MSG0086B;              /*                       @Y30LB33*/
*                                                                  1148
         MVI   DARGSENT(@07),X'0D'                                 1148
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SERIAL WAS CHANGED, SET UP TO INDICATE         @Y30LB33*/
*   /* THAT EITHER ONLY THE SERIAL CHANGED OR BOTH           @Y30LB33*/
*   /* OWNER AND SERIAL CHANGED                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1149
*   IF ADDR(NEWSR)>NULLPTR THEN     /*                       @Y30LB33*/
         SLR   @07,@07                                             1149
         L     @15,@PC00001+4                                      1149
         C     @07,FDTPTR+4(,@15)                                  1149
         BNL   @RF01149                                            1149
*     IF ADDR(OWNER)>NULLPTR×       /*                       @Y30LB33*/
*         ADDR(NOWN)>NULLPTR THEN   /*                       @Y30LB33*/
         C     @07,FDTPTR+8(,@15)                                  1150
         BL    @RT01150                                            1150
         C     @07,FDTPTR+72(,@15)                                 1150
         BNL   @RF01150                                            1150
@RT01150 DS    0H                                                  1151
*       DARGSENT=MSG0086C;          /*                       @Y30LB33*/
         L     @07,DDSTRU                                          1151
         MVI   DARGSENT(@07),X'31'                                 1151
*     ELSE                                                         1152
*       DARGSENT=MSG0086A;          /*                       @Y30LB33*/
*                                                                  1152
         B     @RC01150                                            1152
@RF01150 L     @07,DDSTRU                                          1152
         MVI   DARGSENT(@07),X'14'                                 1152
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT THE MESSAGE                                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB33*/
*                                                                  1153
@RC01150 DS    0H                                                  1153
@RF01149 L     @07,@PC00001                                        1153
         ST    @07,@AL00001                                        1153
         LA    @15,@CF00117                                        1153
         ST    @15,@AL00001+4                                      1153
         LA    @15,DDSTRU                                          1153
         ST    @15,@AL00001+8                                      1153
         MVI   @AL00001+8,X'80'                                    1153
         L     @15,GDTPRT(,@07)                                    1153
         LA    @01,@AL00001                                        1153
         BALR  @14,@15                                             1153
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE DEQUEUE PARAMETERS                         @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1154
*   MINAMVOL=MVVOLUME;              /*                       @ZA05119*/
         MVC   MINAMVOL(6),MVVOLUME                                1154
*   MINAMQL=MINQLR;                 /*                       @Y30LB33*/
*                                                                  1155
         MVC   MINAMQL(16),@CC01589                                1155
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE DEQUEUE ON THE RESERVE                      @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1156
*   CALL IDCSADQ0(GDTTBL,MVMAJNAM,MVMINNAM);/*               @Y30LB33*/
         L     @07,@PC00001                                        1156
         ST    @07,@AL00001                                        1156
         LA    @15,MVMAJNAM                                        1156
         ST    @15,@AL00001+4                                      1156
         LA    @15,MVMINNAM                                        1156
         ST    @15,@AL00001+8                                      1156
         MVI   @AL00001+8,X'80'                                    1156
         L     @15,GDTDEQ(,@07)                                    1156
         LA    @01,@AL00001                                        1156
         BALR  @14,@15                                             1156
*                                                                  1157
*   /*****************************************************************/
*   /*                                                               */
*   /* WE MUST DEMOUNT THE VOLUME PRIOR TO                   @Y30LB33*/
*   /* CHANGING ATTRIBUTES. THIS MUST BE                     @Y30LB33*/
*   /* DONE NOW IN ORDER TO SET THE READONLY                 @Y30LB33*/
*   /* FLAG. WE HAVE TO SET THE READONLY FLAG                @Y30LB33*/
*   /* NOW IF READONLY WAS REQUESTED IN THE                  @Y30LB33*/
*   /* FDTTBL OR READONLY IS TO BE COPIED                    @Y30LB33*/
*   /* FROM THE GROUP                                        @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1157
*   IF ADDR(RONLY)>0×(NEWGENSW=ON&  /*                       @Y30LB33*/
*       GRORONLY=ON) THEN                                          1157
         L     @07,@PC00001+4                                      1157
         L     @07,FDTPTR+40(,@07)                                 1157
         LTR   @07,@07                                             1157
         BP    @RT01157                                            1157
         TM    NEWGENSW,B'00000100'                                1157
         BNO   @RF01157                                            1157
         TM    GRORONLY(GROUPPTR),B'00010000'                      1157
         BNO   @RF01157                                            1157
@RT01157 DS    0H                                                  1158
*     DO;                           /*                       @Y30LB33*/
*                                                                  1158
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP THE DEMOUNT LIST                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1159
*       MDAGL=MDAGL&&MDAGL;         /*                       @Y30LB33*/
         LA    @07,MVMDAGL                                         1159
         XC    MDAGL(37,@07),MDAGL(@07)                            1159
*       MDDDNAME=MVDDNAME;          /*                       @Y30LB33*/
         MVC   MDDDNAME(8,@07),MVDDNAME                            1160
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @Y30LB33*/
         LA    @02,MVUCBPTR                                        1161
         ST    @02,MDUCBPTR(,@07)                                  1161
*       MDLABEL=MVVOLUME;           /*                       @Y30LB33*/
         MVC   MDLABEL(6,@07),MVVOLUME                             1162
*       MDWAIT=ON;                  /*                       @Y30LB33*/
*                                                                  1163
         OI    MDWAIT(@07),B'00010000'                             1163
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEMOUNT                                 @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1164
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB33*/
         L     @02,@PC00001                                        1164
         ST    @02,@AL00001                                        1164
         LA    @15,DEMOUNT                                         1164
         ST    @15,@AL00001+4                                      1164
         ST    @07,@AL00001+8                                      1164
         MVI   @AL00001+8,X'80'                                    1164
         L     @15,GDTUNT(,@02)                                    1164
         LA    @01,@AL00001                                        1164
         BALR  @14,@15                                             1164
*       RESPECIFY                                                  1165
*         RTNREG RSTD;                                             1165
*       TESTRC=RTNREG;                                             1166
         LR    TESTRC,RTNREG                                       1166
*       RESPECIFY                                                  1167
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*                                                                  1168
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE READONLY ATTRIBUTE ON IF THE              @Y30LB33*/
*       /* DEMOUNT WAS SUCCESSFUL                            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1168
*       IF TESTRC=0 THEN                                           1168
         SLR   @07,@07                                             1168
         CR    TESTRC,@07                                          1168
         BNE   @RF01168                                            1168
*         DO;                       /*                       @Y30LB33*/
*           MNTSW=OFF;              /*                       @YD00175*/
         NI    MNTSW,B'11011111'                                   1170
*           DMNTSW=ON;              /*                       @YD00175*/
         OI    DMNTSW,B'10000000'                                  1171
*           DEFLIST=DEFLIST&&DEFLIST;/*                      @Y30LB33*/
         L     @15,DEFVPTR                                         1172
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1172
*           DEFVOLD=MVVOLUME;       /*                       @Y30LB33*/
         MVC   DEFVOLD(6,@15),MVVOLUME                             1173
*           DEFVVFLG=MYVVFLG;       /*                       @Y30LB33*/
         MVC   DEFVVFLG(1,@15),MYVVFLG                             1174
*           DEFVREP=ON;             /*                       @Y30LB33*/
         OI    DEFVREP(@15),B'00010000'                            1175
*           DEFVWINH=ON;            /*                       @Y30LB33*/
*                                                                  1176
         OI    DEFVWINH(@15),B'00000010'                           1176
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE SERIAL CHANGED, SET UP TO              @Y30LB33*/
*           /* TURN OFF LABEL MISMATCH                       @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1177
*           IF ADDR(NEWSR)>0 THEN                                  1177
         L     @14,@PC00001+4                                      1177
         C     @07,FDTPTR+4(,@14)                                  1177
         BNL   @RF01177                                            1177
*             DO;                   /*                       @Y30LB33*/
*               DEFLABEL=MVBLANKS;  /*                       @Y30LB33*/
         MVC   DEFLABEL(6,DEFVEPTR),@CC01575                       1179
*               DEFPVLAB=ON;        /*                       @Y30LB33*/
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1180
*               DEFVVEXT=DEFVEPTR;  /*                       @Y30LB33*/
         ST    DEFVEPTR,DEFVVEXT(,@15)                             1181
*               DEFVE=DEFVE&&DEFVE; /*                       @Y30LB33*/
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  1182
*               DEFLNGTH=DEFLEN;    /*                       @Y30LB33*/
         LH    @07,DEFLEN                                          1183
         ST    @07,DEFLNGTH(,DEFVEPTR)                             1183
*               DEFCRCVY=ON;        /*                       @Y30LB33*/
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1184
*               DEFLAMIS=ON;        /*                       @Y30LB33*/
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1185
*             END;                  /*                       @Y30LB33*/
*                                                                  1186
*           /*********************************************************/
*           /*                                                       */
*           /* DUMP THE PARAMETER LISTS                      @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1187
*           IF GDTDBG=NULLPTR THEN                                 1187
@RF01177 L     @07,@PC00001                                        1187
         L     @07,GDTDBG(,@07)                                    1187
         LTR   @07,@07                                             1187
         BZ    @RT01187                                            1187
*             ;                                                    1188
*           ELSE                                                   1189
*             DO;                                                  1189
*               DMPINDEX=ADDR(DUMPAREA);/*                   @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1190
*               DMPITMNM='DEFLIST';                                1191
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1191
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1191
*               DMPITMPT=ADDR(DEFLIST);                            1192
         L     @07,DEFVPTR                                         1192
         ST    @07,DMPITMPT(,DMPINDEX)                             1192
*               DMPITMLN=LENGTH(DEFLIST);                          1193
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       1193
*               DMPITMTP='H';                                      1194
         MVI   DMPITMTP(DMPINDEX),C'H'                             1194
*               DMPINDEX=DMPINDEX+DMPELEMT;                        1195
*                                                                  1195
         LA    @07,16                                              1195
         ALR   DMPINDEX,@07                                        1195
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1196
*               DMPITMNM='DEFVE';                                  1196
         MVI   DMPITMNM+5(DMPINDEX),C' '                           1196
         MVC   DMPITMNM+6(2,DMPINDEX),DMPITMNM+5(DMPINDEX)         1196
         MVC   DMPITMNM(5,DMPINDEX),@CC01764                       1196
*               DMPITMPT=ADDR(DEFVE);                              1197
         ST    DEFVEPTR,DMPITMPT(,DMPINDEX)                        1197
*               DMPITMLN=LENGTH(DEFVE);                            1198
         MVC   DMPITMLN(2,DMPINDEX),@CH01826                       1198
*               DMPITMTP='H';                                      1199
         MVI   DMPITMTP(DMPINDEX),C'H'                             1199
*               DMPINDEX=DMPINDEX+DMPELEMT;                        1200
*                                                                  1200
         ALR   DMPINDEX,@07                                        1200
*               /*****************************************************/
*               /*                                                   */
*               /*                                           @Y30LB33*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1201
*               DMPTRM=DMPTRMVL;                                   1201
         MVI   DMPTRM(DMPINDEX),X'FF'                              1201
*             END;                  /*                       @Y30LB33*/
*           IF GDTDBG=NULLPTR THEN                                 1203
@RT01187 L     @07,@PC00001                                        1203
         L     @07,GDTDBG(,@07)                                    1203
         LTR   @07,@07                                             1203
         BZ    @RT01203                                            1203
*             ;                                                    1204
*           ELSE                                                   1205
*             CALL IDCDB010(GDTTBL,'MVRC',DUMPADDR);/*       @YM02887*/
*                                                                  1205
         L     @07,@PC00001                                        1205
         ST    @07,@AL00001                                        1205
         LA    @05,@CC01765                                        1205
         ST    @05,@AL00001+4                                      1205
         LA    @05,DUMPADDR                                        1205
         ST    @05,@AL00001+8                                      1205
         MVI   @AL00001+8,X'80'                                    1205
         L     @15,GDTDBG(,@07)                                    1205
         LA    @01,@AL00001                                        1205
         BALR  @14,@15                                             1205
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE USSC TO SET READONLY                    @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1206
*           CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/* 1206
*                                                            @Y30LB33*/
@RT01203 L     @07,@PC00001                                        1206
         ST    @07,@AL00001                                        1206
         LA    @05,DEFINE                                          1206
         ST    @05,@AL00001+4                                      1206
         LA    @05,DEFVPTR                                         1206
         ST    @05,@AL00001+8                                      1206
         LA    @05,RCAREA                                          1206
         ST    @05,@AL00001+12                                     1206
         LA    @05,ECBBYTE                                         1206
         ST    @05,@AL00001+16                                     1206
         MVI   @AL00001+16,X'80'                                   1206
         L     @15,GDTSSC(,@07)                                    1206
         LA    @01,@AL00001                                        1206
         BALR  @14,@15                                             1206
*           RESPECIFY                                              1207
*             RTNREG RSTD;                                         1207
*           TESTRC=RTNREG;                                         1208
         LR    TESTRC,RTNREG                                       1208
*           RESPECIFY                                              1209
*             RTNREG UNRSTD;        /*                       @Y30LB33*/
*                                                                  1209
*           /*********************************************************/
*           /*                                                       */
*           /* IF WE HAVE AN ERROR, CALL SSCMSG TO           @Y30LB33*/
*           /* PRINT THE REASON                              @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1210
*           IF TESTRC=4 THEN        /*                       @Y30LB33*/
         C     TESTRC,@CF00043                                     1210
         BNE   @RF01210                                            1210
*             CALL SSCMSG(RCAREA);  /*                       @Y30LB33*/
         LA    @07,RCAREA                                          1211
         ST    @07,@AL00001                                        1211
         LA    @01,@AL00001                                        1211
         BAL   @14,SSCMSG                                          1211
*         END;                      /*                       @Y30LB33*/
*                                                                  1212
@RF01210 DS    0H                                                  1213
*       /*************************************************************/
*       /*                                                           */
*       /* IF A COMMAND HAD AN ERROR, SET LASTCOND           @Y30LB33*/
*       /* TO 8 AND PRINT IDC2091I TO INDICATE               @Y30LB33*/
*       /* THAT THE READONLY ATTRIBUTE WAS                   @Y30LB33*/
*       /* NOT SET                                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1213
*       IF TESTRC=4×TESTRC=8        /*                       @Y30LB33*/
*         THEN                                                     1213
@RF01168 C     TESTRC,@CF00043                                     1213
         BE    @RT01213                                            1213
         C     TESTRC,@CF00035                                     1213
         BNE   @RF01213                                            1213
@RT01213 DS    0H                                                  1214
*         DO;                       /*                       @Y30LB33*/
*           LASTCOND=MAX(LASTCOND,LASTCC08);/*               @Y30LB33*/
         L     @07,@PC00001+8                                      1215
         LA    @05,8                                               1215
         LH    @02,LASTCOND(,@07)                                  1215
         CR    @02,@05                                             1215
         BNL   *+6
         LR    @02,@05                                             1215
         STH   @02,LASTCOND(,@07)                                  1215
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/
         L     @07,DDSTRU                                          1216
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1216
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/
*                                                                  1217
         MVC   DARGSMOD(3,@07),MODCMN                              1217
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT IDC2093I IF READONLY IS THE             @Y30LB33*/
*           /* ONLY ATTRIBUTE COPIED FROM THE GROUP          @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1218
*           IF ONLYONLY=ON THEN                                    1218
         TM    ONLYONLY,B'10000000'                                1218
         BNO   @RF01218                                            1218
*             DO;                   /*                       @Y30LB33*/
*               DARGSENT=MSG2093I;  /*                       @Y30LB33*/
         MVI   DARGSENT(@07),X'36'                                 1220
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/
         STH   @05,DARGILP(,@07)                                   1221
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/
         LA    @05,GROVVGRP(,GROUPPTR)                             1222
         ST    @05,DARGDBP(,@07)                                   1222
*             END;                  /*                       @Y30LB33*/
*                                                                  1223
*           /*********************************************************/
*           /*                                                       */
*           /* OTHERWISE, PRINT IDC2091I                     @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1224
*           ELSE                                                   1224
*             DO;                   /*                       @Y30LB33*/
         B     @RC01218                                            1224
@RF01218 DS    0H                                                  1225
*               DARGSENT=MSG2091I;  /*                       @Y30LB33*/
         L     @07,DDSTRU                                          1225
         MVI   DARGSENT(@07),X'0F'                                 1225
*               DARGILP=LENGTH(MVVOLUME);/*                  @Y30LB33*/
         MVC   DARGILP(2,@07),@CH00159                             1226
*               DARGDBP=ADDR(MVVOLUME);/*                    @Y30LB33*/
         LA    @05,MVVOLUME                                        1227
         ST    @05,DARGDBP(,@07)                                   1227
*             END;                  /*                       @Y30LB33*/
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/
@RC01218 L     @07,@PC00001                                        1229
         ST    @07,@AL00001                                        1229
         LA    @05,@CF00117                                        1229
         ST    @05,@AL00001+4                                      1229
         LA    @05,DDSTRU                                          1229
         ST    @05,@AL00001+8                                      1229
         MVI   @AL00001+8,X'80'                                    1229
         L     @15,GDTPRT(,@07)                                    1229
         LA    @01,@AL00001                                        1229
         BALR  @14,@15                                             1229
*         END;                      /*                       @Y30LB33*/
*                                                                  1231
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE GOT NO ERRORS, TEST FOR AN                  @Y30LB33*/
*       /* INVENTORY I/O ERROR AND SET                       @Y30LB33*/
*       /* LASTCOND TO 4                                     @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1231
*       ELSE                                                       1231
*         IF TESTRC=12 THEN         /*                       @Y30LB33*/
         B     @RC01213                                            1231
@RF01213 C     TESTRC,@CF00038                                     1231
         BNE   @RF01231                                            1231
*           LASTCOND=MAX(LASTCOND,LASTCC04);/*               @Y30LB33*/
*                                                                  1232
         L     @07,@PC00001+8                                      1232
         LH    @05,LASTCOND(,@07)                                  1232
         LA    @02,4                                               1232
         CR    @05,@02                                             1232
         BNL   *+6
         LR    @05,@02                                             1232
         STH   @05,LASTCOND(,@07)                                  1232
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE GET NO ERRORS,                              @Y30LB33*/
*       /* TURN ON THE MISMATCH CLEAR SWITCH, AND IF         @Y30LB33*/
*       /* THE ONLYONLY SWITCH IS ON,                        @Y30LB33*/
*       /* INDICATING THE MESSAGE IDC0073I                   @Y30LB33*/
*       /* HAS NOT BEEN SENT YET,                            @Y30LB33*/
*       /* ISSUE MESSAGE IDC0073I TO INDICATE                @Y30LB33*/
*       /* THAT THE GROUP ATTRIBUTES WERE                    @Y30LB33*/
*       /* IMPOSED ON THE VOLUME,                            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1233
*       IF TESTRC=12×TESTRC=0 THEN                                 1233
@RF01231 DS    0H                                                  1233
@RC01213 C     TESTRC,@CF00038                                     1233
         BE    @RT01233                                            1233
         LTR   TESTRC,TESTRC                                       1233
         BNZ   @RF01233                                            1233
@RT01233 DS    0H                                                  1234
*         DO;                       /*                       @Y30LB33*/
*           MISCLEAR=ON;            /*                       @Y30LB33*/
         OI    MISCLEAR,B'00000001'                                1235
*           IF ONLYONLY=ON THEN                                    1236
         TM    ONLYONLY,B'10000000'                                1236
         BNO   @RF01236                                            1236
*             DO;                   /*                       @Y30LB33*/
*               DARGLIST=DARGLIST&&DARGLIST;/*               @Y30LB33*/
         L     @07,DDSTRU                                          1238
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1238
*               DARGSMOD=MODCMN;    /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@07),MODCMN                              1239
*               DARGSENT=MSG0073I;  /*                       @Y30LB33*/
         MVI   DARGSENT(@07),X'21'                                 1240
*               DARGILP=LENGTH(GROVVGRP);/*                  @Y30LB33*/
         MVC   DARGILP(2,@07),@CH00035                             1241
*               DARGDBP=ADDR(GROVVGRP);/*                    @Y30LB33*/
         LA    @05,GROVVGRP(,GROUPPTR)                             1242
         ST    @05,DARGDBP(,@07)                                   1242
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB33*/
         L     @05,@PC00001                                        1243
         ST    @05,@AL00001                                        1243
         LA    @15,@CF00117                                        1243
         ST    @15,@AL00001+4                                      1243
         LA    @15,DDSTRU                                          1243
         ST    @15,@AL00001+8                                      1243
         MVI   @AL00001+8,X'80'                                    1243
         L     @15,GDTPRT(,@05)                                    1243
         LA    @01,@AL00001                                        1243
         BALR  @14,@15                                             1243
*             END;                  /*                       @Y30LB33*/
*         END;                      /*                       @Y30LB33*/
@RF01236 DS    0H                                                  1246
*     END;                          /*                       @Y30LB33*/
*                                                                  1246
@RF01233 DS    0H                                                  1247
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1247
*   REG14=DMNTVSV;                  /*                       @Y30LB33*/
@RF01157 LR    REG14,DMNTVSV                                       1247
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1248
@EL00019 DS    0H                                                  1248
@EF00019 DS    0H                                                  1248
@ER00019 BR    @14                                                 1248
*   END DMNTVOL;                    /*                       @Y30LB33*/
*                                                                  1250
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - SETFLGS                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO TURN OFF THE LABEL MISMATCH                @Y30LB33*/
*/*      FLAG                                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC2065I IS ISSUED IF THE MISMATCH FLAG     @Y30LB33*/
*/*      UPDATE FAILS                                        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL AND SWCHBITS                          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - LASTCOND OF 8 IF LABEL MISMATCH UPDATE FAILS    @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1250
*SETFLGS:                                                          1250
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1250
SETFLGS  DS    0H                                                  1251
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1251
*   DCL                                                            1251
*     SETFLGSV PTR(31);             /*                       @Y30LB33*/
*   SETFLGSV=REG14;                 /*                       @Y30LB33*/
         LR    SETFLGSV,REG14                                      1252
*   OLDERID2=NEWERID2;                                             1253
         L     @05,@PC00001                                        1253
         L     @15,GDTTR2(,@05)                                    1253
         MVC   @TS00001(95),NEWERID2(@15)                          1253
         MVC   OLDERID2(95,@15),@TS00001                           1253
*   NEWID2='MVSA';                  /*                       @Y30LB33*/
*                                                                  1254
         MVC   NEWID2(4,@15),@CC01770                              1254
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD LIST TO TURN OFF                                @Y30LB33*/
*   /* MISMATCH                                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1255
*   MVR=MVR&&MVR;                   /*                       @Y30LB33*/
         L     @15,MVRPTR                                          1255
         XC    MVR(88,@15),MVR(@15)                                1255
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB33*/
         LH    @14,MVRLEN                                          1256
         ST    @14,MVRLNGTH(,@15)                                  1256
*   MVRCODE=MVROP;                  /*                       @Y30LB33*/
         XC    MVRCODE+1(3,@15),MVRCODE+1(@15)                     1257
         MVI   MVRCODE(@15),X'85'                                  1257
*   MVRBVOL=MVVOLUME;               /*                       @Y30LB33*/
         MVC   MVRBVOL(6,@15),MVVOLUME                             1258
*   MVRLABEL=MVBLANKS;              /*                       @Y30LB33*/
         MVC   MVRLABEL(6,@15),@CC01575                            1259
*   MVRFLLAB=ON;                    /*                       @Y30LB33*/
         OI    MVRFLLAB(@15),B'00000001'                           1260
*   MVRCLMIS=ON;                    /*                       @Y30LB33*/
*                                                                  1261
         OI    MVRCLMIS(@15),B'00000001'                           1261
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP THE ARGUMENT LIST                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1262
*   IF GDTDBG=NULLPTR THEN                                         1262
         L     @05,GDTDBG(,@05)                                    1262
         LTR   @05,@05                                             1262
         BZ    @RT01262                                            1262
*     ;                                                            1263
*   ELSE                                                           1264
*     DO;                                                          1264
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1265
*       DMPITMNM='MVR';                                            1266
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1266
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1266
         MVC   DMPITMNM(3,DMPINDEX),@CC01771                       1266
*       DMPITMPT=ADDR(MVR);                                        1267
         L     @05,MVRPTR                                          1267
         ST    @05,DMPITMPT(,DMPINDEX)                             1267
*       DMPITMLN=LENGTH(MVR);                                      1268
         MVC   DMPITMLN(2,DMPINDEX),@CH01823                       1268
*       DMPITMTP='H';                                              1269
         MVI   DMPITMTP(DMPINDEX),C'H'                             1269
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1270
*                                                                  1270
         AL    DMPINDEX,@CF00507                                   1270
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1271
*       DMPTRM=DMPTRMVL;                                           1271
         MVI   DMPTRM(DMPINDEX),X'FF'                              1271
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         1273
@RT01262 L     @05,@PC00001                                        1273
         L     @05,GDTDBG(,@05)                                    1273
         LTR   @05,@05                                             1273
         BZ    @RT01273                                            1273
*     ;                                                            1274
*   ELSE                                                           1275
*     CALL IDCDB010(GDTTBL,'MVSB',DUMPADDR);/*               @YM02887*/
*                                                                  1275
         L     @05,@PC00001                                        1275
         ST    @05,@AL00001                                        1275
         LA    @15,@CC01772                                        1275
         ST    @15,@AL00001+4                                      1275
         LA    @15,DUMPADDR                                        1275
         ST    @15,@AL00001+8                                      1275
         MVI   @AL00001+8,X'80'                                    1275
         L     @15,GDTDBG(,@05)                                    1275
         LA    @01,@AL00001                                        1275
         BALR  @14,@15                                             1275
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC TO CHANGE MISMATCH                         @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1276
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,RCAREA);/*              @Y30LB33*/
@RT01273 L     @05,@PC00001                                        1276
         ST    @05,@AL00001                                        1276
         LA    @02,VVIC                                            1276
         ST    @02,@AL00001+4                                      1276
         LA    @02,MVRPTR                                          1276
         ST    @02,@AL00001+8                                      1276
         LA    @02,RCAREA                                          1276
         ST    @02,@AL00001+12                                     1276
         MVI   @AL00001+12,X'80'                                   1276
         L     @15,GDTSSC(,@05)                                    1276
         LA    @01,@AL00001                                        1276
         BALR  @14,@15                                             1276
*   RESPECIFY                                                      1277
*     RTNREG RSTD;                                                 1277
*   TESTRC=RTNREG;                                                 1278
         LR    TESTRC,RTNREG                                       1278
*   RESPECIFY                                                      1279
*     RTNREG UNRSTD;                /*                       @Y30LB33*/
*                                                                  1279
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR AN ERROR TURNING OFF                         @Y30LB33*/
*   /* MISMATCH                                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1280
*   IF TESTRC^=0 THEN                                              1280
         LTR   TESTRC,TESTRC                                       1280
         BZ    @RF01280                                            1280
*     DO;                           /*                       @Y30LB33*/
*                                                                  1281
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SSCMSG TO PRINT THE FAILURE REASON           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1282
*       CALL SSCMSG(RCAREA);        /*                       @Y30LB33*/
*                                                                  1282
         LA    @05,RCAREA                                          1282
         ST    @05,@AL00001                                        1282
         LA    @01,@AL00001                                        1282
         BAL   @14,SSCMSG                                          1282
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT IDC2065I TO TELL                            @Y30LB33*/
*       /* USER MISMATCH RESET FAILED                        @Y30LB33*/
*       /* AND SET LASTCOND TO 8                             @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1283
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @05,DDSTRU                                          1283
         XC    DARGLIST(20,@05),DARGLIST(@05)                      1283
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@05),MODCMN                              1284
*       DARGSENT=MSG2065I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@05),X'2D'                                 1285
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @05,@PC00001                                        1286
         ST    @05,@AL00001                                        1286
         LA    @15,@CF00117                                        1286
         ST    @15,@AL00001+4                                      1286
         LA    @15,DDSTRU                                          1286
         ST    @15,@AL00001+8                                      1286
         MVI   @AL00001+8,X'80'                                    1286
         L     @15,GDTPRT(,@05)                                    1286
         LA    @01,@AL00001                                        1286
         BALR  @14,@15                                             1286
*       LASTCOND=LASTCC08;          /*                       @Y30LB33*/
         L     @05,@PC00001+8                                      1287
         MVC   LASTCOND(2,@05),@CH00035                            1287
*     END;                          /*                       @Y30LB33*/
*                                                                  1288
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1289
*   REG14=SETFLGSV;                 /*                       @Y30LB33*/
@RF01280 LR    REG14,SETFLGSV                                      1289
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1290
@EL00020 DS    0H                                                  1290
@EF00020 DS    0H                                                  1290
@ER00020 BR    @14                                                 1290
*   END SETFLGS;                    /*                       @Y30LB33*/
*                                                                  1292
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - BACKOUT                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - CHANGES THE VOLUME RECORD AND                 @Y30LB33*/
*/*    CARTRIDGE LABEL TO WHAT IT WAS BEFORE THE             @Y30LB33*/
*/*    MODIFICATION                                          @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC3062I IS ISSUED IF THE CARTRIDGE AND     @Y30LB33*/
*/*      RECORD ARE NOT RESTORED                             @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*      MESSAGE IDC0063I IS ISSUED IF THE BACKOUT RUNS      @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - DEFLIST, SWCHBITS, AND THE DEFLIST               @Y30LB33*/
*/*    EXTENSION                                             @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/
*/*      BACKFAIL IS TURNED IF THE BACKOUT FAILED            @Y30LB33*/
*/*      INACTSW IS TURNED ON WHEN THE DEFINE COMMAND RUNS,  @Y30LB33*/
*/*      AND IS TURNED OFF WHEN THE ACTIVATE COMMAND         @Y30LB33*/
*/*      RUNS                                                @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1292
*BACKOUT:                                                          1292
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1292
BACKOUT  DS    0H                                                  1293
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1293
*   DCL                                                            1293
*     BACKSV PTR(31);               /*                       @Y30LB33*/
*   BACKSV=REG14;                   /*                       @Y30LB33*/
         ST    REG14,BACKSV                                        1294
*   OLDERID2=NEWERID2;                                             1295
         L     @02,@PC00001                                        1295
         L     @15,GDTTR2(,@02)                                    1295
         MVC   @TS00001(95),NEWERID2(@15)                          1295
         MVC   OLDERID2(95,@15),@TS00001                           1295
*   NEWID2='MVTA';                  /*                       @Y30LB33*/
*                                                                  1296
         MVC   NEWID2(4,@15),@CC01777                              1296
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME IS MOUNTED AFTER BEING PROCESSED        @YM02888*/
*   /* IN ALLOVOL FOR EXCLUSIVE CONTROL, WE MUST             @YM02888*/
*   /* DEMOUNT IT BEFORE BACKING OUT THE CHANGES             @YM02888*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1297
*   IF MNTSW=ON THEN                                               1297
         TM    MNTSW,B'00100000'                                   1297
         BNO   @RF01297                                            1297
*     DO;                           /*                       @YM02888*/
*                                                                  1298
*       /*************************************************************/
*       /*                                                           */
*       /* CREATE THE DEMOUNT ARGUMENT LIST                  @YM02888*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1299
*       MDAGL=MDAGL&&MDAGL;         /*                       @YM02888*/
         LA    @15,MVMDAGL                                         1299
         XC    MDAGL(37,@15),MDAGL(@15)                            1299
*       MDDDNAME=MVDDNAME;          /*                       @YM02888*/
         MVC   MDDDNAME(8,@15),MVDDNAME                            1300
*       MDUCBPTR=ADDR(MVUCBPTR);    /*                       @YM02888*/
         LA    @14,MVUCBPTR                                        1301
         ST    @14,MDUCBPTR(,@15)                                  1301
*       MDLABEL=MVVOLUME;           /*                       @YM02888*/
         MVC   MDLABEL(6,@15),MVVOLUME                             1302
*       MDWAIT=ON;                  /*                       @YM02888*/
*                                                                  1303
         OI    MDWAIT(@15),B'00010000'                             1303
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEMOUNT                                 @YM02888*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1304
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @YM02888*/
         ST    @02,@AL00001                                        1304
         LA    @14,DEMOUNT                                         1304
         ST    @14,@AL00001+4                                      1304
         ST    @15,@AL00001+8                                      1304
         MVI   @AL00001+8,X'80'                                    1304
         L     @15,GDTUNT(,@02)                                    1304
         LA    @01,@AL00001                                        1304
         BALR  @14,@15                                             1304
*       RESPECIFY                                                  1305
*         RTNREG RSTD;                                             1305
*       TESTRC=RTNREG;                                             1306
         LR    TESTRC,RTNREG                                       1306
*       RESPECIFY                                                  1307
*         RTNREG UNRSTD;            /*                       @YM02888*/
*                                                                  1307
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO ERRORS, TURN OFF THE MOUNT SWITCH           @YM02888*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1308
*       IF TESTRC=0 THEN                                           1308
         LTR   TESTRC,TESTRC                                       1308
         BNZ   @RF01308                                            1308
*         DO;                       /*                       @YD00175*/
*           MNTSW=OFF;              /*                       @YD00175*/
         NI    MNTSW,B'11011111'                                   1310
*           DMNTSW=ON;              /*                       @YD00175*/
         OI    DMNTSW,B'10000000'                                  1311
*         END;                      /*                       @YD00175*/
*     END;                          /*                       @Y30LB33*/
*                                                                  1313
@RF01308 DS    0H                                                  1314
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME IS DEMOUNTED AND THIS IS NOT            @ZDR2057*/
*   /* A REBUILD LABEL REQUEST, DO THE BACKOUT.              @ZDR2057*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1314
*   IF MNTSW=OFF&ADDR(RLBL)=NULLPTR THEN                           1314
@RF01297 TM    MNTSW,B'00100000'                                   1314
         BNZ   @RF01314                                            1314
         L     @02,@PC00001+4                                      1314
         L     @02,FDTPTR+100(,@02)                                1314
         LTR   @02,@02                                             1314
         BNZ   @RF01314                                            1314
*     DO;                           /*                       @ZDR2057*/
*                                                                  1315
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP BASE POINTER AT THE BACKOUT                @YM02888*/
*       /* ARGUMENT LISTS. SET UP TO OPERATE ON AN           @YM02888*/
*       /* ACTIVE OR INACTIVE VOLUME                         @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1316
*       DEFVPTR=ADDR(BKDEFLST);     /*                       @Y30LB33*/
*                                                                  1316
         LA    @15,BKDEFLST                                        1316
         ST    @15,DEFVPTR                                         1316
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS INACTIVE, SET UP ARGUMENT        @Y30LB33*/
*       /* LIST TO OPERATE ON AN INACTIVE VOLUME             @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1317
*       IF INACTSW=ON THEN                                         1317
         TM    INACTSW,B'00000100'                                 1317
         BNO   @RF01317                                            1317
*         DO;                       /*                       @Y30LB33*/
*           DEFVRNTR=ON;            /*                       @Y30LB33*/
         OI    DEFVRNTR(@15),B'00000100'                           1319
*           DEFVCSN1=BASCSN1;       /*                       @Y30LB33*/
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  1320
*         END;                      /*                       @Y30LB33*/
*                                                                  1321
*       /*************************************************************/
*       /*                                                           */
*       /* OTHERWISE, SET UP TO OPERATE ON AN ACTIVE VOLUME  @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1322
*       ELSE                                                       1322
*         DEFVRNM=ON;               /*                       @Y30LB33*/
*                                                                  1322
         B     @RC01317                                            1322
@RF01317 L     @01,DEFVPTR                                         1322
         OI    DEFVRNM(@01),B'00100000'                            1322
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE DEFINE COMMAND TO BACKOUT THE           @Y30LB33*/
*       /* CHANGES                                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1323
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     1323
*                                                            @Y30LB33*/
@RC01317 L     @02,@PC00001                                        1323
         ST    @02,@AL00001                                        1323
         LA    @15,DEFINE                                          1323
         ST    @15,@AL00001+4                                      1323
         LA    @15,DEFVPTR                                         1323
         ST    @15,@AL00001+8                                      1323
         LA    @15,RCAREA                                          1323
         ST    @15,@AL00001+12                                     1323
         LA    @15,ECBBYTE                                         1323
         ST    @15,@AL00001+16                                     1323
         MVI   @AL00001+16,X'80'                                   1323
         L     @15,GDTSSC(,@02)                                    1323
         LA    @01,@AL00001                                        1323
         BALR  @14,@15                                             1323
*       RESPECIFY                                                  1324
*         RTNREG RSTD;                                             1324
*       TESTRC=RTNREG;                                             1325
         LR    TESTRC,RTNREG                                       1325
*       RESPECIFY                                                  1326
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*                                                                  1327
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE HAD AN ERROR, PRINT THE                     @Y30LB33*/
*       /* MESSAGE IDC3062I AND TURN ON THE BACK FAIL        @Y30LB33*/
*       /* SWITCH                                            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1327
*     END;                          /*                       @YM02888*/
*   IF MNTSW=ON×TESTRC=4×TESTRC=8 THEN                             1328
@RF01314 TM    MNTSW,B'00100000'                                   1328
         BO    @RT01328                                            1328
         C     TESTRC,@CF00043                                     1328
         BE    @RT01328                                            1328
         C     TESTRC,@CF00035                                     1328
         BNE   @RF01328                                            1328
@RT01328 DS    0H                                                  1329
*     DO;                           /*                       @YM02888*/
*                                                                  1329
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE GOT A REAL ERROR, NOT JUST NO SPACE         @Y30LB33*/
*       /* CALL SSCMSG AND THEN PRINT IDC3062I               @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1330
*       IF TESTRC=4 THEN            /*                       @Y30LB33*/
         C     TESTRC,@CF00043                                     1330
         BNE   @RF01330                                            1330
*         CALL SSCMSG(RCAREA,ECBBYTE);/*                     @Y30LB33*/
         LA    @15,RCAREA                                          1331
         ST    @15,@AL00001                                        1331
         LA    @15,ECBBYTE                                         1331
         ST    @15,@AL00001+4                                      1331
         LA    @01,@AL00001                                        1331
         BAL   @14,SSCMSG                                          1331
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
@RF01330 L     @15,DDSTRU                                          1332
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1332
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              1333
*       DARGSENT=MSG3062I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'30'                                 1334
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @15,@PC00001                                        1335
         ST    @15,@AL00001                                        1335
         LA    @14,@CF00117                                        1335
         ST    @14,@AL00001+4                                      1335
         LA    @14,DDSTRU                                          1335
         ST    @14,@AL00001+8                                      1335
         MVI   @AL00001+8,X'80'                                    1335
         L     @15,GDTPRT(,@15)                                    1335
         LA    @01,@AL00001                                        1335
         BALR  @14,@15                                             1335
*     END;                          /*                       @Y30LB33*/
*                                                                  1337
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE GOT NO ERRORS, PRINT MESSAGE                    @Y30LB33*/
*   /* IDC0063I TO INDICATE THAT                             @Y30LB33*/
*   /* EVERYTHING WAS RESTORED                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1337
*   ELSE                                                           1337
*     DO;                           /*                       @Y30LB33*/
         B     @RC01328                                            1337
@RF01328 DS    0H                                                  1338
*       INACTSW=ON;                 /*                       @Y30LB33*/
         OI    INACTSW,B'00000100'                                 1338
*       MVVOLUME=VOLVAL;            /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      1339
         L     @01,FDTPTR(,@15)                                    1339
         MVC   MVVOLUME(6),VOLVAL(@01)                             1339
*       DARGLIST=DARGLIST&&DARGLIST;/*                       @Y30LB33*/
         L     @15,DDSTRU                                          1340
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1340
*       DARGSMOD=MODCMN;            /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              1341
*       DARGSENT=MSG0063I;          /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'2F'                                 1342
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB33*/
         L     @15,@PC00001                                        1343
         ST    @15,@AL00001                                        1343
         LA    @14,@CF00117                                        1343
         ST    @14,@AL00001+4                                      1343
         LA    @14,DDSTRU                                          1343
         ST    @14,@AL00001+8                                      1343
         MVI   @AL00001+8,X'80'                                    1343
         L     @15,GDTPRT(,@15)                                    1343
         LA    @01,@AL00001                                        1343
         BALR  @14,@15                                             1343
*     END;                          /*                       @Y30LB33*/
*                                                                  1345
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ARGUMENTS TO ACTIVATE VOLUME                   @Y30LB33*/
*   /* IF THE VOLUME IS INACTIVE                             @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1345
*   IF INACTSW=ON THEN                                             1345
@RC01328 TM    INACTSW,B'00000100'                                 1345
         BNO   @RF01345                                            1345
*     DO;                           /*                       @Y30LB33*/
*       DEFLIST=DEFLIST&&DEFLIST;   /*                       @Y30LB33*/
         L     @15,DEFVPTR                                         1347
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1347
*       DEFVACT=ON;                 /*                       @Y30LB33*/
         OI    DEFVACT(@15),B'00000010'                            1348
*       DEFVCSN1=BASCSN1;           /*                       @Y30LB33*/
*                                                                  1349
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  1349
*       /*************************************************************/
*       /*                                                           */
*       /* DUMP ACTIVATE ARGUMENT LIST                       @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1350
*       IF GDTDBG=NULLPTR THEN                                     1350
         L     @15,@PC00001                                        1350
         L     @15,GDTDBG(,@15)                                    1350
         LTR   @15,@15                                             1350
         BZ    @RT01350                                            1350
*         ;                                                        1351
*       ELSE                                                       1352
*         DO;                                                      1352
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1353
*           DMPITMNM='DEFLIST';                                    1354
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1354
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1354
*           DMPITMPT=ADDR(DEFLIST);                                1355
         L     @03,DEFVPTR                                         1355
         ST    @03,DMPITMPT(,DMPINDEX)                             1355
*           DMPITMLN=LENGTH(DEFLIST);                              1356
         MVC   DMPITMLN(2,DMPINDEX),@CH01836                       1356
*           DMPITMTP='H';                                          1357
         MVI   DMPITMTP(DMPINDEX),C'H'                             1357
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Y30LB33*/
         AL    DMPINDEX,@CF00507                                   1358
*           DMPTRM=DMPTRMVL;                                       1359
         MVI   DMPTRM(DMPINDEX),X'FF'                              1359
*         END;                      /*                       @Y30LB33*/
*       IF GDTDBG=NULLPTR THEN                                     1361
@RT01350 L     @15,@PC00001                                        1361
         L     @15,GDTDBG(,@15)                                    1361
         LTR   @15,@15                                             1361
         BZ    @RT01361                                            1361
*         ;                                                        1362
*       ELSE                                                       1363
*         CALL IDCDB010(GDTTBL,'MVTB',DUMPADDR);/*           @Y30LB33*/
*                                                                  1363
         L     @15,@PC00001                                        1363
         ST    @15,@AL00001                                        1363
         LA    @14,@CC01778                                        1363
         ST    @14,@AL00001+4                                      1363
         LA    @14,DUMPADDR                                        1363
         ST    @14,@AL00001+8                                      1363
         MVI   @AL00001+8,X'80'                                    1363
         L     @15,GDTDBG(,@15)                                    1363
         LA    @01,@AL00001                                        1363
         BALR  @14,@15                                             1363
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO ACTIVATE VOLUME                     @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1364
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,RCAREA,ECBBYTE);/*     1364
*                                                            @Y30LB33*/
@RT01361 L     @02,@PC00001                                        1364
         ST    @02,@AL00001                                        1364
         LA    @15,DEFINE                                          1364
         ST    @15,@AL00001+4                                      1364
         LA    @15,DEFVPTR                                         1364
         ST    @15,@AL00001+8                                      1364
         LA    @15,RCAREA                                          1364
         ST    @15,@AL00001+12                                     1364
         LA    @15,ECBBYTE                                         1364
         ST    @15,@AL00001+16                                     1364
         MVI   @AL00001+16,X'80'                                   1364
         L     @15,GDTSSC(,@02)                                    1364
         LA    @01,@AL00001                                        1364
         BALR  @14,@15                                             1364
*       RESPECIFY                                                  1365
*         RTNREG RSTD;                                             1365
*       TESTRC=RTNREG;                                             1366
         LR    TESTRC,RTNREG                                       1366
*       RESPECIFY                                                  1367
*         RTNREG UNRSTD;            /*                       @Y30LB33*/
*                                                                  1367
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ACTIVATE FAILED, CALL SSCMSG TO PRINT      @Y30LB33*/
*       /* THE REASON AND THEN PRINT IDC2075I TO INDICATE    @Y30LB33*/
*       /* THAT THE ACTIVATE FAILED                          @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1368
*       IF TESTRC=4×TESTRC=8 THEN                                  1368
         C     TESTRC,@CF00043                                     1368
         BE    @RT01368                                            1368
         C     TESTRC,@CF00035                                     1368
         BNE   @RF01368                                            1368
@RT01368 DS    0H                                                  1369
*         DO;                       /*                       @Y30LB33*/
*           IF TESTRC=4 THEN        /*                       @Y30LB33*/
         C     TESTRC,@CF00043                                     1370
         BNE   @RF01370                                            1370
*             CALL SSCMSG(RCAREA,ECBBYTE);/*                 @Y30LB33*/
         LA    @15,RCAREA                                          1371
         ST    @15,@AL00001                                        1371
         LA    @15,ECBBYTE                                         1371
         ST    @15,@AL00001+4                                      1371
         LA    @01,@AL00001                                        1371
         BAL   @14,SSCMSG                                          1371
*           DARGLIST=DARGLIST&&DARGLIST;/*                   @Y30LB33*/
@RF01370 L     @15,DDSTRU                                          1372
         XC    DARGLIST(20,@15),DARGLIST(@15)                      1372
*           DARGSMOD=MODCMN;        /*                       @Y30LB33*/
         MVC   DARGSMOD(3,@15),MODCMN                              1373
*           DARGSENT=MSG2075I;      /*                       @Y30LB33*/
         MVI   DARGSENT(@15),X'1F'                                 1374
*           DARGDBP=ADDR(MVVOLUME); /*                       @Y30LB33*/
         LA    @14,MVVOLUME                                        1375
         ST    @14,DARGDBP(,@15)                                   1375
*           DARGILP=LENGTH(MVVOLUME);/*                      @Y30LB33*/
         MVC   DARGILP(2,@15),@CH00159                             1376
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB33*/
         L     @15,@PC00001                                        1377
         ST    @15,@AL00001                                        1377
         LA    @14,@CF00117                                        1377
         ST    @14,@AL00001+4                                      1377
         LA    @14,DDSTRU                                          1377
         ST    @14,@AL00001+8                                      1377
         MVI   @AL00001+8,X'80'                                    1377
         L     @15,GDTPRT(,@15)                                    1377
         LA    @01,@AL00001                                        1377
         BALR  @14,@15                                             1377
*         END;                      /*                       @Y30LB33*/
*                                                                  1378
*       /*************************************************************/
*       /*                                                           */
*       /* AND IF THE ACTIVATE WENT WELL,                    @Y30LB33*/
*       /* TURN OFF THE INACTIVE SWITCH                      @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1379
*       ELSE                                                       1379
*         INACTSW=OFF;              /*                       @Y30LB33*/
         B     @RC01368                                            1379
@RF01368 NI    INACTSW,B'11111011'                                 1379
*     END;                          /*                       @Y30LB33*/
*                                                                  1380
@RC01368 DS    0H                                                  1381
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1381
*   REG14=BACKSV;                   /*                       @Y30LB33*/
@RF01345 L     REG14,BACKSV                                        1381
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1382
@EL00021 DS    0H                                                  1382
@EF00021 DS    0H                                                  1382
@ER00021 BR    @14                                                 1382
*   END BACKOUT;                    /*                       @Y30LB33*/
*                                                                  1384
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - BLDLIST                                 @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO BUILD THE PARAMETER LISTS TO               @Y30LB33*/
*/*    CHANGE THE VOLUME AND TO BACKOUT THE                  @Y30LB33*/
*/*    CHANGES IF AN ERROR OCCURS                            @Y30LB33*/
*/*                                                          @Y30LB33*/
*/*    THE FOLLOWING ROUTINES ARE CALLED                     @Y30LB33*/
*/*            BLDEXT                                        @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, SWCHBITS, VOLUME                     @Y30LB33*/
*/*    RECORD AND THE GROUP RECORD                           @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1384
*BLDLIST:                                                          1384
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1384
BLDLIST  DS    0H                                                  1385
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1385
*   DCL                                                            1385
*     BLDLSV PTR(31);               /*                       @Y30LB33*/
*   BLDLSV=REG14;                   /*                       @Y30LB33*/
         ST    REG14,BLDLSV                                        1386
*   OLDERID2=NEWERID2;                                             1387
         L     @15,@PC00001                                        1387
         L     @15,GDTTR2(,@15)                                    1387
         MVC   @TS00001(95),NEWERID2(@15)                          1387
         MVC   OLDERID2(95,@15),@TS00001                           1387
*   NEWID2='MVUA';                  /*                       @Y30LB33*/
         MVC   NEWID2(4,@15),@CC01783                              1388
*   MVDEFLST=MVDEFLST&&MVDEFLST;    /*                       @Y30LB33*/
*                                                                  1389
         XC    MVDEFLST(132),MVDEFLST                              1389
*   /*****************************************************************/
*   /*                                                               */
*   /* PUT THE VOLUME SERIAL INTO THE LIST                   @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1390
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB33*/
*                                                                  1390
         L     @15,DEFVPTR                                         1390
         L     @14,@PC00001+4                                      1390
         L     @01,FDTPTR(,@14)                                    1390
         MVC   DEFVOLD(6,@15),VOLVAL(@01)                          1390
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE RELABELING,                                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1391
*   IF RENAMSW=ON THEN                                             1391
         TM    RENAMSW,B'01000000'                                 1391
         BNO   @RF01391                                            1391
*     DO;                           /*                       @Y30LB33*/
*       DEFVRNM=ON;                 /* CHANGE AN ACTIVE VOLUME     1393
*                                                            @Y30LB33*/
         OI    DEFVRNM(@15),B'00100000'                            1393
*       DEFVNVOL=MVVOLUME;          /* SET SERIAL NUMBER     @Y30LB33*/
*                                                                  1394
         MVC   DEFVNVOL(6,@15),MVVOLUME                            1394
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP OWNER UPDATE                               @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1395
*       IF ADDR(NOWN)>0 THEN        /* IF NULLING OWNER      @Y30LB33*/
         L     @14,FDTPTR+72(,@14)                                 1395
         LTR   @14,@14                                             1395
         BNP   @RF01395                                            1395
*         DEFOWNID=MVBLANKS;        /* MAKE IT BLANK         @Y30LB33*/
         MVI   DEFOWNID+10(@15),C' '                               1396
         MVC   DEFOWNID+11(3,@15),DEFOWNID+10(@15)                 1396
         MVC   DEFOWNID(10,@15),@CC01575                           1396
*       IF ADDR(OWNER)>0 THEN       /* IF CHANGING OWNER     @Y30LB33*/
@RF01395 L     @15,@PC00001+4                                      1397
         L     @15,FDTPTR+8(,@15)                                  1397
         LTR   @15,@15                                             1397
         BNP   @RF01397                                            1397
*         DEFOWNID=OWNERVAL;        /* PUT IN THE VALUE      @Y30LB33*/
         L     @01,DEFVPTR                                         1398
         MVI   DEFOWNID+10(@01),C' '                               1398
         MVC   DEFOWNID+11(3,@01),DEFOWNID+10(@01)                 1398
         MVC   DEFOWNID(10,@01),OWNERVAL(@15)                      1398
*     END;                          /*                       @Y30LB33*/
*                                                                  1399
@RF01397 DS    0H                                                  1400
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE CHANGING ATTRIBUTES ,                       @Y30LB33*/
*   /* AND WE ARE NOT RELABELING,                            @Y30LB33*/
*   /* THEN SET UP TO CHANGE ATTRIBUTES ONLY                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1400
*   IF(ATTRSW=ON×COPYATTR=ON×ONLYONLY=ON)/*                  @Y30LB33*/
*       &RENAMSW=OFF                /* IF NO RELABELING      @Y30LB33*/
*     THEN                                                         1400
@RF01391 TM    ATTRSW,B'00100010'                                  1400
         BNZ   @GL00109                                            1400
         TM    ONLYONLY,B'10000000'                                1400
         BNO   @RF01400                                            1400
@GL00109 TM    RENAMSW,B'01000000'                                 1400
         BNZ   @RF01400                                            1400
*     DEFVREP=ON;                   /* CHANGE ATTR ONLY      @Y30LB33*/
*                                                                  1401
         L     @01,DEFVPTR                                         1401
         OI    DEFVREP(@01),B'00010000'                            1401
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ATTRIBUTES USING THE VOLUME RECORD, THE           @Y30LB33*/
*   /* GROUP RECORD, AND THE FDTTBL, OVERRIDING EACH         @Y30LB33*/
*   /* OTHER IN THAT ORDER. FIRST, SET UP THE VOLUME         @Y30LB33*/
*   /* ATTRIBUTES AS THEY ARE IN THE RECORD, UNLESS          @Y30LB33*/
*   /* THE GROUP RECORD ATTRIBUTES ARE BEING COPIED.         @Y30LB33*/
*   /* IF THEY ARE BEING COPIED, USE THE GROUP               @Y30LB33*/
*   /* ATTRIBUTES                                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1402
*   IF                              /*                       @Y30LB33*/
*                                                                  1402
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE COPYING FROM THE GROUP                      @Y30LB33*/
*   /* SET REQUEST BLOCK FROM THE GROUP                      @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1402
*       COPYATTR=ON×(ONLYONLY=ON&RENAMSW=OFF) THEN                 1402
@RF01400 TM    COPYATTR,B'00000010'                                1402
         BO    @RT01402                                            1402
         TM    ONLYONLY,B'10000000'                                1402
         BNO   @RF01402                                            1402
         TM    RENAMSW,B'01000000'                                 1402
         BNZ   @RF01402                                            1402
@RT01402 DS    0H                                                  1403
*     DO;                           /*                       @Y30LB33*/
*       IF GROEXCL=ON THEN                                         1404
         TM    GROEXCL(GROUPPTR),B'01000000'                       1404
         BNO   @RF01404                                            1404
*         DEFVEXCL=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1405
         OI    DEFVEXCL(@01),B'00010000'                           1405
*       IF GROBIND=ON THEN                                         1406
@RF01404 TM    GROBIND(GROUPPTR),B'10000000'                       1406
         BNO   @RF01406                                            1406
*         DEFVBIND=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1407
         OI    DEFVBIND(@01),B'00000100'                           1407
*       IF GRODAERA=ON THEN                                        1408
@RF01406 TM    GRODAERA(GROUPPTR),B'00100000'                      1408
         BNO   @RF01408                                            1408
*         DEFVSEC=ON;               /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1409
         OI    DEFVSEC(@01),B'00100000'                            1409
*       IF GRORONLY=ON THEN                                        1410
@RF01408 TM    GRORONLY(GROUPPTR),B'00010000'                      1410
         BNO   @RF01410                                            1410
*         DEFVWINH=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1411
         OI    DEFVWINH(@01),B'00000010'                           1411
*     END;                          /*                       @Y30LB33*/
*                                                                  1412
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE, SET THE REQUEST BLOCK FROM                 @Y30LB33*/
*   /* THE VOLUME RECORD                                     @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1413
*   ELSE                                                           1413
*     DO;                           /*                       @Y30LB33*/
         B     @RC01402                                            1413
@RF01402 DS    0H                                                  1414
*       IF BASEXCL=ON THEN                                         1414
         TM    BASEXCL(BASEVPTR),B'00000001'                       1414
         BNO   @RF01414                                            1414
*         DEFVEXCL=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1415
         OI    DEFVEXCL(@01),B'00010000'                           1415
*       IF BASBIND=ON THEN                                         1416
@RF01414 TM    BASBIND(BASEVPTR),B'00000010'                       1416
         BNO   @RF01416                                            1416
*         DEFVBIND=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1417
         OI    DEFVBIND(@01),B'00000100'                           1417
*       IF BASDAERA=ON THEN                                        1418
@RF01416 TM    BASDAERA(BASEVPTR),B'10000000'                      1418
         BNO   @RF01418                                            1418
*         DEFVSEC=ON;               /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1419
         OI    DEFVSEC(@01),B'00100000'                            1419
*       IF BASRONLY=ON THEN                                        1420
@RF01418 TM    BASRONLY(BASEVPTR),B'01000000'                      1420
         BNO   @RF01420                                            1420
*         DEFVWINH=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1421
         OI    DEFVWINH(@01),B'00000010'                           1421
*     END;                          /*                       @Y30LB33*/
*                                                                  1422
@RF01420 DS    0H                                                  1423
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE RELABELING, TURN OFF THE                    @Y30LB33*/
*   /* READONLY FLAG                                         @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1423
*   IF RENAMSW=ON THEN                                             1423
@RC01402 TM    RENAMSW,B'01000000'                                 1423
         BNO   @RF01423                                            1423
*     DEFVWINH=OFF;                 /*                       @Y30LB33*/
*                                                                  1424
         L     @01,DEFVPTR                                         1424
         NI    DEFVWINH(@01),B'11111101'                           1424
*   /*****************************************************************/
*   /*                                                               */
*   /* THEN OVERRIDE THE VOLUME RECORD OR GROUP              @Y30LB33*/
*   /* RECORD ATTRIBUTES WITH THE USER REQUEST               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1425
*   IF ATTRSW=ON THEN                                              1425
@RF01423 TM    ATTRSW,B'00100000'                                  1425
         BNO   @RF01425                                            1425
*     DO;                           /*                       @Y30LB33*/
*       IF ADDR(EXECL)>NULLPTR THEN                                1427
         L     @15,@PC00001+4                                      1427
         L     @15,FDTPTR+32(,@15)                                 1427
         LTR   @15,@15                                             1427
         BNP   @RF01427                                            1427
*         DEFVEXCL=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1428
         OI    DEFVEXCL(@01),B'00010000'                           1428
*       IF ADDR(BIND)>NULLPTR THEN                                 1429
@RF01427 L     @15,@PC00001+4                                      1429
         L     @15,FDTPTR+24(,@15)                                 1429
         LTR   @15,@15                                             1429
         BNP   @RF01429                                            1429
*         DEFVBIND=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1430
         OI    DEFVBIND(@01),B'00000100'                           1430
*       IF ADDR(DERAS)>NULLPTR THEN                                1431
@RF01429 L     @15,@PC00001+4                                      1431
         L     @15,FDTPTR+48(,@15)                                 1431
         LTR   @15,@15                                             1431
         BNP   @RF01431                                            1431
*         DEFVSEC=ON;               /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1432
         OI    DEFVSEC(@01),B'00100000'                            1432
*       IF ADDR(RONLY)>NULLPTR&RENAMSW=OFF THEN                    1433
@RF01431 L     @15,@PC00001+4                                      1433
         L     @15,FDTPTR+40(,@15)                                 1433
         LTR   @15,@15                                             1433
         BNP   @RF01433                                            1433
         TM    RENAMSW,B'01000000'                                 1433
         BNZ   @RF01433                                            1433
*         DEFVWINH=ON;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1434
         OI    DEFVWINH(@01),B'00000010'                           1434
*       IF ADDR(SHRD)>NULLPTR THEN                                 1435
@RF01433 L     @15,@PC00001+4                                      1435
         L     @15,FDTPTR+36(,@15)                                 1435
         LTR   @15,@15                                             1435
         BNP   @RF01435                                            1435
*         DEFVEXCL=OFF;             /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1436
         NI    DEFVEXCL(@01),B'11101111'                           1436
*       IF ADDR(NBIND)>NULLPTR THEN                                1437
@RF01435 L     @15,@PC00001+4                                      1437
         L     @15,FDTPTR+28(,@15)                                 1437
         LTR   @15,@15                                             1437
         BNP   @RF01437                                            1437
*         DEFVBIND=OFF;             /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1438
         NI    DEFVBIND(@01),B'11111011'                           1438
*       IF ADDR(NDERS)>NULLPTR THEN                                1439
@RF01437 L     @15,@PC00001+4                                      1439
         L     @15,FDTPTR+52(,@15)                                 1439
         LTR   @15,@15                                             1439
         BNP   @RF01439                                            1439
*         DEFVSEC=OFF;              /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1440
         NI    DEFVSEC(@01),B'11011111'                            1440
*       IF ADDR(RW)>NULLPTR THEN                                   1441
@RF01439 L     @15,@PC00001+4                                      1441
         L     @15,FDTPTR+44(,@15)                                 1441
         LTR   @15,@15                                             1441
         BNP   @RF01441                                            1441
*         DEFVWINH=OFF;             /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1442
         NI    DEFVWINH(@01),B'11111101'                           1442
*     END;                          /*                       @Y30LB33*/
*                                                                  1443
@RF01441 DS    0H                                                  1444
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE ATTRIBUTES ASIDE FOR USE LATER                @Y30LB33*/
*   /* WHEN WE HAVE TO HAVE THEM AGAIN FOR                   @Y30LB33*/
*   /* SETTING THE READONLY ATTRIBUTE AFTER                  @Y30LB33*/
*   /* RELABELING                                            @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1444
*   MYVVFLG=DEFVVFLG;               /*                       @Y30LB33*/
*                                                                  1444
@RF01425 L     @01,DEFVPTR                                         1444
         MVC   MYVVFLG(1),DEFVVFLG(@01)                            1444
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE HAVE TO UPDATE THE INVENTORY BECAUSE OF         @Y30LB33*/
*   /* INVENTORY-TYPE CHANGES OR SETTING THE MISMATCH        @Y30LB33*/
*   /* DUE TO A NEW SERIAL, PUT THE EXTENSION LIST           @Y30LB33*/
*   /* ADDRESS INTO THE DEFINE PARAMETER LIST.               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1445
*   IF MSVCSW=ON×ADDR(NEWSR)>0 THEN /*                       @Y30LB33*/
         TM    MSVCSW,B'00010000'                                  1445
         BO    @RT01445                                            1445
         L     @15,@PC00001+4                                      1445
         L     @15,FDTPTR+4(,@15)                                  1445
         LTR   @15,@15                                             1445
         BNP   @RF01445                                            1445
@RT01445 DS    0H                                                  1446
*     DEFVVEXT=DEFVEPTR;            /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1446
         ST    DEFVEPTR,DEFVVEXT(,@01)                             1446
*   IF ATTRSW=OFF&                  /* IF USER IS NOT CHANGING     1447
*                                                            @Y30LB33
*                                      THE ATTRIBUTES        @Y30LB33*/
*       COPYATTR=OFF&               /* AND THE ATTRIBUTES ARE NOT  1447
*                                                            @Y30LB33
*                                      CHANGING TO AGREE WITH A    1447
*                                                            @Y30LB33
*                                      GROUP                 @Y30LB33*/
*       (ONLYONLY=OFF×              /* OR THE READONLY ATTR  @Y30LB33
*                                      IS NOT BEING COPIED   @Y30LB33*/
*       RENAMSW=ON)                 /* OR WE ARE UPDATING LABEL    1447
*                                                            @Y30LB33*/
*     THEN                                                         1447
@RF01445 TM    ATTRSW,B'00100010'                                  1447
         BNZ   @RF01447                                            1447
         TM    ONLYONLY,B'10000000'                                1447
         BZ    @RT01447                                            1447
         TM    RENAMSW,B'01000000'                                 1447
         BNO   @RF01447                                            1447
@RT01447 DS    0H                                                  1448
*     DEFVVFLG='FF'X;               /* SET ATTR LIST NULL    @Y30LB33*/
*                                                                  1448
         L     @01,DEFVPTR                                         1448
         MVI   DEFVVFLG(@01),X'FF'                                 1448
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE RELABELING, WE MUST BUILD THE BACKOUT       @Y30LB33*/
*   /* PARAMETER LIST                                        @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1449
*   IF RENAMSW=ON THEN                                             1449
@RF01447 TM    RENAMSW,B'01000000'                                 1449
         BNO   @RF01449                                            1449
*     DO;                           /*                       @Y30LB33*/
*       BKDEFLST=BKDEFLST&&BKDEFLST;/*                       @Y30LB33*/
         XC    BKDEFLST(132),BKDEFLST                              1451
*       DEFVPTR=ADDR(BKDEFLST);     /* BASE THE BACKOUT      @Y30LB33*/
         LA    @15,BKDEFLST                                        1452
         ST    @15,DEFVPTR                                         1452
*       DEFVEPTR=ADDR(BKDEFVE);     /* PARAMETER AREAS       @Y30LB33*/
         LA    DEFVEPTR,BKDEFVE                                    1453
*       DEFLIST=DEFLIST&&DEFLIST;   /* CLEAR THE             @Y30LB33*/
         XC    DEFLIST(132,@15),DEFLIST(@15)                       1454
*       DEFVE=DEFVE&&DEFVE;         /* AREAS                 @Y30LB33*/
         XC    DEFVE(64,DEFVEPTR),DEFVE(DEFVEPTR)                  1455
*       DEFVNVOL=VOLVAL;            /* SET UP VOLSER         @Y30LB33*/
         L     @14,@PC00001+4                                      1456
         L     @01,FDTPTR(,@14)                                    1456
         MVC   DEFVNVOL(6,@15),VOLVAL(@01)                         1456
*       DEFVOLD=MVVOLUME;           /*                       @Y30LB33*/
         MVC   DEFVOLD(6,@15),MVVOLUME                             1457
*       IF ADDR(NOWN)>0×ADDR(OWNER)>0/*                      @Y30LB33*/
*         THEN                                                     1458
         SLR   @15,@15                                             1458
         C     @15,FDTPTR+72(,@14)                                 1458
         BL    @RT01458                                            1458
         C     @15,FDTPTR+8(,@14)                                  1458
         BNL   @RF01458                                            1458
@RT01458 DS    0H                                                  1459
*         DEFOWNID=BASOWNER;        /* SET UP THE            @Y30LB33
*                                      OWNER FIELD IF IT WILL      1459
*                                                            @Y30LB33
*                                      CHANGE                @Y30LB33*/
*                                                                  1459
         L     @01,DEFVPTR                                         1459
         MVI   DEFOWNID+10(@01),C' '                               1459
         MVC   DEFOWNID+11(3,@01),DEFOWNID+10(@01)                 1459
         MVC   DEFOWNID(10,@01),BASOWNER(BASEVPTR)                 1459
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ATTRIBUTES ARE CHANGING, SET               @Y30LB33*/
*       /* THEM UP AS THEY ARE IN THE VOLUME RECORD          @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1460
*       IF ATTRSW=ON×COPYATTR=ON THEN                              1460
@RF01458 TM    ATTRSW,B'00100010'                                  1460
         BZ    @RF01460                                            1460
*         DO;                       /*                       @Y30LB33*/
*           IF BASEXCL=ON THEN                                     1462
         TM    BASEXCL(BASEVPTR),B'00000001'                       1462
         BNO   @RF01462                                            1462
*             DEFVEXCL=ON;          /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1463
         OI    DEFVEXCL(@01),B'00010000'                           1463
*           IF BASBIND=ON THEN                                     1464
@RF01462 TM    BASBIND(BASEVPTR),B'00000010'                       1464
         BNO   @RF01464                                            1464
*             DEFVBIND=ON;          /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1465
         OI    DEFVBIND(@01),B'00000100'                           1465
*           IF BASDAERA=ON THEN                                    1466
@RF01464 TM    BASDAERA(BASEVPTR),B'10000000'                      1466
         BNO   @RF01466                                            1466
*             DEFVSEC=ON;           /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1467
         OI    DEFVSEC(@01),B'00100000'                            1467
*           IF BASRONLY=ON THEN                                    1468
@RF01466 TM    BASRONLY(BASEVPTR),B'01000000'                      1468
         BNO   @RF01468                                            1468
*             DEFVWINH=ON;          /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1469
         OI    DEFVWINH(@01),B'00000010'                           1469
*         END;                      /*                       @Y30LB33*/
*                                                                  1470
*       /*************************************************************/
*       /*                                                           */
*       /* AND IF THEY ARE NOT CHANGING, SET THAT            @Y30LB33*/
*       /* UP WITH THE NULL INDICATOR                        @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1471
*       ELSE                                                       1471
*         DEFVVFLG='FF'X;           /*                       @Y30LB33*/
*                                                                  1471
         B     @RC01460                                            1471
@RF01460 L     @01,DEFVPTR                                         1471
         MVI   DEFVVFLG(@01),X'FF'                                 1471
*       /*************************************************************/
*       /*                                                           */
*       /* IF WE ARE CHANGING THE MSVC RECORD OR             @Y30LB33*/
*       /* RELABELING AND MUST SET MISMATCH FLAG,            @Y30LB33*/
*       /* SET UP THE EXTENSION LIST ADDR                    @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1472
*       IF MSVCSW=ON×ADDR(NEWSR)>0 THEN/*                    @Y30LB33*/
@RC01460 TM    MSVCSW,B'00010000'                                  1472
         BO    @RT01472                                            1472
         L     @15,@PC00001+4                                      1472
         L     @15,FDTPTR+4(,@15)                                  1472
         LTR   @15,@15                                             1472
         BNP   @RF01472                                            1472
@RT01472 DS    0H                                                  1473
*         DEFVVEXT=DEFVEPTR;        /*                       @Y30LB33*/
         L     @01,DEFVPTR                                         1473
         ST    DEFVEPTR,DEFVVEXT(,@01)                             1473
*                                                                  1474
*       /*************************************************************/
*       /*                                                           */
*       /* NOW RESTORE THE POINTERS TO THE LISTS             @Y30LB33*/
*       /* TO BE USED FOR THE CHANGE                         @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1474
*       DEFVEPTR=ADDR(MVDEFVE);     /*                       @Y30LB33*/
@RF01472 LA    DEFVEPTR,MVDEFVE                                    1474
*       DEFVPTR=ADDR(MVDEFLST);     /*                       @Y30LB33*/
         LA    @15,MVDEFLST                                        1475
         ST    @15,DEFVPTR                                         1475
*     END;                          /*                       @Y30LB33*/
*                                                                  1476
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MSVC IS CHANGING OR WE ARE RE-SERIALLING,          @Y30LB33*/
*   /* BUILD THE EXTENSION PARAMETER LIST BY                 @Y30LB33*/
*   /* CALLING BLDEXT                                        @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1477
*   IF MSVCSW=ON×ADDR(NEWSR)>0 THEN /*                       @Y30LB33*/
@RF01449 TM    MSVCSW,B'00010000'                                  1477
         BO    @RT01477                                            1477
         L     @15,@PC00001+4                                      1477
         L     @15,FDTPTR+4(,@15)                                  1477
         LTR   @15,@15                                             1477
         BNP   @RF01477                                            1477
@RT01477 DS    0H                                                  1478
*     CALL BLDEXT;                  /*                       @Y30LB33*/
*                                                                  1478
         BAL   @14,BLDEXT                                          1478
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP ARGUMENT LIST AND BACKOUT LIST                   @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1479
*   IF GDTDBG=NULLPTR THEN                                         1479
@RF01477 L     @15,@PC00001                                        1479
         L     @15,GDTDBG(,@15)                                    1479
         LTR   @15,@15                                             1479
         BZ    @RT01479                                            1479
*     ;                                                            1480
*   ELSE                                                           1481
*     DO;                                                          1481
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1482
*       DMPITMNM='DEFLIST';                                        1483
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1483
         MVC   DMPITMNM(7,DMPINDEX),@CC01739                       1483
*       DMPITMPT=ADDR(DEFLIST);                                    1484
         L     @03,DEFVPTR                                         1484
         ST    @03,DMPITMPT(,DMPINDEX)                             1484
*       DMPITMLN=LENGTH(DEFLIST);                                  1485
         LA    @03,132                                             1485
         STH   @03,DMPITMLN(,DMPINDEX)                             1485
*       DMPITMTP='H';                                              1486
         MVI   DMPITMTP(DMPINDEX),C'H'                             1486
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/
         LA    @15,16                                              1487
         ALR   DMPINDEX,@15                                        1487
*       DMPITMNM='BKDEFLST';                                       1488
         MVC   DMPITMNM(8,DMPINDEX),@CC01785                       1488
*       DMPITMPT=ADDR(BKDEFLST);                                   1489
         LA    @14,BKDEFLST                                        1489
         ST    @14,DMPITMPT(,DMPINDEX)                             1489
*       DMPITMLN=LENGTH(BKDEFLST);                                 1490
         STH   @03,DMPITMLN(,DMPINDEX)                             1490
*       ;                                                          1491
*       DMPITMTP='H';                                              1492
         MVI   DMPITMTP(DMPINDEX),C'H'                             1492
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/
         ALR   DMPINDEX,@15                                        1493
*       DMPTRM=DMPTRMVL;                                           1494
         MVI   DMPTRM(DMPINDEX),X'FF'                              1494
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         1496
@RT01479 L     @15,@PC00001                                        1496
         L     @15,GDTDBG(,@15)                                    1496
         LTR   @15,@15                                             1496
         BZ    @RT01496                                            1496
*     ;                                                            1497
*   ELSE                                                           1498
*     CALL IDCDB010(GDTTBL,'MVUB',DUMPADDR);/*               @Y30LB33*/
*                                                                  1498
         L     @15,@PC00001                                        1498
         ST    @15,@AL00001                                        1498
         LA    @14,@CC01786                                        1498
         ST    @14,@AL00001+4                                      1498
         LA    @14,DUMPADDR                                        1498
         ST    @14,@AL00001+8                                      1498
         MVI   @AL00001+8,X'80'                                    1498
         L     @15,GDTDBG(,@15)                                    1498
         LA    @01,@AL00001                                        1498
         BALR  @14,@15                                             1498
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1499
*   REG14=BLDLSV;                   /*                       @Y30LB33*/
@RT01496 L     REG14,BLDLSV                                        1499
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1500
@EL00022 DS    0H                                                  1500
@EF00022 DS    0H                                                  1500
@ER00022 BR    @14                                                 1500
*   END BLDLIST;                    /*                       @Y30LB33*/
*                                                                  1502
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - BLDEXT                                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - BUILDS THE MODIFY EXTENSION                   @Y30LB33*/
*/*    LIST TO UPDATE INVENTORY RECORDS DURING               @Y30LB33*/
*/*    MODIFICATION OF THE VOLUME                            @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - FDTTBL, SWCHBITS, AND THE VOLUME                 @Y30LB33*/
*/*    RECORD                                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1502
*BLDEXT:                                                           1502
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1502
BLDEXT   DS    0H                                                  1503
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1503
*   DCL                                                            1503
*     BLDESV PTR(31);               /*                       @Y30LB33*/
*   BLDESV=REG14;                   /*                       @Y30LB33*/
         LR    BLDESV,REG14                                        1504
*   OLDERID2=NEWERID2;                                             1505
         L     @02,@PC00001                                        1505
         L     @02,GDTTR2(,@02)                                    1505
         MVC   @TS00001(95),NEWERID2(@02)                          1505
         MVC   OLDERID2(95,@02),@TS00001                           1505
*   NEWID2='MVVA';                  /*                       @Y30LB33*/
         MVC   NEWID2(4,@02),@CC01791                              1506
*   MVDEFVE=MVDEFVE&&MVDEFVE;       /*                       @Y30LB33*/
         XC    MVDEFVE(64),MVDEFVE                                 1507
*   DEFLNGTH=DEFLEN;                /*                       @Y30LB33*/
*                                                                  1508
         LH    @02,DEFLEN                                          1508
         ST    @02,DEFLNGTH(,DEFVEPTR)                             1508
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE USER SAYS NULL THE GROUP, AND THE              @Y30LB33*/
*   /* VOLUME IS GROUPED, INDICATE NO GROUP                  @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1509
*   IF ADDR(NGRP)>0&BASGRPV=ON      /*                       @Y30LB33*/
*     THEN                                                         1509
         L     @02,@PC00001+4                                      1509
         L     @02,FDTPTR+76(,@02)                                 1509
         LTR   @02,@02                                             1509
         BNP   @RF01509                                            1509
         TM    BASGRPV(BASEVPTR),B'00100000'                       1509
         BNO   @RF01509                                            1509
*     DEFNGRP=ON;                   /*                       @Y30LB33*/
*                                                                  1510
         OI    DEFNGRP(DEFVEPTR),B'10000000'                       1510
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE USER SAYS GROUP THE VOLUME, THEN               @Y30LB33*/
*   /* INDICATE THE GROUP                                    @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1511
*   IF ADDR(GRP)>0 THEN                                            1511
@RF01509 L     @02,@PC00001+4                                      1511
         L     @02,FDTPTR+12(,@02)                                 1511
         LTR   @02,@02                                             1511
         BNP   @RF01511                                            1511
*     DO;                           /*                       @Y30LB33*/
*       DEFPGRO=ON;                 /*                       @Y30LB33*/
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       1513
*       DEFGROUP=GRPVAL;            /*                       @Y30LB33*/
         MVC   DEFGROUP(8,DEFVEPTR),GRPVAL(@02)                    1514
*       DEFNGRP=OFF;                /*                       @Y30LB33*/
         NI    DEFNGRP(DEFVEPTR),B'01111111'                       1515
*     END;                          /*                       @Y30LB33*/
*                                                                  1516
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO CHANGE OR NULLIFY THE DESCRIPTION           @Y30LB33*/
*   /* IF BOTH NULL AND UPDATE ASKED, OVERLAY NULL           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1517
*   IF ADDR(NDESC)>0 THEN                                          1517
@RF01511 L     @02,@PC00001+4                                      1517
         L     @02,FDTPTR+80(,@02)                                 1517
         LTR   @02,@02                                             1517
         BNP   @RF01517                                            1517
*     DEFNDESC=ON;                  /*                       @Y30LB33*/
         OI    DEFNDESC(DEFVEPTR),B'01000000'                      1518
*   IF ADDR(DESCR)>0 THEN                                          1519
@RF01517 L     @02,@PC00001+4                                      1519
         L     @02,FDTPTR+56(,@02)                                 1519
         LTR   @02,@02                                             1519
         BNP   @RF01519                                            1519
*     DO;                           /*                       @Y30LB33*/
*       DEFPDESC=ON;                /*                       @Y30LB33*/
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      1521
*       DEFNDESC=OFF;               /*                       @Y30LB33*/
         NI    DEFNDESC(DEFVEPTR),B'10111111'                      1522
*       DEFDESCR=DESCRVAL;          /*                       @Y30LB33*/
         MVC   DEFDESCR(30,DEFVEPTR),DESCRVAL(@02)                 1523
*     END;                          /*                       @Y30LB33*/
*                                                                  1524
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO CHANGE EXPIRATION OR RETENTION              @Y30LB33*/
*   /* IF BOTH NULL AND UPDATE ASKED, OVERLAY NULL           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1525
*   IF ADDR(NRET)>0 THEN                                           1525
@RF01519 L     @02,@PC00001+4                                      1525
         L     @02,FDTPTR+84(,@02)                                 1525
         LTR   @02,@02                                             1525
         BNP   @RF01525                                            1525
*     DEFNEXPD=ON;                  /*                       @Y30LB33*/
         OI    DEFNEXPD(DEFVEPTR),B'00100000'                      1526
*   IF ADDR(TO)>0 THEN                                             1527
@RF01525 L     @02,@PC00001+4                                      1527
         L     @02,FDTPTR+60(,@02)                                 1527
         LTR   @02,@02                                             1527
         BNP   @RF01527                                            1527
*     DO;                           /*                       @Y30LB33*/
*       DEFPTO=ON;                  /*                       @Y30LB33*/
         OI    DEFPTO(DEFVEPTR),B'00001000'                        1529
*       DEFNEXPD=OFF;               /*                       @Y30LB33*/
         NI    DEFNEXPD(DEFVEPTR),B'11011111'                      1530
*       CVD(TOVAL,DEFTO);           /*                       @Y30LB33*/
         L     @02,TOVAL(,@02)                                     1531
         CVD   @02,@TS00001                                        1531
         MVC   DEFTO(4,DEFVEPTR),@TS00001+4                        1531
*     END;                          /*                       @Y30LB33*/
*   IF ADDR(FORE)>0 THEN                                           1533
@RF01527 L     @02,@PC00001+4                                      1533
         L     @02,FDTPTR+96(,@02)                                 1533
         LTR   @02,@02                                             1533
         BNP   @RF01533                                            1533
*     DO;                           /*                       @Y30LB33*/
*       DEFPFOR=ON;                 /*                       @Y30LB33*/
         OI    DEFPFOR(DEFVEPTR),B'10000000'                       1535
*       DEFNEXPD=OFF;               /*                       @Y30LB33*/
         NI    DEFNEXPD(DEFVEPTR),B'11011111'                      1536
*       DEFFOR=FOREVAL;             /*                       @Y30LB33*/
         L     @02,FOREVAL(,@02)                                   1537
         STH   @02,DEFFOR(,DEFVEPTR)                               1537
*     END;                          /*                       @Y30LB33*/
*                                                                  1538
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE BACKUP NUMBER IF SPECIFIED                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1539
*   IF ADDR(BKUP)>0 THEN                                           1539
@RF01533 L     @02,@PC00001+4                                      1539
         L     @02,FDTPTR+64(,@02)                                 1539
         LTR   @02,@02                                             1539
         BNP   @RF01539                                            1539
*     DO;                           /*                       @Y30LB33*/
*       DEFPBKUP=ON;                /*                       @Y30LB33*/
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      1541
*       DEFBKUPN=BKUPVAL;           /*                       @Y30LB33*/
         MVC   DEFBKUPN(1,DEFVEPTR),BKUPVAL+3(@02)                 1542
*     END;                          /*                       @Y30LB33*/
*                                                                  1543
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR A SERIAL CHANGE AND MISMATCH               @Y30LB33*/
*   /* IF THE VOLUME HAS NO MISMATCH NOW AND                 @Y30LB33*/
*   /* WE ARE GOING TO UPDATE THE SERIAL NUMBER              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1544
*   IF BASVSMIS=OFF&ADDR(NEWSR)>0 THEN                             1544
@RF01539 TM    BASVSMIS(BASEVPTR),B'00100000'                      1544
         BNZ   @RF01544                                            1544
         L     @02,@PC00001+4                                      1544
         L     @15,FDTPTR+4(,@02)                                  1544
         LTR   @15,@15                                             1544
         BNP   @RF01544                                            1544
*     DO;                           /*                       @Y30LB33*/
*       DEFLABEL=VOLVAL;            /*                       @Y30LB33*/
         L     @02,FDTPTR(,@02)                                    1546
         MVC   DEFLABEL(6,DEFVEPTR),VOLVAL(@02)                    1546
*       DEFPVLAB=ON;                /*                       @Y30LB33*/
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1547
*       DEFSRCVY=ON;                /*                       @Y30LB33*/
         OI    DEFSRCVY(DEFVEPTR),B'10000000'                      1548
*       DEFLAMIS=ON;                /*                       @Y30LB33*/
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1549
*     END;                          /*                       @Y30LB33*/
*                                                                  1550
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR GENERAL OR RESTRICTED CHANGE               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1551
*   IF NEWGENSW=ON THEN             /*                       @Y30LB33*/
@RF01544 TM    NEWGENSW,B'00000100'                                1551
         BNO   @RF01551                                            1551
*     DEFGENUS=ON;                  /*                       @Y30LB33*/
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1552
*   IF ADDR(RSTR)>NULLPTR THEN                                     1553
@RF01551 L     @02,@PC00001+4                                      1553
         L     @02,FDTPTR+20(,@02)                                 1553
         LTR   @02,@02                                             1553
         BNP   @RF01553                                            1553
*     DEFRSTD=ON;                   /*                       @Y30LB33*/
*                                                                  1554
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1554
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE CHANGING THE LABEL, SET UP THE              @Y30LB33*/
*   /* BACKOUT PARAMETER LIST                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1555
*   IF RENAMSW=ON THEN                                             1555
@RF01553 TM    RENAMSW,B'01000000'                                 1555
         BNO   @RF01555                                            1555
*     DO;                           /*                       @Y30LB33*/
*       DEFVEPTR=ADDR(BKDEFVE);     /* SET BASE              @Y30LB33*/
         LA    DEFVEPTR,BKDEFVE                                    1557
*       BKDEFVE=BKDEFVE&&BKDEFVE;   /*                       @Y30LB33*/
         XC    BKDEFVE(64),BKDEFVE                                 1558
*       DEFLNGTH=DEFLEN;            /*                       @YM02857*/
*                                                                  1559
         LH    @02,DEFLEN                                          1559
         ST    @02,DEFLNGTH(,DEFVEPTR)                             1559
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP NEW GROUP BACKOUT                          @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1560
*       IF(ADDR(NGRP)>0×ADDR(GRP)>0)&/*                      @Y30LB33*/
*           BASGRPV=ON THEN                                        1560
         SLR   @02,@02                                             1560
         L     @15,@PC00001+4                                      1560
         C     @02,FDTPTR+76(,@15)                                 1560
         BL    @GL00122                                            1560
         C     @02,FDTPTR+12(,@15)                                 1560
         BNL   @RF01560                                            1560
@GL00122 TM    BASGRPV(BASEVPTR),B'00100000'                       1560
         BNO   @RF01560                                            1560
*         DO;                       /*                       @Y30LB33*/
*           DEFPGRO=ON;             /*                       @Y30LB33*/
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       1562
*           DEFGROUP=BASGROUP;      /*                       @Y30LB33*/
         MVC   DEFGROUP(8,DEFVEPTR),BASGROUP(BASEVPTR)             1563
*         END;                      /*                       @Y30LB33*/
*                                                                  1564
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP TO NULL THE GROUP IN BACKOUT               @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1565
*       IF ADDR(GRP)>0&BASGRPV=OFF  /*                       @Y30LB33*/
*         THEN                                                     1565
@RF01560 L     @02,@PC00001+4                                      1565
         L     @02,FDTPTR+12(,@02)                                 1565
         LTR   @02,@02                                             1565
         BNP   @RF01565                                            1565
         TM    BASGRPV(BASEVPTR),B'00100000'                       1565
         BNZ   @RF01565                                            1565
*         DEFNGRP=ON;               /*                       @Y30LB33*/
*                                                                  1566
         OI    DEFNGRP(DEFVEPTR),B'10000000'                       1566
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP BACKUP NUMBER BACKOUT                      @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1567
*       IF ADDR(BKUP)>0 THEN                                       1567
@RF01565 L     @02,@PC00001+4                                      1567
         L     @02,FDTPTR+64(,@02)                                 1567
         LTR   @02,@02                                             1567
         BNP   @RF01567                                            1567
*         DO;                       /*                       @Y30LB33*/
*           DEFBKUPN=BASBKLMT;      /*                       @Y30LB33*/
         MVC   DEFBKUPN(1,DEFVEPTR),BASBKLMT(BASEVPTR)             1569
*           DEFPBKUP=ON;            /*                       @Y30LB33*/
         OI    DEFPBKUP(DEFVEPTR),B'00000100'                      1570
*         END;                      /*                       @Y30LB33*/
*                                                                  1571
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP DESCRIPTION BACKOUT                        @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1572
*       IF BASDESCR^=BLANK30&       /*                       @Y30LB33*/
*           (ADDR(DESCR)>0×ADDR(NDESC)>0)/*                  @Y30LB33*/
*         THEN                                                     1572
@RF01567 CLC   BASDESCR(30,BASEVPTR),BLANK30                       1572
         BE    @RF01572                                            1572
         SLR   @02,@02                                             1572
         L     @15,@PC00001+4                                      1572
         C     @02,FDTPTR+56(,@15)                                 1572
         BL    @RT01572                                            1572
         C     @02,FDTPTR+80(,@15)                                 1572
         BNL   @RF01572                                            1572
@RT01572 DS    0H                                                  1573
*         DO;                       /*                       @Y30LB33*/
*           DEFDESCR=BASDESCR;      /*                       @Y30LB33*/
         MVC   DEFDESCR(30,DEFVEPTR),BASDESCR(BASEVPTR)            1574
*           DEFPDESC=ON;            /*                       @Y30LB33*/
         OI    DEFPDESC(DEFVEPTR),B'00010000'                      1575
*         END;                      /*                       @Y30LB33*/
*       IF BASDESCR=BLANK30&        /*                       @Y30LB33*/
*           ADDR(DESCR)>0 THEN                                     1577
@RF01572 CLC   BASDESCR(30,BASEVPTR),BLANK30                       1577
         BNE   @RF01577                                            1577
         L     @02,@PC00001+4                                      1577
         L     @02,FDTPTR+56(,@02)                                 1577
         LTR   @02,@02                                             1577
         BNP   @RF01577                                            1577
*         DEFNDESC=ON;              /*                       @Y30LB33*/
*                                                                  1578
         OI    DEFNDESC(DEFVEPTR),B'01000000'                      1578
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP THE RETENTION OR EXPIRATION BACKOUT        @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1579
*       IF                          /*                       @Y30LB33*/
*                                                                  1579
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE EXPIR DATE NOT NULL                        @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1579
*           BASEXPDT^=NULLEFFS&     /*                       @Y30LB33*/
*                                                                  1579
*       /*************************************************************/
*       /*                                                           */
*       /* AND USER WANTS A CHANGE                           @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1579
*           (ADDR(TO)>0×ADDR(FORE)>0×ADDR(NRET)>0)/*         @Y30LB33*/
*         THEN                                                     1579
@RF01577 CLC   BASEXPDT(4,BASEVPTR),NULLEFFS                       1579
         BE    @RF01579                                            1579
         SLR   @02,@02                                             1579
         L     @15,@PC00001+4                                      1579
         C     @02,FDTPTR+60(,@15)                                 1579
         BL    @RT01579                                            1579
         C     @02,FDTPTR+96(,@15)                                 1579
         BL    @RT01579                                            1579
         C     @02,FDTPTR+84(,@15)                                 1579
         BNL   @RF01579                                            1579
@RT01579 DS    0H                                                  1580
*         DO;                       /*                       @Y30LB33*/
*                                                                  1580
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP VALUE FROM VOL RECORD                  @Y30LB33*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1581
*           DEFTO=BASEXPDT;         /*                       @Y30LB33*/
         MVC   DEFTO(4,DEFVEPTR),BASEXPDT(BASEVPTR)                1581
*           DEFPTO=ON;              /*                       @Y30LB33*/
         OI    DEFPTO(DEFVEPTR),B'00001000'                        1582
*         END;                      /*                       @Y30LB33*/
*       IF                                                         1584
*                                                                  1584
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXPDT IS NULL AND                              @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1584
*           BASEXPDT=NULLEFFS&      /*                       @Y30LB33*/
*                                                                  1584
*       /*************************************************************/
*       /*                                                           */
*       /* USER WANTS A CHANGE                               @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1584
*           (ADDR(TO)>0×ADDR(FORE)>0×ADDR(NRET)>0)/*         @Y30LB33*/
*                                                                  1584
*       /*************************************************************/
*       /*                                                           */
*       /* THEN WE NULL THE FIELD                            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1584
*         THEN                                                     1584
@RF01579 CLC   BASEXPDT(4,BASEVPTR),NULLEFFS                       1584
         BNE   @RF01584                                            1584
         SLR   @02,@02                                             1584
         L     @15,@PC00001+4                                      1584
         C     @02,FDTPTR+60(,@15)                                 1584
         BL    @RT01584                                            1584
         C     @02,FDTPTR+96(,@15)                                 1584
         BL    @RT01584                                            1584
         C     @02,FDTPTR+84(,@15)                                 1584
         BNL   @RF01584                                            1584
@RT01584 DS    0H                                                  1585
*         DEFNEXPD=ON;              /*                       @Y30LB33*/
*                                                                  1585
         OI    DEFNEXPD(DEFVEPTR),B'00100000'                      1585
*       /*************************************************************/
*       /*                                                           */
*       /* IF LABEL MISMATCH IS OFF IN THE VOLUME            @Y30LB33*/
*       /* RECORD, THEN SET IT OFF IN THE BACKOUT            @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1586
*       IF BASVSMIS=OFF THEN                                       1586
@RF01584 TM    BASVSMIS(BASEVPTR),B'00100000'                      1586
         BNZ   @RF01586                                            1586
*         DO;                       /*                       @Y30LB33*/
*           DEFLAMIS=ON;            /*                       @Y30LB33*/
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1588
*           DEFCRCVY=ON;            /*                       @Y30LB33*/
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1589
*           DEFPVLAB=ON;            /*                       @Y30LB33*/
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1590
*           DEFLABEL=MVBLANKS;      /*                       @Y30LB33*/
         MVC   DEFLABEL(6,DEFVEPTR),@CC01575                       1591
*         END;                      /*                       @Y30LB33*/
*                                                                  1592
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME IS GROUPED, SET UP THE BACKOUT      @Y30LB33*/
*       /* ARGUMENT TO RESTORE THE VOLUME TO ITS GROUPED     @Y30LB33*/
*       /* POSITION AND SET UP THE FLAGS TO RESTORE IT       @Y30LB33*/
*       /* TO GENERAL OR RESTRICTED                          @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1593
*       IF BASGRPV=ON THEN          /*                       @ZA05148*/
@RF01586 TM    BASGRPV(BASEVPTR),B'00100000'                       1593
         BNO   @RF01593                                            1593
*         DO;                       /*                       @ZA05148*/
*           IF BASGENUS=ON THEN     /*                       @ZA05148*/
         TM    BASGENUS(BASEVPTR),B'00010000'                      1595
         BNO   @RF01595                                            1595
*             DEFGENUS=ON;          /*                       @ZA05148*/
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1596
*           IF BASRSTD=ON THEN      /*                       @ZA05148*/
@RF01595 TM    BASRSTD(BASEVPTR),B'00001000'                       1597
         BNO   @RF01597                                            1597
*             DEFRSTD=ON;           /*                       @ZA05148*/
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1598
*         END;                      /*                       @ZA05148*/
@RF01597 DS    0H                                                  1600
*     END;                          /*                       @Y30LB33*/
*                                                                  1600
@RF01593 DS    0H                                                  1601
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP THE ARGUMENT LIST AND THE BACKOUT LIST           @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1601
*   IF GDTDBG=NULLPTR THEN                                         1601
@RF01555 L     @05,@PC00001                                        1601
         L     @05,GDTDBG(,@05)                                    1601
         LTR   @05,@05                                             1601
         BZ    @RT01601                                            1601
*     ;                                                            1602
*   ELSE                                                           1603
*     DO;                                                          1603
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1604
*       DMPITMNM='MVDEFVE';                                        1605
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1605
         MVC   DMPITMNM(7,DMPINDEX),@CC01793                       1605
*       DMPITMPT=ADDR(MVDEFVE);                                    1606
         LA    @05,MVDEFVE                                         1606
         ST    @05,DMPITMPT(,DMPINDEX)                             1606
*       DMPITMLN=LENGTH(DEFVE);                                    1607
         LA    @05,64                                              1607
         STH   @05,DMPITMLN(,DMPINDEX)                             1607
*       DMPITMTP='H';                                              1608
         MVI   DMPITMTP(DMPINDEX),C'H'                             1608
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1609
*                                                                  1609
         LA    @15,16                                              1609
         ALR   DMPINDEX,@15                                        1609
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB33*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1610
*       DMPITMNM='BKDEFVE';                                        1610
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1610
         MVC   DMPITMNM(7,DMPINDEX),@CC01794                       1610
*       DMPITMPT=ADDR(BKDEFVE);                                    1611
         LA    @14,BKDEFVE                                         1611
         ST    @14,DMPITMPT(,DMPINDEX)                             1611
*       DMPITMLN=LENGTH(DEFVE);                                    1612
         STH   @05,DMPITMLN(,DMPINDEX)                             1612
*       DMPITMTP='H';                                              1613
         MVI   DMPITMTP(DMPINDEX),C'H'                             1613
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/
         ALR   DMPINDEX,@15                                        1614
*       DMPTRM=DMPTRMVL;                                           1615
         MVI   DMPTRM(DMPINDEX),X'FF'                              1615
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         1617
@RT01601 L     @05,@PC00001                                        1617
         L     @05,GDTDBG(,@05)                                    1617
         LTR   @05,@05                                             1617
         BZ    @RT01617                                            1617
*     ;                                                            1618
*   ELSE                                                           1619
*     CALL IDCDB010(GDTTBL,'MVVB',DUMPADDR);/*               @Y30LB33*/
*                                                                  1619
         L     @05,@PC00001                                        1619
         ST    @05,@AL00001                                        1619
         LA    @02,@CC01795                                        1619
         ST    @02,@AL00001+4                                      1619
         LA    @02,DUMPADDR                                        1619
         ST    @02,@AL00001+8                                      1619
         MVI   @AL00001+8,X'80'                                    1619
         L     @15,GDTDBG(,@05)                                    1619
         LA    @01,@AL00001                                        1619
         BALR  @14,@15                                             1619
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE POINTERS TO THE ADDRESSES OF THE              @Y30LB33*/
*   /* LISTS OF THE ORIGINAL ARGUMENTS                       @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1620
*   DEFVEPTR=ADDR(MVDEFVE);         /*                       @Y30LB33*/
@RT01617 LA    DEFVEPTR,MVDEFVE                                    1620
*   DEFVPTR=ADDR(MVDEFLST);         /*                       @Y30LB33*/
*                                                                  1621
         LA    @02,MVDEFLST                                        1621
         ST    @02,DEFVPTR                                         1621
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1622
*   REG14=BLDESV;                   /*                       @Y30LB33*/
         LR    REG14,BLDESV                                        1622
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1623
@EL00023 DS    0H                                                  1623
@EF00023 DS    0H                                                  1623
@ER00023 BR    @14                                                 1623
*   END BLDEXT;                     /*                       @Y30LB33*/
*                                                                  1625
*/********************************************************   @Y30LB33*/
*/* PROCEDURE NAME - BLDMVR                                  @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* FUNCTION - TO BUILD THE PARAMETERS LIST FOR              @Y30LB33*/
*/*    MODIFYING MSVC VOLUME RECORDS ONLY                    @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* INPUT - THE FDTTBL, SWCHBITS, AND THE VOLUME             @Y30LB33*/
*/*    RECORD                                                @Y30LB33*/
*/*                                                          @Y30LB33*/
*/* OUTPUT - RETURN CODE OF ZERO                             @Y30LB33*/
*/********************************************************   @Y30LB33*/
*                                                                  1625
*BLDMVR:                                                           1625
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB33*/
*                                                                  1625
BLDMVR   DS    0H                                                  1626
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN ADDRESS SAVE AREA                              @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1626
*   DCL                                                            1626
*     BLDMSV PTR(31);               /*                       @Y30LB33*/
*   BLDMSV=REG14;                   /*                       @Y30LB33*/
         LR    BLDMSV,REG14                                        1627
*   OLDERID2=NEWERID2;                                             1628
         L     @02,@PC00001                                        1628
         L     @02,GDTTR2(,@02)                                    1628
         MVC   @TS00001(95),NEWERID2(@02)                          1628
         MVC   OLDERID2(95,@02),@TS00001                           1628
*   NEWID2='MVWA';                  /*                       @Y30LB33*/
         MVC   NEWID2(4,@02),@CC01800                              1629
*   MVR=MVR&&MVR;                   /*                       @Y30LB33*/
         L     @02,MVRPTR                                          1630
         XC    MVR(88,@02),MVR(@02)                                1630
*   MVRCODE=MVROP;                  /*                       @Y30LB33*/
         XC    MVRCODE+1(3,@02),MVRCODE+1(@02)                     1631
         MVI   MVRCODE(@02),X'85'                                  1631
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB33*/
         LH    @15,MVRLEN                                          1632
         ST    @15,MVRLNGTH(,@02)                                  1632
*   MVRBVOL=VOLVAL;                 /*                       @Y30LB33*/
         L     @15,@PC00001+4                                      1633
         L     @01,FDTPTR(,@15)                                    1633
         MVC   MVRBVOL(6,@02),VOLVAL(@01)                          1633
*   MVRFLBAS=ON;                    /*                       @Y30LB33*/
*                                                                  1634
         OI    MVRFLBAS(@02),B'00100000'                           1634
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE RETENTION OR EXPIRATION CHANGES            @Y30LB33*/
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1635
*   IF ADDR(NRET)>0 THEN                                           1635
         L     @15,FDTPTR+84(,@15)                                 1635
         LTR   @15,@15                                             1635
         BNP   @RF01635                                            1635
*     MVRNEXPD=ON;                  /*                       @Y30LB33*/
         OI    MVRNEXPD(@02),B'00000100'                           1636
*   IF ADDR(TO)>0 THEN                                             1637
@RF01635 L     @02,@PC00001+4                                      1637
         L     @02,FDTPTR+60(,@02)                                 1637
         LTR   @02,@02                                             1637
         BNP   @RF01637                                            1637
*     DO;                           /*                       @Y30LB33*/
*       CVD(TOVAL,MVRTO);           /*                       @Y30LB33*/
         L     @02,TOVAL(,@02)                                     1639
         L     @15,MVRPTR                                          1639
         CVD   @02,@TS00001                                        1639
         MVC   MVRTO(4,@15),@TS00001+4                             1639
*       MVRFLTO=ON;                 /*                       @Y30LB33*/
         OI    MVRFLTO(@15),B'00001000'                            1640
*       MVRNEXPD=OFF;               /*                       @Y30LB33*/
         NI    MVRNEXPD(@15),B'11111011'                           1641
*     END;                          /*                       @Y30LB33*/
*   IF ADDR(FORE)>0 THEN                                           1643
@RF01637 L     @02,@PC00001+4                                      1643
         L     @02,FDTPTR+96(,@02)                                 1643
         LTR   @02,@02                                             1643
         BNP   @RF01643                                            1643
*     DO;                           /*                       @Y30LB33*/
*       MVRFLFOR=ON;                /*                       @Y30LB33*/
         L     @15,MVRPTR                                          1645
         OI    MVRFLFOR(@15),B'10000000'                           1645
*       MVRFOR=FOREVAL;             /*                       @Y30LB33*/
         L     @02,FOREVAL(,@02)                                   1646
         STH   @02,MVRFOR(,@15)                                    1646
*       MVRNEXPD=OFF;               /*                       @Y30LB33*/
         NI    MVRNEXPD(@15),B'11111011'                           1647
*     END;                          /*                       @Y30LB33*/
*                                                                  1648
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ANY GROUP CHANGE                               @Y30LB33*/
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1649
*   IF ADDR(NGRP)>0 THEN                                           1649
@RF01643 L     @02,@PC00001+4                                      1649
         L     @02,FDTPTR+76(,@02)                                 1649
         LTR   @02,@02                                             1649
         BNP   @RF01649                                            1649
*     MVRNGRP=ON;                   /*                       @Y30LB33*/
         L     @02,MVRPTR                                          1650
         OI    MVRNGRP(@02),B'00100000'                            1650
*   IF ADDR(GRP)>0 THEN                                            1651
@RF01649 L     @02,@PC00001+4                                      1651
         L     @02,FDTPTR+12(,@02)                                 1651
         LTR   @02,@02                                             1651
         BNP   @RF01651                                            1651
*     DO;                           /*                       @Y30LB33*/
*       MVRGROUP=GRPVAL;            /*                       @Y30LB33*/
         L     @15,MVRPTR                                          1653
         MVC   MVRGROUP(8,@15),GRPVAL(@02)                         1653
*       MVRFLGRO=ON;                /*                       @Y30LB33*/
         OI    MVRFLGRO(@15),B'01000000'                           1654
*       MVRNGRP=OFF;                /*                       @Y30LB33*/
         NI    MVRNGRP(@15),B'11011111'                            1655
*     END;                          /*                       @Y30LB33*/
*                                                                  1656
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP DESCRIPTION CHANGES                            @Y30LB33*/
*   /* IF BOTH NULL AND UPDATE ASKED, OVERRIDE NULL          @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1657
*   IF ADDR(NDESC)>0 THEN                                          1657
@RF01651 L     @02,@PC00001+4                                      1657
         L     @02,FDTPTR+80(,@02)                                 1657
         LTR   @02,@02                                             1657
         BNP   @RF01657                                            1657
*     MVRNDESC=ON;                  /*                       @Y30LB33*/
         L     @02,MVRPTR                                          1658
         OI    MVRNDESC(@02),B'00001000'                           1658
*   IF ADDR(DESCR)>0 THEN                                          1659
@RF01657 L     @02,@PC00001+4                                      1659
         L     @02,FDTPTR+56(,@02)                                 1659
         LTR   @02,@02                                             1659
         BNP   @RF01659                                            1659
*     DO;                           /*                       @Y30LB33*/
*       MVRDES=DESCRVAL;            /*                       @Y30LB33*/
         L     @15,MVRPTR                                          1661
         MVC   MVRDES(30,@15),DESCRVAL(@02)                        1661
*       MVRFLDES=ON;                /*                       @Y30LB33*/
         OI    MVRFLDES(@15),B'00010000'                           1662
*       MVRNDESC=OFF;               /*                       @Y30LB33*/
         NI    MVRNDESC(@15),B'11110111'                           1663
*     END;                          /*                       @Y30LB33*/
*                                                                  1664
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP GENERAL OR RESTRICTED                          @Y30LB33*/
*   /* IF IT IS BECOMMING GENERAL, TURN ON GENERAL           @Y30LB33*/
*   /* SWITCH                                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1665
*   IF NEWGENSW=ON THEN                                            1665
@RF01659 TM    NEWGENSW,B'00000100'                                1665
         BNO   @RF01665                                            1665
*     MVRGEN=ON;                    /*                       @Y30LB33*/
*                                                                  1666
         L     @02,MVRPTR                                          1666
         OI    MVRGEN(@02),B'10000000'                             1666
*   /*****************************************************************/
*   /*                                                               */
*   /* IF VOLUME BECOMING RESTRICTED                         @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1667
*   IF ADDR(RSTR)>0                 /*                       @Y30LB33*/
*     THEN                                                         1667
@RF01665 L     @02,@PC00001+4                                      1667
         L     @02,FDTPTR+20(,@02)                                 1667
         LTR   @02,@02                                             1667
         BNP   @RF01667                                            1667
*     MVRRSTD=ON;                   /*                       @Y30LB33*/
*                                                                  1668
         L     @02,MVRPTR                                          1668
         OI    MVRRSTD(@02),B'01000000'                            1668
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE BACKUP NUMBER IF SPECIFIED                 @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1669
*   IF ADDR(BKUP)>0 THEN                                           1669
@RF01667 L     @02,@PC00001+4                                      1669
         L     @02,FDTPTR+64(,@02)                                 1669
         LTR   @02,@02                                             1669
         BNP   @RF01669                                            1669
*     DO;                           /*                       @Y30LB33*/
*       MVRBKUPN=BKUPVAL;           /*                       @Y30LB33*/
         L     @15,MVRPTR                                          1671
         MVC   MVRBKUPN(1,@15),BKUPVAL+3(@02)                      1671
*       MVRFLBK=ON;                 /*                       @Y30LB33*/
         OI    MVRFLBK(@15),B'00000010'                            1672
*     END;                          /*                       @Y30LB33*/
*                                                                  1673
*   /*****************************************************************/
*   /*                                                               */
*   /* DUMP THE PARAMETER LIST                               @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1674
*   IF GDTDBG=NULLPTR THEN                                         1674
@RF01669 L     @02,@PC00001                                        1674
         L     @02,GDTDBG(,@02)                                    1674
         LTR   @02,@02                                             1674
         BZ    @RT01674                                            1674
*     ;                                                            1675
*   ELSE                                                           1676
*     DO;                                                          1676
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB33*/
         LA    DMPINDEX,DUMPAREA                                   1677
*       DMPITMNM='MVR';                                            1678
         MVI   DMPITMNM+3(DMPINDEX),C' '                           1678
         MVC   DMPITMNM+4(4,DMPINDEX),DMPITMNM+3(DMPINDEX)         1678
         MVC   DMPITMNM(3,DMPINDEX),@CC01771                       1678
*       DMPITMPT=ADDR(MVR);                                        1679
         L     @15,MVRPTR                                          1679
         ST    @15,DMPITMPT(,DMPINDEX)                             1679
*       DMPITMLN=LENGTH(MVR);                                      1680
         MVC   DMPITMLN(2,DMPINDEX),@CH01823                       1680
*       DMPITMTP='H';                                              1681
         MVI   DMPITMTP(DMPINDEX),C'H'                             1681
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB33*/
         AL    DMPINDEX,@CF00507                                   1682
*       DMPTRM=DMPTRMVL;                                           1683
         MVI   DMPTRM(DMPINDEX),X'FF'                              1683
*     END;                          /*                       @Y30LB33*/
*   IF GDTDBG=NULLPTR THEN                                         1685
@RT01674 L     @02,@PC00001                                        1685
         L     @02,GDTDBG(,@02)                                    1685
         LTR   @02,@02                                             1685
         BZ    @RT01685                                            1685
*     ;                                                            1686
*   ELSE                                                           1687
*     CALL IDCDB010(GDTTBL,'MVWB',DUMPADDR);/*               @Y30LB33*/
*                                                                  1687
         L     @02,@PC00001                                        1687
         ST    @02,@AL00001                                        1687
         LA    @15,@CC01801                                        1687
         ST    @15,@AL00001+4                                      1687
         LA    @15,DUMPADDR                                        1687
         ST    @15,@AL00001+8                                      1687
         MVI   @AL00001+8,X'80'                                    1687
         L     @15,GDTDBG(,@02)                                    1687
         LA    @01,@AL00001                                        1687
         BALR  @14,@15                                             1687
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE RETURN ADDRESS                                @Y30LB33*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1688
*   REG14=BLDMSV;                   /*                       @Y30LB33*/
@RT01685 LR    REG14,BLDMSV                                        1688
*   RETURN CODE(0);                 /*                       @Y30LB33*/
         SLR   @15,@15                                             1689
@EL00024 DS    0H                                                  1689
@EF00024 DS    0H                                                  1689
@ER00024 BR    @14                                                 1689
*   END BLDMVR;                     /*                       @Y30LB33*/
*                                                                  1691
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1691
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1691
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00025                                    1691
         MVC   @PC00025(8),0(@01)                                  1691
*                                   /*                       @Y30LB39*/
*                                                                  1692
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1692
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1692
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1692
*                                   /*                       @Y30LB39*/
*   DCL                                                            1692
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1693
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1693
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1694
*                                   /*                       @Y30LB39*/
*   DCL                                                            1694
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1695
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1695
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1696
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1696
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1696
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1697
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1697
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1697
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1698
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1698
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1698
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1699
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1699
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1699
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1700
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1700
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1701
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1701
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1701
         L     @15,@PC00001                                        1701
         L     @14,GDTTR2(,@15)                                    1701
         MVC   @TS00001(95),NEWERID2(@14)                          1701
         MVC   OLDERID2(95,@14),@TS00001                           1701
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1702
         MVC   NEWID2(4,@14),@CC01822                              1702
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1703
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1703
         LA    @14,SSDRGLT                                         1703
         ST    @14,SSDLPTR                                         1703
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1704
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1704
         L     @07,@PC00025                                        1704
         L     @07,SSRCODE(,@07)                                   1704
         LTR   @07,@07                                             1704
         BNP   @RF01704                                            1704
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1705
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1706
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1706
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1707
         ST    @03,DARGRETP(,@14)                                  1707
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            1708
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 1709
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1710
         MVC   DARGRETL(2,@14),@CH01837                            1710
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1711
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1711
         ST    @15,@AL00001                                        1711
         LA    @03,@CF00117                                        1711
         ST    @03,@AL00001+4                                      1711
         LA    @03,SSDLPTR                                         1711
         ST    @03,@AL00001+8                                      1711
         MVI   @AL00001+8,X'80'                                    1711
         L     @15,GDTPRT(,@15)                                    1711
         LA    @01,@AL00001                                        1711
         BALR  @14,@15                                             1711
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1712
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1712
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   1713
@DL01713 DS    0H                                                  1714
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00221                                   1714
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1715
@DE01713 L     @03,@PC00025                                        1715
         LR    @15,ENTRYNUM                                        1715
         ALR   @15,@15                                             1715
         LH    @15,SSARRAY-2(@15)                                  1715
         CH    @15,SSRHALF(,@03)                                   1715
         BE    @DC01713                                            1715
         SLR   @14,@14                                             1715
         CR    @15,@14                                             1715
         BNE   @DL01713                                            1715
@DC01713 DS    0H                                                  1716
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1716
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1716
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @07,SSDLPTR                                         1717
         MVC   DARGSMOD(3,@07),SSMODSS0                            1717
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@07)                             1718
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @15,@14                                             1719
         BNE   @RF01719                                            1719
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @03,DARGDBP(,@07)                                   1721
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@07),@CH00043                             1722
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1725
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1725
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01704                                            1725
@RF01704 DS    0H                                                  1726
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1726
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @15,SSDLPTR                                         1727
         MVC   DARGSMOD(3,@15),SSMODCM0                            1727
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            1728
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @14,@PC00025+4                                      1729
         ST    @14,DARGDBP(,@15)                                   1729
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@15),@CH00221                             1730
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1731
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1732
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1732
@RC01704 L     @15,@PC00001                                        1732
         ST    @15,@AL00001                                        1732
         LA    @14,@CF00117                                        1732
         ST    @14,@AL00001+4                                      1732
         LA    @14,SSDLPTR                                         1732
         ST    @14,@AL00001+8                                      1732
         MVI   @AL00001+8,X'80'                                    1732
         L     @15,GDTPRT(,@15)                                    1732
         LA    @01,@AL00001                                        1732
         BALR  @14,@15                                             1732
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1733
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1733
         L     @14,@SA00025                                        1733
         LM    @00,@12,@SA00025+8                                  1733
         BR    @14                                                 1733
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCMV01                     /*                       @Y30LB33*/
*                                                                  1735
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */
*/*%INCLUDE SYSLIB  (IDCCSMV )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1735
*       ;                                                          1735
@DATA    DS    0H
@CH00156 DC    H'2'
@CH00297 DC    H'5'
@CH00159 DC    H'6'
@CH01468 DC    H'23'
@CH01826 DC    H'64'
@CH01833 DC    H'68'
@CH01823 DC    H'88'
@CH01837 DC    H'120'
@CH01836 DC    H'132'
@CH01834 DC    H'164'
@CH01832 DC    H'224'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00003 DS    1F
@SA00025 DS    15F
@PC00025 DS    2F
@PC00016 DS    1F
@AL00001 DS    5A
IDCMV01  CSECT
         DS    0F
@CF00117 DC    F'0'
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00043 DC    F'4'
@CH00043 EQU   @CF00043+2
@CF00035 DC    F'8'
@CH00035 EQU   @CF00035+2
@CF00038 DC    F'12'
@CH00038 EQU   @CF00038+2
@CF00507 DC    F'16'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
MVRPTR   DS    A
DEFVPTR  DS    A
MVUCBPTR DS    A
IOCTLBKP DS    A
RCAREA   DS    F
DUMPADDR DS    A
CKOUTSV  DS    A
GRPROCSV DS    A
DLSUCB   DS    A
DOITSV   DS    A
CKAUTHSV DS    A
MODFYSV  DS    A
LABELSV  DS    A
NEWLABSV DS    A
BACKSV   DS    A
BLDLSV   DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
SETRC    DS    H
MYBAKUP  DS    FL1
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
SWCHBITS DS    CL2
         ORG   SWCHBITS
DMNTSW   DS    BL1
RENAMSW  EQU   SWCHBITS+0
ATTRSW   EQU   SWCHBITS+0
MSVCSW   EQU   SWCHBITS+0
GRPRCD   EQU   SWCHBITS+0
INACTSW  EQU   SWCHBITS+0
COPYATTR EQU   SWCHBITS+0
MISCLEAR EQU   SWCHBITS+0
ONLYONLY DS    BL1
CKSW     EQU   SWCHBITS+1
MNTSW    EQU   SWCHBITS+1
COPYRW   EQU   SWCHBITS+1
VOLRCD   EQU   SWCHBITS+1
NEWGENSW EQU   SWCHBITS+1
         ORG   SWCHBITS+2
MYVVFLG  DS    BL1
MVALLULP DS    CL12
         ORG   MVALLULP
MVALLUNO DS    FL2
MVALLULN DS    FL2
MVALLUNT DS    CL8
         ORG   MVALLULP+12
MVALLVLP DS    CL10
         ORG   MVALLVLP
MVALLVNO DS    FL2
MVALLVLN DS    FL2
MVALLVOL DS    CL6
         ORG   MVALLVLP+10
ECBBYTE  DS    CL1
MVMAJNAM DS    CL8
MVMINNAM DS    CL23
         ORG   MVMINNAM
MINAMLN  DS    CL1
MINAMVOL DS    CL6
MINAMQL  DS    CL16
         ORG   MVMINNAM+23
MVDDNAME DS    CL8
MVVOLUME DS    CL6
         DS    CL2
MVOPNAGL DS    BL48
MVDRGLST DS    CL36
MVDEFLST DS    CL132
MVDEFVE  DS    CL64
BKDEFLST DS    CL132
BKDEFVE  DS    CL64
MVMVRLST DS    CL88
MVRVVI   DS    CL68
MVCKAGL  DS    CL29
         DS    CL3
MVMDAGL  DS    CL37
         DS    CL3
MVALLAGL DS    CL31
         DS    CL1
MVSELAGL DS    CL23
         DS    CL1
MVVS1AGL DS    CL74
         DS    CL2
MVVS2AGL DS    CL52
VOLRCDBF DS    CL224
GRPRCDBF DS    CL164
MVEXAGL  DS    CL23
DUMPAREA DS    CL33
TEMPVAL  DS    CL5
         ORG   TEMPVAL
VTOCCCHH DS    CL4
         ORG   VTOCCCHH
VTOCCC   DS    CL2
VTOCHH   DS    CL2
         ORG   TEMPVAL+4
VTOCR    DS    CL1
         ORG   TEMPVAL+5
DLSDDN   DS    CL8
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCMV01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
DEFLEN   DC    AL2(64)
MVRLEN   DC    AL2(88)
SSMSGNUM DC    AL1(56)
@CC01586 DC    C'.VIRTUAL.ENQUEUE'
@CC01589 DC    C'.VIRTUAL.RESERVE'
@CC01575 DC    C'          '
@CC01573 DC    C'SYSGROUP'
@CC01584 DC    C'SYSZAMS '
@CC01705 DC    C'IDCVS01 '
@CC01758 DC    C'IDCVS02 '
@CC01785 DC    C'BKDEFLST'
@CC01648 DC    C'EXCLAGL'
@CC01739 DC    C'DEFLIST'
@CC01793 DC    C'MVDEFVE'
@CC01794 DC    C'BKDEFVE'
@CC01570 DC    C'3330V'
@CC01764 DC    C'DEFVE'
@CC01637 DC    C'MVAA'
@CC01645 DC    C'MVBA'
@CC01650 DC    C'MVBB'
@CC01654 DC    C'MVRL'
@CC01662 DC    C'MVDA'
@CC01663 DC    C'RVVI'
@CC01664 DC    C'MVDB'
@CC01671 DC    C'MVEA'
@CC01676 DC    C'MVGB'
@CC01685 DC    C'MVDL'
@CC01690 DC    C'MVGC'
@CC01695 DC    C'MVCA'
@CC01703 DC    C'MVFA'
@CC01710 DC    C'MVGA'
@CC01717 DC    C'MVHA'
@CC01723 DC    C'MVIA'
@CC01729 DC    C'MVJA'
@CC01738 DC    C'MVNA'
@CC01740 DC    C'MVNB'
@CC01747 DC    C'MVOA'
@CC01752 DC    C'MVPA'
@CC01757 DC    C'MVQA'
@CC01763 DC    C'MVRA'
@CC01765 DC    C'MVRC'
@CC01770 DC    C'MVSA'
@CC01772 DC    C'MVSB'
@CC01777 DC    C'MVTA'
@CC01778 DC    C'MVTB'
@CC01783 DC    C'MVUA'
@CC01786 DC    C'MVUB'
@CC01791 DC    C'MVVA'
@CC01795 DC    C'MVVB'
@CC01800 DC    C'MVWA'
@CC01801 DC    C'MVWB'
@CC01822 DC    C'SSAA'
@CC01771 EQU   @CC01654
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
VTOCRR   DC    X'01'
MAXHH    DC    X'0012'
MODID    DC    CL4'MV01'
MODMV0   DC    CL3'MV0'
MODCMN   DC    CL3'CM0'
MODUNIV  DC    CL3'UV0'
BLANK30  DC    CL30'                              '
NULLEFFS DC    X'FFFFFFFF'
FIXAREA  DS    CL720
         ORG   FIXAREA
@NM00123 DS    CL720
         ORG   @NM00123
@NM00124 DC    240X'00'
@NM00125 DC    240X'00'
@NM00126 DC    240X'00'
         ORG   FIXAREA+720
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
BLDMSV   EQU   @03
BLDESV   EQU   @03
SETFLGSV EQU   @04
DMNTVSV  EQU   @04
MNTVOLSV EQU   @07
ALLOVSV  EQU   @07
ACTVOLSV EQU   @07
CHNG2SV  EQU   @07
CHNG1SV  EQU   @07
GRPCHKSV EQU   @07
DLSPCHSV EQU   @07
BVOLSV   EQU   @03
VOLCKSV  EQU   @07
DEFVEPTR EQU   @05
GROUPPTR EQU   @06
BASEVPTR EQU   @04
DMPINDEX EQU   @02
OPNPTR   EQU   @02
TESTRC   EQU   @03
RTNREG   EQU   @15
REG14    EQU   @14
DEFVR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IDCIO050 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDNEWVOL EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDVTOCTR EQU   MDFLAGS
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLVOL  EQU   EXCLAGL+16
EXCLFLAG EQU   EXCLAGL+22
EXCLMNT  EQU   EXCLFLAG
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSUCBPTR EQU   VS2AGL+8
VSOWNPTR EQU   VS2AGL+16
VSVOLPTR EQU   VS2AGL+20
VSIOBKPT EQU   VS2AGL+24
VSLABOPT EQU   VS2AGL+28
VSOWNER  EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLUME EQU   VS2AGL+29
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS2RES   EQU   VS2RESOP
VSDDNAME EQU   VS2AGL+37
VSVTOCPT EQU   VS2AGL+48
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSPFILEP EQU   VS1AGL+48
VSSECOPT EQU   VS1AGL+68
VSNOVSAM EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00074 EQU   SV82LIST+4
SV82DCBP EQU   @NM00074
@NM00075 EQU   SV82LIST+12
SV82WRKP EQU   @NM00075
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELUCBP  EQU   SELAGL+8
SELDDNP  EQU   SELAGL+12
SELVOL   EQU   SELAGL+16
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASDLSF  EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASEXCL  EQU   BASFLAGA+2
BASDAERA EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASCSN1  EQU   BASEV+24
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASNBKUP EQU   BASEV+63
BASBKLMT EQU   BASEV+64
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASEXPDT EQU   BASEV+96
BASDESCR EQU   BASEV+104
BASOWNER EQU   BASEV+134
BASRECOV EQU   BASEV+174
BASGROUP EQU   BASEV+180
GROUP    EQU   0
GRONAME  EQU   GROUP
GROVVGRP EQU   GRONAME+3
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROBIND  EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GROERRTS EQU   GROUP+56
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVGROUP EQU   RVVI+14
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSGRP  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
DEFVE    EQU   0
DEFLNGTH EQU   DEFVE
DEFGROUP EQU   DEFVE+4
DEFDESCR EQU   DEFVE+12
DEFTO    EQU   DEFVE+42
DEFFOR   EQU   DEFVE+46
DEFBKUPN EQU   DEFVE+48
DEFLABEL EQU   DEFVE+49
DEFFLAGA EQU   DEFVE+55
DEFPFOR  EQU   DEFFLAGA
DEFPVLAB EQU   DEFFLAGA
DEFPGRO  EQU   DEFFLAGA
DEFPDESC EQU   DEFFLAGA
DEFPTO   EQU   DEFFLAGA
DEFPBKUP EQU   DEFFLAGA
DEFFLAGB EQU   DEFVE+56
DEFSETFL EQU   DEFFLAGB
DEFSRCVY EQU   DEFSETFL
DEFCRCVY EQU   DEFSETFL
DEFRECFL EQU   DEFFLAGB+1
DEFLAMIS EQU   DEFRECFL
DEFTYPFL EQU   DEFFLAGB+2
DEFGENUS EQU   DEFTYPFL
DEFRSTD  EQU   DEFTYPFL
DEFNULFL EQU   DEFFLAGB+3
DEFNGRP  EQU   DEFNULFL
DEFNDESC EQU   DEFNULFL
DEFNEXPD EQU   DEFNULFL
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVRFLAGA EQU   MVR+8
MVRFLFOR EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLBAS EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLLAB EQU   MVRFLAGA
MVRGEN   EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRCLMIS EQU   MVRFLAGA+1
MVRBVOL  EQU   MVR+12
MVRFOR   EQU   MVR+18
MVRGROUP EQU   MVR+20
MVRDES   EQU   MVR+28
MVRTO    EQU   MVR+58
MVRBKUPN EQU   MVR+74
MVRLABEL EQU   MVR+76
DEFLIST  EQU   0
DEFVFLG  EQU   DEFLIST+6
DEFVRNM  EQU   DEFVFLG
DEFVREP  EQU   DEFVFLG
DEFVRNTR EQU   DEFVFLG
DEFVACT  EQU   DEFVFLG
DEFVLIB  EQU   DEFLIST+7
DEFVOLD  EQU   DEFLIST+8
DEFVVFLG EQU   DEFLIST+14
DEFVSEC  EQU   DEFVVFLG
DEFVEXCL EQU   DEFVVFLG
DEFVBIND EQU   DEFVVFLG
DEFVWINH EQU   DEFVVFLG
DEFVNVOL EQU   DEFLIST+16
DEFVCSN1 EQU   DEFLIST+24
DEFVDATA EQU   DEFLIST+56
DEFOWNID EQU   DEFVDATA+29
DEFVVEXT EQU   DEFLIST+128
VOL      EQU   0
VOLVAL   EQU   VOL+1
NEWSR    EQU   0
NEWSRVAL EQU   NEWSR+1
OWNER    EQU   0
OWNERVAL EQU   OWNER+1
GRP      EQU   0
GRPVAL   EQU   GRP+1
GNRL     EQU   0
RSTR     EQU   0
BIND     EQU   0
NBIND    EQU   0
EXECL    EQU   0
SHRD     EQU   0
RONLY    EQU   0
RW       EQU   0
DERAS    EQU   0
NDERS    EQU   0
DESCR    EQU   0
DESCRVAL EQU   DESCR+1
TO       EQU   0
TOVAL    EQU   TO
BKUP     EQU   0
BKUPVAL  EQU   BKUP
NOWN     EQU   0
NGRP     EQU   0
NDESC    EQU   0
NRET     EQU   0
FYLE     EQU   0
FYLEVAL  EQU   FYLE+1
PSWD     EQU   0
@NM00122 EQU   PSWD+2
FORE     EQU   0
FOREVAL  EQU   FORE
RLBL     EQU   0
VADDR    EQU   0
VADDRVAL EQU   VADDR
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
NULFY    EQU   0
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
VOLARG   EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00127 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
PSWDVAL  EQU   @NM00122+1
PSWDLEN  EQU   @NM00122
PSWDCNT  EQU   PSWD
FYLELEN  EQU   FYLE
DESCRLEN EQU   DESCR
GRPLEN   EQU   GRP
OWNERLEN EQU   OWNER
NEWSRLEN EQU   NEWSR
VOLLEN   EQU   VOL
DEFTLAB  EQU   DEFVDATA+71
DEFR60   EQU   DEFVDATA+43
DEFR55   EQU   DEFVDATA+3
DEFACSEC EQU   DEFVDATA+2
DEFR50   EQU   DEFVDATA
DEFVECB  EQU   DEFLIST+52
DEFVASID EQU   DEFLIST+50
@NM00121 EQU   DEFLIST+48
DEFVCSN2 EQU   DEFLIST+36
@NM00120 EQU   DEFLIST+22
@NM00119 EQU   DEFLIST+15
@NM00118 EQU   DEFVVFLG
@NM00117 EQU   DEFVVFLG
@NM00116 EQU   DEFVVFLG
DEFVCECT EQU   DEFVVFLG
DEFVLID  EQU   DEFVLIB
@NM00115 EQU   DEFVLIB
DEFVDACT EQU   DEFVFLG
DEFVELTR EQU   DEFVFLG
DEFVELM  EQU   DEFVFLG
DEFVCR   EQU   DEFVFLG
@NM00114 EQU   DEFLIST+5
DEFVOPCD EQU   DEFLIST+4
DEFVLEN  EQU   DEFLIST
@NM00113 EQU   MVR+82
MVRBLNK1 EQU   MVR+75
MVRCSN   EQU   MVR+62
@NM00112 EQU   MVRFLAGA+2
MVRCICPY EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRSLMIS EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRFLCSN EQU   MVRFLAGA
@NM00111 EQU   MVRCODE+1
MVROPCD  EQU   MVRCODE
@NM00110 EQU   DEFVE+60
@NM00109 EQU   DEFNULFL
@NM00108 EQU   DEFTYPFL
DEFCOPY  EQU   DEFTYPFL
DEFDUP   EQU   DEFTYPFL
@NM00107 EQU   DEFRECFL
DEFCREAT EQU   DEFRECFL
DEFICOPY EQU   DEFRECFL
@NM00106 EQU   DEFSETFL
@NM00105 EQU   DEFFLAGA
@NM00104 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
@NM00103 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
@NM00102 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00101 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00100 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
@NM00099 EQU   RVVOPCOD+1
@NM00098 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GROSSPD  EQU   GROUP+38
GROPSPD  EQU   GROUP+36
GRONINAC EQU   GROUP+34
GRONRSTD EQU   GROUP+32
GRONGEN  EQU   GROUP+30
GROPCENT EQU   GROUP+29
GROLSN   EQU   GROUP+23
GROFSN   EQU   GROUP+17
@NM00097 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROG     EQU   GRONAME
@NM00096 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASDEST  EQU   BASEV+144
BASDTREM EQU   BASEV+100
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00095 EQU   BASEV+65
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00094 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASNOCPY EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00093 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00092 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00091 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00090 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00089 EQU   VSDSCR+5
@NM00088 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
@NM00087 EQU   VSDSTAT+29
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00086 EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00085 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00084 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00083 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00082 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00081 EQU   VSDVTOC
@NM00080 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00079 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00078 EQU   SELFLAGS
SELHEAD  EQU   SELAGL
@NM00077 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00076 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00073 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00072 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00071 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00070 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00069 EQU   RCTAGL+10
@NM00068 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00067 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
@NM00066 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00065 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00064 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00063 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSHEAD   EQU   VS1AGL
@NM00062 EQU   VS2AGL+45
@NM00061 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
@NM00060 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
@NM00059 EQU   VSLABOPT
VSVTOCSZ EQU   VS2AGL+12
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00058 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00057 EQU   EXSPACE+8
@NM00056 EQU   EXSPACE+6
@NM00055 EQU   EXSPACE+4
@NM00054 EQU   EXSPACE+1
@NM00053 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00052 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00051 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00050 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00049 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00048 EQU   EXCLFLAG
EXCLHEAD EQU   EXCLAGL
@NM00047 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00046 EQU   MDAGL+31
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00045 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00044 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00043 EQU   CMMSG+7
@NM00042 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00041 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00040 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00039 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00038 EQU   DMPITM+15
@NM00037 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00036 EQU   ERCNVTAB+4
@NM00035 EQU   ERCNVTAB+3
@NM00034 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00033 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00032 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00031 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00030 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00029 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00028 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00027 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00026 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00025 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
UNITUCB  EQU   UNITABL
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00628 EQU   @RC00618
@RF00768 EQU   @RC00765
@RF00938 EQU   @RC00935
@RF01410 EQU   @RC01402
@RF01468 EQU   @RC01460
@RF01719 EQU   @RC01704
@PB00025 EQU   @EL00001
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCMV01,(C'PLS2303',0603,76349)

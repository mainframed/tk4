         TITLE '**************** IDCSD01:   SCRDSET FSR ****************
               *********'
         MACRO
         GETMAIN &R,&LV=
         L     REG15,0(REG1)           GDTTBL ADDRESS
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
         CNOP  2,4                     BOUNDARY ALIGNMENT
         LA    REG14,*+14              RETURN ADDRESS
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
         DC    A(MODID)                MODULE ID ADDRESS
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
         MEND
IDCSD01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCSD01   76.306'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @11,4095(,@12)                                      0002
         LA    @10,4095(,@11)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@11                                    0002
         USING @PSTART+8190,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0002
         USING @DATD,@09                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @09,8(,@13)                                         0002
         LR    @13,@09                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THE EXECUTABLE PORTION OF        @Z40LB30*/
*   /* THE MODULE. THIS SECTION DOES INITIALIZATION,         @Z40LB30*/
*   /* CHECKS THE LEVEL PARAMETER FOR VALIDITY,              @Z40LB30*/
*   /* CALLS A PROCEDURE TO CALCULATE AN EXPIRATION          @Z40LB30*/
*   /* OR CREATION DATE, CALLS THE CORRECT PROCEDURE TO      @Z40LB30*/
*   /* EXECUTE THE FUNCTION REQUESTED ON THE COMMAND, AND    @Z40LB30*/
*   /* SETS THE LASTCOND FIELD.                              @Z40LB30*/
*   /*                                                       @Z40LB30*/
*   /* ESTABLISH TRACE POINT AND FULL REGION DUMP POINT      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   OLDERID2=NEWERID2;                                             0315
         L     @08,@PC00001                                        0315
         L     @15,GDTTR2(,@08)                                    0315
         MVC   @TS00001(95),NEWERID2(@15)                          0315
         MVC   OLDERID2(95,@15),@TS00001                           0315
*   NEWID2='SD01';                  /*                       @Z40LB30*/
         MVC   NEWID2(4,@15),@CC01361                              0316
*   IF GDTDBG=NULLPTR THEN                                         0317
         L     @08,GDTDBG(,@08)                                    0317
         LTR   @08,@08                                             0317
         BZ    @RT00317                                            0317
*     ;                                                            0318
*   ELSE                                                           0319
*     CALL IDCDB010(GDTTBL,'SDST'); /*                       @Z40LB30*/
*                                                                  0319
         L     @08,@PC00001                                        0319
         ST    @08,@AL00001                                        0319
         LA    @15,@CC01488                                        0319
         ST    @15,@AL00001+4                                      0319
         MVI   @AL00001+4,X'80'                                    0319
         L     @15,GDTDBG(,@08)                                    0319
         LA    @01,@AL00001                                        0319
         BALR  @14,@15                                             0319
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESSABILITY TO UPRINT AGRUMENT LIST            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB30*/
*                                                                  0320
@RT00317 LA    @08,DARGAREA                                        0320
         ST    @08,DDSTRU                                          0320
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO FLAG AREAS                                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0321
*   COMFLAGS=''B;                   /*                       @Z40LB30*/
         MVI   COMFLAGS,X'00'                                      0321
*   FLAGS=''B;                      /*                       @Z40LB30*/
*                                                                  0322
         MVI   FLAGS,X'00'                                         0322
*   /*****************************************************************/
*   /*                                                               */
*   /* SET ADDRESSABILITY TO VOLUME RECORD AND GROUP RECORD  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   BASEVPTR=ADDR(VOLREC);          /*                       @Z40LB30*/
         LA    BASEVPTR,VOLREC                                     0323
*   GROUPPTR=ADDR(GRPREC);          /*                       @Z40LB30*/
         LA    @04,GRPREC                                          0324
         ST    @04,GROUPPTR                                        0324
*                                                                  0325
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE LEVEL PARAMETER WAS SPECIFIED AND THE LAST     @Z40LB30*/
*   /* CHARACTER IS AN ASTERISK, ISSUE MESSAGE IDC3113I      @Z40LB30*/
*   /* AND SET THE LASTCOND FIELD                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IF ADDR(LEVEL)^=NULLPTR&LEVELPOS=LEVELLEN THEN/*         @Z40LB30*/
         L     @04,@PC00001+4                                      0325
         L     @04,FDTPTR+20(,@04)                                 0325
         LTR   @04,@04                                             0325
         BZ    @RF00325                                            0325
         CLC   LEVELPOS(1,@04),LEVELLEN(@04)                       0325
         BNE   @RF00325                                            0325
*     DO;                           /*                       @Z40LB30*/
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0327
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         MVC   DARGSMOD(3,@08),@CC01418                            0328
*       DARGSENT=MSG3113I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'45'                                 0329
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @08,@PC00001                                        0330
         ST    @08,@AL00001                                        0330
         LA    @04,@CF00116                                        0330
         ST    @04,@AL00001+4                                      0330
         LA    @04,DDSTRU                                          0330
         ST    @04,@AL00001+8                                      0330
         MVI   @AL00001+8,X'80'                                    0330
         L     @15,GDTPRT(,@08)                                    0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*       LASTCOND=LASTCC12;          /*                       @Z40LB30*/
         L     @08,@PC00001+8                                      0331
         MVC   LASTCOND(2,@08),@CH00035                            0331
*     END;                          /*                       @Z40LB30*/
*                                                                  0332
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FILE PARAMETER WAS SPECIFIED ON THE COMMAND,   @Z40LB30*/
*   /* ISSUE THE UMSSUNIT MACRO TO CHECK THAT IT IS          @Z40LB30*/
*   /* A VIRTUAL DEVICE AND A DEMOUNTABLE UNIT. SAVE THE     @Z40LB30*/
*   /* RETURN CODE AND SET THE LASTCOND FIELD.               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0333
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Z40LB30*/
@RF00325 SLR   @08,@08                                             0333
         L     @04,@PC00001+4                                      0333
         L     @04,FDTPTR+44(,@04)                                 0333
         CR    @04,@08                                             0333
         BE    @RF00333                                            0333
*     DO;                           /*                       @Z40LB30*/
*       RESPECIFY                                                  0335
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB30*/
*       CKAGL=''B;                  /*                       @Z40LB30*/
         LA    @02,CHKAREA                                         0336
         XC    CKAGL(29,@02),CKAGL(@02)                            0336
*       CKTESTVT=ON;                /* TEST FOR VIRTUAL      @Z40LB30*/
*       CKDMTABL=ON;                /* TEST FOR DEMOUNTABLE  @Z40LB30*/
         OI    CKTESTVT(@02),B'10100000'                           0338
*       CKDDNAME=FILEVAL;           /*                       @Z40LB30*/
         MVC   CKDDNAME(8,@02),FILEVAL(@04)                        0339
*       CKUCBPTR=ADDR(FILEUCB);     /* UCB ADDRESS TO BE RETURNED  0340
*                                                            @Z40LB30*/
         LA    @04,FILEUCB                                         0340
         ST    @04,CKUCBPTR(,@02)                                  0340
*       FILEUCB=NULLPTR;            /*                       @Z40LB30*/
         ST    @08,FILEUCB                                         0341
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB30*/
         L     @08,@PC00001                                        0342
         ST    @08,@AL00001                                        0342
         LA    @04,CHECK                                           0342
         ST    @04,@AL00001+4                                      0342
         ST    @02,@AL00001+8                                      0342
         MVI   @AL00001+8,X'80'                                    0342
         L     @15,GDTUNT(,@08)                                    0342
         LA    @01,@AL00001                                        0342
         BALR  @14,@15                                             0342
*       RESPECIFY                                                  0343
*         RTNREG RSTD;                                             0343
*       TESTRC=RTNREG;                                             0344
         LR    TESTRC,RTNREG                                       0344
*       RESPECIFY                                                  0345
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*       IF TESTRC^=0 THEN           /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0346
         BZ    @RF00346                                            0346
*         LASTCOND=LASTCC12;        /*                       @Z40LB30*/
         L     @08,@PC00001+8                                      0347
         MVC   LASTCOND(2,@08),@CH00035                            0347
*     END;                          /*                       @Z40LB30*/
@RF00346 DS    0H                                                  0349
*                                                                  0349
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALL CHECKS WERE SUCCESSFUL, CONTINUE WITH          @Z40LB30*/
*   /* PROCESSING                                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   IF LASTCOND=LASTCC00 THEN       /*                       @Z40LB30*/
@RF00333 SLR   @08,@08                                             0349
         L     @04,@PC00001+8                                      0349
         CH    @08,LASTCOND(,@04)                                  0349
         BNE   @RF00349                                            0349
*     DO;                           /*                       @Z40LB30*/
*       RESPECIFY                                                  0351
*         DATESAGL BASED(ADDR(DTSAREA));/*                   @Z40LB30*/
*                                                                  0351
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXPIRATION PARAMETERS WERE SPECIFIED ON        @Z40LB30*/
*       /* THE COMMAND, CALL THE DATES PROCEDURE TO          @Z40LB30*/
*       /* CALCULATE A DATE FOR COMPARISON                   @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0352
*       IF ADDR(EXPIR)^=NULLPTR×ADDR(EXPDT)^=NULLPTR/*       @Z40LB30*/
*         THEN                      /*                       @Z40LB30*/
         L     @04,@PC00001+4                                      0352
         C     @08,FDTPTR+32(,@04)                                 0352
         BNE   @RT00352                                            0352
         C     @08,FDTPTR+28(,@04)                                 0352
         BE    @RF00352                                            0352
@RT00352 DS    0H                                                  0353
*         DO;                       /*                       @Z40LB30*/
*           DATESAGL=''B;           /*                       @Z40LB30*/
         LA    @08,DTSAREA                                         0354
         XC    DATESAGL(21,@08),DATESAGL(@08)                      0354
*           DATRETRN=ADDR(EXPDATE); /* PLACE TO RETURN       @Z40LB30
*                                      DATE                  @Z40LB30*/
*                                                                  0355
         LA    @04,EXPDATE                                         0355
         ST    @04,DATRETRN(,@08)                                  0355
*           /*********************************************************/
*           /*                                                       */
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0356
*           IF ADDR(EXPIR)^=NULLPTR THEN/*                   @Z40LB30*/
         L     @04,@PC00001+4                                      0356
         L     @04,FDTPTR+32(,@04)                                 0356
         LTR   @04,@04                                             0356
         BZ    @RF00356                                            0356
*             DO;                   /*                       @Z40LB30*/
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB30*/
         OI    DATDAYOP(@08),B'00010000'                           0358
*               DATDAYS=EXPIRVAL;   /* NUMBER OF DAYS        @Z40LB30*/
         L     @04,EXPIRVAL(,@04)                                  0359
         ST    @04,DATDAYS(,@08)                                   0359
*               DATADD=ON;          /* ADD DAYS TO CURRENT   @Z40LB30
*                                      DATE                  @Z40LB30*/
         OI    DATADD(@08),B'10000000'                             0360
*             END;                  /*                       @Z40LB30*/
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00356                                            0362
@RF00356 DS    0H                                                  0363
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB30*/
         LA    @08,DTSAREA                                         0363
         OI    DATDTEOP(@08),B'00100000'                           0363
*               DATDATE=EXPDTVAL;   /* DATE                  @Z40LB30*/
         L     @04,@PC00001+4                                      0364
         L     @04,FDTPTR+28(,@04)                                 0364
         L     @04,EXPDTVAL(,@04)                                  0364
         ST    @04,DATDATE(,@08)                                   0364
*             END;                  /*                       @Z40LB30*/
*           CALL DATES(DATESAGL);   /*                       @Z40LB30*/
@RC00356 LA    @08,DTSAREA                                         0366
         ST    @08,@AL00001                                        0366
         LA    @01,@AL00001                                        0366
         BAL   @14,DATES                                           0366
*         END;                      /*                       @Z40LB30*/
*                                                                  0368
*       /*************************************************************/
*       /*                                                           */
*       /* IF CREATION PARAMETERS WERE SPECIFIED ON THE      @Z40LB30*/
*       /* COMMAND, CALL THE DATES PROCEDURE TO CALCULATE    @Z40LB30*/
*       /* A DATE FOR COMPARISON                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0368
*       IF ADDR(CREAT)^=NULLPTR×ADDR(CREDT)^=NULLPTR/*       @Z40LB30*/
*         THEN                      /*                       @Z40LB30*/
@RF00352 SLR   @08,@08                                             0368
         L     @04,@PC00001+4                                      0368
         C     @08,FDTPTR+40(,@04)                                 0368
         BNE   @RT00368                                            0368
         C     @08,FDTPTR+36(,@04)                                 0368
         BE    @RF00368                                            0368
@RT00368 DS    0H                                                  0369
*         DO;                       /*                       @Z40LB30*/
*           DATESAGL=''B;           /*                       @Z40LB30*/
         LA    @08,DTSAREA                                         0370
         XC    DATESAGL(21,@08),DATESAGL(@08)                      0370
*           DATRETRN=ADDR(CREDATE); /* PLACE TO RETURN       @Z40LB30
*                                      DATE                  @Z40LB30*/
*                                                                  0371
         LA    @04,CREDATE                                         0371
         ST    @04,DATRETRN(,@08)                                  0371
*           /*********************************************************/
*           /*                                                       */
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0372
*           IF ADDR(CREAT)^=NULLPTR THEN/*                   @Z40LB30*/
         L     @04,@PC00001+4                                      0372
         L     @04,FDTPTR+40(,@04)                                 0372
         LTR   @04,@04                                             0372
         BZ    @RF00372                                            0372
*             DO;                   /*                       @Z40LB30*/
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB30*/
         OI    DATDAYOP(@08),B'00010000'                           0374
*               DATDAYS=CREATVAL;   /* NUMBER OF DAYS        @Z40LB30*/
         L     @04,CREATVAL(,@04)                                  0375
         ST    @04,DATDAYS(,@08)                                   0375
*               DATSUB=ON;          /* SUBTRACT DAYS FROM    @Z40LB30
*                                      CURRENT DATE          @Z40LB30*/
         OI    DATSUB(@08),B'01000000'                             0376
*             END;                  /*                       @Z40LB30*/
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00372                                            0378
@RF00372 DS    0H                                                  0379
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB30*/
         LA    @08,DTSAREA                                         0379
         OI    DATDTEOP(@08),B'00100000'                           0379
*               DATDATE=CREDTVAL;   /* DATE                  @Z40LB30*/
         L     @04,@PC00001+4                                      0380
         L     @04,FDTPTR+36(,@04)                                 0380
         L     @04,CREDTVAL(,@04)                                  0380
         ST    @04,DATDATE(,@08)                                   0380
*             END;                  /*                       @Z40LB30*/
*           CALL DATES(DATESAGL);   /*                       @Z40LB30*/
@RC00372 LA    @08,DTSAREA                                         0382
         ST    @08,@AL00001                                        0382
         LA    @01,@AL00001                                        0382
         BAL   @14,DATES                                           0382
*         END;                      /*                       @Z40LB30*/
*                                                                  0384
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE PROPER PROCEDURE TO PROCESS THE VOLUMES  @Z40LB30*/
*       /* BASED ON THE PARAMETER SPECIFIED ON THE COMMAND:  @Z40LB30*/
*       /* VOLUMES, GROUPS, NONGROUPED, ALLVOLUMES, OR       @Z40LB30*/
*       /* ALLGROUPS                                         @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0384
*       IF ADDR(VOL)^=NULLPTR THEN  /*                       @Z40LB30*/
@RF00368 L     @08,@PC00001+4                                      0384
         L     @08,FDTPTR(,@08)                                    0384
         LTR   @08,@08                                             0384
         BZ    @RF00384                                            0384
*         CALL SPECVOL;             /*                       @Z40LB30*/
         BAL   @14,SPECVOL                                         0385
*       ELSE                        /*                       @Z40LB30*/
*         IF ADDR(GRP)^=NULLPTR THEN/*                       @Z40LB30*/
         B     @RC00384                                            0386
@RF00384 L     @08,@PC00001+4                                      0386
         L     @08,FDTPTR+4(,@08)                                  0386
         LTR   @08,@08                                             0386
         BZ    @RF00386                                            0386
*           CALL SPECGRP;           /*                       @Z40LB30*/
         BAL   @14,SPECGRP                                         0387
*         ELSE                      /*                       @Z40LB30*/
*           IF ADDR(NGRPD)^=NULLPTR THEN/*                   @Z40LB30*/
         B     @RC00386                                            0388
@RF00386 L     @08,@PC00001+4                                      0388
         L     @08,FDTPTR+16(,@08)                                 0388
         LTR   @08,@08                                             0388
         BZ    @RF00388                                            0388
*             CALL NONGRPD;         /*                       @Z40LB30*/
         BAL   @14,NONGRPD                                         0389
*           ELSE                    /*                       @Z40LB30*/
*             IF ADDR(AGRP)^=NULLPTR THEN/*                  @Z40LB30*/
         B     @RC00388                                            0390
@RF00388 L     @08,@PC00001+4                                      0390
         L     @08,FDTPTR+12(,@08)                                 0390
         LTR   @08,@08                                             0390
         BZ    @RF00390                                            0390
*               CALL ALLGRPS;       /*                       @Z40LB30*/
         BAL   @14,ALLGRPS                                         0391
*             ELSE                  /*                       @Z40LB30*/
*               IF ADDR(AVOL)^=NULLPTR THEN/*                @Z40LB30*/
         B     @RC00390                                            0392
@RF00390 L     @08,@PC00001+4                                      0392
         L     @08,FDTPTR+8(,@08)                                  0392
         LTR   @08,@08                                             0392
         BZ    @RF00392                                            0392
*                 CALL ALLVOLS;     /*                       @Z40LB30*/
*                                                                  0393
         BAL   @14,ALLVOLS                                         0393
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE THE RETURN CODE AND SET THE LASTCOND         @Z40LB30*/
*       /* FIELD EQUAL TO THE RETURN CODE                    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0394
*       RESPECIFY                                                  0394
*         RTNREG RSTD;                                             0394
@RF00392 DS    0H                                                  0394
@RC00390 DS    0H                                                  0394
@RC00388 DS    0H                                                  0394
@RC00386 DS    0H                                                  0394
@RC00384 DS    0H                                                  0395
*       TESTRC=RTNREG;                                             0395
         LR    TESTRC,RTNREG                                       0395
*       RESPECIFY                                                  0396
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*       LASTCOND=TESTRC;            /*                       @Z40LB30*/
         L     @08,@PC00001+8                                      0397
         STH   TESTRC,LASTCOND(,@08)                               0397
*     END;                          /*                       @Z40LB30*/
*                                                                  0399
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE MESSAGE IDC0001I IF THE LAST CONDITION CODE     @Z40LB30*/
*   /* IS < 12 OR ISSUE MESSAGE IDC3003I IF THE LAST         @Z40LB30*/
*   /* CONDITION CODE IS 12                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   DARGAREA=''B;                   /*                       @Z40LB30*/
@RF00349 XC    DARGAREA(28),DARGAREA                               0399
*   DARGSMOD=UV0MSG;                /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0400
         MVC   DARGSMOD(3,@08),@CC01422                            0400
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB30*/
         L     @15,@PC00001+8                                      0401
         ST    @15,DARGDBP(,@08)                                   0401
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00155                             0402
*   IF LASTCOND<LASTCC12 THEN       /*                       @Z40LB30*/
         LH    @15,LASTCOND(,@15)                                  0403
         C     @15,@CF00035                                        0403
         BNL   @RF00403                                            0403
*     DARGSENT=MSG0001I;            /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'01'                                 0404
*   ELSE                            /*                       @Z40LB30*/
*     DARGSENT=MSG3003I;            /*                       @Z40LB30*/
         B     @RC00403                                            0405
@RF00403 L     @08,DDSTRU                                          0405
         MVI   DARGSENT(@08),X'03'                                 0405
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/
*                                                                  0406
@RC00403 L     @08,@PC00001                                        0406
         ST    @08,@AL00001                                        0406
         LA    @15,@CF00116                                        0406
         ST    @15,@AL00001+4                                      0406
         LA    @15,DDSTRU                                          0406
         ST    @15,@AL00001+8                                      0406
         MVI   @AL00001+8,X'80'                                    0406
         L     @15,GDTPRT(,@08)                                    0406
         LA    @01,@AL00001                                        0406
         BALR  @14,@15                                             0406
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*   IF GDTDBG=NULLPTR THEN                                         0407
         L     @08,@PC00001                                        0407
         L     @08,GDTDBG(,@08)                                    0407
         LTR   @08,@08                                             0407
         BZ    @RT00407                                            0407
*     ;                                                            0408
*   ELSE                                                           0409
*     CALL IDCDB010(GDTTBL,'SDED'); /*                       @Z40LB30*/
*                                                                  0409
         L     @08,@PC00001                                        0409
         ST    @08,@AL00001                                        0409
         LA    @15,@CC01500                                        0409
         ST    @15,@AL00001+4                                      0409
         MVI   @AL00001+4,X'80'                                    0409
         L     @15,GDTDBG(,@08)                                    0409
         LA    @01,@AL00001                                        0409
         BALR  @14,@15                                             0409
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);/*                  @Z40LB30*/
@RT00407 L     @08,@PC00001                                        0410
         ST    @08,@AL00001                                        0410
         LA    @15,MODID                                           0410
         ST    @15,@AL00001+4                                      0410
         L     @15,@PC00001+8                                      0410
         ST    @15,@AL00001+8                                      0410
         MVI   @AL00001+8,X'80'                                    0410
         L     @15,GDTEPL(,@08)                                    0410
         LA    @01,@AL00001                                        0410
         BALR  @14,@15                                             0410
*                                                                  0411
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - SPECVOL                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/
*/*           TO READ EACH VOLUME RECORD SPECIFIED ON THE    @Z40LB30*/
*/*           SCRDSET COMMAND.  CALL PROCEDURES TO CHECK     @Z40LB30*/
*/*           IF THERE ARE ANY RECOVERY FLAGS ON AND         @Z40LB30*/
*/*           TO PROCESS THE VOLUME.  PRINT MESSAGE          @Z40LB30*/
*/*           IDC2074I IF THE VOLUME IS NOT ACTIVE,          @Z40LB30*/
*/*           FOLLOWED BY MESSAGE IDC2108I.  IF AN ERROR     @Z40LB30*/
*/*           OCCURS READING A VOLUME RECORD, PRINT MESSAGE  @Z40LB30*/
*/*           IDC2080I.                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERROR OCCURRED              @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME      @Z40LB30*/
*/*                           OR CLOSING VTOC                @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0411
*SPECVOL:                                                          0411
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
@EL00001 L     @13,4(,@13)                                         0411
@EF00001 L     @00,@SIZDATD                                        0411
         LR    @01,@09                                             0411
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0411
         BR    @14                                                 0411
SPECVOL  ST    @14,@SA00002                                        0411
*                                                                  0412
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   OLDERID2=NEWERID2;                                             0412
         L     @08,@PC00001                                        0412
         L     @08,GDTTR2(,@08)                                    0412
         MVC   @TS00001(95),NEWERID2(@08)                          0412
         MVC   OLDERID2(95,@08),@TS00001                           0412
*   NEWID2='SDSV';                  /*                       @Z40LB30*/
*                                                                  0413
         MVC   NEWID2(4,@08),@CC01504                              0413
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0414
         SLR   CC01,CC01                                           0414
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ A SPECIFIC   @Z40LB30*/
*   /* BASE VOLUME RECORD FROM THE INVENTORY AND TEST THAT   @Z40LB30*/
*   /* IT IS ACTIVE                                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0415
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0415
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @08,VOLRVVI                                         0416
         ST    @08,RVVIPTR                                         0416
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @15,RVVLEN                                          0417
         ST    @15,RVVLNGTH(,@08)                                  0417
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@08),X'87'                                  0418
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@08),@CH01625                            0419
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,VOLREC                                          0420
         ST    @15,RVVRTBUF(,@08)                                  0420
*   RVVRDR=ON;                      /* READ A RECORD         @Z40LB30*/
         OI    RVVRDR(@08),B'10000000'                             0421
*   RVVBVRCD=ON;                    /* BASE RECORD           @Z40LB30*/
         OI    RVVBVRCD(@08),B'10000000'                           0422
*   RVVACTV=ON;                     /* ACTIVE VOLUME         @Z40LB30*/
         OI    RVVACTV(@08),B'00000100'                            0423
*   RVVSVOL=ON;                     /* VOLUME SERIAL IS      @Z40LB30
*                                      SPECIFIED             @Z40LB30*/
         OI    RVVSVOL(@08),B'00000001'                            0424
*                                                                  0425
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE BASE VOLUME RECORD FOR EACH VOLUME SPECIFIED @Z40LB30*/
*   /* ON THE SCRDSET COMMAND                                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0425
*   DO INDEX=1 TO VOLCNT;           /*                       @Z40LB30*/
*                                                                  0425
         LA    @08,1                                               0425
         B     @DE00425                                            0425
@DL00425 DS    0H                                                  0426
*     /***************************************************************/
*     /*                                                             */
*     /* PUT THE VOLUME SERIAL IN THE IEZRVVI PARAMETER LIST @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0426
*     RVVOLUME=VOLVAL(INDEX);       /*                       @Z40LB30*/
*                                                                  0426
         L     @02,RVVIPTR                                         0426
         SLA   @08,3                                               0426
         L     @15,@PC00001+4                                      0426
         L     @01,FDTPTR(,@15)                                    0426
         ALR   @01,@08                                             0426
         AL    @01,@CF01643                                        0426
         MVC   RVVOLUME(6,@02),VOLVAL-3(@01)                       0426
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC TO READ THE RECORD. SAVE THE RETURN      @Z40LB30*/
*     /* CODE                                                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0427
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @08,@PC00001                                        0427
         ST    @08,@AL00001                                        0427
         LA    @02,VVIC                                            0427
         ST    @02,@AL00001+4                                      0427
         LA    @02,RVVIPTR                                         0427
         ST    @02,@AL00001+8                                      0427
         LA    @02,VVICODE                                         0427
         ST    @02,@AL00001+12                                     0427
         MVI   @AL00001+12,X'80'                                   0427
         L     @15,GDTSSC(,@08)                                    0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*     RESPECIFY                                                    0428
*       RTNREG RSTD;                                               0428
*     TESTRC=RTNREG;                                               0429
         LR    TESTRC,RTNREG                                       0429
*     RESPECIFY                                                    0430
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0430
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0431
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0431
         BNZ   @RF00431                                            0431
*       DO;                         /*                       @Z40LB30*/
*                                                                  0432
*         /***********************************************************/
*         /*                                                         */
*         /* CALL CKRECEXC TO SEE IF ANY RECOVERY FLAGS ARE  @Z40LB30*/
*         /* ON IN THE RECORD AND THE VOLUME CANNOT BE       @Z40LB30*/
*         /* PROCESSED                                       @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0433
*         CALL CKRECEXC;            /*                       @Z40LB30*/
         BAL   @14,CKRECEXC                                        0433
*         RESPECIFY                                                0434
*           RTNREG RSTD;                                           0434
*         TESTRC=RTNREG;                                           0435
         LR    TESTRC,RTNREG                                       0435
*         RESPECIFY                                                0436
*           RTNREG UNRSTD;          /*                       @Z40LB30*/
*                                                                  0436
*         /***********************************************************/
*         /*                                                         */
*         /* ACCUMULATE THE HIGHEST RETURN CODE IN THE       @Z40LB30*/
*         /* INTERNAL CONDITION CODE AREA                    @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0437
*         CC01=MAX(CC01,TESTRC);    /*                       @Z40LB30*/
*                                                                  0437
         CR    CC01,TESTRC                                         0437
         BNL   *+6
         LR    CC01,TESTRC                                         0437
*         /***********************************************************/
*         /*                                                         */
*         /* IF NO ERRORS WERE FOUND, CALL PROCVOL TO        @Z40LB30*/
*         /* PROCESS THE VOLUME. SAVE THE RETURN CODE        @Z40LB30*/
*         /* AND PUT THE HIGHEST RETURN CODE IN THE INTER-   @Z40LB30*/
*         /* NAL CONDITION CODE AREA                         @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0438
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0438
         BNZ   @RF00438                                            0438
*           DO;                     /*                       @Z40LB30*/
*             CALL PROCVOL;         /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0440
*             RESPECIFY                                            0441
*               RTNREG RSTD;                                       0441
*             TESTRC=RTNREG;                                       0442
         LR    TESTRC,RTNREG                                       0442
*             RESPECIFY                                            0443
*               RTNREG UNRSTD;      /*                       @Z40LB30*/
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/
*                                                                  0444
         CR    CC01,TESTRC                                         0444
         BNL   *+6
         LR    CC01,TESTRC                                         0444
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE RETURN CODE INDICATES A VOLUME WAS   @Z40LB30*/
*             /* PROCESSED, SET AN INDICATOR                 @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0445
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/
         C     TESTRC,@CF00035                                     0445
         BNL   @RF00445                                            0445
*               ONEDONE=ON;         /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0446
*           END;                    /*                       @Z40LB30*/
*       END;                        /*                       @Z40LB30*/
*                                                                  0448
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS NOT SUCCESSFUL, ISSUE THE PROPER    @Z40LB30*/
*     /* MESSAGES                                            @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0449
*     ELSE                          /*                       @Z40LB30*/
*                                                                  0449
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE REASON CODE INDICATES THE VOLUME IS NOT    @Z40LB30*/
*       /* ACTIVE, PRINT MESSAGE IDC2074I, FOLLOWED BY       @Z40LB30*/
*       /* MESSAGE IDC2108I. SET THE CONDITION CODE          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0449
*       IF VVICODE=NOACTIVE THEN    /*                       @Z40LB30*/
         B     @RC00431                                            0449
@RF00431 CLC   VVICODE(4),@CF01475                                 0449
         BNE   @RF00449                                            0449
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0451
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0452
         MVC   DARGSMOD(3,@08),@CC01418                            0452
*           DARGSENT=MSG2074I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'20'                                 0453
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/
         LH    @15,INDEX                                           0454
         SLA   @15,3                                               0454
         L     @14,@PC00001+4                                      0454
         L     @01,FDTPTR(,@14)                                    0454
         AL    @01,@CF01643                                        0454
         LA    @15,VOLVAL-3(@15,@01)                               0454
         ST    @15,DARGDBP(,@08)                                   0454
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00158                             0455
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @08,@PC00001                                        0456
         ST    @08,@AL00001                                        0456
         LA    @15,@CF00116                                        0456
         ST    @15,@AL00001+4                                      0456
         LA    @15,DDSTRU                                          0456
         ST    @15,@AL00001+8                                      0456
         MVI   @AL00001+8,X'80'                                    0456
         L     @15,GDTPRT(,@08)                                    0456
         LA    @01,@AL00001                                        0456
         BALR  @14,@15                                             0456
*           DARGSENT=MSG2108I;      /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0457
         MVI   DARGSENT(@08),X'40'                                 0457
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @08,@PC00001                                        0458
         ST    @08,@AL00001                                        0458
         LA    @15,@CF00116                                        0458
         ST    @15,@AL00001+4                                      0458
         LA    @15,DDSTRU                                          0458
         ST    @15,@AL00001+8                                      0458
         MVI   @AL00001+8,X'80'                                    0458
         L     @15,GDTPRT(,@08)                                    0458
         LA    @01,@AL00001                                        0458
         BALR  @14,@15                                             0458
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0459
*         END;                      /*                       @Z40LB30*/
*                                                                  0460
*     /***************************************************************/
*     /*                                                             */
*     /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG TO PRINT     @Z40LB30*/
*     /* THE REASON CODE. THEN ISSUE MESSAGE IDC2080I TO     @Z40LB30*/
*     /* IDENTIFY THE VOLUME. SET THE CONDITION CODE         @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0461
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
         B     @RC00449                                            0461
@RF00449 DS    0H                                                  0462
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0462
         ST    @08,@AL00001                                        0462
         LA    @01,@AL00001                                        0462
         BAL   @14,SSCMSG                                          0462
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0463
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0464
         MVC   DARGSMOD(3,@08),@CC01418                            0464
*           DARGSENT=MSG2080I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'1A'                                 0465
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/
         LH    @15,INDEX                                           0466
         SLA   @15,3                                               0466
         L     @14,@PC00001+4                                      0466
         L     @01,FDTPTR(,@14)                                    0466
         AL    @01,@CF01643                                        0466
         LA    @15,VOLVAL-3(@15,@01)                               0466
         ST    @15,DARGDBP(,@08)                                   0466
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00158                             0467
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @08,@PC00001                                        0468
         ST    @08,@AL00001                                        0468
         LA    @15,@CF00116                                        0468
         ST    @15,@AL00001+4                                      0468
         LA    @15,DDSTRU                                          0468
         ST    @15,@AL00001+8                                      0468
         MVI   @AL00001+8,X'80'                                    0468
         L     @15,GDTPRT(,@08)                                    0468
         LA    @01,@AL00001                                        0468
         BALR  @14,@15                                             0468
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0469
*         END;                      /*                       @Z40LB30*/
*                                                                  0470
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN ORDER   @Z40LB30*/
*     /* TO SPACE BETWEEN THE MESSAGES FOR EACH VOLUME       @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0471
*     DARGAREA=''B;                 /*                       @Z40LB30*/
@RC00449 DS    0H                                                  0471
@RC00431 XC    DARGAREA(28),DARGAREA                               0471
*     DARGSMOD=SD01MSG;             /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0472
         MVC   DARGSMOD(3,@08),@CC01420                            0472
*     DARGSENT=BLANKS;              /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0473
*     CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                @Z40LB30*/
         L     @08,@PC00001                                        0474
         ST    @08,@AL00001                                        0474
         LA    @15,@CF00116                                        0474
         ST    @15,@AL00001+4                                      0474
         LA    @15,DDSTRU                                          0474
         ST    @15,@AL00001+8                                      0474
         MVI   @AL00001+8,X'80'                                    0474
         L     @15,GDTPRT(,@08)                                    0474
         LA    @01,@AL00001                                        0474
         BALR  @14,@15                                             0474
*   END;                            /*                       @Z40LB30*/
         LA    @08,1                                               0475
         AH    @08,INDEX                                           0475
@DE00425 STH   @08,INDEX                                           0475
         L     @15,@PC00001+4                                      0475
         L     @01,FDTPTR(,@15)                                    0475
         CH    @08,VOLCNT(,@01)                                    0475
         BNH   @DL00425                                            0475
*                                                                  0476
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/
*   /* THE FINAL CONDITION CODE                              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
         C     CC01,@CF00035                                       0476
         BNE   @RF00476                                            0476
         TM    ONEDONE,B'10000000'                                 0476
         BNO   @RF00476                                            0476
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0477
         LA    CC01,8                                              0477
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0478
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00476 LR    @15,CC01                                            0478
@EL00002 DS    0H                                                  0478
@EF00002 DS    0H                                                  0478
@ER00002 L     @14,@SA00002                                        0478
         BR    @14                                                 0478
*   END SPECVOL;                    /*                       @Z40LB30*/
*                                                                  0480
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - SPECGRP                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/
*/*           TO READ THE INVENTORY RECORD FOR EACH GROUP    @Z40LB30*/
*/*           SPECIFIED ON THE SCRDSET COMMAND.  THEN CALL   @Z40LB30*/
*/*           A PROCEDURE TO READ THE RECORD FOR EACH ACTIVE @Z40LB30*/
*/*           BASE VOLUME IN THE GROUP.  FOR EACH VOLUME,    @Z40LB30*/
*/*           CALL PROCEDURES TO SEE IF THE VOLUME IS TO BE  @Z40LB30*/
*/*           EXCLUDED OR HAS RECOVERY FLAGS ON IN THE       @Z40LB30*/
*/*           RECORD AND TO PROCESS THE VOLUME.  ISSUE       @Z40LB30*/
*/*           MESSAGE IDC2079I IF A GROUP RECORD CANNOT      @Z40LB30*/
*/*           BE READ.  ISSUE MESSAGE IDC0817I IF ALL THE    @Z40LB30*/
*/*           VOLUMES IN A GROUP WERE EXCLUDED.              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE DATA SETS OR       @Z40LB30*/
*/*                           VOLUMES COULD NOT BE PROCESSED @Z40LB30*/
*/*                           DUE TO ERROR                   @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0480
*SPECGRP:                                                          0480
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
SPECGRP  ST    @14,@SA00003                                        0480
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0481
*   OLDERID2=NEWERID2;                                             0481
         L     @08,@PC00001                                        0481
         L     @08,GDTTR2(,@08)                                    0481
         MVC   @TS00001(95),NEWERID2(@08)                          0481
         MVC   OLDERID2(95,@08),@TS00001                           0481
*   NEWID2='SDSG';                  /*                       @Z40LB30*/
*                                                                  0482
         MVC   NEWID2(4,@08),@CC01511                              0482
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0483
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0483
         SLR   CC01,CC01                                           0483
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST TO READ A        @Z40LB30*/
*   /* SPECIFIC GROUP RECORD FROM THE INVENTORY              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   GRPRVVI=''B;                    /*                       @Z40LB30*/
         XC    GRPRVVI(68),GRPRVVI                                 0484
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/
         LA    @08,GRPRVVI                                         0485
         ST    @08,RVVIPTR                                         0485
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @15,RVVLEN                                          0486
         ST    @15,RVVLNGTH(,@08)                                  0486
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@08),X'87'                                  0487
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@08),@CH01626                            0488
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,GRPREC                                          0489
         ST    @15,RVVRTBUF(,@08)                                  0489
*   RVVRDR=ON;                      /* READ NEXT             @Z40LB30*/
         OI    RVVRDR(@08),B'10000000'                             0490
*   RVVGRPRC=ON;                    /* READ GROUP RECORD     @Z40LB30*/
         OI    RVVGRPRC(@08),B'01000000'                           0491
*   RVVSGRP=ON;                     /* GROUP NAME SPECIFIED  @Z40LB30*/
         OI    RVVSGRP(@08),B'10000000'                            0492
*                                                                  0493
*   /*****************************************************************/
*   /*                                                               */
*   /* READ THE RECORD FOR EACH GROUP SPECIFIED ON THE       @Z40LB30*/
*   /* SCRDSET COMMAND                                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*   DO INDEX=1 TO GRPCNT;           /*                       @Z40LB30*/
*                                                                  0493
         LA    @08,1                                               0493
         B     @DE00493                                            0493
@DL00493 DS    0H                                                  0494
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE COUNTS OF HOW MANY VOLUMES HAVE          @Z40LB30*/
*     /* BEEN READ FROM THE GROUP AND HOW MANY HAVE          @Z40LB30*/
*     /* BEEN EXCLUDED. INITIALIZE TO OFF INDICATOR          @Z40LB30*/
*     /* OF WHETHER LAST VOLUME PROCESSED WAS EXCLUDED.      @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0494
*     EXCLCNT=0;                    /*                       @Z40LB30*/
         SLR   @02,@02                                             0494
         STH   @02,EXCLCNT                                         0494
*     VOLRDCNT=0;                   /*                       @Z40LB30*/
         STH   @02,VOLRDCNT                                        0495
*     EXCVOL=OFF;                   /*                       @Z40LB30*/
*                                                                  0496
         NI    EXCVOL,B'11101111'                                  0496
*     /***************************************************************/
*     /*                                                             */
*     /* RESET THE POINTER TO THE IEZRVVI PARAMETER LIST AND @Z40LB30*/
*     /* SET THE GROUP NAME IN THE PARAMETER LIST            @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0497
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Z40LB30*/
         LA    @02,GRPRVVI                                         0497
         ST    @02,RVVIPTR                                         0497
*     RVVGROUP=GRPVAL(INDEX);       /*                       @Z40LB30*/
*                                                                  0498
         MH    @08,@CH00037                                        0498
         L     @15,@PC00001+4                                      0498
         L     @01,FDTPTR+4(,@15)                                  0498
         ALR   @01,@08                                             0498
         AL    @01,@CF01645                                        0498
         MVC   RVVGROUP(8,@02),GRPVAL-3(@01)                       0498
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD. SAVE THE   @Z40LB30*/
*     /* RETURN CODE                                         @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0499
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @08,@PC00001                                        0499
         ST    @08,@AL00001                                        0499
         LA    @02,VVIC                                            0499
         ST    @02,@AL00001+4                                      0499
         LA    @02,RVVIPTR                                         0499
         ST    @02,@AL00001+8                                      0499
         LA    @02,VVICODE                                         0499
         ST    @02,@AL00001+12                                     0499
         MVI   @AL00001+12,X'80'                                   0499
         L     @15,GDTSSC(,@08)                                    0499
         LA    @01,@AL00001                                        0499
         BALR  @14,@15                                             0499
*     RESPECIFY                                                    0500
*       RTNREG RSTD;                                               0500
*     TESTRC=RTNREG;                                               0501
         LR    TESTRC,RTNREG                                       0501
*     RESPECIFY                                                    0502
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0502
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE GROUP RECORD WAS READ SUCCESSFULLY, CONTINUE @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0503
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         SLR   @08,@08                                             0503
         CR    TESTRC,@08                                          0503
         BNE   @RF00503                                            0503
*       DO;                         /*                       @Z40LB30*/
*                                                                  0504
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO 0  @Z40LB30*/
*         /* TO PASS TO RDGRPCHN                             @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0505
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
*                                                                  0505
         ST    @08,VOLPTR                                          0505
*         /***********************************************************/
*         /*                                                         */
*         /* READ EACH ACTIVE BASE VOLUME RECORD + PROCESS   @Z40LB30*/
*         /* THE VOLUME UNTIL THERE ARE NO MORE VOLUME       @Z40LB30*/
*         /* RECORDS OR A READ ERROR OCCURS                  @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0506
*         RDERROR=OFF;              /*                       @Z40LB30*/
         NI    RDERROR,B'10111111'                                 0506
*         DO UNTIL VOLPTR=NULLPTR×RDERROR=ON;/*              @Z40LB30*/
*                                                                  0507
@DL00507 DS    0H                                                  0508
*           /*********************************************************/
*           /*                                                       */
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0508
*           CALL RDGRPCHN;          /*                       @Z40LB30*/
         BAL   @14,RDGRPCHN                                        0508
*           RESPECIFY                                              0509
*             RTNREG RSTD;                                         0509
*           TESTRC=RTNREG;                                         0510
         LR    TESTRC,RTNREG                                       0510
*           RESPECIFY                                              0511
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0511
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/
*           /* IF THERE IS A VOLUME TO PROCESS               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0512
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/
         SLR   @08,@08                                             0512
         CR    TESTRC,@08                                          0512
         BNE   @RF00512                                            0512
*             IF VOLPTR^=NULLPTR THEN/*                      @Z40LB30*/
         C     @08,VOLPTR                                          0513
         BE    @RF00513                                            0513
*               DO;                 /*                       @Z40LB30*/
*                                                                  0514
*                 /***************************************************/
*                 /*                                                 */
*                 /* INCREMENT THE COUNT OF THE NUMBER OF    @Z40LB30*/
*                 /* VOLUMES READ.                           @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0515
*                 VOLRDCNT=VOLRDCNT+1;/*                     @Z40LB30*/
*                                                                  0515
         LA    @08,1                                               0515
         AH    @08,VOLRDCNT                                        0515
         STH   @08,VOLRDCNT                                        0515
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL CKRECEXC TO SEE IF THE VOLUME IS   @Z40LB30*/
*                 /* TO BE EXCLUDED OR IF RECOVERY FLAGS     @Z40LB30*/
*                 /* ARE ON IN THE RECORD. SAVE THE RETURN   @Z40LB30*/
*                 /* CODE                                    @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0516
*                 CALL CKRECEXC;    /*                       @Z40LB30*/
         BAL   @14,CKRECEXC                                        0516
*                 RESPECIFY                                        0517
*                   RTNREG RSTD;                                   0517
*                 TESTRC=RTNREG;                                   0518
         LR    TESTRC,RTNREG                                       0518
*                 RESPECIFY                                        0519
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/
*                                                                  0519
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/
*                 /* (> 4), SET THE CONDITION CODE TO INDI-  @Z40LB30*/
*                 /* CATE A VOLUME WAS NOT PROCESSED         @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0520
*                 IF TESTRC>LASTCC04 THEN/*                  @Z40LB30*/
         C     TESTRC,@CF00042                                     0520
         BNH   @RF00520                                            0520
*                   CC01=LASTCC12;  /*                       @Z40LB30*/
*                                                                  0521
         LA    CC01,12                                             0521
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/
*                 /* PROCESS IT.                             @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0522
*                 ELSE              /*                       @Z40LB30*/
*                   IF TESTRC=LASTCC00 THEN/*                @Z40LB30*/
         B     @RC00520                                            0522
@RF00520 LTR   TESTRC,TESTRC                                       0522
         BNZ   @RF00522                                            0522
*                     DO;           /*                       @Z40LB30*/
*                                                                  0523
*                       /*********************************************/
*                       /*                                           */
*                       /* CALL PROCVOL TO PROCESS THE       @Z40LB30*/
*                       /* VOLUME. SAVE THE RETURN CODE.     @Z40LB30*/
*                       /* SET THE RETURN CODE IN THE        @Z40LB30*/
*                       /* INTERNAL CONDITION CODE AREA IF   @Z40LB30*/
*                       /* IT IS HIGHER THAN CURRENT ONE     @Z40LB30*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0524
*                       CALL PROCVOL;/*                      @Z40LB30*/
         BAL   @14,PROCVOL                                         0524
*                       RESPECIFY                                  0525
*                         RTNREG RSTD;                             0525
*                       TESTRC=RTNREG;                             0526
         LR    TESTRC,RTNREG                                       0526
*                       RESPECIFY                                  0527
*                         RTNREG UNRSTD;/*                   @Z40LB30*/
*                       CC01=MAX(CC01,TESTRC);/*             @Z40LB30*/
*                                                                  0528
         CR    CC01,TESTRC                                         0528
         BNL   *+6
         LR    CC01,TESTRC                                         0528
*                       /*********************************************/
*                       /*                                           */
*                       /* IF THE RETURN CODE INDICATES A    @Z40LB30*/
*                       /* VOLUME WAS PROCESSED, SET         @Z40LB30*/
*                       /* INDICATOR                         @Z40LB30*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0529
*                       IF TESTRC<LASTCC12 THEN/*            @Z40LB30*/
         C     TESTRC,@CF00035                                     0529
         BNL   @RF00529                                            0529
*                         ONEDONE=ON;/*                      @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0530
*                     END;          /*                       @Z40LB30*/
*                                                                  0531
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME WAS EXCLUDED, INCREMENT   @Z40LB30*/
*                 /* THE COUNT OF EXCLUDED VOLUMES AND       @Z40LB30*/
*                 /* ALSO SET AN INDICATOR.                  @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0532
*                   ELSE            /*                       @Z40LB30*/
*                     DO;           /*                       @Z40LB30*/
         B     @RC00522                                            0532
@RF00522 DS    0H                                                  0533
*                       EXCLCNT=EXCLCNT+1;/*                 @Z40LB30*/
         LA    @08,1                                               0533
         AH    @08,EXCLCNT                                         0533
         STH   @08,EXCLCNT                                         0533
*                       EXCVOL=ON;  /*                       @Z40LB30*/
         OI    EXCVOL,B'00010000'                                  0534
*                     END;          /*                       @Z40LB30*/
*               END;                /*                       @Z40LB30*/
*                                                                  0536
*           /*********************************************************/
*           /*                                                       */
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0537
*             ELSE                                                 0537
*               ;                   /*                       @Z40LB30*/
*                                                                  0537
@RF00513 DS    0H                                                  0538
*           /*********************************************************/
*           /*                                                       */
*           /* IF AN ERROR OCCURRED READING A VOLUME RECORD  @Z40LB30*/
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0538
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00512                                            0538
@RF00512 DS    0H                                                  0539
*               RDERROR=ON;         /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0539
*               CC01=LASTCC12;      /*                       @Z40LB30*/
         LA    CC01,12                                             0540
*             END;                  /*                       @Z40LB30*/
*                                                                  0541
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE      @Z40LB30*/
*           /* IN ORDER TO SPACE BETWEEN THE MESSAGES        @Z40LB30*/
*           /* FOR EACH VOLUME                               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0542
*           DARGAREA=''B;           /*                       @Z40LB30*/
@RC00512 XC    DARGAREA(28),DARGAREA                               0542
*           DARGSMOD=SD01MSG;       /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0543
         MVC   DARGSMOD(3,@08),@CC01420                            0543
*           DARGSENT=BLANKS;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0544
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @08,@PC00001                                        0545
         ST    @08,@AL00001                                        0545
         LA    @15,@CF00116                                        0545
         ST    @15,@AL00001+4                                      0545
         LA    @15,DDSTRU                                          0545
         ST    @15,@AL00001+8                                      0545
         MVI   @AL00001+8,X'80'                                    0545
         L     @15,GDTPRT(,@08)                                    0545
         LA    @01,@AL00001                                        0545
         BALR  @14,@15                                             0545
*         END;                      /*                       @Z40LB30*/
@DE00507 L     @08,VOLPTR                                          0546
         LTR   @08,@08                                             0546
         BZ    @DC00507                                            0546
         TM    RDERROR,B'01000000'                                 0546
         BNO   @DL00507                                            0546
@DC00507 DS    0H                                                  0547
*       END;                        /*                       @Z40LB30*/
*                                                                  0547
*     /***************************************************************/
*     /*                                                             */
*     /* IF AN ERROR OCCURRED READING A GROUP RECORD, CALL   @Z40LB30*/
*     /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT         @Z40LB30*/
*     /* MESSAGE IDC2079I TO INDICATE THE GROUP NAME.        @Z40LB30*/
*     /* THEN SET THE CONDITION CODE TO INDICATE A SEVERE    @Z40LB30*/
*     /* ERROR                                               @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0548
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00503                                            0548
@RF00503 DS    0H                                                  0549
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0549
         ST    @08,@AL00001                                        0549
         LA    @01,@AL00001                                        0549
         BAL   @14,SSCMSG                                          0549
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0550
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0551
         MVC   DARGSMOD(3,@08),@CC01418                            0551
*         DARGSENT=MSG2079I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'1B'                                 0552
*         DARGDBP=ADDR(GRPVAL(INDEX));/*                     @Z40LB30*/
         LH    @15,INDEX                                           0553
         MH    @15,@CH00037                                        0553
         L     @14,@PC00001+4                                      0553
         L     @01,FDTPTR+4(,@14)                                  0553
         AL    @01,@CF01645                                        0553
         LA    @15,GRPVAL-3(@15,@01)                               0553
         ST    @15,DARGDBP(,@08)                                   0553
*         DARGILP=LENGTH(GRPVAL(INDEX));/*                   @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00181                             0554
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @08,@PC00001                                        0555
         ST    @08,@AL00001                                        0555
         LA    @15,@CF00116                                        0555
         ST    @15,@AL00001+4                                      0555
         LA    @15,DDSTRU                                          0555
         ST    @15,@AL00001+8                                      0555
         MVI   @AL00001+8,X'80'                                    0555
         L     @15,GDTPRT(,@08)                                    0555
         LA    @01,@AL00001                                        0555
         BALR  @14,@15                                             0555
*         CC01=LASTCC12;            /*                       @Z40LB30*/
*                                                                  0556
         LA    CC01,12                                             0556
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE        @Z40LB30*/
*         /* IN ORDER TO SPACE BETWEEN THE MESSAGES          @Z40LB30*/
*         /* FOR EACH VOLUME. ISSUE UPRINT ONLY IF THE       @Z40LB30*/
*         /* PREVIOUS VOLUME WAS NOT EXCLUDED SINCE          @Z40LB30*/
*         /* NO MESSAGES WERE ISSUED IF THE VOLUME WAS       @Z40LB30*/
*         /* EXCLUDED.                                       @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0557
*         IF EXCVOL=OFF THEN        /*                       @Z40LB30*/
         TM    EXCVOL,B'00010000'                                  0557
         BNZ   @RF00557                                            0557
*           DO;                     /*                       @Z40LB30*/
*             DARGAREA=''B;         /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0559
*             DARGSMOD=SD01MSG;     /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0560
         MVC   DARGSMOD(3,@08),@CC01420                            0560
*             DARGSENT=BLANKS;      /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0561
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/
         L     @08,@PC00001                                        0562
         ST    @08,@AL00001                                        0562
         LA    @15,@CF00116                                        0562
         ST    @15,@AL00001+4                                      0562
         LA    @15,DDSTRU                                          0562
         ST    @15,@AL00001+8                                      0562
         MVI   @AL00001+8,X'80'                                    0562
         L     @15,GDTPRT(,@08)                                    0562
         LA    @01,@AL00001                                        0562
         BALR  @14,@15                                             0562
*           END;                    /*                       @Z40LB30*/
*       END;                        /*                       @Z40LB30*/
*                                                                  0564
@RF00557 DS    0H                                                  0565
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF ALL THE ACTIVE VOLUMES IN THE GROUP    @Z40LB30*/
*     /* HAVE BEEN EXCLUDED. IF NO ERRORS HAVE OCCURRED,     @Z40LB30*/
*     /* AND AT LEAST 1 VOL HAS BEEN READ, COMPARE THE COUNT @Z40LB30*/
*     /* OF THE NUMBER OF VOLUMES READ IN THE GROUP TO THE   @Z40LB30*/
*     /* NUMBER EXCLUDED. IF THE COUNTS MATCH, PRINT         @Z40LB30*/
*     /* MESSAGE IDC0817I TO SAY ALL THE VOLUMES IN THE      @Z40LB30*/
*     /* GROUP HAVE BEEN EXCLUDED AND SET AN INDICATOR.      @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0565
*     IF RDERROR=OFF&VOLRDCNT>0&VOLRDCNT=EXCLCNT/*           @Z40LB30*/
*       THEN                        /*                       @Z40LB30*/
@RC00503 TM    RDERROR,B'01000000'                                 0565
         BNZ   @RF00565                                            0565
         LH    @08,VOLRDCNT                                        0565
         LTR   @08,@08                                             0565
         BNP   @RF00565                                            0565
         CH    @08,EXCLCNT                                         0565
         BNE   @RF00565                                            0565
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0567
*         DARGSMOD=SD01MSG;         /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0568
         MVC   DARGSMOD(3,@08),@CC01420                            0568
*         DARGSENT=MSG0817I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'09'                                 0569
*         DARGDBP=ADDR(GROVVGRP);   /*                       @Z40LB30*/
         L     @01,GROUPPTR                                        0570
         LA    @15,GROVVGRP(,@01)                                  0570
         ST    @15,DARGDBP(,@08)                                   0570
*         DARGILP=LENGTH(GROVVGRP); /*                       @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00181                             0571
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @08,@PC00001                                        0572
         ST    @08,@AL00001                                        0572
         LA    @15,@CF00116                                        0572
         ST    @15,@AL00001+4                                      0572
         LA    @15,DDSTRU                                          0572
         ST    @15,@AL00001+8                                      0572
         MVI   @AL00001+8,X'80'                                    0572
         L     @15,GDTPRT(,@08)                                    0572
         LA    @01,@AL00001                                        0572
         BALR  @14,@15                                             0572
*         EMPTYGRP=ON;              /*                       @Z40LB30*/
         OI    EMPTYGRP,B'00001000'                                0573
*       END;                        /*                       @Z40LB30*/
*   END;                            /*                       @Z40LB30*/
@RF00565 LA    @08,1                                               0575
         AH    @08,INDEX                                           0575
@DE00493 STH   @08,INDEX                                           0575
         L     @15,@PC00001+4                                      0575
         L     @01,FDTPTR+4(,@15)                                  0575
         CH    @08,GRPCNT(,@01)                                    0575
         BNH   @DL00493                                            0575
*                                                                  0576
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CONDITION CODE INDICATES A SEVERE ERROR THAT   @Z40LB30*/
*   /* PREVENTED A VOLUME FROM BEING PROCESSED, CHECK IF     @Z40LB30*/
*   /* AT LEAST ONE VOLUME WAS PROCESSED OR IF AT            @Z40LB30*/
*   /* LEAST ONE EMPTY GROUP WAS PROCESSED. IF SO,           @Z40LB30*/
*   /* LOWER THE FINAL CONDITION CODE.                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0576
*   IF CC01=LASTCC12&(ONEDONE=ON×EMPTYGRP=ON) THEN/*         @Z40LB30*/
         C     CC01,@CF00035                                       0576
         BNE   @RF00576                                            0576
         TM    ONEDONE,B'10001000'                                 0576
         BZ    @RF00576                                            0576
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0577
         LA    CC01,8                                              0577
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00576 LR    @15,CC01                                            0578
@EL00003 DS    0H                                                  0578
@EF00003 DS    0H                                                  0578
@ER00003 L     @14,@SA00003                                        0578
         BR    @14                                                 0578
*   END SPECGRP;                    /*                       @Z40LB30*/
*                                                                  0580
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - NONGRPD                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/
*/*           READ EACH ACTIVE NON-GROUPED VOLUME RECORD.    @Z40LB30*/
*/*           FOR EACH ACTIVE NON-GROUPED VOLUME, CALL A     @Z40LB30*/
*/*           PROCEDURE TO SEE IF THE VOLUME IS EXCLUDED OR  @Z40LB30*/
*/*           IF THE RECORD HAS ANY RECOVERY FLAGS ON. CALL  @Z40LB30*/
*/*           ANOTHER PROCEDURE TO PROCESS THE VOLUME.       @Z40LB30*/
*/*           ISSUE MESSAGE IDC0102I IF THERE ARE NO         @Z40LB30*/
*/*           ACTIVE NON-GROUPED VOLUMES.  ISSUE MESSAGE     @Z40LB30*/
*/*           IDC2103I IF THE NON-GROUPED RECORD CHAIN IS    @Z40LB30*/
*/*           BROKEN.  ISSUE MESSAGE IDC2109I IF AN ERROR    @Z40LB30*/
*/*           OCCURS READING AND NO MORE VOLUMES CAN BE      @Z40LB30*/
*/*           PROCESSED.                                     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*********************************************************  @Z40LB30*/
*                                                                  0580
*NONGRPD:                                                          0580
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
NONGRPD  ST    @14,@SA00004                                        0580
*                                                                  0581
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   OLDERID2=NEWERID2;                                             0581
         L     @08,@PC00001                                        0581
         L     @02,GDTTR2(,@08)                                    0581
         MVC   @TS00001(95),NEWERID2(@02)                          0581
         MVC   OLDERID2(95,@02),@TS00001                           0581
*   NEWID2='SDNG';                  /*                       @Z40LB30*/
*                                                                  0582
         MVC   NEWID2(4,@02),@CC01516                              0582
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0583
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0583
         SLR   CC01,CC01                                           0583
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ THE ACTIVE   @Z40LB30*/
*   /* NON-GROUPED VOLUME RECORDS                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0584
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0584
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @02,VOLRVVI                                         0585
         ST    @02,RVVIPTR                                         0585
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @15,RVVLEN                                          0586
         ST    @15,RVVLNGTH(,@02)                                  0586
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@02),X'87'                                  0587
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@02),@CH01625                            0588
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,VOLREC                                          0589
         ST    @15,RVVRTBUF(,@02)                                  0589
*   RVVRDCH=ON;                     /* READ CHAIN            @Z40LB30*/
         OI    RVVRDCH(@02),B'00100000'                            0590
*   RVVBVRCD=ON;                    /* BASE VOLUME RECORDS   @Z40LB30*/
         OI    RVVBVRCD(@02),B'10000000'                           0591
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/
         OI    RVVACTV(@02),B'00000100'                            0592
*   RVVNGVOL=ON;                    /* NON-GROUPED CHAIN     @Z40LB30*/
*                                                                  0593
         OI    RVVNGVOL(@02),B'01000000'                           0593
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO READ FIRST ACTIVE NON-GROUPED     @Z40LB30*/
*   /* VOLUME. SAVE THE RETURN CODE.                         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0594
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/
         ST    @08,@AL00001                                        0594
         LA    @02,VVIC                                            0594
         ST    @02,@AL00001+4                                      0594
         LA    @02,RVVIPTR                                         0594
         ST    @02,@AL00001+8                                      0594
         LA    @02,VVICODE                                         0594
         ST    @02,@AL00001+12                                     0594
         MVI   @AL00001+12,X'80'                                   0594
         L     @15,GDTSSC(,@08)                                    0594
         LA    @01,@AL00001                                        0594
         BALR  @14,@15                                             0594
*   RESPECIFY                                                      0595
*     RTNREG RSTD;                                                 0595
*   TESTRC=RTNREG;                                                 0596
         LR    TESTRC,RTNREG                                       0596
*   RESPECIFY                                                      0597
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0597
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE ARE NO NON-GROUPED VOLUMES OR NO ACTIVE NON- @Z40LB30*/
*   /* GROUPED VOLUMES, ISSUE MESSAGE IDC0102I.              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0598
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0598
         BZ    @RF00598                                            0598
*     IF VVICODE=NORECORD×VVICODE=NOACTIVE THEN/*            @Z40LB30*/
         L     @08,VVICODE                                         0599
         C     @08,@CF01473                                        0599
         BE    @RT00599                                            0599
         C     @08,@CF01475                                        0599
         BNE   @RF00599                                            0599
@RT00599 DS    0H                                                  0600
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0601
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0602
         MVC   DARGSMOD(3,@08),@CC01418                            0602
*         DARGSENT=MSG0102I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'3A'                                 0603
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @08,@PC00001                                        0604
         ST    @08,@AL00001                                        0604
         LA    @05,@CF00116                                        0604
         ST    @05,@AL00001+4                                      0604
         LA    @05,DDSTRU                                          0604
         ST    @05,@AL00001+8                                      0604
         MVI   @AL00001+8,X'80'                                    0604
         L     @15,GDTPRT(,@08)                                    0604
         LA    @01,@AL00001                                        0604
         BALR  @14,@15                                             0604
*       END;                        /*                       @Z40LB30*/
*                                                                  0605
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/
*   /* REASON CODE AND SET AN INDICATOR.                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0606
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00599                                            0606
@RF00599 DS    0H                                                  0607
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0607
         ST    @08,@AL00001                                        0607
         LA    @01,@AL00001                                        0607
         BAL   @14,SSCMSG                                          0607
*         RDERROR=ON;               /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0608
*       END;                        /*                       @Z40LB30*/
*                                                                  0610
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A RECORD WAS RETURNED, PROCESS AND READ ALL THE    @Z40LB30*/
*   /* ACTIVE NON-GROUPED VOLUMES UNTIL A READ ERROR OCCURS  @Z40LB30*/
*   /* OR END OF FILE.                                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0610
*   ELSE                            /*                       @Z40LB30*/
*     DO WHILE RDERROR=OFF&EOFILE=OFF;/*                     @Z40LB30*/
*                                                                  0610
         B     @RC00598                                            0610
@RF00598 B     @DE00610                                            0610
@DL00610 DS    0H                                                  0611
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CKRECEXC TO SEE IF THE VOLUME WAS EXCLUDED   @Z40LB30*/
*       /* OR IF RECOVERY FLAGS ARE ON. SAVE THE RETURN      @Z40LB30*/
*       /* CODE.                                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0611
*       CALL CKRECEXC;              /*                       @Z40LB30*/
         BAL   @14,CKRECEXC                                        0611
*       RESPECIFY                                                  0612
*         RTNREG RSTD;                                             0612
*       TESTRC=RTNREG;                                             0613
         LR    TESTRC,RTNREG                                       0613
*       RESPECIFY                                                  0614
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0614
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0615
*       IF TESTRC>LASTCC04 THEN     /*                       @Z40LB30*/
         C     TESTRC,@CF00042                                     0615
         BNH   @RF00615                                            0615
*         CC01=LASTCC12;            /*                       @Z40LB30*/
*                                                                  0616
         LA    CC01,12                                             0616
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RECORD CAN BE PROCESSED CALL PROCVOL TO    @Z40LB30*/
*       /* PROCESS THE VOLUME. SAVE THE RETURN CODE.         @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0617
*       IF TESTRC=LASTCC00 THEN     /*                       @Z40LB30*/
@RF00615 LTR   TESTRC,TESTRC                                       0617
         BNZ   @RF00617                                            0617
*         DO;                       /*                       @Z40LB30*/
*           CALL PROCVOL;           /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0619
*           RESPECIFY                                              0620
*             RTNREG RSTD;                                         0620
*           TESTRC=RTNREG;                                         0621
         LR    TESTRC,RTNREG                                       0621
*           RESPECIFY                                              0622
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0622
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE CONDITION CODE TO THE HIGHEST VALUE   @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0623
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/
*                                                                  0623
         CR    CC01,TESTRC                                         0623
         BNL   *+6
         LR    CC01,TESTRC                                         0623
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE RETURN CODE INDICATES A VOLUME WAS     @Z40LB30*/
*           /* PROCESSED, SET AN INDICATOR.                  @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0624
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/
         C     TESTRC,@CF00035                                     0624
         BNL   @RF00624                                            0624
*             ONEDONE=ON;           /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0625
*         END;                      /*                       @Z40LB30*/
*                                                                  0626
@RF00624 DS    0H                                                  0627
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN ORDER @Z40LB30*/
*       /* TO SPACE BETWEEN THE MESSAGES FOR EACH VOLUME     @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0627
*       DARGAREA=''B;               /*                       @Z40LB30*/
@RF00617 XC    DARGAREA(28),DARGAREA                               0627
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0628
         MVC   DARGSMOD(3,@08),@CC01420                            0628
*       DARGSENT=BLANKS;            /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0629
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0630
         L     @08,@PC00001                                        0630
         ST    @08,@AL00001                                        0630
         LA    @15,@CF00116                                        0630
         ST    @15,@AL00001+4                                      0630
         LA    @15,DDSTRU                                          0630
         ST    @15,@AL00001+8                                      0630
         MVI   @AL00001+8,X'80'                                    0630
         L     @15,GDTPRT(,@08)                                    0630
         LA    @01,@AL00001                                        0630
         BALR  @14,@15                                             0630
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CURRENT RECORD WAS NOT THE LAST, ISSUE     @Z40LB30*/
*       /* USSC TO READ THE NEXT RECORD. FIRST SET THE       @Z40LB30*/
*       /* NEW VOLUME SERIAL IN THE IEZRVVI ARGUMENT LIST.   @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0631
*       IF BASLAST^=ON THEN         /*                       @Z40LB30*/
         TM    BASLAST(BASEVPTR),B'00001000'                       0631
         BO    @RF00631                                            0631
*         DO;                       /*                       @Z40LB30*/
*           RVVSVOL=ON;             /*                       @Z40LB30*/
         L     @08,RVVIPTR                                         0633
         OI    RVVSVOL(@08),B'00000001'                            0633
*           RVVOLUME=BASNEXTV;      /*                       @Z40LB30*/
         MVC   RVVOLUME(6,@08),BASNEXTV(BASEVPTR)                  0634
*           CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*    @Z40LB30*/
         L     @08,@PC00001                                        0635
         ST    @08,@AL00001                                        0635
         LA    @02,VVIC                                            0635
         ST    @02,@AL00001+4                                      0635
         LA    @02,RVVIPTR                                         0635
         ST    @02,@AL00001+8                                      0635
         LA    @02,VVICODE                                         0635
         ST    @02,@AL00001+12                                     0635
         MVI   @AL00001+12,X'80'                                   0635
         L     @15,GDTSSC(,@08)                                    0635
         LA    @01,@AL00001                                        0635
         BALR  @14,@15                                             0635
*           RESPECIFY                                              0636
*             RTNREG RSTD;                                         0636
*           TESTRC=RTNREG;                                         0637
         LR    TESTRC,RTNREG                                       0637
*           RESPECIFY                                              0638
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0638
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO ACTIVE VOLUMES LEFT, SET END OF FILE    @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0639
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0639
         BZ    @RF00639                                            0639
*             IF VVICODE=NOACTIVE THEN/*                     @Z40LB30*/
         CLC   VVICODE(4),@CF01475                                 0640
         BNE   @RF00640                                            0640
*               EOFILE=ON;          /*                       @Z40LB30*/
*                                                                  0641
         OI    EOFILE,B'00100000'                                  0641
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE NEXT VOLUME IN THE CHAIN COULD NOT     @Z40LB30*/
*           /* BE FOUND OR IF IT WAS FOUND TO BE A GROUPED   @Z40LB30*/
*           /* VOLUME, ISSUE MESSAGE IDC2103I.               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0642
*             ELSE                  /*                       @Z40LB30*/
*               IF VVICODE=NORECORD×VVICODE=WRONGCHN/*       @Z40LB30*/
*                 THEN              /*                       @Z40LB30*/
         B     @RC00640                                            0642
@RF00640 L     @08,VVICODE                                         0642
         C     @08,@CF01473                                        0642
         BE    @RT00642                                            0642
         C     @08,@CF01477                                        0642
         BNE   @RF00642                                            0642
@RT00642 DS    0H                                                  0643
*                 DO;               /*                       @Z40LB30*/
*                   RDERROR=ON;     /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0644
*                   DARGAREA=''B;   /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0645
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/
         L     @08,DDSTRU                                          0646
         MVC   DARGSMOD(3,@08),@CC01418                            0646
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/
         MVI   DARGSENT(@08),X'3B'                                 0647
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @08,@PC00001                                        0648
         ST    @08,@AL00001                                        0648
         LA    @15,@CF00116                                        0648
         ST    @15,@AL00001+4                                      0648
         LA    @15,DDSTRU                                          0648
         ST    @15,@AL00001+8                                      0648
         MVI   @AL00001+8,X'80'                                    0648
         L     @15,GDTPRT(,@08)                                    0648
         LA    @01,@AL00001                                        0648
         BALR  @14,@15                                             0648
*                 END;              /*                       @Z40LB30*/
*                                                                  0649
*           /*********************************************************/
*           /*                                                       */
*           /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG        @Z40LB30*/
*           /* TO PRINT THE REASON CODE                      @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0650
*               ELSE                /*                       @Z40LB30*/
*                 DO;               /*                       @Z40LB30*/
         B     @RC00642                                            0650
@RF00642 DS    0H                                                  0651
*                   RDERROR=ON;     /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0651
*                   CALL SSCMSG(VVICODE);/*                  @Z40LB30*/
         LA    @08,VVICODE                                         0652
         ST    @08,@AL00001                                        0652
         LA    @01,@AL00001                                        0652
         BAL   @14,SSCMSG                                          0652
*                 END;              /*                       @Z40LB30*/
*                                                                  0653
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO ERRORS OCCURRED, NOTHING TO DO          @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0654
*           ELSE                                                   0654
*             ;                     /*                       @Z40LB30*/
@RF00639 DS    0H                                                  0655
*         END;                      /*                       @Z40LB30*/
*                                                                  0655
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE CURRENT RECORD IS THE LAST, SET THE        @Z40LB30*/
*       /* END-OF-FILE INDICATOR.                            @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0656
*       ELSE                        /*                       @Z40LB30*/
*         EOFILE=ON;                /*                       @Z40LB30*/
         B     @RC00631                                            0656
@RF00631 OI    EOFILE,B'00100000'                                  0656
*     END;                          /*                       @Z40LB30*/
@RC00631 DS    0H                                                  0657
@DE00610 TM    RDERROR,B'01100000'                                 0657
         BZ    @DL00610                                            0657
*                                                                  0658
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A READ ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/
*   /* AND ISSUE SECONDARY MESSAGE IDC2109I TO SAY NO MORE   @Z40LB30*/
*   /* VOLUMES CAN BE PROCESSED.                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   IF RDERROR=ON THEN              /*                       @Z40LB30*/
@RC00598 TM    RDERROR,B'01000000'                                 0658
         BNO   @RF00658                                            0658
*     DO;                           /*                       @Z40LB30*/
*       CC01=LASTCC12;              /*                       @Z40LB30*/
         LA    CC01,12                                             0660
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0661
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0662
         MVC   DARGSMOD(3,@08),@CC01418                            0662
*       DARGSENT=MSG2109I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'41'                                 0663
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @08,@PC00001                                        0664
         ST    @08,@AL00001                                        0664
         LA    @05,@CF00116                                        0664
         ST    @05,@AL00001+4                                      0664
         LA    @05,DDSTRU                                          0664
         ST    @05,@AL00001+8                                      0664
         MVI   @AL00001+8,X'80'                                    0664
         L     @15,GDTPRT(,@08)                                    0664
         LA    @01,@AL00001                                        0664
         BALR  @14,@15                                             0664
*     END;                          /*                       @Z40LB30*/
*                                                                  0666
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0666
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
@RF00658 C     CC01,@CF00035                                       0666
         BNE   @RF00666                                            0666
         TM    ONEDONE,B'10000000'                                 0666
         BNO   @RF00666                                            0666
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0667
         LA    CC01,8                                              0667
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0668
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00666 LR    @15,CC01                                            0668
@EL00004 DS    0H                                                  0668
@EF00004 DS    0H                                                  0668
@ER00004 L     @14,@SA00004                                        0668
         BR    @14                                                 0668
*   END NONGRPD;                    /*                       @Z40LB30*/
*                                                                  0670
*/*********************************************************  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - ALLGRPS                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/
*/*           READ EACH GROUP RECORD IN THE INVENTORY.  THEN @Z40LB30*/
*/*           CALL A PROCEDURE TO READ EACH ACTIVE BASE      @Z40LB30*/
*/*           VOLUME IN THE GROUP.  FOR EACH VOLUME, CALL    @Z40LB30*/
*/*           PROCEDURES TO CHECK IF THE VOLUME IS TO BE     @Z40LB30*/
*/*           EXCLUDED OR HAS A RECOVERY FLAG ON IN THE      @Z40LB30*/
*/*           VOLUME RECORD AND TO PROCESS THE VOLUME.       @Z40LB30*/
*/*           ISSUE MESSAGE IDC2111I IF AN ERROR             @Z40LB30*/
*/*           OCCURS AND THE REMAINING GROUPS CANNOT         @Z40LB30*/
*/*           BE PROCESSED.  ISSUE MESSAGE IDC0817I IF ALL   @Z40LB30*/
*/*           THE VOLUMES IN A GROUP WERE EXCLUDED FROM      @Z40LB30*/
*/*           PROCESSING.                                    @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/
*/*                           TO ERRORS                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*********************************************************  @Z40LB30*/
*                                                                  0670
*ALLGRPS:                                                          0670
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
ALLGRPS  ST    @14,@SA00005                                        0670
*                                                                  0671
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0671
*   OLDERID2=NEWERID2;                                             0671
         L     @08,@PC00001                                        0671
         L     @08,GDTTR2(,@08)                                    0671
         MVC   @TS00001(95),NEWERID2(@08)                          0671
         MVC   OLDERID2(95,@08),@TS00001                           0671
*   NEWID2='SDAG';                  /*                       @Z40LB30*/
*                                                                  0672
         MVC   NEWID2(4,@08),@CC01520                              0672
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0673
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0673
         SLR   @08,@08                                             0673
         LR    CC01,@08                                            0673
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ EACH GROUP   @Z40LB30*/
*   /* RECORD                                                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0674
*   GRPRVVI=''B;                    /*                       @Z40LB30*/
         XC    GRPRVVI(68),GRPRVVI                                 0674
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/
         LA    @15,GRPRVVI                                         0675
         ST    @15,RVVIPTR                                         0675
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @14,RVVLEN                                          0676
         ST    @14,RVVLNGTH(,@15)                                  0676
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@15),X'87'                                  0677
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@15),@CH01626                            0678
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @14,GRPREC                                          0679
         ST    @14,RVVRTBUF(,@15)                                  0679
*   RVVRDNR=ON;                     /* READ NEXT             @Z40LB30*/
         OI    RVVRDNR(@15),B'01000000'                            0680
*   RVVGRPRC=ON;                    /* GROUP RECORD          @Z40LB30*/
         OI    RVVGRPRC(@15),B'01000000'                           0681
*                                                                  0682
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH ALL THE GROUPS UNTIL NO MORE GROUPS CAN  @Z40LB30*/
*   /* BE READ DUE TO ERROR OR BECAUSE THERE ARE NO MORE.    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0682
*   VVICODE=0;                      /*                       @Z40LB30*/
         ST    @08,VVICODE                                         0682
*   DO UNTIL VVICODE^=0;            /*                       @Z40LB30*/
*                                                                  0683
@DL00683 DS    0H                                                  0684
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE COUNTS OF HOW MANY VOLUMES HAVE BEEN     @Z40LB30*/
*     /* READ FROM THE GROUP AND HOW MANY HAVE BEEN          @Z40LB30*/
*     /* EXCLUDED. SET INDICATOR OF WHETHER LAST             @Z40LB30*/
*     /* VOLUME PROCESSED WAS EXCLUDED TO OFF.               @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0684
*     EXCLCNT=0;                    /*                       @Z40LB30*/
         SLR   @08,@08                                             0684
         STH   @08,EXCLCNT                                         0684
*     VOLRDCNT=0;                   /*                       @Z40LB30*/
         STH   @08,VOLRDCNT                                        0685
*     EXCVOL=OFF;                   /*                       @Z40LB30*/
*                                                                  0686
         NI    EXCVOL,B'11101111'                                  0686
*     /***************************************************************/
*     /*                                                             */
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD.            @Z40LB30*/
*     /* SAVE THE RETURN CODE.                               @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0687
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/
         L     @08,@PC00001                                        0687
         ST    @08,@AL00001                                        0687
         LA    @02,VVIC                                            0687
         ST    @02,@AL00001+4                                      0687
         LA    @02,RVVIPTR                                         0687
         ST    @02,@AL00001+8                                      0687
         LA    @02,VVICODE                                         0687
         ST    @02,@AL00001+12                                     0687
         MVI   @AL00001+12,X'80'                                   0687
         L     @15,GDTSSC(,@08)                                    0687
         LA    @01,@AL00001                                        0687
         BALR  @14,@15                                             0687
*     RESPECIFY                                                    0688
*       RTNREG RSTD;                                               0688
*     TESTRC=RTNREG;                                               0689
         LR    TESTRC,RTNREG                                       0689
*     RESPECIFY                                                    0690
*       RTNREG UNRSTD;              /*                       @Z40LB30*/
*                                                                  0690
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0691
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/
         SLR   @08,@08                                             0691
         CR    TESTRC,@08                                          0691
         BNE   @RF00691                                            0691
*       DO;                         /*                       @Z40LB30*/
*                                                                  0692
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO    @Z40LB30*/
*         /* ZERO TO PASS TO RDGRPCHN PROCEDURE.             @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0693
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
*                                                                  0693
         ST    @08,VOLPTR                                          0693
*         /***********************************************************/
*         /*                                                         */
*         /* READ AND PROCESS ALL ACTIVE BASE VOLUME RECORDS @Z40LB30*/
*         /* UNTIL THERE ARE NO MORE OR A READ ERROR OCCURS. @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0694
*         RDERROR=OFF;              /*                       @Z40LB30*/
         NI    RDERROR,B'10111111'                                 0694
*         DO UNTIL VOLPTR=NULLPTR×RDERROR=ON;/*              @Z40LB30*/
*                                                                  0695
@DL00695 DS    0H                                                  0696
*           /*********************************************************/
*           /*                                                       */
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/
*           /* SAVE THE RETURN CODE.                         @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0696
*           CALL RDGRPCHN;          /*                       @Z40LB30*/
         BAL   @14,RDGRPCHN                                        0696
*           RESPECIFY                                              0697
*             RTNREG RSTD;                                         0697
*           TESTRC=RTNREG;                                         0698
         LR    TESTRC,RTNREG                                       0698
*           RESPECIFY                                              0699
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0699
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/
*           /* IF THERE IS A VOLUME TO PROCESS.              @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0700
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/
         SLR   @08,@08                                             0700
         CR    TESTRC,@08                                          0700
         BNE   @RF00700                                            0700
*             IF VOLPTR^=NULLPTR    /*                       @Z40LB30*/
*               THEN                /*                       @Z40LB30*/
*                                                                  0701
         C     @08,VOLPTR                                          0701
         BE    @RF00701                                            0701
*               /*****************************************************/
*               /*                                                   */
*               /* PROCESS THE VOLUME                        @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0702
*               DO;                 /*                       @Z40LB30*/
*                                                                  0702
*                 /***************************************************/
*                 /*                                                 */
*                 /* INCREMENT THE COUNT OF THE NUMBER       @Z40LB30*/
*                 /* OF VOLUMES READ                         @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0703
*                 VOLRDCNT=VOLRDCNT+1;/*                     @Z40LB30*/
*                                                                  0703
         LA    @08,1                                               0703
         AH    @08,VOLRDCNT                                        0703
         STH   @08,VOLRDCNT                                        0703
*                 /***************************************************/
*                 /*                                                 */
*                 /* CALL CKRECEXC TO SEE IF THE VOLUME      @Z40LB30*/
*                 /* IS EXCLUDED OR IF ANY RECOVERY FLAGS    @Z40LB30*/
*                 /* ARE ON. SAVE THE RETURN CODE.           @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0704
*                 CALL CKRECEXC;    /*                       @Z40LB30*/
         BAL   @14,CKRECEXC                                        0704
*                 RESPECIFY                                        0705
*                   RTNREG RSTD;                                   0705
*                 TESTRC=RTNREG;                                   0706
         LR    TESTRC,RTNREG                                       0706
*                 RESPECIFY                                        0707
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/
*                                                                  0707
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/
*                 /* (>4), SET THE CONDITION CODE TO         @Z40LB30*/
*                 /* INDICATE A VOLUME COULD NOT BE          @Z40LB30*/
*                 /* PROCESSED.                              @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0708
*                 IF TESTRC>LASTCC04 THEN/*                  @Z40LB30*/
         C     TESTRC,@CF00042                                     0708
         BNH   @RF00708                                            0708
*                   CC01=LASTCC12;  /*                       @Z40LB30*/
*                                                                  0709
         LA    CC01,12                                             0709
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/
*                 /* PROCESS IT.                             @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0710
*                 ELSE              /*                       @Z40LB30*/
*                   IF TESTRC=LASTCC00 THEN/*                @Z40LB30*/
         B     @RC00708                                            0710
@RF00708 LTR   TESTRC,TESTRC                                       0710
         BNZ   @RF00710                                            0710
*                     DO;           /*                       @Z40LB30*/
*                                                                  0711
*                       /*********************************************/
*                       /*                                           */
*                       /* CALL PROCVOL TO PROCESS THE       @Z40LB30*/
*                       /* VOLUME. SAVE THE RETURN           @Z40LB30*/
*                       /* CODE. ACCUMULATE THE LARGEST      @Z40LB30*/
*                       /* RETURN CODE IN THE INTERNAL       @Z40LB30*/
*                       /* CONDITION CODE AREA.              @Z40LB30*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0712
*                       CALL PROCVOL;/*                      @Z40LB30*/
         BAL   @14,PROCVOL                                         0712
*                       RESPECIFY                                  0713
*                         RTNREG RSTD;                             0713
*                       TESTRC=RTNREG;                             0714
         LR    TESTRC,RTNREG                                       0714
*                       RESPECIFY                                  0715
*                         RTNREG UNRSTD;/*                   @Z40LB30*/
*                       CC01=MAX(CC01,TESTRC);/*             @Z40LB30*/
*                                                                  0716
         CR    CC01,TESTRC                                         0716
         BNL   *+6
         LR    CC01,TESTRC                                         0716
*                       /*********************************************/
*                       /*                                           */
*                       /* IF THE RETURN CODE INDICATES      @Z40LB30*/
*                       /* A VOLUME WAS PROCESSED, SET       @Z40LB30*/
*                       /* AN INDICATOR.                     @Z40LB30*/
*                       /*                                           */
*                       /*********************************************/
*                                                                  0717
*                       IF TESTRC<LASTCC12 THEN/*            @Z40LB30*/
         C     TESTRC,@CF00035                                     0717
         BNL   @RF00717                                            0717
*                         ONEDONE=ON;/*                      @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0718
*                     END;          /*                       @Z40LB30*/
*                                                                  0719
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE VOLUME WAS EXCLUDED,             @Z40LB30*/
*                 /* INCREMENT THE COUNT OF EXCLUDED         @Z40LB30*/
*                 /* VOLUME AND SET AN INDICATOR.            @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0720
*                   ELSE            /*                       @Z40LB30*/
*                     DO;           /*                       @Z40LB30*/
         B     @RC00710                                            0720
@RF00710 DS    0H                                                  0721
*                       EXCLCNT=EXCLCNT+1;/*                 @Z40LB30*/
         LA    @08,1                                               0721
         AH    @08,EXCLCNT                                         0721
         STH   @08,EXCLCNT                                         0721
*                       EXCVOL=ON;  /*                       @Z40LB30*/
         OI    EXCVOL,B'00010000'                                  0722
*                     END;          /*                       @Z40LB30*/
*               END;                /*                       @Z40LB30*/
*                                                                  0724
*           /*********************************************************/
*           /*                                                       */
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP.    @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0725
*             ELSE                                                 0725
*               ;                   /*                       @Z40LB30*/
*                                                                  0725
@RF00701 DS    0H                                                  0726
*           /*********************************************************/
*           /*                                                       */
*           /* IF THERE WAS AN ERROR READING A VOLUME RECORD @Z40LB30*/
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0726
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC00700                                            0726
@RF00700 DS    0H                                                  0727
*               RDERROR=ON;         /*                       @Z40LB30*/
         OI    RDERROR,B'01000000'                                 0727
*               CC01=LASTCC12;      /*                       @Z40LB30*/
         LA    CC01,12                                             0728
*             END;                  /*                       @Z40LB30*/
*                                                                  0729
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN   @Z40LB30*/
*           /* ORDER TO SPACE BETWEEN THE MESSAGES FOR EACH  @Z40LB30*/
*           /* VOLUME. ISSUE UPRINT ONLY IF LAST VOLUME      @Z40LB30*/
*           /* WAS NOT EXCLUDED SINCE NO MESSAGES WERE ISSUED        */
*           /*                                               @Z40LB30*/
*           /* IF THE VOLUME WAS EXCLUDED.                   @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0730
*           IF EXCVOL=OFF THEN      /*                       @Z40LB30*/
@RC00700 TM    EXCVOL,B'00010000'                                  0730
         BNZ   @RF00730                                            0730
*             DO;                   /*                       @Z40LB30*/
*               DARGAREA=''B;       /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0732
*               DARGSMOD=SD01MSG;   /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0733
         MVC   DARGSMOD(3,@08),@CC01420                            0733
*               DARGSENT=BLANKS;    /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0734
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/
         L     @08,@PC00001                                        0735
         ST    @08,@AL00001                                        0735
         LA    @15,@CF00116                                        0735
         ST    @15,@AL00001+4                                      0735
         LA    @15,DDSTRU                                          0735
         ST    @15,@AL00001+8                                      0735
         MVI   @AL00001+8,X'80'                                    0735
         L     @15,GDTPRT(,@08)                                    0735
         LA    @01,@AL00001                                        0735
         BALR  @14,@15                                             0735
*             END;                  /*                       @Z40LB30*/
*         END;                      /*                       @Z40LB30*/
*                                                                  0737
@RF00730 DS    0H                                                  0737
@DE00695 SLR   @08,@08                                             0737
         C     @08,VOLPTR                                          0737
         BE    @DC00695                                            0737
         TM    RDERROR,B'01000000'                                 0737
         BNO   @DL00695                                            0737
@DC00695 DS    0H                                                  0738
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE IF ALL THE ACTIVE VOLUMES IN THE      @Z40LB30*/
*         /* GROUP HAVE BEEN EXCLUDED. IF NO ERRORS HAVE     @Z40LB30*/
*         /* OCCURRED, AND AT LEAST 1 VOLUME HAS BEEN READ,  @Z40LB30*/
*         /* COMPARE THE COUNT OF THE NUMBER OF VOLUMES READ @Z40LB30*/
*         /* IN THE GROUP TO THE NUMBER EXCLUDED. IF THE     @Z40LB30*/
*         /* COUNTS MATCH, PRINT MESSAGE IDC0817I TO SAY     @Z40LB30*/
*         /* ALL THE VOLUMES IN THE GROUP HAVE BEEN          @Z40LB30*/
*         /* EXCLUDED AND SET AN INDICATOR.                  @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0738
*         IF RDERROR=OFF&VOLRDCNT>0 /*                       @Z40LB30*/
*             &VOLRDCNT=EXCLCNT THEN/*                       @Z40LB30*/
         TM    RDERROR,B'01000000'                                 0738
         BNZ   @RF00738                                            0738
         LH    @15,VOLRDCNT                                        0738
         CR    @15,@08                                             0738
         BNH   @RF00738                                            0738
         CH    @15,EXCLCNT                                         0738
         BNE   @RF00738                                            0738
*           DO;                     /*                       @Z40LB30*/
*             DARGAREA=''B;         /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0740
*             DARGSMOD=SD01MSG;     /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0741
         MVC   DARGSMOD(3,@08),@CC01420                            0741
*             DARGSENT=MSG0817I;    /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'09'                                 0742
*             DARGDBP=ADDR(GROVVGRP);/*                      @Z40LB30*/
         L     @01,GROUPPTR                                        0743
         LA    @15,GROVVGRP(,@01)                                  0743
         ST    @15,DARGDBP(,@08)                                   0743
*             DARGILP=LENGTH(GROVVGRP);/*                    @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00181                             0744
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/
         L     @08,@PC00001                                        0745
         ST    @08,@AL00001                                        0745
         LA    @15,@CF00116                                        0745
         ST    @15,@AL00001+4                                      0745
         LA    @15,DDSTRU                                          0745
         ST    @15,@AL00001+8                                      0745
         MVI   @AL00001+8,X'80'                                    0745
         L     @15,GDTPRT(,@08)                                    0745
         LA    @01,@AL00001                                        0745
         BALR  @14,@15                                             0745
*             EMPTYGRP=ON;          /*                       @Z40LB30*/
         OI    EMPTYGRP,B'00001000'                                0746
*           END;                    /*                       @Z40LB30*/
*                                                                  0747
*         /***********************************************************/
*         /*                                                         */
*         /* RESET THE POINTER TO THE IEZRVVI ARGUMENT LIST. @Z40LB30*/
*         /* INCREMENT GROUP NAME IN IEZRVVI ARGUMENT LIST   @Z40LB30*/
*         /* SO THAT NEXT GROUP RECORD IS READ.              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0748
*         RVVIPTR=ADDR(GRPRVVI);    /*                       @Z40LB30*/
@RF00738 LA    @08,GRPRVVI                                         0748
         ST    @08,RVVIPTR                                         0748
*         RVVGROUP=GROVVGRP;        /*                       @Z40LB30*/
         L     @01,GROUPPTR                                        0749
         MVC   RVVGROUP(8,@08),GROVVGRP(@01)                       0749
*         RVVSGRP=ON;               /*                       @Z40LB30*/
         OI    RVVSGRP(@08),B'10000000'                            0750
*       END;                        /*                       @Z40LB30*/
*   END;                            /*                       @Z40LB30*/
@RF00691 DS    0H                                                  0752
@DE00683 L     @08,VVICODE                                         0752
         LTR   @08,@08                                             0752
         BZ    @DL00683                                            0752
*                                                                  0753
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE WAS AN ERROR READING A GROUP RECORD, CALL    @Z40LB30*/
*   /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT MESSAGE   @Z40LB30*/
*   /* IDC2111I TO SAY NO MORE GROUPS COULD BE PROCESSED.    @Z40LB30*/
*   /* THEN SET CONDITION CODE TO INDICATE A SEVERE ERROR.   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0753
*   IF VVICODE^=NORECORD THEN       /*                       @Z40LB30*/
         C     @08,@CF01473                                        0753
         BE    @RF00753                                            0753
*     DO;                           /*                       @Z40LB30*/
*       CALL SSCMSG(VVICODE);       /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0755
         ST    @08,@AL00001                                        0755
         LA    @01,@AL00001                                        0755
         BAL   @14,SSCMSG                                          0755
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0756
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0757
         MVC   DARGSMOD(3,@08),@CC01418                            0757
*       DARGSENT=MSG2111I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'43'                                 0758
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @08,@PC00001                                        0759
         ST    @08,@AL00001                                        0759
         LA    @05,@CF00116                                        0759
         ST    @05,@AL00001+4                                      0759
         LA    @05,DDSTRU                                          0759
         ST    @05,@AL00001+8                                      0759
         MVI   @AL00001+8,X'80'                                    0759
         L     @15,GDTPRT(,@08)                                    0759
         LA    @01,@AL00001                                        0759
         BALR  @14,@15                                             0759
*       CC01=LASTCC12;              /*                       @Z40LB30*/
         LA    CC01,12                                             0760
*     END;                          /*                       @Z40LB30*/
*                                                                  0762
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED OR AT LEAST      @Z40LB30*/
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER THE       @Z40LB30*/
*   /* FINAL CONDITION CODE.                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0762
*   IF CC01=LASTCC12&(ONEDONE=ON×EMPTYGRP=ON) THEN/*         @Z40LB30*/
@RF00753 C     CC01,@CF00035                                       0762
         BNE   @RF00762                                            0762
         TM    ONEDONE,B'10001000'                                 0762
         BZ    @RF00762                                            0762
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0763
         LA    CC01,8                                              0763
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER.                                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0764
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00762 LR    @15,CC01                                            0764
@EL00005 DS    0H                                                  0764
@EF00005 DS    0H                                                  0764
@ER00005 L     @14,@SA00005                                        0764
         BR    @14                                                 0764
*   END ALLGRPS;                    /*                       @Z40LB30*/
*                                                                  0766
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - ALLVOLS                                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - INTERFACE WITH THE MSVC PROGRAM TO READ EACH  @Z40LB30*/
*/*           ACTIVE BASE VOLUME RECORD IN THE INVENTORY.    @Z40LB30*/
*/*           THEN CALL A PROCEDURE TO CHECK IF THE VOLUME   @Z40LB30*/
*/*           IS TO BE EXCLUDED OR IF THE RECORD HAS ANY     @Z40LB30*/
*/*           RECOVERY FLAGS ON.  THEN CALL A PROCEDURE.     @Z40LB30*/
*/*           TO PROCESS THE VOLUME.  ISSUE MESSAGE          @Z40LB30*/
*/*           IDC0104I IF THERE ARE NO ACTIVE VOLUMES        @Z40LB30*/
*/*           IN THE INVENTORY AND MESSAGE IDC2109I          @Z40LB30*/
*/*           IF AN ERROR OCCURS AND NO MORE VOLUMES         @Z40LB30*/
*/*           CAN BE PROCESSED.                              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - NONE                                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/
*/*                           CLOSING VTOC                   @Z40LB30*/
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/
*/*                           DUE TO ERRORS                  @Z40LB30*/
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/
*/*                           TO ERRORS                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0766
*ALLVOLS:                                                          0766
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
ALLVOLS  ST    @14,@SA00006                                        0766
*                                                                  0767
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0767
*   OLDERID2=NEWERID2;                                             0767
         L     @08,@PC00001                                        0767
         L     @02,GDTTR2(,@08)                                    0767
         MVC   @TS00001(95),NEWERID2(@02)                          0767
         MVC   OLDERID2(95,@02),@TS00001                           0767
*   NEWID2='SDAV';                  /*                       @Z40LB30*/
*                                                                  0768
         MVC   NEWID2(4,@02),@CC01524                              0768
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /* SET MSVC REASON CODE TO 0                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0769
*   CC01=LASTCC00;                  /*                       @Z40LB30*/
         SLR   @02,@02                                             0769
         LR    CC01,@02                                            0769
*   VVICODE=0;                      /*                       @Z40LB30*/
*                                                                  0770
         ST    @02,VVICODE                                         0770
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ AN ACTIVE    @Z40LB30*/
*   /* BASE VOLUME RECORD.                                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0771
*   VOLRVVI=''B;                    /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0771
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/
         LA    @02,VOLRVVI                                         0772
         ST    @02,RVVIPTR                                         0772
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/
         LH    @15,RVVLEN                                          0773
         ST    @15,RVVLNGTH(,@02)                                  0773
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/
         MVI   RVVCODE(@02),X'87'                                  0774
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@02),@CH01625                            0775
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,VOLREC                                          0776
         ST    @15,RVVRTBUF(,@02)                                  0776
*   RVVRDNR=ON;                     /* READ NEXT RECORDS     @Z40LB30*/
         OI    RVVRDNR(@02),B'01000000'                            0777
*   RVVBVRCD=ON;                    /* BASE RECORDS ONLY     @Z40LB30*/
         OI    RVVBVRCD(@02),B'10000000'                           0778
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/
*                                                                  0779
         OI    RVVACTV(@02),B'00000100'                            0779
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USSC MACRO TO READ FIRST RECORD.                @Z40LB30*/
*   /* SAVE THE RETURN CODE.                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0780
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/
         ST    @08,@AL00001                                        0780
         LA    @02,VVIC                                            0780
         ST    @02,@AL00001+4                                      0780
         LA    @02,RVVIPTR                                         0780
         ST    @02,@AL00001+8                                      0780
         LA    @02,VVICODE                                         0780
         ST    @02,@AL00001+12                                     0780
         MVI   @AL00001+12,X'80'                                   0780
         L     @15,GDTSSC(,@08)                                    0780
         LA    @01,@AL00001                                        0780
         BALR  @14,@15                                             0780
*   RESPECIFY                                                      0781
*     RTNREG RSTD;                                                 0781
*   TESTRC=RTNREG;                                                 0782
         LR    TESTRC,RTNREG                                       0782
*   RESPECIFY                                                      0783
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0784
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FIRST RECORD WAS READ SUCCESSFULLY, START A    @Z40LB30*/
*   /* LOOP TO PROCESS THE VOLUME AND THEN READ THE NEXT     @Z40LB30*/
*   /* VOLUME RECORD. END THE LOOP WHEN THERE ARE NO MORE    @Z40LB30*/
*   /* ACTIVE BASE VOLUME RECORDS THAT CAN BE READ FROM THE  @Z40LB30*/
*   /* INVENTORY.                                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0784
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0784
         BNZ   @RF00784                                            0784
*     DO WHILE VVICODE=0;           /*                       @Z40LB30*/
*                                                                  0785
         B     @DE00785                                            0785
@DL00785 DS    0H                                                  0786
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CKRECEXC TO SEE IF THE VOLUME IS EXCLUDED    @Z40LB30*/
*       /* BY THE SCRDSET COMMAND OR IF A RECOVERY FLAG IS   @Z40LB30*/
*       /* ON IN THE VOLUME RECORD. SAVE THE RETURN CODE.    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0786
*       CALL CKRECEXC;              /*                       @Z40LB30*/
         BAL   @14,CKRECEXC                                        0786
*       RESPECIFY                                                  0787
*         RTNREG RSTD;                                             0787
*       TESTRC=RTNREG;                                             0788
         LR    TESTRC,RTNREG                                       0788
*       RESPECIFY                                                  0789
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0789
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE INDICATES AN ERROR (>4), SET   @Z40LB30*/
*       /* THE CONDITION CODE TO INDICATE A SEVERE ERROR     @Z40LB30*/
*       /* THAT PREVENTED A VOLUME BEING PROCESSED.          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0790
*       IF TESTRC>LASTCC04 THEN     /*                       @Z40LB30*/
         C     TESTRC,@CF00042                                     0790
         BNH   @RF00790                                            0790
*         CC01=LASTCC12;            /*                       @Z40LB30*/
*                                                                  0791
         LA    CC01,12                                             0791
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME CAN BE PROCESSED, PROCESS IT.       @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0792
*       ELSE                        /*                       @Z40LB30*/
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/
         B     @RC00790                                            0792
@RF00790 LTR   TESTRC,TESTRC                                       0792
         BNZ   @RF00792                                            0792
*           DO;                     /*                       @Z40LB30*/
*                                                                  0793
*             /*******************************************************/
*             /*                                                     */
*             /* CALL PROCVOL TO PROCESS THE VOLUME. SAVE    @Z40LB30*/
*             /* THE RETURN CODE. ACCUMULATE THE HIGHEST     @Z40LB30*/
*             /* RETURN CODE IN THE INTERNAL CONDITION       @Z40LB30*/
*             /* CODE AREA.                                  @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0794
*             CALL PROCVOL;         /*                       @Z40LB30*/
         BAL   @14,PROCVOL                                         0794
*             RESPECIFY                                            0795
*               RTNREG RSTD;                                       0795
*             TESTRC=RTNREG;                                       0796
         LR    TESTRC,RTNREG                                       0796
*             RESPECIFY                                            0797
*               RTNREG UNRSTD;      /*                       @Z40LB30*/
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/
*                                                                  0798
         CR    CC01,TESTRC                                         0798
         BNL   *+6
         LR    CC01,TESTRC                                         0798
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE RETURN CODE INDICATES THE VOLUME     @Z40LB30*/
*             /* WAS PROCESSED, SET AN INDICATOR.            @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0799
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/
         C     TESTRC,@CF00035                                     0799
         BNL   @RF00799                                            0799
*               ONEDONE=ON;         /*                       @Z40LB30*/
         OI    ONEDONE,B'10000000'                                 0800
*           END;                    /*                       @Z40LB30*/
*                                                                  0801
@RF00799 DS    0H                                                  0802
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN       @Z40LB30*/
*       /* ORDER TO SPACE BETWEEN THE MESSAGES FOR EACH      @Z40LB30*/
*       /* VOLUME                                            @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0802
*       DARGAREA=''B;               /*                       @Z40LB30*/
@RF00792 DS    0H                                                  0802
@RC00790 XC    DARGAREA(28),DARGAREA                               0802
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0803
         MVC   DARGSMOD(3,@08),@CC01420                            0803
*       DARGSENT=BLANKS;            /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'06'                                 0804
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0805
         L     @08,@PC00001                                        0805
         ST    @08,@AL00001                                        0805
         LA    @02,@CF00116                                        0805
         ST    @02,@AL00001+4                                      0805
         LA    @02,DDSTRU                                          0805
         ST    @02,@AL00001+8                                      0805
         MVI   @AL00001+8,X'80'                                    0805
         L     @15,GDTPRT(,@08)                                    0805
         LA    @01,@AL00001                                        0805
         BALR  @14,@15                                             0805
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE VOLUME SERIAL IN THE IEZRVVI ARGUMENT     @Z40LB30*/
*       /* LIST TO THE SERIAL IN THE CURRENT BASE VOLUME     @Z40LB30*/
*       /* RECORD IN PREPARATION FOR READING THE NEXT        @Z40LB30*/
*       /* RECORD.                                           @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0806
*       RVVOLUME=BASSERNO;          /*                       @Z40LB30*/
         L     @08,RVVIPTR                                         0806
         MVC   RVVOLUME(6,@08),BASSERNO(BASEVPTR)                  0806
*       RVVSVOL=ON;                 /*                       @Z40LB30*/
*                                                                  0807
         OI    RVVSVOL(@08),B'00000001'                            0807
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/
*       /* RETURN CODE.                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0808
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*        @Z40LB30*/
         L     @08,@PC00001                                        0808
         ST    @08,@AL00001                                        0808
         LA    @02,VVIC                                            0808
         ST    @02,@AL00001+4                                      0808
         LA    @02,RVVIPTR                                         0808
         ST    @02,@AL00001+8                                      0808
         LA    @02,VVICODE                                         0808
         ST    @02,@AL00001+12                                     0808
         MVI   @AL00001+12,X'80'                                   0808
         L     @15,GDTSSC(,@08)                                    0808
         LA    @01,@AL00001                                        0808
         BALR  @14,@15                                             0808
*       RESPECIFY                                                  0809
*         RTNREG RSTD;                                             0809
*       TESTRC=RTNREG;                                             0810
         LR    TESTRC,RTNREG                                       0810
*       RESPECIFY                                                  0811
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0811
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODES INDICATE AN ERROR OCCURRED,   @Z40LB30*/
*       /* CALL THE SSCMSG PROCEDURE TO PRINT THE REASON     @Z40LB30*/
*       /* CODE AND THEN PRINT MESSAGE IDC2109I TO SAY NO    @Z40LB30*/
*       /* MORE VOLUMES COULD BE PROCESSED.                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0812
*       IF TESTRC^=0&VVICODE^=NORECORD&/*                    @Z40LB30*/
*           VVICODE^=NOACTIVE THEN  /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0812
         BZ    @RF00812                                            0812
         L     @08,VVICODE                                         0812
         C     @08,@CF01473                                        0812
         BE    @RF00812                                            0812
         C     @08,@CF01475                                        0812
         BE    @RF00812                                            0812
*         DO;                       /*                       @Z40LB30*/
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0814
         ST    @08,@AL00001                                        0814
         LA    @01,@AL00001                                        0814
         BAL   @14,SSCMSG                                          0814
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0815
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0816
         MVC   DARGSMOD(3,@08),@CC01418                            0816
*           DARGSENT=MSG2109I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'41'                                 0817
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
*                                                                  0818
         L     @08,@PC00001                                        0818
         ST    @08,@AL00001                                        0818
         LA    @15,@CF00116                                        0818
         ST    @15,@AL00001+4                                      0818
         LA    @15,DDSTRU                                          0818
         ST    @15,@AL00001+8                                      0818
         MVI   @AL00001+8,X'80'                                    0818
         L     @15,GDTPRT(,@08)                                    0818
         LA    @01,@AL00001                                        0818
         BALR  @14,@15                                             0818
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE INTERNAL CONDITION CODE.              @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0819
*           CC01=LASTCC12;          /*                       @Z40LB30*/
         LA    CC01,12                                             0819
*         END;                      /*                       @Z40LB30*/
*     END;                          /*                       @Z40LB30*/
@RF00812 DS    0H                                                  0821
@DE00785 L     @08,VVICODE                                         0821
         LTR   @08,@08                                             0821
         BZ    @DL00785                                            0821
*                                                                  0822
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A RECORD WAS NOT RETURNED BY THE FIRST READ,       @Z40LB30*/
*   /* DETERMINE IF IT WAS AN ERROR OR IF THERE ARE NO       @Z40LB30*/
*   /* ACTIVE VOLUME RECORDS IN THE INVENTORY.               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*   ELSE                            /*                       @Z40LB30*/
*                                                                  0822
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE RETURN CODE INDICATES NO ACTIVE VOLUME       @Z40LB30*/
*     /* RECORDS, PRINT MESSAGE IDC0104I.                    @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0822
*     IF VVICODE=NORECORD×VVICODE=NOACTIVE THEN/*            @Z40LB30*/
         B     @RC00784                                            0822
@RF00784 L     @08,VVICODE                                         0822
         C     @08,@CF01473                                        0822
         BE    @RT00822                                            0822
         C     @08,@CF01475                                        0822
         BNE   @RF00822                                            0822
@RT00822 DS    0H                                                  0823
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0824
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0825
         MVC   DARGSMOD(3,@08),@CC01418                            0825
*         DARGSENT=MSG0104I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'3C'                                 0826
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @08,@PC00001                                        0827
         ST    @08,@AL00001                                        0827
         LA    @05,@CF00116                                        0827
         ST    @05,@AL00001+4                                      0827
         LA    @05,DDSTRU                                          0827
         ST    @05,@AL00001+8                                      0827
         MVI   @AL00001+8,X'80'                                    0827
         L     @15,GDTPRT(,@08)                                    0827
         LA    @01,@AL00001                                        0827
         BALR  @14,@15                                             0827
*       END;                        /*                       @Z40LB30*/
*                                                                  0828
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/
*   /* REASON CODE AND PRINT MESSAGE IDC2109I TO SAY NO      @Z40LB30*/
*   /* MORE VOLUMES CAN BE PROCESSED.                        @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0829
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
         B     @RC00822                                            0829
@RF00822 DS    0H                                                  0830
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/
         LA    @08,VVICODE                                         0830
         ST    @08,@AL00001                                        0830
         LA    @01,@AL00001                                        0830
         BAL   @14,SSCMSG                                          0830
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0831
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0832
         MVC   DARGSMOD(3,@08),@CC01418                            0832
*         DARGSENT=MSG2109I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'41'                                 0833
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
*                                                                  0834
         L     @08,@PC00001                                        0834
         ST    @08,@AL00001                                        0834
         LA    @05,@CF00116                                        0834
         ST    @05,@AL00001+4                                      0834
         LA    @05,DDSTRU                                          0834
         ST    @05,@AL00001+8                                      0834
         MVI   @AL00001+8,X'80'                                    0834
         L     @15,GDTPRT(,@08)                                    0834
         LA    @01,@AL00001                                        0834
         BALR  @14,@15                                             0834
*         /***********************************************************/
*         /*                                                         */
*         /* SET THE INTERNAL CONDITION CODE TO INDICATE NO  @Z40LB30*/
*         /* VOLUMES PROCESSED.                              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0835
*         CC01=LASTCC12;            /*                       @Z40LB30*/
         LA    CC01,12                                             0835
*       END;                        /*                       @Z40LB30*/
*                                                                  0837
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE FINAL CONDITON CODE INDICATES A SEVERE ERROR   @Z40LB30*/
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF AT LEAST     @Z40LB30*/
*   /* ONE VOLUME WAS PROCESSED, LOWER THE FINAL CONDITION   @Z40LB30*/
*   /* CODE.                                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0837
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/
@RC00822 DS    0H                                                  0837
@RC00784 C     CC01,@CF00035                                       0837
         BNE   @RF00837                                            0837
         TM    ONEDONE,B'10000000'                                 0837
         BNO   @RF00837                                            0837
*     CC01=LASTCC08;                /*                       @Z40LB30*/
*                                                                  0838
         LA    CC01,8                                              0838
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0839
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00837 LR    @15,CC01                                            0839
@EL00006 DS    0H                                                  0839
@EF00006 DS    0H                                                  0839
@ER00006 L     @14,@SA00006                                        0839
         BR    @14                                                 0839
*   END ALLVOLS;                    /*                       @Z40LB30*/
*                                                                  0841
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - RDGRPCHN                                     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - READ THE NEXT ACTIVE AND, OPTIONALLY, GENERAL @Z40LB30*/
*/*           USE VOLUME RECORD IN A SPECIFIC GROUP.  IF     @Z40LB30*/
*/*           THERE ARE NO ACTIVE AND, OPTIONALLY, GENERAL-  @Z40LB30*/
*/*           USE VOLUMES IN THE GROUP, ISSUE MESSAGE        @Z40LB30*/
*/*           IDC0105I OR MESSAGE IDC0106I.  IF A CHAIN      @Z40LB30*/
*/*           ERROR OCCURS, ISSUE MESSAGE IDC2103I.  IF      @Z40LB30*/
*/*           ANY READ ERROR OCCURS, ISSUE MESSAGE IDC2110I. @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - GROUP RECORD. POINTER TO BASE VOLUME RECORD      @Z40LB30*/
*/*         (VOLPTR) SET WITH 0 IF NO VOLUME RECORDS HAVE    @Z40LB30*/
*/*         BEEN READ YET OR SET WITH THE ADDRESS OF THE     @Z40LB30*/
*/*         LAST VOLUME RECORD READ. FUNTION DEFINITION      @Z40LB30*/
*/*         TABLE.                                           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/
*/*                        4, AN ERROR OCCURRED              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*          POINTER TO VOLUME RECORD SET WITH 0 IF NO MORE  @Z40LB30*/
*/*          RECORDS ARE IN THE GROUP OR SET WITH ADDRESS    @Z40LB30*/
*/*          OF VOLUME RECORD JUST READ                      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  0841
*RDGRPCHN:                                                         0841
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
RDGRPCHN ST    @14,@SA00007                                        0841
*                                                                  0842
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE.    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0842
*   OLDERID2=NEWERID2;                                             0842
         L     @08,@PC00001                                        0842
         L     @06,GDTTR2(,@08)                                    0842
         MVC   @TS00001(95),NEWERID2(@06)                          0842
         MVC   OLDERID2(95,@06),@TS00001                           0842
*   NEWID2='SDRG';                  /*                       @Z40LB30*/
*                                                                  0843
         MVC   NEWID2(4,@06),@CC01528                              0843
*   /*****************************************************************/
*   /*                                                               */
*   /* SET CONDITION CODE TO ZERO AND INITIALIZE INDICATOR   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0844
*   CC02=0;                         /*                       @Z40LB30*/
         SLR   @15,@15                                             0844
         LR    CC02,@15                                            0844
*   NOVOLS=OFF;                     /*                       @Z40LB30*/
         NI    NOVOLS,B'11101111'                                  0845
*                                                                  0846
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO BASE VOLUME RECORDS HAVE BEEN READ YET FOR      @Z40LB30*/
*   /* THIS GROUP, CHECK FOR NO VOLUMES IN THE GROUP AND     @Z40LB30*/
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST.                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0846
*   IF VOLPTR=NULLPTR THEN          /*                       @Z40LB30*/
         C     @15,VOLPTR                                          0846
         BNE   @RF00846                                            0846
*     DO;                           /*                       @Z40LB30*/
*                                                                  0847
*       /*************************************************************/
*       /*                                                           */
*       /* IF GENERAL WAS SPECIFIED, BUT THERE ARE NO        @Z40LB30*/
*       /* ACTIVE GENERAL VOLUMES IN THE GROUP, ISSUE        @Z40LB30*/
*       /* MESSAGE IDC0106I.                                 @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0848
*       IF ADDR(GENER)^=NULLPTR&GRONGEN=0 THEN/*             @Z40LB30*/
         L     @06,@PC00001+4                                      0848
         C     @15,FDTPTR+60(,@06)                                 0848
         BE    @RF00848                                            0848
         L     @06,GROUPPTR                                        0848
         CH    @15,GRONGEN(,@06)                                   0848
         BNE   @RF00848                                            0848
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0850
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0851
         MVC   DARGSMOD(3,@15),@CC01418                            0851
*           DARGSENT=MSG0106I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'3E'                                 0852
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB30*/
         LA    @06,GROVVGRP(,@06)                                  0853
         ST    @06,DARGDBP(,@15)                                   0853
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00181                             0854
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         ST    @08,@AL00001                                        0855
         LA    @06,@CF00116                                        0855
         ST    @06,@AL00001+4                                      0855
         LA    @06,DDSTRU                                          0855
         ST    @06,@AL00001+8                                      0855
         MVI   @AL00001+8,X'80'                                    0855
         L     @15,GDTPRT(,@08)                                    0855
         LA    @01,@AL00001                                        0855
         BALR  @14,@15                                             0855
*           NOVOLS=ON;              /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0856
*         END;                      /*                       @Z40LB30*/
*                                                                  0857
*       /*************************************************************/
*       /*                                                           */
*       /* IF GENERAL WAS NOT SPECIFIED, BUT THERE ARE NO    @Z40LB30*/
*       /* ACTIVE GENERAL OR RESTRICTED VOLUMES IN THE GROUP @Z40LB30*/
*       /* ISSUE MESSAGE IDC0105I.                           @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0858
*       IF ADDR(GENER)=NULLPTR&GRONGEN=0&/*                  @Z40LB30*/
*           GRONRSTD=0 THEN         /*                       @Z40LB30*/
@RF00848 SLR   @08,@08                                             0858
         L     @06,@PC00001+4                                      0858
         C     @08,FDTPTR+60(,@06)                                 0858
         BNE   @RF00858                                            0858
         L     @06,GROUPPTR                                        0858
         CH    @08,GRONGEN(,@06)                                   0858
         BNE   @RF00858                                            0858
         CH    @08,GRONRSTD(,@06)                                  0858
         BNE   @RF00858                                            0858
*         DO;                       /*                       @Z40LB30*/
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0860
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0861
         MVC   DARGSMOD(3,@08),@CC01418                            0861
*           DARGSENT=MSG0105I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'3D'                                 0862
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB30*/
         LA    @06,GROVVGRP(,@06)                                  0863
         ST    @06,DARGDBP(,@08)                                   0863
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00181                             0864
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @08,@PC00001                                        0865
         ST    @08,@AL00001                                        0865
         LA    @06,@CF00116                                        0865
         ST    @06,@AL00001+4                                      0865
         LA    @06,DDSTRU                                          0865
         ST    @06,@AL00001+8                                      0865
         MVI   @AL00001+8,X'80'                                    0865
         L     @15,GDTPRT(,@08)                                    0865
         LA    @01,@AL00001                                        0865
         BALR  @14,@15                                             0865
*           NOVOLS=ON;              /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0866
*         END;                      /*                       @Z40LB30*/
*                                                                  0867
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE ARE SOME VOLUMES IN THE GROUP, SET       @Z40LB30*/
*       /* FIELDS IN THE IEZRVVI ARGUMENT LIST TO READ       @Z40LB30*/
*       /* VOLUME RECORDS IN THE GROUP.                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0868
*       IF NOVOLS=OFF THEN          /*                       @Z40LB30*/
@RF00858 TM    NOVOLS,B'00010000'                                  0868
         BNZ   @RF00868                                            0868
*         DO;                       /*                       @Z40LB30*/
*           VOLRVVI=''B;            /*                       @Z40LB30*/
         XC    VOLRVVI(68),VOLRVVI                                 0870
*           RVVIPTR=ADDR(VOLRVVI);  /*                       @Z40LB30*/
         LA    @08,VOLRVVI                                         0871
         ST    @08,RVVIPTR                                         0871
*           RVVLNGTH=RVVLEN;        /*                       @Z40LB30*/
         LH    @06,RVVLEN                                          0872
         ST    @06,RVVLNGTH(,@08)                                  0872
*           RVVCODE=RVVOP;          /*                       @Z40LB30*/
         MVI   RVVCODE(@08),X'87'                                  0873
*           RVVGROUP=GROVVGRP;      /* GROUP NAME            @Z40LB30*/
         L     @06,GROUPPTR                                        0874
         MVC   RVVGROUP(8,@08),GROVVGRP(@06)                       0874
*           RVVBUFLN=LENGTH(VOLREC);/*                       @Z40LB30*/
         MVC   RVVBUFLN(2,@08),@CH01625                            0875
*           RVVRTBUF=ADDR(VOLREC);  /* ADDRESS OF BUFFER     @Z40LB30*/
         LA    @15,VOLREC                                          0876
         ST    @15,RVVRTBUF(,@08)                                  0876
*           RVVRDCH=ON;             /* READ CHAIN            @Z40LB30*/
         OI    RVVRDCH(@08),B'00100000'                            0877
*           RVVBVRCD=ON;            /* BASE VOLUME           @Z40LB30*/
         OI    RVVBVRCD(@08),B'10000000'                           0878
*           RVVGPVOL=ON;            /* GROUPED CHAIN         @Z40LB30*/
         OI    RVVGPVOL(@08),B'10000000'                           0879
*           RVVACTV=ON;             /* ONLY ACTIVE VOLUMES   @Z40LB30*/
         OI    RVVACTV(@08),B'00000100'                            0880
*           RVVSGRP=ON;             /* GROUP NAME SPECIFIED  @Z40LB30*/
*           RVVSVOL=ON;             /* VOLUME SPECIFIED      @Z40LB30*/
         OI    RVVSGRP(@08),B'10000001'                            0882
*           RVVOLUME=GROFSN;        /* FIRST VOLUME IN CHAIN @Z40LB30*/
*                                                                  0883
         MVC   RVVOLUME(6,@08),GROFSN(@06)                         0883
*           /*********************************************************/
*           /*                                                       */
*           /* IF ONLY GENERAL VOLUMES REQUESTED ON THE      @Z40LB30*/
*           /* COMMAND, SPECIFY THAT.                        @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0884
*           IF ADDR(GENER)^=NULLPTR THEN/*                   @Z40LB30*/
         L     @06,@PC00001+4                                      0884
         L     @06,FDTPTR+60(,@06)                                 0884
         LTR   @06,@06                                             0884
         BZ    @RF00884                                            0884
*             RVVGSVOL=ON;          /*                       @Z40LB30*/
         OI    RVVGSVOL(@08),B'00100000'                           0885
*         END;                      /*                       @Z40LB30*/
*                                                                  0886
@RF00884 DS    0H                                                  0887
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE ARE NO VOLUMES TO BE PROCESSED IN        @Z40LB30*/
*       /* THIS GROUP, SET AN INDICATOR SO THE FINAL         @Z40LB30*/
*       /* CONDITION CODE CAN BE SET TO REFLECT ONE          @Z40LB30*/
*       /* GROUP WAS PROCESSED.                              @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0887
*       IF NOVOLS=ON THEN           /*                       @Z40LB30*/
@RF00868 TM    NOVOLS,B'00010000'                                  0887
         BNO   @RF00887                                            0887
*         EMPTYGRP=ON;              /*                       @Z40LB30*/
         OI    EMPTYGRP,B'00001000'                                0888
*     END;                          /*                       @Z40LB30*/
*                                                                  0890
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A BASE VOLUME RECORD IN THIS GROUP HAS BEEN READ   @Z40LB30*/
*   /* PREVIOUSLY, CHECK IF THERE ARE ANY MORE VOLUMES IN    @Z40LB30*/
*   /* THE GROUP.                                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0890
*   ELSE                            /*                       @Z40LB30*/
*                                                                  0890
*     /***************************************************************/
*     /*                                                             */
*     /* NO MORE VOLUMES                                     @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0890
*     IF BASLAST=ON THEN            /*                       @Z40LB30*/
*                                                                  0890
         B     @RC00846                                            0890
@RF00846 TM    BASLAST(BASEVPTR),B'00001000'                       0890
         BNO   @RF00890                                            0890
*       /*************************************************************/
*       /*                                                           */
*       /* SET INDICATOR AND ZERO OUT THE POINTER TO THE     @Z40LB30*/
*       /* VOLUME RECORD.                                    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0891
*       DO;                         /*                       @Z40LB30*/
*         NOVOLS=ON;                /*                       @Z40LB30*/
         OI    NOVOLS,B'00010000'                                  0892
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/
         SLR   @08,@08                                             0893
         ST    @08,VOLPTR                                          0893
*       END;                        /*                       @Z40LB30*/
*                                                                  0894
*   /*****************************************************************/
*   /*                                                               */
*   /* MORE VOLUMES                                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0895
*     ELSE                          /*                       @Z40LB30*/
*                                                                  0895
*       /*************************************************************/
*       /*                                                           */
*       /* PUT THE NEXT VOLUME SERIAL INTO THE IEZRVVI       @Z40LB30*/
*       /* ARGUMENT LIST                                     @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0895
*       DO;                         /*                       @Z40LB30*/
         B     @RC00890                                            0895
@RF00890 DS    0H                                                  0896
*         RVVIPTR=ADDR(VOLRVVI);    /*                       @Z40LB30*/
         LA    @08,VOLRVVI                                         0896
         ST    @08,RVVIPTR                                         0896
*         RVVSVOL=ON;               /*                       @Z40LB30*/
         OI    RVVSVOL(@08),B'00000001'                            0897
*         RVVOLUME=BASNEXTV;        /*                       @Z40LB30*/
         MVC   RVVOLUME(6,@08),BASNEXTV(BASEVPTR)                  0898
*       END;                        /*                       @Z40LB30*/
*                                                                  0900
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THERE ARE MORE VOLUMES IN THE GROUP, READ ONE.     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0900
*   IF NOVOLS=OFF THEN              /*                       @Z40LB30*/
@RC00890 DS    0H                                                  0900
@RC00846 TM    NOVOLS,B'00010000'                                  0900
         BNZ   @RF00900                                            0900
*     DO;                           /*                       @Z40LB30*/
*                                                                  0901
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/
*       /* RETURN CODE.                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0902
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE2);/*       @Z40LB30*/
         L     @08,@PC00001                                        0902
         ST    @08,@AL00001                                        0902
         LA    @06,VVIC                                            0902
         ST    @06,@AL00001+4                                      0902
         LA    @06,RVVIPTR                                         0902
         ST    @06,@AL00001+8                                      0902
         LA    @06,VVICODE2                                        0902
         ST    @06,@AL00001+12                                     0902
         MVI   @AL00001+12,X'80'                                   0902
         L     @15,GDTSSC(,@08)                                    0902
         LA    @01,@AL00001                                        0902
         BALR  @14,@15                                             0902
*       RESPECIFY                                                  0903
*         RTNREG RSTD;                                             0903
*       TESTRC=RTNREG;                                             0904
         LR    TESTRC,RTNREG                                       0904
*       RESPECIFY                                                  0905
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0905
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO ERROR, PUT ADDRESS OF RECORD IN POINTER     @Z40LB30*/
*       /* AREA FOR CALLER.                                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0906
*       IF TESTRC=0 THEN            /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       0906
         BNZ   @RF00906                                            0906
*         VOLPTR=ADDR(VOLREC);      /*                       @Z40LB30*/
         LA    @08,VOLREC                                          0907
         ST    @08,VOLPTR                                          0907
*                                                                  0908
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO RECORD WAS READ, CHECK FOR ERRORS.          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0908
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
*                                                                  0908
         B     @RC00906                                            0908
@RF00906 DS    0H                                                  0909
*           /*********************************************************/
*           /*                                                       */
*           /* SET VOLUME RECORD POINTER TO ZERO.            @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0909
*           VOLPTR=NULLPTR;         /*                       @Z40LB30*/
*                                                                  0909
         SLR   @08,@08                                             0909
         ST    @08,VOLPTR                                          0909
*           /*********************************************************/
*           /*                                                       */
*           /* IF A REAL ERROR OCCURRED, PROCESS IT.         @Z40LB30*/
*           /* NO MORE ACTIVE VOLUMES IS NOT AN ERROR.       @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0910
*           IF VVICODE2^=NOACTIVE THEN/*                     @Z40LB30*/
         L     @08,VVICODE2                                        0910
         C     @08,@CF01475                                        0910
         BE    @RF00910                                            0910
*             DO;                   /*                       @Z40LB30*/
*                                                                  0911
*               /*****************************************************/
*               /*                                                   */
*               /* IF CHAINING ERROR, ISSUE MESSAGE IDC2103I @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0912
*               IF VVICODE2=NORECORD×VVICODE2=WRONGCHN/*     @Z40LB30*/
*                 THEN              /*                       @Z40LB30*/
         C     @08,@CF01473                                        0912
         BE    @RT00912                                            0912
         C     @08,@CF01477                                        0912
         BNE   @RF00912                                            0912
@RT00912 DS    0H                                                  0913
*                 DO;               /*                       @Z40LB30*/
*                   DARGAREA=''B;   /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0914
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/
         L     @08,DDSTRU                                          0915
         MVC   DARGSMOD(3,@08),@CC01418                            0915
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/
         MVI   DARGSENT(@08),X'3B'                                 0916
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @08,@PC00001                                        0917
         ST    @08,@AL00001                                        0917
         LA    @15,@CF00116                                        0917
         ST    @15,@AL00001+4                                      0917
         LA    @15,DDSTRU                                          0917
         ST    @15,@AL00001+8                                      0917
         MVI   @AL00001+8,X'80'                                    0917
         L     @15,GDTPRT(,@08)                                    0917
         LA    @01,@AL00001                                        0917
         BALR  @14,@15                                             0917
*                 END;              /*                       @Z40LB30*/
*                                                                  0918
*               /*****************************************************/
*               /*                                                   */
*               /* IF ANOTHER ERROR, CALL SSCMSG TO PRINT    @Z40LB30*/
*               /* REASON CODE.                              @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0919
*               ELSE                /*                       @Z40LB30*/
*                 CALL SSCMSG(VVICODE2);/*                   @Z40LB30*/
*                                                                  0919
         B     @RC00912                                            0919
@RF00912 LA    @08,VVICODE2                                        0919
         ST    @08,@AL00001                                        0919
         LA    @01,@AL00001                                        0919
         BAL   @14,SSCMSG                                          0919
*               /*****************************************************/
*               /*                                                   */
*               /* FOLLOW WITH MESSAGE IDC2110I TO SAY NO    @Z40LB30*/
*               /* MORE VOLUMES IN THE GROUP CAN BE          @Z40LB30*/
*               /* PROCESSED.                                @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0920
*               DARGAREA=''B;       /*                       @Z40LB30*/
@RC00912 XC    DARGAREA(28),DARGAREA                               0920
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0921
         MVC   DARGSMOD(3,@08),@CC01418                            0921
*               DARGSENT=MSG2110I;  /*                       @Z40LB30*/
         MVI   DARGSENT(@08),X'42'                                 0922
*               DARGDBP=ADDR(GROVVGRP);/*                    @Z40LB30*/
         L     @06,GROUPPTR                                        0923
         LA    @06,GROVVGRP(,@06)                                  0923
         ST    @06,DARGDBP(,@08)                                   0923
*               DARGILP=LENGTH(GROVVGRP);/*                  @Z40LB30*/
         MVC   DARGILP(2,@08),@CH00181                             0924
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/
*                                                                  0925
         L     @08,@PC00001                                        0925
         ST    @08,@AL00001                                        0925
         LA    @06,@CF00116                                        0925
         ST    @06,@AL00001+4                                      0925
         LA    @06,DDSTRU                                          0925
         ST    @06,@AL00001+8                                      0925
         MVI   @AL00001+8,X'80'                                    0925
         L     @15,GDTPRT(,@08)                                    0925
         LA    @01,@AL00001                                        0925
         BALR  @14,@15                                             0925
*               /*****************************************************/
*               /*                                                   */
*               /* SET CONDITION CODE                        @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0926
*               CC02=4;             /*                       @Z40LB30*/
         LA    CC02,4                                              0926
*             END;                  /*                       @Z40LB30*/
*         END;                      /*                       @Z40LB30*/
@RF00910 DS    0H                                                  0929
*     END;                          /*                       @Z40LB30*/
*                                                                  0929
@RC00906 DS    0H                                                  0930
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0930
*   RETURN CODE(CC02);              /*                       @Z40LB30*/
@RF00900 LR    @15,CC02                                            0930
@EL00007 DS    0H                                                  0930
@EF00007 DS    0H                                                  0930
@ER00007 L     @14,@SA00007                                        0930
         BR    @14                                                 0930
*   END RDGRPCHN;                   /*                       @Z40LB30*/
*                                                                  0932
*/*********************************************************  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - CKRECEXC                                @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - CHECK THE INVENTORY VOLUME RECORD TO DETERMINE@Z40LB30*/
*/*            IF ANY RECOVERY FLAGS ARE SET AND CHECK TO    @Z40LB30*/
*/*            SEE IF THE SCRDSET COMMAND INDICATED THE      @Z40LB30*/
*/*            VOLUME IS TO BE EXCLUDED.                     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTIONAL DATA TABLE, INVENTORY VOLUME RECORD.  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 - 0, NO ERRORS                      @Z40LB30*/
*/*                        4, VOLUME EXCLUDED BY COMMAND     @Z40LB30*/
*/*                       12, VOLUME CANNOT BE PROCESSED     @Z40LB30*/
*/*                           BECAUSE RECOVERY FLAGS ARE SET @Z40LB30*/
*/*                                                          @Z40LB30*/
*/***********************************************************@Z40LB30*/
*                                                                  0932
*CKRECEXC:                                                         0932
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
CKRECEXC ST    @14,@SA00008                                        0932
*                                                                  0933
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0933
*   OLDERID2=NEWERID2;                                             0933
         L     @08,@PC00001                                        0933
         L     @08,GDTTR2(,@08)                                    0933
         MVC   @TS00001(95),NEWERID2(@08)                          0933
         MVC   OLDERID2(95,@08),@TS00001                           0933
*   NEWID2='SDCK';                  /*                       @Z40LB30*/
*                                                                  0934
         MVC   NEWID2(4,@08),@CC01532                              0934
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE INTERNAL CONDITION CODE TO 0                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0935
*   CC02=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0935
         SLR   @08,@08                                             0935
         LR    CC02,@08                                            0935
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF VOLUME WAS SPECIFIED ON THE EXCLUDEVOLUME    @Z40LB30*/
*   /* PARAMETER                                             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0936
*   IF ADDR(EXVOL)^=NULLPTR THEN    /*                       @Z40LB30*/
         L     @06,@PC00001+4                                      0936
         C     @08,FDTPTR+52(,@06)                                 0936
         BE    @RF00936                                            0936
*     DO;                           /*                       @Z40LB30*/
*       DO INDEX1=1 TO EXVOLCNT WHILE EXVOLVAL(INDEX1)/*     @Z40LB30*/
*             ^=BASSERNO;           /*                       @Z40LB30*/
         LA    INDEX1,1                                            0938
         B     @DE00938                                            0938
@DL00938 LR    @08,INDEX1                                          0938
         SLA   @08,3                                               0938
         L     @06,@PC00001+4                                      0938
         L     @06,FDTPTR+52(,@06)                                 0938
         ALR   @06,@08                                             0938
         AL    @06,@CF01643                                        0938
         CLC   EXVOLVAL-3(6,@06),BASSERNO(BASEVPTR)                0938
         BE    @DC00938                                            0938
*       END;                        /*                       @Z40LB30*/
*                                                                  0939
         AL    INDEX1,@CF00221                                     0939
@DE00938 L     @08,@PC00001+4                                      0939
         L     @08,FDTPTR+52(,@08)                                 0939
         CH    INDEX1,EXVOLCNT(,@08)                               0939
         BNH   @DL00938                                            0939
@DC00938 DS    0H                                                  0940
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME SERIAL WAS FOUND ON THE EXCLUDE     @Z40LB30*/
*       /* LIST, SET THE RETURN CODE                         @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0940
*       IF INDEX1<=EXVOLCNT THEN    /*                       @Z40LB30*/
         L     @08,@PC00001+4                                      0940
         L     @08,FDTPTR+52(,@08)                                 0940
         CH    INDEX1,EXVOLCNT(,@08)                               0940
         BH    @RF00940                                            0940
*         CC02=LASTCC04;            /*                       @Z40LB30*/
         LA    CC02,4                                              0941
*     END;                          /*                       @Z40LB30*/
@RF00940 DS    0H                                                  0943
*                                                                  0943
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE VOLUME WAS NOT EXCLUDED, CHECK THE VOLUME      @Z40LB30*/
*   /* RECORD TO SEE IF ANY UTILITY RECOVERY FLAGS ARE ON.   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0943
*   IF CC02=LASTCC00&BASSATIA^=0 THEN/*                      @Z40LB30*/
@RF00936 LTR   CC02,CC02                                           0943
         BNZ   @RF00943                                            0943
         LH    @08,BASSATIA(,BASEVPTR)                             0943
         N     @08,@CF01648                                        0943
         LTR   @08,@08                                             0943
         BZ    @RF00943                                            0943
*     DO;                           /*                       @Z40LB30*/
*                                                                  0944
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP TO ISSUE A MESSAGE SAYING WHICH RECOVERY   @Z40LB30*/
*       /* FLAG IS SET                                       @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0945
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0945
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0946
         MVC   DARGSMOD(3,@08),@CC01418                            0946
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB30*/
         LA    @15,BASSERNO(,BASEVPTR)                             0947
         ST    @15,DARGDBP(,@08)                                   0947
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB30*/
*                                                                  0948
         MVC   DARGILP(2,@08),@CH00158                             0948
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME WAS INCOMPLETELY RENAMED, ISSUE     @Z40LB30*/
*       /* MESSAGE IDC2095I                                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0949
*       IF BASVSMIS=ON THEN         /*                       @Z40LB30*/
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0949
         BNO   @RF00949                                            0949
*         DARGSENT=MSG2095I;        /*                       @Z40LB30*/
*                                                                  0950
         MVI   DARGSENT(@08),X'09'                                 0950
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE VOLUME WAS INCOMPLETELY COPIED, ISSUE      @Z40LB30*/
*       /* MESSAGE IDC2096I                                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0951
*       ELSE                        /*                       @Z40LB30*/
*         IF BASIVCPY=ON THEN       /*                       @Z40LB30*/
         B     @RC00949                                            0951
@RF00949 TM    BASIVCPY(BASEVPTR),B'01000000'                      0951
         BNO   @RF00951                                            0951
*           DARGSENT=MSG2096I;      /*                       @Z40LB30*/
*                                                                  0952
         L     @08,DDSTRU                                          0952
         MVI   DARGSENT(@08),X'06'                                 0952
*       /*************************************************************/
*       /*                                                           */
*       /* THE VOLUME MUST BE INCOMPLETELY CREATED,          @Z40LB30*/
*       /* SO ISSUE MESSAGE IDC2097I                         @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0953
*         ELSE                      /*                       @Z40LB30*/
*           DARGSENT=MSG2097I;      /*                       @Z40LB30*/
*                                                                  0953
         B     @RC00951                                            0953
@RF00951 L     @08,DDSTRU                                          0953
         MVI   DARGSENT(@08),X'03'                                 0953
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0954
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0954
@RC00951 DS    0H                                                  0954
@RC00949 L     @08,@PC00001                                        0954
         ST    @08,@AL00001                                        0954
         LA    @06,@CF00116                                        0954
         ST    @06,@AL00001+4                                      0954
         LA    @06,DDSTRU                                          0954
         ST    @06,@AL00001+8                                      0954
         MVI   @AL00001+8,X'80'                                    0954
         L     @15,GDTPRT(,@08)                                    0954
         LA    @01,@AL00001                                        0954
         BALR  @14,@15                                             0954
*       /*************************************************************/
*       /*                                                           */
*       /* FOLLOW WITH SECONDARY MESSAGE IDC2108I            @Z40LB30*/
*       /* TO INDICATE THE VOLUME WAS NOT PROCESSED          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0955
*       DARGSENT=MSG2108I;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0955
         MVI   DARGSENT(@08),X'40'                                 0955
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0956
         L     @08,@PC00001                                        0956
         ST    @08,@AL00001                                        0956
         LA    @06,@CF00116                                        0956
         ST    @06,@AL00001+4                                      0956
         LA    @06,DDSTRU                                          0956
         ST    @06,@AL00001+8                                      0956
         MVI   @AL00001+8,X'80'                                    0956
         L     @15,GDTPRT(,@08)                                    0956
         LA    @01,@AL00001                                        0956
         BALR  @14,@15                                             0956
*       /*************************************************************/
*       /*                                                           */
*       /* SET CONDITION CODE                                @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0957
*       CC02=LASTCC12;              /*                       @Z40LB30*/
         LA    CC02,12                                             0957
*     END;                          /*                       @Z40LB30*/
*                                                                  0958
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0959
*   RETURN CODE(CC02);              /*                       @Z40LB30*/
@RF00943 LR    @15,CC02                                            0959
@EL00008 DS    0H                                                  0959
@EF00008 DS    0H                                                  0959
@ER00008 L     @14,@SA00008                                        0959
         BR    @14                                                 0959
*   END CKRECEXC;                   /*                       @Z40LB30*/
*                                                                  0961
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - PROCVOL                                 @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - CONTROLS THE SCRATCH AND UNCATALOG OF ELIGI-  @Z40LB30*/
*/*            BLE DATA SETS FROM A PARTICULAR VOLUME. CALLS @Z40LB30*/
*/*            PROCEDURES TO ALLOCATE A UNIT, SELECT ELIGI-  @Z40LB30*/
*/*            BLE DATA SETS, AND SCRATCH AND UNCATALOG THE  @Z40LB30*/
*/*            DATA SETS.  THIS PROCEDURE THEN FREES STORAGE @Z40LB30*/
*/*            AND DEALLOCATES THE UNIT IF NECESSARY.  AT    @Z40LB30*/
*/*            START, ISSUES MESSAGE IDC0810I OR IDC0815I    @Z40LB30*/
*/*            TO INDICATE WHICH VOLUME IS BEING PROCESSED.  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - INVENTORY VOLUME RECORD, GROUP RECORD            @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, DEALLOCATION OR VTOC CLOSE     @Z40LB30*/
*/*                           ERROR                          @Z40LB30*/
*/*                        8, ERROR PREVENTED SOME DATA SETS @Z40LB30*/
*/*                           FROM BEING SCRATCHED BUT SOME  @Z40LB30*/
*/*                           DATA SETS WERE SCRATCHED       @Z40LB30*/
*/*                       12, THE ENTIRE VOLUME COULD NOT    @Z40LB30*/
*/*                           BE PROCESSED DUE TO ERRORS     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  0961
*PROCVOL:                                                          0961
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
PROCVOL  ST    @14,@SA00009                                        0961
*                                                                  0962
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0962
*   OLDERID2=NEWERID2;                                             0962
         L     @08,@PC00001                                        0962
         L     @08,GDTTR2(,@08)                                    0962
         MVC   @TS00001(95),NEWERID2(@08)                          0962
         MVC   OLDERID2(95,@08),@TS00001                           0962
*   NEWID2='SDPV';                  /*                       @Z40LB30*/
*                                                                  0963
         MVC   NEWID2(4,@08),@CC01536                              0963
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0964
*   CC02=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  0964
         SLR   @08,@08                                             0964
         LR    CC02,@08                                            0964
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO ISSUE A MESSAGE TO INDICATE WHICH VOLUME    @Z40LB30*/
*   /* IS BEING PROCESSED. GET THE VOLUME SERIAL FROM THE    @Z40LB30*/
*   /* INVENTORY VOLUME RECORD.                              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0965
*   DARGAREA=''B;                   /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0965
*   DARGSMOD=SD01MSG;               /*                       @Z40LB30*/
         L     @15,DDSTRU                                          0966
         MVC   DARGSMOD(3,@15),@CC01420                            0966
*   DARGDBP=ADDR(BASSERNO);         /*                       @Z40LB30*/
         LA    @14,BASSERNO(,BASEVPTR)                             0967
         ST    @14,DARGDBP(,@15)                                   0967
*   DARGILP=LENGTH(BASSERNO);       /*                       @Z40LB30*/
*                                                                  0968
         MVC   DARGILP(2,@15),@CH00158                             0968
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A GROUP IS BEING PROCESSED, ISSUE MESSAGE          @Z40LB30*/
*   /* IDC0815I, INSERTING THE GROUP NAME FROM THE           @Z40LB30*/
*   /* INVENTORY GROUP RECORD                                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0969
*   IF ADDR(GRP)^=NULLPTR×ADDR(AGRP)^=NULLPTR THEN/*         @Z40LB30*/
         L     @15,@PC00001+4                                      0969
         C     @08,FDTPTR+4(,@15)                                  0969
         BNE   @RT00969                                            0969
         C     @08,FDTPTR+12(,@15)                                 0969
         BE    @RF00969                                            0969
@RT00969 DS    0H                                                  0970
*     DO;                           /*                       @Z40LB30*/
*       DARGSENT=MSG0815I;          /*                       @Z40LB30*/
         L     @08,DDSTRU                                          0971
         MVI   DARGSENT(@08),X'07'                                 0971
*       DARGCNT=1;                  /*                       @Z40LB30*/
         LA    @15,1                                               0972
         STH   @15,DARGCNT(,@08)                                   0972
*       DARGINS(1)=1;               /*                       @Z40LB30*/
         STH   @15,DARGINS(,@08)                                   0973
*       DARGINL(1)=LENGTH(GROVVGRP);/*                       @Z40LB30*/
         MVC   DARGINL(2,@08),@CH00181                             0974
*       DARGDTM(1)=ADDR(GROVVGRP);  /*                       @Z40LB30*/
         L     @01,GROUPPTR                                        0975
         LA    @15,GROVVGRP(,@01)                                  0975
         ST    @15,DARGDTM(,@08)                                   0975
*     END;                          /*                       @Z40LB30*/
*                                                                  0976
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A GROUP IS NOT BEING PROCESSED, ISSUE MESSAGE      @Z40LB30*/
*   /* IDC0810I                                              @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0977
*   ELSE                            /*                       @Z40LB30*/
*     DARGSENT=MSG0810I;            /*                       @Z40LB30*/
         B     @RC00969                                            0977
@RF00969 L     @08,DDSTRU                                          0977
         MVI   DARGSENT(@08),X'01'                                 0977
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/
@RC00969 L     @08,@PC00001                                        0978
         ST    @08,@AL00001                                        0978
         LA    @15,@CF00116                                        0978
         ST    @15,@AL00001+4                                      0978
         LA    @15,DDSTRU                                          0978
         ST    @15,@AL00001+8                                      0978
         MVI   @AL00001+8,X'80'                                    0978
         L     @15,GDTPRT(,@08)                                    0978
         LA    @01,@AL00001                                        0978
         BALR  @14,@15                                             0978
*                                                                  0979
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL THE ALLOCATE PROCEDURE TO DETERMINE THE DD       @Z40LB30*/
*   /* TO USE TO MOUNT THE VOLUME. SAVE THE RETURN CODE      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0979
*   CALL ALLOCATE;                  /*                       @Z40LB30*/
         BAL   @14,ALLOCATE                                        0979
*   RESPECIFY                                                      0980
*     RTNREG RSTD;                                                 0980
*   TESTRC=RTNREG;                                                 0981
         LR    TESTRC,RTNREG                                       0981
*   RESPECIFY                                                      0982
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*   CC02=TESTRC;                    /*                       @Z40LB30*/
         LR    CC02,TESTRC                                         0983
*                                                                  0984
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALLOCATE WAS SUCCESSFUL, CONTINUE.                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0984
*   IF CC02=LASTCC00 THEN           /*                       @Z40LB30*/
         LTR   CC02,CC02                                           0984
         BNZ   @RF00984                                            0984
*     DO;                           /*                       @Z40LB30*/
*                                                                  0985
*       /*************************************************************/
*       /*                                                           */
*       /* CALL SELECTOR TO SELECT ELIGIBLE DATA SETS.       @Z40LB30*/
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0986
*       CALL SELECTOR;              /*                       @Z40LB30*/
         BAL   @14,SELECTOR                                        0986
*       RESPECIFY                                                  0987
*         RTNREG RSTD;                                             0987
*       TESTRC=RTNREG;                                             0988
         LR    TESTRC,RTNREG                                       0988
*       RESPECIFY                                                  0989
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*       CC02=TESTRC;                /*                       @Z40LB30*/
*                                                                  0990
         LR    CC02,TESTRC                                         0990
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE INDICATES A LIST OF ELIGIBLE   @Z40LB30*/
*       /* DATA SETS WAS RETURNED, CONTINUE.                 @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0991
*       IF CC02<LASTCC12 THEN       /*                       @Z40LB30*/
         C     CC02,@CF00035                                       0991
         BNL   @RF00991                                            0991
*         DO;                       /*                       @Z40LB30*/
*                                                                  0992
*           /*********************************************************/
*           /*                                                       */
*           /* CALL SCRUNCAT PROCEDURE TO SCRATCH AND        @Z40LB30*/
*           /* UNCATALOG THE DATA SETS. SAVE THE RETURN      @Z40LB30*/
*           /* CODE.                                         @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0993
*           CALL SCRUNCAT;          /*                       @Z40LB30*/
         BAL   @14,SCRUNCAT                                        0993
*           RESPECIFY                                              0994
*             RTNREG RSTD;                                         0994
*           TESTRC=RTNREG;                                         0995
         LR    TESTRC,RTNREG                                       0995
*           RESPECIFY                                              0996
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  0996
*           /*********************************************************/
*           /*                                                       */
*           /* SET THE INTERNAL CONDITION CODE TO THE RETURN @Z40LB30*/
*           /* CODE FROM SCRUNCAT IF IT IS HIGHER.           @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0997
*           CC02=MAX(CC02,TESTRC);  /*                       @Z40LB30*/
*                                                                  0997
         CR    CC02,TESTRC                                         0997
         BNL   *+6
         LR    CC02,TESTRC                                         0997
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE INTERNAL CODE IS 8, INDICATING DATA    @Z40LB30*/
*           /* SET ERRORS, AND NO DATA SETS COULD BE         @Z40LB30*/
*           /* SELECTED, INCREASE THE INTERNAL CONDITION     @Z40LB30*/
*           /* CODE TO 12.                                   @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0998
*           RESPECIFY                                              0998
*             VSDBLOCK BASED(LISTADDR);/*                    @Z40LB30*/
*           IF CC02=LASTCC08&VSDELEM=0 THEN/*                @Z40LB30*/
         C     CC02,@CF00181                                       0999
         BNE   @RF00999                                            0999
         L     @08,LISTADDR                                        0999
         L     @08,VSDELEM(,@08)                                   0999
         LTR   @08,@08                                             0999
         BNZ   @RF00999                                            0999
*             CC02=LASTCC12;        /*                       @Z40LB30*/
         LA    CC02,12                                             1000
*         END;                      /*                       @Z40LB30*/
*                                                                  1001
@RF00999 DS    0H                                                  1002
*       /*************************************************************/
*       /*                                                           */
*       /* IF SELECTOR CAUSED STORAGE TO BE OBTAINED,        @Z40LB30*/
*       /* ISSUE UFPOOL MACRO TO FREE IT.                    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1002
*       IF LISTADDR^=NULLPTR THEN   /*                       @Z40LB30*/
@RF00991 L     @08,LISTADDR                                        1002
         LTR   @08,@08                                             1002
         BZ    @RF01002                                            1002
*         CALL IDCSAFP0(GDTTBL,POOLID);/*                    @Z40LB30*/
*                                                                  1003
         L     @08,@PC00001                                        1003
         ST    @08,@AL00001                                        1003
         LA    @06,@CC01467                                        1003
         ST    @06,@AL00001+4                                      1003
         MVI   @AL00001+4,X'80'                                    1003
         L     @15,GDTFPL(,@08)                                    1003
         LA    @01,@AL00001                                        1003
         BALR  @14,@15                                             1003
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE ALLOCATE PROCEDURE DYNAMICALLY ALLOCATED   @Z40LB30*/
*       /* A UNIT, ISSUE UDEALLOC MACRO TO DEALLOCATE IT.    @Z40LB30*/
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1004
*       IF ALOCFLAG=ON THEN         /*                       @Z40LB30*/
@RF01002 TM    ALOCFLAG,B'10000000'                                1004
         BNO   @RF01004                                            1004
*         DO;                       /*                       @Z40LB30*/
*           RESPECIFY                                              1006
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB30*/
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Z40LB30*/
         L     @08,@PC00001                                        1007
         ST    @08,@AL00001                                        1007
         LA    @06,ALOCAREA                                        1007
         ST    @06,@AL00001+4                                      1007
         MVI   @AL00001+4,X'80'                                    1007
         L     @15,GDTDLC(,@08)                                    1007
         LA    @01,@AL00001                                        1007
         BALR  @14,@15                                             1007
*           RESPECIFY                                              1008
*             RTNREG RSTD;                                         1008
*           TESTRC=RTNREG;                                         1009
         LR    TESTRC,RTNREG                                       1009
*           RESPECIFY                                              1010
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  1010
*           /*********************************************************/
*           /*                                                       */
*           /* IF UDEALLOC FAILED, SET THE INTERNAL          @Z40LB30*/
*           /* CONDITION CODE.                               @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1011
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1011
         BZ    @RF01011                                            1011
*             CC02=MAX(LASTCC04,CC02);/*                     @Z40LB30*/
         LA    @08,4                                               1012
         CR    CC02,@08                                            1012
         BNL   *+6
         LR    CC02,@08                                            1012
*         END;                      /*                       @Z40LB30*/
@RF01011 DS    0H                                                  1014
*     END;                          /*                       @Z40LB30*/
@RF01004 DS    0H                                                  1015
*                                                                  1015
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1015
*   RETURN CODE(CC02);              /*                       @Z40LB30*/
@RF00984 LR    @15,CC02                                            1015
@EL00009 DS    0H                                                  1015
@EF00009 DS    0H                                                  1015
@ER00009 L     @14,@SA00009                                        1015
         BR    @14                                                 1015
*   END PROCVOL;                    /*                       @Z40LB30*/
*                                                                  1017
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE - ALLOCATE                                     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - DETERMINE THE DD TO USE TO MOUNT THE VOLUME   @Z40LB30*/
*/*            ON.  CHECK THE DD TO DETERMINE IF THE UNIT IS @Z40LB30*/
*/*            VIRTUAL.  DYNAMICALLY ALLOCATE THE VOLUME IF  @Z40LB30*/
*/*            NECESSARY.  ISSUE MESSAGE IDC2108I IF THE     @Z40LB30*/
*/*            VOLUME CAN NOT BE PROCESSED.                  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - INVENTORY BASE RECORD                            @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                       12, EITHER THE UNIT ALLOCATED TO   @Z40LB30*/
*/*                           THE VOLUME IS NOT VIRTUAL OR   @Z40LB30*/
*/*                           DYNAMIC ALLOCATION FAILED      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*         ALOCFLAG SET ON IF VOLUME WAS DYNAMICALLY        @Z40LB30*/
*/*          ALLOCATED, OTHERWISE, SET OFF.                  @Z40LB30*/
*/*          DDNAME FIELD SET WITH DD NAME IF RETURN CODE    @Z40LB30*/
*/*          IS 0.                                           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*          ADDRUCB SET TO ZERO OR SET WITH THE ADDRESS OF  @Z40LB30*/
*/*          THE UCB OF A UNIT SELECTED FOR USE              @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  1017
*ALLOCATE:                                                         1017
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
ALLOCATE ST    @14,@SA00010                                        1017
*                                                                  1018
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1018
*   OLDERID2=NEWERID2;                                             1018
         L     @02,@PC00001                                        1018
         L     @15,GDTTR2(,@02)                                    1018
         MVC   @TS00001(95),NEWERID2(@15)                          1018
         MVC   OLDERID2(95,@15),@TS00001                           1018
*   NEWID2='SDAL';                  /*                       @Z40LB30*/
*                                                                  1019
         MVC   NEWID2(4,@15),@CC01546                              1019
*   /*****************************************************************/
*   /*                                                               */
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1020
*   CC03=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  1020
         SLR   @15,@15                                             1020
         LR    CC03,@15                                            1020
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FLAG TO INDICATE NO DYNAMIC ALLOCATION            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1021
*   ALOCFLAG=OFF;                   /*                       @Z40LB30*/
*                                                                  1021
         NI    ALOCFLAG,B'01111111'                                1021
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UMSSUNIT MACRO TO DETERMINE IF THE VOLUME IS    @Z40LB30*/
*   /* MOUNTED. SAVE THE RETURN CODE.                        @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1022
*   RESPECIFY                                                      1022
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB30*/
*   SELAGL=''B;                     /* SET TO ZERO           @Z40LB30*/
         LA    @14,SLTAREA                                         1023
         XC    SELAGL(23,@14),SELAGL(@14)                          1023
*   SELUCBP=ADDR(ADDRUCB);          /* UCB TO BE RETURNED    @Z40LB30*/
         LA    @07,ADDRUCB                                         1024
         ST    @07,SELUCBP(,@14)                                   1024
*   ADDRUCB=NULLPTR;                /*                       @Z40LB30*/
         ST    @15,ADDRUCB                                         1025
*   SELDDNP=ADDR(DDNAME);           /* DD TO BE RETURNED     @Z40LB30*/
         LA    @15,DDNAME                                          1026
         ST    @15,SELDDNP(,@14)                                   1026
*   SELVOL=BASSERNO;                /* VOLUME SERIAL         @Z40LB30*/
         MVC   SELVOL(6,@14),BASSERNO(BASEVPTR)                    1027
*   CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*                 @Z40LB30*/
         ST    @02,@AL00001                                        1028
         LA    @15,SELECTDD                                        1028
         ST    @15,@AL00001+4                                      1028
         ST    @14,@AL00001+8                                      1028
         MVI   @AL00001+8,X'80'                                    1028
         L     @15,GDTUNT(,@02)                                    1028
         LA    @01,@AL00001                                        1028
         BALR  @14,@15                                             1028
*   RESPECIFY                                                      1029
*     RTNREG RSTD;                                                 1029
*   TESTRC=RTNREG;                                                 1030
         LR    TESTRC,RTNREG                                       1030
*   RESPECIFY                                                      1031
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  1031
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A DD WAS FOUND BY UMSSUNIT, ISSUE UMSSUNIT MACRO   @Z40LB30*/
*   /* TO CHECK THAT THE UNIT IS VIRTUAL. SAVE THE RETURN    @Z40LB30*/
*   /* CODE.                                                 @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1032
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1032
         BNZ   @RF01032                                            1032
*     DO;                           /*                       @Z40LB30*/
*       RESPECIFY                                                  1034
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB30*/
*       CKAGL=''B;                  /*                       @Z40LB30*/
         LA    @02,CHKAREA                                         1035
         XC    CKAGL(29,@02),CKAGL(@02)                            1035
*       CKUCBPTR=ADDR(ADDRUCB);     /*                       @Z40LB30*/
         LA    @15,ADDRUCB                                         1036
         ST    @15,CKUCBPTR(,@02)                                  1036
*       CKDDNAME=DDNAME;            /*                       @Z40LB30*/
         MVC   CKDDNAME(8,@02),DDNAME                              1037
*       CKTESTVT=ON;                /*                       @Z40LB30*/
         OI    CKTESTVT(@02),B'10000000'                           1038
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB30*/
         L     @15,@PC00001                                        1039
         ST    @15,@AL00001                                        1039
         LA    @14,CHECK                                           1039
         ST    @14,@AL00001+4                                      1039
         ST    @02,@AL00001+8                                      1039
         MVI   @AL00001+8,X'80'                                    1039
         L     @15,GDTUNT(,@15)                                    1039
         LA    @01,@AL00001                                        1039
         BALR  @14,@15                                             1039
*       RESPECIFY                                                  1040
*         RTNREG RSTD;                                             1040
*       TESTRC=RTNREG;                                             1041
         LR    TESTRC,RTNREG                                       1041
*       RESPECIFY                                                  1042
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  1042
*       /*************************************************************/
*       /*                                                           */
*       /* IF AN ERROR WAS FOUND, SET THE INTERNAL           @Z40LB30*/
*       /* CONDITION CODE.                                   @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1043
*       IF TESTRC^=0 THEN           /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1043
         BZ    @RF01043                                            1043
*         CC03=LASTCC12;            /*                       @Z40LB30*/
         LA    CC03,12                                             1044
*     END;                          /*                       @Z40LB30*/
*                                                                  1046
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO DD WAS FOUND, CONTINUE                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1046
*   ELSE                            /*                       @Z40LB30*/
*     DO;                           /*                       @Z40LB30*/
*                                                                  1046
         B     @RC01032                                            1046
@RF01032 DS    0H                                                  1047
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FILE PARAMETER WAS SPECIFIED ON THE        @Z40LB30*/
*       /* COMMAND, RETURN IT TO THE CALLER.                 @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1047
*       IF ADDR(FILE)^=NULLPTR THEN /*                       @Z40LB30*/
         L     @15,@PC00001+4                                      1047
         L     @15,FDTPTR+44(,@15)                                 1047
         LTR   @15,@15                                             1047
         BZ    @RF01047                                            1047
*         DDNAME=FILEVAL;           /*                       @Z40LB30*/
*                                                                  1048
         MVC   DDNAME(8),FILEVAL(@15)                              1048
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE FILE PARAMETER WAS NOT SPECIFIED, ISSUE    @Z40LB30*/
*       /* THE UALLOC MACRO TO DYNAMICALLY ALLOCATE A UNIT.  @Z40LB30*/
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1049
*       ELSE                        /*                       @Z40LB30*/
*         DO;                       /*                       @Z40LB30*/
         B     @RC01047                                            1049
@RF01047 DS    0H                                                  1050
*           RESPECIFY                                              1050
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB30*/
*           ALLAGL=''B;             /*                       @Z40LB30*/
         LA    @02,ALOCAREA                                        1051
         XC    ALLAGL(31,@02),ALLAGL(@02)                          1051
*           UNITCNT=1;              /*                       @Z40LB30*/
         LA    @15,1                                               1052
         STH   @15,UNITCNT                                         1052
*           UNITLNG=LENGTH(V3330);  /*                       @Z40LB30*/
         MVC   UNITLNG(2),@CH00297                                 1053
*           UNITNAME=V3330;         /* UNIT TYPE             @Z40LB30*/
         MVI   UNITNAME+5,C' '                                     1054
         MVC   UNITNAME+6(2),UNITNAME+5                            1054
         MVC   UNITNAME(5),@CC01469                                1054
*           VOLCOUNT=1;             /*                       @Z40LB30*/
         STH   @15,VOLCOUNT                                        1055
*           VOLLNG=LENGTH(BASSERNO);/*                       @Z40LB30*/
         MVC   VOLLNG(2),@CH00158                                  1056
*           VOLNAME=BASSERNO;       /* VOLUME SERIAL         @Z40LB30*/
         MVC   VOLNAME(6),BASSERNO(BASEVPTR)                       1057
*           ALLULP=ADDR(UNITLIST);  /* UNIT TYPE LIST        @Z40LB30*/
         LA    @15,UNITLIST                                        1058
         ST    @15,ALLULP(,@02)                                    1058
*           ALLVLP=ADDR(VOLLIST);   /* VOLUME SERIAL LIST    @Z40LB30*/
         LA    @15,VOLLIST                                         1059
         ST    @15,ALLVLP(,@02)                                    1059
*           ALLOPTVL=ON;            /* VOLUME ALLOCATION     @Z40LB30*/
*           ALLOPTPV=ON;            /* PRIVATE VOLUME        @Z40LB30*/
         OI    ALLOPTVL(@02),B'10100000'                           1061
*           ALOCFLAG=ON;            /* INDICATES DYNAMIC     @Z40LB30
*                                      ALLOCATION WAS DONE   @Z40LB30*/
         OI    ALOCFLAG,B'10000000'                                1062
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Z40LB30*/
         L     @15,@PC00001                                        1063
         ST    @15,@AL00001                                        1063
         ST    @02,@AL00001+4                                      1063
         MVI   @AL00001+4,X'80'                                    1063
         L     @15,GDTALC(,@15)                                    1063
         LA    @01,@AL00001                                        1063
         BALR  @14,@15                                             1063
*           RESPECIFY                                              1064
*             RTNREG RSTD;                                         1064
*           TESTRC=RTNREG;                                         1065
         LR    TESTRC,RTNREG                                       1065
*           RESPECIFY                                              1066
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*                                                                  1066
*           /*********************************************************/
*           /*                                                       */
*           /* IF AN ERROR OCCURRED, SET THE CONDITION CODE  @Z40LB30*/
*           /* OTHERWISE, RETURN DDNAME.                     @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1067
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1067
         BZ    @RF01067                                            1067
*             CC03=LASTCC12;        /*                       @Z40LB30*/
         LA    CC03,12                                             1068
*           ELSE                    /*                       @Z40LB30*/
*             DDNAME=ALLDDN;        /*                       @Z40LB30*/
         B     @RC01067                                            1069
@RF01067 LA    @15,ALOCAREA                                        1069
         MVC   DDNAME(8),ALLDDN(@15)                               1069
*         END;                      /*                       @Z40LB30*/
@RC01067 DS    0H                                                  1071
*     END;                          /*                       @Z40LB30*/
@RC01047 DS    0H                                                  1072
*                                                                  1072
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, ISSUE MESSAGE IDC2108I TO SAY   @Z40LB30*/
*   /* THE VOLUME WAS NOT PROCESSED.                         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1072
*   IF CC03=LASTCC12 THEN           /*                       @Z40LB30*/
@RC01032 C     CC03,@CF00035                                       1072
         BNE   @RF01072                                            1072
*     DO;                           /*                       @Z40LB30*/
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1074
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/
         L     @15,DDSTRU                                          1075
         MVC   DARGSMOD(3,@15),@CC01418                            1075
*       DARGSENT=MSG2108I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'40'                                 1076
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB30*/
         LA    @14,BASSERNO(,BASEVPTR)                             1077
         ST    @14,DARGDBP(,@15)                                   1077
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00158                             1078
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @15,@PC00001                                        1079
         ST    @15,@AL00001                                        1079
         LA    @14,@CF00116                                        1079
         ST    @14,@AL00001+4                                      1079
         LA    @14,DDSTRU                                          1079
         ST    @14,@AL00001+8                                      1079
         MVI   @AL00001+8,X'80'                                    1079
         L     @15,GDTPRT(,@15)                                    1079
         LA    @01,@AL00001                                        1079
         BALR  @14,@15                                             1079
*     END;                          /*                       @Z40LB30*/
*                                                                  1080
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1081
*   RETURN CODE(CC03);              /*                       @Z40LB30*/
@RF01072 LR    @15,CC03                                            1081
@EL00010 DS    0H                                                  1081
@EF00010 DS    0H                                                  1081
@ER00010 L     @14,@SA00010                                        1081
         BR    @14                                                 1081
*   END ALLOCATE;                   /*                       @Z40LB30*/
*                                                                  1083
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - SELECTOR                                @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - CONTROLS SELECTION OF DATA SETS ELIGIBLE FOR  @Z40LB30*/
*/*            SCRATCH AND UNCATALOG ON A PARTICULAR VOLUME. @Z40LB30*/
*/*            IF THERE ARE NO DATA SETS ELIGIBLE FOR SELEC  @Z40LB30*/
*/*            TION, ISSUES MESSAGE IDC0107I. IF THE VOLUME  @Z40LB30*/
*/*            CAN NOT BE PROCESSED, ISSUES MESSAGE IDC2108I @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - FUNCTIONAL DATA TABLE, BASE VOLUME RECORD,       @Z40LB30*/
*/*         EXPIRATION AND CREATION DATES IN FORMAT REQUIRED @Z40LB30*/
*/*         BY IDCVS03, DD NAME TO BE USED TO MOUNT THE      @Z40LB30*/
*/*         VOLUME, UCB ADDRESS FOR EITHER A UNIQUE DD CARD  @Z40LB30*/
*/*         TO BE USED OR FOR THE FILE PARAMETER DD CARD     @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        4, VTOC CLOSE ERROR, BUT LIST     @Z40LB30*/
*/*                           OF ELIGIBLE DATA SETS          @Z40LB30*/
*/*                           CAN BE PROCESSED               @Z40LB30*/
*/*                        8, SOME ERRORS DETECTED, BUT THE  @Z40LB30*/
*/*                           LIST OF ELIGIBLE DATA SETS CAN @Z40LB30*/
*/*                           BE PROCESSED                   @Z40LB30*/
*/*                       12, SEVERE ERROR - NO LIST OF DATA @Z40LB30*/
*/*                           SETS CAN BE PROCESSED          @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*        - LISTADDR SET WITH 0 OR ADDRESS OF LIST OF       @Z40LB30*/
*/*                   ELIGIBLE DATA SETS.                    @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  1083
*SELECTOR:                                                         1083
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
SELECTOR ST    @14,@SA00011                                        1083
*                                                                  1084
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1084
*   OLDERID2=NEWERID2;                                             1084
         L     @15,@PC00001                                        1084
         L     @15,GDTTR2(,@15)                                    1084
         MVC   @TS00001(95),NEWERID2(@15)                          1084
         MVC   OLDERID2(95,@15),@TS00001                           1084
*   NEWID2='SDSL';                  /*                       @Z40LB30*/
*                                                                  1085
         MVC   NEWID2(4,@15),@CC01556                              1085
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1086
*   CC03=LASTCC00;                  /*                       @Z40LB30*/
         SLR   @15,@15                                             1086
         LR    CC03,@15                                            1086
*                                                                  1087
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE ARGUMENT LIST FOR IDCVS03                  @Z40LB30*/
*   /* IF NOT ALREADY INITIALIZED                            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1087
*   RESPECIFY                                                      1087
*     VS3AGL BASED(ADDR(VSAREA3));  /*                       @Z40LB30*/
*   RESPECIFY                                                      1088
*     VSDBLOCK BASED(LISTADDR);     /*                       @Z40LB30*/
*   IF INITVS3=OFF THEN             /*                       @Z40LB30*/
         TM    INITVS3,B'01000000'                                 1089
         BNZ   @RF01089                                            1089
*     DO;                           /*                       @Z40LB30*/
*       INITVS3=ON;                 /*                       @Z40LB30*/
         OI    INITVS3,B'01000000'                                 1091
*       VS3AGL=''B;                 /* SET TO 0              @Z40LB30*/
         LA    @14,VSAREA3                                         1092
         XC    VS3AGL(59,@14),VS3AGL(@14)                          1092
*       VS3LISTP=ADDR(LISTADDR);    /* ADDR OF LIST PTR      @Z40LB30*/
         LA    @07,LISTADDR                                        1093
         ST    @07,VS3LISTP(,@14)                                  1093
*       VS3EXDSP=ADDR(EXDS);        /* ADDR OF DATA SETS TO  @Z40LB30
*                                      EXCLUDE               @Z40LB30*/
         L     @07,@PC00001+4                                      1094
         L     @06,FDTPTR+56(,@07)                                 1094
         ST    @06,VS3EXDSP(,@14)                                  1094
*       VS3POOL=POOLID;             /* POOL ID FOR STORAGE   @Z40LB30*/
         MVC   VS3POOL(4,@14),@CC01467                             1095
*       VS3DEV=DEV3330V;            /* VIRTUAL DEVICE TYPE   @Z40LB30*/
         MVC   VS3DEV(4,@14),@CB01471                              1096
*       VS3SCR=ON;                  /* SELECT FOR SCRATCH    @Z40LB30
*                                      FUNCTION              @Z40LB30*/
*                                                                  1097
         OI    VS3SCR(@14),B'00100000'                             1097
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE LEVEL KEYWORD WAS SPECIFIED ON THE COMMAND @Z40LB30*/
*       /* SET THE NECESSARY VALUES IN THE VS3AGL            @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1098
*       IF ADDR(LEVEL)^=NULLPTR THEN/*                       @Z40LB30*/
         L     @07,FDTPTR+20(,@07)                                 1098
         CR    @07,@15                                             1098
         BE    @RF01098                                            1098
*         DO;                       /*                       @Z40LB30*/
*           VS3LEVP=ADDR(LEVELVAL); /* ADDRESS OF LEVEL      @Z40LB30*/
         LA    @15,LEVELVAL(,@07)                                  1100
         ST    @15,VS3LEVP(,@14)                                   1100
*           VS3LEVLN=LEVELLEN;      /* LENGTH OF LEVEL       @Z40LB30*/
         SLR   @06,@06                                             1101
         IC    @06,LEVELLEN(,@07)                                  1101
         STH   @06,VS3LEVLN(,@14)                                  1101
*           VS3AST=LEVELPOS;        /* OFFSET OF ASTERISK    @Z40LB30*/
         SLR   @06,@06                                             1102
         IC    @06,LEVELPOS(,@07)                                  1102
         STH   @06,VS3AST(,@14)                                    1102
*         END;                      /*                       @Z40LB30*/
*                                                                  1103
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXPIRATION OR CREATION KEYWORDS WERE SPECIFIED @Z40LB30*/
*       /* SET THE ADDRESS OF THE DATES IN VS3AGL            @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1104
*       IF ADDR(EXPIR)^=NULLPTR×ADDR(EXPDT)^=NULLPTR/*       @Z40LB30*/
*         THEN                      /*                       @Z40LB30*/
@RF01098 SLR   @15,@15                                             1104
         L     @14,@PC00001+4                                      1104
         C     @15,FDTPTR+32(,@14)                                 1104
         BNE   @RT01104                                            1104
         C     @15,FDTPTR+28(,@14)                                 1104
         BE    @RF01104                                            1104
@RT01104 DS    0H                                                  1105
*         VS3EXPIR=ADDR(EXPDATE);   /*                       @Z40LB30*/
         LA    @15,VSAREA3                                         1105
         LA    @14,EXPDATE                                         1105
         ST    @14,VS3EXPIR(,@15)                                  1105
*       IF ADDR(CREAT)^=NULLPTR×ADDR(CREDT)^=NULLPTR/*       @Z40LB30*/
*         THEN                      /*                       @Z40LB30*/
@RF01104 SLR   @15,@15                                             1106
         L     @14,@PC00001+4                                      1106
         C     @15,FDTPTR+40(,@14)                                 1106
         BNE   @RT01106                                            1106
         C     @15,FDTPTR+36(,@14)                                 1106
         BE    @RF01106                                            1106
@RT01106 DS    0H                                                  1107
*         VS3CREAT=ADDR(CREDATE);   /*                       @Z40LB30*/
*                                                                  1107
         LA    @15,VSAREA3                                         1107
         LA    @14,CREDATE                                         1107
         ST    @14,VS3CREAT(,@15)                                  1107
*       /*************************************************************/
*       /*                                                           */
*       /* IF UNCATALOGED OR SYSTEMNAMES KEYWORDS WERE       @Z40LB30*/
*       /* SPECIFIED ON THE COMMAND, SET BITS IN VS3AGL      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1108
*       IF ADDR(UNCAT)^=NULLPTR THEN/*                       @Z40LB30*/
@RF01106 L     @15,@PC00001+4                                      1108
         L     @15,FDTPTR+24(,@15)                                 1108
         LTR   @15,@15                                             1108
         BZ    @RF01108                                            1108
*         VS3UNCAT=ON;              /*                       @Z40LB30*/
         LA    @15,VSAREA3                                         1109
         OI    VS3UNCAT(@15),B'00010000'                           1109
*       IF ADDR(SYSN)^=NULLPTR THEN /*                       @Z40LB30*/
@RF01108 L     @15,@PC00001+4                                      1110
         L     @15,FDTPTR+48(,@15)                                 1110
         LTR   @15,@15                                             1110
         BZ    @RF01110                                            1110
*         VS3SYSNM=ON;              /*                       @Z40LB30*/
         LA    @15,VSAREA3                                         1111
         OI    VS3SYSNM(@15),B'00001000'                           1111
*     END;                          /*                       @Z40LB30*/
@RF01110 DS    0H                                                  1113
*                                                                  1113
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE VOLUME SERIAL AND DD NAME IN VS3AGL. THEN     @Z40LB30*/
*   /* SET THE ADDRESS OF THE LIST TO BE RETURNED BY         @Z40LB30*/
*   /* IDCVS03 TO ZERO                                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1113
*   VS3VOL=BASSERNO;                /*                       @Z40LB30*/
@RF01089 LA    @15,VSAREA3                                         1113
         MVC   VS3VOL(6,@15),BASSERNO(BASEVPTR)                    1113
*   VS3DD=DDNAME;                   /*                       @Z40LB30*/
         MVC   VS3DD(8,@15),DDNAME                                 1114
*   LISTADDR=NULLPTR;               /*                       @Z40LB30*/
*                                                                  1115
         SLR   @14,@14                                             1115
         ST    @14,LISTADDR                                        1115
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE UCB ADDRESS WAS RETURNED BY THE UMSSUNIT       @Z40LB30*/
*   /* SELECTDD FUNCTION, SET IT IN THE VS3AGL. IF NOT AND   @Z40LB30*/
*   /* THE FILE PARAMETER IS SPECIFIED, SET THAT UCB ADDRESS @Z40LB30*/
*   /* IN VS3AGL. IF THE FILE PARAMETER WAS NOT SPECIFIED    @Z40LB30*/
*   /* EITHER, SET THE UCB ADDRESS IN VS3AGL TO ZERO.        @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1116
*   IF ADDRUCB^=NULLPTR THEN        /*                       @Z40LB30*/
         L     @07,ADDRUCB                                         1116
         CR    @07,@14                                             1116
         BE    @RF01116                                            1116
*     VS3UCBP=ADDRUCB;              /*                       @Z40LB30*/
         ST    @07,VS3UCBP(,@15)                                   1117
*   ELSE                            /*                       @Z40LB30*/
*     IF ADDR(FILE)^=NULLPTR THEN   /*                       @Z40LB30*/
         B     @RC01116                                            1118
@RF01116 L     @15,@PC00001+4                                      1118
         L     @15,FDTPTR+44(,@15)                                 1118
         LTR   @15,@15                                             1118
         BZ    @RF01118                                            1118
*       VS3UCBP=FILEUCB;            /*                       @Z40LB30*/
         LA    @15,VSAREA3                                         1119
         L     @14,FILEUCB                                         1119
         ST    @14,VS3UCBP(,@15)                                   1119
*     ELSE                          /*                       @Z40LB30*/
*       VS3UCBP=NULLPTR;            /*                       @Z40LB30*/
*                                                                  1120
         B     @RC01118                                            1120
@RF01118 LA    @15,VSAREA3                                         1120
         SLR   @14,@14                                             1120
         ST    @14,VS3UCBP(,@15)                                   1120
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL IDCVS03 TO SELECT DATA SETS AND SAVE THE         @Z40LB30*/
*   /* RETURN CODE                                           @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1121
*   CALL IDCSACL0(GDTTBL,'IDCVS03 ',SELECTDS,VS3AGL);/*      @Z40LB30*/
@RC01118 DS    0H                                                  1121
@RC01116 L     @02,@PC00001                                        1121
         ST    @02,@AL00001                                        1121
         LA    @15,@CC01560                                        1121
         ST    @15,@AL00001+4                                      1121
         LA    @15,SELECTDS                                        1121
         ST    @15,@AL00001+8                                      1121
         LA    @15,VSAREA3                                         1121
         ST    @15,@AL00001+12                                     1121
         MVI   @AL00001+12,X'80'                                   1121
         L     @15,GDTCAL(,@02)                                    1121
         LA    @01,@AL00001                                        1121
         BALR  @14,@15                                             1121
*   RESPECIFY                                                      1122
*     RTNREG RSTD;                                                 1122
*   TESTRC=RTNREG;                                                 1123
         LR    TESTRC,RTNREG                                       1123
*   RESPECIFY                                                      1124
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  1124
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ERROR OCCURRED, SET RETURN CODES PROPERLY.      @Z40LB30*/
*   /* IF THE VOLUME WAS NOT PROCESSED AT ALL, ISSUE         @Z40LB30*/
*   /* MESSAGE IDC2108I                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1125
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1125
         BZ    @RF01125                                            1125
*     DO;                           /*                       @Z40LB30*/
*       IF TESTRC=12 THEN           /* VTOC CLOSE ERROR      @Z40LB30*/
         C     TESTRC,@CF00035                                     1127
         BNE   @RF01127                                            1127
*         CC03=LASTCC04;            /*                       @Z40LB30*/
         LA    CC03,4                                              1128
*       ELSE                        /*                       @Z40LB30*/
*         IF TESTRC=8 THEN          /* DATA SET ERRORS       @Z40LB30*/
         B     @RC01127                                            1129
@RF01127 LA    @08,8                                               1129
         CR    TESTRC,@08                                          1129
         BNE   @RF01129                                            1129
*           CC03=LASTCC08;          /*                       @Z40LB30*/
         LA    @15,8                                               1130
         LR    CC03,@15                                            1130
*         ELSE                      /* MAJOR VOLUME ERROR    @Z40LB30*/
*           DO;                     /*                       @Z40LB30*/
         B     @RC01129                                            1131
@RF01129 DS    0H                                                  1132
*             CC03=LASTCC12;        /*                       @Z40LB30*/
         LA    CC03,12                                             1132
*             DARGAREA=''B;         /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1133
*             DARGSMOD=CM0MSG;      /*                       @Z40LB30*/
         L     @15,DDSTRU                                          1134
         MVC   DARGSMOD(3,@15),@CC01418                            1134
*             DARGSENT=MSG2108I;    /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'40'                                 1135
*             DARGDBP=ADDR(BASSERNO);/*                      @Z40LB30*/
         LA    @14,BASSERNO(,BASEVPTR)                             1136
         ST    @14,DARGDBP(,@15)                                   1136
*             DARGILP=LENGTH(BASSERNO);/*                    @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00158                             1137
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/
         L     @15,@PC00001                                        1138
         ST    @15,@AL00001                                        1138
         LA    @14,@CF00116                                        1138
         ST    @14,@AL00001+4                                      1138
         LA    @14,DDSTRU                                          1138
         ST    @14,@AL00001+8                                      1138
         MVI   @AL00001+8,X'80'                                    1138
         L     @15,GDTPRT(,@15)                                    1138
         LA    @01,@AL00001                                        1138
         BALR  @14,@15                                             1138
*           END;                    /*                       @Z40LB30*/
*     END;                          /*                       @Z40LB30*/
*                                                                  1140
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO ERROR OCCURRED BUT NO DATA SETS ARE ELIGIBLE    @Z40LB30*/
*   /* FOR SELECTION, PRINT MESSAGE IDC0107I.                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*   ELSE                            /*                       @Z40LB30*/
*     IF VSDELEM=0 THEN             /*                       @Z40LB30*/
         B     @RC01125                                            1141
@RF01125 L     @01,LISTADDR                                        1141
         L     @15,VSDELEM(,@01)                                   1141
         LTR   @15,@15                                             1141
         BNZ   @RF01141                                            1141
*       DO;                         /*                       @Z40LB30*/
*         DARGAREA=''B;             /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1143
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/
         L     @15,DDSTRU                                          1144
         MVC   DARGSMOD(3,@15),@CC01418                            1144
*         DARGSENT=MSG0107I;        /*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'3F'                                 1145
*         DARGDBP=ADDR(BASSERNO);   /*                       @Z40LB30*/
         LA    @14,BASSERNO(,BASEVPTR)                             1146
         ST    @14,DARGDBP(,@15)                                   1146
*         DARGILP=LENGTH(BASSERNO); /*                       @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00158                             1147
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/
         L     @15,@PC00001                                        1148
         ST    @15,@AL00001                                        1148
         LA    @14,@CF00116                                        1148
         ST    @14,@AL00001+4                                      1148
         LA    @14,DDSTRU                                          1148
         ST    @14,@AL00001+8                                      1148
         MVI   @AL00001+8,X'80'                                    1148
         L     @15,GDTPRT(,@15)                                    1148
         LA    @01,@AL00001                                        1148
         BALR  @14,@15                                             1148
*       END;                        /*                       @Z40LB30*/
*                                                                  1149
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1150
*   RETURN CODE(CC03);              /*                       @Z40LB30*/
@RF01141 DS    0H                                                  1150
@RC01125 LR    @15,CC03                                            1150
@EL00011 DS    0H                                                  1150
@EF00011 DS    0H                                                  1150
@ER00011 L     @14,@SA00011                                        1150
         BR    @14                                                 1150
*   END SELECTOR;                   /*                       @Z40LB30*/
*                                                                  1152
*/********************************************************** @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - SCRUNCAT                                @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - SCRATCHES AND UNCATALOGS THE DATA SETS THAT   @Z40LB30*/
*/*            HAVE BEEN SELECTED FROM THE VTOC.  CHECKS     @Z40LB30*/
*/*            FOR CATALOGED GDG TYPE DATA SETS AND FOR      @Z40LB30*/
*/*            CATALOGED MULTI-VOLUME DATA SETS AND DOES NOT @Z40LB30*/
*/*            SCRATCH OR UNCATALOG THEM.  CHECKS FOR A      @Z40LB30*/
*/*            SYSCTLG DATA SET AND DOES NOT SCRATCH IT      @Z40LB30*/
*/*            UNLESS THE PURGE PARAMETER WAS SPECIFIED.     @Z40LB30*/
*/*            ISSUES MESSAGE IDC0112I WHEN A DATA SET IS    @Z40LB30*/
*/*            SUCCESSFULLY SCRATCHED.  ISSUES MESSAGE       @Z40LB30*/
*/*            IDC0811I WHEN A DATA SET IS SUCCESSFULLY      @Z40LB30*/
*/*            UNCATALOGED.  AT END, ISSUES MESSAGE          @Z40LB30*/
*/*            IDC0812I TO INDICATE HOW MANY  DATA SETS      @Z40LB30*/
*/*            WERE SUCCESSFULLY SCRATCHED AND ISSUES        @Z40LB30*/
*/*            MESSAGES IDC0813I AND IDC0814I TO             @Z40LB30*/
*/*            SAY HOW MANY GDG AND MULTI-VOLUME DATA SETS   @Z40LB30*/
*/*            WERE NOT SCRATCHED.  ISSUES MSG IDC0816I      @Z40LB30*/
*/*            IF A SYSCTLG DATA SET WAS NOT SCRATCHED.      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT -  LIST OF ELIGIBLE DATA SETS RETURNED BY IDCVS03. @Z40LB30*/
*/*          VOLUME SERIAL FROM INVENTORY VOLUME RECORD. DD  @Z40LB30*/
*/*          NAME USED TO MOUNT VOLUME IN FIELD DDNAME.      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/
*/*                        8, AN ERROR OCCURRED BUT SOME     @Z40LB30*/
*/*                           DATA SETS HAVE BEEN SCRATCHED  @Z40LB30*/
*/*                       12, NO DATA SETS HAVE BEEN         @Z40LB30*/
*/*                           SCRATCHED DUE TO ERRORS        @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************** @Z40LB30*/
*                                                                  1152
*SCRUNCAT:                                                         1152
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
SCRUNCAT ST    @14,@SA00012                                        1152
*                                                                  1153
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   OLDERID2=NEWERID2;                                             1153
         L     @06,@PC00001                                        1153
         L     @06,GDTTR2(,@06)                                    1153
         MVC   @TS00001(95),NEWERID2(@06)                          1153
         MVC   OLDERID2(95,@06),@TS00001                           1153
*   NEWID2='SDSC';                  /*                       @Z40LB30*/
*                                                                  1154
         MVC   NEWID2(4,@06),@CC01564                              1154
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*   CC03=LASTCC00;                  /*                       @Z40LB30*/
*                                                                  1155
         SLR   @06,@06                                             1155
         LR    CC03,@06                                            1155
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE USCRATCH ARGUMENT LIST                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1156
*   RESPECIFY                                                      1156
*     UVOLLIST BASED(ADDR(SCRAREA));/*                       @Z40LB30*/
*   UVOLCNT=1;                      /*                       @Z40LB30*/
         LA    @15,1                                               1157
         LA    @14,SCRAREA                                         1157
         STH   @15,UVOLCNT(,@14)                                   1157
*   UVOLDEV(1)=DEV3330V;            /*                       @Z40LB30*/
         MVC   UVOLDEV(4,@14),@CB01471                             1158
*   UVOLVOL(1)=BASSERNO;            /*                       @Z40LB30*/
*                                                                  1159
         MVC   UVOLVOL(6,@14),BASSERNO(BASEVPTR)                   1159
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE UUNCATLG ARGUMENT LIST                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1160
*   RESPECIFY                                                      1160
*     UCTAGL BASED(ADDR(CATAREA));  /*                       @Z40LB30*/
*   UCTAGL=''B;                     /*                       @Z40LB30*/
         LA    @03,CATAREA                                         1161
         XC    UCTAGL(69,@03),UCTAGL(@03)                          1161
*   UCTVOLP=ADDR(UVOLLIST);         /*                       @Z40LB30*/
         ST    @14,UCTVOLP(,@03)                                   1162
*   UCTDD=DDNAME;                   /*                       @Z40LB30*/
*                                                                  1163
         MVC   UCTDD(8,@03),DDNAME                                 1163
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE COUNTERS FOR VOLUME TO ZERO                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1164
*   SCRATCNT=0;                     /*                       @Z40LB30*/
         STH   @06,SCRATCNT                                        1164
*   GDGCNT=0;                       /*                       @Z40LB30*/
         STH   @06,GDGCNT                                          1165
*   MULTICNT=0;                     /*                       @Z40LB30*/
         STH   @06,MULTICNT                                        1166
*   SYSCTCNT=0;                     /*                       @Z40LB30*/
         STH   @06,SYSCTCNT                                        1167
*                                                                  1168
*   /*****************************************************************/
*   /*                                                               */
*   /* INCREMENT THROUGH LIST OF ELIGIBLE DATA SETS          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB30*/
*                                                                  1168
         LR    ELEMENT,@15                                         1168
         B     @DE01168                                            1168
@DL01168 DS    0H                                                  1169
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DATA SET IS NOT CATALOGED, SCRATCH IT        @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1169
*     IF VSDCATLC=OFF THEN          /*                       @Z40LB30*/
         L     @15,LISTADDR                                        1169
         LR    @14,ELEMENT                                         1169
         MH    @14,@CH01628                                        1169
         LA    @01,0(@14,@15)                                      1169
         AL    @01,@CF01650                                        1169
         TM    VSDCATLC(@01),B'10000000'                           1169
         BNZ   @RF01169                                            1169
*       DO;                         /*                       @Z40LB30*/
*                                                                  1170
*         /***********************************************************/
*         /*                                                         */
*         /* FIRST CHECK IF THE DATA SET NAME IS SYSCTLG.    @Z40LB30*/
*         /* IF IT IS, DO NOT SCRATCH THE DATA SET UNTIL     @Z40LB30*/
*         /* THE REST OF THE DATA SET HAVE BEEN SCRATCHED    @Z40LB30*/
*         /* AND UNCATALOGUED TO AVOID UNCATALOG ERRORS.     @Z40LB30*/
*         /* HOWEVER, INCREMENT THE SYSCTLG NOT SCRATCHED    @Z40LB30*/
*         /* COUNTER. OTHERWISE, CONTINUE WITH SCRATCH.      @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1171
*         IF VSDDSN(ELEMENT,1:LENGTH(SYSCTLG))=SYSCTLG/*     @Z40LB30*/
*           THEN                    /*                       @Z40LB30*/
         ALR   @15,@14                                             1171
         AL    @15,@CF01651                                        1171
         CLC   VSDDSN-20(44,@15),@CC01479                          1171
         BNE   @RF01171                                            1171
*           SYSCTCNT=SYSCTCNT+1;    /*                       @Z40LB30*/
         LA    @15,1                                               1172
         AH    @15,SYSCTCNT                                        1172
         STH   @15,SYSCTCNT                                        1172
*         ELSE                      /*                       @Z40LB30*/
*           DO;                     /*                       @Z40LB30*/
*                                                                  1173
         B     @RC01171                                            1173
@RF01171 DS    0H                                                  1174
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE USCRATCH MACRO, OVERRIDING THE        @Z40LB30*/
*             /* EXPIRATION DATE, AND SAVE RETURN CODE       @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1174
*             CALL IDCSASC0(GDTTBL,VSDDSN(ELEMENT),ADDR(UVOLLIST),/*
*                                                            @Z40LB30*/
*                 OVERRIDE);        /*                       @Z40LB30*/
         L     @02,@PC00001                                        1174
         ST    @02,@AL00001                                        1174
         LR    @15,ELEMENT                                         1174
         MH    @15,@CH01628                                        1174
         L     @01,LISTADDR                                        1174
         AL    @01,@CF01651                                        1174
         LA    @15,VSDDSN-20(@15,@01)                              1174
         ST    @15,@AL00001+4                                      1174
         LA    @15,SCRAREA                                         1174
         ST    @15,@AFTEMPS                                        1174
         LA    @15,@AFTEMPS                                        1174
         ST    @15,@AL00001+8                                      1174
         LA    @15,OVERRIDE                                        1174
         ST    @15,@AL00001+12                                     1174
         MVI   @AL00001+12,X'80'                                   1174
         L     @15,GDTSCR(,@02)                                    1174
         LA    @01,@AL00001                                        1174
         BALR  @14,@15                                             1174
*             RESPECIFY                                            1175
*               RTNREG RSTD;                                       1175
*             TESTRC=RTNREG;                                       1176
         LR    TESTRC,RTNREG                                       1176
*             RESPECIFY                                            1177
*               RTNREG UNRSTD;      /*                       @Z40LB30*/
*                                                                  1177
*             /*******************************************************/
*             /*                                                     */
*             /* IF USCRATCH IS SUCCESSFUL, ISSUE MSG IDC0112I       */
*             /*                                             @Z40LB30*/
*             /* INSERTING DATA SET NAME AND THEN INCREMENT  @Z40LB30*/
*             /* COUNTER                                     @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1178
*             IF TESTRC=0 THEN      /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1178
         BNZ   @RF01178                                            1178
*               DO;                 /*                       @Z40LB30*/
*                 DARGAREA=''B;     /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1180
*                 DARGSMOD=CM0MSG;  /*                       @Z40LB30*/
         L     @15,DDSTRU                                          1181
         MVC   DARGSMOD(3,@15),@CC01418                            1181
*                 DARGSENT=MSG0112I;/*                       @Z40LB30*/
         MVI   DARGSENT(@15),X'44'                                 1182
*                 DARGDBP=ADDR(VSDDSN(ELEMENT));/*           @Z40LB30*/
         LR    @14,ELEMENT                                         1183
         MH    @14,@CH01628                                        1183
         L     @01,LISTADDR                                        1183
         AL    @01,@CF01651                                        1183
         LA    @14,VSDDSN-20(@14,@01)                              1183
         ST    @14,DARGDBP(,@15)                                   1183
*                 DARGILP=LENGTH(VSDDSN(1));/*               @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00848                             1184
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Z40LB30*/
         L     @15,@PC00001                                        1185
         ST    @15,@AL00001                                        1185
         LA    @14,@CF00116                                        1185
         ST    @14,@AL00001+4                                      1185
         LA    @14,DDSTRU                                          1185
         ST    @14,@AL00001+8                                      1185
         MVI   @AL00001+8,X'80'                                    1185
         L     @15,GDTPRT(,@15)                                    1185
         LA    @01,@AL00001                                        1185
         BALR  @14,@15                                             1185
*                 SCRATCNT=SCRATCNT+1;/*                     @Z40LB30*/
         LA    @15,1                                               1186
         AH    @15,SCRATCNT                                        1186
         STH   @15,SCRATCNT                                        1186
*               END;                /*                       @Z40LB30*/
*                                                                  1187
*             /*******************************************************/
*             /*                                                     */
*             /* IF USCRATCH IS NOT SUCCESSFUL, SET INTERNAL @Z40LB30*/
*             /* CONDITION CODE                              @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1188
*             ELSE                  /*                       @Z40LB30*/
*               CC03=LASTCC08;      /*                       @Z40LB30*/
         B     @RC01178                                            1188
@RF01178 LA    CC03,8                                              1188
*           END;                    /*                       @Z40LB30*/
*       END;                        /*                       @Z40LB30*/
*                                                                  1191
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE DATA SET IS CATALOGED, SCRATCH AND           @Z40LB30*/
*     /* UNCATALOG IT                                        @Z40LB30*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1191
*     ELSE                          /*                       @Z40LB30*/
*       DO;                         /*                       @Z40LB30*/
*                                                                  1191
         B     @RC01169                                            1191
@RF01169 DS    0H                                                  1192
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK THE DATA SET NAME TO SEE IF IT LOOKS      @Z40LB30*/
*         /* LIKE A GDG, THAT IS, HAS LAST 10 CHARACTERS     @Z40LB30*/
*         /* X.GNNNNVNN WHERE N IS A NUMBER FROM 0 - 9       @Z40LB30*/
*         /*                                                 @Z40LB30*/
*         /* FIND THE NUMBER OF THE FIRST BLANK CHARACTER    @Z40LB30*/
*         /* IN THE DATA SET NAME                            @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1192
*         GDGTYPE=OFF;              /*                       @Z40LB30*/
         NI    GDGTYPE,B'11011111'                                 1192
*         DO LASTCHAR=2 TO LENGTH(VSDDSN(1)) WHILE/*         @Z40LB30*/
*               VSDDSN(ELEMENT,LASTCHAR:LASTCHAR)^=' ';/*    @Z40LB30*/
         LA    LASTCHAR,2                                          1193
@DL01193 LR    @03,ELEMENT                                         1193
         MH    @03,@CH01628                                        1193
         ALR   @03,LASTCHAR                                        1193
         L     @01,LISTADDR                                        1193
         ALR   @01,@03                                             1193
         AL    @01,@CF01653                                        1193
         CLI   VSDDSN-20(@01),C' '                                 1193
         BE    @DC01193                                            1193
*         END;                      /*                       @Z40LB30*/
*                                                                  1194
         AL    LASTCHAR,@CF00221                                   1194
         C     LASTCHAR,@CF00848                                   1194
         BNH   @DL01193                                            1194
@DC01193 DS    0H                                                  1195
*         /***********************************************************/
*         /*                                                         */
*         /* DECREMENT TO GET THE NUMBER OF THE LAST NON-    @Z40LB30*/
*         /* BLANK CHARACTER                                 @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1195
*         LASTCHAR=LASTCHAR-1;      /*                       @Z40LB30*/
*                                                                  1195
         BCTR  LASTCHAR,0                                          1195
*         /***********************************************************/
*         /*                                                         */
*         /* IF THERE ARE AT LEAST 10 CHARACTERS IN THE      @Z40LB30*/
*         /* NAME AND THE LAST 8 CHARACTERS CONTAIN A 'G'    @Z40LB30*/
*         /* AND 'V' IN THE CORRECT POSITIONS, THIS COULD    @Z40LB30*/
*         /* BE A GDG, SO CONTINUE CHECKS                    @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1196
*         IF LASTCHAR>=10&VSDDSN(ELEMENT,LASTCHAR-7:/*       @Z40LB30*/
*             LASTCHAR-7)='G'&VSDDSN(ELEMENT,LASTCHAR-2:/*   @Z40LB30*/
*             LASTCHAR-2)='V'       /*                       @Z40LB30*/
*           THEN                    /*                       @Z40LB30*/
         C     LASTCHAR,@CF00037                                   1196
         BL    @RF01196                                            1196
         L     @03,LISTADDR                                        1196
         LR    @15,ELEMENT                                         1196
         MH    @15,@CH01628                                        1196
         ALR   @15,LASTCHAR                                        1196
         ST    @15,@TF00001                                        1196
         ALR   @15,@03                                             1196
         AL    @15,@CF01654                                        1196
         CLI   VSDDSN-20(@15),C'G'                                 1196
         BNE   @RF01196                                            1196
         AL    @03,@TF00001                                        1196
         AL    @03,@CF01655                                        1196
         CLI   VSDDSN-20(@03),C'V'                                 1196
         BNE   @RF01196                                            1196
*           DO;                     /*                       @Z40LB30*/
*                                                                  1197
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF THE CHARACTERS BETWEEN THE 'G'     @Z40LB30*/
*             /* AND 'V' IN THE LAST 8 CHARACTERS OF THE     @Z40LB30*/
*             /* DATA SET NAME ARE NUMERIC                   @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1198
*             DO NUMCHAR=(LASTCHAR-6) TO(LASTCHAR-3)/*       @Z40LB30*/
*                   WHILE VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)>='0'/*   1198
*                                                            @Z40LB30*/
*                   &VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)<='9';/* @Z40LB30*/
         LR    NUMCHAR,LASTCHAR                                    1198
         SL    NUMCHAR,@CF00158                                    1198
         B     @DE01198                                            1198
@DL01198 L     @15,LISTADDR                                        1198
         LR    @14,ELEMENT                                         1198
         MH    @14,@CH01628                                        1198
         ALR   @14,NUMCHAR                                         1198
         ST    @14,@TF00001                                        1198
         ALR   @14,@15                                             1198
         AL    @14,@CF01653                                        1198
         CLI   VSDDSN-20(@14),C'0'                                 1198
         BL    @DC01198                                            1198
         AL    @15,@TF00001                                        1198
         AL    @15,@CF01653                                        1198
         CLI   VSDDSN-20(@15),C'9'                                 1198
         BH    @DC01198                                            1198
*             END;                  /*                       @Z40LB30*/
*                                                                  1199
         AL    NUMCHAR,@CF00221                                    1199
@DE01198 LR    @15,LASTCHAR                                        1199
         SL    @15,@CF00164                                        1199
         CR    NUMCHAR,@15                                         1199
         BNH   @DL01198                                            1199
@DC01198 DS    0H                                                  1200
*             /*******************************************************/
*             /*                                                     */
*             /* IF ALL THE CHARACTERS WERE NUMERIC, CHECK   @Z40LB30*/
*             /* IF THE TWO CHARACTERS AFTER THE 'V' ARE     @Z40LB30*/
*             /* NUMERIC                                     @Z40LB30*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1200
*             IF NUMCHAR>(LASTCHAR-3) THEN/*                 @Z40LB30*/
         LR    @15,LASTCHAR                                        1200
         SL    @15,@CF00164                                        1200
         CR    NUMCHAR,@15                                         1200
         BNH   @RF01200                                            1200
*               DO;                 /*                       @Z40LB30*/
*                 DO NUMCHAR=(LASTCHAR-1) TO LASTCHAR/*      @Z40LB30*/
*                       WHILE VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)/*    1202
*                                                            @Z40LB30*/
*                       >='0'&VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)/*    1202
*                                                            @Z40LB30*/
*                       <='9';      /*                       @Z40LB30*/
         LR    NUMCHAR,LASTCHAR                                    1202
         BCTR  NUMCHAR,0                                           1202
         B     @DE01202                                            1202
@DL01202 L     @15,LISTADDR                                        1202
         LR    @14,ELEMENT                                         1202
         MH    @14,@CH01628                                        1202
         ALR   @14,NUMCHAR                                         1202
         ST    @14,@TF00001                                        1202
         ALR   @14,@15                                             1202
         AL    @14,@CF01653                                        1202
         CLI   VSDDSN-20(@14),C'0'                                 1202
         BL    @DC01202                                            1202
         AL    @15,@TF00001                                        1202
         AL    @15,@CF01653                                        1202
         CLI   VSDDSN-20(@15),C'9'                                 1202
         BH    @DC01202                                            1202
*                 END;              /*                       @Z40LB30*/
*                                                                  1203
         AL    NUMCHAR,@CF00221                                    1203
@DE01202 CR    NUMCHAR,LASTCHAR                                    1203
         BNH   @DL01202                                            1203
@DC01202 DS    0H                                                  1204
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF ALL THE CHARACTERS WERE NUMERIC,     @Z40LB30*/
*                 /* INDICATE THE DATA SET NAME LOOKS LIKE   @Z40LB30*/
*                 /* A GDG                                   @Z40LB30*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1204
*                 IF NUMCHAR>LASTCHAR THEN/*                 @Z40LB30*/
         CR    NUMCHAR,LASTCHAR                                    1204
         BNH   @RF01204                                            1204
*                   GDGTYPE=ON;     /*                       @Z40LB30*/
         OI    GDGTYPE,B'00100000'                                 1205
*               END;                /*                       @Z40LB30*/
@RF01204 DS    0H                                                  1207
*           END;                    /*                       @Z40LB30*/
*                                                                  1207
@RF01200 DS    0H                                                  1208
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DATA SET IS A GDG OR RESIDES ON MORE     @Z40LB30*/
*         /* THAN ONE VOLUME, INCREMENT THE COUNTER BUT      @Z40LB30*/
*         /* DON'T SCRATCH THE DATA SET                      @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1208
*         IF GDGTYPE=ON THEN        /*                       @Z40LB30*/
@RF01196 TM    GDGTYPE,B'00100000'                                 1208
         BNO   @RF01208                                            1208
*           GDGCNT=GDGCNT+1;        /*                       @Z40LB30*/
         LA    @15,1                                               1209
         AH    @15,GDGCNT                                          1209
         STH   @15,GDGCNT                                          1209
*         ELSE                      /*                       @Z40LB30*/
*           IF VSDVOLCT(ELEMENT)>1 THEN/*                    @Z40LB30*/
         B     @RC01208                                            1210
@RF01208 LA    @15,1                                               1210
         LR    @14,ELEMENT                                         1210
         MH    @14,@CH01628                                        1210
         L     @01,LISTADDR                                        1210
         AL    @01,@CF01656                                        1210
         C     @15,VSDVOLCT-16(@14,@01)                            1210
         BNL   @RF01210                                            1210
*             MULTICNT=MULTICNT+1;  /*                       @Z40LB30*/
*                                                                  1211
         AH    @15,MULTICNT                                        1211
         STH   @15,MULTICNT                                        1211
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE DATA SET IS NOT GDG OR MULTI-VOLUME      @Z40LB30*/
*         /* ISSUE UUNCATLG MACRO TO SCRATCH & UNCATALOG     @Z40LB30*/
*         /* THE DATA SET. SAVE THE RETURN CODE              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1212
*           ELSE                    /*                       @Z40LB30*/
*             DO;                   /*                       @Z40LB30*/
         B     @RC01210                                            1212
@RF01210 DS    0H                                                  1213
*               UCTDSN=VSDDSN(ELEMENT);/*                    @Z40LB30*/
*                                                                  1213
         LA    @15,CATAREA                                         1213
         L     @14,LISTADDR                                        1213
         LR    @03,ELEMENT                                         1213
         MH    @03,@CH01628                                        1213
         ST    @03,@TF00001                                        1213
         ALR   @03,@14                                             1213
         AL    @03,@CF01651                                        1213
         MVC   UCTDSN(44,@15),VSDDSN-20(@03)                       1213
*               /*****************************************************/
*               /*                                                   */
*               /* IF THE DATA SET WAS LOCATED IN A          @Z40LB30*/
*               /* VSAM CATALOG, INDICATE THAT AND           @Z40LB30*/
*               /* SET THE CATALOG ACB POINTER IN            @Z40LB30*/
*               /* THE UUNCATLG ARGUMENT LIST.               @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1214
*               IF VSDVSAM=ON THEN  /*                       @Z40LB30*/
         L     @01,@TF00001                                        1214
         AL    @14,@CF01650                                        1214
         LA    @14,VSDVARY-64(@01,@14)                             1214
         TM    VSDVSAM(@14),B'01000000'                            1214
         BNO   @RF01214                                            1214
*                 DO;               /*                       @Z40LB30*/
*                   UCTVSCAT=ON;    /*                       @Z40LB30*/
         OI    UCTVSCAT(@15),B'10000000'                           1216
*                   UCTACBP=VSDACBPT;/*                      @Z40LB30*/
         L     @14,VSDACBPT(,@14)                                  1217
         ST    @14,UCTACBP(,@15)                                   1217
*                 END;              /*                       @Z40LB30*/
*               ELSE                /*                       @Z40LB30*/
*                 UCTVSCAT=OFF;     /*                       @Z40LB30*/
         B     @RC01214                                            1219
@RF01214 LA    @15,CATAREA                                         1219
         NI    UCTVSCAT(@15),B'01111111'                           1219
*               CALL IDCSAUC0(GDTTBL,UCTAGL);/*              @Z40LB30*/
@RC01214 L     @02,@PC00001                                        1220
         ST    @02,@AL00001                                        1220
         LA    @15,CATAREA                                         1220
         ST    @15,@AL00001+4                                      1220
         MVI   @AL00001+4,X'80'                                    1220
         L     @15,GDTUNC(,@02)                                    1220
         LA    @01,@AL00001                                        1220
         BALR  @14,@15                                             1220
*               RESPECIFY                                          1221
*                 RTNREG RSTD;                                     1221
*               TESTRC=RTNREG;                                     1222
         LR    TESTRC,RTNREG                                       1222
*               RESPECIFY                                          1223
*                 RTNREG UNRSTD;    /*                       @Z40LB30*/
*                                                                  1223
*               /*****************************************************/
*               /*                                                   */
*               /* IF UUNCATLG IS SUCCESSFUL, ISSUE MESSAGE  @Z40LB30*/
*               /* IDC0112I TO SAY THE DATA SET WAS          @Z40LB30*/
*               /* SCRATCHED. THEN ISSUE MESSAGE             @Z40LB30*/
*               /* IDC0811I TO SAY THE DATA SET WAS          @Z40LB30*/
*               /* UNCATALOGED. INCREMENT COUNTER            @Z40LB30*/
*               /* OF SCRATCHED DATA SETS.                   @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1224
*               IF TESTRC=0 THEN    /*                       @Z40LB30*/
         LTR   TESTRC,TESTRC                                       1224
         BNZ   @RF01224                                            1224
*                 DO;               /*                       @Z40LB30*/
*                   DARGAREA=''B;   /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1226
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/
         L     @15,DDSTRU                                          1227
         MVC   DARGSMOD(3,@15),@CC01418                            1227
*                   DARGSENT=MSG0112I;/*                     @Z40LB30*/
         MVI   DARGSENT(@15),X'44'                                 1228
*                   DARGDBP=ADDR(VSDDSN(ELEMENT));/*         @Z40LB30*/
         LR    @14,ELEMENT                                         1229
         MH    @14,@CH01628                                        1229
         L     @01,LISTADDR                                        1229
         AL    @01,@CF01651                                        1229
         LA    @14,VSDDSN-20(@14,@01)                              1229
         ST    @14,DARGDBP(,@15)                                   1229
*                   DARGILP=LENGTH(VSDDSN(ELEMENT));/*       @Z40LB30*/
         MVC   DARGILP(2,@15),@CH00848                             1230
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @15,@PC00001                                        1231
         ST    @15,@AL00001                                        1231
         LA    @14,@CF00116                                        1231
         ST    @14,@AL00001+4                                      1231
         LA    @14,DDSTRU                                          1231
         ST    @14,@AL00001+8                                      1231
         MVI   @AL00001+8,X'80'                                    1231
         L     @15,GDTPRT(,@15)                                    1231
         LA    @01,@AL00001                                        1231
         BALR  @14,@15                                             1231
*                   DARGSMOD=SD01MSG;/*                      @Z40LB30*/
         L     @15,DDSTRU                                          1232
         MVC   DARGSMOD(3,@15),@CC01420                            1232
*                   DARGSENT=MSG0811I;/*                     @Z40LB30*/
         MVI   DARGSENT(@15),X'02'                                 1233
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/
         L     @15,@PC00001                                        1234
         ST    @15,@AL00001                                        1234
         LA    @14,@CF00116                                        1234
         ST    @14,@AL00001+4                                      1234
         LA    @14,DDSTRU                                          1234
         ST    @14,@AL00001+8                                      1234
         MVI   @AL00001+8,X'80'                                    1234
         L     @15,GDTPRT(,@15)                                    1234
         LA    @01,@AL00001                                        1234
         BALR  @14,@15                                             1234
*                   SCRATCNT=SCRATCNT+1;/*                   @Z40LB30*/
         LA    @15,1                                               1235
         AH    @15,SCRATCNT                                        1235
         STH   @15,SCRATCNT                                        1235
*                 END;              /*                       @Z40LB30*/
*                                                                  1236
*               /*****************************************************/
*               /*                                                   */
*               /* IF UUNCATLG IS NOT SUCCESSFUL SET         @Z40LB30*/
*               /* INTERNAL CONDITION CODE                   @Z40LB30*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1237
*               ELSE                /*                       @Z40LB30*/
*                 CC03=LASTCC08;    /*                       @Z40LB30*/
         B     @RC01224                                            1237
@RF01224 LA    CC03,8                                              1237
*             END;                  /*                       @Z40LB30*/
@RC01224 DS    0H                                                  1239
*       END;                        /*                       @Z40LB30*/
@RC01210 DS    0H                                                  1239
@RC01208 DS    0H                                                  1240
*   END;                            /*                       @Z40LB30*/
@RC01169 AL    ELEMENT,@CF00221                                    1240
@DE01168 L     @01,LISTADDR                                        1240
         C     ELEMENT,VSDELEM(,@01)                               1240
         BNH   @DL01168                                            1240
*                                                                  1241
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A SYSCTLG DATA SET HAS BEEN FOUND, DETERMINE       @Z40LB30*/
*   /* WHETHER TO SCRATCH IT OR NOT.                         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1241
*   IF SYSCTCNT>0 THEN              /*                       @Z40LB30*/
         SLR   @06,@06                                             1241
         CH    @06,SYSCTCNT                                        1241
         BNL   @RF01241                                            1241
*     DO;                           /*                       @Z40LB30*/
*                                                                  1242
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE PURGE PARAMETER WAS SPECIFIED, SCRATCH     @Z40LB30*/
*       /* THE DATA SET                                      @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1243
*       IF ADDR(PURGE)^=NULLPTR THEN/*                       @Z40LB30*/
         L     @15,@PC00001+4                                      1243
         C     @06,FDTPTR+64(,@15)                                 1243
         BE    @RF01243                                            1243
*         DO;                       /*                       @Z40LB30*/
*                                                                  1244
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE USCRATCH MACRO AND SAVE THE RETURN      @Z40LB30*/
*           /* CODE. ALSO RESET SYSCTLG COUNTER.             @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1245
*           CALL IDCSASC0(GDTTBL,SYSCTLG,ADDR(UVOLLIST),/*   @Z40LB30*/
*               OVERRIDE);          /*                       @Z40LB30*/
         L     @06,@PC00001                                        1245
         ST    @06,@AL00001                                        1245
         LA    @02,@CC01479                                        1245
         ST    @02,@AL00001+4                                      1245
         LA    @02,SCRAREA                                         1245
         ST    @02,@AFTEMPS                                        1245
         LA    @02,@AFTEMPS                                        1245
         ST    @02,@AL00001+8                                      1245
         LA    @02,OVERRIDE                                        1245
         ST    @02,@AL00001+12                                     1245
         MVI   @AL00001+12,X'80'                                   1245
         L     @15,GDTSCR(,@06)                                    1245
         LA    @01,@AL00001                                        1245
         BALR  @14,@15                                             1245
*           RESPECIFY                                              1246
*             RTNREG RSTD;                                         1246
*           TESTRC=RTNREG;                                         1247
         LR    TESTRC,RTNREG                                       1247
*           RESPECIFY                                              1248
*             RTNREG UNRSTD;        /*                       @Z40LB30*/
*           SYSCTCNT=0;             /*                       @Z40LB30*/
*                                                                  1249
         SLR   @06,@06                                             1249
         STH   @06,SYSCTCNT                                        1249
*           /*********************************************************/
*           /*                                                       */
*           /* IF USCRATCH IS SUCCESSFUL, ISSUE MSG IDC0112I @Z40LB30*/
*           /* AND INCREMENT COUNTE OF SCRATCHED DATA        @Z40LB30*/
*           /* SETS.                                         @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1250
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/
         CR    TESTRC,@06                                          1250
         BNE   @RF01250                                            1250
*             DO;                   /*                       @Z40LB30*/
*               DARGAREA=''B;       /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1252
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/
         L     @06,DDSTRU                                          1253
         MVC   DARGSMOD(3,@06),@CC01418                            1253
*               DARGSENT=MSG0112I;  /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'44'                                 1254
*               DARGDBP=ADDR(SYSCTLG);/*                     @Z40LB30*/
         LA    @15,@CC01479                                        1255
         ST    @15,DARGDBP(,@06)                                   1255
*               DARGILP=LENGTH(SYSCTLG);/*                   @Z40LB30*/
         MVC   DARGILP(2,@06),@CH00848                             1256
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/
         L     @06,@PC00001                                        1257
         ST    @06,@AL00001                                        1257
         LA    @15,@CF00116                                        1257
         ST    @15,@AL00001+4                                      1257
         LA    @15,DDSTRU                                          1257
         ST    @15,@AL00001+8                                      1257
         MVI   @AL00001+8,X'80'                                    1257
         L     @15,GDTPRT(,@06)                                    1257
         LA    @01,@AL00001                                        1257
         BALR  @14,@15                                             1257
*               SCRATCNT=SCRATCNT+1;/*                       @Z40LB30*/
         LA    @06,1                                               1258
         AH    @06,SCRATCNT                                        1258
         STH   @06,SCRATCNT                                        1258
*             END;                  /*                       @Z40LB30*/
*                                                                  1259
*           /*********************************************************/
*           /*                                                       */
*           /* IF USCRATCH IS NOT SUCCESSFUL, SET INTERNAL   @Z40LB30*/
*           /* CONDITION CODE                                @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1260
*           ELSE                    /*                       @Z40LB30*/
*             CC03=LASTCC08;        /*                       @Z40LB30*/
         B     @RC01250                                            1260
@RF01250 LA    CC03,8                                              1260
*         END;                      /*                       @Z40LB30*/
@RC01250 DS    0H                                                  1262
*     END;                          /*                       @Z40LB30*/
@RF01243 DS    0H                                                  1263
*                                                                  1263
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT MESSAGE IDC0812I TO SUMMARIZE THE NUMBER OF     @Z40LB30*/
*   /* DATA SETS SCRATCHED                                   @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1263
*   DARGAREA=''B;                   /*                       @Z40LB30*/
@RF01241 XC    DARGAREA(28),DARGAREA                               1263
*   DARGSMOD=SD01MSG;               /*                       @Z40LB30*/
         L     @06,DDSTRU                                          1264
         MVC   DARGSMOD(3,@06),@CC01420                            1264
*   DARGSENT=MSG0812I;              /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'03'                                 1265
*   DARGCNT=2;                      /*                       @Z40LB30*/
         LA    @15,2                                               1266
         STH   @15,DARGCNT(,@06)                                   1266
*   DARGINS(1)=1;                   /*                       @Z40LB30*/
         MVC   DARGINS(2,@06),@CH00221                             1267
*   DARGINL(1)=LENGTH(SCRATCNT);    /*                       @Z40LB30*/
         STH   @15,DARGINL(,@06)                                   1268
*   DARGDTM(1)=ADDR(SCRATCNT);      /*                       @Z40LB30*/
         LA    @14,SCRATCNT                                        1269
         ST    @14,DARGDTM(,@06)                                   1269
*   DARGINS(2)=2;                   /*                       @Z40LB30*/
         STH   @15,DARGINS+8(,@06)                                 1270
*   DARGINL(2)=LENGTH(BASSERNO);    /*                       @Z40LB30*/
         MVC   DARGINL+8(2,@06),@CH00158                           1271
*   DARGDTM(2)=ADDR(BASSERNO);      /*                       @Z40LB30*/
         LA    @15,BASSERNO(,BASEVPTR)                             1272
         ST    @15,DARGDTM+8(,@06)                                 1272
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/
*                                                                  1273
         L     @06,@PC00001                                        1273
         ST    @06,@AL00001                                        1273
         LA    @15,@CF00116                                        1273
         ST    @15,@AL00001+4                                      1273
         LA    @15,DDSTRU                                          1273
         ST    @15,@AL00001+8                                      1273
         MVI   @AL00001+8,X'80'                                    1273
         L     @15,GDTPRT(,@06)                                    1273
         LA    @01,@AL00001                                        1273
         BALR  @14,@15                                             1273
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SYSCTLG DATA SET WAS NOT SCRATCHED, PRINT      @Z40LB30*/
*   /* MESSAGE IDC0816I TO SAY IT WAS NOT SCRATCHED.         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1274
*   IF SYSCTCNT>0 THEN              /*                       @Z40LB30*/
         LH    @06,SYSCTCNT                                        1274
         LTR   @06,@06                                             1274
         BNP   @RF01274                                            1274
*     DO;                           /*                       @Z40LB30*/
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1276
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/
         L     @06,DDSTRU                                          1277
         MVC   DARGSMOD(3,@06),@CC01420                            1277
*       DARGSENT=MSG0816I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'08'                                 1278
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @06,@PC00001                                        1279
         ST    @06,@AL00001                                        1279
         LA    @15,@CF00116                                        1279
         ST    @15,@AL00001+4                                      1279
         LA    @15,DDSTRU                                          1279
         ST    @15,@AL00001+8                                      1279
         MVI   @AL00001+8,X'80'                                    1279
         L     @15,GDTPRT(,@06)                                    1279
         LA    @01,@AL00001                                        1279
         BALR  @14,@15                                             1279
*     END;                          /*                       @Z40LB30*/
*                                                                  1280
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ANY GDGS WERE NOT SCRATCHED, PRINT MESSAGE         @Z40LB30*/
*   /* IDC0813I TO SAY HOW MANY GDGS WERE NOT SCRATCHED      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1281
*   IF GDGCNT>0 THEN                /*                       @Z40LB30*/
@RF01274 LH    @06,GDGCNT                                          1281
         LTR   @06,@06                                             1281
         BNP   @RF01281                                            1281
*     DO;                           /*                       @Z40LB30*/
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1283
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/
         L     @06,DDSTRU                                          1284
         MVC   DARGSMOD(3,@06),@CC01420                            1284
*       DARGSENT=MSG0813I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'04'                                 1285
*       DARGDBP=ADDR(GDGCNT);       /*                       @Z40LB30*/
         LA    @15,GDGCNT                                          1286
         ST    @15,DARGDBP(,@06)                                   1286
*       DARGILP=LENGTH(GDGCNT);     /*                       @Z40LB30*/
         MVC   DARGILP(2,@06),@CH00155                             1287
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @06,@PC00001                                        1288
         ST    @06,@AL00001                                        1288
         LA    @15,@CF00116                                        1288
         ST    @15,@AL00001+4                                      1288
         LA    @15,DDSTRU                                          1288
         ST    @15,@AL00001+8                                      1288
         MVI   @AL00001+8,X'80'                                    1288
         L     @15,GDTPRT(,@06)                                    1288
         LA    @01,@AL00001                                        1288
         BALR  @14,@15                                             1288
*     END;                          /*                       @Z40LB30*/
*                                                                  1289
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ANY MULTI-VOLUME DATA SETS WERE NOT SCRATCHED      @Z40LB30*/
*   /* PRINT MESSAGE IDC0814I TO SAY HOW MANY MULTI-VOLUME   @Z40LB30*/
*   /* DATA SETS WERE NOT SCRATCHED                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*   IF MULTICNT>0 THEN              /*                       @Z40LB30*/
@RF01281 LH    @06,MULTICNT                                        1290
         LTR   @06,@06                                             1290
         BNP   @RF01290                                            1290
*     DO;                           /*                       @Z40LB30*/
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               1292
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/
         L     @06,DDSTRU                                          1293
         MVC   DARGSMOD(3,@06),@CC01420                            1293
*       DARGSENT=MSG0814I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@06),X'05'                                 1294
*       DARGDBP=ADDR(MULTICNT);     /*                       @Z40LB30*/
         LA    @15,MULTICNT                                        1295
         ST    @15,DARGDBP(,@06)                                   1295
*       DARGILP=LENGTH(MULTICNT);   /*                       @Z40LB30*/
         MVC   DARGILP(2,@06),@CH00155                             1296
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @06,@PC00001                                        1297
         ST    @06,@AL00001                                        1297
         LA    @15,@CF00116                                        1297
         ST    @15,@AL00001+4                                      1297
         LA    @15,DDSTRU                                          1297
         ST    @15,@AL00001+8                                      1297
         MVI   @AL00001+8,X'80'                                    1297
         L     @15,GDTPRT(,@06)                                    1297
         LA    @01,@AL00001                                        1297
         BALR  @14,@15                                             1297
*     END;                          /*                       @Z40LB30*/
*                                                                  1298
*   /*****************************************************************/
*   /*                                                               */
*   /* IF SOME ERRORS OCCURRED AND NO DATA SETS WERE         @Z40LB30*/
*   /* SCRATCHED, INCREASE THE CONDITION CODE                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1299
*   IF CC03=LASTCC08&SCRATCNT=0 THEN/*                       @Z40LB30*/
@RF01290 C     CC03,@CF00181                                       1299
         BNE   @RF01299                                            1299
         LH    @06,SCRATCNT                                        1299
         LTR   @06,@06                                             1299
         BNZ   @RF01299                                            1299
*     CC03=LASTCC12;                /*                       @Z40LB30*/
*                                                                  1300
         LA    CC03,12                                             1300
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1301
*   RETURN CODE(CC03);              /*                       @Z40LB30*/
@RF01299 LR    @15,CC03                                            1301
@EL00012 DS    0H                                                  1301
@EF00012 DS    0H                                                  1301
@ER00012 L     @14,@SA00012                                        1301
         BR    @14                                                 1301
*   END SCRUNCAT;                   /*                       @Z40LB30*/
*                                                                  1303
*/********************************************************************/
*/*                                                          @Z40LB35*/
*/* PROCEDURE NAME - DATES  (ACCESS METHOD SERVICES)         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES       @Z40LB35*/
*/*            THE AMS SERVICES WITH THE BASIC FUNCTION OF   @Z40LB35*/
*/*            CONVERTING A ONE VALUE DATE SUCH AS 99999 TO  @Z40LB35*/
*/*            '00 99 0999' OR OBTAINING THE CURRENT DATE AND@Z40LB35*/
*/*            ADJUSTING IT BY EITHER ADDING OR SUBTRACTING  @Z40LB35*/
*/*            DAYS TO THAT DATE.  THE DATE WILL BE ADJUSTED @Z40LB35*/
*/*            FOR ANY LEAP YEARS.  THE DATE WILL ALSO BE    @Z40LB35*/
*/*            ADJUSTED TO FIT WITHIN THE RANGE 0 TO 99999.  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* ENTRY POINT - DATES                                      @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*      LINKAGE - 'CALL DATES (DATESAGL)'                   @Z40LB35*/
*/*                '%INCLUDE SYSLIB(IDCDF55)'                @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* INPUT  - ADDRESS OF ARGUMENT LIST (DATESAGL)             @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB35*/
*/*          (0) - DATES SUCCESSFUL                          @Z40LB35*/
*/*                                                          @Z40LB35*/
*/*        - A CONVERTED DATE (00 YY DDDD) IN BINARY         @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB35*/
*/*               CODE ZERO                                  @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* EXIT ERROR  - NONE                                       @Z40LB35*/
*/*                                                          @Z40LB35*/
*/* CHANGE ACTIVITY - NONE                                   @Z40LB35*/
*/*                                                          @Z40LB35*/
*/********************************************************************/
*                                                                  1303
*DATES:                                                            1303
*   PROC;                           /*                       @Z40LB35*/
*                                                                  1303
DATES    STM   @14,@12,@SA00013                                    1303
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATION FOR DATES PROCEDURE                       @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1304
*   DCL                                                            1304
*     TIMEVAR CHAR(8);              /* TIME VARIABLE - UTIME @Z40LB35
*                                      USED IN UTIME CALL    @Z40LB35*/
*   DCL                                                            1305
*     1 DATEVAR CHAR(4),            /* DATE VARIABLE - UTIME @Z40LB35*/
*      2 * CHAR(1),                 /* FILLER - RESERVED     @Z40LB35*/
*      2 DATEPACK CHAR(3);          /* DATE RETURN - PACKED  @Z40LB35
*                                      DECIMAL FORMAT        @Z40LB35*/
*                                                                  1305
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING STRUCTURE IS THE DATE RETURNED          @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1306
*   DCL                                                            1306
*     1 CONVDATE BDY(WORD) BASED(DATRETRN),                        1306
*      2 CONVYEAR FIXED(15),        /* YEAR - RANGE 0 - 99   @Z40LB35*/
*      2 CONVDAYS FIXED(15);        /* DAYS - RANGE 0 - 999  @Z40LB35*/
*                                                                  1306
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING DECLARES ARE INTERNAL FIELDS            @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1307
*   DCL                                                            1307
*     DATEBIN FIXED(31);            /* USED TO UNPACK DATE   @Z40LB35*/
*   DCL                                                            1308
*     QUITSW BIT(1);                /* USED TO CONTROL LOOPS @Z40LB35*/
*   DCL                                                            1309
*     ADJDAYS FIXED(31);            /* USED TO ADJUST DAYS   @Z40LB35*/
*                                                                  1309
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ARE STATIC CONSTANTS                    @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1310
*   DCL                                                            1310
*     REGYEAR FIXED(15) INIT(365);  /*                       @Z40LB35
*                                      NUM DAYS IN REG YEAR  @Z40LB35*/
*   DCL                                                            1311
*     LEAPYEAR FIXED(15) INIT(366); /*                       @Z40LB35
*                                      NUM DAYS IN LEAP YEAR @Z40LB35*/
*   DCL                                                            1312
*     MAXYEAR FIXED(15) INIT(99);   /*                       @Z40LB35
*                                      HIGHEST YEAR          @Z40LB35*/
*   DCL                                                            1313
*     MAXDAYS FIXED(15) INIT(999);  /*                       @Z40LB35
*                                      HIGHEST DAYS          @Z40LB35*/
*   DCL                                                            1314
*     MINYEAR FIXED(15) INIT(0);    /*                       @Z40LB35
*                                      LOWEST YEAR           @Z40LB35*/
*   DCL                                                            1315
*     MINDAYS FIXED(15) INIT(0);    /*                       @Z40LB35
*                                      LOWEST DAYS           @Z40LB35*/
*   DCL                                                            1316
*     NOREMAIN FIXED(15) INIT(0);   /*                       @Z40LB35
*                                      NO REMAINDER AFTER DIV      1316
*                                                            @Z40LB35*/
*                                                                  1317
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS IS THE START OF THIS PROCEDURE                   @Z40LB35*/
*   /* HERE INITIALIZATION TAKES PLACE.                      @Z40LB35*/
*   /* THE PARM LIST HEADER IS INITIALIZED,                  @Z40LB35*/
*   /* THE TRACE POINT 'DTST' IS RECORDED, AND               @Z40LB35*/
*   /* THE DATE IS SET TO ZERO.                              @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1317
*   OLDERID2=NEWERID2;                                             1317
         L     @08,@PC00001                                        1317
         L     @15,GDTTR2(,@08)                                    1317
         MVC   @TS00001(95),NEWERID2(@15)                          1317
         MVC   OLDERID2(95,@15),@TS00001                           1317
*   NEWID2='DTST';                  /*                       @Z40LB35*/
         MVC   NEWID2(4,@15),@CC01598                              1318
*   DATHEAD='DATESAGL';             /*                       @Z40LB35*/
         LA    @15,DTSAREA                                         1319
         MVC   DATHEAD(8,@15),@CC01599                             1319
*   CONVDATE=0;                     /*                       @Z40LB35*/
*                                                                  1320
         L     @01,DATRETRN(,@15)                                  1320
         SLR   @00,@00                                             1320
         ST    @00,CONVDATE(,@01)                                  1320
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF CALLER WANTS THE CURRENT DATE            @Z40LB35*/
*   /* ADJUSTED WITH DAYS ADD OR SUBTRACTED.                 @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1321
*   IF DATDAYOP=ON THEN                                            1321
         TM    DATDAYOP(@15),B'00010000'                           1321
         BNO   @RF01321                                            1321
*     DO;                           /*                       @Z40LB35*/
*                                                                  1322
*       /*************************************************************/
*       /*                                                           */
*       /* IF CALLER WANTS TO ADJUST CURRENT DATE,           @Z40LB35*/
*       /* ISSUE UTIME TO RETRIEVE CURRENT DATE,             @Z40LB35*/
*       /* CONVERT THE DATE FROM PACKED DECIMAL TO           @Z40LB35*/
*       /* BINARY, AND SEPARATE THE YEARS FROM THE           @Z40LB35*/
*       /* DAYS.                                             @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1323
*       ADJDAYS=DATDAYS;            /*                       @Z40LB35*/
         L     ADJDAYS,DATDAYS(,@15)                               1323
*       CALL IDCSATI0(GDTTBL,TIMEVAR,DATEVAR);/*             @Z40LB35*/
         ST    @08,@AL00001                                        1324
         LA    @15,TIMEVAR                                         1324
         ST    @15,@AL00001+4                                      1324
         LA    @15,DATEVAR                                         1324
         ST    @15,@AL00001+8                                      1324
         MVI   @AL00001+8,X'80'                                    1324
         L     @15,GDTTIM(,@08)                                    1324
         LA    @01,@AL00001                                        1324
         BALR  @14,@15                                             1324
*       CVB(DATEBIN,DATEPACK);      /*                       @Z40LB35*/
         XC    @TS00001(8),@TS00001                                1325
         MVC   @TS00001+5(3),DATEPACK                              1325
         CVB   DATEBIN,@TS00001                                    1325
*       CONVYEAR=DATEBIN/1000;      /*                       @Z40LB35*/
         LA    @08,DTSAREA                                         1326
         L     @15,DATRETRN(,@08)                                  1326
         LA    @14,1000                                            1326
         LR    @00,DATEBIN                                         1326
         SRDA  @00,32                                              1326
         DR    @00,@14                                             1326
         STH   @01,CONVYEAR(,@15)                                  1326
*       CONVDAYS=DATEBIN-(CONVYEAR*1000);/*                  @Z40LB35*/
*                                                                  1327
         MR    @00,@14                                             1327
         LCR   @01,@01                                             1327
         ALR   @01,DATEBIN                                         1327
         STH   @01,CONVDAYS(,@15)                                  1327
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE QUITSW OFF FOR LOOP CONTROL            @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1328
*       QUITSW=OFF;                 /*                       @Z40LB35*/
*                                                                  1328
         NI    QUITSW,B'01111111'                                  1328
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE IF CALLER WANTS DAYS ADDED TO           @Z40LB35*/
*       /* CURRENT DATE.                                     @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1329
*       IF DATADD=ON THEN                                          1329
*                                                                  1329
         TM    DATADD(@08),B'10000000'                             1329
         BNO   @RF01329                                            1329
*         /***********************************************************/
*         /*                                                         */
*         /* IF CALLER WANTS DAYS ADDED, LOOP THOUGH         @Z40LB35*/
*         /* THE FOLLOWING DO LOOP UNTIL QUITSW IS SET       @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1330
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/
*                                                                  1330
         B     @DE01330                                            1330
@DL01330 DS    0H                                                  1331
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1331
*           IF CONVYEAR//4=NOREMAIN THEN                           1331
*                                                                  1331
         LA    @08,DTSAREA                                         1331
         L     @08,DATRETRN(,@08)                                  1331
         LH    @03,CONVYEAR(,@08)                                  1331
         LR    @00,@03                                             1331
         SRDA  @00,32                                              1331
         D     @00,@CF00042                                        1331
         CH    @00,NOREMAIN                                        1331
         BNE   @RF01331                                            1331
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */
*             /*                                             @Z40LB35*/
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1332
*             IF(ADJDAYS+CONVDAYS)>LEAPYEAR THEN                   1332
*                                                                  1332
         LH    @15,LEAPYEAR                                        1332
         LR    @14,ADJDAYS                                         1332
         AH    @14,CONVDAYS(,@08)                                  1332
         CR    @14,@15                                             1332
         BNH   @RF01332                                            1332
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1333
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/
         SLR   ADJDAYS,@15                                         1334
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/
         AL    @03,@CF00221                                        1335
         STH   @03,CONVYEAR(,@08)                                  1335
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1337
*                                                                  1337
*               /*****************************************************/
*               /*                                                   */
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/
*               /* OF DO LOOP                                @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1337
*               DO;                 /*                       @Z40LB35*/
         B     @RC01332                                            1337
@RF01332 DS    0H                                                  1338
*                 CONVDAYS=ADJDAYS+CONVDAYS;/*               @Z40LB35*/
         LA    @08,DTSAREA                                         1338
         L     @08,DATRETRN(,@08)                                  1338
         LR    @03,ADJDAYS                                         1338
         AH    @03,CONVDAYS(,@08)                                  1338
         STH   @03,CONVDAYS(,@08)                                  1338
*                 QUITSW=ON;        /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1339
*               END;                /*                       @Z40LB35*/
*           ELSE                                                   1341
*                                                                  1341
*             /*******************************************************/
*             /*                                                     */
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */
*             /*                                             @Z40LB35*/
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1341
*             IF(ADJDAYS+CONVDAYS)>REGYEAR THEN                    1341
*                                                                  1341
         B     @RC01331                                            1341
@RF01331 LH    @08,REGYEAR                                         1341
         LA    @03,DTSAREA                                         1341
         L     @03,DATRETRN(,@03)                                  1341
         LR    @15,ADJDAYS                                         1341
         AH    @15,CONVDAYS(,@03)                                  1341
         CR    @15,@08                                             1341
         BNH   @RF01341                                            1341
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1342
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/
         SLR   ADJDAYS,@08                                         1343
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/
         LA    @08,1                                               1344
         AH    @08,CONVYEAR(,@03)                                  1344
         STH   @08,CONVYEAR(,@03)                                  1344
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1346
*                                                                  1346
*               /*****************************************************/
*               /*                                                   */
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/
*               /* OF DO LOOP                                @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1346
*               DO;                 /*                       @Z40LB35*/
         B     @RC01341                                            1346
@RF01341 DS    0H                                                  1347
*                 CONVDAYS=CONVDAYS+ADJDAYS;/*               @Z40LB35*/
         LA    @08,DTSAREA                                         1347
         L     @08,DATRETRN(,@08)                                  1347
         LR    @03,ADJDAYS                                         1347
         AH    @03,CONVDAYS(,@08)                                  1347
         STH   @03,CONVDAYS(,@08)                                  1347
*                 QUITSW=ON;        /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1348
*               END;                /*                       @Z40LB35*/
*         END;                      /*                       @Z40LB35*/
@RC01341 DS    0H                                                  1350
@RC01331 DS    0H                                                  1350
@DE01330 TM    QUITSW,B'10000000'                                  1350
         BZ    @DL01330                                            1350
*                                                                  1351
*       /*************************************************************/
*       /*                                                           */
*       /* IF DAYS ARE TO BE SUBTRACTED FROM CURRENT,        @Z40LB35*/
*       /* DO THE FOLLOWING DO GROUP                         @Z40LB35*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1351
*       ELSE                                                       1351
*                                                                  1351
*         /***********************************************************/
*         /*                                                         */
*         /* DO THE FOLLOWING WHILE THE QUITSW IS NOT SET    @Z40LB35*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  1351
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/
*                                                                  1351
         B     @RC01329                                            1351
@RF01329 B     @DE01351                                            1351
@DL01351 DS    0H                                                  1352
*           /*********************************************************/
*           /*                                                       */
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1352
*           IF(CONVYEAR-1)//4=NOREMAIN THEN                        1352
*                                                                  1352
         LA    @08,DTSAREA                                         1352
         L     @08,DATRETRN(,@08)                                  1352
         LH    @03,CONVYEAR(,@08)                                  1352
         BCTR  @03,0                                               1352
         LR    @00,@03                                             1352
         SRDA  @00,32                                              1352
         D     @00,@CF00042                                        1352
         CH    @00,NOREMAIN                                        1352
         BNE   @RF01352                                            1352
*             /*******************************************************/
*             /*                                                     */
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1353
*             IF ADJDAYS>=LEAPYEAR THEN                            1353
*                                                                  1353
         LH    @15,LEAPYEAR                                        1353
         CR    ADJDAYS,@15                                         1353
         BL    @RF01353                                            1353
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1354
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/
         SLR   ADJDAYS,@15                                         1355
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/
         STH   @03,CONVYEAR(,@08)                                  1356
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1358
*                                                                  1358
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1358
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1358
*                                                                  1358
         B     @RC01353                                            1358
@RF01353 LA    @08,DTSAREA                                         1358
         L     @08,DATRETRN(,@08)                                  1358
         LH    @03,CONVDAYS(,@08)                                  1358
         LR    @15,@03                                             1358
         SLR   @15,ADJDAYS                                         1358
         LTR   @15,@15                                             1358
         BP    @RF01358                                            1358
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */
*                 /*                                         @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1359
*                 DO;               /*                       @Z40LB35*/
*                   CONVDAYS=CONVDAYS+LEAPYEAR-ADJDAYS;            1360
         AH    @03,LEAPYEAR                                        1360
         SLR   @03,ADJDAYS                                         1360
         STH   @03,CONVDAYS(,@08)                                  1360
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/
         LH    @03,CONVYEAR(,@08)                                  1361
         BCTR  @03,0                                               1361
         STH   @03,CONVYEAR(,@08)                                  1361
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1362
*                 END;              /*                       @Z40LB35*/
*               ELSE                                               1364
*                                                                  1364
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */
*                 /*                                         @Z40LB35*/
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1364
*                 DO;               /*                       @Z40LB35*/
         B     @RC01358                                            1364
@RF01358 DS    0H                                                  1365
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/
         LA    @08,DTSAREA                                         1365
         L     @08,DATRETRN(,@08)                                  1365
         LH    @03,CONVDAYS(,@08)                                  1365
         SLR   @03,ADJDAYS                                         1365
         STH   @03,CONVDAYS(,@08)                                  1365
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1366
*                 END;              /*                       @Z40LB35*/
*                                                                  1367
*           /*********************************************************/
*           /*                                                       */
*           /* ELSE THIS IS A NORMAL YEAR(NON-LEAP YEAR)     @Z40LB35*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1368
*           ELSE                                                   1368
*                                                                  1368
*             /*******************************************************/
*             /*                                                     */
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  1368
*             IF ADJDAYS>=REGYEAR THEN                             1368
*                                                                  1368
         B     @RC01352                                            1368
@RF01352 LH    @08,REGYEAR                                         1368
         CR    ADJDAYS,@08                                         1368
         BL    @RF01368                                            1368
*               /*****************************************************/
*               /*                                                   */
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1369
*               DO;                 /*                       @Z40LB35*/
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/
         SLR   ADJDAYS,@08                                         1370
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/
         LA    @08,DTSAREA                                         1371
         L     @08,DATRETRN(,@08)                                  1371
         LH    @03,CONVYEAR(,@08)                                  1371
         BCTR  @03,0                                               1371
         STH   @03,CONVYEAR(,@08)                                  1371
*               END;                /*                       @Z40LB35*/
*             ELSE                                                 1373
*                                                                  1373
*               /*****************************************************/
*               /*                                                   */
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1373
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1373
*                                                                  1373
         B     @RC01368                                            1373
@RF01368 LA    @08,DTSAREA                                         1373
         L     @08,DATRETRN(,@08)                                  1373
         LH    @03,CONVDAYS(,@08)                                  1373
         LR    @15,@03                                             1373
         SLR   @15,ADJDAYS                                         1373
         LTR   @15,@15                                             1373
         BP    @RF01373                                            1373
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */
*                 /*                                         @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1374
*                 DO;               /*                       @Z40LB35*/
*                   CONVDAYS=CONVDAYS+REGYEAR-ADJDAYS;             1375
         AH    @03,REGYEAR                                         1375
         SLR   @03,ADJDAYS                                         1375
         STH   @03,CONVDAYS(,@08)                                  1375
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/
         LH    @03,CONVYEAR(,@08)                                  1376
         BCTR  @03,0                                               1376
         STH   @03,CONVYEAR(,@08)                                  1376
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1377
*                 END;              /*                       @Z40LB35*/
*               ELSE                                               1379
*                                                                  1379
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */
*                 /*                                         @Z40LB35*/
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1379
*                 DO;               /*                       @Z40LB35*/
         B     @RC01373                                            1379
@RF01373 DS    0H                                                  1380
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/
         LA    @08,DTSAREA                                         1380
         L     @08,DATRETRN(,@08)                                  1380
         LH    @03,CONVDAYS(,@08)                                  1380
         SLR   @03,ADJDAYS                                         1380
         STH   @03,CONVDAYS(,@08)                                  1380
*                   QUITSW=ON;      /*                       @Z40LB35*/
         OI    QUITSW,B'10000000'                                  1381
*                 END;              /*                       @Z40LB35*/
*         END;                      /*                       @Z40LB35*/
@RC01373 DS    0H                                                  1383
@RC01368 DS    0H                                                  1383
@RC01352 DS    0H                                                  1383
@DE01351 TM    QUITSW,B'10000000'                                  1383
         BZ    @DL01351                                            1383
*     END;                          /*                       @Z40LB35*/
@RC01329 DS    0H                                                  1385
*                                                                  1385
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF THE CALLER WANTS THE DATE                @Z40LB35*/
*   /* CONVERTED                                             @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1385
*   IF DATDTEOP=ON THEN                                            1385
*                                                                  1385
@RF01321 LA    @08,DTSAREA                                         1385
         TM    DATDTEOP(@08),B'00100000'                           1385
         BNO   @RF01385                                            1385
*     /***************************************************************/
*     /*                                                             */
*     /* IF CALLER WANTS DATE CONVERTED, CONVERT THE         @Z40LB35*/
*     /* DATE BY SEPARATING THE YEARS FROM THE DAYS          @Z40LB35*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1386
*     DO;                           /*                       @Z40LB35*/
*       CONVYEAR=DATDATE/1000;      /*                       @Z40LB35*/
         L     @15,DATRETRN(,@08)                                  1387
         LA    @14,1000                                            1387
         L     @08,DATDATE(,@08)                                   1387
         LR    @00,@08                                             1387
         SRDA  @00,32                                              1387
         DR    @00,@14                                             1387
         STH   @01,CONVYEAR(,@15)                                  1387
*       CONVDAYS=DATDATE-(CONVYEAR*1000);/*                  @Z40LB35*/
         MR    @00,@14                                             1388
         SLR   @08,@01                                             1388
         STH   @08,CONVDAYS(,@15)                                  1388
*     END;                          /*                       @Z40LB35*/
*                                                                  1389
*   /*****************************************************************/
*   /*                                                               */
*   /* HERE THE DETERMINATION WILL BE MADE TO SEE            @Z40LB35*/
*   /* IF THE LIMITS ARE VIOLATED                            @Z40LB35*/
*   /* IF SO, FORCE THE DATE TO FALL WITHIN THE              @Z40LB35*/
*   /* LIMITS (0 99999)                                      @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1390
*   IF CONVYEAR>MAXYEAR THEN                                       1390
@RF01385 LH    @08,MAXYEAR                                         1390
         LA    @15,DTSAREA                                         1390
         L     @15,DATRETRN(,@15)                                  1390
         CH    @08,CONVYEAR(,@15)                                  1390
         BNL   @RF01390                                            1390
*     DO;                           /*                       @Z40LB35*/
*       CONVYEAR=MAXYEAR;           /*                       @Z40LB35*/
         STH   @08,CONVYEAR(,@15)                                  1392
*       CONVDAYS=MAXDAYS;           /*                       @Z40LB35*/
         LH    @08,MAXDAYS                                         1393
         STH   @08,CONVDAYS(,@15)                                  1393
*     END;                          /*                       @Z40LB35*/
*   ELSE                                                           1395
*     IF CONVYEAR<MINYEAR×CONVDAYS<MINDAYS THEN                    1395
         B     @RC01390                                            1395
@RF01390 LA    @08,DTSAREA                                         1395
         L     @08,DATRETRN(,@08)                                  1395
         LH    @15,CONVYEAR(,@08)                                  1395
         CH    @15,MINYEAR                                         1395
         BL    @RT01395                                            1395
         LH    @08,CONVDAYS(,@08)                                  1395
         CH    @08,MINDAYS                                         1395
         BNL   @RF01395                                            1395
@RT01395 DS    0H                                                  1396
*       DO;                         /*                       @Z40LB35*/
*         CONVYEAR=MINYEAR;         /*                       @Z40LB35*/
         LA    @08,DTSAREA                                         1397
         L     @08,DATRETRN(,@08)                                  1397
         LH    @15,MINYEAR                                         1397
         STH   @15,CONVYEAR(,@08)                                  1397
*         CONVDAYS=MINDAYS;         /*                       @Z40LB35*/
         LH    @15,MINDAYS                                         1398
         STH   @15,CONVDAYS(,@08)                                  1398
*       END;                        /*                       @Z40LB35*/
*                                                                  1399
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER WITH RETURN CODE ZERO                @Z40LB35*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1400
*   IF GDTDBG=NULLPTR THEN                                         1400
@RF01395 DS    0H                                                  1400
@RC01390 L     @08,@PC00001                                        1400
         L     @08,GDTDBG(,@08)                                    1400
         LTR   @08,@08                                             1400
         BZ    @RT01400                                            1400
*     ;                                                            1401
*   ELSE                                                           1402
*     CALL IDCDB010(GDTTBL,'DTND'); /*                       @Z40LB35*/
         L     @08,@PC00001                                        1402
         ST    @08,@AL00001                                        1402
         LA    @15,@CC01602                                        1402
         ST    @15,@AL00001+4                                      1402
         MVI   @AL00001+4,X'80'                                    1402
         L     @15,GDTDBG(,@08)                                    1402
         LA    @01,@AL00001                                        1402
         BALR  @14,@15                                             1402
*   RETURN CODE(0);                 /*                       @Z40LB35*/
@RT01400 SLR   @15,@15                                             1403
         L     @14,@SA00013                                        1403
         LM    @00,@12,@SA00013+8                                  1403
         BR    @14                                                 1403
*   END DATES;                      /*                       @Z40LB35*/
*                                                                  1405
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                                  1405
*                                   /*                       @Y30LB39*/
*SSCMSG:                                                           1405
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39
*                                                            @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00014                                    1405
         MVC   @PC00014(8),0(@01)                                  1405
*                                   /*                       @Y30LB39*/
*                                                                  1406
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1406
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1406
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1406
*                                   /*                       @Y30LB39*/
*   DCL                                                            1406
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/
*       3 * FIXED(15),              /*                       @Y30LB39*/
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/
*   DCL                                                            1407
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39
*                                                            @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1407
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1408
*                                   /*                       @Y30LB39*/
*   DCL                                                            1408
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/
*   DCL                                                            1409
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1409
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1410
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1410
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1410
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/
*   /* IDCTSCM0.                                             @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1411
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1411
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1411
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1412
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1412
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1412
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1413
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1413
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1413
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1414
*                                   /*                       @Y30LB39*/
*   DECLARE                                                        1414
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1415
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1415
*                                   /*                       @Y30LB39*/
*   OLDERID2=NEWERID2;                                             1415
         L     @08,@PC00001                                        1415
         L     @15,GDTTR2(,@08)                                    1415
         MVC   @TS00001(95),NEWERID2(@15)                          1415
         MVC   OLDERID2(95,@15),@TS00001                           1415
*   NEWID2='SSAA';                  /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1416
         MVC   NEWID2(4,@15),@CC01622                              1416
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/
*   /* ARGUMENT LIST.                                        @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1417
*                                   /*                       @Y30LB39*/
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1417
         LA    @15,SSDRGLT                                         1417
         ST    @15,SSDLPTR                                         1417
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1418
*                                   /*                       @Y30LB39*/
*   IF SSRCODE>0 THEN                                              1418
         L     @14,@PC00014                                        1418
         L     @14,SSRCODE(,@14)                                   1418
         LTR   @14,@14                                             1418
         BNP   @RF01418                                            1418
*     DO;                           /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1419
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/
*       /* CODES.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1420
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1420
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/
         LA    @03,SSINXLST                                        1421
         ST    @03,DARGRETP(,@15)                                  1421
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         MVC   DARGSMOD(3,@15),SSMODSS0                            1422
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 1423
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1424
         MVC   DARGRETL(2,@15),@CH01632                            1424
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/
*       /* ARRAY.                                            @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1425
*                                   /*                       @Y30LB39*/
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1425
         ST    @08,@AL00001                                        1425
         LA    @03,@CF00116                                        1425
         ST    @03,@AL00001+4                                      1425
         LA    @03,SSDLPTR                                         1425
         ST    @03,@AL00001+8                                      1425
         MVI   @AL00001+8,X'80'                                    1425
         L     @15,GDTPRT(,@08)                                    1425
         LA    @01,@AL00001                                        1425
         BALR  @14,@15                                             1425
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/
*       /* REASON CODE.                                      @Y30LB39*/
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1426
*                                   /*                       @Y30LB39*/
*       ENTRYNUM=1;                 /*                       @Y30LB39*/
         LA    ENTRYNUM,1                                          1426
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);   1427
@DL01427 DS    0H                                                  1428
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/
         AL    ENTRYNUM,@CF00221                                   1428
*       END;                        /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1429
@DE01427 L     @08,@PC00014                                        1429
         LR    @03,ENTRYNUM                                        1429
         ALR   @03,@03                                             1429
         LH    @03,SSARRAY-2(@03)                                  1429
         CH    @03,SSRHALF(,@08)                                   1429
         BE    @DC01427                                            1429
         SLR   @15,@15                                             1429
         CR    @03,@15                                             1429
         BNE   @DL01427                                            1429
@DC01427 DS    0H                                                  1430
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Y30LB39*/
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/
*       /* CODE OR                                           @Y30LB39*/
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/
*       /*                                                   @Y30LB39*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1430
*                                   /*                       @Y30LB39*/
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1430
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/
         L     @14,SSDLPTR                                         1431
         MVC   DARGSMOD(3,@14),SSMODSS0                            1431
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@14)                             1432
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/
         CR    @03,@15                                             1433
         BNE   @RF01433                                            1433
*         DO;                       /*                       @Y30LB39*/
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/
         ST    @08,DARGDBP(,@14)                                   1435
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/
         MVC   DARGILP(2,@14),@CH00042                             1436
*         END;                      /*                       @Y30LB39*/
*     END;                          /*                       @Y30LB39*/
*                                   /*                       @Y30LB39*/
*                                                                  1439
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/
*   /* POST CODE.                                            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1439
*                                   /*                       @Y30LB39*/
*   ELSE                            /*                       @Y30LB39*/
*     DO;                           /*                       @Y30LB39*/
         B     @RC01418                                            1439
@RF01418 DS    0H                                                  1440
*       SSDRGLT=''B;                /*                       @Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1440
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/
         L     @08,SSDLPTR                                         1441
         MVC   DARGSMOD(3,@08),SSMODCM0                            1441
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/
         MVC   DARGSENT(1,@08),SSMSGNUM                            1442
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/
         L     @15,@PC00014+4                                      1443
         ST    @15,DARGDBP(,@08)                                   1443
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/
         MVC   DARGILP(2,@08),@CH00221                             1444
*     END;                          /*                       @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1445
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1446
*                                   /*                       @Y30LB39*/
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39
*                                                            @Y30LB39*/
*                                                                  1446
@RC01418 L     @08,@PC00001                                        1446
         ST    @08,@AL00001                                        1446
         LA    @15,@CF00116                                        1446
         ST    @15,@AL00001+4                                      1446
         LA    @15,SSDLPTR                                         1446
         ST    @15,@AL00001+8                                      1446
         MVI   @AL00001+8,X'80'                                    1446
         L     @15,GDTPRT(,@08)                                    1446
         LA    @01,@AL00001                                        1446
         BALR  @14,@15                                             1446
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Y30LB39*/
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/
*   /*                                                       @Y30LB39*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1447
*                                   /*                       @Y30LB39
*                                                            @Y30LB39*/
*   RETURN CODE(0);                 /*                       @Y30LB39
*                                                            @Y30LB39*/
         SLR   @15,@15                                             1447
         L     @14,@SA00014                                        1447
         LM    @00,@12,@SA00014+8                                  1447
         BR    @14                                                 1447
*   END SSCMSG;                     /*                       @Y30LB39*/
*   END IDCSD01                     /*                       @Z40LB30*/
*                                                                  1449
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IDCCSSD )                                       */
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */
*/*%INCLUDE SYSLIB  (IDCDF55 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */
*                                                                  1449
*       ;                                                          1449
@DATA    DS    0H
@CH00155 DC    H'2'
@CH00297 DC    H'5'
@CH01628 DC    H'80'
@CH01632 DC    H'120'
@CH01626 DC    H'164'
@CH01625 DC    H'224'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00013 DS    15F
@SA00002 DS    1F
@SA00003 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@SA00006 DS    1F
@SA00008 DS    1F
@SA00009 DS    1F
@SA00014 DS    15F
@PC00014 DS    2F
@SA00007 DS    1F
@SA00010 DS    1F
@SA00011 DS    1F
@SA00012 DS    1F
@AL00001 DS    4A
@TF00001 DS    F
@AFTEMPS DS    1F
IDCSD01  CSECT
         DS    0F
@CF00116 DC    F'0'
@CF00221 DC    F'1'
@CH00221 EQU   @CF00221+2
@CF00164 DC    F'3'
@CF00042 DC    F'4'
@CH00042 EQU   @CF00042+2
@CF00158 DC    F'6'
@CH00158 EQU   @CF00158+2
@CF00181 DC    F'8'
@CH00181 EQU   @CF00181+2
@CF00037 DC    F'10'
@CH00037 EQU   @CF00037+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00848 DC    F'44'
@CH00848 EQU   @CF00848+2
@CF01654 DC    F'-68'
@CF01656 DC    F'-64'
@CF01655 DC    F'-63'
@CF01653 DC    F'-61'
@CF01651 DC    F'-60'
@CF01650 DC    F'-16'
@CF01645 DC    F'-7'
@CF01643 DC    F'-5'
@CF01648 DC    XL4'0000FFFF'
@CF01473 DC    XL4'0208'
@CF01475 DC    XL4'0223'
@CF01477 DC    XL4'0224'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
DMPINDEX DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
RVVIPTR  DS    A
GROUPPTR DS    A
LISTADDR DS    A
EXPDATE  DS    F
CREDATE  DS    F
ADDRUCB  DS    A
FILEUCB  DS    A
VVICODE  DS    F
VVICODE2 DS    F
VOLPTR   DS    A
SSDLPTR  DS    A
LISTPTR  DS    A
SCRATCNT DS    H
GDGCNT   DS    H
MULTICNT DS    H
VOLRDCNT DS    H
EXCLCNT  DS    H
SYSCTCNT DS    H
INDEX    DS    H
SETRC    DS    H
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
ALOCAREA DS    CL31
         DS    CL1
DARGAREA DS    CL28
SCRAREA  DS    CL12
CATAREA  DS    CL69
         DS    CL3
VSAREA3  DS    CL59
         DS    CL1
SLTAREA  DS    CL23
         DS    CL1
CHKAREA  DS    CL29
         DS    CL3
DTSAREA  DS    CL21
         DS    CL3
VOLRVVI  DS    CL68
GRPRVVI  DS    CL68
VOLREC   DS    CL224
GRPREC   DS    CL164
FLAGS    DS    BL1
         ORG   FLAGS
ALOCFLAG DS    BL1
INITVS3  EQU   FLAGS+0
GDGTYPE  EQU   FLAGS+0
EXCVOL   EQU   FLAGS+0
@NM00109 EQU   FLAGS+0
         ORG   FLAGS+1
COMFLAGS DS    BL1
         ORG   COMFLAGS
ONEDONE  DS    BL1
RDERROR  EQU   COMFLAGS+0
EOFILE   EQU   COMFLAGS+0
NOVOLS   EQU   COMFLAGS+0
EMPTYGRP EQU   COMFLAGS+0
@NM00110 EQU   COMFLAGS+0
         ORG   COMFLAGS+1
DDNAME   DS    CL8
UNITLIST DS    CL12
         ORG   UNITLIST
UNITCNT  DS    FL2
UNITLNG  DS    FL2
UNITNAME DS    CL8
         ORG   UNITLIST+12
VOLLIST  DS    CL10
         ORG   VOLLIST
VOLCOUNT DS    FL2
VOLLNG   DS    FL2
VOLNAME  DS    CL6
         ORG   VOLLIST+10
TIMEVAR  DS    CL8
DATEVAR  DS    CL4
         ORG   DATEVAR
@NM00113 DS    CL1
DATEPACK DS    CL3
         ORG   DATEVAR+4
QUITSW   DS    BL1
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSD01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
RVVLEN   DC    AL2(68)
REGYEAR  DC    H'365'
LEAPYEAR DC    H'366'
MAXYEAR  DC    H'99'
MAXDAYS  DC    H'999'
MINYEAR  DC    H'0'
MINDAYS  DC    H'0'
NOREMAIN DC    H'0'
SSMSGNUM DC    AL1(56)
@CC01479 DC    C'SYSCTLG                                     '
@CC01560 DC    C'IDCVS03 '
@CC01599 DC    C'DATESAGL'
@CC01469 DC    C'3330V'
@CC01361 DC    C'SD01'
@CC01467 DC    C'SD00'
@CC01488 DC    C'SDST'
@CC01500 DC    C'SDED'
@CC01504 DC    C'SDSV'
@CC01511 DC    C'SDSG'
@CC01516 DC    C'SDNG'
@CC01520 DC    C'SDAG'
@CC01524 DC    C'SDAV'
@CC01528 DC    C'SDRG'
@CC01532 DC    C'SDCK'
@CC01536 DC    C'SDPV'
@CC01546 DC    C'SDAL'
@CC01556 DC    C'SDSL'
@CC01564 DC    C'SDSC'
@CC01598 DC    C'DTST'
@CC01602 DC    C'DTND'
@CC01622 DC    C'SSAA'
@CC01418 DC    C'CM0'
@CC01420 EQU   @CC01361
@CC01422 DC    C'UV0'
@CB01471 DC    X'30582009'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODIFYC  DC    CL8'MODIFYC '
MODID    DC    CL4'SD01'
FIXAREA  DS    CL500
         ORG   FIXAREA
@NM00111 DC    250X'00'
@NM00112 DC    250X'00'
         ORG   FIXAREA+500
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
ADJDAYS  EQU   @02
DATEBIN  EQU   @03
INDEX1   EQU   @02
NUMCHAR  EQU   @03
LASTCHAR EQU   @02
CC03     EQU   @08
CC02     EQU   @07
CC01     EQU   @04
BASEVPTR EQU   @05
ELEMENT  EQU   @06
TESTRC   EQU   @03
RTNREG   EQU   @15
REG0     EQU   @00
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAFP0 EQU   0
IDCSATI0 EQU   0
IDCSAAL0 EQU   0
IDCSADL0 EQU   0
IDCSASS0 EQU   0
IDCSASC0 EQU   0
IDCSA060 EQU   0
IDCSAUC0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
RACFAGL  EQU   0
RACFFLG1 EQU   RACFAGL
RACFFLG2 EQU   RACFAGL+1
RACFFLG3 EQU   RACFAGL+2
RACFFLG4 EQU   RACFAGL+3
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00017 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
IOCREL   EQU   IOCSTR+60
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLCNT  EQU   UVOLLIST
UVOLENT  EQU   UVOLLIST+2
UVOLDEV  EQU   UVOLENT
UVOLVOL  EQU   UVOLENT+4
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPARY   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00074 EQU   SV82LIST+4
SV82DCBP EQU   @NM00074
@NM00075 EQU   SV82LIST+12
SV82WRKP EQU   @NM00075
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTDSN   EQU   UCTAGL+8
UCTACBP  EQU   UCTAGL+52
UCTVOLP  EQU   UCTAGL+56
UCTDD    EQU   UCTAGL+60
UCTFLAGS EQU   UCTAGL+68
UCTVSCAT EQU   UCTFLAGS
SELAGL   EQU   0
SELUCBP  EQU   SELAGL+8
SELDDNP  EQU   SELAGL+12
SELVOL   EQU   SELAGL+16
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATHEAD  EQU   DATESAGL
DATDATE  EQU   DATESAGL+8
DATDAYS  EQU   DATESAGL+12
DATRETRN EQU   DATESAGL+16
DATESOPT EQU   DATESAGL+20
DATADD   EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATDAYOP EQU   DATESOPT
VS3AGL   EQU   0
VS3LISTP EQU   VS3AGL+8
VS3EXDSP EQU   VS3AGL+12
VS3LEVP  EQU   VS3AGL+16
VS3LEVLN EQU   VS3AGL+20
VS3AST   EQU   VS3AGL+22
VS3EXPIR EQU   VS3AGL+24
VS3CREAT EQU   VS3AGL+28
VS3UCBP  EQU   VS3AGL+32
VS3DEV   EQU   VS3AGL+36
VS3POOL  EQU   VS3AGL+40
VS3VOL   EQU   VS3AGL+44
VS3DD    EQU   VS3AGL+50
VS3FLAGS EQU   VS3AGL+58
VS3SCR   EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDACBPT EQU   VSDSCR
VSDSCRFL EQU   VSDSCR+4
VSDCATLC EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDELEM  EQU   VSDBLOCK
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVOLCT EQU   VSDARRAY
VSDDSN   EQU   VSDARRAY+4
VSDVARY  EQU   VSDARRAY+48
VOL      EQU   0
VOLCNT   EQU   VOL
@NM00094 EQU   VOL+2
VOLVAL   EQU   @NM00094+1
GRP      EQU   0
GRPCNT   EQU   GRP
@NM00095 EQU   GRP+2
GRPVAL   EQU   @NM00095+1
AVOL     EQU   0
AGRP     EQU   0
NGRPD    EQU   0
GENER    EQU   0
LEVEL    EQU   0
LEVELPOS EQU   LEVEL+9
LEVELFLG EQU   LEVEL+10
LEVELLEN EQU   LEVEL+20
LEVELVAL EQU   LEVEL+21
UNCAT    EQU   0
EXPDT    EQU   0
EXPDTVAL EQU   EXPDT
EXPIR    EQU   0
EXPIRVAL EQU   EXPIR
CREDT    EQU   0
CREDTVAL EQU   CREDT
CREAT    EQU   0
CREATVAL EQU   CREAT
FILE     EQU   0
FILEVAL  EQU   FILE+1
SYSN     EQU   0
PURGE    EQU   0
EXVOL    EQU   0
EXVOLCNT EQU   EXVOL
@NM00096 EQU   EXVOL+2
EXVOLVAL EQU   @NM00096+1
EXDS     EQU   0
@NM00097 EQU   EXDS+2
EXDSFLG  EQU   @NM00097+10
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVGROUP EQU   RVVI+14
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVGPVOL EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVGSVOL EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVCPYTP EQU   RVVFLAGA+4
RVVSPEC  EQU   RVVFLAGA+5
RVVSGRP  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
GROUP    EQU   0
GRONAME  EQU   GROUP
GROVVGRP EQU   GRONAME+3
GROID    EQU   GRONAME+11
GROFLAGA EQU   GROUP+13
GROTYPE  EQU   GROFLAGA
GROFSN   EQU   GROUP+17
GRONGEN  EQU   GROUP+30
GRONRSTD EQU   GROUP+32
GROERRTS EQU   GROUP+56
BASEV    EQU   0
BASNAME  EQU   BASEV
BASSERNO EQU   BASNAME+5
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASLAST  EQU   BASFLAGA+3
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASNEXTV EQU   BASEV+56
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
CONVDATE EQU   0
CONVYEAR EQU   CONVDATE
CONVDAYS EQU   CONVDATE+2
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
DMPTRM   EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADQ0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARK0 EQU   0
IDCSARV0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
GDTRCK   EQU   GDTTBL+284
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00114 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00108 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASOWNER EQU   BASEV+134
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00107 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASIVCRE EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00106 EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASINAC  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASEVKEY EQU   BASNAME
@NM00105 EQU   GROUP+136
GROADDR  EQU   GROUP+106
GROOWNER EQU   GROUP+96
GRORESSP EQU   GROUP+95
GROCONUS EQU   GROUP+94
GRODESCR EQU   GROUP+64
GROERRTM EQU   GROERRTS+4
GROERRDT EQU   GROERRTS
GRORETPD EQU   GROUP+52
GROFREXT EQU   GROUP+48
GROFRESP EQU   GROUP+44
GROSTRSH EQU   GROUP+40
GROSSPD  EQU   GROUP+38
GROPSPD  EQU   GROUP+36
GRONINAC EQU   GROUP+34
GROPCENT EQU   GROUP+29
GROLSN   EQU   GROUP+23
@NM00104 EQU   GROFLAGA+2
GROMSG1  EQU   GROFLAGA+2
GRORETN  EQU   GROFLAGA+2
GRORLSE  EQU   GROFLAGA+2
GRORONLY EQU   GROFLAGA+2
GRODAERA EQU   GROFLAGA+2
GROEXCL  EQU   GROFLAGA+2
GROBIND  EQU   GROFLAGA+2
GRORES1  EQU   GROTYPE
GROGVR   EQU   GROTYPE
GROZERO  EQU   GROID+1
GROBLANK EQU   GROID
GROG     EQU   GRONAME
@NM00103 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSDTE  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
@NM00102 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVLBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
@NM00101 EQU   RVVCHAIN
@NM00100 EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVRDSEQ EQU   RVVI+43
RVVBLNK1 EQU   RVVI+42
RVVCDATE EQU   RVVI+38
RVVEXPIR EQU   RVVI+36
@NM00099 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
@NM00098 EQU   RVVOPCOD+1
EXDSVAL  EQU   @NM00097+21
EXDSLEN  EQU   @NM00097+20
EXDSMEM  EQU   @NM00097+12
EXDSMLN  EQU   @NM00097+11
EXDSFUQ  EQU   EXDSFLG
EXDSPOS  EQU   @NM00097+9
EXDSPAS  EQU   @NM00097+1
EXDSPLN  EQU   @NM00097
EXDSCNT  EQU   EXDS
EXVOLLEN EQU   @NM00096
FILELEN  EQU   FILE
LEVELMEM EQU   LEVEL+12
LEVELMLN EQU   LEVEL+11
LEVELFUQ EQU   LEVELFLG
LEVELPAS EQU   LEVEL+1
LEVELPLN EQU   LEVEL
GRPLEN   EQU   @NM00095
VOLLEN   EQU   @NM00094
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00093 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00092 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00091 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00090 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00089 EQU   VSDSCR+5
@NM00088 EQU   VSDSCRFL
@NM00087 EQU   VSDSTAT+29
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00086 EQU   VSDFLG2
VSDRACF  EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00085 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00084 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00083 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00082 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00081 EQU   VSDVTOC
@NM00080 EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3HEAD  EQU   VS3AGL
@NM00079 EQU   DATESOPT
@NM00078 EQU   SELFLAGS
SELHEAD  EQU   SELAGL
@NM00077 EQU   UCTFLAGS
UCTHEAD  EQU   UCTAGL
@NM00076 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00073 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00072 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00071 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00070 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00069 EQU   RCTAGL+10
@NM00068 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00067 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00066 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00065 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00064 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00063 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00062 EQU   VS2AGL+45
VSDDNAME EQU   VS2AGL+37
@NM00061 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00060 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00059 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00058 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00057 EQU   EXSPACE+8
@NM00056 EQU   EXSPACE+6
@NM00055 EQU   EXSPACE+4
@NM00054 EQU   EXSPACE+1
@NM00053 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00052 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00051 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00050 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00049 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00048 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00047 EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00046 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00045 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00044 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00043 EQU   CMMSG+7
@NM00042 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00041 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00040 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00039 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00038 EQU   DMPITM+15
DMPITMTP EQU   DMPITM+14
DMPITMLN EQU   DMPITM+12
DMPITMPT EQU   DMPITM+8
DMPITMNM EQU   DMPITM
@NM00037 EQU   ERCNVTAB+24
ERDARBPT EQU   ERCPLPT
ERDYNRC  EQU   ERCATRC
ERDSNM   EQU   ERCNVTAB+12
@NM00036 EQU   ERCNVTAB+4
@NM00035 EQU   ERCNVTAB+3
@NM00034 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00033 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00032 EQU   ERTYPE
ERDYNAL  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00031 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00030 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00029 EQU   FMTFLGS+1
FMTSMSG  EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00028 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
@NM00027 EQU   IOINFOPT
IOINFLUB EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
OPNSTRNO EQU   OPNAGL+43
@NM00026 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00025 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00024 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
OPNTYPSY EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00023 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCTSML  EQU   IOCREL+2
IOCTPML  EQU   IOCREL
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00022 EQU   IOCMSG
IOCMSGSM EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
IOCCHPKG EQU   IOCMSG
IOCCHPKE EQU   IOCMSG
IOCCHPNU EQU   IOCCHP
IOCCHPUP EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
IOCMACNT EQU   IOCMAC2
IOCMACER EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
IOCMACEN EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00021 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00020 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00019 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00018 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00017+1
UNITCHA  EQU   @NM00017
UNITUCB  EQU   UNITABL
RACFVOLS EQU   RACFAGL+16
RACFCLN  EQU   RACFAGL+12
RACFPROF EQU   RACFAGL+8
RACFENT  EQU   RACFAGL+4
@NM00016 EQU   RACFFLG4
@NM00015 EQU   RACFFLG3
RACFPRF  EQU   RACFFLG3
@NM00014 EQU   RACFFLG3
@NM00013 EQU   RACFFLG2
RACFTRD  EQU   RACFFLG2
RACFTUPD EQU   RACFFLG2
RACFTCTL EQU   RACFFLG2
@NM00012 EQU   RACFFLG2
RACFTALT EQU   RACFFLG2
RACFCSA  EQU   RACFFLG1
RACFLOGN EQU   RACFFLG1
RACFLOGF EQU   RACFFLG1
@NM00011 EQU   RACFFLG1
RACFDSTV EQU   RACFFLG1
@NM00010 EQU   RACFFLG1
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00438 EQU   @RC00431
@RF00445 EQU   @RC00431
@RC00513 EQU   @RC00512
@RC00599 EQU   @RC00598
@RC00639 EQU   @RC00631
@RC00701 EQU   @RC00700
@RF00887 EQU   @RC00846
@RF01043 EQU   @RC01032
@RC01129 EQU   @RC01125
@RC01127 EQU   @RC01125
@RC01171 EQU   @RC01169
@RC01178 EQU   @RC01169
@RC01332 EQU   @RC01331
@RC01358 EQU   @RC01352
@RC01353 EQU   @RC01352
@RF01433 EQU   @RC01418
@PB00014 EQU   @EL00001
@RC00522 EQU   @RC00513
@RC00520 EQU   @RC00513
@RC00642 EQU   @RC00639
@RC00640 EQU   @RC00639
@RC00710 EQU   @RC00701
@RC00708 EQU   @RC00701
@PB00013 EQU   @PB00014
@RF00529 EQU   @RC00522
@RF00717 EQU   @RC00710
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCSD01,(C'PLS1913',0603,76306)

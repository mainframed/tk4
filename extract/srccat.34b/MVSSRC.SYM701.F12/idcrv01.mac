         TITLE '*********** IDCRV01:  RECOVERV FUNCTION SUPPORT ROUTINE*
               E *******'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCRV01  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IDCRV01   76.340'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @10,0                                               0002
@PSTART  LA    @12,4095(,@10)                                      0002
         USING @PSTART,@10                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         MVC   @PC00001(12),0(@01)                                 0002
*                                      /* INCOMPLETE COPY    @Y30LB39*/
*                                      /* FLAG COULD NOT BE  @Y30LB39*/
*                                      /* CLEARED.           @Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THIS IS CENTRAL SECTION OF THE RECOVERV ROUTINE.@Y30LB39*/
*        /*  IT PERFORMS INITIALIZATION AND TERMINATION      @Y30LB39*/
*        /*  FUNCTIONS AND ROUTES CONTROL TO SUB-PROCEDURES. @Y30LB39*/
*        /*  THE EXIT FROM IDCRV01 OCCURS FROM HERE.         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV ROUTINE         @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0257
         L     @15,@PC00001                                        0257
         L     @14,GDTTR2(,@15)                                    0257
         MVC   @TS00001(95),NEWERID2(@14)                          0257
         MVC   OLDERID2(95,@14),@TS00001                           0257
*        NEWID2 = 'RVST';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@14),@CC01505                              0258
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA    @Y30LB39*/
*        /*  PRIOR TO SERVICING RECOVERV UTILITY REQUEST     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       0259
*          THEN;                                                   0259
         L     @15,GDTDBG(,@15)                                    0259
         LTR   @15,@15                                             0259
         BZ    @RT00259                                            0259
*          ELSE                                                    0261
*            CALL IDCDB010 (GDTTBL,'RVBG');                        0261
         L     @15,@PC00001                                        0261
         ST    @15,@AL00001                                        0261
         LA    @14,@CC01506                                        0261
         ST    @14,@AL00001+4                                      0261
         MVI   @AL00001+4,X'80'                                    0261
         L     @15,GDTDBG(,@15)                                    0261
         LA    @01,@AL00001                                        0261
         BALR  @14,@15                                             0261
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*      INITIALIZE THE PRINT ARGUMENT LIST          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DDSTRU = ADDR(PRINTTAB);                          /*@Y30LB39*/
@RT00259 LA    @07,PRINTTAB                                        0262
         ST    @07,DDSTRU                                          0262
*        PRINTTAB = ''B;                                   /*@Y30LB39*/
         XC    PRINTTAB(44),PRINTTAB                               0263
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /* THE NEXT SECTION OF CODE ESTABLISHES ADDRESS-    @Y30LB39*/
*        /* ABILITY TO THE VARIOUS ARGUMENT AND PARAMETER    @Y30LB39*/
*        /* LISTS WHICH ARE USED BY IDCRV01 IN SERVICING     @Y30LB39*/
*        /* THE RECOVERV FSR REQUEST.                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RFY ALLAGL BASED(ADDR(ALLAGLBF));                 /*@Y30LB39*/
*        RFY CKAGL BASED(ADDR(CKAGLBUF));                  /*@Y30LB39*/
*        RFY VS1AGL BASED(ADDR(VS1AGLBF));                 /*@Y30LB39*/
*        RFY VS2AGL BASED(ADDR(VS2AGLBF));                 /*@Y30LB39*/
*        RFY EXCLAGL BASED(ADDR(EXCLAGLB));                /*@ZD00175*/
*        RFY MDAGL BASED(ADDR(MDAGLBUF));                  /*@Y30LB39*/
*        COVCEPTR = ADDR(COVCEBUF);                        /*@Y30LB39*/
         LA    @07,COVCEBUF                                        0270
         ST    @07,COVCEPTR                                        0270
*        MVRPTR = ADDR(MVRBUFR);                           /*@Y30LB39*/
         LA    @07,MVRBUFR                                         0271
         ST    @07,MVRPTR                                          0271
*        RVVIPTR = ADDR(RVVIBUFR);                         /*@Y30LB39*/
         LA    @07,RVVIBUFR                                        0272
         ST    @07,RVVIPTR                                         0272
*        COVCPTR = ADDR(COVLISTB);                         /*@Y30LB39*/
         LA    @07,COVLISTB                                        0273
         ST    @07,COVCPTR                                         0273
*        BASEVPTR = ADDR(BASVOLBD);                        /*@Y30LB39*/
         LA    BASEVPTR,BASVOLBD                                   0274
*        COPYVPTR = ADDR(COPVOLBD);                        /*@Y30LB39*/
         LA    COPYVPTR,COPVOLBD                                   0275
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /* SET THE INTERNAL TABLE USED BY THIS MODULE       @Y30LB39*/
*        /* TO ZEROES.  ALL FLAGS ARE THEREBY INITIALIZED    @Y30LB39*/
*        /* TO OFF.                                          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RECVTBL = ''B;                                    /*@Y30LB39*/
         XC    RECVTBL(25),RECVTBL                                 0276
*        RECVTBC = 'RECVTBL ';                             /*@Y30LB39*/
         MVC   RECVTBC(8),@CC01520                                 0277
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE MOUNT-DEMOUNT ARGUMENT LIST TO ZEROES   @Y30LB39*/
*        /*  SINCE THE LOGIC IN VPREPRTN SUBROUTINE          @Y30LB39*/
*        /*  DEPENDS ON THIS INITIALIZATION.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        MDAGL = ''B;                                      /*@Y30LB39*/
         LA    @07,MDAGLBUF                                        0278
         XC    MDAGL(37,@07),MDAGL(@07)                            0278
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET UP KEYWORD PARAMETERS FOR UENQ MACRO        @Y30LB39*/
*        /*  TO ENQUEUE ON THE VOLUME SERIAL NUMBER          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RNAMLNTH = LENGTH(RNAMCHAR);                      /*@Y30LB39*/
         MVI   RNAMLNTH,X'16'                                      0279
*        RNAMCHAR(1:6) = TVOLVAL;                          /*@Y30LB39*/
         L     @07,@PC00001+4                                      0280
         L     @07,FDTPTR+4(,@07)                                  0280
         MVC   RNAMCHAR(6),TVOLVAL(@07)                            0280
*        RNAMCHAR(7:22) = '.VIRTUAL.ENQUEUE';              /*@Y30LB39*/
         MVC   RNAMCHAR+6(16),@CC01521                             0281
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /* ISSUE UENQ MACRO TO ENQUEUE ON THE VOLUME SERIAL @Y30LB39*/
*        /* NUMBER TO INSURE THAT THE VOLUME RECORD IS NOT   @Y30LB39*/
*        /* UPDATED DURING RECOVERV PROCESSING.              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        CALL IDCSANQ0 (GDTTBL,EXCL,WAIT,'SYSZAMS ',MINORNAM);/*   0282
*                                                            @Y30LB39*/
         MVC   @AL00001+4(12),@AL00282                             0282
         L     @07,@PC00001                                        0282
         ST    @07,@AL00001                                        0282
         LA    @04,MINORNAM                                        0282
         ST    @04,@AL00001+16                                     0282
         MVI   @AL00001+16,X'80'                                   0282
         L     @15,GDTENQ(,@07)                                    0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CALL SETUPRTN FOR THE CHECK OUT THAT IS         @Y30LB39*/
*        /*  REQUIRED BEFORE THE COPY IS PERFORMED.          @Y30LB39*/
*        /*  THIS INVOLVES CHECKING OUT THE SOURCE AND       @Y30LB39*/
*        /*  TARGET VOLUMES AND THE ALLOCATED UNIT.          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        CALL SETUPRTN;                                    /*@Y30LB39*/
         BAL   @14,SETUPRTN                                        0283
*        RESPECIFY RTNREG RSTD;                                    0284
*        TESTRC = RTNREG;                                          0285
         LR    TESTRC,RTNREG                                       0285
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*        LASTCOND = TESTRC;                                /*@Y30LB39*/
         L     @07,@PC00001+8                                      0287
         STH   TESTRC,LASTCOND(,@07)                               0287
*        IF LASTCOND = 0 THEN                                      0288
         L     @07,@PC00001+8                                      0288
         LH    @07,LASTCOND(,@07)                                  0288
         LTR   @07,@07                                             0288
         BNZ   @RF00288                                            0288
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL COPYRTN TO DIRECT THE COPY VOLUME      @Y30LB39*/
*            /*  OPERATION WHICH INVOLVES DEMOUNTING THE     @Y30LB39*/
*            /*  TARGET, PERFORMING THE COPY, AND CLEARING   @Y30LB39*/
*            /*  THE INCOMPLETE-COPY FLAG IF THE TARGET      @Y30LB39*/
*            /*  VOLUME SERIAL NUMBER REQUIRES NO UPDATING.  @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL COPYRTN;                                 /*@Y30LB39*/
         BAL   @14,COPYRTN                                         0290
*            RESPECIFY RTNREG RSTD;                                0291
*            TESTRC = RTNREG;                                      0292
         LR    TESTRC,RTNREG                                       0292
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                                   0294
         LTR   TESTRC,TESTRC                                       0294
         BZ    @RF00294                                            0294
*              LASTCOND = LASTCC12;                        /*@Y30LB39*/
         L     @15,@PC00001+8                                      0295
         MVC   LASTCOND(2,@15),@CH00567                            0295
*            ELSE                                                  0296
*              IF BASOWNER ^= COPOWNER × TVOLVAL ^= FVOLVAL THEN   0296
         B     @RC00294                                            0296
@RF00294 CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            0296
         BNE   @RT00296                                            0296
         L     @04,@PC00001+4                                      0296
         L     @01,FDTPTR+4(,@04)                                  0296
         L     @04,FDTPTR(,@04)                                    0296
         CLC   TVOLVAL(6,@01),FVOLVAL(@04)                         0296
         BE    @RF00296                                            0296
@RT00296 DS    0H                                                  0297
*                DO;                                       /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                  /**************************************************/
*                  /*                                        @Y30LB39*/
*                  /*  CALL LABELRTN TO DIRECT THE VOLUME    @Y30LB39*/
*                  /*  LABEL UPDATE OPERATION.  THIS OPERA-  @Y30LB39*/
*                  /*  TION INVOLVES MOUNTING THE TARGET,    @Y30LB39*/
*                  /*  PERFORMING THE SOFTWARE LABEL UPDATE  @ZD00175*/
*                  /*  AND CLEARING THE INCOMPLETE-COPY      @ZD00175*/
*                  /*  FLAG IF THE TARGET VOLUME SERIAL      @Y30LB39*/
*                  /*  NUMBER WAS UPDATED.                   @ZD00175*/
*                  /*                                        @Y30LB39*/
*                  /**************************************************/
*                                                          /*@Y30LB39*/
*                  CALL LABELRTN;                          /*@Y30LB39*/
         BAL   @14,LABELRTN                                        0298
*                  RESPECIFY RTNREG RSTD;                          0299
*                  TESTRC = RTNREG;                                0300
         LR    TESTRC,RTNREG                                       0300
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/
*                  IF TESTRC ^= 0 THEN                             0302
         LTR   TESTRC,TESTRC                                       0302
         BZ    @RF00302                                            0302
*                    IF FVOLVAL = TVOLVAL THEN                     0303
         L     @15,@PC00001+4                                      0303
         L     @01,FDTPTR(,@15)                                    0303
         L     @15,FDTPTR+4(,@15)                                  0303
         CLC   FVOLVAL(6,@01),TVOLVAL(@15)                         0303
         BNE   @RF00303                                            0303
*                                                          /*@Y30LB39*/
*                      /**********************************************/
*                      /*                                    @Y30LB39*/
*                      /*  NO SERIAL NUMBER UPDATE WAS       @Y30LB39*/
*                      /*  REQUIRED.  IN THIS CASE, ONLY     @Y30LB39*/
*                      /*  THE OWNER DATE COULD NOT BE       @Y30LB39*/
*                      /*  RESTORED.                         @Y30LB39*/
*                      /*                                    @Y30LB39*/
*                      /**********************************************/
*                                                          /*@Y30LB39*/
*                      LASTCOND = MAX(LASTCOND,LASTCC08);  /*@Y30LB39*/
         L     @15,@PC00001+8                                      0304
         LH    @14,LASTCOND(,@15)                                  0304
         LA    @09,8                                               0304
         CR    @14,@09                                             0304
         BNL   *+6
         LR    @14,@09                                             0304
         STH   @14,LASTCOND(,@15)                                  0304
*                    ELSE                                          0305
*                                                          /*@Y30LB39*/
*                      /**********************************************/
*                      /*                                    @Y30LB39*/
*                      /*  EITHER THE VOLUME SERIAL NUMBER   @Y30LB39*/
*                      /*  UPDATE FAILED OR THE INCOMPLETE   @Y30LB39*/
*                      /*  COPY FLAG COULD NOT BE CLEARED.   @Y30LB39*/
*                      /*                                    @Y30LB39*/
*                      /**********************************************/
*                                                          /*@Y30LB39*/
*                      LASTCOND = MAX(LASTCOND,LASTCC12);  /*@Y30LB39*/
         B     @RC00303                                            0305
@RF00303 L     @15,@PC00001+8                                      0305
         LH    @14,LASTCOND(,@15)                                  0305
         LA    @09,12                                              0305
         CR    @14,@09                                             0305
         BNL   *+6
         LR    @14,@09                                             0305
         STH   @14,LASTCOND(,@15)                                  0305
*                END;                                      /*@Y30LB39*/
*                                                                  0306
*               /*****************************************************/
*               /*                                           @ZD00175*/
*               /* IF THE VOLUME HAS BEEN DEMOUNTED, REMOUNT THE     */
*               /* TARGET VOLUME.  THE SECURITY CHECK PERFORMED BY   */
*               /* IDCVS01 MAY HAVE RESULTED IN DYNAMIC ALLOCATION   */
*               /* OF THE CATALOG AND THE CATALOG IS STILL OPEN.     */
*               /*                                           @ZD00175*/
*               /*****************************************************/
*                                                                  0307
*               ELSE                                               0307
*                 IF DEMNTFLG=ON THEN                              0307
         B     @RC00296                                            0307
@RF00296 TM    DEMNTFLG,B'00000100'                                0307
         BNO   @RF00307                                            0307
*                   DO;                                    /*@ZD00175*/
*                     MOUNTFLG=ON;                         /*@ZD00175*/
*                     WAITFLG=OFF;                         /*@ZD00175*/
         OI    MOUNTFLG,B'00100000'                                0310
         NI    WAITFLG,B'11101111'                                 0310
*                     CALL VPREPRTN;                       /*@ZD00175*/
         BAL   @14,VPREPRTN                                        0311
*                     RESPECIFY RTNREG RSTD;                       0312
*                     TESTRC = RTNREG;                             0313
         LR    TESTRC,RTNREG                                       0313
*                     RESPECIFY RTNREG UNRSTD;             /*@ZD00175*/
*                                                                  0314
*                     /***********************************************/
*                     /*                                     @ZD00175*/
*                     /* IF THE TARGET VOLUME COULD NOT BE REMOUNTED, *
*                     /* UPDATE THE FINAL CONDITION CODE.    @ZD00175*/
*                     /*                                     @ZD00175*/
*                     /***********************************************/
*                                                                  0315
*                     IF TESTRC^=0 THEN                            0315
         LTR   TESTRC,TESTRC                                       0315
         BZ    @RF00315                                            0315
*                       LASTCOND=MAX(LASTCOND,LASTCC04);   /*@ZD00175*/
         L     @15,@PC00001+8                                      0316
         LH    @14,LASTCOND(,@15)                                  0316
         LA    @09,4                                               0316
         CR    @14,@09                                             0316
         BNL   *+6
         LR    @14,@09                                             0316
         STH   @14,LASTCOND(,@15)                                  0316
*                   END;                                   /*@ZD00175*/
@RF00315 DS    0H                                                  0318
*          END;                                            /*#Y30LB39*/
@RF00307 DS    0H                                                  0318
@RC00296 DS    0H                                                  0318
@RC00294 DS    0H                                                  0319
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CHECK TO SEE IF A MINOR ERROR OCCURED           @Y30LB39*/
*        /*  DURING THE PROCESSING OF THE RECOVERV REQUEST.  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF LASTCOND < LASTCC04 & CC04FLG = ON THEN                0319
@RF00288 LA    @15,4                                               0319
         L     @14,@PC00001+8                                      0319
         CH    @15,LASTCOND(,@14)                                  0319
         BNH   @RF00319                                            0319
         TM    CC04FLG,B'01000000'                                 0319
         BNO   @RF00319                                            0319
*          LASTCOND = LASTCC04;                            /*@Y30LB39*/
         STH   @15,LASTCOND(,@14)                                  0320
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE DEQUEUE MACRO TO RELEASE ENQUEUE SET AT   @Y30LB39*/
*        /*  BEGINNING OF PROGRAM.                           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RNAMCHAR(1:6) = TVOLVAL;                          /*@Y30LB39*/
@RF00319 L     @15,@PC00001+4                                      0321
         L     @01,FDTPTR+4(,@15)                                  0321
         MVC   RNAMCHAR(6),TVOLVAL(@01)                            0321
*        RNAMCHAR(7:22) = '.VIRTUAL.ENQUEUE';              /*@ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01521                             0322
*        CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);       /*@Y30LB39*/
         L     @15,@PC00001                                        0323
         ST    @15,@AL00001                                        0323
         LA    @14,@CC01523                                        0323
         ST    @14,@AL00001+4                                      0323
         LA    @14,MINORNAM                                        0323
         ST    @14,@AL00001+8                                      0323
         MVI   @AL00001+8,X'80'                                    0323
         L     @15,GDTDEQ(,@15)                                    0323
         LA    @01,@AL00001                                        0323
         BALR  @14,@15                                             0323
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UPRINT TO PRINT THE APPROPRIATE           @Y30LB39*/
*        /*  COMPLETION MESSAGE.                             @Y30LB39*/
*        /*  MESSAGE IDC3003I IF CONDITION CODE GREATER      @Y30LB39*/
*        /*  THAN EIGHT                                      @Y30LB39*/
*        /*  MESSAGE IDC0001I IF CONDITION CODE LESS THAN    @Y30LB39*/
*        /*  OR EQUAL TO EIGHT.                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DARGLIST = ''B;                                   /*@Y30LB39*/
         L     @15,DDSTRU                                          0324
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0324
*        IF LASTCOND > LASTCC08 THEN                               0325
         L     @14,@PC00001+8                                      0325
         LH    @14,LASTCOND(,@14)                                  0325
         C     @14,@CF00178                                        0325
         BNH   @RF00325                                            0325
*          DARGSENT = MSG3003I;                            /*@Y30LB39*/
         MVI   DARGSENT(@15),X'03'                                 0326
*        ELSE                                                      0327
*          DARGSENT = MSG0001I;                            /*@Y30LB39*/
         B     @RC00325                                            0327
@RF00325 L     @01,DDSTRU                                          0327
         MVI   DARGSENT(@01),X'01'                                 0327
*        DARGSMOD = UNIVMSG;                               /*@Y30LB39*/
@RC00325 L     @15,DDSTRU                                          0328
         MVC   DARGSMOD(3,@15),@CC01462                            0328
*        DARGDBP = ADDR(LASTCOND);                         /*@Y30LB39*/
         L     @14,@PC00001+8                                      0329
         ST    @14,DARGDBP(,@15)                                   0329
*        DARGILP = LENGTH (LASTCOND);                      /*@Y30LB39*/
         MVC   DARGILP(2,@15),@CH00152                             0330
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);            /*@Y30LB39*/
         L     @15,@PC00001                                        0331
         ST    @15,@AL00001                                        0331
         LA    @14,@CF00114                                        0331
         ST    @14,@AL00001+4                                      0331
         LA    @14,DDSTRU                                          0331
         ST    @14,@AL00001+8                                      0331
         MVI   @AL00001+8,X'80'                                    0331
         L     @15,GDTPRT(,@15)                                    0331
         LA    @01,@AL00001                                        0331
         BALR  @14,@15                                             0331
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA    @Y30LB39*/
*        /*  PRIOR TO RETURNING TO EXECUTIVE ROUTINE.        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       0332
*          THEN;                                                   0332
         L     @15,@PC00001                                        0332
         L     @15,GDTDBG(,@15)                                    0332
         LTR   @15,@15                                             0332
         BZ    @RT00332                                            0332
*          ELSE                                                    0334
*            CALL IDCDB010 (GDTTBL,'RVND');                        0334
         L     @15,@PC00001                                        0334
         ST    @15,@AL00001                                        0334
         LA    @14,@CC01528                                        0334
         ST    @14,@AL00001+4                                      0334
         MVI   @AL00001+4,X'80'                                    0334
         L     @15,GDTDBG(,@15)                                    0334
         LA    @01,@AL00001                                        0334
         BALR  @14,@15                                             0334
*                                                          /*@Y30LB39*/
*          CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                   0335
@RT00332 L     @15,@PC00001                                        0335
         ST    @15,@AL00001                                        0335
         LA    @14,MODID                                           0335
         ST    @14,@AL00001+4                                      0335
         L     @14,@PC00001+8                                      0335
         ST    @14,@AL00001+8                                      0335
         MVI   @AL00001+8,X'80'                                    0335
         L     @15,GDTEPL(,@15)                                    0335
         LA    @01,@AL00001                                        0335
         BALR  @14,@15                                             0335
*       /*@Y30LB39*/                                               0336
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - SETUPRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  DIRECT THE CHECKING OUT OF SOURCE AND TARGET    @Y30LB39*/
*        /*  VOLUMES.  IT DOES THIS BY CALLING SUBROUTINES   @Y30LB39*/
*        /*  TO READ THE INVENTORY RECORDS, ALLOCATE UNIT    @Y30LB39*/
*        /*  AND MAKE SECURITY CHECK OF THE VOLUMES.  IF, AT @Y30LB39*/
*        /*  ANY TIME, IT RECEIVES A NON-ZERO RETURN CODE    @Y30LB39*/
*        /*  BACK FROM A PROCEDURE WHICH IT CALLS, IT WILL   @Y30LB39*/
*        /*  RETURN TO THE MAINLINE ROUTINE WHICH CALLED IT. @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - BUFFER FOR BASE VOLUME RECORD           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*     12 - IF CHECK OF SOURCE AND TARGET VOLUMES   @Y30LB39*/
*        /*          NOT OKAY OR                             @Y30LB39*/
*        /*          IF VTOC CHECK NOT OKAY OR               @Y30LB39*/
*        /*          IF UNABLE TO DYNAMICALLY ALLOCAT A UNIT @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0336
*SETUPRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0336
@EL00001 L     @13,4(,@13)                                         0336
@EF00001 L     @00,@SIZDATD                                        0336
         LR    @01,@11                                             0336
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0336
         BR    @14                                                 0336
SETUPRTN DS    0H                                                  0337
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL SETUPRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR1 = REG14;                                 /*@Y30LB39*/
         ST    REG14,RETADDR1                                      0338
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0339
         L     @07,@PC00001                                        0339
         L     @07,GDTTR2(,@07)                                    0339
         MVC   @TS00001(95),NEWERID2(@07)                          0339
         MVC   OLDERID2(95,@07),@TS00001                           0339
*        NEWID2 = 'RVSU';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@07),@CC01533                              0340
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        SETUPRC = LASTCC00;                               /*@Y30LB39*/
         MVI   SETUPRC,X'00'                                       0341
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CALL VOLCKRTN TO CHECK OUT THE SOURCE AND       @Y30LB39*/
*        /*  TARGET VOLUMES.                                 @Y30LB39*/
*        /*  IF THE RETURN CODE IS NOT ZERO, THEN EXIT       @Y30LB39*/
*        /*  VIA THE LAST STEP IN THIS SUBROUTINE.           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        CALL VOLCKRTN;                                    /*@Y30LB39*/
         BAL   @14,VOLCKRTN                                        0342
*        RESPECIFY RTNREG RSTD;                                    0343
*        TESTRC = RTNREG;                                          0344
         LR    TESTRC,RTNREG                                       0344
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       0346
         LTR   TESTRC,TESTRC                                       0346
         BZ    @RF00346                                            0346
*          SETUPRC = LASTCC12;                             /*@Y30LB39*/
         MVI   SETUPRC,X'0C'                                       0347
*        ELSE                                                      0348
*          DO;                                             /*@Y30LB39*/
         B     @RC00346                                            0348
@RF00346 DS    0H                                                  0349
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL ALLOCRTN TO DYNAMICALLY ALLOCATE A     @Y30LB39*/
*            /*  UNIT AND TO CHECK OUT THE UNIT OBTAINED     @Y30LB39*/
*            /*  EITHER DYNAMICALLY OR VIA THE FILE          @Y30LB39*/
*            /*  PARAMETER.  IF THE RETURN CODE IS NOT ZERO, @Y30LB39*/
*            /*  EXIT VIA THE LAST STEP IN THIS SUBROUTINE.  @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL ALLOCRTN;                                /*@Y30LB39*/
         BAL   @14,ALLOCRTN                                        0349
*            RESPECIFY RTNREG RSTD;                                0350
*            TESTRC = RTNREG;                                      0351
         LR    TESTRC,RTNREG                                       0351
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                                   0353
         LTR   TESTRC,TESTRC                                       0353
         BZ    @RF00353                                            0353
*              SETUPRC = LASTCC12;                         /*@Y30LB39*/
         MVI   SETUPRC,X'0C'                                       0354
*            ELSE                                                  0355
*              IF (BASIVCRE=OFF & BASIVCPY=OFF & BASVSMIS=OFF) THEN
         B     @RC00353                                            0355
@RF00353 TM    BASIVCRE(BASEVPTR),B'11100000'                      0355
         BNZ   @RF00355                                            0355
*                DO;                                       /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                  /**************************************************/
*                  /*                                        @Y30LB39*/
*                  /*  CALL VTOCKRTN IN ORDER TO MAKE THE    @Y30LB39*/
*                  /*  APPROPRIATE VTOC CHECK.               @Y30LB39*/
*                  /*                                        @Y30LB39*/
*                  /**************************************************/
*                                                          /*@Y30LB39*/
*                  CALL VTOCKRTN;                          /*@Y30LB39*/
         BAL   @14,VTOCKRTN                                        0357
*                  RESPECIFY RTNREG RSTD;                          0358
*                  TESTRC = RTNREG;                                0359
         LR    TESTRC,RTNREG                                       0359
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/
*                  IF TESTRC ^= 0 THEN                             0361
         LTR   TESTRC,TESTRC                                       0361
         BZ    @RF00361                                            0361
*                    SETUPRC = LASTCC12;                   /*@Y30LB39*/
         MVI   SETUPRC,X'0C'                                       0362
*                END;                                      /*@Y30LB39*/
@RF00361 DS    0H                                                  0364
*          END;                                            /*@Y30LB39*/
@RF00355 DS    0H                                                  0364
@RC00353 DS    0H                                                  0365
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR1;                                 /*@Y30LB39*/
@RC00346 L     REG14,RETADDR1                                      0365
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(SETUPRC);                             /*@Y30LB39*/
         SLR   @15,@15                                             0366
         IC    @15,SETUPRC                                         0366
@EL00002 DS    0H                                                  0366
@EF00002 DS    0H                                                  0366
@ER00002 BR    @14                                                 0366
*END SETUPRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - VOLCKRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  DIRECT THE RETRIEVAL OF THE INVENTORY RECORDS   @Y30LB39*/
*        /*  AND THE VOLUME CHECKOUT.  IT FIRST SPECIFIES    @Y30LB39*/
*        /*  THAT THE BASE VOLUME RECORD                     @Y30LB39*/
*        /*  IS TO BE RETRIEVED AND FOLLOWING THAT, IT       @Y30LB39*/
*        /*  RETRIEVES A COPY VOLUME RECORD.                 @Y30LB39*/
*        /*  THEN THE APPROPRIATE SUBROUTINE IS CALLED TO    @Y30LB39*/
*        /*  CHECK OUT THE STATUS OF THE SOURCE OR TARGET    @Y30LB39*/
*        /*  VOLUMES.                                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - RECVTBL                                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF RETURN CODE OF A CALLED SUBPROCEDURE @Y30LB39*/
*        /*          IS NOT ZERO.                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0368
*VOLCKRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0368
VOLCKRTN DS    0H                                                  0369
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL VOLCHKRC FIXED(8);        /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      0370
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0371
         L     @08,@PC00001                                        0371
         L     @08,GDTTR2(,@08)                                    0371
         MVC   @TS00001(95),NEWERID2(@08)                          0371
         MVC   OLDERID2(95,@08),@TS00001                           0371
*        NEWID2 = 'RVVO';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@08),@CC01541                              0372
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*      SET CONDITION CODE AND RETURN CODES TO ZERO @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VOLCHKRC = LASTCC00;                              /*@Y30LB39*/
         SLR   VOLCHKRC,VOLCHKRC                                   0373
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CALL RVVIRTN TO RETRIEVE THE APPROPRIATE        @Y30LB39*/
*        /*  COPY VOLUME RECORD FOR THE SOURCE VOLUME.       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RECTYPE = COPYCHAR;                               /*@Y30LB39*/
         MVC   RECTYPE(4),COPYCHAR                                 0374
*        CALL RVVIRTN;                                     /*@Y30LB39*/
         BAL   @14,RVVIRTN                                         0375
*        RESPECIFY RTNREG RSTD;                                    0376
*        TESTRC = RTNREG;                                          0377
         LR    TESTRC,RTNREG                                       0377
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       0379
         LTR   TESTRC,TESTRC                                       0379
         BZ    @RF00379                                            0379
*          VOLCHKRC = LASTCC04;                            /*@Y30LB39*/
         LA    VOLCHKRC,4                                          0380
*        ELSE                                                      0381
*          DO;                                             /*@Y30LB39*/
         B     @RC00379                                            0381
@RF00379 DS    0H                                                  0382
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL FVOLRTN TO VERIFY THAT THE SOURCE      @Y30LB39*/
*            /*  VOLUME IS USABLE.                           @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL FVOLRTN;                                 /*@Y30LB39*/
         BAL   @14,FVOLRTN                                         0382
*            RESPECIFY RTNREG RSTD;                                0383
*            TESTRC = RTNREG;                                      0384
         LR    TESTRC,RTNREG                                       0384
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                                   0386
         LTR   TESTRC,TESTRC                                       0386
         BZ    @RF00386                                            0386
*              VOLCHKRC = LASTCC04;                        /*@Y30LB39*/
         LA    VOLCHKRC,4                                          0387
*          END;                                            /*@Y30LB39*/
@RF00386 DS    0H                                                  0389
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CALL RVVIRTN TO RETRIEVE THE BASE VOLUME        @Y30LB39*/
*        /*  RECORD FOR THE TARGET VOLUME                    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RECTYPE = BASECHAR;                               /*@Y30LB39*/
@RC00379 MVC   RECTYPE(4),BASECHAR                                 0389
*        CALL RVVIRTN;                                     /*@Y30LB39*/
         BAL   @14,RVVIRTN                                         0390
*        RESPECIFY RTNREG RSTD;                                    0391
*        TESTRC = RTNREG;                                          0392
         LR    TESTRC,RTNREG                                       0392
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       0394
         LTR   TESTRC,TESTRC                                       0394
         BZ    @RF00394                                            0394
*          VOLCHKRC = LASTCC04;                            /*@Y30LB39*/
         LA    VOLCHKRC,4                                          0395
*        ELSE                                                      0396
*          DO;                                             /*@Y30LB39*/
         B     @RC00394                                            0396
@RF00394 DS    0H                                                  0397
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL TVOLRTN TO VERIFY THAT THE TARGET      @Y30LB39*/
*            /*  VOLUME IS USABLE.                           @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL TVOLRTN;                                 /*@Y30LB39*/
         BAL   @14,TVOLRTN                                         0397
*            RESPECIFY RTNREG RSTD;                                0398
*            TESTRC = RTNREG;                                      0399
         LR    TESTRC,RTNREG                                       0399
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                                   0401
         LTR   TESTRC,TESTRC                                       0401
         BZ    @RF00401                                            0401
*              VOLCHKRC = LASTCC04;                        /*@Y30LB39*/
         LA    VOLCHKRC,4                                          0402
*          END;                                            /*@Y30LB39*/
@RF00401 DS    0H                                                  0404
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RC00394 LR    REG14,RETADDR2                                      0404
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(VOLCHKRC);                            /*@Y30LB39*/
         LR    @15,VOLCHKRC                                        0405
@EL00003 DS    0H                                                  0405
@EF00003 DS    0H                                                  0405
@ER00003 BR    @14                                                 0405
*END VOLCKRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - RVVIRTN                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  RETRIEVE THE TYPE OF RECORD REQUESTED BY THE    @Y30LB39*/
*        /*  CALLER.                                         @Y30LB39*/
*        /*  ONCE THIS DETERMINATION HAS BEEN MADE BY        @Y30LB39*/
*        /*  EXAMINING THE CHARACTER TYPE SET IN THE RECOVERV@Y30LB39*/
*        /*  INTERNAL TABLE, THEN THE PARAMETER LIST IS      @Y30LB39*/
*        /*  SET UP AND MSVC IS INVOKED TO RETRIEVE THE      @Y30LB39*/
*        /*  RECORD.  IF THE RECORD COULD NOT BE RETRIEVED,  @Y30LB39*/
*        /*  THEN ONE OF THE FOLLOWING MESSAGES IS ISSUED.   @Y30LB39*/
*        /*  MESSAGE IDC2080I IF BASE RECORD IS NOT READ.    @Y30LB39*/
*        /*  MESSAGE IDC3081I IF COPY RECORD IS NOT READ.    @Y30LB39*/
*        /*  MESSAGE IDC3710I IF NO BACKUP COPY RECORD IS    @Y30LB39*/
*        /*  FOUND.                                          @Y30LB39*/
*        /*  MESSAGE IDC3712I IF LATEST BACKUP COPY NOT      @Y30LB39*/
*        /*  READ.                                           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          DYNAMIC ARGUMENT LIST                   @Y30LB39*/
*        /*          BASE VOLUME RECORD BUFFER               @Y30LB39*/
*        /*          COPY VOLUME RECORD BUFFER               @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*          AND BUFFER CONTAINS RECORD.             @Y30LB39*/
*        /*      4 - IF MSVC COULD NOT RETRIEVE RECORD.      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0407
*RVVIRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/
*                                                                  0407
RVVIRTN  DS    0H                                                  0408
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL RVVIRC FIXED(8);          /* RETURN CODE        @Y30LB39*/
*        DCL DATECHAR CHAR(4);         /* REQUIRED WHEN      @Y30LB39*/
*                                      /* CONVERTING DATE    @Y30LB39*/
*                                      /* VALUE.             @Y30LB39*/
*        DCL NOTFOUND FIXED(31) STATIC INIT(520);          /*@Y30LB39*/
*                                      /* RECORD NOT FOUND   @Y30LB39*/
*                                      /* CODE FROM USSC     @Y30LB39*/
*        DCL SEQ#DFLT FIXED(31) STATIC INIT(1);  /* SEQUENCE @Y30LB39*/
*                                      /* NUMBER DEFAULT     @Y30LB39*/
*                                      /* VALUE              @Y30LB39*/
*        DCL SEQ#XVAL FIXED(31);       /* FOR STORING THE    @Y30LB39*/
*                                      /* SEQUENCE NUMBER AS @Y30LB39*/
*                                      /* SPECIFIED OR THE   @Y30LB39*/
*                                      /* DEFAULT OF ONE.    @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR3 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR3,REG14                                      0413
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0414
         L     @15,@PC00001                                        0414
         L     @15,GDTTR2(,@15)                                    0414
         MVC   @TS00001(95),NEWERID2(@15)                          0414
         MVC   OLDERID2(95,@15),@TS00001                           0414
*        NEWID2 = 'RVRV';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@15),@CC01554                              0415
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RVVIRC = LASTCC00;                                /*@Y30LB39*/
         SLR   RVVIRC,RVVIRC                                       0416
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  INITIALIZE THE RVVI PARAMETER LIST FOR THE      @Y30LB39*/
*        /*  TYPE OF RECORD TO BE RETRIEVED.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RVVI = ''B;                                       /*@Y30LB39*/
         L     @15,RVVIPTR                                         0417
         XC    RVVI(68,@15),RVVI(@15)                              0417
*        RVVLNGTH = RVVLEN;                                /*@Y30LB39*/
         LH    @14,RVVLEN                                          0418
         ST    @14,RVVLNGTH(,@15)                                  0418
*        RVVCODE = RVVOP;                                  /*@Y30LB39*/
         MVI   RVVCODE(@15),X'87'                                  0419
*        RVVSVOL = ON;                                     /*@Y30LB39*/
         OI    RVVSVOL(@15),B'00000001'                            0420
*        RVVRDR = ON;                                      /*@Y30LB39*/
         OI    RVVRDR(@15),B'10000000'                             0421
*        IF RECTYPE = BASECHAR THEN                                0422
         CLC   RECTYPE(4),BASECHAR                                 0422
         BNE   @RF00422                                            0422
*          DO;                                             /*@Y30LB39*/
*            RVVOLUME = TVOLVAL;                           /*@Y30LB39*/
         L     @14,@PC00001+4                                      0424
         L     @01,FDTPTR+4(,@14)                                  0424
         MVC   RVVOLUME(6,@15),TVOLVAL(@01)                        0424
*            RVVRTBUF = BASEVPTR;                          /*@Y30LB39*/
         ST    BASEVPTR,RVVRTBUF(,@15)                             0425
*            RVVBUFLN = LENGTH (BASEV);                    /*@Y30LB39*/
         MVC   RVVBUFLN(2,@15),@CH01648                            0426
*            RVVBVRCD = ON;                                /*@Y30LB39*/
         OI    RVVBVRCD(@15),B'10000000'                           0427
*          END;                                            /*@Y30LB39*/
*        ELSE                                                      0429
*          DO;                                             /*@Y30LB39*/
         B     @RC00422                                            0429
@RF00422 DS    0H                                                  0430
*            RVVOLUME = FVOLVAL;                           /*@Y30LB39*/
         L     @15,RVVIPTR                                         0430
         L     @14,@PC00001+4                                      0430
         L     @01,FDTPTR(,@14)                                    0430
         MVC   RVVOLUME(6,@15),FVOLVAL(@01)                        0430
*            RVVRTBUF = COPYVPTR;                          /*@Y30LB39*/
         ST    COPYVPTR,RVVRTBUF(,@15)                             0431
*            RVVBUFLN = LENGTH (COPYV);                    /*@Y30LB39*/
         MVC   RVVBUFLN(2,@15),@CH01649                            0432
*            RVVCPYRC = ON;                                /*@Y30LB39*/
         OI    RVVCPYRC(@15),B'00100000'                           0433
*            IF ADDR (LBKUP) ^= NULLPTR THEN                       0434
         L     @14,FDTPTR+20(,@14)                                 0434
         LTR   @14,@14                                             0434
         BZ    @RF00434                                            0434
*              RVVLBKUP = ON;                              /*@Y30LB39*/
         OI    RVVLBKUP(@15),B'10000000'                           0435
*            ELSE                                                  0436
*              DO;                                         /*@Y30LB39*/
         B     @RC00434                                            0436
@RF00434 DS    0H                                                  0437
*                CVD (DATEVAL,DATECHAR);                   /*@Y30LB39*/
         L     @15,@PC00001+4                                      0437
         L     @01,FDTPTR+12(,@15)                                 0437
         L     @14,DATEVAL(,@01)                                   0437
         CVD   @14,@TS00001                                        0437
         MVC   DATECHAR(4),@TS00001+4                              0437
*                RVVCDATE = DATECHAR;                      /*@Y30LB39*/
         L     @14,RVVIPTR                                         0438
         MVC   RVVCDATE(4,@14),DATECHAR                            0438
*                RVVSDTE = ON;                             /*@Y30LB39*/
         OI    RVVSDTE(@14),B'00100000'                            0439
*                IF ADDR(SEQ#VAL) = NULLPTR THEN           /*@Y30LB39*/
         L     @15,FDTPTR+16(,@15)                                 0440
         LTR   @15,@15                                             0440
         BNZ   @RF00440                                            0440
*                  RVVRDSEQ = SEQ#DFLT;                    /*@Y30LB39*/
         MVC   RVVRDSEQ(1,@14),SEQ#DFLT+3                          0441
*                ELSE                                      /*@Y30LB39*/
*                  RVVRDSEQ = SEQ#VAL;                     /*@Y30LB39*/
         B     @RC00440                                            0442
@RF00440 L     @15,@PC00001+4                                      0442
         L     @01,FDTPTR+16(,@15)                                 0442
         L     @15,RVVIPTR                                         0442
         MVC   RVVRDSEQ(1,@15),SEQ#VAL+3(@01)                      0442
*                RVVSSEQ = ON;                             /*@Y30LB39*/
@RC00440 L     @15,RVVIPTR                                         0443
         OI    RVVSSEQ(@15),B'00010000'                            0443
*                SEQ#XVAL = RVVRDSEQ;                      /*@Y30LB39*/
         SLR   @14,@14                                             0444
         IC    @14,RVVRDSEQ(,@15)                                  0444
         ST    @14,SEQ#XVAL                                        0444
*            END;                                          /*@Y30LB39*/
*          END;                                            /*@Y30LB39*/
@RC00434 DS    0H                                                  0447
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE USSC TO READ THE SPECIFIED INVENTORY      @Y30LB39*/
*        /*  RECORD AFTER DUMPING RVVI PARAMETER LIST        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*                                                                  0447
*          IF GDTDBG = NULLPTR                                     0447
*            THEN;                                                 0447
@RC00422 L     @15,@PC00001                                        0447
         L     @15,GDTDBG(,@15)                                    0447
         LTR   @15,@15                                             0447
         BZ    @RT00447                                            0447
*            ELSE                                                  0449
*              DO;                                                 0449
*                DMPINDEX = ADDR(DUMPLIST);                        /*@Y
*0LB39*/                                                           0450
*                                                                  0450
         LA    DMPINDEX,DUMPLIST                                   0450
*                DMPITMNM = 'RVVI';                                0451
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0451
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0451
         MVC   DMPITMNM(4,DMPINDEX),@CC01556                       0451
*                DMPITMPT = ADDR(RVVI);                            0452
         L     @03,RVVIPTR                                         0452
         ST    @03,DMPITMPT(,DMPINDEX)                             0452
*                DMPITMLN = RVVLEN;                                0453
         LH    @03,RVVLEN                                          0453
         STH   @03,DMPITMLN(,DMPINDEX)                             0453
*                DMPITMTP = 'H';                                   0454
         MVI   DMPITMTP(DMPINDEX),C'H'                             0454
*                DMPINDEX = DMPINDEX + DMPELEMT;      /*@Y30LB39*/ 0455
*                                                                  0455
         AL    DMPINDEX,@CF00473                                   0455
*                DMPTRM = DMPTRMVL;                                0456
         MVI   DMPTRM(DMPINDEX),X'FF'                              0456
*              END;                                         /*@Y30LB39*
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       0458
*          THEN;                                                   0458
@RT00447 L     @15,@PC00001                                        0458
         L     @15,GDTDBG(,@15)                                    0458
         LTR   @15,@15                                             0458
         BZ    @RT00458                                            0458
*          ELSE                                                    0460
*            CALL IDCDB010 (GDTTBL,'RVRR',ADDR(DUMPLIST));         0460
         L     @15,@PC00001                                        0460
         ST    @15,@AL00001                                        0460
         LA    @14,@CC01558                                        0460
         ST    @14,@AL00001+4                                      0460
         LA    @14,DUMPLIST                                        0460
         ST    @14,@AFTEMPS                                        0460
         LA    @14,@AFTEMPS                                        0460
         ST    @14,@AL00001+8                                      0460
         MVI   @AL00001+8,X'80'                                    0460
         L     @15,GDTDBG(,@15)                                    0460
         LA    @01,@AL00001                                        0460
         BALR  @14,@15                                             0460
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        CALL IDCSASS0 (GDTTBL,VVIC,RVVIPTR,REASON);       /*@Y30LB39*/
*                                                                  0461
@RT00458 L     @02,@PC00001                                        0461
         ST    @02,@AL00001                                        0461
         LA    @15,VVIC                                            0461
         ST    @15,@AL00001+4                                      0461
         LA    @15,RVVIPTR                                         0461
         ST    @15,@AL00001+8                                      0461
         LA    @15,REASON                                          0461
         ST    @15,@AL00001+12                                     0461
         MVI   @AL00001+12,X'80'                                   0461
         L     @15,GDTSSC(,@02)                                    0461
         LA    @01,@AL00001                                        0461
         BALR  @14,@15                                             0461
*        RESPECIFY RTNREG RSTD;                                    0462
*        TESTRC = RTNREG;                                          0463
         LR    TESTRC,RTNREG                                       0463
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE READ RETURN CODE IS ZERO, THEN EXIT      @Y30LB39*/
*        /*  VIA THE LAST STEP IN THIS SUBROUTINE.           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       0465
         LTR   TESTRC,TESTRC                                       0465
         BZ    @RF00465                                            0465
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  SET CONDITION CODE TO FOUR AND CALL         @Y30LB39*/
*            /*  SSCMSG TO ISSUE THE APPROPRIATE REASON      @Y30LB39*/
*            /*  CODE.                                       @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            RVVIRC = LASTCC04;                            /*@Y30LB39*/
         LA    RVVIRC,4                                            0467
*            CALL SSCMSG(REASON);                          /*@Y30LB39*/
         LA    @15,REASON                                          0468
         ST    @15,@AL00001                                        0468
         LA    @01,@AL00001                                        0468
         BAL   @14,SSCMSG                                          0468
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE APPROPRIATE SECONDARY MESSAGE.        @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @15,DDSTRU                                          0469
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0469
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01460                            0470
*            IF RECTYPE = BASECHAR THEN                            0471
         CLC   RECTYPE(4),BASECHAR                                 0471
         BNE   @RF00471                                            0471
*              DO;                                         /*@Y30LB39*/
*                DARGSENT = MSG2080I;                      /*@Y30LB39*/
         MVI   DARGSENT(@15),X'1A'                                 0473
*                DARGDBP = ADDR (TVOLVAL);                 /*@Y30LB39*/
         L     @14,@PC00001+4                                      0474
         L     @14,FDTPTR+4(,@14)                                  0474
         LA    @03,TVOLVAL(,@14)                                   0474
         ST    @03,DARGDBP(,@15)                                   0474
*                DARGILP = TVOLLEN;                        /*@Y30LB39*/
         SLR   @03,@03                                             0475
         IC    @03,TVOLLEN(,@14)                                   0475
         STH   @03,DARGILP(,@15)                                   0475
*              END;                                        /*@Y30LB39*/
*            ELSE                                                  0477
*              IF ADDR(LBKUP) = NULLPTR THEN                       0477
         B     @RC00471                                            0477
@RF00471 L     @15,@PC00001+4                                      0477
         L     @15,FDTPTR+20(,@15)                                 0477
         LTR   @15,@15                                             0477
         BNZ   @RF00477                                            0477
*                DO;                                       /*@Y30LB39*/
*                  DARGSENT = MSG3081I;                    /*@Y30LB39*/
         L     @15,DDSTRU                                          0479
         MVI   DARGSENT(@15),X'19'                                 0479
*                  DARGDBP = ADDR(DATECHAR);               /*@Y30LB39*/
         LA    @14,DATECHAR                                        0480
         ST    @14,DARGDBP(,@15)                                   0480
*                  DARGILP = LENGTH(DATECHAR);             /*@Y30LB39*/
         LA    @14,4                                               0481
         STH   @14,DARGILP(,@15)                                   0481
*                  DARGCNT = 1;                            /*@Y30LB39*/
         LA    @03,1                                               0482
         STH   @03,DARGCNT(,@15)                                   0482
*                  DARGINS(1) = 1;                         /*@Y30LB39*/
         STH   @03,DARGINS(,@15)                                   0483
*                  DARGINL(1) = LENGTH(SEQ#XVAL);          /*@Y30LB39*/
         STH   @14,DARGINL(,@15)                                   0484
*                  DARGDTM(1) = ADDR(SEQ#XVAL);            /*@Y30LB39*/
         LA    @14,SEQ#XVAL                                        0485
         ST    @14,DARGDTM(,@15)                                   0485
*                END;                                      /*@Y30LB39*/
*              ELSE                                                0487
*                DO;                                       /*@Y30LB39*/
         B     @RC00477                                            0487
@RF00477 DS    0H                                                  0488
*                  DARGSMOD = RECVMSG;                     /*@Y30LB39*/
         L     @15,DDSTRU                                          0488
         MVC   DARGSMOD(3,@15),@CC01458                            0488
*                  IF REASON = NOTFOUND THEN                       0489
         CLC   REASON(4),NOTFOUND                                  0489
         BNE   @RF00489                                            0489
*                    DO;                                   /*@Y30LB39*/
*                      DARGSENT = MSG3710I;                /*@Y30LB39*/
         MVI   DARGSENT(@15),X'01'                                 0491
*                      DARGDBP = ADDR(FVOLVAL);            /*@Y30LB39*/
         L     @14,@PC00001+4                                      0492
         L     @14,FDTPTR(,@14)                                    0492
         LA    @03,FVOLVAL(,@14)                                   0492
         ST    @03,DARGDBP(,@15)                                   0492
*                      DARGILP = FVOLLEN;                  /*@Y30LB39*/
         SLR   @03,@03                                             0493
         IC    @03,FVOLLEN(,@14)                                   0493
         STH   @03,DARGILP(,@15)                                   0493
*                    END;                                  /*@Y30LB39*/
*                  ELSE                                            0495
*                    DARGSENT = MSG3712I;                  /*@Y30LB39*/
         B     @RC00489                                            0495
@RF00489 L     @01,DDSTRU                                          0495
         MVI   DARGSENT(@01),X'03'                                 0495
*                END;                                      /*@Y30LB39*/
@RC00489 DS    0H                                                  0497
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
@RC00477 DS    0H                                                  0497
@RC00471 L     @15,@PC00001                                        0497
         ST    @15,@AL00001                                        0497
         LA    @14,@CF00114                                        0497
         ST    @14,@AL00001+4                                      0497
         LA    @14,DDSTRU                                          0497
         ST    @14,@AL00001+8                                      0497
         MVI   @AL00001+8,X'80'                                    0497
         L     @15,GDTPRT(,@15)                                    0497
         LA    @01,@AL00001                                        0497
         BALR  @14,@15                                             0497
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR3;                                 /*@Y30LB39*/
@RF00465 LR    REG14,RETADDR3                                      0499
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(RVVIRC);                              /*@Y30LB39*/
         LR    @15,RVVIRC                                          0500
@EL00004 DS    0H                                                  0500
@EF00004 DS    0H                                                  0500
@ER00004 BR    @14                                                 0500
*END RVVIRTN;                                              /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - FVOLRTN                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  VERIFY THAT THE COPY VOLUME IS USABLE AND       @Y30LB39*/
*        /*  THAT BOTH OF THE CARTRIDGES ARE RESIDENT IN     @Y30LB39*/
*        /*  THE MASS STORAGE FACILITY.                      @Y30LB39*/
*        /*  IF ANY ERROR CONDITION IS FOUND THEN            @Y30LB39*/
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/
*        /*  ISSUED:                                         @Y30LB39*/
*        /*    IDC3096I IF VOLUME IS UNUSABLE                @Y30LB39*/
*        /*    IDC3067I IF VOLSERS DIFFER AND COPY VOLUME    @Y30LB39*/
*        /*    IS VSAM                                       @Y30LB39*/
*        /*    IDC2076I IF EITHER CARTRIDGE OUT OF MSF       @Y30LB39*/
*        /*    IDC0098I IF LOC OF MISSING CART IS KNOWN      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/
*        /*          DARGLIST                                @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF VOLUME FLAGGED INCOMPLETE, VOLUME    @Y30LB39*/
*        /*          SERIAL NUMBERS DIFFERENT & COPY IS VSAM,@Y30LB39*/
*        /*          OR CART IS OUT OF THE MSF.              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0502
*FVOLRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/
*                                                                  0502
FVOLRTN  DS    0H                                                  0503
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL FVOLRC FIXED(8);          /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR3 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR3,REG14                                      0504
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0505
         L     @08,@PC00001                                        0505
         L     @02,GDTTR2(,@08)                                    0505
         MVC   @TS00001(95),NEWERID2(@02)                          0505
         MVC   OLDERID2(95,@02),@TS00001                           0505
*        NEWID2 = 'RVFV';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@02),@CC01564                              0506
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*      SET CONDITION CODE AND RETURN CODES TO ZERO @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        FVOLRC = LASTCC00;                                /*@Y30LB39*/
         SLR   FVOLRC,FVOLRC                                       0507
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CHECK TO SEE IF THE VOLUME IS UNUSABLE          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF COPSATIA ^= TWOZERO THEN                               0508
         LH    @02,COPSATIA(,COPYVPTR)                             0508
         N     @02,@CF01669                                        0508
         LTR   @02,@02                                             0508
         BZ    @RF00508                                            0508
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  SET THE CONDTION CODE TO FOUR AND ISSUE     @Y30LB39*/
*            /*  MESSAGE IDC3096I                            @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/
         LA    FVOLRC,4                                            0510
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @02,DDSTRU                                          0511
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0511
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@02),@CC01460                            0512
*            DARGDBP = ADDR(FVOLVAL);                      /*@Y30LB39*/
         L     @15,@PC00001+4                                      0513
         L     @15,FDTPTR(,@15)                                    0513
         LA    @14,FVOLVAL(,@15)                                   0513
         ST    @14,DARGDBP(,@02)                                   0513
*            DARGILP = FVOLLEN;                            /*@Y30LB39*/
         SLR   @14,@14                                             0514
         IC    @14,FVOLLEN(,@15)                                   0514
         STH   @14,DARGILP(,@02)                                   0514
*            DARGSENT = MSG3096I;                          /*@Y30LB39*/
         MVI   DARGSENT(@02),X'08'                                 0515
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         ST    @08,@AL00001                                        0516
         LA    @02,@CF00114                                        0516
         ST    @02,@AL00001+4                                      0516
         LA    @02,DDSTRU                                          0516
         ST    @02,@AL00001+8                                      0516
         MVI   @AL00001+8,X'80'                                    0516
         L     @15,GDTPRT(,@08)                                    0516
         LA    @01,@AL00001                                        0516
         BALR  @14,@15                                             0516
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CHECK TO SEE IF THE VOLUME IS A VSAM VOLUME AND @Y30LB39*/
*        /*  WHETHER OR NOT THE TARGET VOLUME SERIAL NUMBER  @Y30LB39*/
*        /*  IS DIFFERENT.                                   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF COPVSAM = ON & FVOLVAL ^= TVOLVAL THEN                 0518
@RF00508 TM    COPVSAM(COPYVPTR),B'01000000'                       0518
         BNO   @RF00518                                            0518
         L     @08,@PC00001+4                                      0518
         L     @02,FDTPTR(,@08)                                    0518
         L     @08,FDTPTR+4(,@08)                                  0518
         CLC   FVOLVAL(6,@02),TVOLVAL(@08)                         0518
         BE    @RF00518                                            0518
*          DO;                                             /*@Y30LB39*/
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/
         LA    FVOLRC,4                                            0520
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @08,DDSTRU                                          0521
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0521
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@08),@CC01460                            0522
*            DARGSENT = MSG3067I;                          /*@Y30LB39*/
         MVI   DARGSENT(@08),X'2B'                                 0523
*            DARGDBP = ADDR(FVOLVAL);                      /*@Y30LB39*/
         LA    @15,FVOLVAL(,@02)                                   0524
         ST    @15,DARGDBP(,@08)                                   0524
*            DARGILP = FVOLLEN;                            /*@Y30LB39*/
         SLR   @15,@15                                             0525
         IC    @15,FVOLLEN(,@02)                                   0525
         STH   @15,DARGILP(,@08)                                   0525
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         L     @08,@PC00001                                        0526
         ST    @08,@AL00001                                        0526
         LA    @02,@CF00114                                        0526
         ST    @02,@AL00001+4                                      0526
         LA    @02,DDSTRU                                          0526
         ST    @02,@AL00001+8                                      0526
         MVI   @AL00001+8,X'80'                                    0526
         L     @15,GDTPRT(,@08)                                    0526
         LA    @01,@AL00001                                        0526
         BALR  @14,@15                                             0526
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CHECK TO SEE IF ONE OR BOTH OF THE CARTRIDGES   @Y30LB39*/
*        /*  ARE OUT OF THE MASS STORAGE FACILITY.  IF       @Y30LB39*/
*        /*  EITHER OR BOTH OF THE CARTRIDGES ARE, IN FACT,  @Y30LB39*/
*        /*  OUT OF THE MSF, THEN ISSUE THE SECONDARY        @Y30LB39*/
*        /*  MESSAGE WITH THE INSERTION OF ONE OR BOTH OF    @Y30LB39*/
*        /*  THE CSNS FOR THE MISSING CARTRIDGE(S).          @Y30LB39*/
*        /*  IF THE LOCATION OF THE MISSING CARTRIDGE IS     @Y30LB39*/
*        /*  KNOWN, THEN ISSUE MESSAGE IDC0098I TO GIVE      @Y30LB39*/
*        /*  THE LOCATION DATA.                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF COPLIB1 = HEXFF × COPLIB2 = HEXFF THEN         /*@Y30LB39*/
@RF00518 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0528
         BE    @RT00528                                            0528
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0528
         BNE   @RF00528                                            0528
@RT00528 DS    0H                                                  0529
*          DO;                                             /*@Y30LB39*/
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/
         LA    FVOLRC,4                                            0530
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE UPRINT FOR SECONDARY MESSAGE          @Y30LB39*/
*            /*  IDC2076I.  INSERT FROM THE COPY             @Y30LB39*/
*            /*  RECORD ONE OR BOTH CSNS AND THE             @Y30LB39*/
*            /*  COPY DATE.                                  @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @08,DDSTRU                                          0531
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0531
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@08),@CC01460                            0532
*            DARGSENT = MSG2076I;                          /*@Y30LB39*/
         MVI   DARGSENT(@08),X'1E'                                 0533
*            IF COPLIB1 = HEXFF & COPLIB2 = HEXFF THEN     /*@Y30LB39*/
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0534
         BNE   @RF00534                                            0534
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0534
         BNE   @RF00534                                            0534
*              DARGCNT = BOTHCSNS;                         /*@Y30LB39*/
         MVC   DARGCNT(2,@08),@CH00152                             0535
*            ELSE                                          /*@Y30LB39*/
*              DARGCNT = ONECSN;                           /*@Y30LB39*/
         B     @RC00534                                            0536
@RF00534 L     @08,DDSTRU                                          0536
         MVC   DARGCNT(2,@08),@CH00218                             0536
*            IF DARGCNT = BOTHCSNS THEN                    /*@Y30LB39*/
@RC00534 L     @08,DDSTRU                                          0537
         CLC   DARGCNT(2,@08),@CH00152                             0537
         BNE   @RF00537                                            0537
*              DO;                                         /*@Y30LB39*/
*                DARGILP = LENGTH(COPCSN1);                /*@Y30LB39*/
         LA    @02,12                                              0539
         STH   @02,DARGILP(,@08)                                   0539
*                DARGDBP = ADDR(COPCSN1);                  /*@Y30LB39*/
         LA    @15,COPCSN1(,COPYVPTR)                              0540
         ST    @15,DARGDBP(,@08)                                   0540
*                DARGINS(1) = 1;                           /*@Y30LB39*/
         MVC   DARGINS(2,@08),@CH00218                             0541
*                DARGINL(1) = LENGTH(COPCSN2);             /*@Y30LB39*/
         STH   @02,DARGINL(,@08)                                   0542
*                DARGDTM(1) = ADDR(COPCSN2);               /*@Y30LB39*/
         LA    @02,COPCSN2(,COPYVPTR)                              0543
         ST    @02,DARGDTM(,@08)                                   0543
*              END;                                        /*@Y30LB39*/
*            ELSE                                          /*@Y30LB39*/
*              IF COPLIB1 = HEXFF THEN                     /*@Y30LB39*/
         B     @RC00537                                            0545
@RF00537 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0545
         BNE   @RF00545                                            0545
*                DO;                                       /*@Y30LB39*/
*                  DARGILP = LENGTH(COPCSN1);              /*@Y30LB39*/
         L     @08,DDSTRU                                          0547
         MVC   DARGILP(2,@08),@CH00567                             0547
*                  DARGDBP = ADDR(COPCSN1);                /*@Y30LB39*/
         LA    @02,COPCSN1(,COPYVPTR)                              0548
         ST    @02,DARGDBP(,@08)                                   0548
*                END;                                      /*@Y30LB39*/
*              ELSE                                        /*@Y30LB39*/
*                DO;                                       /*@Y30LB39*/
         B     @RC00545                                            0550
@RF00545 DS    0H                                                  0551
*                  DARGILP = LENGTH(COPCSN2);              /*@Y30LB39*/
         L     @08,DDSTRU                                          0551
         MVC   DARGILP(2,@08),@CH00567                             0551
*                  DARGDBP = ADDR(COPCSN2);                /*@Y30LB39*/
         LA    @02,COPCSN2(,COPYVPTR)                              0552
         ST    @02,DARGDBP(,@08)                                   0552
*                END;                                      /*@Y30LB39*/
*            DARGINS(DARGCNT) = 2;                         /*@Y30LB39*/
@RC00545 DS    0H                                                  0554
@RC00537 L     @08,DDSTRU                                          0554
         LH    @02,DARGCNT(,@08)                                   0554
         SLA   @02,3                                               0554
         LA    @15,2                                               0554
         STH   @15,DARGINS-8(@02,@08)                              0554
*            DARGINL(DARGCNT) = LENGTH(COPDATE);           /*@Y30LB39*/
         LA    @15,4                                               0555
         STH   @15,DARGINL-8(@02,@08)                              0555
*            DARGDTM(DARGCNT) = ADDR(COPDATE);             /*@Y30LB39*/
         LA    @15,COPDATE(,COPYVPTR)                              0556
         ST    @15,DARGDTM-8(@02,@08)                              0556
*                                                          /*@Y30LB39*/
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         L     @08,@PC00001                                        0557
         ST    @08,@AL00001                                        0557
         LA    @02,@CF00114                                        0557
         ST    @02,@AL00001+4                                      0557
         LA    @02,DDSTRU                                          0557
         ST    @02,@AL00001+8                                      0557
         MVI   @AL00001+8,X'80'                                    0557
         L     @15,GDTPRT(,@08)                                    0557
         LA    @01,@AL00001                                        0557
         BALR  @14,@15                                             0557
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  IF COPDEST IS NOT BLANK, ISSUE UPRINT       @Y30LB39*/
*            /*  FOR SECONDARY MESSAGE IDC0098I    INSERT    @Y30LB39*/
*            /*  THE LOCATION DATA FROM THE COPY RECORD.     @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF COPDEST ^= THIRTYBK THEN                   /*@Y30LB39*/
         CLC   COPDEST(30,COPYVPTR),THIRTYBK                       0558
         BE    @RF00558                                            0558
*              DO;                                         /*@Y30LB39*/
*                DARGLIST = ''B;                           /*@Y30LB39*/
         L     @08,DDSTRU                                          0560
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0560
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/
         MVC   DARGSMOD(3,@08),@CC01460                            0561
*                DARGSENT = MSG0098I;                      /*@Y30LB39*/
         MVI   DARGSENT(@08),X'02'                                 0562
*                DARGDBP = ADDR(COPDEST);                  /*@Y30LB39*/
         LA    @02,COPDEST(,COPYVPTR)                              0563
         ST    @02,DARGDBP(,@08)                                   0563
*                DARGILP = LENGTH(COPDEST);                /*@Y30LB39*/
         MVC   DARGILP(2,@08),@CH01209                             0564
*                                                          /*@Y30LB39*/
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/
         L     @08,@PC00001                                        0565
         ST    @08,@AL00001                                        0565
         LA    @02,@CF00114                                        0565
         ST    @02,@AL00001+4                                      0565
         LA    @02,DDSTRU                                          0565
         ST    @02,@AL00001+8                                      0565
         MVI   @AL00001+8,X'80'                                    0565
         L     @15,GDTPRT(,@08)                                    0565
         LA    @01,@AL00001                                        0565
         BALR  @14,@15                                             0565
*                                                          /*@Y30LB39*/
*              END;                                        /*@Y30LB39*/
*          END;                                            /*@Y30LB39*/
@RF00558 DS    0H                                                  0568
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR3;                                 /*@Y30LB39*/
@RF00528 LR    REG14,RETADDR3                                      0568
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(FVOLRC);                              /*@Y30LB39*/
         LR    @15,FVOLRC                                          0569
@EL00005 DS    0H                                                  0569
@EF00005 DS    0H                                                  0569
@ER00005 BR    @14                                                 0569
*END FVOLRTN;                                              /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - TVOLRTN                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  VERIFY THAT THE TARGET VOLUME IS ACTIVE         @Y30LB39*/
*        /*  AND THAT IT IS, IN FACT, USABLE.  IF NOT, THEN  @Y30LB39*/
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/
*        /*  ISSUED:                                         @Y30LB39*/
*        /*    IDC3074I IF VOLUME IS INACTIVE                @Y30LB39*/
*        /*    IDC3097I IF VOLUME IS UNUSABLE - INCOMPLETE   @Y30LB39*/
*        /*             CREATE                               @Y30LB39*/
*        /*    IDC3095I IF VOLUME IS UNUSABLE - VOLSER       @Y30LB39*/
*        /*             MISMATCH                             @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF BASE VOLUME INACTIVE OR INCOMPLETE   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0571
*TVOLRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/
*                                                                  0571
TVOLRTN  DS    0H                                                  0572
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL TVOLRC FIXED(8);          /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR3 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR3,REG14                                      0573
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0574
         L     @08,@PC00001                                        0574
         L     @02,GDTTR2(,@08)                                    0574
         MVC   @TS00001(95),NEWERID2(@02)                          0574
         MVC   OLDERID2(95,@02),@TS00001                           0574
*        NEWID2 = 'RVTV';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@02),@CC01569                              0575
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*      SET CONDITION CODE TO ZERO                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        TVOLRC = LASTCC00;                                /*@Y30LB39*/
         SLR   TVOLRC,TVOLRC                                       0576
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /* CHECK TO SEE IF VOLUME IS FLAGGED AS INACTIVE.   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF BASINAC = ON THEN                                      0577
         TM    BASINAC(BASEVPTR),B'00000100'                       0577
         BNO   @RF00577                                            0577
*          DO;                                             /*@Y30LB39*/
*            TVOLRC = LASTCC04;                            /*@Y30LB39*/
         LA    TVOLRC,4                                            0579
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @02,DDSTRU                                          0580
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0580
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@02),@CC01460                            0581
*            DARGSENT = MSG3074I;                          /*@Y30LB39*/
         MVI   DARGSENT(@02),X'20'                                 0582
*            DARGDBP = ADDR(TVOLVAL);                      /*@Y30LB39*/
         L     @15,@PC00001+4                                      0583
         L     @15,FDTPTR+4(,@15)                                  0583
         LA    @14,TVOLVAL(,@15)                                   0583
         ST    @14,DARGDBP(,@02)                                   0583
*            DARGILP = TVOLLEN;                            /*@Y30LB39*/
         SLR   @14,@14                                             0584
         IC    @14,TVOLLEN(,@15)                                   0584
         STH   @14,DARGILP(,@02)                                   0584
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         ST    @08,@AL00001                                        0585
         LA    @02,@CF00114                                        0585
         ST    @02,@AL00001+4                                      0585
         LA    @02,DDSTRU                                          0585
         ST    @02,@AL00001+8                                      0585
         MVI   @AL00001+8,X'80'                                    0585
         L     @15,GDTPRT(,@08)                                    0585
         LA    @01,@AL00001                                        0585
         BALR  @14,@15                                             0585
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  TEST IF VOLUME IS UNUSABLE. AN ACCEPTABLE TARGET@Y30LB39*/
*        /*  VOLUME FOR THE RECOVER OPERATION MUST NOT BE    @Y30LB39*/
*        /*  FLAGGED AS INCOMPLETE UNLESS IT IS MARKED AS AN @Y30LB39*/
*        /*  INCOMPLETE COPY DUE TO A PREVIOUS COPY FAILURE. @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF BASIVCRE=ON × BASVSMIS=ON THEN                 /*@ZM30737*/
@RF00577 TM    BASIVCRE(BASEVPTR),B'10100000'                      0587
         BZ    @RF00587                                            0587
*          DO;                                             /*@Y30LB39*/
*            TVOLRC = LASTCC04;                            /*@Y30LB39*/
         LA    TVOLRC,4                                            0589
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @08,DDSTRU                                          0590
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0590
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@08),@CC01460                            0591
*            DARGDBP = ADDR(TVOLVAL);                      /*@Y30LB39*/
         L     @02,@PC00001+4                                      0592
         L     @02,FDTPTR+4(,@02)                                  0592
         LA    @15,TVOLVAL(,@02)                                   0592
         ST    @15,DARGDBP(,@08)                                   0592
*            DARGILP = TVOLLEN;                            /*@Y30LB39*/
         SLR   @15,@15                                             0593
         IC    @15,TVOLLEN(,@02)                                   0593
         STH   @15,DARGILP(,@08)                                   0593
*            IF BASIVCRE = ON THEN                                 0594
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0594
         BNO   @RF00594                                            0594
*              DARGSENT = MSG3097I;                        /*@Y30LB39*/
         MVI   DARGSENT(@08),X'04'                                 0595
*            ELSE                                                  0596
*                DARGSENT = MSG3095I;                      /*@Y30LB39*/
         B     @RC00594                                            0596
@RF00594 L     @08,DDSTRU                                          0596
         MVI   DARGSENT(@08),X'0A'                                 0596
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
@RC00594 L     @08,@PC00001                                        0597
         ST    @08,@AL00001                                        0597
         LA    @02,@CF00114                                        0597
         ST    @02,@AL00001+4                                      0597
         LA    @02,DDSTRU                                          0597
         ST    @02,@AL00001+8                                      0597
         MVI   @AL00001+8,X'80'                                    0597
         L     @15,GDTPRT(,@08)                                    0597
         LA    @01,@AL00001                                        0597
         BALR  @14,@15                                             0597
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR3;                                 /*@Y30LB39*/
@RF00587 LR    REG14,RETADDR3                                      0599
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(TVOLRC);                              /*@Y30LB39*/
         LR    @15,TVOLRC                                          0600
@EL00006 DS    0H                                                  0600
@EF00006 DS    0H                                                  0600
@ER00006 BR    @14                                                 0600
*END TVOLRTN;                                              /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - ALLOCRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  EITHER SELECT A UNIT FOR REUSE OR DYNAMICALLY   @ZD00175*/
*        /*  ALLOCATE A UNIT IF FILE IS NOT SPECIFIED. THEN  @ZD00175*/
*        /*  VERIFY THAT THE UNIT ALLOCATED VIA THE FILE     @ZD00175*/
*        /*  PARAMETER IS VIRTUAL.                           @ZD00175*/
*        /*  IF AT ANY TIME, THIS SUBROUTINE RECEIVES A      @Y30LB39*/
*        /*  NON-ZERO RETURN CODE FROM A MACRO, THEN         @Y30LB39*/
*        /*  CONTROL WILL RETURN IMMEDIATELY TO CALLER.      @Y30LB39*/
*        /*  IT IS POSSIBLE FOR MESSAGE IDC3092I TO BE       @Y30LB39*/
*        /*  ISSUED IF A UNIT IS REQUIRED VIA THE FILE PARM. @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/
*        /*          BUFFER FOR ALLOC ARGUMENT LIST          @Y30LB39*/
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF PROCESSING DID NOT COMPLETE          @Y30LB39*/
*        /*          NORMALLY                                @Y30LB39*/
*        /*            . IF UNIT REQUIRED BUT NOT ALLOCATED  @Y30LB39*/
*        /*              BECAUSE DEFERRED MOUNT IS NECESSARY @Y30LB39*/
*        /*            . IF RETURN CODE NOT ZERO FROM SELECT,@ZD00175*/
*        /*              DYNAMIC ALLOCATING OR CHECK ROUTINE @ZD00175*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0602
*ALLOCRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0602
ALLOCRTN DS    0H                                                  0603
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL ALLOCRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      0604
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @ZD00175*/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0605
         L     @15,@PC00001                                        0605
         L     @14,GDTTR2(,@15)                                    0605
         MVC   @TS00001(95),NEWERID2(@14)                          0605
         MVC   OLDERID2(95,@14),@TS00001                           0605
*        NEWID2 = 'RVAL';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@14),@CC01574                              0606
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        ALLOCRC = LASTCC00;                               /*@Y30LB39*/
         SLR   @14,@14                                             0607
         LR    ALLOCRC,@14                                         0607
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF FILE NAME IS NOT SPECIFIED AND THE VOLUME    @Y30LB39*/
*        /*  SERIAL NUMBER MUST BE UPDATED AFTER THE COPY    @Y30LB39*/
*        /*  OPERATION AND THE TARGET VOLUME IS ALREADY      @Y30LB39*/
*        /*  MARKED INCOMPLETE, THEN A UNIT IS REQUIRED BUT  @Y30LB39*/
*        /*  CANNOT BE DYNAMICALLY ALLOCATED BECAUSE         @Y30LB39*/
*        /*  DEFERRED MOUNT IS NECESSARY.                    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF ADDR(FILE) = NULLPTR & FVOLVAL ^= TVOLVAL &            0608
*          (BASIVCRE=ON × BASIVCPY=ON × BASVSMIS=ON) THEN          0608
         L     @03,@PC00001+4                                      0608
         C     @14,FDTPTR+36(,@03)                                 0608
         BNE   @RF00608                                            0608
         L     @01,FDTPTR(,@03)                                    0608
         L     @14,FDTPTR+4(,@03)                                  0608
         CLC   FVOLVAL(6,@01),TVOLVAL(@14)                         0608
         BE    @RF00608                                            0608
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0608
         BZ    @RF00608                                            0608
*          DO;                                             /*@Y30LB39*/
*            ALLOCRC = LASTCC04;                           /*@Y30LB39*/
         LA    ALLOCRC,4                                           0610
*            DARGLIST = ''B;                               /*@Y30LB39*/
         L     @14,DDSTRU                                          0611
         XC    DARGLIST(20,@14),DARGLIST(@14)                      0611
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@14),@CC01460                            0612
*            DARGSENT = MSG3092I;                          /*@Y30LB39*/
         MVI   DARGSENT(@14),X'0E'                                 0613
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         ST    @15,@AL00001                                        0614
         LA    @14,@CF00114                                        0614
         ST    @14,@AL00001+4                                      0614
         LA    @14,DDSTRU                                          0614
         ST    @14,@AL00001+8                                      0614
         MVI   @AL00001+8,X'80'                                    0614
         L     @15,GDTPRT(,@15)                                    0614
         LA    @01,@AL00001                                        0614
         BALR  @14,@15                                             0614
*          END;                                            /*@Y30LB39*/
*        IF ALLOCRC = LASTCC00 THEN                                0616
@RF00608 SLR   @15,@15                                             0616
         CR    ALLOCRC,@15                                         0616
         BNE   @RF00616                                            0616
*          DO;                                             /*@Y30LB39*/
*                                                                  0617
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /* IF EITHER ALLOCATION IS BEING DONE AFTER THE COPY OR */
*            /* IF FILE WAS NOT SPECIFIED AND THE TARGET VOLUME IS   */
*            /* NOT INCOMPLETE, CONTINUE WITH ALLOCATION OF A UNIT.  */
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                                  0618
*            IF GETDDFLG=ON ×                                      0618
*              (ADDR(FILE) = NULLPTR &                             0618
*              (BASIVCRE=OFF & BASIVCPY=OFF & BASVSMIS=OFF)) THEN  0618
         TM    GETDDFLG,B'00001000'                                0618
         BO    @RT00618                                            0618
         L     @14,@PC00001+4                                      0618
         C     @15,FDTPTR+36(,@14)                                 0618
         BNE   @RF00618                                            0618
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0618
         BNZ   @RF00618                                            0618
@RT00618 DS    0H                                                  0619
*              DO;                                         /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @ZD00175*/
*                /* DETERMINE IF THE TARGET VOLUME IS ALREADY        */
*                /* ALLOCATED EXCLUSIVELY TO THE JOB STEP AND        */
*                /* IF A UNIT IS AVAILABLE FOR REUSE.        @ZD00175*/
*                /*                                          @ZD00175*/
*                /****************************************************/
*                                                                  0620
*                EXCLAGL=''B;                              /*@ZD00175*/
         LA    @02,EXCLAGLB                                        0620
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        0620
*                EXCLUCBP=ADDR(RUNITUCB);                  /*@ZD00175*/
         LA    @15,RUNITUCB                                        0621
         ST    @15,EXCLUCBP(,@02)                                  0621
*                EXCLDDP=ADDR(RUNITDDN);                   /*@ZD00175*/
         LA    @15,RUNITDDN                                        0622
         ST    @15,EXCLDDP(,@02)                                   0622
*                EXCLVOL=TVOLVAL;                          /*@ZD00175*/
*                                                                  0623
         L     @15,@PC00001+4                                      0623
         L     @01,FDTPTR+4(,@15)                                  0623
         MVC   EXCLVOL(6,@02),TVOLVAL(@01)                         0623
*                /****************************************************/
*                /*                                          @ZD00175*/
*                /* INVOKE THE SYSTEM ADAPTER, IDCSA06, TO SELECT    */
*                /* A UNIT ALREADY EXCLUSIVELY ALLOCATED TO THE      */
*                /* VOLUME AND JOB STEP.                     @ZD00175*/
*                /*                                          @ZD00175*/
*                /****************************************************/
*                                                                  0624
*                CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);    /*@ZD00175*/
*                                                                  0624
         L     @15,@PC00001                                        0624
         ST    @15,@AL00001                                        0624
         LA    @14,SELECTX                                         0624
         ST    @14,@AL00001+4                                      0624
         ST    @02,@AL00001+8                                      0624
         MVI   @AL00001+8,X'80'                                    0624
         L     @15,GDTUNT(,@15)                                    0624
         LA    @01,@AL00001                                        0624
         BALR  @14,@15                                             0624
*                RESPECIFY RTNREG RSTD;                            0625
*                TESTRC = RTNREG;                                  0626
         LR    TESTRC,RTNREG                                       0626
*                RESPECIFY RTNREG UNRSTD;                  /*@ZD00175*/
*                                                                  0627
*                /****************************************************/
*                /*                                          @ZD00175*/
*                /* IF NO DDNAME AND UCB ADDRESS ARE RETURNED BY     */
*                /* IDCSA06, A UNIT IS NOT AVAILABLE.  DYNAMICALLY   */
*                /* ALLOCATE ONE FOR SHARED USE.             @ZD00175*/
*                /*                                          @ZD00175*/
*                /****************************************************/
*                                                                  0628
*                IF TESTRC=0 THEN                                  0628
         SLR   @02,@02                                             0628
         CR    TESTRC,@02                                          0628
         BNE   @RF00628                                            0628
*                  IF RUNITUCB=NULLPTR THEN                        0629
         C     @02,RUNITUCB                                        0629
         BNE   @RF00629                                            0629
*                    DO;                                   /*@ZD00175*/
*                                                          /*#Y30LB39*/
*                    /************************************************/
*                    /*                                      @ZD00175*/
*                    /*  INITIALIZE THE ARGUMENT LIST TO DYNAMICALLY
*                    /*  ALLOCATE A VIRTUAL UNIT, 3330V, AND TO MOUNT
*                    /*  THE TARGET VOLUME.                  @ZD00175*/
*                    /*                                      @ZD00175*/
*                    /************************************************/
*                                                          /*@ZD00175*/
*                    ALLAGL = ''B;                         /*@ZD00175*/
         LA    @03,ALLAGLBF                                        0631
         XC    ALLAGL(31,@03),ALLAGL(@03)                          0631
*                    ALLOPTVL = ON;                        /*@ZD00175*/
         OI    ALLOPTVL(@03),B'10000000'                           0632
*                    RVULNUM = 1;                          /*@ZD00175*/
         LA    @15,1                                               0633
         STH   @15,RVULNUM                                         0633
*                    RVULLNTH = LENGTH('3330V');           /*@ZD00175*/
         MVC   RVULLNTH(2),@CH00285                                0634
*                    RVULTYPE = '3330V';                   /*@ZD00175*/
         MVC   RVULTYPE(5),@CC01575                                0635
*                    ALLULP = ADDR(RVULLIST);              /*@ZD00175*/
         LA    @14,RVULLIST                                        0636
         ST    @14,ALLULP(,@03)                                    0636
*                    VOLNUMBR = 1;                         /*@ZD00175*/
         STH   @15,VOLNUMBR                                        0637
*                    VOLLENTH = TVOLLEN;                   /*@ZD00175*/
         L     @15,@PC00001+4                                      0638
         L     @15,FDTPTR+4(,@15)                                  0638
         SLR   @14,@14                                             0638
         IC    @14,TVOLLEN(,@15)                                   0638
         STH   @14,VOLLENTH                                        0638
*                    VOLSERNM = TVOLVAL;                   /*@ZD00175*/
         MVC   VOLSERNM(6),TVOLVAL(@15)                            0639
*                    ALLVLP = ADDR(VOLSERLT);              /*@ZD00175*/
         LA    @15,VOLSERLT                                        0640
         ST    @15,ALLVLP(,@03)                                    0640
*                    ALLVLCNT = VOLUMCNT;                  /*@ZD00175*/
         MVI   ALLVLCNT(@03),X'01'                                 0641
*                    ALLUNCNT = 1;                         /*@ZD00175*/
         MVI   ALLUNCNT(@03),X'01'                                 0642
*                    ALLOPTPV = ON;                        /*@ZD00175*/
         OI    ALLOPTPV(@03),B'00100000'                           0643
*                                                          /*@ZD00175*/
*                    /************************************************/
*                    /*                                      @ZD00175*/
*                    /*  DUMP ALLOCATION ARGUMENT LIST PRIOR TO      */
*                    /*  INVOKING DYNAMIC ALLOCATION ROUTINE.        */
*                    /*                                      @ZD00175*/
*                    /************************************************/
*                                                          /*@ZD00175*/
*                                                                  0644
*                      IF GDTDBG = NULLPTR                         0644
*                        THEN;                                     0644
         L     @03,@PC00001                                        0644
         C     @02,GDTDBG(,@03)                                    0644
         BE    @RT00644                                            0644
*                        ELSE                                      0646
*                          DO;                                     0646
*                            DMPINDEX = ADDR(DUMPLIST);            /*@Z
*00175*/                                                           0647
*                                                                  0647
         LA    DMPINDEX,DUMPLIST                                   0647
*                            DMPITMNM = 'ALLAGLBF';                0648
         MVC   DMPITMNM(8,DMPINDEX),@CC01576                       0648
*                            DMPITMPT = ADDR(ALLAGLBF);            0649
         LA    @03,ALLAGLBF                                        0649
         ST    @03,DMPITMPT(,DMPINDEX)                             0649
*                            DMPITMLN = LENGTH(ALLAGLBF);          0650
         MVC   DMPITMLN(2,DMPINDEX),@CH00043                       0650
*                            DMPITMTP = 'H';                       0651
         MVI   DMPITMTP(DMPINDEX),C'H'                             0651
*                            DMPINDEX = DMPINDEX + DMPELEMT;       0652
         AL    DMPINDEX,@CF00473                                   0652
*                /*@ZD00175*/                                      0653
*                                                                  0653
*                            DMPTRM = DMPTRMVL;                    0653
         MVI   DMPTRM(DMPINDEX),X'FF'                              0653
*                          END;                             /*@ZD00175*
*                                                          /*@ZD00175*/
*                    IF GDTDBG = NULLPTR                           0655
*                      THEN;                                       0655
@RT00644 L     @15,@PC00001                                        0655
         L     @15,GDTDBG(,@15)                                    0655
         LTR   @15,@15                                             0655
         BZ    @RT00655                                            0655
*                      ELSE                                        0657
*                        CALL IDCDB010 (GDTTBL,'RVAA',ADDR(DUMPLIST));
         L     @15,@PC00001                                        0657
         ST    @15,@AL00001                                        0657
         LA    @14,@CC01577                                        0657
         ST    @14,@AL00001+4                                      0657
         LA    @14,DUMPLIST                                        0657
         ST    @14,@AFTEMPS+4                                      0657
         LA    @14,@AFTEMPS+4                                      0657
         ST    @14,@AL00001+8                                      0657
         MVI   @AL00001+8,X'80'                                    0657
         L     @15,GDTDBG(,@15)                                    0657
         LA    @01,@AL00001                                        0657
         BALR  @14,@15                                             0657
*                                                          /*@ZD00175*/
*                                                          /*@ZD00175*/
*                    CALL IDCSAAL0 (GDTTBL,ALLAGL);        /*@ZD00175*/
@RT00655 L     @02,@PC00001                                        0658
         ST    @02,@AL00001                                        0658
         LA    @15,ALLAGLBF                                        0658
         ST    @15,@AL00001+4                                      0658
         MVI   @AL00001+4,X'80'                                    0658
         L     @15,GDTALC(,@02)                                    0658
         LA    @01,@AL00001                                        0658
         BALR  @14,@15                                             0658
*                                                          /*@ZD00175*/
*                    RESPECIFY RTNREG RSTD;                        0659
*                    TESTRC = RTNREG;                              0660
         LR    TESTRC,RTNREG                                       0660
*                    RESPECIFY RTNREG UNRSTD;              /*@ZD00175*/
*                                                          /*@ZD00175*/
*                    /************************************************/
*                    /*                                      @ZD00175*/
*                    /*  IF UALLOC RETURN CODE NOT ZERO, DYNAMIC     */
*                    /*  ALLOCATION FAILED. THE UALLOC FUNCTION      */
*                    /*  ISSUED THE APPROPRIATE MESSAGE.     @ZD00175*/
*                    /*  SET THE CONDITION CODE TO 4 PRIOR   @ZD00175*/
*                    /*  TO RETURNING TO CALLER.             @ZD00175*/
*                    /*                                      @ZD00175*/
*                    /************************************************/
*                                                                  0662
*                    IF TESTRC ^= 0 THEN                   /*@ZD00175*/
         LTR   TESTRC,TESTRC                                       0662
         BZ    @RF00662                                            0662
*                      ALLOCRC = LASTCC04;                 /*@ZD00175*/
         LA    ALLOCRC,4                                           0663
*                                                          /*@ZD00175*/
*                    /************************************************/
*                    /*                                      @ZD00175*/
*                    /* SET FLAG ON INDICATING THAT UNIT WAS @ZD00175*/
*                    /* DYNAMICALLY ALLOCATED.               @ZD00175*/
*                    /*                                      @ZD00175*/
*                    /************************************************/
*                                                          /*@ZD00175*/
*                    ELSE                                  /*@ZD00175*/
*                      DO;                                 /*@ZD00175*/
         B     @RC00662                                            0664
@RF00662 DS    0H                                                  0665
*                        ALLOCFLG = ON;                    /*@ZD00175*/
         OI    ALLOCFLG,B'10000000'                                0665
*                        RUNITDDN = ALLDDN;                /*@ZD00175*/
         LA    @15,ALLAGLBF                                        0666
         MVC   RUNITDDN(8),ALLDDN(@15)                             0666
*                      END;                                /*@ZD00175*/
*                    END;                                  /*@ZD00175*/
*                                                                  0668
*                /****************************************************/
*                /*                                          @ZD00175*/
*                /* USE THE DDNAME AND UCB ADDRESS RETURNED BY       */
*                /* IDCSA06 SINCE THE VOLUME IS ALREADY ALLOCATED    */
*                /* EXCLUSIVELY TO THIS TASK.                @ZD00175*/
*                /*                                          @ZD00175*/
*                /****************************************************/
*                                                                  0669
*                ELSE;                                     /*@ZD00175*/
*                                                                  0669
@RF00629 DS    0H                                                  0670
*              /******************************************************/
*              /*                                            @ZD00175*/
*              /* IF NO UNIT IS AVAILABLE AND THE VOLUME IS  @ZD00175*/
*              /* IS ALREADY ALLOCATED FOR EXCLUSIVE USE, IDCSA06    */
*              /* ISSUED THE APPROPRIATE ERROR MESSAGE.  SET THE     */
*              /* CONDITION CODE TO 12 PRIOR TO RETURNING TO THE     */
*              /* CALLER.                                    @ZD00175*/
*              /*                                            @ZD00175*/
*              /******************************************************/
*                                                                  0670
*              ELSE                                                0670
*                                                                  0670
*                ALLOCRC=LASTCC04;                         /*@ZD00175*/
*                                                                  0670
         B     @RC00628                                            0670
@RF00628 LA    ALLOCRC,4                                           0670
*            END;                                          /*@ZD00175*/
@RC00628 DS    0H                                                  0672
*          END;                                            /*#Y30LB39*/
@RF00618 DS    0H                                                  0673
*        IF ALLOCRC = 0 THEN                                       0673
@RF00616 SLR   @15,@15                                             0673
         CR    ALLOCRC,@15                                         0673
         BNE   @RF00673                                            0673
*          DO;                                             /*#Y30LB39*/
*                                                          /*#Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  IF FILE IS SPECIFED THEN SAVE THE FILE      @Y30LB39*/
*            /*  NAME IN THE RECOVERV INTERNAL TABLE AND     @ZD00175*/
*            /*  CHECK THE UNIT.                             @ZD00175*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF ADDR(FILE) ^= NULLPTR THEN                         0675
         L     @14,@PC00001+4                                      0675
         L     @03,FDTPTR+36(,@14)                                 0675
         CR    @03,@15                                             0675
         BE    @RF00675                                            0675
*              DO;                                         /*@ZD00175*/
*                RUNITDDN = FILEVAL;                       /*@ZD00175*/
         MVC   RUNITDDN(8),FILEVAL(@03)                            0677
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @Y30LB39*/
*                /*  INITIALIZE CKAGL - ISSUE UMSSUNIT MACRO @Y30LB39*/
*                /*  TO VERIFY THAT THE DEVICE ALLOCATED IS  @Y30LB39*/
*                /*  VIRTUAL.                                @ZD00175*/
*                /*                                          @Y30LB39*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                CKAGL = ''B;                              /*@Y30LB39*/
         LA    @03,CKAGLBUF                                        0678
         XC    CKAGL(29,@03),CKAGL(@03)                            0678
*                CKUCBPTR = ADDR(RUNITUCB);                /*@Y30LB39*/
         LA    @02,RUNITUCB                                        0679
         ST    @02,CKUCBPTR(,@03)                                  0679
*                CKDDNAME = RUNITDDN;                      /*@Y30LB39*/
         MVC   CKDDNAME(8,@03),RUNITDDN                            0680
*                CKTESTVT = ON;                            /*@Y30LB39*/
         OI    CKTESTVT(@03),B'10000000'                           0681
*                CKLABELP = ADDR(TVOLVAL);                 /*@ZD00175*/
         L     @01,FDTPTR+4(,@14)                                  0682
         LA    @02,TVOLVAL(,@01)                                   0682
         ST    @02,CKLABELP(,@03)                                  0682
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @Y30LB39*/
*                /*  DUMP CHECK ARGUMENT LIST PRIOR TO       @Y30LB39*/
*                /*  INVOKING CHECK ALLOCATION ROUTINE.      @Y30LB39*/
*                /*                                          @Y30LB39*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                                                                  0683
*                  IF GDTDBG = NULLPTR                             0683
*                    THEN;                                         0683
         L     @14,@PC00001                                        0683
         C     @15,GDTDBG(,@14)                                    0683
         BE    @RT00683                                            0683
*                    ELSE                                          0685
*                      DO;                                         0685
*                        DMPINDEX = ADDR(DUMPLIST);                /*@Y
*0LB39*/                                                           0686
*                                                                  0686
         LA    DMPINDEX,DUMPLIST                                   0686
*                        DMPITMNM = 'CKAGLBUF';                    0687
         MVC   DMPITMNM(8,DMPINDEX),@CC01578                       0687
*                        DMPITMPT = ADDR(CKAGLBUF);                0688
         LA    @03,CKAGLBUF                                        0688
         ST    @03,DMPITMPT(,DMPINDEX)                             0688
*                        DMPITMLN = LENGTH(CKAGLBUF);              0689
         MVC   DMPITMLN(2,DMPINDEX),@CH00847                       0689
*                        DMPITMTP = 'H';                           0690
         MVI   DMPITMTP(DMPINDEX),C'H'                             0690
*                        DMPINDEX = DMPINDEX + DMPELEMT;           0691
         AL    DMPINDEX,@CF00473                                   0691
*                /*@Y30LB39*/                                      0692
*                                                                  0692
*                        DMPTRM = DMPTRMVL;                        0692
         MVI   DMPTRM(DMPINDEX),X'FF'                              0692
*                      END;                                 /*@Y30LB39*
*                                                          /*@Y30LB39*/
*                IF GDTDBG = NULLPTR                               0694
*                  THEN;                                           0694
@RT00683 L     @15,@PC00001                                        0694
         L     @15,GDTDBG(,@15)                                    0694
         LTR   @15,@15                                             0694
         BZ    @RT00694                                            0694
*                  ELSE                                            0696
*                    CALL IDCDB010 (GDTTBL,'RVBB',ADDR(DUMPLIST)); 0696
         L     @15,@PC00001                                        0696
         ST    @15,@AL00001                                        0696
         LA    @14,@CC01579                                        0696
         ST    @14,@AL00001+4                                      0696
         LA    @14,DUMPLIST                                        0696
         ST    @14,@AFTEMPS+4                                      0696
         LA    @14,@AFTEMPS+4                                      0696
         ST    @14,@AL00001+8                                      0696
         MVI   @AL00001+8,X'80'                                    0696
         L     @15,GDTDBG(,@15)                                    0696
         LA    @01,@AL00001                                        0696
         BALR  @14,@15                                             0696
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                CALL IDCSA060 (GDTTBL,CHECK,CKAGL);       /*@Y30LB39*/
@RT00694 L     @02,@PC00001                                        0697
         ST    @02,@AL00001                                        0697
         LA    @15,CHECK                                           0697
         ST    @15,@AL00001+4                                      0697
         LA    @15,CKAGLBUF                                        0697
         ST    @15,@AL00001+8                                      0697
         MVI   @AL00001+8,X'80'                                    0697
         L     @15,GDTUNT(,@02)                                    0697
         LA    @01,@AL00001                                        0697
         BALR  @14,@15                                             0697
*                                                          /*@Y30LB39*/
*                RESPECIFY RTNREG RSTD;                            0698
*                TESTRC = RTNREG;                                  0699
         LR    TESTRC,RTNREG                                       0699
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @Y30LB39*/
*                /*  IF UMSSUNIT RETURN CODE IS NOT ZERO, AN @Y30LB39*/
*                /*  APPROPRIATE MESSAGE WAS ISSUED BY THE   @Y30LB39*/
*                /*  CHECK FUNCTION.  MERELY SET CONDITION   @Y30LB39*/
*                /*  CODE TO FOUR BEFORE RETURNING           @Y30LB39*/
*                /*                                          @Y30LB39*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                IF TESTRC ^= 0 THEN                       /*@Y30LB39*/
         LTR   TESTRC,TESTRC                                       0701
         BZ    @RF00701                                            0701
*                  ALLOCRC = LASTCC04;                     /*@Y30LB39*/
         LA    ALLOCRC,4                                           0702
*              END;                                        /*@Y30LB39*/
@RF00701 DS    0H                                                  0704
*          END;                                            /*@Y30LB39*/
@RF00675 DS    0H                                                  0705
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RF00673 LR    REG14,RETADDR2                                      0705
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(ALLOCRC);                             /*@Y30LB39*/
         LR    @15,ALLOCRC                                         0706
@EL00007 DS    0H                                                  0706
@EF00007 DS    0H                                                  0706
@ER00007 BR    @14                                                 0706
*END ALLOCRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - VTOCKRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  MAKE A SECURITY CHECK OF PASSWORD PROTECTED     @Y30LB39*/
*        /*  DATA SETS AND UNEXPIRED DATA SETS OR TO         @Y30LB39*/
*        /*  CHECK THAT THE VOLUME IS IN FACT EMPTY AND      @Y30LB39*/
*        /*  NON-VSAM.                                       @Y30LB39*/
*        /*  AN EXTERNAL CALL IS MADE TO IDCVS01 TO          @Y30LB39*/
*        /*  DO THE ACTUAL CHECKING OF PASSWORD PROTECTED    @Y30LB39*/
*        /*  AND UNEXPIRED DATA SETS AND TO CHECK FOR        @Y30LB39*/
*        /*  EMPTY VTOC WHICH, OF COURSE, WOULD INSURE THAT  @Y30LB39*/
*        /*  THE VOLUME IS EMPTY.                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF RETURN CODE FROM IDCVS01 IS NOT ZERO @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0708
*VTOCKRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0708
VTOCKRTN DS    0H                                                  0709
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL VTOCKRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*        DCL VOLSERV CHAR(8) CONSTANT('IDCVS01 ');         /*@Y30LB39*/
*                                      /* CHARACTER STRING   @Y30LB39*/
*                                      /* USED TO IDENTIFY   @Y30LB39*/
*                                      /* EXTERNAL ROUTINE.  @Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      0711
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0712
         L     @08,@PC00001                                        0712
         L     @08,GDTTR2(,@08)                                    0712
         MVC   @TS00001(95),NEWERID2(@08)                          0712
         MVC   OLDERID2(95,@08),@TS00001                           0712
*        NEWID2 = 'RVVS';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@08),@CC01586                              0713
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VTOCKRC = LASTCC00;                               /*@Y30LB39*/
         SLR   @08,@08                                             0714
         LR    VTOCKRC,@08                                         0714
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  INITIALIZE VS1AGL FOR THE APPROPRIATE TYPE      @Y30LB39*/
*        /*  OF VTOC SECURITY CHECKED REQUIRED ON THE        @Y30LB39*/
*        /*  TARGET VOLUME.                                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VS1AGL = ''B;                                     /*@Y30LB39*/
         LA    @07,VS1AGLBF                                        0715
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0715
*        VSRES = ON;                                       /*@Y30LB39*/
         OI    VSRES(@07),B'10000000'                              0716
*        VSUCBP = ADDR(RUNITUCB);                          /*@Y30LB39*/
         LA    @15,RUNITUCB                                        0717
         ST    @15,VSUCBP(,@07)                                    0717
*        VSVOLP = ADDR(TVOLVAL);                           /*@Y30LB39*/
         L     @15,@PC00001+4                                      0718
         L     @14,FDTPTR+4(,@15)                                  0718
         LA    @03,TVOLVAL(,@14)                                   0718
         ST    @03,VSVOLP(,@07)                                    0718
*        VSFILEP = ADDR(RUNITDDN);                         /*@Y30LB39*/
         LA    @03,RUNITDDN                                        0719
         ST    @03,VSFILEP(,@07)                                   0719
*        VSTOV = ON;                                       /*@Y30LB39*/
         OI    VSTOV(@07),B'01000000'                              0720
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE SOURCE AND TARGET VOLUMES HAVE THE SAME  @Y30LB39*/
*        /*  VOLUME SERIAL NUMBERS, A CHECK IS MADE FOR      @Y30LB39*/
*        /*  WRITE-LEVEL PASSWORD PROTECTED DATASETS AND     @Y30LB39*/
*        /*  UNEXPIRED DATA SETS.                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF TVOLVAL = FVOLVAL THEN                                 0721
         L     @01,FDTPTR(,@15)                                    0721
         CLC   TVOLVAL(6,@14),FVOLVAL(@01)                         0721
         BNE   @RF00721                                            0721
*          DO;                                             /*@Y30LB39*/
*            VSMASTER = ON;                                /*@Y30LB39*/
*            VSWRITE = ON;                                 /*@Y30LB39*/
         OI    VSMASTER(@07),B'01001000'                           0724
*            IF ADDR(CAT) ^= NULLPTR THEN                          0725
         C     @08,FDTPTR+24(,@15)                                 0725
         BE    @RF00725                                            0725
*              DO;                                         /*@Y30LB39*/
*                VSCATP = ADDR(CATNMVAL);                  /*@Y30LB39*/
         L     @01,FDTPTR+28(,@15)                                 0727
         LA    @14,CATNMVAL(,@01)                                  0727
         ST    @14,VSCATP(,@07)                                    0727
*                IF ADDR (CATDN) ^= NULLPTR THEN                   0728
         L     @15,FDTPTR+32(,@15)                                 0728
         CR    @15,@08                                             0728
         BE    @RF00728                                            0728
*                  VSCATDDP = ADDR (CATDNVAL);             /*@Y30LB39*/
         LA    @08,CATDNVAL(,@15)                                  0729
         ST    @08,VSCATDDP(,@07)                                  0729
*                IF CATNMPLN ^= 0 THEN                             0730
@RF00728 L     @08,@PC00001+4                                      0730
         L     @08,FDTPTR+28(,@08)                                 0730
         CLI   CATNMPLN(@08),0                                     0730
         BE    @RF00730                                            0730
*                  VSPSWDP = ADDR (CATNMPAS);              /*@Y30LB39*/
         LA    @07,VS1AGLBF                                        0731
         LA    @08,CATNMPAS(,@08)                                  0731
         ST    @08,VSPSWDP(,@07)                                   0731
*              END;                                        /*@Y30LB39*/
@RF00730 DS    0H                                                  0733
*            VSPFILEP = ADDR(PFILE);                       /*@Y30LB39*/
@RF00725 LA    @08,VS1AGLBF                                        0733
         L     @07,@PC00001+4                                      0733
         L     @07,FDTPTR+40(,@07)                                 0733
         ST    @07,VSPFILEP(,@08)                                  0733
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE SOURCE AND TARGET VOLUMES HAVE DIFFERENT @Y30LB39*/
*        /*  VOLUME SERIAL NUMBERS, A CHECK IS MADE TO       @Y30LB39*/
*        /*  VERIFY THAT THE VOLUME CONTAINS NO DATA SETS    @Y30LB39*/
*        /*  AND THAT IT IS NOT A VSAM CANDIDATE VOLUME.     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        ELSE                                                      0735
*          DO;                                             /*@Y30LB39*/
         B     @RC00721                                            0735
@RF00721 DS    0H                                                  0736
*            VSNONONV = ON;                                /*@Y30LB39*/
*            VSNOVSAM = ON;                                /*@Y30LB39*/
         LA    @08,VS1AGLBF                                        0737
         OI    VSNONONV(@08),B'10100000'                           0737
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/
*        /*  TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       0739
*          THEN;                                                   0739
@RC00721 L     @08,@PC00001                                        0739
         L     @08,GDTDBG(,@08)                                    0739
         LTR   @08,@08                                             0739
         BZ    @RT00739                                            0739
*          ELSE                                                    0741
*            CALL IDCDB010 (GDTTBL,'RVCH');                        0741
         L     @08,@PC00001                                        0741
         ST    @08,@AL00001                                        0741
         LA    @07,@CC01587                                        0741
         ST    @07,@AL00001+4                                      0741
         MVI   @AL00001+4,X'80'                                    0741
         L     @15,GDTDBG(,@08)                                    0741
         LA    @01,@AL00001                                        0741
         BALR  @14,@15                                             0741
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        CALL IDCSACL0 (GDTTBL,VOLSERV,SECCHECK,VS1AGL);   /*@Y30LB39*/
@RT00739 L     @08,@PC00001                                        0742
         ST    @08,@AL00001                                        0742
         LA    @07,@CC01585                                        0742
         ST    @07,@AL00001+4                                      0742
         LA    @07,SECCHECK                                        0742
         ST    @07,@AL00001+8                                      0742
         LA    @07,VS1AGLBF                                        0742
         ST    @07,@AL00001+12                                     0742
         MVI   @AL00001+12,X'80'                                   0742
         L     @15,GDTCAL(,@08)                                    0742
         LA    @01,@AL00001                                        0742
         BALR  @14,@15                                             0742
*                                                          /*@Y30LB39*/
*        RESPECIFY RTNREG RSTD;                                    0743
*        TESTRC = RTNREG;                                          0744
         LR    TESTRC,RTNREG                                       0744
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       0746
         LTR   TESTRC,TESTRC                                       0746
         BZ    @RF00746                                            0746
*          IF TESTRC = 8 THEN                                      0747
         C     TESTRC,@CF00178                                     0747
         BNE   @RF00747                                            0747
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  A PASSWORD PROTECTED DATA SET COULD NOT     @Y30LB39*/
*            /*  BE CLOSED.                                  @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CC04FLG = ON;                                 /*@Y30LB39*/
         OI    CC04FLG,B'01000000'                                 0748
*          ELSE                                                    0749
*            IF TESTRC = LASTCC04 THEN                             0749
         B     @RC00747                                            0749
@RF00747 LA    @08,4                                               0749
         CR    TESTRC,@08                                          0749
         BNE   @RF00749                                            0749
*                                                          /*@Y30LB39*/
*              /******************************************************/
*              /*                                            @Y30LB39*/
*              /*  SECURITY CHECK FAILED                     @Y30LB39*/
*              /*                                            @Y30LB39*/
*              /******************************************************/
*                                                          /*@Y30LB39*/
*              VTOCKRC = LASTCC04;                         /*@Y30LB39*/
         LR    VTOCKRC,@08                                         0750
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF VSIOP ^= NULLPTR THEN                          /*@Y30LB39*/
@RF00749 DS    0H                                                  0751
@RC00747 DS    0H                                                  0751
@RF00746 LA    @08,VS1AGLBF                                        0751
         L     @07,VSIOP(,@08)                                     0751
         LTR   @07,@07                                             0751
         BZ    @RF00751                                            0751
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            CALL IDCIOCL0 (GDTTBL,VSIOP);                 /*@Y30LB39*/
         L     @07,@PC00001                                        0753
         ST    @07,@AL00001                                        0753
         LA    @08,VSIOP(,@08)                                     0753
         ST    @08,@AL00001+4                                      0753
         MVI   @AL00001+4,X'80'                                    0753
         L     @15,GDTCLS(,@07)                                    0753
         LA    @01,@AL00001                                        0753
         BALR  @14,@15                                             0753
*                                                          /*@Y30LB39*/
*            RESPECIFY RTNREG RSTD;                                0754
*            TESTRC = RTNREG;                                      0755
         LR    TESTRC,RTNREG                                       0755
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                                   0757
         LTR   TESTRC,TESTRC                                       0757
         BZ    @RF00757                                            0757
*              CC04FLG = ON;                               /*@Y30LB39*/
         OI    CC04FLG,B'01000000'                                 0758
*          END;                                            /*@Y30LB39*/
@RF00757 DS    0H                                                  0760
*        IF VTOCKRC ^= 0 THEN                                      0760
@RF00751 C     VTOCKRC,@CF00114                                    0760
         BE    @RF00760                                            0760
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*          /**********************************************************/
*          /*                                                @Y30LB39*/
*          /*  IF THE CONDITION CODE IS NOT ZERO,            @Y30LB39*/
*          /*  THEN THE COPY OPERATION CANNOT BE PERFORMED.  @Y30LB39*/
*          /*  ISSUE UDEQ TO RELEASE THE RESERVE SET BY      @Y30LB39*/
*          /*  IDCVS01.                                      @Y30LB39*/
*          /*                                                @Y30LB39*/
*          /**********************************************************/
*                                                          /*@Y30LB39*/
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@Y30LB39*/
         L     @08,@PC00001+4                                      0762
         L     @08,FDTPTR+4(,@08)                                  0762
         MVC   RNAMCHAR(6),TVOLVAL(@08)                            0762
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01588                             0763
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@Y30LB39*/
         L     @08,@PC00001                                        0764
         ST    @08,@AL00001                                        0764
         LA    @07,@CC01523                                        0764
         ST    @07,@AL00001+4                                      0764
         LA    @07,MINORNAM                                        0764
         ST    @07,@AL00001+8                                      0764
         MVI   @AL00001+8,X'80'                                    0764
         L     @15,GDTDEQ(,@08)                                    0764
         LA    @01,@AL00001                                        0764
         BALR  @14,@15                                             0764
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RF00760 LR    REG14,RETADDR2                                      0766
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(VTOCKRC);                             /*@Y30LB39*/
         LR    @15,VTOCKRC                                         0767
@EL00008 DS    0H                                                  0767
@EF00008 DS    0H                                                  0767
@ER00008 BR    @14                                                 0767
*END VTOCKRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - COPYRTN                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  COPY THE TARGET VOLUME FROM THE SOURCE VOLUME.  @ZD00175*/
*        /*  IT OBTAINS EXCLUSIVE CONTROL OF THE UNIT IF     @ZD00175*/
*        /*  ALLOCATED.  IT CALLS SUBROUTINE VPREPRTN TO     @ZD00175*/
*        /*  DEMOUNT THE TARGET VOLUME AND IF THE RETURN     @ZD00175*/
*        /*  CODE IS OKAY, THEN THE COPY PARAMETER LISTS     @ZD00175*/
*        /*  ARE FILLED OUT AND THE COPY PERFORMED.          @ZD00175*/
*        /*  PROVIDING THAT EVERYTHING GOES OKAY, THEN A     @Y30LB39*/
*        /*  MESSAGE IS PRINTED AND SUBROUTINE MVRRTN IS     @Y30LB39*/
*        /*  CALLED TO CLEAR THE INCOMPLETE COPY FLAG IN     @Y30LB39*/
*        /*  THE INVENTORY.                                  @Y30LB39*/
*        /*  IF, AT ANY TIME, A NON-ZERO RETURN CODE IS      @Y30LB39*/
*        /*  ENCOUNTERED, THEN CONTROL RETURNS IMMEDIATELY   @Y30LB39*/
*        /*  TO THE CALLER OF THIS SUBPROCEDURE.             @Y30LB39*/
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/
*        /*  ISSUED:                                         @Y30LB39*/
*        /*    IDC3082I IF UNABLE TO DEMOUNT TARGET VOLUME   @Y30LB39*/
*        /*    WHICH IS REQUIRED TO PERFORM COPY.            @Y30LB39*/
*        /*    IDC0711I IF COPY WAS SUCCESSFUL               @Y30LB39*/
*        /*    IDC3071I IF COPY WAS INCOMPLETE               @Y30LB39*/
*        /*    IDC3082I IF COPY NOT STARTED                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/
*        /*          BUFFER FOR A PRINT ARGUMENT LIST        @Y30LB39*/
*        /*          BUFFER FOR COPY PARAMETER LISTS         @Y30LB39*/
*        /*          (COPLIST AND COVCE)                     @Y30LB39*/
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - COPY WAS UNSUCCESSFUL.                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0769
*COPYRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/
*                                                                  0769
COPYRTN  DS    0H                                                  0770
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL COPYRC FIXED(8);                              /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR1 = REG14;                                 /*@Y30LB39*/
         ST    REG14,RETADDR1                                      0771
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0772
         L     @04,@PC00001                                        0772
         L     @04,GDTTR2(,@04)                                    0772
         MVC   @TS00001(95),NEWERID2(@04)                          0772
         MVC   OLDERID2(95,@04),@TS00001                           0772
*        NEWID2 = 'RVCP';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@04),@CC01594                              0773
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        COPYRC = LASTCC00;                                /*@Y30LB39*/
         SLR   COPYRC,COPYRC                                       0774
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @ZD00175*/
*        /* OBTAIN EXCLUSIVE USE OF THE UNIT AND VOLUME MOUNTED      */
*        /* ON IT IF A UNIT HAS BEEN ALLOCATED.  IF THE VOLUME LABEL */
*        /* NEED NOT BE UPDATED AFTER THE COPY OPERATION, DO NOT GET */
*        /* EXCLUSIVE CONTROL IF THE TARGET VOLUME IS NOT ALREADY    */
*        /* MOUNTED.                                         @ZD00175*/
*        /*                                                  @ZD00175*/
*        /************************************************************/
*                                                                  0775
*        IF RUNITDDN^=EIGHTZRO THEN                                0775
         CLC   RUNITDDN(8),EIGHTZRO                                0775
         BE    @RF00775                                            0775
*          DO;                                             /*@ZD00175*/
*            EXCLAGL=''B;                                  /*@ZD00175*/
         LA    @04,EXCLAGLB                                        0777
         XC    EXCLAGL(23,@04),EXCLAGL(@04)                        0777
*            EXCLUCBP=ADDR(RUNITUCB);                      /*@ZD00175*/
         LA    @15,RUNITUCB                                        0778
         ST    @15,EXCLUCBP(,@04)                                  0778
*            EXCLDDP=ADDR(RUNITDDN);                       /*@ZD00175*/
         LA    @15,RUNITDDN                                        0779
         ST    @15,EXCLDDP(,@04)                                   0779
*            EXCLVOL=TVOLVAL;                              /*@ZD00175*/
*                                                                  0780
         L     @15,@PC00001+4                                      0780
         L     @14,FDTPTR+4(,@15)                                  0780
         MVC   EXCLVOL(6,@04),TVOLVAL(@14)                         0780
*            IF COPOWNER^=BASOWNER×TVOLVAL^=FVOLVAL THEN           0781
         CLC   COPOWNER(10,COPYVPTR),BASOWNER(BASEVPTR)            0781
         BNE   @RT00781                                            0781
         L     @04,FDTPTR(,@15)                                    0781
         CLC   TVOLVAL(6,@14),FVOLVAL(@04)                         0781
         BE    @RF00781                                            0781
@RT00781 DS    0H                                                  0782
*              EXCLMNT=OFF;                                /*@ZD00175*/
         LA    @04,EXCLAGLB                                        0782
         NI    EXCLMNT(@04),B'01111111'                            0782
*            ELSE                                                  0783
*              EXCLMNT=ON;                                 /*@ZD00175*/
*                                                                  0783
         B     @RC00781                                            0783
@RF00781 LA    @04,EXCLAGLB                                        0783
         OI    EXCLMNT(@04),B'10000000'                            0783
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /* TAKE A FULL REGION DUMP PRIOR TO THE EXTERNAL CALL   */
*            /* TO IDCSA06.                                  @ZD00175*/
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                                  0784
*            IF GDTDBG = NULLPTR                                   0784
*              THEN;                                               0784
@RC00781 L     @04,@PC00001                                        0784
         L     @04,GDTDBG(,@04)                                    0784
         LTR   @04,@04                                             0784
         BZ    @RT00784                                            0784
*              ELSE                                                0786
*                CALL IDCDB010(GDTTBL,'RVHH');                     0786
         L     @04,@PC00001                                        0786
         ST    @04,@AL00001                                        0786
         LA    @15,@CC01595                                        0786
         ST    @15,@AL00001+4                                      0786
         MVI   @AL00001+4,X'80'                                    0786
         L     @15,GDTDBG(,@04)                                    0786
         LA    @01,@AL00001                                        0786
         BALR  @14,@15                                             0786
*                                                          /*@ZD00175*/
*                                                                  0787
*            CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);        /*@ZD00175*/
@RT00784 L     @04,@PC00001                                        0787
         ST    @04,@AL00001                                        0787
         LA    @02,CHANGEX                                         0787
         ST    @02,@AL00001+4                                      0787
         LA    @02,EXCLAGLB                                        0787
         ST    @02,@AL00001+8                                      0787
         MVI   @AL00001+8,X'80'                                    0787
         L     @15,GDTUNT(,@04)                                    0787
         LA    @01,@AL00001                                        0787
         BALR  @14,@15                                             0787
*            RESPECIFY RTNREG RSTD;                                0788
*            TESTRC = RTNREG;                                      0789
         LR    TESTRC,RTNREG                                       0789
*            RESPECIFY RTNREG UNRSTD;                      /*@ZD00175*/
*                                                                  0790
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /* IF THE REQUEST TO CHANGE VOLUME ALLOCATION FROM      */
*            /* SHARED TO EXCLUSIVE FAILED, RETURN TO THE CALLER AND */
*            /* DO NOT PERFORM THE COPY.                     @ZD00175*/
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                                  0791
*            IF TESTRC^=0 THEN                                     0791
         LTR   TESTRC,TESTRC                                       0791
         BZ    @RF00791                                            0791
*              COPYRC=LASTCC04;                            /*@ZD00175*/
*                                                                  0792
         LA    COPYRC,4                                            0792
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /*  THE TARGET VOLUME MAY BE MOUNTED ON THE     @ZD00175*/
*            /*  UNIT.  CALL VPREPRTN TO DEMOUNT THE TARGET  @ZD00175*/
*            /*  VOLUME AND CLEAR THE RESERVE SET BY IDCVS01 @ZD00175*/
*            /*  BEFORE THE COPY OPERATION IS STARTED.       @ZD00175*/
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            ELSE                                                  0793
*              DO;                                         /*@ZD00175*/
         B     @RC00791                                            0793
@RF00791 DS    0H                                                  0794
*                MOUNTFLG = OFF;                           /*@ZD00175*/
*                WAITFLG = ON;                             /*@ZD00175*/
*                DEMNTFLG = ON;                            /*@ZD00175*/
         OI    WAITFLG,B'00010100'                                 0796
         NI    MOUNTFLG,B'11011111'                                0796
*                CALL VPREPRTN;                            /*@ZD00175*/
         BAL   @14,VPREPRTN                                        0797
*                RESPECIFY RTNREG RSTD;                            0798
*                TESTRC = RTNREG;                                  0799
         LR    TESTRC,RTNREG                                       0799
*                RESPECIFY RTNREG UNRSTD;                  /*@ZD00175*/
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @ZD00175*/
*                /*  IF THE RETURN CODE FROM VPREPRTN IS     @ZD00175*/
*                /*  NOT ZERO, THEN SET THE CONDITION CODE   @ZD00175*/
*                /*  TO FOUR.                                @ZD00175*/
*                /*                                          @ZD00175*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                IF TESTRC ^= 0 THEN                               0801
         LTR   TESTRC,TESTRC                                       0801
         BZ    @RF00801                                            0801
*                  COPYRC = LASTCC04;                      /*@ZD00175*/
*                                                                  0802
         LA    COPYRC,4                                            0802
*                END;                                      /*@ZD00175*/
*                                                                  0803
@RF00801 DS    0H                                                  0804
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /* RETURN TO THE CALLER IF ALLOCATION OR DEMOUNT ERROR. */
*            /* ISSUE MSG IDC3082I AND EXIT VIA THE LAST STEP IN     */
*            /* THIS SUBROUTINE.                             @ZD00175*/
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                                  0804
*            IF COPYRC^=0 THEN                                     0804
@RC00791 C     COPYRC,@CF00114                                     0804
         BE    @RF00804                                            0804
*              DO;                                         /*@ZD00175*/
*                DARGLIST = ''B;                           /*@Y30LB39*/
         L     @04,DDSTRU                                          0806
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0806
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/
         MVC   DARGSMOD(3,@04),@CC01460                            0807
*                DARGSENT = MSG3082I;                      /*@Y30LB39*/
         MVI   DARGSENT(@04),X'18'                                 0808
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/
         L     @04,@PC00001                                        0809
         ST    @04,@AL00001                                        0809
         LA    @15,@CF00114                                        0809
         ST    @15,@AL00001+4                                      0809
         LA    @15,DDSTRU                                          0809
         ST    @15,@AL00001+8                                      0809
         MVI   @AL00001+8,X'80'                                    0809
         L     @15,GDTPRT(,@04)                                    0809
         LA    @01,@AL00001                                        0809
         BALR  @14,@15                                             0809
*              END;                                        /*@Y30LB39*/
*        END;                                              /*@ZD00175*/
@RF00804 DS    0H                                                  0812
*        IF COPYRC = 0 THEN                                        0812
@RF00775 SLR   @04,@04                                             0812
         CR    COPYRC,@04                                          0812
         BNE   @RF00812                                            0812
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  INITIALIZE THE MSVC COVCE PARAMETER LIST    @Y30LB39*/
*            /*  TAKING SPECIAL CARE TO INSURE THAT THE      @Y30LB39*/
*            /*  CORRECT RECOVER FLAGS ARE SET ON.           @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            COVCE = ''B;                                  /*@Y30LB39*/
         L     @15,COVCEPTR                                        0814
         XC    COVCE(43,@15),COVCE(@15)                            0814
*            COVLNGTH = COVLEN;                            /*@Y30LB39*/
         LH    @14,COVLEN                                          0815
         ST    @14,COVLNGTH(,@15)                                  0815
*            COVSRCVY = ON;                                /*@Y30LB39*/
         OI    COVSRCVY(@15),B'10000000'                           0816
*            COVICOPY = ON;                                /*@Y30LB39*/
         OI    COVICOPY(@15),B'10000000'                           0817
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  INITIALIZE THE MSSC COVLIST PARAMETER LIST  @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            COVLIST = ''B;                                /*@Y30LB39*/
         L     @14,COVCPTR                                         0818
         XC    COVLIST(40,@14),COVLIST(@14)                        0818
*            CVOCRCRV = ON;                                /*@Y30LB39*/
         OI    CVOCRCRV(@14),B'00010000'                           0819
*            CVOLID = TVOLVAL;                             /*@Y30LB39*/
         L     @09,@PC00001+4                                      0820
         L     @01,FDTPTR+4(,@09)                                  0820
         MVC   CVOLID(6,@14),TVOLVAL(@01)                          0820
*            CVOLCSN = COPCSN1;                            /*@Y30LB39*/
         MVC   CVOLCSN(12,@14),COPCSN1(COPYVPTR)                   0821
*            CVOLVEXT = COVCEPTR;                          /*@Y30LB39*/
         ST    @15,CVOLVEXT(,@14)                                  0822
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE USSC MACRO TO COPY THE SOURCE VOLUME  @Y30LB39*/
*            /*  TO AN ACTIVE COPY VOLUME AFTER DUMPING      @Y30LB39*/
*            /*  PARAMETER LISTS.                            @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*                                                                  0823
*              IF GDTDBG = NULLPTR                                 0823
*                THEN;                                             0823
         L     @15,@PC00001                                        0823
         C     @04,GDTDBG(,@15)                                    0823
         BE    @RT00823                                            0823
*                ELSE                                              0825
*                  DO;                                             0825
*                    DMPINDEX = ADDR(DUMPLIST);                    /*@Y
*0LB39*/                                                           0826
*                                                                  0826
         LA    DMPINDEX,DUMPLIST                                   0826
*                    DMPITMNM = 'COVLISTB';                        0827
         MVC   DMPITMNM(8,DMPINDEX),@CC01596                       0827
*                    DMPITMPT = ADDR(COVLISTB);                    0828
         LA    @04,COVLISTB                                        0828
         ST    @04,DMPITMPT(,DMPINDEX)                             0828
*                    DMPITMLN = LENGTH(COVLISTB);                  0829
         MVC   DMPITMLN(2,DMPINDEX),@CH01652                       0829
*                    DMPITMTP = 'H';                               0830
         MVI   DMPITMTP(DMPINDEX),C'H'                             0830
*                    DMPINDEX = DMPINDEX + DMPELEMT;               0831
*                                                                  0831
         LA    @04,16                                              0831
         ALR   DMPINDEX,@04                                        0831
*                    DMPITMNM = 'COVCEBUF';                        0832
         MVC   DMPITMNM(8,DMPINDEX),@CC01597                       0832
*                    DMPITMPT = ADDR(COVCEBUF);                    0833
         LA    @03,COVCEBUF                                        0833
         ST    @03,DMPITMPT(,DMPINDEX)                             0833
*                    DMPITMLN = LENGTH(COVCEBUF);                  0834
         MVC   DMPITMLN(2,DMPINDEX),@CH01503                       0834
*                    DMPITMTP = 'H';                               0835
         MVI   DMPITMTP(DMPINDEX),C'H'                             0835
*                    DMPINDEX = DMPINDEX + DMPELEMT;               0836
*                                                                  0836
         ALR   DMPINDEX,@04                                        0836
*                    DMPTRM = DMPTRMVL;                            0837
         MVI   DMPTRM(DMPINDEX),X'FF'                              0837
*                  END;                                     /*@Y30LB39*
*                                                          /*@Y30LB39*/
*            IF GDTDBG = NULLPTR                                   0839
*              THEN;                                               0839
@RT00823 L     @04,@PC00001                                        0839
         L     @04,GDTDBG(,@04)                                    0839
         LTR   @04,@04                                             0839
         BZ    @RT00839                                            0839
*              ELSE                                                0841
*                CALL IDCDB010 (GDTTBL,'RVEE',ADDR(DUMPLIST));     0841
         L     @04,@PC00001                                        0841
         ST    @04,@AL00001                                        0841
         LA    @15,@CC01598                                        0841
         ST    @15,@AL00001+4                                      0841
         LA    @15,DUMPLIST                                        0841
         ST    @15,@AFTEMPS+8                                      0841
         LA    @15,@AFTEMPS+8                                      0841
         ST    @15,@AL00001+8                                      0841
         MVI   @AL00001+8,X'80'                                    0841
         L     @15,GDTDBG(,@04)                                    0841
         LA    @01,@AL00001                                        0841
         BALR  @14,@15                                             0841
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            CALL IDCSASS0 (GDTTBL,COPYVOL,COVCPTR,REASON,ECBBYTE);/*
*                                                            @Y30LB39*/
@RT00839 L     @04,@PC00001                                        0842
         ST    @04,@AL00001                                        0842
         LA    @02,COPYVOL                                         0842
         ST    @02,@AL00001+4                                      0842
         LA    @02,COVCPTR                                         0842
         ST    @02,@AL00001+8                                      0842
         LA    @02,REASON                                          0842
         ST    @02,@AL00001+12                                     0842
         LA    @02,ECBBYTE                                         0842
         ST    @02,@AL00001+16                                     0842
         MVI   @AL00001+16,X'80'                                   0842
         L     @15,GDTSSC(,@04)                                    0842
         LA    @01,@AL00001                                        0842
         BALR  @14,@15                                             0842
*                                                          /*@Y30LB39*/
*            RESPECIFY RTNREG RSTD;                                0843
*            TESTRC = RTNREG;                                      0844
         LR    TESTRC,RTNREG                                       0844
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  IF MSVC RETURNS A RETURN CODE OF TWELVE,    @Y30LB39*/
*            /*  IT MEANS THE FUNCTION WAS COMPLETED BUT AN  @Y30LB39*/
*            /*  I-O ERROR PREVENTED THE UPDATING OF THE     @Y30LB39*/
*            /*  MSV INVENTORY.  THIS RETURN CODE SHOULD BE  @Y30LB39*/
*            /*  TREATED AS A RETURN CODE OF ZERO, EXCEPT    @Y30LB39*/
*            /*  THAT THE FINAL CODE TO THE EXECUTIVE        @Y30LB39*/
*            /*  SHOULD BE AT LEAST FOUR.  THAT IS THE       @Y30LB39*/
*            /*  REASON FOR SETTING CC04FLG ON.              @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF TESTRC = 12 THEN                           /*@Y30LB39*/
         C     TESTRC,@CF00567                                     0846
         BNE   @RF00846                                            0846
*              DO;                                         /*@Y30LB39*/
*                TESTRC = LASTCC00;                        /*@Y30LB39*/
         SLR   TESTRC,TESTRC                                       0848
*                CC04FLG = ON;                             /*@Y30LB39*/
         OI    CC04FLG,B'01000000'                                 0849
*              END;                                        /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  IF RETURN CODE IS ZERO, ISSUE MESSAGE       @Y30LB39*/
*            /*  IDC0711I TO ADVISE OF SUCCESSFUL COPY.      @Y30LB39*/
*            /*  INSERT IN THE MESSAGE BOTH THE SOURCE       @Y30LB39*/
*            /*  AND TARGET VOLSERS AND THE COPY DATE        @Y30LB39*/
*            /*  FROM THE COPY RECORD.                       @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF TESTRC = 0 THEN                                    0851
@RF00846 LTR   TESTRC,TESTRC                                       0851
         BNZ   @RF00851                                            0851
*              DO;                                         /*@Y30LB39*/
*                DARGLIST = ''B;                           /*@Y30LB39*/
         L     @04,DDSTRU                                          0853
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0853
*                DARGSMOD = RECVMSG;                       /*@Y30LB39*/
         MVC   DARGSMOD(3,@04),@CC01458                            0854
*                DARGSENT = MSG0711I;                      /*@Y30LB39*/
         MVI   DARGSENT(@04),X'02'                                 0855
*                DARGDBP = ADDR(TVOLVAL);                  /*@Y30LB39*/
         L     @15,@PC00001+4                                      0856
         L     @14,FDTPTR+4(,@15)                                  0856
         LA    @09,TVOLVAL(,@14)                                   0856
         ST    @09,DARGDBP(,@04)                                   0856
*                DARGILP = TVOLLEN;                        /*@Y30LB39*/
         SLR   @09,@09                                             0857
         IC    @09,TVOLLEN(,@14)                                   0857
         STH   @09,DARGILP(,@04)                                   0857
*                DARGCNT = 2;                              /*@Y30LB39*/
         LA    @14,2                                               0858
         STH   @14,DARGCNT(,@04)                                   0858
*                DARGINS(1) = 1;                           /*@Y30LB39*/
         MVC   DARGINS(2,@04),@CH00218                             0859
*                DARGINL(1) = FVOLLEN;                     /*@Y30LB39*/
         L     @15,FDTPTR(,@15)                                    0860
         SLR   @09,@09                                             0860
         IC    @09,FVOLLEN(,@15)                                   0860
         STH   @09,DARGINL(,@04)                                   0860
*                DARGDTM(1) = ADDR(FVOLVAL);               /*@Y30LB39*/
         LA    @15,FVOLVAL(,@15)                                   0861
         ST    @15,DARGDTM(,@04)                                   0861
*                DARGINS(2) = 2;                           /*@Y30LB39*/
         STH   @14,DARGINS+8(,@04)                                 0862
*                DARGINL(2) = LENGTH(COPDATE);             /*@Y30LB39*/
         MVC   DARGINL+8(2,@04),@CH00041                           0863
*                DARGDTM(2) = ADDR(COPDATE);               /*@Y30LB39*/
         LA    @15,COPDATE(,COPYVPTR)                              0864
         ST    @15,DARGDTM+8(,@04)                                 0864
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/
         L     @04,@PC00001                                        0865
         ST    @04,@AL00001                                        0865
         LA    @15,@CF00114                                        0865
         ST    @15,@AL00001+4                                      0865
         LA    @15,DDSTRU                                          0865
         ST    @15,@AL00001+8                                      0865
         MVI   @AL00001+8,X'80'                                    0865
         L     @15,GDTPRT(,@04)                                    0865
         LA    @01,@AL00001                                        0865
         BALR  @14,@15                                             0865
*              END;                                        /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  RETURN CODE FROM USSC WAS NOT ZERO          @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            ELSE                                          /*@Y30LB39*/
*              DO;                                         /*@Y30LB39*/
         B     @RC00851                                            0867
@RF00851 DS    0H                                                  0868
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @Y30LB39*/
*                /*  SET THE CONDITION CODE TO FOUR.         @Y30LB39*/
*                /*                                          @Y30LB39*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                COPYRC = LASTCC04;                        /*@Y30LB39*/
         LA    @04,4                                               0868
         LR    COPYRC,@04                                          0868
*                                                          /*@Y30LB39*/
*                /****************************************************/
*                /*                                          @Y30LB39*/
*                /*  CALL SSCMSG TO OUTPUT APPROPRIATE REASON@Y30LB39*/
*                /*  CODE MESSAGE IF USSC CODE IS FOUR,      @Y30LB39*/
*                /*  WHICH INDICATES MSC COPY ORDER FAILED.  @Y30LB39*/
*                /*                                          @Y30LB39*/
*                /****************************************************/
*                                                          /*@Y30LB39*/
*                IF TESTRC = LASTCC04 THEN                 /*@Y30LB39*/
         CR    TESTRC,@04                                          0869
         BNE   @RF00869                                            0869
*                  CALL SSCMSG (REASON,ECBBYTE);           /*@Y30LB39*/
         LA    @04,REASON                                          0870
         ST    @04,@AL00001                                        0870
         LA    @04,ECBBYTE                                         0870
         ST    @04,@AL00001+4                                      0870
         LA    @01,@AL00001                                        0870
         BAL   @14,SSCMSG                                          0870
*                DARGLIST = ''B;                           /*@Y30LB39*/
@RF00869 L     @04,DDSTRU                                          0871
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0871
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/
         MVC   DARGSMOD(3,@04),@CC01460                            0872
*                IF ECBBYTE = ONEZERO THEN                         0873
         CLC   ECBBYTE(1),ONEZERO                                  0873
         BNE   @RF00873                                            0873
*                  DARGSENT = MSG3082I;                    /*@Y30LB39*/
         MVI   DARGSENT(@04),X'18'                                 0874
*                ELSE                                              0875
*                  DARGSENT = MSG3071I;                    /*@Y30LB39*/
         B     @RC00873                                            0875
@RF00873 L     @04,DDSTRU                                          0875
         MVI   DARGSENT(@04),X'23'                                 0875
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/
@RC00873 L     @04,@PC00001                                        0876
         ST    @04,@AL00001                                        0876
         LA    @15,@CF00114                                        0876
         ST    @15,@AL00001+4                                      0876
         LA    @15,DDSTRU                                          0876
         ST    @15,@AL00001+8                                      0876
         MVI   @AL00001+8,X'80'                                    0876
         L     @15,GDTPRT(,@04)                                    0876
         LA    @01,@AL00001                                        0876
         BALR  @14,@15                                             0876
*              END;                                        /*@Y30LB39*/
*            IF COPYRC = 0 THEN                            /*@Y30LB39*/
@RC00851 C     COPYRC,@CF00114                                     0878
         BNE   @RF00878                                            0878
*                                                          /*@Y30LB39*/
*              /******************************************************/
*              /*                                            @Y30LB39*/
*              /*  IF SOURCE AND TARGET VOLUME SERIAL        @Y30LB39*/
*              /*  NUMBERS ARE THE SAME, CALL MVRRTN         @Y30LB39*/
*              /*  TO CLEAR THE INCOMPLETE-COPY FLAG FROM    @Y30LB39*/
*              /*  THE INVENTORY.                            @Y30LB39*/
*              /*                                            @Y30LB39*/
*              /******************************************************/
*                                                          /*@Y30LB39*/
*              IF TVOLVAL = FVOLVAL THEN                   /*@Y30LB39*/
         L     @04,@PC00001+4                                      0879
         L     @01,FDTPTR+4(,@04)                                  0879
         L     @04,FDTPTR(,@04)                                    0879
         CLC   TVOLVAL(6,@01),FVOLVAL(@04)                         0879
         BNE   @RF00879                                            0879
*                DO;                                       /*@Y30LB39*/
*                  CALL MVRRTN;                            /*@Y30LB39*/
         BAL   @14,MVRRTN                                          0881
*                  RESPECIFY RTNREG RSTD;                          0882
*                  TESTRC = RTNREG;                                0883
         LR    TESTRC,RTNREG                                       0883
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/
*                  IF TESTRC ^= 0 THEN                             0885
         LTR   TESTRC,TESTRC                                       0885
         BZ    @RF00885                                            0885
*                    COPYRC = LASTCC04;                    /*@Y30LB39*/
         LA    COPYRC,4                                            0886
*                END;                                      /*@Y30LB39*/
@RF00885 DS    0H                                                  0888
*          END;                                            /*@Y30LB39*/
@RF00879 DS    0H                                                  0888
@RF00878 DS    0H                                                  0889
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR1;                                 /*@Y30LB39*/
@RF00812 L     REG14,RETADDR1                                      0889
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(COPYRC);                              /*@Y30LB39*/
         LR    @15,COPYRC                                          0890
@EL00009 DS    0H                                                  0890
@EF00009 DS    0H                                                  0890
@ER00009 BR    @14                                                 0890
*END COPYRTN;                                              /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - VPREPRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  MOUNT OR DEMOUNT THE TARGET VOLUME.             @Y30LB39*/
*        /*  THE DETERMINATION AS TO WHICH OF THESE IS       @Y30LB39*/
*        /*  TO BE DONE HAS BEEN MADE BEFORE THIS SUB-       @Y30LB39*/
*        /*  ROUTINE IS CALLED.  THIS ROUTINE MERELY         @Y30LB39*/
*        /*  EXAMINES AN INTERNAL FLAG AND PROCEEDS TO       @Y30LB39*/
*        /*  FILL OUT THE PARAMETER LIST AND ISSUE THE       @Y30LB39*/
*        /*  REQUEST ACCORDING TO THE SETTING OF THAT        @Y30LB39*/
*        /*  INTERNAL FLAG.                                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          BUFFER FOR MOUNT OR DEMOUNT PARM LIST   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF UMSSUNIT MACRO RETURNS A NON-ZERO    @Y30LB39*/
*        /*          RETURN CODE.                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0892
*VPREPRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0892
VPREPRTN DS    0H                                                  0893
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL VPREPRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      0894
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0895
         L     @15,@PC00001                                        0895
         L     @14,GDTTR2(,@15)                                    0895
         MVC   @TS00001(95),NEWERID2(@14)                          0895
         MVC   OLDERID2(95,@14),@TS00001                           0895
*        NEWID2 = 'RVVP';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@14),@CC01604                              0896
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VPREPRC = LASTCC00;                               /*@Y30LB39*/
         SLR   VPREPRC,VPREPRC                                     0897
*                                                          /*@ZA05125*/
*        /************************************************************/
*        /*                                                  @ZA05125*/
*        /*  IF MOUNTFLG IS OFF, A VOLUME DEMOUNT WAS        @ZA05125*/
*        /*  REQUESTED, SO ISSUE DEQUEUE TO RELEASE THE      @ZA05125*/
*        /*  RESERVE SET BY IDCVS01 FOR THE VTOC CHECK.      @ZA05125*/
*        /*                                                  @ZA05125*/
*        /************************************************************/
*                                                          /*@ZA05125*/
*        IF MOUNTFLG = OFF THEN                            /*@ZA05125*/
         TM    MOUNTFLG,B'00100000'                                0898
         BNZ   @RF00898                                            0898
*          DO;                                             /*@ZA05125*/
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@ZA05125*/
         L     @14,@PC00001+4                                      0900
         L     @01,FDTPTR+4(,@14)                                  0900
         MVC   RNAMCHAR(6),TVOLVAL(@01)                            0900
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01588                             0901
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@ZA05125*/
         ST    @15,@AL00001                                        0902
         LA    @14,@CC01523                                        0902
         ST    @14,@AL00001+4                                      0902
         LA    @14,MINORNAM                                        0902
         ST    @14,@AL00001+8                                      0902
         MVI   @AL00001+8,X'80'                                    0902
         L     @15,GDTDEQ(,@15)                                    0902
         LA    @01,@AL00001                                        0902
         BALR  @14,@15                                             0902
*          END;                                            /*@ZA05125*/
*                                                          /*#Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  INITIALIZE THE MDAGL PARM LIST IF IT HAS        @Y30LB39*/
*        /*  NOT BEEN INITIALIZED ALREADY.                   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF MDAGL = ZEROS31 THEN                           /*@Y30LB39*/
@RF00898 LA    @15,MDAGLBUF                                        0904
         CLC   MDAGL(31,@15),ZEROS31                               0904
         BNE   @RF00904                                            0904
*          DO;                                             /*@Y30LB39*/
*            MDDDNAME = RUNITDDN;                          /*@Y30LB39*/
         MVC   MDDDNAME(8,@15),RUNITDDN                            0906
*            MDUCBPTR = ADDR(RUNITUCB);                    /*@Y30LB39*/
         LA    @14,RUNITUCB                                        0907
         ST    @14,MDUCBPTR(,@15)                                  0907
*            MDLABEL = TVOLVAL;                            /*@Y30LB39*/
         L     @14,@PC00001+4                                      0908
         L     @01,FDTPTR+4(,@14)                                  0908
         MVC   MDLABEL(6,@15),TVOLVAL(@01)                         0908
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE MOUNT FLAG IS ON, A VOLUME MOUNT IS      @Y30LB39*/
*        /*  DESIRED BEFORE THE LABEL UPDATE.  OTHERWISE,    @Y30LB39*/
*        /*  A VOLUME DEMOUNT IS DESIRED BEFORE THE COPY     @Y30LB39*/
*        /*  OPERATION.  IF THE WAIT FLAG IS ON, THE WAIT    @Y30LB39*/
*        /*  OPTION IS DESIRED WITH THE DEMOUNT REQUEST.     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF WAITFLG = ON THEN                              /*@Y30LB39*/
@RF00904 TM    WAITFLG,B'00010000'                                 0910
         BNO   @RF00910                                            0910
*          MDWAIT = ON;                                    /*@Y30LB39*/
         LA    @15,MDAGLBUF                                        0911
         OI    MDWAIT(@15),B'00010000'                             0911
*        ELSE                                              /*@Y30LB39*/
*          MDWAIT = OFF;                                   /*@Y30LB39*/
         B     @RC00910                                            0912
@RF00910 LA    @15,MDAGLBUF                                        0912
         NI    MDWAIT(@15),B'11101111'                             0912
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UMSSUNIT MACRO TO EXECUTE THE             @Y30LB39*/
*        /*  APPROPRIATE REQUEST - DEMOUNT OR MOUNT.         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF MOUNTFLG = ON THEN                             /*@Y30LB39*/
@RC00910 TM    MOUNTFLG,B'00100000'                                0913
         BNO   @RF00913                                            0913
*          CALL IDCSA060 (GDTTBL,MOUNT,MDAGL);             /*@Y30LB39*/
         L     @15,@PC00001                                        0914
         ST    @15,@AL00001                                        0914
         LA    @14,MOUNT                                           0914
         ST    @14,@AL00001+4                                      0914
         LA    @14,MDAGLBUF                                        0914
         ST    @14,@AL00001+8                                      0914
         MVI   @AL00001+8,X'80'                                    0914
         L     @15,GDTUNT(,@15)                                    0914
         LA    @01,@AL00001                                        0914
         BALR  @14,@15                                             0914
*        ELSE                                              /*@Y30LB39*/
*          CALL IDCSA060 (GDTTBL,DEMOUNT,MDAGL);           /*@Y30LB39*/
         B     @RC00913                                            0915
@RF00913 L     @15,@PC00001                                        0915
         ST    @15,@AL00001                                        0915
         LA    @14,DEMOUNT                                         0915
         ST    @14,@AL00001+4                                      0915
         LA    @14,MDAGLBUF                                        0915
         ST    @14,@AL00001+8                                      0915
         MVI   @AL00001+8,X'80'                                    0915
         L     @15,GDTUNT(,@15)                                    0915
         LA    @01,@AL00001                                        0915
         BALR  @14,@15                                             0915
*        RESPECIFY RTNREG RSTD;                                    0916
@RC00913 DS    0H                                                  0917
*        TESTRC = RTNREG;                                          0917
         LR    TESTRC,RTNREG                                       0917
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE RETURN CODE IS NOT ZERO, SET THE         @Y30LB39*/
*        /*  CONDITION CODE TO FOUR.                         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                               /*@Y30LB39*/
         LTR   TESTRC,TESTRC                                       0919
         BZ    @RF00919                                            0919
*          VPREPRC = LASTCC04;                             /*@Y30LB39*/
         LA    VPREPRC,4                                           0920
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RF00919 LR    REG14,RETADDR2                                      0921
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(VPREPRC);                             /*@Y30LB39*/
         LR    @15,VPREPRC                                         0922
@EL00010 DS    0H                                                  0922
@EF00010 DS    0H                                                  0922
@ER00010 BR    @14                                                 0922
*END VPREPRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - MVRRTN                         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  CLEAR THE INCOMPLETE COPY FLAG FROM THE         @Y30LB39*/
*        /*  INVENTORY.                                      @Y30LB39*/
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/
*        /*  ISSUED:                                         @Y30LB39*/
*        /*    IDC3066I IF USSC RETURN CODE IS NON-ZERO      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/
*        /*          BUFFER FOR MVR PARAMETER LIST           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF USSC RETURN CODE NON-ZERO            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0924
*MVRRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                  /*@Y30LB39*/
*                                                                  0924
MVRRTN   DS    0H                                                  0925
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL MVRRC FIXED(8);           /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      0926
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0927
         L     @15,@PC00001                                        0927
         L     @14,GDTTR2(,@15)                                    0927
         MVC   @TS00001(95),NEWERID2(@14)                          0927
         MVC   OLDERID2(95,@14),@TS00001                           0927
*        NEWID2 = 'RVMV';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@14),@CC01609                              0928
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*  INITIALIZE THE LOCAL VARIABLE WHICH WILL HAVE   @Y30LB39*/
*        /*  THE EXCESS NUMBER OF BACKUP COPIES VALUE.       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        MVRRC = LASTCC00;                                 /*@Y30LB39*/
         SLR   @14,@14                                             0929
         LR    MVRRC,@14                                           0929
*                                                          /*@Y30LB39*/
*        /***********************************************************/
*        /*                                                  @Y30LB39*/
*        /*  INITIALIZE MVR TO CLEAR THE INCOMPLETE          @Y30LB39*/
*        /*  FLAG FROM THE INVENTORY.                        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /***********************************************************/
*                                                          /*@Y30LB39*/
*        MVR = ''B;                                        /*@Y30LB39*/
         L     @03,MVRPTR                                          0930
         XC    MVR(88,@03),MVR(@03)                                0930
*        MVRLNGTH = MVRLEN;                                /*@Y30LB39*/
         LH    @02,MVRLEN                                          0931
         ST    @02,MVRLNGTH(,@03)                                  0931
*        MVRCODE = MVROP;                                  /*@Y30LB39*/
         XC    MVRCODE+1(3,@03),MVRCODE+1(@03)                     0932
         MVI   MVRCODE(@03),X'85'                                  0932
*        MVRCICPY = ON;                                    /*@Y30LB39*/
         OI    MVRCICPY(@03),B'01000000'                           0933
*        MVRBVOL = TVOLVAL;                                /*@Y30LB39*/
         L     @02,@PC00001+4                                      0934
         L     @01,FDTPTR+4(,@02)                                  0934
         MVC   MVRBVOL(6,@03),TVOLVAL(@01)                         0934
*                                                          /*@Y30LB39*/
*        /***********************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE USSC TO INVOKE MSVC AFTER DUMPING MVR     @Y30LB39*/
*        /*  PARAMETER LIST.                                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*                                                                  0935
*          IF GDTDBG = NULLPTR                                     0935
*            THEN;                                                 0935
         C     @14,GDTDBG(,@15)                                    0935
         BE    @RT00935                                            0935
*            ELSE                                                  0937
*              DO;                                                 0937
*                DMPINDEX = ADDR(DUMPLIST);                        /*@Y
*0LB39*/                                                           0938
*                                                                  0938
         LA    DMPINDEX,DUMPLIST                                   0938
*                DMPITMNM = 'MVRBUFR';                             0939
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0939
         MVC   DMPITMNM(7,DMPINDEX),@CC01610                       0939
*                DMPITMPT = ADDR(MVRBUFR);                         0940
         LA    @03,MVRBUFR                                         0940
         ST    @03,DMPITMPT(,DMPINDEX)                             0940
*                DMPITMLN = LENGTH(MVRBUFR);                       0941
         MVC   DMPITMLN(2,DMPINDEX),@CH01653                       0941
*                DMPITMTP = 'H';                                   0942
         MVI   DMPITMTP(DMPINDEX),C'H'                             0942
*                DMPINDEX = DMPINDEX + DMPELEMT;                   0943
*                                                                  0943
         AL    DMPINDEX,@CF00473                                   0943
*                DMPTRM = DMPTRMVL;                                0944
         MVI   DMPTRM(DMPINDEX),X'FF'                              0944
*              END;                                         /*@Y30LB39*
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       0946
*          THEN;                                                   0946
@RT00935 L     @15,@PC00001                                        0946
         L     @15,GDTDBG(,@15)                                    0946
         LTR   @15,@15                                             0946
         BZ    @RT00946                                            0946
*          ELSE                                                    0948
*            CALL IDCDB010 (GDTTBL,'RVFF',ADDR(DUMPLIST));         0948
         L     @15,@PC00001                                        0948
         ST    @15,@AL00001                                        0948
         LA    @14,@CC01611                                        0948
         ST    @14,@AL00001+4                                      0948
         LA    @14,DUMPLIST                                        0948
         ST    @14,@AFTEMPS+12                                     0948
         LA    @14,@AFTEMPS+12                                     0948
         ST    @14,@AL00001+8                                      0948
         MVI   @AL00001+8,X'80'                                    0948
         L     @15,GDTDBG(,@15)                                    0948
         LA    @01,@AL00001                                        0948
         BALR  @14,@15                                             0948
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        CALL IDCSASS0 (GDTTBL,VVIC,MVRPTR,REASON);        /*@Y30LB39*/
@RT00946 L     @02,@PC00001                                        0949
         ST    @02,@AL00001                                        0949
         LA    @15,VVIC                                            0949
         ST    @15,@AL00001+4                                      0949
         LA    @15,MVRPTR                                          0949
         ST    @15,@AL00001+8                                      0949
         LA    @15,REASON                                          0949
         ST    @15,@AL00001+12                                     0949
         MVI   @AL00001+12,X'80'                                   0949
         L     @15,GDTSSC(,@02)                                    0949
         LA    @01,@AL00001                                        0949
         BALR  @14,@15                                             0949
*                                                          /*@Y30LB39*/
*        RESPECIFY RTNREG RSTD;                                    0950
*        TESTRC = RTNREG;                                          0951
         LR    TESTRC,RTNREG                                       0951
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /***********************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF MSVC RETURNS A RETURN CODE OF TWELVE,        @Y30LB39*/
*        /*  IT MEANS THE FUNCTION WAS COMPLETED BUT AN      @Y30LB39*/
*        /*  I-O ERROR PREVENTED THE UPDATING OF THE         @Y30LB39*/
*        /*  MSV INVENTORY.  THIS RETURN CODE SHOULD BE      @Y30LB39*/
*        /*  TREATED AS A RETURN CODE OF ZERO, EXCEPT        @Y30LB39*/
*        /*  THAT THE FINAL CODE TO THE EXECUTIVE            @Y30LB39*/
*        /*  SHOULD BE AT LEAST FOUR.  THAT IS THE           @Y30LB39*/
*        /*  REASON FOR SETTING CC04FLG ON.                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /***********************************************************/
*                                                          /*@Y30LB39*/
*        IF TESTRC = 12 THEN                               /*@Y30LB39*/
         C     TESTRC,@CF00567                                     0953
         BNE   @RF00953                                            0953
*          DO;                                             /*@Y30LB39*/
*            TESTRC = LASTCC00;                            /*@Y30LB39*/
         SLR   TESTRC,TESTRC                                       0955
*            CC04FLG = ON;                                 /*@Y30LB39*/
         OI    CC04FLG,B'01000000'                                 0956
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /********************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CHECK IF THE INCOMPLETE COPY FLAG WAS           @Y30LB39*/
*        /*  SUCCESSFULLY CLEARED FROM THE MSVI              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                               /*@Y30LB39*/
@RF00953 LTR   TESTRC,TESTRC                                       0958
         BZ    @RF00958                                            0958
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  SET THE CONDITION CODE TO FOUR,             @Y30LB39*/
*            /*  IF MSVI NOT UPDATED                         @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            COPYRC = LASTCC04;                            /*@Y30LB39*/
         LA    @02,4                                               0960
         LR    COPYRC,@02                                          0960
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL SSCMSG TO OUTPUT APPROPRIATE           @Y30LB39*/
*            /*  REASON CODE IF RETURN CODE IS FOUR.         @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF TESTRC = LASTCC04 THEN                     /*@Y30LB39*/
         CR    TESTRC,@02                                          0961
         BNE   @RF00961                                            0961
*                                                          /*@Y30LB39*/
*              CALL SSCMSG (REASON);                       /*@Y30LB39*/
         LA    @15,REASON                                          0962
         ST    @15,@AL00001                                        0962
         LA    @01,@AL00001                                        0962
         BAL   @14,SSCMSG                                          0962
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE UPRINT FOR SECONDARY MESSAGE          @Y30LB39*/
*            /*  IDC3066I.                                   @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            DARGLIST = ''B;                               /*@Y30LB39*/
@RF00961 L     @15,DDSTRU                                          0963
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0963
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/
         MVC   DARGSMOD(3,@15),@CC01460                            0964
*            DARGSENT = MSG3066I;                          /*@Y30LB39*/
         MVI   DARGSENT(@15),X'2C'                                 0965
*                                                          /*@Y30LB39*/
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/
         L     @15,@PC00001                                        0966
         ST    @15,@AL00001                                        0966
         LA    @14,@CF00114                                        0966
         ST    @14,@AL00001+4                                      0966
         LA    @14,DDSTRU                                          0966
         ST    @14,@AL00001+8                                      0966
         MVI   @AL00001+8,X'80'                                    0966
         L     @15,GDTPRT(,@15)                                    0966
         LA    @01,@AL00001                                        0966
         BALR  @14,@15                                             0966
*                                                          /*@Y30LB39*/
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RF00958 LR    REG14,RETADDR2                                      0968
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(MVRRC);                               /*@Y30LB39*/
         LR    @15,MVRRC                                           0969
@EL00011 DS    0H                                                  0969
@EF00011 DS    0H                                                  0969
@ER00011 BR    @14                                                 0969
*END MVRRTN;                                               /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - LABELRTN                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  DIRECT THE VOLUME LABEL UPDATE                  @Y30LB39*/
*        /*  FOLLOWING THE COPY OPERATION IF THE OWNER       @Y30LB39*/
*        /*  OR SERIAL NUMBER MUST BE RESTORED.              @Y30LB39*/
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGE TO     @Y30LB39*/
*        /*  BE ISSUED:                                      @Y30LB39*/
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/
*        /*             AND SOURCE AND TARGET OWNERS ARE     @Y30LB39*/
*        /*             DIFFERENT.                           @Y30LB39*/
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/
*        /*             AND SOURCE AND TARGET VOLSERS ARE    @Y30LB39*/
*        /*             DIFFERENT.                           @Y30LB39*/
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/
*        /*             AND SOURCE AND TARGET OWNERS ARE     @Y30LB39*/
*        /*             DIFFERENT AND SOURCE AND TARGET      @Y30LB39*/
*        /*             VOLUME SERIAL NUMBERS ARE DIFFERENT. @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*          BASE VOLUME RECORD  (BASEV)             @Y30LB39*/
*        /*          COPY VOLUME RECORD  (COPYV)             @Y30LB39*/
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF DYNAMIC ALLOCATION FAILED OR         @Y30LB39*/
*        /*          PROCESSING DID NOT COMPLETE NORMALLY    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  0971
*LABELRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/
*                                                                  0971
LABELRTN DS    0H                                                  0972
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL LABELRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR1 = REG14;                                 /*@Y30LB39*/
         ST    REG14,RETADDR1                                      0973
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      0974
         L     @09,@PC00001                                        0974
         L     @09,GDTTR2(,@09)                                    0974
         MVC   @TS00001(95),NEWERID2(@09)                          0974
         MVC   OLDERID2(95,@09),@TS00001                           0974
*        NEWID2 = 'RVLB';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@09),@CC01616                              0975
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        LABELRC = LASTCC00;                               /*@Y30LB39*/
         SLR   LABELRC,LABELRC                                     0976
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @ZD00175*/
*        /* IF A UNIT HAS NOT BEEN ALLOCATED, EITHER SELECT A UNIT   */
*        /* FOR REUSE OR DYNAMICALLY ALLOCATE A UNIT AND MOUNT THE   */
*        /* VOLUME.                                          @ZD00175*/
*        /*                                                  @ZD00175*/
*        /************************************************************/
*                                                                  0977
*        IF RUNITDDN=EIGHTZRO THEN                                 0977
         CLC   RUNITDDN(8),EIGHTZRO                                0977
         BNE   @RF00977                                            0977
*          DO;                                             /*@ZD00175*/
*            GETDDFLG=ON;                                  /*@ZD00175*/
         OI    GETDDFLG,B'00001000'                                0979
*            CALL ALLOCRTN;                                /*@ZD00175*/
         BAL   @14,ALLOCRTN                                        0980
*            RESPECIFY RTNREG RSTD;                                0981
*            TESTRC = RTNREG;                                      0982
         LR    TESTRC,RTNREG                                       0982
*            RESPECIFY RTNREG UNRSTD;                      /*@ZD00175*/
*            IF TESTRC^=0 THEN                                     0984
         LTR   TESTRC,TESTRC                                       0984
         BZ    @RF00984                                            0984
*              LABELRC=LASTCC04;                           /*@ZD00175*/
*                                                                  0985
         LA    LABELRC,4                                           0985
*            /********************************************************/
*            /*                                              @ZD00175*/
*            /* INSURE THAT THE UNIT, IF DYNAMICALLY ALLOCATED, AND  */
*            /* THE TARGET VOLUME MOUNTED ON IT ARE ALLOCATED FOR    */
*            /* EXCLUSIVE USE.  EXCLAGL WAS INITIALIZED IN THE       */
*            /* ALLOCRTN PROCEDURE.                          @ZD00175*/
*            /*                                              @ZD00175*/
*            /********************************************************/
*                                                                  0986
*            ELSE                                                  0986
*              IF ALLOCFLG=ON THEN                                 0986
         B     @RC00984                                            0986
@RF00984 TM    ALLOCFLG,B'10000000'                                0986
         BNO   @RF00986                                            0986
*                DO;                                       /*@ZD00175*/
*                                                                  0987
*                  /**************************************************/
*                  /*                                        @ZD00175*/
*                  /* TAKE A FULL REGION DUMP BEFORE THE EXTERNAL    */
*                  /* CALL TO IDCSA06.                       @ZD00175*/
*                  /*                                        @ZD00175*/
*                  /**************************************************/
*                                                                  0988
*                  IF GDTDBG = NULLPTR                             0988
*                    THEN;                                         0988
         L     @09,@PC00001                                        0988
         L     @09,GDTDBG(,@09)                                    0988
         LTR   @09,@09                                             0988
         BZ    @RT00988                                            0988
*                    ELSE                                          0990
*                      CALL IDCDB010(GDTTBL,'RVII');               0990
         L     @09,@PC00001                                        0990
         ST    @09,@AL00001                                        0990
         LA    @04,@CC01617                                        0990
         ST    @04,@AL00001+4                                      0990
         MVI   @AL00001+4,X'80'                                    0990
         L     @15,GDTDBG(,@09)                                    0990
         LA    @01,@AL00001                                        0990
         BALR  @14,@15                                             0990
*                                                          /*@ZD00175*/
*                                                                  0991
*                  CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);  /*@ZD00175*/
@RT00988 L     @09,@PC00001                                        0991
         ST    @09,@AL00001                                        0991
         LA    @04,CHANGEX                                         0991
         ST    @04,@AL00001+4                                      0991
         LA    @04,EXCLAGLB                                        0991
         ST    @04,@AL00001+8                                      0991
         MVI   @AL00001+8,X'80'                                    0991
         L     @15,GDTUNT(,@09)                                    0991
         LA    @01,@AL00001                                        0991
         BALR  @14,@15                                             0991
*                  RESPECIFY RTNREG RSTD;                          0992
*                  TESTRC = RTNREG;                                0993
         LR    TESTRC,RTNREG                                       0993
*                  RESPECIFY RTNREG UNRSTD;                /*@ZD00175*/
*                                                                  0994
*                  IF TESTRC^=0 THEN                               0995
         LTR   TESTRC,TESTRC                                       0995
         BZ    @RF00995                                            0995
*                    LABELRC=LASTCC04;                     /*@ZD00175*/
         LA    LABELRC,4                                           0996
*                END;                                      /*@ZD00175*/
*              ELSE;                                       /*@ZD00175*/
@RF00986 DS    0H                                                  0999
*          END;                                            /*@ZD00175*/
*                                                                  0999
*        /************************************************************/
*        /*                                                  #Y30LB39*/
*        /*  A UNIT IS ALREADY ALLOCATED.  CALL VPREPRTN     #Y30LB39*/
*        /*  TO MOUNT THE TARGET VOLUME AFTER SETTING        #Y30LB39*/
*        /*  THE APPROPRIATE FLAGS IN THE PARM LIST.         #Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        ELSE                                              /*@Y30LB39*/
*          DO;                                             /*@Y30LB39*/
         B     @RC00977                                            1000
@RF00977 DS    0H                                                  1001
*            MOUNTFLG = ON;                                /*@Y30LB39*/
*            WAITFLG = OFF;                                /*@Y30LB39*/
         OI    MOUNTFLG,B'00100000'                                1002
         NI    WAITFLG,B'11101111'                                 1002
*            CALL VPREPRTN;                                /*@Y30LB39*/
         BAL   @14,VPREPRTN                                        1003
*            RESPECIFY RTNREG RSTD;                                1004
*            TESTRC = RTNREG;                                      1005
         LR    TESTRC,RTNREG                                       1005
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                           /*@Y30LB39*/
         LTR   TESTRC,TESTRC                                       1007
         BZ    @RF01007                                            1007
*              LABELRC = LASTCC04;                         /*@Y30LB39*/
         LA    LABELRC,4                                           1008
*          END;                                            /*@Y30LB39*/
@RF01007 DS    0H                                                  1010
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE CONDITION CODE IS NOT ZERO, THE LABEL    @Y30LB39*/
*        /*  UPDATE IS NOT ATTEMPTED.  ISSUE THE APPROPRI-   @Y30LB39*/
*        /*  ATE MESSAGES.                                   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF LABELRC ^= 0 THEN                              /*@Y30LB39*/
@RC00977 C     LABELRC,@CF00114                                    1010
         BE    @RF01010                                            1010
*          DO;                                             /*@Y30LB39*/
*            IF BASOWNER ^= COPOWNER & FVOLVAL ^= TVOLVAL THEN     1012
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            1012
         BE    @RF01012                                            1012
         L     @09,@PC00001+4                                      1012
         L     @07,FDTPTR(,@09)                                    1012
         L     @09,FDTPTR+4(,@09)                                  1012
         CLC   FVOLVAL(6,@07),TVOLVAL(@09)                         1012
         BE    @RF01012                                            1012
*              DO;                                         /*@Y30LB39*/
*                DARGLIST = ''B;                           /*@Y30LB39*/
         L     @09,DDSTRU                                          1014
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1014
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01460                            1015
*                DARGSENT = MSG3070C;                      /*@Y30LB39*/
         MVI   DARGSENT(@09),X'35'                                 1016
*                                                          /*@Y30LB39*/
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/
         L     @09,@PC00001                                        1017
         ST    @09,@AL00001                                        1017
         LA    @15,@CF00114                                        1017
         ST    @15,@AL00001+4                                      1017
         LA    @15,DDSTRU                                          1017
         ST    @15,@AL00001+8                                      1017
         MVI   @AL00001+8,X'80'                                    1017
         L     @15,GDTPRT(,@09)                                    1017
         LA    @01,@AL00001                                        1017
         BALR  @14,@15                                             1017
*                                                          /*@Y30LB39*/
*              END;                                        /*@Y30LB39*/
*            ELSE                                          /*@Y30LB39*/
*              DO;                                         /*@Y30LB39*/
         B     @RC01012                                            1019
@RF01012 DS    0H                                                  1020
*                IF BASOWNER ^= COPOWNER THEN              /*@Y30LB39*/
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            1020
         BE    @RF01020                                            1020
*                  DO;                                     /*@Y30LB39*/
*                    DARGLIST = ''B;                       /*@Y30LB39*/
         L     @09,DDSTRU                                          1022
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1022
*                    DARGSMOD = COMNMSG;                   /*@Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01460                            1023
*                    DARGSENT = MSG3070B;                  /*@Y30LB39*/
         MVI   DARGSENT(@09),X'27'                                 1024
*                                                          /*@Y30LB39*/
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30LB39*/
         L     @09,@PC00001                                        1025
         ST    @09,@AL00001                                        1025
         LA    @15,@CF00114                                        1025
         ST    @15,@AL00001+4                                      1025
         LA    @15,DDSTRU                                          1025
         ST    @15,@AL00001+8                                      1025
         MVI   @AL00001+8,X'80'                                    1025
         L     @15,GDTPRT(,@09)                                    1025
         LA    @01,@AL00001                                        1025
         BALR  @14,@15                                             1025
*                                                          /*@Y30LB39*/
*                  END;                                    /*@Y30LB39*/
*                IF FVOLVAL ^= TVOLVAL THEN                /*@Y30LB39*/
@RF01020 L     @09,@PC00001+4                                      1027
         L     @01,FDTPTR(,@09)                                    1027
         L     @09,FDTPTR+4(,@09)                                  1027
         CLC   FVOLVAL(6,@01),TVOLVAL(@09)                         1027
         BE    @RF01027                                            1027
*                  DO;                                     /*@Y30LB39*/
*                    DARGLIST = ''B;                       /*@Y30LB39*/
         L     @09,DDSTRU                                          1029
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1029
*                    DARGSMOD = COMNMSG;                   /*@Y30LB39*/
         MVC   DARGSMOD(3,@09),@CC01460                            1030
*                    DARGSENT = MSG3070A;                  /*@Y30LB39*/
         MVI   DARGSENT(@09),X'25'                                 1031
*                                                          /*@Y30LB39*/
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30LB39*/
         L     @09,@PC00001                                        1032
         ST    @09,@AL00001                                        1032
         LA    @15,@CF00114                                        1032
         ST    @15,@AL00001+4                                      1032
         LA    @15,DDSTRU                                          1032
         ST    @15,@AL00001+8                                      1032
         MVI   @AL00001+8,X'80'                                    1032
         L     @15,GDTPRT(,@09)                                    1032
         LA    @01,@AL00001                                        1032
         BALR  @14,@15                                             1032
*                                                          /*@Y30LB39*/
*                  END;                                    /*@Y30LB39*/
*              END;                                        /*@Y30LB39*/
*          END;                                            /*@Y30LB39*/
*        ELSE                                              /*@Y30LB39*/
*          DO;                                             /*@Y30LB39*/
         B     @RC01010                                            1036
@RF01010 DS    0H                                                  1037
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CALL VS2RTN FOR THE ACTUAL LABEL UPDATE.    @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL VS2RTN;                                  /*@Y30LB39*/
         BAL   @14,VS2RTN                                          1037
*            RESPECIFY RTNREG RSTD;                                1038
*            TESTRC = RTNREG;                                      1039
         LR    TESTRC,RTNREG                                       1039
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/
*            IF TESTRC ^= 0 THEN                           /*@Y30LB39*/
         LTR   TESTRC,TESTRC                                       1041
         BZ    @RF01041                                            1041
*              LABELRC = LASTCC04;                         /*@Y30LB39*/
         LA    LABELRC,4                                           1042
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE UDEQ TO RELEASE THE RESERVE SET BY    @Y30LB39*/
*            /*  IDCVS02 FOR THE LABEL UPDATE.  PLEASE NOTE  @Y30LB39*/
*            /*  THAT THE VOLUME IS NOT DEMOUNTED VIA        @Y30LB39*/
*            /*  IDCSA06 SINCE THE VOLUME WAS MOUNTED        @Y30LB39*/
*            /*  ORIGINALLY VIA UALLOC OR THRU OPEN OR       @Y30LB39*/
*            /*  BY ALLOCATION AT THE START OF THE JOB AND,  @Y30LB39*/
*            /*  THEREFORE, WILL BE DEMOUNTED BY SYSTEM      @ZD00175*/
*            /*  STEP TERMINATION.                           @ZD00175*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@Y30LB39*/
@RF01041 L     @09,@PC00001+4                                      1043
         L     @09,FDTPTR+4(,@09)                                  1043
         MVC   RNAMCHAR(6),TVOLVAL(@09)                            1043
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/
         MVC   RNAMCHAR+6(16),@CC01588                             1044
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@Y30LB39*/
         L     @09,@PC00001                                        1045
         ST    @09,@AL00001                                        1045
         LA    @06,@CC01523                                        1045
         ST    @06,@AL00001+4                                      1045
         LA    @06,MINORNAM                                        1045
         ST    @06,@AL00001+8                                      1045
         MVI   @AL00001+8,X'80'                                    1045
         L     @15,GDTDEQ(,@09)                                    1045
         LA    @01,@AL00001                                        1045
         BALR  @14,@15                                             1045
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  IF THE CONDITION CODE IS ZERO AND THE       @Y30LB39*/
*            /*  TARGET VOLUME SERIAL NUMBER WAS UPDATED     @Y30LB39*/
*            /*  THEN CALL MVRRTN TO CLEAR THE INCOMPLETE    @Y30LB39*/
*            /*  COPY FLAG FROM THE INVENTORY.  IF THE       @Y30LB39*/
*            /*  RETURN CODE IS NOT ZERO, SET CONDITION CODE @Y30LB39*/
*            /*  TO FOUR PRIOR TO EXITING THIS SUBROUTINE.   @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            IF LABELRC = 0 & FVOLVAL ^= TVOLVAL THEN      /*@Y30LB39*/
         C     LABELRC,@CF00114                                    1046
         BNE   @RF01046                                            1046
         L     @09,@PC00001+4                                      1046
         L     @06,FDTPTR(,@09)                                    1046
         L     @09,FDTPTR+4(,@09)                                  1046
         CLC   FVOLVAL(6,@06),TVOLVAL(@09)                         1046
         BE    @RF01046                                            1046
*              DO;                                         /*@Y30LB39*/
*                CALL MVRRTN;                              /*@Y30LB39*/
         BAL   @14,MVRRTN                                          1048
*                RESPECIFY RTNREG RSTD;                            1049
*                TESTRC = RTNREG;                                  1050
         LR    TESTRC,RTNREG                                       1050
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LB39*/
*                IF TESTRC ^= 0 THEN                       /*@Y30LB39*/
         LTR   TESTRC,TESTRC                                       1052
         BZ    @RF01052                                            1052
*                  LABELRC = LASTCC04;                     /*@Y30LB39*/
         LA    LABELRC,4                                           1053
*              END;                                        /*@Y30LB39*/
@RF01052 DS    0H                                                  1055
*          END;                                            /*@Y30LB39*/
@RF01046 DS    0H                                                  1056
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR1;                                 /*@Y30LB39*/
@RC01010 L     REG14,RETADDR1                                      1056
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(LABELRC);                             /*@Y30LB39*/
         LR    @15,LABELRC                                         1057
@EL00012 DS    0H                                                  1057
@EF00012 DS    0H                                                  1057
@ER00012 BR    @14                                                 1057
*END LABELRTN;                                             /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  PROCEDURE NAME - VS2RTN                         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/
*        /*  UPDATE THE VOLUME LABEL FOLLOWING THE           @Y30LB39*/
*        /*  COPY OPERATION.  AN EXTERNAL CALL TO IDCVS02    @Y30LB39*/
*        /*  IS MADE TO DO THE ACTUAL UPDATE.                @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/
*        /*          RECOVERV TABLE                          @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/
*        /*      4 - IF IDCVS02 RETURN CODE IS NOT ZERO      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                                  1059
*VS2RTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                  /*@Y30LB39*/
*                                                                  1059
VS2RTN   DS    0H                                                  1060
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL VS2RTRC FIXED(8);         /* RETURN CODE        @Y30LB39*/
*        DCL VOLVS02 CHAR(8) CONSTANT('IDCVS02 ');         /*@Y30LB39*/
*                                      /* CHARACTER STRING   @Y30LB39*/
*                                      /* USED TO IDENTIFY   @Y30LB39*/
*                                      /* EXTERNAL ROUTINE.  @Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETADDR2 = REG14;                                 /*@Y30LB39*/
         LR    RETADDR2,REG14                                      1062
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      1063
         L     @15,@PC00001                                        1063
         L     @15,GDTTR2(,@15)                                    1063
         MVC   @TS00001(95),NEWERID2(@15)                          1063
         MVC   OLDERID2(95,@15),@TS00001                           1063
*        NEWID2 = 'RVSV';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@15),@CC01625                              1064
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VS2RTRC = LASTCC00;                               /*@Y30LB39*/
         SLR   VS2RTRC,VS2RTRC                                     1065
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*        INITIALIZE THE VS2AGL PARAMETER LIST      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        VS2AGL = ''B;                                     /*@Y30LB39*/
         LA    @15,VS2AGLBF                                        1066
         XC    VS2AGL(52,@15),VS2AGL(@15)                          1066
*        VS2RES = ON;                                      /*@Y30LB39*/
         OI    VS2RES(@15),B'10000000'                             1067
*        VSUCBPTR = ADDR(RUNITUCB);                        /*@Y30LB39*/
         LA    @14,RUNITUCB                                        1068
         ST    @14,VSUCBPTR(,@15)                                  1068
*        VSDDNAME = RUNITDDN;                              /*@Y30LB39*/
         MVC   VSDDNAME(8,@15),RUNITDDN                            1069
*        VSVOLUME = TVOLVAL;                               /*@Y30LB39*/
         L     @14,@PC00001+4                                      1070
         L     @01,FDTPTR+4(,@14)                                  1070
         MVC   VSVOLUME(6,@15),TVOLVAL(@01)                        1070
*        VS2TOV = ON;                                      /*@Y30LB39*/
         OI    VS2TOV(@15),B'10000000'                             1071
*        IF COPOWNER ^= BASOWNER THEN                      /*@Y30LB39*/
         CLC   COPOWNER(10,COPYVPTR),BASOWNER(BASEVPTR)            1072
         BE    @RF01072                                            1072
*          DO;                                             /*@Y30LB39*/
*            VSOWNPTR = ADDR(BASOWNER);                    /*@Y30LB39*/
         LA    @05,BASOWNER(,BASEVPTR)                             1074
         ST    @05,VSOWNPTR(,@15)                                  1074
*            VSOWNER = ON;                                 /*@Y30LB39*/
         OI    VSOWNER(@15),B'10000000'                            1075
*          END;                                            /*@Y30LB39*/
*        IF FVOLVAL ^= TVOLVAL THEN                        /*@Y30LB39*/
@RF01072 L     @06,@PC00001+4                                      1077
         L     @05,FDTPTR(,@06)                                    1077
         L     @06,FDTPTR+4(,@06)                                  1077
         CLC   FVOLVAL(6,@05),TVOLVAL(@06)                         1077
         BE    @RF01077                                            1077
*          DO;                                             /*@Y30LB39*/
*            VSVOLPTR = ADDR(TVOLVAL);                     /*@Y30LB39*/
         LA    @05,VS2AGLBF                                        1079
         LA    @06,TVOLVAL(,@06)                                   1079
         ST    @06,VSVOLPTR(,@05)                                  1079
*            VSVOLSER = ON;                                /*@Y30LB39*/
         OI    VSVOLSER(@05),B'01000000'                           1080
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/
*        /*  TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF GDTDBG = NULLPTR                                       1082
*          THEN;                                                   1082
@RF01077 L     @06,@PC00001                                        1082
         L     @06,GDTDBG(,@06)                                    1082
         LTR   @06,@06                                             1082
         BZ    @RT01082                                            1082
*          ELSE                                                    1084
*            CALL IDCDB010 (GDTTBL,'RVSS');                        1084
         L     @06,@PC00001                                        1084
         ST    @06,@AL00001                                        1084
         LA    @05,@CC01626                                        1084
         ST    @05,@AL00001+4                                      1084
         MVI   @AL00001+4,X'80'                                    1084
         L     @15,GDTDBG(,@06)                                    1084
         LA    @01,@AL00001                                        1084
         BALR  @14,@15                                             1084
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  CALL IDCVS02 TO UPDATE THE VOLUME LABEL.        @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        CALL IDCSACL0 (GDTTBL,VOLVS02,PUTLABEL,VS2AGL);   /*@Y30LB39*/
@RT01082 L     @06,@PC00001                                        1085
         ST    @06,@AL00001                                        1085
         LA    @05,@CC01624                                        1085
         ST    @05,@AL00001+4                                      1085
         LA    @05,PUTLABEL                                        1085
         ST    @05,@AL00001+8                                      1085
         LA    @05,VS2AGLBF                                        1085
         ST    @05,@AL00001+12                                     1085
         MVI   @AL00001+12,X'80'                                   1085
         L     @15,GDTCAL(,@06)                                    1085
         LA    @01,@AL00001                                        1085
         BALR  @14,@15                                             1085
*                                                          /*@Y30LB39*/
*        RESPECIFY RTNREG RSTD;                                    1086
*        TESTRC = RTNREG;                                          1087
         LR    TESTRC,RTNREG                                       1087
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE RETURN CODE FROM IDCVS02 IS NOT ZERO,    @Y30LB39*/
*        /*  THEN SET CONDITION CODE TO FOUR IF THE RETURN   @Y30LB39*/
*        /*  CODE IS FOUR OR SET CC04FLG ON IF RETURN        @Y30LB39*/
*        /*  CODE IS EIGHT.                                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF TESTRC ^= 0 THEN                                       1089
         LTR   TESTRC,TESTRC                                       1089
         BZ    @RF01089                                            1089
*          IF TESTRC = 8 THEN                                      1090
         C     TESTRC,@CF00178                                     1090
         BNE   @RF01090                                            1090
*            CC04FLG = ON;                                 /*@Y30LB39*/
         OI    CC04FLG,B'01000000'                                 1091
*          ELSE                                                    1092
*            IF TESTRC = LASTCC04 THEN                             1092
         B     @RC01090                                            1092
@RF01090 LA    @06,4                                               1092
         CR    TESTRC,@06                                          1092
         BNE   @RF01092                                            1092
*              VS2RTRC = LASTCC04;                         /*@Y30LB39*/
         LR    VS2RTRC,@06                                         1093
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        REG14 = RETADDR2;                                 /*@Y30LB39*/
@RF01092 DS    0H                                                  1094
@RC01090 DS    0H                                                  1094
@RF01089 LR    REG14,RETADDR2                                      1094
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        RETURN CODE(VS2RTRC);                             /*@Y30LB39*/
         LR    @15,VS2RTRC                                         1095
@EL00013 DS    0H                                                  1095
@EF00013 DS    0H                                                  1095
@ER00013 BR    @14                                                 1095
*END VS2RTN;                                               /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO      @Y30LB39*/
*        /*  OUTPUT SSC MESSAGES.                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*/***********************************************************@Y30LB39*/
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/
*/*   IN SSECBCD.                                            @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/
*/*                                                          @Y30LB39*/
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/
*/*                                                          @Y30LB39*/
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/
*/*                                                          @Y30LB39*/
*/***********************************************************@Y30LB39*/
*                                                          /*@Y30LB39*/
*SSCMSG: PROCEDURE(SSRCODE,            /* SSC RETURN CODE    @Y30LB39*/
*                  SSECBCD);           /* ECB POST CODE      @Y30LB39*/
SSCMSG   STM   @14,@12,@SA00014                                    1097
         MVC   @PC00014(8),0(@01)                                  1097
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  DECLARATIONS FOR THE SSCMSG PROCEDURE           @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT TWO DECLARES ARE FOR THE TWO INPUT     @Y30LB39*/
*        /*  ARGUMENTS. 1ST - MSSC REASON CODE OR            @Y30LB39*/
*        /*  2ND - MSSC POST CODE                            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL 1 SSRCODE FIXED(31),                          /*@Y30LB39*/
*              3 * FIXED(15),                              /*@Y30LB39*/
*              3 SSRHALF FIXED(15);    /*1ST ARG REASON CODE @Y30LB39*/
*        DCL SSECBCD PTR(8);           /*2ND ARG POST CODE   @Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND @Y30LB39*/
*        /*  CONTAIN THE "LOCAL" PRINT ARGUMENT LIST         @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DCL SSDLPTR PTR(31);                              /*@Y30LB39*/
*        DCL SSDRGLT CHAR(LENGTH(DARGLIST));               /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT DECLARE IS FOR THE INDEX WHICH IS      @Y30LB39*/
*        /*  INCREMENTED WHILE SEARCHING THE ARRAY OF        @Y30LB39*/
*        /*  REASON CODES AND, UPON FINDING THE CORRECT      @Y30LB39*/
*        /*  REASON CODE, IS PASSED TO PRINT MODULE AS THE   @Y30LB39*/
*        /*  INDEX OF THE MESSAGE NUMBER TO BE PRINTED.      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DECLARE ENTRYNUM FIXED(8) UNSIGNED;               /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT DECLARE IS FOR THE COMMON MESSAGE      @Y30LB39*/
*        /*  NUMBER TO IDENTIFY THE ECB POST CODE            @Y30LB39*/
*        /*  MESSAGE CONTAINED IN STATIC TEXT MODULE         @Y30LB39*/
*        /*  IDCTSCM0.                                       @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DECLARE SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);  /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT DECLARE IS FOR THE ARRAY WHICH IS      @Y30LB39*/
*        /*  SEARCHED FOR THE REASON CODE CORRESPONDING      @Y30LB39*/
*        /*  TO THE MESSAGE INDEX AND ULTIMATELY, THE        @Y30LB39*/
*        /*  MESSAGE TEXT TO BE PRINTED TO THE USER TELLING  @Y30LB39*/
*        /*  HIM OF THE EXACT REASON FOR THE MSSC FAILURE.   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DECLARE 1 SSINXLST BDY(WORD),                     /*@Y30LB39*/
*                  3 SSARRAY (60) FIXED(15);               /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT DECLARATION IS FOR THE MESSAGE ID      @Y30LB39*/
*        /*  USED BY THE STATIC TEXT MODULE - IDCTSSS0.      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DECLARE SSMODSS0 CHAR(3) STATIC INIT('SS0');      /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE NEXT DECLARATION IS FOR THE MESSAGE ID      @Y30LB39*/
*        /*  USED BY THE STATIC TEXT MODULE - IDCTSCMO.      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        DECLARE SSMODCM0 CHAR(3) STATIC INIT('CM0');      /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/
*        /*  ON CONTROL WITHIN THE SSMSG MODULE.             @Y30LB39*/
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        OLDERID2 = NEWERID2;                                      1107
         L     @15,@PC00001                                        1107
         L     @14,GDTTR2(,@15)                                    1107
         MVC   @TS00001(95),NEWERID2(@14)                          1107
         MVC   OLDERID2(95,@14),@TS00001                           1107
*        NEWID2 = 'SSAA';                                  /*@Y30LB39*/
         MVC   NEWID2(4,@14),@CC01647                              1108
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ESTABLISH ADDRESSABILITY TO THE DYNAMIC         @Y30LB39*/
*        /*  ARGUMENT LIST.                                  @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        SSDLPTR = ADDR(SSDRGLT);                          /*@Y30LB39*/
         LA    @14,SSDRGLT                                         1109
         ST    @14,SSDLPTR                                         1109
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  IF THE REASON CODE IS NOT ZERO, READ IN THE     @Y30LB39*/
*        /*  ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.   @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        IF SSRCODE > 0 THEN                                       1110
         L     @09,@PC00014                                        1110
         L     @09,SSRCODE(,@09)                                   1110
         LTR   @09,@09                                             1110
         BNP   @RF01110                                            1110
*          DO;                                             /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  CLEAR THE DYNAMIC ARGUMENT LIST AND         @Y30LB39*/
*            /*  INITIALIZE THE PRINT ARGUMENT LIST TO READ  @Y30LB39*/
*            /*  IN THE ARRAY WHICH CONTAINS THE MSSC REASON @Y30LB39*/
*            /*  CODES.                                      @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            SSDRGLT = ''B;                                /*@Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1112
*            SSDLPTR -> DARGRETP = ADDR(SSINXLST);         /*@Y30LB39*/
         LA    @03,SSINXLST                                        1113
         ST    @03,DARGRETP(,@14)                                  1113
*            SSDLPTR -> DARGSMOD = SSMODSS0;               /*@Y30LB39*/
         MVC   DARGSMOD(3,@14),SSMODSS0                            1114
*            SSDLPTR -> DARGSENT = 1;                      /*@Y30LB39*/
         MVI   DARGSENT(@14),X'01'                                 1115
*            SSDLPTR -> DARGRETL = LENGTH(SSINXLST);       /*@Y30LB39*/
         MVC   DARGRETL(2,@14),@CH01654                            1116
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  ISSUE UPRINT MACRO TO READ IN THE SEARCH    @Y30LB39*/
*            /*  ARRAY.                                      @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            CALL AMSTP011 (GDTTBL,PRTFILE,SSDLPTR);       /*@Y30LB39*/
         ST    @15,@AL00001                                        1117
         LA    @03,@CF00114                                        1117
         ST    @03,@AL00001+4                                      1117
         LA    @03,SSDLPTR                                         1117
         ST    @03,@AL00001+8                                      1117
         MVI   @AL00001+8,X'80'                                    1117
         L     @15,GDTPRT(,@15)                                    1117
         LA    @01,@AL00001                                        1117
         BALR  @14,@15                                             1117
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  BEGIN DO LOOP TO SEARCH FOR THE MESSAGE     @Y30LB39*/
*            /*  INDEX CORRESPONDING TO THE REASON CODE      @Y30LB39*/
*            /*  PASSED AS THE FIRST ARGUMENT.               @Y30LB39*/
*            /*  THE DO LOOP BEGINS WITH THE SECOND ARRAY    @Y30LB39*/
*            /*  ENTRY SINCE THE FIRST IS REQUIRED BY THE    @Y30LB39*/
*            /*  SEARCH ARRAY ITSELF.                        @Y30LB39*/
*            /*  THE SEARCH CONTINUES UNTIL THE REASON CODE  @Y30LB39*/
*            /*  IS FOUND, AT WHICH TIME THE SEARCH INDEX    @Y30LB39*/
*            /*  IS PASSED TO THE PRINT MODULE TO PRINT      @Y30LB39*/
*            /*  THE MESSAGE ASSOCIATED WITH THAT PARTICULAR @Y30LB39*/
*            /*  REASON CODE.                                @Y30LB39*/
*            /*  IF THERE IS NO MATCH FOUND IN THE ARRAY,    @Y30LB39*/
*            /*  THEN THE INDEX WILL BE THE LAST POSITION IN @Y30LB39*/
*            /*  ARRAY.  THIS WILL BE THE INDICATION THAT    @Y30LB39*/
*            /*  THE REASON CODE ITSELF SHOULD BE PRINTED.   @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            ENTRYNUM = 1;                                 /*@Y30LB39*/
         LA    ENTRYNUM,1                                          1118
*            DO UNTIL (SSRHALF=SSARRAY(ENTRYNUM)×SSARRAY(ENTRYNUM)=0);
@DL01119 DS    0H                                                  1120
*              ENTRYNUM = ENTRYNUM + 1;                    /*@Y30LB39*/
         AL    ENTRYNUM,@CF00218                                   1120
*            END;                                          /*@Y30LB39*/
@DE01119 L     @03,@PC00014                                        1121
         LR    @15,ENTRYNUM                                        1121
         ALR   @15,@15                                             1121
         LH    @15,SSARRAY-2(@15)                                  1121
         CH    @15,SSRHALF(,@03)                                   1121
         BE    @DC01119                                            1121
         SLR   @14,@14                                             1121
         CR    @15,@14                                             1121
         BNE   @DL01119                                            1121
@DC01119 DS    0H                                                  1122
*                                                          /*@Y30LB39*/
*            /********************************************************/
*            /*                                              @Y30LB39*/
*            /*  THE CORRECT INDEX HAS BEEN FOUND            @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /*  CLEAR THE DYNAMIC ARGUMENT LIST AND FILL    @Y30LB39*/
*            /*  OUT THE PRINT ARGUMENT FIELDS WITH EITHER:  @Y30LB39*/
*            /*    1) THE INDEX CORRESPONDING TO THE REASON  @Y30LB39*/
*            /*       CODE OR                                @Y30LB39*/
*            /*    2) THE LAST INDEX AND THE REASON CODE     @Y30LB39*/
*            /*       ITSELF AS A STATIC TEXT INSERT.        @Y30LB39*/
*            /*                                              @Y30LB39*/
*            /********************************************************/
*                                                          /*@Y30LB39*/
*            SSDRGLT = ''B;                                /*@Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1122
*            SSDLPTR -> DARGSMOD = SSMODSS0;               /*@Y30LB39*/
         L     @09,SSDLPTR                                         1123
         MVC   DARGSMOD(3,@09),SSMODSS0                            1123
*            SSDLPTR -> DARGSENT = ENTRYNUM;               /*@Y30LB39*/
         STC   ENTRYNUM,DARGSENT(,@09)                             1124
*            IF SSARRAY(ENTRYNUM) = 0 THEN                 /*@Y30LB39*/
         CR    @15,@14                                             1125
         BNE   @RF01125                                            1125
*              DO;                                         /*@Y30LB39*/
*                SSDLPTR -> DARGDBP = ADDR(SSRCODE);       /*@Y30LB39*/
         ST    @03,DARGDBP(,@09)                                   1127
*                SSDLPTR -> DARGILP = LENGTH(SSRCODE);     /*@Y30LB39*/
         MVC   DARGILP(2,@09),@CH00041                             1128
*              END;                                        /*@Y30LB39*/
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  THE FIRST ARGUMENT WAS ZERO, INDICATING THAT    @Y30LB39*/
*        /*  THIS ROUTINE IS TO PRINT OUT THE ECB POST       @Y30LB39*/
*        /*  CODE.  THEREFORE, CLEAR THE DYNAMIC ARGUMENT    @Y30LB39*/
*        /*  LIST AND FILL OUT THE PRINT ARGUMENT FIELDS     @Y30LB39*/
*        /*  SO THE STATIC TEXT MODULE, IDCTSCM0, WILL       @Y30LB39*/
*        /*  PRINT OUT THE MESSAGE ASSOCIATED WITH THE       @Y30LB39*/
*        /*  POST CODE.                                      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        ELSE                                              /*@Y30LB39*/
*          DO;                                             /*@Y30LB39*/
         B     @RC01110                                            1131
@RF01110 DS    0H                                                  1132
*            SSDRGLT = ''B;                                /*@Y30LB39*/
         XC    SSDRGLT(20),SSDRGLT                                 1132
*            SSDLPTR -> DARGSMOD = SSMODCM0;               /*@Y30LB39*/
         L     @15,SSDLPTR                                         1133
         MVC   DARGSMOD(3,@15),SSMODCM0                            1133
*            SSDLPTR -> DARGSENT = SSMSGNUM;               /*@Y30LB39*/
         MVC   DARGSENT(1,@15),SSMSGNUM                            1134
*            SSDLPTR -> DARGDBP = ADDR(SSECBCD);           /*@Y30LB39*/
         L     @14,@PC00014+4                                      1135
         ST    @14,DARGDBP(,@15)                                   1135
*            SSDLPTR -> DARGILP = LENGTH(SSECBCD);         /*@Y30LB39*/
         MVC   DARGILP(2,@15),@CH00218                             1136
*          END;                                            /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  ISSUE UPRINT MACRO TO PRINT THE REASON          @Y30LB39*/
*        /*  CODE MESSAGE OR THE ECB POST CODE MESSAGE.      @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*        CALL AMSTP011 (GDTTBL,PRTFILE,SSDLPTR);           /*@Y30LB39*/
@RC01110 L     @15,@PC00001                                        1138
         ST    @15,@AL00001                                        1138
         LA    @14,@CF00114                                        1138
         ST    @14,@AL00001+4                                      1138
         LA    @14,SSDLPTR                                         1138
         ST    @14,@AL00001+8                                      1138
         MVI   @AL00001+8,X'80'                                    1138
         L     @15,GDTPRT(,@15)                                    1138
         LA    @01,@AL00001                                        1138
         BALR  @14,@15                                             1138
*                                                          /*@Y30LB39*/
*        /************************************************************/
*        /*                                                  @Y30LB39*/
*        /*  RETURN TO CALLER WITH A RETURN CODE OF ZERO     @Y30LB39*/
*        /*                                                  @Y30LB39*/
*        /************************************************************/
*                                                          /*@Y30LB39*/
*                                                          /*@Y30LB39*/
*        RETURN CODE(0);                                   /*@Y30LB39*/
         SLR   @15,@15                                             1139
         L     @14,@SA00014                                        1139
         LM    @00,@12,@SA00014+8                                  1139
         BR    @14                                                 1139
*                                                          /*@Y30LB39*/
*        END SSCMSG;                                       /*@Y30LB39*/
*END IDCRV01                                               /*@Y30LB39*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        *
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        *
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        *
*/*%INCLUDE SYSLIB  (IDCDF04 )                                        *
*/*%INCLUDE SYSLIB  (IDCCSRV )                                        *
*/*%INCLUDE SYSLIB  (IEZRVVI )                                        *
*/*%INCLUDE SYSLIB  (IEZMVR  )                                        *
*/*%INCLUDE SYSLIB  (IEZBASEV)                                        *
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                        *
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                        *
*/*%INCLUDE SYSLIB  (IDCDF52 )                                        *
*;                                                                 1141
@DATA    DS    0H
@CH00152 DC    H'2'
@CH00041 DC    H'4'
@CH00285 DC    H'5'
@CH00847 DC    H'29'
@CH01209 DC    H'30'
@CH00043 DC    H'31'
@CH01652 DC    H'40'
@CH01503 DC    H'43'
@CH01653 DC    H'88'
@CH01654 DC    H'120'
@CH01649 DC    H'164'
@CH01648 DC    H'224'
         DS    0F
@AL00282 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)
         DC    A(WAIT)
         DC    A(@CC01523)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00014 DS    15F
@PC00014 DS    2F
@AL00001 DS    5A
@AFTEMPS DS    4F
IDCRV01  CSECT
         DS    0F
@CF00114 DC    F'0'
@CF00218 DC    F'1'
@CH00218 EQU   @CF00218+2
@CF00178 DC    F'8'
@CF00567 DC    F'12'
@CH00567 EQU   @CF00567+2
@CF00473 DC    F'16'
@CF01669 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
RVVIPTR  DS    A
MVRPTR   DS    A
COVCPTR  DS    A
COVCEPTR DS    A
REASON   DS    F
RETADDR1 DS    A
SEQ#XVAL DS    F
SSDLPTR  DS    A
LISTPTR  DS    A
SETRC    DS    H
ECBBYTE  DS    FL1
SETUPRC  DS    FL1
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
PRINTTAB DS    CL44
ALLAGLBF DS    CL31
         DS    CL1
CKAGLBUF DS    CL29
         DS    CL3
VS1AGLBF DS    CL74
         DS    CL2
VS2AGLBF DS    CL52
MDAGLBUF DS    CL37
         DS    CL3
COVCEBUF DS    CL43
         DS    CL1
MVRBUFR  DS    CL88
RVVIBUFR DS    CL68
COVLISTB DS    CL40
EXCLAGLB DS    CL23
         DS    CL1
BASVOLBD DS    CL224
COPVOLBD DS    CL164
RECVTBL  DS    CL25
         ORG   RECVTBL
RECVTBC  DS    CL8
RUNITUCB DS    AL4
RUNITDDN DS    CL8
RECTYPE  DS    CL4
RECVFLGS DS    BL1
         ORG   RECVFLGS
ALLOCFLG DS    BL1
CC04FLG  EQU   RECVFLGS+0
MOUNTFLG EQU   RECVFLGS+0
WAITFLG  EQU   RECVFLGS+0
GETDDFLG EQU   RECVFLGS+0
DEMNTFLG EQU   RECVFLGS+0
@NM00115 EQU   RECVFLGS+0
         ORG   RECVTBL+25
MINORNAM DS    CL23
         ORG   MINORNAM
RNAMLNTH DS    FL1
RNAMCHAR DS    CL22
         ORG   MINORNAM+23
RVULLIST DS    CL9
         ORG   RVULLIST
RVULNUM  DS    FL2
RVULARAY DS    CL7
         ORG   RVULARAY
RVULLNTH DS    FL2
RVULTYPE DS    CL5
         ORG   RVULLIST+9
         DS    CL3
VOLSERLT DS    CL10
         ORG   VOLSERLT
VOLNUMBR DS    FL2
VOLARRAY DS    CL8
         ORG   VOLARRAY
VOLLENTH DS    FL2
VOLSERNM DS    CL6
         ORG   VOLSERLT+10
         DS    CL2
DUMPLIST DS    CL33
DATECHAR DS    CL4
SSDRGLT  DS    CL20
         DS    CL3
SSINXLST DS    CL120
         ORG   SSINXLST
SSARRAY  DS    60H
         ORG   SSINXLST+120
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCRV01  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
NOTFOUND DC    F'520'
SEQ#DFLT DC    F'1'
RVVLEN   DC    AL2(68)
MVRLEN   DC    AL2(88)
COVLEN   DC    AL2(43)
ONEZERO  DC    AL1(0)
SSMSGNUM DC    AL1(56)
@CC01521 DC    C'.VIRTUAL.ENQUEUE'
@CC01588 DC    C'.VIRTUAL.RESERVE'
@CC01520 DC    C'RECVTBL '
@CC01523 DC    C'SYSZAMS '
@CC01576 DC    C'ALLAGLBF'
@CC01578 DC    C'CKAGLBUF'
@CC01585 DC    C'IDCVS01 '
@CC01596 DC    C'COVLISTB'
@CC01597 DC    C'COVCEBUF'
@CC01624 DC    C'IDCVS02 '
@CC01610 DC    C'MVRBUFR'
@CC01575 DC    C'3330V'
@CC01505 DC    C'RVST'
@CC01506 DC    C'RVBG'
@CC01528 DC    C'RVND'
@CC01533 DC    C'RVSU'
@CC01541 DC    C'RVVO'
@CC01554 DC    C'RVRV'
@CC01556 DC    C'RVVI'
@CC01558 DC    C'RVRR'
@CC01564 DC    C'RVFV'
@CC01569 DC    C'RVTV'
@CC01574 DC    C'RVAL'
@CC01577 DC    C'RVAA'
@CC01579 DC    C'RVBB'
@CC01586 DC    C'RVVS'
@CC01587 DC    C'RVCH'
@CC01594 DC    C'RVCP'
@CC01595 DC    C'RVHH'
@CC01598 DC    C'RVEE'
@CC01604 DC    C'RVVP'
@CC01609 DC    C'RVMV'
@CC01611 DC    C'RVFF'
@CC01616 DC    C'RVLB'
@CC01617 DC    C'RVII'
@CC01625 DC    C'RVSV'
@CC01626 DC    C'RVSS'
@CC01647 DC    C'SSAA'
@CC01458 DC    C'RV0'
@CC01460 DC    C'CM0'
@CC01462 DC    C'UV0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
RVOPENR  DC    CL8'OPENR   '
RVRDCNT  DC    CL8'READCNT '
RVREADKD DC    CL8'READKD  '
RVSPACCR DC    CL8'SPACCR  '
RVFWRITE DC    CL8'FWRITE  '
RVWRITER DC    CL8'WRITEREC'
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
MODID    DC    CL4'RV01'
FIXAREA  DS    CL512
         ORG   FIXAREA
@NM00116 DC    256X'00'
@NM00117 DC    256X'00'
         ORG   FIXAREA+512
BASECHAR DC    CL4'BASE'
COPYCHAR DC    CL4'COPY'
HEXFF    DC    X'FF'
BLNKAREA DC    CL1' '
THIRTYBK DS    CL30
         ORG   THIRTYBK
@NM00118 DC    30CL1' '
         ORG   THIRTYBK+30
EIGHTZRO DS    CL8
         ORG   EIGHTZRO
@NM00119 DC    8X'00'
         ORG   EIGHTZRO+8
ZEROS31  DS    CL31
         ORG   ZEROS31
@NM00120 DC    31X'00'
         ORG   ZEROS31+31
SSMODSS0 DC    CL3'SS0'
SSMODCM0 DC    CL3'CM0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ENTRYNUM EQU   @02
VS2RTRC  EQU   @04
LABELRC  EQU   @08
MVRRC    EQU   @04
VPREPRC  EQU   @04
COPYRC   EQU   @07
VTOCKRC  EQU   @04
ALLOCRC  EQU   @04
TVOLRC   EQU   @03
FVOLRC   EQU   @03
RVVIRC   EQU   @08
VOLCHKRC EQU   @07
RETADDR3 EQU   @04
RETADDR2 EQU   @09
COPYVPTR EQU   @05
BASEVPTR EQU   @06
DMPINDEX EQU   @02
TESTRC   EQU   @03
REG10    EQU   @10
REG12    EQU   @12
RTNREG   EQU   @15
REG14    EQU   @14
CVOLR1   EQU   @01
REG0     EQU   @00
REG1     EQU   @01
REG11    EQU   @11
REG13    EQU   @13
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
IDCSACL0 EQU   0
IDCSAEP0 EQU   0
IDCSAAL0 EQU   0
IDCSASS0 EQU   0
IDCSANQ0 EQU   0
IDCSADQ0 EQU   0
IDCSA060 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLDDN   EQU   ALLAGL+4
ALLULP   EQU   ALLAGL+12
ALLVLP   EQU   ALLAGL+16
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
ALLOPTVL EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLVLCNT EQU   ALLAGL+29
ALLUNCNT EQU   ALLAGL+30
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IDCIOCL0 EQU   0
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGRETP EQU   DARGLIST+4
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGRETL EQU   DARGLIST+16
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
EROPER   EQU   ERCNVTAB+1
EROSOPER EQU   ERCNVTAB+2
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDUCBPTR EQU   MDAGL+8
MDDDNAME EQU   MDAGL+12
MDLABEL  EQU   MDAGL+24
MDFLAGS  EQU   MDAGL+30
MDWAIT   EQU   MDFLAGS
MDVTOC   EQU   MDAGL+32
PUAGL    EQU   0
CKAGL    EQU   0
CKUCBPTR EQU   CKAGL+8
CKDDNAME EQU   CKAGL+12
CKLABELP EQU   CKAGL+24
CKFLAGS  EQU   CKAGL+28
CKTESTVT EQU   CKFLAGS
EXCLAGL  EQU   0
EXCLUCBP EQU   EXCLAGL+8
EXCLDDP  EQU   EXCLAGL+12
EXCLVOL  EQU   EXCLAGL+16
EXCLFLAG EQU   EXCLAGL+22
EXCLMNT  EQU   EXCLFLAG
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXWRARG  EQU   0
EXRWCHR  EQU   EXWRARG+26
EXSPACE  EQU   EXWRARG+36
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSUCBPTR EQU   VS2AGL+8
VSOWNPTR EQU   VS2AGL+16
VSVOLPTR EQU   VS2AGL+20
VSLABOPT EQU   VS2AGL+28
VSOWNER  EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSVOLUME EQU   VS2AGL+29
VS2MSG   EQU   VS2AGL+35
VS2TOV   EQU   VS2MSG
VS2RESOP EQU   VS2AGL+36
VS2RES   EQU   VS2RESOP
VSDDNAME EQU   VS2AGL+37
VS1AGL   EQU   0
VSUCBP   EQU   VS1AGL+8
VSVOLP   EQU   VS1AGL+12
VSFILEP  EQU   VS1AGL+16
VSIOP    EQU   VS1AGL+20
VSCATP   EQU   VS1AGL+32
VSCATDDP EQU   VS1AGL+40
VSPSWDP  EQU   VS1AGL+44
VSPFILEP EQU   VS1AGL+48
VSSECOPT EQU   VS1AGL+68
VSNOVSAM EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSTOV    EQU   VSMSG
VSRESOPT EQU   VS1AGL+73
VSRES    EQU   VSRESOPT
RCTAGL   EQU   0
RCTOPT   EQU   RCTAGL+8
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00072 EQU   SV82LIST+4
SV82DCBP EQU   @NM00072
@NM00073 EQU   SV82LIST+12
SV82WRKP EQU   @NM00073
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTFLAGS EQU   LCTINFO+32
UCTAGL   EQU   0
UCTFLAGS EQU   UCTAGL+68
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
FVOL     EQU   0
FVOLLEN  EQU   FVOL
FVOLVAL  EQU   FVOL+1
TVOL     EQU   0
TVOLLEN  EQU   TVOL
TVOLVAL  EQU   TVOL+1
DATE     EQU   0
DATEVAL  EQU   DATE
SEQ#     EQU   0
SEQ#VAL  EQU   SEQ#
LBKUP    EQU   0
CAT      EQU   0
CATNM    EQU   0
CATNMPLN EQU   CATNM
CATNMPAS EQU   CATNM+1
CATNMFLG EQU   CATNM+10
CATNMVAL EQU   CATNM+21
CATDN    EQU   0
CATDNVAL EQU   CATDN+1
FILE     EQU   0
FILEVAL  EQU   FILE+1
PFILE    EQU   0
@NM00091 EQU   PFILE+2
RVVI     EQU   0
RVVLNGTH EQU   RVVI
RVVOPCOD EQU   RVVI+4
RVVCODE  EQU   RVVOPCOD
RVVOLUME EQU   RVVI+8
RVVBUFLN EQU   RVVI+30
RVVRTBUF EQU   RVVI+32
RVVCDATE EQU   RVVI+38
RVVRDSEQ EQU   RVVI+43
RVVFLAGA EQU   RVVI+58
RVVRMODE EQU   RVVFLAGA
RVVRDR   EQU   RVVRMODE
RVVCHAIN EQU   RVVFLAGA+1
RVVRDRCD EQU   RVVFLAGA+2
RVVBVRCD EQU   RVVRDRCD
RVVCPYRC EQU   RVVRDRCD
RVVRTEST EQU   RVVFLAGA+3
RVVCPYTP EQU   RVVFLAGA+4
RVVLBKUP EQU   RVVCPYTP
RVVSPEC  EQU   RVVFLAGA+5
RVVSDTE  EQU   RVVSPEC
RVVSSEQ  EQU   RVVSPEC
RVVSVOL  EQU   RVVSPEC
MVR      EQU   0
MVRLNGTH EQU   MVR
MVRCODE  EQU   MVR+4
MVRFLAGA EQU   MVR+8
MVRCICPY EQU   MVRFLAGA+2
MVRBVOL  EQU   MVR+12
BASEV    EQU   0
BASNAME  EQU   BASEV
BASID    EQU   BASNAME+11
BASFLAGA EQU   BASEV+14
BASTYPE  EQU   BASFLAGA
BASINAC  EQU   BASFLAGA+2
BASRCVYF EQU   BASEV+20
BASSATIA EQU   BASRCVYF
BASIVCRE EQU   BASSATIA
BASIVCPY EQU   BASSATIA
BASVSMIS EQU   BASSATIA
BASMISCF EQU   BASRCVYF+2
BASLIB1  EQU   BASEV+36
BASLID1  EQU   BASLIB1
BASLIB2  EQU   BASEV+49
BASLID2  EQU   BASLIB2
BASKLCPY EQU   BASEV+76
BASCOPID EQU   BASKLCPY+11
BASOWNER EQU   BASEV+134
COPYV    EQU   0
COPNAME  EQU   COPYV
COPID    EQU   COPNAME+11
COPFLAGA EQU   COPYV+14
COPTYPE  EQU   COPFLAGA
COPVSAM  EQU   COPFLAGA+2
COPRCVYF EQU   COPYV+20
COPSATIA EQU   COPRCVYF
COPMISCF EQU   COPRCVYF+2
COPCSN1  EQU   COPYV+24
COPLIB1  EQU   COPYV+36
COPLID1  EQU   COPLIB1
COPCSN2  EQU   COPYV+37
COPLIB2  EQU   COPYV+49
COPLID2  EQU   COPLIB2
COPDATE  EQU   COPYV+50
COPDEST  EQU   COPYV+88
COPOWNER EQU   COPYV+118
COVLIST  EQU   0
CVOLFLG  EQU   COVLIST+6
CVOCRCRV EQU   CVOLFLG
CVOLID   EQU   COVLIST+8
CVOLCSN  EQU   COVLIST+20
CVOLVEXT EQU   COVLIST+36
COVCE    EQU   0
COVLNGTH EQU   COVCE
COVFLAGA EQU   COVCE+34
COVFLAGB EQU   COVCE+35
COVSETFL EQU   COVFLAGB
COVSRCVY EQU   COVSETFL
COVRECFL EQU   COVFLAGB+1
COVICOPY EQU   COVRECFL
COVTYPE  EQU   COVFLAGB+2
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
CDATE    EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSACA0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASC0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCST010 EQU   0
IDCTPER0 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
FDTTBL   EQU   0
FDTPTR   EQU   FDTTBL+8
LASTCOND EQU   0
SSRCODE  EQU   0
SSRHALF  EQU   SSRCODE+2
SSECBCD  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00121 EQU   SSRCODE
FDTVERB  EQU   FDTTBL
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00114 EQU   COVCE+39
@NM00113 EQU   COVFLAGB+3
@NM00112 EQU   COVTYPE
COVREUSE EQU   COVTYPE
COVSAM   EQU   COVTYPE
@NM00111 EQU   COVRECFL
COVLAMIS EQU   COVRECFL
COVCREAT EQU   COVRECFL
@NM00110 EQU   COVSETFL
COVCRCVY EQU   COVSETFL
@NM00109 EQU   COVFLAGA
COVSPDES EQU   COVFLAGA
COVDESCR EQU   COVCE+4
CVOLRES2 EQU   COVLIST+34
CVOLRUA  EQU   COVLIST+32
CVOLECB  EQU   COVLIST+16
CVOLASID EQU   COVLIST+14
@NM00108 EQU   CVOLFLG
CVOCRCR  EQU   CVOLFLG
CVOCRDAS EQU   CVOLFLG
CVODASCR EQU   CVOLFLG
CVOLRES1 EQU   COVLIST+5
CVOLOPCD EQU   COVLIST+4
CVOLLEN  EQU   COVLIST
@NM00107 EQU   COPYV+136
COPFREXT EQU   COPYV+132
COPLEXT  EQU   COPYV+130
COPFRESP EQU   COPYV+128
COPDESCR EQU   COPYV+58
COPDTREM EQU   COPYV+54
COP2BIT2 EQU   COPLID2
COP2BIT1 EQU   COPLID2
COPRES5  EQU   COPLIB2
COP1BIT2 EQU   COPLID1
COP1BIT1 EQU   COPLID1
COPRES4  EQU   COPLIB1
@NM00106 EQU   COPMISCF
COPHOLD  EQU   COPMISCF
COPRES3  EQU   COPSATIA
COPVSMIS EQU   COPSATIA
COPIVCPY EQU   COPSATIA
COPIVCRE EQU   COPSATIA
@NM00105 EQU   COPYV+18
@NM00104 EQU   COPFLAGA+3
COPDLSPF EQU   COPFLAGA+3
COPRONLY EQU   COPFLAGA+3
COPDAERA EQU   COPFLAGA+2
COPEXCL  EQU   COPFLAGA+2
COPBIND  EQU   COPFLAGA+2
COPBKUP  EQU   COPFLAGA+2
COPRSTD  EQU   COPFLAGA+2
COPGENUS EQU   COPFLAGA+2
COPGROUP EQU   COPFLAGA+2
COPRES2  EQU   COPTYPE
COPCOPYV EQU   COPTYPE
COPRES1  EQU   COPTYPE
COPRES6  EQU   COPYV+13
COPNO    EQU   COPID+1
COPBLANK EQU   COPID
COPSERNO EQU   COPNAME+5
COPV     EQU   COPNAME
@NM00103 EQU   BASEV+192
BASXPDT2 EQU   BASEV+188
BASGROUP EQU   BASEV+180
BASRECOV EQU   BASEV+174
BASDEST  EQU   BASEV+144
BASDESCR EQU   BASEV+104
BASDTREM EQU   BASEV+100
BASEXPDT EQU   BASEV+96
BASDLMTD EQU   BASEV+92
BASRES6  EQU   BASEV+89
BASCOPNO EQU   BASCOPID+1
BASCOPBK EQU   BASCOPID
BASCOPSN EQU   BASKLCPY+5
BASCOPV  EQU   BASKLCPY
BASFREXT EQU   BASEV+72
BASLEXT  EQU   BASEV+70
BASFRESP EQU   BASEV+68
@NM00102 EQU   BASEV+65
BASBKLMT EQU   BASEV+64
BASNBKUP EQU   BASEV+63
BASNCOPY EQU   BASEV+62
BASNEXTV EQU   BASEV+56
BASPREV  EQU   BASEV+50
BAS2BIT2 EQU   BASLID2
BAS2BIT1 EQU   BASLID2
BASRES5  EQU   BASLIB2
BASCSN2  EQU   BASEV+37
BAS1BIT2 EQU   BASLID1
BAS1BIT1 EQU   BASLID1
BASRES4  EQU   BASLIB1
BASCSN1  EQU   BASEV+24
BASRES3  EQU   BASMISCF
BASHOLD  EQU   BASMISCF
BASRES8  EQU   BASSATIA
BASCPUID EQU   BASEV+18
@NM00101 EQU   BASFLAGA+3
BASLAST  EQU   BASFLAGA+3
BASFIRST EQU   BASFLAGA+3
BASREASS EQU   BASFLAGA+3
BASRONLY EQU   BASFLAGA+3
BASDAERA EQU   BASFLAGA+3
BASEXCL  EQU   BASFLAGA+2
BASBIND  EQU   BASFLAGA+2
BASRSTD  EQU   BASFLAGA+2
BASGENUS EQU   BASFLAGA+2
BASGRPV  EQU   BASFLAGA+2
BASNOCPY EQU   BASFLAGA+2
BASDLSF  EQU   BASFLAGA+2
BASRES2  EQU   BASTYPE
BASBASVR EQU   BASTYPE
BASRES1  EQU   BASTYPE
BASRES7  EQU   BASEV+13
BASZERO  EQU   BASID+1
BASBLANK EQU   BASID
BASSERNO EQU   BASNAME+5
BASEVKEY EQU   BASNAME
@NM00100 EQU   MVR+82
MVRLABEL EQU   MVR+76
MVRBLNK1 EQU   MVR+75
MVRBKUPN EQU   MVR+74
MVRCSN   EQU   MVR+62
MVRTO    EQU   MVR+58
MVRDES   EQU   MVR+28
MVRGROUP EQU   MVR+20
MVRFOR   EQU   MVR+18
@NM00099 EQU   MVRFLAGA+2
MVRCIVCF EQU   MVRFLAGA+2
MVRCLMIS EQU   MVRFLAGA+1
MVRSLMIS EQU   MVRFLAGA+1
MVRNEXPD EQU   MVRFLAGA+1
MVRNDESC EQU   MVRFLAGA+1
MVRBKUP  EQU   MVRFLAGA+1
MVRNGRP  EQU   MVRFLAGA+1
MVRRSTD  EQU   MVRFLAGA+1
MVRGEN   EQU   MVRFLAGA+1
MVRFLLAB EQU   MVRFLAGA
MVRFLBK  EQU   MVRFLAGA
MVRFLCSN EQU   MVRFLAGA
MVRFLTO  EQU   MVRFLAGA
MVRFLDES EQU   MVRFLAGA
MVRFLBAS EQU   MVRFLAGA
MVRFLGRO EQU   MVRFLAGA
MVRFLFOR EQU   MVRFLAGA
@NM00098 EQU   MVRCODE+1
MVROPCD  EQU   MVRCODE
@NM00097 EQU   RVVI+64
RVVSDUP  EQU   RVVSPEC
RVVSCPY  EQU   RVVSPEC
RVVSCSN  EQU   RVVSPEC
RVVSEXP  EQU   RVVSPEC
RVVSGRP  EQU   RVVSPEC
@NM00096 EQU   RVVCPYTP
RVVCPLHD EQU   RVVCPYTP
RVVLCOPY EQU   RVVCPYTP
RVVOBKUP EQU   RVVCPYTP
RVVBPLHD EQU   RVVRTEST
RVVDVOL  EQU   RVVRTEST
RVVACTV  EQU   RVVRTEST
RVVINACT EQU   RVVRTEST
RVVRSTD  EQU   RVVRTEST
RVVGSVOL EQU   RVVRTEST
RVVTHOLD EQU   RVVRTEST
RVVEXPDT EQU   RVVRTEST
RVVALL   EQU   RVVRDRCD
RVVCPURC EQU   RVVRDRCD
RVVCIRCD EQU   RVVRDRCD
RVVRUNKN EQU   RVVRDRCD
RVVDUPRC EQU   RVVRDRCD
RVVGRPRC EQU   RVVRDRCD
@NM00095 EQU   RVVCHAIN
RVVNGVOL EQU   RVVCHAIN
RVVGPVOL EQU   RVVCHAIN
@NM00094 EQU   RVVRMODE
RVVRDCH  EQU   RVVRMODE
RVVRDNR  EQU   RVVRMODE
RVVDUPID EQU   RVVI+57
RVVCPYID EQU   RVVI+56
RVVRDCSN EQU   RVVI+44
RVVBLNK1 EQU   RVVI+42
RVVEXPIR EQU   RVVI+36
@NM00093 EQU   RVVI+28
RVVAREA  EQU   RVVI+24
RVVARLN  EQU   RVVI+22
RVVGROUP EQU   RVVI+14
@NM00092 EQU   RVVOPCOD+1
PFILEVAL EQU   @NM00091+1
PFILELEN EQU   @NM00091
PFILECNT EQU   PFILE
FILELEN  EQU   FILE
CATDNLEN EQU   CATDN
CATNMLEN EQU   CATNM+20
CATNMMEM EQU   CATNM+12
CATNMMLN EQU   CATNM+11
CATNMFUQ EQU   CATNMFLG
CATNMPOS EQU   CATNM+9
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00090 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00089 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00088 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00087 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00086 EQU   VSDSCR+5
@NM00085 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00084 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00083 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00082 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00081 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00080 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00079 EQU   VSDVTOC
@NM00078 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00077 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00076 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00075 EQU   UCTFLAGS
UCTVSCAT EQU   UCTFLAGS
UCTDD    EQU   UCTAGL+60
UCTVOLP  EQU   UCTAGL+56
UCTACBP  EQU   UCTAGL+52
UCTDSN   EQU   UCTAGL+8
UCTHEAD  EQU   UCTAGL
@NM00074 EQU   LCTFLAGS
LCTVSCAT EQU   LCTFLAGS
LCTOWNER EQU   LCTINFO+24
LCTEXPIR EQU   LCTINFO+20
LCTCREAT EQU   LCTINFO+16
LCTACBP  EQU   LCTINFO+12
LCTMULVC EQU   LCTINFO+8
LCTHEAD  EQU   LCTINFO
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00071 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00070 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00069 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00068 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
RCTDSET  EQU   RCTAGL+32
RCTNVOL  EQU   RCTAGL+26
RCTOVOL  EQU   RCTAGL+20
RCTNDEV  EQU   RCTAGL+16
RCTODEV  EQU   RCTAGL+12
@NM00067 EQU   RCTAGL+10
@NM00066 EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTDEV   EQU   RCTOPT
RCTHEAD  EQU   RCTAGL
@NM00065 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
@NM00064 EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00063 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00062 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00061 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSACBP   EQU   VS1AGL+36
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSHEAD   EQU   VS1AGL
VSVTOCPT EQU   VS2AGL+48
@NM00060 EQU   VS2AGL+45
@NM00059 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
@NM00058 EQU   VS2MSG
@NM00057 EQU   VSLABOPT
VSNOVTOC EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVTOCSZ EQU   VS2AGL+12
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00056 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXRWFUN  EQU   EXWRARG+46
@NM00055 EQU   EXSPACE+8
@NM00054 EQU   EXSPACE+6
@NM00053 EQU   EXSPACE+4
@NM00052 EQU   EXSPACE+1
@NM00051 EQU   EXSPACE
EXRWKDLN EQU   EXWRARG+32
@NM00050 EQU   EXWRARG+31
EXRECNUM EQU   EXRWCHR+4
EXHH     EQU   EXRWCHR+2
EXCC     EQU   EXRWCHR
EXCCWCNT EQU   EXWRARG+24
EXLOCPTR EQU   EXWRARG+20
EXRWDARE EQU   EXWRARG+16
EXRWIOAR EQU   EXWRARG+12
EXRWCTBL EQU   EXWRARG+8
EXRWRES  EQU   EXWRARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
EXOVTH   EQU   EXFLG
EXORVT   EQU   EXFLG
EXORDS   EQU   EXFLG
EXOSPK   EQU   EXFLG
EXORVS   EQU   EXFLG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOREP   EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKDATYPE EQU   CKAGL+20
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
MDR      EQU   MDVTOC+4
MDHH     EQU   MDVTOC+2
MDCC     EQU   MDVTOC
@NM00044 EQU   MDAGL+31
MDVTOCTR EQU   MDFLAGS
MDFORCE  EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDPUAGL  EQU   MDAGL+20
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
ERCPLPT  EQU   ERCNVTAB+20
ERCATRC  EQU   ERCNVTAB+16
ERDSNM   EQU   ERCNVTAB+12
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSUCDX EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDL  EQU   EROPER
ERCATDE  EQU   EROPER
ERCATLC  EQU   EROPER
@NM00030 EQU   ERTYPE
EROSCAT  EQU   ERTYPE
ERCATLG  EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTAR    EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITUSHR EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00303 EQU   @RC00296
@RF00302 EQU   @RC00296
@RC00629 EQU   @RC00628
@RC00986 EQU   @RC00977
@RC00984 EQU   @RC00977
@RC01012 EQU   @RC01010
@RF01027 EQU   @RC01010
@RF01125 EQU   @RC01110
@PB00014 EQU   @EL00001
@RC00662 EQU   @RC00629
@RF00995 EQU   @RC00986
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCRV01,(C'PLS2303',0603,76340)

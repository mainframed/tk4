         TITLE '**************** IDCSA07:   CATALOG SYSTEM ADAPTOR *****
               *********'
        MACRO
        GETMAIN &R,&LV=
        L     REG15,0(REG1)           GDTTBL ADDRESS
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS
        CNOP  2,4                     BOUNDARY ALIGNMENT
        LA    REG14,*+14              RETURN ADDRESS
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE
        DC    A(MODID)                MODULE ID ADDRESS
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS
        MEND
IDCSA07  CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00002-@MAINENT)
         DC    AL1(16)                                             0002
         DC    C'IDCSA07   75.323'                                 0002
IDCSARC  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00267-IDCSARC)
         ENTRY IDCSARC
IDCSAUC  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00444-IDCSAUC)
         ENTRY IDCSAUC
IDCSALC  DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL2(@EP00596-IDCSALC)
         ENTRY IDCSALC
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @12,0                                               0002
@PSTART  LA    @10,4095(,@12)                                      0002
         USING @PSTART,@12                                         0002
         USING @PSTART+4095,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         USING @DATD,@11                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @15,@01,16(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         AH    @15,4(,@15)                                         0002
         BR    @15                                                 0002
@EP00002 DS    0H                                                  0003
*                                                                  0266
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* ENTRY POINT FOR URECAT                                   @Z40LB30*/
*/*                                                          #Y30LB34*/
*/********************************************************** #Y30LB34*/
*                                                                  0267
*IDCSARC:                                                          0267
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     #Y30LB34*/
*       RCTAGLAR);                  /* URECAT ARG LIST       #Y30LB34*/
         B     @EC00267                                            0267
@EP00267 MVC   @PC00001(8),0(@01)                                  0267
@EC00267 DS    0H                                                  0268
*                                                                  0268
*/********************************************************** #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* THIS IS THE BEGINNING OF THE MAIN PROCEDURE FOR URECAT   @Z40LB30*/
*/*                                                          #Y30LB34*/
*/* FUNCTION - CALLS PROCEDURES TO:                          #Y30LB34*/
*/*                A) GET THE CATALOG ENTRY FOR THE DATA     #Y30LB34*/
*/*                   SET,                                   #Y30LB34*/
*/*                B) DETERMINE IF THAT DATA SET SHOULD      #Y30LB34*/
*/*                   OR COULD BE RECATALOGED,               #Y30LB34*/
*/*                C) UPDATE THE VOLUME LIST AND RECATALOG   @Y30LB34*/
*/*                   THE DATA SET.                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*********************************************************  @Y30LB34*/
*                                                                  0268
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0268
*   OLDERID2=NEWERID2;                                             0268
         L     @04,@PC00001                                        0268
         L     @02,GDTTR2(,@04)                                    0268
         MVC   @TS00001(95),NEWERID2(@02)                          0268
         MVC   OLDERID2(95,@02),@TS00001                           0268
*   NEWID2='RCEX';                  /*                       @Y30LB34*/
*                                                                  0269
         MVC   NEWID2(4,@02),@CC01217                              0269
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO DATA AREAS                @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0270
*   RESPECIFY                                                      0270
*     RCTAGL BASED(RCTPTR);         /*                       @Y30LB34*/
*   RCTPTR=ADDR(RCTAGLAR);          /*                       @Y30LB34*/
         L     RCTPTR,@PC00001+4                                   0271
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB34*/
*                                                                  0272
         LA    @02,DARGAREA                                        0272
         ST    @02,DDSTRU                                          0272
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE DATA AREAS AND WORK AREAS                  @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0273
*   DARGAREA=''B;                   /*                       @Y30LB34*/
         XC    DARGAREA(28),DARGAREA                               0273
*   CAMLST=''B;                     /*                       @Y30LB34*/
         XC    CAMLST(20),CAMLST                                   0274
*   CAMPTR1=ADDR(RCTDSET);          /*                       @Y30LB34*/
         LA    @02,RCTDSET(,RCTPTR)                                0275
         ST    @02,CAMPTR1                                         0275
*   CAMPTR3=ADDR(WKAREA);           /*                       @Y30LB34*/
         LA    @02,WKAREA                                          0276
         ST    @02,CAMPTR3                                         0276
*   AREA1=''B;                      /*                       @Y30LB34*/
         XC    AREA1(256),AREA1                                    0277
*   AREA2=''B;                      /*                       @Y30LB34*/
         XC    AREA2(9),AREA2                                      0278
*   RCTHEAD=RECATHDR;               /*                       @Y30LB34*/
         MVC   RCTHEAD(8,RCTPTR),@CC01206                          0279
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A DUMP POINT AFTER INITIALIZATION OF DATA   @Y30LB34*/
*   /* AREAS                                                 @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   IF GDTDBG=NULLPTR THEN                                         0280
         L     @04,GDTDBG(,@04)                                    0280
         LTR   @04,@04                                             0280
         BZ    @RT00280                                            0280
*     ;                                                            0281
*   ELSE                                                           0282
*     CALL IDCDB010(GDTTBL,'RCBG'); /*                       @Y30LB34*/
*                                                                  0282
         L     @04,@PC00001                                        0282
         ST    @04,@AL00001                                        0282
         LA    @02,@CC01220                                        0282
         ST    @02,@AL00001+4                                      0282
         MVI   @AL00001+4,X'80'                                    0282
         L     @15,GDTDBG(,@04)                                    0282
         LA    @01,@AL00001                                        0282
         BALR  @14,@15                                             0282
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL GETENT TO RETRIEVE THE CATALOG ENTRY FOR THE     @Y30LB34*/
*   /* SPECIFIED DATA SET                                    @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*   CALL GETENT;                    /*                       @Y30LB34*/
@RT00280 BAL   @14,GETENT                                          0283
*   RESPECIFY                                                      0284
*     RTNREG RSTD;                                                 0284
*   TESTRC=RTNREG;                                                 0285
         STH   RTNREG,TESTRC                                       0285
*   RESPECIFY                                                      0286
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   SETRC=TESTRC;                   /*                       @Y30LB34*/
*                                                                  0287
         LH    @04,TESTRC                                          0287
         STH   @04,SETRC                                           0287
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE FROM GETENT WAS ZERO, CALL TESTENT @Y30LB34*/
*   /* TO DETERMINE IF THE DATA SET SHOULD AND CAN BE        @Y30LB34*/
*   /* RECATALOGED                                           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0288
*   IF SETRC=0 THEN                                                0288
         LTR   @04,@04                                             0288
         BNZ   @RF00288                                            0288
*     DO;                           /*                       @Y30LB34*/
*       CALL TESTENT;               /*                       @Y30LB34*/
         BAL   @14,TESTENT                                         0290
*       RESPECIFY                                                  0291
*         RTNREG RSTD;                                             0291
*       TESTRC=RTNREG;                                             0292
         STH   RTNREG,TESTRC                                       0292
*       RESPECIFY                                                  0293
*         RTNREG UNRSTD;            /*                       @Y30LB34*/
*       SETRC=TESTRC;               /*                       @Y30LB34*/
         LH    @04,TESTRC                                          0294
         STH   @04,SETRC                                           0294
*                                                                  0295
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE FROM TESTENT WAS ZERO, CALL    @Y30LB34*/
*       /* UPDATENT TO UPDATE THE VOLUME LIST AND RECATALOG  @Y30LB34*/
*       /* THE DATA SET                                      @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0295
*       IF SETRC=0 THEN                                            0295
         LTR   @04,@04                                             0295
         BNZ   @RF00295                                            0295
*         DO;                       /*                       @Y30LB34*/
*           CALL UPDATENT;          /*                       @Y30LB34*/
         BAL   @14,UPDATENT                                        0297
*           RESPECIFY                                              0298
*             RTNREG RSTD;                                         0298
*           TESTRC=RTNREG;                                         0299
         STH   RTNREG,TESTRC                                       0299
*           RESPECIFY                                              0300
*             RTNREG UNRSTD;        /*                       @Y30LB34*/
*           SETRC=TESTRC;           /*                       @Y30LB34*/
         LH    @15,TESTRC                                          0301
         STH   @15,SETRC                                           0301
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  0303
@RF00295 DS    0H                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A DUMP POINT AT END OF MODULE               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*   IF GDTDBG=NULLPTR THEN                                         0304
@RF00288 L     @15,@PC00001                                        0304
         L     @15,GDTDBG(,@15)                                    0304
         LTR   @15,@15                                             0304
         BZ    @RT00304                                            0304
*     ;                                                            0305
*   ELSE                                                           0306
*     CALL IDCDB010(GDTTBL,'RCND'); /*                       @Y30LB34*/
*                                                                  0306
         L     @15,@PC00001                                        0306
         ST    @15,@AL00001                                        0306
         LA    @14,@CC01224                                        0306
         ST    @14,@AL00001+4                                      0306
         MVI   @AL00001+4,X'80'                                    0306
         L     @15,GDTDBG(,@15)                                    0306
         LA    @01,@AL00001                                        0306
         BALR  @14,@15                                             0306
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0307
*   CALL IDCSAEP0(GDTTBL,MODID,SETRC);/*                     @Y30LB34*/
@RT00304 L     @15,@PC00001                                        0307
         ST    @15,@AL00001                                        0307
         LA    @14,MODID                                           0307
         ST    @14,@AL00001+4                                      0307
         LA    @14,SETRC                                           0307
         ST    @14,@AL00001+8                                      0307
         MVI   @AL00001+8,X'80'                                    0307
         L     @15,GDTEPL(,@15)                                    0307
         LA    @01,@AL00001                                        0307
         BALR  @14,@15                                             0307
*                                                                  0308
*/*********************************************************  #Y30LB34*/
*/*                                                          #Y30LB34*/
*/* PROCEDURE NAME - GETENT                                  #Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - ISSUES THE LOCATE MACRO TO RETRIEVE THE       @Y30LB34*/
*/*            CATALOG ENTRY FOR THE DATA SET                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            PRINTS MESSAGE IDC2100I IF THE RETURN CODE    @Y30LB34*/
*/*            FROM LOCATE IS NOT 0 OR 8, AND PRINTS         @Y30LB34*/
*/*            MESSAGE IDC0396I NOTIFYING THE DATA SET WAS   @Y30LB34*/
*/*            NOT RECATALOGED.                              @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - CAMLST,RCTAGL                                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - WKAREA                                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*            R. C. = 0, SUCCESSFUL COMPLETION              @Y30LB34*/
*/*            R. C. = 4, ERROR LOCATING DATA SET            @Y30LB34*/
*/*            R. C. = 8, DATA SET NOT FOUND IN CATALOGS     @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*********************************************************  @Y30LB34*/
*                                                                  0308
*GETENT:                                                           0308
*   PROCEDURE;                      /*                       @Y30LB34*/
         B     @PB00002                                            0308
GETENT   STM   @14,@12,@SA00002                                    0308
*                                                                  0309
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   CC01=0;                         /*                       @Y30LB34*/
*                                                                  0309
         SLR   CC01,CC01                                           0309
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0310
*   OLDERID2=NEWERID2;                                             0310
         L     @15,@PC00001                                        0310
         L     @15,GDTTR2(,@15)                                    0310
         MVC   @TS00001(95),NEWERID2(@15)                          0310
         MVC   OLDERID2(95,@15),@TS00001                           0310
*   NEWID2='RCGE';                  /*                       @Y30LB34*/
*                                                                  0311
         MVC   NEWID2(4,@15),@CC01228                              0311
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CAMLST OPTION1 TO LOCATE BY NAME       @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0312
*   CAMOPTN1=LOCNAME;               /*                       @Y30LB34*/
*                                                                  0312
         MVI   CAMOPTN1,B'00000000'                                0312
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE LOCATE MACRO POINTING TO CAMLST CODED BY    @Y30LB34*/
*   /* IDCSARC                                               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0313
*LLOCAT1:                                                          0313
*   GEN(LOCATE CAMLST);             /*                       @Y30LB34*/
LLOCAT1  LOCATE CAMLST
*   RESPECIFY                                                      0314
*     RTNREG RSTD;                                                 0314
*   TESTRC=RTNREG;                                                 0315
         STH   RTNREG,TESTRC                                       0315
*   RESPECIFY                                                      0316
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*                                                                  0317
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A DUMP POINT FOR THE VOLUME LIST RETURNED   @Y30LB34*/
*   /* BY LOCATE                                             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0317
*   IF GDTDBG=NULLPTR THEN                                         0317
         L     @15,@PC00001                                        0317
         L     @15,GDTDBG(,@15)                                    0317
         LTR   @15,@15                                             0317
         BZ    @RT00317                                            0317
*     ;                                                            0318
*   ELSE                                                           0319
*     DO;                                                          0319
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB34*/
         LA    DMPINDEX,DUMPAREA                                   0320
*       DMPITMNM='WKAREA';                                         0321
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0321
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0321
         MVC   DMPITMNM(6,DMPINDEX),@CC01231                       0321
*       DMPITMPT=ADDR(WKAREA);                                     0322
         LA    @03,WKAREA                                          0322
         ST    @03,DMPITMPT(,DMPINDEX)                             0322
*       DMPITMLN=LENGTH(AREA1)+LENGTH(AREA2);                      0323
         MVC   DMPITMLN(2,DMPINDEX),@CH01342                       0323
*       DMPITMTP='H';                                              0324
         MVI   DMPITMTP(DMPINDEX),C'H'                             0324
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB34*/
         AL    DMPINDEX,@CF00466                                   0325
*       DMPTRM=DMPTRMVL;                                           0326
         MVI   DMPTRM(DMPINDEX),X'FF'                              0326
*     END;                          /*                       @Y30LB34*/
*   IF GDTDBG=NULLPTR THEN                                         0328
@RT00317 L     @15,@PC00001                                        0328
         L     @15,GDTDBG(,@15)                                    0328
         LTR   @15,@15                                             0328
         BZ    @RT00328                                            0328
*     ;                                                            0329
*   ELSE                                                           0330
*     CALL IDCDB010(GDTTBL,'RCAC',ADDR(DUMPAREA));/*         @Y30LB34*/
*                                                                  0330
         L     @15,@PC00001                                        0330
         ST    @15,@AL00001                                        0330
         LA    @14,@CC01233                                        0330
         ST    @14,@AL00001+4                                      0330
         LA    @14,DUMPAREA                                        0330
         ST    @14,@AFTEMPS                                        0330
         LA    @14,@AFTEMPS                                        0330
         ST    @14,@AL00001+8                                      0330
         MVI   @AL00001+8,X'80'                                    0330
         L     @15,GDTDBG(,@15)                                    0330
         LA    @01,@AL00001                                        0330
         BALR  @14,@15                                             0330
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LOCATE RETURNED A CODE GREATER THAN ZERO           @Y30LB34*/
*   /* DETERMINE TYPE OF ERROR                               @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0331
*   IF TESTRC>0 THEN                                               0331
@RT00328 LH    @15,TESTRC                                          0331
         LTR   @15,@15                                             0331
         BNP   @RF00331                                            0331
*     DO;                           /*                       @Y30LB34*/
*                                                                  0333
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE IS 8, INDICATING THE ENTRY WAS     @Y30LB34*/
*       /* NOT FOUND, SET CONDITION CODE TO 8                @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0333
*       IF TESTRC=NOTFOUND THEN                                    0333
         LA    @04,8                                               0333
         CR    @15,@04                                             0333
         BNE   @RF00333                                            0333
*         CC01=8;                   /*                       @Y30LB34*/
*                                                                  0334
         LA    @15,8                                               0334
         LR    CC01,@15                                            0334
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE IS NOT 8, INDICATING AN ERROR,     @Y30LB34*/
*       /* PRINT MESSAGE IDC2100I INFORMING THE USER WHAT    @Y30LB34*/
*       /* THE RETURN CODE IS, AND PRINTS MESSAGE IDC0396I   @Y30LB34*/
*       /* STATING THE DATA SET WAS NOT RECATALOGED          @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0335
*       ELSE                                                       0335
*         DO;                       /*                       @Y30LB34*/
         B     @RC00333                                            0335
@RF00333 DS    0H                                                  0336
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          0336
         MVC   DARGSMOD(3,@15),@CC01179                            0336
*           DARGSENT=MSG2100I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'03'                                 0337
*           DARGDBP=ADDR(TESTRC);   /*                       @Y30LB34*/
         LA    @14,TESTRC                                          0338
         ST    @14,DARGDBP(,@15)                                   0338
*           DARGILP=LENGTH(TESTRC); /*                       @Y30LB34*/
         MVC   DARGILP(2,@15),@CH00147                             0339
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @15,@PC00001                                        0340
         ST    @15,@AL00001                                        0340
         LA    @14,@CF00109                                        0340
         ST    @14,@AL00001+4                                      0340
         LA    @14,DDSTRU                                          0340
         ST    @14,@AL00001+8                                      0340
         MVI   @AL00001+8,X'80'                                    0340
         L     @15,GDTPRT(,@15)                                    0340
         LA    @01,@AL00001                                        0340
         BALR  @14,@15                                             0340
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/
         L     @15,DDSTRU                                          0341
         MVC   DARGSMOD(3,@15),@CC01179                            0341
*           DARGSENT=MSG0396I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'01'                                 0342
*           DARGDBP=ADDR(RCTDSET);  /*                       @Y30LB34*/
         LA    @14,RCTDSET(,RCTPTR)                                0343
         ST    @14,DARGDBP(,@15)                                   0343
*           DARGILP=LENGTH(RCTDSET);/*                       @Y30LB34*/
         MVC   DARGILP(2,@15),@CH00767                             0344
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @15,@PC00001                                        0345
         ST    @15,@AL00001                                        0345
         LA    @14,@CF00109                                        0345
         ST    @14,@AL00001+4                                      0345
         LA    @14,DDSTRU                                          0345
         ST    @14,@AL00001+8                                      0345
         MVI   @AL00001+8,X'80'                                    0345
         L     @15,GDTPRT(,@15)                                    0345
         LA    @01,@AL00001                                        0345
         BALR  @14,@15                                             0345
*           CC01=4;                 /*                       @Y30LB34*/
         LA    CC01,4                                              0346
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  0348
@RC00333 DS    0H                                                  0349
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0349
*   RETURN CODE(CC01);              /*                       @Y30LB34*/
@RF00331 LR    @15,CC01                                            0349
         L     @14,@SA00002                                        0349
         LM    @00,@12,@SA00002+8                                  0349
         BR    @14                                                 0349
*   END GETENT;                     /*                       @Y30LB34*/
*                                                                  0351
*/********************************************************** @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - TESTENT                                 @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - DETERMINES IF DATA SET RESIDES ON MORE OR     @Y30LB34*/
*/*            LESS THAN 20 VOLUMES.                         @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF LESS THAN OR EQUAL TO 20 VOLUMES,          @Y30LB34*/
*/*            SEARCHES THE VOLUME LIST FOR A MATCH WITH     @Y30LB34*/
*/*            THE OLD DEVTYPE/VOLSER.  IF FOUND, SAVES      @Y30LB34*/
*/*            THE ENTRY NUMBER.                             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            IF MORE THAN 20 VOLUMES, SEARCHES THE VOLUME  @Y30LB34*/
*/*            LIST FOR A MATCH WITH THE NEW DEVTYPE/        @Y30LB34*/
*/*            VOLSER.  IF FOUND, THE DATA SET HAS BEEN      @Y30LB34*/
*/*            RECATALOGED.  IF NOT FOUND, PRINTS MESSAGE    @Y30LB34*/
*/*            IDC0398I NOTIFYING THE USER THE DATA SET      @Y30LB34*/
*/*            RESIDES ON MORE THAN 20 VOLUMES, AND MESSAGE  @Y30LB34*/
*/*            IDC0396I, NOTIFYING THE USER THE DATA SET     @Y30LB34*/
*/*            WAS NOT RECATALOGED.                          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - WKAREA,RCTAGL                                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - ENTRY NUMBER                                    @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*            R. C. =  0, DATA SET CAN BE RECATALOGED       @Y30LB34*/
*/*            R. C. =  8, DATA SET ALREADY RECATALOGED,     @Y30LB34*/
*/*                        RECATALOGING NOT SUPPORTED        @Y30LB34*/
*/*                        BECAUSE DATA SET RESIDES ON       @Y30LB34*/
*/*                        MORE THAN 20 VOLUMES.             @Y30LB34*/
*/*                                                          @Y30LB34*/
*/********************************************************** @Y30LB34*/
*                                                                  0351
*TESTENT:                                                          0351
*   PROCEDURE;                      /*                       @Y30LB34*/
TESTENT  STM   @14,@02,@SA00003                                    0351
         STM   @04,@12,@SA00003+20                                 0351
*                                                                  0352
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0352
*   OLDERID2=NEWERID2;                                             0352
         L     @02,@PC00001                                        0352
         L     @02,GDTTR2(,@02)                                    0352
         MVC   @TS00001(95),NEWERID2(@02)                          0352
         MVC   OLDERID2(95,@02),@TS00001                           0352
*   NEWID2='RCTE';                  /*                       @Y30LB34*/
*                                                                  0353
         MVC   NEWID2(4,@02),@CC01237                              0353
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0354
*   CC01=0;                         /*                       @Y30LB34*/
*                                                                  0354
         SLR   @02,@02                                             0354
         LR    CC01,@02                                            0354
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP THE DEVICE TYPE IN A HOLD AREA SO WE           @ZM01090*/
*   /* CAN AND OUT THE BITS THAT ARE NOT NEEDED FOR CATALOGING       */
*   /*                                                       @ZM01090*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0355
*   TSTRCTND=RCTNDEV;               /*                       @ZM01090*/
         MVC   TSTRCTND(4),RCTNDEV(RCTPTR)                         0355
*   TSTRCTOD=RCTODEV;               /*                       @ZM01090*/
*                                                                  0356
         MVC   TSTRCTOD(4),RCTODEV(RCTPTR)                         0356
*   /*****************************************************************/
*   /*                                                               */
*   /* USE THE MASK TO AND OUT THE UNUSED BITS FROM          @ZM01090*/
*   /* THE DEVTYPE WE GOT FROM THE UCB SO THAT OUR COMPARES AND      */
*   /* CATALOGING ARE DONE CORRECTLY                         @ZM01090*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0357
*   TSTOCODE=TSTOCODE&TSTDMASK;     /*                       @ZM01090*/
         NC    TSTOCODE(2),TSTDMASK                                0357
*   TSTNCODE=TSTNCODE&TSTDMASK;     /*                       @ZM01090*/
*                                                                  0358
         NC    TSTNCODE(2),TSTDMASK                                0358
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATA SET IS ON 20 VOLUMES OR LESS FIND THE         #Y30LB34*/
*   /* ENTRY TO BE UPDATED                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0359
*   IF VOLCOUNT<=VOLLIMIT THEN                                     0359
         LH    @15,VOLCOUNT                                        0359
         C     @15,@CF01109                                        0359
         BH    @RF00359                                            0359
*     DO;                           /*                       @Y30LB34*/
*       NUMBER=0;                   /*                       @Y30LB34*/
         SLR   @15,@15                                             0361
         LR    NUMBER,@15                                          0361
*       DO UNTIL(NUMBER=VOLCOUNT×(DEVCODE(NUMBER)=TSTRCTOD/* @ZM01090*/
*             &VOLSER(NUMBER)=RCTOVOL));/*                   @Y30LB34*/
@DL00362 DS    0H                                                  0363
*         NUMBER=NUMBER+1;          /*                       @Y30LB34*/
         AL    NUMBER,@CF00213                                     0363
*       END;                        /*                       @Y30LB34*/
*                                                                  0364
@DE00362 CH    NUMBER,VOLCOUNT                                     0364
         BE    @DC00362                                            0364
         LR    @15,NUMBER                                          0364
         MH    @15,@CH00032                                        0364
         LA    @14,DEVCODE-12(@15)                                 0364
         CLC   0(4,@14),TSTRCTOD                                   0364
         BNE   @DL00362                                            0364
         LA    @14,VOLSER-12(@15)                                  0364
         CLC   0(6,@14),RCTOVOL(RCTPTR)                            0364
         BNE   @DL00362                                            0364
@DC00362 DS    0H                                                  0365
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVICE TYPE/VOLSER OF OLD VOLUME DOES          @Y30LB34*/
*       /* MATCH DEVICE TYPE/VOLSER ENTRY IN CATALOG,        @Y30LB34*/
*       /* RECATALOGING WILL TAKE PLACE. OTHERWISE           @Y30LB34*/
*       /* SET RETURN CODE TO 8.                             @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0365
*       IF DEVCODE(NUMBER)=TSTRCTOD&VOLSER(NUMBER)=RCTOVOL THEN    0365
         LR    @15,NUMBER                                          0365
         MH    @15,@CH00032                                        0365
         LA    @14,DEVCODE-12(@15)                                 0365
         CLC   0(4,@14),TSTRCTOD                                   0365
         BNE   @RF00365                                            0365
         LA    @14,VOLSER-12(@15)                                  0365
         CLC   0(6,@14),RCTOVOL(RCTPTR)                            0365
         BNE   @RF00365                                            0365
*         ENTNO=NUMBER;             /*                       @Y30LB34*/
         LR    ENTNO,NUMBER                                        0366
*       ELSE                                                       0367
*         CC01=8;                   /*                       @Y30LB34*/
         B     @RC00365                                            0367
@RF00365 LA    CC01,8                                              0367
*     END;                          /*                       @Y30LB34*/
*                                                                  0369
*   /*****************************************************************/
*   /*                                                               */
*   /* IF DATA SET IS ON MORE THAN 20 VOLUMES DETERMINE IF   @Y30LB34*/
*   /* DATA SET HAS BEEN RECATALOGED                         @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0369
*   ELSE                                                           0369
*     DO;                           /*                       @Y30LB34*/
         B     @RC00359                                            0369
@RF00359 DS    0H                                                  0370
*       NUMBER=0;                   /*                       @Y30LB34*/
         SLR   NUMBER,NUMBER                                       0370
*       DO UNTIL(NUMBER=VOLLIMIT×(DEVCODE(NUMBER)=TSTRCTND&VOLSER( 0371
*             NUMBER)=RCTNVOL));    /*                       @Y30LB34*/
@DL00371 DS    0H                                                  0372
*         NUMBER=NUMBER+1;          /*                       @Y30LB34*/
         AL    NUMBER,@CF00213                                     0372
*       END;                        /*                       @Y30LB34*/
*                                                                  0373
@DE00371 C     NUMBER,@CF01109                                     0373
         BE    @DC00371                                            0373
         LR    @04,NUMBER                                          0373
         MH    @04,@CH00032                                        0373
         LA    @01,DEVCODE-12(@04)                                 0373
         CLC   0(4,@01),TSTRCTND                                   0373
         BNE   @DL00371                                            0373
         LA    @01,VOLSER-12(@04)                                  0373
         CLC   0(6,@01),RCTNVOL(RCTPTR)                            0373
         BNE   @DL00371                                            0373
@DC00371 DS    0H                                                  0374
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVICE TYPE/VOLSER OF NEW VOLUME MATCH DEVICE  @Y30LB34*/
*       /* TYPE/VOLUME ENTRY IN CATALOG, DATA SET HAS BEEN   @Y30LB34*/
*       /* RECATALOGED. SET RETURN CODE TO 8.                @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0374
*       IF(DEVCODE(NUMBER)=TSTRCTND&VOLSER(NUMBER)=RCTNVOL) THEN   0374
         LR    @04,NUMBER                                          0374
         MH    @04,@CH00032                                        0374
         LA    @01,DEVCODE-12(@04)                                 0374
         CLC   0(4,@01),TSTRCTND                                   0374
         BNE   @RF00374                                            0374
         LA    @01,VOLSER-12(@04)                                  0374
         CLC   0(6,@01),RCTNVOL(RCTPTR)                            0374
         BNE   @RF00374                                            0374
*         CC01=8;                   /*                       @Y30LB34*/
*                                                                  0375
         LA    CC01,8                                              0375
*       /*************************************************************/
*       /*                                                           */
*       /* IF NO MATCH ON DEVICE TYPE/VOLSER, THE DATA SET   @Y30LB34*/
*       /* HAS NOT BEEN RECATALOGED ON FIRST 20 VOLUMES.     @Y30LB34*/
*       /* PRINT MESSAGE IDC0398I STATING DATA SET RESIDES   @Y30LB34*/
*       /* ON MORE THAN 20 VOLUMES, AND MESSAGE IDC0396I     @Y30LB34*/
*       /* NOTIFYING DATA SET NOT RECATALOGED.               @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0376
*       ELSE                                                       0376
*         DO;                       /*                       @Y30LB34*/
         B     @RC00374                                            0376
@RF00374 DS    0H                                                  0377
*           DARGAREA=''B;           /*                       @Y30LB34*/
         XC    DARGAREA(28),DARGAREA                               0377
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/
         L     @02,DDSTRU                                          0378
         MVC   DARGSMOD(3,@02),@CC01179                            0378
*           DARGSENT=MSG0398I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@02),X'05'                                 0379
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @02,@PC00001                                        0380
         ST    @02,@AL00001                                        0380
         LA    @15,@CF00109                                        0380
         ST    @15,@AL00001+4                                      0380
         LA    @15,DDSTRU                                          0380
         ST    @15,@AL00001+8                                      0380
         MVI   @AL00001+8,X'80'                                    0380
         L     @15,GDTPRT(,@02)                                    0380
         LA    @01,@AL00001                                        0380
         BALR  @14,@15                                             0380
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/
         L     @02,DDSTRU                                          0381
         MVC   DARGSMOD(3,@02),@CC01179                            0381
*           DARGSENT=MSG0396I;      /*                       @Y30LB34*/
         MVI   DARGSENT(@02),X'01'                                 0382
*           DARGDBP=ADDR(RCTDSET);  /*                       @Y30LB34*/
         LA    @15,RCTDSET(,RCTPTR)                                0383
         ST    @15,DARGDBP(,@02)                                   0383
*           DARGILP=LENGTH(RCTDSET);/*                       @Y30LB34*/
         MVC   DARGILP(2,@02),@CH00767                             0384
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/
         L     @02,@PC00001                                        0385
         ST    @02,@AL00001                                        0385
         LA    @15,@CF00109                                        0385
         ST    @15,@AL00001+4                                      0385
         LA    @15,DDSTRU                                          0385
         ST    @15,@AL00001+8                                      0385
         MVI   @AL00001+8,X'80'                                    0385
         L     @15,GDTPRT(,@02)                                    0385
         LA    @01,@AL00001                                        0385
         BALR  @14,@15                                             0385
*           CC01=8;                 /*                       @Y30LB34*/
         LA    CC01,8                                              0386
*         END;                      /*                       @Y30LB34*/
*     END;                          /*                       @Y30LB34*/
*                                                                  0388
@RC00374 DS    0H                                                  0389
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0389
*   RETURN CODE(CC01);              /*                       @Y30LB34*/
@RC00359 LR    @15,CC01                                            0389
         L     @14,@SA00003                                        0389
         LM    @00,@02,@SA00003+8                                  0389
         LM    @04,@12,@SA00003+20                                 0389
         BR    @14                                                 0389
*   END TESTENT;                    /*                       @Y30LB34*/
*                                                                  0391
*/*********************************************************  @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* PROCEDURE NAME - UPDATENT                                @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* FUNCTION - UPDATES THE DEVICE TYPE AND VOLUME SERIAL     @Y30LB34*/
*/*            NUMBER IN VOLUME LIST ENTRY                   @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*            ISSUES THE CATALOG MACRO TO RECATALOG THE     @Y30LB34*/
*/*            DATA SET                                      @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* INPUT - WKAREA, RCTAGL, CAMLST                           @Y30LB34*/
*/*                                                          @Y30LB34*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/
*/*          R. C. = 0, DATA SET RECATALOGED SUCCESSFULLY    @Y30LB34*/
*/*          R. C. = 4, ERROR RECATALOGING DATA SET          @Y30LB34*/
*/*                                                          @Y30LB34*/
*/*********************************************************  @Y30LB34*/
*                                                                  0391
*UPDATENT:                                                         0391
*   PROCEDURE;                      /*                       @Y30LB34*/
UPDATENT STM   @14,@12,@SA00004                                    0391
*                                                                  0392
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0392
*   OLDERID2=NEWERID2;                                             0392
         L     @02,@PC00001                                        0392
         L     @02,GDTTR2(,@02)                                    0392
         MVC   @TS00001(95),NEWERID2(@02)                          0392
         MVC   OLDERID2(95,@02),@TS00001                           0392
*   NEWID2='RCUE';                  /*                       @Y30LB34*/
*                                                                  0393
         MVC   NEWID2(4,@02),@CC01241                              0393
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0394
*   CC01=0;                         /*                       @Y30LB34*/
*                                                                  0394
         SLR   CC01,CC01                                           0394
*   /*****************************************************************/
*   /*                                                               */
*   /* CHANGE THE DEVICE TYPE AND/OR VOLUME SERIAL NUMBER    @Y30LB34*/
*   /* IN THE APPROPRIATE ENTRY OF THE VOLUME LIST           @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0395
*   IF RCTDEV=ON THEN                                              0395
         TM    RCTDEV(RCTPTR),B'10000000'                          0395
         BNO   @RF00395                                            0395
*     DEVCODE(ENTNO)=TSTRCTND;      /*                       @ZM01090*/
         LR    @02,ENTNO                                           0396
         MH    @02,@CH00032                                        0396
         LA    @01,DEVCODE-12(@02)                                 0396
         MVC   0(4,@01),TSTRCTND                                   0396
*   IF RCTVOL=ON THEN                                              0397
@RF00395 TM    RCTVOL(RCTPTR),B'01000000'                          0397
         BNO   @RF00397                                            0397
*     VOLSER(ENTNO)=RCTNVOL;        /*                       @Y30LB34*/
*                                                                  0398
         LR    @02,ENTNO                                           0398
         MH    @02,@CH00032                                        0398
         LA    @01,VOLSER-12(@02)                                  0398
         MVC   0(6,@01),RCTNVOL(RCTPTR)                            0398
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CAMLST OPTION 1 TO RECATALOG AND IF    @Y30LB34*/
*   /* THE DATA SET RESIDES ON ONE VOLUME SPECIFY THE DSCB   @Y30LB34*/
*   /* TTR                                                   @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   CAMOPTN1=RECAT;                 /*                       @Y30LB34*/
@RF00397 MVI   CAMOPTN1,B'00010000'                                0399
*   IF VOLCOUNT=1 THEN                                             0400
         CLC   VOLCOUNT(2),@CH00213                                0400
         BNE   @RF00400                                            0400
*     CAMDSCB=ADDR(TTRDSCB);        /*                       @Y30LB34*/
         LA    @15,TTRDSCB                                         0401
         ST    @15,CAMDSCB                                         0401
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE THE CATALOG MACRO POINTING TO CAMLST            @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0402
*   RESPECIFY                                                      0402
*     REG0 RSTD;                    /*                       @Y30LB34*/
@RF00400 DS    0H                                                  0403
*LCATLG1:                                                          0403
*   GEN(CATALOG CAMLST);            /*                       @Y30LB34*/
LCATLG1  CATALOG CAMLST
*   RESPECIFY                                                      0404
*     RTNREG RSTD;                                                 0404
*   TESTRC=RTNREG;                                                 0405
         STH   RTNREG,TESTRC                                       0405
*   RESPECIFY                                                      0406
*     RTNREG UNRSTD;                /*                       @Y30LB34*/
*   RSNCODE=REG0;                   /*                       @Y30LB34*/
         STH   REG0,RSNCODE                                        0407
*   RESPECIFY                                                      0408
*     REG0 UNRSTD;                  /*                       @Y30LB34*/
*                                                                  0408
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A DUMP POINT FOR THE VOLUME LIST AFTER      @Y30LB34*/
*   /* RECATALOG                                             @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   IF GDTDBG=NULLPTR THEN                                         0409
         L     @15,@PC00001                                        0409
         L     @15,GDTDBG(,@15)                                    0409
         LTR   @15,@15                                             0409
         BZ    @RT00409                                            0409
*     ;                                                            0410
*   ELSE                                                           0411
*     DO;                                                          0411
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB34*/
         LA    DMPINDEX,DUMPAREA                                   0412
*       DMPITMNM='WKAREA';                                         0413
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0413
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0413
         MVC   DMPITMNM(6,DMPINDEX),@CC01231                       0413
*       DMPITMPT=ADDR(WKAREA);                                     0414
         LA    @03,WKAREA                                          0414
         ST    @03,DMPITMPT(,DMPINDEX)                             0414
*       DMPITMLN=LENGTH(AREA1)+LENGTH(AREA2);                      0415
         MVC   DMPITMLN(2,DMPINDEX),@CH01342                       0415
*       DMPITMTP='H';                                              0416
         MVI   DMPITMTP(DMPINDEX),C'H'                             0416
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB34*/
         AL    DMPINDEX,@CF00466                                   0417
*       DMPTRM=DMPTRMVL;                                           0418
         MVI   DMPTRM(DMPINDEX),X'FF'                              0418
*     END;                          /*                       @Y30LB34*/
*   IF GDTDBG=NULLPTR THEN                                         0420
@RT00409 L     @15,@PC00001                                        0420
         L     @15,GDTDBG(,@15)                                    0420
         LTR   @15,@15                                             0420
         BZ    @RT00420                                            0420
*     ;                                                            0421
*   ELSE                                                           0422
*     CALL IDCDB010(GDTTBL,'RCAC',ADDR(DUMPAREA));/*         @Y30LB34*/
         L     @15,@PC00001                                        0422
         ST    @15,@AL00001                                        0422
         LA    @14,@CC01233                                        0422
         ST    @14,@AL00001+4                                      0422
         LA    @14,DUMPAREA                                        0422
         ST    @14,@AFTEMPS+4                                      0422
         LA    @14,@AFTEMPS+4                                      0422
         ST    @14,@AL00001+8                                      0422
         MVI   @AL00001+8,X'80'                                    0422
         L     @15,GDTDBG(,@15)                                    0422
         LA    @01,@AL00001                                        0422
         BALR  @14,@15                                             0422
*                                                                  0423
*   /*****************************************************************/
*   /*                                                               */
*   /* IF CATALOG RETURNED A CODE GREATER THAN ZERO          @Y30LB34*/
*   /* RECATALOGONG WAS NOT PERFORMED                        @Y30LB34*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0423
*   IF TESTRC>0 THEN                                               0423
@RT00420 LH    @15,TESTRC                                          0423
         LTR   @15,@15                                             0423
         BNP   @RF00423                                            0423
*     DO;                           /*                       @Y30LB34*/
*                                                                  0424
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT MESSAGE IDC21019 STATING THE RECATALOG      @Y30LB34*/
*       /* RETURN CODE AND REASON CODE                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0425
*       CC01=4;                     /*                       @Y30LB34*/
         LA    CC01,4                                              0425
*       DARGSMOD=SA07MSG;           /*                       @Y30LB34*/
         L     @15,DDSTRU                                          0426
         MVC   DARGSMOD(3,@15),@CC01179                            0426
*       DARGSENT=MSG2101I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'04'                                 0427
*       DARGDBP=ADDR(TESTRC);       /*                       @Y30LB34*/
         LA    @14,TESTRC                                          0428
         ST    @14,DARGDBP(,@15)                                   0428
*       DARGILP=LENGTH(TESTRC);     /*                       @Y30LB34*/
         LA    @14,2                                               0429
         STH   @14,DARGILP(,@15)                                   0429
*       DARGCNT=1;                  /*                       @Y30LB34*/
         LA    @09,1                                               0430
         STH   @09,DARGCNT(,@15)                                   0430
*       DARGINS(1)=1;               /*                       @Y30LB34*/
         STH   @09,DARGINS(,@15)                                   0431
*       DARGINL(1)=LENGTH(RSNCODE); /*                       @Y30LB34*/
         STH   @14,DARGINL(,@15)                                   0432
*       DARGDTM(1)=ADDR(RSNCODE);   /*                       @Y30LB34*/
         LA    @14,RSNCODE                                         0433
         ST    @14,DARGDTM(,@15)                                   0433
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
*                                                                  0434
         L     @15,@PC00001                                        0434
         ST    @15,@AL00001                                        0434
         LA    @14,@CF00109                                        0434
         ST    @14,@AL00001+4                                      0434
         LA    @14,DDSTRU                                          0434
         ST    @14,@AL00001+8                                      0434
         MVI   @AL00001+8,X'80'                                    0434
         L     @15,GDTPRT(,@15)                                    0434
         LA    @01,@AL00001                                        0434
         BALR  @14,@15                                             0434
*       /*************************************************************/
*       /*                                                           */
*       /* PRINT MESSAGE IDC0396I NOTIFYING DATA SET NOT     @Y30LB34*/
*       /* RECATALOGED                                       @Y30LB34*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0435
*       DARGAREA=''B;               /*                       @Y30LB34*/
         XC    DARGAREA(28),DARGAREA                               0435
*       DARGSMOD=SA07MSG;           /*                       @Y30LB34*/
         L     @15,DDSTRU                                          0436
         MVC   DARGSMOD(3,@15),@CC01179                            0436
*       DARGSENT=MSG0396I;          /*                       @Y30LB34*/
         MVI   DARGSENT(@15),X'01'                                 0437
*       DARGDBP=ADDR(RCTDSET);      /*                       @Y30LB34*/
         LA    @14,RCTDSET(,RCTPTR)                                0438
         ST    @14,DARGDBP(,@15)                                   0438
*       DARGILP=LENGTH(RCTDSET);    /*                       @Y30LB34*/
         MVC   DARGILP(2,@15),@CH00767                             0439
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/
         L     @05,@PC00001                                        0440
         ST    @05,@AL00001                                        0440
         LA    @15,@CF00109                                        0440
         ST    @15,@AL00001+4                                      0440
         LA    @15,DDSTRU                                          0440
         ST    @15,@AL00001+8                                      0440
         MVI   @AL00001+8,X'80'                                    0440
         L     @15,GDTPRT(,@05)                                    0440
         LA    @01,@AL00001                                        0440
         BALR  @14,@15                                             0440
*     END;                          /*                       @Y30LB34*/
*                                                                  0441
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0442
*                                   /*                       @Y30LB34*/
*   RETURN CODE(CC01);              /*                       @Y30LB34*/
@RF00423 LR    @15,CC01                                            0442
         L     @14,@SA00004                                        0442
         LM    @00,@12,@SA00004+8                                  0442
         BR    @14                                                 0442
*   END UPDATENT;                   /*                       @Y30LB34*/
*                                                                  0444
*/*********************************************************  @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - IDCSAUC (ENTRY POINT FOR UUNCATLG)      @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - CONTROLS THE SCRATCH AND UNCATALOG OF A       @Z40LB30*/
*/*            NON-VSAM DATA SET                             @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - GDTTBL, UCTAGL                                   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - UCTAGL HEADER IS SET                            @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*          R. C. = 0, DATA SET SCRATCHED FROM VTOC AND     @Z40LB30*/
*/*                     UNCATALOGED SUCCESSFULLY OR DATA     @Z40LB30*/
*/*                     SET WAS ALREADY SCRATCHED AND/OR     @Z40LB30*/
*/*                     UNCATALOGED                          @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*          R. C. = 4, DATA SET NOT SCRATCHED AND UNCATA-   @Z40LB30*/
*/*                     LOGED SUCCESSFULLY                   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0444
*IDCSAUC:                                                          0444
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     @Z40LB30*/
*       UARGAREA);                  /* UUNCATLG ARGUMENT LIST      0444
*                                                            @Z40LB30*/
         B     @EC00444                                            0444
@EP00444 MVC   @PC00001(4),0(@01)                                  0444
         MVC   @PC00001+8(4),4(@01)                                0444
@EC00444 DS    0H                                                  0445
*                                                                  0445
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*   OLDERID2=NEWERID2;                                             0445
         L     @15,@PC00001                                        0445
         L     @14,GDTTR2(,@15)                                    0445
         MVC   @TS00001(95),NEWERID2(@14)                          0445
         MVC   OLDERID2(95,@14),@TS00001                           0445
*   NEWID2='SAUC';                  /*                       @Z40LB30*/
*                                                                  0446
         MVC   NEWID2(4,@14),@CC01250                              0446
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   IF GDTDBG=NULLPTR THEN                                         0447
         L     @15,GDTDBG(,@15)                                    0447
         LTR   @15,@15                                             0447
         BZ    @RT00447                                            0447
*     ;                                                            0448
*   ELSE                                                           0449
*     CALL IDCDB010(GDTTBL,'SAUC'); /*                       @Z40LB30*/
*                                                                  0449
         L     @15,@PC00001                                        0449
         ST    @15,@AL00001                                        0449
         LA    @14,@CC01250                                        0449
         ST    @14,@AL00001+4                                      0449
         MVI   @AL00001+4,X'80'                                    0449
         L     @15,GDTDBG(,@15)                                    0449
         LA    @01,@AL00001                                        0449
         BALR  @14,@15                                             0449
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO INPUT ARGUMENT            @Z40LB30*/
*   /* LIST AND TO UPRINT ARGUMENT LIST AND TO UERROR        @Z40LB30*/
*   /* ARGUMENT LIST AND TO USCRATCH ARGUMENT LIST           @Z40LB30*/
*   /* THE USCRATCH ARGUMENT LIST IS BASED ON THE            @Z40LB30*/
*   /* ADDRESS PROVIDED BY THE CALLER.                       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0450
*   RESPECIFY                                                      0450
*     UCTAGL BASED(UARGPTR);        /*                       @Z40LB30*/
@RT00447 DS    0H                                                  0451
*   UARGPTR=ADDR(UARGAREA);         /*                       @Z40LB30*/
         L     UARGPTR,@PC00001+8                                  0451
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB30*/
         LA    @02,DARGAREA                                        0452
         ST    @02,DDSTRU                                          0452
*   ERCNVADR=ADDR(ERRAREA);         /*                       @Z40LB37*/
         LA    @02,ERRAREA                                         0453
         ST    @02,ERCNVADR                                        0453
*   RESPECIFY                                                      0454
*     UVOLLIST BASED(UCTVOLP);      /*                       @Z40LB30*/
*                                                                  0454
*   /*****************************************************************/
*   /*                                                               */
*   /* SET HEADER IN UCTAGL                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0455
*   UCTHEAD=UNCATHDR;               /*                       @Z40LB30*/
*                                                                  0455
         MVC   UCTHEAD(8,UARGPTR),@CC01208                         0455
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE UCTVSCAT BIT IN THE UCTAGL IS SET              @Z40LB30*/
*   /* INDICATING A VSAM DELETE CAN BE USED TO SCRATCH AND   @Z40LB30*/
*   /* UNCATALOG THE DATA SET, CALL VSAMUCT PROCEDURE. OTHER @Z40LB30*/
*   /* WISE CALL OSUCT PROCEDURE. SAVE THE RETURN CODE       @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0456
*   IF UCTVSCAT=ON THEN             /*                       @Z40LB30*/
         TM    UCTVSCAT(UARGPTR),B'10000000'                       0456
         BNO   @RF00456                                            0456
*     CALL VSAMUCT;                 /*                       @Z40LB30*/
         BAL   @14,VSAMUCT                                         0457
*   ELSE                            /*                       @Z40LB30*/
*     CALL OSUCT;                   /*                       @Z40LB30*/
         B     @RC00456                                            0458
@RF00456 BAL   @14,OSUCT                                           0458
*   RESPECIFY                                                      0459
*     RTNREG RSTD;                                                 0459
@RC00456 DS    0H                                                  0460
*   TESTRC=RTNREG;                                                 0460
         STH   RTNREG,TESTRC                                       0460
*   RESPECIFY                                                      0461
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0461
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0462
*   IF GDTDBG=NULLPTR THEN                                         0462
         L     @15,@PC00001                                        0462
         L     @15,GDTDBG(,@15)                                    0462
         LTR   @15,@15                                             0462
         BZ    @RT00462                                            0462
*     ;                                                            0463
*   ELSE                                                           0464
*     CALL IDCDB010(GDTTBL,'SAUE'); /*                       @Z40LB30*/
*                                                                  0464
         L     @15,@PC00001                                        0464
         ST    @15,@AL00001                                        0464
         LA    @14,@CC01255                                        0464
         ST    @14,@AL00001+4                                      0464
         MVI   @AL00001+4,X'80'                                    0464
         L     @15,GDTDBG(,@15)                                    0464
         LA    @01,@AL00001                                        0464
         BALR  @14,@15                                             0464
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER WITH THE RETURN CODE             @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0465
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);/*                    @Z40LB30*/
@RT00462 L     @15,@PC00001                                        0465
         ST    @15,@AL00001                                        0465
         LA    @14,MODID                                           0465
         ST    @14,@AL00001+4                                      0465
         LA    @14,TESTRC                                          0465
         ST    @14,@AL00001+8                                      0465
         MVI   @AL00001+8,X'80'                                    0465
         L     @15,GDTEPL(,@15)                                    0465
         LA    @01,@AL00001                                        0465
         BALR  @14,@15                                             0465
*                                                                  0466
*/********************************************************   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - OSUCT                                   @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - SCRATCHES AND UNCATALOGS A NON-VSAM           @Z40LB30*/
*/*            DATA SET THAT IS CATALOGED IN THE OS SYSTEM   @Z40LB30*/
*/*            CATALOG OR IN AN OS CVOL CATALOG.  THIS       @Z40LB30*/
*/*            PROCEDURE SHOULD BE CALLED ONLY IN VS1.       @Z40LB30*/
*/*            MESSAGE IDC0112I IS ISSUED IF THE DATA SET    @Z40LB30*/
*/*            IS SCRATCHED SUCCESSFULLY BUT AN ERROR        @Z40LB30*/
*/*            OCCURS UNCATALOGING.  MESSAGE IDC0363I IS     @Z40LB30*/
*/*            ISSUED IF THE DATA SET IS NOT UNCATALOGED     @Z40LB30*/
*/*            SUCCESSFULLY.                                 @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - UCTAGL                                           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Z40LB30*/
*/*          R. C. = 0, DATA SET SCRATCHED AND UNCATALOGED   @Z40LB30*/
*/*                     SUCCESSFULLY OR DATA SET NOT FOUND   @Z40LB30*/
*/*          R. C. = 4, ERROR OCCURRED SCRATCHING OR         @Z40LB30*/
*/*                     UNCATALOGING THE DATA SET.           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/********************************************************   @Z40LB30*/
*                                                                  0466
*OSUCT:                                                            0466
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
         B     @PB00005                                            0466
OSUCT    ST    @14,@SA00005                                        0466
*                                                                  0467
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0467
*   OLDERID2=NEWERID2;                                             0467
         L     @05,@PC00001                                        0467
         L     @02,GDTTR2(,@05)                                    0467
         MVC   @TS00001(95),NEWERID2(@02)                          0467
         MVC   OLDERID2(95,@02),@TS00001                           0467
*   NEWID2='SAOU';                  /*                       @Z40LB30*/
*                                                                  0468
         MVC   NEWID2(4,@02),@CC01260                              0468
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0469
*   CC01=0;                         /*                       @Z40LB30*/
*                                                                  0469
         SLR   CC01,CC01                                           0469
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE USCRATCH MACRO TO SCRATCH THE DATA SET. GET     @Z40LB30*/
*   /* DATA SET NAME FROM UCTAGL. INDICATE EXPIRATION DATE   @Z40LB30*/
*   /* IS TO BE OVERRIDDEN. SAVE THE RETURN CODE.            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0470
*   CALL IDCSASC0(GDTTBL,UCTDSN,ADDR(UVOLLIST),OVERRIDE);/*  @Z40LB30*/
         ST    @05,@AL00001                                        0470
         LA    @02,UCTDSN(,UARGPTR)                                0470
         ST    @02,@AL00001+4                                      0470
         LA    @02,UCTVOLP(,UARGPTR)                               0470
         ST    @02,@AL00001+8                                      0470
         LA    @02,OVERRIDE                                        0470
         ST    @02,@AL00001+12                                     0470
         MVI   @AL00001+12,X'80'                                   0470
         L     @15,GDTSCR(,@05)                                    0470
         LA    @01,@AL00001                                        0470
         BALR  @14,@15                                             0470
*   RESPECIFY                                                      0471
*     RTNREG RSTD;                                                 0471
*   TESTRC=RTNREG;                                                 0472
         STH   RTNREG,TESTRC                                       0472
*   RESPECIFY                                                      0473
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0473
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SCRATCH WAS NOT SUCCESSFUL, SET THE INTERNAL   @Z40LB30*/
*   /* CONDITION CODE AND ISSUE UPRINT TO PRINT MESSAGE      @Z40LB30*/
*   /* IDC0363I TO INDICATE THE DATA SET WAS NOT UNCATALOGED @Z40LB30*/
*   /* EITHER. USCRATCH HAS ISSUED MESSAGES TO INCICATE THE  @Z40LB30*/
*   /* DATA SET WAS NOT SCRATCHED.                           @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0474
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/
         LH    @05,TESTRC                                          0474
         LTR   @05,@05                                             0474
         BZ    @RF00474                                            0474
*     DO;                           /*                       @Z40LB30*/
*       CC01=4;                     /*                       @Z40LB30*/
         LA    CC01,4                                              0476
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0477
*       DARGSMOD=SA07MSG;           /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0478
         MVC   DARGSMOD(3,@05),@CC01179                            0478
*       DARGSENT=MSG0363I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'0B'                                 0479
*       DARGDBP=ADDR(UCTDSN);       /*                       @Z40LB30*/
         LA    @02,UCTDSN(,UARGPTR)                                0480
         ST    @02,DARGDBP(,@05)                                   0480
*       DARGILP=LENGTH(UCTDSN);     /*                       @Z40LB30*/
         MVC   DARGILP(2,@05),@CH00767                             0481
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
         L     @05,@PC00001                                        0482
         ST    @05,@AL00001                                        0482
         LA    @15,@CF00109                                        0482
         ST    @15,@AL00001+4                                      0482
         LA    @15,DDSTRU                                          0482
         ST    @15,@AL00001+8                                      0482
         MVI   @AL00001+8,X'80'                                    0482
         L     @15,GDTPRT(,@05)                                    0482
         LA    @01,@AL00001                                        0482
         BALR  @14,@15                                             0482
*     END;                          /*                       @Z40LB30*/
*                                                                  0484
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SCRATCH WAS SUCCESSFUL, INITIALIZE THE CAMLST  @Z40LB30*/
*   /* AND ISSUE CATALOG MACRO TO UNCATALOG THE DATA SET     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*   ELSE                            /*                       @Z40LB30*/
*     DO;                           /*                       @Z40LB30*/
*                                                                  0484
         B     @RC00474                                            0484
@RF00474 DS    0H                                                  0485
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE FIRST BYTE OF CAMLST TO INDICATE AN       @Z40LB30*/
*       /* UNCATALOG REQUEST. SET THE SECOND BYTE TO         @Z40LB30*/
*       /* INDICATE DELETE EMPTY HIGHER LEVEL INDEXES.       @Z40LB30*/
*       /* SET THE THIRD BYTE TO INDICATE SEARCH ONLY OS     @Z40LB30*/
*       /* CATALOG                                           @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0485
*       CAMLST=''B;                 /*                       @Z40LB30*/
         XC    CAMLST(20),CAMLST                                   0485
*       CAMOPTN1=UCAT;              /*                       @Z40LB30*/
         MVI   CAMOPTN1,B'00001000'                                0486
*       CAMOPTN2=UCATDX;            /*                       @Z40LB30*/
         MVI   CAMOPTN2,B'00000100'                                0487
*       CAMOPTN3=OSCAT;             /*                       @Z40LB30*/
*                                                                  0488
         MVI   CAMOPTN3,B'00000110'                                0488
*       /*************************************************************/
*       /*                                                           */
*       /* SET THE POINTER TO THE DATA SET NAME FROM UCTAGL  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0489
*       CAMPTR1=ADDR(UCTDSN);       /*                       @Z40LB30*/
*                                                                  0489
         LA    @05,UCTDSN(,UARGPTR)                                0489
         ST    @05,CAMPTR1                                         0489
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE CATALOG MACRO TO UNCATALOG THE DATA SET AND @Z40LB30*/
*       /* SAVE THE RETURN CODE                              @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0490
*LCATLG2:                           /*                       @Z40LB30*/
*       GEN(CATALOG CAMLST);        /*                       @Z40LB30*/
LCATLG2  CATALOG CAMLST
*       RESPECIFY                                                  0491
*         RTNREG RSTD;                                             0491
*       TESTRC=RTNREG;                                             0492
         STH   RTNREG,TESTRC                                       0492
*       RESPECIFY                                                  0493
*         RTNREG UNRSTD;            /*                       @Z40LB30*/
*                                                                  0493
*       /*************************************************************/
*       /*                                                           */
*       /* ESTABLISH A DUMP POINT TO DUMP REGISTER 15        @Z40LB30*/
*       /* AND THE CAMLST                                    @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0494
*       IF GDTDBG=NULLPTR THEN                                     0494
         L     @05,@PC00001                                        0494
         L     @05,GDTDBG(,@05)                                    0494
         LTR   @05,@05                                             0494
         BZ    @RT00494                                            0494
*         ;                                                        0495
*       ELSE                                                       0496
*         DO;                                                      0496
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Z40LB30*/
         LA    DMPINDEX,DUMPAREA                                   0497
*           DMPITMNM='TESTRC';                                     0498
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0498
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0498
         MVC   DMPITMNM(6,DMPINDEX),@CC01263                       0498
*           DMPITMPT=ADDR(TESTRC);                                 0499
         LA    @05,TESTRC                                          0499
         ST    @05,DMPITMPT(,DMPINDEX)                             0499
*           DMPITMLN=LENGTH(TESTRC);                               0500
         MVC   DMPITMLN(2,DMPINDEX),@CH00147                       0500
*           DMPITMTP='H';                                          0501
         MVI   DMPITMTP(DMPINDEX),C'H'                             0501
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Z40LB30*/
         LA    @05,16                                              0502
         ALR   DMPINDEX,@05                                        0502
*           DMPITMNM='CAMLST';                                     0503
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0503
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0503
         MVC   DMPITMNM(6,DMPINDEX),@CC01264                       0503
*           DMPITMPT=ADDR(CAMLST);                                 0504
         LA    @15,CAMLST                                          0504
         ST    @15,DMPITMPT(,DMPINDEX)                             0504
*           DMPITMLN=LENGTH(CAMLST);                               0505
         MVC   DMPITMLN(2,DMPINDEX),@CH01109                       0505
*           DMPITMTP='H';                                          0506
         MVI   DMPITMTP(DMPINDEX),C'H'                             0506
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Z40LB30*/
         ALR   DMPINDEX,@05                                        0507
*           DMPTRM=DMPTRMVL;                                       0508
         MVI   DMPTRM(DMPINDEX),X'FF'                              0508
*         END;                      /*                       @Z40LB30*/
*       IF GDTDBG=NULLPTR THEN                                     0510
@RT00494 L     @05,@PC00001                                        0510
         L     @05,GDTDBG(,@05)                                    0510
         LTR   @05,@05                                             0510
         BZ    @RT00510                                            0510
*         ;                                                        0511
*       ELSE                                                       0512
*         CALL IDCDB010(GDTTBL,'SAOD',ADDR(DUMPAREA));/*     @Z40LB30*/
*                                                                  0512
         L     @05,@PC00001                                        0512
         ST    @05,@AL00001                                        0512
         LA    @02,@CC01265                                        0512
         ST    @02,@AL00001+4                                      0512
         LA    @02,DUMPAREA                                        0512
         ST    @02,@AFTEMPS+8                                      0512
         LA    @02,@AFTEMPS+8                                      0512
         ST    @02,@AL00001+8                                      0512
         MVI   @AL00001+8,X'80'                                    0512
         L     @15,GDTDBG(,@05)                                    0512
         LA    @01,@AL00001                                        0512
         BALR  @14,@15                                             0512
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE RETURN CODE IS NOT '0 OR 8', AN ERROR      @Z40LB30*/
*       /* OCCURRED DURING THE UNCATALOG                     @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0513
*       IF TESTRC^=0&TESTRC^=NOTFOUND THEN                         0513
@RT00510 LH    @05,TESTRC                                          0513
         LTR   @05,@05                                             0513
         BZ    @RF00513                                            0513
         C     @05,@CF00173                                        0513
         BE    @RF00513                                            0513
*         DO;                       /*                       @Z40LB30*/
*                                                                  0514
*           /*********************************************************/
*           /*                                                       */
*           /* SET INTERNAL RETURN CODE                      @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0515
*           CC01=4;                 /*                       @Z40LB30*/
*                                                                  0515
         LA    CC01,4                                              0515
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT TO PRINT MESSAGE IDC0112I TO     @Z40LB30*/
*           /* EXPLAIN THAT THE DATA SET WAS SCRATCHED       @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0516
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0516
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0517
         MVC   DARGSMOD(3,@05),@CC01181                            0517
*           DARGSENT=MSG0112I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'44'                                 0518
*           DARGDBP=ADDR(UCTDSN);   /*                       @Z40LB30*/
         LA    @02,UCTDSN(,UARGPTR)                                0519
         ST    @02,DARGDBP(,@05)                                   0519
*           DARGILP=LENGTH(UCTDSN); /*                       @Z40LB30*/
         MVC   DARGILP(2,@05),@CH00767                             0520
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
*                                                                  0521
         L     @05,@PC00001                                        0521
         ST    @05,@AL00001                                        0521
         LA    @02,@CF00109                                        0521
         ST    @02,@AL00001+4                                      0521
         LA    @02,DDSTRU                                          0521
         ST    @02,@AL00001+8                                      0521
         MVI   @AL00001+8,X'80'                                    0521
         L     @15,GDTPRT(,@05)                                    0521
         LA    @01,@AL00001                                        0521
         BALR  @14,@15                                             0521
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UERROR TO PRINT MESSAGES IDENTIFYING    @Z40LB30*/
*           /* THE CATALOG ERROR                             @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0522
*           ERCNVTAB=''B;           /* SET TO 0              @Z40LB30*/
         L     @05,ERCNVADR                                        0522
         XC    ERCNVTAB(32,@05),ERCNVTAB(@05)                      0522
*           EROSCAT=ON;             /* OS CATALOG ERROR      @Z40LB30*/
         OI    EROSCAT(@05),B'01000000'                            0523
*           EROSUCDX=ON;            /* DELETE INDEX FUNCTION @Z40LB30*/
         OI    EROSUCDX(@05),B'01000000'                           0524
*           ERDSNM=ADDR(UCTDSN);    /* DATA SET NAME         @Z40LB30*/
         LA    @02,UCTDSN(,UARGPTR)                                0525
         ST    @02,ERDSNM(,@05)                                    0525
*           ERCATRC=TESTRC;         /* CATALOG RETURN CODE   @Z40LB30*/
         LH    @02,TESTRC                                          0526
         ST    @02,ERCATRC(,@05)                                   0526
*           ERCPLPT=ADDR(CAMLST);   /* CATALOG PARAMETER LIST      0527
*                                                            @Z40LB30*/
         LA    @02,CAMLST                                          0527
         ST    @02,ERCPLPT(,@05)                                   0527
*           CALL IDCTPER0(GDTTBL,ERCNVADR);/*                @Z40LB37*/
*                                                                  0528
         L     @05,@PC00001                                        0528
         ST    @05,@AL00001                                        0528
         LA    @02,ERCNVADR                                        0528
         ST    @02,@AL00001+4                                      0528
         MVI   @AL00001+4,X'80'                                    0528
         L     @15,GDTERR(,@05)                                    0528
         LA    @01,@AL00001                                        0528
         BALR  @14,@15                                             0528
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE UPRINT TO PRINT MESSAGE IDC0363I TO     @Z40LB30*/
*           /* EXPLAIN THAT THE DATA SET WAS NOT UNCATALOGED @Z40LB30*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0529
*           DARGAREA=''B;           /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0529
*           DARGSMOD=SA07MSG;       /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0530
         MVC   DARGSMOD(3,@05),@CC01179                            0530
*           DARGSENT=MSG0363I;      /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'0B'                                 0531
*           DARGDBP=ADDR(UCTDSN);   /*                       @Z40LB30*/
         LA    @02,UCTDSN(,UARGPTR)                                0532
         ST    @02,DARGDBP(,@05)                                   0532
*           DARGILP=LENGTH(UCTDSN); /*                       @Z40LB30*/
         MVC   DARGILP(2,@05),@CH00767                             0533
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/
         L     @05,@PC00001                                        0534
         ST    @05,@AL00001                                        0534
         LA    @15,@CF00109                                        0534
         ST    @15,@AL00001+4                                      0534
         LA    @15,DDSTRU                                          0534
         ST    @15,@AL00001+8                                      0534
         MVI   @AL00001+8,X'80'                                    0534
         L     @15,GDTPRT(,@05)                                    0534
         LA    @01,@AL00001                                        0534
         BALR  @14,@15                                             0534
*         END;                      /*                       @Z40LB30*/
*     END;                          /*                       @Z40LB30*/
*                                                                  0536
@RF00513 DS    0H                                                  0537
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RC00474 LR    @15,CC01                                            0537
@EL00005 DS    0H                                                  0537
@EF00005 DS    0H                                                  0537
@ER00005 L     @14,@SA00005                                        0537
         BR    @14                                                 0537
*   END OSUCT;                      /*                       @Z40LB30*/
*                                                                  0539
*/*******************************************************    @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* PROCEDURE NAME - VSAMUCT                                 @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* FUNCTION - SCRATCHES AND UNCATALOGS A NON-VSAM DATA      @Z40LB30*/
*/*            SET THAT IS CATALOGED IN A VSAM CATALOG       @Z40LB30*/
*/*            IN VS/1 OR VS/2 OR THAT IS CATALOGED IN       @Z40LB30*/
*/*            AN OS CVOL THAT IS CONNECTED TO THE VSAM      @Z40LB30*/
*/*            MASTER CATALOG IN VS/2.  MESSAGES IDC0362I    @Z40LB30*/
*/*            AND IDC0363I ARE ISSUED IF THE DATA SET       @Z40LB30*/
*/*            WAS NOT SCRATCHED OR UNCATALOGED SUCCESS-     @Z40LB30*/
*/*            FULLY                                         @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* INPUT - UCTAGL                                           @Z40LB30*/
*/*                                                          @Z40LB30*/
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Z40LB30*/
*/*          R. C. = 0, DATA SET SCRATCHED AND               @Z40LB30*/
*/*                     UNCATALOGED SUCCESSFULLY OR DATA     @Z40LB30*/
*/*                     SET WAS NOT FOUND ON THE VTOC OR     @Z40LB30*/
*/*                     IN THE CATALOG                       @Z40LB30*/
*/*          R. C. = 4, AN ERROR OCCURRED SCRATCHING AND/OR  @Z40LB30*/
*/*                     UNCATALOGING THE DATA SET            @Z40LB30*/
*/*                                                          @Z40LB30*/
*/*********************************************************  @Z40LB30*/
*                                                                  0539
*VSAMUCT:                                                          0539
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/
*                                                                  0539
VSAMUCT  ST    @14,@SA00006                                        0539
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF AREAS FOR VSAM CATALOG PARAMETER LIST @Z40LB30*/
*   /* AND WORK AREA                                         @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0540
*   DCL                                                            0540
*     CPLAREA CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD)) BDY(WORD);/*    0540
*                                                            @Z40LB30*/
*   DCL                                                            0541
*     1 WORKAREA BDY(WORD),         /*                       @Z40LB30*/
*      2 WRKALEN CHAR(2),           /* LENGTH OF WORK AREA   @Z40LB30*/
*      2 * CHAR(47);                /* RETURNED BY VSAM      @Z40LB30*/
*                                                                  0542
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0542
*   OLDERID2=NEWERID2;                                             0542
         L     @05,@PC00001                                        0542
         L     @05,GDTTR2(,@05)                                    0542
         MVC   @TS00001(95),NEWERID2(@05)                          0542
         MVC   OLDERID2(95,@05),@TS00001                           0542
*   NEWID2='SAVU';                  /*                       @Z40LB30*/
*                                                                  0543
         MVC   NEWID2(4,@05),@CC01274                              0543
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0544
*   CC01=0;                         /*                       @Z40LB30*/
*                                                                  0544
         SLR   @02,@02                                             0544
         LR    CC01,@02                                            0544
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IEZCTGPL TO SCRATCH AND UNCATALOG      @Z40LB30*/
*   /* THE DATA SET                                          @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0545
*   CTGPLPTR=ADDR(CPLAREA);         /*                       @Z40LB30*/
         LA    @05,CPLAREA                                         0545
         ST    @05,CTGPLPTR                                        0545
*   CPLAREA=''B;                    /* SET TO 0              @Z40LB30*/
         XC    CPLAREA(32),CPLAREA                                 0546
*   CTGFUNC='100'B;                 /* CATALOG MANAGEMENT    @Z40LB30
*                                      SERVICES REQUEST      @Z40LB30*/
         NI    CTGFUNC(@05),B'10011111'                            0547
         OI    CTGFUNC(@05),B'10000000'                            0547
*   CTGNAME=ON;                     /* CTGENT POINTS TO ENTRY      0548
*                                                            @Z40LB30
*                                      NAME                  @Z40LB30*/
         OI    CTGNAME(@05),B'00000100'                            0548
*   CTGAM0=ON;                      /* VSAM PARAMETER LIST   @Z40LB30*/
         OI    CTGAM0(@05),B'00000001'                             0549
*   CTGOPTNS='00011'B;              /* DELETE FUNCTION       @Z40LB30*/
         NI    CTGOPTNS(@05),B'00011111'                           0550
         OI    CTGOPTNS(@05),B'00011000'                           0550
*   CTGDDNM=ADDR(UCTDD);            /* DD NAME               @Z40LB30*/
         LA    @15,UCTDD(,UARGPTR)                                 0551
         ST    @15,CTGDDNM(,@05)                                   0551
*   CTGTYPE='A';                    /* NON-VSAM DATA SET     @Z40LB30*/
         MVI   CTGTYPE(@05),C'A'                                   0552
*   CTGPURG=ON;                     /* OVERRIDE EXPIRATION   @Z40LB30
*                                      DATE                  @Z40LB30*/
*   CTGSCR=ON;                      /* SCRATCH OPTION        @Z40LB30*/
         OI    CTGPURG(@05),B'00100010'                            0554
*   CTGENT=ADDR(UCTDSN);            /* DATA SET NAME         @Z40LB30*/
         LA    @15,UCTDSN(,UARGPTR)                                0555
         ST    @15,CTGENT(,@05)                                    0555
*   CTGWKA=ADDR(WORKAREA);          /* WORK AREA             @Z40LB30*/
*                                                                  0556
         LA    @15,WORKAREA                                        0556
         ST    @15,CTGWKA(,@05)                                    0556
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A CATALOG ACB IS SPECIFIED IN THE UCTAGL, SET ITS  @Z40LB30*/
*   /* ADDRESS IN THE CATALOG PARAMETER LIST.                @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   IF UCTACBP^=NULLPTR THEN        /*                       @Z40LB30*/
         C     @02,UCTACBP(,UARGPTR)                               0557
         BE    @RF00557                                            0557
*     CTGCAT=ADDR(UCTACBP);         /*                       @Z40LB30*/
         LA    @02,UCTACBP(,UARGPTR)                               0558
         ST    @02,CTGCAT(,@05)                                    0558
*   ELSE                            /*                       @Z40LB30*/
*     CTGCNAME=ON;                  /* INDICATE NO CATALOG ACB     0559
*                                                            @Z40LB30*/
*                                                                  0559
         B     @RC00557                                            0559
@RF00557 L     @05,CTGPLPTR                                        0559
         OI    CTGCNAME(@05),B'00000010'                           0559
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CATALOG WORK AREA                      @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0560
*   WORKAREA=''B;                   /*                       @Z40LB30*/
@RC00557 XC    WORKAREA(49),WORKAREA                               0560
*   WRKALEN=LENGTH(WORKAREA);       /*                       @Z40LB30*/
*                                                                  0561
         MVC   WRKALEN(2),@CH01343                                 0561
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UCATLG AND SAVE RETURN CODE                     @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   CALL IDCSACA0(GDTTBL,CTGPLPTR); /*                       @Z40LB30*/
         L     @05,@PC00001                                        0562
         ST    @05,@AL00001                                        0562
         LA    @02,CTGPLPTR                                        0562
         ST    @02,@AL00001+4                                      0562
         L     @15,GDTCAT(,@05)                                    0562
         LA    @01,@AL00001                                        0562
         BALR  @14,@15                                             0562
*   RESPECIFY                                                      0563
*     RTNREG RSTD;                                                 0563
*   TESTRC=RTNREG;                                                 0564
         STH   RTNREG,TESTRC                                       0564
*   RESPECIFY                                                      0565
*     RTNREG UNRSTD;                /*                       @Z40LB30*/
*                                                                  0566
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS NOT 0 OR 8, AN ERROR OCCURRED   @Z40LB30*/
*   /* UNCATALOGING OR SCRATCHING THE DATA SET               @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0566
*   IF TESTRC^=0&TESTRC^=NOTFOUND THEN/*                     @Z40LB30*/
         LH    @05,TESTRC                                          0566
         LTR   @05,@05                                             0566
         BZ    @RF00566                                            0566
         C     @05,@CF00173                                        0566
         BE    @RF00566                                            0566
*     DO;                           /*                       @Z40LB30*/
*                                                                  0567
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE UERROR ARGUMENT LIST AND ISSUE UERROR  @Z40LB30*/
*       /* TO PRINT MESSAGES IDENTIFYING THE CATALOG ERROR   @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0568
*       ERCNVTAB=''B;               /* SET TO 0              @Z40LB30*/
         L     @02,ERCNVADR                                        0568
         XC    ERCNVTAB(32,@02),ERCNVTAB(@02)                      0568
*       ERCATLG=ON;                 /* VSAM CATALOG ERROR    @Z40LB30*/
         OI    ERCATLG(@02),B'10000000'                            0569
*       ERCATDL=ON;                 /* DELETE FUNCTION       @Z40LB30*/
         OI    ERCATDL(@02),B'00100000'                            0570
*       ERDSNM=ADDR(UCTDSN);        /* DATA SET NAME         @Z40LB30*/
         LA    @15,UCTDSN(,UARGPTR)                                0571
         ST    @15,ERDSNM(,@02)                                    0571
*       ERCATRC=TESTRC;             /* CATALOG RETURN CODE   @Z40LB30*/
         ST    @05,ERCATRC(,@02)                                   0572
*       ERCPLPT=CTGPLPTR;           /* CATALOG PARAMETER LIST      0573
*                                                            @Z40LB30*/
         L     @05,CTGPLPTR                                        0573
         ST    @05,ERCPLPT(,@02)                                   0573
*       CALL IDCTPER0(GDTTBL,ERCNVADR);/*                    @Z40LB37*/
*                                                                  0574
         L     @05,@PC00001                                        0574
         ST    @05,@AL00001                                        0574
         LA    @02,ERCNVADR                                        0574
         ST    @02,@AL00001+4                                      0574
         MVI   @AL00001+4,X'80'                                    0574
         L     @15,GDTERR(,@05)                                    0574
         LA    @01,@AL00001                                        0574
         BALR  @14,@15                                             0574
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE UPRINT ARGUMENT LIST AND ISSUE UPRINT  @Z40LB30*/
*       /* TO PRINT MESSAGE IDC0362I TO SAY THAT THE DATA    @Z40LB30*/
*       /* SET WAS NOT SCRATCHED                             @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0575
*       DARGAREA=''B;               /*                       @Z40LB30*/
         XC    DARGAREA(28),DARGAREA                               0575
*       DARGSMOD=SA07MSG;           /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0576
         MVC   DARGSMOD(3,@05),@CC01179                            0576
*       DARGSENT=MSG0362I;          /*                       @Z40LB30*/
         MVI   DARGSENT(@05),X'0A'                                 0577
*       DARGDBP=ADDR(UCTDSN);       /*                       @Z40LB30*/
         LA    @02,UCTDSN(,UARGPTR)                                0578
         ST    @02,DARGDBP(,@05)                                   0578
*       DARGILP=LENGTH(UCTDSN);     /*                       @Z40LB30*/
         MVC   DARGILP(2,@05),@CH00767                             0579
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0580
         L     @05,@PC00001                                        0580
         ST    @05,@AL00001                                        0580
         LA    @15,@CF00109                                        0580
         ST    @15,@AL00001+4                                      0580
         LA    @15,DDSTRU                                          0580
         ST    @15,@AL00001+8                                      0580
         MVI   @AL00001+8,X'80'                                    0580
         L     @15,GDTPRT(,@05)                                    0580
         LA    @01,@AL00001                                        0580
         BALR  @14,@15                                             0580
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE UPRINT TO PRINT MESSAGE IDC0363I TO SAY     @Z40LB30*/
*       /* THE DATA SET WAS NOT UNCATALOGED                  @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0581
*       DARGSENT=MSG0363I;          /*                       @Z40LB30*/
         L     @05,DDSTRU                                          0581
         MVI   DARGSENT(@05),X'0B'                                 0581
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/
*                                                                  0582
         L     @05,@PC00001                                        0582
         ST    @05,@AL00001                                        0582
         LA    @15,@CF00109                                        0582
         ST    @15,@AL00001+4                                      0582
         LA    @15,DDSTRU                                          0582
         ST    @15,@AL00001+8                                      0582
         MVI   @AL00001+8,X'80'                                    0582
         L     @15,GDTPRT(,@05)                                    0582
         LA    @01,@AL00001                                        0582
         BALR  @14,@15                                             0582
*       /*************************************************************/
*       /*                                                           */
*       /* SET INTERNAL RETURN CODE                          @Z40LB30*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0583
*       CC01=4;                     /*                       @Z40LB30*/
         LA    CC01,4                                              0583
*     END;                          /*                       @Z40LB30*/
*                                                                  0585
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CATALOG RETURN CODE WAS 8, INDICATING THE      @Z40LB30*/
*   /* DATA SET WAS NOT FOUND IN THE CATALOG, ATTEMPT TO     @Z40LB30*/
*   /* SCRATCH THE DATA SET FROM THE VTOC                    @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*   ELSE                                                           0585
*     IF TESTRC=NOTFOUND THEN                                      0585
         B     @RC00566                                            0585
@RF00566 CLC   TESTRC(2),@CH00173                                  0585
         BNE   @RF00585                                            0585
*       DO;                         /*                       @Z40LB30*/
*                                                                  0586
*         /***********************************************************/
*         /*                                                         */
*         /* ISSUE USCRATCH MACRO TO SCRATCH THE DATA SET.   @Z40LB30*/
*         /* IF THE DATA SET IS NOT ON THE VTOC, USCRATCH    @Z40LB30*/
*         /* WILL RETURN A SUCCESSFUL CODE. SPECIFY ON       @Z40LB30*/
*         /* USCRATCH MACRO THE DATA SET NAME AND INDICATE   @Z40LB30*/
*         /* EXPIRATION DATE IS TO BE OVERRIDDEN. SAVE THE   @Z40LB30*/
*         /* RETURN CODE.                                    @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0587
*         CALL IDCSASC0(GDTTBL,UCTDSN,ADDR(UVOLLIST),OVERRIDE);/*  0587
*                                                            @Z40LB30*/
         L     @05,@PC00001                                        0587
         ST    @05,@AL00001                                        0587
         LA    @02,UCTDSN(,UARGPTR)                                0587
         ST    @02,@AL00001+4                                      0587
         LA    @02,UCTVOLP(,UARGPTR)                               0587
         ST    @02,@AL00001+8                                      0587
         LA    @02,OVERRIDE                                        0587
         ST    @02,@AL00001+12                                     0587
         MVI   @AL00001+12,X'80'                                   0587
         L     @15,GDTSCR(,@05)                                    0587
         LA    @01,@AL00001                                        0587
         BALR  @14,@15                                             0587
*         RESPECIFY                                                0588
*           RTNREG RSTD;                                           0588
*         TESTRC=RTNREG;                                           0589
         STH   RTNREG,TESTRC                                       0589
*         RESPECIFY                                                0590
*           RTNREG UNRSTD;          /*                       @Z40LB30*/
*                                                                  0590
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE USCRATCH RETURN CODE IS NOT ZERO, SET    @Z40LB30*/
*         /* THE INTERNAL RETURN CODE. USCRATCH HAS ISSUED   @Z40LB30*/
*         /* NECESSARY MESSAGES                              @Z40LB30*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0591
*         IF TESTRC^=0 THEN                                        0591
         LH    @05,TESTRC                                          0591
         LTR   @05,@05                                             0591
         BZ    @RF00591                                            0591
*           CC01=4;                 /*                       @Z40LB30*/
         LA    CC01,4                                              0592
*       END;                        /*                       @Z40LB30*/
*                                                                  0593
@RF00591 DS    0H                                                  0594
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB30*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0594
*   RETURN CODE(CC01);              /*                       @Z40LB30*/
@RF00585 DS    0H                                                  0594
@RC00566 LR    @15,CC01                                            0594
@EL00006 DS    0H                                                  0594
@EF00006 DS    0H                                                  0594
@ER00006 L     @14,@SA00006                                        0594
         BR    @14                                                 0594
*   END VSAMUCT;                    /*                       @Z40LB30*/
*                                                                  0596
*/********************************************************************/
*/*                                                          @Z40LB37*/
*/* PROCEDURE NAME - IDCSALC (ENTRY POINT FOR ULOCATE)       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* FUNCTION - CONTROLS THE FLOW AMONG LOWER PROCEDURES      @Z40LB37*/
*/*            FOR LOCATING A NON-VSAM DATA SET              @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* INPUT  - GDTTBL, DSNAME VARIABLE, VOLSER VARIABLE,       @Z40LB37*/
*/*          DEVICE TYPE VARIABLE, LCTINFO AREA ADDRESS      @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* OUTPUT - LCTINFO HEADER IS SET                           @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 0, DATA SET LOCATED SUCCESSFULLY.       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 4, DATA SET NOT LOCATED SUCCESSFULLY.   @Z40LB37*/
*/*                     CATALOG ERROR.                       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 8, DATA SET NOT FOUND IN CATALOG        @Z40LB37*/
*/*                     SEARCH.                              @Z40LB37*/
*/*                                                          @Z40LB37*/
*/********************************************************************/
*                                                                  0596
*IDCSALC:                                                          0596
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     @Z40LB37*/
*       DSNVAR,                     /* DSNAME VARIABLE       @Z40LB37*/
*       VOLVAR,                     /* VOLSER VARIABLE       @Z40LB37*/
*       DEVVAR,                     /* DEVICE TYPE VARIABLE  @Z40LB37*/
*       LOCAREAP);                  /* LOCATE INFO AREA PTR  @Z40LB37*/
         B     @EC00596                                            0596
@EP00596 MVC   @PC00001(4),0(@01)                                  0596
         MVC   @PC00001+12(16),4(@01)                              0596
@EC00596 DS    0H                                                  0597
*                                                                  0597
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0597
*   OLDERID2=NEWERID2;                                             0597
         L     @15,@PC00001                                        0597
         L     @14,GDTTR2(,@15)                                    0597
         MVC   @TS00001(95),NEWERID2(@14)                          0597
         MVC   OLDERID2(95,@14),@TS00001                           0597
*   NEWID2='SALT';                  /*                       @Z40LB37*/
*                                                                  0598
         MVC   NEWID2(4,@14),@CC01291                              0598
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0599
*   IF GDTDBG=NULLPTR THEN                                         0599
         L     @15,GDTDBG(,@15)                                    0599
         LTR   @15,@15                                             0599
         BZ    @RT00599                                            0599
*     ;                                                            0600
*   ELSE                                                           0601
*     CALL IDCDB010(GDTTBL,'SALC'); /*                       @Z40LB37*/
*                                                                  0601
         L     @15,@PC00001                                        0601
         ST    @15,@AL00001                                        0601
         LA    @14,@CC01292                                        0601
         ST    @14,@AL00001+4                                      0601
         MVI   @AL00001+4,X'80'                                    0601
         L     @15,GDTDBG(,@15)                                    0601
         LA    @01,@AL00001                                        0601
         BALR  @14,@15                                             0601
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH ADDRESSABILITY TO INPUT VARIABLE            @Z40LB37*/
*   /* LISTS AND TO UPRINT ARGUMENT LIST AND TO UERROR       @Z40LB37*/
*   /* ARGUMENT LIST                                         @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   RESPECIFY                                                      0602
*     LOCTDSN BASED(ADDR(DSNVAR));  /*                       @Z40LB37*/
@RT00599 DS    0H                                                  0603
*   RESPECIFY                                                      0603
*     LOCTVOL BASED(ADDR(VOLVAR));  /*                       @Z40LB37*/
*   RESPECIFY                                                      0604
*     LOCTDEV BASED(ADDR(DEVVAR));  /*                       @Z40LB37*/
*   RESPECIFY                                                      0605
*     LCTINFO BASED(LOCTPTR);       /*                       @Z40LB37*/
*   LOCTPTR=LOCAREAP;               /*                       @Z40LB37*/
         L     @15,@PC00001+24                                     0606
         L     LOCTPTR,LOCAREAP(,@15)                              0606
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB37*/
         LA    @15,DARGAREA                                        0607
         ST    @15,DDSTRU                                          0607
*   ERCNVADR=ADDR(ERRAREA);         /*                       @Z40LB37*/
*                                                                  0608
         LA    @15,ERRAREA                                         0608
         ST    @15,ERCNVADR                                        0608
*   /*****************************************************************/
*   /*                                                               */
*   /* SET HEADER IN LCTINFO                                 @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0609
*   LCTHEAD=LOCTHDR;                /*                       @Z40LB37*/
         MVC   LCTHEAD(8,LOCTPTR),LOCTHDR                          0609
*                                                                  0610
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL VSAMLOC PROCEDURE TO LOCATE A NON-VSAM DATA      @Z40LB37*/
*   /* SET. SAVE THE RETURN CODE                             @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0610
*   CALL VSAMLOC;                   /*                       @Z40LB37*/
         BAL   @14,VSAMLOC                                         0610
*   RESPECIFY                                                      0611
*     RTNREG RSTD;                                                 0611
*   TESTRC=RTNREG;                                                 0612
         STH   RTNREG,TESTRC                                       0612
*   RESPECIFY                                                      0613
*     RTNREG UNRSTD;                /*                       @Z40LB37*/
*                                                                  0613
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RETURN CODE IS SUCCESSFUL THEN CHECK VOLSER AND    @Z40LB37*/
*   /* DEVICE TYPE AGAINST LOCATED ENTRY.                    @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0614
*   IF TESTRC=0 THEN                                               0614
         LH    @03,TESTRC                                          0614
         LTR   @03,@03                                             0614
         BNZ   @RF00614                                            0614
*     DO;                           /*                       @Z40LB37*/
*                                                                  0615
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK THE VOLSER AND DEVICE TYPE FROM CALLER.     @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0616
*       DEVICEOK=OFF;               /*                       @Z40LB37*/
         NI    DEVICEOK,B'01111111'                                0616
*       VOLSEROK=OFF;               /*                       @Z40LB37*/
         NI    VOLSEROK,B'01111111'                                0617
*       DO COUNTI=1 TO LOCCOUNT;    /*                       @Z40LB37*/
         LA    COUNTI,1                                            0618
         B     @DE00618                                            0618
@DL00618 DS    0H                                                  0619
*         IF LOCTVOL=LOCTVOLS(COUNTI) THEN                         0619
         L     @15,@PC00001+16                                     0619
         LR    @14,COUNTI                                          0619
         MH    @14,@CH00222                                        0619
         L     @09,CTGFLPT(,CTGFLPTR)                              0619
         ST    @14,@TF00001                                        0619
         ALR   @14,@09                                             0619
         AL    @14,@CF01356                                        0619
         CLC   LOCTVOL(6,@15),LOCTVOLS-6(@14)                      0619
         BNE   @RF00619                                            0619
*           DO;                     /*                       @Z40LB37*/
*             VOLSEROK=ON;          /*                       @Z40LB37*/
         OI    VOLSEROK,B'10000000'                                0621
*             IF((LOCTRV=ON&LOCTCRV(COUNTI)=ON)×(LOCTRV=OFF&LOCTCRV(
*                 COUNTI)=OFF))&(LOCTDTYP=LOCTCTYP(COUNTI)) THEN   0622
         L     @08,@PC00001+20                                     0622
         TM    LOCTRV(@08),B'00001000'                             0622
         BNO   @GL00010                                            0622
         AL    @09,@TF00001                                        0622
         AL    @09,@CF01357                                        0622
         TM    LOCTCRV-3(@09),B'00001000'                          0622
         BO    @GL00009                                            0622
@GL00010 L     @15,@PC00001+20                                     0622
         TM    LOCTRV(@15),B'00001000'                             0622
         BNZ   @RF00622                                            0622
         LR    @15,COUNTI                                          0622
         MH    @15,@CH00222                                        0622
         L     @01,CTGFLPT(,CTGFLPTR)                              0622
         ALR   @01,@15                                             0622
         AL    @01,@CF01357                                        0622
         TM    LOCTCRV-3(@01),B'00001000'                          0622
         BNZ   @RF00622                                            0622
@GL00009 L     @15,@PC00001+20                                     0622
         LR    @14,COUNTI                                          0622
         MH    @14,@CH00222                                        0622
         L     @01,CTGFLPT(,CTGFLPTR)                              0622
         ALR   @01,@14                                             0622
         AL    @01,@CF01358                                        0622
         CLC   LOCTDTYP(2,@15),LOCTCTYP-4(@01)                     0622
         BNE   @RF00622                                            0622
*               DEVICEOK=ON;        /*                       @Z40LB37*/
         OI    DEVICEOK,B'10000000'                                0623
*           END;                    /*                       @Z40LB37*/
@RF00622 DS    0H                                                  0625
*       END;                        /*                       @Z40LB37*/
@RF00619 AL    COUNTI,@CF00213                                     0625
@DE00618 C     COUNTI,LOCCOUNT                                     0625
         BNH   @DL00618                                            0625
*                                                                  0626
*       /*************************************************************/
*       /*                                                           */
*       /* IF VOLSER IS NOT THE SAME AS THE CALLER'S INPUT,  @Z40LB37*/
*       /* THEN PRINT MESSAGE IDC2399I.                      @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0626
*       IF VOLSEROK^=ON THEN                                       0626
         TM    VOLSEROK,B'10000000'                                0626
         BO    @RF00626                                            0626
*         DO;                       /*                       @Z40LB37*/
*           DARGAREA=''B;           /*                       @Z40LB37*/
         XC    DARGAREA(28),DARGAREA                               0628
*           DARGSMOD=SA07MSG;       /*                       @Z40LB37*/
         L     @15,DDSTRU                                          0629
         MVC   DARGSMOD(3,@15),@CC01179                            0629
*           DARGSENT=MSG2399I;      /*                       @Z40LB37*/
         MVI   DARGSENT(@15),X'07'                                 0630
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB37*/
         L     @15,@PC00001                                        0631
         ST    @15,@AL00001                                        0631
         LA    @14,@CF00109                                        0631
         ST    @14,@AL00001+4                                      0631
         LA    @14,DDSTRU                                          0631
         ST    @14,@AL00001+8                                      0631
         MVI   @AL00001+8,X'80'                                    0631
         L     @15,GDTPRT(,@15)                                    0631
         LA    @01,@AL00001                                        0631
         BALR  @14,@15                                             0631
*           TESTRC=4;               /*                       @Z40LB37*/
         MVC   TESTRC(2),@CH00036                                  0632
*         END;                      /*                       @Z40LB37*/
*                                                                  0633
*       /*************************************************************/
*       /*                                                           */
*       /* IF DEVICE IS NOT THE SAME AS THE CALLER'S INPUT,  @Z40LB37*/
*       /* THEN PRINT MESSAGE IDC2360I.                      @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0634
*       ELSE                                                       0634
*         IF DEVICEOK^=ON THEN                                     0634
         B     @RC00626                                            0634
@RF00626 TM    DEVICEOK,B'10000000'                                0634
         BO    @RF00634                                            0634
*           DO;                     /*                       @Z40LB37*/
*             DARGAREA=''B;         /*                       @Z40LB37*/
         XC    DARGAREA(28),DARGAREA                               0636
*             DARGSMOD=SA07MSG;     /*                       @Z40LB37*/
         L     @15,DDSTRU                                          0637
         MVC   DARGSMOD(3,@15),@CC01179                            0637
*             DARGSENT=MSG2360I;    /*                       @Z40LB37*/
         MVI   DARGSENT(@15),X'08'                                 0638
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB37*/
         L     @15,@PC00001                                        0639
         ST    @15,@AL00001                                        0639
         LA    @14,@CF00109                                        0639
         ST    @14,@AL00001+4                                      0639
         LA    @14,DDSTRU                                          0639
         ST    @14,@AL00001+8                                      0639
         MVI   @AL00001+8,X'80'                                    0639
         L     @15,GDTPRT(,@15)                                    0639
         LA    @01,@AL00001                                        0639
         BALR  @14,@15                                             0639
*             TESTRC=4;             /*                       @Z40LB37*/
         MVC   TESTRC(2),@CH00036                                  0640
*           END;                    /*                       @Z40LB37*/
*     END;                          /*                       @Z40LB37*/
@RF00634 DS    0H                                                  0642
@RC00626 DS    0H                                                  0643
*                                                                  0643
*   /*****************************************************************/
*   /*                                                               */
*   /* IF RETURN CODE IS NOT ZERO AND NOT EIGHT, THEN        @Z40LB37*/
*   /* A CATALOG ERROR OCCURRED. PRINT ERROR MESSAGE         @Z40LB37*/
*   /* IDC0361I AND SET RETURN CODE.                         @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0643
*   IF TESTRC^=0&TESTRC^=8 THEN                                    0643
@RF00614 LH    @15,TESTRC                                          0643
         LTR   @15,@15                                             0643
         BZ    @RF00643                                            0643
         C     @15,@CF00173                                        0643
         BE    @RF00643                                            0643
*     DO;                           /*                       @Z40LB37*/
*       DARGAREA=''B;               /*                       @Z40LB37*/
         XC    DARGAREA(28),DARGAREA                               0645
*       DARGSMOD=SA07MSG;           /*                       @Z40LB37*/
         L     @15,DDSTRU                                          0646
         MVC   DARGSMOD(3,@15),@CC01179                            0646
*       DARGSENT=MSG0361I;          /*                       @Z40LB37*/
         MVI   DARGSENT(@15),X'09'                                 0647
*       DARGDBP=ADDR(LOCTDSN);      /*                       @Z40LB37*/
         L     @14,@PC00001+12                                     0648
         ST    @14,DARGDBP(,@15)                                   0648
*       DARGILP=LENGTH(LOCTDSN);    /*                       @Z40LB37*/
         MVC   DARGILP(2,@15),@CH00767                             0649
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB37*/
         L     @15,@PC00001                                        0650
         ST    @15,@AL00001                                        0650
         LA    @14,@CF00109                                        0650
         ST    @14,@AL00001+4                                      0650
         LA    @14,DDSTRU                                          0650
         ST    @14,@AL00001+8                                      0650
         MVI   @AL00001+8,X'80'                                    0650
         L     @15,GDTPRT(,@15)                                    0650
         LA    @01,@AL00001                                        0650
         BALR  @14,@15                                             0650
*       TESTRC=4;                   /*                       @Z40LB37*/
         MVC   TESTRC(2),@CH00036                                  0651
*     END;                          /*                       @Z40LB37*/
*                                                                  0652
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0653
*   IF GDTDBG=NULLPTR THEN                                         0653
@RF00643 L     @15,@PC00001                                        0653
         L     @15,GDTDBG(,@15)                                    0653
         LTR   @15,@15                                             0653
         BZ    @RT00653                                            0653
*     ;                                                            0654
*   ELSE                                                           0655
*     CALL IDCDB010(GDTTBL,'SALE'); /*                       @Z40LB37*/
*                                                                  0655
         L     @15,@PC00001                                        0655
         ST    @15,@AL00001                                        0655
         LA    @14,@CC01301                                        0655
         ST    @14,@AL00001+4                                      0655
         MVI   @AL00001+4,X'80'                                    0655
         L     @15,GDTDBG(,@15)                                    0655
         LA    @01,@AL00001                                        0655
         BALR  @14,@15                                             0655
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER WITH THE RETURN CODE             @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);/*                    @Z40LB37*/
@RT00653 L     @15,@PC00001                                        0656
         ST    @15,@AL00001                                        0656
         LA    @14,MODID                                           0656
         ST    @14,@AL00001+4                                      0656
         LA    @14,TESTRC                                          0656
         ST    @14,@AL00001+8                                      0656
         MVI   @AL00001+8,X'80'                                    0656
         L     @15,GDTEPL(,@15)                                    0656
         LA    @01,@AL00001                                        0656
         BALR  @14,@15                                             0656
*                                                                  0657
*/********************************************************************/
*/*                                                          @Z40LB37*/
*/* PROCEDURE NAME - VSAMLOC                                 @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* FUNCTION - VSAMLOC LOCATES A NON-VSAM DATA SET ENTRY     @Z40LB37*/
*/*            THAT IS CATALOGED IN A VSAM CATALOG           @Z40LB37*/
*/*            IN VS/1 OR VS/2 OR THAT IS CATALOGED IN       @Z40LB37*/
*/*            AN OS CVOL THAT IS CONNECTED TO THE VSAM      @Z40LB37*/
*/*            MASTER CATALOG IN VS/2.  MESSAGE IDC2364I     @Z40LB37*/
*/*            IS ISSUED IF THE DATA SET WAS NOT A NON-VSAM  @Z40LB37*/
*/*            DATA SET.                                     @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* INPUT  - LCTINFO, DSNAME VARIABLE                        @Z40LB37*/
*/*                                                          @Z40LB37*/
*/* OUTPUT - RETURN CODE IN REGISTER 15.  LOCCOUNT SET WITH  @Z40LB37*/
*/*          NUMBER OF VOLUME ENTRIES IF RETURN CODE IS 0.   @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 0, DATA SET LOCATED SUCCESSFULLY.       @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 4, AN ERROR OCCURRED LOCATING THE       @Z40LB37*/
*/*                     DATA SET.                            @Z40LB37*/
*/*                                                          @Z40LB37*/
*/*          R. C. = 8, DATA SET ENTRY WAS NOT FOUND IN THE  @Z40LB37*/
*/*                     CATALOG.                             @Z40LB37*/
*/*                                                          @Z40LB37*/
*/********************************************************************/
*                                                                  0657
*VSAMLOC:                                                          0657
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB37*/
         B     @PB00007                                            0657
VSAMLOC  ST    @14,@SA00007                                        0657
*                                                                  0658
*   /*****************************************************************/
*   /*                                                               */
*   /* DECLARATIONS OF AREAS FOR VSAM CATALOG PARAMETER      @Z40LB37*/
*   /* LIST, VSAM CATALOG FIELD PARAMETER LISTS, AND THE     @Z40LB37*/
*   /* CATALOG WORK AREA                                     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0658
*   DCL                                                            0658
*     LCPLAREA CHAR(LENGTH(CTGPL)+(LENGTH(CTGFIELD)*6)) BDY(WORD);/*
*                                                            @Z40LB37*/
*   DCL                                                            0659
*     LCFLAREA CHAR((LENGTH(CTGFL)+LENGTH(CTGFLDAT))*6) BDY(WORD);/*
*                                                            @Z40LB37*/
*   DCL                                                            0660
*     1 LOCWAREA BDY(WORD),         /*                       @Z40LB37*/
*      2 LOCWLEN1 CHAR(2),          /* LENGTH OF WORK AREA   @Z40LB37*/
*      2 LOCWLEN2 CHAR(2),          /* RETURNED BY VSAM      @Z40LB37*/
*      2 LOCWENTP CHAR(1),          /* ENTRY TYPE RETURNED   @Z40LB37*/
*      2 LOCWDATE,                  /* RETURNED DATE FIELDS  @Z40LB37*/
*       3 LOCWCRDT CHAR(3),         /* RETURNED CREATION     @Z40LB37*/
*       3 LOCWEXDT CHAR(3),         /* RETURNED EXPIRATION   @Z40LB37*/
*       3 * CHAR(1),                /* RESERVED              @Z40LB37*/
*      2 LOCWOWNR CHAR(8),          /* OWNER ID RETURNED     @Z40LB37*/
*      2 LOCWACBP PTR(31),          /* ACBPTR RETURNED       @Z40LB37*/
*      2 LOCWVOLL(255),             /* RETURNED VOLSER FIELD @Z40LB37*/
*       3 LOCWREP CHAR(2),          /* RETURNED REPEAT CNT   @Z40LB37*/
*       3 LOCWDEVT CHAR(4),         /* RETURNED DEVICE TYPE  @Z40LB37*/
*       3 LOCWVOL CHAR(6),          /* RETURNED VOLSER       @Z40LB37*/
*       3 LOCWFILS CHAR(2),         /* RETURNED FILES        @Z40LB37*/
*       3 LOCWVOLF CHAR(1);         /* RETURNED VOL FLAGS    @Z40LB37*/
*   DCL                                                            0661
*     VLOCRC FIXED(15) BDY(HWORD);  /* VSAMLOC RETURN CODE   @Z40LB37*/
*   DCL                                                            0662
*     LCTGFNUM PTR(8) CONSTANT(6);  /* NUM OF CTGFLS         @Z40LB37*/
*   DCL                                                            0663
*     DSENTYP CHAR(8) INIT('ENTYPE  ');/* ENTRY TYPE         @Z40LB37*/
*   DCL                                                            0664
*     DSCRDT CHAR(8) INIT('DSETCRDT');/* CREATION DATE       @Z40LB37*/
*   DCL                                                            0665
*     DSEXDT CHAR(8) INIT('DSETEXDT');/* EXPIRATION DATE     @Z40LB37*/
*   DCL                                                            0666
*     DSOWNR CHAR(8) INIT('OWNERID ');/* OWNER IDENT         @Z40LB37*/
*   DCL                                                            0667
*     DSCATACB CHAR(8) INIT('CATACB  ');/* CATALOG ACBPTR    @Z40LB37*/
*   DCL                                                            0668
*     DSCATVOL CHAR(8) INIT('CATVOL  ');/* VOLSER & DEVICE   @Z40LB37
*                                      TYPE LIST REQUESTED   @Z40LB37*/
*                                                                  0669
*   /*****************************************************************/
*   /*                                                               */
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0669
*   OLDERID2=NEWERID2;                                             0669
         L     @06,@PC00001                                        0669
         L     @06,GDTTR2(,@06)                                    0669
         MVC   @TS00001(95),NEWERID2(@06)                          0669
         MVC   OLDERID2(95,@06),@TS00001                           0669
*   NEWID2='SAVL';                  /*                       @Z40LB37*/
*                                                                  0670
         MVC   NEWID2(4,@06),@CC01338                              0670
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0671
*   VLOCRC=0;                       /*                       @Z40LB37*/
         SLR   VLOCRC,VLOCRC                                       0671
*                                                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE IEZCTGPL TO LOCATE THE NON-VSAM        @Z40LB37*/
*   /* DATA SET ENTRY                                        @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0672
*   CTGPLPTR=ADDR(LCPLAREA);        /*                       @Z40LB37*/
         LA    @06,LCPLAREA                                        0672
         ST    @06,CTGPLPTR                                        0672
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/
         LA    CTGFLPTR,LCFLAREA                                   0673
*   LCPLAREA=''B;                   /* SET TO 0              @Z40LB37*/
         XC    LCPLAREA(52),LCPLAREA                               0674
*   LCFLAREA=''B;                   /* SET TO 0              @Z40LB37*/
         XC    LCFLAREA(144),LCFLAREA                              0675
*   CTGFUNC='001'B;                 /* CATALOG MANAGEMENT    @Z40LB37
*                                      SERVICES REQUEST      @Z40LB37*/
         NI    CTGFUNC(@06),B'00111111'                            0676
         OI    CTGFUNC(@06),B'00100000'                            0676
*   CTGNAME=ON;                     /* CTGENT POINTS TO ENTRY      0677
*                                                            @Z40LB37
*                                      NAME                  @Z40LB37*/
*   CTGCNAME=ON;                    /* NO ACBPTR PASSED      @Z40LB37*/
         OI    CTGNAME(@06),B'00000110'                            0678
*   CTGAM0=ON;                      /* VSAM PARAMETER LIST   @Z40LB37*/
         OI    CTGAM0(@06),B'00000001'                             0679
*   CTGENT=ADDR(LOCTDSN);           /* DATA SET NAME         @Z40LB37*/
         L     @15,@PC00001+12                                     0680
         ST    @15,CTGENT(,@06)                                    0680
*   CTGWKA=ADDR(LOCWAREA);          /* WORK AREA             @Z40LB37*/
         LA    @15,LOCWAREA                                        0681
         ST    @15,CTGWKA(,@06)                                    0681
*   CTGNOFLD=LCTGFNUM;              /* NUMBER OF CTGFLS (6)  @Z40LB37*/
         MVI   CTGNOFLD(@06),X'06'                                 0682
*   CTGFIELD(1)=CTGFLPTR;           /* ADDRESS OF CTGFL #1   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD(,@06)                             0683
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         LA    @14,24                                              0684
         ALR   CTGFLPTR,@14                                        0684
*   CTGFIELD(2)=CTGFLPTR;           /* ADDRESS OF CTGFL #2   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD+4(,@06)                           0685
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0686
*   CTGFIELD(3)=CTGFLPTR;           /* ADDRESS OF CTGFL #3   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD+8(,@06)                           0687
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0688
*   CTGFIELD(4)=CTGFLPTR;           /* ADDRESS OF CTGFL #4   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD+12(,@06)                          0689
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0690
*   CTGFIELD(5)=CTGFLPTR;           /* ADDRESS OF CTGFL #5   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD+16(,@06)                          0691
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0692
*   CTGFIELD(6)=CTGFLPTR;           /* ADDRESS OF CTGFL #6   @Z40LB37*/
         ST    CTGFLPTR,CTGFIELD+20(,@06)                          0693
*                                                                  0694
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CTGFL FIELD NAMES                      @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0694
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/
         LA    @06,LCFLAREA                                        0694
         LR    CTGFLPTR,@06                                        0694
*   CTGFLDNM=ADDR(DSENTYP);         /*                       @Z40LB37*/
         LA    @09,DSENTYP                                         0695
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0695
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0696
*   CTGFLDNM=ADDR(DSCRDT);          /*                       @Z40LB37*/
         LA    @09,DSCRDT                                          0697
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0697
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0698
*   CTGFLDNM=ADDR(DSEXDT);          /*                       @Z40LB37*/
         LA    @09,DSEXDT                                          0699
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0699
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0700
*   CTGFLDNM=ADDR(DSOWNR);          /*                       @Z40LB37*/
         LA    @09,DSOWNR                                          0701
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0701
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0702
*   CTGFLDNM=ADDR(DSCATACB);        /*                       @Z40LB37*/
         LA    @09,DSCATACB                                        0703
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0703
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/
         ALR   CTGFLPTR,@14                                        0704
*   CTGFLDNM=ADDR(DSCATVOL);        /*                       @Z40LB37*/
         LA    @14,DSCATVOL                                        0705
         ST    @14,CTGFLDNM(,CTGFLPTR)                             0705
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/
         LR    CTGFLPTR,@06                                        0706
*                                                                  0707
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE CATALOG WORK AREA                      @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0707
*   RESPECIFY                                                      0707
*    (REG4,                                                        0707
*     REG5,                                                        0707
*     REG8,                                                        0707
*     REG9) RSTD;                   /*                       @Z40LB37*/
*   REG4=ADDR(LOCWAREA);            /*                       @Z40LB37*/
         LR    REG4,@15                                            0708
*   REG5=LENGTH(LOCWAREA);          /*                       @Z40LB37*/
         LA    REG5,3849                                           0709
*   REG8=''B;                       /*                       @Z40LB37*/
         SLR   @06,@06                                             0710
         LR    REG8,@06                                            0710
*   REG9=''B;                       /*                       @Z40LB37*/
         LR    REG9,@06                                            0711
*   MVCL(REG4,REG8);                /* ZERO LOCWAREA         @Z40LB37*/
         MVCL  REG4,REG8                                           0712
*   RESPECIFY                                                      0713
*    (REG4,                                                        0713
*     REG5,                                                        0713
*     REG8,                                                        0713
*     REG9) UNRSTD;                 /*                       @Z40LB37*/
*   LOCWLEN1=LENGTH(LOCWAREA);      /*                       @Z40LB37*/
*                                                                  0714
         MVC   LOCWLEN1(2),@CH01344                                0714
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE UCATLG AND SAVE RETURN CODE                     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0715
*   CALL IDCSACA0(GDTTBL,CTGPLPTR); /*                       @Z40LB37*/
         L     @06,@PC00001                                        0715
         ST    @06,@AL00001                                        0715
         LA    @15,CTGPLPTR                                        0715
         ST    @15,@AL00001+4                                      0715
         L     @15,GDTCAT(,@06)                                    0715
         LA    @01,@AL00001                                        0715
         BALR  @14,@15                                             0715
*   RESPECIFY                                                      0716
*     RTNREG RSTD;                                                 0716
*   TESTRC=RTNREG;                                                 0717
         STH   RTNREG,TESTRC                                       0717
*   RESPECIFY                                                      0718
*     RTNREG UNRSTD;                /*                       @Z40LB37*/
*                                                                  0719
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS NOT 0 AND NOT 8, AN ERROR       @Z40LB37*/
*   /* OCCURRED LOCATING THE NON-VSAM DATA SET               @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0719
*   IF TESTRC^=0&TESTRC^=8 THEN                                    0719
         LH    @06,TESTRC                                          0719
         LTR   @06,@06                                             0719
         BZ    @RF00719                                            0719
         C     @06,@CF00173                                        0719
         BE    @RF00719                                            0719
*     DO;                           /*                       @Z40LB37*/
*                                                                  0720
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE UERROR ARGUMENT LIST AND ISSUE UERROR  @Z40LB37*/
*       /* TO PRINT MESSAGES IDENTIFYING THE CATALOG ERROR   @Z40LB37*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0721
*       ERCNVTAB=''B;               /* SET TO 0              @Z40LB37*/
         L     @15,ERCNVADR                                        0721
         XC    ERCNVTAB(32,@15),ERCNVTAB(@15)                      0721
*       ERCATLG=ON;                 /* CATALOG ERROR         @Z40LB37*/
         OI    ERCATLG(@15),B'10000000'                            0722
*       ERCATLC=ON;                 /* LOCATE FUNCTION       @Z40LB37*/
         OI    ERCATLC(@15),B'10000000'                            0723
*       ERDSNM=ADDR(LOCTDSN);       /* DATA SET NAME         @Z40LB37*/
         L     @14,@PC00001+12                                     0724
         ST    @14,ERDSNM(,@15)                                    0724
*       ERCATRC=TESTRC;             /* CATALOG RETURN CODE   @Z40LB37*/
         ST    @06,ERCATRC(,@15)                                   0725
*       ERCPLPT=CTGPLPTR;           /* CATALOG PARAMETER LIST      0726
*                                                            @Z40LB37*/
         L     @06,CTGPLPTR                                        0726
         ST    @06,ERCPLPT(,@15)                                   0726
*       CALL IDCTPER0(GDTTBL,ERCNVADR);/*                    @Z40LB37*/
         L     @06,@PC00001                                        0727
         ST    @06,@AL00001                                        0727
         LA    @15,ERCNVADR                                        0727
         ST    @15,@AL00001+4                                      0727
         MVI   @AL00001+4,X'80'                                    0727
         L     @15,GDTERR(,@06)                                    0727
         LA    @01,@AL00001                                        0727
         BALR  @14,@15                                             0727
*       VLOCRC=4;                   /*                       @Z40LB37*/
         LA    VLOCRC,4                                            0728
*     END;                          /*                       @Z40LB37*/
*                                                                  0729
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RETURN CODE IS 0 AND THE ENTRY THAT WAS FOUND  @Z40LB37*/
*   /* IS A NON-VSAM DATA SET ENTRY, THEN PROCESS RETURNED   @Z40LB37*/
*   /* CATALOG INFORMATION INTO THE LCTINFO AREA, ELSE PRINT @Z40LB37*/
*   /* MESSAGE IDC2364I.                                     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0730
*   IF TESTRC=0 THEN                                               0730
@RF00719 LH    @06,TESTRC                                          0730
         LTR   @06,@06                                             0730
         BNZ   @RF00730                                            0730
*     IF LOCTENTP='A' THEN                                         0731
         L     @06,CTGFLPT(,CTGFLPTR)                              0731
         CLI   LOCTENTP(@06),C'A'                                  0731
         BNE   @RF00731                                            0731
*       DO;                         /*                       @Z40LB37*/
*                                                                  0733
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT TO BINARY CREATION DATE IF RETURNED     @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0733
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0733
         AL    CTGFLPTR,@CF00302                                   0733
*         IF LOCTCRDT^=FOXES THEN                                  0734
         L     @06,CTGFLPT(,CTGFLPTR)                              0734
         CLC   LOCTCRDT(3,@06),FOXES                               0734
         BE    @RF00734                                            0734
*           DO;                     /*                       @Z40LB37*/
*             FULWORD=''B;          /*                       @Z40LB37*/
         SLR   FULWORD,FULWORD                                     0736
*             CVB(FULWORD,LOCTCRDT);/*                       @Z40LB37*/
         XC    @TS00001(8),@TS00001                                0737
         MVC   @TS00001+5(3),LOCTCRDT(@06)                         0737
         CVB   FULWORD,@TS00001                                    0737
*             LCTCREAT(3:4)=FULWORD//THOUSAND;/*             @Z40LB37*/
         L     @06,THOUSAND                                        0738
         LR    @00,FULWORD                                         0738
         SRDA  @00,32                                              0738
         DR    @00,@06                                             0738
         STCM  @00,3,LCTCREAT+2(LOCTPTR)                           0738
*             LCTCREAT(1:2)=FULWORD/THOUSAND;/*              @Z40LB37*/
         LR    @00,FULWORD                                         0739
         SRDA  @00,32                                              0739
         DR    @00,@06                                             0739
         STCM  @01,3,LCTCREAT(LOCTPTR)                             0739
*           END;                    /*                       @Z40LB37*/
*         ELSE                                                     0741
*           LCTCREAT=NULENTRY;      /*                       @Z40LB37*/
*                                                                  0741
         B     @RC00734                                            0741
@RF00734 MVC   LCTCREAT(4,LOCTPTR),NULENTRY                        0741
*         /***********************************************************/
*         /*                                                         */
*         /* CONVERT TO BINARY EXPIRATION DATE IF RETURNED   @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0742
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0742
@RC00734 AL    CTGFLPTR,@CF00302                                   0742
*         IF LOCTEXDT^=FOXES THEN                                  0743
         L     @06,CTGFLPT(,CTGFLPTR)                              0743
         CLC   LOCTEXDT(3,@06),FOXES                               0743
         BE    @RF00743                                            0743
*           DO;                     /*                       @Z40LB37*/
*             FULWORD=''B;          /*                       @Z40LB37*/
         SLR   FULWORD,FULWORD                                     0745
*             CVB(FULWORD,LOCTEXDT);/*                       @Z40LB37*/
         XC    @TS00001(8),@TS00001                                0746
         MVC   @TS00001+5(3),LOCTEXDT(@06)                         0746
         CVB   FULWORD,@TS00001                                    0746
*             LCTEXPIR(3:4)=FULWORD//THOUSAND;/*             @Z40LB37*/
         L     @06,THOUSAND                                        0747
         LR    @00,FULWORD                                         0747
         SRDA  @00,32                                              0747
         DR    @00,@06                                             0747
         STCM  @00,3,LCTEXPIR+2(LOCTPTR)                           0747
*             LCTEXPIR(1:2)=FULWORD/THOUSAND;/*              @Z40LB37*/
         LR    @00,FULWORD                                         0748
         SRDA  @00,32                                              0748
         DR    @00,@06                                             0748
         STCM  @01,3,LCTEXPIR(LOCTPTR)                             0748
*           END;                    /*                       @Z40LB37*/
*         ELSE                                                     0750
*           LCTEXPIR=NULENTRY;      /*                       @Z40LB37*/
         B     @RC00743                                            0750
@RF00743 MVC   LCTEXPIR(4,LOCTPTR),NULENTRY                        0750
*                                                                  0751
*         /***********************************************************/
*         /*                                                         */
*         /* SET OWNER ID IN LCTINFO AREA IF RETURNED        @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0751
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0751
@RC00743 AL    CTGFLPTR,@CF00302                                   0751
*         IF LOCTOWNR(6:8)^=FOXES THEN                             0752
         L     @06,CTGFLPT(,CTGFLPTR)                              0752
         CLC   LOCTOWNR+5(3,@06),FOXES                             0752
         BE    @RF00752                                            0752
*           LCTOWNER=LOCTOWNR;      /*                       @Z40LB37*/
         MVC   LCTOWNER(8,LOCTPTR),LOCTOWNR(@06)                   0753
*         ELSE                                                     0754
*           LCTOWNER=NULOWNER;      /*                       @Z40LB37*/
*                                                                  0754
         B     @RC00752                                            0754
@RF00752 MVC   LCTOWNER(8,LOCTPTR),NULOWNER                        0754
*         /***********************************************************/
*         /*                                                         */
*         /* SET CATALOG ACB POINTER IN LCTINFO IF NOT ZERO  @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0755
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0755
@RC00752 AL    CTGFLPTR,@CF00302                                   0755
*         IF CTGFLPT(1)^=NULLPTR THEN                              0756
         L     @06,CTGFLPT(,CTGFLPTR)                              0756
         LTR   @06,@06                                             0756
         BZ    @RF00756                                            0756
*           LCTACBP=LOCTCATA;       /*                       @Z40LB37*/
         L     @06,LOCTCATA(,@06)                                  0757
         ST    @06,LCTACBP(,LOCTPTR)                               0757
*         ELSE                                                     0758
*           LCTACBP=''B;            /*                       @Z40LB37*/
*                                                                  0758
         B     @RC00756                                            0758
@RF00756 SLR   @06,@06                                             0758
         ST    @06,LCTACBP(,LOCTPTR)                               0758
*         /***********************************************************/
*         /*                                                         */
*         /* SET VOLUME SERIAL COUNT IN LCTINFO AREA         @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0759
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0759
@RC00756 AL    CTGFLPTR,@CF00302                                   0759
*         LOCCOUNT=CTGFLNG(1)/LENGTH(LOCTVOLL);/*            @Z40LB37*/
         L     @00,CTGFLNG(,CTGFLPTR)                              0760
         SRDA  @00,32                                              0760
         D     @00,@CF00222                                        0760
         ST    @01,LOCCOUNT                                        0760
*         LCTMULVC=LOCCOUNT;        /*                       @Z40LB37*/
*                                                                  0761
         ST    @01,LCTMULVC(,LOCTPTR)                              0761
*         /***********************************************************/
*         /*                                                         */
*         /* TURN ON LOCATED IN A VSAM CATALOG SWITCH        @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0762
*         LCTVSCAT=ON;              /*                       @Z40LB37*/
         OI    LCTVSCAT(LOCTPTR),B'10000000'                       0762
*       END;                        /*                       @Z40LB37*/
*     ELSE                                                         0764
*       DO;                         /*                       @Z40LB37*/
*                                                                  0764
         B     @RC00731                                            0764
@RF00731 DS    0H                                                  0765
*         /***********************************************************/
*         /*                                                         */
*         /* INITIALIZE UPRINT ARGUMENT LIST, ISSUE UPRINT   @Z40LB37*/
*         /* TO PRINT MESSAGE IDC2364I TO SAY THAT THE DATA  @Z40LB37*/
*         /* SET WAS NOT A NON-VSAM DATA SET                 @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0765
*         DARGAREA=''B;             /*                       @Z40LB37*/
         XC    DARGAREA(28),DARGAREA                               0765
*         DARGSMOD=SA07MSG;         /*                       @Z40LB37*/
         L     @06,DDSTRU                                          0766
         MVC   DARGSMOD(3,@06),@CC01179                            0766
*         DARGSENT=MSG2364I;        /*                       @Z40LB37*/
         MVI   DARGSENT(@06),X'0C'                                 0767
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB37*/
*                                                                  0768
         L     @06,@PC00001                                        0768
         ST    @06,@AL00001                                        0768
         LA    @03,@CF00109                                        0768
         ST    @03,@AL00001+4                                      0768
         LA    @03,DDSTRU                                          0768
         ST    @03,@AL00001+8                                      0768
         MVI   @AL00001+8,X'80'                                    0768
         L     @15,GDTPRT(,@06)                                    0768
         LA    @01,@AL00001                                        0768
         BALR  @14,@15                                             0768
*         /***********************************************************/
*         /*                                                         */
*         /* SET INTERNAL RETURN CODE                        @Z40LB37*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0769
*         VLOCRC=4;                 /*                       @Z40LB37*/
         LA    VLOCRC,4                                            0769
*       END;                        /*                       @Z40LB37*/
*                                                                  0770
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CATALOG RETURN CODE WAS 8, INDICATING THE      @Z40LB37*/
*   /* DATA SET WAS NOT LOCATED IN THE CATALOG, SET RETURN   @Z40LB37*/
*   /* CODE TO RCNLOCAT.                                     @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0771
*   IF TESTRC=8 THEN                                               0771
@RC00731 DS    0H                                                  0771
@RF00730 LA    @06,8                                               0771
         CH    @06,TESTRC                                          0771
         BNE   @RF00771                                            0771
*     VLOCRC=8;                     /*                       @Z40LB37*/
*                                                                  0772
         LR    VLOCRC,@06                                          0772
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER                                  @Z40LB37*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0773
*   RETURN CODE(VLOCRC);            /*                       @Z40LB37*/
@RF00771 LR    @15,VLOCRC                                          0773
@EL00007 DS    0H                                                  0773
@EF00007 DS    0H                                                  0773
@ER00007 L     @14,@SA00007                                        0773
         BR    @14                                                 0773
*   END VSAMLOC;                    /*                       @Z40LB37*/
*   END IDCSA07                     /*                       @Z40LB30*/
*                                                                  0775
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */
*                                                                  0775
*       ;                                                          0775
@EL00001 L     @13,4(,@13)                                         0775
@EF00001 L     @00,@SIZDATD                                        0775
         LR    @01,@11                                             0775
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0775
         BR    @14                                                 0775
@DATA    DS    0H
@CH00147 DC    H'2'
@CH00036 DC    H'4'
@CH00032 DC    H'12'
@CH00767 DC    H'44'
@CH01343 DC    H'49'
@CH01342 DC    H'265'
@CH01344 DC    H'3849'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    7F
@SA00002 DS    15F
@SA00003 DS    14F
@SA00004 DS    15F
@SA00006 DS    1F
@SA00005 DS    1F
@SA00007 DS    1F
@AL00001 DS    4A
@TF00001 DS    F
@AFTEMPS DS    3F
IDCSA07  CSECT
         DS    0F
@CF00109 DC    F'0'
@CF00213 DC    F'1'
@CH00213 EQU   @CF00213+2
@CF00173 DC    F'8'
@CH00173 EQU   @CF00173+2
@CF00222 DC    F'15'
@CH00222 EQU   @CF00222+2
@CF00466 DC    F'16'
@CF01109 DC    F'20'
@CH01109 EQU   @CF01109+2
@CF00302 DC    F'24'
@CF01357 DC    F'-12'
@CF01358 DC    F'-11'
@CF01356 DC    F'-9'
@DATD    DSECT
         DS    0D
LISTSCAN DS    A
IOCSPTR  DS    A
OPNPTR   DS    A
DDSTRU   DS    A
FSADDR   DS    A
ERCNVADR DS    A
CCMSGPTR DS    A
CMMSGPTR DS    A
CTMSGPTR DS    A
ELEMENT  DS    F
CTGPLPTR DS    A
LOCCOUNT DS    F
LISTPTR  DS    A
SETRC    DS    H
TESTRC   DS    H
RSNCODE  DS    H
LISTLN   DS    FL1
         DS    0D
@TS00001 DS    CL95
         DS    CL1
CAMLST   DS    CL20
         ORG   CAMLST
CAMOPTNS DS    CL4
         ORG   CAMOPTNS
CAMOPTN1 DS    BL1
CAMOPTN2 DS    BL1
CAMOPTN3 DS    BL1
@NM00089 DS    BL1
         ORG   CAMLST+4
CAMPTR1  DS    AL4
CAMCVOL  DS    AL4
CAMPTR3  DS    AL4
CAMDSCB  DS    AL4
         ORG   CAMLST+20
         DS    CL4
WKAREA   DS    CL265
         ORG   WKAREA
AREA1    DS    CL256
AREA2    DS    CL9
         ORG   WKAREA+265
TSTRCTOD DS    CL4
         ORG   TSTRCTOD
TSTOCODE DS    CL2
@NM00090 DS    CL2
         ORG   TSTRCTOD+4
TSTRCTND DS    CL4
         ORG   TSTRCTND
TSTNCODE DS    CL2
@NM00091 DS    CL2
         ORG   TSTRCTND+4
         DS    CL3
DUMPAREA DS    CL49
         DS    CL3
DARGAREA DS    CL28
ERRAREA  DS    CL32
DEVICEOK DS    BL1
VOLSEROK DS    BL1
         DS    CL2
CPLAREA  DS    CL32
WORKAREA DS    CL49
         ORG   WORKAREA
WRKALEN  DS    CL2
@NM00102 DS    CL47
         ORG   WORKAREA+49
         DS    CL3
LCPLAREA DS    CL52
LCFLAREA DS    CL144
LOCWAREA DS    CL3849
         ORG   LOCWAREA
LOCWLEN1 DS    CL2
LOCWLEN2 DS    CL2
LOCWENTP DS    CL1
LOCWDATE DS    CL7
         ORG   LOCWDATE
LOCWCRDT DS    CL3
LOCWEXDT DS    CL3
@NM00103 DS    CL1
         ORG   LOCWAREA+12
LOCWOWNR DS    CL8
LOCWACBP DS    AL4
LOCWVOLL DS    CL15
         ORG   LOCWVOLL+0
LOCWREP  DS    CL2
LOCWDEVT DS    CL4
LOCWVOL  DS    CL6
LOCWFILS DS    CL2
LOCWVOLF DS    CL1
         ORG   LOCWAREA+3849
IDCSA07  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
THOUSAND DC    F'1000'
@CC01206 DC    C'RCTAGL  '
@CC01208 DC    C'UCTAGL  '
@CC01231 DC    C'WKAREA'
@CC01263 DC    C'TESTRC'
@CC01264 DC    C'CAMLST'
@CC01217 DC    C'RCEX'
@CC01220 DC    C'RCBG'
@CC01224 DC    C'RCND'
@CC01228 DC    C'RCGE'
@CC01233 DC    C'RCAC'
@CC01237 DC    C'RCTE'
@CC01241 DC    C'RCUE'
@CC01250 DC    C'SAUC'
@CC01255 DC    C'SAUE'
@CC01260 DC    C'SAOU'
@CC01265 DC    C'SAOD'
@CC01274 DC    C'SAVU'
@CC01291 DC    C'SALT'
@CC01292 DC    C'SALC'
@CC01301 DC    C'SALE'
@CC01338 DC    C'SAVL'
@CC01179 DC    C'SA7'
@CC01181 DC    C'CM0'
ALL      DC    CL3'ALL'
FORMAT   DC    CL4'FORM'
HSECOND  DC    CL4'HSEC'
CLOCK    DC    CL4'KLOK'
SETZERO  DC    CL4'ZERO'
SETBLANK DC    CL4'BLNK'
NOSET    DC    CL4'NSET'
OVERRIDE DC    CL4'OVRD'
ACQUIRE  DC    CL8'ACQUIRE '
RELINQ   DC    CL8'RELINQ  '
MOUNT    DC    CL8'MOUNT   '
DEMOUNT  DC    CL8'DEMOUNT '
DEFINE   DC    CL8'DEFINE  '
MOVE     DC    CL8'MOVE    '
TRACEQ   DC    CL8'TRACEQ  '
COPYTABL DC    CL8'COPYTABL'
COPYCRTG DC    CL8'COPYCRTG'
COPYVOL  DC    CL8'COPYVOL '
VVIC     DC    CL8'VVIC    '
TUNE     DC    CL8'TUNE    '
NAMES    DC    CL4'NAME'
UNIT     DC    CL4'UNIT'
SHR      DC    CL4'SHR '
EXCL     DC    CL4'EXCL'
NOWAIT   DC    CL4'NWAI'
WAIT     DC    CL4'WAIT'
SECCHECK DC    CL8'SECCHECK'
SCRVTOC  DC    CL8'SCRVTOC '
GETVTOC  DC    CL8'GETVTOC '
PUTVTOC  DC    CL8'PUTVTOC '
RECATLG  DC    CL8'RECATLG '
INITVOL  DC    CL8'INITVOL '
CHECK    DC    CL8'CHECK   '
POSTUCB  DC    CL8'POSTUCB '
GET      DC    CL8'GET     '
PUT      DC    CL8'PUT     '
CLOSE    DC    CL8'CLOSE   '
OPEN     DC    CL8'OPEN    '
PUTLABEL DC    CL8'PUTLABEL'
GETLABEL DC    CL8'GETLABEL'
CANCEL   DC    CL8'CANCEL  '
SET      DC    CL8'SET     '
SELECTX  DC    CL8'SELECTX '
CHANGEX  DC    CL8'CHANGEX '
SELECTDD DC    CL8'SELECTDD'
SELECTDS DC    CL8'SELECTDS'
TBLREST  DC    CL8'TBLREST '
NULLIFYC DC    CL8'NULLIFYC'
RDMSC    DC    CL8'RDMSC   '
RDMSCTBL DC    CL8'RDMSCTBL'
RDCARTLB DC    CL8'RDCARTLB'
AUDITCEL DC    CL8'AUDITCEL'
RDSTGAD  DC    CL8'RDSTGAD '
TSTDMASK DC    X'FF7C'
MODID    DC    CL4'SA07'
LOCTHDR  DC    CL8'LCTINFO '
         DS    CL3
NULENTRY DS    CL4
         ORG   NULENTRY
@NM00100 DC    X'00'
FOXES    DC    X'FFFFFF'
         ORG   NULENTRY+4
NULOWNER DS    CL8
         ORG   NULOWNER
BLANKS   DC    CL8'        '
         ORG   NULOWNER+8
FIXAREA  DS    CL300
         ORG   FIXAREA
@NM00101 DC    300X'00'
         ORG   FIXAREA+300
DSENTYP  DC    CL8'ENTYPE  '
DSCRDT   DC    CL8'DSETCRDT'
DSEXDT   DC    CL8'DSETEXDT'
DSOWNR   DC    CL8'OWNERID '
DSCATACB DC    CL8'CATACB  '
DSCATVOL DC    CL8'CATVOL  '
@DATD    DSECT
*                                                         /*#Y30LB34*/
IDCSA07  CSECT
         ENTRY IDCSAS7
IDCSAS7  DC    A(@SIZDATD)
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IDCSA07  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
VLOCRC   EQU   @07
COUNTI   EQU   @03
FULWORD  EQU   @04
LOCTPTR  EQU   @03
NUMBER   EQU   @02
ENTNO    EQU   @03
CC01     EQU   @04
UARGPTR  EQU   @03
RCTPTR   EQU   @05
CTGFLPTR EQU   @02
DMPINDEX EQU   @02
RTNREG   EQU   @15
REG0     EQU   @00
REG4     EQU   @04
REG5     EQU   @05
REG8     EQU   @08
REG9     EQU   @09
REG1     EQU   @01
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
REG2     EQU   @02
REG3     EQU   @03
REG6     EQU   @06
REG7     EQU   @07
IDCSAEP0 EQU   0
IDCSACA0 EQU   0
IDCSASC0 EQU   0
TRACE1   EQU   0
OLDERID1 EQU   TRACE1
TRACE2   EQU   0
OLDERID2 EQU   TRACE2
NEWID2   EQU   TRACE2+95
NEWERID2 EQU   5
CIRAGL   EQU   0
CIRTYPE  EQU   CIRAGL
ALLAGL   EQU   0
ALLSTS   EQU   ALLAGL+24
ALLDSP   EQU   ALLAGL+25
ALLORG   EQU   ALLAGL+26
ALLOPT   EQU   ALLAGL+28
UNITABL  EQU   0
UNITADR  EQU   UNITABL+4
@NM00010 EQU   UNITADR
UNITSTAT EQU   UNITABL+6
IOCSTR   EQU   0
IOCDSO   EQU   IOCSTR+16
IOCRFM   EQU   IOCSTR+17
IOCMAC   EQU   IOCSTR+18
IOCMAC2  EQU   IOCSTR+19
IOCCHP   EQU   IOCSTR+20
IOCMSG   EQU   IOCSTR+21
IOCRBA   EQU   IOCSTR+40
IOCTTR   EQU   IOCRBA
IOCMEM   EQU   IOCSTR+44
IOCNWM   EQU   IOCSTR+48
OPNAGL   EQU   0
OPNOPT   EQU   OPNAGL
OPNRFM   EQU   OPNAGL+1
OPNTYP   EQU   OPNAGL+2
OPNMOD   EQU   OPNAGL+3
OPNDEV   EQU   OPNAGL+24
OPNDSO   EQU   OPNAGL+41
OPNOPT2  EQU   OPNAGL+42
IOINFOPT EQU   0
UVOLLIST EQU   0
UVOLENT  EQU   UVOLLIST+2
AMSTP011 EQU   0
IDCTPER0 EQU   0
DARGLIST EQU   0
DARGDBP  EQU   DARGLIST
DARGSTID EQU   DARGLIST+8
DARGSMOD EQU   DARGSTID
DARGSENT EQU   DARGSTID+3
DARGILP  EQU   DARGLIST+12
DARGCNT  EQU   DARGLIST+14
DARGARY  EQU   DARGLIST+20
DARGINS  EQU   DARGARY
DARGINL  EQU   DARGARY+2
DARGDTM  EQU   DARGARY+4
FMTLIST  EQU   0
FMTFLGS  EQU   FMTLIST
FMTSPF   EQU   FMTLIST+2
FMTRFNO  EQU   FMTSPF
FMTILEN  EQU   FMTRFNO
FMTIOFF  EQU   FMTLIST+4
FMTTRBC  EQU   FMTIOFF
FMTSTO   EQU   FMTTRBC
FMTOCOL  EQU   FMTLIST+6
FMTCNVF  EQU   FMTLIST+10
ERCNVTAB EQU   0
ERTYPE   EQU   ERCNVTAB
ERCATLG  EQU   ERTYPE
EROSCAT  EQU   ERTYPE
EROPER   EQU   ERCNVTAB+1
ERCATLC  EQU   EROPER
ERCATDL  EQU   EROPER
EROSOPER EQU   ERCNVTAB+2
EROSUCDX EQU   EROSOPER
ERDSNM   EQU   ERCNVTAB+12
ERCATRC  EQU   ERCNVTAB+16
ERCPLPT  EQU   ERCNVTAB+20
IDCDB010 EQU   0
DMPITM   EQU   0
DMPITMNM EQU   DMPITM
DMPITMPT EQU   DMPITM+8
DMPITMLN EQU   DMPITM+12
DMPITMTP EQU   DMPITM+14
DMPARY   EQU   0
DMPTRM   EQU   0
CCMSG    EQU   0
CMMSG    EQU   0
CMVOLFLG EQU   CMMSG+6
CTMSG    EQU   0
CTARRAY  EQU   CTMSG+4
MDAGL    EQU   0
MDFLAGS  EQU   MDAGL+30
PUAGL    EQU   0
CKAGL    EQU   0
CKFLAGS  EQU   CKAGL+28
EXCLAGL  EQU   0
EXCLFLAG EQU   EXCLAGL+22
EXOARG   EQU   0
EXOPT    EQU   EXOARG+32
EXFLG    EQU   EXOARG+33
EXGARG   EQU   0
EXPARG   EQU   0
EXPDATA  EQU   EXPARG+12
EXPDATAB EQU   0
EXPARRAY EQU   EXPDATAB+4
VS2AGL   EQU   0
VSLABOPT EQU   VS2AGL+28
VS2MSG   EQU   VS2AGL+35
VS2RESOP EQU   VS2AGL+36
VS1AGL   EQU   0
VSSECOPT EQU   VS1AGL+68
VSVTOPT  EQU   VS1AGL+69
VSCATOPT EQU   VS1AGL+70
VSRETURN EQU   VS1AGL+71
VSMSG    EQU   VS1AGL+72
VSRESOPT EQU   VS1AGL+73
RCTAGL   EQU   0
RCTHEAD  EQU   RCTAGL
RCTOPT   EQU   RCTAGL+8
RCTDEV   EQU   RCTOPT
RCTVOL   EQU   RCTOPT
RCTODEV  EQU   RCTAGL+12
RCTNDEV  EQU   RCTAGL+16
RCTOVOL  EQU   RCTAGL+20
RCTNVOL  EQU   RCTAGL+26
RCTDSET  EQU   RCTAGL+32
STAEPARM EQU   0
STARCVY  EQU   STAEPARM+52
STARETRY EQU   STAEPARM+53
VOLLABEL EQU   0
SV82LIST EQU   0
@NM00065 EQU   SV82LIST+4
SV82DCBP EQU   @NM00065
@NM00066 EQU   SV82LIST+12
SV82WRKP EQU   @NM00066
SRTAGL   EQU   0
LCTINFO  EQU   0
LCTHEAD  EQU   LCTINFO
LCTMULVC EQU   LCTINFO+8
LCTACBP  EQU   LCTINFO+12
LCTCREAT EQU   LCTINFO+16
LCTEXPIR EQU   LCTINFO+20
LCTOWNER EQU   LCTINFO+24
LCTFLAGS EQU   LCTINFO+32
LCTVSCAT EQU   LCTFLAGS
UCTAGL   EQU   0
UCTHEAD  EQU   UCTAGL
UCTDSN   EQU   UCTAGL+8
UCTACBP  EQU   UCTAGL+52
UCTVOLP  EQU   UCTAGL+56
UCTDD    EQU   UCTAGL+60
UCTFLAGS EQU   UCTAGL+68
UCTVSCAT EQU   UCTFLAGS
SELAGL   EQU   0
SELFLAGS EQU   SELAGL+22
DATESAGL EQU   0
DATESOPT EQU   DATESAGL+20
VS3AGL   EQU   0
VS3FLAGS EQU   VS3AGL+58
VSDVTOC  EQU   0
VSDSTAT  EQU   0
VSDSFLG1 EQU   VSDSTAT+16
VSDFLG2  EQU   VSDSTAT+17
VSDSCR   EQU   0
VSDSCRFL EQU   VSDSCR+4
VSDUSAGE EQU   0
VSDDORG  EQU   VSDUSAGE+9
VSDALLOC EQU   VSDUSAGE+10
VSDUSEF  EQU   VSDUSAGE+11
VSDDSORG EQU   VSDUSAGE+16
VSDBLOCK EQU   0
VSDSPACE EQU   VSDBLOCK+12
VSDARRAY EQU   VSDBLOCK+16
VSDVARY  EQU   VSDARRAY+48
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGNAME  EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGSCR   EQU   CTGOPTN2
CTGOPTN3 EQU   CTGPL+2
CTGFUNC  EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGOPTNS EQU   CTGDSORG
CTGTYPE  EQU   CTGPL+18
CTGNOFLD EQU   CTGPL+19
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGJSCB  EQU   CTGPL+24
CTGFIELD EQU   CTGPL+28
CTGFL    EQU   0
CTGFLDRE EQU   CTGFL+3
CTGFLDNM EQU   CTGFL+8
CTGFLDAT EQU   CTGFL+16
CTGFLNG  EQU   CTGFLDAT
CTGFLPT  EQU   CTGFLDAT+4
LOCTDSN  EQU   0
LOCTVOL  EQU   0
LOCTDEV  EQU   0
LOCTBITS EQU   LOCTDEV+1
LOCTRV   EQU   LOCTBITS
LOCTDTYP EQU   LOCTDEV+2
LOCTENTP EQU   0
LOCTCRDT EQU   0
LOCTEXDT EQU   0
LOCTOWNR EQU   0
LOCTCATA EQU   0
LOCTVOLL EQU   0
LOCTDEVT EQU   LOCTVOLL+2
LOCTFLGS EQU   LOCTDEVT+1
LOCTCRV  EQU   LOCTFLGS
LOCTCTYP EQU   LOCTDEVT+2
LOCTVOLS EQU   LOCTVOLL+6
AMSTP041 EQU   0
AMSTP042 EQU   0
AMSTP043 EQU   0
AMSTP044 EQU   0
IDCIOCL0 EQU   0
IDCIOCO0 EQU   0
IDCIOGT0 EQU   0
IDCIOIT0 EQU   0
IDCIOOP0 EQU   0
IDCIOPO0 EQU   0
IDCIOPT0 EQU   0
IDCIOSI0 EQU   0
IDCIOST0 EQU   0
IDCIOTM0 EQU   0
IDCIOVY0 EQU   0
IDCIO050 EQU   0
IDCSAAL0 EQU   0
IDCSACL0 EQU   0
IDCSACR0 EQU   0
IDCSADE0 EQU   0
IDCSADL0 EQU   0
IDCSADQ0 EQU   0
IDCSAFP0 EQU   0
IDCSAFS0 EQU   0
IDCSAGP0 EQU   0
IDCSAGS0 EQU   0
IDCSAID0 EQU   0
IDCSALC0 EQU   0
IDCSALD0 EQU   0
IDCSALK0 EQU   0
IDCSANQ0 EQU   0
IDCSAPR0 EQU   0
IDCSAPT0 EQU   0
IDCSAQL0 EQU   0
IDCSARC0 EQU   0
IDCSARV0 EQU   0
IDCSASI0 EQU   0
IDCSASN0 EQU   0
IDCSASS0 EQU   0
IDCSAST0 EQU   0
IDCSATI0 EQU   0
IDCSAUC0 EQU   0
IDCSAWO0 EQU   0
IDCSA060 EQU   0
IDCST010 EQU   0
LISTTEST EQU   0
NEWERID1 EQU   5
GDTTBL   EQU   0
GDTTR1   EQU   GDTTBL+8
GDTTR2   EQU   GDTTBL+12
GDTDBG   EQU   GDTTBL+40
GDTSTC   EQU   GDTTBL+44
GDTPRT   EQU   GDTTBL+48
GDTESS   EQU   GDTTBL+52
GDTESA   EQU   GDTTBL+56
GDTRST   EQU   GDTTBL+60
GDTRES   EQU   GDTTBL+64
GDTCAL   EQU   GDTTBL+68
GDTGSP   EQU   GDTTBL+72
GDTFSP   EQU   GDTTBL+76
GDTGPL   EQU   GDTTBL+80
GDTFPL   EQU   GDTTBL+84
GDTLOD   EQU   GDTTBL+88
GDTDEL   EQU   GDTTBL+92
GDTPRL   EQU   GDTTBL+96
GDTEPL   EQU   GDTTBL+100
GDTTIM   EQU   GDTTBL+104
GDTIIO   EQU   GDTTBL+108
GDTTIO   EQU   GDTTBL+112
GDTOPN   EQU   GDTTBL+124
GDTCLS   EQU   GDTTBL+128
GDTGET   EQU   GDTTBL+132
GDTPUT   EQU   GDTTBL+136
GDTPOS   EQU   GDTTBL+140
GDTCPY   EQU   GDTTBL+144
GDTCAT   EQU   GDTTBL+148
GDTSNP   EQU   GDTTBL+164
GDTVFY   EQU   GDTTBL+172
GDTUID   EQU   GDTTBL+192
GDTPMT   EQU   GDTTBL+196
GDTCIR   EQU   GDTTBL+200
GDTLNK   EQU   GDTTBL+204
GDTALC   EQU   GDTTBL+208
GDTDLC   EQU   GDTTBL+212
GDTQAL   EQU   GDTTBL+216
GDTSTW   EQU   GDTTBL+220
GDTSSC   EQU   GDTTBL+224
GDTENQ   EQU   GDTTBL+228
GDTRSV   EQU   GDTTBL+232
GDTDEQ   EQU   GDTTBL+236
GDTSFO   EQU   GDTTBL+240
GDTWTO   EQU   GDTTBL+244
GDTSCR   EQU   GDTTBL+248
GDTUNT   EQU   GDTTBL+252
GDTRCT   EQU   GDTTBL+256
GDTIFO   EQU   GDTTBL+260
GDTEXP   EQU   GDTTBL+264
GDTSTA   EQU   GDTTBL+268
GDTERR   EQU   GDTTBL+272
GDTUNC   EQU   GDTTBL+276
GDTLOC   EQU   GDTTBL+280
RCTAGLAR EQU   0
UARGAREA EQU   0
DSNVAR   EQU   0
VOLVAR   EQU   0
DEVVAR   EQU   0
LOCAREAP EQU   0
VOLCOUNT EQU   WKAREA
VOLPOINT EQU   WKAREA+2
DEVCODE  EQU   VOLPOINT
VOLSER   EQU   VOLPOINT+4
TTRDSCB  EQU   WKAREA+251
*                                      START UNREFERENCED COMPONENTS
SEQNO    EQU   VOLPOINT+10
GDTECT   EQU   GDTTBL+188
GDTPSB   EQU   GDTTBL+184
GDTUPT   EQU   GDTTBL+180
GDTCMB   EQU   GDTTBL+176
GDTSPR   EQU   GDTTBL+168
@NM00001 EQU   GDTTBL+160
GDTABH   EQU   GDTTBL+156
GDTABT   EQU   GDTTBL+152
GDTTOH   EQU   GDTTBL+120
GDTRIP   EQU   GDTTBL+116
GDTIOH   EQU   GDTTBL+36
GDTSAH   EQU   GDTTBL+32
GDTTPH   EQU   GDTTBL+28
GDTRIH   EQU   GDTTBL+24
GDTSTH   EQU   GDTTBL+20
GDTDBH   EQU   GDTTBL+16
GDTPRM   EQU   GDTTBL+4
GDTHDR   EQU   GDTTBL
@NM00099 EQU   LOCTVOLL+12
@NM00098 EQU   LOCTFLGS
@NM00097 EQU   LOCTFLGS
@NM00096 EQU   LOCTDEVT
@NM00095 EQU   LOCTVOLL
@NM00094 EQU   LOCTBITS
@NM00093 EQU   LOCTBITS
@NM00092 EQU   LOCTDEV
CTGFLCHN EQU   CTGFL+12
CTGFLDWA EQU   CTGFL+4
CTGFLDTS EQU   CTGFLDRE
@NM00088 EQU   CTGFLDRE
CTGFLDGC EQU   CTGFL+2
CTGFLDCD EQU   CTGFL+1
CTGFLDNO EQU   CTGFL
CTGPSWD  EQU   CTGJSCB
@NM00087 EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
@NM00086 EQU   CTGDSORG
CTGCVOL  EQU   CTGCAT
CTGFVT   EQU   CTGENT
@NM00085 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
@NM00084 EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
VSDDSN   EQU   VSDARRAY+4
VSDVOLCT EQU   VSDARRAY
VSDFMT0  EQU   VSDBLOCK+8
VSDVTOCS EQU   VSDBLOCK+4
VSDELEM  EQU   VSDBLOCK
VSDFREE  EQU   VSDUSAGE+24
VSDALLC  EQU   VSDUSAGE+19
VSDDSOR3 EQU   VSDDSORG+2
@NM00083 EQU   VSDDSORG
VSDSCAL  EQU   VSDUSAGE+12
@NM00082 EQU   VSDUSEF
VSDCALFR EQU   VSDUSEF
@NM00081 EQU   VSDALLOC
VSDABSTR EQU   VSDALLOC
VSDABLK  EQU   VSDALLOC
VSDATRK  EQU   VSDALLOC
VSDACYL  EQU   VSDALLOC
@NM00080 EQU   VSDDORG
VSDOU    EQU   VSDDORG
VSDOIS   EQU   VSDDORG
VSDODA   EQU   VSDDORG
VSDOUN   EQU   VSDDORG
VSDOPS   EQU   VSDDORG
VSDOPO   EQU   VSDDORG
VSDEXTS  EQU   VSDUSAGE+8
VSDSECAL EQU   VSDUSAGE+4
VSDFTRK  EQU   VSDUSAGE+2
VSDTRKS  EQU   VSDUSAGE
@NM00079 EQU   VSDSCR+5
@NM00078 EQU   VSDSCRFL
VSDVSAM  EQU   VSDSCRFL
VSDCATLC EQU   VSDSCRFL
VSDACBPT EQU   VSDSCR
VSDPRTC  EQU   VSDSTAT+25
VSDCAT   EQU   VSDSTAT+22
VSDEXP   EQU   VSDSTAT+20
VSDCRE   EQU   VSDSTAT+18
@NM00077 EQU   VSDFLG2
VSDERROR EQU   VSDFLG2
VSDPROT  EQU   VSDFLG2
VSDPWW   EQU   VSDFLG2
VSDPWR   EQU   VSDFLG2
@NM00076 EQU   VSDSFLG1
VSDCVSAM EQU   VSDSFLG1
VSDCATLG EQU   VSDSFLG1
VSDVSAME EQU   VSDSFLG1
VSDVSAMC EQU   VSDSFLG1
VSDVTOCE EQU   VSDSFLG1
VSDVTOCC EQU   VSDSFLG1
VSDOWNER EQU   VSDSTAT+8
VSDEXPIR EQU   VSDSTAT+4
VSDCREAT EQU   VSDSTAT
VSDFRCCL EQU   VSDVTOC+21
@NM00075 EQU   VSDVTOC+20
VSDFREXT EQU   VSDVTOC+16
@NM00074 EQU   VSDVTOC+15
VSDFRTRK EQU   VSDVTOC+11
@NM00073 EQU   VSDVTOC+10
VSDFRCYL EQU   VSDVTOC+6
@NM00072 EQU   VSDVTOC
@NM00071 EQU   VS3FLAGS
VS3SYSNM EQU   VS3FLAGS
VS3UNCAT EQU   VS3FLAGS
VS3SCR   EQU   VS3FLAGS
VS3USAGE EQU   VS3FLAGS
VS3STAT  EQU   VS3FLAGS
VS3DD    EQU   VS3AGL+50
VS3VOL   EQU   VS3AGL+44
VS3POOL  EQU   VS3AGL+40
VS3DEV   EQU   VS3AGL+36
VS3UCBP  EQU   VS3AGL+32
VS3CREAT EQU   VS3AGL+28
VS3EXPIR EQU   VS3AGL+24
VS3AST   EQU   VS3AGL+22
VS3LEVLN EQU   VS3AGL+20
VS3LEVP  EQU   VS3AGL+16
VS3EXDSP EQU   VS3AGL+12
VS3LISTP EQU   VS3AGL+8
VS3HEAD  EQU   VS3AGL
@NM00070 EQU   DATESOPT
DATDAYOP EQU   DATESOPT
DATDTEOP EQU   DATESOPT
DATSUB   EQU   DATESOPT
DATADD   EQU   DATESOPT
DATRETRN EQU   DATESAGL+16
DATDAYS  EQU   DATESAGL+12
DATDATE  EQU   DATESAGL+8
DATHEAD  EQU   DATESAGL
@NM00069 EQU   SELFLAGS
SELVOL   EQU   SELAGL+16
SELDDNP  EQU   SELAGL+12
SELUCBP  EQU   SELAGL+8
SELHEAD  EQU   SELAGL
@NM00068 EQU   UCTFLAGS
@NM00067 EQU   LCTFLAGS
SRTWORKP EQU   SRTAGL+28
SRTFLDLN EQU   SRTAGL+24
SRTPOSIT EQU   SRTAGL+20
SRTLEN   EQU   SRTAGL+16
SRTNUM   EQU   SRTAGL+12
SRTADDR  EQU   SRTAGL+8
SRTHEAD  EQU   SRTAGL
SV82DEBP EQU   SV82WRKP
SV82TTRP EQU   SV82LIST+8
SV82VOLP EQU   SV82DCBP
SV82UCBP EQU   SV82LIST+1
SV82CODE EQU   SV82LIST
VOLRESV3 EQU   VOLLABEL+55
VOLOWNER EQU   VOLLABEL+45
VOLRESV1 EQU   VOLLABEL+20
VOLVTOC  EQU   VOLLABEL+15
VOLSECTY EQU   VOLLABEL+14
VOLSERNO EQU   VOLLABEL+8
VOLNO    EQU   VOLLABEL+7
VOLLABI  EQU   VOLLABEL+4
VOLKEY   EQU   VOLLABEL
STAVTTR  EQU   STAEPARM+54
@NM00064 EQU   STARETRY
STAVTOC  EQU   STARETRY
STAOFF   EQU   STARETRY
STAIO05  EQU   STARETRY
@NM00063 EQU   STARCVY
STACLEAR EQU   STARCVY
STAVPOST EQU   STARCVY
STAVENQ  EQU   STARCVY
STAVDMNT EQU   STARCVY
STAVMNT  EQU   STARCVY
STATCB   EQU   STAEPARM+48
STARTADD EQU   STAEPARM+44
STAEXSAV EQU   STAEPARM+40
STARTSAV EQU   STAEPARM+36
STARTTR  EQU   STAEPARM+32
@NM00062 EQU   STAEPARM+30
STARVOL  EQU   STAEPARM+24
STARUCB  EQU   STAEPARM+20
@NM00061 EQU   STAEPARM+18
STAVVOL  EQU   STAEPARM+12
STAVUCB  EQU   STAEPARM+8
STAHEAD  EQU   STAEPARM
@NM00060 EQU   RCTAGL+10
@NM00059 EQU   RCTOPT
@NM00058 EQU   VSRESOPT
VSREAL   EQU   VSRESOPT
VSRES    EQU   VSRESOPT
@NM00057 EQU   VSMSG
VSTOV    EQU   VSMSG
VSFROMV  EQU   VSMSG
@NM00056 EQU   VSRETURN
VSUCAT   EQU   VSRETURN
VSVSAM   EQU   VSRETURN
@NM00055 EQU   VSCATOPT
VSLIST   EQU   VSCATOPT
VSSERIAL EQU   VSCATOPT
VSDEVICE EQU   VSCATOPT
@NM00054 EQU   VSVTOPT
VSVSFLAG EQU   VSVTOPT
VSALTTRK EQU   VSVTOPT
VSTIME   EQU   VSVTOPT
VSUCMAST EQU   VSSECOPT
VSOPCAT  EQU   VSSECOPT
VSUCTEST EQU   VSSECOPT
VSWRITE  EQU   VSSECOPT
VSREAD   EQU   VSSECOPT
VSNONONV EQU   VSSECOPT
VSMASTER EQU   VSSECOPT
VSNOVSAM EQU   VSSECOPT
VSODEVP  EQU   VS1AGL+64
VSOSERP  EQU   VS1AGL+60
VSDEVP   EQU   VS1AGL+56
VSSERP   EQU   VS1AGL+52
VSPFILEP EQU   VS1AGL+48
VSPSWDP  EQU   VS1AGL+44
VSCATDDP EQU   VS1AGL+40
VSACBP   EQU   VS1AGL+36
VSCATP   EQU   VS1AGL+32
VSNXTATP EQU   VS1AGL+28
VSNUMATP EQU   VS1AGL+24
VSIOP    EQU   VS1AGL+20
VSFILEP  EQU   VS1AGL+16
VSVOLP   EQU   VS1AGL+12
VSUCBP   EQU   VS1AGL+8
VSHEAD   EQU   VS1AGL
VSDDNAME EQU   VS2AGL+37
@NM00053 EQU   VS2RESOP
VS2REAL  EQU   VS2RESOP
VS2RES   EQU   VS2RESOP
@NM00052 EQU   VS2MSG
VS2TOV   EQU   VS2MSG
VSVOLUME EQU   VS2AGL+29
@NM00051 EQU   VSLABOPT
VSVOLSER EQU   VSLABOPT
VSOWNER  EQU   VSLABOPT
VSIOBKPT EQU   VS2AGL+24
VSVOLPTR EQU   VS2AGL+20
VSOWNPTR EQU   VS2AGL+16
VSVTOCSZ EQU   VS2AGL+12
VSUCBPTR EQU   VS2AGL+8
VS2HEAD  EQU   VS2AGL
EXPDATAL EQU   EXPARRAY+6
@NM00050 EQU   EXPARRAY+5
EXPKEYLN EQU   EXPARRAY+4
EXPDATAP EQU   EXPARRAY
EXPRECNO EQU   EXPDATAB
EXPCCHHR EQU   EXPARG+16
EXPCTLBK EQU   EXPARG+8
EXPHEAD  EQU   EXPARG
EXGDATAL EQU   EXGARG+30
@NM00049 EQU   EXGARG+29
EXGKEYLN EQU   EXGARG+28
EXGDATAP EQU   EXGARG+24
EXGRECNO EQU   EXGARG+20
EXGCCHH2 EQU   EXGARG+16
EXGCCHH1 EQU   EXGARG+12
EXGCTLBK EQU   EXGARG+8
EXGHEAD  EQU   EXGARG
@NM00048 EQU   EXFLG
EXOREAD  EQU   EXFLG
@NM00047 EQU   EXOPT
EXOVTOC  EQU   EXOPT
EXONEW   EQU   EXOPT
EXOPASS  EQU   EXOPT
EXOLAB   EQU   EXOPT
EXOTAB   EQU   EXOPT
EXOCTLBK EQU   EXOARG+28
EXOEXT   EQU   EXOARG+24
EXOUCB   EQU   EXOARG+20
EXOVSN   EQU   EXOARG+16
EXODSN   EQU   EXOARG+12
EXODDN   EQU   EXOARG+8
EXOHEAD  EQU   EXOARG
@NM00046 EQU   EXCLFLAG
EXCLMNT  EQU   EXCLFLAG
EXCLVOL  EQU   EXCLAGL+16
EXCLDDP  EQU   EXCLAGL+12
EXCLUCBP EQU   EXCLAGL+8
EXCLHEAD EQU   EXCLAGL
@NM00045 EQU   CKFLAGS
CKDMTABL EQU   CKFLAGS
CKRETTYP EQU   CKFLAGS
CKTESTVT EQU   CKFLAGS
CKLABELP EQU   CKAGL+24
CKDATYPE EQU   CKAGL+20
CKDDNAME EQU   CKAGL+12
CKUCBPTR EQU   CKAGL+8
CKHEAD   EQU   CKAGL
PULABELP EQU   PUAGL+16
PUTTRPTR EQU   PUAGL+12
PUUCBPTR EQU   PUAGL+8
PUHEAD   EQU   PUAGL
@NM00044 EQU   MDFLAGS
MDDEQ    EQU   MDFLAGS
MDENQ    EQU   MDFLAGS
MDWAIT   EQU   MDFLAGS
MDPOST   EQU   MDFLAGS
MDCLEAR  EQU   MDFLAGS
MDNEWVOL EQU   MDFLAGS
MDLABEL  EQU   MDAGL+24
MDPUAGL  EQU   MDAGL+20
MDDDNAME EQU   MDAGL+12
MDUCBPTR EQU   MDAGL+8
MDHEAD   EQU   MDAGL
CTTBLRR  EQU   CTARRAY+3
CTTBLHH  EQU   CTARRAY+2
CTTBLCC  EQU   CTARRAY+1
CTTBLID  EQU   CTARRAY
CTREALH  EQU   CTMSG+3
CTREALCC EQU   CTMSG+1
@NM00043 EQU   CTMSG
CMCSN2   EQU   CMMSG+28
CMCSN1   EQU   CMMSG+16
CMNUMCRT EQU   CMMSG+15
@NM00042 EQU   CMMSG+14
CMNEWVOL EQU   CMMSG+8
@NM00041 EQU   CMMSG+7
@NM00040 EQU   CMVOLFLG
CMRONLY  EQU   CMVOLFLG
CMBIND   EQU   CMVOLFLG
CMSCRCRT EQU   CMVOLFLG
CMEXCL   EQU   CMVOLFLG
CMDERAS  EQU   CMVOLFLG
CMSCRVOL EQU   CMVOLFLG
CMCECART EQU   CMVOLFLG
CMOLDVOL EQU   CMMSG
CCOLDCSN EQU   CCMSG+24
CCNEWCSN EQU   CCMSG+12
@NM00039 EQU   CCMSG+10
CCVOL    EQU   CCMSG+4
@NM00038 EQU   CCMSG+2
CCEJCODE EQU   CCMSG+1
CCPSTCDE EQU   CCMSG
@NM00037 EQU   DMPARY+15
DMPARYTP EQU   DMPARY+14
DMPARYEX EQU   DMPARY+12
DMPARYIC EQU   DMPARY+10
DMPARYSZ EQU   DMPARY+8
DMPARYNM EQU   DMPARY
@NM00036 EQU   DMPITM+15
@NM00035 EQU   ERCNVTAB+24
@NM00034 EQU   ERCNVTAB+4
@NM00033 EQU   ERCNVTAB+3
@NM00032 EQU   EROSOPER
EROSCATL EQU   EROSOPER
@NM00031 EQU   EROPER
ERCATAL  EQU   EROPER
ERCATDE  EQU   EROPER
@NM00030 EQU   ERTYPE
@NM00029 EQU   FMTCNVF+1
FMTBS    EQU   FMTCNVF+1
FMTSS    EQU   FMTCNVF+1
FMTAL    EQU   FMTCNVF+1
FMTZS    EQU   FMTCNVF+1
@NM00028 EQU   FMTCNVF
FMTPU    EQU   FMTCNVF
FMTBD    EQU   FMTCNVF
FMTBHD   EQU   FMTCNVF
FMTBHA   EQU   FMTCNVF
FMTBH    EQU   FMTCNVF
FMTOLEN  EQU   FMTLIST+8
FMTRIO   EQU   FMTOCOL
FMTSPT   EQU   FMTSTO
FMTSTL   EQU   FMTILEN
@NM00027 EQU   FMTFLGS+1
FMTHDF   EQU   FMTFLGS
FMTDFF   EQU   FMTFLGS
FMTSTF   EQU   FMTFLGS
FMTREPF  EQU   FMTFLGS
FMTBDF   EQU   FMTFLGS
FMTIDF   EQU   FMTFLGS
FMTSCF   EQU   FMTFLGS
FMTEOLF  EQU   FMTFLGS
DARGPCT  EQU   DARGINL
DARGREP  EQU   DARGINS
@NM00026 EQU   DARGLIST+19
DARGIND  EQU   DARGLIST+18
DARGRETL EQU   DARGLIST+16
DARGRETP EQU   DARGLIST+4
UVOLVOL  EQU   UVOLENT+4
UVOLDEV  EQU   UVOLENT
UVOLCNT  EQU   UVOLLIST
@NM00025 EQU   IOINFOPT
IOINFTMS EQU   IOINFOPT
IOINFSUP EQU   IOINFOPT
IOINFDSN EQU   IOINFOPT
IOINFVOL EQU   IOINFOPT
IOINFDVT EQU   IOINFOPT
OPNVOL   EQU   OPNAGL+44
@NM00024 EQU   OPNAGL+43
@NM00023 EQU   OPNOPT2
OPNOPTJM EQU   OPNOPT2
@NM00022 EQU   OPNOPT2
OPNOPTAS EQU   OPNOPT2
@NM00021 EQU   OPNDSO
OPNDSOPO EQU   OPNDSO
OPNDSOIS EQU   OPNDSO
OPNDSOPS EQU   OPNDSO
OPNDSOAM EQU   OPNDSO
OPNKYL   EQU   OPNAGL+40
OPNBLK   EQU   OPNAGL+36
OPNREC   EQU   OPNAGL+32
OPNDEVIX EQU   OPNDEV+4
OPNDEVDT EQU   OPNDEV
OPNCBP   EQU   OPNAGL+20
OPNDSN   EQU   OPNAGL+16
OPNPWA   EQU   OPNAGL+12
OPNDDN   EQU   OPNAGL+8
OPNIOC   EQU   OPNAGL+4
OPNMODRP EQU   OPNMOD
OPNMODUB EQU   OPNMOD
OPNMODRS EQU   OPNMOD
OPNMODAX EQU   OPNMOD
OPNMODRR EQU   OPNMOD
OPNMODRC EQU   OPNMOD
OPNMODAC EQU   OPNMOD
OPNMODPD EQU   OPNMOD
@NM00020 EQU   OPNTYP
OPNTYPRV EQU   OPNTYP
OPNTYPEX EQU   OPNTYP
OPNTYPRA EQU   OPNTYP
OPNTYPXM EQU   OPNTYP
OPNTYPCI EQU   OPNTYP
OPNTYPSO EQU   OPNTYP
OPNTYPSI EQU   OPNTYP
@NM00019 EQU   OPNRFM
OPNRFMBK EQU   OPNRFM
OPNRFMSF EQU   OPNRFM
OPNRFMUN EQU   OPNRFM
OPNRFMVR EQU   OPNRFM
OPNRFMFX EQU   OPNRFM
OPNOPTSK EQU   OPNOPT
OPNOPTDR EQU   OPNOPT
OPNOPTCR EQU   OPNOPT
OPNOPTKS EQU   OPNOPT
OPNOPTBK EQU   OPNOPT
OPNOPTUP EQU   OPNOPT
OPNOPTOT EQU   OPNOPT
OPNOPTIN EQU   OPNOPT
IOCEXT   EQU   IOCSTR+64
IOCREL   EQU   IOCSTR+60
IOCWORK  EQU   IOCSTR+56
IOCRRN   EQU   IOCSTR+52
IOCPNM   EQU   IOCNWM+2
IOCPTL   EQU   IOCNWM
IOCKYA   EQU   IOCMEM
IOCVRC   EQU   IOCTTR
IOCCBP   EQU   IOCSTR+36
IOCDSN   EQU   IOCSTR+32
IOCHURBA EQU   IOCSTR+28
IOCVOLSR EQU   IOCSTR+22
@NM00018 EQU   IOCMSG
IOCMSGAE EQU   IOCMSG
IOCMSGCE EQU   IOCMSG
IOCMSGOE EQU   IOCMSG
IOCMSGOP EQU   IOCMSG
@NM00017 EQU   IOCMSG
IOCCHPSY EQU   IOCCHP
IOCCHPAS EQU   IOCCHP
IOCCHPBK EQU   IOCCHP
IOCCHPCR EQU   IOCCHP
IOCCHPKS EQU   IOCCHP
IOCCHPSK EQU   IOCCHP
IOCCHPDR EQU   IOCCHP
IOCCHPSQ EQU   IOCCHP
@NM00016 EQU   IOCMAC2
IOCMACPA EQU   IOCMAC2
@NM00015 EQU   IOCMAC2
IOCMACCP EQU   IOCMAC2
IOCMACRR EQU   IOCMAC2
IOCMACAS EQU   IOCMAC2
IOCMACSK EQU   IOCMAC2
@NM00014 EQU   IOCMAC
IOCMACCC EQU   IOCMAC
IOCMACDR EQU   IOCMAC
IOCMACBK EQU   IOCMAC
IOCMACCR EQU   IOCMAC
IOCMACUP EQU   IOCMAC
IOCMACOT EQU   IOCMAC
IOCMACIN EQU   IOCMAC
@NM00013 EQU   IOCRFM
IOCRFMBK EQU   IOCRFM
IOCRFMSF EQU   IOCRFM
IOCRFMUN EQU   IOCRFM
IOCRFMVR EQU   IOCRFM
IOCRFMFX EQU   IOCRFM
@NM00012 EQU   IOCDSO
IOCDSOPO EQU   IOCDSO
IOCDSOIS EQU   IOCDSO
IOCDSOPS EQU   IOCDSO
IOCDSOAM EQU   IOCDSO
IOCRKP   EQU   IOCSTR+13
IOCKYL   EQU   IOCSTR+12
IOCTRN   EQU   IOCSTR+8
IOCDLN   EQU   IOCSTR+4
IOCDAD   EQU   IOCSTR
UNITVTOC EQU   UNITABL+7
@NM00011 EQU   UNITSTAT
UNITXSHR EQU   UNITSTAT
UNITISHR EQU   UNITSTAT
UNITUA   EQU   @NM00010+1
UNITCHA  EQU   @NM00010
UNITUCB  EQU   UNITABL
ALLUNCNT EQU   ALLAGL+30
ALLVLCNT EQU   ALLAGL+29
@NM00009 EQU   ALLOPT
ALLOPTUN EQU   ALLOPT
ALLOPTPV EQU   ALLOPT
ALLOPTDS EQU   ALLOPT
ALLOPTVL EQU   ALLOPT
@NM00008 EQU   ALLORG+1
ALLORGVS EQU   ALLORG+1
@NM00007 EQU   ALLORG+1
ALLORGGS EQU   ALLORG+1
ALLORGUN EQU   ALLORG
ALLORGPO EQU   ALLORG
ALLORGMQ EQU   ALLORG
ALLORGCQ EQU   ALLORG
ALLORGCX EQU   ALLORG
ALLORGDA EQU   ALLORG
ALLORGPS EQU   ALLORG
ALLORGIS EQU   ALLORG
ALLDSPUN EQU   ALLDSP
ALLDSPCG EQU   ALLDSP
ALLDSPDE EQU   ALLDSP
ALLDSPKP EQU   ALLDSP
@NM00006 EQU   ALLDSP
ALLSTSOD EQU   ALLSTS
ALLSTSMD EQU   ALLSTS
ALLSTSNW EQU   ALLSTS
ALLSTSSR EQU   ALLSTS
@NM00005 EQU   ALLSTS
ALLPWD   EQU   ALLAGL+20
ALLVLP   EQU   ALLAGL+16
ALLULP   EQU   ALLAGL+12
ALLDDN   EQU   ALLAGL+4
ALLDSN   EQU   ALLAGL
CIRPID   EQU   CIRAGL+28
CIRPWD   EQU   CIRAGL+24
CIRCAT   EQU   CIRAGL+20
CIRWKP   EQU   CIRAGL+16
CIRTLR   EQU   CIRAGL+12
CIRHDR   EQU   CIRAGL+8
CIRTLN   EQU   CIRAGL+6
CIRHLN   EQU   CIRAGL+4
@NM00004 EQU   CIRAGL+1
@NM00003 EQU   CIRTYPE
CIRTYPAQ EQU   CIRTYPE
CIRTYP1Q EQU   CIRTYPE
NEWID1   EQU   TRACE1+95
CALLID   EQU   OLDERID1+90
@NM00002 EQU   OLDERID1
*                                      END UNREFERENCED COMPONENTS
@RC00365 EQU   @RC00359
@PB00004 EQU   @EC00444
@PB00006 EQU   @EC00596
@PB00007 EQU   @EL00001
@PB00003 EQU   @PB00004
@PB00005 EQU   @PB00006
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IDCSA07,(C'PLS0041',0603,75323)
